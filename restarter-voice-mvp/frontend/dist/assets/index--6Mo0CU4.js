function KC(n,e){for(var t=0;t<e.length;t++){const r=e[t];if(typeof r!="string"&&!Array.isArray(r)){for(const o in r)if(o!=="default"&&!(o in n)){const a=Object.getOwnPropertyDescriptor(r,o);a&&Object.defineProperty(n,o,a.get?a:{enumerable:!0,get:()=>r[o]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const a of o)if(a.type==="childList")for(const c of a.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&r(c)}).observe(document,{childList:!0,subtree:!0});function t(o){const a={};return o.integrity&&(a.integrity=o.integrity),o.referrerPolicy&&(a.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?a.credentials="include":o.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(o){if(o.ep)return;o.ep=!0;const a=t(o);fetch(o.href,a)}})();function QC(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var Ag={exports:{}},wu={},Pg={exports:{}},wt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Yv;function YC(){if(Yv)return wt;Yv=1;var n=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),c=Symbol.for("react.context"),d=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),m=Symbol.for("react.memo"),g=Symbol.for("react.lazy"),x=Symbol.iterator;function S($){return $===null||typeof $!="object"?null:($=x&&$[x]||$["@@iterator"],typeof $=="function"?$:null)}var j={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},T=Object.assign,R={};function I($,Q,G){this.props=$,this.context=Q,this.refs=R,this.updater=G||j}I.prototype.isReactComponent={},I.prototype.setState=function($,Q){if(typeof $!="object"&&typeof $!="function"&&$!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,$,Q,"setState")},I.prototype.forceUpdate=function($){this.updater.enqueueForceUpdate(this,$,"forceUpdate")};function F(){}F.prototype=I.prototype;function P($,Q,G){this.props=$,this.context=Q,this.refs=R,this.updater=G||j}var z=P.prototype=new F;z.constructor=P,T(z,I.prototype),z.isPureReactComponent=!0;var H=Array.isArray,J=Object.prototype.hasOwnProperty,O={current:null},L={key:!0,ref:!0,__self:!0,__source:!0};function C($,Q,G){var ne,se={},me=null,Ie=null;if(Q!=null)for(ne in Q.ref!==void 0&&(Ie=Q.ref),Q.key!==void 0&&(me=""+Q.key),Q)J.call(Q,ne)&&!L.hasOwnProperty(ne)&&(se[ne]=Q[ne]);var Pe=arguments.length-2;if(Pe===1)se.children=G;else if(1<Pe){for(var qe=Array(Pe),Ge=0;Ge<Pe;Ge++)qe[Ge]=arguments[Ge+2];se.children=qe}if($&&$.defaultProps)for(ne in Pe=$.defaultProps,Pe)se[ne]===void 0&&(se[ne]=Pe[ne]);return{$$typeof:n,type:$,key:me,ref:Ie,props:se,_owner:O.current}}function A($,Q){return{$$typeof:n,type:$.type,key:Q,ref:$.ref,props:$.props,_owner:$._owner}}function D($){return typeof $=="object"&&$!==null&&$.$$typeof===n}function M($){var Q={"=":"=0",":":"=2"};return"$"+$.replace(/[=:]/g,function(G){return Q[G]})}var B=/\/+/g;function _($,Q){return typeof $=="object"&&$!==null&&$.key!=null?M(""+$.key):Q.toString(36)}function U($,Q,G,ne,se){var me=typeof $;(me==="undefined"||me==="boolean")&&($=null);var Ie=!1;if($===null)Ie=!0;else switch(me){case"string":case"number":Ie=!0;break;case"object":switch($.$$typeof){case n:case e:Ie=!0}}if(Ie)return Ie=$,se=se(Ie),$=ne===""?"."+_(Ie,0):ne,H(se)?(G="",$!=null&&(G=$.replace(B,"$&/")+"/"),U(se,Q,G,"",function(Ge){return Ge})):se!=null&&(D(se)&&(se=A(se,G+(!se.key||Ie&&Ie.key===se.key?"":(""+se.key).replace(B,"$&/")+"/")+$)),Q.push(se)),1;if(Ie=0,ne=ne===""?".":ne+":",H($))for(var Pe=0;Pe<$.length;Pe++){me=$[Pe];var qe=ne+_(me,Pe);Ie+=U(me,Q,G,qe,se)}else if(qe=S($),typeof qe=="function")for($=qe.call($),Pe=0;!(me=$.next()).done;)me=me.value,qe=ne+_(me,Pe++),Ie+=U(me,Q,G,qe,se);else if(me==="object")throw Q=String($),Error("Objects are not valid as a React child (found: "+(Q==="[object Object]"?"object with keys {"+Object.keys($).join(", ")+"}":Q)+"). If you meant to render a collection of children, use an array instead.");return Ie}function oe($,Q,G){if($==null)return $;var ne=[],se=0;return U($,ne,"","",function(me){return Q.call(G,me,se++)}),ne}function X($){if($._status===-1){var Q=$._result;Q=Q(),Q.then(function(G){($._status===0||$._status===-1)&&($._status=1,$._result=G)},function(G){($._status===0||$._status===-1)&&($._status=2,$._result=G)}),$._status===-1&&($._status=0,$._result=Q)}if($._status===1)return $._result.default;throw $._result}var ce={current:null},le={transition:null},te={ReactCurrentDispatcher:ce,ReactCurrentBatchConfig:le,ReactCurrentOwner:O};function xe(){throw Error("act(...) is not supported in production builds of React.")}return wt.Children={map:oe,forEach:function($,Q,G){oe($,function(){Q.apply(this,arguments)},G)},count:function($){var Q=0;return oe($,function(){Q++}),Q},toArray:function($){return oe($,function(Q){return Q})||[]},only:function($){if(!D($))throw Error("React.Children.only expected to receive a single React element child.");return $}},wt.Component=I,wt.Fragment=t,wt.Profiler=o,wt.PureComponent=P,wt.StrictMode=r,wt.Suspense=h,wt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=te,wt.act=xe,wt.cloneElement=function($,Q,G){if($==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+$+".");var ne=T({},$.props),se=$.key,me=$.ref,Ie=$._owner;if(Q!=null){if(Q.ref!==void 0&&(me=Q.ref,Ie=O.current),Q.key!==void 0&&(se=""+Q.key),$.type&&$.type.defaultProps)var Pe=$.type.defaultProps;for(qe in Q)J.call(Q,qe)&&!L.hasOwnProperty(qe)&&(ne[qe]=Q[qe]===void 0&&Pe!==void 0?Pe[qe]:Q[qe])}var qe=arguments.length-2;if(qe===1)ne.children=G;else if(1<qe){Pe=Array(qe);for(var Ge=0;Ge<qe;Ge++)Pe[Ge]=arguments[Ge+2];ne.children=Pe}return{$$typeof:n,type:$.type,key:se,ref:me,props:ne,_owner:Ie}},wt.createContext=function($){return $={$$typeof:c,_currentValue:$,_currentValue2:$,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},$.Provider={$$typeof:a,_context:$},$.Consumer=$},wt.createElement=C,wt.createFactory=function($){var Q=C.bind(null,$);return Q.type=$,Q},wt.createRef=function(){return{current:null}},wt.forwardRef=function($){return{$$typeof:d,render:$}},wt.isValidElement=D,wt.lazy=function($){return{$$typeof:g,_payload:{_status:-1,_result:$},_init:X}},wt.memo=function($,Q){return{$$typeof:m,type:$,compare:Q===void 0?null:Q}},wt.startTransition=function($){var Q=le.transition;le.transition={};try{$()}finally{le.transition=Q}},wt.unstable_act=xe,wt.useCallback=function($,Q){return ce.current.useCallback($,Q)},wt.useContext=function($){return ce.current.useContext($)},wt.useDebugValue=function(){},wt.useDeferredValue=function($){return ce.current.useDeferredValue($)},wt.useEffect=function($,Q){return ce.current.useEffect($,Q)},wt.useId=function(){return ce.current.useId()},wt.useImperativeHandle=function($,Q,G){return ce.current.useImperativeHandle($,Q,G)},wt.useInsertionEffect=function($,Q){return ce.current.useInsertionEffect($,Q)},wt.useLayoutEffect=function($,Q){return ce.current.useLayoutEffect($,Q)},wt.useMemo=function($,Q){return ce.current.useMemo($,Q)},wt.useReducer=function($,Q,G){return ce.current.useReducer($,Q,G)},wt.useRef=function($){return ce.current.useRef($)},wt.useState=function($){return ce.current.useState($)},wt.useSyncExternalStore=function($,Q,G){return ce.current.useSyncExternalStore($,Q,G)},wt.useTransition=function(){return ce.current.useTransition()},wt.version="18.3.1",wt}var Xv;function cx(){return Xv||(Xv=1,Pg.exports=YC()),Pg.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Jv;function XC(){if(Jv)return wu;Jv=1;var n=cx(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,o=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,a={key:!0,ref:!0,__self:!0,__source:!0};function c(d,h,m){var g,x={},S=null,j=null;m!==void 0&&(S=""+m),h.key!==void 0&&(S=""+h.key),h.ref!==void 0&&(j=h.ref);for(g in h)r.call(h,g)&&!a.hasOwnProperty(g)&&(x[g]=h[g]);if(d&&d.defaultProps)for(g in h=d.defaultProps,h)x[g]===void 0&&(x[g]=h[g]);return{$$typeof:e,type:d,key:S,ref:j,props:x,_owner:o.current}}return wu.Fragment=t,wu.jsx=c,wu.jsxs=c,wu}var Zv;function JC(){return Zv||(Zv=1,Ag.exports=XC()),Ag.exports}var i=JC(),rp={},Bg={exports:{}},Tr={},Fg={exports:{}},zg={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var e1;function ZC(){return e1||(e1=1,function(n){function e(le,te){var xe=le.length;le.push(te);e:for(;0<xe;){var $=xe-1>>>1,Q=le[$];if(0<o(Q,te))le[$]=te,le[xe]=Q,xe=$;else break e}}function t(le){return le.length===0?null:le[0]}function r(le){if(le.length===0)return null;var te=le[0],xe=le.pop();if(xe!==te){le[0]=xe;e:for(var $=0,Q=le.length,G=Q>>>1;$<G;){var ne=2*($+1)-1,se=le[ne],me=ne+1,Ie=le[me];if(0>o(se,xe))me<Q&&0>o(Ie,se)?(le[$]=Ie,le[me]=xe,$=me):(le[$]=se,le[ne]=xe,$=ne);else if(me<Q&&0>o(Ie,xe))le[$]=Ie,le[me]=xe,$=me;else break e}}return te}function o(le,te){var xe=le.sortIndex-te.sortIndex;return xe!==0?xe:le.id-te.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;n.unstable_now=function(){return a.now()}}else{var c=Date,d=c.now();n.unstable_now=function(){return c.now()-d}}var h=[],m=[],g=1,x=null,S=3,j=!1,T=!1,R=!1,I=typeof setTimeout=="function"?setTimeout:null,F=typeof clearTimeout=="function"?clearTimeout:null,P=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function z(le){for(var te=t(m);te!==null;){if(te.callback===null)r(m);else if(te.startTime<=le)r(m),te.sortIndex=te.expirationTime,e(h,te);else break;te=t(m)}}function H(le){if(R=!1,z(le),!T)if(t(h)!==null)T=!0,X(J);else{var te=t(m);te!==null&&ce(H,te.startTime-le)}}function J(le,te){T=!1,R&&(R=!1,F(C),C=-1),j=!0;var xe=S;try{for(z(te),x=t(h);x!==null&&(!(x.expirationTime>te)||le&&!M());){var $=x.callback;if(typeof $=="function"){x.callback=null,S=x.priorityLevel;var Q=$(x.expirationTime<=te);te=n.unstable_now(),typeof Q=="function"?x.callback=Q:x===t(h)&&r(h),z(te)}else r(h);x=t(h)}if(x!==null)var G=!0;else{var ne=t(m);ne!==null&&ce(H,ne.startTime-te),G=!1}return G}finally{x=null,S=xe,j=!1}}var O=!1,L=null,C=-1,A=5,D=-1;function M(){return!(n.unstable_now()-D<A)}function B(){if(L!==null){var le=n.unstable_now();D=le;var te=!0;try{te=L(!0,le)}finally{te?_():(O=!1,L=null)}}else O=!1}var _;if(typeof P=="function")_=function(){P(B)};else if(typeof MessageChannel<"u"){var U=new MessageChannel,oe=U.port2;U.port1.onmessage=B,_=function(){oe.postMessage(null)}}else _=function(){I(B,0)};function X(le){L=le,O||(O=!0,_())}function ce(le,te){C=I(function(){le(n.unstable_now())},te)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(le){le.callback=null},n.unstable_continueExecution=function(){T||j||(T=!0,X(J))},n.unstable_forceFrameRate=function(le){0>le||125<le?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):A=0<le?Math.floor(1e3/le):5},n.unstable_getCurrentPriorityLevel=function(){return S},n.unstable_getFirstCallbackNode=function(){return t(h)},n.unstable_next=function(le){switch(S){case 1:case 2:case 3:var te=3;break;default:te=S}var xe=S;S=te;try{return le()}finally{S=xe}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(le,te){switch(le){case 1:case 2:case 3:case 4:case 5:break;default:le=3}var xe=S;S=le;try{return te()}finally{S=xe}},n.unstable_scheduleCallback=function(le,te,xe){var $=n.unstable_now();switch(typeof xe=="object"&&xe!==null?(xe=xe.delay,xe=typeof xe=="number"&&0<xe?$+xe:$):xe=$,le){case 1:var Q=-1;break;case 2:Q=250;break;case 5:Q=1073741823;break;case 4:Q=1e4;break;default:Q=5e3}return Q=xe+Q,le={id:g++,callback:te,priorityLevel:le,startTime:xe,expirationTime:Q,sortIndex:-1},xe>$?(le.sortIndex=xe,e(m,le),t(h)===null&&le===t(m)&&(R?(F(C),C=-1):R=!0,ce(H,xe-$))):(le.sortIndex=Q,e(h,le),T||j||(T=!0,X(J))),le},n.unstable_shouldYield=M,n.unstable_wrapCallback=function(le){var te=S;return function(){var xe=S;S=te;try{return le.apply(this,arguments)}finally{S=xe}}}}(zg)),zg}var t1;function eR(){return t1||(t1=1,Fg.exports=ZC()),Fg.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var n1;function tR(){if(n1)return Tr;n1=1;var n=cx(),e=eR();function t(s){for(var l="https://reactjs.org/docs/error-decoder.html?invariant="+s,u=1;u<arguments.length;u++)l+="&args[]="+encodeURIComponent(arguments[u]);return"Minified React error #"+s+"; visit "+l+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var r=new Set,o={};function a(s,l){c(s,l),c(s+"Capture",l)}function c(s,l){for(o[s]=l,s=0;s<l.length;s++)r.add(l[s])}var d=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),h=Object.prototype.hasOwnProperty,m=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,g={},x={};function S(s){return h.call(x,s)?!0:h.call(g,s)?!1:m.test(s)?x[s]=!0:(g[s]=!0,!1)}function j(s,l,u,f){if(u!==null&&u.type===0)return!1;switch(typeof l){case"function":case"symbol":return!0;case"boolean":return f?!1:u!==null?!u.acceptsBooleans:(s=s.toLowerCase().slice(0,5),s!=="data-"&&s!=="aria-");default:return!1}}function T(s,l,u,f){if(l===null||typeof l>"u"||j(s,l,u,f))return!0;if(f)return!1;if(u!==null)switch(u.type){case 3:return!l;case 4:return l===!1;case 5:return isNaN(l);case 6:return isNaN(l)||1>l}return!1}function R(s,l,u,f,y,w,E){this.acceptsBooleans=l===2||l===3||l===4,this.attributeName=f,this.attributeNamespace=y,this.mustUseProperty=u,this.propertyName=s,this.type=l,this.sanitizeURL=w,this.removeEmptyString=E}var I={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(s){I[s]=new R(s,0,!1,s,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(s){var l=s[0];I[l]=new R(l,1,!1,s[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(s){I[s]=new R(s,2,!1,s.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(s){I[s]=new R(s,2,!1,s,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(s){I[s]=new R(s,3,!1,s.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(s){I[s]=new R(s,3,!0,s,null,!1,!1)}),["capture","download"].forEach(function(s){I[s]=new R(s,4,!1,s,null,!1,!1)}),["cols","rows","size","span"].forEach(function(s){I[s]=new R(s,6,!1,s,null,!1,!1)}),["rowSpan","start"].forEach(function(s){I[s]=new R(s,5,!1,s.toLowerCase(),null,!1,!1)});var F=/[\-:]([a-z])/g;function P(s){return s[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(s){var l=s.replace(F,P);I[l]=new R(l,1,!1,s,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(s){var l=s.replace(F,P);I[l]=new R(l,1,!1,s,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(s){var l=s.replace(F,P);I[l]=new R(l,1,!1,s,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(s){I[s]=new R(s,1,!1,s.toLowerCase(),null,!1,!1)}),I.xlinkHref=new R("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(s){I[s]=new R(s,1,!1,s.toLowerCase(),null,!0,!0)});function z(s,l,u,f){var y=I.hasOwnProperty(l)?I[l]:null;(y!==null?y.type!==0:f||!(2<l.length)||l[0]!=="o"&&l[0]!=="O"||l[1]!=="n"&&l[1]!=="N")&&(T(l,u,y,f)&&(u=null),f||y===null?S(l)&&(u===null?s.removeAttribute(l):s.setAttribute(l,""+u)):y.mustUseProperty?s[y.propertyName]=u===null?y.type===3?!1:"":u:(l=y.attributeName,f=y.attributeNamespace,u===null?s.removeAttribute(l):(y=y.type,u=y===3||y===4&&u===!0?"":""+u,f?s.setAttributeNS(f,l,u):s.setAttribute(l,u))))}var H=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,J=Symbol.for("react.element"),O=Symbol.for("react.portal"),L=Symbol.for("react.fragment"),C=Symbol.for("react.strict_mode"),A=Symbol.for("react.profiler"),D=Symbol.for("react.provider"),M=Symbol.for("react.context"),B=Symbol.for("react.forward_ref"),_=Symbol.for("react.suspense"),U=Symbol.for("react.suspense_list"),oe=Symbol.for("react.memo"),X=Symbol.for("react.lazy"),ce=Symbol.for("react.offscreen"),le=Symbol.iterator;function te(s){return s===null||typeof s!="object"?null:(s=le&&s[le]||s["@@iterator"],typeof s=="function"?s:null)}var xe=Object.assign,$;function Q(s){if($===void 0)try{throw Error()}catch(u){var l=u.stack.trim().match(/\n( *(at )?)/);$=l&&l[1]||""}return`
`+$+s}var G=!1;function ne(s,l){if(!s||G)return"";G=!0;var u=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(l)if(l=function(){throw Error()},Object.defineProperty(l.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(l,[])}catch(ge){var f=ge}Reflect.construct(s,[],l)}else{try{l.call()}catch(ge){f=ge}s.call(l.prototype)}else{try{throw Error()}catch(ge){f=ge}s()}}catch(ge){if(ge&&f&&typeof ge.stack=="string"){for(var y=ge.stack.split(`
`),w=f.stack.split(`
`),E=y.length-1,V=w.length-1;1<=E&&0<=V&&y[E]!==w[V];)V--;for(;1<=E&&0<=V;E--,V--)if(y[E]!==w[V]){if(E!==1||V!==1)do if(E--,V--,0>V||y[E]!==w[V]){var Z=`
`+y[E].replace(" at new "," at ");return s.displayName&&Z.includes("<anonymous>")&&(Z=Z.replace("<anonymous>",s.displayName)),Z}while(1<=E&&0<=V);break}}}finally{G=!1,Error.prepareStackTrace=u}return(s=s?s.displayName||s.name:"")?Q(s):""}function se(s){switch(s.tag){case 5:return Q(s.type);case 16:return Q("Lazy");case 13:return Q("Suspense");case 19:return Q("SuspenseList");case 0:case 2:case 15:return s=ne(s.type,!1),s;case 11:return s=ne(s.type.render,!1),s;case 1:return s=ne(s.type,!0),s;default:return""}}function me(s){if(s==null)return null;if(typeof s=="function")return s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case L:return"Fragment";case O:return"Portal";case A:return"Profiler";case C:return"StrictMode";case _:return"Suspense";case U:return"SuspenseList"}if(typeof s=="object")switch(s.$$typeof){case M:return(s.displayName||"Context")+".Consumer";case D:return(s._context.displayName||"Context")+".Provider";case B:var l=s.render;return s=s.displayName,s||(s=l.displayName||l.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case oe:return l=s.displayName||null,l!==null?l:me(s.type)||"Memo";case X:l=s._payload,s=s._init;try{return me(s(l))}catch{}}return null}function Ie(s){var l=s.type;switch(s.tag){case 24:return"Cache";case 9:return(l.displayName||"Context")+".Consumer";case 10:return(l._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return s=l.render,s=s.displayName||s.name||"",l.displayName||(s!==""?"ForwardRef("+s+")":"ForwardRef");case 7:return"Fragment";case 5:return l;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return me(l);case 8:return l===C?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof l=="function")return l.displayName||l.name||null;if(typeof l=="string")return l}return null}function Pe(s){switch(typeof s){case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function qe(s){var l=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(l==="checkbox"||l==="radio")}function Ge(s){var l=qe(s)?"checked":"value",u=Object.getOwnPropertyDescriptor(s.constructor.prototype,l),f=""+s[l];if(!s.hasOwnProperty(l)&&typeof u<"u"&&typeof u.get=="function"&&typeof u.set=="function"){var y=u.get,w=u.set;return Object.defineProperty(s,l,{configurable:!0,get:function(){return y.call(this)},set:function(E){f=""+E,w.call(this,E)}}),Object.defineProperty(s,l,{enumerable:u.enumerable}),{getValue:function(){return f},setValue:function(E){f=""+E},stopTracking:function(){s._valueTracker=null,delete s[l]}}}}function be(s){s._valueTracker||(s._valueTracker=Ge(s))}function ae(s){if(!s)return!1;var l=s._valueTracker;if(!l)return!0;var u=l.getValue(),f="";return s&&(f=qe(s)?s.checked?"true":"false":s.value),s=f,s!==u?(l.setValue(s),!0):!1}function rt(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}function Le(s,l){var u=l.checked;return xe({},l,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:u??s._wrapperState.initialChecked})}function $e(s,l){var u=l.defaultValue==null?"":l.defaultValue,f=l.checked!=null?l.checked:l.defaultChecked;u=Pe(l.value!=null?l.value:u),s._wrapperState={initialChecked:f,initialValue:u,controlled:l.type==="checkbox"||l.type==="radio"?l.checked!=null:l.value!=null}}function fe(s,l){l=l.checked,l!=null&&z(s,"checked",l,!1)}function _e(s,l){fe(s,l);var u=Pe(l.value),f=l.type;if(u!=null)f==="number"?(u===0&&s.value===""||s.value!=u)&&(s.value=""+u):s.value!==""+u&&(s.value=""+u);else if(f==="submit"||f==="reset"){s.removeAttribute("value");return}l.hasOwnProperty("value")?ze(s,l.type,u):l.hasOwnProperty("defaultValue")&&ze(s,l.type,Pe(l.defaultValue)),l.checked==null&&l.defaultChecked!=null&&(s.defaultChecked=!!l.defaultChecked)}function Ce(s,l,u){if(l.hasOwnProperty("value")||l.hasOwnProperty("defaultValue")){var f=l.type;if(!(f!=="submit"&&f!=="reset"||l.value!==void 0&&l.value!==null))return;l=""+s._wrapperState.initialValue,u||l===s.value||(s.value=l),s.defaultValue=l}u=s.name,u!==""&&(s.name=""),s.defaultChecked=!!s._wrapperState.initialChecked,u!==""&&(s.name=u)}function ze(s,l,u){(l!=="number"||rt(s.ownerDocument)!==s)&&(u==null?s.defaultValue=""+s._wrapperState.initialValue:s.defaultValue!==""+u&&(s.defaultValue=""+u))}var De=Array.isArray;function K(s,l,u,f){if(s=s.options,l){l={};for(var y=0;y<u.length;y++)l["$"+u[y]]=!0;for(u=0;u<s.length;u++)y=l.hasOwnProperty("$"+s[u].value),s[u].selected!==y&&(s[u].selected=y),y&&f&&(s[u].defaultSelected=!0)}else{for(u=""+Pe(u),l=null,y=0;y<s.length;y++){if(s[y].value===u){s[y].selected=!0,f&&(s[y].defaultSelected=!0);return}l!==null||s[y].disabled||(l=s[y])}l!==null&&(l.selected=!0)}}function ie(s,l){if(l.dangerouslySetInnerHTML!=null)throw Error(t(91));return xe({},l,{value:void 0,defaultValue:void 0,children:""+s._wrapperState.initialValue})}function q(s,l){var u=l.value;if(u==null){if(u=l.children,l=l.defaultValue,u!=null){if(l!=null)throw Error(t(92));if(De(u)){if(1<u.length)throw Error(t(93));u=u[0]}l=u}l==null&&(l=""),u=l}s._wrapperState={initialValue:Pe(u)}}function Me(s,l){var u=Pe(l.value),f=Pe(l.defaultValue);u!=null&&(u=""+u,u!==s.value&&(s.value=u),l.defaultValue==null&&s.defaultValue!==u&&(s.defaultValue=u)),f!=null&&(s.defaultValue=""+f)}function st(s){var l=s.textContent;l===s._wrapperState.initialValue&&l!==""&&l!==null&&(s.value=l)}function et(s){switch(s){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function dt(s,l){return s==null||s==="http://www.w3.org/1999/xhtml"?et(l):s==="http://www.w3.org/2000/svg"&&l==="foreignObject"?"http://www.w3.org/1999/xhtml":s}var Ht,je=function(s){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(l,u,f,y){MSApp.execUnsafeLocalFunction(function(){return s(l,u,f,y)})}:s}(function(s,l){if(s.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in s)s.innerHTML=l;else{for(Ht=Ht||document.createElement("div"),Ht.innerHTML="<svg>"+l.valueOf().toString()+"</svg>",l=Ht.firstChild;s.firstChild;)s.removeChild(s.firstChild);for(;l.firstChild;)s.appendChild(l.firstChild)}});function Qe(s,l){if(l){var u=s.firstChild;if(u&&u===s.lastChild&&u.nodeType===3){u.nodeValue=l;return}}s.textContent=l}var Tt={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},vt=["Webkit","ms","Moz","O"];Object.keys(Tt).forEach(function(s){vt.forEach(function(l){l=l+s.charAt(0).toUpperCase()+s.substring(1),Tt[l]=Tt[s]})});function Bt(s,l,u){return l==null||typeof l=="boolean"||l===""?"":u||typeof l!="number"||l===0||Tt.hasOwnProperty(s)&&Tt[s]?(""+l).trim():l+"px"}function Dt(s,l){s=s.style;for(var u in l)if(l.hasOwnProperty(u)){var f=u.indexOf("--")===0,y=Bt(u,l[u],f);u==="float"&&(u="cssFloat"),f?s.setProperty(u,y):s[u]=y}}var ke=xe({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function W(s,l){if(l){if(ke[s]&&(l.children!=null||l.dangerouslySetInnerHTML!=null))throw Error(t(137,s));if(l.dangerouslySetInnerHTML!=null){if(l.children!=null)throw Error(t(60));if(typeof l.dangerouslySetInnerHTML!="object"||!("__html"in l.dangerouslySetInnerHTML))throw Error(t(61))}if(l.style!=null&&typeof l.style!="object")throw Error(t(62))}}function Y(s,l){if(s.indexOf("-")===-1)return typeof l.is=="string";switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ee=null;function ve(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var Te=null,Je=null,He=null;function Ye(s){if(s=su(s)){if(typeof Te!="function")throw Error(t(280));var l=s.stateNode;l&&(l=xh(l),Te(s.stateNode,s.type,l))}}function gt(s){Je?He?He.push(s):He=[s]:Je=s}function mt(){if(Je){var s=Je,l=He;if(He=Je=null,Ye(s),l)for(s=0;s<l.length;s++)Ye(l[s])}}function _t(s,l){return s(l)}function xn(){}var lr=!1;function Br(s,l,u){if(lr)return s(l,u);lr=!0;try{return _t(s,l,u)}finally{lr=!1,(Je!==null||He!==null)&&(xn(),mt())}}function Xt(s,l){var u=s.stateNode;if(u===null)return null;var f=xh(u);if(f===null)return null;u=f[l];e:switch(l){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(f=!f.disabled)||(s=s.type,f=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!f;break e;default:s=!1}if(s)return null;if(u&&typeof u!="function")throw Error(t(231,l,typeof u));return u}var Gt=!1;if(d)try{var gr={};Object.defineProperty(gr,"passive",{get:function(){Gt=!0}}),window.addEventListener("test",gr,gr),window.removeEventListener("test",gr,gr)}catch{Gt=!1}function wi(s,l,u,f,y,w,E,V,Z){var ge=Array.prototype.slice.call(arguments,3);try{l.apply(u,ge)}catch(Be){this.onError(Be)}}var Si=!1,pt=null,cr=!1,Qi=null,Oc={onError:function(s){Si=!0,pt=s}};function Ha(s,l,u,f,y,w,E,V,Z){Si=!1,pt=null,wi.apply(Oc,arguments)}function Ud(s,l,u,f,y,w,E,V,Z){if(Ha.apply(this,arguments),Si){if(Si){var ge=pt;Si=!1,pt=null}else throw Error(t(198));cr||(cr=!0,Qi=ge)}}function ni(s){var l=s,u=s;if(s.alternate)for(;l.return;)l=l.return;else{s=l;do l=s,(l.flags&4098)!==0&&(u=l.return),s=l.return;while(s)}return l.tag===3?u:null}function Ms(s){if(s.tag===13){var l=s.memoizedState;if(l===null&&(s=s.alternate,s!==null&&(l=s.memoizedState)),l!==null)return l.dehydrated}return null}function ri(s){if(ni(s)!==s)throw Error(t(188))}function qd(s){var l=s.alternate;if(!l){if(l=ni(s),l===null)throw Error(t(188));return l!==s?null:s}for(var u=s,f=l;;){var y=u.return;if(y===null)break;var w=y.alternate;if(w===null){if(f=y.return,f!==null){u=f;continue}break}if(y.child===w.child){for(w=y.child;w;){if(w===u)return ri(y),s;if(w===f)return ri(y),l;w=w.sibling}throw Error(t(188))}if(u.return!==f.return)u=y,f=w;else{for(var E=!1,V=y.child;V;){if(V===u){E=!0,u=y,f=w;break}if(V===f){E=!0,f=y,u=w;break}V=V.sibling}if(!E){for(V=w.child;V;){if(V===u){E=!0,u=w,f=y;break}if(V===f){E=!0,f=w,u=y;break}V=V.sibling}if(!E)throw Error(t(189))}}if(u.alternate!==f)throw Error(t(190))}if(u.tag!==3)throw Error(t(188));return u.stateNode.current===u?s:l}function Wc(s){return s=qd(s),s!==null?$a(s):null}function $a(s){if(s.tag===5||s.tag===6)return s;for(s=s.child;s!==null;){var l=$a(s);if(l!==null)return l;s=s.sibling}return null}var Ga=e.unstable_scheduleCallback,Vc=e.unstable_cancelCallback,Hd=e.unstable_shouldYield,sm=e.unstable_requestPaint,Jt=e.unstable_now,$d=e.unstable_getCurrentPriorityLevel,Ls=e.unstable_ImmediatePriority,Fo=e.unstable_UserBlockingPriority,$r=e.unstable_NormalPriority,Uc=e.unstable_LowPriority,Gd=e.unstable_IdlePriority,Os=null,Fr=null;function Kd(s){if(Fr&&typeof Fr.onCommitFiberRoot=="function")try{Fr.onCommitFiberRoot(Os,s,void 0,(s.current.flags&128)===128)}catch{}}var ur=Math.clz32?Math.clz32:Yd,qc=Math.log,Qd=Math.LN2;function Yd(s){return s>>>=0,s===0?32:31-(qc(s)/Qd|0)|0}var Ka=64,Qa=4194304;function zo(s){switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return s&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return s}}function Ws(s,l){var u=s.pendingLanes;if(u===0)return 0;var f=0,y=s.suspendedLanes,w=s.pingedLanes,E=u&268435455;if(E!==0){var V=E&~y;V!==0?f=zo(V):(w&=E,w!==0&&(f=zo(w)))}else E=u&~y,E!==0?f=zo(E):w!==0&&(f=zo(w));if(f===0)return 0;if(l!==0&&l!==f&&(l&y)===0&&(y=f&-f,w=l&-l,y>=w||y===16&&(w&4194240)!==0))return l;if((f&4)!==0&&(f|=u&16),l=s.entangledLanes,l!==0)for(s=s.entanglements,l&=f;0<l;)u=31-ur(l),y=1<<u,f|=s[u],l&=~y;return f}function am(s,l){switch(s){case 1:case 2:case 4:return l+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return l+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Yi(s,l){for(var u=s.suspendedLanes,f=s.pingedLanes,y=s.expirationTimes,w=s.pendingLanes;0<w;){var E=31-ur(w),V=1<<E,Z=y[E];Z===-1?((V&u)===0||(V&f)!==0)&&(y[E]=am(V,l)):Z<=l&&(s.expiredLanes|=V),w&=~V}}function zr(s){return s=s.pendingLanes&-1073741825,s!==0?s:s&1073741824?1073741824:0}function Vs(){var s=Ka;return Ka<<=1,(Ka&4194240)===0&&(Ka=64),s}function Do(s){for(var l=[],u=0;31>u;u++)l.push(s);return l}function No(s,l,u){s.pendingLanes|=l,l!==536870912&&(s.suspendedLanes=0,s.pingedLanes=0),s=s.eventTimes,l=31-ur(l),s[l]=u}function Kt(s,l){var u=s.pendingLanes&~l;s.pendingLanes=l,s.suspendedLanes=0,s.pingedLanes=0,s.expiredLanes&=l,s.mutableReadLanes&=l,s.entangledLanes&=l,l=s.entanglements;var f=s.eventTimes;for(s=s.expirationTimes;0<u;){var y=31-ur(u),w=1<<y;l[y]=0,f[y]=-1,s[y]=-1,u&=~w}}function Mo(s,l){var u=s.entangledLanes|=l;for(s=s.entanglements;u;){var f=31-ur(u),y=1<<f;y&l|s[f]&l&&(s[f]|=l),u&=~y}}var Rt=0;function Lo(s){return s&=-s,1<s?4<s?(s&268435455)!==0?16:536870912:4:1}var Xd,Ya,Jd,Zd,eh,Hc=!1,ki=[],Gn=null,ii=null,oi=null,Oo=new Map,Gr=new Map,Ti=[],lm="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function th(s,l){switch(s){case"focusin":case"focusout":Gn=null;break;case"dragenter":case"dragleave":ii=null;break;case"mouseover":case"mouseout":oi=null;break;case"pointerover":case"pointerout":Oo.delete(l.pointerId);break;case"gotpointercapture":case"lostpointercapture":Gr.delete(l.pointerId)}}function yr(s,l,u,f,y,w){return s===null||s.nativeEvent!==w?(s={blockedOn:l,domEventName:u,eventSystemFlags:f,nativeEvent:w,targetContainers:[y]},l!==null&&(l=su(l),l!==null&&Ya(l)),s):(s.eventSystemFlags|=f,l=s.targetContainers,y!==null&&l.indexOf(y)===-1&&l.push(y),s)}function cm(s,l,u,f,y){switch(l){case"focusin":return Gn=yr(Gn,s,l,u,f,y),!0;case"dragenter":return ii=yr(ii,s,l,u,f,y),!0;case"mouseover":return oi=yr(oi,s,l,u,f,y),!0;case"pointerover":var w=y.pointerId;return Oo.set(w,yr(Oo.get(w)||null,s,l,u,f,y)),!0;case"gotpointercapture":return w=y.pointerId,Gr.set(w,yr(Gr.get(w)||null,s,l,u,f,y)),!0}return!1}function nh(s){var l=Gs(s.target);if(l!==null){var u=ni(l);if(u!==null){if(l=u.tag,l===13){if(l=Ms(u),l!==null){s.blockedOn=l,eh(s.priority,function(){Jd(u)});return}}else if(l===3&&u.stateNode.current.memoizedState.isDehydrated){s.blockedOn=u.tag===3?u.stateNode.containerInfo:null;return}}}s.blockedOn=null}function Xi(s){if(s.blockedOn!==null)return!1;for(var l=s.targetContainers;0<l.length;){var u=Xa(s.domEventName,s.eventSystemFlags,l[0],s.nativeEvent);if(u===null){u=s.nativeEvent;var f=new u.constructor(u.type,u);ee=f,u.target.dispatchEvent(f),ee=null}else return l=su(u),l!==null&&Ya(l),s.blockedOn=u,!1;l.shift()}return!0}function Us(s,l,u){Xi(s)&&u.delete(l)}function rh(){Hc=!1,Gn!==null&&Xi(Gn)&&(Gn=null),ii!==null&&Xi(ii)&&(ii=null),oi!==null&&Xi(oi)&&(oi=null),Oo.forEach(Us),Gr.forEach(Us)}function si(s,l){s.blockedOn===l&&(s.blockedOn=null,Hc||(Hc=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,rh)))}function ai(s){function l(y){return si(y,s)}if(0<ki.length){si(ki[0],s);for(var u=1;u<ki.length;u++){var f=ki[u];f.blockedOn===s&&(f.blockedOn=null)}}for(Gn!==null&&si(Gn,s),ii!==null&&si(ii,s),oi!==null&&si(oi,s),Oo.forEach(l),Gr.forEach(l),u=0;u<Ti.length;u++)f=Ti[u],f.blockedOn===s&&(f.blockedOn=null);for(;0<Ti.length&&(u=Ti[0],u.blockedOn===null);)nh(u),u.blockedOn===null&&Ti.shift()}var Ji=H.ReactCurrentBatchConfig,Wo=!0;function ln(s,l,u,f){var y=Rt,w=Ji.transition;Ji.transition=null;try{Rt=1,$c(s,l,u,f)}finally{Rt=y,Ji.transition=w}}function um(s,l,u,f){var y=Rt,w=Ji.transition;Ji.transition=null;try{Rt=4,$c(s,l,u,f)}finally{Rt=y,Ji.transition=w}}function $c(s,l,u,f){if(Wo){var y=Xa(s,l,u,f);if(y===null)wm(s,l,f,qs,u),th(s,f);else if(cm(y,s,l,u,f))f.stopPropagation();else if(th(s,f),l&4&&-1<lm.indexOf(s)){for(;y!==null;){var w=su(y);if(w!==null&&Xd(w),w=Xa(s,l,u,f),w===null&&wm(s,l,f,qs,u),w===y)break;y=w}y!==null&&f.stopPropagation()}else wm(s,l,f,null,u)}}var qs=null;function Xa(s,l,u,f){if(qs=null,s=ve(f),s=Gs(s),s!==null)if(l=ni(s),l===null)s=null;else if(u=l.tag,u===13){if(s=Ms(l),s!==null)return s;s=null}else if(u===3){if(l.stateNode.current.memoizedState.isDehydrated)return l.tag===3?l.stateNode.containerInfo:null;s=null}else l!==s&&(s=null);return qs=s,null}function Gc(s){switch(s){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch($d()){case Ls:return 1;case Fo:return 4;case $r:case Uc:return 16;case Gd:return 536870912;default:return 16}default:return 16}}var Dr=null,Ja=null,xr=null;function Kc(){if(xr)return xr;var s,l=Ja,u=l.length,f,y="value"in Dr?Dr.value:Dr.textContent,w=y.length;for(s=0;s<u&&l[s]===y[s];s++);var E=u-s;for(f=1;f<=E&&l[u-f]===y[w-f];f++);return xr=y.slice(s,1<f?1-f:void 0)}function Za(s){var l=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&l===13&&(s=13)):s=l,s===10&&(s=13),32<=s||s===13?s:0}function _i(){return!0}function Qc(){return!1}function Kn(s){function l(u,f,y,w,E){this._reactName=u,this._targetInst=y,this.type=f,this.nativeEvent=w,this.target=E,this.currentTarget=null;for(var V in s)s.hasOwnProperty(V)&&(u=s[V],this[V]=u?u(w):w[V]);return this.isDefaultPrevented=(w.defaultPrevented!=null?w.defaultPrevented:w.returnValue===!1)?_i:Qc,this.isPropagationStopped=Qc,this}return xe(l.prototype,{preventDefault:function(){this.defaultPrevented=!0;var u=this.nativeEvent;u&&(u.preventDefault?u.preventDefault():typeof u.returnValue!="unknown"&&(u.returnValue=!1),this.isDefaultPrevented=_i)},stopPropagation:function(){var u=this.nativeEvent;u&&(u.stopPropagation?u.stopPropagation():typeof u.cancelBubble!="unknown"&&(u.cancelBubble=!0),this.isPropagationStopped=_i)},persist:function(){},isPersistent:_i}),l}var li={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},el=Kn(li),ji=xe({},li,{view:0,detail:0}),dm=Kn(ji),tl,Zi,Vo,Hs=xe({},ji,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ii,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==Vo&&(Vo&&s.type==="mousemove"?(tl=s.screenX-Vo.screenX,Zi=s.screenY-Vo.screenY):Zi=tl=0,Vo=s),tl)},movementY:function(s){return"movementY"in s?s.movementY:Zi}}),nl=Kn(Hs),Yc=xe({},Hs,{dataTransfer:0}),ih=Kn(Yc),rl=xe({},ji,{relatedTarget:0}),il=Kn(rl),oh=xe({},li,{animationName:0,elapsedTime:0,pseudoElement:0}),eo=Kn(oh),sh=xe({},li,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),ah=Kn(sh),lh=xe({},li,{data:0}),Xc=Kn(lh),ol={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},dr={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ch={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function uh(s){var l=this.nativeEvent;return l.getModifierState?l.getModifierState(s):(s=ch[s])?!!l[s]:!1}function Ii(){return uh}var p=xe({},ji,{key:function(s){if(s.key){var l=ol[s.key]||s.key;if(l!=="Unidentified")return l}return s.type==="keypress"?(s=Za(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?dr[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ii,charCode:function(s){return s.type==="keypress"?Za(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?Za(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),b=Kn(p),k=xe({},Hs,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),N=Kn(k),de=xe({},ji,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ii}),we=Kn(de),Oe=xe({},li,{propertyName:0,elapsedTime:0,pseudoElement:0}),Vt=Kn(Oe),In=xe({},Hs,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),At=Kn(In),Dn=[9,13,27,32],Tn=d&&"CompositionEvent"in window,Kr=null;d&&"documentMode"in document&&(Kr=document.documentMode);var Nr=d&&"TextEvent"in window&&!Kr,$s=d&&(!Tn||Kr&&8<Kr&&11>=Kr),sl=" ",q0=!1;function H0(s,l){switch(s){case"keyup":return Dn.indexOf(l.keyCode)!==-1;case"keydown":return l.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function $0(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var al=!1;function HI(s,l){switch(s){case"compositionend":return $0(l);case"keypress":return l.which!==32?null:(q0=!0,sl);case"textInput":return s=l.data,s===sl&&q0?null:s;default:return null}}function $I(s,l){if(al)return s==="compositionend"||!Tn&&H0(s,l)?(s=Kc(),xr=Ja=Dr=null,al=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(l.ctrlKey||l.altKey||l.metaKey)||l.ctrlKey&&l.altKey){if(l.char&&1<l.char.length)return l.char;if(l.which)return String.fromCharCode(l.which)}return null;case"compositionend":return $s&&l.locale!=="ko"?null:l.data;default:return null}}var GI={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function G0(s){var l=s&&s.nodeName&&s.nodeName.toLowerCase();return l==="input"?!!GI[s.type]:l==="textarea"}function K0(s,l,u,f){gt(f),l=mh(l,"onChange"),0<l.length&&(u=new el("onChange","change",null,u,f),s.push({event:u,listeners:l}))}var Jc=null,Zc=null;function KI(s){hb(s,0)}function dh(s){var l=hl(s);if(ae(l))return s}function QI(s,l){if(s==="change")return l}var Q0=!1;if(d){var hm;if(d){var pm="oninput"in document;if(!pm){var Y0=document.createElement("div");Y0.setAttribute("oninput","return;"),pm=typeof Y0.oninput=="function"}hm=pm}else hm=!1;Q0=hm&&(!document.documentMode||9<document.documentMode)}function X0(){Jc&&(Jc.detachEvent("onpropertychange",J0),Zc=Jc=null)}function J0(s){if(s.propertyName==="value"&&dh(Zc)){var l=[];K0(l,Zc,s,ve(s)),Br(KI,l)}}function YI(s,l,u){s==="focusin"?(X0(),Jc=l,Zc=u,Jc.attachEvent("onpropertychange",J0)):s==="focusout"&&X0()}function XI(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return dh(Zc)}function JI(s,l){if(s==="click")return dh(l)}function ZI(s,l){if(s==="input"||s==="change")return dh(l)}function eC(s,l){return s===l&&(s!==0||1/s===1/l)||s!==s&&l!==l}var ci=typeof Object.is=="function"?Object.is:eC;function eu(s,l){if(ci(s,l))return!0;if(typeof s!="object"||s===null||typeof l!="object"||l===null)return!1;var u=Object.keys(s),f=Object.keys(l);if(u.length!==f.length)return!1;for(f=0;f<u.length;f++){var y=u[f];if(!h.call(l,y)||!ci(s[y],l[y]))return!1}return!0}function Z0(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function eb(s,l){var u=Z0(s);s=0;for(var f;u;){if(u.nodeType===3){if(f=s+u.textContent.length,s<=l&&f>=l)return{node:u,offset:l-s};s=f}e:{for(;u;){if(u.nextSibling){u=u.nextSibling;break e}u=u.parentNode}u=void 0}u=Z0(u)}}function tb(s,l){return s&&l?s===l?!0:s&&s.nodeType===3?!1:l&&l.nodeType===3?tb(s,l.parentNode):"contains"in s?s.contains(l):s.compareDocumentPosition?!!(s.compareDocumentPosition(l)&16):!1:!1}function nb(){for(var s=window,l=rt();l instanceof s.HTMLIFrameElement;){try{var u=typeof l.contentWindow.location.href=="string"}catch{u=!1}if(u)s=l.contentWindow;else break;l=rt(s.document)}return l}function fm(s){var l=s&&s.nodeName&&s.nodeName.toLowerCase();return l&&(l==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||l==="textarea"||s.contentEditable==="true")}function tC(s){var l=nb(),u=s.focusedElem,f=s.selectionRange;if(l!==u&&u&&u.ownerDocument&&tb(u.ownerDocument.documentElement,u)){if(f!==null&&fm(u)){if(l=f.start,s=f.end,s===void 0&&(s=l),"selectionStart"in u)u.selectionStart=l,u.selectionEnd=Math.min(s,u.value.length);else if(s=(l=u.ownerDocument||document)&&l.defaultView||window,s.getSelection){s=s.getSelection();var y=u.textContent.length,w=Math.min(f.start,y);f=f.end===void 0?w:Math.min(f.end,y),!s.extend&&w>f&&(y=f,f=w,w=y),y=eb(u,w);var E=eb(u,f);y&&E&&(s.rangeCount!==1||s.anchorNode!==y.node||s.anchorOffset!==y.offset||s.focusNode!==E.node||s.focusOffset!==E.offset)&&(l=l.createRange(),l.setStart(y.node,y.offset),s.removeAllRanges(),w>f?(s.addRange(l),s.extend(E.node,E.offset)):(l.setEnd(E.node,E.offset),s.addRange(l)))}}for(l=[],s=u;s=s.parentNode;)s.nodeType===1&&l.push({element:s,left:s.scrollLeft,top:s.scrollTop});for(typeof u.focus=="function"&&u.focus(),u=0;u<l.length;u++)s=l[u],s.element.scrollLeft=s.left,s.element.scrollTop=s.top}}var nC=d&&"documentMode"in document&&11>=document.documentMode,ll=null,mm=null,tu=null,gm=!1;function rb(s,l,u){var f=u.window===u?u.document:u.nodeType===9?u:u.ownerDocument;gm||ll==null||ll!==rt(f)||(f=ll,"selectionStart"in f&&fm(f)?f={start:f.selectionStart,end:f.selectionEnd}:(f=(f.ownerDocument&&f.ownerDocument.defaultView||window).getSelection(),f={anchorNode:f.anchorNode,anchorOffset:f.anchorOffset,focusNode:f.focusNode,focusOffset:f.focusOffset}),tu&&eu(tu,f)||(tu=f,f=mh(mm,"onSelect"),0<f.length&&(l=new el("onSelect","select",null,l,u),s.push({event:l,listeners:f}),l.target=ll)))}function hh(s,l){var u={};return u[s.toLowerCase()]=l.toLowerCase(),u["Webkit"+s]="webkit"+l,u["Moz"+s]="moz"+l,u}var cl={animationend:hh("Animation","AnimationEnd"),animationiteration:hh("Animation","AnimationIteration"),animationstart:hh("Animation","AnimationStart"),transitionend:hh("Transition","TransitionEnd")},ym={},ib={};d&&(ib=document.createElement("div").style,"AnimationEvent"in window||(delete cl.animationend.animation,delete cl.animationiteration.animation,delete cl.animationstart.animation),"TransitionEvent"in window||delete cl.transitionend.transition);function ph(s){if(ym[s])return ym[s];if(!cl[s])return s;var l=cl[s],u;for(u in l)if(l.hasOwnProperty(u)&&u in ib)return ym[s]=l[u];return s}var ob=ph("animationend"),sb=ph("animationiteration"),ab=ph("animationstart"),lb=ph("transitionend"),cb=new Map,ub="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Uo(s,l){cb.set(s,l),a(l,[s])}for(var xm=0;xm<ub.length;xm++){var bm=ub[xm],rC=bm.toLowerCase(),iC=bm[0].toUpperCase()+bm.slice(1);Uo(rC,"on"+iC)}Uo(ob,"onAnimationEnd"),Uo(sb,"onAnimationIteration"),Uo(ab,"onAnimationStart"),Uo("dblclick","onDoubleClick"),Uo("focusin","onFocus"),Uo("focusout","onBlur"),Uo(lb,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),a("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),a("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),a("onBeforeInput",["compositionend","keypress","textInput","paste"]),a("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var nu="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),oC=new Set("cancel close invalid load scroll toggle".split(" ").concat(nu));function db(s,l,u){var f=s.type||"unknown-event";s.currentTarget=u,Ud(f,l,void 0,s),s.currentTarget=null}function hb(s,l){l=(l&4)!==0;for(var u=0;u<s.length;u++){var f=s[u],y=f.event;f=f.listeners;e:{var w=void 0;if(l)for(var E=f.length-1;0<=E;E--){var V=f[E],Z=V.instance,ge=V.currentTarget;if(V=V.listener,Z!==w&&y.isPropagationStopped())break e;db(y,V,ge),w=Z}else for(E=0;E<f.length;E++){if(V=f[E],Z=V.instance,ge=V.currentTarget,V=V.listener,Z!==w&&y.isPropagationStopped())break e;db(y,V,ge),w=Z}}}if(cr)throw s=Qi,cr=!1,Qi=null,s}function nn(s,l){var u=l[Im];u===void 0&&(u=l[Im]=new Set);var f=s+"__bubble";u.has(f)||(pb(l,s,2,!1),u.add(f))}function vm(s,l,u){var f=0;l&&(f|=4),pb(u,s,f,l)}var fh="_reactListening"+Math.random().toString(36).slice(2);function ru(s){if(!s[fh]){s[fh]=!0,r.forEach(function(u){u!=="selectionchange"&&(oC.has(u)||vm(u,!1,s),vm(u,!0,s))});var l=s.nodeType===9?s:s.ownerDocument;l===null||l[fh]||(l[fh]=!0,vm("selectionchange",!1,l))}}function pb(s,l,u,f){switch(Gc(l)){case 1:var y=ln;break;case 4:y=um;break;default:y=$c}u=y.bind(null,l,u,s),y=void 0,!Gt||l!=="touchstart"&&l!=="touchmove"&&l!=="wheel"||(y=!0),f?y!==void 0?s.addEventListener(l,u,{capture:!0,passive:y}):s.addEventListener(l,u,!0):y!==void 0?s.addEventListener(l,u,{passive:y}):s.addEventListener(l,u,!1)}function wm(s,l,u,f,y){var w=f;if((l&1)===0&&(l&2)===0&&f!==null)e:for(;;){if(f===null)return;var E=f.tag;if(E===3||E===4){var V=f.stateNode.containerInfo;if(V===y||V.nodeType===8&&V.parentNode===y)break;if(E===4)for(E=f.return;E!==null;){var Z=E.tag;if((Z===3||Z===4)&&(Z=E.stateNode.containerInfo,Z===y||Z.nodeType===8&&Z.parentNode===y))return;E=E.return}for(;V!==null;){if(E=Gs(V),E===null)return;if(Z=E.tag,Z===5||Z===6){f=w=E;continue e}V=V.parentNode}}f=f.return}Br(function(){var ge=w,Be=ve(u),Fe=[];e:{var Ae=cb.get(s);if(Ae!==void 0){var Xe=el,tt=s;switch(s){case"keypress":if(Za(u)===0)break e;case"keydown":case"keyup":Xe=b;break;case"focusin":tt="focus",Xe=il;break;case"focusout":tt="blur",Xe=il;break;case"beforeblur":case"afterblur":Xe=il;break;case"click":if(u.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Xe=nl;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Xe=ih;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Xe=we;break;case ob:case sb:case ab:Xe=eo;break;case lb:Xe=Vt;break;case"scroll":Xe=dm;break;case"wheel":Xe=At;break;case"copy":case"cut":case"paste":Xe=ah;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Xe=N}var it=(l&4)!==0,wn=!it&&s==="scroll",he=it?Ae!==null?Ae+"Capture":null:Ae;it=[];for(var re=ge,pe;re!==null;){pe=re;var Ne=pe.stateNode;if(pe.tag===5&&Ne!==null&&(pe=Ne,he!==null&&(Ne=Xt(re,he),Ne!=null&&it.push(iu(re,Ne,pe)))),wn)break;re=re.return}0<it.length&&(Ae=new Xe(Ae,tt,null,u,Be),Fe.push({event:Ae,listeners:it}))}}if((l&7)===0){e:{if(Ae=s==="mouseover"||s==="pointerover",Xe=s==="mouseout"||s==="pointerout",Ae&&u!==ee&&(tt=u.relatedTarget||u.fromElement)&&(Gs(tt)||tt[to]))break e;if((Xe||Ae)&&(Ae=Be.window===Be?Be:(Ae=Be.ownerDocument)?Ae.defaultView||Ae.parentWindow:window,Xe?(tt=u.relatedTarget||u.toElement,Xe=ge,tt=tt?Gs(tt):null,tt!==null&&(wn=ni(tt),tt!==wn||tt.tag!==5&&tt.tag!==6)&&(tt=null)):(Xe=null,tt=ge),Xe!==tt)){if(it=nl,Ne="onMouseLeave",he="onMouseEnter",re="mouse",(s==="pointerout"||s==="pointerover")&&(it=N,Ne="onPointerLeave",he="onPointerEnter",re="pointer"),wn=Xe==null?Ae:hl(Xe),pe=tt==null?Ae:hl(tt),Ae=new it(Ne,re+"leave",Xe,u,Be),Ae.target=wn,Ae.relatedTarget=pe,Ne=null,Gs(Be)===ge&&(it=new it(he,re+"enter",tt,u,Be),it.target=pe,it.relatedTarget=wn,Ne=it),wn=Ne,Xe&&tt)t:{for(it=Xe,he=tt,re=0,pe=it;pe;pe=ul(pe))re++;for(pe=0,Ne=he;Ne;Ne=ul(Ne))pe++;for(;0<re-pe;)it=ul(it),re--;for(;0<pe-re;)he=ul(he),pe--;for(;re--;){if(it===he||he!==null&&it===he.alternate)break t;it=ul(it),he=ul(he)}it=null}else it=null;Xe!==null&&fb(Fe,Ae,Xe,it,!1),tt!==null&&wn!==null&&fb(Fe,wn,tt,it,!0)}}e:{if(Ae=ge?hl(ge):window,Xe=Ae.nodeName&&Ae.nodeName.toLowerCase(),Xe==="select"||Xe==="input"&&Ae.type==="file")var ot=QI;else if(G0(Ae))if(Q0)ot=ZI;else{ot=XI;var lt=YI}else(Xe=Ae.nodeName)&&Xe.toLowerCase()==="input"&&(Ae.type==="checkbox"||Ae.type==="radio")&&(ot=JI);if(ot&&(ot=ot(s,ge))){K0(Fe,ot,u,Be);break e}lt&&lt(s,Ae,ge),s==="focusout"&&(lt=Ae._wrapperState)&&lt.controlled&&Ae.type==="number"&&ze(Ae,"number",Ae.value)}switch(lt=ge?hl(ge):window,s){case"focusin":(G0(lt)||lt.contentEditable==="true")&&(ll=lt,mm=ge,tu=null);break;case"focusout":tu=mm=ll=null;break;case"mousedown":gm=!0;break;case"contextmenu":case"mouseup":case"dragend":gm=!1,rb(Fe,u,Be);break;case"selectionchange":if(nC)break;case"keydown":case"keyup":rb(Fe,u,Be)}var ct;if(Tn)e:{switch(s){case"compositionstart":var ft="onCompositionStart";break e;case"compositionend":ft="onCompositionEnd";break e;case"compositionupdate":ft="onCompositionUpdate";break e}ft=void 0}else al?H0(s,u)&&(ft="onCompositionEnd"):s==="keydown"&&u.keyCode===229&&(ft="onCompositionStart");ft&&($s&&u.locale!=="ko"&&(al||ft!=="onCompositionStart"?ft==="onCompositionEnd"&&al&&(ct=Kc()):(Dr=Be,Ja="value"in Dr?Dr.value:Dr.textContent,al=!0)),lt=mh(ge,ft),0<lt.length&&(ft=new Xc(ft,s,null,u,Be),Fe.push({event:ft,listeners:lt}),ct?ft.data=ct:(ct=$0(u),ct!==null&&(ft.data=ct)))),(ct=Nr?HI(s,u):$I(s,u))&&(ge=mh(ge,"onBeforeInput"),0<ge.length&&(Be=new Xc("onBeforeInput","beforeinput",null,u,Be),Fe.push({event:Be,listeners:ge}),Be.data=ct))}hb(Fe,l)})}function iu(s,l,u){return{instance:s,listener:l,currentTarget:u}}function mh(s,l){for(var u=l+"Capture",f=[];s!==null;){var y=s,w=y.stateNode;y.tag===5&&w!==null&&(y=w,w=Xt(s,u),w!=null&&f.unshift(iu(s,w,y)),w=Xt(s,l),w!=null&&f.push(iu(s,w,y))),s=s.return}return f}function ul(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5);return s||null}function fb(s,l,u,f,y){for(var w=l._reactName,E=[];u!==null&&u!==f;){var V=u,Z=V.alternate,ge=V.stateNode;if(Z!==null&&Z===f)break;V.tag===5&&ge!==null&&(V=ge,y?(Z=Xt(u,w),Z!=null&&E.unshift(iu(u,Z,V))):y||(Z=Xt(u,w),Z!=null&&E.push(iu(u,Z,V)))),u=u.return}E.length!==0&&s.push({event:l,listeners:E})}var sC=/\r\n?/g,aC=/\u0000|\uFFFD/g;function mb(s){return(typeof s=="string"?s:""+s).replace(sC,`
`).replace(aC,"")}function gh(s,l,u){if(l=mb(l),mb(s)!==l&&u)throw Error(t(425))}function yh(){}var Sm=null,km=null;function Tm(s,l){return s==="textarea"||s==="noscript"||typeof l.children=="string"||typeof l.children=="number"||typeof l.dangerouslySetInnerHTML=="object"&&l.dangerouslySetInnerHTML!==null&&l.dangerouslySetInnerHTML.__html!=null}var _m=typeof setTimeout=="function"?setTimeout:void 0,lC=typeof clearTimeout=="function"?clearTimeout:void 0,gb=typeof Promise=="function"?Promise:void 0,cC=typeof queueMicrotask=="function"?queueMicrotask:typeof gb<"u"?function(s){return gb.resolve(null).then(s).catch(uC)}:_m;function uC(s){setTimeout(function(){throw s})}function jm(s,l){var u=l,f=0;do{var y=u.nextSibling;if(s.removeChild(u),y&&y.nodeType===8)if(u=y.data,u==="/$"){if(f===0){s.removeChild(y),ai(l);return}f--}else u!=="$"&&u!=="$?"&&u!=="$!"||f++;u=y}while(u);ai(l)}function qo(s){for(;s!=null;s=s.nextSibling){var l=s.nodeType;if(l===1||l===3)break;if(l===8){if(l=s.data,l==="$"||l==="$!"||l==="$?")break;if(l==="/$")return null}}return s}function yb(s){s=s.previousSibling;for(var l=0;s;){if(s.nodeType===8){var u=s.data;if(u==="$"||u==="$!"||u==="$?"){if(l===0)return s;l--}else u==="/$"&&l++}s=s.previousSibling}return null}var dl=Math.random().toString(36).slice(2),Ci="__reactFiber$"+dl,ou="__reactProps$"+dl,to="__reactContainer$"+dl,Im="__reactEvents$"+dl,dC="__reactListeners$"+dl,hC="__reactHandles$"+dl;function Gs(s){var l=s[Ci];if(l)return l;for(var u=s.parentNode;u;){if(l=u[to]||u[Ci]){if(u=l.alternate,l.child!==null||u!==null&&u.child!==null)for(s=yb(s);s!==null;){if(u=s[Ci])return u;s=yb(s)}return l}s=u,u=s.parentNode}return null}function su(s){return s=s[Ci]||s[to],!s||s.tag!==5&&s.tag!==6&&s.tag!==13&&s.tag!==3?null:s}function hl(s){if(s.tag===5||s.tag===6)return s.stateNode;throw Error(t(33))}function xh(s){return s[ou]||null}var Cm=[],pl=-1;function Ho(s){return{current:s}}function rn(s){0>pl||(s.current=Cm[pl],Cm[pl]=null,pl--)}function Zt(s,l){pl++,Cm[pl]=s.current,s.current=l}var $o={},Zn=Ho($o),br=Ho(!1),Ks=$o;function fl(s,l){var u=s.type.contextTypes;if(!u)return $o;var f=s.stateNode;if(f&&f.__reactInternalMemoizedUnmaskedChildContext===l)return f.__reactInternalMemoizedMaskedChildContext;var y={},w;for(w in u)y[w]=l[w];return f&&(s=s.stateNode,s.__reactInternalMemoizedUnmaskedChildContext=l,s.__reactInternalMemoizedMaskedChildContext=y),y}function vr(s){return s=s.childContextTypes,s!=null}function bh(){rn(br),rn(Zn)}function xb(s,l,u){if(Zn.current!==$o)throw Error(t(168));Zt(Zn,l),Zt(br,u)}function bb(s,l,u){var f=s.stateNode;if(l=l.childContextTypes,typeof f.getChildContext!="function")return u;f=f.getChildContext();for(var y in f)if(!(y in l))throw Error(t(108,Ie(s)||"Unknown",y));return xe({},u,f)}function vh(s){return s=(s=s.stateNode)&&s.__reactInternalMemoizedMergedChildContext||$o,Ks=Zn.current,Zt(Zn,s),Zt(br,br.current),!0}function vb(s,l,u){var f=s.stateNode;if(!f)throw Error(t(169));u?(s=bb(s,l,Ks),f.__reactInternalMemoizedMergedChildContext=s,rn(br),rn(Zn),Zt(Zn,s)):rn(br),Zt(br,u)}var no=null,wh=!1,Rm=!1;function wb(s){no===null?no=[s]:no.push(s)}function pC(s){wh=!0,wb(s)}function Go(){if(!Rm&&no!==null){Rm=!0;var s=0,l=Rt;try{var u=no;for(Rt=1;s<u.length;s++){var f=u[s];do f=f(!0);while(f!==null)}no=null,wh=!1}catch(y){throw no!==null&&(no=no.slice(s+1)),Ga(Ls,Go),y}finally{Rt=l,Rm=!1}}return null}var ml=[],gl=0,Sh=null,kh=0,Qr=[],Yr=0,Qs=null,ro=1,io="";function Ys(s,l){ml[gl++]=kh,ml[gl++]=Sh,Sh=s,kh=l}function Sb(s,l,u){Qr[Yr++]=ro,Qr[Yr++]=io,Qr[Yr++]=Qs,Qs=s;var f=ro;s=io;var y=32-ur(f)-1;f&=~(1<<y),u+=1;var w=32-ur(l)+y;if(30<w){var E=y-y%5;w=(f&(1<<E)-1).toString(32),f>>=E,y-=E,ro=1<<32-ur(l)+y|u<<y|f,io=w+s}else ro=1<<w|u<<y|f,io=s}function Em(s){s.return!==null&&(Ys(s,1),Sb(s,1,0))}function Am(s){for(;s===Sh;)Sh=ml[--gl],ml[gl]=null,kh=ml[--gl],ml[gl]=null;for(;s===Qs;)Qs=Qr[--Yr],Qr[Yr]=null,io=Qr[--Yr],Qr[Yr]=null,ro=Qr[--Yr],Qr[Yr]=null}var Mr=null,Lr=null,cn=!1,ui=null;function kb(s,l){var u=ei(5,null,null,0);u.elementType="DELETED",u.stateNode=l,u.return=s,l=s.deletions,l===null?(s.deletions=[u],s.flags|=16):l.push(u)}function Tb(s,l){switch(s.tag){case 5:var u=s.type;return l=l.nodeType!==1||u.toLowerCase()!==l.nodeName.toLowerCase()?null:l,l!==null?(s.stateNode=l,Mr=s,Lr=qo(l.firstChild),!0):!1;case 6:return l=s.pendingProps===""||l.nodeType!==3?null:l,l!==null?(s.stateNode=l,Mr=s,Lr=null,!0):!1;case 13:return l=l.nodeType!==8?null:l,l!==null?(u=Qs!==null?{id:ro,overflow:io}:null,s.memoizedState={dehydrated:l,treeContext:u,retryLane:1073741824},u=ei(18,null,null,0),u.stateNode=l,u.return=s,s.child=u,Mr=s,Lr=null,!0):!1;default:return!1}}function Pm(s){return(s.mode&1)!==0&&(s.flags&128)===0}function Bm(s){if(cn){var l=Lr;if(l){var u=l;if(!Tb(s,l)){if(Pm(s))throw Error(t(418));l=qo(u.nextSibling);var f=Mr;l&&Tb(s,l)?kb(f,u):(s.flags=s.flags&-4097|2,cn=!1,Mr=s)}}else{if(Pm(s))throw Error(t(418));s.flags=s.flags&-4097|2,cn=!1,Mr=s}}}function _b(s){for(s=s.return;s!==null&&s.tag!==5&&s.tag!==3&&s.tag!==13;)s=s.return;Mr=s}function Th(s){if(s!==Mr)return!1;if(!cn)return _b(s),cn=!0,!1;var l;if((l=s.tag!==3)&&!(l=s.tag!==5)&&(l=s.type,l=l!=="head"&&l!=="body"&&!Tm(s.type,s.memoizedProps)),l&&(l=Lr)){if(Pm(s))throw jb(),Error(t(418));for(;l;)kb(s,l),l=qo(l.nextSibling)}if(_b(s),s.tag===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(t(317));e:{for(s=s.nextSibling,l=0;s;){if(s.nodeType===8){var u=s.data;if(u==="/$"){if(l===0){Lr=qo(s.nextSibling);break e}l--}else u!=="$"&&u!=="$!"&&u!=="$?"||l++}s=s.nextSibling}Lr=null}}else Lr=Mr?qo(s.stateNode.nextSibling):null;return!0}function jb(){for(var s=Lr;s;)s=qo(s.nextSibling)}function yl(){Lr=Mr=null,cn=!1}function Fm(s){ui===null?ui=[s]:ui.push(s)}var fC=H.ReactCurrentBatchConfig;function au(s,l,u){if(s=u.ref,s!==null&&typeof s!="function"&&typeof s!="object"){if(u._owner){if(u=u._owner,u){if(u.tag!==1)throw Error(t(309));var f=u.stateNode}if(!f)throw Error(t(147,s));var y=f,w=""+s;return l!==null&&l.ref!==null&&typeof l.ref=="function"&&l.ref._stringRef===w?l.ref:(l=function(E){var V=y.refs;E===null?delete V[w]:V[w]=E},l._stringRef=w,l)}if(typeof s!="string")throw Error(t(284));if(!u._owner)throw Error(t(290,s))}return s}function _h(s,l){throw s=Object.prototype.toString.call(l),Error(t(31,s==="[object Object]"?"object with keys {"+Object.keys(l).join(", ")+"}":s))}function Ib(s){var l=s._init;return l(s._payload)}function Cb(s){function l(he,re){if(s){var pe=he.deletions;pe===null?(he.deletions=[re],he.flags|=16):pe.push(re)}}function u(he,re){if(!s)return null;for(;re!==null;)l(he,re),re=re.sibling;return null}function f(he,re){for(he=new Map;re!==null;)re.key!==null?he.set(re.key,re):he.set(re.index,re),re=re.sibling;return he}function y(he,re){return he=ts(he,re),he.index=0,he.sibling=null,he}function w(he,re,pe){return he.index=pe,s?(pe=he.alternate,pe!==null?(pe=pe.index,pe<re?(he.flags|=2,re):pe):(he.flags|=2,re)):(he.flags|=1048576,re)}function E(he){return s&&he.alternate===null&&(he.flags|=2),he}function V(he,re,pe,Ne){return re===null||re.tag!==6?(re=_g(pe,he.mode,Ne),re.return=he,re):(re=y(re,pe),re.return=he,re)}function Z(he,re,pe,Ne){var ot=pe.type;return ot===L?Be(he,re,pe.props.children,Ne,pe.key):re!==null&&(re.elementType===ot||typeof ot=="object"&&ot!==null&&ot.$$typeof===X&&Ib(ot)===re.type)?(Ne=y(re,pe.props),Ne.ref=au(he,re,pe),Ne.return=he,Ne):(Ne=Qh(pe.type,pe.key,pe.props,null,he.mode,Ne),Ne.ref=au(he,re,pe),Ne.return=he,Ne)}function ge(he,re,pe,Ne){return re===null||re.tag!==4||re.stateNode.containerInfo!==pe.containerInfo||re.stateNode.implementation!==pe.implementation?(re=jg(pe,he.mode,Ne),re.return=he,re):(re=y(re,pe.children||[]),re.return=he,re)}function Be(he,re,pe,Ne,ot){return re===null||re.tag!==7?(re=ia(pe,he.mode,Ne,ot),re.return=he,re):(re=y(re,pe),re.return=he,re)}function Fe(he,re,pe){if(typeof re=="string"&&re!==""||typeof re=="number")return re=_g(""+re,he.mode,pe),re.return=he,re;if(typeof re=="object"&&re!==null){switch(re.$$typeof){case J:return pe=Qh(re.type,re.key,re.props,null,he.mode,pe),pe.ref=au(he,null,re),pe.return=he,pe;case O:return re=jg(re,he.mode,pe),re.return=he,re;case X:var Ne=re._init;return Fe(he,Ne(re._payload),pe)}if(De(re)||te(re))return re=ia(re,he.mode,pe,null),re.return=he,re;_h(he,re)}return null}function Ae(he,re,pe,Ne){var ot=re!==null?re.key:null;if(typeof pe=="string"&&pe!==""||typeof pe=="number")return ot!==null?null:V(he,re,""+pe,Ne);if(typeof pe=="object"&&pe!==null){switch(pe.$$typeof){case J:return pe.key===ot?Z(he,re,pe,Ne):null;case O:return pe.key===ot?ge(he,re,pe,Ne):null;case X:return ot=pe._init,Ae(he,re,ot(pe._payload),Ne)}if(De(pe)||te(pe))return ot!==null?null:Be(he,re,pe,Ne,null);_h(he,pe)}return null}function Xe(he,re,pe,Ne,ot){if(typeof Ne=="string"&&Ne!==""||typeof Ne=="number")return he=he.get(pe)||null,V(re,he,""+Ne,ot);if(typeof Ne=="object"&&Ne!==null){switch(Ne.$$typeof){case J:return he=he.get(Ne.key===null?pe:Ne.key)||null,Z(re,he,Ne,ot);case O:return he=he.get(Ne.key===null?pe:Ne.key)||null,ge(re,he,Ne,ot);case X:var lt=Ne._init;return Xe(he,re,pe,lt(Ne._payload),ot)}if(De(Ne)||te(Ne))return he=he.get(pe)||null,Be(re,he,Ne,ot,null);_h(re,Ne)}return null}function tt(he,re,pe,Ne){for(var ot=null,lt=null,ct=re,ft=re=0,Ln=null;ct!==null&&ft<pe.length;ft++){ct.index>ft?(Ln=ct,ct=null):Ln=ct.sibling;var Nt=Ae(he,ct,pe[ft],Ne);if(Nt===null){ct===null&&(ct=Ln);break}s&&ct&&Nt.alternate===null&&l(he,ct),re=w(Nt,re,ft),lt===null?ot=Nt:lt.sibling=Nt,lt=Nt,ct=Ln}if(ft===pe.length)return u(he,ct),cn&&Ys(he,ft),ot;if(ct===null){for(;ft<pe.length;ft++)ct=Fe(he,pe[ft],Ne),ct!==null&&(re=w(ct,re,ft),lt===null?ot=ct:lt.sibling=ct,lt=ct);return cn&&Ys(he,ft),ot}for(ct=f(he,ct);ft<pe.length;ft++)Ln=Xe(ct,he,ft,pe[ft],Ne),Ln!==null&&(s&&Ln.alternate!==null&&ct.delete(Ln.key===null?ft:Ln.key),re=w(Ln,re,ft),lt===null?ot=Ln:lt.sibling=Ln,lt=Ln);return s&&ct.forEach(function(ns){return l(he,ns)}),cn&&Ys(he,ft),ot}function it(he,re,pe,Ne){var ot=te(pe);if(typeof ot!="function")throw Error(t(150));if(pe=ot.call(pe),pe==null)throw Error(t(151));for(var lt=ot=null,ct=re,ft=re=0,Ln=null,Nt=pe.next();ct!==null&&!Nt.done;ft++,Nt=pe.next()){ct.index>ft?(Ln=ct,ct=null):Ln=ct.sibling;var ns=Ae(he,ct,Nt.value,Ne);if(ns===null){ct===null&&(ct=Ln);break}s&&ct&&ns.alternate===null&&l(he,ct),re=w(ns,re,ft),lt===null?ot=ns:lt.sibling=ns,lt=ns,ct=Ln}if(Nt.done)return u(he,ct),cn&&Ys(he,ft),ot;if(ct===null){for(;!Nt.done;ft++,Nt=pe.next())Nt=Fe(he,Nt.value,Ne),Nt!==null&&(re=w(Nt,re,ft),lt===null?ot=Nt:lt.sibling=Nt,lt=Nt);return cn&&Ys(he,ft),ot}for(ct=f(he,ct);!Nt.done;ft++,Nt=pe.next())Nt=Xe(ct,he,ft,Nt.value,Ne),Nt!==null&&(s&&Nt.alternate!==null&&ct.delete(Nt.key===null?ft:Nt.key),re=w(Nt,re,ft),lt===null?ot=Nt:lt.sibling=Nt,lt=Nt);return s&&ct.forEach(function(GC){return l(he,GC)}),cn&&Ys(he,ft),ot}function wn(he,re,pe,Ne){if(typeof pe=="object"&&pe!==null&&pe.type===L&&pe.key===null&&(pe=pe.props.children),typeof pe=="object"&&pe!==null){switch(pe.$$typeof){case J:e:{for(var ot=pe.key,lt=re;lt!==null;){if(lt.key===ot){if(ot=pe.type,ot===L){if(lt.tag===7){u(he,lt.sibling),re=y(lt,pe.props.children),re.return=he,he=re;break e}}else if(lt.elementType===ot||typeof ot=="object"&&ot!==null&&ot.$$typeof===X&&Ib(ot)===lt.type){u(he,lt.sibling),re=y(lt,pe.props),re.ref=au(he,lt,pe),re.return=he,he=re;break e}u(he,lt);break}else l(he,lt);lt=lt.sibling}pe.type===L?(re=ia(pe.props.children,he.mode,Ne,pe.key),re.return=he,he=re):(Ne=Qh(pe.type,pe.key,pe.props,null,he.mode,Ne),Ne.ref=au(he,re,pe),Ne.return=he,he=Ne)}return E(he);case O:e:{for(lt=pe.key;re!==null;){if(re.key===lt)if(re.tag===4&&re.stateNode.containerInfo===pe.containerInfo&&re.stateNode.implementation===pe.implementation){u(he,re.sibling),re=y(re,pe.children||[]),re.return=he,he=re;break e}else{u(he,re);break}else l(he,re);re=re.sibling}re=jg(pe,he.mode,Ne),re.return=he,he=re}return E(he);case X:return lt=pe._init,wn(he,re,lt(pe._payload),Ne)}if(De(pe))return tt(he,re,pe,Ne);if(te(pe))return it(he,re,pe,Ne);_h(he,pe)}return typeof pe=="string"&&pe!==""||typeof pe=="number"?(pe=""+pe,re!==null&&re.tag===6?(u(he,re.sibling),re=y(re,pe),re.return=he,he=re):(u(he,re),re=_g(pe,he.mode,Ne),re.return=he,he=re),E(he)):u(he,re)}return wn}var xl=Cb(!0),Rb=Cb(!1),jh=Ho(null),Ih=null,bl=null,zm=null;function Dm(){zm=bl=Ih=null}function Nm(s){var l=jh.current;rn(jh),s._currentValue=l}function Mm(s,l,u){for(;s!==null;){var f=s.alternate;if((s.childLanes&l)!==l?(s.childLanes|=l,f!==null&&(f.childLanes|=l)):f!==null&&(f.childLanes&l)!==l&&(f.childLanes|=l),s===u)break;s=s.return}}function vl(s,l){Ih=s,zm=bl=null,s=s.dependencies,s!==null&&s.firstContext!==null&&((s.lanes&l)!==0&&(wr=!0),s.firstContext=null)}function Xr(s){var l=s._currentValue;if(zm!==s)if(s={context:s,memoizedValue:l,next:null},bl===null){if(Ih===null)throw Error(t(308));bl=s,Ih.dependencies={lanes:0,firstContext:s}}else bl=bl.next=s;return l}var Xs=null;function Lm(s){Xs===null?Xs=[s]:Xs.push(s)}function Eb(s,l,u,f){var y=l.interleaved;return y===null?(u.next=u,Lm(l)):(u.next=y.next,y.next=u),l.interleaved=u,oo(s,f)}function oo(s,l){s.lanes|=l;var u=s.alternate;for(u!==null&&(u.lanes|=l),u=s,s=s.return;s!==null;)s.childLanes|=l,u=s.alternate,u!==null&&(u.childLanes|=l),u=s,s=s.return;return u.tag===3?u.stateNode:null}var Ko=!1;function Om(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Ab(s,l){s=s.updateQueue,l.updateQueue===s&&(l.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,effects:s.effects})}function so(s,l){return{eventTime:s,lane:l,tag:0,payload:null,callback:null,next:null}}function Qo(s,l,u){var f=s.updateQueue;if(f===null)return null;if(f=f.shared,(Ft&2)!==0){var y=f.pending;return y===null?l.next=l:(l.next=y.next,y.next=l),f.pending=l,oo(s,u)}return y=f.interleaved,y===null?(l.next=l,Lm(f)):(l.next=y.next,y.next=l),f.interleaved=l,oo(s,u)}function Ch(s,l,u){if(l=l.updateQueue,l!==null&&(l=l.shared,(u&4194240)!==0)){var f=l.lanes;f&=s.pendingLanes,u|=f,l.lanes=u,Mo(s,u)}}function Pb(s,l){var u=s.updateQueue,f=s.alternate;if(f!==null&&(f=f.updateQueue,u===f)){var y=null,w=null;if(u=u.firstBaseUpdate,u!==null){do{var E={eventTime:u.eventTime,lane:u.lane,tag:u.tag,payload:u.payload,callback:u.callback,next:null};w===null?y=w=E:w=w.next=E,u=u.next}while(u!==null);w===null?y=w=l:w=w.next=l}else y=w=l;u={baseState:f.baseState,firstBaseUpdate:y,lastBaseUpdate:w,shared:f.shared,effects:f.effects},s.updateQueue=u;return}s=u.lastBaseUpdate,s===null?u.firstBaseUpdate=l:s.next=l,u.lastBaseUpdate=l}function Rh(s,l,u,f){var y=s.updateQueue;Ko=!1;var w=y.firstBaseUpdate,E=y.lastBaseUpdate,V=y.shared.pending;if(V!==null){y.shared.pending=null;var Z=V,ge=Z.next;Z.next=null,E===null?w=ge:E.next=ge,E=Z;var Be=s.alternate;Be!==null&&(Be=Be.updateQueue,V=Be.lastBaseUpdate,V!==E&&(V===null?Be.firstBaseUpdate=ge:V.next=ge,Be.lastBaseUpdate=Z))}if(w!==null){var Fe=y.baseState;E=0,Be=ge=Z=null,V=w;do{var Ae=V.lane,Xe=V.eventTime;if((f&Ae)===Ae){Be!==null&&(Be=Be.next={eventTime:Xe,lane:0,tag:V.tag,payload:V.payload,callback:V.callback,next:null});e:{var tt=s,it=V;switch(Ae=l,Xe=u,it.tag){case 1:if(tt=it.payload,typeof tt=="function"){Fe=tt.call(Xe,Fe,Ae);break e}Fe=tt;break e;case 3:tt.flags=tt.flags&-65537|128;case 0:if(tt=it.payload,Ae=typeof tt=="function"?tt.call(Xe,Fe,Ae):tt,Ae==null)break e;Fe=xe({},Fe,Ae);break e;case 2:Ko=!0}}V.callback!==null&&V.lane!==0&&(s.flags|=64,Ae=y.effects,Ae===null?y.effects=[V]:Ae.push(V))}else Xe={eventTime:Xe,lane:Ae,tag:V.tag,payload:V.payload,callback:V.callback,next:null},Be===null?(ge=Be=Xe,Z=Fe):Be=Be.next=Xe,E|=Ae;if(V=V.next,V===null){if(V=y.shared.pending,V===null)break;Ae=V,V=Ae.next,Ae.next=null,y.lastBaseUpdate=Ae,y.shared.pending=null}}while(!0);if(Be===null&&(Z=Fe),y.baseState=Z,y.firstBaseUpdate=ge,y.lastBaseUpdate=Be,l=y.shared.interleaved,l!==null){y=l;do E|=y.lane,y=y.next;while(y!==l)}else w===null&&(y.shared.lanes=0);ea|=E,s.lanes=E,s.memoizedState=Fe}}function Bb(s,l,u){if(s=l.effects,l.effects=null,s!==null)for(l=0;l<s.length;l++){var f=s[l],y=f.callback;if(y!==null){if(f.callback=null,f=u,typeof y!="function")throw Error(t(191,y));y.call(f)}}}var lu={},Ri=Ho(lu),cu=Ho(lu),uu=Ho(lu);function Js(s){if(s===lu)throw Error(t(174));return s}function Wm(s,l){switch(Zt(uu,l),Zt(cu,s),Zt(Ri,lu),s=l.nodeType,s){case 9:case 11:l=(l=l.documentElement)?l.namespaceURI:dt(null,"");break;default:s=s===8?l.parentNode:l,l=s.namespaceURI||null,s=s.tagName,l=dt(l,s)}rn(Ri),Zt(Ri,l)}function wl(){rn(Ri),rn(cu),rn(uu)}function Fb(s){Js(uu.current);var l=Js(Ri.current),u=dt(l,s.type);l!==u&&(Zt(cu,s),Zt(Ri,u))}function Vm(s){cu.current===s&&(rn(Ri),rn(cu))}var pn=Ho(0);function Eh(s){for(var l=s;l!==null;){if(l.tag===13){var u=l.memoizedState;if(u!==null&&(u=u.dehydrated,u===null||u.data==="$?"||u.data==="$!"))return l}else if(l.tag===19&&l.memoizedProps.revealOrder!==void 0){if((l.flags&128)!==0)return l}else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===s)break;for(;l.sibling===null;){if(l.return===null||l.return===s)return null;l=l.return}l.sibling.return=l.return,l=l.sibling}return null}var Um=[];function qm(){for(var s=0;s<Um.length;s++)Um[s]._workInProgressVersionPrimary=null;Um.length=0}var Ah=H.ReactCurrentDispatcher,Hm=H.ReactCurrentBatchConfig,Zs=0,fn=null,Cn=null,Nn=null,Ph=!1,du=!1,hu=0,mC=0;function er(){throw Error(t(321))}function $m(s,l){if(l===null)return!1;for(var u=0;u<l.length&&u<s.length;u++)if(!ci(s[u],l[u]))return!1;return!0}function Gm(s,l,u,f,y,w){if(Zs=w,fn=l,l.memoizedState=null,l.updateQueue=null,l.lanes=0,Ah.current=s===null||s.memoizedState===null?bC:vC,s=u(f,y),du){w=0;do{if(du=!1,hu=0,25<=w)throw Error(t(301));w+=1,Nn=Cn=null,l.updateQueue=null,Ah.current=wC,s=u(f,y)}while(du)}if(Ah.current=zh,l=Cn!==null&&Cn.next!==null,Zs=0,Nn=Cn=fn=null,Ph=!1,l)throw Error(t(300));return s}function Km(){var s=hu!==0;return hu=0,s}function Ei(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Nn===null?fn.memoizedState=Nn=s:Nn=Nn.next=s,Nn}function Jr(){if(Cn===null){var s=fn.alternate;s=s!==null?s.memoizedState:null}else s=Cn.next;var l=Nn===null?fn.memoizedState:Nn.next;if(l!==null)Nn=l,Cn=s;else{if(s===null)throw Error(t(310));Cn=s,s={memoizedState:Cn.memoizedState,baseState:Cn.baseState,baseQueue:Cn.baseQueue,queue:Cn.queue,next:null},Nn===null?fn.memoizedState=Nn=s:Nn=Nn.next=s}return Nn}function pu(s,l){return typeof l=="function"?l(s):l}function Qm(s){var l=Jr(),u=l.queue;if(u===null)throw Error(t(311));u.lastRenderedReducer=s;var f=Cn,y=f.baseQueue,w=u.pending;if(w!==null){if(y!==null){var E=y.next;y.next=w.next,w.next=E}f.baseQueue=y=w,u.pending=null}if(y!==null){w=y.next,f=f.baseState;var V=E=null,Z=null,ge=w;do{var Be=ge.lane;if((Zs&Be)===Be)Z!==null&&(Z=Z.next={lane:0,action:ge.action,hasEagerState:ge.hasEagerState,eagerState:ge.eagerState,next:null}),f=ge.hasEagerState?ge.eagerState:s(f,ge.action);else{var Fe={lane:Be,action:ge.action,hasEagerState:ge.hasEagerState,eagerState:ge.eagerState,next:null};Z===null?(V=Z=Fe,E=f):Z=Z.next=Fe,fn.lanes|=Be,ea|=Be}ge=ge.next}while(ge!==null&&ge!==w);Z===null?E=f:Z.next=V,ci(f,l.memoizedState)||(wr=!0),l.memoizedState=f,l.baseState=E,l.baseQueue=Z,u.lastRenderedState=f}if(s=u.interleaved,s!==null){y=s;do w=y.lane,fn.lanes|=w,ea|=w,y=y.next;while(y!==s)}else y===null&&(u.lanes=0);return[l.memoizedState,u.dispatch]}function Ym(s){var l=Jr(),u=l.queue;if(u===null)throw Error(t(311));u.lastRenderedReducer=s;var f=u.dispatch,y=u.pending,w=l.memoizedState;if(y!==null){u.pending=null;var E=y=y.next;do w=s(w,E.action),E=E.next;while(E!==y);ci(w,l.memoizedState)||(wr=!0),l.memoizedState=w,l.baseQueue===null&&(l.baseState=w),u.lastRenderedState=w}return[w,f]}function zb(){}function Db(s,l){var u=fn,f=Jr(),y=l(),w=!ci(f.memoizedState,y);if(w&&(f.memoizedState=y,wr=!0),f=f.queue,Xm(Lb.bind(null,u,f,s),[s]),f.getSnapshot!==l||w||Nn!==null&&Nn.memoizedState.tag&1){if(u.flags|=2048,fu(9,Mb.bind(null,u,f,y,l),void 0,null),Mn===null)throw Error(t(349));(Zs&30)!==0||Nb(u,l,y)}return y}function Nb(s,l,u){s.flags|=16384,s={getSnapshot:l,value:u},l=fn.updateQueue,l===null?(l={lastEffect:null,stores:null},fn.updateQueue=l,l.stores=[s]):(u=l.stores,u===null?l.stores=[s]:u.push(s))}function Mb(s,l,u,f){l.value=u,l.getSnapshot=f,Ob(l)&&Wb(s)}function Lb(s,l,u){return u(function(){Ob(l)&&Wb(s)})}function Ob(s){var l=s.getSnapshot;s=s.value;try{var u=l();return!ci(s,u)}catch{return!0}}function Wb(s){var l=oo(s,1);l!==null&&fi(l,s,1,-1)}function Vb(s){var l=Ei();return typeof s=="function"&&(s=s()),l.memoizedState=l.baseState=s,s={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:pu,lastRenderedState:s},l.queue=s,s=s.dispatch=xC.bind(null,fn,s),[l.memoizedState,s]}function fu(s,l,u,f){return s={tag:s,create:l,destroy:u,deps:f,next:null},l=fn.updateQueue,l===null?(l={lastEffect:null,stores:null},fn.updateQueue=l,l.lastEffect=s.next=s):(u=l.lastEffect,u===null?l.lastEffect=s.next=s:(f=u.next,u.next=s,s.next=f,l.lastEffect=s)),s}function Ub(){return Jr().memoizedState}function Bh(s,l,u,f){var y=Ei();fn.flags|=s,y.memoizedState=fu(1|l,u,void 0,f===void 0?null:f)}function Fh(s,l,u,f){var y=Jr();f=f===void 0?null:f;var w=void 0;if(Cn!==null){var E=Cn.memoizedState;if(w=E.destroy,f!==null&&$m(f,E.deps)){y.memoizedState=fu(l,u,w,f);return}}fn.flags|=s,y.memoizedState=fu(1|l,u,w,f)}function qb(s,l){return Bh(8390656,8,s,l)}function Xm(s,l){return Fh(2048,8,s,l)}function Hb(s,l){return Fh(4,2,s,l)}function $b(s,l){return Fh(4,4,s,l)}function Gb(s,l){if(typeof l=="function")return s=s(),l(s),function(){l(null)};if(l!=null)return s=s(),l.current=s,function(){l.current=null}}function Kb(s,l,u){return u=u!=null?u.concat([s]):null,Fh(4,4,Gb.bind(null,l,s),u)}function Jm(){}function Qb(s,l){var u=Jr();l=l===void 0?null:l;var f=u.memoizedState;return f!==null&&l!==null&&$m(l,f[1])?f[0]:(u.memoizedState=[s,l],s)}function Yb(s,l){var u=Jr();l=l===void 0?null:l;var f=u.memoizedState;return f!==null&&l!==null&&$m(l,f[1])?f[0]:(s=s(),u.memoizedState=[s,l],s)}function Xb(s,l,u){return(Zs&21)===0?(s.baseState&&(s.baseState=!1,wr=!0),s.memoizedState=u):(ci(u,l)||(u=Vs(),fn.lanes|=u,ea|=u,s.baseState=!0),l)}function gC(s,l){var u=Rt;Rt=u!==0&&4>u?u:4,s(!0);var f=Hm.transition;Hm.transition={};try{s(!1),l()}finally{Rt=u,Hm.transition=f}}function Jb(){return Jr().memoizedState}function yC(s,l,u){var f=Zo(s);if(u={lane:f,action:u,hasEagerState:!1,eagerState:null,next:null},Zb(s))ev(l,u);else if(u=Eb(s,l,u,f),u!==null){var y=pr();fi(u,s,f,y),tv(u,l,f)}}function xC(s,l,u){var f=Zo(s),y={lane:f,action:u,hasEagerState:!1,eagerState:null,next:null};if(Zb(s))ev(l,y);else{var w=s.alternate;if(s.lanes===0&&(w===null||w.lanes===0)&&(w=l.lastRenderedReducer,w!==null))try{var E=l.lastRenderedState,V=w(E,u);if(y.hasEagerState=!0,y.eagerState=V,ci(V,E)){var Z=l.interleaved;Z===null?(y.next=y,Lm(l)):(y.next=Z.next,Z.next=y),l.interleaved=y;return}}catch{}finally{}u=Eb(s,l,y,f),u!==null&&(y=pr(),fi(u,s,f,y),tv(u,l,f))}}function Zb(s){var l=s.alternate;return s===fn||l!==null&&l===fn}function ev(s,l){du=Ph=!0;var u=s.pending;u===null?l.next=l:(l.next=u.next,u.next=l),s.pending=l}function tv(s,l,u){if((u&4194240)!==0){var f=l.lanes;f&=s.pendingLanes,u|=f,l.lanes=u,Mo(s,u)}}var zh={readContext:Xr,useCallback:er,useContext:er,useEffect:er,useImperativeHandle:er,useInsertionEffect:er,useLayoutEffect:er,useMemo:er,useReducer:er,useRef:er,useState:er,useDebugValue:er,useDeferredValue:er,useTransition:er,useMutableSource:er,useSyncExternalStore:er,useId:er,unstable_isNewReconciler:!1},bC={readContext:Xr,useCallback:function(s,l){return Ei().memoizedState=[s,l===void 0?null:l],s},useContext:Xr,useEffect:qb,useImperativeHandle:function(s,l,u){return u=u!=null?u.concat([s]):null,Bh(4194308,4,Gb.bind(null,l,s),u)},useLayoutEffect:function(s,l){return Bh(4194308,4,s,l)},useInsertionEffect:function(s,l){return Bh(4,2,s,l)},useMemo:function(s,l){var u=Ei();return l=l===void 0?null:l,s=s(),u.memoizedState=[s,l],s},useReducer:function(s,l,u){var f=Ei();return l=u!==void 0?u(l):l,f.memoizedState=f.baseState=l,s={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:l},f.queue=s,s=s.dispatch=yC.bind(null,fn,s),[f.memoizedState,s]},useRef:function(s){var l=Ei();return s={current:s},l.memoizedState=s},useState:Vb,useDebugValue:Jm,useDeferredValue:function(s){return Ei().memoizedState=s},useTransition:function(){var s=Vb(!1),l=s[0];return s=gC.bind(null,s[1]),Ei().memoizedState=s,[l,s]},useMutableSource:function(){},useSyncExternalStore:function(s,l,u){var f=fn,y=Ei();if(cn){if(u===void 0)throw Error(t(407));u=u()}else{if(u=l(),Mn===null)throw Error(t(349));(Zs&30)!==0||Nb(f,l,u)}y.memoizedState=u;var w={value:u,getSnapshot:l};return y.queue=w,qb(Lb.bind(null,f,w,s),[s]),f.flags|=2048,fu(9,Mb.bind(null,f,w,u,l),void 0,null),u},useId:function(){var s=Ei(),l=Mn.identifierPrefix;if(cn){var u=io,f=ro;u=(f&~(1<<32-ur(f)-1)).toString(32)+u,l=":"+l+"R"+u,u=hu++,0<u&&(l+="H"+u.toString(32)),l+=":"}else u=mC++,l=":"+l+"r"+u.toString(32)+":";return s.memoizedState=l},unstable_isNewReconciler:!1},vC={readContext:Xr,useCallback:Qb,useContext:Xr,useEffect:Xm,useImperativeHandle:Kb,useInsertionEffect:Hb,useLayoutEffect:$b,useMemo:Yb,useReducer:Qm,useRef:Ub,useState:function(){return Qm(pu)},useDebugValue:Jm,useDeferredValue:function(s){var l=Jr();return Xb(l,Cn.memoizedState,s)},useTransition:function(){var s=Qm(pu)[0],l=Jr().memoizedState;return[s,l]},useMutableSource:zb,useSyncExternalStore:Db,useId:Jb,unstable_isNewReconciler:!1},wC={readContext:Xr,useCallback:Qb,useContext:Xr,useEffect:Xm,useImperativeHandle:Kb,useInsertionEffect:Hb,useLayoutEffect:$b,useMemo:Yb,useReducer:Ym,useRef:Ub,useState:function(){return Ym(pu)},useDebugValue:Jm,useDeferredValue:function(s){var l=Jr();return Cn===null?l.memoizedState=s:Xb(l,Cn.memoizedState,s)},useTransition:function(){var s=Ym(pu)[0],l=Jr().memoizedState;return[s,l]},useMutableSource:zb,useSyncExternalStore:Db,useId:Jb,unstable_isNewReconciler:!1};function di(s,l){if(s&&s.defaultProps){l=xe({},l),s=s.defaultProps;for(var u in s)l[u]===void 0&&(l[u]=s[u]);return l}return l}function Zm(s,l,u,f){l=s.memoizedState,u=u(f,l),u=u==null?l:xe({},l,u),s.memoizedState=u,s.lanes===0&&(s.updateQueue.baseState=u)}var Dh={isMounted:function(s){return(s=s._reactInternals)?ni(s)===s:!1},enqueueSetState:function(s,l,u){s=s._reactInternals;var f=pr(),y=Zo(s),w=so(f,y);w.payload=l,u!=null&&(w.callback=u),l=Qo(s,w,y),l!==null&&(fi(l,s,y,f),Ch(l,s,y))},enqueueReplaceState:function(s,l,u){s=s._reactInternals;var f=pr(),y=Zo(s),w=so(f,y);w.tag=1,w.payload=l,u!=null&&(w.callback=u),l=Qo(s,w,y),l!==null&&(fi(l,s,y,f),Ch(l,s,y))},enqueueForceUpdate:function(s,l){s=s._reactInternals;var u=pr(),f=Zo(s),y=so(u,f);y.tag=2,l!=null&&(y.callback=l),l=Qo(s,y,f),l!==null&&(fi(l,s,f,u),Ch(l,s,f))}};function nv(s,l,u,f,y,w,E){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(f,w,E):l.prototype&&l.prototype.isPureReactComponent?!eu(u,f)||!eu(y,w):!0}function rv(s,l,u){var f=!1,y=$o,w=l.contextType;return typeof w=="object"&&w!==null?w=Xr(w):(y=vr(l)?Ks:Zn.current,f=l.contextTypes,w=(f=f!=null)?fl(s,y):$o),l=new l(u,w),s.memoizedState=l.state!==null&&l.state!==void 0?l.state:null,l.updater=Dh,s.stateNode=l,l._reactInternals=s,f&&(s=s.stateNode,s.__reactInternalMemoizedUnmaskedChildContext=y,s.__reactInternalMemoizedMaskedChildContext=w),l}function iv(s,l,u,f){s=l.state,typeof l.componentWillReceiveProps=="function"&&l.componentWillReceiveProps(u,f),typeof l.UNSAFE_componentWillReceiveProps=="function"&&l.UNSAFE_componentWillReceiveProps(u,f),l.state!==s&&Dh.enqueueReplaceState(l,l.state,null)}function eg(s,l,u,f){var y=s.stateNode;y.props=u,y.state=s.memoizedState,y.refs={},Om(s);var w=l.contextType;typeof w=="object"&&w!==null?y.context=Xr(w):(w=vr(l)?Ks:Zn.current,y.context=fl(s,w)),y.state=s.memoizedState,w=l.getDerivedStateFromProps,typeof w=="function"&&(Zm(s,l,w,u),y.state=s.memoizedState),typeof l.getDerivedStateFromProps=="function"||typeof y.getSnapshotBeforeUpdate=="function"||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(l=y.state,typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount(),l!==y.state&&Dh.enqueueReplaceState(y,y.state,null),Rh(s,u,y,f),y.state=s.memoizedState),typeof y.componentDidMount=="function"&&(s.flags|=4194308)}function Sl(s,l){try{var u="",f=l;do u+=se(f),f=f.return;while(f);var y=u}catch(w){y=`
Error generating stack: `+w.message+`
`+w.stack}return{value:s,source:l,stack:y,digest:null}}function tg(s,l,u){return{value:s,source:null,stack:u??null,digest:l??null}}function ng(s,l){try{console.error(l.value)}catch(u){setTimeout(function(){throw u})}}var SC=typeof WeakMap=="function"?WeakMap:Map;function ov(s,l,u){u=so(-1,u),u.tag=3,u.payload={element:null};var f=l.value;return u.callback=function(){Uh||(Uh=!0,yg=f),ng(s,l)},u}function sv(s,l,u){u=so(-1,u),u.tag=3;var f=s.type.getDerivedStateFromError;if(typeof f=="function"){var y=l.value;u.payload=function(){return f(y)},u.callback=function(){ng(s,l)}}var w=s.stateNode;return w!==null&&typeof w.componentDidCatch=="function"&&(u.callback=function(){ng(s,l),typeof f!="function"&&(Xo===null?Xo=new Set([this]):Xo.add(this));var E=l.stack;this.componentDidCatch(l.value,{componentStack:E!==null?E:""})}),u}function av(s,l,u){var f=s.pingCache;if(f===null){f=s.pingCache=new SC;var y=new Set;f.set(l,y)}else y=f.get(l),y===void 0&&(y=new Set,f.set(l,y));y.has(u)||(y.add(u),s=DC.bind(null,s,l,u),l.then(s,s))}function lv(s){do{var l;if((l=s.tag===13)&&(l=s.memoizedState,l=l!==null?l.dehydrated!==null:!0),l)return s;s=s.return}while(s!==null);return null}function cv(s,l,u,f,y){return(s.mode&1)===0?(s===l?s.flags|=65536:(s.flags|=128,u.flags|=131072,u.flags&=-52805,u.tag===1&&(u.alternate===null?u.tag=17:(l=so(-1,1),l.tag=2,Qo(u,l,1))),u.lanes|=1),s):(s.flags|=65536,s.lanes=y,s)}var kC=H.ReactCurrentOwner,wr=!1;function hr(s,l,u,f){l.child=s===null?Rb(l,null,u,f):xl(l,s.child,u,f)}function uv(s,l,u,f,y){u=u.render;var w=l.ref;return vl(l,y),f=Gm(s,l,u,f,w,y),u=Km(),s!==null&&!wr?(l.updateQueue=s.updateQueue,l.flags&=-2053,s.lanes&=~y,ao(s,l,y)):(cn&&u&&Em(l),l.flags|=1,hr(s,l,f,y),l.child)}function dv(s,l,u,f,y){if(s===null){var w=u.type;return typeof w=="function"&&!Tg(w)&&w.defaultProps===void 0&&u.compare===null&&u.defaultProps===void 0?(l.tag=15,l.type=w,hv(s,l,w,f,y)):(s=Qh(u.type,null,f,l,l.mode,y),s.ref=l.ref,s.return=l,l.child=s)}if(w=s.child,(s.lanes&y)===0){var E=w.memoizedProps;if(u=u.compare,u=u!==null?u:eu,u(E,f)&&s.ref===l.ref)return ao(s,l,y)}return l.flags|=1,s=ts(w,f),s.ref=l.ref,s.return=l,l.child=s}function hv(s,l,u,f,y){if(s!==null){var w=s.memoizedProps;if(eu(w,f)&&s.ref===l.ref)if(wr=!1,l.pendingProps=f=w,(s.lanes&y)!==0)(s.flags&131072)!==0&&(wr=!0);else return l.lanes=s.lanes,ao(s,l,y)}return rg(s,l,u,f,y)}function pv(s,l,u){var f=l.pendingProps,y=f.children,w=s!==null?s.memoizedState:null;if(f.mode==="hidden")if((l.mode&1)===0)l.memoizedState={baseLanes:0,cachePool:null,transitions:null},Zt(Tl,Or),Or|=u;else{if((u&1073741824)===0)return s=w!==null?w.baseLanes|u:u,l.lanes=l.childLanes=1073741824,l.memoizedState={baseLanes:s,cachePool:null,transitions:null},l.updateQueue=null,Zt(Tl,Or),Or|=s,null;l.memoizedState={baseLanes:0,cachePool:null,transitions:null},f=w!==null?w.baseLanes:u,Zt(Tl,Or),Or|=f}else w!==null?(f=w.baseLanes|u,l.memoizedState=null):f=u,Zt(Tl,Or),Or|=f;return hr(s,l,y,u),l.child}function fv(s,l){var u=l.ref;(s===null&&u!==null||s!==null&&s.ref!==u)&&(l.flags|=512,l.flags|=2097152)}function rg(s,l,u,f,y){var w=vr(u)?Ks:Zn.current;return w=fl(l,w),vl(l,y),u=Gm(s,l,u,f,w,y),f=Km(),s!==null&&!wr?(l.updateQueue=s.updateQueue,l.flags&=-2053,s.lanes&=~y,ao(s,l,y)):(cn&&f&&Em(l),l.flags|=1,hr(s,l,u,y),l.child)}function mv(s,l,u,f,y){if(vr(u)){var w=!0;vh(l)}else w=!1;if(vl(l,y),l.stateNode===null)Mh(s,l),rv(l,u,f),eg(l,u,f,y),f=!0;else if(s===null){var E=l.stateNode,V=l.memoizedProps;E.props=V;var Z=E.context,ge=u.contextType;typeof ge=="object"&&ge!==null?ge=Xr(ge):(ge=vr(u)?Ks:Zn.current,ge=fl(l,ge));var Be=u.getDerivedStateFromProps,Fe=typeof Be=="function"||typeof E.getSnapshotBeforeUpdate=="function";Fe||typeof E.UNSAFE_componentWillReceiveProps!="function"&&typeof E.componentWillReceiveProps!="function"||(V!==f||Z!==ge)&&iv(l,E,f,ge),Ko=!1;var Ae=l.memoizedState;E.state=Ae,Rh(l,f,E,y),Z=l.memoizedState,V!==f||Ae!==Z||br.current||Ko?(typeof Be=="function"&&(Zm(l,u,Be,f),Z=l.memoizedState),(V=Ko||nv(l,u,V,f,Ae,Z,ge))?(Fe||typeof E.UNSAFE_componentWillMount!="function"&&typeof E.componentWillMount!="function"||(typeof E.componentWillMount=="function"&&E.componentWillMount(),typeof E.UNSAFE_componentWillMount=="function"&&E.UNSAFE_componentWillMount()),typeof E.componentDidMount=="function"&&(l.flags|=4194308)):(typeof E.componentDidMount=="function"&&(l.flags|=4194308),l.memoizedProps=f,l.memoizedState=Z),E.props=f,E.state=Z,E.context=ge,f=V):(typeof E.componentDidMount=="function"&&(l.flags|=4194308),f=!1)}else{E=l.stateNode,Ab(s,l),V=l.memoizedProps,ge=l.type===l.elementType?V:di(l.type,V),E.props=ge,Fe=l.pendingProps,Ae=E.context,Z=u.contextType,typeof Z=="object"&&Z!==null?Z=Xr(Z):(Z=vr(u)?Ks:Zn.current,Z=fl(l,Z));var Xe=u.getDerivedStateFromProps;(Be=typeof Xe=="function"||typeof E.getSnapshotBeforeUpdate=="function")||typeof E.UNSAFE_componentWillReceiveProps!="function"&&typeof E.componentWillReceiveProps!="function"||(V!==Fe||Ae!==Z)&&iv(l,E,f,Z),Ko=!1,Ae=l.memoizedState,E.state=Ae,Rh(l,f,E,y);var tt=l.memoizedState;V!==Fe||Ae!==tt||br.current||Ko?(typeof Xe=="function"&&(Zm(l,u,Xe,f),tt=l.memoizedState),(ge=Ko||nv(l,u,ge,f,Ae,tt,Z)||!1)?(Be||typeof E.UNSAFE_componentWillUpdate!="function"&&typeof E.componentWillUpdate!="function"||(typeof E.componentWillUpdate=="function"&&E.componentWillUpdate(f,tt,Z),typeof E.UNSAFE_componentWillUpdate=="function"&&E.UNSAFE_componentWillUpdate(f,tt,Z)),typeof E.componentDidUpdate=="function"&&(l.flags|=4),typeof E.getSnapshotBeforeUpdate=="function"&&(l.flags|=1024)):(typeof E.componentDidUpdate!="function"||V===s.memoizedProps&&Ae===s.memoizedState||(l.flags|=4),typeof E.getSnapshotBeforeUpdate!="function"||V===s.memoizedProps&&Ae===s.memoizedState||(l.flags|=1024),l.memoizedProps=f,l.memoizedState=tt),E.props=f,E.state=tt,E.context=Z,f=ge):(typeof E.componentDidUpdate!="function"||V===s.memoizedProps&&Ae===s.memoizedState||(l.flags|=4),typeof E.getSnapshotBeforeUpdate!="function"||V===s.memoizedProps&&Ae===s.memoizedState||(l.flags|=1024),f=!1)}return ig(s,l,u,f,w,y)}function ig(s,l,u,f,y,w){fv(s,l);var E=(l.flags&128)!==0;if(!f&&!E)return y&&vb(l,u,!1),ao(s,l,w);f=l.stateNode,kC.current=l;var V=E&&typeof u.getDerivedStateFromError!="function"?null:f.render();return l.flags|=1,s!==null&&E?(l.child=xl(l,s.child,null,w),l.child=xl(l,null,V,w)):hr(s,l,V,w),l.memoizedState=f.state,y&&vb(l,u,!0),l.child}function gv(s){var l=s.stateNode;l.pendingContext?xb(s,l.pendingContext,l.pendingContext!==l.context):l.context&&xb(s,l.context,!1),Wm(s,l.containerInfo)}function yv(s,l,u,f,y){return yl(),Fm(y),l.flags|=256,hr(s,l,u,f),l.child}var og={dehydrated:null,treeContext:null,retryLane:0};function sg(s){return{baseLanes:s,cachePool:null,transitions:null}}function xv(s,l,u){var f=l.pendingProps,y=pn.current,w=!1,E=(l.flags&128)!==0,V;if((V=E)||(V=s!==null&&s.memoizedState===null?!1:(y&2)!==0),V?(w=!0,l.flags&=-129):(s===null||s.memoizedState!==null)&&(y|=1),Zt(pn,y&1),s===null)return Bm(l),s=l.memoizedState,s!==null&&(s=s.dehydrated,s!==null)?((l.mode&1)===0?l.lanes=1:s.data==="$!"?l.lanes=8:l.lanes=1073741824,null):(E=f.children,s=f.fallback,w?(f=l.mode,w=l.child,E={mode:"hidden",children:E},(f&1)===0&&w!==null?(w.childLanes=0,w.pendingProps=E):w=Yh(E,f,0,null),s=ia(s,f,u,null),w.return=l,s.return=l,w.sibling=s,l.child=w,l.child.memoizedState=sg(u),l.memoizedState=og,s):ag(l,E));if(y=s.memoizedState,y!==null&&(V=y.dehydrated,V!==null))return TC(s,l,E,f,V,y,u);if(w){w=f.fallback,E=l.mode,y=s.child,V=y.sibling;var Z={mode:"hidden",children:f.children};return(E&1)===0&&l.child!==y?(f=l.child,f.childLanes=0,f.pendingProps=Z,l.deletions=null):(f=ts(y,Z),f.subtreeFlags=y.subtreeFlags&14680064),V!==null?w=ts(V,w):(w=ia(w,E,u,null),w.flags|=2),w.return=l,f.return=l,f.sibling=w,l.child=f,f=w,w=l.child,E=s.child.memoizedState,E=E===null?sg(u):{baseLanes:E.baseLanes|u,cachePool:null,transitions:E.transitions},w.memoizedState=E,w.childLanes=s.childLanes&~u,l.memoizedState=og,f}return w=s.child,s=w.sibling,f=ts(w,{mode:"visible",children:f.children}),(l.mode&1)===0&&(f.lanes=u),f.return=l,f.sibling=null,s!==null&&(u=l.deletions,u===null?(l.deletions=[s],l.flags|=16):u.push(s)),l.child=f,l.memoizedState=null,f}function ag(s,l){return l=Yh({mode:"visible",children:l},s.mode,0,null),l.return=s,s.child=l}function Nh(s,l,u,f){return f!==null&&Fm(f),xl(l,s.child,null,u),s=ag(l,l.pendingProps.children),s.flags|=2,l.memoizedState=null,s}function TC(s,l,u,f,y,w,E){if(u)return l.flags&256?(l.flags&=-257,f=tg(Error(t(422))),Nh(s,l,E,f)):l.memoizedState!==null?(l.child=s.child,l.flags|=128,null):(w=f.fallback,y=l.mode,f=Yh({mode:"visible",children:f.children},y,0,null),w=ia(w,y,E,null),w.flags|=2,f.return=l,w.return=l,f.sibling=w,l.child=f,(l.mode&1)!==0&&xl(l,s.child,null,E),l.child.memoizedState=sg(E),l.memoizedState=og,w);if((l.mode&1)===0)return Nh(s,l,E,null);if(y.data==="$!"){if(f=y.nextSibling&&y.nextSibling.dataset,f)var V=f.dgst;return f=V,w=Error(t(419)),f=tg(w,f,void 0),Nh(s,l,E,f)}if(V=(E&s.childLanes)!==0,wr||V){if(f=Mn,f!==null){switch(E&-E){case 4:y=2;break;case 16:y=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:y=32;break;case 536870912:y=268435456;break;default:y=0}y=(y&(f.suspendedLanes|E))!==0?0:y,y!==0&&y!==w.retryLane&&(w.retryLane=y,oo(s,y),fi(f,s,y,-1))}return kg(),f=tg(Error(t(421))),Nh(s,l,E,f)}return y.data==="$?"?(l.flags|=128,l.child=s.child,l=NC.bind(null,s),y._reactRetry=l,null):(s=w.treeContext,Lr=qo(y.nextSibling),Mr=l,cn=!0,ui=null,s!==null&&(Qr[Yr++]=ro,Qr[Yr++]=io,Qr[Yr++]=Qs,ro=s.id,io=s.overflow,Qs=l),l=ag(l,f.children),l.flags|=4096,l)}function bv(s,l,u){s.lanes|=l;var f=s.alternate;f!==null&&(f.lanes|=l),Mm(s.return,l,u)}function lg(s,l,u,f,y){var w=s.memoizedState;w===null?s.memoizedState={isBackwards:l,rendering:null,renderingStartTime:0,last:f,tail:u,tailMode:y}:(w.isBackwards=l,w.rendering=null,w.renderingStartTime=0,w.last=f,w.tail=u,w.tailMode=y)}function vv(s,l,u){var f=l.pendingProps,y=f.revealOrder,w=f.tail;if(hr(s,l,f.children,u),f=pn.current,(f&2)!==0)f=f&1|2,l.flags|=128;else{if(s!==null&&(s.flags&128)!==0)e:for(s=l.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&bv(s,u,l);else if(s.tag===19)bv(s,u,l);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===l)break e;for(;s.sibling===null;){if(s.return===null||s.return===l)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}f&=1}if(Zt(pn,f),(l.mode&1)===0)l.memoizedState=null;else switch(y){case"forwards":for(u=l.child,y=null;u!==null;)s=u.alternate,s!==null&&Eh(s)===null&&(y=u),u=u.sibling;u=y,u===null?(y=l.child,l.child=null):(y=u.sibling,u.sibling=null),lg(l,!1,y,u,w);break;case"backwards":for(u=null,y=l.child,l.child=null;y!==null;){if(s=y.alternate,s!==null&&Eh(s)===null){l.child=y;break}s=y.sibling,y.sibling=u,u=y,y=s}lg(l,!0,u,null,w);break;case"together":lg(l,!1,null,null,void 0);break;default:l.memoizedState=null}return l.child}function Mh(s,l){(l.mode&1)===0&&s!==null&&(s.alternate=null,l.alternate=null,l.flags|=2)}function ao(s,l,u){if(s!==null&&(l.dependencies=s.dependencies),ea|=l.lanes,(u&l.childLanes)===0)return null;if(s!==null&&l.child!==s.child)throw Error(t(153));if(l.child!==null){for(s=l.child,u=ts(s,s.pendingProps),l.child=u,u.return=l;s.sibling!==null;)s=s.sibling,u=u.sibling=ts(s,s.pendingProps),u.return=l;u.sibling=null}return l.child}function _C(s,l,u){switch(l.tag){case 3:gv(l),yl();break;case 5:Fb(l);break;case 1:vr(l.type)&&vh(l);break;case 4:Wm(l,l.stateNode.containerInfo);break;case 10:var f=l.type._context,y=l.memoizedProps.value;Zt(jh,f._currentValue),f._currentValue=y;break;case 13:if(f=l.memoizedState,f!==null)return f.dehydrated!==null?(Zt(pn,pn.current&1),l.flags|=128,null):(u&l.child.childLanes)!==0?xv(s,l,u):(Zt(pn,pn.current&1),s=ao(s,l,u),s!==null?s.sibling:null);Zt(pn,pn.current&1);break;case 19:if(f=(u&l.childLanes)!==0,(s.flags&128)!==0){if(f)return vv(s,l,u);l.flags|=128}if(y=l.memoizedState,y!==null&&(y.rendering=null,y.tail=null,y.lastEffect=null),Zt(pn,pn.current),f)break;return null;case 22:case 23:return l.lanes=0,pv(s,l,u)}return ao(s,l,u)}var wv,cg,Sv,kv;wv=function(s,l){for(var u=l.child;u!==null;){if(u.tag===5||u.tag===6)s.appendChild(u.stateNode);else if(u.tag!==4&&u.child!==null){u.child.return=u,u=u.child;continue}if(u===l)break;for(;u.sibling===null;){if(u.return===null||u.return===l)return;u=u.return}u.sibling.return=u.return,u=u.sibling}},cg=function(){},Sv=function(s,l,u,f){var y=s.memoizedProps;if(y!==f){s=l.stateNode,Js(Ri.current);var w=null;switch(u){case"input":y=Le(s,y),f=Le(s,f),w=[];break;case"select":y=xe({},y,{value:void 0}),f=xe({},f,{value:void 0}),w=[];break;case"textarea":y=ie(s,y),f=ie(s,f),w=[];break;default:typeof y.onClick!="function"&&typeof f.onClick=="function"&&(s.onclick=yh)}W(u,f);var E;u=null;for(ge in y)if(!f.hasOwnProperty(ge)&&y.hasOwnProperty(ge)&&y[ge]!=null)if(ge==="style"){var V=y[ge];for(E in V)V.hasOwnProperty(E)&&(u||(u={}),u[E]="")}else ge!=="dangerouslySetInnerHTML"&&ge!=="children"&&ge!=="suppressContentEditableWarning"&&ge!=="suppressHydrationWarning"&&ge!=="autoFocus"&&(o.hasOwnProperty(ge)?w||(w=[]):(w=w||[]).push(ge,null));for(ge in f){var Z=f[ge];if(V=y!=null?y[ge]:void 0,f.hasOwnProperty(ge)&&Z!==V&&(Z!=null||V!=null))if(ge==="style")if(V){for(E in V)!V.hasOwnProperty(E)||Z&&Z.hasOwnProperty(E)||(u||(u={}),u[E]="");for(E in Z)Z.hasOwnProperty(E)&&V[E]!==Z[E]&&(u||(u={}),u[E]=Z[E])}else u||(w||(w=[]),w.push(ge,u)),u=Z;else ge==="dangerouslySetInnerHTML"?(Z=Z?Z.__html:void 0,V=V?V.__html:void 0,Z!=null&&V!==Z&&(w=w||[]).push(ge,Z)):ge==="children"?typeof Z!="string"&&typeof Z!="number"||(w=w||[]).push(ge,""+Z):ge!=="suppressContentEditableWarning"&&ge!=="suppressHydrationWarning"&&(o.hasOwnProperty(ge)?(Z!=null&&ge==="onScroll"&&nn("scroll",s),w||V===Z||(w=[])):(w=w||[]).push(ge,Z))}u&&(w=w||[]).push("style",u);var ge=w;(l.updateQueue=ge)&&(l.flags|=4)}},kv=function(s,l,u,f){u!==f&&(l.flags|=4)};function mu(s,l){if(!cn)switch(s.tailMode){case"hidden":l=s.tail;for(var u=null;l!==null;)l.alternate!==null&&(u=l),l=l.sibling;u===null?s.tail=null:u.sibling=null;break;case"collapsed":u=s.tail;for(var f=null;u!==null;)u.alternate!==null&&(f=u),u=u.sibling;f===null?l||s.tail===null?s.tail=null:s.tail.sibling=null:f.sibling=null}}function tr(s){var l=s.alternate!==null&&s.alternate.child===s.child,u=0,f=0;if(l)for(var y=s.child;y!==null;)u|=y.lanes|y.childLanes,f|=y.subtreeFlags&14680064,f|=y.flags&14680064,y.return=s,y=y.sibling;else for(y=s.child;y!==null;)u|=y.lanes|y.childLanes,f|=y.subtreeFlags,f|=y.flags,y.return=s,y=y.sibling;return s.subtreeFlags|=f,s.childLanes=u,l}function jC(s,l,u){var f=l.pendingProps;switch(Am(l),l.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return tr(l),null;case 1:return vr(l.type)&&bh(),tr(l),null;case 3:return f=l.stateNode,wl(),rn(br),rn(Zn),qm(),f.pendingContext&&(f.context=f.pendingContext,f.pendingContext=null),(s===null||s.child===null)&&(Th(l)?l.flags|=4:s===null||s.memoizedState.isDehydrated&&(l.flags&256)===0||(l.flags|=1024,ui!==null&&(vg(ui),ui=null))),cg(s,l),tr(l),null;case 5:Vm(l);var y=Js(uu.current);if(u=l.type,s!==null&&l.stateNode!=null)Sv(s,l,u,f,y),s.ref!==l.ref&&(l.flags|=512,l.flags|=2097152);else{if(!f){if(l.stateNode===null)throw Error(t(166));return tr(l),null}if(s=Js(Ri.current),Th(l)){f=l.stateNode,u=l.type;var w=l.memoizedProps;switch(f[Ci]=l,f[ou]=w,s=(l.mode&1)!==0,u){case"dialog":nn("cancel",f),nn("close",f);break;case"iframe":case"object":case"embed":nn("load",f);break;case"video":case"audio":for(y=0;y<nu.length;y++)nn(nu[y],f);break;case"source":nn("error",f);break;case"img":case"image":case"link":nn("error",f),nn("load",f);break;case"details":nn("toggle",f);break;case"input":$e(f,w),nn("invalid",f);break;case"select":f._wrapperState={wasMultiple:!!w.multiple},nn("invalid",f);break;case"textarea":q(f,w),nn("invalid",f)}W(u,w),y=null;for(var E in w)if(w.hasOwnProperty(E)){var V=w[E];E==="children"?typeof V=="string"?f.textContent!==V&&(w.suppressHydrationWarning!==!0&&gh(f.textContent,V,s),y=["children",V]):typeof V=="number"&&f.textContent!==""+V&&(w.suppressHydrationWarning!==!0&&gh(f.textContent,V,s),y=["children",""+V]):o.hasOwnProperty(E)&&V!=null&&E==="onScroll"&&nn("scroll",f)}switch(u){case"input":be(f),Ce(f,w,!0);break;case"textarea":be(f),st(f);break;case"select":case"option":break;default:typeof w.onClick=="function"&&(f.onclick=yh)}f=y,l.updateQueue=f,f!==null&&(l.flags|=4)}else{E=y.nodeType===9?y:y.ownerDocument,s==="http://www.w3.org/1999/xhtml"&&(s=et(u)),s==="http://www.w3.org/1999/xhtml"?u==="script"?(s=E.createElement("div"),s.innerHTML="<script><\/script>",s=s.removeChild(s.firstChild)):typeof f.is=="string"?s=E.createElement(u,{is:f.is}):(s=E.createElement(u),u==="select"&&(E=s,f.multiple?E.multiple=!0:f.size&&(E.size=f.size))):s=E.createElementNS(s,u),s[Ci]=l,s[ou]=f,wv(s,l,!1,!1),l.stateNode=s;e:{switch(E=Y(u,f),u){case"dialog":nn("cancel",s),nn("close",s),y=f;break;case"iframe":case"object":case"embed":nn("load",s),y=f;break;case"video":case"audio":for(y=0;y<nu.length;y++)nn(nu[y],s);y=f;break;case"source":nn("error",s),y=f;break;case"img":case"image":case"link":nn("error",s),nn("load",s),y=f;break;case"details":nn("toggle",s),y=f;break;case"input":$e(s,f),y=Le(s,f),nn("invalid",s);break;case"option":y=f;break;case"select":s._wrapperState={wasMultiple:!!f.multiple},y=xe({},f,{value:void 0}),nn("invalid",s);break;case"textarea":q(s,f),y=ie(s,f),nn("invalid",s);break;default:y=f}W(u,y),V=y;for(w in V)if(V.hasOwnProperty(w)){var Z=V[w];w==="style"?Dt(s,Z):w==="dangerouslySetInnerHTML"?(Z=Z?Z.__html:void 0,Z!=null&&je(s,Z)):w==="children"?typeof Z=="string"?(u!=="textarea"||Z!=="")&&Qe(s,Z):typeof Z=="number"&&Qe(s,""+Z):w!=="suppressContentEditableWarning"&&w!=="suppressHydrationWarning"&&w!=="autoFocus"&&(o.hasOwnProperty(w)?Z!=null&&w==="onScroll"&&nn("scroll",s):Z!=null&&z(s,w,Z,E))}switch(u){case"input":be(s),Ce(s,f,!1);break;case"textarea":be(s),st(s);break;case"option":f.value!=null&&s.setAttribute("value",""+Pe(f.value));break;case"select":s.multiple=!!f.multiple,w=f.value,w!=null?K(s,!!f.multiple,w,!1):f.defaultValue!=null&&K(s,!!f.multiple,f.defaultValue,!0);break;default:typeof y.onClick=="function"&&(s.onclick=yh)}switch(u){case"button":case"input":case"select":case"textarea":f=!!f.autoFocus;break e;case"img":f=!0;break e;default:f=!1}}f&&(l.flags|=4)}l.ref!==null&&(l.flags|=512,l.flags|=2097152)}return tr(l),null;case 6:if(s&&l.stateNode!=null)kv(s,l,s.memoizedProps,f);else{if(typeof f!="string"&&l.stateNode===null)throw Error(t(166));if(u=Js(uu.current),Js(Ri.current),Th(l)){if(f=l.stateNode,u=l.memoizedProps,f[Ci]=l,(w=f.nodeValue!==u)&&(s=Mr,s!==null))switch(s.tag){case 3:gh(f.nodeValue,u,(s.mode&1)!==0);break;case 5:s.memoizedProps.suppressHydrationWarning!==!0&&gh(f.nodeValue,u,(s.mode&1)!==0)}w&&(l.flags|=4)}else f=(u.nodeType===9?u:u.ownerDocument).createTextNode(f),f[Ci]=l,l.stateNode=f}return tr(l),null;case 13:if(rn(pn),f=l.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(cn&&Lr!==null&&(l.mode&1)!==0&&(l.flags&128)===0)jb(),yl(),l.flags|=98560,w=!1;else if(w=Th(l),f!==null&&f.dehydrated!==null){if(s===null){if(!w)throw Error(t(318));if(w=l.memoizedState,w=w!==null?w.dehydrated:null,!w)throw Error(t(317));w[Ci]=l}else yl(),(l.flags&128)===0&&(l.memoizedState=null),l.flags|=4;tr(l),w=!1}else ui!==null&&(vg(ui),ui=null),w=!0;if(!w)return l.flags&65536?l:null}return(l.flags&128)!==0?(l.lanes=u,l):(f=f!==null,f!==(s!==null&&s.memoizedState!==null)&&f&&(l.child.flags|=8192,(l.mode&1)!==0&&(s===null||(pn.current&1)!==0?Rn===0&&(Rn=3):kg())),l.updateQueue!==null&&(l.flags|=4),tr(l),null);case 4:return wl(),cg(s,l),s===null&&ru(l.stateNode.containerInfo),tr(l),null;case 10:return Nm(l.type._context),tr(l),null;case 17:return vr(l.type)&&bh(),tr(l),null;case 19:if(rn(pn),w=l.memoizedState,w===null)return tr(l),null;if(f=(l.flags&128)!==0,E=w.rendering,E===null)if(f)mu(w,!1);else{if(Rn!==0||s!==null&&(s.flags&128)!==0)for(s=l.child;s!==null;){if(E=Eh(s),E!==null){for(l.flags|=128,mu(w,!1),f=E.updateQueue,f!==null&&(l.updateQueue=f,l.flags|=4),l.subtreeFlags=0,f=u,u=l.child;u!==null;)w=u,s=f,w.flags&=14680066,E=w.alternate,E===null?(w.childLanes=0,w.lanes=s,w.child=null,w.subtreeFlags=0,w.memoizedProps=null,w.memoizedState=null,w.updateQueue=null,w.dependencies=null,w.stateNode=null):(w.childLanes=E.childLanes,w.lanes=E.lanes,w.child=E.child,w.subtreeFlags=0,w.deletions=null,w.memoizedProps=E.memoizedProps,w.memoizedState=E.memoizedState,w.updateQueue=E.updateQueue,w.type=E.type,s=E.dependencies,w.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext}),u=u.sibling;return Zt(pn,pn.current&1|2),l.child}s=s.sibling}w.tail!==null&&Jt()>_l&&(l.flags|=128,f=!0,mu(w,!1),l.lanes=4194304)}else{if(!f)if(s=Eh(E),s!==null){if(l.flags|=128,f=!0,u=s.updateQueue,u!==null&&(l.updateQueue=u,l.flags|=4),mu(w,!0),w.tail===null&&w.tailMode==="hidden"&&!E.alternate&&!cn)return tr(l),null}else 2*Jt()-w.renderingStartTime>_l&&u!==1073741824&&(l.flags|=128,f=!0,mu(w,!1),l.lanes=4194304);w.isBackwards?(E.sibling=l.child,l.child=E):(u=w.last,u!==null?u.sibling=E:l.child=E,w.last=E)}return w.tail!==null?(l=w.tail,w.rendering=l,w.tail=l.sibling,w.renderingStartTime=Jt(),l.sibling=null,u=pn.current,Zt(pn,f?u&1|2:u&1),l):(tr(l),null);case 22:case 23:return Sg(),f=l.memoizedState!==null,s!==null&&s.memoizedState!==null!==f&&(l.flags|=8192),f&&(l.mode&1)!==0?(Or&1073741824)!==0&&(tr(l),l.subtreeFlags&6&&(l.flags|=8192)):tr(l),null;case 24:return null;case 25:return null}throw Error(t(156,l.tag))}function IC(s,l){switch(Am(l),l.tag){case 1:return vr(l.type)&&bh(),s=l.flags,s&65536?(l.flags=s&-65537|128,l):null;case 3:return wl(),rn(br),rn(Zn),qm(),s=l.flags,(s&65536)!==0&&(s&128)===0?(l.flags=s&-65537|128,l):null;case 5:return Vm(l),null;case 13:if(rn(pn),s=l.memoizedState,s!==null&&s.dehydrated!==null){if(l.alternate===null)throw Error(t(340));yl()}return s=l.flags,s&65536?(l.flags=s&-65537|128,l):null;case 19:return rn(pn),null;case 4:return wl(),null;case 10:return Nm(l.type._context),null;case 22:case 23:return Sg(),null;case 24:return null;default:return null}}var Lh=!1,nr=!1,CC=typeof WeakSet=="function"?WeakSet:Set,Ze=null;function kl(s,l){var u=s.ref;if(u!==null)if(typeof u=="function")try{u(null)}catch(f){bn(s,l,f)}else u.current=null}function ug(s,l,u){try{u()}catch(f){bn(s,l,f)}}var Tv=!1;function RC(s,l){if(Sm=Wo,s=nb(),fm(s)){if("selectionStart"in s)var u={start:s.selectionStart,end:s.selectionEnd};else e:{u=(u=s.ownerDocument)&&u.defaultView||window;var f=u.getSelection&&u.getSelection();if(f&&f.rangeCount!==0){u=f.anchorNode;var y=f.anchorOffset,w=f.focusNode;f=f.focusOffset;try{u.nodeType,w.nodeType}catch{u=null;break e}var E=0,V=-1,Z=-1,ge=0,Be=0,Fe=s,Ae=null;t:for(;;){for(var Xe;Fe!==u||y!==0&&Fe.nodeType!==3||(V=E+y),Fe!==w||f!==0&&Fe.nodeType!==3||(Z=E+f),Fe.nodeType===3&&(E+=Fe.nodeValue.length),(Xe=Fe.firstChild)!==null;)Ae=Fe,Fe=Xe;for(;;){if(Fe===s)break t;if(Ae===u&&++ge===y&&(V=E),Ae===w&&++Be===f&&(Z=E),(Xe=Fe.nextSibling)!==null)break;Fe=Ae,Ae=Fe.parentNode}Fe=Xe}u=V===-1||Z===-1?null:{start:V,end:Z}}else u=null}u=u||{start:0,end:0}}else u=null;for(km={focusedElem:s,selectionRange:u},Wo=!1,Ze=l;Ze!==null;)if(l=Ze,s=l.child,(l.subtreeFlags&1028)!==0&&s!==null)s.return=l,Ze=s;else for(;Ze!==null;){l=Ze;try{var tt=l.alternate;if((l.flags&1024)!==0)switch(l.tag){case 0:case 11:case 15:break;case 1:if(tt!==null){var it=tt.memoizedProps,wn=tt.memoizedState,he=l.stateNode,re=he.getSnapshotBeforeUpdate(l.elementType===l.type?it:di(l.type,it),wn);he.__reactInternalSnapshotBeforeUpdate=re}break;case 3:var pe=l.stateNode.containerInfo;pe.nodeType===1?pe.textContent="":pe.nodeType===9&&pe.documentElement&&pe.removeChild(pe.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(Ne){bn(l,l.return,Ne)}if(s=l.sibling,s!==null){s.return=l.return,Ze=s;break}Ze=l.return}return tt=Tv,Tv=!1,tt}function gu(s,l,u){var f=l.updateQueue;if(f=f!==null?f.lastEffect:null,f!==null){var y=f=f.next;do{if((y.tag&s)===s){var w=y.destroy;y.destroy=void 0,w!==void 0&&ug(l,u,w)}y=y.next}while(y!==f)}}function Oh(s,l){if(l=l.updateQueue,l=l!==null?l.lastEffect:null,l!==null){var u=l=l.next;do{if((u.tag&s)===s){var f=u.create;u.destroy=f()}u=u.next}while(u!==l)}}function dg(s){var l=s.ref;if(l!==null){var u=s.stateNode;switch(s.tag){case 5:s=u;break;default:s=u}typeof l=="function"?l(s):l.current=s}}function _v(s){var l=s.alternate;l!==null&&(s.alternate=null,_v(l)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(l=s.stateNode,l!==null&&(delete l[Ci],delete l[ou],delete l[Im],delete l[dC],delete l[hC])),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}function jv(s){return s.tag===5||s.tag===3||s.tag===4}function Iv(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||jv(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function hg(s,l,u){var f=s.tag;if(f===5||f===6)s=s.stateNode,l?u.nodeType===8?u.parentNode.insertBefore(s,l):u.insertBefore(s,l):(u.nodeType===8?(l=u.parentNode,l.insertBefore(s,u)):(l=u,l.appendChild(s)),u=u._reactRootContainer,u!=null||l.onclick!==null||(l.onclick=yh));else if(f!==4&&(s=s.child,s!==null))for(hg(s,l,u),s=s.sibling;s!==null;)hg(s,l,u),s=s.sibling}function pg(s,l,u){var f=s.tag;if(f===5||f===6)s=s.stateNode,l?u.insertBefore(s,l):u.appendChild(s);else if(f!==4&&(s=s.child,s!==null))for(pg(s,l,u),s=s.sibling;s!==null;)pg(s,l,u),s=s.sibling}var Qn=null,hi=!1;function Yo(s,l,u){for(u=u.child;u!==null;)Cv(s,l,u),u=u.sibling}function Cv(s,l,u){if(Fr&&typeof Fr.onCommitFiberUnmount=="function")try{Fr.onCommitFiberUnmount(Os,u)}catch{}switch(u.tag){case 5:nr||kl(u,l);case 6:var f=Qn,y=hi;Qn=null,Yo(s,l,u),Qn=f,hi=y,Qn!==null&&(hi?(s=Qn,u=u.stateNode,s.nodeType===8?s.parentNode.removeChild(u):s.removeChild(u)):Qn.removeChild(u.stateNode));break;case 18:Qn!==null&&(hi?(s=Qn,u=u.stateNode,s.nodeType===8?jm(s.parentNode,u):s.nodeType===1&&jm(s,u),ai(s)):jm(Qn,u.stateNode));break;case 4:f=Qn,y=hi,Qn=u.stateNode.containerInfo,hi=!0,Yo(s,l,u),Qn=f,hi=y;break;case 0:case 11:case 14:case 15:if(!nr&&(f=u.updateQueue,f!==null&&(f=f.lastEffect,f!==null))){y=f=f.next;do{var w=y,E=w.destroy;w=w.tag,E!==void 0&&((w&2)!==0||(w&4)!==0)&&ug(u,l,E),y=y.next}while(y!==f)}Yo(s,l,u);break;case 1:if(!nr&&(kl(u,l),f=u.stateNode,typeof f.componentWillUnmount=="function"))try{f.props=u.memoizedProps,f.state=u.memoizedState,f.componentWillUnmount()}catch(V){bn(u,l,V)}Yo(s,l,u);break;case 21:Yo(s,l,u);break;case 22:u.mode&1?(nr=(f=nr)||u.memoizedState!==null,Yo(s,l,u),nr=f):Yo(s,l,u);break;default:Yo(s,l,u)}}function Rv(s){var l=s.updateQueue;if(l!==null){s.updateQueue=null;var u=s.stateNode;u===null&&(u=s.stateNode=new CC),l.forEach(function(f){var y=MC.bind(null,s,f);u.has(f)||(u.add(f),f.then(y,y))})}}function pi(s,l){var u=l.deletions;if(u!==null)for(var f=0;f<u.length;f++){var y=u[f];try{var w=s,E=l,V=E;e:for(;V!==null;){switch(V.tag){case 5:Qn=V.stateNode,hi=!1;break e;case 3:Qn=V.stateNode.containerInfo,hi=!0;break e;case 4:Qn=V.stateNode.containerInfo,hi=!0;break e}V=V.return}if(Qn===null)throw Error(t(160));Cv(w,E,y),Qn=null,hi=!1;var Z=y.alternate;Z!==null&&(Z.return=null),y.return=null}catch(ge){bn(y,l,ge)}}if(l.subtreeFlags&12854)for(l=l.child;l!==null;)Ev(l,s),l=l.sibling}function Ev(s,l){var u=s.alternate,f=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:if(pi(l,s),Ai(s),f&4){try{gu(3,s,s.return),Oh(3,s)}catch(it){bn(s,s.return,it)}try{gu(5,s,s.return)}catch(it){bn(s,s.return,it)}}break;case 1:pi(l,s),Ai(s),f&512&&u!==null&&kl(u,u.return);break;case 5:if(pi(l,s),Ai(s),f&512&&u!==null&&kl(u,u.return),s.flags&32){var y=s.stateNode;try{Qe(y,"")}catch(it){bn(s,s.return,it)}}if(f&4&&(y=s.stateNode,y!=null)){var w=s.memoizedProps,E=u!==null?u.memoizedProps:w,V=s.type,Z=s.updateQueue;if(s.updateQueue=null,Z!==null)try{V==="input"&&w.type==="radio"&&w.name!=null&&fe(y,w),Y(V,E);var ge=Y(V,w);for(E=0;E<Z.length;E+=2){var Be=Z[E],Fe=Z[E+1];Be==="style"?Dt(y,Fe):Be==="dangerouslySetInnerHTML"?je(y,Fe):Be==="children"?Qe(y,Fe):z(y,Be,Fe,ge)}switch(V){case"input":_e(y,w);break;case"textarea":Me(y,w);break;case"select":var Ae=y._wrapperState.wasMultiple;y._wrapperState.wasMultiple=!!w.multiple;var Xe=w.value;Xe!=null?K(y,!!w.multiple,Xe,!1):Ae!==!!w.multiple&&(w.defaultValue!=null?K(y,!!w.multiple,w.defaultValue,!0):K(y,!!w.multiple,w.multiple?[]:"",!1))}y[ou]=w}catch(it){bn(s,s.return,it)}}break;case 6:if(pi(l,s),Ai(s),f&4){if(s.stateNode===null)throw Error(t(162));y=s.stateNode,w=s.memoizedProps;try{y.nodeValue=w}catch(it){bn(s,s.return,it)}}break;case 3:if(pi(l,s),Ai(s),f&4&&u!==null&&u.memoizedState.isDehydrated)try{ai(l.containerInfo)}catch(it){bn(s,s.return,it)}break;case 4:pi(l,s),Ai(s);break;case 13:pi(l,s),Ai(s),y=s.child,y.flags&8192&&(w=y.memoizedState!==null,y.stateNode.isHidden=w,!w||y.alternate!==null&&y.alternate.memoizedState!==null||(gg=Jt())),f&4&&Rv(s);break;case 22:if(Be=u!==null&&u.memoizedState!==null,s.mode&1?(nr=(ge=nr)||Be,pi(l,s),nr=ge):pi(l,s),Ai(s),f&8192){if(ge=s.memoizedState!==null,(s.stateNode.isHidden=ge)&&!Be&&(s.mode&1)!==0)for(Ze=s,Be=s.child;Be!==null;){for(Fe=Ze=Be;Ze!==null;){switch(Ae=Ze,Xe=Ae.child,Ae.tag){case 0:case 11:case 14:case 15:gu(4,Ae,Ae.return);break;case 1:kl(Ae,Ae.return);var tt=Ae.stateNode;if(typeof tt.componentWillUnmount=="function"){f=Ae,u=Ae.return;try{l=f,tt.props=l.memoizedProps,tt.state=l.memoizedState,tt.componentWillUnmount()}catch(it){bn(f,u,it)}}break;case 5:kl(Ae,Ae.return);break;case 22:if(Ae.memoizedState!==null){Bv(Fe);continue}}Xe!==null?(Xe.return=Ae,Ze=Xe):Bv(Fe)}Be=Be.sibling}e:for(Be=null,Fe=s;;){if(Fe.tag===5){if(Be===null){Be=Fe;try{y=Fe.stateNode,ge?(w=y.style,typeof w.setProperty=="function"?w.setProperty("display","none","important"):w.display="none"):(V=Fe.stateNode,Z=Fe.memoizedProps.style,E=Z!=null&&Z.hasOwnProperty("display")?Z.display:null,V.style.display=Bt("display",E))}catch(it){bn(s,s.return,it)}}}else if(Fe.tag===6){if(Be===null)try{Fe.stateNode.nodeValue=ge?"":Fe.memoizedProps}catch(it){bn(s,s.return,it)}}else if((Fe.tag!==22&&Fe.tag!==23||Fe.memoizedState===null||Fe===s)&&Fe.child!==null){Fe.child.return=Fe,Fe=Fe.child;continue}if(Fe===s)break e;for(;Fe.sibling===null;){if(Fe.return===null||Fe.return===s)break e;Be===Fe&&(Be=null),Fe=Fe.return}Be===Fe&&(Be=null),Fe.sibling.return=Fe.return,Fe=Fe.sibling}}break;case 19:pi(l,s),Ai(s),f&4&&Rv(s);break;case 21:break;default:pi(l,s),Ai(s)}}function Ai(s){var l=s.flags;if(l&2){try{e:{for(var u=s.return;u!==null;){if(jv(u)){var f=u;break e}u=u.return}throw Error(t(160))}switch(f.tag){case 5:var y=f.stateNode;f.flags&32&&(Qe(y,""),f.flags&=-33);var w=Iv(s);pg(s,w,y);break;case 3:case 4:var E=f.stateNode.containerInfo,V=Iv(s);hg(s,V,E);break;default:throw Error(t(161))}}catch(Z){bn(s,s.return,Z)}s.flags&=-3}l&4096&&(s.flags&=-4097)}function EC(s,l,u){Ze=s,Av(s)}function Av(s,l,u){for(var f=(s.mode&1)!==0;Ze!==null;){var y=Ze,w=y.child;if(y.tag===22&&f){var E=y.memoizedState!==null||Lh;if(!E){var V=y.alternate,Z=V!==null&&V.memoizedState!==null||nr;V=Lh;var ge=nr;if(Lh=E,(nr=Z)&&!ge)for(Ze=y;Ze!==null;)E=Ze,Z=E.child,E.tag===22&&E.memoizedState!==null?Fv(y):Z!==null?(Z.return=E,Ze=Z):Fv(y);for(;w!==null;)Ze=w,Av(w),w=w.sibling;Ze=y,Lh=V,nr=ge}Pv(s)}else(y.subtreeFlags&8772)!==0&&w!==null?(w.return=y,Ze=w):Pv(s)}}function Pv(s){for(;Ze!==null;){var l=Ze;if((l.flags&8772)!==0){var u=l.alternate;try{if((l.flags&8772)!==0)switch(l.tag){case 0:case 11:case 15:nr||Oh(5,l);break;case 1:var f=l.stateNode;if(l.flags&4&&!nr)if(u===null)f.componentDidMount();else{var y=l.elementType===l.type?u.memoizedProps:di(l.type,u.memoizedProps);f.componentDidUpdate(y,u.memoizedState,f.__reactInternalSnapshotBeforeUpdate)}var w=l.updateQueue;w!==null&&Bb(l,w,f);break;case 3:var E=l.updateQueue;if(E!==null){if(u=null,l.child!==null)switch(l.child.tag){case 5:u=l.child.stateNode;break;case 1:u=l.child.stateNode}Bb(l,E,u)}break;case 5:var V=l.stateNode;if(u===null&&l.flags&4){u=V;var Z=l.memoizedProps;switch(l.type){case"button":case"input":case"select":case"textarea":Z.autoFocus&&u.focus();break;case"img":Z.src&&(u.src=Z.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(l.memoizedState===null){var ge=l.alternate;if(ge!==null){var Be=ge.memoizedState;if(Be!==null){var Fe=Be.dehydrated;Fe!==null&&ai(Fe)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}nr||l.flags&512&&dg(l)}catch(Ae){bn(l,l.return,Ae)}}if(l===s){Ze=null;break}if(u=l.sibling,u!==null){u.return=l.return,Ze=u;break}Ze=l.return}}function Bv(s){for(;Ze!==null;){var l=Ze;if(l===s){Ze=null;break}var u=l.sibling;if(u!==null){u.return=l.return,Ze=u;break}Ze=l.return}}function Fv(s){for(;Ze!==null;){var l=Ze;try{switch(l.tag){case 0:case 11:case 15:var u=l.return;try{Oh(4,l)}catch(Z){bn(l,u,Z)}break;case 1:var f=l.stateNode;if(typeof f.componentDidMount=="function"){var y=l.return;try{f.componentDidMount()}catch(Z){bn(l,y,Z)}}var w=l.return;try{dg(l)}catch(Z){bn(l,w,Z)}break;case 5:var E=l.return;try{dg(l)}catch(Z){bn(l,E,Z)}}}catch(Z){bn(l,l.return,Z)}if(l===s){Ze=null;break}var V=l.sibling;if(V!==null){V.return=l.return,Ze=V;break}Ze=l.return}}var AC=Math.ceil,Wh=H.ReactCurrentDispatcher,fg=H.ReactCurrentOwner,Zr=H.ReactCurrentBatchConfig,Ft=0,Mn=null,_n=null,Yn=0,Or=0,Tl=Ho(0),Rn=0,yu=null,ea=0,Vh=0,mg=0,xu=null,Sr=null,gg=0,_l=1/0,lo=null,Uh=!1,yg=null,Xo=null,qh=!1,Jo=null,Hh=0,bu=0,xg=null,$h=-1,Gh=0;function pr(){return(Ft&6)!==0?Jt():$h!==-1?$h:$h=Jt()}function Zo(s){return(s.mode&1)===0?1:(Ft&2)!==0&&Yn!==0?Yn&-Yn:fC.transition!==null?(Gh===0&&(Gh=Vs()),Gh):(s=Rt,s!==0||(s=window.event,s=s===void 0?16:Gc(s.type)),s)}function fi(s,l,u,f){if(50<bu)throw bu=0,xg=null,Error(t(185));No(s,u,f),((Ft&2)===0||s!==Mn)&&(s===Mn&&((Ft&2)===0&&(Vh|=u),Rn===4&&es(s,Yn)),kr(s,f),u===1&&Ft===0&&(l.mode&1)===0&&(_l=Jt()+500,wh&&Go()))}function kr(s,l){var u=s.callbackNode;Yi(s,l);var f=Ws(s,s===Mn?Yn:0);if(f===0)u!==null&&Vc(u),s.callbackNode=null,s.callbackPriority=0;else if(l=f&-f,s.callbackPriority!==l){if(u!=null&&Vc(u),l===1)s.tag===0?pC(Dv.bind(null,s)):wb(Dv.bind(null,s)),cC(function(){(Ft&6)===0&&Go()}),u=null;else{switch(Lo(f)){case 1:u=Ls;break;case 4:u=Fo;break;case 16:u=$r;break;case 536870912:u=Gd;break;default:u=$r}u=qv(u,zv.bind(null,s))}s.callbackPriority=l,s.callbackNode=u}}function zv(s,l){if($h=-1,Gh=0,(Ft&6)!==0)throw Error(t(327));var u=s.callbackNode;if(jl()&&s.callbackNode!==u)return null;var f=Ws(s,s===Mn?Yn:0);if(f===0)return null;if((f&30)!==0||(f&s.expiredLanes)!==0||l)l=Kh(s,f);else{l=f;var y=Ft;Ft|=2;var w=Mv();(Mn!==s||Yn!==l)&&(lo=null,_l=Jt()+500,na(s,l));do try{FC();break}catch(V){Nv(s,V)}while(!0);Dm(),Wh.current=w,Ft=y,_n!==null?l=0:(Mn=null,Yn=0,l=Rn)}if(l!==0){if(l===2&&(y=zr(s),y!==0&&(f=y,l=bg(s,y))),l===1)throw u=yu,na(s,0),es(s,f),kr(s,Jt()),u;if(l===6)es(s,f);else{if(y=s.current.alternate,(f&30)===0&&!PC(y)&&(l=Kh(s,f),l===2&&(w=zr(s),w!==0&&(f=w,l=bg(s,w))),l===1))throw u=yu,na(s,0),es(s,f),kr(s,Jt()),u;switch(s.finishedWork=y,s.finishedLanes=f,l){case 0:case 1:throw Error(t(345));case 2:ra(s,Sr,lo);break;case 3:if(es(s,f),(f&130023424)===f&&(l=gg+500-Jt(),10<l)){if(Ws(s,0)!==0)break;if(y=s.suspendedLanes,(y&f)!==f){pr(),s.pingedLanes|=s.suspendedLanes&y;break}s.timeoutHandle=_m(ra.bind(null,s,Sr,lo),l);break}ra(s,Sr,lo);break;case 4:if(es(s,f),(f&4194240)===f)break;for(l=s.eventTimes,y=-1;0<f;){var E=31-ur(f);w=1<<E,E=l[E],E>y&&(y=E),f&=~w}if(f=y,f=Jt()-f,f=(120>f?120:480>f?480:1080>f?1080:1920>f?1920:3e3>f?3e3:4320>f?4320:1960*AC(f/1960))-f,10<f){s.timeoutHandle=_m(ra.bind(null,s,Sr,lo),f);break}ra(s,Sr,lo);break;case 5:ra(s,Sr,lo);break;default:throw Error(t(329))}}}return kr(s,Jt()),s.callbackNode===u?zv.bind(null,s):null}function bg(s,l){var u=xu;return s.current.memoizedState.isDehydrated&&(na(s,l).flags|=256),s=Kh(s,l),s!==2&&(l=Sr,Sr=u,l!==null&&vg(l)),s}function vg(s){Sr===null?Sr=s:Sr.push.apply(Sr,s)}function PC(s){for(var l=s;;){if(l.flags&16384){var u=l.updateQueue;if(u!==null&&(u=u.stores,u!==null))for(var f=0;f<u.length;f++){var y=u[f],w=y.getSnapshot;y=y.value;try{if(!ci(w(),y))return!1}catch{return!1}}}if(u=l.child,l.subtreeFlags&16384&&u!==null)u.return=l,l=u;else{if(l===s)break;for(;l.sibling===null;){if(l.return===null||l.return===s)return!0;l=l.return}l.sibling.return=l.return,l=l.sibling}}return!0}function es(s,l){for(l&=~mg,l&=~Vh,s.suspendedLanes|=l,s.pingedLanes&=~l,s=s.expirationTimes;0<l;){var u=31-ur(l),f=1<<u;s[u]=-1,l&=~f}}function Dv(s){if((Ft&6)!==0)throw Error(t(327));jl();var l=Ws(s,0);if((l&1)===0)return kr(s,Jt()),null;var u=Kh(s,l);if(s.tag!==0&&u===2){var f=zr(s);f!==0&&(l=f,u=bg(s,f))}if(u===1)throw u=yu,na(s,0),es(s,l),kr(s,Jt()),u;if(u===6)throw Error(t(345));return s.finishedWork=s.current.alternate,s.finishedLanes=l,ra(s,Sr,lo),kr(s,Jt()),null}function wg(s,l){var u=Ft;Ft|=1;try{return s(l)}finally{Ft=u,Ft===0&&(_l=Jt()+500,wh&&Go())}}function ta(s){Jo!==null&&Jo.tag===0&&(Ft&6)===0&&jl();var l=Ft;Ft|=1;var u=Zr.transition,f=Rt;try{if(Zr.transition=null,Rt=1,s)return s()}finally{Rt=f,Zr.transition=u,Ft=l,(Ft&6)===0&&Go()}}function Sg(){Or=Tl.current,rn(Tl)}function na(s,l){s.finishedWork=null,s.finishedLanes=0;var u=s.timeoutHandle;if(u!==-1&&(s.timeoutHandle=-1,lC(u)),_n!==null)for(u=_n.return;u!==null;){var f=u;switch(Am(f),f.tag){case 1:f=f.type.childContextTypes,f!=null&&bh();break;case 3:wl(),rn(br),rn(Zn),qm();break;case 5:Vm(f);break;case 4:wl();break;case 13:rn(pn);break;case 19:rn(pn);break;case 10:Nm(f.type._context);break;case 22:case 23:Sg()}u=u.return}if(Mn=s,_n=s=ts(s.current,null),Yn=Or=l,Rn=0,yu=null,mg=Vh=ea=0,Sr=xu=null,Xs!==null){for(l=0;l<Xs.length;l++)if(u=Xs[l],f=u.interleaved,f!==null){u.interleaved=null;var y=f.next,w=u.pending;if(w!==null){var E=w.next;w.next=y,f.next=E}u.pending=f}Xs=null}return s}function Nv(s,l){do{var u=_n;try{if(Dm(),Ah.current=zh,Ph){for(var f=fn.memoizedState;f!==null;){var y=f.queue;y!==null&&(y.pending=null),f=f.next}Ph=!1}if(Zs=0,Nn=Cn=fn=null,du=!1,hu=0,fg.current=null,u===null||u.return===null){Rn=1,yu=l,_n=null;break}e:{var w=s,E=u.return,V=u,Z=l;if(l=Yn,V.flags|=32768,Z!==null&&typeof Z=="object"&&typeof Z.then=="function"){var ge=Z,Be=V,Fe=Be.tag;if((Be.mode&1)===0&&(Fe===0||Fe===11||Fe===15)){var Ae=Be.alternate;Ae?(Be.updateQueue=Ae.updateQueue,Be.memoizedState=Ae.memoizedState,Be.lanes=Ae.lanes):(Be.updateQueue=null,Be.memoizedState=null)}var Xe=lv(E);if(Xe!==null){Xe.flags&=-257,cv(Xe,E,V,w,l),Xe.mode&1&&av(w,ge,l),l=Xe,Z=ge;var tt=l.updateQueue;if(tt===null){var it=new Set;it.add(Z),l.updateQueue=it}else tt.add(Z);break e}else{if((l&1)===0){av(w,ge,l),kg();break e}Z=Error(t(426))}}else if(cn&&V.mode&1){var wn=lv(E);if(wn!==null){(wn.flags&65536)===0&&(wn.flags|=256),cv(wn,E,V,w,l),Fm(Sl(Z,V));break e}}w=Z=Sl(Z,V),Rn!==4&&(Rn=2),xu===null?xu=[w]:xu.push(w),w=E;do{switch(w.tag){case 3:w.flags|=65536,l&=-l,w.lanes|=l;var he=ov(w,Z,l);Pb(w,he);break e;case 1:V=Z;var re=w.type,pe=w.stateNode;if((w.flags&128)===0&&(typeof re.getDerivedStateFromError=="function"||pe!==null&&typeof pe.componentDidCatch=="function"&&(Xo===null||!Xo.has(pe)))){w.flags|=65536,l&=-l,w.lanes|=l;var Ne=sv(w,V,l);Pb(w,Ne);break e}}w=w.return}while(w!==null)}Ov(u)}catch(ot){l=ot,_n===u&&u!==null&&(_n=u=u.return);continue}break}while(!0)}function Mv(){var s=Wh.current;return Wh.current=zh,s===null?zh:s}function kg(){(Rn===0||Rn===3||Rn===2)&&(Rn=4),Mn===null||(ea&268435455)===0&&(Vh&268435455)===0||es(Mn,Yn)}function Kh(s,l){var u=Ft;Ft|=2;var f=Mv();(Mn!==s||Yn!==l)&&(lo=null,na(s,l));do try{BC();break}catch(y){Nv(s,y)}while(!0);if(Dm(),Ft=u,Wh.current=f,_n!==null)throw Error(t(261));return Mn=null,Yn=0,Rn}function BC(){for(;_n!==null;)Lv(_n)}function FC(){for(;_n!==null&&!Hd();)Lv(_n)}function Lv(s){var l=Uv(s.alternate,s,Or);s.memoizedProps=s.pendingProps,l===null?Ov(s):_n=l,fg.current=null}function Ov(s){var l=s;do{var u=l.alternate;if(s=l.return,(l.flags&32768)===0){if(u=jC(u,l,Or),u!==null){_n=u;return}}else{if(u=IC(u,l),u!==null){u.flags&=32767,_n=u;return}if(s!==null)s.flags|=32768,s.subtreeFlags=0,s.deletions=null;else{Rn=6,_n=null;return}}if(l=l.sibling,l!==null){_n=l;return}_n=l=s}while(l!==null);Rn===0&&(Rn=5)}function ra(s,l,u){var f=Rt,y=Zr.transition;try{Zr.transition=null,Rt=1,zC(s,l,u,f)}finally{Zr.transition=y,Rt=f}return null}function zC(s,l,u,f){do jl();while(Jo!==null);if((Ft&6)!==0)throw Error(t(327));u=s.finishedWork;var y=s.finishedLanes;if(u===null)return null;if(s.finishedWork=null,s.finishedLanes=0,u===s.current)throw Error(t(177));s.callbackNode=null,s.callbackPriority=0;var w=u.lanes|u.childLanes;if(Kt(s,w),s===Mn&&(_n=Mn=null,Yn=0),(u.subtreeFlags&2064)===0&&(u.flags&2064)===0||qh||(qh=!0,qv($r,function(){return jl(),null})),w=(u.flags&15990)!==0,(u.subtreeFlags&15990)!==0||w){w=Zr.transition,Zr.transition=null;var E=Rt;Rt=1;var V=Ft;Ft|=4,fg.current=null,RC(s,u),Ev(u,s),tC(km),Wo=!!Sm,km=Sm=null,s.current=u,EC(u),sm(),Ft=V,Rt=E,Zr.transition=w}else s.current=u;if(qh&&(qh=!1,Jo=s,Hh=y),w=s.pendingLanes,w===0&&(Xo=null),Kd(u.stateNode),kr(s,Jt()),l!==null)for(f=s.onRecoverableError,u=0;u<l.length;u++)y=l[u],f(y.value,{componentStack:y.stack,digest:y.digest});if(Uh)throw Uh=!1,s=yg,yg=null,s;return(Hh&1)!==0&&s.tag!==0&&jl(),w=s.pendingLanes,(w&1)!==0?s===xg?bu++:(bu=0,xg=s):bu=0,Go(),null}function jl(){if(Jo!==null){var s=Lo(Hh),l=Zr.transition,u=Rt;try{if(Zr.transition=null,Rt=16>s?16:s,Jo===null)var f=!1;else{if(s=Jo,Jo=null,Hh=0,(Ft&6)!==0)throw Error(t(331));var y=Ft;for(Ft|=4,Ze=s.current;Ze!==null;){var w=Ze,E=w.child;if((Ze.flags&16)!==0){var V=w.deletions;if(V!==null){for(var Z=0;Z<V.length;Z++){var ge=V[Z];for(Ze=ge;Ze!==null;){var Be=Ze;switch(Be.tag){case 0:case 11:case 15:gu(8,Be,w)}var Fe=Be.child;if(Fe!==null)Fe.return=Be,Ze=Fe;else for(;Ze!==null;){Be=Ze;var Ae=Be.sibling,Xe=Be.return;if(_v(Be),Be===ge){Ze=null;break}if(Ae!==null){Ae.return=Xe,Ze=Ae;break}Ze=Xe}}}var tt=w.alternate;if(tt!==null){var it=tt.child;if(it!==null){tt.child=null;do{var wn=it.sibling;it.sibling=null,it=wn}while(it!==null)}}Ze=w}}if((w.subtreeFlags&2064)!==0&&E!==null)E.return=w,Ze=E;else e:for(;Ze!==null;){if(w=Ze,(w.flags&2048)!==0)switch(w.tag){case 0:case 11:case 15:gu(9,w,w.return)}var he=w.sibling;if(he!==null){he.return=w.return,Ze=he;break e}Ze=w.return}}var re=s.current;for(Ze=re;Ze!==null;){E=Ze;var pe=E.child;if((E.subtreeFlags&2064)!==0&&pe!==null)pe.return=E,Ze=pe;else e:for(E=re;Ze!==null;){if(V=Ze,(V.flags&2048)!==0)try{switch(V.tag){case 0:case 11:case 15:Oh(9,V)}}catch(ot){bn(V,V.return,ot)}if(V===E){Ze=null;break e}var Ne=V.sibling;if(Ne!==null){Ne.return=V.return,Ze=Ne;break e}Ze=V.return}}if(Ft=y,Go(),Fr&&typeof Fr.onPostCommitFiberRoot=="function")try{Fr.onPostCommitFiberRoot(Os,s)}catch{}f=!0}return f}finally{Rt=u,Zr.transition=l}}return!1}function Wv(s,l,u){l=Sl(u,l),l=ov(s,l,1),s=Qo(s,l,1),l=pr(),s!==null&&(No(s,1,l),kr(s,l))}function bn(s,l,u){if(s.tag===3)Wv(s,s,u);else for(;l!==null;){if(l.tag===3){Wv(l,s,u);break}else if(l.tag===1){var f=l.stateNode;if(typeof l.type.getDerivedStateFromError=="function"||typeof f.componentDidCatch=="function"&&(Xo===null||!Xo.has(f))){s=Sl(u,s),s=sv(l,s,1),l=Qo(l,s,1),s=pr(),l!==null&&(No(l,1,s),kr(l,s));break}}l=l.return}}function DC(s,l,u){var f=s.pingCache;f!==null&&f.delete(l),l=pr(),s.pingedLanes|=s.suspendedLanes&u,Mn===s&&(Yn&u)===u&&(Rn===4||Rn===3&&(Yn&130023424)===Yn&&500>Jt()-gg?na(s,0):mg|=u),kr(s,l)}function Vv(s,l){l===0&&((s.mode&1)===0?l=1:(l=Qa,Qa<<=1,(Qa&130023424)===0&&(Qa=4194304)));var u=pr();s=oo(s,l),s!==null&&(No(s,l,u),kr(s,u))}function NC(s){var l=s.memoizedState,u=0;l!==null&&(u=l.retryLane),Vv(s,u)}function MC(s,l){var u=0;switch(s.tag){case 13:var f=s.stateNode,y=s.memoizedState;y!==null&&(u=y.retryLane);break;case 19:f=s.stateNode;break;default:throw Error(t(314))}f!==null&&f.delete(l),Vv(s,u)}var Uv;Uv=function(s,l,u){if(s!==null)if(s.memoizedProps!==l.pendingProps||br.current)wr=!0;else{if((s.lanes&u)===0&&(l.flags&128)===0)return wr=!1,_C(s,l,u);wr=(s.flags&131072)!==0}else wr=!1,cn&&(l.flags&1048576)!==0&&Sb(l,kh,l.index);switch(l.lanes=0,l.tag){case 2:var f=l.type;Mh(s,l),s=l.pendingProps;var y=fl(l,Zn.current);vl(l,u),y=Gm(null,l,f,s,y,u);var w=Km();return l.flags|=1,typeof y=="object"&&y!==null&&typeof y.render=="function"&&y.$$typeof===void 0?(l.tag=1,l.memoizedState=null,l.updateQueue=null,vr(f)?(w=!0,vh(l)):w=!1,l.memoizedState=y.state!==null&&y.state!==void 0?y.state:null,Om(l),y.updater=Dh,l.stateNode=y,y._reactInternals=l,eg(l,f,s,u),l=ig(null,l,f,!0,w,u)):(l.tag=0,cn&&w&&Em(l),hr(null,l,y,u),l=l.child),l;case 16:f=l.elementType;e:{switch(Mh(s,l),s=l.pendingProps,y=f._init,f=y(f._payload),l.type=f,y=l.tag=OC(f),s=di(f,s),y){case 0:l=rg(null,l,f,s,u);break e;case 1:l=mv(null,l,f,s,u);break e;case 11:l=uv(null,l,f,s,u);break e;case 14:l=dv(null,l,f,di(f.type,s),u);break e}throw Error(t(306,f,""))}return l;case 0:return f=l.type,y=l.pendingProps,y=l.elementType===f?y:di(f,y),rg(s,l,f,y,u);case 1:return f=l.type,y=l.pendingProps,y=l.elementType===f?y:di(f,y),mv(s,l,f,y,u);case 3:e:{if(gv(l),s===null)throw Error(t(387));f=l.pendingProps,w=l.memoizedState,y=w.element,Ab(s,l),Rh(l,f,null,u);var E=l.memoizedState;if(f=E.element,w.isDehydrated)if(w={element:f,isDehydrated:!1,cache:E.cache,pendingSuspenseBoundaries:E.pendingSuspenseBoundaries,transitions:E.transitions},l.updateQueue.baseState=w,l.memoizedState=w,l.flags&256){y=Sl(Error(t(423)),l),l=yv(s,l,f,u,y);break e}else if(f!==y){y=Sl(Error(t(424)),l),l=yv(s,l,f,u,y);break e}else for(Lr=qo(l.stateNode.containerInfo.firstChild),Mr=l,cn=!0,ui=null,u=Rb(l,null,f,u),l.child=u;u;)u.flags=u.flags&-3|4096,u=u.sibling;else{if(yl(),f===y){l=ao(s,l,u);break e}hr(s,l,f,u)}l=l.child}return l;case 5:return Fb(l),s===null&&Bm(l),f=l.type,y=l.pendingProps,w=s!==null?s.memoizedProps:null,E=y.children,Tm(f,y)?E=null:w!==null&&Tm(f,w)&&(l.flags|=32),fv(s,l),hr(s,l,E,u),l.child;case 6:return s===null&&Bm(l),null;case 13:return xv(s,l,u);case 4:return Wm(l,l.stateNode.containerInfo),f=l.pendingProps,s===null?l.child=xl(l,null,f,u):hr(s,l,f,u),l.child;case 11:return f=l.type,y=l.pendingProps,y=l.elementType===f?y:di(f,y),uv(s,l,f,y,u);case 7:return hr(s,l,l.pendingProps,u),l.child;case 8:return hr(s,l,l.pendingProps.children,u),l.child;case 12:return hr(s,l,l.pendingProps.children,u),l.child;case 10:e:{if(f=l.type._context,y=l.pendingProps,w=l.memoizedProps,E=y.value,Zt(jh,f._currentValue),f._currentValue=E,w!==null)if(ci(w.value,E)){if(w.children===y.children&&!br.current){l=ao(s,l,u);break e}}else for(w=l.child,w!==null&&(w.return=l);w!==null;){var V=w.dependencies;if(V!==null){E=w.child;for(var Z=V.firstContext;Z!==null;){if(Z.context===f){if(w.tag===1){Z=so(-1,u&-u),Z.tag=2;var ge=w.updateQueue;if(ge!==null){ge=ge.shared;var Be=ge.pending;Be===null?Z.next=Z:(Z.next=Be.next,Be.next=Z),ge.pending=Z}}w.lanes|=u,Z=w.alternate,Z!==null&&(Z.lanes|=u),Mm(w.return,u,l),V.lanes|=u;break}Z=Z.next}}else if(w.tag===10)E=w.type===l.type?null:w.child;else if(w.tag===18){if(E=w.return,E===null)throw Error(t(341));E.lanes|=u,V=E.alternate,V!==null&&(V.lanes|=u),Mm(E,u,l),E=w.sibling}else E=w.child;if(E!==null)E.return=w;else for(E=w;E!==null;){if(E===l){E=null;break}if(w=E.sibling,w!==null){w.return=E.return,E=w;break}E=E.return}w=E}hr(s,l,y.children,u),l=l.child}return l;case 9:return y=l.type,f=l.pendingProps.children,vl(l,u),y=Xr(y),f=f(y),l.flags|=1,hr(s,l,f,u),l.child;case 14:return f=l.type,y=di(f,l.pendingProps),y=di(f.type,y),dv(s,l,f,y,u);case 15:return hv(s,l,l.type,l.pendingProps,u);case 17:return f=l.type,y=l.pendingProps,y=l.elementType===f?y:di(f,y),Mh(s,l),l.tag=1,vr(f)?(s=!0,vh(l)):s=!1,vl(l,u),rv(l,f,y),eg(l,f,y,u),ig(null,l,f,!0,s,u);case 19:return vv(s,l,u);case 22:return pv(s,l,u)}throw Error(t(156,l.tag))};function qv(s,l){return Ga(s,l)}function LC(s,l,u,f){this.tag=s,this.key=u,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=l,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=f,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ei(s,l,u,f){return new LC(s,l,u,f)}function Tg(s){return s=s.prototype,!(!s||!s.isReactComponent)}function OC(s){if(typeof s=="function")return Tg(s)?1:0;if(s!=null){if(s=s.$$typeof,s===B)return 11;if(s===oe)return 14}return 2}function ts(s,l){var u=s.alternate;return u===null?(u=ei(s.tag,l,s.key,s.mode),u.elementType=s.elementType,u.type=s.type,u.stateNode=s.stateNode,u.alternate=s,s.alternate=u):(u.pendingProps=l,u.type=s.type,u.flags=0,u.subtreeFlags=0,u.deletions=null),u.flags=s.flags&14680064,u.childLanes=s.childLanes,u.lanes=s.lanes,u.child=s.child,u.memoizedProps=s.memoizedProps,u.memoizedState=s.memoizedState,u.updateQueue=s.updateQueue,l=s.dependencies,u.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext},u.sibling=s.sibling,u.index=s.index,u.ref=s.ref,u}function Qh(s,l,u,f,y,w){var E=2;if(f=s,typeof s=="function")Tg(s)&&(E=1);else if(typeof s=="string")E=5;else e:switch(s){case L:return ia(u.children,y,w,l);case C:E=8,y|=8;break;case A:return s=ei(12,u,l,y|2),s.elementType=A,s.lanes=w,s;case _:return s=ei(13,u,l,y),s.elementType=_,s.lanes=w,s;case U:return s=ei(19,u,l,y),s.elementType=U,s.lanes=w,s;case ce:return Yh(u,y,w,l);default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case D:E=10;break e;case M:E=9;break e;case B:E=11;break e;case oe:E=14;break e;case X:E=16,f=null;break e}throw Error(t(130,s==null?s:typeof s,""))}return l=ei(E,u,l,y),l.elementType=s,l.type=f,l.lanes=w,l}function ia(s,l,u,f){return s=ei(7,s,f,l),s.lanes=u,s}function Yh(s,l,u,f){return s=ei(22,s,f,l),s.elementType=ce,s.lanes=u,s.stateNode={isHidden:!1},s}function _g(s,l,u){return s=ei(6,s,null,l),s.lanes=u,s}function jg(s,l,u){return l=ei(4,s.children!==null?s.children:[],s.key,l),l.lanes=u,l.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},l}function WC(s,l,u,f,y){this.tag=l,this.containerInfo=s,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Do(0),this.expirationTimes=Do(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Do(0),this.identifierPrefix=f,this.onRecoverableError=y,this.mutableSourceEagerHydrationData=null}function Ig(s,l,u,f,y,w,E,V,Z){return s=new WC(s,l,u,V,Z),l===1?(l=1,w===!0&&(l|=8)):l=0,w=ei(3,null,null,l),s.current=w,w.stateNode=s,w.memoizedState={element:f,isDehydrated:u,cache:null,transitions:null,pendingSuspenseBoundaries:null},Om(w),s}function VC(s,l,u){var f=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:O,key:f==null?null:""+f,children:s,containerInfo:l,implementation:u}}function Hv(s){if(!s)return $o;s=s._reactInternals;e:{if(ni(s)!==s||s.tag!==1)throw Error(t(170));var l=s;do{switch(l.tag){case 3:l=l.stateNode.context;break e;case 1:if(vr(l.type)){l=l.stateNode.__reactInternalMemoizedMergedChildContext;break e}}l=l.return}while(l!==null);throw Error(t(171))}if(s.tag===1){var u=s.type;if(vr(u))return bb(s,u,l)}return l}function $v(s,l,u,f,y,w,E,V,Z){return s=Ig(u,f,!0,s,y,w,E,V,Z),s.context=Hv(null),u=s.current,f=pr(),y=Zo(u),w=so(f,y),w.callback=l??null,Qo(u,w,y),s.current.lanes=y,No(s,y,f),kr(s,f),s}function Xh(s,l,u,f){var y=l.current,w=pr(),E=Zo(y);return u=Hv(u),l.context===null?l.context=u:l.pendingContext=u,l=so(w,E),l.payload={element:s},f=f===void 0?null:f,f!==null&&(l.callback=f),s=Qo(y,l,E),s!==null&&(fi(s,y,E,w),Ch(s,y,E)),E}function Jh(s){if(s=s.current,!s.child)return null;switch(s.child.tag){case 5:return s.child.stateNode;default:return s.child.stateNode}}function Gv(s,l){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var u=s.retryLane;s.retryLane=u!==0&&u<l?u:l}}function Cg(s,l){Gv(s,l),(s=s.alternate)&&Gv(s,l)}function UC(){return null}var Kv=typeof reportError=="function"?reportError:function(s){console.error(s)};function Rg(s){this._internalRoot=s}Zh.prototype.render=Rg.prototype.render=function(s){var l=this._internalRoot;if(l===null)throw Error(t(409));Xh(s,l,null,null)},Zh.prototype.unmount=Rg.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var l=s.containerInfo;ta(function(){Xh(null,s,null,null)}),l[to]=null}};function Zh(s){this._internalRoot=s}Zh.prototype.unstable_scheduleHydration=function(s){if(s){var l=Zd();s={blockedOn:null,target:s,priority:l};for(var u=0;u<Ti.length&&l!==0&&l<Ti[u].priority;u++);Ti.splice(u,0,s),u===0&&nh(s)}};function Eg(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function ep(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11&&(s.nodeType!==8||s.nodeValue!==" react-mount-point-unstable "))}function Qv(){}function qC(s,l,u,f,y){if(y){if(typeof f=="function"){var w=f;f=function(){var ge=Jh(E);w.call(ge)}}var E=$v(l,f,s,0,null,!1,!1,"",Qv);return s._reactRootContainer=E,s[to]=E.current,ru(s.nodeType===8?s.parentNode:s),ta(),E}for(;y=s.lastChild;)s.removeChild(y);if(typeof f=="function"){var V=f;f=function(){var ge=Jh(Z);V.call(ge)}}var Z=Ig(s,0,!1,null,null,!1,!1,"",Qv);return s._reactRootContainer=Z,s[to]=Z.current,ru(s.nodeType===8?s.parentNode:s),ta(function(){Xh(l,Z,u,f)}),Z}function tp(s,l,u,f,y){var w=u._reactRootContainer;if(w){var E=w;if(typeof y=="function"){var V=y;y=function(){var Z=Jh(E);V.call(Z)}}Xh(l,E,s,y)}else E=qC(u,l,s,y,f);return Jh(E)}Xd=function(s){switch(s.tag){case 3:var l=s.stateNode;if(l.current.memoizedState.isDehydrated){var u=zo(l.pendingLanes);u!==0&&(Mo(l,u|1),kr(l,Jt()),(Ft&6)===0&&(_l=Jt()+500,Go()))}break;case 13:ta(function(){var f=oo(s,1);if(f!==null){var y=pr();fi(f,s,1,y)}}),Cg(s,1)}},Ya=function(s){if(s.tag===13){var l=oo(s,134217728);if(l!==null){var u=pr();fi(l,s,134217728,u)}Cg(s,134217728)}},Jd=function(s){if(s.tag===13){var l=Zo(s),u=oo(s,l);if(u!==null){var f=pr();fi(u,s,l,f)}Cg(s,l)}},Zd=function(){return Rt},eh=function(s,l){var u=Rt;try{return Rt=s,l()}finally{Rt=u}},Te=function(s,l,u){switch(l){case"input":if(_e(s,u),l=u.name,u.type==="radio"&&l!=null){for(u=s;u.parentNode;)u=u.parentNode;for(u=u.querySelectorAll("input[name="+JSON.stringify(""+l)+'][type="radio"]'),l=0;l<u.length;l++){var f=u[l];if(f!==s&&f.form===s.form){var y=xh(f);if(!y)throw Error(t(90));ae(f),_e(f,y)}}}break;case"textarea":Me(s,u);break;case"select":l=u.value,l!=null&&K(s,!!u.multiple,l,!1)}},_t=wg,xn=ta;var HC={usingClientEntryPoint:!1,Events:[su,hl,xh,gt,mt,wg]},vu={findFiberByHostInstance:Gs,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},$C={bundleType:vu.bundleType,version:vu.version,rendererPackageName:vu.rendererPackageName,rendererConfig:vu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:H.ReactCurrentDispatcher,findHostInstanceByFiber:function(s){return s=Wc(s),s===null?null:s.stateNode},findFiberByHostInstance:vu.findFiberByHostInstance||UC,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var np=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!np.isDisabled&&np.supportsFiber)try{Os=np.inject($C),Fr=np}catch{}}return Tr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=HC,Tr.createPortal=function(s,l){var u=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Eg(l))throw Error(t(200));return VC(s,l,null,u)},Tr.createRoot=function(s,l){if(!Eg(s))throw Error(t(299));var u=!1,f="",y=Kv;return l!=null&&(l.unstable_strictMode===!0&&(u=!0),l.identifierPrefix!==void 0&&(f=l.identifierPrefix),l.onRecoverableError!==void 0&&(y=l.onRecoverableError)),l=Ig(s,1,!1,null,null,u,!1,f,y),s[to]=l.current,ru(s.nodeType===8?s.parentNode:s),new Rg(l)},Tr.findDOMNode=function(s){if(s==null)return null;if(s.nodeType===1)return s;var l=s._reactInternals;if(l===void 0)throw typeof s.render=="function"?Error(t(188)):(s=Object.keys(s).join(","),Error(t(268,s)));return s=Wc(l),s=s===null?null:s.stateNode,s},Tr.flushSync=function(s){return ta(s)},Tr.hydrate=function(s,l,u){if(!ep(l))throw Error(t(200));return tp(null,s,l,!0,u)},Tr.hydrateRoot=function(s,l,u){if(!Eg(s))throw Error(t(405));var f=u!=null&&u.hydratedSources||null,y=!1,w="",E=Kv;if(u!=null&&(u.unstable_strictMode===!0&&(y=!0),u.identifierPrefix!==void 0&&(w=u.identifierPrefix),u.onRecoverableError!==void 0&&(E=u.onRecoverableError)),l=$v(l,null,s,1,u??null,y,!1,w,E),s[to]=l.current,ru(s),f)for(s=0;s<f.length;s++)u=f[s],y=u._getVersion,y=y(u._source),l.mutableSourceEagerHydrationData==null?l.mutableSourceEagerHydrationData=[u,y]:l.mutableSourceEagerHydrationData.push(u,y);return new Zh(l)},Tr.render=function(s,l,u){if(!ep(l))throw Error(t(200));return tp(null,s,l,!1,u)},Tr.unmountComponentAtNode=function(s){if(!ep(s))throw Error(t(40));return s._reactRootContainer?(ta(function(){tp(null,null,s,!1,function(){s._reactRootContainer=null,s[to]=null})}),!0):!1},Tr.unstable_batchedUpdates=wg,Tr.unstable_renderSubtreeIntoContainer=function(s,l,u,f){if(!ep(u))throw Error(t(200));if(s==null||s._reactInternals===void 0)throw Error(t(38));return tp(s,l,u,!1,f)},Tr.version="18.3.1-next-f1338f8080-20240426",Tr}var r1;function vk(){if(r1)return Bg.exports;r1=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),Bg.exports=tR(),Bg.exports}var i1;function nR(){if(i1)return rp;i1=1;var n=vk();return rp.createRoot=n.createRoot,rp.hydrateRoot=n.hydrateRoot,rp}var rR=nR(),v=cx();const Un=QC(v),iR=KC({__proto__:null,default:Un},[v]);vk();/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Yu(){return Yu=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},Yu.apply(this,arguments)}var us;(function(n){n.Pop="POP",n.Push="PUSH",n.Replace="REPLACE"})(us||(us={}));const o1="popstate";function oR(n){n===void 0&&(n={});function e(r,o){let{pathname:a,search:c,hash:d}=r.location;return py("",{pathname:a,search:c,hash:d},o.state&&o.state.usr||null,o.state&&o.state.key||"default")}function t(r,o){return typeof o=="string"?o:Sk(o)}return aR(e,t,null,n)}function Bn(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function wk(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function sR(){return Math.random().toString(36).substr(2,8)}function s1(n,e){return{usr:n.state,key:n.key,idx:e}}function py(n,e,t,r){return t===void 0&&(t=null),Yu({pathname:typeof n=="string"?n:n.pathname,search:"",hash:""},typeof e=="string"?wc(e):e,{state:t,key:e&&e.key||r||sR()})}function Sk(n){let{pathname:e="/",search:t="",hash:r=""}=n;return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function wc(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substr(t),n=n.substr(0,t));let r=n.indexOf("?");r>=0&&(e.search=n.substr(r),n=n.substr(0,r)),n&&(e.pathname=n)}return e}function aR(n,e,t,r){r===void 0&&(r={});let{window:o=document.defaultView,v5Compat:a=!1}=r,c=o.history,d=us.Pop,h=null,m=g();m==null&&(m=0,c.replaceState(Yu({},c.state,{idx:m}),""));function g(){return(c.state||{idx:null}).idx}function x(){d=us.Pop;let I=g(),F=I==null?null:I-m;m=I,h&&h({action:d,location:R.location,delta:F})}function S(I,F){d=us.Push;let P=py(R.location,I,F);m=g()+1;let z=s1(P,m),H=R.createHref(P);try{c.pushState(z,"",H)}catch(J){if(J instanceof DOMException&&J.name==="DataCloneError")throw J;o.location.assign(H)}a&&h&&h({action:d,location:R.location,delta:1})}function j(I,F){d=us.Replace;let P=py(R.location,I,F);m=g();let z=s1(P,m),H=R.createHref(P);c.replaceState(z,"",H),a&&h&&h({action:d,location:R.location,delta:0})}function T(I){let F=o.location.origin!=="null"?o.location.origin:o.location.href,P=typeof I=="string"?I:Sk(I);return P=P.replace(/ $/,"%20"),Bn(F,"No window.location.(origin|href) available to create URL for href: "+P),new URL(P,F)}let R={get action(){return d},get location(){return n(o,c)},listen(I){if(h)throw new Error("A history only accepts one active listener");return o.addEventListener(o1,x),h=I,()=>{o.removeEventListener(o1,x),h=null}},createHref(I){return e(o,I)},createURL:T,encodeLocation(I){let F=T(I);return{pathname:F.pathname,search:F.search,hash:F.hash}},push:S,replace:j,go(I){return c.go(I)}};return R}var a1;(function(n){n.data="data",n.deferred="deferred",n.redirect="redirect",n.error="error"})(a1||(a1={}));function lR(n,e,t){return t===void 0&&(t="/"),cR(n,e,t)}function cR(n,e,t,r){let o=typeof e=="string"?wc(e):e,a=_k(o.pathname||"/",t);if(a==null)return null;let c=kk(n);uR(c);let d=null;for(let h=0;d==null&&h<c.length;++h){let m=SR(a);d=bR(c[h],m)}return d}function kk(n,e,t,r){e===void 0&&(e=[]),t===void 0&&(t=[]),r===void 0&&(r="");let o=(a,c,d)=>{let h={relativePath:d===void 0?a.path||"":d,caseSensitive:a.caseSensitive===!0,childrenIndex:c,route:a};h.relativePath.startsWith("/")&&(Bn(h.relativePath.startsWith(r),'Absolute route path "'+h.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),h.relativePath=h.relativePath.slice(r.length));let m=xa([r,h.relativePath]),g=t.concat(h);a.children&&a.children.length>0&&(Bn(a.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+m+'".')),kk(a.children,e,g,m)),!(a.path==null&&!a.index)&&e.push({path:m,score:yR(m,a.index),routesMeta:g})};return n.forEach((a,c)=>{var d;if(a.path===""||!((d=a.path)!=null&&d.includes("?")))o(a,c);else for(let h of Tk(a.path))o(a,c,h)}),e}function Tk(n){let e=n.split("/");if(e.length===0)return[];let[t,...r]=e,o=t.endsWith("?"),a=t.replace(/\?$/,"");if(r.length===0)return o?[a,""]:[a];let c=Tk(r.join("/")),d=[];return d.push(...c.map(h=>h===""?a:[a,h].join("/"))),o&&d.push(...c),d.map(h=>n.startsWith("/")&&h===""?"/":h)}function uR(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:xR(e.routesMeta.map(r=>r.childrenIndex),t.routesMeta.map(r=>r.childrenIndex)))}const dR=/^:[\w-]+$/,hR=3,pR=2,fR=1,mR=10,gR=-2,l1=n=>n==="*";function yR(n,e){let t=n.split("/"),r=t.length;return t.some(l1)&&(r+=gR),e&&(r+=pR),t.filter(o=>!l1(o)).reduce((o,a)=>o+(dR.test(a)?hR:a===""?fR:mR),r)}function xR(n,e){return n.length===e.length&&n.slice(0,-1).every((r,o)=>r===e[o])?n[n.length-1]-e[e.length-1]:0}function bR(n,e,t){let{routesMeta:r}=n,o={},a="/",c=[];for(let d=0;d<r.length;++d){let h=r[d],m=d===r.length-1,g=a==="/"?e:e.slice(a.length)||"/",x=vR({path:h.relativePath,caseSensitive:h.caseSensitive,end:m},g),S=h.route;if(!x)return null;Object.assign(o,x.params),c.push({params:o,pathname:xa([a,x.pathname]),pathnameBase:CR(xa([a,x.pathnameBase])),route:S}),x.pathnameBase!=="/"&&(a=xa([a,x.pathnameBase]))}return c}function vR(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,r]=wR(n.path,n.caseSensitive,n.end),o=e.match(t);if(!o)return null;let a=o[0],c=a.replace(/(.)\/+$/,"$1"),d=o.slice(1);return{params:r.reduce((m,g,x)=>{let{paramName:S,isOptional:j}=g;if(S==="*"){let R=d[x]||"";c=a.slice(0,a.length-R.length).replace(/(.)\/+$/,"$1")}const T=d[x];return j&&!T?m[S]=void 0:m[S]=(T||"").replace(/%2F/g,"/"),m},{}),pathname:a,pathnameBase:c,pattern:n}}function wR(n,e,t){e===void 0&&(e=!1),t===void 0&&(t=!0),wk(n==="*"||!n.endsWith("*")||n.endsWith("/*"),'Route path "'+n+'" will be treated as if it were '+('"'+n.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+n.replace(/\*$/,"/*")+'".'));let r=[],o="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(c,d,h)=>(r.push({paramName:d,isOptional:h!=null}),h?"/?([^\\/]+)?":"/([^\\/]+)"));return n.endsWith("*")?(r.push({paramName:"*"}),o+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?o+="\\/*$":n!==""&&n!=="/"&&(o+="(?:(?=\\/|$))"),[new RegExp(o,e?void 0:"i"),r]}function SR(n){try{return n.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return wk(!1,'The URL path "'+n+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),n}}function _k(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,r=n.charAt(t);return r&&r!=="/"?null:n.slice(t)||"/"}function kR(n,e){e===void 0&&(e="/");let{pathname:t,search:r="",hash:o=""}=typeof n=="string"?wc(n):n;return{pathname:t?t.startsWith("/")?t:TR(t,e):e,search:RR(r),hash:ER(o)}}function TR(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(o=>{o===".."?t.length>1&&t.pop():o!=="."&&t.push(o)}),t.length>1?t.join("/"):"/"}function Dg(n,e,t,r){return"Cannot include a '"+n+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+t+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function _R(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function jR(n,e){let t=_R(n);return e?t.map((r,o)=>o===t.length-1?r.pathname:r.pathnameBase):t.map(r=>r.pathnameBase)}function IR(n,e,t,r){r===void 0&&(r=!1);let o;typeof n=="string"?o=wc(n):(o=Yu({},n),Bn(!o.pathname||!o.pathname.includes("?"),Dg("?","pathname","search",o)),Bn(!o.pathname||!o.pathname.includes("#"),Dg("#","pathname","hash",o)),Bn(!o.search||!o.search.includes("#"),Dg("#","search","hash",o)));let a=n===""||o.pathname==="",c=a?"/":o.pathname,d;if(c==null)d=t;else{let x=e.length-1;if(!r&&c.startsWith("..")){let S=c.split("/");for(;S[0]==="..";)S.shift(),x-=1;o.pathname=S.join("/")}d=x>=0?e[x]:"/"}let h=kR(o,d),m=c&&c!=="/"&&c.endsWith("/"),g=(a||c===".")&&t.endsWith("/");return!h.pathname.endsWith("/")&&(m||g)&&(h.pathname+="/"),h}const xa=n=>n.join("/").replace(/\/\/+/g,"/"),CR=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),RR=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,ER=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n;function AR(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}const jk=["post","put","patch","delete"];new Set(jk);const PR=["get",...jk];new Set(PR);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Xu(){return Xu=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},Xu.apply(this,arguments)}const ux=v.createContext(null),BR=v.createContext(null),yf=v.createContext(null),xf=v.createContext(null),Ma=v.createContext({outlet:null,matches:[],isDataRoute:!1}),Ik=v.createContext(null);function bf(){return v.useContext(xf)!=null}function pd(){return bf()||Bn(!1),v.useContext(xf).location}function Ck(n){v.useContext(yf).static||v.useLayoutEffect(n)}function Et(){let{isDataRoute:n}=v.useContext(Ma);return n?GR():FR()}function FR(){bf()||Bn(!1);let n=v.useContext(ux),{basename:e,future:t,navigator:r}=v.useContext(yf),{matches:o}=v.useContext(Ma),{pathname:a}=pd(),c=JSON.stringify(jR(o,t.v7_relativeSplatPath)),d=v.useRef(!1);return Ck(()=>{d.current=!0}),v.useCallback(function(m,g){if(g===void 0&&(g={}),!d.current)return;if(typeof m=="number"){r.go(m);return}let x=IR(m,JSON.parse(c),a,g.relative==="path");n==null&&e!=="/"&&(x.pathname=x.pathname==="/"?e:xa([e,x.pathname])),(g.replace?r.replace:r.push)(x,g.state,g)},[e,r,c,a,n])}function zR(){let{matches:n}=v.useContext(Ma),e=n[n.length-1];return e?e.params:{}}function DR(n,e){return NR(n,e)}function NR(n,e,t,r){bf()||Bn(!1);let{navigator:o}=v.useContext(yf),{matches:a}=v.useContext(Ma),c=a[a.length-1],d=c?c.params:{};c&&c.pathname;let h=c?c.pathnameBase:"/";c&&c.route;let m=pd(),g;if(e){var x;let I=typeof e=="string"?wc(e):e;h==="/"||(x=I.pathname)!=null&&x.startsWith(h)||Bn(!1),g=I}else g=m;let S=g.pathname||"/",j=S;if(h!=="/"){let I=h.replace(/^\//,"").split("/");j="/"+S.replace(/^\//,"").split("/").slice(I.length).join("/")}let T=lR(n,{pathname:j}),R=VR(T&&T.map(I=>Object.assign({},I,{params:Object.assign({},d,I.params),pathname:xa([h,o.encodeLocation?o.encodeLocation(I.pathname).pathname:I.pathname]),pathnameBase:I.pathnameBase==="/"?h:xa([h,o.encodeLocation?o.encodeLocation(I.pathnameBase).pathname:I.pathnameBase])})),a,t,r);return e&&R?v.createElement(xf.Provider,{value:{location:Xu({pathname:"/",search:"",hash:"",state:null,key:"default"},g),navigationType:us.Pop}},R):R}function MR(){let n=$R(),e=AR(n)?n.status+" "+n.statusText:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,o={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return v.createElement(v.Fragment,null,v.createElement("h2",null,"Unexpected Application Error!"),v.createElement("h3",{style:{fontStyle:"italic"}},e),t?v.createElement("pre",{style:o},t):null,null)}const LR=v.createElement(MR,null);class OR extends v.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return this.state.error!==void 0?v.createElement(Ma.Provider,{value:this.props.routeContext},v.createElement(Ik.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function WR(n){let{routeContext:e,match:t,children:r}=n,o=v.useContext(ux);return o&&o.static&&o.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(o.staticContext._deepestRenderedBoundaryId=t.route.id),v.createElement(Ma.Provider,{value:e},r)}function VR(n,e,t,r){var o;if(e===void 0&&(e=[]),t===void 0&&(t=null),r===void 0&&(r=null),n==null){var a;if(!t)return null;if(t.errors)n=t.matches;else if((a=r)!=null&&a.v7_partialHydration&&e.length===0&&!t.initialized&&t.matches.length>0)n=t.matches;else return null}let c=n,d=(o=t)==null?void 0:o.errors;if(d!=null){let g=c.findIndex(x=>x.route.id&&(d==null?void 0:d[x.route.id])!==void 0);g>=0||Bn(!1),c=c.slice(0,Math.min(c.length,g+1))}let h=!1,m=-1;if(t&&r&&r.v7_partialHydration)for(let g=0;g<c.length;g++){let x=c[g];if((x.route.HydrateFallback||x.route.hydrateFallbackElement)&&(m=g),x.route.id){let{loaderData:S,errors:j}=t,T=x.route.loader&&S[x.route.id]===void 0&&(!j||j[x.route.id]===void 0);if(x.route.lazy||T){h=!0,m>=0?c=c.slice(0,m+1):c=[c[0]];break}}}return c.reduceRight((g,x,S)=>{let j,T=!1,R=null,I=null;t&&(j=d&&x.route.id?d[x.route.id]:void 0,R=x.route.errorElement||LR,h&&(m<0&&S===0?(KR("route-fallback"),T=!0,I=null):m===S&&(T=!0,I=x.route.hydrateFallbackElement||null)));let F=e.concat(c.slice(0,S+1)),P=()=>{let z;return j?z=R:T?z=I:x.route.Component?z=v.createElement(x.route.Component,null):x.route.element?z=x.route.element:z=g,v.createElement(WR,{match:x,routeContext:{outlet:g,matches:F,isDataRoute:t!=null},children:z})};return t&&(x.route.ErrorBoundary||x.route.errorElement||S===0)?v.createElement(OR,{location:t.location,revalidation:t.revalidation,component:R,error:j,children:P(),routeContext:{outlet:null,matches:F,isDataRoute:!0}}):P()},null)}var Rk=function(n){return n.UseBlocker="useBlocker",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n}(Rk||{}),Ek=function(n){return n.UseBlocker="useBlocker",n.UseLoaderData="useLoaderData",n.UseActionData="useActionData",n.UseRouteError="useRouteError",n.UseNavigation="useNavigation",n.UseRouteLoaderData="useRouteLoaderData",n.UseMatches="useMatches",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n.UseRouteId="useRouteId",n}(Ek||{});function UR(n){let e=v.useContext(ux);return e||Bn(!1),e}function qR(n){let e=v.useContext(BR);return e||Bn(!1),e}function HR(n){let e=v.useContext(Ma);return e||Bn(!1),e}function Ak(n){let e=HR(),t=e.matches[e.matches.length-1];return t.route.id||Bn(!1),t.route.id}function $R(){var n;let e=v.useContext(Ik),t=qR(),r=Ak();return e!==void 0?e:(n=t.errors)==null?void 0:n[r]}function GR(){let{router:n}=UR(Rk.UseNavigateStable),e=Ak(Ek.UseNavigateStable),t=v.useRef(!1);return Ck(()=>{t.current=!0}),v.useCallback(function(o,a){a===void 0&&(a={}),t.current&&(typeof o=="number"?n.navigate(o):n.navigate(o,Xu({fromRouteId:e},a)))},[n,e])}const c1={};function KR(n,e,t){c1[n]||(c1[n]=!0)}function QR(n,e){n==null||n.v7_startTransition,n==null||n.v7_relativeSplatPath}function yt(n){Bn(!1)}function YR(n){let{basename:e="/",children:t=null,location:r,navigationType:o=us.Pop,navigator:a,static:c=!1,future:d}=n;bf()&&Bn(!1);let h=e.replace(/^\/*/,"/"),m=v.useMemo(()=>({basename:h,navigator:a,static:c,future:Xu({v7_relativeSplatPath:!1},d)}),[h,d,a,c]);typeof r=="string"&&(r=wc(r));let{pathname:g="/",search:x="",hash:S="",state:j=null,key:T="default"}=r,R=v.useMemo(()=>{let I=_k(g,h);return I==null?null:{location:{pathname:I,search:x,hash:S,state:j,key:T},navigationType:o}},[h,g,x,S,j,T,o]);return R==null?null:v.createElement(yf.Provider,{value:m},v.createElement(xf.Provider,{children:t,value:R}))}function XR(n){let{children:e,location:t}=n;return DR(fy(e),t)}new Promise(()=>{});function fy(n,e){e===void 0&&(e=[]);let t=[];return v.Children.forEach(n,(r,o)=>{if(!v.isValidElement(r))return;let a=[...e,o];if(r.type===v.Fragment){t.push.apply(t,fy(r.props.children,a));return}r.type!==yt&&Bn(!1),!r.props.index||!r.props.children||Bn(!1);let c={id:r.props.id||a.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(c.children=fy(r.props.children,a)),t.push(c)}),t}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function my(n){return n===void 0&&(n=""),new URLSearchParams(typeof n=="string"||Array.isArray(n)||n instanceof URLSearchParams?n:Object.keys(n).reduce((e,t)=>{let r=n[t];return e.concat(Array.isArray(r)?r.map(o=>[t,o]):[[t,r]])},[]))}function JR(n,e){let t=my(n);return e&&e.forEach((r,o)=>{t.has(o)||e.getAll(o).forEach(a=>{t.append(o,a)})}),t}const ZR="6";try{window.__reactRouterVersion=ZR}catch{}const eE="startTransition",u1=iR[eE];function tE(n){let{basename:e,children:t,future:r,window:o}=n,a=v.useRef();a.current==null&&(a.current=oR({window:o,v5Compat:!0}));let c=a.current,[d,h]=v.useState({action:c.action,location:c.location}),{v7_startTransition:m}=r||{},g=v.useCallback(x=>{m&&u1?u1(()=>h(x)):h(x)},[h,m]);return v.useLayoutEffect(()=>c.listen(g),[c,g]),v.useEffect(()=>QR(r),[r]),v.createElement(YR,{basename:e,children:t,location:d.location,navigationType:d.action,navigator:c,future:r})}var d1;(function(n){n.UseScrollRestoration="useScrollRestoration",n.UseSubmit="useSubmit",n.UseSubmitFetcher="useSubmitFetcher",n.UseFetcher="useFetcher",n.useViewTransitionState="useViewTransitionState"})(d1||(d1={}));var h1;(function(n){n.UseFetcher="useFetcher",n.UseFetchers="useFetchers",n.UseScrollRestoration="useScrollRestoration"})(h1||(h1={}));function Pk(n){let e=v.useRef(my(n)),t=v.useRef(!1),r=pd(),o=v.useMemo(()=>JR(r.search,t.current?null:e.current),[r.search]),a=Et(),c=v.useCallback((d,h)=>{const m=my(typeof d=="function"?d(o):d);t.current=!0,a("?"+m,h)},[a,o]);return[o,c]}const nE=()=>{const[n,e]=v.useState(!0),[t,r]=v.useState(0),[o,a]=v.useState(!1),[c,d]=v.useState(!1),h=Et();return v.useEffect(()=>{(async()=>{r(1),a(!0),d(!0),await new Promise(g=>setTimeout(g,2e3)),await new Promise(g=>setTimeout(g,500)),r(0),await new Promise(g=>setTimeout(g,400)),h("/home")})()},[h]),i.jsxs("div",{style:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",background:"radial-gradient(ellipse 80% 60% at 50% 50%, #fff 0%, #e3eafc 70%, #b3c6f7 100%)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1e4,opacity:n?1:0,transition:"opacity 0.5s ease-in-out",overflow:"hidden"},children:[i.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",opacity:t,transition:"opacity 0.7s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative"},children:[i.jsx("div",{style:{position:"absolute",width:320,height:220,borderRadius:"50% / 40%",top:"50%",left:"50%",transform:"translate(-50%, -50%)",zIndex:1,pointerEvents:"none",animation:o?"halo-rotate 2.5s linear forwards":"none",opacity:.85,background:"conic-gradient(from 0deg, #fff 0deg, #ffd700 60deg, #b3c6f7 180deg, #fff 300deg, #fff 360deg)",filter:"blur(2px)"}}),i.jsx("div",{style:{position:"absolute",width:260,height:260,borderRadius:"50%",background:"radial-gradient(circle, #fff 0%, rgba(255,255,255,0.7) 50%, transparent 80%)",zIndex:2,top:"50%",left:"50%",transform:"translate(-50%, -50%)",pointerEvents:"none"}}),i.jsx("img",{src:"/ctx-logo.png",alt:"CTX Logo",style:{width:"200px",height:"200px",filter:"drop-shadow(0 8px 32px rgba(40, 40, 40, 0.35)) drop-shadow(0 2px 8px #fff)",zIndex:3,animation:c?"logo-scale-rotate 2.5s cubic-bezier(0.4,0,0.2,1) forwards":"none",transformOrigin:"50% 50%",transform:c?void 0:"scale(1) rotate(0deg)",opacity:c?void 0:1}}),i.jsx("div",{style:{marginTop:"20px",color:"#232946",fontSize:"24px",fontWeight:"bold",textAlign:"center",textShadow:"0 2px 8px rgba(255,255,255,0.5)",zIndex:3},children:"Restarter™"}),i.jsx("div",{style:{marginTop:"8px",color:"#ffd700",fontSize:"16px",textAlign:"center",textShadow:"0 2px 8px rgba(0, 0, 0, 0.1)",zIndex:3},children:"重啟人生的平台"})]}),i.jsx("style",{children:`
        @keyframes halo-rotate {
          0% { transform: translate(-50%, -50%) rotate(0deg); }
          100% { transform: translate(-50%, -50%) rotate(360deg); }
        }
        @keyframes logo-scale-rotate {
          0% { transform: scale(0.1) rotate(-180deg); opacity: 0.2; }
          20% { opacity: 1; }
          100% { transform: scale(1) rotate(0deg); opacity: 1; }
        }
      `})]})},rE=()=>{};var p1={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bk=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let o=n.charCodeAt(r);o<128?e[t++]=o:o<2048?(e[t++]=o>>6|192,e[t++]=o&63|128):(o&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(o=65536+((o&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=o>>18|240,e[t++]=o>>12&63|128,e[t++]=o>>6&63|128,e[t++]=o&63|128):(e[t++]=o>>12|224,e[t++]=o>>6&63|128,e[t++]=o&63|128)}return e},iE=function(n){const e=[];let t=0,r=0;for(;t<n.length;){const o=n[t++];if(o<128)e[r++]=String.fromCharCode(o);else if(o>191&&o<224){const a=n[t++];e[r++]=String.fromCharCode((o&31)<<6|a&63)}else if(o>239&&o<365){const a=n[t++],c=n[t++],d=n[t++],h=((o&7)<<18|(a&63)<<12|(c&63)<<6|d&63)-65536;e[r++]=String.fromCharCode(55296+(h>>10)),e[r++]=String.fromCharCode(56320+(h&1023))}else{const a=n[t++],c=n[t++];e[r++]=String.fromCharCode((o&15)<<12|(a&63)<<6|c&63)}}return e.join("")},Fk={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let o=0;o<n.length;o+=3){const a=n[o],c=o+1<n.length,d=c?n[o+1]:0,h=o+2<n.length,m=h?n[o+2]:0,g=a>>2,x=(a&3)<<4|d>>4;let S=(d&15)<<2|m>>6,j=m&63;h||(j=64,c||(S=64)),r.push(t[g],t[x],t[S],t[j])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(Bk(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):iE(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let o=0;o<n.length;){const a=t[n.charAt(o++)],d=o<n.length?t[n.charAt(o)]:0;++o;const m=o<n.length?t[n.charAt(o)]:64;++o;const x=o<n.length?t[n.charAt(o)]:64;if(++o,a==null||d==null||m==null||x==null)throw new oE;const S=a<<2|d>>4;if(r.push(S),m!==64){const j=d<<4&240|m>>2;if(r.push(j),x!==64){const T=m<<6&192|x;r.push(T)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class oE extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const sE=function(n){const e=Bk(n);return Fk.encodeByteArray(e,!0)},Dp=function(n){return sE(n).replace(/\./g,"")},zk=function(n){try{return Fk.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dk(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aE=()=>Dk().__FIREBASE_DEFAULTS__,lE=()=>{if(typeof process>"u"||typeof p1>"u")return;const n=p1.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},cE=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&zk(n[1]);return e&&JSON.parse(e)},vf=()=>{try{return rE()||aE()||lE()||cE()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},Nk=n=>{var e,t;return(t=(e=vf())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},Mk=n=>{const e=Nk(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},Lk=()=>{var n;return(n=vf())===null||n===void 0?void 0:n.config},Ok=n=>{var e;return(e=vf())===null||e===void 0?void 0:e[`_${n}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uE{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jo(n){return n.endsWith(".cloudworkstations.dev")}async function wf(n){return(await fetch(n,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wk(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},r=e||"demo-project",o=n.iat||0,a=n.sub||n.user_id;if(!a)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const c=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:o,exp:o+3600,auth_time:o,sub:a,user_id:a,firebase:{sign_in_provider:"custom",identities:{}}},n);return[Dp(JSON.stringify(t)),Dp(JSON.stringify(c)),""].join(".")}const Nu={};function dE(){const n={prod:[],emulator:[]};for(const e of Object.keys(Nu))Nu[e]?n.emulator.push(e):n.prod.push(e);return n}function hE(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let f1=!1;function dx(n,e){if(typeof window>"u"||typeof document>"u"||!jo(window.location.host)||Nu[n]===e||Nu[n]||f1)return;Nu[n]=e;function t(S){return`__firebase__banner__${S}`}const r="__firebase__banner",a=dE().prod.length>0;function c(){const S=document.getElementById(r);S&&S.remove()}function d(S){S.style.display="flex",S.style.background="#7faaf0",S.style.position="fixed",S.style.bottom="5px",S.style.left="5px",S.style.padding=".5em",S.style.borderRadius="5px",S.style.alignItems="center"}function h(S,j){S.setAttribute("width","24"),S.setAttribute("id",j),S.setAttribute("height","24"),S.setAttribute("viewBox","0 0 24 24"),S.setAttribute("fill","none"),S.style.marginLeft="-6px"}function m(){const S=document.createElement("span");return S.style.cursor="pointer",S.style.marginLeft="16px",S.style.fontSize="24px",S.innerHTML=" &times;",S.onclick=()=>{f1=!0,c()},S}function g(S,j){S.setAttribute("id",j),S.innerText="Learn more",S.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",S.setAttribute("target","__blank"),S.style.paddingLeft="5px",S.style.textDecoration="underline"}function x(){const S=hE(r),j=t("text"),T=document.getElementById(j)||document.createElement("span"),R=t("learnmore"),I=document.getElementById(R)||document.createElement("a"),F=t("preprendIcon"),P=document.getElementById(F)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(S.created){const z=S.element;d(z),g(I,R);const H=m();h(P,F),z.append(P,T,I,H),document.body.appendChild(z)}a?(T.innerText="Preview backend disconnected.",P.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(P.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,T.innerText="Preview backend running in this workspace."),T.setAttribute("id",j)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",x):x()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function pE(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Fn())}function Vk(){var n;const e=(n=vf())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function fE(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function mE(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function gE(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function yE(){const n=Fn();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function Uk(){return!Vk()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function qk(){return!Vk()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function Hk(){try{return typeof indexedDB=="object"}catch{return!1}}function xE(){return new Promise((n,e)=>{try{let t=!0;const r="validate-browser-context-for-indexeddb-analytics-module",o=self.indexedDB.open(r);o.onsuccess=()=>{o.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},o.onupgradeneeded=()=>{t=!1},o.onerror=()=>{var a;e(((a=o.error)===null||a===void 0?void 0:a.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bE="FirebaseError";class $i extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=bE,Object.setPrototypeOf(this,$i.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,fd.prototype.create)}}class fd{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){const r=t[0]||{},o=`${this.service}/${e}`,a=this.errors[e],c=a?vE(a,r):"Error",d=`${this.serviceName}: ${c} (${o}).`;return new $i(o,d,r)}}function vE(n,e){return n.replace(wE,(t,r)=>{const o=e[r];return o!=null?String(o):`<${r}?>`})}const wE=/\{\$([^}]+)}/g;function SE(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function bi(n,e){if(n===e)return!0;const t=Object.keys(n),r=Object.keys(e);for(const o of t){if(!r.includes(o))return!1;const a=n[o],c=e[o];if(m1(a)&&m1(c)){if(!bi(a,c))return!1}else if(a!==c)return!1}for(const o of r)if(!t.includes(o))return!1;return!0}function m1(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function md(n){const e=[];for(const[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(o=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(o))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function Au(n){const e={};return n.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[o,a]=r.split("=");e[decodeURIComponent(o)]=decodeURIComponent(a)}}),e}function Pu(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function kE(n,e){const t=new TE(n,e);return t.subscribe.bind(t)}class TE{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let o;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");_E(e,["next","error","complete"])?o=e:o={next:e,error:t,complete:r},o.next===void 0&&(o.next=Ng),o.error===void 0&&(o.error=Ng),o.complete===void 0&&(o.complete=Ng);const a=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?o.error(this.finalError):o.complete()}catch{}}),this.observers.push(o),a}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function _E(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Ng(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mt(n){return n&&n._delegate?n._delegate:n}class bs{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sa="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jE{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const r=new uE;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{const o=this.getOrInitializeService({instanceIdentifier:t});o&&r.resolve(o)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),o=(t=e==null?void 0:e.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(a){if(o)return null;throw a}else{if(o)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(CE(e))try{this.getOrInitializeService({instanceIdentifier:sa})}catch{}for(const[t,r]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(t);try{const a=this.getOrInitializeService({instanceIdentifier:o});r.resolve(a)}catch{}}}}clearInstance(e=sa){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=sa){return this.instances.has(e)}getOptions(e=sa){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const o=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[a,c]of this.instancesDeferred.entries()){const d=this.normalizeInstanceIdentifier(a);r===d&&c.resolve(o)}return o}onInit(e,t){var r;const o=this.normalizeInstanceIdentifier(t),a=(r=this.onInitCallbacks.get(o))!==null&&r!==void 0?r:new Set;a.add(e),this.onInitCallbacks.set(o,a);const c=this.instances.get(o);return c&&e(c,o),()=>{a.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const o of r)try{o(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:IE(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=sa){return this.component?this.component.multipleInstances?e:sa:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function IE(n){return n===sa?void 0:n}function CE(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RE{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new jE(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var jt;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(jt||(jt={}));const EE={debug:jt.DEBUG,verbose:jt.VERBOSE,info:jt.INFO,warn:jt.WARN,error:jt.ERROR,silent:jt.SILENT},AE=jt.INFO,PE={[jt.DEBUG]:"log",[jt.VERBOSE]:"log",[jt.INFO]:"info",[jt.WARN]:"warn",[jt.ERROR]:"error"},BE=(n,e,...t)=>{if(e<n.logLevel)return;const r=new Date().toISOString(),o=PE[e];if(o)console[o](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class hx{constructor(e){this.name=e,this._logLevel=AE,this._logHandler=BE,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in jt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?EE[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,jt.DEBUG,...e),this._logHandler(this,jt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,jt.VERBOSE,...e),this._logHandler(this,jt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,jt.INFO,...e),this._logHandler(this,jt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,jt.WARN,...e),this._logHandler(this,jt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,jt.ERROR,...e),this._logHandler(this,jt.ERROR,...e)}}const FE=(n,e)=>e.some(t=>n instanceof t);let g1,y1;function zE(){return g1||(g1=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function DE(){return y1||(y1=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const $k=new WeakMap,gy=new WeakMap,Gk=new WeakMap,Mg=new WeakMap,px=new WeakMap;function NE(n){const e=new Promise((t,r)=>{const o=()=>{n.removeEventListener("success",a),n.removeEventListener("error",c)},a=()=>{t(fs(n.result)),o()},c=()=>{r(n.error),o()};n.addEventListener("success",a),n.addEventListener("error",c)});return e.then(t=>{t instanceof IDBCursor&&$k.set(t,n)}).catch(()=>{}),px.set(e,n),e}function ME(n){if(gy.has(n))return;const e=new Promise((t,r)=>{const o=()=>{n.removeEventListener("complete",a),n.removeEventListener("error",c),n.removeEventListener("abort",c)},a=()=>{t(),o()},c=()=>{r(n.error||new DOMException("AbortError","AbortError")),o()};n.addEventListener("complete",a),n.addEventListener("error",c),n.addEventListener("abort",c)});gy.set(n,e)}let yy={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return gy.get(n);if(e==="objectStoreNames")return n.objectStoreNames||Gk.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return fs(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function LE(n){yy=n(yy)}function OE(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const r=n.call(Lg(this),e,...t);return Gk.set(r,e.sort?e.sort():[e]),fs(r)}:DE().includes(n)?function(...e){return n.apply(Lg(this),e),fs($k.get(this))}:function(...e){return fs(n.apply(Lg(this),e))}}function WE(n){return typeof n=="function"?OE(n):(n instanceof IDBTransaction&&ME(n),FE(n,zE())?new Proxy(n,yy):n)}function fs(n){if(n instanceof IDBRequest)return NE(n);if(Mg.has(n))return Mg.get(n);const e=WE(n);return e!==n&&(Mg.set(n,e),px.set(e,n)),e}const Lg=n=>px.get(n);function VE(n,e,{blocked:t,upgrade:r,blocking:o,terminated:a}={}){const c=indexedDB.open(n,e),d=fs(c);return r&&c.addEventListener("upgradeneeded",h=>{r(fs(c.result),h.oldVersion,h.newVersion,fs(c.transaction),h)}),t&&c.addEventListener("blocked",h=>t(h.oldVersion,h.newVersion,h)),d.then(h=>{a&&h.addEventListener("close",()=>a()),o&&h.addEventListener("versionchange",m=>o(m.oldVersion,m.newVersion,m))}).catch(()=>{}),d}const UE=["get","getKey","getAll","getAllKeys","count"],qE=["put","add","delete","clear"],Og=new Map;function x1(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Og.get(e))return Og.get(e);const t=e.replace(/FromIndex$/,""),r=e!==t,o=qE.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(o||UE.includes(t)))return;const a=async function(c,...d){const h=this.transaction(c,o?"readwrite":"readonly");let m=h.store;return r&&(m=m.index(d.shift())),(await Promise.all([m[t](...d),o&&h.done]))[0]};return Og.set(e,a),a}LE(n=>({...n,get:(e,t,r)=>x1(e,t)||n.get(e,t,r),has:(e,t)=>!!x1(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HE{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if($E(t)){const r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}}function $E(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const xy="@firebase/app",b1="0.13.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wo=new hx("@firebase/app"),GE="@firebase/app-compat",KE="@firebase/analytics-compat",QE="@firebase/analytics",YE="@firebase/app-check-compat",XE="@firebase/app-check",JE="@firebase/auth",ZE="@firebase/auth-compat",eA="@firebase/database",tA="@firebase/data-connect",nA="@firebase/database-compat",rA="@firebase/functions",iA="@firebase/functions-compat",oA="@firebase/installations",sA="@firebase/installations-compat",aA="@firebase/messaging",lA="@firebase/messaging-compat",cA="@firebase/performance",uA="@firebase/performance-compat",dA="@firebase/remote-config",hA="@firebase/remote-config-compat",pA="@firebase/storage",fA="@firebase/storage-compat",mA="@firebase/firestore",gA="@firebase/ai",yA="@firebase/firestore-compat",xA="firebase",bA="11.9.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Np="[DEFAULT]",vA={[xy]:"fire-core",[GE]:"fire-core-compat",[QE]:"fire-analytics",[KE]:"fire-analytics-compat",[XE]:"fire-app-check",[YE]:"fire-app-check-compat",[JE]:"fire-auth",[ZE]:"fire-auth-compat",[eA]:"fire-rtdb",[tA]:"fire-data-connect",[nA]:"fire-rtdb-compat",[rA]:"fire-fn",[iA]:"fire-fn-compat",[oA]:"fire-iid",[sA]:"fire-iid-compat",[aA]:"fire-fcm",[lA]:"fire-fcm-compat",[cA]:"fire-perf",[uA]:"fire-perf-compat",[dA]:"fire-rc",[hA]:"fire-rc-compat",[pA]:"fire-gcs",[fA]:"fire-gcs-compat",[mA]:"fire-fst",[yA]:"fire-fst-compat",[gA]:"fire-vertex","fire-js":"fire-js",[xA]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mp=new Map,wA=new Map,by=new Map;function v1(n,e){try{n.container.addComponent(e)}catch(t){wo.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function Ta(n){const e=n.name;if(by.has(e))return wo.debug(`There were multiple attempts to register component ${e}.`),!1;by.set(e,n);for(const t of Mp.values())v1(t,n);for(const t of wA.values())v1(t,n);return!0}function Sc(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function SA(n,e,t=Np){Sc(n,e).clearInstance(t)}function jr(n){return n==null?!1:n.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kA={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},ms=new fd("app","Firebase",kA);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TA{constructor(e,t,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new bs("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw ms.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const La=bA;function Kk(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const r=Object.assign({name:Np,automaticDataCollectionEnabled:!0},e),o=r.name;if(typeof o!="string"||!o)throw ms.create("bad-app-name",{appName:String(o)});if(t||(t=Lk()),!t)throw ms.create("no-options");const a=Mp.get(o);if(a){if(bi(t,a.options)&&bi(r,a.config))return a;throw ms.create("duplicate-app",{appName:o})}const c=new RE(o);for(const h of by.values())c.addComponent(h);const d=new TA(t,r,c);return Mp.set(o,d),d}function fx(n=Np){const e=Mp.get(n);if(!e&&n===Np&&Lk())return Kk();if(!e)throw ms.create("no-app",{appName:n});return e}function Oi(n,e,t){var r;let o=(r=vA[n])!==null&&r!==void 0?r:n;t&&(o+=`-${t}`);const a=o.match(/\s|\//),c=e.match(/\s|\//);if(a||c){const d=[`Unable to register library "${o}" with version "${e}":`];a&&d.push(`library name "${o}" contains illegal characters (whitespace or "/")`),a&&c&&d.push("and"),c&&d.push(`version name "${e}" contains illegal characters (whitespace or "/")`),wo.warn(d.join(" "));return}Ta(new bs(`${o}-version`,()=>({library:o,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _A="firebase-heartbeat-database",jA=1,Ju="firebase-heartbeat-store";let Wg=null;function Qk(){return Wg||(Wg=VE(_A,jA,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Ju)}catch(t){console.warn(t)}}}}).catch(n=>{throw ms.create("idb-open",{originalErrorMessage:n.message})})),Wg}async function IA(n){try{const t=(await Qk()).transaction(Ju),r=await t.objectStore(Ju).get(Yk(n));return await t.done,r}catch(e){if(e instanceof $i)wo.warn(e.message);else{const t=ms.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});wo.warn(t.message)}}}async function w1(n,e){try{const r=(await Qk()).transaction(Ju,"readwrite");await r.objectStore(Ju).put(e,Yk(n)),await r.done}catch(t){if(t instanceof $i)wo.warn(t.message);else{const r=ms.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});wo.warn(r.message)}}}function Yk(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CA=1024,RA=30;class EA{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new PA(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,t;try{const o=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),a=S1();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===a||this._heartbeatsCache.heartbeats.some(c=>c.date===a))return;if(this._heartbeatsCache.heartbeats.push({date:a,agent:o}),this._heartbeatsCache.heartbeats.length>RA){const c=BA(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(c,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){wo.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=S1(),{heartbeatsToSend:r,unsentEntries:o}=AA(this._heartbeatsCache.heartbeats),a=Dp(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,o.length>0?(this._heartbeatsCache.heartbeats=o,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),a}catch(t){return wo.warn(t),""}}}function S1(){return new Date().toISOString().substring(0,10)}function AA(n,e=CA){const t=[];let r=n.slice();for(const o of n){const a=t.find(c=>c.agent===o.agent);if(a){if(a.dates.push(o.date),k1(t)>e){a.dates.pop();break}}else if(t.push({agent:o.agent,dates:[o.date]}),k1(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}class PA{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Hk()?xE().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await IA(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const o=await this.read();return w1(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:o.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const o=await this.read();return w1(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:o.lastSentHeartbeatDate,heartbeats:[...o.heartbeats,...e.heartbeats]})}else return}}function k1(n){return Dp(JSON.stringify({version:2,heartbeats:n})).length}function BA(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let r=1;r<n.length;r++)n[r].date<t&&(t=n[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FA(n){Ta(new bs("platform-logger",e=>new HE(e),"PRIVATE")),Ta(new bs("heartbeat",e=>new EA(e),"PRIVATE")),Oi(xy,b1,n),Oi(xy,b1,"esm2017"),Oi("fire-js","")}FA("");var zA="firebase",DA="11.9.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Oi(zA,DA,"app");var T1=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var gs,Xk;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(L,C){function A(){}A.prototype=C.prototype,L.D=C.prototype,L.prototype=new A,L.prototype.constructor=L,L.C=function(D,M,B){for(var _=Array(arguments.length-2),U=2;U<arguments.length;U++)_[U-2]=arguments[U];return C.prototype[M].apply(D,_)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,t),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function o(L,C,A){A||(A=0);var D=Array(16);if(typeof C=="string")for(var M=0;16>M;++M)D[M]=C.charCodeAt(A++)|C.charCodeAt(A++)<<8|C.charCodeAt(A++)<<16|C.charCodeAt(A++)<<24;else for(M=0;16>M;++M)D[M]=C[A++]|C[A++]<<8|C[A++]<<16|C[A++]<<24;C=L.g[0],A=L.g[1],M=L.g[2];var B=L.g[3],_=C+(B^A&(M^B))+D[0]+3614090360&4294967295;C=A+(_<<7&4294967295|_>>>25),_=B+(M^C&(A^M))+D[1]+3905402710&4294967295,B=C+(_<<12&4294967295|_>>>20),_=M+(A^B&(C^A))+D[2]+606105819&4294967295,M=B+(_<<17&4294967295|_>>>15),_=A+(C^M&(B^C))+D[3]+3250441966&4294967295,A=M+(_<<22&4294967295|_>>>10),_=C+(B^A&(M^B))+D[4]+4118548399&4294967295,C=A+(_<<7&4294967295|_>>>25),_=B+(M^C&(A^M))+D[5]+1200080426&4294967295,B=C+(_<<12&4294967295|_>>>20),_=M+(A^B&(C^A))+D[6]+2821735955&4294967295,M=B+(_<<17&4294967295|_>>>15),_=A+(C^M&(B^C))+D[7]+4249261313&4294967295,A=M+(_<<22&4294967295|_>>>10),_=C+(B^A&(M^B))+D[8]+1770035416&4294967295,C=A+(_<<7&4294967295|_>>>25),_=B+(M^C&(A^M))+D[9]+2336552879&4294967295,B=C+(_<<12&4294967295|_>>>20),_=M+(A^B&(C^A))+D[10]+4294925233&4294967295,M=B+(_<<17&4294967295|_>>>15),_=A+(C^M&(B^C))+D[11]+2304563134&4294967295,A=M+(_<<22&4294967295|_>>>10),_=C+(B^A&(M^B))+D[12]+1804603682&4294967295,C=A+(_<<7&4294967295|_>>>25),_=B+(M^C&(A^M))+D[13]+4254626195&4294967295,B=C+(_<<12&4294967295|_>>>20),_=M+(A^B&(C^A))+D[14]+2792965006&4294967295,M=B+(_<<17&4294967295|_>>>15),_=A+(C^M&(B^C))+D[15]+1236535329&4294967295,A=M+(_<<22&4294967295|_>>>10),_=C+(M^B&(A^M))+D[1]+4129170786&4294967295,C=A+(_<<5&4294967295|_>>>27),_=B+(A^M&(C^A))+D[6]+3225465664&4294967295,B=C+(_<<9&4294967295|_>>>23),_=M+(C^A&(B^C))+D[11]+643717713&4294967295,M=B+(_<<14&4294967295|_>>>18),_=A+(B^C&(M^B))+D[0]+3921069994&4294967295,A=M+(_<<20&4294967295|_>>>12),_=C+(M^B&(A^M))+D[5]+3593408605&4294967295,C=A+(_<<5&4294967295|_>>>27),_=B+(A^M&(C^A))+D[10]+38016083&4294967295,B=C+(_<<9&4294967295|_>>>23),_=M+(C^A&(B^C))+D[15]+3634488961&4294967295,M=B+(_<<14&4294967295|_>>>18),_=A+(B^C&(M^B))+D[4]+3889429448&4294967295,A=M+(_<<20&4294967295|_>>>12),_=C+(M^B&(A^M))+D[9]+568446438&4294967295,C=A+(_<<5&4294967295|_>>>27),_=B+(A^M&(C^A))+D[14]+3275163606&4294967295,B=C+(_<<9&4294967295|_>>>23),_=M+(C^A&(B^C))+D[3]+4107603335&4294967295,M=B+(_<<14&4294967295|_>>>18),_=A+(B^C&(M^B))+D[8]+1163531501&4294967295,A=M+(_<<20&4294967295|_>>>12),_=C+(M^B&(A^M))+D[13]+2850285829&4294967295,C=A+(_<<5&4294967295|_>>>27),_=B+(A^M&(C^A))+D[2]+4243563512&4294967295,B=C+(_<<9&4294967295|_>>>23),_=M+(C^A&(B^C))+D[7]+1735328473&4294967295,M=B+(_<<14&4294967295|_>>>18),_=A+(B^C&(M^B))+D[12]+2368359562&4294967295,A=M+(_<<20&4294967295|_>>>12),_=C+(A^M^B)+D[5]+4294588738&4294967295,C=A+(_<<4&4294967295|_>>>28),_=B+(C^A^M)+D[8]+2272392833&4294967295,B=C+(_<<11&4294967295|_>>>21),_=M+(B^C^A)+D[11]+1839030562&4294967295,M=B+(_<<16&4294967295|_>>>16),_=A+(M^B^C)+D[14]+4259657740&4294967295,A=M+(_<<23&4294967295|_>>>9),_=C+(A^M^B)+D[1]+2763975236&4294967295,C=A+(_<<4&4294967295|_>>>28),_=B+(C^A^M)+D[4]+1272893353&4294967295,B=C+(_<<11&4294967295|_>>>21),_=M+(B^C^A)+D[7]+4139469664&4294967295,M=B+(_<<16&4294967295|_>>>16),_=A+(M^B^C)+D[10]+3200236656&4294967295,A=M+(_<<23&4294967295|_>>>9),_=C+(A^M^B)+D[13]+681279174&4294967295,C=A+(_<<4&4294967295|_>>>28),_=B+(C^A^M)+D[0]+3936430074&4294967295,B=C+(_<<11&4294967295|_>>>21),_=M+(B^C^A)+D[3]+3572445317&4294967295,M=B+(_<<16&4294967295|_>>>16),_=A+(M^B^C)+D[6]+76029189&4294967295,A=M+(_<<23&4294967295|_>>>9),_=C+(A^M^B)+D[9]+3654602809&4294967295,C=A+(_<<4&4294967295|_>>>28),_=B+(C^A^M)+D[12]+3873151461&4294967295,B=C+(_<<11&4294967295|_>>>21),_=M+(B^C^A)+D[15]+530742520&4294967295,M=B+(_<<16&4294967295|_>>>16),_=A+(M^B^C)+D[2]+3299628645&4294967295,A=M+(_<<23&4294967295|_>>>9),_=C+(M^(A|~B))+D[0]+4096336452&4294967295,C=A+(_<<6&4294967295|_>>>26),_=B+(A^(C|~M))+D[7]+1126891415&4294967295,B=C+(_<<10&4294967295|_>>>22),_=M+(C^(B|~A))+D[14]+2878612391&4294967295,M=B+(_<<15&4294967295|_>>>17),_=A+(B^(M|~C))+D[5]+4237533241&4294967295,A=M+(_<<21&4294967295|_>>>11),_=C+(M^(A|~B))+D[12]+1700485571&4294967295,C=A+(_<<6&4294967295|_>>>26),_=B+(A^(C|~M))+D[3]+2399980690&4294967295,B=C+(_<<10&4294967295|_>>>22),_=M+(C^(B|~A))+D[10]+4293915773&4294967295,M=B+(_<<15&4294967295|_>>>17),_=A+(B^(M|~C))+D[1]+2240044497&4294967295,A=M+(_<<21&4294967295|_>>>11),_=C+(M^(A|~B))+D[8]+1873313359&4294967295,C=A+(_<<6&4294967295|_>>>26),_=B+(A^(C|~M))+D[15]+4264355552&4294967295,B=C+(_<<10&4294967295|_>>>22),_=M+(C^(B|~A))+D[6]+2734768916&4294967295,M=B+(_<<15&4294967295|_>>>17),_=A+(B^(M|~C))+D[13]+1309151649&4294967295,A=M+(_<<21&4294967295|_>>>11),_=C+(M^(A|~B))+D[4]+4149444226&4294967295,C=A+(_<<6&4294967295|_>>>26),_=B+(A^(C|~M))+D[11]+3174756917&4294967295,B=C+(_<<10&4294967295|_>>>22),_=M+(C^(B|~A))+D[2]+718787259&4294967295,M=B+(_<<15&4294967295|_>>>17),_=A+(B^(M|~C))+D[9]+3951481745&4294967295,L.g[0]=L.g[0]+C&4294967295,L.g[1]=L.g[1]+(M+(_<<21&4294967295|_>>>11))&4294967295,L.g[2]=L.g[2]+M&4294967295,L.g[3]=L.g[3]+B&4294967295}r.prototype.u=function(L,C){C===void 0&&(C=L.length);for(var A=C-this.blockSize,D=this.B,M=this.h,B=0;B<C;){if(M==0)for(;B<=A;)o(this,L,B),B+=this.blockSize;if(typeof L=="string"){for(;B<C;)if(D[M++]=L.charCodeAt(B++),M==this.blockSize){o(this,D),M=0;break}}else for(;B<C;)if(D[M++]=L[B++],M==this.blockSize){o(this,D),M=0;break}}this.h=M,this.o+=C},r.prototype.v=function(){var L=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);L[0]=128;for(var C=1;C<L.length-8;++C)L[C]=0;var A=8*this.o;for(C=L.length-8;C<L.length;++C)L[C]=A&255,A/=256;for(this.u(L),L=Array(16),C=A=0;4>C;++C)for(var D=0;32>D;D+=8)L[A++]=this.g[C]>>>D&255;return L};function a(L,C){var A=d;return Object.prototype.hasOwnProperty.call(A,L)?A[L]:A[L]=C(L)}function c(L,C){this.h=C;for(var A=[],D=!0,M=L.length-1;0<=M;M--){var B=L[M]|0;D&&B==C||(A[M]=B,D=!1)}this.g=A}var d={};function h(L){return-128<=L&&128>L?a(L,function(C){return new c([C|0],0>C?-1:0)}):new c([L|0],0>L?-1:0)}function m(L){if(isNaN(L)||!isFinite(L))return x;if(0>L)return I(m(-L));for(var C=[],A=1,D=0;L>=A;D++)C[D]=L/A|0,A*=4294967296;return new c(C,0)}function g(L,C){if(L.length==0)throw Error("number format error: empty string");if(C=C||10,2>C||36<C)throw Error("radix out of range: "+C);if(L.charAt(0)=="-")return I(g(L.substring(1),C));if(0<=L.indexOf("-"))throw Error('number format error: interior "-" character');for(var A=m(Math.pow(C,8)),D=x,M=0;M<L.length;M+=8){var B=Math.min(8,L.length-M),_=parseInt(L.substring(M,M+B),C);8>B?(B=m(Math.pow(C,B)),D=D.j(B).add(m(_))):(D=D.j(A),D=D.add(m(_)))}return D}var x=h(0),S=h(1),j=h(16777216);n=c.prototype,n.m=function(){if(R(this))return-I(this).m();for(var L=0,C=1,A=0;A<this.g.length;A++){var D=this.i(A);L+=(0<=D?D:4294967296+D)*C,C*=4294967296}return L},n.toString=function(L){if(L=L||10,2>L||36<L)throw Error("radix out of range: "+L);if(T(this))return"0";if(R(this))return"-"+I(this).toString(L);for(var C=m(Math.pow(L,6)),A=this,D="";;){var M=H(A,C).g;A=F(A,M.j(C));var B=((0<A.g.length?A.g[0]:A.h)>>>0).toString(L);if(A=M,T(A))return B+D;for(;6>B.length;)B="0"+B;D=B+D}},n.i=function(L){return 0>L?0:L<this.g.length?this.g[L]:this.h};function T(L){if(L.h!=0)return!1;for(var C=0;C<L.g.length;C++)if(L.g[C]!=0)return!1;return!0}function R(L){return L.h==-1}n.l=function(L){return L=F(this,L),R(L)?-1:T(L)?0:1};function I(L){for(var C=L.g.length,A=[],D=0;D<C;D++)A[D]=~L.g[D];return new c(A,~L.h).add(S)}n.abs=function(){return R(this)?I(this):this},n.add=function(L){for(var C=Math.max(this.g.length,L.g.length),A=[],D=0,M=0;M<=C;M++){var B=D+(this.i(M)&65535)+(L.i(M)&65535),_=(B>>>16)+(this.i(M)>>>16)+(L.i(M)>>>16);D=_>>>16,B&=65535,_&=65535,A[M]=_<<16|B}return new c(A,A[A.length-1]&-2147483648?-1:0)};function F(L,C){return L.add(I(C))}n.j=function(L){if(T(this)||T(L))return x;if(R(this))return R(L)?I(this).j(I(L)):I(I(this).j(L));if(R(L))return I(this.j(I(L)));if(0>this.l(j)&&0>L.l(j))return m(this.m()*L.m());for(var C=this.g.length+L.g.length,A=[],D=0;D<2*C;D++)A[D]=0;for(D=0;D<this.g.length;D++)for(var M=0;M<L.g.length;M++){var B=this.i(D)>>>16,_=this.i(D)&65535,U=L.i(M)>>>16,oe=L.i(M)&65535;A[2*D+2*M]+=_*oe,P(A,2*D+2*M),A[2*D+2*M+1]+=B*oe,P(A,2*D+2*M+1),A[2*D+2*M+1]+=_*U,P(A,2*D+2*M+1),A[2*D+2*M+2]+=B*U,P(A,2*D+2*M+2)}for(D=0;D<C;D++)A[D]=A[2*D+1]<<16|A[2*D];for(D=C;D<2*C;D++)A[D]=0;return new c(A,0)};function P(L,C){for(;(L[C]&65535)!=L[C];)L[C+1]+=L[C]>>>16,L[C]&=65535,C++}function z(L,C){this.g=L,this.h=C}function H(L,C){if(T(C))throw Error("division by zero");if(T(L))return new z(x,x);if(R(L))return C=H(I(L),C),new z(I(C.g),I(C.h));if(R(C))return C=H(L,I(C)),new z(I(C.g),C.h);if(30<L.g.length){if(R(L)||R(C))throw Error("slowDivide_ only works with positive integers.");for(var A=S,D=C;0>=D.l(L);)A=J(A),D=J(D);var M=O(A,1),B=O(D,1);for(D=O(D,2),A=O(A,2);!T(D);){var _=B.add(D);0>=_.l(L)&&(M=M.add(A),B=_),D=O(D,1),A=O(A,1)}return C=F(L,M.j(C)),new z(M,C)}for(M=x;0<=L.l(C);){for(A=Math.max(1,Math.floor(L.m()/C.m())),D=Math.ceil(Math.log(A)/Math.LN2),D=48>=D?1:Math.pow(2,D-48),B=m(A),_=B.j(C);R(_)||0<_.l(L);)A-=D,B=m(A),_=B.j(C);T(B)&&(B=S),M=M.add(B),L=F(L,_)}return new z(M,L)}n.A=function(L){return H(this,L).h},n.and=function(L){for(var C=Math.max(this.g.length,L.g.length),A=[],D=0;D<C;D++)A[D]=this.i(D)&L.i(D);return new c(A,this.h&L.h)},n.or=function(L){for(var C=Math.max(this.g.length,L.g.length),A=[],D=0;D<C;D++)A[D]=this.i(D)|L.i(D);return new c(A,this.h|L.h)},n.xor=function(L){for(var C=Math.max(this.g.length,L.g.length),A=[],D=0;D<C;D++)A[D]=this.i(D)^L.i(D);return new c(A,this.h^L.h)};function J(L){for(var C=L.g.length+1,A=[],D=0;D<C;D++)A[D]=L.i(D)<<1|L.i(D-1)>>>31;return new c(A,L.h)}function O(L,C){var A=C>>5;C%=32;for(var D=L.g.length-A,M=[],B=0;B<D;B++)M[B]=0<C?L.i(B+A)>>>C|L.i(B+A+1)<<32-C:L.i(B+A);return new c(M,L.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,Xk=r,c.prototype.add=c.prototype.add,c.prototype.multiply=c.prototype.j,c.prototype.modulo=c.prototype.A,c.prototype.compare=c.prototype.l,c.prototype.toNumber=c.prototype.m,c.prototype.toString=c.prototype.toString,c.prototype.getBits=c.prototype.i,c.fromNumber=m,c.fromString=g,gs=c}).apply(typeof T1<"u"?T1:typeof self<"u"?self:typeof window<"u"?window:{});var ip=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Jk,Bu,Zk,xp,vy,eT,tT,nT;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(p,b,k){return p==Array.prototype||p==Object.prototype||(p[b]=k.value),p};function t(p){p=[typeof globalThis=="object"&&globalThis,p,typeof window=="object"&&window,typeof self=="object"&&self,typeof ip=="object"&&ip];for(var b=0;b<p.length;++b){var k=p[b];if(k&&k.Math==Math)return k}throw Error("Cannot find global object")}var r=t(this);function o(p,b){if(b)e:{var k=r;p=p.split(".");for(var N=0;N<p.length-1;N++){var de=p[N];if(!(de in k))break e;k=k[de]}p=p[p.length-1],N=k[p],b=b(N),b!=N&&b!=null&&e(k,p,{configurable:!0,writable:!0,value:b})}}function a(p,b){p instanceof String&&(p+="");var k=0,N=!1,de={next:function(){if(!N&&k<p.length){var we=k++;return{value:b(we,p[we]),done:!1}}return N=!0,{done:!0,value:void 0}}};return de[Symbol.iterator]=function(){return de},de}o("Array.prototype.values",function(p){return p||function(){return a(this,function(b,k){return k})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var c=c||{},d=this||self;function h(p){var b=typeof p;return b=b!="object"?b:p?Array.isArray(p)?"array":b:"null",b=="array"||b=="object"&&typeof p.length=="number"}function m(p){var b=typeof p;return b=="object"&&p!=null||b=="function"}function g(p,b,k){return p.call.apply(p.bind,arguments)}function x(p,b,k){if(!p)throw Error();if(2<arguments.length){var N=Array.prototype.slice.call(arguments,2);return function(){var de=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(de,N),p.apply(b,de)}}return function(){return p.apply(b,arguments)}}function S(p,b,k){return S=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?g:x,S.apply(null,arguments)}function j(p,b){var k=Array.prototype.slice.call(arguments,1);return function(){var N=k.slice();return N.push.apply(N,arguments),p.apply(this,N)}}function T(p,b){function k(){}k.prototype=b.prototype,p.aa=b.prototype,p.prototype=new k,p.prototype.constructor=p,p.Qb=function(N,de,we){for(var Oe=Array(arguments.length-2),Vt=2;Vt<arguments.length;Vt++)Oe[Vt-2]=arguments[Vt];return b.prototype[de].apply(N,Oe)}}function R(p){const b=p.length;if(0<b){const k=Array(b);for(let N=0;N<b;N++)k[N]=p[N];return k}return[]}function I(p,b){for(let k=1;k<arguments.length;k++){const N=arguments[k];if(h(N)){const de=p.length||0,we=N.length||0;p.length=de+we;for(let Oe=0;Oe<we;Oe++)p[de+Oe]=N[Oe]}else p.push(N)}}class F{constructor(b,k){this.i=b,this.j=k,this.h=0,this.g=null}get(){let b;return 0<this.h?(this.h--,b=this.g,this.g=b.next,b.next=null):b=this.i(),b}}function P(p){return/^[\s\xa0]*$/.test(p)}function z(){var p=d.navigator;return p&&(p=p.userAgent)?p:""}function H(p){return H[" "](p),p}H[" "]=function(){};var J=z().indexOf("Gecko")!=-1&&!(z().toLowerCase().indexOf("webkit")!=-1&&z().indexOf("Edge")==-1)&&!(z().indexOf("Trident")!=-1||z().indexOf("MSIE")!=-1)&&z().indexOf("Edge")==-1;function O(p,b,k){for(const N in p)b.call(k,p[N],N,p)}function L(p,b){for(const k in p)b.call(void 0,p[k],k,p)}function C(p){const b={};for(const k in p)b[k]=p[k];return b}const A="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function D(p,b){let k,N;for(let de=1;de<arguments.length;de++){N=arguments[de];for(k in N)p[k]=N[k];for(let we=0;we<A.length;we++)k=A[we],Object.prototype.hasOwnProperty.call(N,k)&&(p[k]=N[k])}}function M(p){var b=1;p=p.split(":");const k=[];for(;0<b&&p.length;)k.push(p.shift()),b--;return p.length&&k.push(p.join(":")),k}function B(p){d.setTimeout(()=>{throw p},0)}function _(){var p=te;let b=null;return p.g&&(b=p.g,p.g=p.g.next,p.g||(p.h=null),b.next=null),b}class U{constructor(){this.h=this.g=null}add(b,k){const N=oe.get();N.set(b,k),this.h?this.h.next=N:this.g=N,this.h=N}}var oe=new F(()=>new X,p=>p.reset());class X{constructor(){this.next=this.g=this.h=null}set(b,k){this.h=b,this.g=k,this.next=null}reset(){this.next=this.g=this.h=null}}let ce,le=!1,te=new U,xe=()=>{const p=d.Promise.resolve(void 0);ce=()=>{p.then($)}};var $=()=>{for(var p;p=_();){try{p.h.call(p.g)}catch(k){B(k)}var b=oe;b.j(p),100>b.h&&(b.h++,p.next=b.g,b.g=p)}le=!1};function Q(){this.s=this.s,this.C=this.C}Q.prototype.s=!1,Q.prototype.ma=function(){this.s||(this.s=!0,this.N())},Q.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function G(p,b){this.type=p,this.g=this.target=b,this.defaultPrevented=!1}G.prototype.h=function(){this.defaultPrevented=!0};var ne=function(){if(!d.addEventListener||!Object.defineProperty)return!1;var p=!1,b=Object.defineProperty({},"passive",{get:function(){p=!0}});try{const k=()=>{};d.addEventListener("test",k,b),d.removeEventListener("test",k,b)}catch{}return p}();function se(p,b){if(G.call(this,p?p.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,p){var k=this.type=p.type,N=p.changedTouches&&p.changedTouches.length?p.changedTouches[0]:null;if(this.target=p.target||p.srcElement,this.g=b,b=p.relatedTarget){if(J){e:{try{H(b.nodeName);var de=!0;break e}catch{}de=!1}de||(b=null)}}else k=="mouseover"?b=p.fromElement:k=="mouseout"&&(b=p.toElement);this.relatedTarget=b,N?(this.clientX=N.clientX!==void 0?N.clientX:N.pageX,this.clientY=N.clientY!==void 0?N.clientY:N.pageY,this.screenX=N.screenX||0,this.screenY=N.screenY||0):(this.clientX=p.clientX!==void 0?p.clientX:p.pageX,this.clientY=p.clientY!==void 0?p.clientY:p.pageY,this.screenX=p.screenX||0,this.screenY=p.screenY||0),this.button=p.button,this.key=p.key||"",this.ctrlKey=p.ctrlKey,this.altKey=p.altKey,this.shiftKey=p.shiftKey,this.metaKey=p.metaKey,this.pointerId=p.pointerId||0,this.pointerType=typeof p.pointerType=="string"?p.pointerType:me[p.pointerType]||"",this.state=p.state,this.i=p,p.defaultPrevented&&se.aa.h.call(this)}}T(se,G);var me={2:"touch",3:"pen",4:"mouse"};se.prototype.h=function(){se.aa.h.call(this);var p=this.i;p.preventDefault?p.preventDefault():p.returnValue=!1};var Ie="closure_listenable_"+(1e6*Math.random()|0),Pe=0;function qe(p,b,k,N,de){this.listener=p,this.proxy=null,this.src=b,this.type=k,this.capture=!!N,this.ha=de,this.key=++Pe,this.da=this.fa=!1}function Ge(p){p.da=!0,p.listener=null,p.proxy=null,p.src=null,p.ha=null}function be(p){this.src=p,this.g={},this.h=0}be.prototype.add=function(p,b,k,N,de){var we=p.toString();p=this.g[we],p||(p=this.g[we]=[],this.h++);var Oe=rt(p,b,N,de);return-1<Oe?(b=p[Oe],k||(b.fa=!1)):(b=new qe(b,this.src,we,!!N,de),b.fa=k,p.push(b)),b};function ae(p,b){var k=b.type;if(k in p.g){var N=p.g[k],de=Array.prototype.indexOf.call(N,b,void 0),we;(we=0<=de)&&Array.prototype.splice.call(N,de,1),we&&(Ge(b),p.g[k].length==0&&(delete p.g[k],p.h--))}}function rt(p,b,k,N){for(var de=0;de<p.length;++de){var we=p[de];if(!we.da&&we.listener==b&&we.capture==!!k&&we.ha==N)return de}return-1}var Le="closure_lm_"+(1e6*Math.random()|0),$e={};function fe(p,b,k,N,de){if(Array.isArray(b)){for(var we=0;we<b.length;we++)fe(p,b[we],k,N,de);return null}return k=st(k),p&&p[Ie]?p.K(b,k,m(N)?!!N.capture:!1,de):_e(p,b,k,!1,N,de)}function _e(p,b,k,N,de,we){if(!b)throw Error("Invalid event type");var Oe=m(de)?!!de.capture:!!de,Vt=q(p);if(Vt||(p[Le]=Vt=new be(p)),k=Vt.add(b,k,N,Oe,we),k.proxy)return k;if(N=Ce(),k.proxy=N,N.src=p,N.listener=k,p.addEventListener)ne||(de=Oe),de===void 0&&(de=!1),p.addEventListener(b.toString(),N,de);else if(p.attachEvent)p.attachEvent(K(b.toString()),N);else if(p.addListener&&p.removeListener)p.addListener(N);else throw Error("addEventListener and attachEvent are unavailable.");return k}function Ce(){function p(k){return b.call(p.src,p.listener,k)}const b=ie;return p}function ze(p,b,k,N,de){if(Array.isArray(b))for(var we=0;we<b.length;we++)ze(p,b[we],k,N,de);else N=m(N)?!!N.capture:!!N,k=st(k),p&&p[Ie]?(p=p.i,b=String(b).toString(),b in p.g&&(we=p.g[b],k=rt(we,k,N,de),-1<k&&(Ge(we[k]),Array.prototype.splice.call(we,k,1),we.length==0&&(delete p.g[b],p.h--)))):p&&(p=q(p))&&(b=p.g[b.toString()],p=-1,b&&(p=rt(b,k,N,de)),(k=-1<p?b[p]:null)&&De(k))}function De(p){if(typeof p!="number"&&p&&!p.da){var b=p.src;if(b&&b[Ie])ae(b.i,p);else{var k=p.type,N=p.proxy;b.removeEventListener?b.removeEventListener(k,N,p.capture):b.detachEvent?b.detachEvent(K(k),N):b.addListener&&b.removeListener&&b.removeListener(N),(k=q(b))?(ae(k,p),k.h==0&&(k.src=null,b[Le]=null)):Ge(p)}}}function K(p){return p in $e?$e[p]:$e[p]="on"+p}function ie(p,b){if(p.da)p=!0;else{b=new se(b,this);var k=p.listener,N=p.ha||p.src;p.fa&&De(p),p=k.call(N,b)}return p}function q(p){return p=p[Le],p instanceof be?p:null}var Me="__closure_events_fn_"+(1e9*Math.random()>>>0);function st(p){return typeof p=="function"?p:(p[Me]||(p[Me]=function(b){return p.handleEvent(b)}),p[Me])}function et(){Q.call(this),this.i=new be(this),this.M=this,this.F=null}T(et,Q),et.prototype[Ie]=!0,et.prototype.removeEventListener=function(p,b,k,N){ze(this,p,b,k,N)};function dt(p,b){var k,N=p.F;if(N)for(k=[];N;N=N.F)k.push(N);if(p=p.M,N=b.type||b,typeof b=="string")b=new G(b,p);else if(b instanceof G)b.target=b.target||p;else{var de=b;b=new G(N,p),D(b,de)}if(de=!0,k)for(var we=k.length-1;0<=we;we--){var Oe=b.g=k[we];de=Ht(Oe,N,!0,b)&&de}if(Oe=b.g=p,de=Ht(Oe,N,!0,b)&&de,de=Ht(Oe,N,!1,b)&&de,k)for(we=0;we<k.length;we++)Oe=b.g=k[we],de=Ht(Oe,N,!1,b)&&de}et.prototype.N=function(){if(et.aa.N.call(this),this.i){var p=this.i,b;for(b in p.g){for(var k=p.g[b],N=0;N<k.length;N++)Ge(k[N]);delete p.g[b],p.h--}}this.F=null},et.prototype.K=function(p,b,k,N){return this.i.add(String(p),b,!1,k,N)},et.prototype.L=function(p,b,k,N){return this.i.add(String(p),b,!0,k,N)};function Ht(p,b,k,N){if(b=p.i.g[String(b)],!b)return!0;b=b.concat();for(var de=!0,we=0;we<b.length;++we){var Oe=b[we];if(Oe&&!Oe.da&&Oe.capture==k){var Vt=Oe.listener,In=Oe.ha||Oe.src;Oe.fa&&ae(p.i,Oe),de=Vt.call(In,N)!==!1&&de}}return de&&!N.defaultPrevented}function je(p,b,k){if(typeof p=="function")k&&(p=S(p,k));else if(p&&typeof p.handleEvent=="function")p=S(p.handleEvent,p);else throw Error("Invalid listener argument");return 2147483647<Number(b)?-1:d.setTimeout(p,b||0)}function Qe(p){p.g=je(()=>{p.g=null,p.i&&(p.i=!1,Qe(p))},p.l);const b=p.h;p.h=null,p.m.apply(null,b)}class Tt extends Q{constructor(b,k){super(),this.m=b,this.l=k,this.h=null,this.i=!1,this.g=null}j(b){this.h=arguments,this.g?this.i=!0:Qe(this)}N(){super.N(),this.g&&(d.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function vt(p){Q.call(this),this.h=p,this.g={}}T(vt,Q);var Bt=[];function Dt(p){O(p.g,function(b,k){this.g.hasOwnProperty(k)&&De(b)},p),p.g={}}vt.prototype.N=function(){vt.aa.N.call(this),Dt(this)},vt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ke=d.JSON.stringify,W=d.JSON.parse,Y=class{stringify(p){return d.JSON.stringify(p,void 0)}parse(p){return d.JSON.parse(p,void 0)}};function ee(){}ee.prototype.h=null;function ve(p){return p.h||(p.h=p.i())}function Te(){}var Je={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function He(){G.call(this,"d")}T(He,G);function Ye(){G.call(this,"c")}T(Ye,G);var gt={},mt=null;function _t(){return mt=mt||new et}gt.La="serverreachability";function xn(p){G.call(this,gt.La,p)}T(xn,G);function lr(p){const b=_t();dt(b,new xn(b))}gt.STAT_EVENT="statevent";function Br(p,b){G.call(this,gt.STAT_EVENT,p),this.stat=b}T(Br,G);function Xt(p){const b=_t();dt(b,new Br(b,p))}gt.Ma="timingevent";function Gt(p,b){G.call(this,gt.Ma,p),this.size=b}T(Gt,G);function gr(p,b){if(typeof p!="function")throw Error("Fn must not be null and must be a function");return d.setTimeout(function(){p()},b)}function wi(){this.g=!0}wi.prototype.xa=function(){this.g=!1};function Si(p,b,k,N,de,we){p.info(function(){if(p.g)if(we)for(var Oe="",Vt=we.split("&"),In=0;In<Vt.length;In++){var At=Vt[In].split("=");if(1<At.length){var Dn=At[0];At=At[1];var Tn=Dn.split("_");Oe=2<=Tn.length&&Tn[1]=="type"?Oe+(Dn+"="+At+"&"):Oe+(Dn+"=redacted&")}}else Oe=null;else Oe=we;return"XMLHTTP REQ ("+N+") [attempt "+de+"]: "+b+`
`+k+`
`+Oe})}function pt(p,b,k,N,de,we,Oe){p.info(function(){return"XMLHTTP RESP ("+N+") [ attempt "+de+"]: "+b+`
`+k+`
`+we+" "+Oe})}function cr(p,b,k,N){p.info(function(){return"XMLHTTP TEXT ("+b+"): "+Oc(p,k)+(N?" "+N:"")})}function Qi(p,b){p.info(function(){return"TIMEOUT: "+b})}wi.prototype.info=function(){};function Oc(p,b){if(!p.g)return b;if(!b)return null;try{var k=JSON.parse(b);if(k){for(p=0;p<k.length;p++)if(Array.isArray(k[p])){var N=k[p];if(!(2>N.length)){var de=N[1];if(Array.isArray(de)&&!(1>de.length)){var we=de[0];if(we!="noop"&&we!="stop"&&we!="close")for(var Oe=1;Oe<de.length;Oe++)de[Oe]=""}}}}return ke(k)}catch{return b}}var Ha={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Ud={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},ni;function Ms(){}T(Ms,ee),Ms.prototype.g=function(){return new XMLHttpRequest},Ms.prototype.i=function(){return{}},ni=new Ms;function ri(p,b,k,N){this.j=p,this.i=b,this.l=k,this.R=N||1,this.U=new vt(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new qd}function qd(){this.i=null,this.g="",this.h=!1}var Wc={},$a={};function Ga(p,b,k){p.L=1,p.v=Mo(zr(b)),p.m=k,p.P=!0,Vc(p,null)}function Vc(p,b){p.F=Date.now(),Jt(p),p.A=zr(p.v);var k=p.A,N=p.R;Array.isArray(N)||(N=[String(N)]),Oo(k.i,"t",N),p.C=0,k=p.j.J,p.h=new qd,p.g=lh(p.j,k?b:null,!p.m),0<p.O&&(p.M=new Tt(S(p.Y,p,p.g),p.O)),b=p.U,k=p.g,N=p.ca;var de="readystatechange";Array.isArray(de)||(de&&(Bt[0]=de.toString()),de=Bt);for(var we=0;we<de.length;we++){var Oe=fe(k,de[we],N||b.handleEvent,!1,b.h||b);if(!Oe)break;b.g[Oe.key]=Oe}b=p.H?C(p.H):{},p.m?(p.u||(p.u="POST"),b["Content-Type"]="application/x-www-form-urlencoded",p.g.ea(p.A,p.u,p.m,b)):(p.u="GET",p.g.ea(p.A,p.u,null,b)),lr(),Si(p.i,p.u,p.A,p.l,p.R,p.m)}ri.prototype.ca=function(p){p=p.target;const b=this.M;b&&xr(p)==3?b.j():this.Y(p)},ri.prototype.Y=function(p){try{if(p==this.g)e:{const Tn=xr(this.g);var b=this.g.Ba();const Kr=this.g.Z();if(!(3>Tn)&&(Tn!=3||this.g&&(this.h.h||this.g.oa()||Kc(this.g)))){this.J||Tn!=4||b==7||(b==8||0>=Kr?lr(3):lr(2)),Ls(this);var k=this.g.Z();this.X=k;t:if(Hd(this)){var N=Kc(this.g);p="";var de=N.length,we=xr(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){$r(this),Fo(this);var Oe="";break t}this.h.i=new d.TextDecoder}for(b=0;b<de;b++)this.h.h=!0,p+=this.h.i.decode(N[b],{stream:!(we&&b==de-1)});N.length=0,this.h.g+=p,this.C=0,Oe=this.h.g}else Oe=this.g.oa();if(this.o=k==200,pt(this.i,this.u,this.A,this.l,this.R,Tn,k),this.o){if(this.T&&!this.K){t:{if(this.g){var Vt,In=this.g;if((Vt=In.g?In.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!P(Vt)){var At=Vt;break t}}At=null}if(k=At)cr(this.i,this.l,k,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Uc(this,k);else{this.o=!1,this.s=3,Xt(12),$r(this),Fo(this);break e}}if(this.P){k=!0;let Nr;for(;!this.J&&this.C<Oe.length;)if(Nr=sm(this,Oe),Nr==$a){Tn==4&&(this.s=4,Xt(14),k=!1),cr(this.i,this.l,null,"[Incomplete Response]");break}else if(Nr==Wc){this.s=4,Xt(15),cr(this.i,this.l,Oe,"[Invalid Chunk]"),k=!1;break}else cr(this.i,this.l,Nr,null),Uc(this,Nr);if(Hd(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Tn!=4||Oe.length!=0||this.h.h||(this.s=1,Xt(16),k=!1),this.o=this.o&&k,!k)cr(this.i,this.l,Oe,"[Invalid Chunked Response]"),$r(this),Fo(this);else if(0<Oe.length&&!this.W){this.W=!0;var Dn=this.j;Dn.g==this&&Dn.ba&&!Dn.M&&(Dn.j.info("Great, no buffering proxy detected. Bytes received: "+Oe.length),Yc(Dn),Dn.M=!0,Xt(11))}}else cr(this.i,this.l,Oe,null),Uc(this,Oe);Tn==4&&$r(this),this.o&&!this.J&&(Tn==4?il(this.j,this):(this.o=!1,Jt(this)))}else Za(this.g),k==400&&0<Oe.indexOf("Unknown SID")?(this.s=3,Xt(12)):(this.s=0,Xt(13)),$r(this),Fo(this)}}}catch{}finally{}};function Hd(p){return p.g?p.u=="GET"&&p.L!=2&&p.j.Ca:!1}function sm(p,b){var k=p.C,N=b.indexOf(`
`,k);return N==-1?$a:(k=Number(b.substring(k,N)),isNaN(k)?Wc:(N+=1,N+k>b.length?$a:(b=b.slice(N,N+k),p.C=N+k,b)))}ri.prototype.cancel=function(){this.J=!0,$r(this)};function Jt(p){p.S=Date.now()+p.I,$d(p,p.I)}function $d(p,b){if(p.B!=null)throw Error("WatchDog timer not null");p.B=gr(S(p.ba,p),b)}function Ls(p){p.B&&(d.clearTimeout(p.B),p.B=null)}ri.prototype.ba=function(){this.B=null;const p=Date.now();0<=p-this.S?(Qi(this.i,this.A),this.L!=2&&(lr(),Xt(17)),$r(this),this.s=2,Fo(this)):$d(this,this.S-p)};function Fo(p){p.j.G==0||p.J||il(p.j,p)}function $r(p){Ls(p);var b=p.M;b&&typeof b.ma=="function"&&b.ma(),p.M=null,Dt(p.U),p.g&&(b=p.g,p.g=null,b.abort(),b.ma())}function Uc(p,b){try{var k=p.j;if(k.G!=0&&(k.g==p||ur(k.h,p))){if(!p.K&&ur(k.h,p)&&k.G==3){try{var N=k.Da.g.parse(b)}catch{N=null}if(Array.isArray(N)&&N.length==3){var de=N;if(de[0]==0){e:if(!k.u){if(k.g)if(k.g.F+3e3<p.F)rl(k),li(k);else break e;nl(k),Xt(18)}}else k.za=de[1],0<k.za-k.T&&37500>de[2]&&k.F&&k.v==0&&!k.C&&(k.C=gr(S(k.Za,k),6e3));if(1>=Kd(k.h)&&k.ca){try{k.ca()}catch{}k.ca=void 0}}else eo(k,11)}else if((p.K||k.g==p)&&rl(k),!P(b))for(de=k.Da.g.parse(b),b=0;b<de.length;b++){let At=de[b];if(k.T=At[0],At=At[1],k.G==2)if(At[0]=="c"){k.K=At[1],k.ia=At[2];const Dn=At[3];Dn!=null&&(k.la=Dn,k.j.info("VER="+k.la));const Tn=At[4];Tn!=null&&(k.Aa=Tn,k.j.info("SVER="+k.Aa));const Kr=At[5];Kr!=null&&typeof Kr=="number"&&0<Kr&&(N=1.5*Kr,k.L=N,k.j.info("backChannelRequestTimeoutMs_="+N)),N=k;const Nr=p.g;if(Nr){const $s=Nr.g?Nr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if($s){var we=N.h;we.g||$s.indexOf("spdy")==-1&&$s.indexOf("quic")==-1&&$s.indexOf("h2")==-1||(we.j=we.l,we.g=new Set,we.h&&(qc(we,we.h),we.h=null))}if(N.D){const sl=Nr.g?Nr.g.getResponseHeader("X-HTTP-Session-Id"):null;sl&&(N.ya=sl,Kt(N.I,N.D,sl))}}k.G=3,k.l&&k.l.ua(),k.ba&&(k.R=Date.now()-p.F,k.j.info("Handshake RTT: "+k.R+"ms")),N=k;var Oe=p;if(N.qa=ah(N,N.J?N.ia:null,N.W),Oe.K){Qd(N.h,Oe);var Vt=Oe,In=N.L;In&&(Vt.I=In),Vt.B&&(Ls(Vt),Jt(Vt)),N.g=Oe}else Hs(N);0<k.i.length&&ji(k)}else At[0]!="stop"&&At[0]!="close"||eo(k,7);else k.G==3&&(At[0]=="stop"||At[0]=="close"?At[0]=="stop"?eo(k,7):Kn(k):At[0]!="noop"&&k.l&&k.l.ta(At),k.v=0)}}lr(4)}catch{}}var Gd=class{constructor(p,b){this.g=p,this.map=b}};function Os(p){this.l=p||10,d.PerformanceNavigationTiming?(p=d.performance.getEntriesByType("navigation"),p=0<p.length&&(p[0].nextHopProtocol=="hq"||p[0].nextHopProtocol=="h2")):p=!!(d.chrome&&d.chrome.loadTimes&&d.chrome.loadTimes()&&d.chrome.loadTimes().wasFetchedViaSpdy),this.j=p?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Fr(p){return p.h?!0:p.g?p.g.size>=p.j:!1}function Kd(p){return p.h?1:p.g?p.g.size:0}function ur(p,b){return p.h?p.h==b:p.g?p.g.has(b):!1}function qc(p,b){p.g?p.g.add(b):p.h=b}function Qd(p,b){p.h&&p.h==b?p.h=null:p.g&&p.g.has(b)&&p.g.delete(b)}Os.prototype.cancel=function(){if(this.i=Yd(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const p of this.g.values())p.cancel();this.g.clear()}};function Yd(p){if(p.h!=null)return p.i.concat(p.h.D);if(p.g!=null&&p.g.size!==0){let b=p.i;for(const k of p.g.values())b=b.concat(k.D);return b}return R(p.i)}function Ka(p){if(p.V&&typeof p.V=="function")return p.V();if(typeof Map<"u"&&p instanceof Map||typeof Set<"u"&&p instanceof Set)return Array.from(p.values());if(typeof p=="string")return p.split("");if(h(p)){for(var b=[],k=p.length,N=0;N<k;N++)b.push(p[N]);return b}b=[],k=0;for(N in p)b[k++]=p[N];return b}function Qa(p){if(p.na&&typeof p.na=="function")return p.na();if(!p.V||typeof p.V!="function"){if(typeof Map<"u"&&p instanceof Map)return Array.from(p.keys());if(!(typeof Set<"u"&&p instanceof Set)){if(h(p)||typeof p=="string"){var b=[];p=p.length;for(var k=0;k<p;k++)b.push(k);return b}b=[],k=0;for(const N in p)b[k++]=N;return b}}}function zo(p,b){if(p.forEach&&typeof p.forEach=="function")p.forEach(b,void 0);else if(h(p)||typeof p=="string")Array.prototype.forEach.call(p,b,void 0);else for(var k=Qa(p),N=Ka(p),de=N.length,we=0;we<de;we++)b.call(void 0,N[we],k&&k[we],p)}var Ws=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function am(p,b){if(p){p=p.split("&");for(var k=0;k<p.length;k++){var N=p[k].indexOf("="),de=null;if(0<=N){var we=p[k].substring(0,N);de=p[k].substring(N+1)}else we=p[k];b(we,de?decodeURIComponent(de.replace(/\+/g," ")):"")}}}function Yi(p){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,p instanceof Yi){this.h=p.h,Vs(this,p.j),this.o=p.o,this.g=p.g,Do(this,p.s),this.l=p.l;var b=p.i,k=new ki;k.i=b.i,b.g&&(k.g=new Map(b.g),k.h=b.h),No(this,k),this.m=p.m}else p&&(b=String(p).match(Ws))?(this.h=!1,Vs(this,b[1]||"",!0),this.o=Rt(b[2]||""),this.g=Rt(b[3]||"",!0),Do(this,b[4]),this.l=Rt(b[5]||"",!0),No(this,b[6]||"",!0),this.m=Rt(b[7]||"")):(this.h=!1,this.i=new ki(null,this.h))}Yi.prototype.toString=function(){var p=[],b=this.j;b&&p.push(Lo(b,Ya,!0),":");var k=this.g;return(k||b=="file")&&(p.push("//"),(b=this.o)&&p.push(Lo(b,Ya,!0),"@"),p.push(encodeURIComponent(String(k)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),k=this.s,k!=null&&p.push(":",String(k))),(k=this.l)&&(this.g&&k.charAt(0)!="/"&&p.push("/"),p.push(Lo(k,k.charAt(0)=="/"?Zd:Jd,!0))),(k=this.i.toString())&&p.push("?",k),(k=this.m)&&p.push("#",Lo(k,Hc)),p.join("")};function zr(p){return new Yi(p)}function Vs(p,b,k){p.j=k?Rt(b,!0):b,p.j&&(p.j=p.j.replace(/:$/,""))}function Do(p,b){if(b){if(b=Number(b),isNaN(b)||0>b)throw Error("Bad port number "+b);p.s=b}else p.s=null}function No(p,b,k){b instanceof ki?(p.i=b,Ti(p.i,p.h)):(k||(b=Lo(b,eh)),p.i=new ki(b,p.h))}function Kt(p,b,k){p.i.set(b,k)}function Mo(p){return Kt(p,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),p}function Rt(p,b){return p?b?decodeURI(p.replace(/%25/g,"%2525")):decodeURIComponent(p):""}function Lo(p,b,k){return typeof p=="string"?(p=encodeURI(p).replace(b,Xd),k&&(p=p.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),p):null}function Xd(p){return p=p.charCodeAt(0),"%"+(p>>4&15).toString(16)+(p&15).toString(16)}var Ya=/[#\/\?@]/g,Jd=/[#\?:]/g,Zd=/[#\?]/g,eh=/[#\?@]/g,Hc=/#/g;function ki(p,b){this.h=this.g=null,this.i=p||null,this.j=!!b}function Gn(p){p.g||(p.g=new Map,p.h=0,p.i&&am(p.i,function(b,k){p.add(decodeURIComponent(b.replace(/\+/g," ")),k)}))}n=ki.prototype,n.add=function(p,b){Gn(this),this.i=null,p=Gr(this,p);var k=this.g.get(p);return k||this.g.set(p,k=[]),k.push(b),this.h+=1,this};function ii(p,b){Gn(p),b=Gr(p,b),p.g.has(b)&&(p.i=null,p.h-=p.g.get(b).length,p.g.delete(b))}function oi(p,b){return Gn(p),b=Gr(p,b),p.g.has(b)}n.forEach=function(p,b){Gn(this),this.g.forEach(function(k,N){k.forEach(function(de){p.call(b,de,N,this)},this)},this)},n.na=function(){Gn(this);const p=Array.from(this.g.values()),b=Array.from(this.g.keys()),k=[];for(let N=0;N<b.length;N++){const de=p[N];for(let we=0;we<de.length;we++)k.push(b[N])}return k},n.V=function(p){Gn(this);let b=[];if(typeof p=="string")oi(this,p)&&(b=b.concat(this.g.get(Gr(this,p))));else{p=Array.from(this.g.values());for(let k=0;k<p.length;k++)b=b.concat(p[k])}return b},n.set=function(p,b){return Gn(this),this.i=null,p=Gr(this,p),oi(this,p)&&(this.h-=this.g.get(p).length),this.g.set(p,[b]),this.h+=1,this},n.get=function(p,b){return p?(p=this.V(p),0<p.length?String(p[0]):b):b};function Oo(p,b,k){ii(p,b),0<k.length&&(p.i=null,p.g.set(Gr(p,b),R(k)),p.h+=k.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const p=[],b=Array.from(this.g.keys());for(var k=0;k<b.length;k++){var N=b[k];const we=encodeURIComponent(String(N)),Oe=this.V(N);for(N=0;N<Oe.length;N++){var de=we;Oe[N]!==""&&(de+="="+encodeURIComponent(String(Oe[N]))),p.push(de)}}return this.i=p.join("&")};function Gr(p,b){return b=String(b),p.j&&(b=b.toLowerCase()),b}function Ti(p,b){b&&!p.j&&(Gn(p),p.i=null,p.g.forEach(function(k,N){var de=N.toLowerCase();N!=de&&(ii(this,N),Oo(this,de,k))},p)),p.j=b}function lm(p,b){const k=new wi;if(d.Image){const N=new Image;N.onload=j(yr,k,"TestLoadImage: loaded",!0,b,N),N.onerror=j(yr,k,"TestLoadImage: error",!1,b,N),N.onabort=j(yr,k,"TestLoadImage: abort",!1,b,N),N.ontimeout=j(yr,k,"TestLoadImage: timeout",!1,b,N),d.setTimeout(function(){N.ontimeout&&N.ontimeout()},1e4),N.src=p}else b(!1)}function th(p,b){const k=new wi,N=new AbortController,de=setTimeout(()=>{N.abort(),yr(k,"TestPingServer: timeout",!1,b)},1e4);fetch(p,{signal:N.signal}).then(we=>{clearTimeout(de),we.ok?yr(k,"TestPingServer: ok",!0,b):yr(k,"TestPingServer: server error",!1,b)}).catch(()=>{clearTimeout(de),yr(k,"TestPingServer: error",!1,b)})}function yr(p,b,k,N,de){try{de&&(de.onload=null,de.onerror=null,de.onabort=null,de.ontimeout=null),N(k)}catch{}}function cm(){this.g=new Y}function nh(p,b,k){const N=k||"";try{zo(p,function(de,we){let Oe=de;m(de)&&(Oe=ke(de)),b.push(N+we+"="+encodeURIComponent(Oe))})}catch(de){throw b.push(N+"type="+encodeURIComponent("_badmap")),de}}function Xi(p){this.l=p.Ub||null,this.j=p.eb||!1}T(Xi,ee),Xi.prototype.g=function(){return new Us(this.l,this.j)},Xi.prototype.i=function(p){return function(){return p}}({});function Us(p,b){et.call(this),this.D=p,this.o=b,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}T(Us,et),n=Us.prototype,n.open=function(p,b){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=p,this.A=b,this.readyState=1,ai(this)},n.send=function(p){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const b={headers:this.u,method:this.B,credentials:this.m,cache:void 0};p&&(b.body=p),(this.D||d).fetch(new Request(this.A,b)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,si(this)),this.readyState=0},n.Sa=function(p){if(this.g&&(this.l=p,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=p.headers,this.readyState=2,ai(this)),this.g&&(this.readyState=3,ai(this),this.g)))if(this.responseType==="arraybuffer")p.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof d.ReadableStream<"u"&&"body"in p){if(this.j=p.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;rh(this)}else p.text().then(this.Ra.bind(this),this.ga.bind(this))};function rh(p){p.j.read().then(p.Pa.bind(p)).catch(p.ga.bind(p))}n.Pa=function(p){if(this.g){if(this.o&&p.value)this.response.push(p.value);else if(!this.o){var b=p.value?p.value:new Uint8Array(0);(b=this.v.decode(b,{stream:!p.done}))&&(this.response=this.responseText+=b)}p.done?si(this):ai(this),this.readyState==3&&rh(this)}},n.Ra=function(p){this.g&&(this.response=this.responseText=p,si(this))},n.Qa=function(p){this.g&&(this.response=p,si(this))},n.ga=function(){this.g&&si(this)};function si(p){p.readyState=4,p.l=null,p.j=null,p.v=null,ai(p)}n.setRequestHeader=function(p,b){this.u.append(p,b)},n.getResponseHeader=function(p){return this.h&&this.h.get(p.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const p=[],b=this.h.entries();for(var k=b.next();!k.done;)k=k.value,p.push(k[0]+": "+k[1]),k=b.next();return p.join(`\r
`)};function ai(p){p.onreadystatechange&&p.onreadystatechange.call(p)}Object.defineProperty(Us.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(p){this.m=p?"include":"same-origin"}});function Ji(p){let b="";return O(p,function(k,N){b+=N,b+=":",b+=k,b+=`\r
`}),b}function Wo(p,b,k){e:{for(N in k){var N=!1;break e}N=!0}N||(k=Ji(k),typeof p=="string"?k!=null&&encodeURIComponent(String(k)):Kt(p,b,k))}function ln(p){et.call(this),this.headers=new Map,this.o=p||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}T(ln,et);var um=/^https?$/i,$c=["POST","PUT"];n=ln.prototype,n.Ha=function(p){this.J=p},n.ea=function(p,b,k,N){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+p);b=b?b.toUpperCase():"GET",this.D=p,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():ni.g(),this.v=this.o?ve(this.o):ve(ni),this.g.onreadystatechange=S(this.Ea,this);try{this.B=!0,this.g.open(b,String(p),!0),this.B=!1}catch(we){qs(this,we);return}if(p=k||"",k=new Map(this.headers),N)if(Object.getPrototypeOf(N)===Object.prototype)for(var de in N)k.set(de,N[de]);else if(typeof N.keys=="function"&&typeof N.get=="function")for(const we of N.keys())k.set(we,N.get(we));else throw Error("Unknown input type for opt_headers: "+String(N));N=Array.from(k.keys()).find(we=>we.toLowerCase()=="content-type"),de=d.FormData&&p instanceof d.FormData,!(0<=Array.prototype.indexOf.call($c,b,void 0))||N||de||k.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[we,Oe]of k)this.g.setRequestHeader(we,Oe);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Ja(this),this.u=!0,this.g.send(p),this.u=!1}catch(we){qs(this,we)}};function qs(p,b){p.h=!1,p.g&&(p.j=!0,p.g.abort(),p.j=!1),p.l=b,p.m=5,Xa(p),Dr(p)}function Xa(p){p.A||(p.A=!0,dt(p,"complete"),dt(p,"error"))}n.abort=function(p){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=p||7,dt(this,"complete"),dt(this,"abort"),Dr(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Dr(this,!0)),ln.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?Gc(this):this.bb())},n.bb=function(){Gc(this)};function Gc(p){if(p.h&&typeof c<"u"&&(!p.v[1]||xr(p)!=4||p.Z()!=2)){if(p.u&&xr(p)==4)je(p.Ea,0,p);else if(dt(p,"readystatechange"),xr(p)==4){p.h=!1;try{const Oe=p.Z();e:switch(Oe){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var b=!0;break e;default:b=!1}var k;if(!(k=b)){var N;if(N=Oe===0){var de=String(p.D).match(Ws)[1]||null;!de&&d.self&&d.self.location&&(de=d.self.location.protocol.slice(0,-1)),N=!um.test(de?de.toLowerCase():"")}k=N}if(k)dt(p,"complete"),dt(p,"success");else{p.m=6;try{var we=2<xr(p)?p.g.statusText:""}catch{we=""}p.l=we+" ["+p.Z()+"]",Xa(p)}}finally{Dr(p)}}}}function Dr(p,b){if(p.g){Ja(p);const k=p.g,N=p.v[0]?()=>{}:null;p.g=null,p.v=null,b||dt(p,"ready");try{k.onreadystatechange=N}catch{}}}function Ja(p){p.I&&(d.clearTimeout(p.I),p.I=null)}n.isActive=function(){return!!this.g};function xr(p){return p.g?p.g.readyState:0}n.Z=function(){try{return 2<xr(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(p){if(this.g){var b=this.g.responseText;return p&&b.indexOf(p)==0&&(b=b.substring(p.length)),W(b)}};function Kc(p){try{if(!p.g)return null;if("response"in p.g)return p.g.response;switch(p.H){case"":case"text":return p.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in p.g)return p.g.mozResponseArrayBuffer}return null}catch{return null}}function Za(p){const b={};p=(p.g&&2<=xr(p)&&p.g.getAllResponseHeaders()||"").split(`\r
`);for(let N=0;N<p.length;N++){if(P(p[N]))continue;var k=M(p[N]);const de=k[0];if(k=k[1],typeof k!="string")continue;k=k.trim();const we=b[de]||[];b[de]=we,we.push(k)}L(b,function(N){return N.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function _i(p,b,k){return k&&k.internalChannelParams&&k.internalChannelParams[p]||b}function Qc(p){this.Aa=0,this.i=[],this.j=new wi,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=_i("failFast",!1,p),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=_i("baseRetryDelayMs",5e3,p),this.cb=_i("retryDelaySeedMs",1e4,p),this.Wa=_i("forwardChannelMaxRetries",2,p),this.wa=_i("forwardChannelRequestTimeoutMs",2e4,p),this.pa=p&&p.xmlHttpFactory||void 0,this.Xa=p&&p.Tb||void 0,this.Ca=p&&p.useFetchStreams||!1,this.L=void 0,this.J=p&&p.supportsCrossDomainXhr||!1,this.K="",this.h=new Os(p&&p.concurrentRequestLimit),this.Da=new cm,this.P=p&&p.fastHandshake||!1,this.O=p&&p.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=p&&p.Rb||!1,p&&p.xa&&this.j.xa(),p&&p.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&p&&p.detectBufferingProxy||!1,this.ja=void 0,p&&p.longPollingTimeout&&0<p.longPollingTimeout&&(this.ja=p.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=Qc.prototype,n.la=8,n.G=1,n.connect=function(p,b,k,N){Xt(0),this.W=p,this.H=b||{},k&&N!==void 0&&(this.H.OSID=k,this.H.OAID=N),this.F=this.X,this.I=ah(this,null,this.W),ji(this)};function Kn(p){if(el(p),p.G==3){var b=p.U++,k=zr(p.I);if(Kt(k,"SID",p.K),Kt(k,"RID",b),Kt(k,"TYPE","terminate"),Zi(p,k),b=new ri(p,p.j,b),b.L=2,b.v=Mo(zr(k)),k=!1,d.navigator&&d.navigator.sendBeacon)try{k=d.navigator.sendBeacon(b.v.toString(),"")}catch{}!k&&d.Image&&(new Image().src=b.v,k=!0),k||(b.g=lh(b.j,null),b.g.ea(b.v)),b.F=Date.now(),Jt(b)}sh(p)}function li(p){p.g&&(Yc(p),p.g.cancel(),p.g=null)}function el(p){li(p),p.u&&(d.clearTimeout(p.u),p.u=null),rl(p),p.h.cancel(),p.s&&(typeof p.s=="number"&&d.clearTimeout(p.s),p.s=null)}function ji(p){if(!Fr(p.h)&&!p.s){p.s=!0;var b=p.Ga;ce||xe(),le||(ce(),le=!0),te.add(b,p),p.B=0}}function dm(p,b){return Kd(p.h)>=p.h.j-(p.s?1:0)?!1:p.s?(p.i=b.D.concat(p.i),!0):p.G==1||p.G==2||p.B>=(p.Va?0:p.Wa)?!1:(p.s=gr(S(p.Ga,p,b),oh(p,p.B)),p.B++,!0)}n.Ga=function(p){if(this.s)if(this.s=null,this.G==1){if(!p){this.U=Math.floor(1e5*Math.random()),p=this.U++;const de=new ri(this,this.j,p);let we=this.o;if(this.S&&(we?(we=C(we),D(we,this.S)):we=this.S),this.m!==null||this.O||(de.H=we,we=null),this.P)e:{for(var b=0,k=0;k<this.i.length;k++){t:{var N=this.i[k];if("__data__"in N.map&&(N=N.map.__data__,typeof N=="string")){N=N.length;break t}N=void 0}if(N===void 0)break;if(b+=N,4096<b){b=k;break e}if(b===4096||k===this.i.length-1){b=k+1;break e}}b=1e3}else b=1e3;b=Vo(this,de,b),k=zr(this.I),Kt(k,"RID",p),Kt(k,"CVER",22),this.D&&Kt(k,"X-HTTP-Session-Id",this.D),Zi(this,k),we&&(this.O?b="headers="+encodeURIComponent(String(Ji(we)))+"&"+b:this.m&&Wo(k,this.m,we)),qc(this.h,de),this.Ua&&Kt(k,"TYPE","init"),this.P?(Kt(k,"$req",b),Kt(k,"SID","null"),de.T=!0,Ga(de,k,null)):Ga(de,k,b),this.G=2}}else this.G==3&&(p?tl(this,p):this.i.length==0||Fr(this.h)||tl(this))};function tl(p,b){var k;b?k=b.l:k=p.U++;const N=zr(p.I);Kt(N,"SID",p.K),Kt(N,"RID",k),Kt(N,"AID",p.T),Zi(p,N),p.m&&p.o&&Wo(N,p.m,p.o),k=new ri(p,p.j,k,p.B+1),p.m===null&&(k.H=p.o),b&&(p.i=b.D.concat(p.i)),b=Vo(p,k,1e3),k.I=Math.round(.5*p.wa)+Math.round(.5*p.wa*Math.random()),qc(p.h,k),Ga(k,N,b)}function Zi(p,b){p.H&&O(p.H,function(k,N){Kt(b,N,k)}),p.l&&zo({},function(k,N){Kt(b,N,k)})}function Vo(p,b,k){k=Math.min(p.i.length,k);var N=p.l?S(p.l.Na,p.l,p):null;e:{var de=p.i;let we=-1;for(;;){const Oe=["count="+k];we==-1?0<k?(we=de[0].g,Oe.push("ofs="+we)):we=0:Oe.push("ofs="+we);let Vt=!0;for(let In=0;In<k;In++){let At=de[In].g;const Dn=de[In].map;if(At-=we,0>At)we=Math.max(0,de[In].g-100),Vt=!1;else try{nh(Dn,Oe,"req"+At+"_")}catch{N&&N(Dn)}}if(Vt){N=Oe.join("&");break e}}}return p=p.i.splice(0,k),b.D=p,N}function Hs(p){if(!p.g&&!p.u){p.Y=1;var b=p.Fa;ce||xe(),le||(ce(),le=!0),te.add(b,p),p.v=0}}function nl(p){return p.g||p.u||3<=p.v?!1:(p.Y++,p.u=gr(S(p.Fa,p),oh(p,p.v)),p.v++,!0)}n.Fa=function(){if(this.u=null,ih(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var p=2*this.R;this.j.info("BP detection timer enabled: "+p),this.A=gr(S(this.ab,this),p)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Xt(10),li(this),ih(this))};function Yc(p){p.A!=null&&(d.clearTimeout(p.A),p.A=null)}function ih(p){p.g=new ri(p,p.j,"rpc",p.Y),p.m===null&&(p.g.H=p.o),p.g.O=0;var b=zr(p.qa);Kt(b,"RID","rpc"),Kt(b,"SID",p.K),Kt(b,"AID",p.T),Kt(b,"CI",p.F?"0":"1"),!p.F&&p.ja&&Kt(b,"TO",p.ja),Kt(b,"TYPE","xmlhttp"),Zi(p,b),p.m&&p.o&&Wo(b,p.m,p.o),p.L&&(p.g.I=p.L);var k=p.g;p=p.ia,k.L=1,k.v=Mo(zr(b)),k.m=null,k.P=!0,Vc(k,p)}n.Za=function(){this.C!=null&&(this.C=null,li(this),nl(this),Xt(19))};function rl(p){p.C!=null&&(d.clearTimeout(p.C),p.C=null)}function il(p,b){var k=null;if(p.g==b){rl(p),Yc(p),p.g=null;var N=2}else if(ur(p.h,b))k=b.D,Qd(p.h,b),N=1;else return;if(p.G!=0){if(b.o)if(N==1){k=b.m?b.m.length:0,b=Date.now()-b.F;var de=p.B;N=_t(),dt(N,new Gt(N,k)),ji(p)}else Hs(p);else if(de=b.s,de==3||de==0&&0<b.X||!(N==1&&dm(p,b)||N==2&&nl(p)))switch(k&&0<k.length&&(b=p.h,b.i=b.i.concat(k)),de){case 1:eo(p,5);break;case 4:eo(p,10);break;case 3:eo(p,6);break;default:eo(p,2)}}}function oh(p,b){let k=p.Ta+Math.floor(Math.random()*p.cb);return p.isActive()||(k*=2),k*b}function eo(p,b){if(p.j.info("Error code "+b),b==2){var k=S(p.fb,p),N=p.Xa;const de=!N;N=new Yi(N||"//www.google.com/images/cleardot.gif"),d.location&&d.location.protocol=="http"||Vs(N,"https"),Mo(N),de?lm(N.toString(),k):th(N.toString(),k)}else Xt(2);p.G=0,p.l&&p.l.sa(b),sh(p),el(p)}n.fb=function(p){p?(this.j.info("Successfully pinged google.com"),Xt(2)):(this.j.info("Failed to ping google.com"),Xt(1))};function sh(p){if(p.G=0,p.ka=[],p.l){const b=Yd(p.h);(b.length!=0||p.i.length!=0)&&(I(p.ka,b),I(p.ka,p.i),p.h.i.length=0,R(p.i),p.i.length=0),p.l.ra()}}function ah(p,b,k){var N=k instanceof Yi?zr(k):new Yi(k);if(N.g!="")b&&(N.g=b+"."+N.g),Do(N,N.s);else{var de=d.location;N=de.protocol,b=b?b+"."+de.hostname:de.hostname,de=+de.port;var we=new Yi(null);N&&Vs(we,N),b&&(we.g=b),de&&Do(we,de),k&&(we.l=k),N=we}return k=p.D,b=p.ya,k&&b&&Kt(N,k,b),Kt(N,"VER",p.la),Zi(p,N),N}function lh(p,b,k){if(b&&!p.J)throw Error("Can't create secondary domain capable XhrIo object.");return b=p.Ca&&!p.pa?new ln(new Xi({eb:k})):new ln(p.pa),b.Ha(p.J),b}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Xc(){}n=Xc.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function ol(){}ol.prototype.g=function(p,b){return new dr(p,b)};function dr(p,b){et.call(this),this.g=new Qc(b),this.l=p,this.h=b&&b.messageUrlParams||null,p=b&&b.messageHeaders||null,b&&b.clientProtocolHeaderRequired&&(p?p["X-Client-Protocol"]="webchannel":p={"X-Client-Protocol":"webchannel"}),this.g.o=p,p=b&&b.initMessageHeaders||null,b&&b.messageContentType&&(p?p["X-WebChannel-Content-Type"]=b.messageContentType:p={"X-WebChannel-Content-Type":b.messageContentType}),b&&b.va&&(p?p["X-WebChannel-Client-Profile"]=b.va:p={"X-WebChannel-Client-Profile":b.va}),this.g.S=p,(p=b&&b.Sb)&&!P(p)&&(this.g.m=p),this.v=b&&b.supportsCrossDomainXhr||!1,this.u=b&&b.sendRawJson||!1,(b=b&&b.httpSessionIdParam)&&!P(b)&&(this.g.D=b,p=this.h,p!==null&&b in p&&(p=this.h,b in p&&delete p[b])),this.j=new Ii(this)}T(dr,et),dr.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},dr.prototype.close=function(){Kn(this.g)},dr.prototype.o=function(p){var b=this.g;if(typeof p=="string"){var k={};k.__data__=p,p=k}else this.u&&(k={},k.__data__=ke(p),p=k);b.i.push(new Gd(b.Ya++,p)),b.G==3&&ji(b)},dr.prototype.N=function(){this.g.l=null,delete this.j,Kn(this.g),delete this.g,dr.aa.N.call(this)};function ch(p){He.call(this),p.__headers__&&(this.headers=p.__headers__,this.statusCode=p.__status__,delete p.__headers__,delete p.__status__);var b=p.__sm__;if(b){e:{for(const k in b){p=k;break e}p=void 0}(this.i=p)&&(p=this.i,b=b!==null&&p in b?b[p]:void 0),this.data=b}else this.data=p}T(ch,He);function uh(){Ye.call(this),this.status=1}T(uh,Ye);function Ii(p){this.g=p}T(Ii,Xc),Ii.prototype.ua=function(){dt(this.g,"a")},Ii.prototype.ta=function(p){dt(this.g,new ch(p))},Ii.prototype.sa=function(p){dt(this.g,new uh)},Ii.prototype.ra=function(){dt(this.g,"b")},ol.prototype.createWebChannel=ol.prototype.g,dr.prototype.send=dr.prototype.o,dr.prototype.open=dr.prototype.m,dr.prototype.close=dr.prototype.close,nT=function(){return new ol},tT=function(){return _t()},eT=gt,vy={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Ha.NO_ERROR=0,Ha.TIMEOUT=8,Ha.HTTP_ERROR=6,xp=Ha,Ud.COMPLETE="complete",Zk=Ud,Te.EventType=Je,Je.OPEN="a",Je.CLOSE="b",Je.ERROR="c",Je.MESSAGE="d",et.prototype.listen=et.prototype.K,Bu=Te,ln.prototype.listenOnce=ln.prototype.L,ln.prototype.getLastError=ln.prototype.Ka,ln.prototype.getLastErrorCode=ln.prototype.Ba,ln.prototype.getStatus=ln.prototype.Z,ln.prototype.getResponseJson=ln.prototype.Oa,ln.prototype.getResponseText=ln.prototype.oa,ln.prototype.send=ln.prototype.ea,ln.prototype.setWithCredentials=ln.prototype.Ha,Jk=ln}).apply(typeof ip<"u"?ip:typeof self<"u"?self:typeof window<"u"?window:{});const _1="@firebase/firestore",j1="4.7.17";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vn{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Vn.UNAUTHENTICATED=new Vn(null),Vn.GOOGLE_CREDENTIALS=new Vn("google-credentials-uid"),Vn.FIRST_PARTY=new Vn("first-party-uid"),Vn.MOCK_USER=new Vn("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let kc="11.9.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vs=new hx("@firebase/firestore");function Ll(){return vs.logLevel}function NA(n){vs.setLogLevel(n)}function Ee(n,...e){if(vs.logLevel<=jt.DEBUG){const t=e.map(mx);vs.debug(`Firestore (${kc}): ${n}`,...t)}}function Sn(n,...e){if(vs.logLevel<=jt.ERROR){const t=e.map(mx);vs.error(`Firestore (${kc}): ${n}`,...t)}}function qr(n,...e){if(vs.logLevel<=jt.WARN){const t=e.map(mx);vs.warn(`Firestore (${kc}): ${n}`,...t)}}function mx(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(t){return JSON.stringify(t)}(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ke(n,e,t){let r="Unexpected state";typeof e=="string"?r=e:t=e,rT(n,r,t)}function rT(n,e,t){let r=`FIRESTORE (${kc}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{r+=" CONTEXT: "+JSON.stringify(t)}catch{r+=" CONTEXT: "+t}throw Sn(r),new Error(r)}function nt(n,e,t,r){let o="Unexpected state";typeof t=="string"?o=t:r=t,n||rT(e,o,r)}function MA(n,e){n||Ke(57014,e)}function We(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ye={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Re extends $i{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qn{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iT{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class oT{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(Vn.UNAUTHENTICATED))}shutdown(){}}class LA{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class OA{constructor(e){this.t=e,this.currentUser=Vn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){nt(this.o===void 0,42304);let r=this.i;const o=h=>this.i!==r?(r=this.i,t(h)):Promise.resolve();let a=new qn;this.o=()=>{this.i++,this.currentUser=this.u(),a.resolve(),a=new qn,e.enqueueRetryable(()=>o(this.currentUser))};const c=()=>{const h=a;e.enqueueRetryable(async()=>{await h.promise,await o(this.currentUser)})},d=h=>{Ee("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=h,this.o&&(this.auth.addAuthTokenListener(this.o),c())};this.t.onInit(h=>d(h)),setTimeout(()=>{if(!this.auth){const h=this.t.getImmediate({optional:!0});h?d(h):(Ee("FirebaseAuthCredentialsProvider","Auth not yet detected"),a.resolve(),a=new qn)}},0),c()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(Ee("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(nt(typeof r.accessToken=="string",31837,{l:r}),new iT(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return nt(e===null||typeof e=="string",2055,{h:e}),new Vn(e)}}class WA{constructor(e,t,r){this.P=e,this.T=t,this.I=r,this.type="FirstParty",this.user=Vn.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class VA{constructor(e,t,r){this.P=e,this.T=t,this.I=r}getToken(){return Promise.resolve(new WA(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t(Vn.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class wy{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class UA{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,jr(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){nt(this.o===void 0,3512);const r=a=>{a.error!=null&&Ee("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${a.error.message}`);const c=a.token!==this.m;return this.m=a.token,Ee("FirebaseAppCheckTokenProvider",`Received ${c?"new":"existing"} token.`),c?t(a.token):Promise.resolve()};this.o=a=>{e.enqueueRetryable(()=>r(a))};const o=a=>{Ee("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=a,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(a=>o(a)),setTimeout(()=>{if(!this.appCheck){const a=this.V.getImmediate({optional:!0});a?o(a):Ee("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new wy(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(nt(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new wy(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}class qA{getToken(){return Promise.resolve(new wy(""))}invalidateToken(){}start(e,t){}shutdown(){}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HA(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gx(){return new TextEncoder}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yx{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const o=HA(40);for(let a=0;a<o.length;++a)r.length<20&&o[a]<t&&(r+=e.charAt(o[a]%62))}return r}}function ut(n,e){return n<e?-1:n>e?1:0}function Sy(n,e){let t=0;for(;t<n.length&&t<e.length;){const r=n.codePointAt(t),o=e.codePointAt(t);if(r!==o){if(r<128&&o<128)return ut(r,o);{const a=gx(),c=$A(a.encode(I1(n,t)),a.encode(I1(e,t)));return c!==0?c:ut(r,o)}}t+=r>65535?2:1}return ut(n.length,e.length)}function I1(n,e){return n.codePointAt(e)>65535?n.substring(e,e+2):n.substring(e,e+1)}function $A(n,e){for(let t=0;t<n.length&&t<e.length;++t)if(n[t]!==e[t])return ut(n[t],e[t]);return ut(n.length,e.length)}function Yl(n,e,t){return n.length===e.length&&n.every((r,o)=>t(r,e[o]))}function sT(n){return n+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C1=-62135596800,R1=1e6;class Yt{static now(){return Yt.fromMillis(Date.now())}static fromDate(e){return Yt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor((e-1e3*t)*R1);return new Yt(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Re(ye.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Re(ye.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<C1)throw new Re(ye.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Re(ye.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/R1}_compareTo(e){return this.seconds===e.seconds?ut(this.nanoseconds,e.nanoseconds):ut(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds-C1;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class at{static fromTimestamp(e){return new at(e)}static min(){return new at(new Yt(0,0))}static max(){return new at(new Yt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ky="__name__";class Fi{constructor(e,t,r){t===void 0?t=0:t>e.length&&Ke(637,{offset:t,range:e.length}),r===void 0?r=e.length-t:r>e.length-t&&Ke(1746,{length:r,range:e.length-t}),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return Fi.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Fi?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let o=0;o<r;o++){const a=Fi.compareSegments(e.get(o),t.get(o));if(a!==0)return a}return ut(e.length,t.length)}static compareSegments(e,t){const r=Fi.isNumericId(e),o=Fi.isNumericId(t);return r&&!o?-1:!r&&o?1:r&&o?Fi.extractNumericId(e).compare(Fi.extractNumericId(t)):Sy(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return gs.fromString(e.substring(4,e.length-2))}}class It extends Fi{construct(e,t,r){return new It(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new Re(ye.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(o=>o.length>0))}return new It(t)}static emptyPath(){return new It([])}}const GA=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class sn extends Fi{construct(e,t,r){return new sn(e,t,r)}static isValidIdentifier(e){return GA.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),sn.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===ky}static keyField(){return new sn([ky])}static fromServerFormat(e){const t=[];let r="",o=0;const a=()=>{if(r.length===0)throw new Re(ye.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let c=!1;for(;o<e.length;){const d=e[o];if(d==="\\"){if(o+1===e.length)throw new Re(ye.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const h=e[o+1];if(h!=="\\"&&h!=="."&&h!=="`")throw new Re(ye.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=h,o+=2}else d==="`"?(c=!c,o++):d!=="."||c?(r+=d,o++):(a(),o++)}if(a(),c)throw new Re(ye.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new sn(t)}static emptyPath(){return new sn([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ve{constructor(e){this.path=e}static fromPath(e){return new Ve(It.fromString(e))}static fromName(e){return new Ve(It.fromString(e).popFirst(5))}static empty(){return new Ve(It.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&It.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return It.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Ve(new It(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xl=-1;class Jl{constructor(e,t,r,o){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=o}}function Ty(n){return n.fields.find(e=>e.kind===2)}function aa(n){return n.fields.filter(e=>e.kind!==2)}function KA(n,e){let t=ut(n.collectionGroup,e.collectionGroup);if(t!==0)return t;for(let r=0;r<Math.min(n.fields.length,e.fields.length);++r)if(t=QA(n.fields[r],e.fields[r]),t!==0)return t;return ut(n.fields.length,e.fields.length)}Jl.UNKNOWN_ID=-1;class ba{constructor(e,t){this.fieldPath=e,this.kind=t}}function QA(n,e){const t=sn.comparator(n.fieldPath,e.fieldPath);return t!==0?t:ut(n.kind,e.kind)}class Zl{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new Zl(0,Hr.min())}}function aT(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,o=at.fromTimestamp(r===1e9?new Yt(t+1,0):new Yt(t,r));return new Hr(o,Ve.empty(),e)}function lT(n){return new Hr(n.readTime,n.key,Xl)}class Hr{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new Hr(at.min(),Ve.empty(),Xl)}static max(){return new Hr(at.max(),Ve.empty(),Xl)}}function xx(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=Ve.comparator(n.documentKey,e.documentKey),t!==0?t:ut(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cT="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class uT{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Rs(n){if(n.code!==ye.FAILED_PRECONDITION||n.message!==cT)throw n;Ee("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ue{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Ke(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new ue((r,o)=>{this.nextCallback=a=>{this.wrapSuccess(e,a).next(r,o)},this.catchCallback=a=>{this.wrapFailure(t,a).next(r,o)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof ue?t:ue.resolve(t)}catch(t){return ue.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):ue.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):ue.reject(t)}static resolve(e){return new ue((t,r)=>{t(e)})}static reject(e){return new ue((t,r)=>{r(e)})}static waitFor(e){return new ue((t,r)=>{let o=0,a=0,c=!1;e.forEach(d=>{++o,d.next(()=>{++a,c&&a===o&&t()},h=>r(h))}),c=!0,a===o&&t()})}static or(e){let t=ue.resolve(!1);for(const r of e)t=t.next(o=>o?ue.resolve(o):r());return t}static forEach(e,t){const r=[];return e.forEach((o,a)=>{r.push(t.call(this,o,a))}),this.waitFor(r)}static mapArray(e,t){return new ue((r,o)=>{const a=e.length,c=new Array(a);let d=0;for(let h=0;h<a;h++){const m=h;t(e[m]).next(g=>{c[m]=g,++d,d===a&&r(c)},g=>o(g))}})}static doWhile(e,t){return new ue((r,o)=>{const a=()=>{e()===!0?t().next(()=>{a()},o):r()};a()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wr="SimpleDb";class Sf{static open(e,t,r,o){try{return new Sf(t,e.transaction(o,r))}catch(a){throw new Mu(t,a)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.S=new qn,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{t.error?this.S.reject(new Mu(e,t.error)):this.S.resolve()},this.transaction.onerror=r=>{const o=bx(r.target.error);this.S.reject(new Mu(e,o))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(Ee(Wr,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}v(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new XA(t)}}class Wi{static delete(e){return Ee(Wr,"Removing database:",e),ua(Dk().indexedDB.deleteDatabase(e)).toPromise()}static C(){if(!Hk())return!1;if(Wi.F())return!0;const e=Fn(),t=Wi.M(e),r=0<t&&t<10,o=dT(e),a=0<o&&o<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||a)}static F(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.O)==="YES"}static N(e,t){return e.store(t)}static M(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)}constructor(e,t,r){this.name=e,this.version=t,this.B=r,this.L=null,Wi.M(Fn())===12.2&&Sn("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async k(e){return this.db||(Ee(Wr,"Opening database:",this.name),this.db=await new Promise((t,r)=>{const o=indexedDB.open(this.name,this.version);o.onsuccess=a=>{const c=a.target.result;t(c)},o.onblocked=()=>{r(new Mu(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},o.onerror=a=>{const c=a.target.error;c.name==="VersionError"?r(new Re(ye.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):c.name==="InvalidStateError"?r(new Re(ye.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+c)):r(new Mu(e,c))},o.onupgradeneeded=a=>{Ee(Wr,'Database "'+this.name+'" requires upgrade from version:',a.oldVersion);const c=a.target.result;if(this.L!==null&&this.L!==a.oldVersion)throw new Error(`refusing to open IndexedDB database due to potential corruption of the IndexedDB database data; this corruption could be caused by clicking the "clear site data" button in a web browser; try reloading the web page to re-initialize the IndexedDB database: lastClosedDbVersion=${this.L}, event.oldVersion=${a.oldVersion}, event.newVersion=${a.newVersion}, db.version=${c.version}`);this.B.q(c,o.transaction,a.oldVersion,this.version).next(()=>{Ee(Wr,"Database upgrade to version "+this.version+" complete")})}}),this.db.addEventListener("close",t=>{const r=t.target;this.L=r.version},{passive:!0})),this.$&&(this.db.onversionchange=t=>this.$(t)),this.db}U(e){this.$=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,r,o){const a=t==="readonly";let c=0;for(;;){++c;try{this.db=await this.k(e);const d=Sf.open(this.db,e,a?"readonly":"readwrite",r),h=o(d).next(m=>(d.v(),m)).catch(m=>(d.abort(m),ue.reject(m))).toPromise();return h.catch(()=>{}),await d.D,h}catch(d){const h=d,m=h.name!=="FirebaseError"&&c<3;if(Ee(Wr,"Transaction failed with error:",h.message,"Retrying:",m),this.close(),!m)return Promise.reject(h)}}}close(){this.db&&this.db.close(),this.db=void 0}}function dT(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class YA{constructor(e){this.K=e,this.W=!1,this.G=null}get isDone(){return this.W}get j(){return this.G}set cursor(e){this.K=e}done(){this.W=!0}H(e){this.G=e}delete(){return ua(this.K.delete())}}class Mu extends Re{constructor(e,t){super(ye.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function Es(n){return n.name==="IndexedDbTransactionError"}class XA{constructor(e){this.store=e}put(e,t){let r;return t!==void 0?(Ee(Wr,"PUT",this.store.name,e,t),r=this.store.put(t,e)):(Ee(Wr,"PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),ua(r)}add(e){return Ee(Wr,"ADD",this.store.name,e,e),ua(this.store.add(e))}get(e){return ua(this.store.get(e)).next(t=>(t===void 0&&(t=null),Ee(Wr,"GET",this.store.name,e,t),t))}delete(e){return Ee(Wr,"DELETE",this.store.name,e),ua(this.store.delete(e))}count(){return Ee(Wr,"COUNT",this.store.name),ua(this.store.count())}J(e,t){const r=this.options(e,t),o=r.index?this.store.index(r.index):this.store;if(typeof o.getAll=="function"){const a=o.getAll(r.range);return new ue((c,d)=>{a.onerror=h=>{d(h.target.error)},a.onsuccess=h=>{c(h.target.result)}})}{const a=this.cursor(r),c=[];return this.Y(a,(d,h)=>{c.push(h)}).next(()=>c)}}Z(e,t){const r=this.store.getAll(e,t===null?void 0:t);return new ue((o,a)=>{r.onerror=c=>{a(c.target.error)},r.onsuccess=c=>{o(c.target.result)}})}X(e,t){Ee(Wr,"DELETE ALL",this.store.name);const r=this.options(e,t);r.ee=!1;const o=this.cursor(r);return this.Y(o,(a,c,d)=>d.delete())}te(e,t){let r;t?r=e:(r={},t=e);const o=this.cursor(r);return this.Y(o,t)}ne(e){const t=this.cursor({});return new ue((r,o)=>{t.onerror=a=>{const c=bx(a.target.error);o(c)},t.onsuccess=a=>{const c=a.target.result;c?e(c.primaryKey,c.value).next(d=>{d?c.continue():r()}):r()}})}Y(e,t){const r=[];return new ue((o,a)=>{e.onerror=c=>{a(c.target.error)},e.onsuccess=c=>{const d=c.target.result;if(!d)return void o();const h=new YA(d),m=t(d.primaryKey,d.value,h);if(m instanceof ue){const g=m.catch(x=>(h.done(),ue.reject(x)));r.push(g)}h.isDone?o():h.j===null?d.continue():d.continue(h.j)}}).next(()=>ue.waitFor(r))}options(e,t){let r;return e!==void 0&&(typeof e=="string"?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const r=this.store.index(e.index);return e.ee?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function ua(n){return new ue((e,t)=>{n.onsuccess=r=>{const o=r.target.result;e(o)},n.onerror=r=>{const o=bx(r.target.error);t(o)}})}let E1=!1;function bx(n){const e=Wi.M(Fn());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const r=new Re("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return E1||(E1=!0,setTimeout(()=>{throw r},0)),r}}return n}const Lu="IndexBackfiller";class JA{constructor(e,t){this.asyncQueue=e,this.re=t,this.task=null}start(){this.ie(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}ie(e){Ee(Lu,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{const t=await this.re.se();Ee(Lu,`Documents written: ${t}`)}catch(t){Es(t)?Ee(Lu,"Ignoring IndexedDB error during index backfill: ",t):await Rs(t)}await this.ie(6e4)})}}class ZA{constructor(e,t){this.localStore=e,this.persistence=t}async se(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",t=>this.oe(t,e))}oe(e,t){const r=new Set;let o=t,a=!0;return ue.doWhile(()=>a===!0&&o>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(c=>{if(c!==null&&!r.has(c))return Ee(Lu,`Processing collection: ${c}`),this._e(e,c,o).next(d=>{o-=d,r.add(c)});a=!1})).next(()=>t-o)}_e(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(o=>this.localStore.localDocuments.getNextDocuments(e,t,o,r).next(a=>{const c=a.changes;return this.localStore.indexManager.updateIndexEntries(e,c).next(()=>this.ae(o,a)).next(d=>(Ee(Lu,`Updating offset: ${d}`),this.localStore.indexManager.updateCollectionGroup(e,t,d))).next(()=>c.size)}))}ae(e,t){let r=e;return t.changes.forEach((o,a)=>{const c=lT(a);xx(c,r)>0&&(r=c)}),new Hr(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ir{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this.ue(r),this.ce=r=>t.writeSequenceNumber(r))}ue(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ce&&this.ce(e),e}}Ir.le=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ys=-1;function gd(n){return n==null}function Zu(n){return n===0&&1/n==-1/0}function hT(n){return typeof n=="number"&&Number.isInteger(n)&&!Zu(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lp="";function sr(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=A1(e)),e=e6(n.get(t),e);return A1(e)}function e6(n,e){let t=e;const r=n.length;for(let o=0;o<r;o++){const a=n.charAt(o);switch(a){case"\0":t+="";break;case Lp:t+="";break;default:t+=a}}return t}function A1(n){return n+Lp+""}function Ni(n){const e=n.length;if(nt(e>=2,64408,{path:n}),e===2)return nt(n.charAt(0)===Lp&&n.charAt(1)==="",56145,{path:n}),It.emptyPath();const t=e-2,r=[];let o="";for(let a=0;a<e;){const c=n.indexOf(Lp,a);switch((c<0||c>t)&&Ke(50515,{path:n}),n.charAt(c+1)){case"":const d=n.substring(a,c);let h;o.length===0?h=d:(o+=d,h=o,o=""),r.push(h);break;case"":o+=n.substring(a,c),o+="\0";break;case"":o+=n.substring(a,c+1);break;default:Ke(61167,{path:n})}a=c+2}return new It(r)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const la="remoteDocuments",yd="owner",Il="owner",ed="mutationQueues",t6="userId",mi="mutations",P1="batchId",fa="userMutationsIndex",B1=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bp(n,e){return[n,sr(e)]}function pT(n,e,t){return[n,sr(e),t]}const n6={},ec="documentMutations",Op="remoteDocumentsV14",r6=["prefixPath","collectionGroup","readTime","documentId"],vp="documentKeyIndex",i6=["prefixPath","collectionGroup","documentId"],fT="collectionGroupIndex",o6=["collectionGroup","readTime","prefixPath","documentId"],td="remoteDocumentGlobal",_y="remoteDocumentGlobalKey",tc="targets",mT="queryTargetsIndex",s6=["canonicalId","targetId"],nc="targetDocuments",a6=["targetId","path"],vx="documentTargetsIndex",l6=["path","targetId"],Wp="targetGlobalKey",va="targetGlobal",nd="collectionParents",c6=["collectionId","parent"],rc="clientMetadata",u6="clientId",kf="bundles",d6="bundleId",Tf="namedQueries",h6="name",wx="indexConfiguration",p6="indexId",jy="collectionGroupIndex",f6="collectionGroup",Ou="indexState",m6=["indexId","uid"],gT="sequenceNumberIndex",g6=["uid","sequenceNumber"],Wu="indexEntries",y6=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],yT="documentKeyIndex",x6=["indexId","uid","orderedDocumentKey"],_f="documentOverlays",b6=["userId","collectionPath","documentId"],Iy="collectionPathOverlayIndex",v6=["userId","collectionPath","largestBatchId"],xT="collectionGroupOverlayIndex",w6=["userId","collectionGroup","largestBatchId"],Sx="globals",S6="name",bT=[ed,mi,ec,la,tc,yd,va,nc,rc,td,nd,kf,Tf],k6=[...bT,_f],vT=[ed,mi,ec,Op,tc,yd,va,nc,rc,td,nd,kf,Tf,_f],wT=vT,kx=[...wT,wx,Ou,Wu],T6=kx,ST=[...kx,Sx],_6=ST;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cy extends uT{constructor(e,t){super(),this.he=e,this.currentSequenceNumber=t}}function zn(n,e){const t=We(n);return Wi.N(t.he,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function F1(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function As(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function kT(n,e){const t=[];for(const r in n)Object.prototype.hasOwnProperty.call(n,r)&&t.push(e(n[r],r,n));return t}function TT(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tn{constructor(e,t){this.comparator=e,this.root=t||Xn.EMPTY}insert(e,t){return new tn(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Xn.BLACK,null,null))}remove(e){return new tn(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Xn.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const o=this.comparator(e,r.key);if(o===0)return t+r.left.size;o<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){const e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new op(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new op(this.root,e,this.comparator,!1)}getReverseIterator(){return new op(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new op(this.root,e,this.comparator,!0)}}class op{constructor(e,t,r,o){this.isReverse=o,this.nodeStack=[];let a=1;for(;!e.isEmpty();)if(a=t?r(e.key,t):1,t&&o&&(a*=-1),a<0)e=this.isReverse?e.left:e.right;else{if(a===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Xn{constructor(e,t,r,o,a){this.key=e,this.value=t,this.color=r??Xn.RED,this.left=o??Xn.EMPTY,this.right=a??Xn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,o,a){return new Xn(e??this.key,t??this.value,r??this.color,o??this.left,a??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let o=this;const a=r(e,o.key);return o=a<0?o.copy(null,null,null,o.left.insert(e,t,r),null):a===0?o.copy(null,t,null,null,null):o.copy(null,null,null,null,o.right.insert(e,t,r)),o.fixUp()}removeMin(){if(this.left.isEmpty())return Xn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,o=this;if(t(e,o.key)<0)o.left.isEmpty()||o.left.isRed()||o.left.left.isRed()||(o=o.moveRedLeft()),o=o.copy(null,null,null,o.left.remove(e,t),null);else{if(o.left.isRed()&&(o=o.rotateRight()),o.right.isEmpty()||o.right.isRed()||o.right.left.isRed()||(o=o.moveRedRight()),t(e,o.key)===0){if(o.right.isEmpty())return Xn.EMPTY;r=o.right.min(),o=o.copy(r.key,r.value,null,null,o.right.removeMin())}o=o.copy(null,null,null,null,o.right.remove(e,t))}return o.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Xn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Xn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Ke(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Ke(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Ke(27949);return e+(this.isRed()?0:1)}}Xn.EMPTY=null,Xn.RED=!0,Xn.BLACK=!1;Xn.EMPTY=new class{constructor(){this.size=0}get key(){throw Ke(57766)}get value(){throw Ke(16141)}get color(){throw Ke(16727)}get left(){throw Ke(29726)}get right(){throw Ke(36894)}copy(e,t,r,o,a){return this}insert(e,t,r){return new Xn(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qt{constructor(e){this.comparator=e,this.data=new tn(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const o=r.getNext();if(this.comparator(o.key,e[1])>=0)return;t(o.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new z1(this.data.getIterator())}getIteratorFrom(e){return new z1(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof qt)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const o=t.getNext().key,a=r.getNext().key;if(this.comparator(o,a)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new qt(this.comparator);return t.data=e,t}}class z1{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Cl(n){return n.hasNext()?n.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cr{constructor(e){this.fields=e,e.sort(sn.comparator)}static empty(){return new Cr([])}unionWith(e){let t=new qt(sn.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new Cr(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Yl(this.fields,e.fields,(t,r)=>t.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _T extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function j6(){return typeof atob<"u"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mn{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(o){try{return atob(o)}catch(a){throw typeof DOMException<"u"&&a instanceof DOMException?new _T("Invalid base64 string: "+a):a}}(e);return new mn(t)}static fromUint8Array(e){const t=function(o){let a="";for(let c=0;c<o.length;++c)a+=String.fromCharCode(o[c]);return a}(e);return new mn(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){const r=new Uint8Array(t.length);for(let o=0;o<t.length;o++)r[o]=t.charCodeAt(o);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ut(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}mn.EMPTY_BYTE_STRING=new mn("");const I6=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function So(n){if(nt(!!n,39018),typeof n=="string"){let e=0;const t=I6.exec(n);if(nt(!!t,46558,{timestamp:n}),t[1]){let o=t[1];o=(o+"000000000").substr(0,9),e=Number(o)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:un(n.seconds),nanos:un(n.nanos)}}function un(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function ko(n){return typeof n=="string"?mn.fromBase64String(n):mn.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jT="server_timestamp",IT="__type__",CT="__previous_value__",RT="__local_write_time__";function jf(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{})[IT])===null||t===void 0?void 0:t.stringValue)===jT}function If(n){const e=n.mapValue.fields[CT];return jf(e)?If(e):e}function rd(n){const e=So(n.mapValue.fields[RT].timestampValue);return new Yt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C6{constructor(e,t,r,o,a,c,d,h,m,g){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=o,this.ssl=a,this.forceLongPolling=c,this.autoDetectLongPolling=d,this.longPollingOptions=h,this.useFetchStreams=m,this.isUsingEmulator=g}}const id="(default)";class ws{constructor(e,t){this.projectId=e,this.database=t||id}static empty(){return new ws("","")}get isDefaultDatabase(){return this.database===id}isEqual(e){return e instanceof ws&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tx="__type__",ET="__max__",ds={mapValue:{fields:{__type__:{stringValue:ET}}}},_x="__vector__",ic="value",wp={nullValue:"NULL_VALUE"};function Ss(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?jf(n)?4:AT(n)?9007199254740991:Cf(n)?10:11:Ke(28295,{value:n})}function qi(n,e){if(n===e)return!0;const t=Ss(n);if(t!==Ss(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return rd(n).isEqual(rd(e));case 3:return function(o,a){if(typeof o.timestampValue=="string"&&typeof a.timestampValue=="string"&&o.timestampValue.length===a.timestampValue.length)return o.timestampValue===a.timestampValue;const c=So(o.timestampValue),d=So(a.timestampValue);return c.seconds===d.seconds&&c.nanos===d.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(o,a){return ko(o.bytesValue).isEqual(ko(a.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(o,a){return un(o.geoPointValue.latitude)===un(a.geoPointValue.latitude)&&un(o.geoPointValue.longitude)===un(a.geoPointValue.longitude)}(n,e);case 2:return function(o,a){if("integerValue"in o&&"integerValue"in a)return un(o.integerValue)===un(a.integerValue);if("doubleValue"in o&&"doubleValue"in a){const c=un(o.doubleValue),d=un(a.doubleValue);return c===d?Zu(c)===Zu(d):isNaN(c)&&isNaN(d)}return!1}(n,e);case 9:return Yl(n.arrayValue.values||[],e.arrayValue.values||[],qi);case 10:case 11:return function(o,a){const c=o.mapValue.fields||{},d=a.mapValue.fields||{};if(F1(c)!==F1(d))return!1;for(const h in c)if(c.hasOwnProperty(h)&&(d[h]===void 0||!qi(c[h],d[h])))return!1;return!0}(n,e);default:return Ke(52216,{left:n})}}function od(n,e){return(n.values||[]).find(t=>qi(t,e))!==void 0}function ks(n,e){if(n===e)return 0;const t=Ss(n),r=Ss(e);if(t!==r)return ut(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return ut(n.booleanValue,e.booleanValue);case 2:return function(a,c){const d=un(a.integerValue||a.doubleValue),h=un(c.integerValue||c.doubleValue);return d<h?-1:d>h?1:d===h?0:isNaN(d)?isNaN(h)?0:-1:1}(n,e);case 3:return D1(n.timestampValue,e.timestampValue);case 4:return D1(rd(n),rd(e));case 5:return Sy(n.stringValue,e.stringValue);case 6:return function(a,c){const d=ko(a),h=ko(c);return d.compareTo(h)}(n.bytesValue,e.bytesValue);case 7:return function(a,c){const d=a.split("/"),h=c.split("/");for(let m=0;m<d.length&&m<h.length;m++){const g=ut(d[m],h[m]);if(g!==0)return g}return ut(d.length,h.length)}(n.referenceValue,e.referenceValue);case 8:return function(a,c){const d=ut(un(a.latitude),un(c.latitude));return d!==0?d:ut(un(a.longitude),un(c.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return N1(n.arrayValue,e.arrayValue);case 10:return function(a,c){var d,h,m,g;const x=a.fields||{},S=c.fields||{},j=(d=x[ic])===null||d===void 0?void 0:d.arrayValue,T=(h=S[ic])===null||h===void 0?void 0:h.arrayValue,R=ut(((m=j==null?void 0:j.values)===null||m===void 0?void 0:m.length)||0,((g=T==null?void 0:T.values)===null||g===void 0?void 0:g.length)||0);return R!==0?R:N1(j,T)}(n.mapValue,e.mapValue);case 11:return function(a,c){if(a===ds.mapValue&&c===ds.mapValue)return 0;if(a===ds.mapValue)return 1;if(c===ds.mapValue)return-1;const d=a.fields||{},h=Object.keys(d),m=c.fields||{},g=Object.keys(m);h.sort(),g.sort();for(let x=0;x<h.length&&x<g.length;++x){const S=Sy(h[x],g[x]);if(S!==0)return S;const j=ks(d[h[x]],m[g[x]]);if(j!==0)return j}return ut(h.length,g.length)}(n.mapValue,e.mapValue);default:throw Ke(23264,{Pe:t})}}function D1(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return ut(n,e);const t=So(n),r=So(e),o=ut(t.seconds,r.seconds);return o!==0?o:ut(t.nanos,r.nanos)}function N1(n,e){const t=n.values||[],r=e.values||[];for(let o=0;o<t.length&&o<r.length;++o){const a=ks(t[o],r[o]);if(a)return a}return ut(t.length,r.length)}function oc(n){return Ry(n)}function Ry(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){const r=So(t);return`time(${r.seconds},${r.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return ko(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return Ve.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let r="[",o=!0;for(const a of t.values||[])o?o=!1:r+=",",r+=Ry(a);return r+"]"}(n.arrayValue):"mapValue"in n?function(t){const r=Object.keys(t.fields||{}).sort();let o="{",a=!0;for(const c of r)a?a=!1:o+=",",o+=`${c}:${Ry(t.fields[c])}`;return o+"}"}(n.mapValue):Ke(61005,{value:n})}function Sp(n){switch(Ss(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=If(n);return e?16+Sp(e):16;case 5:return 2*n.stringValue.length;case 6:return ko(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((o,a)=>o+Sp(a),0)}(n.arrayValue);case 10:case 11:return function(r){let o=0;return As(r.fields,(a,c)=>{o+=a.length+Sp(c)}),o}(n.mapValue);default:throw Ke(13486,{value:n})}}function _a(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function Ey(n){return!!n&&"integerValue"in n}function sd(n){return!!n&&"arrayValue"in n}function M1(n){return!!n&&"nullValue"in n}function L1(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function kp(n){return!!n&&"mapValue"in n}function Cf(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{})[Tx])===null||t===void 0?void 0:t.stringValue)===_x}function Vu(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return As(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=Vu(r)),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Vu(n.arrayValue.values[t]);return e}return Object.assign({},n)}function AT(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===ET}const PT={mapValue:{fields:{[Tx]:{stringValue:_x},[ic]:{arrayValue:{}}}}};function R6(n){return"nullValue"in n?wp:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?_a(ws.empty(),Ve.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?Cf(n)?PT:{mapValue:{}}:Ke(35942,{value:n})}function E6(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?_a(ws.empty(),Ve.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?PT:"mapValue"in n?Cf(n)?{mapValue:{}}:ds:Ke(61959,{value:n})}function O1(n,e){const t=ks(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function W1(n,e){const t=ks(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jn{constructor(e){this.value=e}static empty(){return new Jn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!kp(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Vu(t)}setAll(e){let t=sn.emptyPath(),r={},o=[];e.forEach((c,d)=>{if(!t.isImmediateParentOf(d)){const h=this.getFieldsMap(t);this.applyChanges(h,r,o),r={},o=[],t=d.popLast()}c?r[d.lastSegment()]=Vu(c):o.push(d.lastSegment())});const a=this.getFieldsMap(t);this.applyChanges(a,r,o)}delete(e){const t=this.field(e.popLast());kp(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return qi(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let o=t.mapValue.fields[e.get(r)];kp(o)&&o.mapValue.fields||(o={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=o),t=o}return t.mapValue.fields}applyChanges(e,t,r){As(t,(o,a)=>e[o]=a);for(const o of r)delete e[o]}clone(){return new Jn(Vu(this.value))}}function BT(n){const e=[];return As(n.fields,(t,r)=>{const o=new sn([t]);if(kp(r)){const a=BT(r.mapValue).fields;if(a.length===0)e.push(o);else for(const c of a)e.push(o.child(c))}else e.push(o)}),new Cr(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class on{constructor(e,t,r,o,a,c,d){this.key=e,this.documentType=t,this.version=r,this.readTime=o,this.createTime=a,this.data=c,this.documentState=d}static newInvalidDocument(e){return new on(e,0,at.min(),at.min(),at.min(),Jn.empty(),0)}static newFoundDocument(e,t,r,o){return new on(e,1,t,at.min(),r,o,0)}static newNoDocument(e,t){return new on(e,2,t,at.min(),at.min(),Jn.empty(),0)}static newUnknownDocument(e,t){return new on(e,3,t,at.min(),at.min(),Jn.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(at.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Jn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Jn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=at.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof on&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new on(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ts{constructor(e,t){this.position=e,this.inclusive=t}}function V1(n,e,t){let r=0;for(let o=0;o<n.position.length;o++){const a=e[o],c=n.position[o];if(a.field.isKeyField()?r=Ve.comparator(Ve.fromName(c.referenceValue),t.key):r=ks(c,t.data.field(a.field)),a.dir==="desc"&&(r*=-1),r!==0)break}return r}function U1(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!qi(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ad{constructor(e,t="asc"){this.field=e,this.dir=t}}function A6(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FT{}class Ct extends FT{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new P6(e,t,r):t==="array-contains"?new z6(e,r):t==="in"?new OT(e,r):t==="not-in"?new D6(e,r):t==="array-contains-any"?new N6(e,r):new Ct(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new B6(e,r):new F6(e,r)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(ks(t,this.value)):t!==null&&Ss(this.value)===Ss(t)&&this.matchesComparison(ks(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Ke(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Ut extends FT{constructor(e,t){super(),this.filters=e,this.op=t,this.Te=null}static create(e,t){return new Ut(e,t)}matches(e){return sc(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.Te!==null||(this.Te=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.Te}getFilters(){return Object.assign([],this.filters)}}function sc(n){return n.op==="and"}function Ay(n){return n.op==="or"}function jx(n){return zT(n)&&sc(n)}function zT(n){for(const e of n.filters)if(e instanceof Ut)return!1;return!0}function Py(n){if(n instanceof Ct)return n.field.canonicalString()+n.op.toString()+oc(n.value);if(jx(n))return n.filters.map(e=>Py(e)).join(",");{const e=n.filters.map(t=>Py(t)).join(",");return`${n.op}(${e})`}}function DT(n,e){return n instanceof Ct?function(r,o){return o instanceof Ct&&r.op===o.op&&r.field.isEqual(o.field)&&qi(r.value,o.value)}(n,e):n instanceof Ut?function(r,o){return o instanceof Ut&&r.op===o.op&&r.filters.length===o.filters.length?r.filters.reduce((a,c,d)=>a&&DT(c,o.filters[d]),!0):!1}(n,e):void Ke(19439)}function NT(n,e){const t=n.filters.concat(e);return Ut.create(t,n.op)}function MT(n){return n instanceof Ct?function(t){return`${t.field.canonicalString()} ${t.op} ${oc(t.value)}`}(n):n instanceof Ut?function(t){return t.op.toString()+" {"+t.getFilters().map(MT).join(" ,")+"}"}(n):"Filter"}class P6 extends Ct{constructor(e,t,r){super(e,t,r),this.key=Ve.fromName(r.referenceValue)}matches(e){const t=Ve.comparator(e.key,this.key);return this.matchesComparison(t)}}class B6 extends Ct{constructor(e,t){super(e,"in",t),this.keys=LT("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class F6 extends Ct{constructor(e,t){super(e,"not-in",t),this.keys=LT("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function LT(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(r=>Ve.fromName(r.referenceValue))}class z6 extends Ct{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return sd(t)&&od(t.arrayValue,this.value)}}class OT extends Ct{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&od(this.value.arrayValue,t)}}class D6 extends Ct{constructor(e,t){super(e,"not-in",t)}matches(e){if(od(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!od(this.value.arrayValue,t)}}class N6 extends Ct{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!sd(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>od(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M6{constructor(e,t=null,r=[],o=[],a=null,c=null,d=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=o,this.limit=a,this.startAt=c,this.endAt=d,this.Ie=null}}function By(n,e=null,t=[],r=[],o=null,a=null,c=null){return new M6(n,e,t,r,o,a,c)}function ja(n){const e=We(n);if(e.Ie===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>Py(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>function(a){return a.field.canonicalString()+a.dir}(r)).join(","),gd(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>oc(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>oc(r)).join(",")),e.Ie=t}return e.Ie}function xd(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!A6(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!DT(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!U1(n.startAt,e.startAt)&&U1(n.endAt,e.endAt)}function Vp(n){return Ve.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function Up(n,e){return n.filters.filter(t=>t instanceof Ct&&t.field.isEqual(e))}function q1(n,e,t){let r=wp,o=!0;for(const a of Up(n,e)){let c=wp,d=!0;switch(a.op){case"<":case"<=":c=R6(a.value);break;case"==":case"in":case">=":c=a.value;break;case">":c=a.value,d=!1;break;case"!=":case"not-in":c=wp}O1({value:r,inclusive:o},{value:c,inclusive:d})<0&&(r=c,o=d)}if(t!==null){for(let a=0;a<n.orderBy.length;++a)if(n.orderBy[a].field.isEqual(e)){const c=t.position[a];O1({value:r,inclusive:o},{value:c,inclusive:t.inclusive})<0&&(r=c,o=t.inclusive);break}}return{value:r,inclusive:o}}function H1(n,e,t){let r=ds,o=!0;for(const a of Up(n,e)){let c=ds,d=!0;switch(a.op){case">=":case">":c=E6(a.value),d=!1;break;case"==":case"in":case"<=":c=a.value;break;case"<":c=a.value,d=!1;break;case"!=":case"not-in":c=ds}W1({value:r,inclusive:o},{value:c,inclusive:d})>0&&(r=c,o=d)}if(t!==null){for(let a=0;a<n.orderBy.length;++a)if(n.orderBy[a].field.isEqual(e)){const c=t.position[a];W1({value:r,inclusive:o},{value:c,inclusive:t.inclusive})>0&&(r=c,o=t.inclusive);break}}return{value:r,inclusive:o}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Io{constructor(e,t=null,r=[],o=[],a=null,c="F",d=null,h=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=o,this.limit=a,this.limitType=c,this.startAt=d,this.endAt=h,this.Ee=null,this.de=null,this.Ae=null,this.startAt,this.endAt}}function WT(n,e,t,r,o,a,c,d){return new Io(n,e,t,r,o,a,c,d)}function Tc(n){return new Io(n)}function $1(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function Ix(n){return n.collectionGroup!==null}function ql(n){const e=We(n);if(e.Ee===null){e.Ee=[];const t=new Set;for(const a of e.explicitOrderBy)e.Ee.push(a),t.add(a.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(c){let d=new qt(sn.comparator);return c.filters.forEach(h=>{h.getFlattenedFilters().forEach(m=>{m.isInequality()&&(d=d.add(m.field))})}),d})(e).forEach(a=>{t.has(a.canonicalString())||a.isKeyField()||e.Ee.push(new ad(a,r))}),t.has(sn.keyField().canonicalString())||e.Ee.push(new ad(sn.keyField(),r))}return e.Ee}function ar(n){const e=We(n);return e.de||(e.de=UT(e,ql(n))),e.de}function VT(n){const e=We(n);return e.Ae||(e.Ae=UT(e,n.explicitOrderBy)),e.Ae}function UT(n,e){if(n.limitType==="F")return By(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(o=>{const a=o.dir==="desc"?"asc":"desc";return new ad(o.field,a)});const t=n.endAt?new Ts(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new Ts(n.startAt.position,n.startAt.inclusive):null;return By(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function Fy(n,e){const t=n.filters.concat([e]);return new Io(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function qp(n,e,t){return new Io(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function bd(n,e){return xd(ar(n),ar(e))&&n.limitType===e.limitType}function qT(n){return`${ja(ar(n))}|lt:${n.limitType}`}function Ol(n){return`Query(target=${function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(o=>MT(o)).join(", ")}]`),gd(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(o=>function(c){return`${c.field.canonicalString()} (${c.dir})`}(o)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(o=>oc(o)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(o=>oc(o)).join(",")),`Target(${r})`}(ar(n))}; limitType=${n.limitType})`}function vd(n,e){return e.isFoundDocument()&&function(r,o){const a=o.key.path;return r.collectionGroup!==null?o.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(a):Ve.isDocumentKey(r.path)?r.path.isEqual(a):r.path.isImmediateParentOf(a)}(n,e)&&function(r,o){for(const a of ql(r))if(!a.field.isKeyField()&&o.data.field(a.field)===null)return!1;return!0}(n,e)&&function(r,o){for(const a of r.filters)if(!a.matches(o))return!1;return!0}(n,e)&&function(r,o){return!(r.startAt&&!function(c,d,h){const m=V1(c,d,h);return c.inclusive?m<=0:m<0}(r.startAt,ql(r),o)||r.endAt&&!function(c,d,h){const m=V1(c,d,h);return c.inclusive?m>=0:m>0}(r.endAt,ql(r),o))}(n,e)}function HT(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function $T(n){return(e,t)=>{let r=!1;for(const o of ql(n)){const a=L6(o,e,t);if(a!==0)return a;r=r||o.field.isKeyField()}return 0}}function L6(n,e,t){const r=n.field.isKeyField()?Ve.comparator(e.key,t.key):function(a,c,d){const h=c.data.field(a),m=d.data.field(a);return h!==null&&m!==null?ks(h,m):Ke(42886)}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return Ke(19790,{direction:n.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Co{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(const[o,a]of r)if(this.equalsFn(o,e))return a}}has(e){return this.get(e)!==void 0}set(e,t){const r=this.mapKeyFn(e),o=this.inner[r];if(o===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let a=0;a<o.length;a++)if(this.equalsFn(o[a][0],e))return void(o[a]=[e,t]);o.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let o=0;o<r.length;o++)if(this.equalsFn(r[o][0],e))return r.length===1?delete this.inner[t]:r.splice(o,1),this.innerSize--,!0;return!1}forEach(e){As(this.inner,(t,r)=>{for(const[o,a]of r)e(o,a)})}isEmpty(){return TT(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const O6=new tn(Ve.comparator);function Rr(){return O6}const GT=new tn(Ve.comparator);function Fu(...n){let e=GT;for(const t of n)e=e.insert(t.key,t);return e}function KT(n){let e=GT;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function Mi(){return Uu()}function QT(){return Uu()}function Uu(){return new Co(n=>n.toString(),(n,e)=>n.isEqual(e))}const W6=new tn(Ve.comparator),V6=new qt(Ve.comparator);function bt(...n){let e=V6;for(const t of n)e=e.add(t);return e}const U6=new qt(ut);function Cx(){return U6}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rx(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Zu(e)?"-0":e}}function YT(n){return{integerValue:""+n}}function XT(n,e){return hT(e)?YT(e):Rx(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rf{constructor(){this._=void 0}}function q6(n,e,t){return n instanceof ac?function(o,a){const c={fields:{[IT]:{stringValue:jT},[RT]:{timestampValue:{seconds:o.seconds,nanos:o.nanoseconds}}}};return a&&jf(a)&&(a=If(a)),a&&(c.fields[CT]=a),{mapValue:c}}(t,e):n instanceof Ia?ZT(n,e):n instanceof Ca?e_(n,e):function(o,a){const c=JT(o,a),d=G1(c)+G1(o.Re);return Ey(c)&&Ey(o.Re)?YT(d):Rx(o.serializer,d)}(n,e)}function H6(n,e,t){return n instanceof Ia?ZT(n,e):n instanceof Ca?e_(n,e):t}function JT(n,e){return n instanceof lc?function(r){return Ey(r)||function(a){return!!a&&"doubleValue"in a}(r)}(e)?e:{integerValue:0}:null}class ac extends Rf{}class Ia extends Rf{constructor(e){super(),this.elements=e}}function ZT(n,e){const t=t_(e);for(const r of n.elements)t.some(o=>qi(o,r))||t.push(r);return{arrayValue:{values:t}}}class Ca extends Rf{constructor(e){super(),this.elements=e}}function e_(n,e){let t=t_(e);for(const r of n.elements)t=t.filter(o=>!qi(o,r));return{arrayValue:{values:t}}}class lc extends Rf{constructor(e,t){super(),this.serializer=e,this.Re=t}}function G1(n){return un(n.integerValue||n.doubleValue)}function t_(n){return sd(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wd{constructor(e,t){this.field=e,this.transform=t}}function $6(n,e){return n.field.isEqual(e.field)&&function(r,o){return r instanceof Ia&&o instanceof Ia||r instanceof Ca&&o instanceof Ca?Yl(r.elements,o.elements,qi):r instanceof lc&&o instanceof lc?qi(r.Re,o.Re):r instanceof ac&&o instanceof ac}(n.transform,e.transform)}class G6{constructor(e,t){this.version=e,this.transformResults=t}}class dn{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new dn}static exists(e){return new dn(void 0,e)}static updateTime(e){return new dn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Tp(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class Ef{}function n_(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new jc(n.key,dn.none()):new _c(n.key,n.data,dn.none());{const t=n.data,r=Jn.empty();let o=new qt(sn.comparator);for(let a of e.fields)if(!o.has(a)){let c=t.field(a);c===null&&a.length>1&&(a=a.popLast(),c=t.field(a)),c===null?r.delete(a):r.set(a,c),o=o.add(a)}return new Ro(n.key,r,new Cr(o.toArray()),dn.none())}}function K6(n,e,t){n instanceof _c?function(o,a,c){const d=o.value.clone(),h=Q1(o.fieldTransforms,a,c.transformResults);d.setAll(h),a.convertToFoundDocument(c.version,d).setHasCommittedMutations()}(n,e,t):n instanceof Ro?function(o,a,c){if(!Tp(o.precondition,a))return void a.convertToUnknownDocument(c.version);const d=Q1(o.fieldTransforms,a,c.transformResults),h=a.data;h.setAll(r_(o)),h.setAll(d),a.convertToFoundDocument(c.version,h).setHasCommittedMutations()}(n,e,t):function(o,a,c){a.convertToNoDocument(c.version).setHasCommittedMutations()}(0,e,t)}function qu(n,e,t,r){return n instanceof _c?function(a,c,d,h){if(!Tp(a.precondition,c))return d;const m=a.value.clone(),g=Y1(a.fieldTransforms,h,c);return m.setAll(g),c.convertToFoundDocument(c.version,m).setHasLocalMutations(),null}(n,e,t,r):n instanceof Ro?function(a,c,d,h){if(!Tp(a.precondition,c))return d;const m=Y1(a.fieldTransforms,h,c),g=c.data;return g.setAll(r_(a)),g.setAll(m),c.convertToFoundDocument(c.version,g).setHasLocalMutations(),d===null?null:d.unionWith(a.fieldMask.fields).unionWith(a.fieldTransforms.map(x=>x.field))}(n,e,t,r):function(a,c,d){return Tp(a.precondition,c)?(c.convertToNoDocument(c.version).setHasLocalMutations(),null):d}(n,e,t)}function Q6(n,e){let t=null;for(const r of n.fieldTransforms){const o=e.data.field(r.field),a=JT(r.transform,o||null);a!=null&&(t===null&&(t=Jn.empty()),t.set(r.field,a))}return t||null}function K1(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(r,o){return r===void 0&&o===void 0||!(!r||!o)&&Yl(r,o,(a,c)=>$6(a,c))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class _c extends Ef{constructor(e,t,r,o=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=o,this.type=0}getFieldMask(){return null}}class Ro extends Ef{constructor(e,t,r,o,a=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=o,this.fieldTransforms=a,this.type=1}getFieldMask(){return this.fieldMask}}function r_(n){const e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}}),e}function Q1(n,e,t){const r=new Map;nt(n.length===t.length,32656,{Ve:t.length,me:n.length});for(let o=0;o<t.length;o++){const a=n[o],c=a.transform,d=e.data.field(a.field);r.set(a.field,H6(c,d,t[o]))}return r}function Y1(n,e,t){const r=new Map;for(const o of n){const a=o.transform,c=t.data.field(o.field);r.set(o.field,q6(a,c,e))}return r}class jc extends Ef{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Ex extends Ef{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ax{constructor(e,t,r,o){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=o}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let o=0;o<this.mutations.length;o++){const a=this.mutations[o];a.key.isEqual(e.key)&&K6(a,e,r[o])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=qu(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=qu(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=QT();return this.mutations.forEach(o=>{const a=e.get(o.key),c=a.overlayedDocument;let d=this.applyToLocalView(c,a.mutatedFields);d=t.has(o.key)?null:d;const h=n_(c,d);h!==null&&r.set(o.key,h),c.isValidDocument()||c.convertToNoDocument(at.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),bt())}isEqual(e){return this.batchId===e.batchId&&Yl(this.mutations,e.mutations,(t,r)=>K1(t,r))&&Yl(this.baseMutations,e.baseMutations,(t,r)=>K1(t,r))}}class Px{constructor(e,t,r,o){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=o}static from(e,t,r){nt(e.mutations.length===r.length,58842,{fe:e.mutations.length,ge:r.length});let o=function(){return W6}();const a=e.mutations;for(let c=0;c<a.length;c++)o=o.insert(a[c].key,r[c].version);return new Px(e,t,r,o)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bx{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i_{constructor(e,t,r){this.alias=e,this.aggregateType=t,this.fieldPath=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y6{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var jn,Pt;function o_(n){switch(n){case ye.OK:return Ke(64938);case ye.CANCELLED:case ye.UNKNOWN:case ye.DEADLINE_EXCEEDED:case ye.RESOURCE_EXHAUSTED:case ye.INTERNAL:case ye.UNAVAILABLE:case ye.UNAUTHENTICATED:return!1;case ye.INVALID_ARGUMENT:case ye.NOT_FOUND:case ye.ALREADY_EXISTS:case ye.PERMISSION_DENIED:case ye.FAILED_PRECONDITION:case ye.ABORTED:case ye.OUT_OF_RANGE:case ye.UNIMPLEMENTED:case ye.DATA_LOSS:return!0;default:return Ke(15467,{code:n})}}function s_(n){if(n===void 0)return Sn("GRPC error has no .code"),ye.UNKNOWN;switch(n){case jn.OK:return ye.OK;case jn.CANCELLED:return ye.CANCELLED;case jn.UNKNOWN:return ye.UNKNOWN;case jn.DEADLINE_EXCEEDED:return ye.DEADLINE_EXCEEDED;case jn.RESOURCE_EXHAUSTED:return ye.RESOURCE_EXHAUSTED;case jn.INTERNAL:return ye.INTERNAL;case jn.UNAVAILABLE:return ye.UNAVAILABLE;case jn.UNAUTHENTICATED:return ye.UNAUTHENTICATED;case jn.INVALID_ARGUMENT:return ye.INVALID_ARGUMENT;case jn.NOT_FOUND:return ye.NOT_FOUND;case jn.ALREADY_EXISTS:return ye.ALREADY_EXISTS;case jn.PERMISSION_DENIED:return ye.PERMISSION_DENIED;case jn.FAILED_PRECONDITION:return ye.FAILED_PRECONDITION;case jn.ABORTED:return ye.ABORTED;case jn.OUT_OF_RANGE:return ye.OUT_OF_RANGE;case jn.UNIMPLEMENTED:return ye.UNIMPLEMENTED;case jn.DATA_LOSS:return ye.DATA_LOSS;default:return Ke(39323,{code:n})}}(Pt=jn||(jn={}))[Pt.OK=0]="OK",Pt[Pt.CANCELLED=1]="CANCELLED",Pt[Pt.UNKNOWN=2]="UNKNOWN",Pt[Pt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Pt[Pt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Pt[Pt.NOT_FOUND=5]="NOT_FOUND",Pt[Pt.ALREADY_EXISTS=6]="ALREADY_EXISTS",Pt[Pt.PERMISSION_DENIED=7]="PERMISSION_DENIED",Pt[Pt.UNAUTHENTICATED=16]="UNAUTHENTICATED",Pt[Pt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Pt[Pt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Pt[Pt.ABORTED=10]="ABORTED",Pt[Pt.OUT_OF_RANGE=11]="OUT_OF_RANGE",Pt[Pt.UNIMPLEMENTED=12]="UNIMPLEMENTED",Pt[Pt.INTERNAL=13]="INTERNAL",Pt[Pt.UNAVAILABLE=14]="UNAVAILABLE",Pt[Pt.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Hp=null;/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const X6=new gs([4294967295,4294967295],0);function X1(n){const e=gx().encode(n),t=new Xk;return t.update(e),new Uint8Array(t.digest())}function J1(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),o=e.getUint32(8,!0),a=e.getUint32(12,!0);return[new gs([t,r],0),new gs([o,a],0)]}class Fx{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new zu(`Invalid padding: ${t}`);if(r<0)throw new zu(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new zu(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new zu(`Invalid padding when bitmap length is 0: ${t}`);this.pe=8*e.length-t,this.ye=gs.fromNumber(this.pe)}we(e,t,r){let o=e.add(t.multiply(gs.fromNumber(r)));return o.compare(X6)===1&&(o=new gs([o.getBits(0),o.getBits(1)],0)),o.modulo(this.ye).toNumber()}be(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.pe===0)return!1;const t=X1(e),[r,o]=J1(t);for(let a=0;a<this.hashCount;a++){const c=this.we(r,o,a);if(!this.be(c))return!1}return!0}static create(e,t,r){const o=e%8==0?0:8-e%8,a=new Uint8Array(Math.ceil(e/8)),c=new Fx(a,o,t);return r.forEach(d=>c.insert(d)),c}insert(e){if(this.pe===0)return;const t=X1(e),[r,o]=J1(t);for(let a=0;a<this.hashCount;a++){const c=this.we(r,o,a);this.Se(c)}}Se(e){const t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}}class zu extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sd{constructor(e,t,r,o,a){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=o,this.resolvedLimboDocuments=a}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const o=new Map;return o.set(e,kd.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new Sd(at.min(),o,new tn(ut),Rr(),bt())}}class kd{constructor(e,t,r,o,a){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=o,this.removedDocuments=a}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new kd(r,t,bt(),bt(),bt())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _p{constructor(e,t,r,o){this.De=e,this.removedTargetIds=t,this.key=r,this.ve=o}}class a_{constructor(e,t){this.targetId=e,this.Ce=t}}class l_{constructor(e,t,r=mn.EMPTY_BYTE_STRING,o=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=o}}class Z1{constructor(){this.Fe=0,this.Me=ew(),this.xe=mn.EMPTY_BYTE_STRING,this.Oe=!1,this.Ne=!0}get current(){return this.Oe}get resumeToken(){return this.xe}get Be(){return this.Fe!==0}get Le(){return this.Ne}ke(e){e.approximateByteSize()>0&&(this.Ne=!0,this.xe=e)}qe(){let e=bt(),t=bt(),r=bt();return this.Me.forEach((o,a)=>{switch(a){case 0:e=e.add(o);break;case 2:t=t.add(o);break;case 1:r=r.add(o);break;default:Ke(38017,{changeType:a})}}),new kd(this.xe,this.Oe,e,t,r)}Qe(){this.Ne=!1,this.Me=ew()}$e(e,t){this.Ne=!0,this.Me=this.Me.insert(e,t)}Ue(e){this.Ne=!0,this.Me=this.Me.remove(e)}Ke(){this.Fe+=1}We(){this.Fe-=1,nt(this.Fe>=0,3241,{Fe:this.Fe})}Ge(){this.Ne=!0,this.Oe=!0}}class J6{constructor(e){this.ze=e,this.je=new Map,this.He=Rr(),this.Je=sp(),this.Ye=sp(),this.Ze=new tn(ut)}Xe(e){for(const t of e.De)e.ve&&e.ve.isFoundDocument()?this.et(t,e.ve):this.tt(t,e.key,e.ve);for(const t of e.removedTargetIds)this.tt(t,e.key,e.ve)}nt(e){this.forEachTarget(e,t=>{const r=this.rt(t);switch(e.state){case 0:this.it(t)&&r.ke(e.resumeToken);break;case 1:r.We(),r.Be||r.Qe(),r.ke(e.resumeToken);break;case 2:r.We(),r.Be||this.removeTarget(t);break;case 3:this.it(t)&&(r.Ge(),r.ke(e.resumeToken));break;case 4:this.it(t)&&(this.st(t),r.ke(e.resumeToken));break;default:Ke(56790,{state:e.state})}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.je.forEach((r,o)=>{this.it(o)&&t(o)})}ot(e){const t=e.targetId,r=e.Ce.count,o=this._t(t);if(o){const a=o.target;if(Vp(a))if(r===0){const c=new Ve(a.path);this.tt(t,c,on.newNoDocument(c,at.min()))}else nt(r===1,20013,{expectedCount:r});else{const c=this.ut(t);if(c!==r){const d=this.ct(e),h=d?this.lt(d,e,c):1;if(h!==0){this.st(t);const m=h===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(t,m)}Hp==null||Hp.ht(function(g,x,S,j,T){var R,I,F,P,z,H;const J={localCacheCount:g,existenceFilterCount:x.count,databaseId:S.database,projectId:S.projectId},O=x.unchangedNames;return O&&(J.bloomFilter={applied:T===0,hashCount:(R=O==null?void 0:O.hashCount)!==null&&R!==void 0?R:0,bitmapLength:(P=(F=(I=O==null?void 0:O.bits)===null||I===void 0?void 0:I.bitmap)===null||F===void 0?void 0:F.length)!==null&&P!==void 0?P:0,padding:(H=(z=O==null?void 0:O.bits)===null||z===void 0?void 0:z.padding)!==null&&H!==void 0?H:0,mightContain:L=>{var C;return(C=j==null?void 0:j.mightContain(L))!==null&&C!==void 0&&C}}),J}(c,e.Ce,this.ze.Pt(),d,h))}}}}ct(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:r="",padding:o=0},hashCount:a=0}=t;let c,d;try{c=ko(r).toUint8Array()}catch(h){if(h instanceof _T)return qr("Decoding the base64 bloom filter in existence filter failed ("+h.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw h}try{d=new Fx(c,o,a)}catch(h){return qr(h instanceof zu?"BloomFilter error: ":"Applying bloom filter failed: ",h),null}return d.pe===0?null:d}lt(e,t,r){return t.Ce.count===r-this.Tt(e,t.targetId)?0:2}Tt(e,t){const r=this.ze.getRemoteKeysForTarget(t);let o=0;return r.forEach(a=>{const c=this.ze.Pt(),d=`projects/${c.projectId}/databases/${c.database}/documents/${a.path.canonicalString()}`;e.mightContain(d)||(this.tt(t,a,null),o++)}),o}It(e){const t=new Map;this.je.forEach((a,c)=>{const d=this._t(c);if(d){if(a.current&&Vp(d.target)){const h=new Ve(d.target.path);this.Et(h).has(c)||this.dt(c,h)||this.tt(c,h,on.newNoDocument(h,e))}a.Le&&(t.set(c,a.qe()),a.Qe())}});let r=bt();this.Ye.forEach((a,c)=>{let d=!0;c.forEachWhile(h=>{const m=this._t(h);return!m||m.purpose==="TargetPurposeLimboResolution"||(d=!1,!1)}),d&&(r=r.add(a))}),this.He.forEach((a,c)=>c.setReadTime(e));const o=new Sd(e,t,this.Ze,this.He,r);return this.He=Rr(),this.Je=sp(),this.Ye=sp(),this.Ze=new tn(ut),o}et(e,t){if(!this.it(e))return;const r=this.dt(e,t.key)?2:0;this.rt(e).$e(t.key,r),this.He=this.He.insert(t.key,t),this.Je=this.Je.insert(t.key,this.Et(t.key).add(e)),this.Ye=this.Ye.insert(t.key,this.At(t.key).add(e))}tt(e,t,r){if(!this.it(e))return;const o=this.rt(e);this.dt(e,t)?o.$e(t,1):o.Ue(t),this.Ye=this.Ye.insert(t,this.At(t).delete(e)),this.Ye=this.Ye.insert(t,this.At(t).add(e)),r&&(this.He=this.He.insert(t,r))}removeTarget(e){this.je.delete(e)}ut(e){const t=this.rt(e).qe();return this.ze.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ke(e){this.rt(e).Ke()}rt(e){let t=this.je.get(e);return t||(t=new Z1,this.je.set(e,t)),t}At(e){let t=this.Ye.get(e);return t||(t=new qt(ut),this.Ye=this.Ye.insert(e,t)),t}Et(e){let t=this.Je.get(e);return t||(t=new qt(ut),this.Je=this.Je.insert(e,t)),t}it(e){const t=this._t(e)!==null;return t||Ee("WatchChangeAggregator","Detected inactive target",e),t}_t(e){const t=this.je.get(e);return t&&t.Be?null:this.ze.Rt(e)}st(e){this.je.set(e,new Z1),this.ze.getRemoteKeysForTarget(e).forEach(t=>{this.tt(e,t,null)})}dt(e,t){return this.ze.getRemoteKeysForTarget(e).has(t)}}function sp(){return new tn(Ve.comparator)}function ew(){return new tn(Ve.comparator)}const Z6={asc:"ASCENDING",desc:"DESCENDING"},e5={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},t5={and:"AND",or:"OR"};class n5{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function zy(n,e){return n.useProto3Json||gd(e)?e:{value:e}}function cc(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function c_(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function r5(n,e){return cc(n,e.toTimestamp())}function kn(n){return nt(!!n,49232),at.fromTimestamp(function(t){const r=So(t);return new Yt(r.seconds,r.nanos)}(n))}function zx(n,e){return Dy(n,e).canonicalString()}function Dy(n,e){const t=function(o){return new It(["projects",o.projectId,"databases",o.database])}(n).child("documents");return e===void 0?t:t.child(e)}function u_(n){const e=It.fromString(n);return nt(v_(e),10190,{key:e.toString()}),e}function ld(n,e){return zx(n.databaseId,e.path)}function Vi(n,e){const t=u_(e);if(t.get(1)!==n.databaseId.projectId)throw new Re(ye.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new Re(ye.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new Ve(p_(t))}function d_(n,e){return zx(n.databaseId,e)}function h_(n){const e=u_(n);return e.length===4?It.emptyPath():p_(e)}function Ny(n){return new It(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function p_(n){return nt(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function tw(n,e,t){return{name:ld(n,e),fields:t.value.mapValue.fields}}function f_(n,e,t){const r=Vi(n,e.name),o=kn(e.updateTime),a=e.createTime?kn(e.createTime):at.min(),c=new Jn({mapValue:{fields:e.fields}}),d=on.newFoundDocument(r,o,a,c);return t&&d.setHasCommittedMutations(),t?d.setHasCommittedMutations():d}function i5(n,e){return"found"in e?function(r,o){nt(!!o.found,43571),o.found.name,o.found.updateTime;const a=Vi(r,o.found.name),c=kn(o.found.updateTime),d=o.found.createTime?kn(o.found.createTime):at.min(),h=new Jn({mapValue:{fields:o.found.fields}});return on.newFoundDocument(a,c,d,h)}(n,e):"missing"in e?function(r,o){nt(!!o.missing,3894),nt(!!o.readTime,22933);const a=Vi(r,o.missing),c=kn(o.readTime);return on.newNoDocument(a,c)}(n,e):Ke(7234,{result:e})}function o5(n,e){let t;if("targetChange"in e){e.targetChange;const r=function(m){return m==="NO_CHANGE"?0:m==="ADD"?1:m==="REMOVE"?2:m==="CURRENT"?3:m==="RESET"?4:Ke(39313,{state:m})}(e.targetChange.targetChangeType||"NO_CHANGE"),o=e.targetChange.targetIds||[],a=function(m,g){return m.useProto3Json?(nt(g===void 0||typeof g=="string",58123),mn.fromBase64String(g||"")):(nt(g===void 0||g instanceof Buffer||g instanceof Uint8Array,16193),mn.fromUint8Array(g||new Uint8Array))}(n,e.targetChange.resumeToken),c=e.targetChange.cause,d=c&&function(m){const g=m.code===void 0?ye.UNKNOWN:s_(m.code);return new Re(g,m.message||"")}(c);t=new l_(r,o,a,d||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const o=Vi(n,r.document.name),a=kn(r.document.updateTime),c=r.document.createTime?kn(r.document.createTime):at.min(),d=new Jn({mapValue:{fields:r.document.fields}}),h=on.newFoundDocument(o,a,c,d),m=r.targetIds||[],g=r.removedTargetIds||[];t=new _p(m,g,h.key,h)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const o=Vi(n,r.document),a=r.readTime?kn(r.readTime):at.min(),c=on.newNoDocument(o,a),d=r.removedTargetIds||[];t=new _p([],d,c.key,c)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const o=Vi(n,r.document),a=r.removedTargetIds||[];t=new _p([],a,o,null)}else{if(!("filter"in e))return Ke(11601,{Vt:e});{e.filter;const r=e.filter;r.targetId;const{count:o=0,unchangedNames:a}=r,c=new Y6(o,a),d=r.targetId;t=new a_(d,c)}}return t}function cd(n,e){let t;if(e instanceof _c)t={update:tw(n,e.key,e.value)};else if(e instanceof jc)t={delete:ld(n,e.key)};else if(e instanceof Ro)t={update:tw(n,e.key,e.data),updateMask:d5(e.fieldMask)};else{if(!(e instanceof Ex))return Ke(16599,{ft:e.type});t={verify:ld(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(a,c){const d=c.transform;if(d instanceof ac)return{fieldPath:c.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(d instanceof Ia)return{fieldPath:c.field.canonicalString(),appendMissingElements:{values:d.elements}};if(d instanceof Ca)return{fieldPath:c.field.canonicalString(),removeAllFromArray:{values:d.elements}};if(d instanceof lc)return{fieldPath:c.field.canonicalString(),increment:d.Re};throw Ke(20930,{transform:c.transform})}(0,r))),e.precondition.isNone||(t.currentDocument=function(o,a){return a.updateTime!==void 0?{updateTime:r5(o,a.updateTime)}:a.exists!==void 0?{exists:a.exists}:Ke(27497)}(n,e.precondition)),t}function My(n,e){const t=e.currentDocument?function(a){return a.updateTime!==void 0?dn.updateTime(kn(a.updateTime)):a.exists!==void 0?dn.exists(a.exists):dn.none()}(e.currentDocument):dn.none(),r=e.updateTransforms?e.updateTransforms.map(o=>function(c,d){let h=null;if("setToServerValue"in d)nt(d.setToServerValue==="REQUEST_TIME",16630,{proto:d}),h=new ac;else if("appendMissingElements"in d){const g=d.appendMissingElements.values||[];h=new Ia(g)}else if("removeAllFromArray"in d){const g=d.removeAllFromArray.values||[];h=new Ca(g)}else"increment"in d?h=new lc(c,d.increment):Ke(16584,{proto:d});const m=sn.fromServerFormat(d.fieldPath);return new wd(m,h)}(n,o)):[];if(e.update){e.update.name;const o=Vi(n,e.update.name),a=new Jn({mapValue:{fields:e.update.fields}});if(e.updateMask){const c=function(h){const m=h.fieldPaths||[];return new Cr(m.map(g=>sn.fromServerFormat(g)))}(e.updateMask);return new Ro(o,a,c,t,r)}return new _c(o,a,t,r)}if(e.delete){const o=Vi(n,e.delete);return new jc(o,t)}if(e.verify){const o=Vi(n,e.verify);return new Ex(o,t)}return Ke(1463,{proto:e})}function s5(n,e){return n&&n.length>0?(nt(e!==void 0,14353),n.map(t=>function(o,a){let c=o.updateTime?kn(o.updateTime):kn(a);return c.isEqual(at.min())&&(c=kn(a)),new G6(c,o.transformResults||[])}(t,e))):[]}function m_(n,e){return{documents:[d_(n,e.path)]}}function Af(n,e){const t={structuredQuery:{}},r=e.path;let o;e.collectionGroup!==null?(o=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(o=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=d_(n,o);const a=function(m){if(m.length!==0)return b_(Ut.create(m,"and"))}(e.filters);a&&(t.structuredQuery.where=a);const c=function(m){if(m.length!==0)return m.map(g=>function(S){return{field:as(S.field),direction:l5(S.dir)}}(g))}(e.orderBy);c&&(t.structuredQuery.orderBy=c);const d=zy(n,e.limit);return d!==null&&(t.structuredQuery.limit=d),e.startAt&&(t.structuredQuery.startAt=function(m){return{before:m.inclusive,values:m.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(m){return{before:!m.inclusive,values:m.position}}(e.endAt)),{gt:t,parent:o}}function g_(n,e,t,r){const{gt:o,parent:a}=Af(n,e),c={},d=[];let h=0;return t.forEach(m=>{const g=r?m.alias:"aggregate_"+h++;c[g]=m.alias,m.aggregateType==="count"?d.push({alias:g,count:{}}):m.aggregateType==="avg"?d.push({alias:g,avg:{field:as(m.fieldPath)}}):m.aggregateType==="sum"&&d.push({alias:g,sum:{field:as(m.fieldPath)}})}),{request:{structuredAggregationQuery:{aggregations:d,structuredQuery:o.structuredQuery},parent:o.parent},yt:c,parent:a}}function y_(n){let e=h_(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let o=null;if(r>0){nt(r===1,65062);const g=t.from[0];g.allDescendants?o=g.collectionId:e=e.child(g.collectionId)}let a=[];t.where&&(a=function(x){const S=x_(x);return S instanceof Ut&&jx(S)?S.getFilters():[S]}(t.where));let c=[];t.orderBy&&(c=function(x){return x.map(S=>function(T){return new ad(Wl(T.field),function(I){switch(I){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(T.direction))}(S))}(t.orderBy));let d=null;t.limit&&(d=function(x){let S;return S=typeof x=="object"?x.value:x,gd(S)?null:S}(t.limit));let h=null;t.startAt&&(h=function(x){const S=!!x.before,j=x.values||[];return new Ts(j,S)}(t.startAt));let m=null;return t.endAt&&(m=function(x){const S=!x.before,j=x.values||[];return new Ts(j,S)}(t.endAt)),WT(e,o,c,a,d,"F",h,m)}function a5(n,e){const t=function(o){switch(o){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Ke(28987,{purpose:o})}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function x_(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":const r=Wl(t.unaryFilter.field);return Ct.create(r,"==",{doubleValue:NaN});case"IS_NULL":const o=Wl(t.unaryFilter.field);return Ct.create(o,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const a=Wl(t.unaryFilter.field);return Ct.create(a,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const c=Wl(t.unaryFilter.field);return Ct.create(c,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Ke(61313);default:return Ke(60726)}}(n):n.fieldFilter!==void 0?function(t){return Ct.create(Wl(t.fieldFilter.field),function(o){switch(o){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Ke(58110);default:return Ke(50506)}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return Ut.create(t.compositeFilter.filters.map(r=>x_(r)),function(o){switch(o){case"AND":return"and";case"OR":return"or";default:return Ke(1026)}}(t.compositeFilter.op))}(n):Ke(30097,{filter:n})}function l5(n){return Z6[n]}function c5(n){return e5[n]}function u5(n){return t5[n]}function as(n){return{fieldPath:n.canonicalString()}}function Wl(n){return sn.fromServerFormat(n.fieldPath)}function b_(n){return n instanceof Ct?function(t){if(t.op==="=="){if(L1(t.value))return{unaryFilter:{field:as(t.field),op:"IS_NAN"}};if(M1(t.value))return{unaryFilter:{field:as(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(L1(t.value))return{unaryFilter:{field:as(t.field),op:"IS_NOT_NAN"}};if(M1(t.value))return{unaryFilter:{field:as(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:as(t.field),op:c5(t.op),value:t.value}}}(n):n instanceof Ut?function(t){const r=t.getFilters().map(o=>b_(o));return r.length===1?r[0]:{compositeFilter:{op:u5(t.op),filters:r}}}(n):Ke(54877,{filter:n})}function d5(n){const e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function v_(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class go{constructor(e,t,r,o,a=at.min(),c=at.min(),d=mn.EMPTY_BYTE_STRING,h=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=o,this.snapshotVersion=a,this.lastLimboFreeSnapshotVersion=c,this.resumeToken=d,this.expectedCount=h}withSequenceNumber(e){return new go(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new go(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new go(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new go(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w_{constructor(e){this.wt=e}}function h5(n,e){let t;if(e.document)t=f_(n.wt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=Ve.fromSegments(e.noDocument.path),o=Ea(e.noDocument.readTime);t=on.newNoDocument(r,o),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return Ke(56709);{const r=Ve.fromSegments(e.unknownDocument.path),o=Ea(e.unknownDocument.version);t=on.newUnknownDocument(r,o)}}return e.readTime&&t.setReadTime(function(o){const a=new Yt(o[0],o[1]);return at.fromTimestamp(a)}(e.readTime)),t}function nw(n,e){const t=e.key,r={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:$p(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(a,c){return{name:ld(a,c.key),fields:c.data.value.mapValue.fields,updateTime:cc(a,c.version.toTimestamp()),createTime:cc(a,c.createTime.toTimestamp())}}(n.wt,e);else if(e.isNoDocument())r.noDocument={path:t.path.toArray(),readTime:Ra(e.version)};else{if(!e.isUnknownDocument())return Ke(57904,{document:e});r.unknownDocument={path:t.path.toArray(),version:Ra(e.version)}}return r}function $p(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function Ra(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Ea(n){const e=new Yt(n.seconds,n.nanoseconds);return at.fromTimestamp(e)}function da(n,e){const t=(e.baseMutations||[]).map(a=>My(n.wt,a));for(let a=0;a<e.mutations.length-1;++a){const c=e.mutations[a];if(a+1<e.mutations.length&&e.mutations[a+1].transform!==void 0){const d=e.mutations[a+1];c.updateTransforms=d.transform.fieldTransforms,e.mutations.splice(a+1,1),++a}}const r=e.mutations.map(a=>My(n.wt,a)),o=Yt.fromMillis(e.localWriteTimeMs);return new Ax(e.batchId,o,t,r)}function Du(n){const e=Ea(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?Ea(n.lastLimboFreeSnapshotVersion):at.min();let r;return r=function(a){return a.documents!==void 0}(n.query)?function(a){const c=a.documents.length;return nt(c===1,1966,{count:c}),ar(Tc(h_(a.documents[0])))}(n.query):function(a){return ar(y_(a))}(n.query),new go(r,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,mn.fromBase64String(n.resumeToken))}function S_(n,e){const t=Ra(e.snapshotVersion),r=Ra(e.lastLimboFreeSnapshotVersion);let o;o=Vp(e.target)?m_(n.wt,e.target):Af(n.wt,e.target).gt;const a=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:ja(e.target),readTime:t,resumeToken:a,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:o}}function Dx(n){const e=y_({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?qp(e,e.limit,"L"):e}function Vg(n,e){return new Bx(e.largestBatchId,My(n.wt,e.overlayMutation))}function rw(n,e){const t=e.path.lastSegment();return[n,sr(e.path.popLast()),t]}function iw(n,e,t,r){return{indexId:n,uid:e,sequenceNumber:t,readTime:Ra(r.readTime),documentKey:sr(r.documentKey.path),largestBatchId:r.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p5{getBundleMetadata(e,t){return ow(e).get(t).next(r=>{if(r)return function(a){return{id:a.bundleId,createTime:Ea(a.createTime),version:a.version}}(r)})}saveBundleMetadata(e,t){return ow(e).put(function(o){return{bundleId:o.id,createTime:Ra(kn(o.createTime)),version:o.version}}(t))}getNamedQuery(e,t){return sw(e).get(t).next(r=>{if(r)return function(a){return{name:a.name,query:Dx(a.bundledQuery),readTime:Ea(a.readTime)}}(r)})}saveNamedQuery(e,t){return sw(e).put(function(o){return{name:o.name,readTime:Ra(kn(o.readTime)),bundledQuery:o.bundledQuery}}(t))}}function ow(n){return zn(n,kf)}function sw(n){return zn(n,Tf)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pf{constructor(e,t){this.serializer=e,this.userId=t}static bt(e,t){const r=t.uid||"";return new Pf(e,r)}getOverlay(e,t){return Su(e).get(rw(this.userId,t)).next(r=>r?Vg(this.serializer,r):null)}getOverlays(e,t){const r=Mi();return ue.forEach(t,o=>this.getOverlay(e,o).next(a=>{a!==null&&r.set(o,a)})).next(()=>r)}saveOverlays(e,t,r){const o=[];return r.forEach((a,c)=>{const d=new Bx(t,c);o.push(this.St(e,d))}),ue.waitFor(o)}removeOverlaysForBatchId(e,t,r){const o=new Set;t.forEach(c=>o.add(sr(c.getCollectionPath())));const a=[];return o.forEach(c=>{const d=IDBKeyRange.bound([this.userId,c,r],[this.userId,c,r+1],!1,!0);a.push(Su(e).X(Iy,d))}),ue.waitFor(a)}getOverlaysForCollection(e,t,r){const o=Mi(),a=sr(t),c=IDBKeyRange.bound([this.userId,a,r],[this.userId,a,Number.POSITIVE_INFINITY],!0);return Su(e).J(Iy,c).next(d=>{for(const h of d){const m=Vg(this.serializer,h);o.set(m.getKey(),m)}return o})}getOverlaysForCollectionGroup(e,t,r,o){const a=Mi();let c;const d=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,Number.POSITIVE_INFINITY],!0);return Su(e).te({index:xT,range:d},(h,m,g)=>{const x=Vg(this.serializer,m);a.size()<o||x.largestBatchId===c?(a.set(x.getKey(),x),c=x.largestBatchId):g.done()}).next(()=>a)}St(e,t){return Su(e).put(function(o,a,c){const[d,h,m]=rw(a,c.mutation.key);return{userId:a,collectionPath:h,documentId:m,collectionGroup:c.mutation.key.getCollectionGroup(),largestBatchId:c.largestBatchId,overlayMutation:cd(o.wt,c.mutation)}}(this.serializer,this.userId,t))}}function Su(n){return zn(n,_f)}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f5{Dt(e){return zn(e,Sx)}getSessionToken(e){return this.Dt(e).get("sessionToken").next(t=>{const r=t==null?void 0:t.value;return r?mn.fromUint8Array(r):mn.EMPTY_BYTE_STRING})}setSessionToken(e,t){return this.Dt(e).put({name:"sessionToken",value:t.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ha{constructor(){}vt(e,t){this.Ct(e,t),t.Ft()}Ct(e,t){if("nullValue"in e)this.Mt(t,5);else if("booleanValue"in e)this.Mt(t,10),t.xt(e.booleanValue?1:0);else if("integerValue"in e)this.Mt(t,15),t.xt(un(e.integerValue));else if("doubleValue"in e){const r=un(e.doubleValue);isNaN(r)?this.Mt(t,13):(this.Mt(t,15),Zu(r)?t.xt(0):t.xt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Mt(t,20),typeof r=="string"&&(r=So(r)),t.Ot(`${r.seconds||""}`),t.xt(r.nanos||0)}else if("stringValue"in e)this.Nt(e.stringValue,t),this.Bt(t);else if("bytesValue"in e)this.Mt(t,30),t.Lt(ko(e.bytesValue)),this.Bt(t);else if("referenceValue"in e)this.kt(e.referenceValue,t);else if("geoPointValue"in e){const r=e.geoPointValue;this.Mt(t,45),t.xt(r.latitude||0),t.xt(r.longitude||0)}else"mapValue"in e?AT(e)?this.Mt(t,Number.MAX_SAFE_INTEGER):Cf(e)?this.qt(e.mapValue,t):(this.Qt(e.mapValue,t),this.Bt(t)):"arrayValue"in e?(this.$t(e.arrayValue,t),this.Bt(t)):Ke(19022,{Ut:e})}Nt(e,t){this.Mt(t,25),this.Kt(e,t)}Kt(e,t){t.Ot(e)}Qt(e,t){const r=e.fields||{};this.Mt(t,55);for(const o of Object.keys(r))this.Nt(o,t),this.Ct(r[o],t)}qt(e,t){var r,o;const a=e.fields||{};this.Mt(t,53);const c=ic,d=((o=(r=a[c].arrayValue)===null||r===void 0?void 0:r.values)===null||o===void 0?void 0:o.length)||0;this.Mt(t,15),t.xt(un(d)),this.Nt(c,t),this.Ct(a[c],t)}$t(e,t){const r=e.values||[];this.Mt(t,50);for(const o of r)this.Ct(o,t)}kt(e,t){this.Mt(t,37),Ve.fromName(e).path.forEach(r=>{this.Mt(t,60),this.Kt(r,t)})}Mt(e,t){e.xt(t)}Bt(e){e.xt(2)}}ha.Wt=new ha;/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law | agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES | CONDITIONS OF ANY KIND, either express | implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rl=255;function m5(n){if(n===0)return 8;let e=0;return n>>4||(e+=4,n<<=4),n>>6||(e+=2,n<<=2),n>>7||(e+=1),e}function aw(n){const e=64-function(r){let o=0;for(let a=0;a<8;++a){const c=m5(255&r[a]);if(o+=c,c!==8)break}return o}(n);return Math.ceil(e/8)}class g5{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Gt(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.zt(r.value),r=t.next();this.jt()}Ht(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Jt(r.value),r=t.next();this.Yt()}Zt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.zt(r);else if(r<2048)this.zt(960|r>>>6),this.zt(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.zt(480|r>>>12),this.zt(128|63&r>>>6),this.zt(128|63&r);else{const o=t.codePointAt(0);this.zt(240|o>>>18),this.zt(128|63&o>>>12),this.zt(128|63&o>>>6),this.zt(128|63&o)}}this.jt()}Xt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Jt(r);else if(r<2048)this.Jt(960|r>>>6),this.Jt(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Jt(480|r>>>12),this.Jt(128|63&r>>>6),this.Jt(128|63&r);else{const o=t.codePointAt(0);this.Jt(240|o>>>18),this.Jt(128|63&o>>>12),this.Jt(128|63&o>>>6),this.Jt(128|63&o)}}this.Yt()}en(e){const t=this.tn(e),r=aw(t);this.nn(1+r),this.buffer[this.position++]=255&r;for(let o=t.length-r;o<t.length;++o)this.buffer[this.position++]=255&t[o]}rn(e){const t=this.tn(e),r=aw(t);this.nn(1+r),this.buffer[this.position++]=~(255&r);for(let o=t.length-r;o<t.length;++o)this.buffer[this.position++]=~(255&t[o])}sn(){this._n(Rl),this._n(255)}an(){this.un(Rl),this.un(255)}reset(){this.position=0}seed(e){this.nn(e.length),this.buffer.set(e,this.position),this.position+=e.length}cn(){return this.buffer.slice(0,this.position)}tn(e){const t=function(a){const c=new DataView(new ArrayBuffer(8));return c.setFloat64(0,a,!1),new Uint8Array(c.buffer)}(e),r=!!(128&t[0]);t[0]^=r?255:128;for(let o=1;o<t.length;++o)t[o]^=r?255:0;return t}zt(e){const t=255&e;t===0?(this._n(0),this._n(255)):t===Rl?(this._n(Rl),this._n(0)):this._n(t)}Jt(e){const t=255&e;t===0?(this.un(0),this.un(255)):t===Rl?(this.un(Rl),this.un(0)):this.un(e)}jt(){this._n(0),this._n(1)}Yt(){this.un(0),this.un(1)}_n(e){this.nn(1),this.buffer[this.position++]=e}un(e){this.nn(1),this.buffer[this.position++]=~e}nn(e){const t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);const o=new Uint8Array(r);o.set(this.buffer),this.buffer=o}}class y5{constructor(e){this.ln=e}Lt(e){this.ln.Gt(e)}Ot(e){this.ln.Zt(e)}xt(e){this.ln.en(e)}Ft(){this.ln.sn()}}class x5{constructor(e){this.ln=e}Lt(e){this.ln.Ht(e)}Ot(e){this.ln.Xt(e)}xt(e){this.ln.rn(e)}Ft(){this.ln.an()}}class ku{constructor(){this.ln=new g5,this.hn=new y5(this.ln),this.Pn=new x5(this.ln)}seed(e){this.ln.seed(e)}Tn(e){return e===0?this.hn:this.Pn}cn(){return this.ln.cn()}reset(){this.ln.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pa{constructor(e,t,r,o){this.In=e,this.En=t,this.dn=r,this.An=o}Rn(){const e=this.An.length,t=e===0||this.An[e-1]===255?e+1:e,r=new Uint8Array(t);return r.set(this.An,0),t!==e?r.set([0],this.An.length):++r[r.length-1],new pa(this.In,this.En,this.dn,r)}Vn(e,t,r){return{indexId:this.In,uid:e,arrayValue:jp(this.dn),directionalValue:jp(this.An),orderedDocumentKey:jp(t),documentKey:r.path.toArray()}}mn(e,t,r){const o=this.Vn(e,t,r);return[o.indexId,o.uid,o.arrayValue,o.directionalValue,o.orderedDocumentKey,o.documentKey]}}function rs(n,e){let t=n.In-e.In;return t!==0?t:(t=lw(n.dn,e.dn),t!==0?t:(t=lw(n.An,e.An),t!==0?t:Ve.comparator(n.En,e.En)))}function lw(n,e){for(let t=0;t<n.length&&t<e.length;++t){const r=n[t]-e[t];if(r!==0)return r}return n.length-e.length}function jp(n){return qk()?function(t){let r="";for(let o=0;o<t.length;o++)r+=String.fromCharCode(t[o]);return r}(n):n}function cw(n){return typeof n!="string"?n:function(t){const r=new Uint8Array(t.length);for(let o=0;o<t.length;o++)r[o]=t.charCodeAt(o);return r}(n)}class uw{constructor(e){this.fn=new qt((t,r)=>sn.comparator(t.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.gn=e.orderBy,this.pn=[];for(const t of e.filters){const r=t;r.isInequality()?this.fn=this.fn.add(r):this.pn.push(r)}}get yn(){return this.fn.size>1}wn(e){if(nt(e.collectionGroup===this.collectionId,49279),this.yn)return!1;const t=Ty(e);if(t!==void 0&&!this.bn(t))return!1;const r=aa(e);let o=new Set,a=0,c=0;for(;a<r.length&&this.bn(r[a]);++a)o=o.add(r[a].fieldPath.canonicalString());if(a===r.length)return!0;if(this.fn.size>0){const d=this.fn.getIterator().getNext();if(!o.has(d.field.canonicalString())){const h=r[a];if(!this.Sn(d,h)||!this.Dn(this.gn[c++],h))return!1}++a}for(;a<r.length;++a){const d=r[a];if(c>=this.gn.length||!this.Dn(this.gn[c++],d))return!1}return!0}vn(){if(this.yn)return null;let e=new qt(sn.comparator);const t=[];for(const r of this.pn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")t.push(new ba(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),t.push(new ba(r.field,0))}for(const r of this.gn)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),t.push(new ba(r.field,r.dir==="asc"?0:1)));return new Jl(Jl.UNKNOWN_ID,this.collectionId,t,Zl.empty())}bn(e){for(const t of this.pn)if(this.Sn(t,e))return!0;return!1}Sn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===r}Dn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function k_(n){var e,t;if(nt(n instanceof Ct||n instanceof Ut,20012),n instanceof Ct){if(n instanceof OT){const o=((t=(e=n.value.arrayValue)===null||e===void 0?void 0:e.values)===null||t===void 0?void 0:t.map(a=>Ct.create(n.field,"==",a)))||[];return Ut.create(o,"or")}return n}const r=n.filters.map(o=>k_(o));return Ut.create(r,n.op)}function b5(n){if(n.getFilters().length===0)return[];const e=Wy(k_(n));return nt(T_(e),7391),Ly(e)||Oy(e)?[e]:e.getFilters()}function Ly(n){return n instanceof Ct}function Oy(n){return n instanceof Ut&&jx(n)}function T_(n){return Ly(n)||Oy(n)||function(t){if(t instanceof Ut&&Ay(t)){for(const r of t.getFilters())if(!Ly(r)&&!Oy(r))return!1;return!0}return!1}(n)}function Wy(n){if(nt(n instanceof Ct||n instanceof Ut,34018),n instanceof Ct)return n;if(n.filters.length===1)return Wy(n.filters[0]);const e=n.filters.map(r=>Wy(r));let t=Ut.create(e,n.op);return t=Gp(t),T_(t)?t:(nt(t instanceof Ut,64498),nt(sc(t),40251),nt(t.filters.length>1,57927),t.filters.reduce((r,o)=>Nx(r,o)))}function Nx(n,e){let t;return nt(n instanceof Ct||n instanceof Ut,38388),nt(e instanceof Ct||e instanceof Ut,25473),t=n instanceof Ct?e instanceof Ct?function(o,a){return Ut.create([o,a],"and")}(n,e):dw(n,e):e instanceof Ct?dw(e,n):function(o,a){if(nt(o.filters.length>0&&a.filters.length>0,48005),sc(o)&&sc(a))return NT(o,a.getFilters());const c=Ay(o)?o:a,d=Ay(o)?a:o,h=c.filters.map(m=>Nx(m,d));return Ut.create(h,"or")}(n,e),Gp(t)}function dw(n,e){if(sc(e))return NT(e,n.getFilters());{const t=e.filters.map(r=>Nx(n,r));return Ut.create(t,"or")}}function Gp(n){if(nt(n instanceof Ct||n instanceof Ut,11850),n instanceof Ct)return n;const e=n.getFilters();if(e.length===1)return Gp(e[0]);if(zT(n))return n;const t=e.map(o=>Gp(o)),r=[];return t.forEach(o=>{o instanceof Ct?r.push(o):o instanceof Ut&&(o.op===n.op?r.push(...o.filters):r.push(o))}),r.length===1?r[0]:Ut.create(r,n.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v5{constructor(){this.Cn=new Mx}addToCollectionParentIndex(e,t){return this.Cn.add(t),ue.resolve()}getCollectionParents(e,t){return ue.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return ue.resolve()}deleteFieldIndex(e,t){return ue.resolve()}deleteAllFieldIndexes(e){return ue.resolve()}createTargetIndexes(e,t){return ue.resolve()}getDocumentsMatchingTarget(e,t){return ue.resolve(null)}getIndexType(e,t){return ue.resolve(0)}getFieldIndexes(e,t){return ue.resolve([])}getNextCollectionGroupToUpdate(e){return ue.resolve(null)}getMinOffset(e,t){return ue.resolve(Hr.min())}getMinOffsetFromCollectionGroup(e,t){return ue.resolve(Hr.min())}updateCollectionGroup(e,t,r){return ue.resolve()}updateIndexEntries(e,t){return ue.resolve()}}class Mx{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),o=this.index[t]||new qt(It.comparator),a=!o.has(r);return this.index[t]=o.add(r),a}has(e){const t=e.lastSegment(),r=e.popLast(),o=this.index[t];return o&&o.has(r)}getEntries(e){return(this.index[e]||new qt(It.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hw="IndexedDbIndexManager",ap=new Uint8Array(0);class w5{constructor(e,t){this.databaseId=t,this.Fn=new Mx,this.Mn=new Co(r=>ja(r),(r,o)=>xd(r,o)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.Fn.has(t)){const r=t.lastSegment(),o=t.popLast();e.addOnCommittedListener(()=>{this.Fn.add(t)});const a={collectionId:r,parent:sr(o)};return pw(e).put(a)}return ue.resolve()}getCollectionParents(e,t){const r=[],o=IDBKeyRange.bound([t,""],[sT(t),""],!1,!0);return pw(e).J(o).next(a=>{for(const c of a){if(c.collectionId!==t)break;r.push(Ni(c.parent))}return r})}addFieldIndex(e,t){const r=Tu(e),o=function(d){return{indexId:d.indexId,collectionGroup:d.collectionGroup,fields:d.fields.map(h=>[h.fieldPath.canonicalString(),h.kind])}}(t);delete o.indexId;const a=r.add(o);if(t.indexState){const c=Al(e);return a.next(d=>{c.put(iw(d,this.uid,t.indexState.sequenceNumber,t.indexState.offset))})}return a.next()}deleteFieldIndex(e,t){const r=Tu(e),o=Al(e),a=El(e);return r.delete(t.indexId).next(()=>o.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>a.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const t=Tu(e),r=El(e),o=Al(e);return t.X().next(()=>r.X()).next(()=>o.X())}createTargetIndexes(e,t){return ue.forEach(this.xn(t),r=>this.getIndexType(e,r).next(o=>{if(o===0||o===1){const a=new uw(r).vn();if(a!=null)return this.addFieldIndex(e,a)}}))}getDocumentsMatchingTarget(e,t){const r=El(e);let o=!0;const a=new Map;return ue.forEach(this.xn(t),c=>this.On(e,c).next(d=>{o&&(o=!!d),a.set(c,d)})).next(()=>{if(o){let c=bt();const d=[];return ue.forEach(a,(h,m)=>{Ee(hw,`Using index ${function(z){return`id=${z.indexId}|cg=${z.collectionGroup}|f=${z.fields.map(H=>`${H.fieldPath}:${H.kind}`).join(",")}`}(h)} to execute ${ja(t)}`);const g=function(z,H){const J=Ty(H);if(J===void 0)return null;for(const O of Up(z,J.fieldPath))switch(O.op){case"array-contains-any":return O.value.arrayValue.values||[];case"array-contains":return[O.value]}return null}(m,h),x=function(z,H){const J=new Map;for(const O of aa(H))for(const L of Up(z,O.fieldPath))switch(L.op){case"==":case"in":J.set(O.fieldPath.canonicalString(),L.value);break;case"not-in":case"!=":return J.set(O.fieldPath.canonicalString(),L.value),Array.from(J.values())}return null}(m,h),S=function(z,H){const J=[];let O=!0;for(const L of aa(H)){const C=L.kind===0?q1(z,L.fieldPath,z.startAt):H1(z,L.fieldPath,z.startAt);J.push(C.value),O&&(O=C.inclusive)}return new Ts(J,O)}(m,h),j=function(z,H){const J=[];let O=!0;for(const L of aa(H)){const C=L.kind===0?H1(z,L.fieldPath,z.endAt):q1(z,L.fieldPath,z.endAt);J.push(C.value),O&&(O=C.inclusive)}return new Ts(J,O)}(m,h),T=this.Nn(h,m,S),R=this.Nn(h,m,j),I=this.Bn(h,m,x),F=this.Ln(h.indexId,g,T,S.inclusive,R,j.inclusive,I);return ue.forEach(F,P=>r.Z(P,t.limit).next(z=>{z.forEach(H=>{const J=Ve.fromSegments(H.documentKey);c.has(J)||(c=c.add(J),d.push(J))})}))}).next(()=>d)}return ue.resolve(null)})}xn(e){let t=this.Mn.get(e);return t||(e.filters.length===0?t=[e]:t=b5(Ut.create(e.filters,"and")).map(r=>By(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.Mn.set(e,t),t)}Ln(e,t,r,o,a,c,d){const h=(t!=null?t.length:1)*Math.max(r.length,a.length),m=h/(t!=null?t.length:1),g=[];for(let x=0;x<h;++x){const S=t?this.kn(t[x/m]):ap,j=this.qn(e,S,r[x%m],o),T=this.Qn(e,S,a[x%m],c),R=d.map(I=>this.qn(e,S,I,!0));g.push(...this.createRange(j,T,R))}return g}qn(e,t,r,o){const a=new pa(e,Ve.empty(),t,r);return o?a:a.Rn()}Qn(e,t,r,o){const a=new pa(e,Ve.empty(),t,r);return o?a.Rn():a}On(e,t){const r=new uw(t),o=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,o).next(a=>{let c=null;for(const d of a)r.wn(d)&&(!c||d.fields.length>c.fields.length)&&(c=d);return c})}getIndexType(e,t){let r=2;const o=this.xn(t);return ue.forEach(o,a=>this.On(e,a).next(c=>{c?r!==0&&c.fields.length<function(h){let m=new qt(sn.comparator),g=!1;for(const x of h.filters)for(const S of x.getFlattenedFilters())S.field.isKeyField()||(S.op==="array-contains"||S.op==="array-contains-any"?g=!0:m=m.add(S.field));for(const x of h.orderBy)x.field.isKeyField()||(m=m.add(x.field));return m.size+(g?1:0)}(a)&&(r=1):r=0})).next(()=>function(c){return c.limit!==null}(t)&&o.length>1&&r===2?1:r)}$n(e,t){const r=new ku;for(const o of aa(e)){const a=t.data.field(o.fieldPath);if(a==null)return null;const c=r.Tn(o.kind);ha.Wt.vt(a,c)}return r.cn()}kn(e){const t=new ku;return ha.Wt.vt(e,t.Tn(0)),t.cn()}Un(e,t){const r=new ku;return ha.Wt.vt(_a(this.databaseId,t),r.Tn(function(a){const c=aa(a);return c.length===0?0:c[c.length-1].kind}(e))),r.cn()}Bn(e,t,r){if(r===null)return[];let o=[];o.push(new ku);let a=0;for(const c of aa(e)){const d=r[a++];for(const h of o)if(this.Kn(t,c.fieldPath)&&sd(d))o=this.Wn(o,c,d);else{const m=h.Tn(c.kind);ha.Wt.vt(d,m)}}return this.Gn(o)}Nn(e,t,r){return this.Bn(e,t,r.position)}Gn(e){const t=[];for(let r=0;r<e.length;++r)t[r]=e[r].cn();return t}Wn(e,t,r){const o=[...e],a=[];for(const c of r.arrayValue.values||[])for(const d of o){const h=new ku;h.seed(d.cn()),ha.Wt.vt(c,h.Tn(t.kind)),a.push(h)}return a}Kn(e,t){return!!e.filters.find(r=>r instanceof Ct&&r.field.isEqual(t)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,t){const r=Tu(e),o=Al(e);return(t?r.J(jy,IDBKeyRange.bound(t,t)):r.J()).next(a=>{const c=[];return ue.forEach(a,d=>o.get([d.indexId,this.uid]).next(h=>{c.push(function(g,x){const S=x?new Zl(x.sequenceNumber,new Hr(Ea(x.readTime),new Ve(Ni(x.documentKey)),x.largestBatchId)):Zl.empty(),j=g.fields.map(([T,R])=>new ba(sn.fromServerFormat(T),R));return new Jl(g.indexId,g.collectionGroup,j,S)}(d,h))})).next(()=>c)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(t=>t.length===0?null:(t.sort((r,o)=>{const a=r.indexState.sequenceNumber-o.indexState.sequenceNumber;return a!==0?a:ut(r.collectionGroup,o.collectionGroup)}),t[0].collectionGroup))}updateCollectionGroup(e,t,r){const o=Tu(e),a=Al(e);return this.zn(e).next(c=>o.J(jy,IDBKeyRange.bound(t,t)).next(d=>ue.forEach(d,h=>a.put(iw(h.indexId,this.uid,c,r)))))}updateIndexEntries(e,t){const r=new Map;return ue.forEach(t,(o,a)=>{const c=r.get(o.collectionGroup);return(c?ue.resolve(c):this.getFieldIndexes(e,o.collectionGroup)).next(d=>(r.set(o.collectionGroup,d),ue.forEach(d,h=>this.jn(e,o,h).next(m=>{const g=this.Hn(a,h);return m.isEqual(g)?ue.resolve():this.Jn(e,a,h,m,g)}))))})}Yn(e,t,r,o){return El(e).put(o.Vn(this.uid,this.Un(r,t.key),t.key))}Zn(e,t,r,o){return El(e).delete(o.mn(this.uid,this.Un(r,t.key),t.key))}jn(e,t,r){const o=El(e);let a=new qt(rs);return o.te({index:yT,range:IDBKeyRange.only([r.indexId,this.uid,jp(this.Un(r,t))])},(c,d)=>{a=a.add(new pa(r.indexId,t,cw(d.arrayValue),cw(d.directionalValue)))}).next(()=>a)}Hn(e,t){let r=new qt(rs);const o=this.$n(t,e);if(o==null)return r;const a=Ty(t);if(a!=null){const c=e.data.field(a.fieldPath);if(sd(c))for(const d of c.arrayValue.values||[])r=r.add(new pa(t.indexId,e.key,this.kn(d),o))}else r=r.add(new pa(t.indexId,e.key,ap,o));return r}Jn(e,t,r,o,a){Ee(hw,"Updating index entries for document '%s'",t.key);const c=[];return function(h,m,g,x,S){const j=h.getIterator(),T=m.getIterator();let R=Cl(j),I=Cl(T);for(;R||I;){let F=!1,P=!1;if(R&&I){const z=g(R,I);z<0?P=!0:z>0&&(F=!0)}else R!=null?P=!0:F=!0;F?(x(I),I=Cl(T)):P?(S(R),R=Cl(j)):(R=Cl(j),I=Cl(T))}}(o,a,rs,d=>{c.push(this.Yn(e,t,r,d))},d=>{c.push(this.Zn(e,t,r,d))}),ue.waitFor(c)}zn(e){let t=1;return Al(e).te({index:gT,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,o,a)=>{a.done(),t=o.sequenceNumber+1}).next(()=>t)}createRange(e,t,r){r=r.sort((c,d)=>rs(c,d)).filter((c,d,h)=>!d||rs(c,h[d-1])!==0);const o=[];o.push(e);for(const c of r){const d=rs(c,e),h=rs(c,t);if(d===0)o[0]=e.Rn();else if(d>0&&h<0)o.push(c),o.push(c.Rn());else if(h>0)break}o.push(t);const a=[];for(let c=0;c<o.length;c+=2){if(this.Xn(o[c],o[c+1]))return[];const d=o[c].mn(this.uid,ap,Ve.empty()),h=o[c+1].mn(this.uid,ap,Ve.empty());a.push(IDBKeyRange.bound(d,h))}return a}Xn(e,t){return rs(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(fw)}getMinOffset(e,t){return ue.mapArray(this.xn(t),r=>this.On(e,r).next(o=>o||Ke(44426))).next(fw)}}function pw(n){return zn(n,nd)}function El(n){return zn(n,Wu)}function Tu(n){return zn(n,wx)}function Al(n){return zn(n,Ou)}function fw(n){nt(n.length!==0,28825);let e=n[0].indexState.offset,t=e.largestBatchId;for(let r=1;r<n.length;r++){const o=n[r].indexState.offset;xx(o,e)<0&&(e=o),t<o.largestBatchId&&(t=o.largestBatchId)}return new Hr(e.readTime,e.documentKey,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mw={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},__=41943040;class ir{static withCacheSize(e){return new ir(e,ir.DEFAULT_COLLECTION_PERCENTILE,ir.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function j_(n,e,t){const r=n.store(mi),o=n.store(ec),a=[],c=IDBKeyRange.only(t.batchId);let d=0;const h=r.te({range:c},(g,x,S)=>(d++,S.delete()));a.push(h.next(()=>{nt(d===1,47070,{batchId:t.batchId})}));const m=[];for(const g of t.mutations){const x=pT(e,g.key.path,t.batchId);a.push(o.delete(x)),m.push(g.key)}return ue.waitFor(a).next(()=>m)}function Kp(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw Ke(14731);e=n.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ir.DEFAULT_COLLECTION_PERCENTILE=10,ir.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,ir.DEFAULT=new ir(__,ir.DEFAULT_COLLECTION_PERCENTILE,ir.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),ir.DISABLED=new ir(-1,0,0);class Bf{constructor(e,t,r,o){this.userId=e,this.serializer=t,this.indexManager=r,this.referenceDelegate=o,this.er={}}static bt(e,t,r,o){nt(e.uid!=="",64387);const a=e.isAuthenticated()?e.uid:"";return new Bf(a,t,r,o)}checkEmpty(e){let t=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return is(e).te({index:fa,range:r},(o,a,c)=>{t=!1,c.done()}).next(()=>t)}addMutationBatch(e,t,r,o){const a=Vl(e),c=is(e);return c.add({}).next(d=>{nt(typeof d=="number",49019);const h=new Ax(d,t,r,o),m=function(j,T,R){const I=R.baseMutations.map(P=>cd(j.wt,P)),F=R.mutations.map(P=>cd(j.wt,P));return{userId:T,batchId:R.batchId,localWriteTimeMs:R.localWriteTime.toMillis(),baseMutations:I,mutations:F}}(this.serializer,this.userId,h),g=[];let x=new qt((S,j)=>ut(S.canonicalString(),j.canonicalString()));for(const S of o){const j=pT(this.userId,S.key.path,d);x=x.add(S.key.path.popLast()),g.push(c.put(m)),g.push(a.put(j,n6))}return x.forEach(S=>{g.push(this.indexManager.addToCollectionParentIndex(e,S))}),e.addOnCommittedListener(()=>{this.er[d]=h.keys()}),ue.waitFor(g).next(()=>h)})}lookupMutationBatch(e,t){return is(e).get(t).next(r=>r?(nt(r.userId===this.userId,48,"Unexpected user for mutation batch",{userId:r.userId,batchId:t}),da(this.serializer,r)):null)}tr(e,t){return this.er[t]?ue.resolve(this.er[t]):this.lookupMutationBatch(e,t).next(r=>{if(r){const o=r.keys();return this.er[t]=o,o}return null})}getNextMutationBatchAfterBatchId(e,t){const r=t+1,o=IDBKeyRange.lowerBound([this.userId,r]);let a=null;return is(e).te({index:fa,range:o},(c,d,h)=>{d.userId===this.userId&&(nt(d.batchId>=r,47524,{nr:r}),a=da(this.serializer,d)),h.done()}).next(()=>a)}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=ys;return is(e).te({index:fa,range:t,reverse:!0},(o,a,c)=>{r=a.batchId,c.done()}).next(()=>r)}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,ys],[this.userId,Number.POSITIVE_INFINITY]);return is(e).J(fa,t).next(r=>r.map(o=>da(this.serializer,o)))}getAllMutationBatchesAffectingDocumentKey(e,t){const r=bp(this.userId,t.path),o=IDBKeyRange.lowerBound(r),a=[];return Vl(e).te({range:o},(c,d,h)=>{const[m,g,x]=c,S=Ni(g);if(m===this.userId&&t.path.isEqual(S))return is(e).get(x).next(j=>{if(!j)throw Ke(61480,{rr:c,batchId:x});nt(j.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:j.userId,batchId:x}),a.push(da(this.serializer,j))});h.done()}).next(()=>a)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new qt(ut);const o=[];return t.forEach(a=>{const c=bp(this.userId,a.path),d=IDBKeyRange.lowerBound(c),h=Vl(e).te({range:d},(m,g,x)=>{const[S,j,T]=m,R=Ni(j);S===this.userId&&a.path.isEqual(R)?r=r.add(T):x.done()});o.push(h)}),ue.waitFor(o).next(()=>this.ir(e,r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,o=r.length+1,a=bp(this.userId,r),c=IDBKeyRange.lowerBound(a);let d=new qt(ut);return Vl(e).te({range:c},(h,m,g)=>{const[x,S,j]=h,T=Ni(S);x===this.userId&&r.isPrefixOf(T)?T.length===o&&(d=d.add(j)):g.done()}).next(()=>this.ir(e,d))}ir(e,t){const r=[],o=[];return t.forEach(a=>{o.push(is(e).get(a).next(c=>{if(c===null)throw Ke(35274,{batchId:a});nt(c.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:c.userId,batchId:a}),r.push(da(this.serializer,c))}))}),ue.waitFor(o).next(()=>r)}removeMutationBatch(e,t){return j_(e.he,this.userId,t).next(r=>(e.addOnCommittedListener(()=>{this.sr(t.batchId)}),ue.forEach(r,o=>this.referenceDelegate.markPotentiallyOrphaned(e,o))))}sr(e){delete this.er[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return ue.resolve();const r=IDBKeyRange.lowerBound(function(c){return[c]}(this.userId)),o=[];return Vl(e).te({range:r},(a,c,d)=>{if(a[0]===this.userId){const h=Ni(a[1]);o.push(h)}else d.done()}).next(()=>{nt(o.length===0,56720,{_r:o.map(a=>a.canonicalString())})})})}containsKey(e,t){return I_(e,this.userId,t)}ar(e){return C_(e).get(this.userId).next(t=>t||{userId:this.userId,lastAcknowledgedBatchId:ys,lastStreamToken:""})}}function I_(n,e,t){const r=bp(e,t.path),o=r[1],a=IDBKeyRange.lowerBound(r);let c=!1;return Vl(n).te({range:a,ee:!0},(d,h,m)=>{const[g,x,S]=d;g===e&&x===o&&(c=!0),m.done()}).next(()=>c)}function is(n){return zn(n,mi)}function Vl(n){return zn(n,ec)}function C_(n){return zn(n,ed)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Aa{constructor(e){this.ur=e}next(){return this.ur+=2,this.ur}static cr(){return new Aa(0)}static lr(){return new Aa(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S5{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.hr(e).next(t=>{const r=new Aa(t.highestTargetId);return t.highestTargetId=r.next(),this.Pr(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.hr(e).next(t=>at.fromTimestamp(new Yt(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.hr(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,r){return this.hr(e).next(o=>(o.highestListenSequenceNumber=t,r&&(o.lastRemoteSnapshotVersion=r.toTimestamp()),t>o.highestListenSequenceNumber&&(o.highestListenSequenceNumber=t),this.Pr(e,o)))}addTargetData(e,t){return this.Tr(e,t).next(()=>this.hr(e).next(r=>(r.targetCount+=1,this.Ir(t,r),this.Pr(e,r))))}updateTargetData(e,t){return this.Tr(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>Pl(e).delete(t.targetId)).next(()=>this.hr(e)).next(r=>(nt(r.targetCount>0,8065),r.targetCount-=1,this.Pr(e,r)))}removeTargets(e,t,r){let o=0;const a=[];return Pl(e).te((c,d)=>{const h=Du(d);h.sequenceNumber<=t&&r.get(h.targetId)===null&&(o++,a.push(this.removeTargetData(e,h)))}).next(()=>ue.waitFor(a)).next(()=>o)}forEachTarget(e,t){return Pl(e).te((r,o)=>{const a=Du(o);t(a)})}hr(e){return gw(e).get(Wp).next(t=>(nt(t!==null,2888),t))}Pr(e,t){return gw(e).put(Wp,t)}Tr(e,t){return Pl(e).put(S_(this.serializer,t))}Ir(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.hr(e).next(t=>t.targetCount)}getTargetData(e,t){const r=ja(t),o=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let a=null;return Pl(e).te({range:o,index:mT},(c,d,h)=>{const m=Du(d);xd(t,m.target)&&(a=m,h.done())}).next(()=>a)}addMatchingKeys(e,t,r){const o=[],a=ls(e);return t.forEach(c=>{const d=sr(c.path);o.push(a.put({targetId:r,path:d})),o.push(this.referenceDelegate.addReference(e,r,c))}),ue.waitFor(o)}removeMatchingKeys(e,t,r){const o=ls(e);return ue.forEach(t,a=>{const c=sr(a.path);return ue.waitFor([o.delete([r,c]),this.referenceDelegate.removeReference(e,r,a)])})}removeMatchingKeysForTargetId(e,t){const r=ls(e),o=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(o)}getMatchingKeysForTargetId(e,t){const r=IDBKeyRange.bound([t],[t+1],!1,!0),o=ls(e);let a=bt();return o.te({range:r,ee:!0},(c,d,h)=>{const m=Ni(c[1]),g=new Ve(m);a=a.add(g)}).next(()=>a)}containsKey(e,t){const r=sr(t.path),o=IDBKeyRange.bound([r],[sT(r)],!1,!0);let a=0;return ls(e).te({index:vx,ee:!0,range:o},([c,d],h,m)=>{c!==0&&(a++,m.done())}).next(()=>a>0)}Rt(e,t){return Pl(e).get(t).next(r=>r?Du(r):null)}}function Pl(n){return zn(n,tc)}function gw(n){return zn(n,va)}function ls(n){return zn(n,nc)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yw="LruGarbageCollector",R_=1048576;function xw([n,e],[t,r]){const o=ut(n,t);return o===0?ut(e,r):o}class k5{constructor(e){this.Er=e,this.buffer=new qt(xw),this.dr=0}Ar(){return++this.dr}Rr(e){const t=[e,this.Ar()];if(this.buffer.size<this.Er)this.buffer=this.buffer.add(t);else{const r=this.buffer.last();xw(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}}class E_{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Vr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.mr(6e4)}stop(){this.Vr&&(this.Vr.cancel(),this.Vr=null)}get started(){return this.Vr!==null}mr(e){Ee(yw,`Garbage collection scheduled in ${e}ms`),this.Vr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Vr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Es(t)?Ee(yw,"Ignoring IndexedDB error during garbage collection: ",t):await Rs(t)}await this.mr(3e5)})}}class T5{constructor(e,t){this.gr=e,this.params=t}calculateTargetCount(e,t){return this.gr.pr(e).next(r=>Math.floor(t/100*r))}nthSequenceNumber(e,t){if(t===0)return ue.resolve(Ir.le);const r=new k5(t);return this.gr.forEachTarget(e,o=>r.Rr(o.sequenceNumber)).next(()=>this.gr.yr(e,o=>r.Rr(o))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.gr.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.gr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(Ee("LruGarbageCollector","Garbage collection skipped; disabled"),ue.resolve(mw)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(Ee("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),mw):this.wr(e,t))}getCacheSize(e){return this.gr.getCacheSize(e)}wr(e,t){let r,o,a,c,d,h,m;const g=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(x=>(x>this.params.maximumSequenceNumbersToCollect?(Ee("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${x}`),o=this.params.maximumSequenceNumbersToCollect):o=x,c=Date.now(),this.nthSequenceNumber(e,o))).next(x=>(r=x,d=Date.now(),this.removeTargets(e,r,t))).next(x=>(a=x,h=Date.now(),this.removeOrphanedDocuments(e,r))).next(x=>(m=Date.now(),Ll()<=jt.DEBUG&&Ee("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${c-g}ms
	Determined least recently used ${o} in `+(d-c)+`ms
	Removed ${a} targets in `+(h-d)+`ms
	Removed ${x} documents in `+(m-h)+`ms
Total Duration: ${m-g}ms`),ue.resolve({didRun:!0,sequenceNumbersCollected:o,targetsRemoved:a,documentsRemoved:x})))}}function A_(n,e){return new T5(n,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _5{constructor(e,t){this.db=e,this.garbageCollector=A_(this,t)}pr(e){const t=this.br(e);return this.db.getTargetCache().getTargetCount(e).next(r=>t.next(o=>r+o))}br(e){let t=0;return this.yr(e,r=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}yr(e,t){return this.Sr(e,(r,o)=>t(o))}addReference(e,t,r){return lp(e,r)}removeReference(e,t,r){return lp(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return lp(e,t)}Dr(e,t){return function(o,a){let c=!1;return C_(o).ne(d=>I_(o,d,a).next(h=>(h&&(c=!0),ue.resolve(!h)))).next(()=>c)}(e,t)}removeOrphanedDocuments(e,t){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),o=[];let a=0;return this.Sr(e,(c,d)=>{if(d<=t){const h=this.Dr(e,c).next(m=>{if(!m)return a++,r.getEntry(e,c).next(()=>(r.removeEntry(c,at.min()),ls(e).delete(function(x){return[0,sr(x.path)]}(c))))});o.push(h)}}).next(()=>ue.waitFor(o)).next(()=>r.apply(e)).next(()=>a)}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return lp(e,t)}Sr(e,t){const r=ls(e);let o,a=Ir.le;return r.te({index:vx},([c,d],{path:h,sequenceNumber:m})=>{c===0?(a!==Ir.le&&t(new Ve(Ni(o)),a),a=m,o=h):a=Ir.le}).next(()=>{a!==Ir.le&&t(new Ve(Ni(o)),a)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function lp(n,e){return ls(n).put(function(r,o){return{targetId:0,path:sr(r.path),sequenceNumber:o}}(e,n.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P_{constructor(){this.changes=new Co(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,on.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return r!==void 0?ue.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j5{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return oa(e).put(r)}removeEntry(e,t,r){return oa(e).delete(function(a,c){const d=a.path.toArray();return[d.slice(0,d.length-2),d[d.length-2],$p(c),d[d.length-1]]}(t,r))}updateMetadata(e,t){return this.getMetadata(e).next(r=>(r.byteSize+=t,this.vr(e,r)))}getEntry(e,t){let r=on.newInvalidDocument(t);return oa(e).te({index:vp,range:IDBKeyRange.only(_u(t))},(o,a)=>{r=this.Cr(t,a)}).next(()=>r)}Fr(e,t){let r={size:0,document:on.newInvalidDocument(t)};return oa(e).te({index:vp,range:IDBKeyRange.only(_u(t))},(o,a)=>{r={document:this.Cr(t,a),size:Kp(a)}}).next(()=>r)}getEntries(e,t){let r=Rr();return this.Mr(e,t,(o,a)=>{const c=this.Cr(o,a);r=r.insert(o,c)}).next(()=>r)}Or(e,t){let r=Rr(),o=new tn(Ve.comparator);return this.Mr(e,t,(a,c)=>{const d=this.Cr(a,c);r=r.insert(a,d),o=o.insert(a,Kp(c))}).next(()=>({documents:r,Nr:o}))}Mr(e,t,r){if(t.isEmpty())return ue.resolve();let o=new qt(ww);t.forEach(h=>o=o.add(h));const a=IDBKeyRange.bound(_u(o.first()),_u(o.last())),c=o.getIterator();let d=c.getNext();return oa(e).te({index:vp,range:a},(h,m,g)=>{const x=Ve.fromSegments([...m.prefixPath,m.collectionGroup,m.documentId]);for(;d&&ww(d,x)<0;)r(d,null),d=c.getNext();d&&d.isEqual(x)&&(r(d,m),d=c.hasNext()?c.getNext():null),d?g.H(_u(d)):g.done()}).next(()=>{for(;d;)r(d,null),d=c.hasNext()?c.getNext():null})}getDocumentsMatchingQuery(e,t,r,o,a){const c=t.path,d=[c.popLast().toArray(),c.lastSegment(),$p(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],h=[c.popLast().toArray(),c.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return oa(e).J(IDBKeyRange.bound(d,h,!0)).next(m=>{a==null||a.incrementDocumentReadCount(m.length);let g=Rr();for(const x of m){const S=this.Cr(Ve.fromSegments(x.prefixPath.concat(x.collectionGroup,x.documentId)),x);S.isFoundDocument()&&(vd(t,S)||o.has(S.key))&&(g=g.insert(S.key,S))}return g})}getAllFromCollectionGroup(e,t,r,o){let a=Rr();const c=vw(t,r),d=vw(t,Hr.max());return oa(e).te({index:fT,range:IDBKeyRange.bound(c,d,!0)},(h,m,g)=>{const x=this.Cr(Ve.fromSegments(m.prefixPath.concat(m.collectionGroup,m.documentId)),m);a=a.insert(x.key,x),a.size===o&&g.done()}).next(()=>a)}newChangeBuffer(e){return new I5(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return bw(e).get(_y).next(t=>(nt(!!t,20021),t))}vr(e,t){return bw(e).put(_y,t)}Cr(e,t){if(t){const r=h5(this.serializer,t);if(!(r.isNoDocument()&&r.version.isEqual(at.min())))return r}return on.newInvalidDocument(e)}}function B_(n){return new j5(n)}class I5 extends P_{constructor(e,t){super(),this.Br=e,this.trackRemovals=t,this.Lr=new Co(r=>r.toString(),(r,o)=>r.isEqual(o))}applyChanges(e){const t=[];let r=0,o=new qt((a,c)=>ut(a.canonicalString(),c.canonicalString()));return this.changes.forEach((a,c)=>{const d=this.Lr.get(a);if(t.push(this.Br.removeEntry(e,a,d.readTime)),c.isValidDocument()){const h=nw(this.Br.serializer,c);o=o.add(a.path.popLast());const m=Kp(h);r+=m-d.size,t.push(this.Br.addEntry(e,a,h))}else if(r-=d.size,this.trackRemovals){const h=nw(this.Br.serializer,c.convertToNoDocument(at.min()));t.push(this.Br.addEntry(e,a,h))}}),o.forEach(a=>{t.push(this.Br.indexManager.addToCollectionParentIndex(e,a))}),t.push(this.Br.updateMetadata(e,r)),ue.waitFor(t)}getFromCache(e,t){return this.Br.Fr(e,t).next(r=>(this.Lr.set(t,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,t){return this.Br.Or(e,t).next(({documents:r,Nr:o})=>(o.forEach((a,c)=>{this.Lr.set(a,{size:c,readTime:r.get(a).readTime})}),r))}}function bw(n){return zn(n,td)}function oa(n){return zn(n,Op)}function _u(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function vw(n,e){const t=e.documentKey.path.toArray();return[n,$p(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function ww(n,e){const t=n.path.toArray(),r=e.path.toArray();let o=0;for(let a=0;a<t.length-2&&a<r.length-2;++a)if(o=ut(t[a],r[a]),o)return o;return o=ut(t.length,r.length),o||(o=ut(t[t.length-2],r[r.length-2]),o||ut(t[t.length-1],r[r.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C5{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F_{constructor(e,t,r,o){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=o}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(o=>(r=o,this.remoteDocumentCache.getEntry(e,t))).next(o=>(r!==null&&qu(r.mutation,o,Cr.empty(),Yt.now()),o))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,bt()).next(()=>r))}getLocalViewOfDocuments(e,t,r=bt()){const o=Mi();return this.populateOverlays(e,o,t).next(()=>this.computeViews(e,t,o,r).next(a=>{let c=Fu();return a.forEach((d,h)=>{c=c.insert(d,h.overlayedDocument)}),c}))}getOverlayedDocuments(e,t){const r=Mi();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,bt()))}populateOverlays(e,t,r){const o=[];return r.forEach(a=>{t.has(a)||o.push(a)}),this.documentOverlayCache.getOverlays(e,o).next(a=>{a.forEach((c,d)=>{t.set(c,d)})})}computeViews(e,t,r,o){let a=Rr();const c=Uu(),d=function(){return Uu()}();return t.forEach((h,m)=>{const g=r.get(m.key);o.has(m.key)&&(g===void 0||g.mutation instanceof Ro)?a=a.insert(m.key,m):g!==void 0?(c.set(m.key,g.mutation.getFieldMask()),qu(g.mutation,m,g.mutation.getFieldMask(),Yt.now())):c.set(m.key,Cr.empty())}),this.recalculateAndSaveOverlays(e,a).next(h=>(h.forEach((m,g)=>c.set(m,g)),t.forEach((m,g)=>{var x;return d.set(m,new C5(g,(x=c.get(m))!==null&&x!==void 0?x:null))}),d))}recalculateAndSaveOverlays(e,t){const r=Uu();let o=new tn((c,d)=>c-d),a=bt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(c=>{for(const d of c)d.keys().forEach(h=>{const m=t.get(h);if(m===null)return;let g=r.get(h)||Cr.empty();g=d.applyToLocalView(m,g),r.set(h,g);const x=(o.get(d.batchId)||bt()).add(h);o=o.insert(d.batchId,x)})}).next(()=>{const c=[],d=o.getReverseIterator();for(;d.hasNext();){const h=d.getNext(),m=h.key,g=h.value,x=QT();g.forEach(S=>{if(!a.has(S)){const j=n_(t.get(S),r.get(S));j!==null&&x.set(S,j),a=a.add(S)}}),c.push(this.documentOverlayCache.saveOverlays(e,m,x))}return ue.waitFor(c)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,o){return function(c){return Ve.isDocumentKey(c.path)&&c.collectionGroup===null&&c.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Ix(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,o):this.getDocumentsMatchingCollectionQuery(e,t,r,o)}getNextDocuments(e,t,r,o){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,o).next(a=>{const c=o-a.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,o-a.size):ue.resolve(Mi());let d=Xl,h=a;return c.next(m=>ue.forEach(m,(g,x)=>(d<x.largestBatchId&&(d=x.largestBatchId),a.get(g)?ue.resolve():this.remoteDocumentCache.getEntry(e,g).next(S=>{h=h.insert(g,S)}))).next(()=>this.populateOverlays(e,m,a)).next(()=>this.computeViews(e,h,m,bt())).next(g=>({batchId:d,changes:KT(g)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Ve(t)).next(r=>{let o=Fu();return r.isFoundDocument()&&(o=o.insert(r.key,r)),o})}getDocumentsMatchingCollectionGroupQuery(e,t,r,o){const a=t.collectionGroup;let c=Fu();return this.indexManager.getCollectionParents(e,a).next(d=>ue.forEach(d,h=>{const m=function(x,S){return new Io(S,null,x.explicitOrderBy.slice(),x.filters.slice(),x.limit,x.limitType,x.startAt,x.endAt)}(t,h.child(a));return this.getDocumentsMatchingCollectionQuery(e,m,r,o).next(g=>{g.forEach((x,S)=>{c=c.insert(x,S)})})}).next(()=>c))}getDocumentsMatchingCollectionQuery(e,t,r,o){let a;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(c=>(a=c,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,a,o))).next(c=>{a.forEach((h,m)=>{const g=m.getKey();c.get(g)===null&&(c=c.insert(g,on.newInvalidDocument(g)))});let d=Fu();return c.forEach((h,m)=>{const g=a.get(h);g!==void 0&&qu(g.mutation,m,Cr.empty(),Yt.now()),vd(t,m)&&(d=d.insert(h,m))}),d})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R5{constructor(e){this.serializer=e,this.kr=new Map,this.qr=new Map}getBundleMetadata(e,t){return ue.resolve(this.kr.get(t))}saveBundleMetadata(e,t){return this.kr.set(t.id,function(o){return{id:o.id,version:o.version,createTime:kn(o.createTime)}}(t)),ue.resolve()}getNamedQuery(e,t){return ue.resolve(this.qr.get(t))}saveNamedQuery(e,t){return this.qr.set(t.name,function(o){return{name:o.name,query:Dx(o.bundledQuery),readTime:kn(o.readTime)}}(t)),ue.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E5{constructor(){this.overlays=new tn(Ve.comparator),this.Qr=new Map}getOverlay(e,t){return ue.resolve(this.overlays.get(t))}getOverlays(e,t){const r=Mi();return ue.forEach(t,o=>this.getOverlay(e,o).next(a=>{a!==null&&r.set(o,a)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((o,a)=>{this.St(e,t,a)}),ue.resolve()}removeOverlaysForBatchId(e,t,r){const o=this.Qr.get(r);return o!==void 0&&(o.forEach(a=>this.overlays=this.overlays.remove(a)),this.Qr.delete(r)),ue.resolve()}getOverlaysForCollection(e,t,r){const o=Mi(),a=t.length+1,c=new Ve(t.child("")),d=this.overlays.getIteratorFrom(c);for(;d.hasNext();){const h=d.getNext().value,m=h.getKey();if(!t.isPrefixOf(m.path))break;m.path.length===a&&h.largestBatchId>r&&o.set(h.getKey(),h)}return ue.resolve(o)}getOverlaysForCollectionGroup(e,t,r,o){let a=new tn((m,g)=>m-g);const c=this.overlays.getIterator();for(;c.hasNext();){const m=c.getNext().value;if(m.getKey().getCollectionGroup()===t&&m.largestBatchId>r){let g=a.get(m.largestBatchId);g===null&&(g=Mi(),a=a.insert(m.largestBatchId,g)),g.set(m.getKey(),m)}}const d=Mi(),h=a.getIterator();for(;h.hasNext()&&(h.getNext().value.forEach((m,g)=>d.set(m,g)),!(d.size()>=o)););return ue.resolve(d)}St(e,t,r){const o=this.overlays.get(r.key);if(o!==null){const c=this.Qr.get(o.largestBatchId).delete(r.key);this.Qr.set(o.largestBatchId,c)}this.overlays=this.overlays.insert(r.key,new Bx(t,r));let a=this.Qr.get(t);a===void 0&&(a=bt(),this.Qr.set(t,a)),this.Qr.set(t,a.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A5{constructor(){this.sessionToken=mn.EMPTY_BYTE_STRING}getSessionToken(e){return ue.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,ue.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lx{constructor(){this.$r=new qt(Wn.Ur),this.Kr=new qt(Wn.Wr)}isEmpty(){return this.$r.isEmpty()}addReference(e,t){const r=new Wn(e,t);this.$r=this.$r.add(r),this.Kr=this.Kr.add(r)}Gr(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.zr(new Wn(e,t))}jr(e,t){e.forEach(r=>this.removeReference(r,t))}Hr(e){const t=new Ve(new It([])),r=new Wn(t,e),o=new Wn(t,e+1),a=[];return this.Kr.forEachInRange([r,o],c=>{this.zr(c),a.push(c.key)}),a}Jr(){this.$r.forEach(e=>this.zr(e))}zr(e){this.$r=this.$r.delete(e),this.Kr=this.Kr.delete(e)}Yr(e){const t=new Ve(new It([])),r=new Wn(t,e),o=new Wn(t,e+1);let a=bt();return this.Kr.forEachInRange([r,o],c=>{a=a.add(c.key)}),a}containsKey(e){const t=new Wn(e,0),r=this.$r.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}}class Wn{constructor(e,t){this.key=e,this.Zr=t}static Ur(e,t){return Ve.comparator(e.key,t.key)||ut(e.Zr,t.Zr)}static Wr(e,t){return ut(e.Zr,t.Zr)||Ve.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P5{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.nr=1,this.Xr=new qt(Wn.Ur)}checkEmpty(e){return ue.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,o){const a=this.nr;this.nr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const c=new Ax(a,t,r,o);this.mutationQueue.push(c);for(const d of o)this.Xr=this.Xr.add(new Wn(d.key,a)),this.indexManager.addToCollectionParentIndex(e,d.key.path.popLast());return ue.resolve(c)}lookupMutationBatch(e,t){return ue.resolve(this.ei(t))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,o=this.ti(r),a=o<0?0:o;return ue.resolve(this.mutationQueue.length>a?this.mutationQueue[a]:null)}getHighestUnacknowledgedBatchId(){return ue.resolve(this.mutationQueue.length===0?ys:this.nr-1)}getAllMutationBatches(e){return ue.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new Wn(t,0),o=new Wn(t,Number.POSITIVE_INFINITY),a=[];return this.Xr.forEachInRange([r,o],c=>{const d=this.ei(c.Zr);a.push(d)}),ue.resolve(a)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new qt(ut);return t.forEach(o=>{const a=new Wn(o,0),c=new Wn(o,Number.POSITIVE_INFINITY);this.Xr.forEachInRange([a,c],d=>{r=r.add(d.Zr)})}),ue.resolve(this.ni(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,o=r.length+1;let a=r;Ve.isDocumentKey(a)||(a=a.child(""));const c=new Wn(new Ve(a),0);let d=new qt(ut);return this.Xr.forEachWhile(h=>{const m=h.key.path;return!!r.isPrefixOf(m)&&(m.length===o&&(d=d.add(h.Zr)),!0)},c),ue.resolve(this.ni(d))}ni(e){const t=[];return e.forEach(r=>{const o=this.ei(r);o!==null&&t.push(o)}),t}removeMutationBatch(e,t){nt(this.ri(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Xr;return ue.forEach(t.mutations,o=>{const a=new Wn(o.key,t.batchId);return r=r.delete(a),this.referenceDelegate.markPotentiallyOrphaned(e,o.key)}).next(()=>{this.Xr=r})}sr(e){}containsKey(e,t){const r=new Wn(t,0),o=this.Xr.firstAfterOrEqual(r);return ue.resolve(t.isEqual(o&&o.key))}performConsistencyCheck(e){return this.mutationQueue.length,ue.resolve()}ri(e,t){return this.ti(e)}ti(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}ei(e){const t=this.ti(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B5{constructor(e){this.ii=e,this.docs=function(){return new tn(Ve.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,o=this.docs.get(r),a=o?o.size:0,c=this.ii(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:c}),this.size+=c-a,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return ue.resolve(r?r.document.mutableCopy():on.newInvalidDocument(t))}getEntries(e,t){let r=Rr();return t.forEach(o=>{const a=this.docs.get(o);r=r.insert(o,a?a.document.mutableCopy():on.newInvalidDocument(o))}),ue.resolve(r)}getDocumentsMatchingQuery(e,t,r,o){let a=Rr();const c=t.path,d=new Ve(c.child("__id-9223372036854775808__")),h=this.docs.getIteratorFrom(d);for(;h.hasNext();){const{key:m,value:{document:g}}=h.getNext();if(!c.isPrefixOf(m.path))break;m.path.length>c.length+1||xx(lT(g),r)<=0||(o.has(g.key)||vd(t,g))&&(a=a.insert(g.key,g.mutableCopy()))}return ue.resolve(a)}getAllFromCollectionGroup(e,t,r,o){Ke(9500)}si(e,t){return ue.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new F5(this)}getSize(e){return ue.resolve(this.size)}}class F5 extends P_{constructor(e){super(),this.Br=e}applyChanges(e){const t=[];return this.changes.forEach((r,o)=>{o.isValidDocument()?t.push(this.Br.addEntry(e,o)):this.Br.removeEntry(r)}),ue.waitFor(t)}getFromCache(e,t){return this.Br.getEntry(e,t)}getAllFromCache(e,t){return this.Br.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z5{constructor(e){this.persistence=e,this.oi=new Co(t=>ja(t),xd),this.lastRemoteSnapshotVersion=at.min(),this.highestTargetId=0,this._i=0,this.ai=new Lx,this.targetCount=0,this.ui=Aa.cr()}forEachTarget(e,t){return this.oi.forEach((r,o)=>t(o)),ue.resolve()}getLastRemoteSnapshotVersion(e){return ue.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return ue.resolve(this._i)}allocateTargetId(e){return this.highestTargetId=this.ui.next(),ue.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this._i&&(this._i=t),ue.resolve()}Tr(e){this.oi.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ui=new Aa(t),this.highestTargetId=t),e.sequenceNumber>this._i&&(this._i=e.sequenceNumber)}addTargetData(e,t){return this.Tr(t),this.targetCount+=1,ue.resolve()}updateTargetData(e,t){return this.Tr(t),ue.resolve()}removeTargetData(e,t){return this.oi.delete(t.target),this.ai.Hr(t.targetId),this.targetCount-=1,ue.resolve()}removeTargets(e,t,r){let o=0;const a=[];return this.oi.forEach((c,d)=>{d.sequenceNumber<=t&&r.get(d.targetId)===null&&(this.oi.delete(c),a.push(this.removeMatchingKeysForTargetId(e,d.targetId)),o++)}),ue.waitFor(a).next(()=>o)}getTargetCount(e){return ue.resolve(this.targetCount)}getTargetData(e,t){const r=this.oi.get(t)||null;return ue.resolve(r)}addMatchingKeys(e,t,r){return this.ai.Gr(t,r),ue.resolve()}removeMatchingKeys(e,t,r){this.ai.jr(t,r);const o=this.persistence.referenceDelegate,a=[];return o&&t.forEach(c=>{a.push(o.markPotentiallyOrphaned(e,c))}),ue.waitFor(a)}removeMatchingKeysForTargetId(e,t){return this.ai.Hr(t),ue.resolve()}getMatchingKeysForTargetId(e,t){const r=this.ai.Yr(t);return ue.resolve(r)}containsKey(e,t){return ue.resolve(this.ai.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ox{constructor(e,t){this.ci={},this.overlays={},this.li=new Ir(0),this.hi=!1,this.hi=!0,this.Pi=new A5,this.referenceDelegate=e(this),this.Ti=new z5(this),this.indexManager=new v5,this.remoteDocumentCache=function(o){return new B5(o)}(r=>this.referenceDelegate.Ii(r)),this.serializer=new w_(t),this.Ei=new R5(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.hi=!1,Promise.resolve()}get started(){return this.hi}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new E5,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.ci[e.toKey()];return r||(r=new P5(t,this.referenceDelegate),this.ci[e.toKey()]=r),r}getGlobalsCache(){return this.Pi}getTargetCache(){return this.Ti}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ei}runTransaction(e,t,r){Ee("MemoryPersistence","Starting transaction:",e);const o=new D5(this.li.next());return this.referenceDelegate.di(),r(o).next(a=>this.referenceDelegate.Ai(o).next(()=>a)).toPromise().then(a=>(o.raiseOnCommittedEvent(),a))}Ri(e,t){return ue.or(Object.values(this.ci).map(r=>()=>r.containsKey(e,t)))}}class D5 extends uT{constructor(e){super(),this.currentSequenceNumber=e}}class Ff{constructor(e){this.persistence=e,this.Vi=new Lx,this.mi=null}static fi(e){return new Ff(e)}get gi(){if(this.mi)return this.mi;throw Ke(60996)}addReference(e,t,r){return this.Vi.addReference(r,t),this.gi.delete(r.toString()),ue.resolve()}removeReference(e,t,r){return this.Vi.removeReference(r,t),this.gi.add(r.toString()),ue.resolve()}markPotentiallyOrphaned(e,t){return this.gi.add(t.toString()),ue.resolve()}removeTarget(e,t){this.Vi.Hr(t.targetId).forEach(o=>this.gi.add(o.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(o=>{o.forEach(a=>this.gi.add(a.toString()))}).next(()=>r.removeTargetData(e,t))}di(){this.mi=new Set}Ai(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ue.forEach(this.gi,r=>{const o=Ve.fromPath(r);return this.pi(e,o).next(a=>{a||t.removeEntry(o,at.min())})}).next(()=>(this.mi=null,t.apply(e)))}updateLimboDocument(e,t){return this.pi(e,t).next(r=>{r?this.gi.delete(t.toString()):this.gi.add(t.toString())})}Ii(e){return 0}pi(e,t){return ue.or([()=>ue.resolve(this.Vi.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ri(e,t)])}}class Qp{constructor(e,t){this.persistence=e,this.yi=new Co(r=>sr(r.path),(r,o)=>r.isEqual(o)),this.garbageCollector=A_(this,t)}static fi(e,t){return new Qp(e,t)}di(){}Ai(e){return ue.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}pr(e){const t=this.br(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>t.next(o=>r+o))}br(e){let t=0;return this.yr(e,r=>{t++}).next(()=>t)}yr(e,t){return ue.forEach(this.yi,(r,o)=>this.Dr(e,r,o).next(a=>a?ue.resolve():t(o)))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0;const o=this.persistence.getRemoteDocumentCache(),a=o.newChangeBuffer();return o.si(e,c=>this.Dr(e,c,t).next(d=>{d||(r++,a.removeEntry(c,at.min()))})).next(()=>a.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,t){return this.yi.set(t,e.currentSequenceNumber),ue.resolve()}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.yi.set(r,e.currentSequenceNumber),ue.resolve()}removeReference(e,t,r){return this.yi.set(r,e.currentSequenceNumber),ue.resolve()}updateLimboDocument(e,t){return this.yi.set(t,e.currentSequenceNumber),ue.resolve()}Ii(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Sp(e.data.value)),t}Dr(e,t,r){return ue.or([()=>this.persistence.Ri(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const o=this.yi.get(t);return ue.resolve(o!==void 0&&o>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N5{constructor(e){this.serializer=e}q(e,t,r,o){const a=new Sf("createOrUpgrade",t);r<1&&o>=1&&(function(h){h.createObjectStore(yd)}(e),function(h){h.createObjectStore(ed,{keyPath:t6}),h.createObjectStore(mi,{keyPath:P1,autoIncrement:!0}).createIndex(fa,B1,{unique:!0}),h.createObjectStore(ec)}(e),Sw(e),function(h){h.createObjectStore(la)}(e));let c=ue.resolve();return r<3&&o>=3&&(r!==0&&(function(h){h.deleteObjectStore(nc),h.deleteObjectStore(tc),h.deleteObjectStore(va)}(e),Sw(e)),c=c.next(()=>function(h){const m=h.store(va),g={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:at.min().toTimestamp(),targetCount:0};return m.put(Wp,g)}(a))),r<4&&o>=4&&(r!==0&&(c=c.next(()=>function(h,m){return m.store(mi).J().next(x=>{h.deleteObjectStore(mi),h.createObjectStore(mi,{keyPath:P1,autoIncrement:!0}).createIndex(fa,B1,{unique:!0});const S=m.store(mi),j=x.map(T=>S.put(T));return ue.waitFor(j)})}(e,a))),c=c.next(()=>{(function(h){h.createObjectStore(rc,{keyPath:u6})})(e)})),r<5&&o>=5&&(c=c.next(()=>this.wi(a))),r<6&&o>=6&&(c=c.next(()=>(function(h){h.createObjectStore(td)}(e),this.bi(a)))),r<7&&o>=7&&(c=c.next(()=>this.Si(a))),r<8&&o>=8&&(c=c.next(()=>this.Di(e,a))),r<9&&o>=9&&(c=c.next(()=>{(function(h){h.objectStoreNames.contains("remoteDocumentChanges")&&h.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&o>=10&&(c=c.next(()=>this.Ci(a))),r<11&&o>=11&&(c=c.next(()=>{(function(h){h.createObjectStore(kf,{keyPath:d6})})(e),function(h){h.createObjectStore(Tf,{keyPath:h6})}(e)})),r<12&&o>=12&&(c=c.next(()=>{(function(h){const m=h.createObjectStore(_f,{keyPath:b6});m.createIndex(Iy,v6,{unique:!1}),m.createIndex(xT,w6,{unique:!1})})(e)})),r<13&&o>=13&&(c=c.next(()=>function(h){const m=h.createObjectStore(Op,{keyPath:r6});m.createIndex(vp,i6),m.createIndex(fT,o6)}(e)).next(()=>this.Fi(e,a)).next(()=>e.deleteObjectStore(la))),r<14&&o>=14&&(c=c.next(()=>this.Mi(e,a))),r<15&&o>=15&&(c=c.next(()=>function(h){h.createObjectStore(wx,{keyPath:p6,autoIncrement:!0}).createIndex(jy,f6,{unique:!1}),h.createObjectStore(Ou,{keyPath:m6}).createIndex(gT,g6,{unique:!1}),h.createObjectStore(Wu,{keyPath:y6}).createIndex(yT,x6,{unique:!1})}(e))),r<16&&o>=16&&(c=c.next(()=>{t.objectStore(Ou).clear()}).next(()=>{t.objectStore(Wu).clear()})),r<17&&o>=17&&(c=c.next(()=>{(function(h){h.createObjectStore(Sx,{keyPath:S6})})(e)})),r<18&&o>=18&&qk()&&(c=c.next(()=>{t.objectStore(Ou).clear()}).next(()=>{t.objectStore(Wu).clear()})),c}bi(e){let t=0;return e.store(la).te((r,o)=>{t+=Kp(o)}).next(()=>{const r={byteSize:t};return e.store(td).put(_y,r)})}wi(e){const t=e.store(ed),r=e.store(mi);return t.J().next(o=>ue.forEach(o,a=>{const c=IDBKeyRange.bound([a.userId,ys],[a.userId,a.lastAcknowledgedBatchId]);return r.J(fa,c).next(d=>ue.forEach(d,h=>{nt(h.userId===a.userId,18650,"Cannot process batch from unexpected user",{batchId:h.batchId});const m=da(this.serializer,h);return j_(e,a.userId,m).next(()=>{})}))}))}Si(e){const t=e.store(nc),r=e.store(la);return e.store(va).get(Wp).next(o=>{const a=[];return r.te((c,d)=>{const h=new It(c),m=function(x){return[0,sr(x)]}(h);a.push(t.get(m).next(g=>g?ue.resolve():(x=>t.put({targetId:0,path:sr(x),sequenceNumber:o.highestListenSequenceNumber}))(h)))}).next(()=>ue.waitFor(a))})}Di(e,t){e.createObjectStore(nd,{keyPath:c6});const r=t.store(nd),o=new Mx,a=c=>{if(o.add(c)){const d=c.lastSegment(),h=c.popLast();return r.put({collectionId:d,parent:sr(h)})}};return t.store(la).te({ee:!0},(c,d)=>{const h=new It(c);return a(h.popLast())}).next(()=>t.store(ec).te({ee:!0},([c,d,h],m)=>{const g=Ni(d);return a(g.popLast())}))}Ci(e){const t=e.store(tc);return t.te((r,o)=>{const a=Du(o),c=S_(this.serializer,a);return t.put(c)})}Fi(e,t){const r=t.store(la),o=[];return r.te((a,c)=>{const d=t.store(Op),h=function(x){return x.document?new Ve(It.fromString(x.document.name).popFirst(5)):x.noDocument?Ve.fromSegments(x.noDocument.path):x.unknownDocument?Ve.fromSegments(x.unknownDocument.path):Ke(36783)}(c).path.toArray(),m={prefixPath:h.slice(0,h.length-2),collectionGroup:h[h.length-2],documentId:h[h.length-1],readTime:c.readTime||[0,0],unknownDocument:c.unknownDocument,noDocument:c.noDocument,document:c.document,hasCommittedMutations:!!c.hasCommittedMutations};o.push(d.put(m))}).next(()=>ue.waitFor(o))}Mi(e,t){const r=t.store(mi),o=B_(this.serializer),a=new Ox(Ff.fi,this.serializer.wt);return r.J().next(c=>{const d=new Map;return c.forEach(h=>{var m;let g=(m=d.get(h.userId))!==null&&m!==void 0?m:bt();da(this.serializer,h).keys().forEach(x=>g=g.add(x)),d.set(h.userId,g)}),ue.forEach(d,(h,m)=>{const g=new Vn(m),x=Pf.bt(this.serializer,g),S=a.getIndexManager(g),j=Bf.bt(g,this.serializer,S,a.referenceDelegate);return new F_(o,j,x,S).recalculateAndSaveOverlaysForDocumentKeys(new Cy(t,Ir.le),h).next()})})}}function Sw(n){n.createObjectStore(nc,{keyPath:a6}).createIndex(vx,l6,{unique:!0}),n.createObjectStore(tc,{keyPath:"targetId"}).createIndex(mT,s6,{unique:!0}),n.createObjectStore(va)}const os="IndexedDbPersistence",Ug=18e5,qg=5e3,Hg="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",z_="main";class Wx{constructor(e,t,r,o,a,c,d,h,m,g,x=18){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.xi=a,this.window=c,this.document=d,this.Oi=m,this.Ni=g,this.Bi=x,this.li=null,this.hi=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Li=null,this.inForeground=!1,this.ki=null,this.qi=null,this.Qi=Number.NEGATIVE_INFINITY,this.$i=S=>Promise.resolve(),!Wx.C())throw new Re(ye.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new _5(this,o),this.Ui=t+z_,this.serializer=new w_(h),this.Ki=new Wi(this.Ui,this.Bi,new N5(this.serializer)),this.Pi=new f5,this.Ti=new S5(this.referenceDelegate,this.serializer),this.remoteDocumentCache=B_(this.serializer),this.Ei=new p5,this.window&&this.window.localStorage?this.Wi=this.window.localStorage:(this.Wi=null,g===!1&&Sn(os,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Gi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new Re(ye.FAILED_PRECONDITION,Hg);return this.zi(),this.ji(),this.Hi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Ti.getHighestSequenceNumber(e))}).then(e=>{this.li=new Ir(e,this.Oi)}).then(()=>{this.hi=!0}).catch(e=>(this.Ki&&this.Ki.close(),Promise.reject(e)))}Ji(e){return this.$i=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ki.U(async t=>{t.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.xi.enqueueAndForget(async()=>{this.started&&await this.Gi()}))}Gi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>cp(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.Yi(e).next(t=>{t||(this.isPrimary=!1,this.xi.enqueueRetryable(()=>this.$i(!1)))})}).next(()=>this.Zi(e)).next(t=>this.isPrimary&&!t?this.Xi(e).next(()=>!1):!!t&&this.es(e).next(()=>!0))).catch(e=>{if(Es(e))return Ee(os,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return Ee(os,"Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.xi.enqueueRetryable(()=>this.$i(e)),this.isPrimary=e})}Yi(e){return ju(e).get(Il).next(t=>ue.resolve(this.ts(t)))}ns(e){return cp(e).delete(this.clientId)}async rs(){if(this.isPrimary&&!this.ss(this.Qi,Ug)){this.Qi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",t=>{const r=zn(t,rc);return r.J().next(o=>{const a=this._s(o,Ug),c=o.filter(d=>a.indexOf(d)===-1);return ue.forEach(c,d=>r.delete(d.clientId)).next(()=>c)})}).catch(()=>[]);if(this.Wi)for(const t of e)this.Wi.removeItem(this.us(t.clientId))}}Hi(){this.qi=this.xi.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.Gi().then(()=>this.rs()).then(()=>this.Hi()))}ts(e){return!!e&&e.ownerId===this.clientId}Zi(e){return this.Ni?ue.resolve(!0):ju(e).get(Il).next(t=>{if(t!==null&&this.ss(t.leaseTimestampMs,qg)&&!this.cs(t.ownerId)){if(this.ts(t)&&this.networkEnabled)return!0;if(!this.ts(t)){if(!t.allowTabSynchronization)throw new Re(ye.FAILED_PRECONDITION,Hg);return!1}}return!(!this.networkEnabled||!this.inForeground)||cp(e).J().next(r=>this._s(r,qg).find(o=>{if(this.clientId!==o.clientId){const a=!this.networkEnabled&&o.networkEnabled,c=!this.inForeground&&o.inForeground,d=this.networkEnabled===o.networkEnabled;if(a||c&&d)return!0}return!1})===void 0)}).next(t=>(this.isPrimary!==t&&Ee(os,`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}async shutdown(){this.hi=!1,this.ls(),this.qi&&(this.qi.cancel(),this.qi=null),this.hs(),this.Ps(),await this.Ki.runTransaction("shutdown","readwrite",[yd,rc],e=>{const t=new Cy(e,Ir.le);return this.Xi(t).next(()=>this.ns(t))}),this.Ki.close(),this.Ts()}_s(e,t){return e.filter(r=>this.ss(r.updateTimeMs,t)&&!this.cs(r.clientId))}Is(){return this.runTransaction("getActiveClients","readonly",e=>cp(e).J().next(t=>this._s(t,Ug).map(r=>r.clientId)))}get started(){return this.hi}getGlobalsCache(){return this.Pi}getMutationQueue(e,t){return Bf.bt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Ti}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new w5(e,this.serializer.wt.databaseId)}getDocumentOverlayCache(e){return Pf.bt(this.serializer,e)}getBundleCache(){return this.Ei}runTransaction(e,t,r){Ee(os,"Starting transaction:",e);const o=t==="readonly"?"readonly":"readwrite",a=function(h){return h===18?_6:h===17?ST:h===16?T6:h===15?kx:h===14?wT:h===13?vT:h===12?k6:h===11?bT:void Ke(60245)}(this.Bi);let c;return this.Ki.runTransaction(e,o,a,d=>(c=new Cy(d,this.li?this.li.next():Ir.le),t==="readwrite-primary"?this.Yi(c).next(h=>!!h||this.Zi(c)).next(h=>{if(!h)throw Sn(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.xi.enqueueRetryable(()=>this.$i(!1)),new Re(ye.FAILED_PRECONDITION,cT);return r(c)}).next(h=>this.es(c).next(()=>h)):this.Es(c).next(()=>r(c)))).then(d=>(c.raiseOnCommittedEvent(),d))}Es(e){return ju(e).get(Il).next(t=>{if(t!==null&&this.ss(t.leaseTimestampMs,qg)&&!this.cs(t.ownerId)&&!this.ts(t)&&!(this.Ni||this.allowTabSynchronization&&t.allowTabSynchronization))throw new Re(ye.FAILED_PRECONDITION,Hg)})}es(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return ju(e).put(Il,t)}static C(){return Wi.C()}Xi(e){const t=ju(e);return t.get(Il).next(r=>this.ts(r)?(Ee(os,"Releasing primary lease."),t.delete(Il)):ue.resolve())}ss(e,t){const r=Date.now();return!(e<r-t)&&(!(e>r)||(Sn(`Detected an update time that is in the future: ${e} > ${r}`),!1))}zi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.ki=()=>{this.xi.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.Gi()))},this.document.addEventListener("visibilitychange",this.ki),this.inForeground=this.document.visibilityState==="visible")}hs(){this.ki&&(this.document.removeEventListener("visibilitychange",this.ki),this.ki=null)}ji(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.Li=()=>{this.ls();const t=/(?:Version|Mobile)\/1[456]/;Uk()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.xi.enterRestrictedMode(!0),this.xi.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Li))}Ps(){this.Li&&(this.window.removeEventListener("pagehide",this.Li),this.Li=null)}cs(e){var t;try{const r=((t=this.Wi)===null||t===void 0?void 0:t.getItem(this.us(e)))!==null;return Ee(os,`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return Sn(os,"Failed to get zombied client id.",r),!1}}ls(){if(this.Wi)try{this.Wi.setItem(this.us(this.clientId),String(Date.now()))}catch(e){Sn("Failed to set zombie client id.",e)}}Ts(){if(this.Wi)try{this.Wi.removeItem(this.us(this.clientId))}catch{}}us(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function ju(n){return zn(n,yd)}function cp(n){return zn(n,rc)}function Vx(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ux{constructor(e,t,r,o){this.targetId=e,this.fromCache=t,this.ds=r,this.As=o}static Rs(e,t){let r=bt(),o=bt();for(const a of t.docChanges)switch(a.type){case 0:r=r.add(a.doc.key);break;case 1:o=o.add(a.doc.key)}return new Ux(e,t.fromCache,r,o)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M5{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D_{constructor(){this.Vs=!1,this.fs=!1,this.gs=100,this.ps=function(){return Uk()?8:dT(Fn())>0?6:4}()}initialize(e,t){this.ys=e,this.indexManager=t,this.Vs=!0}getDocumentsMatchingQuery(e,t,r,o){const a={result:null};return this.ws(e,t).next(c=>{a.result=c}).next(()=>{if(!a.result)return this.bs(e,t,o,r).next(c=>{a.result=c})}).next(()=>{if(a.result)return;const c=new M5;return this.Ss(e,t,c).next(d=>{if(a.result=d,this.fs)return this.Ds(e,t,c,d.size)})}).next(()=>a.result)}Ds(e,t,r,o){return r.documentReadCount<this.gs?(Ll()<=jt.DEBUG&&Ee("QueryEngine","SDK will not create cache indexes for query:",Ol(t),"since it only creates cache indexes for collection contains","more than or equal to",this.gs,"documents"),ue.resolve()):(Ll()<=jt.DEBUG&&Ee("QueryEngine","Query:",Ol(t),"scans",r.documentReadCount,"local documents and returns",o,"documents as results."),r.documentReadCount>this.ps*o?(Ll()<=jt.DEBUG&&Ee("QueryEngine","The SDK decides to create cache indexes for query:",Ol(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,ar(t))):ue.resolve())}ws(e,t){if($1(t))return ue.resolve(null);let r=ar(t);return this.indexManager.getIndexType(e,r).next(o=>o===0?null:(t.limit!==null&&o===1&&(t=qp(t,null,"F"),r=ar(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(a=>{const c=bt(...a);return this.ys.getDocuments(e,c).next(d=>this.indexManager.getMinOffset(e,r).next(h=>{const m=this.vs(t,d);return this.Cs(t,m,c,h.readTime)?this.ws(e,qp(t,null,"F")):this.Fs(e,m,t,h)}))})))}bs(e,t,r,o){return $1(t)||o.isEqual(at.min())?ue.resolve(null):this.ys.getDocuments(e,r).next(a=>{const c=this.vs(t,a);return this.Cs(t,c,r,o)?ue.resolve(null):(Ll()<=jt.DEBUG&&Ee("QueryEngine","Re-using previous result from %s to execute query: %s",o.toString(),Ol(t)),this.Fs(e,c,t,aT(o,Xl)).next(d=>d))})}vs(e,t){let r=new qt($T(e));return t.forEach((o,a)=>{vd(e,a)&&(r=r.add(a))}),r}Cs(e,t,r,o){if(e.limit===null)return!1;if(r.size!==t.size)return!0;const a=e.limitType==="F"?t.last():t.first();return!!a&&(a.hasPendingWrites||a.version.compareTo(o)>0)}Ss(e,t,r){return Ll()<=jt.DEBUG&&Ee("QueryEngine","Using full collection scan to execute query:",Ol(t)),this.ys.getDocumentsMatchingQuery(e,t,Hr.min(),r)}Fs(e,t,r,o){return this.ys.getDocumentsMatchingQuery(e,r,o).next(a=>(t.forEach(c=>{a=a.insert(c.key,c)}),a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qx="LocalStore",L5=3e8;class O5{constructor(e,t,r,o){this.persistence=e,this.Ms=t,this.serializer=o,this.xs=new tn(ut),this.Os=new Co(a=>ja(a),xd),this.Ns=new Map,this.Bs=e.getRemoteDocumentCache(),this.Ti=e.getTargetCache(),this.Ei=e.getBundleCache(),this.Ls(r)}Ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new F_(this.Bs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Bs.setIndexManager(this.indexManager),this.Ms.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.xs))}}function N_(n,e,t,r){return new O5(n,e,t,r)}async function M_(n,e){const t=We(n);return await t.persistence.runTransaction("Handle user change","readonly",r=>{let o;return t.mutationQueue.getAllMutationBatches(r).next(a=>(o=a,t.Ls(e),t.mutationQueue.getAllMutationBatches(r))).next(a=>{const c=[],d=[];let h=bt();for(const m of o){c.push(m.batchId);for(const g of m.mutations)h=h.add(g.key)}for(const m of a){d.push(m.batchId);for(const g of m.mutations)h=h.add(g.key)}return t.localDocuments.getDocuments(r,h).next(m=>({ks:m,removedBatchIds:c,addedBatchIds:d}))})})}function W5(n,e){const t=We(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const o=e.batch.keys(),a=t.Bs.newChangeBuffer({trackRemovals:!0});return function(d,h,m,g){const x=m.batch,S=x.keys();let j=ue.resolve();return S.forEach(T=>{j=j.next(()=>g.getEntry(h,T)).next(R=>{const I=m.docVersions.get(T);nt(I!==null,48541),R.version.compareTo(I)<0&&(x.applyToRemoteDocument(R,m),R.isValidDocument()&&(R.setReadTime(m.commitVersion),g.addEntry(R)))})}),j.next(()=>d.mutationQueue.removeMutationBatch(h,x))}(t,r,e,a).next(()=>a.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,o,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(d){let h=bt();for(let m=0;m<d.mutationResults.length;++m)d.mutationResults[m].transformResults.length>0&&(h=h.add(d.batch.mutations[m].key));return h}(e))).next(()=>t.localDocuments.getDocuments(r,o))})}function L_(n){const e=We(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Ti.getLastRemoteSnapshotVersion(t))}function V5(n,e){const t=We(n),r=e.snapshotVersion;let o=t.xs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",a=>{const c=t.Bs.newChangeBuffer({trackRemovals:!0});o=t.xs;const d=[];e.targetChanges.forEach((g,x)=>{const S=o.get(x);if(!S)return;d.push(t.Ti.removeMatchingKeys(a,g.removedDocuments,x).next(()=>t.Ti.addMatchingKeys(a,g.addedDocuments,x)));let j=S.withSequenceNumber(a.currentSequenceNumber);e.targetMismatches.get(x)!==null?j=j.withResumeToken(mn.EMPTY_BYTE_STRING,at.min()).withLastLimboFreeSnapshotVersion(at.min()):g.resumeToken.approximateByteSize()>0&&(j=j.withResumeToken(g.resumeToken,r)),o=o.insert(x,j),function(R,I,F){return R.resumeToken.approximateByteSize()===0||I.snapshotVersion.toMicroseconds()-R.snapshotVersion.toMicroseconds()>=L5?!0:F.addedDocuments.size+F.modifiedDocuments.size+F.removedDocuments.size>0}(S,j,g)&&d.push(t.Ti.updateTargetData(a,j))});let h=Rr(),m=bt();if(e.documentUpdates.forEach(g=>{e.resolvedLimboDocuments.has(g)&&d.push(t.persistence.referenceDelegate.updateLimboDocument(a,g))}),d.push(O_(a,c,e.documentUpdates).next(g=>{h=g.qs,m=g.Qs})),!r.isEqual(at.min())){const g=t.Ti.getLastRemoteSnapshotVersion(a).next(x=>t.Ti.setTargetsMetadata(a,a.currentSequenceNumber,r));d.push(g)}return ue.waitFor(d).next(()=>c.apply(a)).next(()=>t.localDocuments.getLocalViewOfDocuments(a,h,m)).next(()=>h)}).then(a=>(t.xs=o,a))}function O_(n,e,t){let r=bt(),o=bt();return t.forEach(a=>r=r.add(a)),e.getEntries(n,r).next(a=>{let c=Rr();return t.forEach((d,h)=>{const m=a.get(d);h.isFoundDocument()!==m.isFoundDocument()&&(o=o.add(d)),h.isNoDocument()&&h.version.isEqual(at.min())?(e.removeEntry(d,h.readTime),c=c.insert(d,h)):!m.isValidDocument()||h.version.compareTo(m.version)>0||h.version.compareTo(m.version)===0&&m.hasPendingWrites?(e.addEntry(h),c=c.insert(d,h)):Ee(qx,"Ignoring outdated watch update for ",d,". Current version:",m.version," Watch version:",h.version)}),{qs:c,Qs:o}})}function U5(n,e){const t=We(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=ys),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function uc(n,e){const t=We(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let o;return t.Ti.getTargetData(r,e).next(a=>a?(o=a,ue.resolve(o)):t.Ti.allocateTargetId(r).next(c=>(o=new go(e,c,"TargetPurposeListen",r.currentSequenceNumber),t.Ti.addTargetData(r,o).next(()=>o))))}).then(r=>{const o=t.xs.get(r.targetId);return(o===null||r.snapshotVersion.compareTo(o.snapshotVersion)>0)&&(t.xs=t.xs.insert(r.targetId,r),t.Os.set(e,r.targetId)),r})}async function dc(n,e,t){const r=We(n),o=r.xs.get(e),a=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",a,c=>r.persistence.referenceDelegate.removeTarget(c,o))}catch(c){if(!Es(c))throw c;Ee(qx,`Failed to update sequence numbers for target ${e}: ${c}`)}r.xs=r.xs.remove(e),r.Os.delete(o.target)}function Yp(n,e,t){const r=We(n);let o=at.min(),a=bt();return r.persistence.runTransaction("Execute query","readwrite",c=>function(h,m,g){const x=We(h),S=x.Os.get(g);return S!==void 0?ue.resolve(x.xs.get(S)):x.Ti.getTargetData(m,g)}(r,c,ar(e)).next(d=>{if(d)return o=d.lastLimboFreeSnapshotVersion,r.Ti.getMatchingKeysForTargetId(c,d.targetId).next(h=>{a=h})}).next(()=>r.Ms.getDocumentsMatchingQuery(c,e,t?o:at.min(),t?a:bt())).next(d=>(U_(r,HT(e),d),{documents:d,$s:a})))}function W_(n,e){const t=We(n),r=We(t.Ti),o=t.xs.get(e);return o?Promise.resolve(o.target):t.persistence.runTransaction("Get target data","readonly",a=>r.Rt(a,e).next(c=>c?c.target:null))}function V_(n,e){const t=We(n),r=t.Ns.get(e)||at.min();return t.persistence.runTransaction("Get new document changes","readonly",o=>t.Bs.getAllFromCollectionGroup(o,e,aT(r,Xl),Number.MAX_SAFE_INTEGER)).then(o=>(U_(t,e,o),o))}function U_(n,e,t){let r=n.Ns.get(e)||at.min();t.forEach((o,a)=>{a.readTime.compareTo(r)>0&&(r=a.readTime)}),n.Ns.set(e,r)}async function q5(n,e,t,r){const o=We(n);let a=bt(),c=Rr();for(const m of t){const g=e.Us(m.metadata.name);m.document&&(a=a.add(g));const x=e.Ks(m);x.setReadTime(e.Ws(m.metadata.readTime)),c=c.insert(g,x)}const d=o.Bs.newChangeBuffer({trackRemovals:!0}),h=await uc(o,function(g){return ar(Tc(It.fromString(`__bundle__/docs/${g}`)))}(r));return o.persistence.runTransaction("Apply bundle documents","readwrite",m=>O_(m,d,c).next(g=>(d.apply(m),g)).next(g=>o.Ti.removeMatchingKeysForTargetId(m,h.targetId).next(()=>o.Ti.addMatchingKeys(m,a,h.targetId)).next(()=>o.localDocuments.getLocalViewOfDocuments(m,g.qs,g.Qs)).next(()=>g.qs)))}async function H5(n,e,t=bt()){const r=await uc(n,ar(Dx(e.bundledQuery))),o=We(n);return o.persistence.runTransaction("Save named query","readwrite",a=>{const c=kn(e.readTime);if(r.snapshotVersion.compareTo(c)>=0)return o.Ei.saveNamedQuery(a,e);const d=r.withResumeToken(mn.EMPTY_BYTE_STRING,c);return o.xs=o.xs.insert(d.targetId,d),o.Ti.updateTargetData(a,d).next(()=>o.Ti.removeMatchingKeysForTargetId(a,r.targetId)).next(()=>o.Ti.addMatchingKeys(a,t,r.targetId)).next(()=>o.Ei.saveNamedQuery(a,e))})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q_="firestore_clients";function kw(n,e){return`${q_}_${n}_${e}`}const H_="firestore_mutations";function Tw(n,e,t){let r=`${H_}_${n}_${t}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}const $_="firestore_targets";function $g(n,e){return`${$_}_${n}_${e}`}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zi="SharedClientState";class Xp{constructor(e,t,r,o){this.user=e,this.batchId=t,this.state=r,this.error=o}static Gs(e,t,r){const o=JSON.parse(r);let a,c=typeof o=="object"&&["pending","acknowledged","rejected"].indexOf(o.state)!==-1&&(o.error===void 0||typeof o.error=="object");return c&&o.error&&(c=typeof o.error.message=="string"&&typeof o.error.code=="string",c&&(a=new Re(o.error.code,o.error.message))),c?new Xp(e,t,o.state,a):(Sn(zi,`Failed to parse mutation state for ID '${t}': ${r}`),null)}zs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Hu{constructor(e,t,r){this.targetId=e,this.state=t,this.error=r}static Gs(e,t){const r=JSON.parse(t);let o,a=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return a&&r.error&&(a=typeof r.error.message=="string"&&typeof r.error.code=="string",a&&(o=new Re(r.error.code,r.error.message))),a?new Hu(e,r.state,o):(Sn(zi,`Failed to parse target state for ID '${e}': ${t}`),null)}zs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Jp{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Gs(e,t){const r=JSON.parse(t);let o=typeof r=="object"&&r.activeTargetIds instanceof Array,a=Cx();for(let c=0;o&&c<r.activeTargetIds.length;++c)o=hT(r.activeTargetIds[c]),a=a.add(r.activeTargetIds[c]);return o?new Jp(e,a):(Sn(zi,`Failed to parse client data for instance '${e}': ${t}`),null)}}class Hx{constructor(e,t){this.clientId=e,this.onlineState=t}static Gs(e){const t=JSON.parse(e);return typeof t=="object"&&["Unknown","Online","Offline"].indexOf(t.onlineState)!==-1&&typeof t.clientId=="string"?new Hx(t.clientId,t.onlineState):(Sn(zi,`Failed to parse online state: ${e}`),null)}}class Vy{constructor(){this.activeTargetIds=Cx()}js(e){this.activeTargetIds=this.activeTargetIds.add(e)}Hs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}zs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Gg{constructor(e,t,r,o,a){this.window=e,this.xi=t,this.persistenceKey=r,this.Js=o,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.Ys=this.Zs.bind(this),this.Xs=new tn(ut),this.started=!1,this.eo=[];const c=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=a,this.no=kw(this.persistenceKey,this.Js),this.ro=function(h){return`firestore_sequence_number_${h}`}(this.persistenceKey),this.Xs=this.Xs.insert(this.Js,new Vy),this.io=new RegExp(`^${q_}_${c}_([^_]*)$`),this.so=new RegExp(`^${H_}_${c}_(\\d+)(?:_(.*))?$`),this.oo=new RegExp(`^${$_}_${c}_(\\d+)$`),this._o=function(h){return`firestore_online_state_${h}`}(this.persistenceKey),this.ao=function(h){return`firestore_bundle_loaded_v2_${h}`}(this.persistenceKey),this.window.addEventListener("storage",this.Ys)}static C(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.Is();for(const r of e){if(r===this.Js)continue;const o=this.getItem(kw(this.persistenceKey,r));if(o){const a=Jp.Gs(r,o);a&&(this.Xs=this.Xs.insert(a.clientId,a))}}this.uo();const t=this.storage.getItem(this._o);if(t){const r=this.co(t);r&&this.lo(r)}for(const r of this.eo)this.Zs(r);this.eo=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0}writeSequenceNumber(e){this.setItem(this.ro,JSON.stringify(e))}getAllActiveQueryTargets(){return this.ho(this.Xs)}isActiveQueryTarget(e){let t=!1;return this.Xs.forEach((r,o)=>{o.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this.Po(e,"pending")}updateMutationState(e,t,r){this.Po(e,t,r),this.To(e)}addLocalQueryTarget(e,t=!0){let r="not-current";if(this.isActiveQueryTarget(e)){const o=this.storage.getItem($g(this.persistenceKey,e));if(o){const a=Hu.Gs(e,o);a&&(r=a.state)}}return t&&this.Io.js(e),this.uo(),r}removeLocalQueryTarget(e){this.Io.Hs(e),this.uo()}isLocalQueryTarget(e){return this.Io.activeTargetIds.has(e)}clearQueryState(e){this.removeItem($g(this.persistenceKey,e))}updateQueryState(e,t,r){this.Eo(e,t,r)}handleUserChange(e,t,r){t.forEach(o=>{this.To(o)}),this.currentUser=e,r.forEach(o=>{this.addPendingMutation(o)})}setOnlineState(e){this.Ao(e)}notifyBundleLoaded(e){this.Ro(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.Ys),this.removeItem(this.no),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return Ee(zi,"READ",e,t),t}setItem(e,t){Ee(zi,"SET",e,t),this.storage.setItem(e,t)}removeItem(e){Ee(zi,"REMOVE",e),this.storage.removeItem(e)}Zs(e){const t=e;if(t.storageArea===this.storage){if(Ee(zi,"EVENT",t.key,t.newValue),t.key===this.no)return void Sn("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.xi.enqueueRetryable(async()=>{if(this.started){if(t.key!==null){if(this.io.test(t.key)){if(t.newValue==null){const r=this.Vo(t.key);return this.mo(r,null)}{const r=this.fo(t.key,t.newValue);if(r)return this.mo(r.clientId,r)}}else if(this.so.test(t.key)){if(t.newValue!==null){const r=this.po(t.key,t.newValue);if(r)return this.yo(r)}}else if(this.oo.test(t.key)){if(t.newValue!==null){const r=this.wo(t.key,t.newValue);if(r)return this.bo(r)}}else if(t.key===this._o){if(t.newValue!==null){const r=this.co(t.newValue);if(r)return this.lo(r)}}else if(t.key===this.ro){const r=function(a){let c=Ir.le;if(a!=null)try{const d=JSON.parse(a);nt(typeof d=="number",30636,{So:a}),c=d}catch(d){Sn(zi,"Failed to read sequence number from WebStorage",d)}return c}(t.newValue);r!==Ir.le&&this.sequenceNumberHandler(r)}else if(t.key===this.ao){const r=this.Do(t.newValue);await Promise.all(r.map(o=>this.syncEngine.vo(o)))}}}else this.eo.push(t)})}}get Io(){return this.Xs.get(this.Js)}uo(){this.setItem(this.no,this.Io.zs())}Po(e,t,r){const o=new Xp(this.currentUser,e,t,r),a=Tw(this.persistenceKey,this.currentUser,e);this.setItem(a,o.zs())}To(e){const t=Tw(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Ao(e){const t={clientId:this.Js,onlineState:e};this.storage.setItem(this._o,JSON.stringify(t))}Eo(e,t,r){const o=$g(this.persistenceKey,e),a=new Hu(e,t,r);this.setItem(o,a.zs())}Ro(e){const t=JSON.stringify(Array.from(e));this.setItem(this.ao,t)}Vo(e){const t=this.io.exec(e);return t?t[1]:null}fo(e,t){const r=this.Vo(e);return Jp.Gs(r,t)}po(e,t){const r=this.so.exec(e),o=Number(r[1]),a=r[2]!==void 0?r[2]:null;return Xp.Gs(new Vn(a),o,t)}wo(e,t){const r=this.oo.exec(e),o=Number(r[1]);return Hu.Gs(o,t)}co(e){return Hx.Gs(e)}Do(e){return JSON.parse(e)}async yo(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.Co(e.batchId,e.state,e.error);Ee(zi,`Ignoring mutation for non-active user ${e.user.uid}`)}bo(e){return this.syncEngine.Fo(e.targetId,e.state,e.error)}mo(e,t){const r=t?this.Xs.insert(e,t):this.Xs.remove(e),o=this.ho(this.Xs),a=this.ho(r),c=[],d=[];return a.forEach(h=>{o.has(h)||c.push(h)}),o.forEach(h=>{a.has(h)||d.push(h)}),this.syncEngine.Mo(c,d).then(()=>{this.Xs=r})}lo(e){this.Xs.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}ho(e){let t=Cx();return e.forEach((r,o)=>{t=t.unionWith(o.activeTargetIds)}),t}}class G_{constructor(){this.xo=new Vy,this.Oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.xo.js(e),this.Oo[e]||"not-current"}updateQueryState(e,t,r){this.Oo[e]=t}removeLocalQueryTarget(e){this.xo.Hs(e)}isLocalQueryTarget(e){return this.xo.activeTargetIds.has(e)}clearQueryState(e){delete this.Oo[e]}getAllActiveQueryTargets(){return this.xo.activeTargetIds}isActiveQueryTarget(e){return this.xo.activeTargetIds.has(e)}start(){return this.xo=new Vy,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $5{No(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _w="ConnectivityMonitor";class jw{constructor(){this.Bo=()=>this.Lo(),this.ko=()=>this.qo(),this.Qo=[],this.$o()}No(e){this.Qo.push(e)}shutdown(){window.removeEventListener("online",this.Bo),window.removeEventListener("offline",this.ko)}$o(){window.addEventListener("online",this.Bo),window.addEventListener("offline",this.ko)}Lo(){Ee(_w,"Network connectivity changed: AVAILABLE");for(const e of this.Qo)e(0)}qo(){Ee(_w,"Network connectivity changed: UNAVAILABLE");for(const e of this.Qo)e(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let up=null;function Uy(){return up===null?up=function(){return 268435456+Math.round(2147483648*Math.random())}():up++,"0x"+up.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kg="RestConnection",G5={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class K5{get Uo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),o=encodeURIComponent(this.databaseId.database);this.Ko=t+"://"+e.host,this.Wo=`projects/${r}/databases/${o}`,this.Go=this.databaseId.database===id?`project_id=${r}`:`project_id=${r}&database_id=${o}`}zo(e,t,r,o,a){const c=Uy(),d=this.jo(e,t.toUriEncodedString());Ee(Kg,`Sending RPC '${e}' ${c}:`,d,r);const h={"google-cloud-resource-prefix":this.Wo,"x-goog-request-params":this.Go};this.Ho(h,o,a);const{host:m}=new URL(d),g=jo(m);return this.Jo(e,d,h,r,g).then(x=>(Ee(Kg,`Received RPC '${e}' ${c}: `,x),x),x=>{throw qr(Kg,`RPC '${e}' ${c} failed with error: `,x,"url: ",d,"request:",r),x})}Yo(e,t,r,o,a,c){return this.zo(e,t,r,o,a)}Ho(e,t,r){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+kc}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((o,a)=>e[a]=o),r&&r.headers.forEach((o,a)=>e[a]=o)}jo(e,t){const r=G5[e];return`${this.Ko}/v1/${t}:${r}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q5{constructor(e){this.Zo=e.Zo,this.Xo=e.Xo}e_(e){this.t_=e}n_(e){this.r_=e}i_(e){this.s_=e}onMessage(e){this.o_=e}close(){this.Xo()}send(e){this.Zo(e)}__(){this.t_()}a_(){this.r_()}u_(e){this.s_(e)}c_(e){this.o_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rr="WebChannelConnection";class Y5 extends K5{constructor(e){super(e),this.l_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,r,o,a){const c=Uy();return new Promise((d,h)=>{const m=new Jk;m.setWithCredentials(!0),m.listenOnce(Zk.COMPLETE,()=>{try{switch(m.getLastErrorCode()){case xp.NO_ERROR:const x=m.getResponseJson();Ee(rr,`XHR for RPC '${e}' ${c} received:`,JSON.stringify(x)),d(x);break;case xp.TIMEOUT:Ee(rr,`RPC '${e}' ${c} timed out`),h(new Re(ye.DEADLINE_EXCEEDED,"Request time out"));break;case xp.HTTP_ERROR:const S=m.getStatus();if(Ee(rr,`RPC '${e}' ${c} failed with status:`,S,"response text:",m.getResponseText()),S>0){let j=m.getResponseJson();Array.isArray(j)&&(j=j[0]);const T=j==null?void 0:j.error;if(T&&T.status&&T.message){const R=function(F){const P=F.toLowerCase().replace(/_/g,"-");return Object.values(ye).indexOf(P)>=0?P:ye.UNKNOWN}(T.status);h(new Re(R,T.message))}else h(new Re(ye.UNKNOWN,"Server responded with status "+m.getStatus()))}else h(new Re(ye.UNAVAILABLE,"Connection failed."));break;default:Ke(9055,{h_:e,streamId:c,P_:m.getLastErrorCode(),T_:m.getLastError()})}}finally{Ee(rr,`RPC '${e}' ${c} completed.`)}});const g=JSON.stringify(o);Ee(rr,`RPC '${e}' ${c} sending request:`,o),m.send(t,"POST",g,r,15)})}I_(e,t,r){const o=Uy(),a=[this.Ko,"/","google.firestore.v1.Firestore","/",e,"/channel"],c=nT(),d=tT(),h={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},m=this.longPollingOptions.timeoutSeconds;m!==void 0&&(h.longPollingTimeout=Math.round(1e3*m)),this.useFetchStreams&&(h.useFetchStreams=!0),this.Ho(h.initMessageHeaders,t,r),h.encodeInitMessageHeaders=!0;const g=a.join("");Ee(rr,`Creating RPC '${e}' stream ${o}: ${g}`,h);const x=c.createWebChannel(g,h);this.E_(x);let S=!1,j=!1;const T=new Q5({Zo:I=>{j?Ee(rr,`Not sending because RPC '${e}' stream ${o} is closed:`,I):(S||(Ee(rr,`Opening RPC '${e}' stream ${o} transport.`),x.open(),S=!0),Ee(rr,`RPC '${e}' stream ${o} sending:`,I),x.send(I))},Xo:()=>x.close()}),R=(I,F,P)=>{I.listen(F,z=>{try{P(z)}catch(H){setTimeout(()=>{throw H},0)}})};return R(x,Bu.EventType.OPEN,()=>{j||(Ee(rr,`RPC '${e}' stream ${o} transport opened.`),T.__())}),R(x,Bu.EventType.CLOSE,()=>{j||(j=!0,Ee(rr,`RPC '${e}' stream ${o} transport closed`),T.u_(),this.d_(x))}),R(x,Bu.EventType.ERROR,I=>{j||(j=!0,qr(rr,`RPC '${e}' stream ${o} transport errored. Name:`,I.name,"Message:",I.message),T.u_(new Re(ye.UNAVAILABLE,"The operation could not be completed")))}),R(x,Bu.EventType.MESSAGE,I=>{var F;if(!j){const P=I.data[0];nt(!!P,16349);const z=P,H=(z==null?void 0:z.error)||((F=z[0])===null||F===void 0?void 0:F.error);if(H){Ee(rr,`RPC '${e}' stream ${o} received error:`,H);const J=H.status;let O=function(A){const D=jn[A];if(D!==void 0)return s_(D)}(J),L=H.message;O===void 0&&(O=ye.INTERNAL,L="Unknown error status: "+J+" with message "+H.message),j=!0,T.u_(new Re(O,L)),x.close()}else Ee(rr,`RPC '${e}' stream ${o} received:`,P),T.c_(P)}}),R(d,eT.STAT_EVENT,I=>{I.stat===vy.PROXY?Ee(rr,`RPC '${e}' stream ${o} detected buffering proxy`):I.stat===vy.NOPROXY&&Ee(rr,`RPC '${e}' stream ${o} detected no buffering proxy`)}),setTimeout(()=>{T.a_()},0),T}terminate(){this.l_.forEach(e=>e.close()),this.l_=[]}E_(e){this.l_.push(e)}d_(e){this.l_=this.l_.filter(t=>t===e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function K_(){return typeof window<"u"?window:null}function Ip(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Td(n){return new n5(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $x{constructor(e,t,r=1e3,o=1.5,a=6e4){this.xi=e,this.timerId=t,this.A_=r,this.R_=o,this.V_=a,this.m_=0,this.f_=null,this.g_=Date.now(),this.reset()}reset(){this.m_=0}p_(){this.m_=this.V_}y_(e){this.cancel();const t=Math.floor(this.m_+this.w_()),r=Math.max(0,Date.now()-this.g_),o=Math.max(0,t-r);o>0&&Ee("ExponentialBackoff",`Backing off for ${o} ms (base delay: ${this.m_} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.f_=this.xi.enqueueAfterDelay(this.timerId,o,()=>(this.g_=Date.now(),e())),this.m_*=this.R_,this.m_<this.A_&&(this.m_=this.A_),this.m_>this.V_&&(this.m_=this.V_)}b_(){this.f_!==null&&(this.f_.skipDelay(),this.f_=null)}cancel(){this.f_!==null&&(this.f_.cancel(),this.f_=null)}w_(){return(Math.random()-.5)*this.m_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Iw="PersistentStream";class Q_{constructor(e,t,r,o,a,c,d,h){this.xi=e,this.S_=r,this.D_=o,this.connection=a,this.authCredentialsProvider=c,this.appCheckCredentialsProvider=d,this.listener=h,this.state=0,this.v_=0,this.C_=null,this.F_=null,this.stream=null,this.M_=0,this.x_=new $x(e,t)}O_(){return this.state===1||this.state===5||this.N_()}N_(){return this.state===2||this.state===3}start(){this.M_=0,this.state!==4?this.auth():this.B_()}async stop(){this.O_()&&await this.close(0)}L_(){this.state=0,this.x_.reset()}k_(){this.N_()&&this.C_===null&&(this.C_=this.xi.enqueueAfterDelay(this.S_,6e4,()=>this.q_()))}Q_(e){this.U_(),this.stream.send(e)}async q_(){if(this.N_())return this.close(0)}U_(){this.C_&&(this.C_.cancel(),this.C_=null)}K_(){this.F_&&(this.F_.cancel(),this.F_=null)}async close(e,t){this.U_(),this.K_(),this.x_.cancel(),this.v_++,e!==4?this.x_.reset():t&&t.code===ye.RESOURCE_EXHAUSTED?(Sn(t.toString()),Sn("Using maximum backoff delay to prevent overloading the backend."),this.x_.p_()):t&&t.code===ye.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.i_(t)}W_(){}auth(){this.state=1;const e=this.G_(this.v_),t=this.v_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,o])=>{this.v_===t&&this.z_(r,o)},r=>{e(()=>{const o=new Re(ye.UNKNOWN,"Fetching auth token failed: "+r.message);return this.j_(o)})})}z_(e,t){const r=this.G_(this.v_);this.stream=this.H_(e,t),this.stream.e_(()=>{r(()=>this.listener.e_())}),this.stream.n_(()=>{r(()=>(this.state=2,this.F_=this.xi.enqueueAfterDelay(this.D_,1e4,()=>(this.N_()&&(this.state=3),Promise.resolve())),this.listener.n_()))}),this.stream.i_(o=>{r(()=>this.j_(o))}),this.stream.onMessage(o=>{r(()=>++this.M_==1?this.J_(o):this.onNext(o))})}B_(){this.state=5,this.x_.y_(async()=>{this.state=0,this.start()})}j_(e){return Ee(Iw,`close with error: ${e}`),this.stream=null,this.close(4,e)}G_(e){return t=>{this.xi.enqueueAndForget(()=>this.v_===e?t():(Ee(Iw,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class X5 extends Q_{constructor(e,t,r,o,a,c){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,o,c),this.serializer=a}H_(e,t){return this.connection.I_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.x_.reset();const t=o5(this.serializer,e),r=function(a){if(!("targetChange"in a))return at.min();const c=a.targetChange;return c.targetIds&&c.targetIds.length?at.min():c.readTime?kn(c.readTime):at.min()}(e);return this.listener.Y_(t,r)}Z_(e){const t={};t.database=Ny(this.serializer),t.addTarget=function(a,c){let d;const h=c.target;if(d=Vp(h)?{documents:m_(a,h)}:{query:Af(a,h).gt},d.targetId=c.targetId,c.resumeToken.approximateByteSize()>0){d.resumeToken=c_(a,c.resumeToken);const m=zy(a,c.expectedCount);m!==null&&(d.expectedCount=m)}else if(c.snapshotVersion.compareTo(at.min())>0){d.readTime=cc(a,c.snapshotVersion.toTimestamp());const m=zy(a,c.expectedCount);m!==null&&(d.expectedCount=m)}return d}(this.serializer,e);const r=a5(this.serializer,e);r&&(t.labels=r),this.Q_(t)}X_(e){const t={};t.database=Ny(this.serializer),t.removeTarget=e,this.Q_(t)}}class J5 extends Q_{constructor(e,t,r,o,a,c){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,o,c),this.serializer=a}get ea(){return this.M_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.ea&&this.ta([])}H_(e,t){return this.connection.I_("Write",e,t)}J_(e){return nt(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,nt(!e.writeResults||e.writeResults.length===0,55816),this.listener.na()}onNext(e){nt(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.x_.reset();const t=s5(e.writeResults,e.commitTime),r=kn(e.commitTime);return this.listener.ra(r,t)}ia(){const e={};e.database=Ny(this.serializer),this.Q_(e)}ta(e){const t={streamToken:this.lastStreamToken,writes:e.map(r=>cd(this.serializer,r))};this.Q_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z5{}class eP extends Z5{constructor(e,t,r,o){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=o,this.sa=!1}oa(){if(this.sa)throw new Re(ye.FAILED_PRECONDITION,"The client has already been terminated.")}zo(e,t,r,o){return this.oa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,c])=>this.connection.zo(e,Dy(t,r),o,a,c)).catch(a=>{throw a.name==="FirebaseError"?(a.code===ye.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new Re(ye.UNKNOWN,a.toString())})}Yo(e,t,r,o,a){return this.oa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([c,d])=>this.connection.Yo(e,Dy(t,r),o,c,d,a)).catch(c=>{throw c.name==="FirebaseError"?(c.code===ye.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),c):new Re(ye.UNKNOWN,c.toString())})}terminate(){this.sa=!0,this.connection.terminate()}}class tP{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this._a=0,this.aa=null,this.ua=!0}ca(){this._a===0&&(this.la("Unknown"),this.aa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.aa=null,this.ha("Backend didn't respond within 10 seconds."),this.la("Offline"),Promise.resolve())))}Pa(e){this.state==="Online"?this.la("Unknown"):(this._a++,this._a>=1&&(this.Ta(),this.ha(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.la("Offline")))}set(e){this.Ta(),this._a=0,e==="Online"&&(this.ua=!1),this.la(e)}la(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ha(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.ua?(Sn(t),this.ua=!1):Ee("OnlineStateTracker",t)}Ta(){this.aa!==null&&(this.aa.cancel(),this.aa=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pa="RemoteStore";class nP{constructor(e,t,r,o,a){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.Ia=[],this.Ea=new Map,this.da=new Set,this.Aa=[],this.Ra=a,this.Ra.No(c=>{r.enqueueAndForget(async()=>{Ps(this)&&(Ee(Pa,"Restarting streams for network reachability change."),await async function(h){const m=We(h);m.da.add(4),await Ic(m),m.Va.set("Unknown"),m.da.delete(4),await _d(m)}(this))})}),this.Va=new tP(r,o)}}async function _d(n){if(Ps(n))for(const e of n.Aa)await e(!0)}async function Ic(n){for(const e of n.Aa)await e(!1)}function zf(n,e){const t=We(n);t.Ea.has(e.targetId)||(t.Ea.set(e.targetId,e),Qx(t)?Kx(t):Rc(t).N_()&&Gx(t,e))}function hc(n,e){const t=We(n),r=Rc(t);t.Ea.delete(e),r.N_()&&Y_(t,e),t.Ea.size===0&&(r.N_()?r.k_():Ps(t)&&t.Va.set("Unknown"))}function Gx(n,e){if(n.ma.Ke(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(at.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Rc(n).Z_(e)}function Y_(n,e){n.ma.Ke(e),Rc(n).X_(e)}function Kx(n){n.ma=new J6({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),Rt:e=>n.Ea.get(e)||null,Pt:()=>n.datastore.serializer.databaseId}),Rc(n).start(),n.Va.ca()}function Qx(n){return Ps(n)&&!Rc(n).O_()&&n.Ea.size>0}function Ps(n){return We(n).da.size===0}function X_(n){n.ma=void 0}async function rP(n){n.Va.set("Online")}async function iP(n){n.Ea.forEach((e,t)=>{Gx(n,e)})}async function oP(n,e){X_(n),Qx(n)?(n.Va.Pa(e),Kx(n)):n.Va.set("Unknown")}async function sP(n,e,t){if(n.Va.set("Online"),e instanceof l_&&e.state===2&&e.cause)try{await async function(o,a){const c=a.cause;for(const d of a.targetIds)o.Ea.has(d)&&(await o.remoteSyncer.rejectListen(d,c),o.Ea.delete(d),o.ma.removeTarget(d))}(n,e)}catch(r){Ee(Pa,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Zp(n,r)}else if(e instanceof _p?n.ma.Xe(e):e instanceof a_?n.ma.ot(e):n.ma.nt(e),!t.isEqual(at.min()))try{const r=await L_(n.localStore);t.compareTo(r)>=0&&await function(a,c){const d=a.ma.It(c);return d.targetChanges.forEach((h,m)=>{if(h.resumeToken.approximateByteSize()>0){const g=a.Ea.get(m);g&&a.Ea.set(m,g.withResumeToken(h.resumeToken,c))}}),d.targetMismatches.forEach((h,m)=>{const g=a.Ea.get(h);if(!g)return;a.Ea.set(h,g.withResumeToken(mn.EMPTY_BYTE_STRING,g.snapshotVersion)),Y_(a,h);const x=new go(g.target,h,m,g.sequenceNumber);Gx(a,x)}),a.remoteSyncer.applyRemoteEvent(d)}(n,t)}catch(r){Ee(Pa,"Failed to raise snapshot:",r),await Zp(n,r)}}async function Zp(n,e,t){if(!Es(e))throw e;n.da.add(1),await Ic(n),n.Va.set("Offline"),t||(t=()=>L_(n.localStore)),n.asyncQueue.enqueueRetryable(async()=>{Ee(Pa,"Retrying IndexedDB access"),await t(),n.da.delete(1),await _d(n)})}function J_(n,e){return e().catch(t=>Zp(n,t,e))}async function Cc(n){const e=We(n),t=_s(e);let r=e.Ia.length>0?e.Ia[e.Ia.length-1].batchId:ys;for(;aP(e);)try{const o=await U5(e.localStore,r);if(o===null){e.Ia.length===0&&t.k_();break}r=o.batchId,lP(e,o)}catch(o){await Zp(e,o)}Z_(e)&&e2(e)}function aP(n){return Ps(n)&&n.Ia.length<10}function lP(n,e){n.Ia.push(e);const t=_s(n);t.N_()&&t.ea&&t.ta(e.mutations)}function Z_(n){return Ps(n)&&!_s(n).O_()&&n.Ia.length>0}function e2(n){_s(n).start()}async function cP(n){_s(n).ia()}async function uP(n){const e=_s(n);for(const t of n.Ia)e.ta(t.mutations)}async function dP(n,e,t){const r=n.Ia.shift(),o=Px.from(r,e,t);await J_(n,()=>n.remoteSyncer.applySuccessfulWrite(o)),await Cc(n)}async function hP(n,e){e&&_s(n).ea&&await async function(r,o){if(function(c){return o_(c)&&c!==ye.ABORTED}(o.code)){const a=r.Ia.shift();_s(r).L_(),await J_(r,()=>r.remoteSyncer.rejectFailedWrite(a.batchId,o)),await Cc(r)}}(n,e),Z_(n)&&e2(n)}async function Cw(n,e){const t=We(n);t.asyncQueue.verifyOperationInProgress(),Ee(Pa,"RemoteStore received new credentials");const r=Ps(t);t.da.add(3),await Ic(t),r&&t.Va.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.da.delete(3),await _d(t)}async function qy(n,e){const t=We(n);e?(t.da.delete(2),await _d(t)):e||(t.da.add(2),await Ic(t),t.Va.set("Unknown"))}function Rc(n){return n.fa||(n.fa=function(t,r,o){const a=We(t);return a.oa(),new X5(r,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,o)}(n.datastore,n.asyncQueue,{e_:rP.bind(null,n),n_:iP.bind(null,n),i_:oP.bind(null,n),Y_:sP.bind(null,n)}),n.Aa.push(async e=>{e?(n.fa.L_(),Qx(n)?Kx(n):n.Va.set("Unknown")):(await n.fa.stop(),X_(n))})),n.fa}function _s(n){return n.ga||(n.ga=function(t,r,o){const a=We(t);return a.oa(),new J5(r,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,o)}(n.datastore,n.asyncQueue,{e_:()=>Promise.resolve(),n_:cP.bind(null,n),i_:hP.bind(null,n),na:uP.bind(null,n),ra:dP.bind(null,n)}),n.Aa.push(async e=>{e?(n.ga.L_(),await Cc(n)):(await n.ga.stop(),n.Ia.length>0&&(Ee(Pa,`Stopping write stream with ${n.Ia.length} pending writes`),n.Ia=[]))})),n.ga}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yx{constructor(e,t,r,o,a){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=o,this.removalCallback=a,this.deferred=new qn,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(c=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,o,a){const c=Date.now()+r,d=new Yx(e,t,c,o,a);return d.start(r),d}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Re(ye.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Ec(n,e){if(Sn("AsyncQueue",`${e}: ${n}`),Es(n))return new Re(ye.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hl{static emptySet(e){return new Hl(e.comparator)}constructor(e){this.comparator=e?(t,r)=>e(t,r)||Ve.comparator(t.key,r.key):(t,r)=>Ve.comparator(t.key,r.key),this.keyedMap=Fu(),this.sortedSet=new tn(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Hl)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const o=t.getNext().key,a=r.getNext().key;if(!o.isEqual(a))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const r=new Hl;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rw{constructor(){this.pa=new tn(Ve.comparator)}track(e){const t=e.doc.key,r=this.pa.get(t);r?e.type!==0&&r.type===3?this.pa=this.pa.insert(t,e):e.type===3&&r.type!==1?this.pa=this.pa.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.pa=this.pa.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.pa=this.pa.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.pa=this.pa.remove(t):e.type===1&&r.type===2?this.pa=this.pa.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.pa=this.pa.insert(t,{type:2,doc:e.doc}):Ke(63341,{Vt:e,ya:r}):this.pa=this.pa.insert(t,e)}wa(){const e=[];return this.pa.inorderTraversal((t,r)=>{e.push(r)}),e}}class pc{constructor(e,t,r,o,a,c,d,h,m){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=o,this.mutatedKeys=a,this.fromCache=c,this.syncStateChanged=d,this.excludesMetadataChanges=h,this.hasCachedResults=m}static fromInitialDocuments(e,t,r,o,a){const c=[];return t.forEach(d=>{c.push({type:0,doc:d})}),new pc(e,t,Hl.emptySet(t),c,r,o,!0,!1,a)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&bd(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let o=0;o<t.length;o++)if(t[o].type!==r[o].type||!t[o].doc.isEqual(r[o].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pP{constructor(){this.ba=void 0,this.Sa=[]}Da(){return this.Sa.some(e=>e.va())}}class fP{constructor(){this.queries=Ew(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,r){const o=We(t),a=o.queries;o.queries=Ew(),a.forEach((c,d)=>{for(const h of d.Sa)h.onError(r)})})(this,new Re(ye.ABORTED,"Firestore shutting down"))}}function Ew(){return new Co(n=>qT(n),bd)}async function Xx(n,e){const t=We(n);let r=3;const o=e.query;let a=t.queries.get(o);a?!a.Da()&&e.va()&&(r=2):(a=new pP,r=e.va()?0:1);try{switch(r){case 0:a.ba=await t.onListen(o,!0);break;case 1:a.ba=await t.onListen(o,!1);break;case 2:await t.onFirstRemoteStoreListen(o)}}catch(c){const d=Ec(c,`Initialization of query '${Ol(e.query)}' failed`);return void e.onError(d)}t.queries.set(o,a),a.Sa.push(e),e.Fa(t.onlineState),a.ba&&e.Ma(a.ba)&&Zx(t)}async function Jx(n,e){const t=We(n),r=e.query;let o=3;const a=t.queries.get(r);if(a){const c=a.Sa.indexOf(e);c>=0&&(a.Sa.splice(c,1),a.Sa.length===0?o=e.va()?0:1:!a.Da()&&e.va()&&(o=2))}switch(o){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}}function mP(n,e){const t=We(n);let r=!1;for(const o of e){const a=o.query,c=t.queries.get(a);if(c){for(const d of c.Sa)d.Ma(o)&&(r=!0);c.ba=o}}r&&Zx(t)}function gP(n,e,t){const r=We(n),o=r.queries.get(e);if(o)for(const a of o.Sa)a.onError(t);r.queries.delete(e)}function Zx(n){n.Ca.forEach(e=>{e.next()})}var Hy,Aw;(Aw=Hy||(Hy={})).xa="default",Aw.Cache="cache";class e0{constructor(e,t,r){this.query=e,this.Oa=t,this.Na=!1,this.Ba=null,this.onlineState="Unknown",this.options=r||{}}Ma(e){if(!this.options.includeMetadataChanges){const r=[];for(const o of e.docChanges)o.type!==3&&r.push(o);e=new pc(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Na?this.La(e)&&(this.Oa.next(e),t=!0):this.ka(e,this.onlineState)&&(this.qa(e),t=!0),this.Ba=e,t}onError(e){this.Oa.error(e)}Fa(e){this.onlineState=e;let t=!1;return this.Ba&&!this.Na&&this.ka(this.Ba,e)&&(this.qa(this.Ba),t=!0),t}ka(e,t){if(!e.fromCache||!this.va())return!0;const r=t!=="Offline";return(!this.options.Qa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}La(e){if(e.docChanges.length>0)return!0;const t=this.Ba&&this.Ba.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}qa(e){e=pc.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Na=!0,this.Oa.next(e)}va(){return this.options.source!==Hy.Cache}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yP{constructor(e,t){this.$a=e,this.byteLength=t}Ua(){return"metadata"in this.$a}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pw{constructor(e){this.serializer=e}Us(e){return Vi(this.serializer,e)}Ks(e){return e.metadata.exists?f_(this.serializer,e.document,!1):on.newNoDocument(this.Us(e.metadata.name),this.Ws(e.metadata.readTime))}Ws(e){return kn(e)}}class xP{constructor(e,t,r){this.Ka=e,this.localStore=t,this.serializer=r,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=t2(e)}Wa(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.$a.namedQuery)this.queries.push(e.$a.namedQuery);else if(e.$a.documentMetadata){this.documents.push({metadata:e.$a.documentMetadata}),e.$a.documentMetadata.exists||++t;const r=It.fromString(e.$a.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.$a.document&&(this.documents[this.documents.length-1].document=e.$a.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}Ga(e){const t=new Map,r=new Pw(this.serializer);for(const o of e)if(o.metadata.queries){const a=r.Us(o.metadata.name);for(const c of o.metadata.queries){const d=(t.get(c)||bt()).add(a);t.set(c,d)}}return t}async complete(){const e=await q5(this.localStore,new Pw(this.serializer),this.documents,this.Ka.id),t=this.Ga(this.documents);for(const r of this.queries)await H5(this.localStore,r,t.get(r.name));return this.progress.taskState="Success",{progress:this.progress,za:this.collectionGroups,ja:e}}}function t2(n){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:n.totalDocuments,totalBytes:n.totalBytes}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n2{constructor(e){this.key=e}}class r2{constructor(e){this.key=e}}class i2{constructor(e,t){this.query=e,this.Ha=t,this.Ja=null,this.hasCachedResults=!1,this.current=!1,this.Ya=bt(),this.mutatedKeys=bt(),this.Za=$T(e),this.Xa=new Hl(this.Za)}get eu(){return this.Ha}tu(e,t){const r=t?t.nu:new Rw,o=t?t.Xa:this.Xa;let a=t?t.mutatedKeys:this.mutatedKeys,c=o,d=!1;const h=this.query.limitType==="F"&&o.size===this.query.limit?o.last():null,m=this.query.limitType==="L"&&o.size===this.query.limit?o.first():null;if(e.inorderTraversal((g,x)=>{const S=o.get(g),j=vd(this.query,x)?x:null,T=!!S&&this.mutatedKeys.has(S.key),R=!!j&&(j.hasLocalMutations||this.mutatedKeys.has(j.key)&&j.hasCommittedMutations);let I=!1;S&&j?S.data.isEqual(j.data)?T!==R&&(r.track({type:3,doc:j}),I=!0):this.ru(S,j)||(r.track({type:2,doc:j}),I=!0,(h&&this.Za(j,h)>0||m&&this.Za(j,m)<0)&&(d=!0)):!S&&j?(r.track({type:0,doc:j}),I=!0):S&&!j&&(r.track({type:1,doc:S}),I=!0,(h||m)&&(d=!0)),I&&(j?(c=c.add(j),a=R?a.add(g):a.delete(g)):(c=c.delete(g),a=a.delete(g)))}),this.query.limit!==null)for(;c.size>this.query.limit;){const g=this.query.limitType==="F"?c.last():c.first();c=c.delete(g.key),a=a.delete(g.key),r.track({type:1,doc:g})}return{Xa:c,nu:r,Cs:d,mutatedKeys:a}}ru(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,o){const a=this.Xa;this.Xa=e.Xa,this.mutatedKeys=e.mutatedKeys;const c=e.nu.wa();c.sort((g,x)=>function(j,T){const R=I=>{switch(I){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ke(20277,{Vt:I})}};return R(j)-R(T)}(g.type,x.type)||this.Za(g.doc,x.doc)),this.iu(r),o=o!=null&&o;const d=t&&!o?this.su():[],h=this.Ya.size===0&&this.current&&!o?1:0,m=h!==this.Ja;return this.Ja=h,c.length!==0||m?{snapshot:new pc(this.query,e.Xa,a,c,e.mutatedKeys,h===0,m,!1,!!r&&r.resumeToken.approximateByteSize()>0),ou:d}:{ou:d}}Fa(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Xa:this.Xa,nu:new Rw,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{ou:[]}}_u(e){return!this.Ha.has(e)&&!!this.Xa.has(e)&&!this.Xa.get(e).hasLocalMutations}iu(e){e&&(e.addedDocuments.forEach(t=>this.Ha=this.Ha.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ha=this.Ha.delete(t)),this.current=e.current)}su(){if(!this.current)return[];const e=this.Ya;this.Ya=bt(),this.Xa.forEach(r=>{this._u(r.key)&&(this.Ya=this.Ya.add(r.key))});const t=[];return e.forEach(r=>{this.Ya.has(r)||t.push(new r2(r))}),this.Ya.forEach(r=>{e.has(r)||t.push(new n2(r))}),t}au(e){this.Ha=e.$s,this.Ya=bt();const t=this.tu(e.documents);return this.applyChanges(t,!0)}uu(){return pc.fromInitialDocuments(this.query,this.Xa,this.mutatedKeys,this.Ja===0,this.hasCachedResults)}}const Bs="SyncEngine";class bP{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class vP{constructor(e){this.key=e,this.cu=!1}}class wP{constructor(e,t,r,o,a,c){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=o,this.currentUser=a,this.maxConcurrentLimboResolutions=c,this.lu={},this.hu=new Co(d=>qT(d),bd),this.Pu=new Map,this.Tu=new Set,this.Iu=new tn(Ve.comparator),this.Eu=new Map,this.du=new Lx,this.Au={},this.Ru=new Map,this.Vu=Aa.lr(),this.onlineState="Unknown",this.mu=void 0}get isPrimaryClient(){return this.mu===!0}}async function SP(n,e,t=!0){const r=Df(n);let o;const a=r.hu.get(e);return a?(r.sharedClientState.addLocalQueryTarget(a.targetId),o=a.view.uu()):o=await o2(r,e,t,!0),o}async function kP(n,e){const t=Df(n);await o2(t,e,!0,!1)}async function o2(n,e,t,r){const o=await uc(n.localStore,ar(e)),a=o.targetId,c=n.sharedClientState.addLocalQueryTarget(a,t);let d;return r&&(d=await t0(n,e,a,c==="current",o.resumeToken)),n.isPrimaryClient&&t&&zf(n.remoteStore,o),d}async function t0(n,e,t,r,o){n.fu=(x,S,j)=>async function(R,I,F,P){let z=I.view.tu(F);z.Cs&&(z=await Yp(R.localStore,I.query,!1).then(({documents:L})=>I.view.tu(L,z)));const H=P&&P.targetChanges.get(I.targetId),J=P&&P.targetMismatches.get(I.targetId)!=null,O=I.view.applyChanges(z,R.isPrimaryClient,H,J);return $y(R,I.targetId,O.ou),O.snapshot}(n,x,S,j);const a=await Yp(n.localStore,e,!0),c=new i2(e,a.$s),d=c.tu(a.documents),h=kd.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",o),m=c.applyChanges(d,n.isPrimaryClient,h);$y(n,t,m.ou);const g=new bP(e,t,c);return n.hu.set(e,g),n.Pu.has(t)?n.Pu.get(t).push(e):n.Pu.set(t,[e]),m.snapshot}async function TP(n,e,t){const r=We(n),o=r.hu.get(e),a=r.Pu.get(o.targetId);if(a.length>1)return r.Pu.set(o.targetId,a.filter(c=>!bd(c,e))),void r.hu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(o.targetId),r.sharedClientState.isActiveQueryTarget(o.targetId)||await dc(r.localStore,o.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(o.targetId),t&&hc(r.remoteStore,o.targetId),fc(r,o.targetId)}).catch(Rs)):(fc(r,o.targetId),await dc(r.localStore,o.targetId,!0))}async function _P(n,e){const t=We(n),r=t.hu.get(e),o=t.Pu.get(r.targetId);t.isPrimaryClient&&o.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),hc(t.remoteStore,r.targetId))}async function jP(n,e,t){const r=o0(n);try{const o=await function(c,d){const h=We(c),m=Yt.now(),g=d.reduce((j,T)=>j.add(T.key),bt());let x,S;return h.persistence.runTransaction("Locally write mutations","readwrite",j=>{let T=Rr(),R=bt();return h.Bs.getEntries(j,g).next(I=>{T=I,T.forEach((F,P)=>{P.isValidDocument()||(R=R.add(F))})}).next(()=>h.localDocuments.getOverlayedDocuments(j,T)).next(I=>{x=I;const F=[];for(const P of d){const z=Q6(P,x.get(P.key).overlayedDocument);z!=null&&F.push(new Ro(P.key,z,BT(z.value.mapValue),dn.exists(!0)))}return h.mutationQueue.addMutationBatch(j,m,F,d)}).next(I=>{S=I;const F=I.applyToLocalDocumentSet(x,R);return h.documentOverlayCache.saveOverlays(j,I.batchId,F)})}).then(()=>({batchId:S.batchId,changes:KT(x)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(o.batchId),function(c,d,h){let m=c.Au[c.currentUser.toKey()];m||(m=new tn(ut)),m=m.insert(d,h),c.Au[c.currentUser.toKey()]=m}(r,o.batchId,t),await Eo(r,o.changes),await Cc(r.remoteStore)}catch(o){const a=Ec(o,"Failed to persist write");t.reject(a)}}async function s2(n,e){const t=We(n);try{const r=await V5(t.localStore,e);e.targetChanges.forEach((o,a)=>{const c=t.Eu.get(a);c&&(nt(o.addedDocuments.size+o.modifiedDocuments.size+o.removedDocuments.size<=1,22616),o.addedDocuments.size>0?c.cu=!0:o.modifiedDocuments.size>0?nt(c.cu,14607):o.removedDocuments.size>0&&(nt(c.cu,42227),c.cu=!1))}),await Eo(t,r,e)}catch(r){await Rs(r)}}function Bw(n,e,t){const r=We(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){const o=[];r.hu.forEach((a,c)=>{const d=c.view.Fa(e);d.snapshot&&o.push(d.snapshot)}),function(c,d){const h=We(c);h.onlineState=d;let m=!1;h.queries.forEach((g,x)=>{for(const S of x.Sa)S.Fa(d)&&(m=!0)}),m&&Zx(h)}(r.eventManager,e),o.length&&r.lu.Y_(o),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function IP(n,e,t){const r=We(n);r.sharedClientState.updateQueryState(e,"rejected",t);const o=r.Eu.get(e),a=o&&o.key;if(a){let c=new tn(Ve.comparator);c=c.insert(a,on.newNoDocument(a,at.min()));const d=bt().add(a),h=new Sd(at.min(),new Map,new tn(ut),c,d);await s2(r,h),r.Iu=r.Iu.remove(a),r.Eu.delete(e),i0(r)}else await dc(r.localStore,e,!1).then(()=>fc(r,e,t)).catch(Rs)}async function CP(n,e){const t=We(n),r=e.batch.batchId;try{const o=await W5(t.localStore,e);r0(t,r,null),n0(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await Eo(t,o)}catch(o){await Rs(o)}}async function RP(n,e,t){const r=We(n);try{const o=await function(c,d){const h=We(c);return h.persistence.runTransaction("Reject batch","readwrite-primary",m=>{let g;return h.mutationQueue.lookupMutationBatch(m,d).next(x=>(nt(x!==null,37113),g=x.keys(),h.mutationQueue.removeMutationBatch(m,x))).next(()=>h.mutationQueue.performConsistencyCheck(m)).next(()=>h.documentOverlayCache.removeOverlaysForBatchId(m,g,d)).next(()=>h.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(m,g)).next(()=>h.localDocuments.getDocuments(m,g))})}(r.localStore,e);r0(r,e,t),n0(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await Eo(r,o)}catch(o){await Rs(o)}}async function EP(n,e){const t=We(n);Ps(t.remoteStore)||Ee(Bs,"The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const r=await function(c){const d=We(c);return d.persistence.runTransaction("Get highest unacknowledged batch id","readonly",h=>d.mutationQueue.getHighestUnacknowledgedBatchId(h))}(t.localStore);if(r===ys)return void e.resolve();const o=t.Ru.get(r)||[];o.push(e),t.Ru.set(r,o)}catch(r){const o=Ec(r,"Initialization of waitForPendingWrites() operation failed");e.reject(o)}}function n0(n,e){(n.Ru.get(e)||[]).forEach(t=>{t.resolve()}),n.Ru.delete(e)}function r0(n,e,t){const r=We(n);let o=r.Au[r.currentUser.toKey()];if(o){const a=o.get(e);a&&(t?a.reject(t):a.resolve(),o=o.remove(e)),r.Au[r.currentUser.toKey()]=o}}function fc(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.Pu.get(e))n.hu.delete(r),t&&n.lu.gu(r,t);n.Pu.delete(e),n.isPrimaryClient&&n.du.Hr(e).forEach(r=>{n.du.containsKey(r)||a2(n,r)})}function a2(n,e){n.Tu.delete(e.path.canonicalString());const t=n.Iu.get(e);t!==null&&(hc(n.remoteStore,t),n.Iu=n.Iu.remove(e),n.Eu.delete(t),i0(n))}function $y(n,e,t){for(const r of t)r instanceof n2?(n.du.addReference(r.key,e),AP(n,r)):r instanceof r2?(Ee(Bs,"Document no longer in limbo: "+r.key),n.du.removeReference(r.key,e),n.du.containsKey(r.key)||a2(n,r.key)):Ke(19791,{pu:r})}function AP(n,e){const t=e.key,r=t.path.canonicalString();n.Iu.get(t)||n.Tu.has(r)||(Ee(Bs,"New document in limbo: "+t),n.Tu.add(r),i0(n))}function i0(n){for(;n.Tu.size>0&&n.Iu.size<n.maxConcurrentLimboResolutions;){const e=n.Tu.values().next().value;n.Tu.delete(e);const t=new Ve(It.fromString(e)),r=n.Vu.next();n.Eu.set(r,new vP(t)),n.Iu=n.Iu.insert(t,r),zf(n.remoteStore,new go(ar(Tc(t.path)),r,"TargetPurposeLimboResolution",Ir.le))}}async function Eo(n,e,t){const r=We(n),o=[],a=[],c=[];r.hu.isEmpty()||(r.hu.forEach((d,h)=>{c.push(r.fu(h,e,t).then(m=>{var g;if((m||t)&&r.isPrimaryClient){const x=m?!m.fromCache:(g=t==null?void 0:t.targetChanges.get(h.targetId))===null||g===void 0?void 0:g.current;r.sharedClientState.updateQueryState(h.targetId,x?"current":"not-current")}if(m){o.push(m);const x=Ux.Rs(h.targetId,m);a.push(x)}}))}),await Promise.all(c),r.lu.Y_(o),await async function(h,m){const g=We(h);try{await g.persistence.runTransaction("notifyLocalViewChanges","readwrite",x=>ue.forEach(m,S=>ue.forEach(S.ds,j=>g.persistence.referenceDelegate.addReference(x,S.targetId,j)).next(()=>ue.forEach(S.As,j=>g.persistence.referenceDelegate.removeReference(x,S.targetId,j)))))}catch(x){if(!Es(x))throw x;Ee(qx,"Failed to update sequence numbers: "+x)}for(const x of m){const S=x.targetId;if(!x.fromCache){const j=g.xs.get(S),T=j.snapshotVersion,R=j.withLastLimboFreeSnapshotVersion(T);g.xs=g.xs.insert(S,R)}}}(r.localStore,a))}async function PP(n,e){const t=We(n);if(!t.currentUser.isEqual(e)){Ee(Bs,"User change. New user:",e.toKey());const r=await M_(t.localStore,e);t.currentUser=e,function(a,c){a.Ru.forEach(d=>{d.forEach(h=>{h.reject(new Re(ye.CANCELLED,c))})}),a.Ru.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Eo(t,r.ks)}}function BP(n,e){const t=We(n),r=t.Eu.get(e);if(r&&r.cu)return bt().add(r.key);{let o=bt();const a=t.Pu.get(e);if(!a)return o;for(const c of a){const d=t.hu.get(c);o=o.unionWith(d.view.eu)}return o}}async function FP(n,e){const t=We(n),r=await Yp(t.localStore,e.query,!0),o=e.view.au(r);return t.isPrimaryClient&&$y(t,e.targetId,o.ou),o}async function zP(n,e){const t=We(n);return V_(t.localStore,e).then(r=>Eo(t,r))}async function DP(n,e,t,r){const o=We(n),a=await function(d,h){const m=We(d),g=We(m.mutationQueue);return m.persistence.runTransaction("Lookup mutation documents","readonly",x=>g.tr(x,h).next(S=>S?m.localDocuments.getDocuments(x,S):ue.resolve(null)))}(o.localStore,e);a!==null?(t==="pending"?await Cc(o.remoteStore):t==="acknowledged"||t==="rejected"?(r0(o,e,r||null),n0(o,e),function(d,h){We(We(d).mutationQueue).sr(h)}(o.localStore,e)):Ke(6720,"Unknown batchState",{yu:t}),await Eo(o,a)):Ee(Bs,"Cannot apply mutation batch with id: "+e)}async function NP(n,e){const t=We(n);if(Df(t),o0(t),e===!0&&t.mu!==!0){const r=t.sharedClientState.getAllActiveQueryTargets(),o=await Fw(t,r.toArray());t.mu=!0,await qy(t.remoteStore,!0);for(const a of o)zf(t.remoteStore,a)}else if(e===!1&&t.mu!==!1){const r=[];let o=Promise.resolve();t.Pu.forEach((a,c)=>{t.sharedClientState.isLocalQueryTarget(c)?r.push(c):o=o.then(()=>(fc(t,c),dc(t.localStore,c,!0))),hc(t.remoteStore,c)}),await o,await Fw(t,r),function(c){const d=We(c);d.Eu.forEach((h,m)=>{hc(d.remoteStore,m)}),d.du.Jr(),d.Eu=new Map,d.Iu=new tn(Ve.comparator)}(t),t.mu=!1,await qy(t.remoteStore,!1)}}async function Fw(n,e,t){const r=We(n),o=[],a=[];for(const c of e){let d;const h=r.Pu.get(c);if(h&&h.length!==0){d=await uc(r.localStore,ar(h[0]));for(const m of h){const g=r.hu.get(m),x=await FP(r,g);x.snapshot&&a.push(x.snapshot)}}else{const m=await W_(r.localStore,c);d=await uc(r.localStore,m),await t0(r,l2(m),c,!1,d.resumeToken)}o.push(d)}return r.lu.Y_(a),o}function l2(n){return WT(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function MP(n){return function(t){return We(We(t).persistence).Is()}(We(n).localStore)}async function LP(n,e,t,r){const o=We(n);if(o.mu)return void Ee(Bs,"Ignoring unexpected query state notification.");const a=o.Pu.get(e);if(a&&a.length>0)switch(t){case"current":case"not-current":{const c=await V_(o.localStore,HT(a[0])),d=Sd.createSynthesizedRemoteEventForCurrentChange(e,t==="current",mn.EMPTY_BYTE_STRING);await Eo(o,c,d);break}case"rejected":await dc(o.localStore,e,!0),fc(o,e,r);break;default:Ke(64155,t)}}async function OP(n,e,t){const r=Df(n);if(r.mu){for(const o of e){if(r.Pu.has(o)&&r.sharedClientState.isActiveQueryTarget(o)){Ee(Bs,"Adding an already active target "+o);continue}const a=await W_(r.localStore,o),c=await uc(r.localStore,a);await t0(r,l2(a),c.targetId,!1,c.resumeToken),zf(r.remoteStore,c)}for(const o of t)r.Pu.has(o)&&await dc(r.localStore,o,!1).then(()=>{hc(r.remoteStore,o),fc(r,o)}).catch(Rs)}}function Df(n){const e=We(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=s2.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=BP.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=IP.bind(null,e),e.lu.Y_=mP.bind(null,e.eventManager),e.lu.gu=gP.bind(null,e.eventManager),e}function o0(n){const e=We(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=CP.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=RP.bind(null,e),e}function WP(n,e,t){const r=We(n);(async function(a,c,d){try{const h=await c.getMetadata();if(await function(j,T){const R=We(j),I=kn(T.createTime);return R.persistence.runTransaction("hasNewerBundle","readonly",F=>R.Ei.getBundleMetadata(F,T.id)).then(F=>!!F&&F.createTime.compareTo(I)>=0)}(a.localStore,h))return await c.close(),d._completeWith(function(j){return{taskState:"Success",documentsLoaded:j.totalDocuments,bytesLoaded:j.totalBytes,totalDocuments:j.totalDocuments,totalBytes:j.totalBytes}}(h)),Promise.resolve(new Set);d._updateProgress(t2(h));const m=new xP(h,a.localStore,c.serializer);let g=await c.wu();for(;g;){const S=await m.Wa(g);S&&d._updateProgress(S),g=await c.wu()}const x=await m.complete();return await Eo(a,x.ja,void 0),await function(j,T){const R=We(j);return R.persistence.runTransaction("Save bundle","readwrite",I=>R.Ei.saveBundleMetadata(I,T))}(a.localStore,h),d._completeWith(x.progress),Promise.resolve(x.za)}catch(h){return qr(Bs,`Loading bundle failed with ${h}`),d._failWith(h),Promise.resolve(new Set)}})(r,e,t).then(o=>{r.sharedClientState.notifyBundleLoaded(o)})}class mc{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Td(e.databaseInfo.databaseId),this.sharedClientState=this.bu(e),this.persistence=this.Su(e),await this.persistence.start(),this.localStore=this.Du(e),this.gcScheduler=this.vu(e,this.localStore),this.indexBackfillerScheduler=this.Cu(e,this.localStore)}vu(e,t){return null}Cu(e,t){return null}Du(e){return N_(this.persistence,new D_,e.initialUser,this.serializer)}Su(e){return new Ox(Ff.fi,this.serializer)}bu(e){return new G_}async terminate(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}mc.provider={build:()=>new mc};class s0 extends mc{constructor(e){super(),this.cacheSizeBytes=e}vu(e,t){nt(this.persistence.referenceDelegate instanceof Qp,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new E_(r,e.asyncQueue,t)}Su(e){const t=this.cacheSizeBytes!==void 0?ir.withCacheSize(this.cacheSizeBytes):ir.DEFAULT;return new Ox(r=>Qp.fi(r,t),this.serializer)}}class a0 extends mc{constructor(e,t,r){super(),this.Fu=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.Fu.initialize(this,e),await o0(this.Fu.syncEngine),await Cc(this.Fu.remoteStore),await this.persistence.Ji(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}Du(e){return N_(this.persistence,new D_,e.initialUser,this.serializer)}vu(e,t){const r=this.persistence.referenceDelegate.garbageCollector;return new E_(r,e.asyncQueue,t)}Cu(e,t){const r=new ZA(t,this.persistence);return new JA(e.asyncQueue,r)}Su(e){const t=Vx(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?ir.withCacheSize(this.cacheSizeBytes):ir.DEFAULT;return new Wx(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,K_(),Ip(),this.serializer,this.sharedClientState,!!this.forceOwnership)}bu(e){return new G_}}class c2 extends a0{constructor(e,t){super(e,t,!1),this.Fu=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const t=this.Fu.syncEngine;this.sharedClientState instanceof Gg&&(this.sharedClientState.syncEngine={Co:DP.bind(null,t),Fo:LP.bind(null,t),Mo:OP.bind(null,t),Is:MP.bind(null,t),vo:zP.bind(null,t)},await this.sharedClientState.start()),await this.persistence.Ji(async r=>{await NP(this.Fu.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())})}bu(e){const t=K_();if(!Gg.C(t))throw new Re(ye.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const r=Vx(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new Gg(t,e.asyncQueue,r,e.clientId,e.initialUser)}}class js{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>Bw(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=PP.bind(null,this.syncEngine),await qy(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new fP}()}createDatastore(e){const t=Td(e.databaseInfo.databaseId),r=function(a){return new Y5(a)}(e.databaseInfo);return function(a,c,d,h){return new eP(a,c,d,h)}(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return function(r,o,a,c,d){return new nP(r,o,a,c,d)}(this.localStore,this.datastore,e.asyncQueue,t=>Bw(this.syncEngine,t,0),function(){return jw.C()?new jw:new $5}())}createSyncEngine(e,t){return function(o,a,c,d,h,m,g){const x=new wP(o,a,c,d,h,m);return g&&(x.mu=!0),x}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(o){const a=We(o);Ee(Pa,"RemoteStore shutting down."),a.da.add(5),await Ic(a),a.Ra.shutdown(),a.Va.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(t=this.eventManager)===null||t===void 0||t.terminate()}}js.provider={build:()=>new js};function zw(n,e=10240){let t=0;return{async read(){if(t<n.byteLength){const r={value:n.slice(t,t+e),done:!1};return t+=e,r}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nf{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Mu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Mu(this.observer.error,e):Sn("Uncaught Error in snapshot listener:",e.toString()))}xu(){this.muted=!0}Mu(e,t){setTimeout(()=>{this.muted||e(t)},0)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VP{constructor(e,t){this.Ou=e,this.serializer=t,this.metadata=new qn,this.buffer=new Uint8Array,this.Nu=function(){return new TextDecoder("utf-8")}(),this.Bu().then(r=>{r&&r.Ua()?this.metadata.resolve(r.$a.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(r==null?void 0:r.$a)}`))},r=>this.metadata.reject(r))}close(){return this.Ou.cancel()}async getMetadata(){return this.metadata.promise}async wu(){return await this.getMetadata(),this.Bu()}async Bu(){const e=await this.Lu();if(e===null)return null;const t=this.Nu.decode(e),r=Number(t);isNaN(r)&&this.ku(`length string (${t}) is not valid number`);const o=await this.qu(r);return new yP(JSON.parse(o),e.length+r)}Qu(){return this.buffer.findIndex(e=>e===123)}async Lu(){for(;this.Qu()<0&&!await this.$u(););if(this.buffer.length===0)return null;const e=this.Qu();e<0&&this.ku("Reached the end of bundle when a length string is expected.");const t=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),t}async qu(e){for(;this.buffer.length<e;)await this.$u()&&this.ku("Reached the end of bundle when more is expected.");const t=this.Nu.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),t}ku(e){throw this.Ou.cancel(),new Error(`Invalid bundle format: ${e}`)}async $u(){const e=await this.Ou.read();if(!e.done){const t=new Uint8Array(this.buffer.length+e.value.length);t.set(this.buffer),t.set(e.value,this.buffer.length),this.buffer=t}return e.done}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UP{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new Re(ye.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const t=await async function(o,a){const c=We(o),d={documents:a.map(x=>ld(c.serializer,x))},h=await c.Yo("BatchGetDocuments",c.serializer.databaseId,It.emptyPath(),d,a.length),m=new Map;h.forEach(x=>{const S=i5(c.serializer,x);m.set(S.key.toString(),S)});const g=[];return a.forEach(x=>{const S=m.get(x.toString());nt(!!S,55234,{key:x}),g.push(S)}),g}(this.datastore,e);return t.forEach(r=>this.recordVersion(r)),t}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastTransactionError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new jc(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach(t=>{e.delete(t.key.toString())}),e.forEach((t,r)=>{const o=Ve.fromPath(r);this.mutations.push(new Ex(o,this.precondition(o)))}),await async function(r,o){const a=We(r),c={writes:o.map(d=>cd(a.serializer,d))};await a.zo("Commit",a.serializer.databaseId,It.emptyPath(),c)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw Ke(50498,{Uu:e.constructor.name});t=at.min()}const r=this.readVersions.get(e.key.toString());if(r){if(!t.isEqual(r))throw new Re(ye.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(at.min())?dn.exists(!1):dn.updateTime(t):dn.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(at.min()))throw new Re(ye.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return dn.updateTime(t)}return dn.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qP{constructor(e,t,r,o,a){this.asyncQueue=e,this.datastore=t,this.options=r,this.updateFunction=o,this.deferred=a,this.Ku=r.maxAttempts,this.x_=new $x(this.asyncQueue,"transaction_retry")}Wu(){this.Ku-=1,this.Gu()}Gu(){this.x_.y_(async()=>{const e=new UP(this.datastore),t=this.zu(e);t&&t.then(r=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(r)}).catch(o=>{this.ju(o)}))}).catch(r=>{this.ju(r)})})}zu(e){try{const t=this.updateFunction(e);return!gd(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}ju(e){this.Ku>0&&this.Hu(e)?(this.Ku-=1,this.asyncQueue.enqueueAndForget(()=>(this.Gu(),Promise.resolve()))):this.deferred.reject(e)}Hu(e){if(e.name==="FirebaseError"){const t=e.code;return t==="aborted"||t==="failed-precondition"||t==="already-exists"||!o_(t)}return!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Is="FirestoreClient";class HP{constructor(e,t,r,o,a){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=o,this.user=Vn.UNAUTHENTICATED,this.clientId=yx.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=a,this.authCredentials.start(r,async c=>{Ee(Is,"Received user=",c.uid),await this.authCredentialListener(c),this.user=c}),this.appCheckCredentials.start(r,c=>(Ee(Is,"Received new app check token=",c),this.appCheckCredentialListener(c,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new qn;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const r=Ec(t,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function Qg(n,e){n.asyncQueue.verifyOperationInProgress(),Ee(Is,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(async o=>{r.isEqual(o)||(await M_(e.localStore,o),r=o)}),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e}async function Dw(n,e){n.asyncQueue.verifyOperationInProgress();const t=await l0(n);Ee(Is,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>Cw(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,o)=>Cw(e.remoteStore,o)),n._onlineComponents=e}async function l0(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){Ee(Is,"Using user provided OfflineComponentProvider");try{await Qg(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!function(o){return o.name==="FirebaseError"?o.code===ye.FAILED_PRECONDITION||o.code===ye.UNIMPLEMENTED:!(typeof DOMException<"u"&&o instanceof DOMException)||o.code===22||o.code===20||o.code===11}(t))throw t;qr("Error using user provided cache. Falling back to memory cache: "+t),await Qg(n,new mc)}}else Ee(Is,"Using default OfflineComponentProvider"),await Qg(n,new s0(void 0));return n._offlineComponents}async function Mf(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(Ee(Is,"Using user provided OnlineComponentProvider"),await Dw(n,n._uninitializedComponentsProvider._online)):(Ee(Is,"Using default OnlineComponentProvider"),await Dw(n,new js))),n._onlineComponents}function u2(n){return l0(n).then(e=>e.persistence)}function Ac(n){return l0(n).then(e=>e.localStore)}function d2(n){return Mf(n).then(e=>e.remoteStore)}function c0(n){return Mf(n).then(e=>e.syncEngine)}function h2(n){return Mf(n).then(e=>e.datastore)}async function gc(n){const e=await Mf(n),t=e.eventManager;return t.onListen=SP.bind(null,e.syncEngine),t.onUnlisten=TP.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=kP.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=_P.bind(null,e.syncEngine),t}function $P(n){return n.asyncQueue.enqueue(async()=>{const e=await u2(n),t=await d2(n);return e.setNetworkEnabled(!0),function(o){const a=We(o);return a.da.delete(0),_d(a)}(t)})}function GP(n){return n.asyncQueue.enqueue(async()=>{const e=await u2(n),t=await d2(n);return e.setNetworkEnabled(!1),async function(o){const a=We(o);a.da.add(0),await Ic(a),a.Va.set("Offline")}(t)})}function KP(n,e){const t=new qn;return n.asyncQueue.enqueueAndForget(async()=>async function(o,a,c){try{const d=await function(m,g){const x=We(m);return x.persistence.runTransaction("read document","readonly",S=>x.localDocuments.getDocument(S,g))}(o,a);d.isFoundDocument()?c.resolve(d):d.isNoDocument()?c.resolve(null):c.reject(new Re(ye.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(d){const h=Ec(d,`Failed to get document '${a} from cache`);c.reject(h)}}(await Ac(n),e,t)),t.promise}function p2(n,e,t={}){const r=new qn;return n.asyncQueue.enqueueAndForget(async()=>function(a,c,d,h,m){const g=new Nf({next:S=>{g.xu(),c.enqueueAndForget(()=>Jx(a,x));const j=S.docs.has(d);!j&&S.fromCache?m.reject(new Re(ye.UNAVAILABLE,"Failed to get document because the client is offline.")):j&&S.fromCache&&h&&h.source==="server"?m.reject(new Re(ye.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):m.resolve(S)},error:S=>m.reject(S)}),x=new e0(Tc(d.path),g,{includeMetadataChanges:!0,Qa:!0});return Xx(a,x)}(await gc(n),n.asyncQueue,e,t,r)),r.promise}function QP(n,e){const t=new qn;return n.asyncQueue.enqueueAndForget(async()=>async function(o,a,c){try{const d=await Yp(o,a,!0),h=new i2(a,d.$s),m=h.tu(d.documents),g=h.applyChanges(m,!1);c.resolve(g.snapshot)}catch(d){const h=Ec(d,`Failed to execute query '${a} against cache`);c.reject(h)}}(await Ac(n),e,t)),t.promise}function f2(n,e,t={}){const r=new qn;return n.asyncQueue.enqueueAndForget(async()=>function(a,c,d,h,m){const g=new Nf({next:S=>{g.xu(),c.enqueueAndForget(()=>Jx(a,x)),S.fromCache&&h.source==="server"?m.reject(new Re(ye.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):m.resolve(S)},error:S=>m.reject(S)}),x=new e0(d,g,{includeMetadataChanges:!0,Qa:!0});return Xx(a,x)}(await gc(n),n.asyncQueue,e,t,r)),r.promise}function YP(n,e,t){const r=new qn;return n.asyncQueue.enqueueAndForget(async()=>{try{const o=await h2(n);r.resolve(async function(c,d,h){var m;const g=We(c),{request:x,yt:S,parent:j}=g_(g.serializer,VT(d),h);g.connection.Uo||delete x.parent;const T=(await g.Yo("RunAggregationQuery",g.serializer.databaseId,j,x,1)).filter(I=>!!I.result);nt(T.length===1,64727);const R=(m=T[0].result)===null||m===void 0?void 0:m.aggregateFields;return Object.keys(R).reduce((I,F)=>(I[S[F]]=R[F],I),{})}(o,e,t))}catch(o){r.reject(o)}}),r.promise}function XP(n,e){const t=new Nf(e);return n.asyncQueue.enqueueAndForget(async()=>function(o,a){We(o).Ca.add(a),a.next()}(await gc(n),t)),()=>{t.xu(),n.asyncQueue.enqueueAndForget(async()=>function(o,a){We(o).Ca.delete(a)}(await gc(n),t))}}function JP(n,e,t,r){const o=function(c,d){let h;return h=typeof c=="string"?gx().encode(c):c,function(g,x){return new VP(g,x)}(function(g,x){if(g instanceof Uint8Array)return zw(g,x);if(g instanceof ArrayBuffer)return zw(new Uint8Array(g),x);if(g instanceof ReadableStream)return g.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(h),d)}(t,Td(e));n.asyncQueue.enqueueAndForget(async()=>{WP(await c0(n),o,r)})}function ZP(n,e){return n.asyncQueue.enqueue(async()=>function(r,o){const a=We(r);return a.persistence.runTransaction("Get named query","readonly",c=>a.Ei.getNamedQuery(c,o))}(await Ac(n),e))}function eB(n,e){return n.asyncQueue.enqueue(async()=>async function(r,o){const a=We(r),c=a.indexManager,d=[];return a.persistence.runTransaction("Configure indexes","readwrite",h=>c.getFieldIndexes(h).next(m=>function(x,S,j,T,R){x=[...x],S=[...S],x.sort(j),S.sort(j);const I=x.length,F=S.length;let P=0,z=0;for(;P<F&&z<I;){const H=j(x[z],S[P]);H<0?R(x[z++]):H>0?T(S[P++]):(P++,z++)}for(;P<F;)T(S[P++]);for(;z<I;)R(x[z++])}(m,o,KA,g=>{d.push(c.addFieldIndex(h,g))},g=>{d.push(c.deleteFieldIndex(h,g))})).next(()=>ue.waitFor(d)))}(await Ac(n),e))}function tB(n,e){return n.asyncQueue.enqueue(async()=>function(r,o){We(r).Ms.fs=o}(await Ac(n),e))}function nB(n){return n.asyncQueue.enqueue(async()=>function(t){const r=We(t),o=r.indexManager;return r.persistence.runTransaction("Delete All Indexes","readwrite",a=>o.deleteAllFieldIndexes(a))}(await Ac(n)))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function m2(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nw=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function u0(n,e,t){if(!t)throw new Re(ye.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function g2(n,e,t,r){if(e===!0&&r===!0)throw new Re(ye.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function Mw(n){if(!Ve.isDocumentKey(n))throw new Re(ye.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function Lw(n){if(Ve.isDocumentKey(n))throw new Re(ye.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function Lf(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":Ke(12329,{type:typeof n})}function kt(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new Re(ye.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=Lf(n);throw new Re(ye.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function y2(n,e){if(e<=0)throw new Re(ye.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const x2="firestore.googleapis.com",Ow=!0;class Ww{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new Re(ye.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=x2,this.ssl=Ow}else this.host=e.host,this.ssl=(t=e.ssl)!==null&&t!==void 0?t:Ow;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=__;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<R_)throw new Re(ye.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}g2("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=m2((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(a){if(a.timeoutSeconds!==void 0){if(isNaN(a.timeoutSeconds))throw new Re(ye.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (must not be NaN)`);if(a.timeoutSeconds<5)throw new Re(ye.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (minimum allowed value is 5)`);if(a.timeoutSeconds>30)throw new Re(ye.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,o){return r.timeoutSeconds===o.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class jd{constructor(e,t,r,o){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=o,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Ww({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Re(ye.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Re(ye.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Ww(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new oT;switch(r.type){case"firstParty":return new VA(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new Re(ye.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const r=Nw.get(t);r&&(Ee("ComponentProvider","Removing Datastore"),Nw.delete(t),r.terminate())}(this),Promise.resolve()}}function b2(n,e,t,r={}){var o;n=kt(n,jd);const a=jo(e),c=n._getSettings(),d=Object.assign(Object.assign({},c),{emulatorOptions:n._getEmulatorOptions()}),h=`${e}:${t}`;a&&(wf(`https://${h}`),dx("Firestore",!0)),c.host!==x2&&c.host!==h&&qr("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const m=Object.assign(Object.assign({},c),{host:h,ssl:a,emulatorOptions:r});if(!bi(m,d)&&(n._setSettings(m),r.mockUserToken)){let g,x;if(typeof r.mockUserToken=="string")g=r.mockUserToken,x=Vn.MOCK_USER;else{g=Wk(r.mockUserToken,(o=n._app)===null||o===void 0?void 0:o.options.projectId);const S=r.mockUserToken.sub||r.mockUserToken.user_id;if(!S)throw new Re(ye.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");x=new Vn(S)}n._authCredentials=new LA(new iT(g,x))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hn{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Hn(this.firestore,e,this._query)}}class vn{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new yi(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new vn(this.firestore,e,this._key)}}class yi extends Hn{constructor(e,t,r){super(e,t,Tc(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new vn(this.firestore,null,new Ve(e))}withConverter(e){return new yi(this.firestore,e,this._path)}}function En(n,e,...t){if(n=Mt(n),u0("collection","path",e),n instanceof jd){const r=It.fromString(e,...t);return Lw(r),new yi(n,null,r)}{if(!(n instanceof vn||n instanceof yi))throw new Re(ye.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(It.fromString(e,...t));return Lw(r),new yi(n.firestore,null,r)}}function rB(n,e){if(n=kt(n,jd),u0("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new Re(ye.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new Hn(n,null,function(r){return new Io(It.emptyPath(),r)}(e))}function Pn(n,e,...t){if(n=Mt(n),arguments.length===1&&(e=yx.newId()),u0("doc","path",e),n instanceof jd){const r=It.fromString(e,...t);return Mw(r),new vn(n,null,new Ve(r))}{if(!(n instanceof vn||n instanceof yi))throw new Re(ye.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(It.fromString(e,...t));return Mw(r),new vn(n.firestore,n instanceof yi?n.converter:null,new Ve(r))}}function iB(n,e){return n=Mt(n),e=Mt(e),(n instanceof vn||n instanceof yi)&&(e instanceof vn||e instanceof yi)&&n.firestore===e.firestore&&n.path===e.path&&n.converter===e.converter}function d0(n,e){return n=Mt(n),e=Mt(e),n instanceof Hn&&e instanceof Hn&&n.firestore===e.firestore&&bd(n._query,e._query)&&n.converter===e.converter}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vw="AsyncQueue";class Uw{constructor(e=Promise.resolve()){this.Ju=[],this.Yu=!1,this.Zu=[],this.Xu=null,this.ec=!1,this.tc=!1,this.nc=[],this.x_=new $x(this,"async_queue_retry"),this.rc=()=>{const r=Ip();r&&Ee(Vw,"Visibility state changed to "+r.visibilityState),this.x_.b_()},this.sc=e;const t=Ip();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.rc)}get isShuttingDown(){return this.Yu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.oc(),this._c(e)}enterRestrictedMode(e){if(!this.Yu){this.Yu=!0,this.tc=e||!1;const t=Ip();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.rc)}}enqueue(e){if(this.oc(),this.Yu)return new Promise(()=>{});const t=new qn;return this._c(()=>this.Yu&&this.tc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Ju.push(e),this.ac()))}async ac(){if(this.Ju.length!==0){try{await this.Ju[0](),this.Ju.shift(),this.x_.reset()}catch(e){if(!Es(e))throw e;Ee(Vw,"Operation failed with retryable error: "+e)}this.Ju.length>0&&this.x_.y_(()=>this.ac())}}_c(e){const t=this.sc.then(()=>(this.ec=!0,e().catch(r=>{throw this.Xu=r,this.ec=!1,Sn("INTERNAL UNHANDLED ERROR: ",qw(r)),r}).then(r=>(this.ec=!1,r))));return this.sc=t,t}enqueueAfterDelay(e,t,r){this.oc(),this.nc.indexOf(e)>-1&&(t=0);const o=Yx.createAndSchedule(this,e,t,r,a=>this.uc(a));return this.Zu.push(o),o}oc(){this.Xu&&Ke(47125,{cc:qw(this.Xu)})}verifyOperationInProgress(){}async lc(){let e;do e=this.sc,await e;while(e!==this.sc)}hc(e){for(const t of this.Zu)if(t.timerId===e)return!0;return!1}Pc(e){return this.lc().then(()=>{this.Zu.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(const t of this.Zu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.lc()})}Tc(e){this.nc.push(e)}uc(e){const t=this.Zu.indexOf(e);this.Zu.splice(t,1)}}function qw(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gy(n){return function(t,r){if(typeof t!="object"||t===null)return!1;const o=t;for(const a of r)if(a in o&&typeof o[a]=="function")return!0;return!1}(n,["next","error","complete"])}class v2{constructor(){this._progressObserver={},this._taskCompletionResolver=new qn,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,r){this._progressObserver={next:e,error:t,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oB=-1;class $t extends jd{constructor(e,t,r,o){super(e,t,r,o),this.type="firestore",this._queue=new Uw,this._persistenceKey=(o==null?void 0:o.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Uw(e),this._firestoreClient=void 0,await e}}}function sB(n,e,t){t||(t=id);const r=Sc(n,"firestore");if(r.isInitialized(t)){const o=r.getImmediate({identifier:t}),a=r.getOptions(t);if(bi(a,e))return o;throw new Re(ye.FAILED_PRECONDITION,"initializeFirestore() has already been called with different options. To avoid this error, call initializeFirestore() with the same options as when it was originally called, or call getFirestore() to return the already initialized instance.")}if(e.cacheSizeBytes!==void 0&&e.localCache!==void 0)throw new Re(ye.INVALID_ARGUMENT,"cache and cacheSizeBytes cannot be specified at the same time as cacheSizeBytes willbe deprecated. Instead, specify the cache size in the cache object");if(e.cacheSizeBytes!==void 0&&e.cacheSizeBytes!==-1&&e.cacheSizeBytes<R_)throw new Re(ye.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");return e.host&&jo(e.host)&&wf(e.host),r.initialize({options:e,instanceIdentifier:t})}function Id(n,e){const t=typeof n=="object"?n:fx(),r=typeof n=="string"?n:e||id,o=Sc(t,"firestore").getImmediate({identifier:r});if(!o._initialized){const a=Mk("firestore");a&&b2(o,...a)}return o}function hn(n){if(n._terminated)throw new Re(ye.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||w2(n),n._firestoreClient}function w2(n){var e,t,r;const o=n._freezeSettings(),a=function(d,h,m,g){return new C6(d,h,m,g.host,g.ssl,g.experimentalForceLongPolling,g.experimentalAutoDetectLongPolling,m2(g.experimentalLongPollingOptions),g.useFetchStreams,g.isUsingEmulator)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,o);n._componentsProvider||!((t=o.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((r=o.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(n._componentsProvider={_offline:o.localCache._offlineComponentProvider,_online:o.localCache._onlineComponentProvider}),n._firestoreClient=new HP(n._authCredentials,n._appCheckCredentials,n._queue,a,n._componentsProvider&&function(d){const h=d==null?void 0:d._online.build();return{_offline:d==null?void 0:d._offline.build(h),_online:h}}(n._componentsProvider))}function aB(n,e){qr("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=n._freezeSettings();return S2(n,js.provider,{build:r=>new a0(r,t.cacheSizeBytes,e==null?void 0:e.forceOwnership)}),Promise.resolve()}async function lB(n){qr("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const e=n._freezeSettings();S2(n,js.provider,{build:t=>new c2(t,e.cacheSizeBytes)})}function S2(n,e,t){if((n=kt(n,$t))._firestoreClient||n._terminated)throw new Re(ye.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(n._componentsProvider||n._getSettings().localCache)throw new Re(ye.FAILED_PRECONDITION,"SDK cache is already specified.");n._componentsProvider={_online:e,_offline:t},w2(n)}function cB(n){if(n._initialized&&!n._terminated)throw new Re(ye.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new qn;return n._queue.enqueueAndForgetEvenWhileRestricted(async()=>{try{await async function(r){if(!Wi.C())return Promise.resolve();const o=r+z_;await Wi.delete(o)}(Vx(n._databaseId,n._persistenceKey)),e.resolve()}catch(t){e.reject(t)}}),e.promise}function uB(n){return function(t){const r=new qn;return t.asyncQueue.enqueueAndForget(async()=>EP(await c0(t),r)),r.promise}(hn(n=kt(n,$t)))}function dB(n){return $P(hn(n=kt(n,$t)))}function hB(n){return GP(hn(n=kt(n,$t)))}function pB(n){return SA(n.app,"firestore",n._databaseId.database),n._delete()}function fB(n,e){const t=hn(n=kt(n,$t)),r=new v2;return JP(t,n._databaseId,e,r),r}function mB(n,e){return ZP(hn(n=kt(n,$t)),e).then(t=>t?new Hn(n,null,t.query):null)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yc{constructor(e="count",t){this._internalFieldPath=t,this.type="AggregateField",this.aggregateType=e}}class k2{constructor(e,t,r){this._userDataWriter=t,this._data=r,this.type="AggregateQuerySnapshot",this.query=e}data(){return this._userDataWriter.convertObjectMap(this._data)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cs{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Cs(mn.fromBase64String(e))}catch(t){throw new Re(ye.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Cs(mn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fs{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new Re(ye.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new sn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}function gB(){return new Fs(ky)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zs{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Of{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Re(ye.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Re(ye.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return ut(this._lat,e._lat)||ut(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cd{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,o){if(r.length!==o.length)return!1;for(let a=0;a<r.length;++a)if(r[a]!==o[a])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yB=/^__.*__$/;class xB{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new Ro(e,this.data,this.fieldMask,t,this.fieldTransforms):new _c(e,this.data,t,this.fieldTransforms)}}class T2{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new Ro(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function _2(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Ke(40011,{Ic:n})}}class Wf{constructor(e,t,r,o,a,c){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=o,a===void 0&&this.Ec(),this.fieldTransforms=a||[],this.fieldMask=c||[]}get path(){return this.settings.path}get Ic(){return this.settings.Ic}dc(e){return new Wf(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Ac(e){var t;const r=(t=this.path)===null||t===void 0?void 0:t.child(e),o=this.dc({path:r,Rc:!1});return o.Vc(e),o}mc(e){var t;const r=(t=this.path)===null||t===void 0?void 0:t.child(e),o=this.dc({path:r,Rc:!1});return o.Ec(),o}fc(e){return this.dc({path:void 0,Rc:!0})}gc(e){return ef(e,this.settings.methodName,this.settings.yc||!1,this.path,this.settings.wc)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}Ec(){if(this.path)for(let e=0;e<this.path.length;e++)this.Vc(this.path.get(e))}Vc(e){if(e.length===0)throw this.gc("Document fields must not be empty");if(_2(this.Ic)&&yB.test(e))throw this.gc('Document fields cannot begin and end with "__"')}}class bB{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||Td(e)}bc(e,t,r,o=!1){return new Wf({Ic:e,methodName:t,wc:r,path:sn.emptyPath(),Rc:!1,yc:o},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Oa(n){const e=n._freezeSettings(),t=Td(n._databaseId);return new bB(n._databaseId,!!e.ignoreUndefinedProperties,t)}function Vf(n,e,t,r,o,a={}){const c=n.bc(a.merge||a.mergeFields?2:0,e,t,o);x0("Data must be an object, but it was:",c,r);const d=C2(r,c);let h,m;if(a.merge)h=new Cr(c.fieldMask),m=c.fieldTransforms;else if(a.mergeFields){const g=[];for(const x of a.mergeFields){const S=ud(e,x,t);if(!c.contains(S))throw new Re(ye.INVALID_ARGUMENT,`Field '${S}' is specified in your field mask but missing from your input data.`);E2(g,S)||g.push(S)}h=new Cr(g),m=c.fieldTransforms.filter(x=>h.covers(x.field))}else h=null,m=c.fieldTransforms;return new xB(new Jn(d),h,m)}class Rd extends zs{_toFieldTransform(e){if(e.Ic!==2)throw e.Ic===1?e.gc(`${this._methodName}() can only appear at the top level of your update data`):e.gc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Rd}}function j2(n,e,t){return new Wf({Ic:3,wc:e.settings.wc,methodName:n._methodName,Rc:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class h0 extends zs{_toFieldTransform(e){return new wd(e.path,new ac)}isEqual(e){return e instanceof h0}}class p0 extends zs{constructor(e,t){super(e),this.Sc=t}_toFieldTransform(e){const t=j2(this,e,!0),r=this.Sc.map(a=>Wa(a,t)),o=new Ia(r);return new wd(e.path,o)}isEqual(e){return e instanceof p0&&bi(this.Sc,e.Sc)}}class f0 extends zs{constructor(e,t){super(e),this.Sc=t}_toFieldTransform(e){const t=j2(this,e,!0),r=this.Sc.map(a=>Wa(a,t)),o=new Ca(r);return new wd(e.path,o)}isEqual(e){return e instanceof f0&&bi(this.Sc,e.Sc)}}class m0 extends zs{constructor(e,t){super(e),this.Dc=t}_toFieldTransform(e){const t=new lc(e.serializer,XT(e.serializer,this.Dc));return new wd(e.path,t)}isEqual(e){return e instanceof m0&&this.Dc===e.Dc}}function g0(n,e,t,r){const o=n.bc(1,e,t);x0("Data must be an object, but it was:",o,r);const a=[],c=Jn.empty();As(r,(h,m)=>{const g=Uf(e,h,t);m=Mt(m);const x=o.mc(g);if(m instanceof Rd)a.push(g);else{const S=Wa(m,x);S!=null&&(a.push(g),c.set(g,S))}});const d=new Cr(a);return new T2(c,d,o.fieldTransforms)}function y0(n,e,t,r,o,a){const c=n.bc(1,e,t),d=[ud(e,r,t)],h=[o];if(a.length%2!=0)throw new Re(ye.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let S=0;S<a.length;S+=2)d.push(ud(e,a[S])),h.push(a[S+1]);const m=[],g=Jn.empty();for(let S=d.length-1;S>=0;--S)if(!E2(m,d[S])){const j=d[S];let T=h[S];T=Mt(T);const R=c.mc(j);if(T instanceof Rd)m.push(j);else{const I=Wa(T,R);I!=null&&(m.push(j),g.set(j,I))}}const x=new Cr(m);return new T2(g,x,c.fieldTransforms)}function I2(n,e,t,r=!1){return Wa(t,n.bc(r?4:3,e))}function Wa(n,e){if(R2(n=Mt(n)))return x0("Unsupported field value:",e,n),C2(n,e);if(n instanceof zs)return function(r,o){if(!_2(o.Ic))throw o.gc(`${r._methodName}() can only be used with update() and set()`);if(!o.path)throw o.gc(`${r._methodName}() is not currently supported inside arrays`);const a=r._toFieldTransform(o);a&&o.fieldTransforms.push(a)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.Rc&&e.Ic!==4)throw e.gc("Nested arrays are not supported");return function(r,o){const a=[];let c=0;for(const d of r){let h=Wa(d,o.fc(c));h==null&&(h={nullValue:"NULL_VALUE"}),a.push(h),c++}return{arrayValue:{values:a}}}(n,e)}return function(r,o){if((r=Mt(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return XT(o.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const a=Yt.fromDate(r);return{timestampValue:cc(o.serializer,a)}}if(r instanceof Yt){const a=new Yt(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:cc(o.serializer,a)}}if(r instanceof Of)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Cs)return{bytesValue:c_(o.serializer,r._byteString)};if(r instanceof vn){const a=o.databaseId,c=r.firestore._databaseId;if(!c.isEqual(a))throw o.gc(`Document reference is for database ${c.projectId}/${c.database} but should be for database ${a.projectId}/${a.database}`);return{referenceValue:zx(r.firestore._databaseId||o.databaseId,r._key.path)}}if(r instanceof Cd)return function(c,d){return{mapValue:{fields:{[Tx]:{stringValue:_x},[ic]:{arrayValue:{values:c.toArray().map(m=>{if(typeof m!="number")throw d.gc("VectorValues must only contain numeric values.");return Rx(d.serializer,m)})}}}}}}(r,o);throw o.gc(`Unsupported field value: ${Lf(r)}`)}(n,e)}function C2(n,e){const t={};return TT(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):As(n,(r,o)=>{const a=Wa(o,e.Ac(r));a!=null&&(t[r]=a)}),{mapValue:{fields:t}}}function R2(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Yt||n instanceof Of||n instanceof Cs||n instanceof vn||n instanceof zs||n instanceof Cd)}function x0(n,e,t){if(!R2(t)||!function(o){return typeof o=="object"&&o!==null&&(Object.getPrototypeOf(o)===Object.prototype||Object.getPrototypeOf(o)===null)}(t)){const r=Lf(t);throw r==="an object"?e.gc(n+" a custom object"):e.gc(n+" "+r)}}function ud(n,e,t){if((e=Mt(e))instanceof Fs)return e._internalPath;if(typeof e=="string")return Uf(n,e);throw ef("Field path arguments must be of type string or ",n,!1,void 0,t)}const vB=new RegExp("[~\\*/\\[\\]]");function Uf(n,e,t){if(e.search(vB)>=0)throw ef(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Fs(...e.split("."))._internalPath}catch{throw ef(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function ef(n,e,t,r,o){const a=r&&!r.isEmpty(),c=o!==void 0;let d=`Function ${e}() called with invalid data`;t&&(d+=" (via `toFirestore()`)"),d+=". ";let h="";return(a||c)&&(h+=" (found",a&&(h+=` in field ${r}`),c&&(h+=` in document ${o}`),h+=")"),new Re(ye.INVALID_ARGUMENT,d+n+h)}function E2(n,e){return n.some(t=>t.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dd{constructor(e,t,r,o,a){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=o,this._converter=a}get id(){return this._key.path.lastSegment()}get ref(){return new vn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new wB(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(qf("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class wB extends dd{data(){return super.data()}}function qf(n,e){return typeof e=="string"?Uf(n,e):e instanceof Fs?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function A2(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new Re(ye.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class b0{}class Pc extends b0{}function mr(n,e,...t){let r=[];e instanceof b0&&r.push(e),r=r.concat(t),function(a){const c=a.filter(h=>h instanceof Va).length,d=a.filter(h=>h instanceof Bc).length;if(c>1||c>0&&d>0)throw new Re(ye.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const o of r)n=o._apply(n);return n}class Bc extends Pc{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new Bc(e,t,r)}_apply(e){const t=this._parse(e);return B2(e._query,t),new Hn(e.firestore,e.converter,Fy(e._query,t))}_parse(e){const t=Oa(e.firestore);return function(a,c,d,h,m,g,x){let S;if(m.isKeyField()){if(g==="array-contains"||g==="array-contains-any")throw new Re(ye.INVALID_ARGUMENT,`Invalid Query. You can't perform '${g}' queries on documentId().`);if(g==="in"||g==="not-in"){$w(x,g);const T=[];for(const R of x)T.push(Hw(h,a,R));S={arrayValue:{values:T}}}else S=Hw(h,a,x)}else g!=="in"&&g!=="not-in"&&g!=="array-contains-any"||$w(x,g),S=I2(d,c,x,g==="in"||g==="not-in");return Ct.create(m,g,S)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function An(n,e,t){const r=e,o=qf("where",n);return Bc._create(o,r,t)}class Va extends b0{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new Va(e,t)}_parse(e){const t=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return t.length===1?t[0]:Ut.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:(function(o,a){let c=o;const d=a.getFlattenedFilters();for(const h of d)B2(c,h),c=Fy(c,h)}(e._query,t),new Hn(e.firestore,e.converter,Fy(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function SB(...n){return n.forEach(e=>F2("or",e)),Va._create("or",n)}function kB(...n){return n.forEach(e=>F2("and",e)),Va._create("and",n)}class Hf extends Pc{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new Hf(e,t)}_apply(e){const t=function(o,a,c){if(o.startAt!==null)throw new Re(ye.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(o.endAt!==null)throw new Re(ye.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new ad(a,c)}(e._query,this._field,this._direction);return new Hn(e.firestore,e.converter,function(o,a){const c=o.explicitOrderBy.concat([a]);return new Io(o.path,o.collectionGroup,c,o.filters.slice(),o.limit,o.limitType,o.startAt,o.endAt)}(e._query,t))}}function tf(n,e="asc"){const t=e,r=qf("orderBy",n);return Hf._create(r,t)}class Ed extends Pc{constructor(e,t,r){super(),this.type=e,this._limit=t,this._limitType=r}static _create(e,t,r){return new Ed(e,t,r)}_apply(e){return new Hn(e.firestore,e.converter,qp(e._query,this._limit,this._limitType))}}function TB(n){return y2("limit",n),Ed._create("limit",n,"F")}function _B(n){return y2("limitToLast",n),Ed._create("limitToLast",n,"L")}class Ad extends Pc{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new Ad(e,t,r)}_apply(e){const t=P2(e,this.type,this._docOrFields,this._inclusive);return new Hn(e.firestore,e.converter,function(o,a){return new Io(o.path,o.collectionGroup,o.explicitOrderBy.slice(),o.filters.slice(),o.limit,o.limitType,a,o.endAt)}(e._query,t))}}function jB(...n){return Ad._create("startAt",n,!0)}function IB(...n){return Ad._create("startAfter",n,!1)}class Pd extends Pc{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new Pd(e,t,r)}_apply(e){const t=P2(e,this.type,this._docOrFields,this._inclusive);return new Hn(e.firestore,e.converter,function(o,a){return new Io(o.path,o.collectionGroup,o.explicitOrderBy.slice(),o.filters.slice(),o.limit,o.limitType,o.startAt,a)}(e._query,t))}}function CB(...n){return Pd._create("endBefore",n,!1)}function RB(...n){return Pd._create("endAt",n,!0)}function P2(n,e,t,r){if(t[0]=Mt(t[0]),t[0]instanceof dd)return function(a,c,d,h,m){if(!h)throw new Re(ye.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${d}().`);const g=[];for(const x of ql(a))if(x.field.isKeyField())g.push(_a(c,h.key));else{const S=h.data.field(x.field);if(jf(S))throw new Re(ye.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+x.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(S===null){const j=x.field.canonicalString();throw new Re(ye.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${j}' (used as the orderBy) does not exist.`)}g.push(S)}return new Ts(g,m)}(n._query,n.firestore._databaseId,e,t[0]._document,r);{const o=Oa(n.firestore);return function(c,d,h,m,g,x){const S=c.explicitOrderBy;if(g.length>S.length)throw new Re(ye.INVALID_ARGUMENT,`Too many arguments provided to ${m}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const j=[];for(let T=0;T<g.length;T++){const R=g[T];if(S[T].field.isKeyField()){if(typeof R!="string")throw new Re(ye.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${m}(), but got a ${typeof R}`);if(!Ix(c)&&R.indexOf("/")!==-1)throw new Re(ye.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${m}() must be a plain document ID, but '${R}' contains a slash.`);const I=c.path.child(It.fromString(R));if(!Ve.isDocumentKey(I))throw new Re(ye.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${m}() must result in a valid document path, but '${I}' is not because it contains an odd number of segments.`);const F=new Ve(I);j.push(_a(d,F))}else{const I=I2(h,m,R);j.push(I)}}return new Ts(j,x)}(n._query,n.firestore._databaseId,o,e,t,r)}}function Hw(n,e,t){if(typeof(t=Mt(t))=="string"){if(t==="")throw new Re(ye.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Ix(e)&&t.indexOf("/")!==-1)throw new Re(ye.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const r=e.path.child(It.fromString(t));if(!Ve.isDocumentKey(r))throw new Re(ye.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return _a(n,new Ve(r))}if(t instanceof vn)return _a(n,t._key);throw new Re(ye.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Lf(t)}.`)}function $w(n,e){if(!Array.isArray(n)||n.length===0)throw new Re(ye.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function B2(n,e){const t=function(o,a){for(const c of o)for(const d of c.getFlattenedFilters())if(a.indexOf(d.op)>=0)return d.op;return null}(n.filters,function(o){switch(o){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new Re(ye.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Re(ye.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}function F2(n,e){if(!(e instanceof Bc||e instanceof Va))throw new Re(ye.INVALID_ARGUMENT,`Function ${n}() requires AppliableConstraints created with a call to 'where(...)', 'or(...)', or 'and(...)'.`)}class v0{convertValue(e,t="none"){switch(Ss(e)){case 0:return null;case 1:return e.booleanValue;case 2:return un(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(ko(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Ke(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const r={};return As(e,(o,a)=>{r[o]=this.convertValue(a,t)}),r}convertVectorValue(e){var t,r,o;const a=(o=(r=(t=e.fields)===null||t===void 0?void 0:t[ic].arrayValue)===null||r===void 0?void 0:r.values)===null||o===void 0?void 0:o.map(c=>un(c.doubleValue));return new Cd(a)}convertGeoPoint(e){return new Of(un(e.latitude),un(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":const r=If(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(rd(e));default:return null}}convertTimestamp(e){const t=So(e);return new Yt(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=It.fromString(e);nt(v_(r),9688,{name:e});const o=new ws(r.get(1),r.get(3)),a=new Ve(r.popFirst(5));return o.isEqual(t)||Sn(`Document ${a} contains a document reference within a different database (${o.projectId}/${o.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),a}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $f(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}class EB extends v0{constructor(e){super(),this.firestore=e}convertBytes(e){return new Cs(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new vn(this.firestore,null,t)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AB(n){return new yc("sum",ud("sum",n))}function PB(n){return new yc("avg",ud("average",n))}function z2(){return new yc("count")}function BB(n,e){var t,r;return n instanceof yc&&e instanceof yc&&n.aggregateType===e.aggregateType&&((t=n._internalFieldPath)===null||t===void 0?void 0:t.canonicalString())===((r=e._internalFieldPath)===null||r===void 0?void 0:r.canonicalString())}function FB(n,e){return d0(n.query,e.query)&&bi(n.data(),e.data())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hs{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Ba extends dd{constructor(e,t,r,o,a,c){super(e,t,r,o,c),this._firestore=e,this._firestoreImpl=e,this.metadata=a}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new $u(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(qf("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}}class $u extends Ba{data(e={}){return super.data(e)}}class Fa{constructor(e,t,r,o){this._firestore=e,this._userDataWriter=t,this._snapshot=o,this.metadata=new hs(o.hasPendingWrites,o.fromCache),this.query=r}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new $u(this._firestore,this._userDataWriter,r.key,r,new hs(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Re(ye.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(o,a){if(o._snapshot.oldDocs.isEmpty()){let c=0;return o._snapshot.docChanges.map(d=>{const h=new $u(o._firestore,o._userDataWriter,d.doc.key,d.doc,new hs(o._snapshot.mutatedKeys.has(d.doc.key),o._snapshot.fromCache),o.query.converter);return d.doc,{type:"added",doc:h,oldIndex:-1,newIndex:c++}})}{let c=o._snapshot.oldDocs;return o._snapshot.docChanges.filter(d=>a||d.type!==3).map(d=>{const h=new $u(o._firestore,o._userDataWriter,d.doc.key,d.doc,new hs(o._snapshot.mutatedKeys.has(d.doc.key),o._snapshot.fromCache),o.query.converter);let m=-1,g=-1;return d.type!==0&&(m=c.indexOf(d.doc.key),c=c.delete(d.doc.key)),d.type!==1&&(c=c.add(d.doc),g=c.indexOf(d.doc.key)),{type:zB(d.type),doc:h,oldIndex:m,newIndex:g}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function zB(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ke(61501,{type:n})}}function DB(n,e){return n instanceof Ba&&e instanceof Ba?n._firestore===e._firestore&&n._key.isEqual(e._key)&&(n._document===null?e._document===null:n._document.isEqual(e._document))&&n._converter===e._converter:n instanceof Fa&&e instanceof Fa&&n._firestore===e._firestore&&d0(n.query,e.query)&&n.metadata.isEqual(e.metadata)&&n._snapshot.isEqual(e._snapshot)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function To(n){n=kt(n,vn);const e=kt(n.firestore,$t);return p2(hn(e),n._key).then(t=>S0(e,n,t))}class Ds extends v0{constructor(e){super(),this.firestore=e}convertBytes(e){return new Cs(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new vn(this.firestore,null,t)}}function NB(n){n=kt(n,vn);const e=kt(n.firestore,$t),t=hn(e),r=new Ds(e);return KP(t,n._key).then(o=>new Ba(e,r,n._key,o,new hs(o!==null&&o.hasLocalMutations,!0),n.converter))}function MB(n){n=kt(n,vn);const e=kt(n.firestore,$t);return p2(hn(e),n._key,{source:"server"}).then(t=>S0(e,n,t))}function Vr(n){n=kt(n,Hn);const e=kt(n.firestore,$t),t=hn(e),r=new Ds(e);return A2(n._query),f2(t,n._query).then(o=>new Fa(e,r,n,o))}function LB(n){n=kt(n,Hn);const e=kt(n.firestore,$t),t=hn(e),r=new Ds(e);return QP(t,n._query).then(o=>new Fa(e,r,n,o))}function OB(n){n=kt(n,Hn);const e=kt(n.firestore,$t),t=hn(e),r=new Ds(e);return f2(t,n._query,{source:"server"}).then(o=>new Fa(e,r,n,o))}function Bd(n,e,t){n=kt(n,vn);const r=kt(n.firestore,$t),o=$f(n.converter,e,t);return Fc(r,[Vf(Oa(r),"setDoc",n._key,o,n.converter!==null,t).toMutation(n._key,dn.none())])}function nf(n,e,t,...r){n=kt(n,vn);const o=kt(n.firestore,$t),a=Oa(o);let c;return c=typeof(e=Mt(e))=="string"||e instanceof Fs?y0(a,"updateDoc",n._key,e,t,r):g0(a,"updateDoc",n._key,e),Fc(o,[c.toMutation(n._key,dn.exists(!0))])}function rf(n){return Fc(kt(n.firestore,$t),[new jc(n._key,dn.none())])}function xs(n,e){const t=kt(n.firestore,$t),r=Pn(n),o=$f(n.converter,e);return Fc(t,[Vf(Oa(n.firestore),"addDoc",r._key,o,n.converter!==null,{}).toMutation(r._key,dn.exists(!1))]).then(()=>r)}function w0(n,...e){var t,r,o;n=Mt(n);let a={includeMetadataChanges:!1,source:"default"},c=0;typeof e[c]!="object"||Gy(e[c])||(a=e[c],c++);const d={includeMetadataChanges:a.includeMetadataChanges,source:a.source};if(Gy(e[c])){const x=e[c];e[c]=(t=x.next)===null||t===void 0?void 0:t.bind(x),e[c+1]=(r=x.error)===null||r===void 0?void 0:r.bind(x),e[c+2]=(o=x.complete)===null||o===void 0?void 0:o.bind(x)}let h,m,g;if(n instanceof vn)m=kt(n.firestore,$t),g=Tc(n._key.path),h={next:x=>{e[c]&&e[c](S0(m,n,x))},error:e[c+1],complete:e[c+2]};else{const x=kt(n,Hn);m=kt(x.firestore,$t),g=x._query;const S=new Ds(m);h={next:j=>{e[c]&&e[c](new Fa(m,S,x,j))},error:e[c+1],complete:e[c+2]},A2(n._query)}return function(S,j,T,R){const I=new Nf(R),F=new e0(j,I,T);return S.asyncQueue.enqueueAndForget(async()=>Xx(await gc(S),F)),()=>{I.xu(),S.asyncQueue.enqueueAndForget(async()=>Jx(await gc(S),F))}}(hn(m),g,d,h)}function WB(n,e){return XP(hn(n=kt(n,$t)),Gy(e)?e:{next:e})}function Fc(n,e){return function(r,o){const a=new qn;return r.asyncQueue.enqueueAndForget(async()=>jP(await c0(r),o,a)),a.promise}(hn(n),e)}function S0(n,e,t){const r=t.docs.get(e._key),o=new Ds(n);return new Ba(n,o,e._key,r,new hs(t.hasPendingWrites,t.fromCache),e.converter)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VB(n){return D2(n,{count:z2()})}function D2(n,e){const t=kt(n.firestore,$t),r=hn(t),o=kT(e,(a,c)=>new i_(c,a.aggregateType,a._internalFieldPath));return YP(r,n._query,o).then(a=>function(d,h,m){const g=new Ds(d);return new k2(h,g,m)}(t,n,a))}class UB{constructor(e){this.kind="memory",this._onlineComponentProvider=js.provider,e!=null&&e.garbageCollector?this._offlineComponentProvider=e.garbageCollector._offlineComponentProvider:this._offlineComponentProvider={build:()=>new s0(void 0)}}toJSON(){return{kind:this.kind}}}class qB{constructor(e){let t;this.kind="persistent",e!=null&&e.tabManager?(e.tabManager._initialize(e),t=e.tabManager):(t=N2(void 0),t._initialize(e)),this._onlineComponentProvider=t._onlineComponentProvider,this._offlineComponentProvider=t._offlineComponentProvider}toJSON(){return{kind:this.kind}}}class HB{constructor(){this.kind="memoryEager",this._offlineComponentProvider=mc.provider}toJSON(){return{kind:this.kind}}}class $B{constructor(e){this.kind="memoryLru",this._offlineComponentProvider={build:()=>new s0(e)}}toJSON(){return{kind:this.kind}}}function GB(){return new HB}function KB(n){return new $B(n==null?void 0:n.cacheSizeBytes)}function QB(n){return new UB(n)}function YB(n){return new qB(n)}class XB{constructor(e){this.forceOwnership=e,this.kind="persistentSingleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=js.provider,this._offlineComponentProvider={build:t=>new a0(t,e==null?void 0:e.cacheSizeBytes,this.forceOwnership)}}}class JB{constructor(){this.kind="PersistentMultipleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=js.provider,this._offlineComponentProvider={build:t=>new c2(t,e==null?void 0:e.cacheSizeBytes)}}}function N2(n){return new XB(n==null?void 0:n.forceOwnership)}function ZB(){return new JB}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eF={maxAttempts:5};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M2{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=Oa(e)}set(e,t,r){this._verifyNotCommitted();const o=ps(e,this._firestore),a=$f(o.converter,t,r),c=Vf(this._dataReader,"WriteBatch.set",o._key,a,o.converter!==null,r);return this._mutations.push(c.toMutation(o._key,dn.none())),this}update(e,t,r,...o){this._verifyNotCommitted();const a=ps(e,this._firestore);let c;return c=typeof(t=Mt(t))=="string"||t instanceof Fs?y0(this._dataReader,"WriteBatch.update",a._key,t,r,o):g0(this._dataReader,"WriteBatch.update",a._key,t),this._mutations.push(c.toMutation(a._key,dn.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=ps(e,this._firestore);return this._mutations=this._mutations.concat(new jc(t._key,dn.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new Re(ye.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function ps(n,e){if((n=Mt(n)).firestore!==e)throw new Re(ye.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tF{constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=Oa(e)}get(e){const t=ps(e,this._firestore),r=new EB(this._firestore);return this._transaction.lookup([t._key]).then(o=>{if(!o||o.length!==1)return Ke(24041);const a=o[0];if(a.isFoundDocument())return new dd(this._firestore,r,a.key,a,t.converter);if(a.isNoDocument())return new dd(this._firestore,r,t._key,null,t.converter);throw Ke(18433,{doc:a})})}set(e,t,r){const o=ps(e,this._firestore),a=$f(o.converter,t,r),c=Vf(this._dataReader,"Transaction.set",o._key,a,o.converter!==null,r);return this._transaction.set(o._key,c),this}update(e,t,r,...o){const a=ps(e,this._firestore);let c;return c=typeof(t=Mt(t))=="string"||t instanceof Fs?y0(this._dataReader,"Transaction.update",a._key,t,r,o):g0(this._dataReader,"Transaction.update",a._key,t),this._transaction.update(a._key,c),this}delete(e){const t=ps(e,this._firestore);return this._transaction.delete(t._key),this}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L2 extends tF{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=ps(e,this._firestore),r=new Ds(this._firestore);return super.get(e).then(o=>new Ba(this._firestore,r,t._key,o._document,new hs(!1,!1),t.converter))}}function nF(n,e,t){n=kt(n,$t);const r=Object.assign(Object.assign({},eF),t);return function(a){if(a.maxAttempts<1)throw new Re(ye.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(a,c,d){const h=new qn;return a.asyncQueue.enqueueAndForget(async()=>{const m=await h2(a);new qP(a.asyncQueue,m,d,c,h).Wu()}),h.promise}(hn(n),o=>e(new L2(n,o)),r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rF(){return new Rd("deleteField")}function k0(){return new h0("serverTimestamp")}function iF(...n){return new p0("arrayUnion",n)}function oF(...n){return new f0("arrayRemove",n)}function sF(n){return new m0("increment",n)}function aF(n){return new Cd(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lF(n){return hn(n=kt(n,$t)),new M2(n,e=>Fc(n,e))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cF(n,e){const t=hn(n=kt(n,$t));if(!t._uninitializedComponentsProvider||t._uninitializedComponentsProvider._offline.kind==="memory")return qr("Cannot enable indexes when persistence is disabled"),Promise.resolve();const r=function(a){const c=typeof a=="string"?function(m){try{return JSON.parse(m)}catch(g){throw new Re(ye.INVALID_ARGUMENT,"Failed to parse JSON: "+(g==null?void 0:g.message))}}(a):a,d=[];if(Array.isArray(c.indexes))for(const h of c.indexes){const m=Gw(h,"collectionGroup"),g=[];if(Array.isArray(h.fields))for(const x of h.fields){const S=Uf("setIndexConfiguration",Gw(x,"fieldPath"));x.arrayConfig==="CONTAINS"?g.push(new ba(S,2)):x.order==="ASCENDING"?g.push(new ba(S,0)):x.order==="DESCENDING"&&g.push(new ba(S,1))}d.push(new Jl(Jl.UNKNOWN_ID,m,g,Zl.empty()))}return d}(e);return eB(t,r)}function Gw(n,e){if(typeof n[e]!="string")throw new Re(ye.INVALID_ARGUMENT,"Missing string value for: "+e);return n[e]}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O2{constructor(e){this._firestore=e,this.type="PersistentCacheIndexManager"}}function uF(n){var e;n=kt(n,$t);const t=Kw.get(n);if(t)return t;if(((e=hn(n)._uninitializedComponentsProvider)===null||e===void 0?void 0:e._offline.kind)!=="persistent")return null;const r=new O2(n);return Kw.set(n,r),r}function dF(n){W2(n,!0)}function hF(n){W2(n,!1)}function pF(n){nB(hn(n._firestore)).then(e=>Ee("deleting all persistent cache indexes succeeded")).catch(e=>qr("deleting all persistent cache indexes failed",e))}function W2(n,e){tB(hn(n._firestore),e).then(t=>Ee(`setting persistent cache index auto creation isEnabled=${e} succeeded`)).catch(t=>qr(`setting persistent cache index auto creation isEnabled=${e} failed`,t))}const Kw=new WeakMap;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fF(n){var e;const t=(e=hn(kt(n.firestore,$t))._onlineComponents)===null||e===void 0?void 0:e.datastore.serializer;return t===void 0?null:Af(t,ar(n._query)).gt}function mF(n,e){var t;const r=kT(e,(a,c)=>new i_(c,a.aggregateType,a._internalFieldPath)),o=(t=hn(kt(n.firestore,$t))._onlineComponents)===null||t===void 0?void 0:t.datastore.serializer;return o===void 0?null:g_(o,VT(n._query),r,!0).request}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gF{constructor(){throw new Error("instances of this class should not be created")}static onExistenceFilterMismatch(e){return T0.instance.onExistenceFilterMismatch(e)}}class T0{constructor(){this.vc=new Map}static get instance(){return dp||(dp=new T0,function(t){if(Hp)throw new Error("a TestingHooksSpi instance is already set");Hp=t}(dp)),dp}ht(e){this.vc.forEach(t=>t(e))}onExistenceFilterMismatch(e){const t=Symbol(),r=this.vc;return r.set(t,e),()=>r.delete(t)}}let dp=null;(function(e,t=!0){(function(o){kc=o})(La),Ta(new bs("firestore",(r,{instanceIdentifier:o,options:a})=>{const c=r.getProvider("app").getImmediate(),d=new $t(new OA(r.getProvider("auth-internal")),new UA(c,r.getProvider("app-check-internal")),function(m,g){if(!Object.prototype.hasOwnProperty.apply(m.options,["projectId"]))throw new Re(ye.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new ws(m.options.projectId,g)}(c,o),c);return a=Object.assign({useFetchStreams:t},a),d._setSettings(a),d},"PUBLIC").setMultipleInstances(!0)),Oi(_1,j1,e),Oi(_1,j1,"esm2017")})();const of=Object.freeze(Object.defineProperty({__proto__:null,AbstractUserDataWriter:v0,AggregateField:yc,AggregateQuerySnapshot:k2,Bytes:Cs,CACHE_SIZE_UNLIMITED:oB,CollectionReference:yi,DocumentReference:vn,DocumentSnapshot:Ba,FieldPath:Fs,FieldValue:zs,Firestore:$t,FirestoreError:Re,GeoPoint:Of,LoadBundleTask:v2,PersistentCacheIndexManager:O2,Query:Hn,QueryCompositeFilterConstraint:Va,QueryConstraint:Pc,QueryDocumentSnapshot:$u,QueryEndAtConstraint:Pd,QueryFieldFilterConstraint:Bc,QueryLimitConstraint:Ed,QueryOrderByConstraint:Hf,QuerySnapshot:Fa,QueryStartAtConstraint:Ad,SnapshotMetadata:hs,Timestamp:Yt,Transaction:L2,VectorValue:Cd,WriteBatch:M2,_AutoId:yx,_ByteString:mn,_DatabaseId:ws,_DocumentKey:Ve,_EmptyAppCheckTokenProvider:qA,_EmptyAuthCredentialsProvider:oT,_FieldPath:sn,_TestingHooks:gF,_cast:kt,_debugAssert:MA,_internalAggregationQueryToProtoRunAggregationQueryRequest:mF,_internalQueryToProtoQueryTarget:fF,_isBase64Available:j6,_logWarn:qr,_validateIsNotUsedTogether:g2,addDoc:xs,aggregateFieldEqual:BB,aggregateQuerySnapshotEqual:FB,and:kB,arrayRemove:oF,arrayUnion:iF,average:PB,clearIndexedDbPersistence:cB,collection:En,collectionGroup:rB,connectFirestoreEmulator:b2,count:z2,deleteAllPersistentCacheIndexes:pF,deleteDoc:rf,deleteField:rF,disableNetwork:hB,disablePersistentCacheIndexAutoCreation:hF,doc:Pn,documentId:gB,enableIndexedDbPersistence:aB,enableMultiTabIndexedDbPersistence:lB,enableNetwork:dB,enablePersistentCacheIndexAutoCreation:dF,endAt:RB,endBefore:CB,ensureFirestoreConfigured:hn,executeWrite:Fc,getAggregateFromServer:D2,getCountFromServer:VB,getDoc:To,getDocFromCache:NB,getDocFromServer:MB,getDocs:Vr,getDocsFromCache:LB,getDocsFromServer:OB,getFirestore:Id,getPersistentCacheIndexManager:uF,increment:sF,initializeFirestore:sB,limit:TB,limitToLast:_B,loadBundle:fB,memoryEagerGarbageCollector:GB,memoryLocalCache:QB,memoryLruGarbageCollector:KB,namedQuery:mB,onSnapshot:w0,onSnapshotsInSync:WB,or:SB,orderBy:tf,persistentLocalCache:YB,persistentMultipleTabManager:ZB,persistentSingleTabManager:N2,query:mr,queryEqual:d0,refEqual:iB,runTransaction:nF,serverTimestamp:k0,setDoc:Bd,setIndexConfiguration:cF,setLogLevel:NA,snapshotEqual:DB,startAfter:IB,startAt:jB,sum:AB,terminate:pB,updateDoc:nf,vector:aF,waitForPendingWrites:uB,where:An,writeBatch:lF},Symbol.toStringTag,{value:"Module"}));function _0(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(n);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(n,r[o])&&(t[r[o]]=n[r[o]]);return t}function V2(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const U2=V2,q2=new fd("auth","Firebase",V2());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sf=new hx("@firebase/auth");function yF(n,...e){sf.logLevel<=jt.WARN&&sf.warn(`Auth (${La}): ${n}`,...e)}function Cp(n,...e){sf.logLevel<=jt.ERROR&&sf.error(`Auth (${La}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ti(n,...e){throw I0(n,...e)}function xi(n,...e){return I0(n,...e)}function j0(n,e,t){const r=Object.assign(Object.assign({},U2()),{[e]:t});return new fd("auth","Firebase",r).create(e,{appName:n.name})}function bo(n){return j0(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function xF(n,e,t){const r=t;if(!(e instanceof r))throw r.name!==e.constructor.name&&ti(n,"argument-error"),j0(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function I0(n,...e){if(typeof n!="string"){const t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return q2.create(n,...e)}function ht(n,e,...t){if(!n)throw I0(e,...t)}function yo(n){const e="INTERNAL ASSERTION FAILED: "+n;throw Cp(e),new Error(e)}function _o(n,e){n||yo(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ky(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function bF(){return Qw()==="http:"||Qw()==="https:"}function Qw(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vF(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(bF()||mE()||"connection"in navigator)?navigator.onLine:!0}function wF(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fd{constructor(e,t){this.shortDelay=e,this.longDelay=t,_o(t>e,"Short delay should be less than long delay!"),this.isMobile=pE()||gE()}get(){return vF()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function C0(n,e){_o(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H2{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;yo("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;yo("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;yo("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SF={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kF=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],TF=new Fd(3e4,6e4);function Ao(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}async function Gi(n,e,t,r,o={}){return $2(n,o,async()=>{let a={},c={};r&&(e==="GET"?c=r:a={body:JSON.stringify(r)});const d=md(Object.assign({key:n.config.apiKey},c)).slice(1),h=await n._getAdditionalHeaders();h["Content-Type"]="application/json",n.languageCode&&(h["X-Firebase-Locale"]=n.languageCode);const m=Object.assign({method:e,headers:h},a);return fE()||(m.referrerPolicy="no-referrer"),n.emulatorConfig&&jo(n.emulatorConfig.host)&&(m.credentials="include"),H2.fetch()(await G2(n,n.config.apiHost,t,d),m)})}async function $2(n,e,t){n._canInitEmulator=!1;const r=Object.assign(Object.assign({},SF),e);try{const o=new jF(n),a=await Promise.race([t(),o.promise]);o.clearNetworkTimeout();const c=await a.json();if("needConfirmation"in c)throw hp(n,"account-exists-with-different-credential",c);if(a.ok&&!("errorMessage"in c))return c;{const d=a.ok?c.errorMessage:c.error.message,[h,m]=d.split(" : ");if(h==="FEDERATED_USER_ID_ALREADY_LINKED")throw hp(n,"credential-already-in-use",c);if(h==="EMAIL_EXISTS")throw hp(n,"email-already-in-use",c);if(h==="USER_DISABLED")throw hp(n,"user-disabled",c);const g=r[h]||h.toLowerCase().replace(/[_\s]+/g,"-");if(m)throw j0(n,g,m);ti(n,g)}}catch(o){if(o instanceof $i)throw o;ti(n,"network-request-failed",{message:String(o)})}}async function zd(n,e,t,r,o={}){const a=await Gi(n,e,t,r,o);return"mfaPendingCredential"in a&&ti(n,"multi-factor-auth-required",{_serverResponse:a}),a}async function G2(n,e,t,r){const o=`${e}${t}?${r}`,a=n,c=a.config.emulator?C0(n.config,o):`${n.config.apiScheme}://${o}`;return kF.includes(t)&&(await a._persistenceManagerAvailable,a._getPersistenceType()==="COOKIE")?a._getPersistence()._getFinalTarget(c).toString():c}function _F(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class jF{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(xi(this.auth,"network-request-failed")),TF.get())})}}function hp(n,e,t){const r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);const o=xi(n,e,r);return o.customData._tokenResponse=t,o}function Yw(n){return n!==void 0&&n.enterprise!==void 0}class IF{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return _F(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function CF(n,e){return Gi(n,"GET","/v2/recaptchaConfig",Ao(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function RF(n,e){return Gi(n,"POST","/v1/accounts:delete",e)}async function af(n,e){return Gi(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gu(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function K2(n,e=!1){const t=Mt(n),r=await t.getIdToken(e),o=R0(r);ht(o&&o.exp&&o.auth_time&&o.iat,t.auth,"internal-error");const a=typeof o.firebase=="object"?o.firebase:void 0,c=a==null?void 0:a.sign_in_provider;return{claims:o,token:r,authTime:Gu(Yg(o.auth_time)),issuedAtTime:Gu(Yg(o.iat)),expirationTime:Gu(Yg(o.exp)),signInProvider:c||null,signInSecondFactor:(a==null?void 0:a.sign_in_second_factor)||null}}function Yg(n){return Number(n)*1e3}function R0(n){const[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return Cp("JWT malformed, contained fewer than 3 sections"),null;try{const o=zk(t);return o?JSON.parse(o):(Cp("Failed to decode base64 JWT payload"),null)}catch(o){return Cp("Caught error parsing JWT payload as JSON",o==null?void 0:o.toString()),null}}function Xw(n){const e=R0(n);return ht(e,"internal-error"),ht(typeof e.exp<"u","internal-error"),ht(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xc(n,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof $i&&EF(r)&&n.auth.currentUser===n&&await n.auth.signOut(),r}}function EF({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AF{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const o=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,o)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qy{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Gu(this.lastLoginAt),this.creationTime=Gu(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function lf(n){var e;const t=n.auth,r=await n.getIdToken(),o=await xc(n,af(t,{idToken:r}));ht(o==null?void 0:o.users.length,t,"internal-error");const a=o.users[0];n._notifyReloadListener(a);const c=!((e=a.providerUserInfo)===null||e===void 0)&&e.length?Y2(a.providerUserInfo):[],d=PF(n.providerData,c),h=n.isAnonymous,m=!(n.email&&a.passwordHash)&&!(d!=null&&d.length),g=h?m:!1,x={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:d,metadata:new Qy(a.createdAt,a.lastLoginAt),isAnonymous:g};Object.assign(n,x)}async function Q2(n){const e=Mt(n);await lf(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function PF(n,e){return[...n.filter(r=>!e.some(o=>o.providerId===r.providerId)),...e]}function Y2(n){return n.map(e=>{var{providerId:t}=e,r=_0(e,["providerId"]);return{providerId:t,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function BF(n,e){const t=await $2(n,{},async()=>{const r=md({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:o,apiKey:a}=n.config,c=await G2(n,o,"/v1/token",`key=${a}`),d=await n._getAdditionalHeaders();d["Content-Type"]="application/x-www-form-urlencoded";const h={method:"POST",headers:d,body:r};return n.emulatorConfig&&jo(n.emulatorConfig.host)&&(h.credentials="include"),H2.fetch()(c,h)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function FF(n,e){return Gi(n,"POST","/v2/accounts:revokeToken",Ao(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $l{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){ht(e.idToken,"internal-error"),ht(typeof e.idToken<"u","internal-error"),ht(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Xw(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){ht(e.length!==0,"internal-error");const t=Xw(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(ht(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:r,refreshToken:o,expiresIn:a}=await BF(e,t);this.updateTokensAndExpiration(r,o,Number(a))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){const{refreshToken:r,accessToken:o,expirationTime:a}=t,c=new $l;return r&&(ht(typeof r=="string","internal-error",{appName:e}),c.refreshToken=r),o&&(ht(typeof o=="string","internal-error",{appName:e}),c.accessToken=o),a&&(ht(typeof a=="number","internal-error",{appName:e}),c.expirationTime=a),c}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new $l,this.toJSON())}_performRefresh(){return yo("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ss(n,e){ht(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class gi{constructor(e){var{uid:t,auth:r,stsTokenManager:o}=e,a=_0(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new AF(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=r,this.stsTokenManager=o,this.accessToken=o.accessToken,this.displayName=a.displayName||null,this.email=a.email||null,this.emailVerified=a.emailVerified||!1,this.phoneNumber=a.phoneNumber||null,this.photoURL=a.photoURL||null,this.isAnonymous=a.isAnonymous||!1,this.tenantId=a.tenantId||null,this.providerData=a.providerData?[...a.providerData]:[],this.metadata=new Qy(a.createdAt||void 0,a.lastLoginAt||void 0)}async getIdToken(e){const t=await xc(this,this.stsTokenManager.getToken(this.auth,e));return ht(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return K2(this,e)}reload(){return Q2(this)}_assign(e){this!==e&&(ht(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new gi(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){ht(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await lf(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(jr(this.auth.app))return Promise.reject(bo(this.auth));const e=await this.getIdToken();return await xc(this,RF(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var r,o,a,c,d,h,m,g;const x=(r=t.displayName)!==null&&r!==void 0?r:void 0,S=(o=t.email)!==null&&o!==void 0?o:void 0,j=(a=t.phoneNumber)!==null&&a!==void 0?a:void 0,T=(c=t.photoURL)!==null&&c!==void 0?c:void 0,R=(d=t.tenantId)!==null&&d!==void 0?d:void 0,I=(h=t._redirectEventId)!==null&&h!==void 0?h:void 0,F=(m=t.createdAt)!==null&&m!==void 0?m:void 0,P=(g=t.lastLoginAt)!==null&&g!==void 0?g:void 0,{uid:z,emailVerified:H,isAnonymous:J,providerData:O,stsTokenManager:L}=t;ht(z&&L,e,"internal-error");const C=$l.fromJSON(this.name,L);ht(typeof z=="string",e,"internal-error"),ss(x,e.name),ss(S,e.name),ht(typeof H=="boolean",e,"internal-error"),ht(typeof J=="boolean",e,"internal-error"),ss(j,e.name),ss(T,e.name),ss(R,e.name),ss(I,e.name),ss(F,e.name),ss(P,e.name);const A=new gi({uid:z,auth:e,email:S,emailVerified:H,displayName:x,isAnonymous:J,photoURL:T,phoneNumber:j,tenantId:R,stsTokenManager:C,createdAt:F,lastLoginAt:P});return O&&Array.isArray(O)&&(A.providerData=O.map(D=>Object.assign({},D))),I&&(A._redirectEventId=I),A}static async _fromIdTokenResponse(e,t,r=!1){const o=new $l;o.updateFromServerResponse(t);const a=new gi({uid:t.localId,auth:e,stsTokenManager:o,isAnonymous:r});return await lf(a),a}static async _fromGetAccountInfoResponse(e,t,r){const o=t.users[0];ht(o.localId!==void 0,"internal-error");const a=o.providerUserInfo!==void 0?Y2(o.providerUserInfo):[],c=!(o.email&&o.passwordHash)&&!(a!=null&&a.length),d=new $l;d.updateFromIdToken(r);const h=new gi({uid:o.localId,auth:e,stsTokenManager:d,isAnonymous:c}),m={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:a,metadata:new Qy(o.createdAt,o.lastLoginAt),isAnonymous:!(o.email&&o.passwordHash)&&!(a!=null&&a.length)};return Object.assign(h,m),h}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jw=new Map;function xo(n){_o(n instanceof Function,"Expected a class definition");let e=Jw.get(n);return e?(_o(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,Jw.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X2{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}X2.type="NONE";const Yy=X2;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rp(n,e,t){return`firebase:${n}:${e}:${t}`}class Gl{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;const{config:o,name:a}=this.auth;this.fullUserKey=Rp(this.userKey,o.apiKey,a),this.fullPersistenceKey=Rp("persistence",o.apiKey,a),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await af(this.auth,{idToken:e}).catch(()=>{});return t?gi._fromGetAccountInfoResponse(this.auth,t,e):null}return gi._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new Gl(xo(Yy),e,r);const o=(await Promise.all(t.map(async m=>{if(await m._isAvailable())return m}))).filter(m=>m);let a=o[0]||xo(Yy);const c=Rp(r,e.config.apiKey,e.name);let d=null;for(const m of t)try{const g=await m._get(c);if(g){let x;if(typeof g=="string"){const S=await af(e,{idToken:g}).catch(()=>{});if(!S)break;x=await gi._fromGetAccountInfoResponse(e,S,g)}else x=gi._fromJSON(e,g);m!==a&&(d=x),a=m;break}}catch{}const h=o.filter(m=>m._shouldAllowMigration);return!a._shouldAllowMigration||!h.length?new Gl(a,e,r):(a=h[0],d&&await a._set(c,d.toJSON()),await Promise.all(t.map(async m=>{if(m!==a)try{await m._remove(c)}catch{}})),new Gl(a,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zw(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(tj(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(J2(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(rj(e))return"Blackberry";if(ij(e))return"Webos";if(Z2(e))return"Safari";if((e.includes("chrome/")||ej(e))&&!e.includes("edge/"))return"Chrome";if(nj(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function J2(n=Fn()){return/firefox\//i.test(n)}function Z2(n=Fn()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function ej(n=Fn()){return/crios\//i.test(n)}function tj(n=Fn()){return/iemobile/i.test(n)}function nj(n=Fn()){return/android/i.test(n)}function rj(n=Fn()){return/blackberry/i.test(n)}function ij(n=Fn()){return/webos/i.test(n)}function E0(n=Fn()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function zF(n=Fn()){var e;return E0(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function DF(){return yE()&&document.documentMode===10}function oj(n=Fn()){return E0(n)||nj(n)||ij(n)||rj(n)||/windows phone/i.test(n)||tj(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sj(n,e=[]){let t;switch(n){case"Browser":t=Zw(Fn());break;case"Worker":t=`${Zw(Fn())}-${n}`;break;default:t=n}const r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${La}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NF{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const r=a=>new Promise((c,d)=>{try{const h=e(a);c(h)}catch(h){d(h)}});r.onAbort=t,this.queue.push(r);const o=this.queue.length-1;return()=>{this.queue[o]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(const o of t)try{o()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function MF(n,e={}){return Gi(n,"GET","/v2/passwordPolicy",Ao(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LF=6;class OF{constructor(e){var t,r,o,a;const c=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=c.minPasswordLength)!==null&&t!==void 0?t:LF,c.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=c.maxPasswordLength),c.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=c.containsLowercaseCharacter),c.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=c.containsUppercaseCharacter),c.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=c.containsNumericCharacter),c.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=c.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(o=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&o!==void 0?o:"",this.forceUpgradeOnSignin=(a=e.forceUpgradeOnSignin)!==null&&a!==void 0?a:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,r,o,a,c,d;const h={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,h),this.validatePasswordCharacterOptions(e,h),h.isValid&&(h.isValid=(t=h.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),h.isValid&&(h.isValid=(r=h.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),h.isValid&&(h.isValid=(o=h.containsLowercaseLetter)!==null&&o!==void 0?o:!0),h.isValid&&(h.isValid=(a=h.containsUppercaseLetter)!==null&&a!==void 0?a:!0),h.isValid&&(h.isValid=(c=h.containsNumericCharacter)!==null&&c!==void 0?c:!0),h.isValid&&(h.isValid=(d=h.containsNonAlphanumericCharacter)!==null&&d!==void 0?d:!0),h}validatePasswordLengthOptions(e,t){const r=this.customStrengthOptions.minPasswordLength,o=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),o&&(t.meetsMaxPasswordLength=e.length<=o)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let o=0;o<e.length;o++)r=e.charAt(o),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,o,a){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=o)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WF{constructor(e,t,r,o){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=o,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new eS(this),this.idTokenSubscription=new eS(this),this.beforeStateQueue=new NF(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=q2,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=o.sdkClientVersion,this._persistenceManagerAvailable=new Promise(a=>this._resolvePersistenceManagerAvailable=a)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=xo(t)),this._initializationPromise=this.queue(async()=>{var r,o,a;if(!this._deleted&&(this.persistenceManager=await Gl.create(this,e),(r=this._resolvePersistenceManagerAvailable)===null||r===void 0||r.call(this),!this._deleted)){if(!((o=this._popupRedirectResolver)===null||o===void 0)&&o._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((a=this.currentUser)===null||a===void 0?void 0:a.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await af(this,{idToken:e}),r=await gi._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(jr(this.app)){const c=this.app.settings.authIdToken;return c?new Promise(d=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(c).then(d,d))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let o=r,a=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const c=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,d=o==null?void 0:o._redirectEventId,h=await this.tryRedirectSignIn(e);(!c||c===d)&&(h!=null&&h.user)&&(o=h.user,a=!0)}if(!o)return this.directlySetCurrentUser(null);if(!o._redirectEventId){if(a)try{await this.beforeStateQueue.runMiddleware(o)}catch(c){o=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(c))}return o?this.reloadAndSetCurrentUserOrClear(o):this.directlySetCurrentUser(null)}return ht(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===o._redirectEventId?this.directlySetCurrentUser(o):this.reloadAndSetCurrentUserOrClear(o)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await lf(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=wF()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(jr(this.app))return Promise.reject(bo(this));const t=e?Mt(e):null;return t&&ht(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&ht(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return jr(this.app)?Promise.reject(bo(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return jr(this.app)?Promise.reject(bo(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(xo(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await MF(this),t=new OF(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new fd("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),await FF(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,t){const r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&xo(e)||this._popupRedirectResolver;ht(t,this,"argument-error"),this.redirectPersistenceManager=await Gl.create(this,[xo(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,r;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,o){if(this._deleted)return()=>{};const a=typeof t=="function"?t:t.next.bind(t);let c=!1;const d=this._isInitialized?Promise.resolve():this._initializationPromise;if(ht(d,this,"internal-error"),d.then(()=>{c||a(this.currentUser)}),typeof t=="function"){const h=e.addObserver(t,r,o);return()=>{c=!0,h()}}else{const h=e.addObserver(t);return()=>{c=!0,h()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return ht(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=sj(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(t["X-Firebase-Client"]=r);const o=await this._getAppCheckToken();return o&&(t["X-Firebase-AppCheck"]=o),t}async _getAppCheckToken(){var e;if(jr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const t=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return t!=null&&t.error&&yF(`Error while retrieving App Check token: ${t.error}`),t==null?void 0:t.token}}function Ki(n){return Mt(n)}class eS{constructor(e){this.auth=e,this.observer=null,this.addObserver=kE(t=>this.observer=t)}get next(){return ht(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Gf={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function VF(n){Gf=n}function aj(n){return Gf.loadJS(n)}function UF(){return Gf.recaptchaEnterpriseScript}function qF(){return Gf.gapiScript}function HF(n){return`__${n}${Math.floor(Math.random()*1e6)}`}class $F{constructor(){this.enterprise=new GF}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class GF{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const KF="recaptcha-enterprise",lj="NO_RECAPTCHA";class QF{constructor(e){this.type=KF,this.auth=Ki(e)}async verify(e="verify",t=!1){async function r(a){if(!t){if(a.tenantId==null&&a._agentRecaptchaConfig!=null)return a._agentRecaptchaConfig.siteKey;if(a.tenantId!=null&&a._tenantRecaptchaConfigs[a.tenantId]!==void 0)return a._tenantRecaptchaConfigs[a.tenantId].siteKey}return new Promise(async(c,d)=>{CF(a,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(h=>{if(h.recaptchaKey===void 0)d(new Error("recaptcha Enterprise site key undefined"));else{const m=new IF(h);return a.tenantId==null?a._agentRecaptchaConfig=m:a._tenantRecaptchaConfigs[a.tenantId]=m,c(m.siteKey)}}).catch(h=>{d(h)})})}function o(a,c,d){const h=window.grecaptcha;Yw(h)?h.enterprise.ready(()=>{h.enterprise.execute(a,{action:e}).then(m=>{c(m)}).catch(()=>{c(lj)})}):d(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new $F().execute("siteKey",{action:"verify"}):new Promise((a,c)=>{r(this.auth).then(d=>{if(!t&&Yw(window.grecaptcha))o(d,a,c);else{if(typeof window>"u"){c(new Error("RecaptchaVerifier is only supported in browser"));return}let h=UF();h.length!==0&&(h+=d),aj(h).then(()=>{o(d,a,c)}).catch(m=>{c(m)})}}).catch(d=>{c(d)})})}}async function tS(n,e,t,r=!1,o=!1){const a=new QF(n);let c;if(o)c=lj;else try{c=await a.verify(t)}catch{c=await a.verify(t,!0)}const d=Object.assign({},e);if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in d){const h=d.phoneEnrollmentInfo.phoneNumber,m=d.phoneEnrollmentInfo.recaptchaToken;Object.assign(d,{phoneEnrollmentInfo:{phoneNumber:h,recaptchaToken:m,captchaResponse:c,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in d){const h=d.phoneSignInInfo.recaptchaToken;Object.assign(d,{phoneSignInInfo:{recaptchaToken:h,captchaResponse:c,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return d}return r?Object.assign(d,{captchaResp:c}):Object.assign(d,{captchaResponse:c}),Object.assign(d,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(d,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),d}async function cf(n,e,t,r,o){var a;if(!((a=n._getRecaptchaConfig())===null||a===void 0)&&a.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const c=await tS(n,e,t,t==="getOobCode");return r(n,c)}else return r(n,e).catch(async c=>{if(c.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const d=await tS(n,e,t,t==="getOobCode");return r(n,d)}else return Promise.reject(c)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cj(n,e){const t=Sc(n,"auth");if(t.isInitialized()){const o=t.getImmediate(),a=t.getOptions();if(bi(a,e??{}))return o;ti(o,"already-initialized")}return t.initialize({options:e})}function YF(n,e){const t=(e==null?void 0:e.persistence)||[],r=(Array.isArray(t)?t:[t]).map(xo);e!=null&&e.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function uj(n,e,t){const r=Ki(n);ht(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const o=!1,a=dj(e),{host:c,port:d}=XF(e),h=d===null?"":`:${d}`,m={url:`${a}//${c}${h}/`},g=Object.freeze({host:c,port:d,protocol:a.replace(":",""),options:Object.freeze({disableWarnings:o})});if(!r._canInitEmulator){ht(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),ht(bi(m,r.config.emulator)&&bi(g,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=m,r.emulatorConfig=g,r.settings.appVerificationDisabledForTesting=!0,jo(c)?(wf(`${a}//${c}${h}`),dx("Auth",!0)):JF()}function dj(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function XF(n){const e=dj(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const r=t[2].split("@").pop()||"",o=/^(\[[^\]]+\])(:|$)/.exec(r);if(o){const a=o[1];return{host:a,port:nS(r.substr(a.length+1))}}else{const[a,c]=r.split(":");return{host:a,port:nS(c)}}}function nS(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function JF(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kf{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return yo("not implemented")}_getIdTokenResponse(e){return yo("not implemented")}_linkToIdToken(e,t){return yo("not implemented")}_getReauthenticationResolver(e){return yo("not implemented")}}async function ZF(n,e){return Gi(n,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function e4(n,e){return zd(n,"POST","/v1/accounts:signInWithPassword",Ao(n,e))}async function t4(n,e){return Gi(n,"POST","/v1/accounts:sendOobCode",Ao(n,e))}async function n4(n,e){return t4(n,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function r4(n,e){return zd(n,"POST","/v1/accounts:signInWithEmailLink",Ao(n,e))}async function i4(n,e){return zd(n,"POST","/v1/accounts:signInWithEmailLink",Ao(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bc extends Kf{constructor(e,t,r,o=null){super("password",r),this._email=e,this._password=t,this._tenantId=o}static _fromEmailAndPassword(e,t){return new bc(e,t,"password")}static _fromEmailAndCode(e,t,r=null){return new bc(e,t,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t!=null&&t.email&&(t!=null&&t.password)){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return cf(e,t,"signInWithPassword",e4);case"emailLink":return r4(e,{email:this._email,oobCode:this._password});default:ti(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const r={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return cf(e,r,"signUpPassword",ZF);case"emailLink":return i4(e,{idToken:t,email:this._email,oobCode:this._password});default:ti(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Kl(n,e){return zd(n,"POST","/v1/accounts:signInWithIdp",Ao(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const o4="http://localhost";class Hi extends Kf{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Hi(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):ti("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:o}=t,a=_0(t,["providerId","signInMethod"]);if(!r||!o)return null;const c=new Hi(r,o);return c.idToken=a.idToken||void 0,c.accessToken=a.accessToken||void 0,c.secret=a.secret,c.nonce=a.nonce,c.pendingToken=a.pendingToken||null,c}_getIdTokenResponse(e){const t=this.buildRequest();return Kl(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,Kl(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Kl(e,t)}buildRequest(){const e={requestUri:o4,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=md(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function s4(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function a4(n){const e=Au(Pu(n)).link,t=e?Au(Pu(e)).deep_link_id:null,r=Au(Pu(n)).deep_link_id;return(r?Au(Pu(r)).link:null)||r||t||e||n}class Qf{constructor(e){var t,r,o,a,c,d;const h=Au(Pu(e)),m=(t=h.apiKey)!==null&&t!==void 0?t:null,g=(r=h.oobCode)!==null&&r!==void 0?r:null,x=s4((o=h.mode)!==null&&o!==void 0?o:null);ht(m&&g&&x,"argument-error"),this.apiKey=m,this.operation=x,this.code=g,this.continueUrl=(a=h.continueUrl)!==null&&a!==void 0?a:null,this.languageCode=(c=h.lang)!==null&&c!==void 0?c:null,this.tenantId=(d=h.tenantId)!==null&&d!==void 0?d:null}static parseLink(e){const t=a4(e);try{return new Qf(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ua{constructor(){this.providerId=Ua.PROVIDER_ID}static credential(e,t){return bc._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const r=Qf.parseLink(t);return ht(r,"argument-error"),bc._fromEmailAndCode(e,r.code,r.tenantId)}}Ua.PROVIDER_ID="password";Ua.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Ua.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A0{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zc extends A0{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Ql extends zc{static credentialFromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;return ht("providerId"in t&&"signInMethod"in t,"argument-error"),Hi._fromParams(t)}credential(e){return this._credential(Object.assign(Object.assign({},e),{nonce:e.rawNonce}))}_credential(e){return ht(e.idToken||e.accessToken,"argument-error"),Hi._fromParams(Object.assign(Object.assign({},e),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(e){return Ql.oauthCredentialFromTaggedObject(e)}static credentialFromError(e){return Ql.oauthCredentialFromTaggedObject(e.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r,oauthTokenSecret:o,pendingToken:a,nonce:c,providerId:d}=e;if(!r&&!o&&!t&&!a||!d)return null;try{return new Ql(d)._credential({idToken:t,accessToken:r,nonce:c,pendingToken:a})}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class po extends zc{constructor(){super("facebook.com")}static credential(e){return Hi._fromParams({providerId:po.PROVIDER_ID,signInMethod:po.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return po.credentialFromTaggedObject(e)}static credentialFromError(e){return po.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return po.credential(e.oauthAccessToken)}catch{return null}}}po.FACEBOOK_SIGN_IN_METHOD="facebook.com";po.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Di extends zc{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Hi._fromParams({providerId:Di.PROVIDER_ID,signInMethod:Di.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Di.credentialFromTaggedObject(e)}static credentialFromError(e){return Di.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r}=e;if(!t&&!r)return null;try{return Di.credential(t,r)}catch{return null}}}Di.GOOGLE_SIGN_IN_METHOD="google.com";Di.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fo extends zc{constructor(){super("github.com")}static credential(e){return Hi._fromParams({providerId:fo.PROVIDER_ID,signInMethod:fo.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return fo.credentialFromTaggedObject(e)}static credentialFromError(e){return fo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return fo.credential(e.oauthAccessToken)}catch{return null}}}fo.GITHUB_SIGN_IN_METHOD="github.com";fo.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mo extends zc{constructor(){super("twitter.com")}static credential(e,t){return Hi._fromParams({providerId:mo.PROVIDER_ID,signInMethod:mo.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return mo.credentialFromTaggedObject(e)}static credentialFromError(e){return mo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:r}=e;if(!t||!r)return null;try{return mo.credential(t,r)}catch{return null}}}mo.TWITTER_SIGN_IN_METHOD="twitter.com";mo.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function l4(n,e){return zd(n,"POST","/v1/accounts:signUp",Ao(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class za{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,o=!1){const a=await gi._fromIdTokenResponse(e,r,o),c=rS(r);return new za({user:a,providerId:c,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);const o=rS(r);return new za({user:e,providerId:o,_tokenResponse:r,operationType:t})}}function rS(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uf extends $i{constructor(e,t,r,o){var a;super(t.code,t.message),this.operationType=r,this.user=o,Object.setPrototypeOf(this,uf.prototype),this.customData={appName:e.name,tenantId:(a=e.tenantId)!==null&&a!==void 0?a:void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,o){return new uf(e,t,r,o)}}function hj(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(a=>{throw a.code==="auth/multi-factor-auth-required"?uf._fromErrorAndOperation(n,a,e,r):a})}async function c4(n,e,t=!1){const r=await xc(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return za._forOperation(n,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function u4(n,e,t=!1){const{auth:r}=n;if(jr(r.app))return Promise.reject(bo(r));const o="reauthenticate";try{const a=await xc(n,hj(r,o,e,n),t);ht(a.idToken,r,"internal-error");const c=R0(a.idToken);ht(c,r,"internal-error");const{sub:d}=c;return ht(n.uid===d,r,"user-mismatch"),za._forOperation(n,o,a)}catch(a){throw(a==null?void 0:a.code)==="auth/user-not-found"&&ti(r,"user-mismatch"),a}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function pj(n,e,t=!1){if(jr(n.app))return Promise.reject(bo(n));const r="signIn",o=await hj(n,r,e),a=await za._fromIdTokenResponse(n,r,o);return t||await n._updateCurrentUser(a.user),a}async function fj(n,e){return pj(Ki(n),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function mj(n){const e=Ki(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function gj(n,e,t){const r=Ki(n);await cf(r,{requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"},"getOobCode",n4)}async function P0(n,e,t){if(jr(n.app))return Promise.reject(bo(n));const r=Ki(n),c=await cf(r,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",l4).catch(h=>{throw h.code==="auth/password-does-not-meet-requirements"&&mj(n),h}),d=await za._fromIdTokenResponse(r,"signIn",c);return await r._updateCurrentUser(d.user),d}function yj(n,e,t){return jr(n.app)?Promise.reject(bo(n)):fj(Mt(n),Ua.credential(e,t)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&mj(n),r})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function d4(n,e){return Gi(n,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function df(n,{displayName:e,photoURL:t}){if(e===void 0&&t===void 0)return;const r=Mt(n),a={idToken:await r.getIdToken(),displayName:e,photoUrl:t,returnSecureToken:!0},c=await xc(r,d4(r.auth,a));r.displayName=c.displayName||null,r.photoURL=c.photoUrl||null;const d=r.providerData.find(({providerId:h})=>h==="password");d&&(d.displayName=r.displayName,d.photoURL=r.photoURL),await r._updateTokensIfNecessary(c)}function xj(n,e,t,r){return Mt(n).onIdTokenChanged(e,t,r)}function bj(n,e,t){return Mt(n).beforeAuthStateChanged(e,t)}function Ns(n,e,t,r){return Mt(n).onAuthStateChanged(e,t,r)}function Er(n){return Mt(n).signOut()}const hf="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vj{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(hf,"1"),this.storage.removeItem(hf),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const h4=1e3,p4=10;class wj extends vj{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=oj(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const r=this.storage.getItem(t),o=this.localCache[t];r!==o&&e(t,o,r)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((c,d,h)=>{this.notifyListeners(c,h)});return}const r=e.key;t?this.detachListener():this.stopPolling();const o=()=>{const c=this.storage.getItem(r);!t&&this.localCache[r]===c||this.notifyListeners(r,c)},a=this.storage.getItem(r);DF()&&a!==e.newValue&&e.newValue!==e.oldValue?setTimeout(o,p4):o()}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const o of Array.from(r))o(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:r}),!0)})},h4)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}wj.type="LOCAL";const Sj=wj;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kj extends vj{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}kj.type="SESSION";const B0=kj;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function f4(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yf{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(o=>o.isListeningto(e));if(t)return t;const r=new Yf(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:r,eventType:o,data:a}=t.data,c=this.handlersMap[o];if(!(c!=null&&c.size))return;t.ports[0].postMessage({status:"ack",eventId:r,eventType:o});const d=Array.from(c).map(async m=>m(t.origin,a)),h=await f4(d);t.ports[0].postMessage({status:"done",eventId:r,eventType:o,response:h})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Yf.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function F0(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m4{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){const o=typeof MessageChannel<"u"?new MessageChannel:null;if(!o)throw new Error("connection_unavailable");let a,c;return new Promise((d,h)=>{const m=F0("",20);o.port1.start();const g=setTimeout(()=>{h(new Error("unsupported_event"))},r);c={messageChannel:o,onMessage(x){const S=x;if(S.data.eventId===m)switch(S.data.status){case"ack":clearTimeout(g),a=setTimeout(()=>{h(new Error("timeout"))},3e3);break;case"done":clearTimeout(a),d(S.data.response);break;default:clearTimeout(g),clearTimeout(a),h(new Error("invalid_response"));break}}},this.handlers.add(c),o.port1.addEventListener("message",c.onMessage),this.target.postMessage({eventType:e,eventId:m,data:t},[o.port2])}).finally(()=>{c&&this.removeMessageHandler(c)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ui(){return window}function g4(n){Ui().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tj(){return typeof Ui().WorkerGlobalScope<"u"&&typeof Ui().importScripts=="function"}async function y4(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function x4(){var n;return((n=navigator==null?void 0:navigator.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function b4(){return Tj()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _j="firebaseLocalStorageDb",v4=1,pf="firebaseLocalStorage",jj="fbase_key";class Dd{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Xf(n,e){return n.transaction([pf],e?"readwrite":"readonly").objectStore(pf)}function w4(){const n=indexedDB.deleteDatabase(_j);return new Dd(n).toPromise()}function Xy(){const n=indexedDB.open(_j,v4);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const r=n.result;try{r.createObjectStore(pf,{keyPath:jj})}catch(o){t(o)}}),n.addEventListener("success",async()=>{const r=n.result;r.objectStoreNames.contains(pf)?e(r):(r.close(),await w4(),e(await Xy()))})})}async function iS(n,e,t){const r=Xf(n,!0).put({[jj]:e,value:t});return new Dd(r).toPromise()}async function S4(n,e){const t=Xf(n,!1).get(e),r=await new Dd(t).toPromise();return r===void 0?null:r.value}function oS(n,e){const t=Xf(n,!0).delete(e);return new Dd(t).toPromise()}const k4=800,T4=3;class Ij{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Xy(),this.db)}async _withRetries(e){let t=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(t++>T4)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Tj()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Yf._getInstance(b4()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await y4(),!this.activeServiceWorker)return;this.sender=new m4(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((t=r[0])===null||t===void 0)&&t.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||x4()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Xy();return await iS(e,hf,"1"),await oS(e,hf),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(r=>iS(r,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(r=>S4(r,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>oS(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(o=>{const a=Xf(o,!1).getAll();return new Dd(a).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],r=new Set;if(e.length!==0)for(const{fbase_key:o,value:a}of e)r.add(o),JSON.stringify(this.localCache[o])!==JSON.stringify(a)&&(this.notifyListeners(o,a),t.push(o));for(const o of Object.keys(this.localCache))this.localCache[o]&&!r.has(o)&&(this.notifyListeners(o,null),t.push(o));return t}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const o of Array.from(r))o(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),k4)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}Ij.type="LOCAL";const Cj=Ij;new Fd(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rj(n,e){return e?xo(e):(ht(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z0 extends Kf{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Kl(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Kl(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Kl(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function _4(n){return pj(n.auth,new z0(n),n.bypassAuthState)}function j4(n){const{auth:e,user:t}=n;return ht(t,e,"internal-error"),u4(t,new z0(n),n.bypassAuthState)}async function I4(n){const{auth:e,user:t}=n;return ht(t,e,"internal-error"),c4(t,new z0(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ej{constructor(e,t,r,o,a=!1){this.auth=e,this.resolver=r,this.user=o,this.bypassAuthState=a,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:r,postBody:o,tenantId:a,error:c,type:d}=e;if(c){this.reject(c);return}const h={auth:this.auth,requestUri:t,sessionId:r,tenantId:a||void 0,postBody:o||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(d)(h))}catch(m){this.reject(m)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return _4;case"linkViaPopup":case"linkViaRedirect":return I4;case"reauthViaPopup":case"reauthViaRedirect":return j4;default:ti(this.auth,"internal-error")}}resolve(e){_o(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){_o(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C4=new Fd(2e3,1e4);async function Ep(n,e,t){if(jr(n.app))return Promise.reject(xi(n,"operation-not-supported-in-this-environment"));const r=Ki(n);xF(n,e,A0);const o=Rj(r,t);return new ma(r,"signInViaPopup",e,o).executeNotNull()}class ma extends Ej{constructor(e,t,r,o,a){super(e,t,o,a),this.provider=r,this.authWindow=null,this.pollId=null,ma.currentPopupAction&&ma.currentPopupAction.cancel(),ma.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return ht(e,this.auth,"internal-error"),e}async onExecution(){_o(this.filter.length===1,"Popup operations only handle one event");const e=F0();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(xi(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(xi(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,ma.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,r;if(!((r=(t=this.authWindow)===null||t===void 0?void 0:t.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(xi(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,C4.get())};e()}}ma.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const R4="pendingRedirect",Ap=new Map;class E4 extends Ej{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=Ap.get(this.auth._key());if(!e){try{const r=await A4(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}Ap.set(this.auth._key(),e)}return this.bypassAuthState||Ap.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function A4(n,e){const t=F4(e),r=B4(n);if(!await r._isAvailable())return!1;const o=await r._get(t)==="true";return await r._remove(t),o}function P4(n,e){Ap.set(n._key(),e)}function B4(n){return xo(n._redirectPersistence)}function F4(n){return Rp(R4,n.config.apiKey,n.name)}async function z4(n,e){return await Ki(n)._initializationPromise,Aj(n,e,!1)}async function Aj(n,e,t=!1){if(jr(n.app))return Promise.reject(bo(n));const r=Ki(n),o=Rj(r,e),c=await new E4(r,o,t).execute();return c&&!t&&(delete c.user._redirectEventId,await r._persistUserIfCurrent(c.user),await r._setRedirectUser(null,e)),c}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const D4=10*60*1e3;class N4{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!M4(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var r;if(e.error&&!Pj(e)){const o=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";t.onError(xi(this.auth,o))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=D4&&this.cachedEventUids.clear(),this.cachedEventUids.has(sS(e))}saveEventToCache(e){this.cachedEventUids.add(sS(e)),this.lastProcessedEventTime=Date.now()}}function sS(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function Pj({type:n,error:e}){return n==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function M4(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Pj(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function L4(n,e={}){return Gi(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const O4=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,W4=/^https?/;async function V4(n){if(n.config.emulator)return;const{authorizedDomains:e}=await L4(n);for(const t of e)try{if(U4(t))return}catch{}ti(n,"unauthorized-domain")}function U4(n){const e=Ky(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){const c=new URL(n);return c.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&c.hostname===r}if(!W4.test(t))return!1;if(O4.test(n))return r===n;const o=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+o+"|"+o+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q4=new Fd(3e4,6e4);function aS(){const n=Ui().___jsl;if(n!=null&&n.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function H4(n){return new Promise((e,t)=>{var r,o,a;function c(){aS(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{aS(),t(xi(n,"network-request-failed"))},timeout:q4.get()})}if(!((o=(r=Ui().gapi)===null||r===void 0?void 0:r.iframes)===null||o===void 0)&&o.Iframe)e(gapi.iframes.getContext());else if(!((a=Ui().gapi)===null||a===void 0)&&a.load)c();else{const d=HF("iframefcb");return Ui()[d]=()=>{gapi.load?c():t(xi(n,"network-request-failed"))},aj(`${qF()}?onload=${d}`).catch(h=>t(h))}}).catch(e=>{throw Pp=null,e})}let Pp=null;function $4(n){return Pp=Pp||H4(n),Pp}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const G4=new Fd(5e3,15e3),K4="__/auth/iframe",Q4="emulator/auth/iframe",Y4={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},X4=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function J4(n){const e=n.config;ht(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?C0(e,Q4):`https://${n.config.authDomain}/${K4}`,r={apiKey:e.apiKey,appName:n.name,v:La},o=X4.get(n.config.apiHost);o&&(r.eid=o);const a=n._getFrameworks();return a.length&&(r.fw=a.join(",")),`${t}?${md(r).slice(1)}`}async function Z4(n){const e=await $4(n),t=Ui().gapi;return ht(t,n,"internal-error"),e.open({where:document.body,url:J4(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Y4,dontclear:!0},r=>new Promise(async(o,a)=>{await r.restyle({setHideOnLeave:!1});const c=xi(n,"network-request-failed"),d=Ui().setTimeout(()=>{a(c)},G4.get());function h(){Ui().clearTimeout(d),o(r)}r.ping(h).then(h,()=>{a(c)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ez={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},tz=500,nz=600,rz="_blank",iz="http://localhost";class lS{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function oz(n,e,t,r=tz,o=nz){const a=Math.max((window.screen.availHeight-o)/2,0).toString(),c=Math.max((window.screen.availWidth-r)/2,0).toString();let d="";const h=Object.assign(Object.assign({},ez),{width:r.toString(),height:o.toString(),top:a,left:c}),m=Fn().toLowerCase();t&&(d=ej(m)?rz:t),J2(m)&&(e=e||iz,h.scrollbars="yes");const g=Object.entries(h).reduce((S,[j,T])=>`${S}${j}=${T},`,"");if(zF(m)&&d!=="_self")return sz(e||"",d),new lS(null);const x=window.open(e||"",d,g);ht(x,n,"popup-blocked");try{x.focus()}catch{}return new lS(x)}function sz(n,e){const t=document.createElement("a");t.href=n,t.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const az="__/auth/handler",lz="emulator/auth/handler",cz=encodeURIComponent("fac");async function cS(n,e,t,r,o,a){ht(n.config.authDomain,n,"auth-domain-config-required"),ht(n.config.apiKey,n,"invalid-api-key");const c={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:La,eventId:o};if(e instanceof A0){e.setDefaultLanguage(n.languageCode),c.providerId=e.providerId||"",SE(e.getCustomParameters())||(c.customParameters=JSON.stringify(e.getCustomParameters()));for(const[g,x]of Object.entries({}))c[g]=x}if(e instanceof zc){const g=e.getScopes().filter(x=>x!=="");g.length>0&&(c.scopes=g.join(","))}n.tenantId&&(c.tid=n.tenantId);const d=c;for(const g of Object.keys(d))d[g]===void 0&&delete d[g];const h=await n._getAppCheckToken(),m=h?`#${cz}=${encodeURIComponent(h)}`:"";return`${uz(n)}?${md(d).slice(1)}${m}`}function uz({config:n}){return n.emulator?C0(n,lz):`https://${n.authDomain}/${az}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xg="webStorageSupport";class dz{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=B0,this._completeRedirectFn=Aj,this._overrideRedirectResult=P4}async _openPopup(e,t,r,o){var a;_o((a=this.eventManagers[e._key()])===null||a===void 0?void 0:a.manager,"_initialize() not called before _openPopup()");const c=await cS(e,t,r,Ky(),o);return oz(e,c,F0())}async _openRedirect(e,t,r,o){await this._originValidation(e);const a=await cS(e,t,r,Ky(),o);return g4(a),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:o,promise:a}=this.eventManagers[t];return o?Promise.resolve(o):(_o(a,"If manager is not set, promise should be"),a)}const r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}async initAndGetManager(e){const t=await Z4(e),r=new N4(e);return t.register("authEvent",o=>(ht(o==null?void 0:o.authEvent,e,"invalid-auth-event"),{status:r.onEvent(o.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Xg,{type:Xg},o=>{var a;const c=(a=o==null?void 0:o[0])===null||a===void 0?void 0:a[Xg];c!==void 0&&t(!!c),ti(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=V4(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return oj()||Z2()||E0()}}const Bj=dz;var uS="@firebase/auth",dS="1.10.7";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hz{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){ht(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pz(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function fz(n){Ta(new bs("auth",(e,{options:t})=>{const r=e.getProvider("app").getImmediate(),o=e.getProvider("heartbeat"),a=e.getProvider("app-check-internal"),{apiKey:c,authDomain:d}=r.options;ht(c&&!c.includes(":"),"invalid-api-key",{appName:r.name});const h={apiKey:c,authDomain:d,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:sj(n)},m=new WF(r,o,a,h);return YF(m,t),m},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),Ta(new bs("auth-internal",e=>{const t=Ki(e.getProvider("auth").getImmediate());return(r=>new hz(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Oi(uS,dS,pz(n)),Oi(uS,dS,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mz=5*60,gz=Ok("authIdTokenMaxAge")||mz;let hS=null;const yz=n=>async e=>{const t=e&&await e.getIdTokenResult(),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>gz)return;const o=t==null?void 0:t.token;hS!==o&&(hS=o,await fetch(n,{method:o?"POST":"DELETE",headers:o?{Authorization:`Bearer ${o}`}:{}}))};function St(n=fx()){const e=Sc(n,"auth");if(e.isInitialized())return e.getImmediate();const t=cj(n,{popupRedirectResolver:Bj,persistence:[Cj,Sj,B0]}),r=Ok("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const a=new URL(r,location.origin);if(location.origin===a.origin){const c=yz(a.toString());bj(t,c,()=>c(t.currentUser)),xj(t,d=>c(d))}}const o=Nk("auth");return o&&uj(t,`http://${o}`),t}function xz(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}VF({loadJS(n){return new Promise((e,t)=>{const r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=o=>{const a=xi("internal-error");a.customData=o,t(a)},r.type="text/javascript",r.charset="UTF-8",xz().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});fz("Browser");const pS=Object.freeze(Object.defineProperty({__proto__:null,ActionCodeURL:Qf,AuthCredential:Kf,EmailAuthCredential:bc,EmailAuthProvider:Ua,FacebookAuthProvider:po,GithubAuthProvider:fo,GoogleAuthProvider:Di,OAuthCredential:Hi,OAuthProvider:Ql,TwitterAuthProvider:mo,beforeAuthStateChanged:bj,browserLocalPersistence:Sj,browserPopupRedirectResolver:Bj,browserSessionPersistence:B0,connectAuthEmulator:uj,createUserWithEmailAndPassword:P0,getAuth:St,getIdTokenResult:K2,getRedirectResult:z4,inMemoryPersistence:Yy,indexedDBLocalPersistence:Cj,initializeAuth:cj,onAuthStateChanged:Ns,onIdTokenChanged:xj,prodErrorMap:U2,reload:Q2,sendPasswordResetEmail:gj,signInWithCredential:fj,signInWithEmailAndPassword:yj,signInWithPopup:Ep,signOut:Er,updateProfile:df},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fj="firebasestorage.googleapis.com",zj="storageBucket",bz=2*60*1e3,vz=10*60*1e3,wz=1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yn extends $i{constructor(e,t,r=0){super(Jg(e),`Firebase Storage: ${t} (${Jg(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,yn.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Jg(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var an;(function(n){n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(an||(an={}));function Jg(n){return"storage/"+n}function D0(){const n="An unknown error occurred, please check the error payload for server response.";return new yn(an.UNKNOWN,n)}function Sz(n){return new yn(an.OBJECT_NOT_FOUND,"Object '"+n+"' does not exist.")}function kz(n){return new yn(an.QUOTA_EXCEEDED,"Quota for bucket '"+n+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function Tz(){const n="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new yn(an.UNAUTHENTICATED,n)}function _z(){return new yn(an.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function jz(n){return new yn(an.UNAUTHORIZED,"User does not have permission to access '"+n+"'.")}function Dj(){return new yn(an.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function Nj(){return new yn(an.CANCELED,"User canceled the upload/download.")}function Iz(n){return new yn(an.INVALID_URL,"Invalid URL '"+n+"'.")}function Cz(n){return new yn(an.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function Rz(){return new yn(an.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+zj+"' property when initializing the app?")}function Mj(){return new yn(an.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function Ez(){return new yn(an.SERVER_FILE_WRONG_SIZE,"Server recorded incorrect upload file size, please retry the upload.")}function Az(){return new yn(an.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function Pz(n){return new yn(an.UNSUPPORTED_ENVIRONMENT,`${n} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function Jy(n){return new yn(an.INVALID_ARGUMENT,n)}function Lj(){return new yn(an.APP_DELETED,"The Firebase app was deleted.")}function Bz(n){return new yn(an.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function Ku(n,e){return new yn(an.INVALID_FORMAT,"String does not match format '"+n+"': "+e)}function Iu(n){throw new yn(an.INTERNAL_ERROR,"Internal error: "+n)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ur{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let r;try{r=Ur.makeFromUrl(e,t)}catch{return new Ur(e,"")}if(r.path==="")return r;throw Cz(e)}static makeFromUrl(e,t){let r=null;const o="([A-Za-z0-9.\\-_]+)";function a(H){H.path.charAt(H.path.length-1)==="/"&&(H.path_=H.path_.slice(0,-1))}const c="(/(.*))?$",d=new RegExp("^gs://"+o+c,"i"),h={bucket:1,path:3};function m(H){H.path_=decodeURIComponent(H.path)}const g="v[A-Za-z0-9_]+",x=t.replace(/[.]/g,"\\."),S="(/([^?#]*).*)?$",j=new RegExp(`^https?://${x}/${g}/b/${o}/o${S}`,"i"),T={bucket:1,path:3},R=t===Fj?"(?:storage.googleapis.com|storage.cloud.google.com)":t,I="([^?#]*)",F=new RegExp(`^https?://${R}/${o}/${I}`,"i"),z=[{regex:d,indices:h,postModify:a},{regex:j,indices:T,postModify:m},{regex:F,indices:{bucket:1,path:2},postModify:m}];for(let H=0;H<z.length;H++){const J=z[H],O=J.regex.exec(e);if(O){const L=O[J.indices.bucket];let C=O[J.indices.path];C||(C=""),r=new Ur(L,C),J.postModify(r);break}}if(r==null)throw Iz(e);return r}}class Fz{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zz(n,e,t){let r=1,o=null,a=null,c=!1,d=0;function h(){return d===2}let m=!1;function g(...I){m||(m=!0,e.apply(null,I))}function x(I){o=setTimeout(()=>{o=null,n(j,h())},I)}function S(){a&&clearTimeout(a)}function j(I,...F){if(m){S();return}if(I){S(),g.call(null,I,...F);return}if(h()||c){S(),g.call(null,I,...F);return}r<64&&(r*=2);let z;d===1?(d=2,z=0):z=(r+Math.random())*1e3,x(z)}let T=!1;function R(I){T||(T=!0,S(),!m&&(o!==null?(I||(d=2),clearTimeout(o),x(0)):I||(d=1)))}return x(0),a=setTimeout(()=>{c=!0,R(!0)},t),R}function Dz(n){n(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nz(n){return n!==void 0}function Mz(n){return typeof n=="function"}function Lz(n){return typeof n=="object"&&!Array.isArray(n)}function Jf(n){return typeof n=="string"||n instanceof String}function fS(n){return N0()&&n instanceof Blob}function N0(){return typeof Blob<"u"}function mS(n,e,t,r){if(r<e)throw Jy(`Invalid value for '${n}'. Expected ${e} or greater.`);if(r>t)throw Jy(`Invalid value for '${n}'. Expected ${t} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nd(n,e,t){let r=e;return t==null&&(r=`https://${e}`),`${t}://${r}/v0${n}`}function Oj(n){const e=encodeURIComponent;let t="?";for(const r in n)if(n.hasOwnProperty(r)){const o=e(r)+"="+e(n[r]);t=t+o+"&"}return t=t.slice(0,-1),t}var wa;(function(n){n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT"})(wa||(wa={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wj(n,e){const t=n>=500&&n<600,o=[408,429].indexOf(n)!==-1,a=e.indexOf(n)!==-1;return t||o||a}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oz{constructor(e,t,r,o,a,c,d,h,m,g,x,S=!0,j=!1){this.url_=e,this.method_=t,this.headers_=r,this.body_=o,this.successCodes_=a,this.additionalRetryCodes_=c,this.callback_=d,this.errorCallback_=h,this.timeout_=m,this.progressCallback_=g,this.connectionFactory_=x,this.retry=S,this.isUsingEmulator=j,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((T,R)=>{this.resolve_=T,this.reject_=R,this.start_()})}start_(){const e=(r,o)=>{if(o){r(!1,new pp(!1,null,!0));return}const a=this.connectionFactory_();this.pendingConnection_=a;const c=d=>{const h=d.loaded,m=d.lengthComputable?d.total:-1;this.progressCallback_!==null&&this.progressCallback_(h,m)};this.progressCallback_!==null&&a.addUploadProgressListener(c),a.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&a.removeUploadProgressListener(c),this.pendingConnection_=null;const d=a.getErrorCode()===wa.NO_ERROR,h=a.getStatus();if(!d||Wj(h,this.additionalRetryCodes_)&&this.retry){const g=a.getErrorCode()===wa.ABORT;r(!1,new pp(!1,null,g));return}const m=this.successCodes_.indexOf(h)!==-1;r(!0,new pp(m,a))})},t=(r,o)=>{const a=this.resolve_,c=this.reject_,d=o.connection;if(o.wasSuccessCode)try{const h=this.callback_(d,d.getResponse());Nz(h)?a(h):a()}catch(h){c(h)}else if(d!==null){const h=D0();h.serverResponse=d.getErrorText(),this.errorCallback_?c(this.errorCallback_(d,h)):c(h)}else if(o.canceled){const h=this.appDelete_?Lj():Nj();c(h)}else{const h=Dj();c(h)}};this.canceled_?t(!1,new pp(!1,null,!0)):this.backoffId_=zz(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&Dz(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class pp{constructor(e,t,r){this.wasSuccessCode=e,this.connection=t,this.canceled=!!r}}function Wz(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function Vz(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function Uz(n,e){e&&(n["X-Firebase-GMPID"]=e)}function qz(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function Hz(n,e,t,r,o,a,c=!0,d=!1){const h=Oj(n.urlParams),m=n.url+h,g=Object.assign({},n.headers);return Uz(g,e),Wz(g,t),Vz(g,a),qz(g,r),new Oz(m,n.method,g,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,o,c,d)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $z(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function Gz(...n){const e=$z();if(e!==void 0){const t=new e;for(let r=0;r<n.length;r++)t.append(n[r]);return t.getBlob()}else{if(N0())return new Blob(n);throw new yn(an.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function Kz(n,e,t){return n.webkitSlice?n.webkitSlice(e,t):n.mozSlice?n.mozSlice(e,t):n.slice?n.slice(e,t):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qz(n){if(typeof atob>"u")throw Pz("base-64");return atob(n)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Li={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class Zg{constructor(e,t){this.data=e,this.contentType=t||null}}function Yz(n,e){switch(n){case Li.RAW:return new Zg(Vj(e));case Li.BASE64:case Li.BASE64URL:return new Zg(Uj(n,e));case Li.DATA_URL:return new Zg(Jz(e),Zz(e))}throw D0()}function Vj(n){const e=[];for(let t=0;t<n.length;t++){let r=n.charCodeAt(t);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|r&63);else if((r&64512)===55296)if(!(t<n.length-1&&(n.charCodeAt(t+1)&64512)===56320))e.push(239,191,189);else{const a=r,c=n.charCodeAt(++t);r=65536|(a&1023)<<10|c&1023,e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|r&63)}else(r&64512)===56320?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|r&63)}return new Uint8Array(e)}function Xz(n){let e;try{e=decodeURIComponent(n)}catch{throw Ku(Li.DATA_URL,"Malformed data URL.")}return Vj(e)}function Uj(n,e){switch(n){case Li.BASE64:{const o=e.indexOf("-")!==-1,a=e.indexOf("_")!==-1;if(o||a)throw Ku(n,"Invalid character '"+(o?"-":"_")+"' found: is it base64url encoded?");break}case Li.BASE64URL:{const o=e.indexOf("+")!==-1,a=e.indexOf("/")!==-1;if(o||a)throw Ku(n,"Invalid character '"+(o?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let t;try{t=Qz(e)}catch(o){throw o.message.includes("polyfill")?o:Ku(n,"Invalid character found")}const r=new Uint8Array(t.length);for(let o=0;o<t.length;o++)r[o]=t.charCodeAt(o);return r}class qj{constructor(e){this.base64=!1,this.contentType=null;const t=e.match(/^data:([^,]+)?,/);if(t===null)throw Ku(Li.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const r=t[1]||null;r!=null&&(this.base64=eD(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}}function Jz(n){const e=new qj(n);return e.base64?Uj(Li.BASE64,e.rest):Xz(e.rest)}function Zz(n){return new qj(n).contentType}function eD(n,e){return n.length>=e.length?n.substring(n.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cs{constructor(e,t){let r=0,o="";fS(e)?(this.data_=e,r=e.size,o=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=o}size(){return this.size_}type(){return this.type_}slice(e,t){if(fS(this.data_)){const r=this.data_,o=Kz(r,e,t);return o===null?null:new cs(o)}else{const r=new Uint8Array(this.data_.buffer,e,t-e);return new cs(r,!0)}}static getBlob(...e){if(N0()){const t=e.map(r=>r instanceof cs?r.data_:r);return new cs(Gz.apply(null,t))}else{const t=e.map(c=>Jf(c)?Yz(Li.RAW,c).data:c.data_);let r=0;t.forEach(c=>{r+=c.byteLength});const o=new Uint8Array(r);let a=0;return t.forEach(c=>{for(let d=0;d<c.length;d++)o[a++]=c[d]}),new cs(o,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hj(n){let e;try{e=JSON.parse(n)}catch{return null}return Lz(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tD(n){if(n.length===0)return null;const e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function nD(n,e){const t=e.split("/").filter(r=>r.length>0).join("/");return n.length===0?t:n+"/"+t}function $j(n){const e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rD(n,e){return e}class fr{constructor(e,t,r,o){this.server=e,this.local=t||e,this.writable=!!r,this.xform=o||rD}}let fp=null;function iD(n){return!Jf(n)||n.length<2?n:$j(n)}function Gj(){if(fp)return fp;const n=[];n.push(new fr("bucket")),n.push(new fr("generation")),n.push(new fr("metageneration")),n.push(new fr("name","fullPath",!0));function e(a,c){return iD(c)}const t=new fr("name");t.xform=e,n.push(t);function r(a,c){return c!==void 0?Number(c):c}const o=new fr("size");return o.xform=r,n.push(o),n.push(new fr("timeCreated")),n.push(new fr("updated")),n.push(new fr("md5Hash",null,!0)),n.push(new fr("cacheControl",null,!0)),n.push(new fr("contentDisposition",null,!0)),n.push(new fr("contentEncoding",null,!0)),n.push(new fr("contentLanguage",null,!0)),n.push(new fr("contentType",null,!0)),n.push(new fr("metadata","customMetadata",!0)),fp=n,fp}function oD(n,e){function t(){const r=n.bucket,o=n.fullPath,a=new Ur(r,o);return e._makeStorageReference(a)}Object.defineProperty(n,"ref",{get:t})}function sD(n,e,t){const r={};r.type="file";const o=t.length;for(let a=0;a<o;a++){const c=t[a];r[c.local]=c.xform(r,e[c.server])}return oD(r,n),r}function Kj(n,e,t){const r=Hj(e);return r===null?null:sD(n,r,t)}function aD(n,e,t,r){const o=Hj(e);if(o===null||!Jf(o.downloadTokens))return null;const a=o.downloadTokens;if(a.length===0)return null;const c=encodeURIComponent;return a.split(",").map(m=>{const g=n.bucket,x=n.fullPath,S="/b/"+c(g)+"/o/"+c(x),j=Nd(S,t,r),T=Oj({alt:"media",token:m});return j+T})[0]}function Qj(n,e){const t={},r=e.length;for(let o=0;o<r;o++){const a=e[o];a.writable&&(t[a.server]=n[a.local])}return JSON.stringify(t)}class Dc{constructor(e,t,r,o){this.url=e,this.method=t,this.handler=r,this.timeout=o,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vo(n){if(!n)throw D0()}function M0(n,e){function t(r,o){const a=Kj(n,o,e);return vo(a!==null),a}return t}function lD(n,e){function t(r,o){const a=Kj(n,o,e);return vo(a!==null),aD(a,o,n.host,n._protocol)}return t}function Md(n){function e(t,r){let o;return t.getStatus()===401?t.getErrorText().includes("Firebase App Check token is invalid")?o=_z():o=Tz():t.getStatus()===402?o=kz(n.bucket):t.getStatus()===403?o=jz(n.path):o=r,o.status=t.getStatus(),o.serverResponse=r.serverResponse,o}return e}function Yj(n){const e=Md(n);function t(r,o){let a=e(r,o);return r.getStatus()===404&&(a=Sz(n.path)),a.serverResponse=o.serverResponse,a}return t}function cD(n,e,t){const r=e.fullServerUrl(),o=Nd(r,n.host,n._protocol),a="GET",c=n.maxOperationRetryTime,d=new Dc(o,a,M0(n,t),c);return d.errorHandler=Yj(e),d}function uD(n,e,t){const r=e.fullServerUrl(),o=Nd(r,n.host,n._protocol),a="GET",c=n.maxOperationRetryTime,d=new Dc(o,a,lD(n,t),c);return d.errorHandler=Yj(e),d}function dD(n,e){return n&&n.contentType||e&&e.type()||"application/octet-stream"}function Xj(n,e,t){const r=Object.assign({},t);return r.fullPath=n.path,r.size=e.size(),r.contentType||(r.contentType=dD(null,e)),r}function hD(n,e,t,r,o){const a=e.bucketOnlyServerUrl(),c={"X-Goog-Upload-Protocol":"multipart"};function d(){let z="";for(let H=0;H<2;H++)z=z+Math.random().toString().slice(2);return z}const h=d();c["Content-Type"]="multipart/related; boundary="+h;const m=Xj(e,r,o),g=Qj(m,t),x="--"+h+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+g+`\r
--`+h+`\r
Content-Type: `+m.contentType+`\r
\r
`,S=`\r
--`+h+"--",j=cs.getBlob(x,r,S);if(j===null)throw Mj();const T={name:m.fullPath},R=Nd(a,n.host,n._protocol),I="POST",F=n.maxUploadRetryTime,P=new Dc(R,I,M0(n,t),F);return P.urlParams=T,P.headers=c,P.body=j.uploadData(),P.errorHandler=Md(e),P}class ff{constructor(e,t,r,o){this.current=e,this.total=t,this.finalized=!!r,this.metadata=o||null}}function L0(n,e){let t=null;try{t=n.getResponseHeader("X-Goog-Upload-Status")}catch{vo(!1)}return vo(!!t&&(e||["active"]).indexOf(t)!==-1),t}function pD(n,e,t,r,o){const a=e.bucketOnlyServerUrl(),c=Xj(e,r,o),d={name:c.fullPath},h=Nd(a,n.host,n._protocol),m="POST",g={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${r.size()}`,"X-Goog-Upload-Header-Content-Type":c.contentType,"Content-Type":"application/json; charset=utf-8"},x=Qj(c,t),S=n.maxUploadRetryTime;function j(R){L0(R);let I;try{I=R.getResponseHeader("X-Goog-Upload-URL")}catch{vo(!1)}return vo(Jf(I)),I}const T=new Dc(h,m,j,S);return T.urlParams=d,T.headers=g,T.body=x,T.errorHandler=Md(e),T}function fD(n,e,t,r){const o={"X-Goog-Upload-Command":"query"};function a(m){const g=L0(m,["active","final"]);let x=null;try{x=m.getResponseHeader("X-Goog-Upload-Size-Received")}catch{vo(!1)}x||vo(!1);const S=Number(x);return vo(!isNaN(S)),new ff(S,r.size(),g==="final")}const c="POST",d=n.maxUploadRetryTime,h=new Dc(t,c,a,d);return h.headers=o,h.errorHandler=Md(e),h}const gS=256*1024;function mD(n,e,t,r,o,a,c,d){const h=new ff(0,0);if(c?(h.current=c.current,h.total=c.total):(h.current=0,h.total=r.size()),r.size()!==h.total)throw Ez();const m=h.total-h.current;let g=m;o>0&&(g=Math.min(g,o));const x=h.current,S=x+g;let j="";g===0?j="finalize":m===g?j="upload, finalize":j="upload";const T={"X-Goog-Upload-Command":j,"X-Goog-Upload-Offset":`${h.current}`},R=r.slice(x,S);if(R===null)throw Mj();function I(H,J){const O=L0(H,["active","final"]),L=h.current+g,C=r.size();let A;return O==="final"?A=M0(e,a)(H,J):A=null,new ff(L,C,O==="final",A)}const F="POST",P=e.maxUploadRetryTime,z=new Dc(t,F,I,P);return z.headers=T,z.body=R.uploadData(),z.progressCallback=d||null,z.errorHandler=Md(n),z}const _r={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function ey(n){switch(n){case"running":case"pausing":case"canceling":return _r.RUNNING;case"paused":return _r.PAUSED;case"success":return _r.SUCCESS;case"canceled":return _r.CANCELED;case"error":return _r.ERROR;default:return _r.ERROR}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gD{constructor(e,t,r){if(Mz(e)||t!=null||r!=null)this.next=e,this.error=t??void 0,this.complete=r??void 0;else{const a=e;this.next=a.next,this.error=a.error,this.complete=a.complete}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bl(n){return(...e)=>{Promise.resolve().then(()=>n(...e))}}class yD{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=wa.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=wa.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=wa.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,t,r,o,a){if(this.sent_)throw Iu("cannot .send() more than once");if(jo(e)&&r&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(t,e,!0),a!==void 0)for(const c in a)a.hasOwnProperty(c)&&this.xhr_.setRequestHeader(c,a[c].toString());return o!==void 0?this.xhr_.send(o):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw Iu("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw Iu("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw Iu("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw Iu("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class xD extends yD{initXhr(){this.xhr_.responseType="text"}}function Ul(){return new xD}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bD{isExponentialBackoffExpired(){return this.sleepTime>this.maxSleepTime}constructor(e,t,r=null){this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=e,this._blob=t,this._metadata=r,this._mappings=Gj(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=o=>{if(this._request=void 0,this._chunkMultiplier=1,o._codeEquals(an.CANCELED))this._needToFetchStatus=!0,this.completeTransitions_();else{const a=this.isExponentialBackoffExpired();if(Wj(o.status,[]))if(a)o=Dj();else{this.sleepTime=Math.max(this.sleepTime*2,wz),this._needToFetchStatus=!0,this.completeTransitions_();return}this._error=o,this._transition("error")}},this._metadataErrorHandler=o=>{this._request=void 0,o._codeEquals(an.CANCELED)?this.completeTransitions_():(this._error=o,this._transition("error"))},this.sleepTime=0,this.maxSleepTime=this._ref.storage.maxUploadRetryTime,this._promise=new Promise((o,a)=>{this._resolve=o,this._reject=a,this._start()}),this._promise.then(null,()=>{})}_makeProgressCallback(){const e=this._transferred;return t=>this._updateProgress(e+t)}_shouldDoResumable(e){return e.size()>256*1024}_start(){this._state==="running"&&this._request===void 0&&(this._resumable?this._uploadUrl===void 0?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this.pendingTimeout=setTimeout(()=>{this.pendingTimeout=void 0,this._continueUpload()},this.sleepTime):this._oneShotUpload())}_resolveToken(e){Promise.all([this._ref.storage._getAuthToken(),this._ref.storage._getAppCheckToken()]).then(([t,r])=>{switch(this._state){case"running":e(t,r);break;case"canceling":this._transition("canceled");break;case"pausing":this._transition("paused");break}})}_createResumable(){this._resolveToken((e,t)=>{const r=pD(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),o=this._ref.storage._makeRequest(r,Ul,e,t);this._request=o,o.getPromise().then(a=>{this._request=void 0,this._uploadUrl=a,this._needToFetchStatus=!1,this.completeTransitions_()},this._errorHandler)})}_fetchStatus(){const e=this._uploadUrl;this._resolveToken((t,r)=>{const o=fD(this._ref.storage,this._ref._location,e,this._blob),a=this._ref.storage._makeRequest(o,Ul,t,r);this._request=a,a.getPromise().then(c=>{c=c,this._request=void 0,this._updateProgress(c.current),this._needToFetchStatus=!1,c.finalized&&(this._needToFetchMetadata=!0),this.completeTransitions_()},this._errorHandler)})}_continueUpload(){const e=gS*this._chunkMultiplier,t=new ff(this._transferred,this._blob.size()),r=this._uploadUrl;this._resolveToken((o,a)=>{let c;try{c=mD(this._ref._location,this._ref.storage,r,this._blob,e,this._mappings,t,this._makeProgressCallback())}catch(h){this._error=h,this._transition("error");return}const d=this._ref.storage._makeRequest(c,Ul,o,a,!1);this._request=d,d.getPromise().then(h=>{this._increaseMultiplier(),this._request=void 0,this._updateProgress(h.current),h.finalized?(this._metadata=h.metadata,this._transition("success")):this.completeTransitions_()},this._errorHandler)})}_increaseMultiplier(){gS*this._chunkMultiplier*2<32*1024*1024&&(this._chunkMultiplier*=2)}_fetchMetadata(){this._resolveToken((e,t)=>{const r=cD(this._ref.storage,this._ref._location,this._mappings),o=this._ref.storage._makeRequest(r,Ul,e,t);this._request=o,o.getPromise().then(a=>{this._request=void 0,this._metadata=a,this._transition("success")},this._metadataErrorHandler)})}_oneShotUpload(){this._resolveToken((e,t)=>{const r=hD(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),o=this._ref.storage._makeRequest(r,Ul,e,t);this._request=o,o.getPromise().then(a=>{this._request=void 0,this._metadata=a,this._updateProgress(this._blob.size()),this._transition("success")},this._errorHandler)})}_updateProgress(e){const t=this._transferred;this._transferred=e,this._transferred!==t&&this._notifyObservers()}_transition(e){if(this._state!==e)switch(e){case"canceling":case"pausing":this._state=e,this._request!==void 0?this._request.cancel():this.pendingTimeout&&(clearTimeout(this.pendingTimeout),this.pendingTimeout=void 0,this.completeTransitions_());break;case"running":const t=this._state==="paused";this._state=e,t&&(this._notifyObservers(),this._start());break;case"paused":this._state=e,this._notifyObservers();break;case"canceled":this._error=Nj(),this._state=e,this._notifyObservers();break;case"error":this._state=e,this._notifyObservers();break;case"success":this._state=e,this._notifyObservers();break}}completeTransitions_(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start();break}}get snapshot(){const e=ey(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:e,metadata:this._metadata,task:this,ref:this._ref}}on(e,t,r,o){const a=new gD(t||void 0,r||void 0,o||void 0);return this._addObserver(a),()=>{this._removeObserver(a)}}then(e,t){return this._promise.then(e,t)}catch(e){return this.then(null,e)}_addObserver(e){this._observers.push(e),this._notifyObserver(e)}_removeObserver(e){const t=this._observers.indexOf(e);t!==-1&&this._observers.splice(t,1)}_notifyObservers(){this._finishPromise(),this._observers.slice().forEach(t=>{this._notifyObserver(t)})}_finishPromise(){if(this._resolve!==void 0){let e=!0;switch(ey(this._state)){case _r.SUCCESS:Bl(this._resolve.bind(null,this.snapshot))();break;case _r.CANCELED:case _r.ERROR:const t=this._reject;Bl(t.bind(null,this._error))();break;default:e=!1;break}e&&(this._resolve=void 0,this._reject=void 0)}}_notifyObserver(e){switch(ey(this._state)){case _r.RUNNING:case _r.PAUSED:e.next&&Bl(e.next.bind(e,this.snapshot))();break;case _r.SUCCESS:e.complete&&Bl(e.complete.bind(e))();break;case _r.CANCELED:case _r.ERROR:e.error&&Bl(e.error.bind(e,this._error))();break;default:e.error&&Bl(e.error.bind(e,this._error))()}}resume(){const e=this._state==="paused"||this._state==="pausing";return e&&this._transition("running"),e}pause(){const e=this._state==="running";return e&&this._transition("pausing"),e}cancel(){const e=this._state==="running"||this._state==="pausing";return e&&this._transition("canceling"),e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Da{constructor(e,t){this._service=e,t instanceof Ur?this._location=t:this._location=Ur.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new Da(e,t)}get root(){const e=new Ur(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return $j(this._location.path)}get storage(){return this._service}get parent(){const e=tD(this._location.path);if(e===null)return null;const t=new Ur(this._location.bucket,e);return new Da(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw Bz(e)}}function vD(n,e,t){return n._throwIfRoot("uploadBytesResumable"),new bD(n,new cs(e),t)}function wD(n){n._throwIfRoot("getDownloadURL");const e=uD(n.storage,n._location,Gj());return n.storage.makeRequestWithTokens(e,Ul).then(t=>{if(t===null)throw Az();return t})}function SD(n,e){const t=nD(n._location.path,e),r=new Ur(n._location.bucket,t);return new Da(n.storage,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kD(n){return/^[A-Za-z]+:\/\//.test(n)}function TD(n,e){return new Da(n,e)}function Jj(n,e){if(n instanceof O0){const t=n;if(t._bucket==null)throw Rz();const r=new Da(t,t._bucket);return e!=null?Jj(r,e):r}else return e!==void 0?SD(n,e):n}function _D(n,e){if(e&&kD(e)){if(n instanceof O0)return TD(n,e);throw Jy("To use ref(service, url), the first argument must be a Storage instance.")}else return Jj(n,e)}function yS(n,e){const t=e==null?void 0:e[zj];return t==null?null:Ur.makeFromBucketSpec(t,n)}function jD(n,e,t,r={}){n.host=`${e}:${t}`;const o=jo(e);o&&(wf(`https://${n.host}/b`),dx("Storage",!0)),n._isUsingEmulator=!0,n._protocol=o?"https":"http";const{mockUserToken:a}=r;a&&(n._overrideAuthToken=typeof a=="string"?a:Wk(a,n.app.options.projectId))}class O0{constructor(e,t,r,o,a,c=!1){this.app=e,this._authProvider=t,this._appCheckProvider=r,this._url=o,this._firebaseVersion=a,this._isUsingEmulator=c,this._bucket=null,this._host=Fj,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=bz,this._maxUploadRetryTime=vz,this._requests=new Set,o!=null?this._bucket=Ur.makeFromBucketSpec(o,this._host):this._bucket=yS(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Ur.makeFromBucketSpec(this._url,e):this._bucket=yS(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){mS("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){mS("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(jr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Da(this,e)}_makeRequest(e,t,r,o,a=!0){if(this._deleted)return new Fz(Lj());{const c=Hz(e,this._appId,r,o,t,this._firebaseVersion,a,this._isUsingEmulator);return this._requests.add(c),c.getPromise().then(()=>this._requests.delete(c),()=>this._requests.delete(c)),c}}async makeRequestWithTokens(e,t){const[r,o]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,r,o).getPromise()}}const xS="@firebase/storage",bS="0.13.13";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zj="storage";function ID(n,e,t){return n=Mt(n),vD(n,e,t)}function CD(n){return n=Mt(n),wD(n)}function RD(n,e){return n=Mt(n),_D(n,e)}function ED(n=fx(),e){n=Mt(n);const r=Sc(n,Zj).getImmediate({identifier:e}),o=Mk("storage");return o&&AD(r,...o),r}function AD(n,e,t,r={}){jD(n,e,t,r)}function PD(n,{instanceIdentifier:e}){const t=n.getProvider("app").getImmediate(),r=n.getProvider("auth-internal"),o=n.getProvider("app-check-internal");return new O0(t,r,o,e,La)}function BD(){Ta(new bs(Zj,PD,"PUBLIC").setMultipleInstances(!0)),Oi(xS,bS,""),Oi(xS,bS,"esm2017")}BD();const FD={apiKey:"AIzaSyDi9hdqloCIg_8sfjjyERqnfAr-pW3BeNY",authDomain:"restarter-app.firebaseapp.com",projectId:"restarter-app",storageBucket:"restarter-app.firebasestorage.app",messagingSenderId:"393816322828",appId:"1:393816322828:web:32a9ed91fe95ab9cdd8f29",measurementId:"G-CX4DYFJ5B4"},Po=Kk(FD),Wt=Id(Po),ga=St(Po),zD=ED(Po),ty=[{code:"zh-TW",label:"繁中"},{code:"zh-CN",label:"简中"},{code:"en",label:"EN"},{code:"ja",label:"日本語"},{code:"ko",label:"한국어"},{code:"th",label:"ภาษาไทย"},{code:"vi",label:"Tiếng Việt"},{code:"ms",label:"Bahasa Melayu"},{code:"la",label:"Latīna"}],eI=v.createContext(null),Lt=()=>{const n=v.useContext(eI);if(!n)throw new Error("useLanguage must be used within a LanguageProvider");return n},DD=({children:n})=>{const[e,t]=v.useState(()=>{try{const a=localStorage.getItem("lang");if(a&&ty.some(c=>c.code===a))return a}catch(a){console.warn("Failed to read language from localStorage:",a)}return"zh-TW"});v.useEffect(()=>{try{const a=localStorage.getItem("lang");if(a&&ty.some(m=>m.code===a))return;const c={en:"en","en-US":"en","en-GB":"en","zh-TW":"zh-TW","zh-HK":"zh-TW","zh-Hant":"zh-TW","zh-CN":"zh-CN","zh-Hans":"zh-CN",ja:"ja",ko:"ko",vi:"vi",th:"th",ms:"ms",la:"la"},d=navigator.language||navigator.languages&&navigator.languages[0]||"";let h="en";c[d]?h=c[d]:c[d.split("-")[0]]&&(h=c[d.split("-")[0]]),h!==e&&(t(h),localStorage.setItem("lang",h))}catch(a){console.warn("Failed to detect browser language:",a)}},[]);const o={lang:e,setLang:a=>{try{t(a),localStorage.setItem("lang",a)}catch(c){console.warn("Failed to save language to localStorage:",c)}},LANGS:ty};return i.jsx(eI.Provider,{value:o,children:n})},$n=({className:n="",style:e={}})=>{const{lang:t,setLang:r,LANGS:o}=Lt(),a={padding:"3px 6px",borderRadius:4,fontWeight:600,fontSize:11,border:"1px solid #6B5BFF",color:"#6B5BFF",background:"#fff",cursor:"pointer",transition:"background 0.18s, color 0.18s, border 0.18s",minWidth:e.minWidth!==void 0?e.minWidth:50,...e};return i.jsx("select",{value:t,onChange:c=>r(c.target.value),className:n,style:a,children:o.map(c=>i.jsx("option",{value:c.code,children:c.label},c.code))})},ND=({isOpen:n,onClose:e,title:t,message:r,requiredPlan:o="basic"})=>{const a=Et(),c=window.innerWidth<=768;if(!n)return null;const d={basic:"基礎版 (NT$ 149/月)",advanced:"進階版 (NT$ 249/月)",professional:"專業版 (NT$ 349/月)",unlimited:"無限版 (NT$ 499/月)"};return i.jsx("div",{style:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",background:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e4},children:i.jsxs("div",{style:{background:"#fff",borderRadius:16,padding:c?20:32,maxWidth:400,width:"90%",maxHeight:"80vh",overflowY:"auto",textAlign:"center",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.2)"},children:[i.jsx("div",{style:{fontSize:c?36:48,marginBottom:c?12:16,color:"#6B5BFF"},children:"🚀"}),i.jsx("h2",{style:{fontSize:c?20:24,fontWeight:700,color:"#333",marginBottom:c?8:12},children:t}),i.jsx("p",{style:{fontSize:c?14:16,color:"#666",marginBottom:c?16:20,lineHeight:1.6},children:r}),i.jsxs("div",{style:{background:"linear-gradient(135deg, #f8f9ff 0%, #e8f4ff 100%)",borderRadius:12,padding:c?12:16,marginBottom:c?16:24,border:"1px solid #e0e8ff"},children:[i.jsx("div",{style:{fontSize:c?12:14,color:"#6B5BFF",fontWeight:600,marginBottom:c?6:8},children:"💡 升級小提醒"}),i.jsxs("div",{style:{fontSize:c?11:13,color:"#666",lineHeight:1.4},children:["• 升級後立即生效，無需等待",i.jsx("br",{}),"• 可隨時取消，權益保留至本期結束",i.jsx("br",{}),"• 支援多種付款方式，安全便捷"]})]}),o&&i.jsx("div",{style:{background:"#fff",borderRadius:10,padding:c?10:14,marginBottom:c?16:24,border:"2px solid #6B5BFF",boxShadow:"0 2px 8px #6B5BFF22"},children:i.jsxs("span",{style:{fontSize:c?12:14,color:"#6B5BFF",fontWeight:700},children:["✨ 建議方案：",d[o]," 或更高"]})}),i.jsxs("div",{style:{display:"flex",gap:12,justifyContent:"center"},children:[i.jsx("button",{onClick:()=>{e(),a("/plans")},style:{background:"linear-gradient(135deg, #6B5BFF 0%, #00CFFF 100%)",color:"#fff",border:"none",borderRadius:12,padding:"14px 28px",fontSize:16,fontWeight:700,cursor:"pointer",flex:1,boxShadow:"0 4px 12px #6B5BFF33",transition:"all 0.3s ease"},onMouseEnter:h=>{h.currentTarget.style.transform="translateY(-2px)",h.currentTarget.style.boxShadow="0 6px 16px #6B5BFF44"},onMouseLeave:h=>{h.currentTarget.style.transform="translateY(0)",h.currentTarget.style.boxShadow="0 4px 12px #6B5BFF33"},children:"🚀 立即升級"}),i.jsx("button",{onClick:e,style:{background:"#f8f9ff",color:"#6B5BFF",border:"2px solid #6B5BFF",borderRadius:12,padding:"14px 28px",fontSize:16,fontWeight:600,cursor:"pointer",flex:1,transition:"all 0.3s ease"},onMouseEnter:h=>{h.currentTarget.style.background="#6B5BFF",h.currentTarget.style.color="#fff"},onMouseLeave:h=>{h.currentTarget.style.background="#f8f9ff",h.currentTarget.style.color="#6B5BFF"},children:"💭 稍後再說"})]})]})})},qa=({isOpen:n,onClose:e,currentPlan:t,remainingDays:r,usedTokens:o,totalTokens:a})=>{const c=Et();if(!n)return null;const d={basic:"基礎版",advanced:"進階版",professional:"專業版",unlimited:"無限版"},h={basic:"50K",advanced:"100K",professional:"200K",unlimited:"500K"},m={basic:"NT$ 149",advanced:"NT$ 249",professional:"NT$ 349",unlimited:"NT$ 499"},g=()=>{e(),c("/plans")};return i.jsx("div",{style:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",background:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e4},children:i.jsxs("div",{style:{background:"#fff",borderRadius:20,padding:32,maxWidth:480,width:"90%",textAlign:"center",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.2)"},children:[i.jsx("h2",{style:{fontSize:24,fontWeight:700,color:"#333",marginBottom:12},children:"Token 已用完，需要續購嗎？"}),i.jsxs("p",{style:{fontSize:16,color:"#666",marginBottom:20,lineHeight:1.6},children:["您的 ",d[t]," 方案 Token 已用完，但還有 ",r," 天到期。"]}),i.jsxs("div",{style:{background:"linear-gradient(135deg, #f8f9ff 0%, #e8f4ff 100%)",borderRadius:12,padding:16,marginBottom:24,border:"1px solid #e0e8ff"},children:[i.jsx("div",{style:{fontSize:14,color:"#6B5BFF",fontWeight:600,marginBottom:8},children:"📊 本月使用狀況"}),i.jsxs("div",{style:{fontSize:13,color:"#666",lineHeight:1.4},children:["• 已使用：",Math.round(o/1e3),"K / ",Math.round(a/1e3),"K tokens",i.jsx("br",{}),"• 剩餘天數：",r," 天",i.jsx("br",{}),"• 當前方案：",d[t]]})]}),i.jsxs("div",{style:{background:"#fff",borderRadius:12,padding:20,marginBottom:24,border:"2px solid #6B5BFF",boxShadow:"0 2px 8px #6B5BFF22"},children:[i.jsx("div",{style:{fontSize:16,color:"#6B5BFF",fontWeight:700,marginBottom:12},children:"💡 續購方案"}),i.jsxs("div",{style:{fontSize:14,color:"#666",lineHeight:1.5,marginBottom:16},children:[i.jsx("strong",{children:"立即續購："}),"重新獲得 ",h[t]," tokens，",i.jsx("br",{}),"並從今天開始重新計算 ",r," 天使用期"]}),i.jsx("div",{style:{fontSize:18,fontWeight:700,color:"#6B5BFF"},children:m[t]})]}),i.jsxs("div",{style:{background:"linear-gradient(135deg, #fff3cd 0%, #ffeaa7 100%)",borderRadius:12,padding:16,marginBottom:24,border:"1px solid #ffeaa7"},children:[i.jsx("div",{style:{fontSize:14,color:"#856404",fontWeight:600,marginBottom:8},children:"✨ 續購好處"}),i.jsxs("div",{style:{fontSize:13,color:"#856404",lineHeight:1.4},children:["• 立即恢復語音功能使用",i.jsx("br",{}),"• 時間從今天重新計算，更划算",i.jsx("br",{}),"• 文字功能不受影響，可繼續使用"]})]}),i.jsxs("div",{style:{display:"flex",gap:12,justifyContent:"center"},children:[i.jsx("button",{onClick:g,style:{background:"linear-gradient(135deg, #6B5BFF 0%, #00CFFF 100%)",color:"#fff",border:"none",borderRadius:12,padding:"14px 28px",fontSize:16,fontWeight:700,cursor:"pointer",flex:1,boxShadow:"0 4px 12px #6B5BFF33",transition:"all 0.3s ease"},onMouseEnter:x=>{x.currentTarget.style.transform="translateY(-2px)",x.currentTarget.style.boxShadow="0 6px 16px #6B5BFF44"},onMouseLeave:x=>{x.currentTarget.style.transform="translateY(0)",x.currentTarget.style.boxShadow="0 4px 12px #6B5BFF33"},children:"⚡ 立即續購"}),i.jsx("button",{onClick:e,style:{background:"#f8f9ff",color:"#6B5BFF",border:"2px solid #6B5BFF",borderRadius:12,padding:"14px 28px",fontSize:16,fontWeight:600,cursor:"pointer",flex:1,transition:"all 0.3s ease"},onMouseEnter:x=>{x.currentTarget.style.background="#6B5BFF",x.currentTarget.style.color="#fff"},onMouseLeave:x=>{x.currentTarget.style.background="#f8f9ff",x.currentTarget.style.color="#6B5BFF"},children:"💫 稍後再說"})]}),i.jsx("div",{style:{marginTop:16},children:i.jsx("button",{onClick:e,style:{background:"none",border:"none",color:"#888",fontSize:14,cursor:"pointer",textDecoration:"underline"},children:"稍後再說"})})]})})},MD={production:{baseURL:"https://restarter-backend-6e9s.onrender.com/api",wsURL:"wss://restarter-backend-6e9s.onrender.com"}},tI=MD.production,nI=tI.baseURL,rI=tI.wsURL,Qu=n=>`${nI}${n}`,LD=()=>rI;console.log("🌍 環境:","生產");console.log("🔗 API URL:",nI);console.log("🔌 WebSocket URL:",rI);const vS=({className:n="",showDetails:e=!1})=>{const{lang:t}=Lt(),[r,o]=v.useState(null),[a,c]=v.useState(!0),[d,h]=v.useState(null);v.useEffect(()=>{m()},[t]);const m=async()=>{try{c(!0),h(null);const S="Taipei";console.log("Fetching weather for:",S);const j=await fetch(Qu(`/weather/current?city=${S}`));if(!j.ok)throw new Error(`HTTP error! status: ${j.status}`);const T=await j.json();if(console.log("Weather API response:",T),T.weather){const R=g(T.weather,t);console.log("Localized weather:",R),o(R)}else h(T.error||"無法獲取天氣資訊")}catch(S){h("天氣服務暫時無法使用"),console.error("Weather fetch error:",S)}finally{c(!1)}},g=(S,j)=>{var H,J,O;const T={"zh-TW":{"clear sky":"晴天","few clouds":"少雲","scattered clouds":"多雲","broken clouds":"陰天","shower rain":"陣雨",rain:"下雨",thunderstorm:"雷雨",snow:"下雪",haze:"霾",smoke:"煙霧",dust:"沙塵",sand:"沙塵",ash:"火山灰",squall:"狂風",tornado:"龍捲風",sunny:"晴天","partly cloudy":"多雲時晴",cloudy:"陰天",overcast:"陰天",mist:"霧",fog:"霧","patchy rain possible":"可能有陣雨","patchy snow possible":"可能有雪","patchy sleet possible":"可能有雨夾雪","patchy freezing drizzle possible":"可能有凍雨","thundery outbreaks possible":"可能有雷雨","blowing snow":"吹雪",blizzard:"暴風雪","freezing fog":"凍霧","patchy light drizzle":"零星小雨","light drizzle":"小雨","freezing drizzle":"凍雨","heavy freezing drizzle":"強凍雨","patchy light rain":"零星小雨","light rain":"小雨","moderate rain at times":"間歇性中雨","moderate rain":"中雨","heavy rain at times":"間歇性大雨","heavy rain":"大雨","light freezing rain":"輕凍雨","moderate or heavy freezing rain":"中到強凍雨","light sleet":"輕雨夾雪","moderate or heavy sleet":"中到強雨夾雪","patchy light snow":"零星小雪","light snow":"小雪","patchy moderate snow":"零星中雪","moderate snow":"中雪","patchy heavy snow":"零星大雪","heavy snow":"大雪","ice pellets":"冰雹","light rain shower":"小雨陣","moderate or heavy rain shower":"中到強雨陣","torrential rain shower":"暴雨陣","light sleet showers":"小雨夾雪陣","moderate or heavy sleet showers":"中到強雨夾雪陣","light snow showers":"小雪陣","moderate or heavy snow showers":"中到強雪陣","light showers of ice pellets":"輕冰雹陣","moderate or heavy showers of ice pellets":"中到強冰雹陣","patchy light rain with thunder":"零星小雨伴雷","moderate or heavy rain with thunder":"中到強雨伴雷","patchy light snow with thunder":"零星小雪伴雷","moderate or heavy snow with thunder":"中到強雪伴雷",局部多云:"局部多云"},"zh-CN":{"clear sky":"晴天","few clouds":"少云","scattered clouds":"多云","broken clouds":"阴天","shower rain":"阵雨",rain:"下雨",thunderstorm:"雷雨",snow:"下雪",haze:"霾",smoke:"烟雾",dust:"沙尘",sand:"沙尘",ash:"火山灰",squall:"狂风",tornado:"龙卷风",sunny:"晴天","partly cloudy":"多云时晴",cloudy:"阴天",overcast:"阴天",mist:"雾",fog:"雾","patchy rain possible":"可能有阵雨","patchy snow possible":"可能有雪","patchy sleet possible":"可能有雨夹雪","patchy freezing drizzle possible":"可能有冻雨","thundery outbreaks possible":"可能有雷雨","blowing snow":"吹雪",blizzard:"暴风雪","freezing fog":"冻雾","patchy light drizzle":"零星小雨","light drizzle":"小雨","freezing drizzle":"冻雨","heavy freezing drizzle":"强冻雨","patchy light rain":"零星小雨","light rain":"小雨","moderate rain at times":"间歇性中雨","moderate rain":"中雨","heavy rain at times":"间歇性大雨","heavy rain":"大雨","light freezing rain":"轻冻雨","moderate or heavy freezing rain":"中到强冻雨","light sleet":"轻雨夹雪","moderate or heavy sleet":"中到强雨夹雪","patchy light snow":"零星小雪","light snow":"小雪","patchy moderate snow":"零星中雪","moderate snow":"中雪","patchy heavy snow":"零星大雪","heavy snow":"大雪","ice pellets":"冰雹","light rain shower":"小雨阵","moderate or heavy rain shower":"中到强雨阵","torrential rain shower":"暴雨阵","light sleet showers":"小雨夹雪阵","moderate or heavy sleet showers":"中到强雨夹雪阵","light snow showers":"小雪阵","moderate or heavy snow showers":"中到强雪阵","light showers of ice pellets":"轻冰雹阵","moderate or heavy showers of ice pellets":"中到强冰雹阵","patchy light rain with thunder":"零星小雨伴雷","moderate or heavy rain with thunder":"中到强雨伴雷","patchy light snow with thunder":"零星小雪伴雷","moderate or heavy snow with thunder":"中到强雪伴雷",局部多云:"Partly Cloudy"},en:{"clear sky":"Clear","few clouds":"Partly Cloudy","scattered clouds":"Cloudy","broken clouds":"Overcast","shower rain":"Showers",rain:"Rain",thunderstorm:"Thunderstorm",snow:"Snow",haze:"Haze",smoke:"Smoke",dust:"Dust",sand:"Sand",ash:"Ash",squall:"Squall",tornado:"Tornado",sunny:"Sunny","partly cloudy":"Partly Cloudy",cloudy:"Cloudy",overcast:"Overcast",mist:"Mist",fog:"Fog","patchy rain possible":"Patchy Rain","patchy snow possible":"Patchy Snow","patchy sleet possible":"Patchy Sleet","patchy freezing drizzle possible":"Patchy Freezing Drizzle","thundery outbreaks possible":"Thundery Outbreaks","blowing snow":"Blowing Snow",blizzard:"Blizzard","freezing fog":"Freezing Fog","patchy light drizzle":"Patchy Light Drizzle","light drizzle":"Light Drizzle","freezing drizzle":"Freezing Drizzle","heavy freezing drizzle":"Heavy Freezing Drizzle","patchy light rain":"Patchy Light Rain","light rain":"Light Rain","moderate rain at times":"Moderate Rain","moderate rain":"Moderate Rain","heavy rain at times":"Heavy Rain","heavy rain":"Heavy Rain","light freezing rain":"Light Freezing Rain","moderate or heavy freezing rain":"Moderate or Heavy Freezing Rain","light sleet":"Light Sleet","moderate or heavy sleet":"Moderate or Heavy Sleet","patchy light snow":"Patchy Light Snow","light snow":"Light Snow","patchy moderate snow":"Patchy Moderate Snow","moderate snow":"Moderate Snow","patchy heavy snow":"Patchy Heavy Snow","heavy snow":"Heavy Snow","ice pellets":"Ice Pellets","light rain shower":"Light Rain Shower","moderate or heavy rain shower":"Moderate or Heavy Rain Shower","torrential rain shower":"Torrential Rain Shower","light sleet showers":"Light Sleet Showers","moderate or heavy sleet showers":"Moderate or Heavy Sleet Showers","light snow showers":"Light Snow Showers","moderate or heavy snow showers":"Moderate or Heavy Snow Showers","light showers of ice pellets":"Light Ice Pellet Showers","moderate or heavy showers of ice pellets":"Moderate or Heavy Ice Pellet Showers","patchy light rain with thunder":"Patchy Light Rain with Thunder","moderate or heavy rain with thunder":"Moderate or Heavy Rain with Thunder","patchy light snow with thunder":"Patchy Light Snow with Thunder","moderate or heavy snow with thunder":"Moderate or Heavy Snow with Thunder",局部多云:"Partly Cloudy"},ja:{"clear sky":"晴天","few clouds":"晴れ時々曇り","scattered clouds":"曇り","broken clouds":"曇り","shower rain":"にわか雨",rain:"雨",thunderstorm:"雷雨",snow:"雪",haze:"もや",smoke:"煙",dust:"砂塵",sand:"砂塵",ash:"火山灰",squall:"突風",tornado:"竜巻",sunny:"晴天","partly cloudy":"晴れ時々曇り",cloudy:"曇り",overcast:"曇り",mist:"霧",fog:"霧","patchy rain possible":"にわか雨の可能性","patchy snow possible":"にわか雪の可能性","patchy sleet possible":"にわかみぞれの可能性","patchy freezing drizzle possible":"にわか凍る霧雨の可能性","thundery outbreaks possible":"雷雨の可能性","blowing snow":"吹雪",blizzard:"猛吹雪","freezing fog":"凍る霧","patchy light drizzle":"にわか小雨","light drizzle":"小雨","freezing drizzle":"凍る霧雨","heavy freezing drizzle":"強い凍る霧雨","patchy light rain":"にわか小雨","light rain":"小雨","moderate rain at times":"時々中雨","moderate rain":"中雨","heavy rain at times":"時々大雨","heavy rain":"大雨","light freezing rain":"軽い凍る雨","moderate or heavy freezing rain":"中程度または強い凍る雨","light sleet":"軽いみぞれ","moderate or heavy sleet":"中程度または強いみぞれ","patchy light snow":"にわか小雪","light snow":"小雪","patchy moderate snow":"にわか中雪","moderate snow":"中雪","patchy heavy snow":"にわか大雪","heavy snow":"大雪","ice pellets":"氷の粒","light rain shower":"小雨のシャワー","moderate or heavy rain shower":"中程度または強い雨のシャワー","torrential rain shower":"豪雨のシャワー","light sleet showers":"軽いみぞれのシャワー","moderate or heavy sleet showers":"中程度または強いみぞれのシャワー","light snow showers":"小雪のシャワー","moderate or heavy snow showers":"中程度または強い雪のシャワー","light showers of ice pellets":"軽い氷の粒のシャワー","moderate or heavy showers of ice pellets":"中程度または強い氷の粒のシャワー","patchy light rain with thunder":"にわか小雨と雷","moderate or heavy rain with thunder":"中程度または強い雨と雷","patchy light snow with thunder":"にわか小雪と雷","moderate or heavy snow with thunder":"中程度または強い雪と雷",局部多云:"晴れ時々曇り"},ko:{"clear sky":"맑음","few clouds":"구름 조금","scattered clouds":"구름 많음","broken clouds":"흐림","shower rain":"소나기",rain:"비",thunderstorm:"천둥번개",snow:"눈",haze:"연무",smoke:"연기",dust:"먼지",sand:"모래",ash:"화산재",squall:"돌풍",tornado:"토네이도",sunny:"맑음","partly cloudy":"구름 조금",cloudy:"흐림",overcast:"흐림",mist:"안개",fog:"안개","patchy rain possible":"소나기 가능","patchy snow possible":"눈 가능","patchy sleet possible":"진눈깨비 가능","patchy freezing drizzle possible":"얼음비 가능","thundery outbreaks possible":"천둥번개 가능","blowing snow":"눈보라",blizzard:"폭설","freezing fog":"얼음안개","patchy light drizzle":"가벼운 이슬비","light drizzle":"이슬비","freezing drizzle":"얼음비","heavy freezing drizzle":"강한 얼음비","patchy light rain":"가벼운 비","light rain":"가벼운 비","moderate rain at times":"중간 비","moderate rain":"중간 비","heavy rain at times":"강한 비","heavy rain":"강한 비","light freezing rain":"가벼운 얼음비","moderate or heavy freezing rain":"중간 또는 강한 얼음비","light sleet":"가벼운 진눈깨비","moderate or heavy sleet":"중간 또는 강한 진눈깨비","patchy light snow":"가벼운 눈","light snow":"가벼운 눈","patchy moderate snow":"중간 눈","moderate snow":"중간 눈","patchy heavy snow":"강한 눈","heavy snow":"강한 눈","ice pellets":"얼음알갱이","light rain shower":"가벼운 소나기","moderate or heavy rain shower":"중간 또는 강한 소나기","torrential rain shower":"폭우","light sleet showers":"가벼운 진눈깨비 소나기","moderate or heavy sleet showers":"중간 또는 강한 진눈깨비 소나기","light snow showers":"가벼운 눈 소나기","moderate or heavy snow showers":"중간 또는 강한 눈 소나기","light showers of ice pellets":"가벼운 얼음알갱이 소나기","moderate or heavy showers of ice pellets":"중간 또는 강한 얼음알갱이 소나기","patchy light rain with thunder":"가벼운 비와 천둥","moderate or heavy rain with thunder":"중간 또는 강한 비와 천둥","patchy light snow with thunder":"가벼운 눈과 천둥","moderate or heavy snow with thunder":"중간 또는 강한 눈과 천둥",局部多云:"구름 조금"},th:{"clear sky":"ท้องฟ้าแจ่มใส","few clouds":"มีเมฆบางส่วน","scattered clouds":"มีเมฆมาก","broken clouds":"เมฆมาก","shower rain":"ฝนตกเป็นช่วง",rain:"ฝนตก",thunderstorm:"พายุฝนฟ้าคะนอง",snow:"หิมะตก",haze:"หมอกควัน",smoke:"ควัน",dust:"ฝุ่น",sand:"ทราย",ash:"เถ้าถ่าน",squall:"ลมกระโชก",tornado:"พายุทอร์นาโด",sunny:"ท้องฟ้าแจ่มใส","partly cloudy":"มีเมฆบางส่วน",cloudy:"เมฆมาก",overcast:"เมฆมาก",mist:"หมอก",fog:"หมอก","patchy rain possible":"อาจมีฝนตกเป็นช่วง","patchy snow possible":"อาจมีหิมะตกเป็นช่วง","patchy sleet possible":"อาจมีหิมะปนฝนเป็นช่วง","patchy freezing drizzle possible":"อาจมีน้ำค้างแข็งเป็นช่วง","thundery outbreaks possible":"อาจมีพายุฝนฟ้าคะนอง","blowing snow":"หิมะปลิว",blizzard:"พายุหิมะ","freezing fog":"หมอกแข็ง","patchy light drizzle":"น้ำค้างเบาเป็นช่วง","light drizzle":"น้ำค้างเบา","freezing drizzle":"น้ำค้างแข็ง","heavy freezing drizzle":"น้ำค้างแข็งแรง","patchy light rain":"ฝนเบาเป็นช่วง","light rain":"ฝนเบา","moderate rain at times":"ฝนปานกลางเป็นครั้งคราว","moderate rain":"ฝนปานกลาง","heavy rain at times":"ฝนแรงเป็นครั้งคราว","heavy rain":"ฝนแรง","light freezing rain":"ฝนแข็งเบา","moderate or heavy freezing rain":"ฝนแข็งปานกลางหรือแรง","light sleet":"หิมะปนฝนเบา","moderate or heavy sleet":"หิมะปนฝนปานกลางหรือแรง","patchy light snow":"หิมะเบาเป็นช่วง","light snow":"หิมะเบา","patchy moderate snow":"หิมะปานกลางเป็นช่วง","moderate snow":"หิมะปานกลาง","patchy heavy snow":"หิมะแรงเป็นช่วง","heavy snow":"หิมะแรง","ice pellets":"ลูกเห็บ","light rain shower":"ฝนเบาสั้นๆ","moderate or heavy rain shower":"ฝนปานกลางหรือแรงสั้นๆ","torrential rain shower":"ฝนแรงสั้นๆ","light sleet showers":"หิมะปนฝนเบาสั้นๆ","moderate or heavy sleet showers":"หิมะปนฝนปานกลางหรือแรงสั้นๆ","light snow showers":"หิมะเบาสั้นๆ","moderate or heavy snow showers":"หิมะปานกลางหรือแรงสั้นๆ","light showers of ice pellets":"ลูกเห็บเบาสั้นๆ","moderate or heavy showers of ice pellets":"ลูกเห็บปานกลางหรือแรงสั้นๆ","patchy light rain with thunder":"ฝนเบาเป็นช่วงพร้อมฟ้าผ่า","moderate or heavy rain with thunder":"ฝนปานกลางหรือแรงพร้อมฟ้าผ่า","patchy light snow with thunder":"หิมะเบาเป็นช่วงพร้อมฟ้าผ่า","moderate or heavy snow with thunder":"หิมะปานกลางหรือแรงพร้อมฟ้าผ่า",局部多云:"มีเมฆบางส่วน"},vi:{"clear sky":"Trời quang","few clouds":"Ít mây","scattered clouds":"Nhiều mây","broken clouds":"U ám","shower rain":"Mưa rào",rain:"Mưa",thunderstorm:"Giông bão",snow:"Tuyết",haze:"Sương mù nhẹ",smoke:"Khói",dust:"Bụi",sand:"Cát",ash:"Tro núi lửa",squall:"Gió mạnh",tornado:"Lốc xoáy",sunny:"Trời nắng","partly cloudy":"Ít mây",cloudy:"Nhiều mây",overcast:"U ám",mist:"Sương mù",fog:"Sương mù","patchy rain possible":"Có thể mưa rào","patchy snow possible":"Có thể có tuyết","patchy sleet possible":"Có thể có mưa tuyết","patchy freezing drizzle possible":"Có thể có mưa đá","thundery outbreaks possible":"Có thể có giông bão","blowing snow":"Tuyết bay",blizzard:"Bão tuyết","freezing fog":"Sương mù đóng băng","patchy light drizzle":"Mưa phùn nhẹ","light drizzle":"Mưa phùn nhẹ","freezing drizzle":"Mưa đá","heavy freezing drizzle":"Mưa đá mạnh","patchy light rain":"Mưa nhẹ","light rain":"Mưa nhẹ","moderate rain at times":"Mưa vừa","moderate rain":"Mưa vừa","heavy rain at times":"Mưa to","heavy rain":"Mưa to","light freezing rain":"Mưa đá nhẹ","moderate or heavy freezing rain":"Mưa đá vừa hoặc mạnh","light sleet":"Mưa tuyết nhẹ","moderate or heavy sleet":"Mưa tuyết vừa hoặc mạnh","patchy light snow":"Tuyết nhẹ","light snow":"Tuyết nhẹ","patchy moderate snow":"Tuyết vừa","moderate snow":"Tuyết vừa","patchy heavy snow":"Tuyết to","heavy snow":"Tuyết to","ice pellets":"Mưa đá","light rain shower":"Mưa rào nhẹ","moderate or heavy rain shower":"Mưa rào vừa hoặc mạnh","torrential rain shower":"Mưa rào to","light sleet showers":"Mưa tuyết nhẹ","moderate or heavy sleet showers":"Mưa tuyết vừa hoặc mạnh","light snow showers":"Tuyết nhẹ","moderate or heavy snow showers":"Tuyết vừa hoặc mạnh","light showers of ice pellets":"Mưa đá nhẹ","moderate or heavy showers of ice pellets":"Mưa đá vừa hoặc mạnh","patchy light rain with thunder":"Mưa nhẹ có sấm","moderate or heavy rain with thunder":"Mưa vừa hoặc mạnh có sấm","patchy light snow with thunder":"Tuyết nhẹ có sấm","moderate or heavy snow with thunder":"Tuyết vừa hoặc mạnh có sấm",局部多云:"Ít mây"},ms:{"clear sky":"Cerah","few clouds":"Sedikit berawan","scattered clouds":"Berawan","broken clouds":"Mendung","shower rain":"Hujan renyai",rain:"Hujan",thunderstorm:"Ribut petir",snow:"Salji",haze:"Jerebu",smoke:"Asap",dust:"Debu",sand:"Pasir",ash:"Abu gunung berapi",squall:"Angin kencang",tornado:"Puting beliung",sunny:"Cerah","partly cloudy":"Sedikit berawan",cloudy:"Berawan",overcast:"Mendung",mist:"Kabut",fog:"Kabut","patchy rain possible":"Hujan renyai mungkin","patchy snow possible":"Salji mungkin","patchy sleet possible":"Hujan salji mungkin","patchy freezing drizzle possible":"Hujan beku mungkin","thundery outbreaks possible":"Ribut petir mungkin","blowing snow":"Salji berterbangan",blizzard:"Ribut salji","freezing fog":"Kabut beku","patchy light drizzle":"Hujan renyai ringan","light drizzle":"Hujan renyai ringan","freezing drizzle":"Hujan beku","heavy freezing drizzle":"Hujan beku lebat","patchy light rain":"Hujan ringan","light rain":"Hujan ringan","moderate rain at times":"Hujan sederhana","moderate rain":"Hujan sederhana","heavy rain at times":"Hujan lebat","heavy rain":"Hujan lebat","light freezing rain":"Hujan beku ringan","moderate or heavy freezing rain":"Hujan beku sederhana atau lebat","light sleet":"Hujan salji ringan","moderate or heavy sleet":"Hujan salji sederhana atau lebat","patchy light snow":"Salji ringan","light snow":"Salji ringan","patchy moderate snow":"Salji sederhana","moderate snow":"Salji sederhana","patchy heavy snow":"Salji lebat","heavy snow":"Salji lebat","ice pellets":"Hujan batu","light rain shower":"Hujan ringan","moderate or heavy rain shower":"Hujan sederhana atau lebat","torrential rain shower":"Hujan lebat","light sleet showers":"Hujan salji ringan","moderate or heavy sleet showers":"Hujan salji sederhana atau lebat","light snow showers":"Salji ringan","moderate or heavy snow showers":"Salji sederhana atau lebat","light showers of ice pellets":"Hujan batu ringan","moderate or heavy showers of ice pellets":"Hujan batu sederhana atau lebat","patchy light rain with thunder":"Hujan ringan dengan petir","moderate or heavy rain with thunder":"Hujan sederhana atau lebat dengan petir","patchy light snow with thunder":"Salji ringan dengan petir","moderate or heavy snow with thunder":"Salji sederhana atau lebat dengan petir",局部多云:"Sedikit berawan"},la:{"clear sky":"Serenum","few clouds":"Nubibus paucis","scattered clouds":"Nubibus dispersis","broken clouds":"Nubibus fractis","shower rain":"Imbre",rain:"Pluvia",thunderstorm:"Tempestas",snow:"Nix",haze:"Caligo",smoke:"Fumus",dust:"Pulvis",sand:"Arena",ash:"Cinis",squall:"Procella",tornado:"Turbo",sunny:"Serenum","partly cloudy":"Nubibus paucis",cloudy:"Nubibus",overcast:"Nubibus densis",mist:"Nebula",fog:"Nebula","patchy rain possible":"Imbre possibilis","patchy snow possible":"Nix possibilis","patchy sleet possible":"Nix pluvia possibilis","patchy freezing drizzle possible":"Gelida pluvia possibilis","thundery outbreaks possible":"Tempestas possibilis","blowing snow":"Nix ventosa",blizzard:"Procella nivis","freezing fog":"Gelida nebula","patchy light drizzle":"Levis pluvia","light drizzle":"Levis pluvia","freezing drizzle":"Gelida pluvia","heavy freezing drizzle":"Gravis gelida pluvia","patchy light rain":"Levis pluvia","light rain":"Levis pluvia","moderate rain at times":"Moderata pluvia","moderate rain":"Moderata pluvia","heavy rain at times":"Gravis pluvia","heavy rain":"Gravis pluvia","light freezing rain":"Levis gelida pluvia","moderate or heavy freezing rain":"Moderata vel gravis gelida pluvia","light sleet":"Levis nix pluvia","moderate or heavy sleet":"Moderata vel gravis nix pluvia","patchy light snow":"Levis nix","light snow":"Levis nix","patchy moderate snow":"Moderata nix","moderate snow":"Moderata nix","patchy heavy snow":"Gravis nix","heavy snow":"Gravis nix","ice pellets":"Glacies grana","light rain shower":"Levis pluvia","moderate or heavy rain shower":"Moderata vel gravis pluvia","torrential rain shower":"Torrens pluvia","light sleet showers":"Levis nix pluvia","moderate or heavy sleet showers":"Moderata vel gravis nix pluvia","light snow showers":"Levis nix","moderate or heavy snow showers":"Moderata vel gravis nix","light showers of ice pellets":"Levis glacies grana","moderate or heavy showers of ice pellets":"Moderata vel gravis glacies grana","patchy light rain with thunder":"Levis pluvia cum tonitru","moderate or heavy rain with thunder":"Moderata vel gravis pluvia cum tonitru","patchy light snow with thunder":"Levis nix cum tonitru","moderate or heavy snow with thunder":"Moderata vel gravis nix cum tonitru",局部多云:"Nubibus paucis"}},R={"zh-TW":{Taipei:"台北市",Taichung:"台中市",Tainan:"台南市",Kaohsiung:"高雄市","New Taipei":"新北市",Taoyuan:"桃園市",Hsinchu:"新竹市",Chiayi:"嘉義市",Keelung:"基隆市",Hualien:"花蓮縣",Taitung:"台東縣",Pingtung:"屏東縣",Yilan:"宜蘭縣",Nantou:"南投縣",Yunlin:"雲林縣",Changhua:"彰化縣",Miaoli:"苗栗縣"},"zh-CN":{Taipei:"台北市",Taichung:"台中市",Tainan:"台南市",Kaohsiung:"高雄市","New Taipei":"新北市",Taoyuan:"桃园市",Hsinchu:"新竹市",Chiayi:"嘉义市",Keelung:"基隆市",Hualien:"花莲县",Taitung:"台东县",Pingtung:"屏东县",Yilan:"宜兰县",Nantou:"南投县",Yunlin:"云林县",Changhua:"彰化县",Miaoli:"苗栗县"},en:{Taipei:"Taipei",Taichung:"Taichung",Tainan:"Tainan",Kaohsiung:"Kaohsiung","New Taipei":"New Taipei",Taoyuan:"Taoyuan",Hsinchu:"Hsinchu",Chiayi:"Chiayi",Keelung:"Keelung",Hualien:"Hualien",Taitung:"Taitung",Pingtung:"Pingtung",Yilan:"Yilan",Nantou:"Nantou",Yunlin:"Yunlin",Changhua:"Changhua",Miaoli:"Miaoli"},ja:{Taipei:"台北",Taichung:"台中",Tainan:"台南",Kaohsiung:"高雄","New Taipei":"新北",Taoyuan:"桃園",Hsinchu:"新竹",Chiayi:"嘉義",Keelung:"基隆",Hualien:"花蓮",Taitung:"台東",Pingtung:"屏東",Yilan:"宜蘭",Nantou:"南投",Yunlin:"雲林",Changhua:"彰化",Miaoli:"苗栗"},ko:{Taipei:"타이페이",Taichung:"타이중",Tainan:"타이난",Kaohsiung:"가오슝","New Taipei":"신베이",Taoyuan:"타오위안",Hsinchu:"신주",Chiayi:"자이",Keelung:"지룽",Hualien:"화롄",Taitung:"타이둥",Pingtung:"핑둥",Yilan:"이란",Nantou:"난터우",Yunlin:"윈린",Changhua:"창화",Miaoli:"먀오리"},th:{Taipei:"ไทเป",Taichung:"ไทจง",Tainan:"ไทหนาน",Kaohsiung:"เกาสง","New Taipei":"ซินเป่ย์",Taoyuan:"เถาหยวน",Hsinchu:"ซินจู๋",Chiayi:"เจียอี้",Keelung:"จีหลง",Hualien:"ฮวาเหลียน",Taitung:"ไถตง",Pingtung:"ผิงตง",Yilan:"อี๋หลาน",Nantou:"หนานโถว",Yunlin:"ยฺหวินหลิน",Changhua:"จางฮัว",Miaoli:"เหมียวลี่"},vi:{Taipei:"Đài Bắc",Taichung:"Đài Trung",Tainan:"Đài Nam",Kaohsiung:"Cao Hùng","New Taipei":"Tân Bắc",Taoyuan:"Đào Viên",Hsinchu:"Tân Trúc",Chiayi:"Gia Nghĩa",Keelung:"Cơ Long",Hualien:"Hoa Liên",Taitung:"Đài Đông",Pingtung:"Bình Đông",Yilan:"Nghi Lan",Nantou:"Nam Đầu",Yunlin:"Vân Lâm",Changhua:"Chương Hóa",Miaoli:"Miêu Lật"},ms:{Taipei:"Taipei",Taichung:"Taichung",Tainan:"Tainan",Kaohsiung:"Kaohsiung","New Taipei":"New Taipei",Taoyuan:"Taoyuan",Hsinchu:"Hsinchu",Chiayi:"Chiayi",Keelung:"Keelung",Hualien:"Hualien",Taitung:"Taitung",Pingtung:"Pingtung",Yilan:"Yilan",Nantou:"Nantou",Yunlin:"Yunlin",Changhua:"Changhua",Miaoli:"Miaoli"},la:{Taipei:"Taipeium",Taichung:"Taichungum",Tainan:"Tainanum",Kaohsiung:"Kaohsiungum","New Taipei":"Novum Taipeium",Taoyuan:"Taoyuanum",Hsinchu:"Hsinchuum",Chiayi:"Chiayium",Keelung:"Keelungum",Hualien:"Hualienum",Taitung:"Taitungum",Pingtung:"Pingtungum",Yilan:"Yilanum",Nantou:"Nantouum",Yunlin:"Yunlinum",Changhua:"Changhuaum",Miaoli:"Miaolium"}},I={"zh-TW":["星期日","星期一","星期二","星期三","星期四","星期五","星期六"],"zh-CN":["星期日","星期一","星期二","星期三","星期四","星期五","星期六"],en:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],ja:["日曜日","月曜日","火曜日","水曜日","木曜日","金曜日","土曜日"],ko:["일요일","월요일","화요일","수요일","목요일","금요일","토요일"],th:["วันอาทิตย์","วันจันทร์","วันอังคาร","วันพุธ","วันพฤหัสบดี","วันศุกร์","วันเสาร์"],vi:["Chủ nhật","Thứ hai","Thứ ba","Thứ tư","Thứ năm","Thứ sáu","Thứ bảy"],ms:["Ahad","Isnin","Selasa","Rabu","Khamis","Jumaat","Sabtu"],la:["Dies Solis","Dies Lunae","Dies Martis","Dies Mercurii","Dies Iovis","Dies Veneris","Dies Saturni"]},F=((H=T[j])==null?void 0:H[S.description.toLowerCase()])||S.description,P=((J=R[j])==null?void 0:J[S.city])||S.city,z=((O=I[j])==null?void 0:O[new Date().getDay()])||I.en[new Date().getDay()];return{...S,description:F,city:P,weekday:z}};if(a)return i.jsx("div",{className:`weather-widget ${n}`,style:{background:"#ffffff",borderRadius:"8px",padding:"8px 12px",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.1)",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',marginTop:"8px"},children:i.jsx("div",{style:{fontSize:"12px",color:"#666",textAlign:"center"},children:"載入中..."})});if(d)return i.jsx("div",{className:`weather-widget ${n}`,style:{background:"#ffffff",borderRadius:"8px",padding:"8px 12px",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.1)",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',marginTop:"8px"},children:i.jsx("div",{style:{fontSize:"12px",color:"#ff6b6b",textAlign:"center"},children:d})});if(!r)return null;const x=g(r,t);return i.jsx("div",{className:`weather-widget ${n}`,style:{background:"#ffffff",borderRadius:"8px",padding:"8px 12px",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.1)",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',marginTop:"8px"},children:i.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:"8px"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"4px"},children:[i.jsx("span",{style:{fontSize:"16px"},children:"☀️"}),i.jsxs("div",{style:{fontSize:"14px",fontWeight:600,color:"#6B5BFF"},children:[x.temp,"°C"]}),i.jsx("div",{style:{fontSize:"10px",color:"#666"},children:x.description})]}),i.jsx("div",{style:{fontSize:"12px",color:"#666"},children:x.city}),i.jsx("div",{style:{fontSize:"12px",color:"#666"},children:x.weekday})]})})},wS={"zh-TW":{privacy:"隱私權政策",terms:"條款/聲明",deletion:"資料刪除說明"},"zh-CN":{privacy:"隐私政策",terms:"条款/声明",deletion:"数据删除说明"},en:{privacy:"Privacy Policy",terms:"Terms/Statement",deletion:"Data Deletion"},ja:{privacy:"プライバシーポリシー",terms:"規約/声明",deletion:"データ削除について"},ko:{privacy:"개인정보 처리방침",terms:"약관/성명",deletion:"데이터 삭제 안내"},th:{privacy:"นโยบายความเป็นส่วนตัว",terms:"ข้อกำหนด/แถลงการณ์",deletion:"คำอธิบายการลบข้อมูล"},vi:{privacy:"Chính sách bảo mật",terms:"Điều khoản/Tuyên bố",deletion:"Giải thích xóa dữ liệu"},ms:{privacy:"Dasar Privasi",terms:"Terma/Pernyataan",deletion:"Penjelasan Penghapusan Data"},la:{privacy:"Consilium de Privata",terms:"Termini/Declaratio",deletion:"Explicatio Deletionis Datae"}},SS={"zh-TW":"🧬 Restarter™｜我們是誰","zh-CN":"🧬 Restarter™｜我们是谁",en:"🧬 Restarter™｜Who We Are",ja:"🧬 Restarter™｜私たちについて",ko:"🧬 Restarter™｜우리는 누구인가",th:"🧬 Restarter™｜เราเป็นใคร",vi:"🧬 Restarter™｜Chúng tôi là ai",ms:"🧬 Restarter™｜Siapa Kami",la:"🧬 Restarter™｜Quis sumus"},kS={"zh-TW":"💬 意見箱｜我們想聽你說","zh-CN":"💬 意见箱｜我们想听你说",en:"💬 Feedback｜We Want to Hear You",ja:"💬 ご意見箱｜あなたの声を聞かせて",ko:"💬 피드백｜여러분의 의견을 듣고 싶어요",th:"💬 กล่องความคิดเห็น｜เราอยากฟังคุณ",vi:"💬 Hộp góp ý｜Chúng tôi muốn lắng nghe bạn",ms:"💬 Kotak Maklum Balas｜Kami ingin mendengar anda",la:"💬 Arca Consilii｜Te audire volumus"},iI=()=>{const{lang:n}=Lt(),e=pd(),t=wS[n]||wS["zh-TW"],[r,o]=v.useState(20),a=e.pathname==="/feedback",c=e.pathname==="/"||e.pathname==="/home";return v.useEffect(()=>{if(a){o(20);return}if(c){o(24);return}o(20)},[n,a,c]),c&&typeof window<"u"&&window.innerWidth>768?null:i.jsxs("footer",{style:{width:"100%",margin:"0 auto",marginTop:0,background:c?"rgba(255,255,255,0.95)":"rgba(255,255,255,0.92)",borderRadius:c?16:0,padding:c?"16px":"8px 0",boxShadow:c?"0 2px 12px #6B5BFF22":"0 -2px 8px #0001",borderTop:c?"none":"1px solid #eee",position:a?"fixed":c?"relative":"static",bottom:a?0:"auto",top:a?"auto":c?`${r}px`:"auto",zIndex:10,transition:a?"none":c?"top 0.3s ease":"none"},children:[i.jsxs("div",{style:{width:"100%",maxWidth:800,margin:"0 auto",display:"flex",flexDirection:"row",justifyContent:"center",alignItems:"center",gap:c?20:40,flexWrap:"wrap",padding:c?"0":"0 20px"},children:[i.jsx("a",{href:"/privacy-policy",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:c?12:14},children:t.privacy}),i.jsx("a",{href:"/terms",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:c?12:14},children:t.terms}),i.jsx("a",{href:"/data-deletion",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:c?12:14},children:t.deletion}),i.jsx("a",{href:"/about",style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:c?12:14},children:SS[n]||SS["zh-TW"]}),i.jsx("a",{href:"/feedback",style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:c?12:14},children:kS[n]||kS["zh-TW"]})]}),i.jsx("style",{children:`
        @media (max-width: 768px) {
          footer {
            padding: 4px 16px 24px 16px !important;
            marginTop: 0 !important;
            position: relative !important;
            bottom: auto !important;
            top: auto !important;
          }
          footer > div {
            gap: 12px !important;
            flex-direction: row !important;
            justify-content: flex-start !important;
            flex-wrap: wrap !important;
            padding-left: 20px !important;
          }
          footer > div > a {
            padding: 4px 6px !important;
            fontSize: 12px !important;
          }
        }
        @media (min-width: 700px) {
          footer {
            padding: 8px !important;
          }
          footer > div {
            flex-direction: row !important;
            gap: 40px !important;
            justify-content: center !important;
            flex-wrap: wrap !important;
          }
          footer > div > a {
            padding: 4px 8px !important;
          }
        }
      `})]})},ny={"zh-TW":{slogan:["找回信任的起點，重新出發不孤單！"],desc:`Restarter™ 一個重啟人生的平台，這裡沒有標籤，只有理解。
從「社會融入評估」開始，AI 將陪你走進十個關卡：情緒解鎖、心聲釋放、挑戰任務、交友連結……每一站都為了幫助你找回信任與方向。
情緒來了不需要壓抑——專屬的情緒發洩遊戲區讓你不傷人更能盡情釋放壓力。
你不是被定型的人，而是有勇氣重新選擇的人。
在這裡，你可以放心說出自己的故事與情緒，找到解方，為自己活出下一章。`,wall:"你可以放心說出自己的故事與心情，這裡有理解與同行。",friend:"交友區",voice:"即時語音輸入",ai:"AI 風格回覆",tts:"擬真語音輸出",chat:"來聊天吧！",emotion:"情緒圖像實驗室",welcomeRegister:"歡迎註冊"},"zh-CN":{slogan:["找回信任的起点，重新出发不孤单！"],desc:`Restarter™ 一个重启人生的平台，这里没有标签，只有理解。
从「社会融入评估」开始，AI 将陪你走进十个关卡：情绪解锁、心声释放、挑战任务、交友连结……每一站都为了帮助你找回信任与方向。
情绪来了不需要压抑——专属的情绪发泄游戏区让你不伤人更能尽情释放压力。
你不是被定型的人，而是有勇气重新选择的人。
在这里，你可以放心说出自己的故事与情绪，找到解方，为自己活出下一章。`,wall:"你可以放心说出自己的故事与心情，这里有理解与同行。",friend:"交友区",voice:"即时语音输入",ai:"AI 风格回复",tts:"拟真语音输出",chat:"来聊天吧！",emotion:"情绪图像实验室",welcomeRegister:"欢迎注册"},en:{slogan:["Regain trust and start anew, you are never alone!"],desc:`Restarter™ is a platform for restarting your life. Here, there are no labels, only understanding.
Starting with "Social Integration Assessment", AI will accompany you through ten levels: emotional unlocking, voice release, challenging tasks, friend connections... every stop is to help you find trust and direction.
When emotions come, there is no need to suppress them—a dedicated emotional release game zone allows you to fully release stress without harming others.
You are not a fixed person, but someone with the courage to choose again.
Here, you can confidently tell your stories and emotions, find solutions, and live out your next chapter.`,wall:"You can safely share your story and feelings here, where you will find understanding and companionship.",friend:"Friend Match",voice:"Voice Input",ai:"AI Style Reply",tts:"Realistic TTS",chat:"Let's Chat!",emotion:"Emotion Visual Lab",welcomeRegister:"Welcome Register"},ja:{slogan:["信頼を取り戻し、新たな一歩を踏み出そう！"],desc:`Restarter™は人生を再出発するためのプラットフォームです。ここにはラベルはなく、理解だけがあります。
「社会的統合評価」から始まり、AIがあなたと一緒に10のレベルを進みます：感情の解放、心の声の解放、挑戦的なタスク、友達とのつながり... 各ステップはあなたが信頼と方向性を見つけるのを助けるためです。
感情が湧いてきた時、それを抑える必要はありません——専用の感情解放ゲームゾーンで、他の人を傷つけることなくストレスを完全に解放できます。
あなたは固定された人ではなく、再び選択する勇気を持つ人です。
ここでは、自分の物語と感情を安心して話し、解決策を見つけ、次の章を生きることができます。`,wall:"ここでは安心して自分のストーリーや気持ちを話せます。理解と共感がここにあります。",friend:"友達マッチ",voice:"音声入力",ai:"AIスタイル返信",tts:"リアルTTS",chat:"話しましょう！",emotion:"感情ビジュアルラボ",welcomeRegister:"登録へようこそ"},ko:{slogan:["신뢰를 되찾고, 새롭게 시작하세요. 당신은 결코 혼자가 아닙니다!"],desc:`Restarter™는 인생을 재시작하는 플랫폼입니다. 이곳에는 낙인이 없고, 오직 이해만이 있습니다.
「사회적 통합 평가」부터 시작하여 AI가 당신과 함께 10개의 레벨을 진행합니다: 감정 해방, 마음의 소리 해방, 도전적인 임무, 친구 연결... 각 정류장은 당신이 신뢰와 방향을 찾는 것을 돕기 위한 것입니다.
감정이 올 때 그것을 억누를 필요가 없습니다——전용 감정 해방 게임 존에서 다른 사람을 다치게 하지 않고 스트레스를 완전히 해방할 수 있습니다.
당신은 고정된 사람이 아니라 다시 선택할 용기를 가진 사람입니다.
여기서는 자신의 이야기와 감정을 안심하고 말하고, 해결책을 찾아 다음 장을 살아갈 수 있습니다.`,wall:"여기서는 자신의 이야기와 감정을 안심하고 말할 수 있습니다. 이곳에는 이해와 동행이 있습니다.",friend:"친구 매칭",voice:"음성 입력",ai:"AI 스타일 답장",tts:"현실적인 TTS",chat:"채팅하자!",emotion:"감정 비주얼 랩",welcomeRegister:"가입 환영"},th:{slogan:["เริ่มต้นใหม่ด้วยความไว้วางใจ คุณไม่ได้อยู่คนเดียว!"],desc:`Restarter™ คือแพลตฟอร์มสำหรับเริ่มต้นชีวิตใหม่ ที่นี่ไม่มีป้ายกำกับ มีแต่ความเข้าใจ
เริ่มต้นจาก「การประเมินการผสมผสานทางสังคม」AI จะอยู่เคียงข้างคุณผ่าน 10 ระดับ: การปลดล็อคอารมณ์ การปลดปล่อยเสียงในใจ งานท้าทาย การเชื่อมต่อเพื่อน... ทุกจุดหยุดเพื่อช่วยให้คุณค้นพบความไว้วางใจและทิศทาง
เมื่ออารมณ์มา ไม่จำเป็นต้องกดดัน——โซนเกมปลดปล่อยอารมณ์เฉพาะช่วยให้คุณปลดปล่อยความเครียดได้อย่างเต็มที่โดยไม่ทำร้ายผู้อื่น
คุณไม่ใช่คนที่ถูกกำหนดไว้ แต่เป็นคนที่มีความกล้าหาญที่จะเลือกใหม่
ที่นี่ คุณสามารถบอกเล่าเรื่องราวและอารมณ์ของตัวเองได้อย่างสบายใจ หาแนวทางแก้ไข และใช้ชีวิตบทถัดไป`,wall:"คุณสามารถพูดเรื่องราวและความรู้สึกของคุณได้อย่างสบายใจ ที่นี่มีความเข้าใจและเพื่อนร่วมทาง",friend:"จับคู่เพื่อน",voice:"ป้อนข้อมูลด้วยเสียง",ai:"ตอบกลับสไตล์ AI",tts:"TTS ที่สมจริง",chat:"มาคุยกันเถอะ!",emotion:"ห้องทดลองภาพอารมณ์",welcomeRegister:"ยินดีต้อนรับการลงทะเบียน"},vi:{slogan:["Tìm lại niềm tin, bắt đầu lại, bạn không bao giờ đơn độc!"],desc:`Restarter™ là nền tảng để làm lại cuộc đời. Ở đây không có nhãn mác, chỉ có sự thấu hiểu.
Bắt đầu từ「Đánh giá Hòa nhập Xã hội」, AI sẽ đồng hành cùng bạn qua 10 cấp độ: mở khóa cảm xúc, giải phóng tiếng nói nội tâm, nhiệm vụ thách thức, kết nối bạn bè... mỗi điểm dừng để giúp bạn tìm lại niềm tin và định hướng.
Khi cảm xúc đến, không cần phải kìm nén——khu vực trò chơi giải phóng cảm xúc chuyên biệt cho phép bạn giải phóng căng thẳng hoàn toàn mà không làm tổn thương người khác.
Bạn không phải là người bị định hình, mà là người có dũng khí để lựa chọn lại.
Ở đây, bạn có thể yên tâm chia sẻ câu chuyện và cảm xúc của mình, tìm ra giải pháp, và sống chương tiếp theo của cuộc đời.`,wall:"Bạn có thể yên tâm chia sẻ câu chuyện và cảm xúc của mình tại đây, nơi có sự thấu hiểu và đồng hành.",friend:"Ghép bạn bè",voice:"Nhập liệu bằng giọng nói",ai:"Trả lời theo phong cách AI",tts:"TTS thực tế",chat:"Hãy trò chuyện!",emotion:"Phòng thí nghiệm hình ảnh cảm xúc",welcomeRegister:"Chào mừng đăng ký"},ms:{slogan:["Temui semula kepercayaan, mulakan semula, anda tidak pernah keseorangan!"],desc:`Restarter™ ialah platform untuk memulakan semula kehidupan. Di sini tiada label, hanya pemahaman.
Bermula dari「Penilaian Integrasi Sosial」, AI akan menemani anda melalui 10 peringkat: membuka kunci emosi, melepaskan suara hati, tugas mencabar, sambungan rakan... setiap perhentian untuk membantu anda mencari kepercayaan dan arah tuju.
Apabila emosi datang, tidak perlu menekan——zon permainan pelepasan emosi khusus membolehkan anda melepaskan tekanan sepenuhnya tanpa mencederakan orang lain.
Anda bukan orang yang ditetapkan, tetapi seseorang yang mempunyai keberanian untuk memilih semula.
Di sini, anda boleh berkongsi kisah dan emosi anda dengan tenang, mencari penyelesaian, dan hidup bab seterusnya.`,wall:"Anda boleh berkongsi kisah dan perasaan anda dengan tenang di sini, di mana ada pemahaman dan teman seperjalanan.",friend:"Padanan Rakan",voice:"Input Suara",ai:"Balasan Gaya AI",tts:"TTS Realistik",chat:"Jom Sembang!",emotion:"Makmal Visual Emosi",welcomeRegister:"Selamat Datang Daftar"},la:{slogan:["Fidem recupera et iterum incipe, numquam solus es!"],desc:`Restarter™ est suggestum ad vitam iterum incipiendam. Hic nullae notae sunt, tantum intellectus.
Incipiendo ab「Aestimatio Integrationis Socialis」, AI tecum per decem gradus ambulabit: solutio affectuum, emissio vocis cordis, negotia provocantia, nexus amicorum... omnis statio ad te adiuvandum fidem et directionem inveniendam.
Cum affectus veniunt, non necesse est eos supprimere——zona ludi emissionis affectuum dedicata te sinit tensionem plene emittere sine aliis laedendis.
Tu non es homo fixus, sed qui audaciam habet iterum eligendi.
Hic, tuto fabulas tuas et affectus narrare potes, solutiones invenire, et proximum caput vivere.`,wall:"Hic tuto fabulas tuas et sensus tuos narrare potes: hic intellectus et comitatus invenies.",friend:"Par Amicus",voice:"Vox Input",ai:"AI Stylus Responsio",tts:"Verus TTS",chat:"Loquamur!",emotion:"Emotion Visual Lab",welcomeRegister:"Benevenite Registrare"}},TS={"zh-TW":"🧑‍🤝‍🧑","zh-CN":"🧑‍🤝‍🧑",en:"🧑‍🤝‍🧑",ja:"🧑‍🤝‍🧑",ko:"🧑‍🤝‍🧑",th:"🧑‍🤝‍🧑",vi:"🧑‍🤝‍🧑",ms:"🧑‍🤝‍🧑",la:"🧑‍🤝‍🧑"},Fl={"zh-TW":{privacy:"隱私權政策",terms:"條款/聲明",deletion:"資料刪除說明"},"zh-CN":{privacy:"隐私政策",terms:"条款/声明",deletion:"资料删除说明"},en:{privacy:"Privacy Policy",terms:"Terms/Statement",deletion:"Data Deletion"},ja:{privacy:"プライバシーポリシー",terms:"規約/声明",deletion:"データ削除について"},ko:{privacy:"개인정보처리방침",terms:"약관/성명",deletion:"데이터 삭제 안내"},th:{privacy:"นโยบายความเป็นส่วนตัว",terms:"ข้อกำหนด/แถลงการณ์",deletion:"คำอธิบายการลบข้อมูล"},vi:{privacy:"Chính sách bảo mật",terms:"Điều khoản/Tuyên bố",deletion:"Giải thích xóa dữ liệu"},ms:{privacy:"Dasar Privasi",terms:"Terma/Pernyataan",deletion:"Penjelasan Penghapusan Data"},la:{privacy:"Consilium Privacy",terms:"Termini/Declaratio",deletion:"Norma Deletionis Datae"}},_S={"zh-TW":"🧬 Restarter™｜我們是誰","zh-CN":"🧬 Restarter™｜我们是谁",en:"🧬 Restarter™｜Who We Are",ja:"🧬 Restarter™｜私たちについて",ko:"🧬 Restarter™｜우리는 누구인가",th:"🧬 Restarter™｜เราเป็นใคร",vi:"🧬 Restarter™｜Chúng tôi là ai",ms:"🧬 Restarter™｜Siapa Kami",la:"🧬 Restarter™｜Quis sumus"},jS={"zh-TW":"💬 意見箱｜我們想聽你說","zh-CN":"💬 意见箱｜我们想听你说",en:"💬 Feedback｜We Want to Hear You",ja:"💬 ご意見箱｜あなたの声を聞かせて",ko:"💬 피드백｜여러분의 의견을 듣고 싶어요",th:"💬 กล่องความคิดเห็น｜เราอยากฟังคุณ",vi:"💬 Hộp góp ý｜Chúng tôi muốn lắng nghe bạn",ms:"💬 Kotak Maklum Balas｜Kami ingin mendengar anda",la:"💬 Arca Consilii｜Te audire volumus"},IS={"zh-TW":"訂閱方案","zh-CN":"订阅方案",en:"Subscription Plans",ja:"サブスクリプションプラン",ko:"구독 플랜",th:"แผนการสมัครสมาชิก",vi:"Gói Đăng Ký",ms:"Pelan Langganan",la:"Plana Subscriptionis"};function CS(){var xe,$,Q;const n=Et(),{lang:e,setLang:t}=Lt(),r=ny[e],o=v.useRef(null),a=v.useRef(null),[c,d]=v.useState(0),h=St(Po),[m,g]=v.useState(h.currentUser),[x,S]=v.useState(!1),[j,T]=v.useState(!1),[R,I]=v.useState(!1),[F,P]=v.useState(!1),[z,H]=v.useState({title:"",message:"",requiredPlan:"basic"}),{isTestMode:J}=Bo(),[O,L]=v.useState(!1),[C,A]=v.useState({currentPlan:"basic",remainingDays:0,usedTokens:0,totalTokens:0}),[D,M]=v.useState(()=>typeof window<"u"?window.innerWidth<=768:!1);v.useEffect(()=>{const G=()=>M(window.innerWidth<=768);G(),window.addEventListener("resize",G);const ne=setTimeout(()=>{const se=document.querySelector("footer");se&&(se.style.transition="none",setTimeout(()=>{se.style.transition="top 0.3s ease"},50))},500);return()=>{window.removeEventListener("resize",G),clearTimeout(ne)}},[]);const B=[{key:"echo-box",icon:"🎤",title:{"zh-TW":"心聲釋放","zh-CN":"心声释放",ja:"心の声を解放",en:"Voice Release",ko:"마음의 소리 해방",th:"ปลดปล่อยเสียงในใจ",vi:"Giải Phóng Tiếng Lòng",ms:"Pelepasan Suara Hati",la:"Vox Liberatio"},desc:{"zh-TW":"你可盡情說出心裡對某些人事物的不滿，釋放後或許有解方，天下沒有不能解決的難題","zh-CN":"你可尽情说出心里对某些人事物的不满，释放后或许有解方，天下没有不能解决的难题",ja:"心の中の特定の人や物事への不満を自由に言い、解放後には解決策があるかもしれない、解決できない問題はない",en:"You can freely speak out your dissatisfaction with certain people or things, after release there may be a solution, there is no problem that cannot be solved",ko:"마음속 특정 사람이나 사물에 대한 불만을 자유롭게 말하고, 해방 후에는 해결책이 있을지도 모르며, 해결할 수 없는 문제는 없다",th:"คุณสามารถพูดความไม่พอใจต่อคนหรือสิ่งต่างๆ ได้อย่างอิสระ หลังปลดปล่อยแล้วอาจมีวิธีแก้ไข ไม่มีปัญหาที่แก้ไขไม่ได้",vi:"Bạn có thể tự do nói ra sự bất mãn với những người hoặc sự việc cụ thể, sau khi giải phóng có thể có giải pháp, không có vấn đề nào không thể giải quyết",ms:"Anda boleh bebas mengucapkan ketidakpuasan terhadap orang atau perkara tertentu, selepas melepaskan mungkin ada penyelesaian, tiada masalah yang tidak dapat diselesaikan",la:"Libere dissatisfactionem cum hominibus vel rebus certis profer, post liberationem fortasse solutio est, nulla quaestio insolubilis est"},path:"/echo-box"},{key:"restart-wall",icon:"🧱",title:{"zh-TW":"情緒重啟牆","zh-CN":"情绪重启墙",ja:"感情リスタートウォール",en:"Emotional Restart Wall",ko:"감정 재시작 벽",th:"กำแพงรีสตาร์ทอารมณ์",vi:"Tường Khởi Động Lại Cảm Xúc",ms:"Dinding Restart Emosi",la:"Murus Restart Affectus"},desc:{"zh-TW":"舒暢分享心情，獲得支持與理解","zh-CN":"舒畅分享心情，获得支持与理解",ja:"気持ちを快く共有し、サポートと理解を得る",en:"Share feelings comfortably, get support and understanding",ko:"편안하게 감정을 공유하고 지원과 이해를 받으세요",th:"แบ่งปันความรู้สึกอย่างสบายใจ รับการสนับสนุนและความเข้าใจ",vi:"Chia sẻ cảm xúc thoải mái, nhận được hỗ trợ và thấu hiểu",ms:"Kongsi perasaan dengan selesa, dapatkan sokongan dan pemahaman",la:"Sensus libere partiri, auxilium et intelligentiam accipe"},path:"/wall"},{key:"my-story",icon:"📖",title:{"zh-TW":"我的里程碑","zh-CN":"我的里程碑",ja:"私のマイルストーン",en:"My Milestones",ko:"내 이정표",th:"เหตุการณ์สำคัญของฉัน",vi:"Cột Mốc Của Tôi",ms:"Pencapaian Saya",la:"Mea Milestones"},desc:{"zh-TW":"記錄個人成長里程碑，見證改變歷程","zh-CN":"记录个人成长里程碑，见证改变历程",ja:"個人の成長マイルストーンを記録し、変化の過程を目撃",en:"Record personal growth milestones, witness the journey of change",ko:"개인 성장의 이정표를 기록하고 변화의 여정을 목격하세요",th:"บันทึกเหตุการณ์สำคัญของการเติบโตส่วนบุคคล เป็นพยานในการเดินทางแห่งการเปลี่ยนแปลง",vi:"Ghi lại các cột mốc phát triển cá nhân, chứng kiến hành trình thay đổi",ms:"Rekod pencapaian pertumbuhan peribadi, saksikan perjalanan perubahan",la:"Milestones crescendi personalis inscribe, iter mutationis testare"},path:"/my-story"},{key:"journal",icon:"🌳",title:{"zh-TW":"心情解鎖盒","zh-CN":"心情解锁盒",ja:"気持ちアンロックボックス",en:"Mood Unlock Box",ko:"감정 언락 박스",th:"กล่องปลดล็อกอารมณ์",vi:"Hộp Mở Khóa Cảm Xúc",ms:"Kotak Buka Kunci Emosi",la:"Arca Unlock Affectus"},desc:{"zh-TW":"每天記錄心情，解鎖拼圖碎片，拼出完整的自己！","zh-CN":"每天记录心情，解锁拼图碎片，拼出完整的自己！",ja:"毎日気持ちを記録して、パズルのピースをアンロックし、完全な自分を完成させよう！",en:"Record your mood daily, unlock puzzle pieces, and piece together your complete self!",ko:"매일 기분을 기록하고 퍼즐 조각을 열어 완전한 자신을 완성하세요!",th:"บันทึกอารมณ์ทุกวัน ปลดล็อกชิ้นส่วนจิ๊กซอว์ และต่อภาพตัวเองที่สมบูรณ์!",vi:"Ghi lại tâm trạng mỗi ngày, mở khóa các mảnh ghép, và ghép thành hình ảnh hoàn chỉnh của chính mình!",ms:"Catat perasaan setiap hari, buka kepingan teka-teki, dan lengkapkan diri anda yang sempurna!",la:"Cotidie animum inscribe, fragmenta aenigmatis solve, et te ipsum perfectum compone!"},path:"/journal"},{key:"missions",icon:"🎯",title:{"zh-TW":"挑戰任務","zh-CN":"挑战任务",en:"Challenge Missions",ja:"ミッションに挑戦",ko:"임무 도전",th:"ท้าทายภารกิจ",vi:"Thử thách nhiệm vụ",ms:"Cabaran Misi",la:"Provocatio Missionum"},desc:{"zh-TW":"五站重啟路，讓你更堅強","zh-CN":"五站重启路，让你更坚强",en:"Five-Station Restart Journey, Make You Stronger",ja:"五つのステーション再起動の道、あなたをより強くする",ko:"다섯 단계 재시작 여정, 당신을 더 강하게 만들어요",th:"เส้นทางรีสตาร์ทห้าสถานี ทำให้คุณแข็งแกร่งขึ้น",vi:"Hành trình khởi động lại năm trạm, làm cho bạn mạnh mẽ hơn",ms:"Perjalanan Restart Lima Stesen, Membuat Anda Lebih Kuat",la:"Iter Restart Quinque Stationum, Te Fortiorem Facit"},path:"/restart-missions"},{key:"storywall",icon:"📖",title:{"zh-TW":"我是誰故事鏈","zh-CN":"我是誰故事鏈",ja:"ストーリーウォール",en:"Story Wall",ko:"스토리 월",th:"กำแพงเรื่องราว",vi:"Tường Truyện",ms:"Dinding Cerita",la:"Murus Fabularum"},desc:{"zh-TW":"分享故事，建立連結","zh-CN":"分享故事，建立连接",ja:"ストーリーを共有し、つながりを築く",en:"Share Stories, Build Connections",ko:"이야기를 공유하고 연결을 구축",th:"แบ่งปันเรื่องราว สร้างการเชื่อมต่อ",vi:"Chia sẻ câu chuyện, xây dựng kết nối",ms:"Kongsi cerita, bina hubungan",la:"Fabulas partiri, nexus construere"},path:"/storywall"},{key:"skillbox",icon:"🛠️",title:{"zh-TW":"社會模擬所","zh-CN":"技能方块",ja:"スキルボックス",en:"Skill Box",ko:"스킬 박스",th:"กล่องทักษะ",vi:"Hộp Kỹ Năng",ms:"Kotak Kemahiran",la:"Arca Peritiae"},desc:{"zh-TW":"練習社會互動，解鎖成就","zh-CN":"练习社会互动，解锁成就",en:"Practice social skills, unlock achievements",ja:"社会スキル練習で実績解除",ko:"사회적 기술 연습, 업적 잠금 해제",th:"ฝึกฝนทักษะทางสังคม, ปลดล็อกความสำเร็จ",vi:"Thực hành kỹ năng xã hội, mở khóa thành tích",ms:"Latih kemahiran sosial, buka pencapaian",la:"Practice social skills, unlock achievements"},path:"/skillbox"},{key:"emotionRelease",icon:"🎮",title:{"zh-TW":"情緒發洩區","zh-CN":"情绪发泄区",ja:"感情発散エリア",en:"Emotion Release Zone",ko:"감정 발산 구역",th:"พื้นที่ระบายอารมณ์",vi:"Khu Vực Giải Tỏa Cảm Xúc",ms:"Zon Pelepasan Emosi",la:"Zona Emotio Liberationis"},desc:{"zh-TW":"透過遊戲釋放壓力，找回平靜","zh-CN":"通过游戏释放压力，找回平静",en:"Release stress through games, find peace",ja:"ゲームでストレスを発散し、平静を取り戻す",ko:"게임으로 스트레스를 해소하고 평온을 찾으세요",th:"ปลดปล่อยความเครียดผ่านเกม หาความสงบ",vi:"Giải tỏa căng thẳng qua trò chơi, tìm lại bình yên",ms:"Lepaskan tekanan melalui permainan, temui ketenangan",la:"Libera tensionem per ludos, inveni pacem"},path:"/emotion-release"}];v.useLayoutEffect(()=>{if(o.current&&a.current){const G=o.current.getBoundingClientRect().top,ne=a.current.getBoundingClientRect().top,se=o.current.getBoundingClientRect().height,me=a.current.getBoundingClientRect().height;d(G+se-(ne+me))}},[e]),v.useEffect(()=>{const G=Ns(h,ne=>{g(ne),S(!0)});return()=>G()},[h]);const _=v.useRef(null);v.useEffect(()=>{if(!j)return;const G=ne=>{_.current&&!_.current.contains(ne.target)&&T(!1)};return document.addEventListener("mousedown",G),()=>document.removeEventListener("mousedown",G)},[j]);const U=G=>{n("/chat")},oe={"zh-TW":"登出","zh-CN":"登出",en:"Logout",ja:"ログアウト",ko:"로그아웃",th:"ออกจากระบบ",vi:"Đăng xuất",ms:"Keluar",la:"Exire"},X={"zh-TW":"互相幫助&合作實驗室","zh-CN":"互相帮助&合作实验室",en:"Mutual Help & Collaboration Lab",ja:"相互支援＆協力ラボ",ko:"상호도움&협력실험실",th:"ห้องทดลองช่วยเหลือและร่วมมือ",vi:"Phòng thí nghiệm Hỗ trợ & Hợp tác",ms:"Makmal Bantuan & Kerjasama",la:"Laboratorium Auxilii Mutui et Cooperationis"},le={"zh-TW":{title:"請先註冊/登入才能使用此功能",btn:"前往註冊/登入",close:"關閉"},"zh-CN":{title:"请先注册/登录才能使用此功能",btn:"前往注册/登录",close:"关闭"},en:{title:"Please register/login to use this feature",btn:"Go to Register/Login",close:"Close"},ja:{title:"ご利用には登録/ログインが必要です",btn:"登録/ログインへ",close:"閉じる"},ko:{title:"이 기능을 사용하려면 가입/로그인 해주세요",btn:"가입/로그인으로 이동",close:"닫기"},th:{title:"กรุณาสมัคร/เข้าสู่ระบบก่อนใช้ฟีเจอร์นี้",btn:"ไปที่สมัคร/เข้าสู่ระบบ",close:"ปิด"},vi:{title:"Vui lòng đăng ký/đăng nhập để sử dụng chức năng này",btn:"Đến đăng ký/đăng nhập",close:"Đóng"},ms:{title:"Sila daftar/log masuk untuk menggunakan ciri ini",btn:"Pergi ke Daftar/Log Masuk",close:"Tutup"},la:{title:"Quaeso registra/aperi ut hoc munus utaris",btn:"Ad registra/login",close:"Claude"}}[e],te=async(G,ne)=>{if(!m){I(!0);return}if(J){G();return}if(ne)try{const se=await fetch("/api/subscription/check-permission",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:m.uid,feature:ne})});if(!se.ok)throw new Error("權限檢查失敗");const me=await se.json();if(!me.allowed){me.canRenew?(A({currentPlan:me.currentPlan,remainingDays:me.remainingDays,usedTokens:me.usedTokens,totalTokens:me.totalTokens}),L(!0)):(H({title:"功能需要升級",message:me.reason||"此功能需要升級訂閱才能使用",requiredPlan:me.requiredPlan||"basic"}),P(!0));return}}catch(se){console.error("權限檢查錯誤:",se)}G()};return x?i.jsxs("div",{style:{position:"relative",minHeight:"100vh"},children:[D?i.jsxs("div",{style:{position:"fixed",top:0,left:0,right:0,zIndex:100,background:"rgba(255,255,255,0.95)",padding:"8px 16px",display:"flex",justifyContent:"space-between",alignItems:"center",boxShadow:"0 2px 8px #0001"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[i.jsx("img",{src:"/ctx-logo.png",alt:"logo",style:{width:72,height:72,cursor:"pointer"},onClick:()=>n("/")}),i.jsx("span",{style:{fontSize:14,fontWeight:700,color:"#6B5BFF"},children:"Restarter™"})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[m?i.jsxs(i.Fragment,{children:[i.jsx("img",{src:m.photoURL||"/ctx-logo.png",alt:"avatar",style:{width:28,height:28,borderRadius:"50%",objectFit:"cover",border:"2px solid #6B5BFF"}}),i.jsx("span",{style:{color:"#6B5BFF",fontWeight:600,fontSize:12,maxWidth:60,overflow:"hidden",textOverflow:"ellipsis"},children:m.displayName||m.email||"用戶"}),i.jsx("button",{className:"topbar-btn",onClick:async()=>{await Er(h)},style:{background:"#fff",color:"#ff6347",border:"1px solid #ff6347",borderRadius:6,fontWeight:600,fontSize:12,padding:"4px 8px"},children:oe[e]})]}):i.jsx("button",{className:"topbar-btn",onClick:()=>n("/register"),style:{background:"#fff",color:"#1976d2",border:"1px solid #1976d2",borderRadius:6,fontWeight:600,fontSize:12,padding:"4px 8px"},children:e==="zh-TW"?"註冊":e==="zh-CN"?"注册":e==="en"?"Register":e==="ja"?"登録":e==="ko"?"가입":e==="th"?"สมัคร":e==="vi"?"Đăng ký":e==="ms"?"Daftar":"Registrare"}),i.jsx($n,{style:{width:"80px",fontSize:14,padding:"6px 10px"}})]})]}):i.jsxs("div",{style:{position:"fixed",top:8,right:36,zIndex:9999,display:"flex",flexDirection:"row",alignItems:"center",gap:18,pointerEvents:"auto",width:"100%",justifyContent:"flex-end"},children:[i.jsxs("div",{style:{display:"flex",flexDirection:"row",gap:18,marginRight:24},children:[i.jsx("button",{className:"topbar-btn",onClick:()=>n("/about"),style:{background:"#fff",color:"#6B5BFF",border:"2px solid #6B5BFF",borderRadius:6,fontWeight:700,fontSize:12,padding:"4px 8px",minWidth:80},"aria-label":e==="zh-TW"||e==="zh-CN"?"了解 Restarter 平台":e==="en"?"Learn about Restarter platform":e==="ja"?"Restarter プラットフォームについて":e==="ko"?"Restarter 플랫폼에 대해 알아보기":e==="th"?"เรียนรู้เกี่ยวกับแพลตฟอร์ม Restarter":e==="vi"?"Tìm hiểu về nền tảng Restarter":e==="ms"?"Ketahui tentang platform Restarter":"Cognosce de suggestum Restarter",role:"button",children:e==="zh-TW"?"🧬 Restarter™｜我們是誰":e==="zh-CN"?"🧬 Restarter™｜我们是谁":e==="en"?"🧬 Restarter™｜Who We Are":e==="ja"?"🧬 Restarter™｜私たちについて":e==="ko"?"🧬 Restarter™｜우리는 누구인가":e==="th"?"🧬 Restarter™｜เราเป็นใคร":e==="vi"?"🧬 Restarter™｜Chúng tôi là ai":e==="ms"?"🧬 Restarter™｜Siapa Kami":"🧬 Restarter™｜Quis sumus"}),i.jsx("button",{className:"topbar-btn",onClick:()=>n("/feedback"),style:{background:"#fff",color:"#6B5BFF",border:"2px solid #6B5BFF",borderRadius:6,fontWeight:700,fontSize:12,padding:"4px 8px",minWidth:100},"aria-label":e==="zh-TW"?"提供意見和建議":e==="zh-CN"?"提供意见和建议":e==="en"?"Provide feedback and suggestions":e==="ja"?"ご意見やご提案を提供":e==="ko"?"의견과 제안 제공":e==="th"?"ให้ข้อเสนอแนะและคำแนะนำ":e==="vi"?"Cung cấp phản hồiและ đề xuất":e==="ms"?"Berikan maklum balas dan cadangan":"Praebe consilia et suggestiones",role:"button",children:e==="zh-TW"?"💬 意見箱｜我們想聽你說":e==="zh-CN"?"💬 意见箱｜我们想听你说":e==="en"?"💬 Feedback｜We Want to Hear You":e==="ja"?"💬 ご意見箱｜あなたの声を聞かせて":e==="ko"?"💬 피드백｜여러분의 의견을 듣고 싶어요":e==="th"?"💬 กล่องความคิดเห็น｜เราอยากฟังคุณ":e==="vi"?"💬 Hộp góp ý｜Chúng tôi muốn lắng nghe bạn":e==="ms"?"💬 Kotak Maklum Balas｜Kami ingin mendengar anda":"💬 Arca Consilii｜Te audire volumus"}),!1,m?i.jsx(i.Fragment,{children:i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[i.jsx("img",{src:m.photoURL||"/ctx-logo.png",alt:"avatar",style:{width:36,height:36,borderRadius:"50%",objectFit:"cover",border:"2px solid #90caf9"}}),i.jsx("span",{style:{color:"#1976d2",fontWeight:700,fontSize:16},children:m.displayName||m.email||"用戶"}),i.jsx("button",{className:"topbar-btn",onClick:async()=>{await Er(h)},style:{background:"#fff",color:"#ff6347",border:"2px solid #ffb4a2",borderRadius:8,fontWeight:700,fontSize:16,padding:"8px 14px",marginLeft:6},children:oe[e]})]})}):i.jsx("button",{className:"topbar-btn",onClick:()=>n("/register"),style:{background:"#fff",color:"#1976d2",border:"2px solid #90caf9",borderRadius:8,fontWeight:700,fontSize:16,padding:"8px 10px",minWidth:90},children:e==="zh-TW"?"註冊/登入":e==="zh-CN"?"注册/登录":e==="en"?"Register / Login":e==="ja"?"登録/ログイン":e==="ko"?"가입/로그인":e==="th"?"สมัคร/เข้าสู่ระบบ":e==="vi"?"Đăng ký/Đăng nhập":e==="ms"?"Daftar / Log Masuk":"Registrare / Login"})]}),i.jsxs("div",{style:{position:"relative",display:"inline-block"},ref:_,children:[i.jsxs("button",{className:"topbar-btn",style:{background:"#6B5BFF",color:"#fff",border:"2px solid #6B5BFF",borderRadius:8,fontWeight:700,fontSize:16,padding:"8px 10px",minWidth:90,maxWidth:120,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},onClick:()=>T(G=>!G),children:[e==="zh-TW"?"繁中":e==="zh-CN"?"简中":e==="en"?"English":e==="ja"?"日本語":e==="ko"?"한국어":e==="th"?"ไทย":e==="vi"?"Tiếng Việt":e==="ms"?"Bahasa Melayu":"Latin",i.jsx("span",{style:{marginLeft:6},children:"▼"})]}),j&&i.jsx("div",{style:{position:"absolute",right:0,top:"110%",background:"#fff",border:"1.5px solid #6B5BFF",borderRadius:8,boxShadow:"0 4px 16px #0002",zIndex:9999,minWidth:120},children:["zh-TW","zh-CN","en","ja","ko","th","vi","ms","la"].map(G=>i.jsx("div",{style:{padding:"10px 18px",cursor:"pointer",color:G===e?"#6B5BFF":"#232946",fontWeight:G===e?700:500,background:G===e?"#f3f0ff":"#fff"},onClick:()=>{t(G),T(!1)},children:G==="zh-TW"?"繁中":G==="zh-CN"?"简中":G==="en"?"English":G==="ja"?"日本語":G==="ko"?"한국어":G==="th"?"ไทย":G==="vi"?"Tiếng Việt":G==="ms"?"Bahasa Melayu":"Latin"},G))})]})]}),D?i.jsxs("div",{style:{width:"100vw",minHeight:"100vh",background:"url('/plains.png') center center/cover no-repeat",display:"flex",flexDirection:"column",alignItems:"center",paddingTop:100},children:[i.jsx("div",{style:{width:"100%",padding:"0 16px",marginBottom:16},children:i.jsx(vS,{})}),i.jsxs("div",{style:{width:"100%",padding:"20px 16px",textAlign:"center"},children:[i.jsx("div",{style:{marginBottom:16},children:i.jsx("span",{style:{fontWeight:900,color:"#232946",fontSize:16,lineHeight:1.2,letterSpacing:.3,textShadow:"1px 2px 8px #fff",whiteSpace:"nowrap"},children:e==="zh-TW"?"找回信任的起點，重新出發不孤單！":e==="zh-CN"?"找回信任的起点，重新出发不孤单！":e==="en"?"Regain trust and start anew, you are never alone!":e==="ja"?"信頼を取り戻し、新たな一歩を踏み出そう！":e==="ko"?"신뢰를 되찾고, 새롭게 시작하세요. 당신은 결코 혼자가 아닙니다!":e==="th"?"เริ่มต้นใหม่ด้วยความไว้วางใจ คุณไม่ได้อยู่คนเดียว!":e==="vi"?"Tìm lại niềm tin, bắt đầu lại, bạn không bao giờ đơn độc!":e==="ms"?"Temui semula kepercayaan, mulakan semula, anda tidak pernah keseorangan!":"Fidem recupera et iterum incipe, numquam solus es!"})}),i.jsxs("h1",{style:{fontSize:24,fontWeight:900,color:"#fff",marginBottom:12,textShadow:"0 2px 8px #232946"},children:[i.jsx("span",{style:{color:"#6B5BFF"},children:"Restarter™"})," Global Platform"]}),i.jsx("div",{style:{marginBottom:10},children:i.jsx("span",{style:{color:"#232946",fontWeight:500,fontSize:14,lineHeight:1.4,whiteSpace:"pre-line"},children:ny[e].desc})})]}),i.jsxs("div",{style:{width:"100%",padding:"0 16px",marginBottom:"16px",position:"relative"},children:[i.jsxs("button",{onClick:()=>te(()=>n("/social-integration")),style:{background:"linear-gradient(135deg, #6B5BFF 0%, #5A4FCF 100%)",border:"none",borderRadius:"16px",padding:"12px 24px",color:"white",cursor:"pointer",fontSize:"16px",fontWeight:"600",boxShadow:"0 4px 16px rgba(107, 91, 255, 0.3)",transition:"all 0.3s ease",display:"flex",alignItems:"center",gap:"8px",width:"100%",justifyContent:"center",position:"relative"},onMouseOver:G=>{G.currentTarget.style.transform="translateY(-2px)",G.currentTarget.style.boxShadow="0 6px 20px rgba(107, 91, 255, 0.4)";const ne=G.currentTarget.nextElementSibling;ne&&(ne.style.opacity="1")},onMouseOut:G=>{G.currentTarget.style.transform="translateY(0)",G.currentTarget.style.boxShadow="0 4px 16px rgba(107, 91, 255, 0.3)";const ne=G.currentTarget.nextElementSibling;ne&&(ne.style.opacity="0")},children:[i.jsx("span",{style:{fontSize:"18px"},children:"📊"}),e==="zh-TW"?"社會融入度評估":e==="zh-CN"?"社会融入度评估":e==="ja"?"社会統合度評価":e==="en"?"Social Integration Assessment":e==="ko"?"사회 통합도 평가":e==="th"?"การประเมินการผสมผสานทางสังคม":e==="vi"?"Đánh Giá Hòa Nhập Xã Hội":e==="ms"?"Penilaian Integrasi Sosial":"Aestimatio Integrationis Socialis"]}),i.jsx("div",{style:{position:"absolute",bottom:"100%",left:"50%",transform:"translateX(-50%)",background:"#232946",color:"white",padding:"6px 10px",borderRadius:"6px",fontSize:"10px",fontWeight:"500",textAlign:"center",whiteSpace:"nowrap",opacity:"0",transition:"opacity 0.3s ease",zIndex:1e3,pointerEvents:"none",maxWidth:"200px",marginBottom:"8px"},children:e==="zh-TW"?"評估個人社會融入度，獲得專業建議和改善方向":e==="zh-CN"?"评估个人社会融入度，获得专业建议和改善方向":e==="ja"?"個人の社会統合度を評価し、専門的なアドバイスと改善方向を獲得":e==="en"?"Assess personal social integration, get professional advice and improvement direction":e==="ko"?"개인 사회 통합도를 평가하고 전문적인 조언과 개선 방향을 얻으세요":e==="th"?"ประเมินการผสมผสานทางสังคมส่วนบุคคล รับคำแนะนำจากผู้เชี่ยวชาญและทิศทางการปรับปรุง":e==="vi"?"Đánh giá mức độ hòa nhập xã hội cá nhân, nhận lời khuyên chuyên môn và hướng cải thiện":e==="ms"?"Nilai integrasi sosial peribadi, dapatkan nasihat profesional dan arah penambahbaikan":"Aestima integrationem socialem personalem, consilium professionalem et directionem meliorationis accipe"})]}),i.jsxs("div",{style:{width:"100%",padding:"0 16px",display:"flex",flexDirection:"column",gap:12},children:[i.jsxs("div",{style:{display:"flex",flexDirection:"row",gap:8,flexWrap:"wrap"},children:[i.jsxs("button",{className:"feature-btn",style:{flex:1,minWidth:"calc(50% - 4px)",padding:"16px 8px",borderRadius:12,border:"2px solid #6B5BFF",background:"#fff",color:"#6B5BFF",fontWeight:700,fontSize:14,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:4},onClick:()=>te(()=>n("/friend")),children:[i.jsx("span",{style:{fontSize:20},children:TS[e]}),i.jsx("span",{style:{fontSize:12,textAlign:"center"},children:r.friend})]}),i.jsxs("button",{className:"feature-btn",style:{flex:1,minWidth:"calc(50% - 4px)",padding:"16px 8px",borderRadius:12,border:"2px solid #6B5BFF",background:"#fff",color:"#6B5BFF",fontWeight:700,fontSize:14,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:4},onClick:()=>te(()=>U(),"aiChat"),children:[i.jsx("span",{style:{fontSize:20},children:"💬"}),i.jsx("span",{style:{fontSize:12,textAlign:"center"},children:r.chat})]})]}),i.jsx("div",{style:{display:"flex",flexDirection:"row",gap:8,flexWrap:"wrap"},children:B.slice(0,2).map(G=>i.jsxs("button",{className:"feature-btn",style:{flex:1,minWidth:"calc(50% - 4px)",padding:"16px 8px",borderRadius:12,border:"2px solid #6B5BFF",background:"#fff",color:"#6B5BFF",fontWeight:700,fontSize:14,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:4},onClick:()=>te(()=>n(G.path)),children:[i.jsx("span",{style:{fontSize:20},children:G.icon}),i.jsx("span",{style:{fontSize:12,textAlign:"center"},children:G.title[e]})]},G.key))}),i.jsx("div",{style:{display:"flex",flexDirection:"row",gap:8,flexWrap:"wrap"},children:B.slice(2,4).map(G=>i.jsxs("button",{className:"feature-btn",style:{flex:1,minWidth:"calc(50% - 4px)",padding:"16px 8px",borderRadius:12,border:"2px solid #6B5BFF",background:"#fff",color:"#6B5BFF",fontWeight:700,fontSize:14,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:4},onClick:()=>te(()=>n(G.path)),children:[i.jsx("span",{style:{fontSize:20},children:G.icon}),i.jsx("span",{style:{fontSize:12,textAlign:"center"},children:G.title[e]})]},G.key))}),i.jsxs("div",{style:{display:"flex",flexDirection:"row",gap:8,flexWrap:"wrap"},children:[B.slice(4).map(G=>i.jsxs("button",{className:"feature-btn",style:{flex:1,minWidth:"calc(50% - 4px)",padding:"16px 8px",borderRadius:12,border:"2px solid #6B5BFF",background:"#fff",color:"#6B5BFF",fontWeight:700,fontSize:14,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:4},onClick:()=>te(()=>n(G.path)),children:[i.jsx("span",{style:{fontSize:20},children:G.icon}),i.jsx("span",{style:{fontSize:12,textAlign:"center"},children:G.title[e]})]},G.key)),i.jsxs("button",{className:"feature-btn",style:{flex:1,minWidth:"calc(50% - 4px)",padding:"16px 8px",borderRadius:12,background:"linear-gradient(90deg, #ffe0b2 0%, #ffb74d 100%)",color:"#b85c00",border:"2px solid #ffb74d",fontWeight:900,fontSize:14,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:4},onClick:()=>te(()=>n("/HelpLab")),children:[i.jsx("span",{style:{fontSize:20},children:"🧪"}),i.jsx("span",{style:{fontSize:12,textAlign:"center"},children:X[e]})]})]})]}),i.jsx("div",{style:{width:"100%",padding:"20px 16px",display:"flex",flexDirection:"column",gap:12,boxSizing:"border-box"},children:i.jsx("a",{href:"/plans",style:{width:"100%",padding:"12px",borderRadius:10,background:"#6B5BFF",color:"#fff",fontWeight:700,fontSize:14,textDecoration:"none",border:"2px solid #6B5BFF",cursor:"pointer",textAlign:"center",display:"block",boxSizing:"border-box"},children:IS[e]})})]}):i.jsxs("div",{style:{width:"100vw",minHeight:"160vh",background:"url('/plains.png') center center/cover no-repeat",display:"flex",flexDirection:"row",alignItems:"flex-start",justifyContent:"center"},children:[i.jsxs("div",{className:"home-left-col left-relative",style:{flex:1,minWidth:320,maxWidth:600,display:"flex",flexDirection:"column",alignItems:"flex-start",justifyContent:"flex-start",padding:"120px 0 0 0",zIndex:2},children:[i.jsx("div",{className:"fixed-logo-box",style:{position:"fixed",top:16,left:42,display:"flex",flexDirection:"row",alignItems:"center",gap:12,zIndex:1e4,paddingTop:0,marginTop:0},children:i.jsx("img",{src:"/ctx-logo.png",className:"fixed-logo-img",style:{marginBottom:0,width:182,height:182,cursor:"pointer",marginTop:"-40px"},onClick:()=>n("/")})}),i.jsxs("div",{className:"column-content",style:{justifyContent:"center",alignItems:"center",height:"100%",paddingTop:e==="vi"?"200px":e==="ms"?"220px":e==="la"?"240px":e==="en"?"180px":"80px"},children:[i.jsx("div",{style:{width:"100%",maxWidth:900,margin:"0 auto 16px auto",textAlign:"center",wordBreak:"break-word",whiteSpace:"normal",marginLeft:"0px"},children:i.jsx("span",{style:{fontWeight:900,color:"#232946",fontSize:20,lineHeight:1.2,letterSpacing:.5,textShadow:"2px 4px 12px #fff, 0 2px 8px #23294688",display:"inline-block",whiteSpace:"nowrap"},children:e==="zh-TW"?"找回信任的起點，重新出發不孤單！":e==="zh-CN"?"找回信任的起点，重新出发不孤单！":e==="en"?"Regain trust and start anew, you are never alone!":e==="ja"?"信頼を取り戻し、新たな一歩を踏み出そう！":e==="ko"?"신뢰를 되찾고, 새롭게 시작하세요. 당신은 결코 혼자가 아닙니다!":e==="th"?"เริ่มต้นใหม่ด้วยความไว้วางใจ คุณไม่ได้อยู่คนเดียว!":e==="vi"?"Tìm lại niềm tin, bắt đầu lại, bạn không bao giờ đơn độc!":e==="ms"?"Temui semula kepercayaan, mulakan semula, anda tidak pernah keseorangan!":"Fidem recupera et iterum incipe, numquam solus es!"})}),i.jsxs("h1",{className:"main-title",style:{position:"relative",left:"0px",fontSize:36,fontWeight:900,color:"#fff",marginBottom:18,textShadow:"0 2px 12px #232946, 0 4px 24px #0008"},children:[i.jsx("span",{style:{color:"#6B5BFF"},children:"Restarter™"})," Global Platform"]}),i.jsx("div",{style:{width:"100%",textAlign:"center",margin:"0 auto",marginBottom:16,marginTop:"0px"},children:i.jsx("span",{style:{color:"#232946",fontWeight:500,fontSize:16,lineHeight:1.5,letterSpacing:.5,whiteSpace:"pre-line"},children:ny[e].desc})}),i.jsxs("div",{style:{display:"flex",justifyContent:"center",marginBottom:"24px",position:"relative"},children:[i.jsxs("button",{onClick:()=>te(()=>n("/social-integration")),style:{background:"linear-gradient(135deg, #6B5BFF 0%, #5A4FCF 100%)",border:"none",borderRadius:"16px",padding:"16px 32px",color:"white",cursor:"pointer",fontSize:"18px",fontWeight:"600",boxShadow:"0 4px 16px rgba(107, 91, 255, 0.3)",transition:"all 0.3s ease",display:"flex",alignItems:"center",gap:"12px",position:"relative"},onMouseOver:G=>{G.currentTarget.style.transform="translateY(-2px)",G.currentTarget.style.boxShadow="0 6px 20px rgba(107, 91, 255, 0.4)";const ne=G.currentTarget.nextElementSibling;ne&&(ne.style.opacity="1")},onMouseOut:G=>{G.currentTarget.style.transform="translateY(0)",G.currentTarget.style.boxShadow="0 4px 16px rgba(107, 91, 255, 0.3)";const ne=G.currentTarget.nextElementSibling;ne&&(ne.style.opacity="0")},children:[i.jsx("span",{style:{fontSize:"24px"},children:"📊"}),e==="zh-TW"?"社會融入度評估":e==="zh-CN"?"社会融入度评估":e==="ja"?"社会統合度評価":e==="en"?"Social Integration Assessment":e==="ko"?"사회 통합도 평가":e==="th"?"การประเมินการผสมผสานทางสังคม":e==="vi"?"Đánh Giá Hòa Nhập Xã Hội":e==="ms"?"Penilaian Integrasi Sosial":"Aestimatio Integrationis Socialis"]}),i.jsx("div",{style:{position:"absolute",top:"-50px",left:"50%",transform:"translateX(-50%)",background:"#232946",color:"white",padding:"8px 12px",borderRadius:"8px",fontSize:"12px",fontWeight:"500",textAlign:"center",whiteSpace:"nowrap",opacity:"0",transition:"opacity 0.3s ease",zIndex:1e3,pointerEvents:"none"},children:e==="zh-TW"?"評估個人社會融入度，獲得專業建議和改善方向":e==="zh-CN"?"评估个人社会融入度，获得专业建议和改善方向":e==="ja"?"個人の社会統合度を評価し、専門的なアドバイスと改善方向を獲得":e==="en"?"Assess personal social integration, get professional advice and improvement direction":e==="ko"?"개인 사회 통합도를 평가하고 전문적인 조언과 개선 방향을 얻으세요":e==="th"?"ประเมินการผสมผสานทางสังคมส่วนบุคคล รับคำแนะนำจากผู้เชี่ยวชาญและทิศทางการปรับปรุง":e==="vi"?"Đánh giá mức độ hòa nhập xã hội cá nhân, nhận lời khuyên chuyên môn và hướng cải thiện":e==="ms"?"Nilai integrasi sosial peribadi, dapatkan nasihat profesional dan arah penambahbaikan":"Aestima integrationem socialem personalem, consilium professionalem et directionem meliorationis accipe"})]}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:18,marginBottom:60,justifyContent:"center",width:"100%"},children:[i.jsxs("div",{style:{display:"flex",flexDirection:"row",gap:18,justifyContent:"center"},children:[i.jsxs("button",{className:"feature-btn",style:{fontSize:18,padding:"16px 16px",minWidth:160,minHeight:80,display:"flex",flexDirection:"column",alignItems:"center",gap:8,justifyContent:"center",background:"#fff",color:"#6B5BFF",border:"2px solid #6B5BFF"},onClick:()=>te(()=>n("/friend"),"userInteraction"),"aria-label":e==="zh-TW"?"進入交友區，尋找新朋友，建立支持圈":e==="zh-CN"?"进入交友区，寻找新朋友，建立支持圈":e==="en"?"Enter friend matching area to find new friends and build support circle":e==="ja"?"友達マッチングエリアに入って新しい友達を見つけ、サポートサークルを築く":e==="ko"?"친구 매칭 영역으로 이동하여 새로운 친구를 찾고 지원 서클을 구축":e==="th"?"เข้าสู่พื้นที่จับคู่เพื่อนเพื่อหาเพื่อนใหม่และสร้างวงกลมสนับสนุน":e==="vi"?"Vào khu vực ghép bạn bè để tìm bạn mới và xây dựng vòng tròn hỗ trợ":e==="ms"?"Masuk ke kawasan padanan rakan untuk mencari rakan baru dan membina bulatan sokongan":"Intra in area par amicus ad inveniendos novos amicos et construendam circulum auxilii",role:"button",children:[i.jsx("span",{style:{fontSize:32},children:TS[e]}),i.jsx("span",{style:{fontWeight:700,textAlign:"center",lineHeight:1.2},children:r.friend})]}),B.slice(0,2).map(G=>i.jsxs("button",{className:"feature-btn",style:{fontSize:18,padding:"16px 16px",minWidth:160,minHeight:80,display:"flex",flexDirection:"column",alignItems:"center",gap:8,justifyContent:"center",background:"#fff",color:"#6B5BFF",border:"2px solid #6B5BFF"},onClick:()=>te(()=>n(G.path)),"aria-label":G.desc[e],role:"button",children:[i.jsx("span",{style:{fontSize:32,transform:G.icon==="🎤"?"translateY(8px)":"none"},children:G.icon}),i.jsx("span",{style:{fontWeight:700,textAlign:"center",lineHeight:1.2},children:G.title[e]})]},G.key))]}),i.jsx("div",{style:{display:"flex",flexDirection:"row",gap:18,justifyContent:"center"},children:B.slice(2,5).map(G=>i.jsxs("button",{className:"feature-btn",style:{fontSize:18,padding:"16px 16px",minWidth:160,minHeight:80,display:"flex",flexDirection:"column",alignItems:"center",gap:8,justifyContent:"center",background:"#fff",color:"#6B5BFF",border:"2px solid #6B5BFF"},onClick:()=>te(()=>n(G.path)),"aria-label":G.desc[e],role:"button",children:[i.jsx("span",{style:{fontSize:32},children:G.icon}),i.jsx("span",{style:{fontWeight:700,textAlign:"center",lineHeight:1.2},children:G.title[e]})]},G.key))}),i.jsxs("div",{style:{display:"flex",flexDirection:"row",gap:18,justifyContent:"center",marginTop:10},children:[i.jsxs("button",{className:"feature-btn",style:{fontSize:18,padding:"16px 16px",minWidth:160,minHeight:80,display:"flex",flexDirection:"column",alignItems:"center",gap:8,justifyContent:"center",background:"#fff",color:"#6B5BFF",border:"2px solid #6B5BFF"},onClick:()=>te(()=>n("/storywall")),"aria-label":e==="zh-TW"?"分享故事，建立連結":e==="zh-CN"?"分享故事，建立连接":e==="en"?"Share Stories, Build Connections":e==="ja"?"ストーリーを共有し、つながりを築く":e==="ko"?"이야기를 공유하고 연결을 구축":e==="th"?"แบ่งปันเรื่องราว สร้างการเชื่อมต่อ":e==="vi"?"Chia sẻ câu chuyện, xây dựng kết nối":e==="ms"?"Kongsi cerita, bina hubungan":"Fabulas partiri, nexus construere",role:"button",children:[i.jsx("span",{style:{fontSize:32},children:"📖"}),i.jsx("span",{style:{fontWeight:700,textAlign:"center",lineHeight:1.2},children:e==="zh-TW"||e==="zh-CN"?"我是誰故事鏈":e==="ja"?"ストーリーウォール":e==="en"?"Story Wall":e==="ko"?"스토리 월":e==="th"?"กำแพงเรื่องราว":e==="vi"?"Tường Truyện":e==="ms"?"Dinding Cerita":"Murus Fabularum"})]}),i.jsxs("button",{className:"feature-btn mutual-help-btn",style:{fontSize:18,padding:"16px 16px",minWidth:180,maxWidth:240,minHeight:80,display:"flex",flexDirection:"column",alignItems:"center",gap:8,justifyContent:"center",background:"linear-gradient(90deg, #ffe0b2 0%, #ffb74d 100%)",color:"#b85c00",border:"2px solid #ffb74d",fontWeight:900,boxShadow:"0 2px 12px #ffb74d55"},onClick:()=>te(()=>n("/HelpLab")),"aria-label":e==="zh-TW"?"提供與獲得幫助，一樣重要":e==="zh-CN"?"提供与获得帮助，一样重要":e==="en"?"Providing and receiving help are equally important":e==="ja"?"助けを提供することと受けることは同じように重要":e==="ko"?"도움을 제공하고 받는 것은 똑같이 중요합니다":e==="th"?"การให้และรับความช่วยเหลือมีความสำคัญเท่ากัน":e==="vi"?"Cung cấp và nhận sự giúp đỡ đều quan trọng như nhau":e==="ms"?"Memberi dan menerima bantuan sama penting":"Auxilium praebere et accipere aequo modo magni momenti sunt",role:"button",children:[i.jsx("span",{style:{fontSize:32},children:"🧪"}),i.jsx("span",{style:{fontWeight:900,color:"#1976d2",textAlign:"center",lineHeight:1.2},children:X[e]})]}),i.jsxs("button",{className:"feature-btn",style:{fontSize:18,padding:"16px 16px",minWidth:160,minHeight:80,display:"flex",flexDirection:"column",alignItems:"center",gap:8,justifyContent:"center",background:"#fff",color:"#6B5BFF",border:"2px solid #6B5BFF"},onClick:()=>te(()=>n("/emotion-release")),"aria-label":e==="zh-TW"?"透過遊戲釋放壓力，找回平靜":e==="zh-CN"?"通过游戏释放压力，找回平静":e==="en"?"Release stress through games, find peace":e==="ja"?"ゲームでストレスを発散し、平静を取り戻す":e==="ko"?"게임으로 스트레스를 해소하고 평온을 찾으세요":e==="th"?"ปลดปล่อยความเครียดผ่านเกม หาความสงบ":e==="vi"?"Giải tỏa căng thẳng qua trò chơi, tìm lại bình yên":e==="ms"?"Lepaskan tekanan melalui permainan, temui ketenangan":"Libera tensionem per ludos, inveni pacem",role:"button",children:[i.jsx("span",{style:{fontSize:32},children:"🎮"}),i.jsx("span",{style:{fontWeight:700,textAlign:"center",lineHeight:1.2},children:e==="zh-TW"?"情緒發洩區":e==="zh-CN"?"情绪发泄区":e==="ja"?"感情発散エリア":e==="en"?"Emotion Release Zone":e==="ko"?"감정 발산 구역":e==="th"?"พื้นที่ระบายอารมณ์":e==="vi"?"Khu Vực Giải Tỏa Cảm Xúc":e==="ms"?"Zon Pelepasan Emosi":"Zona Emotio Liberationis"})]})]})]})]})]}),i.jsxs("div",{className:"home-right-col",style:{flex:1,minWidth:320,maxWidth:520,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"flex-start",paddingTop:120,zIndex:2},children:[i.jsx("div",{style:{display:"flex",gap:18,marginBottom:18,justifyContent:"center",width:"100%"},children:i.jsx("a",{href:"/plans",style:{background:"#6B5BFF",color:"#fff",fontWeight:700,fontSize:18,padding:"10px 28px",borderRadius:10,boxShadow:"0 2px 8px #6B5BFF33",textDecoration:"none",border:"2px solid #6B5BFF",cursor:"pointer"},children:IS[e]})}),i.jsx("div",{style:{marginBottom:18,width:"100%",maxWidth:300},children:i.jsx(vS,{})}),i.jsx("img",{src:"/hero-mic.jpg",className:"home-mic-img",style:{marginBottom:0,height:"calc(100vh - 180px)",maxHeight:520,minHeight:320,width:"100%",objectFit:"contain",background:"#232946"}}),i.jsxs("button",{ref:a,className:"feature-btn home-chat-btn",style:{height:80,marginTop:0,marginBottom:0,position:"relative",top:"-40px",gap:8,padding:"16px 16px",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",background:"#fff",color:"#6B5BFF",border:"2px solid #6B5BFF"},onClick:()=>te(()=>U(),"aiChat"),"aria-label":e==="zh-TW"?"開始與 AI 聊天對話":e==="zh-CN"?"开始与 AI 聊天对话":e==="en"?"Start chatting with AI":e==="ja"?"AIとのチャットを開始":e==="ko"?"AI와 채팅 시작":e==="th"?"เริ่มแชทกับ AI":e==="vi"?"Bắt đầu trò chuyệnกับ AI":e==="ms"?"Mula berbual dengan AI":"Incipe colloquium cum AI",role:"button",children:[i.jsx("span",{role:"img","aria-label":"chat",style:{fontSize:32},children:"💬"}),i.jsx("span",{className:"home-chat-btn-text",style:{fontWeight:700,textAlign:"center",lineHeight:1.2},children:r.chat})]})]})]}),!D&&i.jsx("div",{style:{width:"100%",margin:"0 auto",marginTop:20,padding:"16px"},children:i.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:20,flexWrap:"wrap"},children:[i.jsx("a",{href:"/about",style:{color:"#6B5BFF",textDecoration:"none",padding:"4px 12px",fontSize:11,background:"#fff",borderRadius:"8px",border:"2px solid #6B5BFF",fontWeight:700,transition:"all 0.3s ease",display:"inline-block",minHeight:"24px",lineHeight:"14px",textAlign:"center"},children:_S[e]||_S["zh-TW"]}),i.jsx("a",{href:"/privacy-policy",style:{color:"#6B5BFF",textDecoration:"none",padding:"4px 12px",fontSize:11,background:"#fff",borderRadius:"8px",border:"2px solid #6B5BFF",fontWeight:600,transition:"all 0.3s ease",display:"inline-block",minHeight:"24px",lineHeight:"14px",textAlign:"center"},children:((xe=Fl[e])==null?void 0:xe.privacy)||Fl["zh-TW"].privacy}),i.jsx("a",{href:"/terms",style:{color:"#6B5BFF",textDecoration:"none",padding:"4px 12px",fontSize:11,background:"#fff",borderRadius:"8px",border:"2px solid #6B5BFF",fontWeight:600,transition:"all 0.3s ease",display:"inline-block",minHeight:"24px",lineHeight:"14px",textAlign:"center"},children:(($=Fl[e])==null?void 0:$.terms)||Fl["zh-TW"].terms}),i.jsx("a",{href:"/data-deletion",style:{color:"#6B5BFF",textDecoration:"none",padding:"4px 12px",fontSize:11,background:"#fff",borderRadius:"8px",border:"2px solid #6B5BFF",fontWeight:600,transition:"all 0.3s ease",display:"inline-block",minHeight:"24px",lineHeight:"14px",textAlign:"center"},children:((Q=Fl[e])==null?void 0:Q.deletion)||Fl["zh-TW"].deletion}),i.jsx("a",{href:"/feedback",style:{color:"#6B5BFF",textDecoration:"none",padding:"4px 12px",fontSize:11,background:"#fff",borderRadius:"8px",border:"2px solid #6B5BFF",fontWeight:700,transition:"all 0.3s ease",display:"inline-block",minHeight:"24px",lineHeight:"14px",textAlign:"center"},children:jS[e]||jS["zh-TW"]})]})}),i.jsx(iI,{}),R&&i.jsx("div",{style:{position:"fixed",left:0,top:0,width:"100vw",height:"100vh",background:"rgba(40,40,80,0.18)",zIndex:1e4,display:"flex",alignItems:"center",justifyContent:"center"},children:i.jsxs("div",{style:{background:"#fff",borderRadius:18,boxShadow:"0 4px 24px #6B5BFF33",padding:28,minWidth:280,maxWidth:340,width:"90vw",position:"relative",display:"flex",flexDirection:"column",gap:12},children:[i.jsx("button",{type:"button",onClick:()=>I(!1),style:{position:"absolute",top:10,right:12,background:"none",border:"none",fontSize:22,color:"#888",cursor:"pointer",fontWeight:700},children:"×"}),i.jsx("div",{style:{fontWeight:800,fontSize:18,color:"#6B5BFF",textAlign:"center",marginBottom:2},children:le.title}),i.jsx("button",{onClick:()=>n("/register"),style:{background:"linear-gradient(90deg, #6e8efb, #a777e3)",color:"#fff",border:"none",borderRadius:14,padding:"12px 0",fontWeight:700,fontSize:17,cursor:"pointer",margin:"12px 0"},children:le.btn}),i.jsx("button",{onClick:()=>I(!1),style:{background:"#eee",color:"#666",border:"none",borderRadius:14,padding:"10px 0",fontWeight:700,fontSize:16,cursor:"pointer"},children:le.close})]})}),i.jsx(ND,{isOpen:F,onClose:()=>P(!1),title:z.title,message:z.message,requiredPlan:z.requiredPlan}),i.jsx(qa,{isOpen:O,onClose:()=>L(!1),currentPlan:C.currentPlan,remainingDays:C.remainingDays,usedTokens:C.usedTokens,totalTokens:C.totalTokens}),i.jsx("style",{children:`
        .feature-btn, .home-chat-btn, .topbar-btn {
          transition: background 0.18s, color 0.18s, box-shadow 0.18s;
          cursor: pointer;
        }
        /* 移除懸停效果以避免畫面停滯和耗電 */
        .feature-btn, .home-chat-btn {
          background: #fff;
          border-radius: 12px;
          border: 2px solid #6B5BFF;
          color: #6B5BFF;
          font-weight: 700;
          font-size: 16px;
          padding: 8px 16px;
          backdrop-filter: blur(10px);
        }
        .home-chat-btn-text {
          font-size: 18px;
          margin-left: 2px;
        }
        .topbar-btn {
          background: #6c63ff;
          border-radius: 8px;
          border: none;
          color: #fff;
          font-weight: 700;
          font-size: 16px;
          padding: 8px 18px;
        }
        .fixed-logo-box {
          position: fixed;
          top: 16px;
          left: 42px;
          display: flex;
          align-items: center;
          gap: 12px;
          z-index: 10000;
        }
        .fixed-logo-img {
          width: 54px;
          height: 54px;
        }
        .fixed-logo-slogan {
          font-size: 20px;
          font-weight: 700;
          color: #fff;
          text-shadow: 0 2px 8px #232946, 0 4px 18px #0008;
        }
      `})]}):i.jsx("div",{style:{textAlign:"center",marginTop:"30vh",fontSize:24},children:"載入中..."})}function Nc(){const[n,e]=v.useState(null),[t,r]=v.useState(!1),o=St(),a=async()=>{const h=o.currentUser;if(!h)return null;try{r(!0);const m=await fetch(`/api/subscription/status/${h.uid}`);if(m.ok){const g=await m.json();return e(g),g}}catch(m){console.error("獲取訂閱狀態失敗:",m)}finally{r(!1)}return null},c=async h=>{const m=o.currentUser;let g=m==null?void 0:m.uid;if(!g){const x=localStorage.getItem("testUser");if(x)g=JSON.parse(x).uid;else return{allowed:!1,reason:"請先登入"}}try{const x=await fetch(`/api/subscription/details/${g}`);let S=null;x.ok&&(S=await x.json());const j=localStorage.getItem("testMode")==="true";if(j)return{allowed:!0,reason:void 0,featureName:{aiChat:"AI 聊天功能",voiceInput:"語音輸入功能",voiceOutput:"語音輸出功能",videoChat:"視訊通話功能",voiceRecording:"語音錄製功能"}[h]||h,isFreeUser:!0,isTestMode:!0,currentPlan:"test"};const T=await fetch("/api/subscription/check-permission",{method:"POST",headers:{"Content-Type":"application/json","x-test-mode":j?"true":"false"},body:JSON.stringify({userId:g,feature:h})});if(T.ok){const R=await T.json(),I={aiChat:"AI 聊天功能",voiceInput:"語音輸入功能",voiceOutput:"語音輸出功能",videoChat:"視訊通話功能",voiceRecording:"語音錄製功能"},F=S&&S.isActive&&S.startDate&&new Date(S.startDate).getTime()>Date.now()-24*60*60*1e3;return{...R,featureName:I[h]||h,isFreeUser:R.currentPlan==="free"||!R.currentPlan,isNewSubscription:F,subscriptionData:S}}else return{allowed:!1,reason:"權限檢查失敗",featureName:h,isFreeUser:!0}}catch(x){return console.error("權限檢查錯誤:",x),{allowed:!1,reason:"網路錯誤",featureName:h,isFreeUser:!0}}},d=async(h,m=0)=>{const g=o.currentUser;let x=g==null?void 0:g.uid;if(!x){const j=localStorage.getItem("testUser");if(j)x=JSON.parse(j).uid;else return}const S=localStorage.getItem("testMode")==="true";try{await fetch("/api/subscription/record-usage",{method:"POST",headers:{"Content-Type":"application/json","x-test-mode":S?"true":"false"},body:JSON.stringify({userId:x,feature:h,cost:m})})}catch(j){console.error("記錄使用量失敗:",j)}};return v.useEffect(()=>{o.currentUser&&a()},[o.currentUser]),{subscriptionStatus:n,loading:t,checkPermission:c,recordUsage:d,fetchSubscriptionStatus:a}}const OD=[{code:"zh-TW",label:"繁中"},{code:"zh-CN",label:"简中"},{code:"en",label:"EN"},{code:"ja",label:"日本語"},{code:"ko",label:"한국어"},{code:"vi",label:"Tiếng Việt"},{code:"th",label:"ไทย"},{code:"la",label:"Latina"},{code:"ms",label:"Bahasa Melayu"}],RS={"zh-TW":{back:"返回",logout:"登出",title:"🧱 情緒牆 Restart Wall",subtitle:"社交情感支援平台",subtitleDesc:"在這裡，每個人都能找到情感上的歸屬感和支援。分享你的心情，或為他人提供溫暖的支援留言，讓我們一起建立溫暖的社群。",inbox:"💌 我的留言箱",placeholder:"說出你的心聲...(200字內)",send:window.innerWidth<=768?"送出":"發送",sending:"發送中...",noMessages:"還沒有留言，快來發表你的心聲吧！",commentsTitle:"支援留言：",noComments:"還沒有人留言支援",modalTitle:"這是他的心情貼文：",modalAction:"給他支援留言：",nicknamePlaceholder:"你的暱稱",commentPlaceholder:"支援內容...",submitComment:"送出支援",supportMessage:"💝 給予支援",supportDesc:"看到別人的情感分享，給予溫暖的支援和鼓勵",recording:"錄音中",pressToStop:"按下停止",readyToRecord:"準備開始錄音",recordInstruction:"點擊「開始錄音」後，系統將開始錄製您的語音留言。",recordTimeLimit:"錄音時間限制為1分鐘",cancel:"取消",startRecording:"開始錄音",voice:"語音"},"zh-CN":{back:"返回",logout:"登出",title:"🧱 情绪墙 Restart Wall",subtitle:"社交情感支援平台",subtitleDesc:"在这里，每个人都能找到情感上的归属感和支援。分享你的心情，或为他人提供温暖的支援留言，让我们一起建立温暖的社群。",inbox:"💌 我的留言箱",placeholder:"说出你的心声...",send:"发送",sending:"发送中...",noMessages:"还没有留言，快来发表你的心声吧！",commentsTitle:"支援留言：",noComments:"还没有人留言支援",modalTitle:"这是他的心情贴文：",modalAction:"给他支援留言：",nicknamePlaceholder:"你的昵称",commentPlaceholder:"支援内容...",submitComment:"送出支援",supportMessage:"💝 给予支援",supportDesc:"看到别人的情感分享，给予温暖的支援和鼓励",recording:"录音中",pressToStop:"按下停止",readyToRecord:"准备开始录音",recordInstruction:"点击「开始录音」后，系统将开始录制您的语音留言。",recordTimeLimit:"录音时间限制为1分钟",cancel:"取消",startRecording:"开始录音",voice:"语音"},en:{back:"Back",logout:"Logout",title:"🧱 Emotion Wall Restart Wall",subtitle:"Social Emotional Support Platform",subtitleDesc:"Here, everyone can find emotional belonging and support. Share your feelings, or provide warm support messages to others. Let's build a caring community together.",inbox:"💌 My Inbox",placeholder:"Say what you feel...",send:"Send",sending:"Sending...",noMessages:"No messages yet. Come and share your feelings!",commentsTitle:"Support Messages:",noComments:"No support messages yet",modalTitle:"Here's their post:",modalAction:"Leave support message:",nicknamePlaceholder:"Your Nickname",commentPlaceholder:"Support content...",submitComment:"Send Support",supportMessage:"💝 Give Support",supportDesc:"See others' emotional sharing and give warm support and encouragement",recording:"Recording",pressToStop:"Press to Stop",readyToRecord:"Ready to Start Recording",recordInstruction:'After clicking "Start Recording", the system will begin recording your voice message.',recordTimeLimit:"Recording time limit is 1 minute",cancel:"Cancel",startRecording:"Start Recording",voice:"Voice"},ja:{back:"戻る",logout:"ログアウト",title:"🧱 感情の壁 Restart Wall",subtitle:"ソーシャル感情サポートプラットフォーム",subtitleDesc:"ここでは、誰もが感情的な帰属意識とサポートを見つけることができます。あなたの気持ちを共有したり、他の人に温かい支援メッセージを提供したりして、一緒に思いやりのあるコミュニティを築きましょう。",inbox:"💌 私の受信箱",placeholder:"あなたの気持ちを話して...",send:"送信",sending:"送信中...",noMessages:"まだメッセージはありません。あなたの気持ちを投稿しに来てください！",commentsTitle:"支援メッセージ：",noComments:"まだ支援メッセージはありません",modalTitle:"彼の投稿です：",modalAction:"彼に支援メッセージを送る：",nicknamePlaceholder:"あなたのニックネーム",commentPlaceholder:"支援内容...",submitComment:"支援を送信",supportMessage:"💝 支援を送る",supportDesc:"他の人の感情的な共有を見て、温かい支援と励ましを提供する",recording:"録音中",pressToStop:"押して停止",readyToRecord:"録音の準備",recordInstruction:"「録音開始」をクリックすると、システムが音声メッセージの録音を開始します。",recordTimeLimit:"録音時間は1分に制限されています",cancel:"キャンセル",startRecording:"録音開始",voice:"音声"},ko:{back:"돌아가기",logout:"로그아웃",title:"🧱 감정의 벽 Restart Wall",subtitle:"소셜 감정 지원 플랫폼",subtitleDesc:"여기서 모든 사람이 감정적 소속감과 지원을 찾을 수 있습니다. 당신의 감정을 공유하거나 다른 사람에게 따뜻한 지원 메시지를 제공하여 함께 돌봄의 커뮤니티를 만들어봅시다.",inbox:"💌 내 메시지함",placeholder:"당신의 마음을 말해보세요...",send:"전송",sending:"전송 중...",noMessages:"아직 메시지가 없습니다. 와서 당신의 마음을 표현하세요!",commentsTitle:"지원 메시지:",noComments:"아직 지원 메시지가 없습니다",modalTitle:"그의 게시물입니다:",modalAction:"그에게 지원 메시지 남기기:",nicknamePlaceholder:"닉네임",commentPlaceholder:"지원 내용...",submitComment:"지원 보내기",supportMessage:"💝 지원하기",supportDesc:"다른 사람의 감정적 공유를 보고 따뜻한 지원과 격려를 제공",recording:"녹음 중",pressToStop:"누르면 중지",readyToRecord:"녹음 준비",recordInstruction:"「녹음 시작」을 클릭하면 시스템이 음성 메시지 녹음을 시작합니다.",recordTimeLimit:"녹음 시간은 1분으로 제한됩니다",cancel:"취소",startRecording:"녹음 시작",voice:"음성"},vi:{back:"Quay lại",logout:"Đăng xuất",title:"🧱 Bức tường Cảm xúc Restart Wall",subtitle:"Nền tảng Hỗ trợ Cảm xúc Xã hội",subtitleDesc:"Ở đây, mọi người đều có thể tìm thấy sự thuộc về và hỗ trợ về mặt cảm xúc. Chia sẻ cảm xúc của bạn, hoặc cung cấp tin nhắn hỗ trợ ấm áp cho người khác. Hãy cùng nhau xây dựng một cộng đồng quan tâm.",inbox:"💌 Hộp thư của tôi",placeholder:"Nói ra cảm xúc của bạn...",send:"Gửi",sending:"Đang gửi...",noMessages:"Chưa có tin nhắn nào. Hãy đến và chia sẻ cảm xúc của bạn!",commentsTitle:"Tin nhắn hỗ trợ:",noComments:"Chưa có tin nhắn hỗ trợ nào",modalTitle:"Đây là bài đăng của họ:",modalAction:"Để lại tin nhắn hỗ trợ:",nicknamePlaceholder:"Biệt danh của bạn",commentPlaceholder:"Nội dung hỗ trợ...",submitComment:"Gửi hỗ trợ",supportMessage:"💝 Gửi hỗ trợ",supportDesc:"Xem chia sẻ cảm xúc của người khác và đưa ra hỗ trợ và khích lệ ấm áp",recording:"Đang ghi âm",pressToStop:"Nhấn để dừng",readyToRecord:"Sẵn sàng ghi âm",recordInstruction:'Sau khi nhấp vào "Bắt đầu ghi âm", hệ thống sẽ bắt đầu ghi âm tin nhắn giọng nói của bạn.',recordTimeLimit:"Thời gian ghi âm giới hạn 1 phút",cancel:"Hủy",startRecording:"Bắt đầu ghi âm",voice:"Giọng nói"},th:{back:"กลับ",logout:"ออกจากระบบ",title:"🧱 กำแพงอารมณ์ Restart Wall",subtitle:"แพลตฟอร์มสนับสนุนอารมณ์ทางสังคม",subtitleDesc:"ที่นี่ ทุกคนสามารถหาความเป็นเจ้าของและความสนับสนุนทางอารมณ์ได้ แบ่งปันความรู้สึกของคุณ หรือให้ข้อความสนับสนุนที่อบอุ่นแก่ผู้อื่น มาเริ่มสร้างชุมชนที่ห่วงใยกันเถอะ",inbox:"💌 กล่องข้อความของฉัน",placeholder:"บอกความรู้สึกของคุณ...",send:"ส่ง",sending:"กำลังส่ง...",noMessages:"ยังไม่มีข้อความ มาแบ่งปันความรู้สึกของคุณสิ!",commentsTitle:"ข้อความสนับสนุน:",noComments:"ยังไม่มีข้อความสนับสนุน",modalTitle:"นี่คือโพสต์ของพวกเขา:",modalAction:"แสดงข้อความสนับสนุน:",nicknamePlaceholder:"ชื่อเล่นของคุณ",commentPlaceholder:"เนื้อหาสนับสนุน...",submitComment:"ส่งการสนับสนุน",supportMessage:"💝 ให้การสนับสนุน",supportDesc:"ดูการแบ่งปันอารมณ์ของผู้อื่นและให้การสนับสนุนและกำลังใจที่อบอุ่น",recording:"กำลังบันทึก",pressToStop:"กดเพื่อหยุด",readyToRecord:"พร้อมบันทึกเสียง",recordInstruction:'หลังจากคลิก "เริ่มบันทึก" ระบบจะเริ่มบันทึกข้อความเสียงของคุณ',recordTimeLimit:"เวลาบันทึกเสียงจำกัด 1 นาที",cancel:"ยกเลิก",startRecording:"เริ่มบันทึก",voice:"เสียง"},la:{back:"Redire",logout:"Exire",title:"🧱 Murus Emotionum Restart Wall",subtitle:"Platea Socialis Sustentationis Emotionalis",subtitleDesc:"Hic, omnes possunt invenire pertinere emotionalem et sustentationem. Communica sensus tuos, vel praebe calidas sustentationis epistulas aliis. Simul aedificemus communitatem curantem.",inbox:"💌 Cista Mea",placeholder:"Dic quod sentis...",send:"Mittere",sending:"Mittens...",noMessages:"Nullae epistulae adhuc. Veni et communica sensus tuos!",commentsTitle:"Epistulae Sustentationis:",noComments:"Nullae epistulae sustentationis adhuc",modalTitle:"Ecce nuntius eorum:",modalAction:"Mitte epistulam sustentationis:",nicknamePlaceholder:"Tuum agnomen",commentPlaceholder:"Contentum sustentationis...",submitComment:"Mitte Sustentationem",supportMessage:"💝 Da Sustentationem",supportDesc:"Vide communicationem emotionalem aliorum et praebe calidam sustentationem et cohortationem",recording:"Recordans",pressToStop:"Preme ad Desinere",readyToRecord:"Paratus ad Recordandum",recordInstruction:'Postquam "Incipe Recordandum" cliccas, systema incipiet recordare nuntium vocis tuae.',recordTimeLimit:"Tempus recordandi limitatur ad 1 minuta",cancel:"Cancella",startRecording:"Incipe Recordandum",voice:"Vox"},ms:{back:"Kembali",logout:"Log Keluar",title:"🧱 Tembok Emosi Restart Wall",subtitle:"Platform Sokongan Emosi Sosial",subtitleDesc:"Di sini, semua orang dapat mencari rasa kepunyaan dan sokongan emosi. Kongsi perasaan anda, atau berikan mesej sokongan yang hangat kepada orang lain. Mari kita bina komuniti yang prihatin bersama.",inbox:"💌 Kotak Mesej Saya",placeholder:"Katakan perasaan anda...",send:"Hantar",sending:"Menghantar...",noMessages:"Belum ada mesej lagi. Datang dan kongsi perasaan anda!",commentsTitle:"Mesej Sokongan:",noComments:"Belum ada mesej sokongan",modalTitle:"Ini adalah siaran mereka:",modalAction:"Tinggalkan mesej sokongan:",nicknamePlaceholder:"Nama samaran anda",commentPlaceholder:"Kandungan sokongan...",submitComment:"Hantar Sokongan",supportMessage:"💝 Beri Sokongan",supportDesc:"Lihat perkongsian emosi orang lain dan berikan sokongan dan galakan yang hangat",recording:"Merakam",pressToStop:"Tekan untuk Berhenti",readyToRecord:"Sedia untuk Merakam",recordInstruction:'Selepas mengklik "Mula Merakam", sistem akan mula merakam mesej suara anda.',recordTimeLimit:"Masa rakaman terhad kepada 1 minit",cancel:"Batal",startRecording:"Mula Merakam",voice:"Suara"}};function WD(){const n=Et(),e=St(),t=Id(),[r,o]=v.useState([]),[a,c]=v.useState(""),[d,h]=v.useState(!1),[m,g]=v.useState(null),[x,S]=v.useState(""),[j,T]=v.useState(!1),[R,I]=v.useState(null),[F,P]=v.useState(!1),[z,H]=v.useState(!1),[J,O]=v.useState(0),[L,C]=v.useState(null),[A,D]=v.useState([]),[M,B]=v.useState(!1),[_,U]=v.useState(""),[oe,X]=v.useState(0),[ce,le]=v.useState(!1),te=v.useRef(null),xe=v.useRef([]),$=v.useRef(0),[Q,G]=v.useState(null),[ne,se]=v.useState(null),[me,Ie]=v.useState(0),[Pe,qe]=v.useState(null),[Ge,be]=v.useState(!1),{lang:ae,setLang:rt}=Lt(),Le=RS[ae]||RS["zh-TW"],{checkPermission:$e,recordUsage:fe}=Nc(),[_e,Ce]=v.useState(!1),[ze,De]=v.useState(null),{isTestMode:K}=Bo(),ie=async Y=>{var ee,ve,Te;try{const Je=Pn(t,"profiles",Y),He=await To(Je);if(He.exists()){const Ye=He.data();return{name:Ye.nickname||Ye.name||"用戶",avatar:Ye.avatar||"/avatars/Derxl.png",country:Ye.country||"台灣",gender:Ye.gender||"未知",age:Ye.age||25,email:((ee=e.currentUser)==null?void 0:ee.email)||"unknown@example.com"}}else{const Ye=e.currentUser;return{name:(Ye==null?void 0:Ye.displayName)||((ve=Ye==null?void 0:Ye.email)==null?void 0:ve.split("@")[0])||"用戶",avatar:(Ye==null?void 0:Ye.photoURL)||"/avatars/Derxl.png",country:"台灣",gender:"未知",age:25,email:(Ye==null?void 0:Ye.email)||"unknown@example.com"}}}catch(Je){console.error("獲取用戶資料失敗:",Je);const He=e.currentUser;return{name:(He==null?void 0:He.displayName)||((Te=He==null?void 0:He.email)==null?void 0:Te.split("@")[0])||"用戶",avatar:(He==null?void 0:He.photoURL)||"/avatars/Derxl.png",country:"台灣",gender:"未知",age:25,email:(He==null?void 0:He.email)||"unknown@example.com"}}};v.useEffect(()=>{const Y=localStorage.getItem("messages");if(Y)try{const ee=JSON.parse(Y),ve=St(),Te=ve.currentUser,He=ee.filter(mt=>!Te||mt.user.id!=="user123"&&mt.user.id!=="user456"&&mt.user.id!=="user789").filter(mt=>mt.text.includes("[語音留言")&&(!mt.duration||mt.duration<=0)?(console.log("移除無效的語音消息:",mt),!1):!0),Ye=He.sort((mt,_t)=>new Date(_t.createdAt).getTime()-new Date(mt.createdAt).getTime());o(Ye),console.log("已加載localStorage中的消息:",Ye.length,"條"),console.log("消息內容:",Ye),He.length!==ee.length&&(localStorage.setItem("messages",JSON.stringify(He)),console.log("已清理假數據和無效語音消息"));const gt=ve.currentUser;gt&&(async()=>{try{let _t=!1;const xn=await ie(gt.uid),lr=He.map(Br=>{if(Br.comments){const Xt=Br.comments.map(Gt=>((Gt.nickname==="lkjh123"||Gt.commenterEmail==="as0@gmail.com"||!Gt.commenterId||Gt.commenterAge===0||Gt.commenterAge===35||Gt.commenterAge===39)&&(Gt.commenterId=gt.uid,Gt.nickname=xn.name,Gt.commenterEmail=xn.email,Gt.commenterAvatar=xn.avatar,Gt.commenterCountry=xn.country,Gt.commenterGender=xn.gender,Gt.commenterAge=xn.age,Gt.createdAt=Gt.createdAt||new Date().toISOString(),_t=!0,console.log("強制修復支援留言:",Gt)),Gt));return{...Br,comments:Xt}}return Br});_t&&(o(lr),localStorage.setItem("messages",JSON.stringify(lr)),console.log("已修復舊的支援留言數據"))}catch(_t){console.error("修復支援留言數據失敗:",_t)}})()}catch(ee){console.error("解析localStorage消息失敗:",ee)}else console.log("localStorage中沒有保存的消息")},[]);const q=Y=>{const ve=St().currentUser;return ve&&Y.user.id===ve.uid},Me=Y=>{const ve=St().currentUser;return ve&&Y.commenterId===ve.uid},st=()=>{const ee=St().currentUser;return ee?r.filter(ve=>ve.user.id===ee.uid):[]},et=()=>{const ee=St().currentUser,ve=[];return ee?(console.log("當前用戶UID:",ee.uid),console.log("所有留言:",r),r.forEach(Te=>{var Je,He;console.log("檢查留言:",Te.id,"支援留言數量:",((Je=Te.comments)==null?void 0:Je.length)||0),(He=Te.comments)==null||He.forEach(Ye=>{var gt;if(!Ye.commenterId){const mt=ee.displayName||((gt=ee.email)==null?void 0:gt.split("@")[0])||"用戶",_t=ee.email;(Ye.nickname===mt||Ye.commenterEmail===_t)&&(Ye.commenterId=ee.uid,console.log("為舊支援留言添加commenterId:",Ye))}console.log("支援留言:",Ye.nickname,"commenterId:",Ye.commenterId,"當前用戶UID:",ee.uid),Ye.commenterId===ee.uid&&(console.log("找到我的支援留言:",Ye),ve.push({message:Te,comment:Ye}))})}),console.log("我的支援留言總數:",ve.length),ve):(console.log("沒有登入用戶"),ve)},dt=async()=>{if(z){te.current&&te.current.state==="recording"&&te.current.stop(),L&&(clearInterval(L),C(null)),H(!1),P(!1),O(0);return}if(localStorage.getItem("testMode")==="true"){le(!0);return}const ee=await $e("aiChat");if(!ee.allowed){De(ee),Ce(!0);return}le(!0)},Ht=async()=>{le(!1);try{const Y=await navigator.mediaDevices.getUserMedia({audio:!0}),ee=new MediaRecorder(Y,{mimeType:"audio/webm;codecs=opus"});D([]),xe.current=[],O(0),$.current=0,Ie(0),ee.ondataavailable=Te=>{console.log("收到音頻數據，大小:",Te.data.size),Te.data.size>0&&(xe.current.push(Te.data),D(Je=>{const He=[...Je,Te.data];return console.log("更新音頻塊，當前數量:",He.length),He}))},ee.onstop=()=>{L&&(clearInterval(L),C(null));const Te=[...xe.current];console.log("錄音停止，音頻塊數量:",Te.length);const Je=Te.length>0?new Blob(Te,{type:"audio/webm"}):new Blob([""],{type:"audio/webm"}),He=Math.max(1,$.current);console.log("創建音頻blob，大小:",Je.size,"實際錄音時長:",He);const Ye=URL.createObjectURL(Je);U(Ye),X(He),B(!0),Y.getTracks().forEach(gt=>gt.stop()),H(!1),P(!1)},ee.start(100),te.current=ee,H(!0),P(!0);const ve=setInterval(()=>{O(Te=>{const Je=Te+1;return $.current=Je,Je>=60&&(te.current&&te.current.state==="recording"&&te.current.stop(),ve&&(clearInterval(ve),C(null)),H(!1),P(!1),alert("錄音時間已達1分鐘限制，已自動停止錄音")),Je})},1e3);C(ve),console.log("開始錄音...")}catch(Y){console.error("錄音失敗:",Y),alert("無法訪問麥克風，請檢查權限設置")}},je=()=>{le(!1)},Qe=async()=>{if(_){const Y=Math.max(1,oe),ee=`[語音留言 - ${Math.floor(Y/60)}:${(Y%60).toString().padStart(2,"0")}]`;console.log("發送語音留言:",{voiceText:ee,actualDuration:Y}),h(!0);const ve=e.currentUser;if(!ve){alert("請先登入"),h(!1);return}const Te=await ie(ve.uid),Je={id:Date.now().toString(),text:ee,aiReply:"",toneId:"",createdAt:new Date().toISOString(),audioUrl:_,duration:Y,user:{id:ve.uid,name:Te.name,avatar:Te.avatar,country:Te.country,region:Te.country,email:Te.email},comments:[]};console.log("語音留言詳情:",{duration:oe,audioUrl:_,voiceText:ee}),console.log("創建的語音留言對象:",Je);const He=[Je,...r];o(He),localStorage.setItem("messages",JSON.stringify(He)),console.log("語音留言已保存到localStorage"),await fe("aiChat",1),U(""),X(0),B(!1),h(!1)}},Tt=()=>{B(!1),U(""),X(0)},vt=Y=>{if(Q===Y.id&&ne){ne.pause(),G(null),se(null),Pe&&(clearInterval(Pe),qe(null)),Ie(0);return}if(Q===Y.id&&!ne){const ee=new Audio(Y.audioUrl),ve=Y.duration?Y.duration-me:0;ee.currentTime=ve,G(Y.id),se(ee);const Te=setInterval(()=>{Ie(Je=>Je<=1?(clearInterval(Te),G(null),se(null),qe(null),0):Je-1)},1e3);qe(Te),ee.play().then(()=>{console.log("繼續播放原音...")}).catch(Je=>{console.error("播放失敗:",Je),Bt(Y.text)});return}if(ne&&(ne.pause(),Pe&&(clearInterval(Pe),qe(null)),Ie(0)),Y.audioUrl){console.log("播放音頻:",{audioUrl:Y.audioUrl,duration:Y.duration,messageId:Y.id});const ee=new Audio(Y.audioUrl);G(Y.id),se(ee),Ie(Y.duration||0),ee.onerror=Te=>{console.error("音頻加載失敗:",Te),Bt(Y.text)},ee.onended=()=>{G(null),se(null),Ie(0),Pe&&(clearInterval(Pe),qe(null))};const ve=setInterval(()=>{Ie(Te=>Te<=1?(clearInterval(ve),G(null),se(null),qe(null),0):Te-1)},1e3);qe(ve),ee.play().then(()=>{console.log("正在播放原音...")}).catch(Te=>{console.error("播放失敗:",Te),Bt(Y.text)})}else Bt(Y.text)},Bt=Y=>{if("speechSynthesis"in window){const ee=new SpeechSynthesisUtterance(Y);ee.lang="zh-TW",ee.rate=.9,ee.pitch=1,window.speechSynthesis.cancel(),window.speechSynthesis.speak(ee),console.log("正在播放留言內容（文字轉語音）...")}else alert("瀏覽器不支援語音播放功能")},Dt=async()=>{if(!a.trim()){console.log("沒有輸入內容，無法發送");return}console.log("發送消息:",{input:a}),h(!0);const Y=e.currentUser;if(!Y){alert("請先登入"),h(!1);return}const ee=await ie(Y.uid),ve={id:Date.now().toString(),text:a,aiReply:"",toneId:"",createdAt:new Date().toISOString(),user:{id:Y.uid,name:ee.name,avatar:ee.avatar,country:ee.country,region:ee.country,email:ee.email},comments:[]};console.log("創建的消息對象:",ve);const Te=[ve,...r];o(Te),localStorage.setItem("messages",JSON.stringify(Te)),console.log("消息已保存到localStorage"),c(""),h(!1)},ke=()=>{Ce(!1),De(null)},W=Y=>{if(window.confirm(`💝 您確定要刪除這條留言嗎？

刪除後將無法恢復，請確認您的選擇。`)){const ee=r.filter(ve=>ve.id!==Y);o(ee),localStorage.setItem("messages",JSON.stringify(ee)),console.log("已刪除留言:",Y)}};return i.jsxs("div",{className:"modern-bg",style:{background:(window.innerWidth<=768,"#8a8a8a"),backgroundImage:"url(/soil.png)",backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat",minHeight:"100vh",display:"flex",flexDirection:"column"},children:[i.jsxs("div",{style:{position:"absolute",top:0,left:0,width:"100%",zIndex:100,display:"flex",justifyContent:"space-between",alignItems:"center",padding:window.innerWidth<=768?"12px 16px 0 16px":"18px 32px 0 32px",boxSizing:"border-box",background:"transparent"},children:[i.jsx("button",{onClick:()=>n("/"),style:{background:"#fff",border:"2px solid #6B5BFF",borderRadius:8,color:"#6B5BFF",fontWeight:700,fontSize:window.innerWidth<=768?14:16,cursor:"pointer",padding:window.innerWidth<=768?"4px 12px":"6px 18px",transition:"background 0.2s, color 0.2s, box-shadow 0.2s"},children:Le.back}),i.jsxs("div",{style:{display:"flex",gap:window.innerWidth<=768?8:12,marginRight:window.innerWidth<=768?4:8},children:[i.jsx("button",{className:"topbar-btn",onClick:async()=>{await St().signOut(),localStorage.clear(),window.location.href="/"},onMouseOver:Y=>{Y.currentTarget.style.background="#6B5BFF",Y.currentTarget.style.color="#fff"},onMouseOut:Y=>{Y.currentTarget.style.background="",Y.currentTarget.style.color=""},style:{fontSize:window.innerWidth<=768?12:16,padding:window.innerWidth<=768?"4px 8px":"6px 12px"},children:Le.logout}),i.jsx("select",{className:"topbar-select",value:ae,onChange:Y=>{const ee=Y.target.value;rt(ee),localStorage.setItem("lang",ee)},style:{padding:window.innerWidth<=768?"4px 6px":"6px 8px",borderRadius:8,fontWeight:600,cursor:"pointer",minWidth:window.innerWidth<=768?"40px":"50px",width:window.innerWidth<=768?"40px":"50px",fontSize:window.innerWidth<=768?12:14},onMouseOver:Y=>{Y.currentTarget.style.background="#6B5BFF",Y.currentTarget.style.color="#fff"},onMouseOut:Y=>{Y.currentTarget.style.background="",Y.currentTarget.style.color=""},children:OD.map(Y=>i.jsx("option",{value:Y.code,children:Y.label},Y.code))})]})]}),i.jsxs("div",{className:"modern-container",style:{maxWidth:window.innerWidth<=768?"100%":600,width:"100%",margin:"0 auto",flex:1,display:"flex",flexDirection:"column",justifyContent:"center",padding:window.innerWidth<=768?"140px 16px 20px 16px":"0",boxSizing:"border-box",minHeight:window.innerWidth<=768?"100vh":"auto",position:"relative",zIndex:1,overflow:"hidden",background:(window.innerWidth<=768,"linear-gradient(135deg, #FFB366 0%, #FFE5CC 100%)"),transform:"translate3d(0, 0, 0)",backfaceVisibility:"hidden",perspective:"1000px",willChange:"auto"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:(window.innerWidth<=768,12),flexDirection:(window.innerWidth<=768,"column"),gap:(window.innerWidth<=768,8),width:"100%",minHeight:(window.innerWidth<=768,"auto"),background:(window.innerWidth<=768,"linear-gradient(135deg, #FFB366 0%, #FFE5CC 100%)")},children:[i.jsx("h2",{className:"modern-title",style:{fontSize:(window.innerWidth<=768,"1.2rem"),margin:0,flex:1,textAlign:"center",color:"#6B5BFF",textShadow:"0 2px 12px #6B5BFF88, 0 4px 24px #0008",letterSpacing:1,display:"flex",alignItems:"center",gap:(window.innerWidth<=768,2),whiteSpace:"nowrap",flexWrap:"wrap",justifyContent:"center",background:(window.innerWidth<=768,"linear-gradient(135deg, #FFB366 0%, #FFE5CC 100%)")},children:Le.title}),window.innerWidth<=768&&i.jsx("button",{onClick:()=>{console.log("【我的留言】按鈕被點擊，當前狀態:",j),T(!j),console.log("設置新狀態:",!j)},style:{background:j?"linear-gradient(135deg, #23c6e6 60%, #6B5BFF 100%)":"linear-gradient(135deg, #6B5BFF 60%, #23c6e6 100%)",color:"#fff",border:"none",borderRadius:12,fontWeight:900,fontSize:10,padding:"8px 12px",boxShadow:"0 2px 12px #6B5BFF33",letterSpacing:1,display:"flex",alignItems:"center",justifyContent:"center",gap:"2px",whiteSpace:"nowrap",width:"120px",minHeight:"32px",cursor:"pointer",zIndex:9999,position:"relative",pointerEvents:"auto",userSelect:"none",WebkitUserSelect:"none",MozUserSelect:"none",msUserSelect:"none",touchAction:"manipulation"},children:j?ae==="zh-TW"||ae==="zh-CN"?"🌍 所有留言":ae==="en"?"🌍 All Messages":ae==="ja"?"🌍 すべてのメッセージ":ae==="ko"?"🌍 모든 메시지":ae==="vi"?"🌍 Tất cả tin nhắn":ae==="th"?"🌍 ข้อความทั้งหมด":ae==="la"?"🌍 Visi ziņojumi":ae==="ms"?"🌍 Semua mesej":"🌍 所有留言":ae==="zh-TW"||ae==="zh-CN"?"💌 我的留言":ae==="en"?"💌 My Messages":ae==="ja"?"💌 私のメッセージ":ae==="ko"?"💌 내 메시지":ae==="vi"?"💌 Tin nhắn của tôi":ae==="th"?"💌 ข้อความของฉัน":ae==="la"?"💌 Mani ziņojumi":ae==="ms"?"💌 Mesej saya":"💌 我的留言"})]}),i.jsxs("div",{style:{background:"linear-gradient(135deg, rgba(107, 91, 255, 0.1) 0%, rgba(35, 198, 230, 0.1) 100%)",borderRadius:"20px",padding:window.innerWidth<=768?"16px":"24px",marginBottom:"18px",border:"2px solid rgba(107, 91, 255, 0.2)",boxShadow:"0 8px 32px rgba(107, 91, 255, 0.15)",backdropFilter:"blur(10px)",textAlign:"center",marginTop:window.innerWidth<=768?"20px":window.innerWidth<=768?"0":"-10px"},children:[i.jsx("h3",{style:{color:"#fff",fontSize:window.innerWidth<=768?"1.2rem":"1.5rem",fontWeight:"700",margin:"0 0 12px 0",textShadow:"0 2px 8px rgba(107, 91, 255, 0.3)"},children:Le.subtitle}),i.jsx("p",{style:{color:"#000",fontSize:window.innerWidth<=768?"0.8rem":"0.9rem",lineHeight:"1.6",margin:"0",opacity:"0.9"},children:"在這裡，分享你真實的情感與心情，或為他人提供溫暖的支援留言，彼此傾聽支持，每個人都能找到情感上的歸屬感和後盾，讓我們一起建立溫暖的社群，共同打造一個有溫度大家庭。"})]}),i.jsx("div",{className:"tone-list",style:{marginBottom:18}}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:12,marginBottom:18,padding:(window.innerWidth<=768,"0 8px"),width:"100%",maxWidth:"600px",margin:"0 auto"},children:[i.jsx("input",{className:"quote-card",style:{width:window.innerWidth<=768?"100%":"calc(100% - 32px)",fontSize:window.innerWidth<=768?16:18,padding:window.innerWidth<=768?"10px 14px":"12px 16px",border:"2px solid rgba(107, 91, 255, 0.5)",outline:"none",background:"#232946",color:"#fff",borderRadius:"12px",marginBottom:"8px",boxSizing:"border-box",margin:window.innerWidth<=768?void 0:"0 auto 8px auto"},maxLength:200,placeholder:Le.placeholder,value:a,onChange:Y=>c(Y.target.value),onKeyDown:Y=>Y.key==="Enter"&&Dt(),disabled:d}),i.jsxs("div",{style:{display:"flex",gap:8,justifyContent:"space-between",width:window.innerWidth<=768?"100%":"calc(100% - 32px)",padding:window.innerWidth<=768?"0 8px":"0 8px 0 16px",margin:window.innerWidth<=768?void 0:"0 auto"},children:[i.jsx("button",{className:"tone-card selected",style:{fontSize:window.innerWidth<=768?14:16,padding:window.innerWidth<=768?"8px 12px":"10px 16px",minWidth:window.innerWidth<=768?"60px":"70px",whiteSpace:"nowrap",flexShrink:0,borderRadius:"8px",background:"linear-gradient(135deg, #6B5BFF 0%, #23c6e6 100%)",color:"#fff",border:"none",cursor:"pointer"},onClick:()=>{console.log("發送按鈕被點擊"),console.log("當前狀態:",{input:a,loading:d}),Dt()},disabled:d,children:d?Le.sending:Le.send}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"},children:[i.jsxs("button",{onClick:dt,style:{background:F?"linear-gradient(135deg, #f44336 0%, #d32f2f 100%)":"linear-gradient(135deg, #2196F3 0%, #1976D2 100%)",border:"none",borderRadius:"12px",padding:window.innerWidth<=768?"10px 16px":"10px 10px",color:"white",cursor:"pointer",fontSize:"16px",fontWeight:"600",boxShadow:F?"0 4px 16px rgba(244, 67, 54, 0.3)":"0 4px 16px rgba(33, 150, 243, 0.3)",transition:"all 0.3s ease",display:"flex",alignItems:"center",gap:"8px",animation:F?"pulse 1.5s infinite":"none",minWidth:window.innerWidth<=768?"70px":"56px",whiteSpace:"nowrap",flexShrink:0,marginRight:window.innerWidth<=768?void 0:8},onMouseOver:Y=>{F||(Y.currentTarget.style.transform="translateY(-2px)",Y.currentTarget.style.boxShadow="0 6px 20px rgba(33, 150, 243, 0.4)")},onMouseOut:Y=>{F||(Y.currentTarget.style.transform="translateY(0)",Y.currentTarget.style.boxShadow="0 4px 16px rgba(33, 150, 243, 0.3)")},children:[i.jsx("span",{style:{fontSize:"18px"},children:"🎤"}),F?`${Le.recording} ${Math.floor(J/60)}:${(J%60).toString().padStart(2,"0")}`:Le.voice]}),F&&i.jsx("div",{style:{fontSize:"12px",color:"#f44336",marginTop:"4px",fontWeight:"500"},children:Le.pressToStop}),window.innerWidth>768&&i.jsx("button",{onClick:()=>{console.log("【我的留言】按鈕被點擊，當前狀態:",j),T(!j),console.log("設置新狀態:",!j)},style:{background:j?"linear-gradient(135deg, #23c6e6 60%, #6B5BFF 100%)":"linear-gradient(135deg, #6B5BFF 60%, #23c6e6 100%)",color:"#fff",border:"none",borderRadius:12,fontWeight:900,fontSize:10,padding:"6px 10px",boxShadow:"0 2px 12px #6B5BFF33",letterSpacing:1,display:"flex",alignItems:"center",justifyContent:"center",gap:"2px",whiteSpace:"nowrap",width:"100px",minHeight:"28px",cursor:"pointer",zIndex:9999,position:"relative",pointerEvents:"auto",userSelect:"none",WebkitUserSelect:"none",MozUserSelect:"none",msUserSelect:"none",touchAction:"manipulation",marginTop:"8px"},children:j?ae==="zh-TW"||ae==="zh-CN"?"🌍 所有留言":ae==="en"?"🌍 All":ae==="ja"?"🌍 すべて":ae==="ko"?"🌍 모든":ae==="vi"?"🌍 Tất cả":ae==="th"?"🌍 ทั้งหมด":ae==="la"?"🌍 Visi":ae==="ms"?"🌍 Semua":"🌍 所有留言":ae==="zh-TW"||ae==="zh-CN"?"💌 我的留言":ae==="en"?"💌 My":ae==="ja"?"💌 私の":ae==="ko"?"💌 내":ae==="vi"?"💌 Tin nhắn":ae==="th"?"💌 ข้อความ":ae==="la"?"💌 Mani":ae==="ms"?"💌 Mesej":"💌 我的留言"})]})]}),i.jsx("div",{className:"quote-list",children:j?i.jsxs("div",{children:[i.jsxs("h3",{style:{color:"#6B5BFF",fontSize:"1.5rem",marginBottom:"20px",textAlign:"center",fontWeight:"700"},children:["💌 ",ae==="zh-TW"||ae==="zh-CN"?"我的留言":ae==="en"?"My Messages":ae==="ja"?"私のメッセージ":ae==="ko"?"내 메시지":ae==="vi"?"Tin nhắn của tôi":ae==="th"?"ข้อความของฉัน":ae==="la"?"Mani ziņojumi":ae==="ms"?"Mesej saya":"我的留言"]}),i.jsxs("div",{style:{marginBottom:"24px"},children:[i.jsx("h3",{style:{color:"#6B5BFF",fontSize:"1.2rem",marginBottom:"12px",textAlign:"center"},children:"📝 我發表的留言"}),st().length===0?i.jsx("div",{style:{color:"#000",textAlign:"center",padding:"20px"},children:"您還沒有發表過留言"}):st().map(Y=>i.jsxs("div",{className:"quote-card",style:{position:"relative",paddingLeft:64,marginBottom:"12px"},children:[i.jsx("img",{src:Y.user.avatar,alt:"avatar",style:{width:48,height:48,borderRadius:"50%",objectFit:"cover",position:"absolute",left:8,top:16,cursor:"pointer",border:"2px solid #6B5BFF"},onClick:()=>g(Y)}),i.jsx("button",{onClick:()=>W(Y.id),style:{position:"absolute",top:"8px",right:"8px",background:"linear-gradient(135deg, #ff6b6b 60%, #ff8e8e 100%)",color:"#fff",border:"none",borderRadius:"12px",padding:"4px 8px",fontSize:"12px",fontWeight:"600",cursor:"pointer",boxShadow:"0 2px 8px rgba(255, 107, 107, 0.3)",zIndex:10},children:"刪除"}),i.jsx("div",{className:"quote-text",children:Y.text}),Y.audioUrl&&i.jsxs("div",{style:{marginTop:"8px",display:"flex",alignItems:"center",gap:"8px"},children:[i.jsxs("button",{onClick:()=>vt(Y),style:{background:"linear-gradient(135deg, #4CAF50 0%, #45a049 100%)",border:"none",borderRadius:"6px",padding:"4px 8px",color:"white",cursor:"pointer",fontSize:"12px",display:"flex",alignItems:"center",gap:"4px"},children:[i.jsx("span",{children:Q===Y.id?"⏹️":"▶️"}),Q===Y.id?"停止播放":"播放原音"]}),i.jsxs("span",{style:{fontSize:"12px",color:"#ccc"},children:["錄音時長: ",Y.duration&&Y.duration>0?`${Math.floor(Y.duration/60)}:${(Y.duration%60).toString().padStart(2,"0")}`:"未知"]})]}),i.jsx("div",{style:{fontSize:12,color:"#fff",marginTop:6},children:new Date(Y.createdAt).toLocaleString()}),i.jsxs("div",{style:{marginTop:14,background:"#f7f7ff",borderRadius:10,padding:"10px 14px",boxShadow:"0 1px 6px #6B5BFF11"},children:[i.jsx("b",{style:{color:"#6B5BFF",fontSize:16},children:Le.commentsTitle}),(Y.comments||[]).length===0&&i.jsx("span",{style:{color:"#bbb",marginLeft:8},children:Le.noComments}),i.jsx("div",{style:{display:"flex",flexDirection:"column",gap:6,marginTop:6},children:(Y.comments||[]).sort((ee,ve)=>{const Te=ee.createdAt?new Date(ee.createdAt).getTime():new Date(Y.createdAt).getTime();return(ve.createdAt?new Date(ve.createdAt).getTime():new Date(Y.createdAt).getTime())-Te}).map((ee,ve)=>i.jsxs("div",{style:{background:"#fff",borderRadius:8,padding:"8px 12px",color:"#232946",fontSize:15,border:"1px solid #eee",boxShadow:"0 1px 4px #6B5BFF08",position:"relative",paddingLeft:"60px"},children:[i.jsx("img",{src:ee.commenterAvatar||"https://via.placeholder.com/40x40/6B7280/FFFFFF?text=?",alt:"commenter avatar",style:{width:40,height:40,borderRadius:"50%",objectFit:"cover",position:"absolute",left:8,top:8,border:"2px solid #6B5BFF"}}),i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"4px"},children:[i.jsx("b",{style:{color:"#6B5BFF"},children:ee.nickname}),(q(Y)||Me(ee))&&i.jsxs("div",{style:{fontSize:"12px",color:"#666"},children:[i.jsxs("div",{children:["📧 ",ee.commenterEmail]}),i.jsxs("div",{children:["🌍 ",ee.commenterCountry]}),i.jsxs("div",{children:["👤 ",ee.commenterGender,"・",ee.commenterAge,"歲"]})]}),!q(Y)&&!Me(ee)&&i.jsx("div",{style:{fontSize:"12px",color:"#666"},children:i.jsxs("div",{children:["🌍 ",ee.commenterCountry]})})]}),i.jsx("div",{children:ee.content}),i.jsx("div",{style:{fontSize:10,color:"#999",marginTop:4},children:ee.createdAt?new Date(ee.createdAt).toLocaleString():new Date(Y.createdAt).toLocaleString()}),q(Y)&&!Me(ee)&&i.jsx("button",{onClick:()=>alert(`聯繫 ${ee.nickname}：
郵箱：${ee.commenterEmail}
國家：${ee.commenterCountry}
性別：${ee.commenterGender}
年齡：${ee.commenterAge}`),style:{position:"absolute",top:"8px",right:"8px",background:"linear-gradient(135deg, #6B5BFF 60%, #23c6e6 100%)",color:"#fff",border:"none",borderRadius:"12px",padding:"4px 8px",fontSize:"10px",cursor:"pointer",fontWeight:"600"},children:"📞 聯繫"})]},ve))})]})]},Y.id))]})]}):i.jsxs(i.Fragment,{children:[i.jsxs("h3",{style:{color:"#6B5BFF",fontSize:"1.2rem",marginBottom:"20px",textAlign:"center",fontWeight:"700"},children:["🌍 ",ae==="zh-TW"||ae==="zh-CN"?"全部留言":ae==="en"?"All Messages":ae==="ja"?"すべてのメッセージ":ae==="ko"?"모든 메시지":ae==="vi"?"Tất cả tin nhắn":ae==="th"?"ข้อความทั้งหมด":ae==="la"?"Visi ziņojumi":ae==="ms"?"Semua mesej":"全部留言"]}),r.filter(Y=>!q(Y)).length===0&&i.jsx("div",{style:{color:"#000",textAlign:"center",marginTop:32},children:Le.noMessages}),i.jsxs("div",{style:{marginTop:"40px",marginBottom:"40px"},children:[i.jsx("h3",{style:{color:"#6B5BFF",fontSize:"1rem",marginBottom:"12px",textAlign:"center"},children:"💝 我給別人的支援留言"}),(()=>{const Y=et();return console.log("我的支援留言數量:",Y.length),console.log("我的支援留言:",Y),Y.length===0?i.jsx("div",{style:{color:"#000",textAlign:"center",padding:"20px"},children:"您還沒有給別人留過支援留言"}):Y.map(({message:ee,comment:ve},Te)=>i.jsxs("div",{className:"quote-card",style:{position:"relative",paddingLeft:64,marginBottom:"12px"},children:[i.jsx("img",{src:ee.user.avatar,alt:"avatar",style:{width:48,height:48,borderRadius:"50%",objectFit:"cover",position:"absolute",left:8,top:16,border:"2px solid #6B5BFF"}}),i.jsxs("div",{style:{fontSize:"12px",color:"#666",marginBottom:"4px"},children:["給 ",i.jsx("b",{style:{color:"#6B5BFF"},children:ee.user.name})," 的支援留言："]}),i.jsx("div",{className:"quote-text",style:{background:"#f0f8ff",padding:"8px 12px",borderRadius:"8px",border:"1px solid #e6f3ff"},children:ve.content}),i.jsx("div",{style:{fontSize:12,color:"#614425",marginTop:6},children:ve.createdAt?new Date(ve.createdAt).toLocaleString():new Date(ee.createdAt).toLocaleString()})]},Te))})()]}),r.filter(Y=>!q(Y)).map(Y=>i.jsxs("div",{className:"quote-card",style:{position:"relative",paddingLeft:64},children:[i.jsx("img",{src:Y.user.avatar,alt:"avatar",style:{width:48,height:48,borderRadius:"50%",objectFit:"cover",position:"absolute",left:8,top:16,cursor:"pointer",border:"2px solid #6B5BFF"},onClick:()=>g(Y)}),i.jsx("div",{className:"quote-text",children:Y.text}),Y.audioUrl&&i.jsxs("div",{style:{marginTop:"8px",display:"flex",alignItems:"center",gap:"8px"},children:[i.jsxs("button",{onClick:()=>vt(Y),style:{background:"linear-gradient(135deg, #4CAF50 0%, #45a049 100%)",border:"none",borderRadius:"6px",padding:"4px 8px",color:"white",cursor:"pointer",fontSize:"12px",display:"flex",alignItems:"center",gap:"4px"},children:[i.jsx("span",{children:Q===Y.id?"⏹️":"▶️"}),Q===Y.id?"停止播放":"播放原音"]}),i.jsxs("span",{style:{fontSize:"12px",color:"#ccc"},children:["錄音時長: ",Y.duration&&Y.duration>0?`${Math.floor(Y.duration/60)}:${(Y.duration%60).toString().padStart(2,"0")}`:"未知"]})]}),i.jsx("div",{style:{fontSize:12,color:"#fff",marginTop:6},children:new Date(Y.createdAt).toLocaleString()}),i.jsx("div",{style:{marginTop:12,display:"flex",justifyContent:"center"},children:i.jsx("button",{onClick:()=>g(Y),style:{background:"linear-gradient(135deg, #6B5BFF 60%, #23c6e6 100%)",color:"#fff",border:"none",borderRadius:"20px",padding:"8px 20px",fontSize:"14px",fontWeight:"600",cursor:"pointer",boxShadow:"0 2px 8px rgba(107, 91, 255, 0.3)"},children:Le.supportMessage})}),i.jsxs("div",{style:{marginTop:14,background:"#f7f7ff",borderRadius:10,padding:"10px 14px",boxShadow:"0 1px 6px #6B5BFF11"},children:[i.jsx("b",{style:{color:"#6B5BFF",fontSize:16},children:Le.commentsTitle}),(Y.comments||[]).length===0&&i.jsx("span",{style:{color:"#bbb",marginLeft:8},children:Le.noComments}),i.jsx("div",{style:{display:"flex",flexDirection:"column",gap:6,marginTop:6},children:(Y.comments||[]).sort((ee,ve)=>{const Te=ee.createdAt?new Date(ee.createdAt).getTime():new Date(Y.createdAt).getTime();return(ve.createdAt?new Date(ve.createdAt).getTime():new Date(Y.createdAt).getTime())-Te}).map((ee,ve)=>i.jsxs("div",{style:{background:"#fff",borderRadius:8,padding:"8px 12px",color:"#232946",fontSize:15,border:"1px solid #eee",boxShadow:"0 1px 4px #6B5BFF08",position:"relative",paddingLeft:"60px"},children:[i.jsx("img",{src:ee.commenterAvatar||"https://via.placeholder.com/40x40/6B7280/FFFFFF?text=?",alt:"commenter avatar",style:{width:40,height:40,borderRadius:"50%",objectFit:"cover",position:"absolute",left:8,top:8,border:"2px solid #6B5BFF"}}),i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"4px"},children:[i.jsx("b",{style:{color:"#6B5BFF"},children:ee.nickname}),(q(Y)||Me(ee))&&i.jsxs("div",{style:{fontSize:"12px",color:"#666"},children:[i.jsxs("div",{children:["📧 ",ee.commenterEmail]}),i.jsxs("div",{children:["🌍 ",ee.commenterCountry]}),i.jsxs("div",{children:["👤 ",ee.commenterGender,"・",ee.commenterAge,"歲"]})]}),!q(Y)&&!Me(ee)&&i.jsx("div",{style:{fontSize:"12px",color:"#666"},children:i.jsxs("div",{children:["🌍 ",ee.commenterCountry]})})]}),i.jsx("div",{children:ee.content}),i.jsx("div",{style:{fontSize:10,color:"#999",marginTop:4},children:ee.createdAt?new Date(ee.createdAt).toLocaleString():new Date(Y.createdAt).toLocaleString()}),q(Y)&&!Me(ee)&&i.jsx("button",{onClick:()=>alert(`聯繫 ${ee.nickname}：
郵箱：${ee.commenterEmail}
國家：${ee.commenterCountry}
性別：${ee.commenterGender}
年齡：${ee.commenterAge}`),style:{position:"absolute",top:"8px",right:"8px",background:"linear-gradient(135deg, #6B5BFF 60%, #23c6e6 100%)",color:"#fff",border:"none",borderRadius:"12px",padding:"4px 8px",fontSize:"10px",cursor:"pointer",fontWeight:"600"},children:"📞 聯繫"})]},ve))})]})]},Y.id))]})})]})]}),ce&&i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.5)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1e3},children:i.jsxs("div",{style:{background:"white",borderRadius:"16px",padding:"24px",maxWidth:"400px",width:"90%",textAlign:"center",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.3)"},children:[i.jsx("div",{style:{fontSize:"48px",marginBottom:"16px"},children:"🎤"}),i.jsx("h3",{style:{margin:"0 0 16px 0",color:"#333",fontSize:"20px"},children:Le.readyToRecord}),i.jsxs("p",{style:{margin:"0 0 20px 0",color:"#666",lineHeight:"1.5"},children:[Le.recordInstruction,i.jsx("br",{}),i.jsxs("strong",{style:{color:"#ff6b6b"},children:["⚠️ ",Le.recordTimeLimit]})]}),i.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"center"},children:[i.jsx("button",{onClick:je,style:{background:"#f44336",border:"none",borderRadius:"8px",padding:"12px 24px",color:"white",cursor:"pointer",fontSize:"16px",fontWeight:"600",minWidth:"120px"},children:Le.cancel}),i.jsx("button",{onClick:Ht,style:{background:"linear-gradient(135deg, #2196F3 0%, #1976D2 100%)",border:"none",borderRadius:"8px",padding:"12px 24px",color:"white",cursor:"pointer",fontSize:"16px",fontWeight:"600",minWidth:"120px"},children:Le.startRecording})]})]})}),M&&i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.5)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1e3},children:i.jsxs("div",{style:{background:"white",borderRadius:"16px",padding:"24px",maxWidth:"400px",width:"90%",textAlign:"center",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.3)"},children:[i.jsx("h3",{style:{margin:"0 0 16px 0",color:"#333"},children:"語音錄製完成"}),i.jsxs("p",{style:{margin:"0 0 20px 0",color:"#666"},children:["錄音時長: ",oe>0?`${Math.floor(oe/60)}:${(oe%60).toString().padStart(2,"0")}`:"0:00"," (實際錄音: ",Math.max(1,oe),"秒)"]}),i.jsxs("button",{onClick:()=>{if(_){const Y=Math.max(1,oe);if(ne){ne.pause(),se(null),Pe&&(clearInterval(Pe),qe(null));return}const ee=new Audio(_);se(ee),Ie(Y),ee.onended=()=>{se(null),Ie(0),Pe&&(clearInterval(Pe),qe(null))};const ve=setInterval(()=>{Ie(Te=>Te<=1?(clearInterval(ve),se(null),0):Te-1)},1e3);qe(ve),ee.play()}},style:{background:"linear-gradient(135deg, #4CAF50 0%, #45a049 100%)",border:"none",borderRadius:"8px",padding:"8px 16px",color:"white",cursor:"pointer",fontSize:"14px",marginBottom:"16px",display:"flex",alignItems:"center",gap:"6px",margin:"0 auto 16px auto"},children:[i.jsx("span",{children:ne?"⏹️":"▶️"}),ne?"停止播放":"播放錄音"]}),i.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"center"},children:[i.jsx("button",{onClick:Qe,style:{background:"linear-gradient(135deg, #2196F3 0%, #1976D2 100%)",border:"none",borderRadius:"8px",padding:"10px 20px",color:"white",cursor:"pointer",fontSize:"14px",fontWeight:"600"},children:"發送語音"}),i.jsx("button",{onClick:Tt,style:{background:"#f44336",border:"none",borderRadius:"8px",padding:"10px 20px",color:"white",cursor:"pointer",fontSize:"14px",fontWeight:"600"},children:"取消"})]})]})}),_e&&ze&&i.jsx(qa,{isOpen:_e,onClose:ke,currentPlan:ze.currentPlan,remainingDays:ze.remainingDays,usedTokens:ze.usedTokens,totalTokens:ze.totalTokens}),i.jsx("div",{style:{width:"100%",margin:"0 auto",marginTop:24,background:"rgba(255,255,255,0.95)",borderRadius:16,padding:"16px",boxShadow:"0 2px 12px #6B5BFF22"},children:i.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:20,flexWrap:"wrap"},children:[i.jsx("a",{href:"/about",style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12},children:ae==="zh-TW"?"🧬 Restarter™｜我們是誰":ae==="zh-CN"?"🧬 Restarter™｜我们是谁":ae==="en"?"🧬 Restarter™｜Who We Are":ae==="ja"?"🧬 Restarter™｜私たちについて":ae==="ko"?"🧬 Restarter™｜우리는 누구인가":ae==="th"?"🧬 Restarter™｜เราเป็นใคร":ae==="vi"?"🧬 Restarter™｜Chúng tôi là ai":ae==="ms"?"🧬 Restarter™｜Siapa Kami":"🧬 Restarter™｜Quis sumus"}),i.jsx("a",{href:"/privacy-policy",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12},children:ae==="zh-TW"?"隱私權政策":ae==="zh-CN"?"隐私政策":ae==="en"?"Privacy Policy":ae==="ja"?"プライバシーポリシー":ae==="ko"?"개인정보 처리방침":ae==="th"?"นโยบายความเป็นส่วนตัว":ae==="vi"?"Chính sách bảo mật":ae==="ms"?"Dasar Privasi":"Consilium de Privata"}),i.jsx("a",{href:"/terms",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12},children:ae==="zh-TW"?"條款/聲明":ae==="zh-CN"?"条款/声明":ae==="en"?"Terms/Statement":ae==="ja"?"規約/声明":ae==="ko"?"약관/성명":ae==="th"?"ข้อกำหนด/แถลงการณ์":ae==="vi"?"Điều khoản/Tuyên bố":ae==="ms"?"Terma/Pernyataan":"Termini/Declaratio"}),i.jsx("a",{href:"/data-deletion",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12},children:ae==="zh-TW"?"資料刪除說明":ae==="zh-CN"?"数据删除说明":ae==="en"?"Data Deletion":ae==="ja"?"データ削除について":ae==="ko"?"데이터 삭제 안내":ae==="th"?"คำอธิบายการลบข้อมูล":ae==="vi"?"Giải thích xóa dữ liệu":ae==="ms"?"Penjelasan Penghapusan Data":"Explicatio Deletionis Datae"}),i.jsx("a",{href:"/feedback",style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12},children:ae==="zh-TW"?"💬 意見箱｜我們想聽你說":ae==="zh-CN"?"💬 意见箱｜我们想听你说":ae==="en"?"💬 Feedback Box｜We Want to Hear From You":ae==="ja"?"💬 ご意見箱｜私たちはあなたの声を聞きたい":ae==="ko"?"💬 피드백｜우리는 당신의 말을 듣고 싶습니다":ae==="th"?"💬 กล่องความคิดเห็น｜เราอยากได้ยินจากคุณ":ae==="vi"?"💬 Hộp góp ý｜Chúng tôi muốn nghe từ bạn":ae==="ms"?"💬 Kotak Maklum Balas｜Kami Ingin Mendengar Dari Anda":"💬 Arca Consilii｜Volumus Audire a Te"})]})})]})}const ES={"zh-TW":{title:"心聲釋放 Voice Release",subtitle:"無需放在心裡...對哪些人事物不滿你可盡情說出，天下沒有不能解決的難題",holdToRecord:"按住錄音",webSimulation:"(網頁版使用模擬錄音)",recording:"錄音中...",stopRecording:"停止錄音",todayMood:"今天的心情",reflectionMoment:"反思時刻",addDiary:"添加心聲",editDiary:"編輯心聲",deleteDiary:"刪除心聲",save:"保存",cancel:"取消",backToHome:"← 返回首頁",logout:"登出",noDiaries:"還沒有心聲日記，開始錄音吧！",startSpeaking:"開始說話",submit:"送出",submitVoice:"送出心聲",recordingComplete:"錄音完成",submitToSave:"點擊送出保存心聲",emotion:{happy:"開心",sad:"難過",angry:"生氣",neutral:"平靜",excited:"興奮",calm:"放鬆"}},"zh-CN":{title:"心声释放 Voice Release",subtitle:"无需放在心里...对哪些人事物不满你可尽情说出，天下没有不能解决的难题",holdToRecord:"按住录音",webSimulation:"(网页版使用模拟录音)",recording:"录音中...",stopRecording:"停止录音",todayMood:"今天的心情",reflectionMoment:"反思时刻",addDiary:"添加心声",editDiary:"编辑心声",deleteDiary:"删除心声",save:"保存",cancel:"取消",backToHome:"← 返回首页",logout:"登出",noDiaries:"还没有心声日记，开始录音吧！",startSpeaking:"开始说话",submit:"送出",submitVoice:"送出心声",recordingComplete:"录音完成",submitToSave:"点击送出保存心声",emotion:{happy:"开心",sad:"难过",angry:"生气",neutral:"平静",excited:"兴奋",calm:"放松"}},ja:{title:"心の声を解放 Voice Release",subtitle:"心に留めておく必要はない...どの人や物事への不満も自由に言い、解決できない問題はない",holdToRecord:"録音を押し続ける",webSimulation:"(Web版は模擬録音を使用)",recording:"録音中...",stopRecording:"録音停止",todayMood:"今日の気分",reflectionMoment:"反省の瞬間",addDiary:"心の声を追加",editDiary:"心の声を編集",deleteDiary:"心の声を削除",save:"保存",cancel:"キャンセル",backToHome:"← ホームに戻る",logout:"ログアウト",noDiaries:"まだ心の声の日記がありません。録音を始めましょう！",startSpeaking:"話し始める",submit:"送信",submitVoice:"心の声を送信",recordingComplete:"録音完了",submitToSave:"送信して心の声を保存",emotion:{happy:"嬉しい",sad:"悲しい",angry:"怒り",neutral:"平静",excited:"興奮",calm:"リラックス"}},ko:{title:"마음의 소리 해방 Voice Release",subtitle:"마음속에 담아둘 필요 없이...어떤 사람이나 사물에 대한 불만을 자유롭게 말하고, 해결할 수 없는 문제는 없다",holdToRecord:"녹음하려면 길게 누르세요",webSimulation:"(웹 버전은 시뮬레이션 녹음 사용)",recording:"녹음 중...",stopRecording:"녹음 중지",todayMood:"오늘의 기분",reflectionMoment:"성찰의 순간",addDiary:"마음의 소리 추가",editDiary:"마음의 소리 편집",deleteDiary:"마음의 소리 삭제",save:"저장",cancel:"취소",backToHome:"← 홈으로 돌아가기",logout:"로그아웃",noDiaries:"아직 마음의 소리 일기가 없습니다. 녹음을 시작해보세요!",startSpeaking:"말하기 시작",submit:"제출",submitVoice:"마음의 소리 제출",recordingComplete:"녹음 완료",submitToSave:"제출하여 마음의 소리 저장",emotion:{happy:"행복",sad:"슬픔",angry:"분노",neutral:"평온",excited:"흥분",calm:"차분"}},th:{title:"ปลดปล่อยเสียงในใจ Voice Release",subtitle:"ไม่จำเป็นต้องเก็บไว้ในใจ...คุณสามารถพูดความไม่พอใจต่อคนหรือสิ่งต่างๆ ได้อย่างอิสระ ไม่มีปัญหาที่แก้ไขไม่ได้",holdToRecord:"กดค้างเพื่อบันทึก",webSimulation:"(เวอร์ชันเว็บใช้การบันทึกจำลอง)",recording:"กำลังบันทึก...",stopRecording:"หยุดบันทึก",todayMood:"อารมณ์วันนี้",reflectionMoment:"ช่วงเวลาสะท้อนคิด",addDiary:"เพิ่มเสียงในใจ",editDiary:"แก้ไขเสียงในใจ",deleteDiary:"ลบเสียงในใจ",save:"บันทึก",cancel:"ยกเลิก",backToHome:"← กลับหน้าหลัก",logout:"ออกจากระบบ",noDiaries:"ยังไม่มีไดอารี่เสียงในใจ เริ่มบันทึกกันเลย!",startSpeaking:"เริ่มพูด",submit:"ส่ง",submitVoice:"ส่งเสียงในใจ",recordingComplete:"บันทึกเสร็จสิ้น",submitToSave:"คลิกส่งเพื่อบันทึกเสียงในใจ",emotion:{happy:"มีความสุข",sad:"เศร้า",angry:"โกรธ",neutral:"สงบ",excited:"ตื่นเต้น",calm:"ผ่อนคลาย"}},vi:{title:"Giải Phóng Tiếng Lòng Voice Release",subtitle:"Không cần giữ trong lòng...bạn có thể tự do nói ra sự bất mãn với những người hoặc sự việc nào đó, không có vấn đề nào không thể giải quyết",holdToRecord:"Giữ để ghi âm",webSimulation:"(Phiên bản web sử dụng ghi âm mô phỏng)",recording:"Đang ghi âm...",stopRecording:"Dừng ghi âm",todayMood:"Tâm trạng hôm nay",reflectionMoment:"Khoảnh khắc suy ngẫm",addDiary:"Thêm tiếng lòng",editDiary:"Chỉnh sửa tiếng lòng",deleteDiary:"Xóa tiếng lòng",save:"Lưu",cancel:"Hủy",backToHome:"← Về trang chủ",logout:"Đăng xuất",noDiaries:"Chưa có nhật ký tiếng lòng, hãy bắt đầu ghi âm!",startSpeaking:"Bắt đầu nói",submit:"Gửi",submitVoice:"Gửi tiếng lòng",recordingComplete:"Ghi âm hoàn thành",submitToSave:"Nhấp để gửi và lưu tiếng lòng",emotion:{happy:"Vui vẻ",sad:"Buồn",angry:"Tức giận",neutral:"Bình tĩnh",excited:"Hưng phấn",calm:"Thư giãn"}},ms:{title:"Pelepasan Suara Hati Voice Release",subtitle:"Tidak perlu disimpan dalam hati...anda boleh bebas mengucapkan ketidakpuasan terhadap orang atau perkara tertentu, tiada masalah yang tidak dapat diselesaikan",holdToRecord:"Tahan untuk Rakam",webSimulation:"(Versi web menggunakan rakaman simulasi)",recording:"Merakam...",stopRecording:"Hentikan Rakaman",todayMood:"Mood Hari Ini",reflectionMoment:"Saat Refleksi",addDiary:"Tambah Suara Hati",editDiary:"Sunting Suara Hati",deleteDiary:"Padam Suara Hati",save:"Simpan",cancel:"Batal",backToHome:"← Kembali ke Rumah",logout:"Log Keluar",noDiaries:"Belum ada diari suara hati, mulakan rakaman!",startSpeaking:"Mula Bercakap",submit:"Hantar",submitVoice:"Hantar Suara Hati",recordingComplete:"Rakaman Selesai",submitToSave:"Klik untuk hantar dan simpan suara hati",emotion:{happy:"Gembira",sad:"Sedih",angry:"Marah",neutral:"Tenang",excited:"Teruja",calm:"Selesa"}},la:{title:"Vox Liberatio Voice Release",subtitle:"Non necesse est in corde servare...liberam dissatisfactionem cum hominibus vel rebus quibusdam profer, nulla quaestio insolubilis est",holdToRecord:"Tene ad Recordandum",webSimulation:"(Versio interretialis simulatione utitur)",recording:"Recordans...",stopRecording:"Recordationem Cessa",todayMood:"Affectus Hodiernus",reflectionMoment:"Momentum Cogitationis",addDiary:"Vox Adde",editDiary:"Vox Edita",deleteDiary:"Vox Dele",save:"Serva",cancel:"Cancella",backToHome:"← Ad Domum Reverte",logout:"Exi",noDiaries:"Nondum diaria vocis cordis, incipiamus recordare!",startSpeaking:"Incipe Loqui",submit:"Submitte",submitVoice:"Vox Submitte",recordingComplete:"Recordatio Perfecta",submitToSave:"Click ut submitte et serva vocem",emotion:{happy:"Laetus",sad:"Tristis",angry:"Iratus",neutral:"Tranquillus",excited:"Excitatus",calm:"Placidus"}},en:{title:"Voice Release",subtitle:"No need to keep it in your heart...you can freely speak out your dissatisfaction with which people or things, there is no problem that cannot be solved",holdToRecord:"Hold to Record",webSimulation:"(Web version uses simulated recording)",recording:"Recording...",stopRecording:"Stop Recording",todayMood:"Today's Mood",reflectionMoment:"Reflection Moment",addDiary:"Add Voice",editDiary:"Edit Voice",deleteDiary:"Delete Voice",save:"Save",cancel:"Cancel",backToHome:"← Back to Home",logout:"Logout",noDiaries:"No heart voice diaries yet, start recording!",startSpeaking:"Start Speaking",submit:"Submit",submitVoice:"Submit Voice",recordingComplete:"Recording Complete",submitToSave:"Click to submit and save voice",emotion:{happy:"Happy",sad:"Sad",angry:"Angry",neutral:"Neutral",excited:"Excited",calm:"Calm"}}};function VD(){const n=Et(),{lang:e,setLang:t}=Lt(),r=ES[e]||ES["zh-TW"],[o,a]=v.useState(!1),[c,d]=v.useState(null),[h,m]=v.useState([]),g=v.useRef([]),[x,S]=v.useState(()=>{const je=localStorage.getItem("voiceDiaries");return je?JSON.parse(je):[{id:1,title:"今天的心情",content:"今天感覺很棒，完成了所有計劃的任務。",date:new Date().toISOString(),emotion:"happy",expanded:!1},{id:2,title:"反思時刻",content:"需要學會更好地管理時間，提高效率。",date:new Date(Date.now()-24*60*60*1e3).toISOString(),emotion:"neutral",expanded:!1}]}),[j,T]=v.useState(!1),[R,I]=v.useState(!1),[F,P]=v.useState(null),[z,H]=v.useState({title:"",content:"",emotion:"neutral"}),[J,O]=v.useState(0),[L,C]=v.useState(null),[A,D]=v.useState(null),[M,B]=v.useState(!1),[_,U]=v.useState(!1),{checkPermission:oe,recordUsage:X}=Nc(),[ce,le]=v.useState(!1),[te,xe]=v.useState(null),[$,Q]=v.useState(null),[G,ne]=v.useState(null),{isTestMode:se}=Bo(),[me,Ie]=v.useState(!1),[Pe,qe]=v.useState(null),Ge=async()=>{if(o){c&&c.state==="recording"&&c.stop(),L&&(clearInterval(L),C(null)),a(!1),T(!1),O(0);return}const je=await oe("aiChat");if(!je.allowed){if(se){U(!0);return}je.canRenew,xe(je),le(!0);return}U(!0)},be=async()=>{U(!1);try{const je=await navigator.mediaDevices.getUserMedia({audio:!0}),Qe=new MediaRecorder(je,{mimeType:"audio/webm;codecs=opus"});m([]),g.current=[],O(0),Qe.ondataavailable=vt=>{console.log("收到音頻數據，大小:",vt.data.size),vt.data.size>0&&(g.current.push(vt.data),m(Bt=>{const Dt=[...Bt,vt.data];return console.log("更新音頻塊，當前數量:",Dt.length),Dt}))},Qe.onstop=()=>{const vt=[...g.current];console.log("錄音停止，音頻塊數量:",vt.length);const Bt=vt.length>0?new Blob(vt,{type:"audio/webm"}):new Blob([""],{type:"audio/webm"}),Dt=Math.max(1,Math.floor(vt.length*.1));console.log("創建音頻blob，大小:",Bt.size,"估算錄音時長:",Dt),D({blob:Bt,duration:Dt}),B(!0),m([]),g.current=[],console.log("設置送出對話框狀態"),je.getTracks().forEach(ke=>ke.stop())},Qe.start(100),d(Qe),a(!0),T(!0);const Tt=setInterval(()=>{O(vt=>{const Bt=vt+1;return Bt>=60&&(c&&c.state==="recording"&&c.stop(),Tt&&(clearInterval(Tt),C(null)),a(!1),T(!1),alert("錄音時間已達1分鐘限制，已自動停止錄音")),Bt})},1e3);C(Tt)}catch(je){console.error("錄音錯誤:",je),alert("無法啟動麥克風，請檢查權限設置")}},ae=()=>{U(!1)},rt=(je,Qe)=>{const Tt=URL.createObjectURL(je),vt=["今天心情很好，完成了所有工作。","遇到了一些挑戰，但都克服了。","學會了新的技能，感覺很有成就感。","和朋友聊天很開心，分享了很多想法。","反思今天的行為，發現還有改進空間。"],Bt=vt[Math.floor(Math.random()*vt.length)],Dt=["happy","neutral","calm"][Math.floor(Math.random()*3)],W=[{id:Date.now(),title:"心聲日記",content:Bt,date:new Date().toISOString(),emotion:Dt,expanded:!1,audioUrl:Tt,duration:Qe},...x];S(W),$e(W),T(!1)},Le=()=>{A&&(rt(A.blob,A.duration),D(null),B(!1),X("aiChat",1))},$e=je=>{localStorage.setItem("voiceDiaries",JSON.stringify(je))},fe=()=>{D(null),B(!1)},_e=()=>{if(z.title.trim()&&z.content.trim()){const Qe=[{id:Date.now(),title:z.title,content:z.content,date:new Date().toISOString(),emotion:z.emotion,expanded:!1,duration:0},...x];S(Qe),$e(Qe),H({title:"",content:"",emotion:"neutral"}),I(!1)}},Ce=je=>{P(je),H({title:je.title,content:je.content,emotion:je.emotion})},ze=()=>{if(F&&z.title.trim()&&z.content.trim()){const je=x.map(Qe=>Qe.id===F.id?{...Qe,title:z.title,content:z.content,emotion:z.emotion}:Qe);S(je),$e(je),P(null),H({title:"",content:"",emotion:"neutral"})}},De=je=>{qe(je),Ie(!0)},K=()=>{if(Pe){const je=x.filter(Qe=>Qe.id!==Pe);S(je),$e(je),Ie(!1),qe(null)}},ie=()=>{Ie(!1),qe(null)},q=je=>{const Qe=x.map(Tt=>Tt.id===je?{...Tt,expanded:!Tt.expanded}:{...Tt,expanded:!1});S(Qe),$e(Qe)},Me=je=>{if($===je.id){G&&(G.pause(),G.currentTime=0),window.speechSynthesis.speaking&&window.speechSynthesis.cancel(),Q(null),ne(null);return}if(G&&(G.pause(),G.currentTime=0),window.speechSynthesis.speaking&&window.speechSynthesis.cancel(),je.audioUrl){const Qe=new Audio(je.audioUrl);Qe.onended=()=>{Q(null),ne(null)},Qe.onerror=Tt=>{console.error("音頻加載失敗:",Tt),Q(null),ne(null),st(je.content)},Qe.play().then(()=>{console.log("正在播放原音..."),Q(je.id),ne(Qe)}).catch(Tt=>{console.error("播放失敗:",Tt),Q(null),ne(null),st(je.content)})}else Q(je.id),st(je.content)},st=je=>{if("speechSynthesis"in window){if(window.speechSynthesis.speaking){window.speechSynthesis.cancel(),Q(null),ne(null);return}const Qe=new SpeechSynthesisUtterance(je);Qe.lang="zh-TW",Qe.rate=.9,Qe.pitch=1,Qe.onend=()=>{Q(null),ne(null)},Qe.onerror=()=>{Q(null),ne(null)},window.speechSynthesis.speak(Qe),console.log("正在播放心聲日記內容（文字轉語音）...")}else alert("瀏覽器不支援語音播放功能"),Q(null),ne(null)},et=je=>({happy:"#4CAF50",sad:"#2196F3",angry:"#F44336",neutral:"#9E9E9E",excited:"#FF9800",calm:"#8BC34A"})[je]||"#9E9E9E",dt=je=>new Date(je).toLocaleString("zh-TW",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"});v.useEffect(()=>()=>{L&&clearInterval(L)},[L]);const Ht=()=>{le(!1),xe(null)};return i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{minHeight:"100vh",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",padding:"20px"},children:[i.jsx("style",{children:`
            @keyframes pulse {
              0% { transform: scale(1); }
              50% { transform: scale(1.05); }
              100% { transform: scale(1); }
            }
            @keyframes bounce {
              0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
              40% { transform: translateY(-3px); }
              60% { transform: translateY(-2px); }
            }
          `}),i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"30px"},children:[i.jsx("button",{onClick:()=>n("/home"),style:{background:"#fff",border:"1.5px solid #6B5BFF",borderRadius:"8px",padding:"6px 10px",color:"#6B5BFF",cursor:"pointer",fontSize:"16px",fontWeight:"600",transition:"background 0.18s, color 0.18s, border 0.18s"},children:"返回"}),i.jsx("h1",{style:{color:"white",fontSize:"24px",fontWeight:"bold",margin:0},children:r.title}),i.jsxs("div",{style:{display:"flex",gap:"10px"},children:[i.jsx($n,{}),i.jsx("button",{onClick:()=>n("/logout"),style:{background:"rgba(255,255,255,0.2)",border:"none",borderRadius:"8px",padding:"8px 16px",color:"white",cursor:"pointer",fontSize:"14px"},children:r.logout})]})]}),i.jsxs("div",{style:{maxWidth:"800px",margin:"0 auto"},children:[i.jsxs("div",{style:{background:"rgba(255,255,255,0.95)",borderRadius:"20px",padding:"40px",textAlign:"center",marginBottom:"30px",boxShadow:"0 8px 32px rgba(0,0,0,0.1)"},children:[i.jsxs("div",{style:{marginBottom:"20px"},children:[i.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",marginBottom:"15px"},children:i.jsx("button",{onClick:Ge,style:{width:"80px",height:"80px",borderRadius:"50%",background:o?"linear-gradient(45deg, #ff5722, #ff9800)":"linear-gradient(45deg, #ff9800, #ff5722)",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:o?"0 0 0 4px #ffe0b2, 0 0 20px rgba(255, 87, 34, 0.5)":"0 4px 16px rgba(255, 152, 0, 0.3)",cursor:"pointer",transition:"all 0.3s ease",border:"none",animation:o?"pulse 1.5s infinite":"none"},onMouseEnter:je=>{o||(je.currentTarget.style.transform="scale(1.1)")},onMouseLeave:je=>{o||(je.currentTarget.style.transform="scale(1)")},children:i.jsx("span",{style:{fontSize:"32px",color:"white",filter:o?"drop-shadow(0 0 6px #ff9800)":""},children:o?"⏹️":"🎤"})})}),i.jsx("div",{style:{color:o?"#ff5722":"#ff9800",fontSize:"16px",fontWeight:"700",marginBottom:"10px",textAlign:"center"},children:o?r.stopRecording:r.startSpeaking}),o&&i.jsxs("div",{style:{color:"#ff5722",fontSize:"14px",fontWeight:"600",textAlign:"center",marginBottom:"10px"},children:["錄音中... ",Math.floor(J/60),":",(J%60).toString().padStart(2,"0")]})]}),i.jsx("p",{style:{color:"#666",fontSize:"14px",marginBottom:"20px"},children:r.holdToRecord}),i.jsx("p",{style:{color:"#999",fontSize:"12px",fontStyle:"italic"},children:r.webSimulation}),i.jsxs("button",{onClick:()=>I(!0),style:{background:"linear-gradient(45deg, #667eea, #764ba2)",border:"none",borderRadius:"12px",padding:"12px 24px",color:"white",cursor:"pointer",fontSize:"16px",fontWeight:"600",marginTop:"20px"},children:["+ ",r.addDiary]})]}),i.jsxs("div",{style:{marginBottom:"30px"},children:[i.jsxs("h3",{style:{color:"white",fontSize:"20px",marginBottom:"20px",fontWeight:"600"},children:["心聲日記 (",x.length,")"]}),x.length===0?i.jsx("div",{style:{background:"rgba(255,255,255,0.95)",borderRadius:"16px",padding:"40px",textAlign:"center",color:"#666"},children:r.noDiaries}):i.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:x.map(je=>i.jsx("div",{style:{background:"rgba(255,255,255,0.95)",borderRadius:"16px",padding:"20px",boxShadow:"0 4px 16px rgba(0,0,0,0.1)"},children:i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"12px"},children:[i.jsxs("div",{style:{flex:1},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",marginBottom:"8px"},children:[i.jsx("button",{onClick:()=>q(je.id),style:{background:"none",border:"none",cursor:"pointer",fontSize:"16px",fontWeight:"600",color:"#333",textAlign:"left",flex:1},children:je.title}),i.jsx("button",{onClick:()=>Me(je),style:{background:$===je.id?"linear-gradient(45deg, #ff5722, #ff9800)":"linear-gradient(45deg, #4CAF50, #45a049)",border:"none",borderRadius:"50%",width:"36px",height:"36px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",transition:"transform 0.2s"},onMouseEnter:Qe=>{Qe.currentTarget.style.transform="scale(1.1)"},onMouseLeave:Qe=>{Qe.currentTarget.style.transform="scale(1)"},children:i.jsx("span",{style:{fontSize:"16px",color:"white"},children:$===je.id?"⏹️":"▶️"})}),i.jsx("span",{style:{background:et(je.emotion),color:"white",padding:"4px 8px",borderRadius:"12px",fontSize:"12px",fontWeight:"600"},children:r.emotion[je.emotion]})]}),je.expanded&&i.jsxs("div",{style:{marginTop:"12px",padding:"12px",background:"rgba(0,0,0,0.05)",borderRadius:"8px"},children:[i.jsx("p",{style:{color:"#666",fontSize:"14px",lineHeight:"1.5",marginBottom:"8px"},children:je.content}),i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:"8px"},children:[i.jsx("p",{style:{color:"#999",fontSize:"12px"},children:dt(je.date)}),je.duration&&i.jsxs("span",{style:{color:"#667eea",fontSize:"12px",fontWeight:"500",background:"rgba(102, 126, 234, 0.1)",padding:"2px 6px",borderRadius:"4px"},children:["⏱️ ",Math.floor(je.duration/60),":",(je.duration%60).toString().padStart(2,"0")]})]})]})]}),i.jsxs("div",{style:{display:"flex",gap:"8px"},children:[i.jsxs("button",{onClick:()=>Ce(je),style:{background:"#4CAF50",border:"none",borderRadius:"6px",padding:"6px 12px",color:"white",cursor:"pointer",fontSize:"12px"},children:["✏️ ",r.editDiary]}),i.jsxs("button",{onClick:()=>De(je.id),style:{background:"#F44336",border:"none",borderRadius:"6px",padding:"6px 12px",color:"white",cursor:"pointer",fontSize:"12px"},children:["🗑️ ",r.deleteDiary]})]})]})},je.id))})]})]}),R&&i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:i.jsxs("div",{style:{background:"white",borderRadius:"16px",padding:"30px",width:"90%",maxWidth:"500px"},children:[i.jsx("h3",{style:{marginBottom:"20px",color:"#333"},children:r.addDiary}),i.jsxs("div",{style:{marginBottom:"16px"},children:[i.jsx("label",{style:{display:"block",marginBottom:"8px",color:"#666"},children:"標題"}),i.jsx("input",{type:"text",value:z.title,onChange:je=>H(Qe=>({...Qe,title:je.target.value})),style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid #ddd",fontSize:"14px"},placeholder:"輸入日記標題"})]}),i.jsxs("div",{style:{marginBottom:"16px"},children:[i.jsx("label",{style:{display:"block",marginBottom:"8px",color:"#666"},children:"內容"}),i.jsx("textarea",{value:z.content,onChange:je=>H(Qe=>({...Qe,content:je.target.value})),style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid #ddd",fontSize:"14px",minHeight:"100px",resize:"vertical"},placeholder:"輸入日記內容"})]}),i.jsxs("div",{style:{marginBottom:"20px"},children:[i.jsx("label",{style:{display:"block",marginBottom:"8px",color:"#666"},children:"情緒"}),i.jsxs("select",{value:z.emotion,onChange:je=>H(Qe=>({...Qe,emotion:je.target.value})),style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid #ddd",fontSize:"14px"},children:[i.jsx("option",{value:"happy",children:r.emotion.happy}),i.jsx("option",{value:"sad",children:r.emotion.sad}),i.jsx("option",{value:"angry",children:r.emotion.angry}),i.jsx("option",{value:"neutral",children:r.emotion.neutral}),i.jsx("option",{value:"excited",children:r.emotion.excited}),i.jsx("option",{value:"calm",children:r.emotion.calm})]})]}),i.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"flex-end"},children:[i.jsx("button",{onClick:()=>I(!1),style:{background:"#f5f5f5",border:"none",borderRadius:"8px",padding:"12px 24px",color:"#666",cursor:"pointer",fontSize:"14px"},children:r.cancel}),i.jsx("button",{onClick:_e,style:{background:"linear-gradient(45deg, #667eea, #764ba2)",border:"none",borderRadius:"8px",padding:"12px 24px",color:"white",cursor:"pointer",fontSize:"14px",fontWeight:"600"},children:r.save})]})]})}),F&&i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:i.jsxs("div",{style:{background:"white",borderRadius:"16px",padding:"30px",width:"90%",maxWidth:"500px"},children:[i.jsx("h3",{style:{marginBottom:"20px",color:"#333"},children:r.editDiary}),i.jsxs("div",{style:{marginBottom:"16px"},children:[i.jsx("label",{style:{display:"block",marginBottom:"8px",color:"#666"},children:"標題"}),i.jsx("input",{type:"text",value:z.title,onChange:je=>H(Qe=>({...Qe,title:je.target.value})),style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid #ddd",fontSize:"14px"}})]}),i.jsxs("div",{style:{marginBottom:"16px"},children:[i.jsx("label",{style:{display:"block",marginBottom:"8px",color:"#666"},children:"內容"}),i.jsx("textarea",{value:z.content,onChange:je=>H(Qe=>({...Qe,content:je.target.value})),style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid #ddd",fontSize:"14px",minHeight:"100px",resize:"vertical"}})]}),i.jsxs("div",{style:{marginBottom:"20px"},children:[i.jsx("label",{style:{display:"block",marginBottom:"8px",color:"#666"},children:"情緒"}),i.jsxs("select",{value:z.emotion,onChange:je=>H(Qe=>({...Qe,emotion:je.target.value})),style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid #ddd",fontSize:"14px"},children:[i.jsx("option",{value:"happy",children:r.emotion.happy}),i.jsx("option",{value:"sad",children:r.emotion.sad}),i.jsx("option",{value:"angry",children:r.emotion.angry}),i.jsx("option",{value:"neutral",children:r.emotion.neutral}),i.jsx("option",{value:"excited",children:r.emotion.excited}),i.jsx("option",{value:"calm",children:r.emotion.calm})]})]}),i.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"flex-end"},children:[i.jsx("button",{onClick:()=>P(null),style:{background:"#f5f5f5",border:"none",borderRadius:"8px",padding:"12px 24px",color:"#666",cursor:"pointer",fontSize:"14px"},children:r.cancel}),i.jsx("button",{onClick:ze,style:{background:"linear-gradient(45deg, #667eea, #764ba2)",border:"none",borderRadius:"8px",padding:"12px 24px",color:"white",cursor:"pointer",fontSize:"14px",fontWeight:"600"},children:r.save})]})]})}),_&&i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:i.jsxs("div",{style:{background:"white",borderRadius:"16px",padding:"30px",width:"90%",maxWidth:"500px",textAlign:"center"},children:[i.jsx("div",{style:{fontSize:"48px",marginBottom:"20px"},children:"🎤"}),i.jsx("h3",{style:{marginBottom:"16px",color:"#333",fontSize:"20px",fontWeight:"600"},children:"準備開始錄音"}),i.jsxs("p",{style:{marginBottom:"20px",color:"#666",fontSize:"16px",lineHeight:"1.5"},children:["點擊「開始錄音」後，系統將開始錄製您的語音日記。",i.jsx("br",{}),i.jsx("strong",{style:{color:"#ff6b6b"},children:"⚠️ 錄音時間限制為1分鐘"})]}),i.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"center"},children:[i.jsx("button",{onClick:ae,style:{background:"#f5f5f5",border:"none",borderRadius:"8px",padding:"12px 24px",color:"#666",cursor:"pointer",fontSize:"14px",fontWeight:"500"},children:"取消"}),i.jsx("button",{onClick:be,style:{background:"linear-gradient(45deg, #667eea, #764ba2)",border:"none",borderRadius:"8px",padding:"12px 24px",color:"white",cursor:"pointer",fontSize:"14px",fontWeight:"600",boxShadow:"0 4px 12px rgba(102, 126, 234, 0.3)"},children:"開始錄音"})]})]})}),M&&A&&(console.log("渲染送出對話框，pendingAudio:",A),!0)&&i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:i.jsxs("div",{style:{background:"white",borderRadius:"16px",padding:"30px",width:"90%",maxWidth:"500px",textAlign:"center"},children:[i.jsx("div",{style:{fontSize:"48px",marginBottom:"20px"},children:"🎤"}),i.jsx("h3",{style:{marginBottom:"10px",color:"#333",fontSize:"20px",fontWeight:"600"},children:r.recordingComplete}),i.jsx("p",{style:{marginBottom:"20px",color:"#666",fontSize:"16px"},children:r.submitToSave}),i.jsx("div",{style:{marginBottom:"20px",padding:"15px",background:"#f8f9fa",borderRadius:"8px",border:"1px solid #e9ecef"},children:i.jsxs("div",{style:{color:"#495057",fontSize:"14px",fontWeight:"500"},children:["錄音時長: ",Math.floor(A.duration/60),":",(A.duration%60).toString().padStart(2,"0")]})}),i.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"center"},children:[i.jsx("button",{onClick:fe,style:{background:"#f5f5f5",border:"none",borderRadius:"8px",padding:"12px 24px",color:"#666",cursor:"pointer",fontSize:"14px",fontWeight:"500"},children:r.cancel}),i.jsx("button",{onClick:Le,style:{background:"linear-gradient(45deg, #667eea, #764ba2)",border:"none",borderRadius:"8px",padding:"12px 24px",color:"white",cursor:"pointer",fontSize:"14px",fontWeight:"600",boxShadow:"0 4px 12px rgba(102, 126, 234, 0.3)"},children:r.submit})]})]})}),me&&i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:i.jsxs("div",{style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",borderRadius:"20px",padding:"40px",width:"90%",maxWidth:"450px",textAlign:"center",boxShadow:"0 20px 40px rgba(0,0,0,0.3)",border:"2px solid rgba(255,255,255,0.2)"},children:[i.jsx("div",{style:{fontSize:"64px",marginBottom:"20px",animation:"pulse 2s infinite"},children:"💔"}),i.jsx("h3",{style:{marginBottom:"15px",color:"white",fontSize:"22px",fontWeight:"600",textShadow:"0 2px 4px rgba(0,0,0,0.3)"},children:"這個心聲對您來說很重要嗎？"}),i.jsx("p",{style:{marginBottom:"30px",color:"rgba(255,255,255,0.9)",fontSize:"16px",lineHeight:"1.5",textShadow:"0 1px 2px rgba(0,0,0,0.3)"},children:"刪除後將無法恢復，請確認是否真的要刪除？"}),i.jsxs("div",{style:{display:"flex",gap:"15px",justifyContent:"center"},children:[i.jsx("button",{onClick:ie,style:{background:"rgba(255,255,255,0.2)",border:"2px solid rgba(255,255,255,0.3)",borderRadius:"12px",padding:"14px 28px",color:"white",cursor:"pointer",fontSize:"16px",fontWeight:"600",transition:"all 0.3s ease",backdropFilter:"blur(10px)"},onMouseEnter:je=>{je.currentTarget.style.background="rgba(255,255,255,0.3)",je.currentTarget.style.transform="translateY(-2px)"},onMouseLeave:je=>{je.currentTarget.style.background="rgba(255,255,255,0.2)",je.currentTarget.style.transform="translateY(0)"},children:"取消"}),i.jsx("button",{onClick:K,style:{background:"linear-gradient(45deg, #ff6b6b, #ee5a52)",border:"none",borderRadius:"12px",padding:"14px 28px",color:"white",cursor:"pointer",fontSize:"16px",fontWeight:"600",boxShadow:"0 8px 20px rgba(255,107,107,0.4)",transition:"all 0.3s ease"},onMouseEnter:je=>{je.currentTarget.style.transform="translateY(-2px)",je.currentTarget.style.boxShadow="0 12px 25px rgba(255,107,107,0.5)"},onMouseLeave:je=>{je.currentTarget.style.transform="translateY(0)",je.currentTarget.style.boxShadow="0 8px 20px rgba(255,107,107,0.4)"},children:"確定刪除"})]})]})})]}),ce&&te&&i.jsx(qa,{isOpen:ce,onClose:Ht,currentPlan:te.currentPlan,remainingDays:te.remainingDays,usedTokens:te.usedTokens,totalTokens:te.totalTokens}),i.jsx("div",{style:{width:"100%",margin:"0 auto",marginTop:24,background:"rgba(255,255,255,0.95)",borderRadius:16,padding:"16px",boxShadow:"0 2px 12px #6B5BFF22"},children:i.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:20,flexWrap:"wrap"},children:[i.jsx("a",{href:"/about",style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12},children:e==="zh-TW"?"🧬 Restarter™｜我們是誰":e==="zh-CN"?"🧬 Restarter™｜我们是谁":e==="en"?"🧬 Restarter™｜Who We Are":e==="ja"?"🧬 Restarter™｜私たちについて":e==="ko"?"🧬 Restarter™｜우리는 누구인가":e==="th"?"🧬 Restarter™｜เราเป็นใคร":e==="vi"?"🧬 Restarter™｜Chúng tôi là ai":e==="ms"?"🧬 Restarter™｜Siapa Kami":"🧬 Restarter™｜Quis sumus"}),i.jsx("a",{href:"/privacy-policy",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12},children:e==="zh-TW"?"隱私權政策":e==="zh-CN"?"隐私政策":e==="en"?"Privacy Policy":e==="ja"?"プライバシーポリシー":e==="ko"?"개인정보 처리방침":e==="th"?"นโยบายความเป็นส่วนตัว":e==="vi"?"Chính sách bảo mật":e==="ms"?"Dasar Privasi":"Consilium de Privata"}),i.jsx("a",{href:"/terms",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12},children:e==="zh-TW"?"條款/聲明":e==="zh-CN"?"条款/声明":e==="en"?"Terms/Statement":e==="ja"?"規約/声明":e==="ko"?"약관/성명":e==="th"?"ข้อกำหนด/แถลงการณ์":e==="vi"?"Điều khoản/Tuyên bố":e==="ms"?"Terma/Pernyataan":"Termini/Declaratio"}),i.jsx("a",{href:"/data-deletion",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12},children:e==="zh-TW"?"資料刪除說明":e==="zh-CN"?"数据删除说明":e==="en"?"Data Deletion":e==="ja"?"データ削除について":e==="ko"?"데이터 삭제 안내":e==="th"?"คำอธิบายการลบข้อมูล":e==="vi"?"Giải thích xóa dữ liệu":e==="ms"?"Penjelasan Penghapusan Data":"Explicatio Deletionis Datae"}),i.jsx("a",{href:"/feedback",style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12},children:e==="zh-TW"?"💬 意見箱｜我們想聽你說":e==="zh-CN"?"💬 意见箱｜我们想听你说":e==="en"?"💬 Feedback Box｜We Want to Hear From You":e==="ja"?"💬 ご意見箱｜私たちはあなたの声を聞きたい":e==="ko"?"💬 피드백｜우리는 당신의 말을 듣고 싶습니다":e==="th"?"💬 กล่องความคิดเห็น｜เราอยากได้ยินจากคุณ":e==="vi"?"💬 Hộp góp ý｜Chúng tôi muốn nghe từ bạn":e==="ms"?"💬 Kotak Maklum Balas｜Kami Ingin Mendengar Dari Anda":"💬 Arca Consilii｜Volumus Audire a Te"})]})})]})}const oI=({isOpen:n,onClose:e,featureName:t})=>{const r=Et(),o=window.innerWidth<=768;if(!n)return null;const a={basic:{price:"NT$ 149",tokens:"50K",features:["語音功能","AI 聊天","語音轉文字","文字轉語音","用戶互動: 100次/月"]}},c=()=>{e(),r("/plans")};return i.jsx("div",{style:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",background:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e4},children:i.jsxs("div",{style:{background:"#fff",borderRadius:20,padding:o?16:32,maxWidth:480,width:"90%",textAlign:"center",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.2)"},children:[!o&&i.jsx("div",{style:{fontSize:48,marginBottom:16,color:"#6B5BFF"},children:"🚀"}),i.jsxs("h2",{style:{fontSize:o?18:24,fontWeight:700,color:"#333",marginBottom:o?6:12},children:["升級方案，解鎖 ",t]}),i.jsxs("p",{style:{fontSize:o?12:16,color:"#666",marginBottom:o?12:20,lineHeight:1.4},children:["您目前使用的是免費方案，",t," 需要升級才能使用。"]}),i.jsxs("div",{style:{background:"linear-gradient(135deg, #f8f9ff 0%, #e8f4ff 100%)",borderRadius:12,padding:o?12:16,marginBottom:o?16:24,border:"1px solid #e0e8ff"},children:[i.jsx("div",{style:{fontSize:o?12:14,color:"#6B5BFF",fontWeight:600,marginBottom:o?6:8},children:"📊 方案對比"}),i.jsxs("div",{style:{fontSize:o?11:13,color:"#666",lineHeight:1.3},children:["• 免費方案：僅限文字功能",i.jsx("br",{}),"• 付費方案：解鎖語音、AI 聊天等進階功能",i.jsx("br",{}),"• 立即升級：享受完整功能體驗"]})]}),i.jsxs("div",{style:{background:"#fff",borderRadius:12,padding:o?14:20,marginBottom:o?16:24,border:"2px solid #6B5BFF",boxShadow:"0 2px 8px #6B5BFF22"},children:[i.jsx("div",{style:{fontSize:o?14:16,color:"#6B5BFF",fontWeight:700,marginBottom:o?8:12},children:"💡 推薦方案"}),i.jsxs("div",{style:{fontSize:o?12:14,color:"#666",lineHeight:1.4,marginBottom:o?12:16},children:[i.jsx("strong",{children:"基礎版："}),"最受歡迎的入門方案",i.jsx("br",{}),"包含 ",a.basic.tokens," tokens，",a.basic.features.join("、")]}),i.jsx("div",{style:{fontSize:o?16:18,fontWeight:700,color:"#6B5BFF"},children:a.basic.price})]}),i.jsxs("div",{style:{background:"linear-gradient(135deg, #fff3cd 0%, #ffeaa7 100%)",borderRadius:12,padding:o?12:16,marginBottom:o?16:24,border:"1px solid #ffeaa7"},children:[i.jsx("div",{style:{fontSize:o?12:14,color:"#856404",fontWeight:600,marginBottom:o?6:8},children:"✨ 升級好處"}),i.jsxs("div",{style:{fontSize:o?11:13,color:"#856404",lineHeight:1.3},children:["• 立即解鎖 ",t,i.jsx("br",{}),"• 享受完整的 AI 體驗",i.jsx("br",{}),"• 無限制使用語音功能",i.jsx("br",{}),"• 優先技術支援"]})]}),i.jsxs("div",{style:{display:"flex",gap:o?8:12,justifyContent:"center"},children:[i.jsx("button",{onClick:c,style:{background:"linear-gradient(135deg, #6B5BFF 0%, #00CFFF 100%)",color:"#fff",border:"none",borderRadius:12,padding:o?"12px 20px":"14px 28px",fontSize:o?14:16,fontWeight:700,cursor:"pointer",flex:1,boxShadow:"0 4px 12px #6B5BFF33",transition:"all 0.3s ease"},onMouseEnter:d=>{d.currentTarget.style.transform="translateY(-2px)",d.currentTarget.style.boxShadow="0 6px 16px #6B5BFF44"},onMouseLeave:d=>{d.currentTarget.style.transform="translateY(0)",d.currentTarget.style.boxShadow="0 4px 12px #6B5BFF33"},children:"🚀 立即升級"}),i.jsx("button",{onClick:e,style:{background:"#f8f9ff",color:"#6B5BFF",border:"2px solid #6B5BFF",borderRadius:12,padding:o?"12px 20px":"14px 28px",fontSize:o?14:16,fontWeight:600,cursor:"pointer",flex:1,transition:"all 0.3s ease"},onMouseEnter:d=>{d.currentTarget.style.background="#6B5BFF",d.currentTarget.style.color="#fff"},onMouseLeave:d=>{d.currentTarget.style.background="#f8f9ff",d.currentTarget.style.color="#6B5BFF"},children:"💫 稍後再說"})]}),i.jsx("div",{style:{marginTop:16},children:i.jsx("button",{onClick:e,style:{background:"none",border:"none",color:"#888",fontSize:14,cursor:"pointer",textDecoration:"underline"},children:"稍後再說"})})]})})},AS={"zh-TW":{title:"我的故事 My Story",subtitle:"記錄你的成長歷程，見證改變的每一步",backToHome:"← 返回首頁",logout:"登出",addMilestone:"添加里程碑",editMilestone:"編輯里程碑",deleteMilestone:"刪除里程碑",save:"保存",cancel:"取消",totalDays:"總天數",achievements:"成就",currentStreak:"連續",days:"天",myMilestones:"我的里程碑",noMilestones:"還沒有里程碑，開始記錄你的故事吧！",socialIntegration:"社會融入度評估",socialIntegrationTitle:"社會融入度評估",socialIntegrationDesc:"評估你在社會中的融入程度，包括人際關係、就業狀況、家庭關係等",socialIntegrationQuestions:{q1:"你覺得與他人的關係如何？",q2:"你對目前的工作/學習狀況滿意嗎？",q3:"你與家人的關係如何？",q4:"你對未來有信心嗎？",q5:"你覺得社會對你的接納程度如何？"},socialIntegrationOptions:{excellent:"非常好",good:"良好",fair:"一般",poor:"需要改善"},milestoneTypes:{start:"開始",achievement:"成就",growth:"成長",habit:"習慣",help:"幫助",goal:"目標",social:"社會融入"}},"zh-CN":{title:"我的故事 My Story",subtitle:"记录你的成长历程，见证改变的每一步",backToHome:"← 返回首页",logout:"登出",addMilestone:"添加里程碑",editMilestone:"编辑里程碑",deleteMilestone:"删除里程碑",save:"保存",cancel:"取消",totalDays:"总天数",achievements:"成就",currentStreak:"连续",days:"天",myMilestones:"我的里程碑",noMilestones:"还没有里程碑，开始记录你的故事吧！",socialIntegration:"社会融入度评估",socialIntegrationTitle:"社会融入度评估",socialIntegrationDesc:"评估你在社会中的融入程度，包括人际关系、就业状况、家庭关系等",socialIntegrationQuestions:{q1:"你觉得与他人的关系如何？",q2:"你对目前的工作/学习状况满意吗？",q3:"你与家人的关系如何？",q4:"你对未来有信心吗？",q5:"你觉得社会对你的接纳程度如何？"},socialIntegrationOptions:{excellent:"非常好",good:"良好",fair:"一般",poor:"需要改善"},milestoneTypes:{start:"开始",achievement:"成就",growth:"成长",habit:"习惯",help:"帮助",goal:"目标",social:"社会融入"}},en:{title:"My Story",subtitle:"Record your growth journey, witness every step of change",backToHome:"← Back to Home",logout:"Logout",addMilestone:"Add Milestone",editMilestone:"Edit Milestone",deleteMilestone:"Delete Milestone",save:"Save",cancel:"Cancel",totalDays:"Total Days",achievements:"Achievements",currentStreak:"Current Streak",days:"days",myMilestones:"My Milestones",noMilestones:"No milestones yet, start recording your story!",socialIntegration:"Social Integration Assessment",socialIntegrationTitle:"Social Integration Assessment",socialIntegrationDesc:"Assess your level of social integration, including relationships, employment status, family relationships, etc.",socialIntegrationQuestions:{q1:"How do you feel about your relationships with others?",q2:"Are you satisfied with your current work/study situation?",q3:"How are your relationships with family?",q4:"Do you have confidence in the future?",q5:"How do you feel about society's acceptance of you?"},socialIntegrationOptions:{excellent:"Excellent",good:"Good",fair:"Fair",poor:"Needs Improvement"},milestoneTypes:{start:"Start",achievement:"Achievement",growth:"Growth",habit:"Habit",help:"Help",goal:"Goal",social:"Social Integration"}},ja:{title:"マイストーリー",subtitle:"成長の旅を記録し、変化の一歩一歩を目撃する",backToHome:"← ホームに戻る",logout:"ログアウト",addMilestone:"マイルストーンを追加",editMilestone:"マイルストーンを編集",deleteMilestone:"マイルストーンを削除",save:"保存",cancel:"キャンセル",totalDays:"総日数",achievements:"達成",currentStreak:"連続",days:"日",myMilestones:"マイマイルストーン",noMilestones:"まだマイルストーンがありません。ストーリーを記録し始めましょう！",socialIntegration:"社会的統合度評価",socialIntegrationTitle:"社会的統合度評価",socialIntegrationDesc:"人間関係、就業状況、家族関係などを含む社会的統合度を評価する",socialIntegrationQuestions:{q1:"他者との関係をどう感じていますか？",q2:"現在の仕事/学習状況に満足していますか？",q3:"家族との関係はどうですか？",q4:"将来に自信がありますか？",q5:"社会からの受け入れられ方をどう感じていますか？"},socialIntegrationOptions:{excellent:"非常に良い",good:"良い",fair:"普通",poor:"改善が必要"},milestoneTypes:{start:"開始",achievement:"達成",growth:"成長",habit:"習慣",help:"支援",goal:"目標",social:"社会的統合"}},ko:{title:"내 이야기",subtitle:"성장 여정을 기록하고 변화의 모든 단계를 목격하세요",backToHome:"← 홈으로",logout:"로그아웃",addMilestone:"마일스톤 추가",editMilestone:"마일스톤 편집",deleteMilestone:"마일스톤 삭제",save:"저장",cancel:"취소",totalDays:"총 일수",achievements:"성취",currentStreak:"연속",days:"일",myMilestones:"내 마일스톤",noMilestones:"아직 마일스톤이 없습니다. 이야기를 기록하기 시작하세요!",socialIntegration:"사회 통합도 평가",socialIntegrationTitle:"사회 통합도 평가",socialIntegrationDesc:"인간관계, 고용상태, 가족관계 등을 포함한 사회 통합도를 평가하세요",socialIntegrationQuestions:{q1:"다른 사람과의 관계를 어떻게 느끼나요?",q2:"현재의 일/학습 상황에 만족하나요?",q3:"가족과의 관계는 어떠한가요?",q4:"미래에 대한 자신감이 있나요?",q5:"사회로부터의 수용도를 어떻게 느끼나요?"},socialIntegrationOptions:{excellent:"매우 좋음",good:"좋음",fair:"보통",poor:"개선 필요"},milestoneTypes:{start:"시작",achievement:"성취",growth:"성장",habit:"습관",help:"도움",goal:"목표",social:"사회 통합"}},th:{title:"เรื่องราวของฉัน",subtitle:"บันทึกการเดินทางแห่งการเติบโต เป็นพยานทุกก้าวของการเปลี่ยนแปลง",backToHome:"← กลับหน้าหลัก",logout:"ออกจากระบบ",addMilestone:"เพิ่มจุดหมาย",editMilestone:"แก้ไขจุดหมาย",deleteMilestone:"ลบจุดหมาย",save:"บันทึก",cancel:"ยกเลิก",totalDays:"จำนวนวันทั้งหมด",achievements:"ความสำเร็จ",currentStreak:"ต่อเนื่อง",days:"วัน",myMilestones:"จุดหมายของฉัน",noMilestones:"ยังไม่มีจุดหมาย เริ่มบันทึกเรื่องราวของคุณเลย!",socialIntegration:"การประเมินการรวมตัวทางสังคม",socialIntegrationTitle:"การประเมินการรวมตัวทางสังคม",socialIntegrationDesc:"ประเมินระดับการรวมตัวทางสังคมของคุณ รวมถึงความสัมพันธ์ สถานะการจ้างงาน ความสัมพันธ์ในครอบครัว",socialIntegrationQuestions:{q1:"คุณรู้สึกอย่างไรกับความสัมพันธ์กับผู้อื่น?",q2:"คุณพอใจกับสถานการณ์การทำงาน/การเรียนปัจจุบันหรือไม่?",q3:"ความสัมพันธ์กับครอบครัวเป็นอย่างไร?",q4:"คุณมีความมั่นใจในอนาคตหรือไม่?",q5:"คุณรู้สึกอย่างไรกับการยอมรับจากสังคม?"},socialIntegrationOptions:{excellent:"ดีมาก",good:"ดี",fair:"ปานกลาง",poor:"ต้องปรับปรุง"},milestoneTypes:{start:"เริ่มต้น",achievement:"ความสำเร็จ",growth:"การเติบโต",habit:"นิสัย",help:"ความช่วยเหลือ",goal:"เป้าหมาย",social:"การรวมตัวทางสังคม"}},vi:{title:"Câu chuyện của tôi",subtitle:"Ghi lại hành trình phát triển, chứng kiến từng bước thay đổi",backToHome:"← Về trang chủ",logout:"Đăng xuất",addMilestone:"Thêm cột mốc",editMilestone:"Chỉnh sửa cột mốc",deleteMilestone:"Xóa cột mốc",save:"Lưu",cancel:"Hủy",totalDays:"Tổng số ngày",achievements:"Thành tựu",currentStreak:"Liên tiếp",days:"ngày",myMilestones:"Cột mốc của tôi",noMilestones:"Chưa có cột mốc nào, hãy bắt đầu ghi lại câu chuyện của bạn!",socialIntegration:"Đánh giá hòa nhập xã hội",socialIntegrationTitle:"Đánh giá hòa nhập xã hội",socialIntegrationDesc:"Đánh giá mức độ hòa nhập xã hội của bạn, bao gồm các mối quan hệ, tình trạng việc làm, mối quan hệ gia đình",socialIntegrationQuestions:{q1:"Bạn cảm thấy thế nào về mối quan hệ với người khác?",q2:"Bạn có hài lòng với tình hình công việc/học tập hiện tại không?",q3:"Mối quan hệ với gia đình như thế nào?",q4:"Bạn có tự tin về tương lai không?",q5:"Bạn cảm thấy thế nào về sự chấp nhận từ xã hội?"},socialIntegrationOptions:{excellent:"Rất tốt",good:"Tốt",fair:"Bình thường",poor:"Cần cải thiện"},milestoneTypes:{start:"Bắt đầu",achievement:"Thành tựu",growth:"Phát triển",habit:"Thói quen",help:"Hỗ trợ",goal:"Mục tiêu",social:"Hòa nhập xã hội"}},ms:{title:"Cerita Saya",subtitle:"Rakam perjalanan pertumbuhan anda, saksikan setiap langkah perubahan",backToHome:"← Kembali ke Laman Utama",logout:"Log keluar",addMilestone:"Tambah Pencapaian",editMilestone:"Edit Pencapaian",deleteMilestone:"Padam Pencapaian",save:"Simpan",cancel:"Batal",totalDays:"Jumlah Hari",achievements:"Pencapaian",currentStreak:"Berturut-turut",days:"hari",myMilestones:"Pencapaian Saya",noMilestones:"Belum ada pencapaian, mulakan rakam cerita anda!",socialIntegration:"Penilaian Integrasi Sosial",socialIntegrationTitle:"Penilaian Integrasi Sosial",socialIntegrationDesc:"Nilai tahap integrasi sosial anda, termasuk hubungan, status pekerjaan, hubungan keluarga",socialIntegrationQuestions:{q1:"Bagaimana perasaan anda tentang hubungan dengan orang lain?",q2:"Adakah anda berpuas hati dengan situasi kerja/pembelajaran semasa?",q3:"Bagaimana hubungan anda dengan keluarga?",q4:"Adakah anda yakin dengan masa hadapan?",q5:"Bagaimana perasaan anda tentang penerimaan masyarakat?"},socialIntegrationOptions:{excellent:"Sangat Baik",good:"Baik",fair:"Sederhana",poor:"Perlu Penambahbaikan"},milestoneTypes:{start:"Mula",achievement:"Pencapaian",growth:"Pertumbuhan",habit:"Tabiat",help:"Bantuan",goal:"Matlamat",social:"Integrasi Sosial"}},la:{title:"Fabula Mea",subtitle:"Iter incrementi tuum inscribe, mutationis gradum quemque testare",backToHome:"← Redi ad domum",logout:"Exire",addMilestone:"Addere Lapidem Milliarium",editMilestone:"Lapidem Milliarium Edere",deleteMilestone:"Lapidem Milliarium Delere",save:"Servare",cancel:"Cancellare",totalDays:"Dies Totales",achievements:"Res Gestae",currentStreak:"Series",days:"dies",myMilestones:"Lapides Milliarii Mei",noMilestones:"Nondum lapides milliarii, incipe fabulam tuam inscribere!",socialIntegration:"Aestimatio Integrationis Socialis",socialIntegrationTitle:"Aestimatio Integrationis Socialis",socialIntegrationDesc:"Aestima gradum integrationis socialis tuae, includens relationes, statum operis, relationes familiae",socialIntegrationQuestions:{q1:"Quomodo sentis de relationibus cum aliis?",q2:"Esne contentus cum statu operis/studii praesenti?",q3:"Quomodo sunt relationes tuae cum familia?",q4:"Habesne fiduciam in futuro?",q5:"Quomodo sentis de acceptatione societatis?"},socialIntegrationOptions:{excellent:"Optime",good:"Bene",fair:"Mediocriter",poor:"Emendatione Opus"},milestoneTypes:{start:"Initiare",achievement:"Res Gesta",growth:"Incrementum",habit:"Consuetudo",help:"Auxilium",goal:"Propositum",social:"Integratio Socialis"}}};function UD(){const n=Et(),{lang:e,setLang:t}=Lt(),r=AS[e]||AS["zh-TW"],{isTestMode:o}=Bo(),a=async()=>{try{const W=St().currentUser;if(W){const Y=Id(),ee=Pn(Y,"profiles",W.uid),ve=await To(ee);if(ve.exists()){const Te=ve.data();Te.avatar&&Q(Te.avatar)}}}catch(ke){console.error("獲取用戶頭像失敗:",ke)}},[c,d]=v.useState(()=>{const ke=localStorage.getItem("userMilestones");return ke?JSON.parse(ke):[{id:1,title:"開始新的旅程",description:"決定重新開始，為自己設定新的目標",date:new Date(Date.now()-30*24*60*60*1e3).toISOString(),type:"start",completed:!0},{id:2,title:"完成第一個小目標",description:"成功完成了一項小任務，感覺很棒",date:new Date(Date.now()-25*24*60*60*1e3).toISOString(),type:"achievement",completed:!0},{id:3,title:"學會控制情緒",description:"在困難時刻保持冷靜，學會了情緒管理",date:new Date(Date.now()-20*24*60*60*1e3).toISOString(),type:"growth",completed:!0},{id:4,title:"建立新的習慣",description:"每天堅持做一些小事情，建立正向習慣",date:new Date(Date.now()-15*24*60*60*1e3).toISOString(),type:"habit",completed:!0},{id:5,title:"幫助他人",description:"第一次主動幫助別人，感受到付出的快樂",date:new Date(Date.now()-10*24*60*60*1e3).toISOString(),type:"help",completed:!0},{id:6,title:"設定更大的目標",description:"為自己設定更具挑戰性的目標",date:new Date(Date.now()+5*24*60*60*1e3).toISOString(),type:"goal",completed:!1}]}),[h]=v.useState({name:"我的故事",startDate:new Date(Date.now()-30*24*60*60*1e3),totalDays:30,achievements:5,currentStreak:7}),[m,g]=v.useState(!1),[x,S]=v.useState(!1),[j,T]=v.useState(!1),[R,I]=v.useState(null),[F,P]=v.useState(null),[z,H]=v.useState({title:"",description:"",type:"achievement"}),[J,O]=v.useState(!1),[L,C]=v.useState(!1),[A,D]=v.useState(0),[M,B]=v.useState(null),[_,U]=v.useState(!1),[oe,X]=v.useState(!1),[ce,le]=v.useState(null),[te,xe]=v.useState(null),[$,Q]=v.useState("/avatars/Derxl.png"),[G,ne]=v.useState([]),se=v.useRef([]),{checkPermission:me,recordUsage:Ie}=Nc(),[Pe,qe]=v.useState(!1),[Ge,be]=v.useState(!1),[ae,rt]=v.useState(null);v.useEffect(()=>{a()},[]);const Le=ke=>{localStorage.setItem("userMilestones",JSON.stringify(ke))},$e=()=>{if(z.title.trim()&&z.description.trim()){const W=[{id:Date.now(),title:z.title,description:z.description,date:new Date().toISOString(),type:z.type,completed:!1},...c];d(W),Le(W),H({title:"",description:"",type:"achievement"}),g(!1)}},fe=ke=>{P(ke),H({title:ke.title,description:ke.description,type:ke.type})},_e=()=>{if(F&&z.title.trim()&&z.description.trim()){const ke=c.map(W=>W.id===F.id?{...W,title:z.title,description:z.description,type:z.type}:W);d(ke),Le(ke),P(null),H({title:"",description:"",type:"achievement"})}},Ce=ke=>{if(window.confirm("確定要刪除這個里程碑嗎？")){const W=c.filter(Y=>Y.id!==ke);d(W),Le(W)}},ze=async()=>{if(L){ce&&ce.state==="recording"&&ce.stop(),te&&(clearInterval(te),xe(null)),C(!1),O(!1),D(0);return}const ke=await me("aiChat");if(!ke.allowed){if(o)return;ke.isFreeUser?be(!0):(ke.canRenew,rt(ke),qe(!0));return}X(!0)},De=async()=>{X(!1);try{const ke=await navigator.mediaDevices.getUserMedia({audio:!0}),W=new MediaRecorder(ke,{mimeType:"audio/webm;codecs=opus"});ne([]),se.current=[],D(0),W.ondataavailable=ee=>{console.log("收到音頻數據，大小:",ee.data.size),ee.data.size>0&&(se.current.push(ee.data),ne(ve=>{const Te=[...ve,ee.data];return console.log("更新音頻塊，當前數量:",Te.length),Te}))},W.onstop=()=>{const ee=[...se.current];console.log("錄音停止，音頻塊數量:",ee.length);const ve=ee.length>0?new Blob(ee,{type:"audio/webm"}):new Blob([""],{type:"audio/webm"}),Te=Math.max(1,Math.floor(ee.length*.1));console.log("創建音頻blob，大小:",ve.size,"估算錄音時長:",Te),B({blob:ve,duration:Te}),U(!0),ne([]),se.current=[],console.log("設置送出對話框狀態"),ke.getTracks().forEach(Je=>Je.stop())},W.start(100),le(W),C(!0),O(!0);const Y=setInterval(()=>{D(ee=>{const ve=ee+1;return ve>=60&&(ce&&ce.state==="recording"&&ce.stop(),Y&&(clearInterval(Y),xe(null)),C(!1),O(!1),alert("錄音時間已達1分鐘限制，已自動停止錄音")),ve})},1e3);xe(Y)}catch(ke){console.error("錄音錯誤:",ke),alert("無法啟動麥克風，請檢查權限設置")}},K=()=>{X(!1)},ie=()=>{M&&(Ht(M.blob,M.duration),B(null),U(!1),Ie("aiChat",1))},q=()=>{B(null),U(!1)},[Me,st]=v.useState({q1:"",q2:"",q3:"",q4:"",q5:""}),et=ke=>{const W={excellent:5,good:4,fair:3,poor:2},ve=[W[ke.q1]||3,W[ke.q2]||3,W[ke.q3]||3,W[ke.q4]||3,W[ke.q5]||3].reduce((Te,Je)=>Te+Je,0)/5;return ve>=4.5?{score:ve,result:"優秀",description:"你的社會融入度非常高，在人際關係、就業狀況、家庭關係等方面都表現出色。",recommendations:["繼續保持現有的良好狀態","可以考慮擔任志工幫助其他更生人","分享你的成功經驗給其他需要幫助的人","參與社區活動擴大影響力"],analysis:"基於你的評估結果，你在各個方面都表現優秀，顯示出良好的社會適應能力和積極的生活態度。建議繼續保持這種狀態，並可以考慮幫助其他需要支持的人。"}:ve>=3.5?{score:ve,result:"良好",description:"你的社會融入度良好，在大部分方面都有不錯的表現，還有提升空間。",recommendations:["參加更多社交活動擴大交友圈","尋求職業技能培訓提升就業競爭力","與家人多溝通改善家庭關係","制定具體的個人發展計劃"],analysis:"你的社會融入度處於良好水平，顯示出積極的改善趨勢。建議在現有基礎上進一步提升，特別是在就業技能和人際關係方面。"}:ve>=2.5?{score:ve,result:"一般",description:"你的社會融入度一般，在某些方面需要改善，建議尋求更多支持。",recommendations:["建議尋求專業輔導師協助","參加更生人互助團體","制定具體的改善計劃","逐步建立支持網絡"],analysis:"你的社會融入度處於一般水平，這表明在某些方面還需要改善。建議尋求專業支持，制定具體的改善計劃，並逐步建立支持網絡。"}:{score:ve,result:"需要改善",description:"你的社會融入度需要改善，建議尋求專業輔導和支持。",recommendations:["立即聯繫專業輔導師","參加更生人支持計劃","尋求心理諮商服務","建立穩定的生活規律"],analysis:"你的社會融入度需要改善，建議立即尋求專業輔導和支持。這不是失敗，而是需要更多幫助的表現。專業輔導師可以幫助你制定適合的改善計劃。"}},dt=()=>{if(!Object.values(Me).every(Te=>Te!=="")){alert("請回答所有問題");return}const W=et(Me),Y={score:W.score,result:W.result,description:W.description,recommendations:W.recommendations,analysis:W.analysis,details:{relationships:Me.q1,employment:Me.q2,family:Me.q3,confidence:Me.q4,acceptance:Me.q5}},ve=[{id:Date.now(),title:`${r.socialIntegrationTitle} - ${W.result}`,description:`${W.description} 評估分數: ${W.score.toFixed(1)}/5.0

分析：
${W.analysis}

建議：
${W.recommendations.map(Te=>`• ${Te}`).join(`
`)}`,date:new Date().toISOString(),type:"social",completed:!0},...c];d(ve),Le(ve),st({q1:"",q2:"",q3:"",q4:"",q5:""}),S(!1),T(!0),I(Y)},Ht=(ke,W)=>{const Y=URL.createObjectURL(ke),ee=["今天完成了一個重要目標，感覺很有成就感。","學會了新的技能，為自己的成長感到驕傲。","克服了困難，證明了自己的能力。","幫助了別人，感受到付出的快樂。","建立了新的習慣，為未來打下基礎。"],ve=ee[Math.floor(Math.random()*ee.length)],Te=["achievement","growth","habit","help","goal"][Math.floor(Math.random()*5)],He=[{id:Date.now(),title:"語音里程碑",description:ve,date:new Date().toISOString(),type:Te,completed:!0,audioUrl:Y,duration:W},...c];d(He),Le(He)},je=ke=>({start:"#2196F3",achievement:"#4CAF50",growth:"#9C27B0",habit:"#FF9800",help:"#E91E63",goal:"#F44336",social:"#6B5BFF"})[ke]||"#9E9E9E",Qe=ke=>new Date(ke).toLocaleString("zh-TW",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}),Tt=ke=>{if(ke.audioUrl){const W=new Audio(ke.audioUrl);W.onerror=Y=>{console.error("音頻加載失敗:",Y),vt(ke.description)},W.play().then(()=>{console.log("正在播放原音...")}).catch(Y=>{console.error("播放失敗:",Y),vt(ke.description)})}else vt(ke.description)},vt=ke=>{if("speechSynthesis"in window){const W=new SpeechSynthesisUtterance(ke);W.lang="zh-TW",W.rate=.9,W.pitch=1,window.speechSynthesis.cancel(),window.speechSynthesis.speak(W),console.log("正在播放里程碑內容（文字轉語音）...")}else alert("瀏覽器不支援語音播放功能")},Bt=c.filter(ke=>ke.completed).length,Dt=()=>{qe(!1),rt(null)};return i.jsxs("div",{style:{minHeight:"100vh",background:"linear-gradient(135deg, #4CAF50 0%, #8BC34A 100%)",padding:"20px"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"30px"},children:[i.jsx("button",{onClick:()=>n("/home"),style:{background:"#fff",border:"1.5px solid #6B5BFF",borderRadius:"8px",padding:"6px 10px",color:"#6B5BFF",cursor:"pointer",fontSize:"16px",fontWeight:"600",transition:"all 0.3s ease"},children:r.backToHome}),i.jsx("h1",{style:{color:"white",fontSize:"24px",fontWeight:"bold",margin:0,marginBottom:"8px"},children:r.myMilestones}),i.jsx("p",{style:{color:"rgba(255,255,255,0.8)",fontSize:"14px",fontWeight:400,margin:0,textAlign:"center",lineHeight:1.4},children:r.subtitle}),i.jsxs("div",{style:{display:"flex",gap:"10px"},children:[i.jsx("button",{onClick:()=>n("/logout"),style:{background:"#fff",border:"1.5px solid #6B5BFF",borderRadius:"8px",padding:"6px 10px",color:"#6B5BFF",cursor:"pointer",fontSize:"16px",fontWeight:"600",transition:"all 0.3s ease"},children:r.logout}),i.jsx($n,{})]})]}),i.jsxs("div",{style:{maxWidth:"800px",margin:"0 auto"},children:[i.jsxs("div",{style:{background:"rgba(255,255,255,0.95)",borderRadius:"20px",padding:"24px",marginBottom:"24px",boxShadow:"0 8px 32px rgba(0,0,0,0.1)"},children:[i.jsxs("div",{style:{textAlign:"center",marginBottom:"20px"},children:[i.jsxs("div",{style:{width:"70px",height:"70px",borderRadius:"50%",background:"white",display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto 12px",boxShadow:"0 4px 16px rgba(0,0,0,0.1)",overflow:"hidden"},children:[i.jsx("img",{src:$,alt:"用戶頭像",style:{width:"100%",height:"100%",objectFit:"cover",borderRadius:"50%"},onError:ke=>{const W=ke.currentTarget;W.style.display="none";const Y=W.nextElementSibling;Y&&(Y.style.display="flex")}}),i.jsx("span",{style:{fontSize:"35px",color:"#4CAF50",display:"none",position:"absolute"},children:"👤"})]}),i.jsx("h2",{style:{color:"#333",fontSize:"22px",fontWeight:"bold",marginBottom:"6px"},children:e==="zh-TW"||e==="zh-CN"?"里程碑":e==="en"?"Milestone":e==="ja"?"マイルストーン":e==="ko"?"마일스톤":e==="th"?"จุดหมาย":e==="vi"?"Cột mốc":e==="ms"?"Pencapaian":"Lapis Milliarius"}),i.jsxs("p",{style:{color:"#666",fontSize:"13px",marginBottom:"20px"},children:["開始於 ",h.startDate.toLocaleDateString("zh-TW")]})]}),i.jsxs("div",{style:{display:"flex",justifyContent:"space-around"},children:[i.jsxs("div",{style:{textAlign:"center"},children:[i.jsx("div",{style:{fontSize:"22px",fontWeight:"bold",color:"#4CAF50",marginBottom:"3px"},children:h.totalDays}),i.jsx("div",{style:{fontSize:"11px",color:"#666"},children:r.totalDays})]}),i.jsxs("div",{style:{textAlign:"center"},children:[i.jsx("div",{style:{fontSize:"22px",fontWeight:"bold",color:"#FF9800",marginBottom:"3px"},children:Bt}),i.jsx("div",{style:{fontSize:"11px",color:"#666"},children:r.achievements})]}),i.jsxs("div",{style:{textAlign:"center"},children:[i.jsx("div",{style:{fontSize:"22px",fontWeight:"bold",color:"#2196F3",marginBottom:"3px"},children:h.currentStreak}),i.jsxs("div",{style:{fontSize:"11px",color:"#666"},children:[r.currentStreak," ",r.days]})]})]})]}),i.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:"16px",marginBottom:"24px",flexWrap:"wrap"},children:[i.jsxs("button",{onClick:()=>g(!0),style:{background:"linear-gradient(135deg, #2196F3 0%, #1976D2 100%)",border:"none",borderRadius:"16px",padding:"12px 24px",color:"white",cursor:"pointer",fontSize:"16px",fontWeight:"600",boxShadow:"0 4px 16px rgba(33, 150, 243, 0.3)",transition:"all 0.3s ease",display:"flex",alignItems:"center",gap:"8px"},onMouseOver:ke=>{ke.currentTarget.style.transform="translateY(-2px)",ke.currentTarget.style.boxShadow="0 6px 20px rgba(33, 150, 243, 0.4)"},onMouseOut:ke=>{ke.currentTarget.style.transform="translateY(0)",ke.currentTarget.style.boxShadow="0 4px 16px rgba(33, 150, 243, 0.3)"},children:[i.jsx("span",{style:{fontSize:"18px"},children:"+"}),r.addMilestone]}),i.jsxs("button",{onClick:ze,style:{background:J?"linear-gradient(135deg, #f44336 0%, #d32f2f 100%)":"linear-gradient(135deg, #2196F3 0%, #1976D2 100%)",border:"none",borderRadius:"16px",padding:"12px 24px",color:"white",cursor:"pointer",fontSize:"16px",fontWeight:"600",boxShadow:J?"0 4px 16px rgba(244, 67, 54, 0.3)":"0 4px 16px rgba(33, 150, 243, 0.3)",transition:"all 0.3s ease",display:"flex",alignItems:"center",gap:"8px",animation:J?"pulse 1.5s infinite":"none"},onMouseOver:ke=>{J||(ke.currentTarget.style.transform="translateY(-2px)",ke.currentTarget.style.boxShadow="0 6px 20px rgba(33, 150, 243, 0.4)")},onMouseOut:ke=>{J||(ke.currentTarget.style.transform="translateY(0)",ke.currentTarget.style.boxShadow="0 4px 16px rgba(33, 150, 243, 0.3)")},children:[i.jsx("span",{style:{fontSize:"18px"},children:"🎤"}),J?`${e==="zh-TW"?"錄音中":e==="zh-CN"?"录音中":e==="en"?"Recording":e==="ja"?"録音中":e==="ko"?"녹음 중":e==="th"?"กำลังบันทึก":e==="vi"?"Đang ghi âm":e==="ms"?"Sedang Merakam":"Recording"} ${Math.floor(A/60)}:${(A%60).toString().padStart(2,"0")}`:e==="zh-TW"?"語音輸入":e==="zh-CN"?"语音输入":e==="en"?"Voice Input":e==="ja"?"音声入力":e==="ko"?"음성 입력":e==="th"?"ป้อนเสียง":e==="vi"?"Nhập giọng nói":e==="ms"?"Input Suara":"Input Vox"]})]}),i.jsx("div",{style:{marginBottom:"30px"},children:c.length===0?i.jsx("div",{style:{background:"rgba(255,255,255,0.95)",borderRadius:"16px",padding:"40px",textAlign:"center",color:"#666"},children:r.noMilestones}):i.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:c.map((ke,W)=>i.jsx("div",{style:{background:"rgba(255,255,255,0.95)",borderRadius:"16px",padding:"20px",boxShadow:"0 4px 16px rgba(0,0,0,0.1)",position:"relative"},children:i.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:"16px"},children:[i.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",minWidth:"40px"},children:[i.jsx("div",{style:{width:"20px",height:"20px",borderRadius:"50%",background:ke.completed?je(ke.type):"#ddd",display:"flex",alignItems:"center",justifyContent:"center",marginBottom:"8px"},children:ke.completed&&i.jsx("span",{style:{color:"white",fontSize:"12px"},children:"✓"})}),W<c.length-1&&i.jsx("div",{style:{width:"2px",height:"40px",background:"#ddd"}})]}),i.jsxs("div",{style:{flex:1},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"8px"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[i.jsx("span",{style:{background:je(ke.type),color:"white",padding:"4px 8px",borderRadius:"12px",fontSize:"12px",fontWeight:"600"},children:r.milestoneTypes[ke.type]}),i.jsx("span",{style:{color:"#999",fontSize:"12px"},children:Qe(ke.date)})]}),i.jsxs("div",{style:{display:"flex",gap:"8px"},children:[ke.title!=="語音里程碑"&&i.jsx("button",{onClick:()=>fe(ke),style:{background:"#4CAF50",border:"none",borderRadius:"6px",padding:"4px 8px",color:"white",cursor:"pointer",fontSize:"12px"},children:"✏️"}),i.jsx("button",{onClick:()=>Ce(ke.id),style:{background:"#F44336",border:"none",borderRadius:"6px",padding:"4px 8px",color:"white",cursor:"pointer",fontSize:"12px"},children:"🗑️"})]})]}),i.jsx("h4",{style:{margin:"0 0 8px 0",fontSize:"16px",fontWeight:"600",color:ke.completed?"#333":"#666"},children:ke.title}),i.jsx("p",{style:{color:"#666",fontSize:"14px",lineHeight:"1.5",margin:0,marginBottom:"8px"},children:ke.description}),ke.audioUrl&&i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",marginTop:"8px"},children:[i.jsxs("button",{onClick:()=>Tt(ke),style:{background:"linear-gradient(135deg, #4CAF50 0%, #8BC34A 100%)",border:"none",borderRadius:"8px",padding:"6px 12px",color:"white",cursor:"pointer",fontSize:"12px",fontWeight:"600",display:"flex",alignItems:"center",gap:"4px"},children:[i.jsx("span",{style:{fontSize:"14px"},children:"▶️"}),"播放原音"]}),ke.duration&&i.jsxs("span",{style:{color:"#666",fontSize:"12px",background:"#f5f5f5",padding:"4px 8px",borderRadius:"6px"},children:["錄音時長: ",Math.floor(ke.duration/60),":",(ke.duration%60).toString().padStart(2,"0")]})]})]})]})},ke.id))})})]}),m&&i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:i.jsxs("div",{style:{background:"white",borderRadius:"16px",padding:"30px",width:"90%",maxWidth:"500px"},children:[i.jsx("h3",{style:{marginBottom:"20px",color:"#333"},children:r.addMilestone}),i.jsxs("div",{style:{marginBottom:"16px"},children:[i.jsx("label",{style:{display:"block",marginBottom:"8px",color:"#666"},children:"標題"}),i.jsx("input",{type:"text",value:z.title,onChange:ke=>H(W=>({...W,title:ke.target.value})),style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid #ddd",fontSize:"14px"},placeholder:"輸入里程碑標題"})]}),i.jsxs("div",{style:{marginBottom:"16px"},children:[i.jsx("label",{style:{display:"block",marginBottom:"8px",color:"#666"},children:"描述"}),i.jsx("textarea",{value:z.description,onChange:ke=>H(W=>({...W,description:ke.target.value})),style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid #ddd",fontSize:"14px",minHeight:"100px",resize:"vertical"},placeholder:"輸入里程碑描述"})]}),i.jsxs("div",{style:{marginBottom:"20px"},children:[i.jsx("label",{style:{display:"block",marginBottom:"8px",color:"#666"},children:"類型"}),i.jsxs("select",{value:z.type,onChange:ke=>H(W=>({...W,type:ke.target.value})),style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid #ddd",fontSize:"14px"},children:[i.jsx("option",{value:"start",children:r.milestoneTypes.start}),i.jsx("option",{value:"achievement",children:r.milestoneTypes.achievement}),i.jsx("option",{value:"growth",children:r.milestoneTypes.growth}),i.jsx("option",{value:"habit",children:r.milestoneTypes.habit}),i.jsx("option",{value:"help",children:r.milestoneTypes.help}),i.jsx("option",{value:"goal",children:r.milestoneTypes.goal}),i.jsx("option",{value:"social",children:r.milestoneTypes.social})]})]}),i.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"flex-end"},children:[i.jsx("button",{onClick:()=>g(!1),style:{background:"#f5f5f5",border:"none",borderRadius:"8px",padding:"12px 24px",color:"#666",cursor:"pointer",fontSize:"14px"},children:r.cancel}),i.jsx("button",{onClick:$e,style:{background:"linear-gradient(45deg, #4CAF50, #8BC34A)",border:"none",borderRadius:"8px",padding:"12px 24px",color:"white",cursor:"pointer",fontSize:"14px",fontWeight:"600"},children:r.save})]})]})}),_&&M&&i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:i.jsxs("div",{style:{background:"white",borderRadius:"16px",padding:"30px",width:"90%",maxWidth:"500px",textAlign:"center"},children:[i.jsx("h3",{style:{marginBottom:"20px",color:"#333"},children:"語音里程碑"}),i.jsxs("div",{style:{marginBottom:"20px"},children:[i.jsxs("p",{style:{color:"#666",marginBottom:"10px"},children:["錄音時長: ",Math.floor(M.duration/60),":",(M.duration%60).toString().padStart(2,"0")]}),i.jsx("audio",{controls:!0,style:{width:"100%",marginBottom:"20px"},src:URL.createObjectURL(M.blob)})]}),i.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"center"},children:[i.jsx("button",{onClick:q,style:{background:"#f5f5f5",border:"none",borderRadius:"8px",padding:"12px 24px",color:"#666",cursor:"pointer",fontSize:"14px",fontWeight:"600"},children:"取消"}),i.jsx("button",{onClick:ie,style:{background:"linear-gradient(45deg, #4CAF50, #8BC34A)",border:"none",borderRadius:"8px",padding:"12px 24px",color:"white",cursor:"pointer",fontSize:"14px",fontWeight:"600"},children:"送出"})]})]})}),oe&&i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:i.jsxs("div",{style:{background:"white",borderRadius:"16px",padding:"30px",width:"90%",maxWidth:"500px",textAlign:"center"},children:[i.jsx("div",{style:{fontSize:"48px",marginBottom:"20px"},children:"🎤"}),i.jsx("h3",{style:{marginBottom:"16px",color:"#333",fontSize:"20px",fontWeight:"600"},children:"準備開始錄音"}),i.jsxs("p",{style:{marginBottom:"20px",color:"#666",fontSize:"16px",lineHeight:"1.5"},children:["點擊「開始錄音」後，系統將開始錄製您的語音里程碑。",i.jsx("br",{}),i.jsx("strong",{style:{color:"#ff6b6b"},children:"⚠️ 錄音時間限制為1分鐘"})]}),i.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"center"},children:[i.jsx("button",{onClick:K,style:{background:"#f5f5f5",border:"none",borderRadius:"8px",padding:"12px 24px",color:"#666",cursor:"pointer",fontSize:"14px",fontWeight:"500"},children:"取消"}),i.jsx("button",{onClick:De,style:{background:"linear-gradient(45deg, #4CAF50, #8BC34A)",border:"none",borderRadius:"8px",padding:"12px 24px",color:"white",cursor:"pointer",fontSize:"14px",fontWeight:"600",boxShadow:"0 4px 12px rgba(76, 175, 80, 0.3)"},children:"開始錄音"})]})]})}),F&&i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:i.jsxs("div",{style:{background:"white",borderRadius:"16px",padding:"30px",width:"90%",maxWidth:"500px"},children:[i.jsx("h3",{style:{marginBottom:"20px",color:"#333"},children:r.editMilestone}),i.jsxs("div",{style:{marginBottom:"16px"},children:[i.jsx("label",{style:{display:"block",marginBottom:"8px",color:"#666"},children:"標題"}),i.jsx("input",{type:"text",value:z.title,onChange:ke=>H(W=>({...W,title:ke.target.value})),style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid #ddd",fontSize:"14px"}})]}),i.jsxs("div",{style:{marginBottom:"16px"},children:[i.jsx("label",{style:{display:"block",marginBottom:"8px",color:"#666"},children:"描述"}),i.jsx("textarea",{value:z.description,onChange:ke=>H(W=>({...W,description:ke.target.value})),style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid #ddd",fontSize:"14px",minHeight:"100px",resize:"vertical"}})]}),i.jsxs("div",{style:{marginBottom:"20px"},children:[i.jsx("label",{style:{display:"block",marginBottom:"8px",color:"#666"},children:"類型"}),i.jsxs("select",{value:z.type,onChange:ke=>H(W=>({...W,type:ke.target.value})),style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid #ddd",fontSize:"14px"},children:[i.jsx("option",{value:"start",children:r.milestoneTypes.start}),i.jsx("option",{value:"achievement",children:r.milestoneTypes.achievement}),i.jsx("option",{value:"growth",children:r.milestoneTypes.growth}),i.jsx("option",{value:"habit",children:r.milestoneTypes.habit}),i.jsx("option",{value:"help",children:r.milestoneTypes.help}),i.jsx("option",{value:"goal",children:r.milestoneTypes.goal}),i.jsx("option",{value:"social",children:r.milestoneTypes.social})]})]}),i.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"flex-end"},children:[i.jsx("button",{onClick:()=>P(null),style:{background:"#f5f5f5",border:"none",borderRadius:"8px",padding:"12px 24px",color:"#666",cursor:"pointer",fontSize:"14px"},children:r.cancel}),i.jsx("button",{onClick:_e,style:{background:"linear-gradient(45deg, #4CAF50, #8BC34A)",border:"none",borderRadius:"8px",padding:"12px 24px",color:"white",cursor:"pointer",fontSize:"14px",fontWeight:"600"},children:r.save})]})]})}),Pe&&ae&&i.jsx(qa,{isOpen:Pe,onClose:Dt,currentPlan:ae.currentPlan,remainingDays:ae.remainingDays,usedTokens:ae.usedTokens,totalTokens:ae.totalTokens}),Ge&&i.jsx(oI,{isOpen:Ge,onClose:()=>be(!1),featureName:"語音錄製功能"}),x&&i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:i.jsxs("div",{style:{background:"white",borderRadius:"16px",padding:"30px",width:"90%",maxWidth:"600px",maxHeight:"80vh",overflowY:"auto"},children:[i.jsx("h3",{style:{marginBottom:"20px",color:"#333",textAlign:"center"},children:r.socialIntegrationTitle}),i.jsx("p",{style:{marginBottom:"24px",color:"#666",textAlign:"center",lineHeight:"1.5"},children:r.socialIntegrationDesc}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"20px"},children:[i.jsxs("div",{children:[i.jsx("label",{style:{display:"block",marginBottom:"8px",color:"#333",fontWeight:"600"},children:r.socialIntegrationQuestions.q1}),i.jsxs("select",{value:Me.q1,onChange:ke=>st(W=>({...W,q1:ke.target.value})),style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid #ddd",fontSize:"14px"},children:[i.jsx("option",{value:"",children:"請選擇..."}),i.jsx("option",{value:"excellent",children:r.socialIntegrationOptions.excellent}),i.jsx("option",{value:"good",children:r.socialIntegrationOptions.good}),i.jsx("option",{value:"fair",children:r.socialIntegrationOptions.fair}),i.jsx("option",{value:"poor",children:r.socialIntegrationOptions.poor})]})]}),i.jsxs("div",{children:[i.jsx("label",{style:{display:"block",marginBottom:"8px",color:"#333",fontWeight:"600"},children:r.socialIntegrationQuestions.q2}),i.jsxs("select",{value:Me.q2,onChange:ke=>st(W=>({...W,q2:ke.target.value})),style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid #ddd",fontSize:"14px"},children:[i.jsx("option",{value:"",children:"請選擇..."}),i.jsx("option",{value:"excellent",children:r.socialIntegrationOptions.excellent}),i.jsx("option",{value:"good",children:r.socialIntegrationOptions.good}),i.jsx("option",{value:"fair",children:r.socialIntegrationOptions.fair}),i.jsx("option",{value:"poor",children:r.socialIntegrationOptions.poor})]})]}),i.jsxs("div",{children:[i.jsx("label",{style:{display:"block",marginBottom:"8px",color:"#333",fontWeight:"600"},children:r.socialIntegrationQuestions.q3}),i.jsxs("select",{value:Me.q3,onChange:ke=>st(W=>({...W,q3:ke.target.value})),style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid #ddd",fontSize:"14px"},children:[i.jsx("option",{value:"",children:"請選擇..."}),i.jsx("option",{value:"excellent",children:r.socialIntegrationOptions.excellent}),i.jsx("option",{value:"good",children:r.socialIntegrationOptions.good}),i.jsx("option",{value:"fair",children:r.socialIntegrationOptions.fair}),i.jsx("option",{value:"poor",children:r.socialIntegrationOptions.poor})]})]}),i.jsxs("div",{children:[i.jsx("label",{style:{display:"block",marginBottom:"8px",color:"#333",fontWeight:"600"},children:r.socialIntegrationQuestions.q4}),i.jsxs("select",{value:Me.q4,onChange:ke=>st(W=>({...W,q4:ke.target.value})),style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid #ddd",fontSize:"14px"},children:[i.jsx("option",{value:"",children:"請選擇..."}),i.jsx("option",{value:"excellent",children:r.socialIntegrationOptions.excellent}),i.jsx("option",{value:"good",children:r.socialIntegrationOptions.good}),i.jsx("option",{value:"fair",children:r.socialIntegrationOptions.fair}),i.jsx("option",{value:"poor",children:r.socialIntegrationOptions.poor})]})]}),i.jsxs("div",{children:[i.jsx("label",{style:{display:"block",marginBottom:"8px",color:"#333",fontWeight:"600"},children:r.socialIntegrationQuestions.q5}),i.jsxs("select",{value:Me.q5,onChange:ke=>st(W=>({...W,q5:ke.target.value})),style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid #ddd",fontSize:"14px"},children:[i.jsx("option",{value:"",children:"請選擇..."}),i.jsx("option",{value:"excellent",children:r.socialIntegrationOptions.excellent}),i.jsx("option",{value:"good",children:r.socialIntegrationOptions.good}),i.jsx("option",{value:"fair",children:r.socialIntegrationOptions.fair}),i.jsx("option",{value:"poor",children:r.socialIntegrationOptions.poor})]})]})]}),i.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"center",marginTop:"24px"},children:[i.jsx("button",{onClick:()=>S(!1),style:{background:"#f5f5f5",border:"none",borderRadius:"8px",padding:"12px 24px",color:"#666",cursor:"pointer",fontSize:"14px"},children:r.cancel}),i.jsx("button",{onClick:dt,disabled:!Object.values(Me).every(ke=>ke!==""),style:{background:Object.values(Me).every(ke=>ke!=="")?"linear-gradient(45deg, #6B5BFF, #5A4FCF)":"#ccc",border:"none",borderRadius:"8px",padding:"12px 24px",color:"white",cursor:Object.values(Me).every(ke=>ke!=="")?"pointer":"not-allowed",fontSize:"14px",fontWeight:"600"},children:"提交評估"})]})]})}),j&&R&&i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:i.jsxs("div",{style:{background:"white",borderRadius:"16px",padding:"30px",width:"90%",maxWidth:"600px",maxHeight:"80vh",overflowY:"auto"},children:[i.jsx("h3",{style:{marginBottom:"20px",color:"#333",textAlign:"center"},children:"📊 社會融入度評估報告"}),i.jsxs("div",{style:{background:"linear-gradient(135deg, #6B5BFF 0%, #5A4FCF 100%)",borderRadius:"12px",padding:"20px",color:"white",marginBottom:"20px",textAlign:"center"},children:[i.jsx("div",{style:{fontSize:"24px",fontWeight:"bold",marginBottom:"8px"},children:R.result}),i.jsxs("div",{style:{fontSize:"18px",marginBottom:"8px"},children:["總分：",R.score.toFixed(1),"/5.0"]}),i.jsx("div",{style:{fontSize:"14px",opacity:.9},children:R.description})]}),i.jsxs("div",{style:{marginBottom:"20px"},children:[i.jsx("h4",{style:{color:"#333",marginBottom:"12px",fontWeight:"600"},children:"📋 詳細分析"}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"8px",background:"#f8f9fa",borderRadius:"6px"},children:[i.jsx("span",{style:{color:"#666"},children:"人際關係"}),i.jsx("span",{style:{fontWeight:"600",color:"#6B5BFF"},children:R.details.relationships==="excellent"?"優秀":R.details.relationships==="good"?"良好":R.details.relationships==="fair"?"一般":"需要改善"})]}),i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"8px",background:"#f8f9fa",borderRadius:"6px"},children:[i.jsx("span",{style:{color:"#666"},children:"就業狀況"}),i.jsx("span",{style:{fontWeight:"600",color:"#6B5BFF"},children:R.details.employment==="excellent"?"優秀":R.details.employment==="good"?"良好":R.details.employment==="fair"?"一般":"需要改善"})]}),i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"8px",background:"#f8f9fa",borderRadius:"6px"},children:[i.jsx("span",{style:{color:"#666"},children:"家庭關係"}),i.jsx("span",{style:{fontWeight:"600",color:"#6B5BFF"},children:R.details.family==="excellent"?"優秀":R.details.family==="good"?"良好":R.details.family==="fair"?"一般":"需要改善"})]}),i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"8px",background:"#f8f9fa",borderRadius:"6px"},children:[i.jsx("span",{style:{color:"#666"},children:"未來信心"}),i.jsx("span",{style:{fontWeight:"600",color:"#6B5BFF"},children:R.details.confidence==="excellent"?"優秀":R.details.confidence==="good"?"良好":R.details.confidence==="fair"?"一般":"需要改善"})]}),i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"8px",background:"#f8f9fa",borderRadius:"6px"},children:[i.jsx("span",{style:{color:"#666"},children:"社會接納"}),i.jsx("span",{style:{fontWeight:"600",color:"#6B5BFF"},children:R.details.acceptance==="excellent"?"優秀":R.details.acceptance==="good"?"良好":R.details.acceptance==="fair"?"一般":"需要改善"})]})]})]}),i.jsxs("div",{style:{marginBottom:"20px"},children:[i.jsx("h4",{style:{color:"#333",marginBottom:"12px",fontWeight:"600"},children:"💡 改善建議"}),i.jsx("div",{style:{background:"#f8f9fa",borderRadius:"8px",padding:"16px"},children:R.recommendations.map((ke,W)=>i.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:"8px",marginBottom:"8px",fontSize:"14px",lineHeight:"1.4"},children:[i.jsx("span",{style:{color:"#6B5BFF",fontWeight:"bold"},children:"•"}),i.jsx("span",{style:{color:"#333"},children:ke})]},W))})]}),i.jsxs("div",{style:{background:"linear-gradient(135deg, #FF9800 0%, #F57C00 100%)",borderRadius:"8px",padding:"16px",marginBottom:"20px"},children:[i.jsx("h4",{style:{color:"white",marginBottom:"8px",fontWeight:"600"},children:"🎯 專業輔導建議"}),i.jsx("p",{style:{color:"white",fontSize:"14px",lineHeight:"1.4",margin:0},children:"基於您的評估結果，我們建議您考慮尋求專業輔導師的協助。專業輔導師可以為您提供個性化的改善計劃和持續的支持。"})]}),i.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"center"},children:[i.jsx("button",{onClick:()=>T(!1),style:{background:"#f5f5f5",border:"none",borderRadius:"8px",padding:"12px 24px",color:"#666",cursor:"pointer",fontSize:"14px"},children:"關閉報告"}),i.jsx("button",{onClick:()=>{T(!1),alert("功能開發中：聯繫專業輔導師")},style:{background:"linear-gradient(45deg, #6B5BFF, #5A4FCF)",border:"none",borderRadius:"8px",padding:"12px 24px",color:"white",cursor:"pointer",fontSize:"14px",fontWeight:"600"},children:"聯繫輔導師"})]})]})}),window.innerWidth<=768?i.jsxs("footer",{style:{textAlign:"center",fontSize:12,color:"#888",marginTop:20,padding:12,background:"rgba(255,255,255,0.95)",borderTop:"1px solid #eee",display:"flex",flexDirection:"column",gap:8},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:16,flexWrap:"wrap"},children:[i.jsx("a",{href:"/about",style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:600,fontSize:11},children:e==="zh-TW"?"🧬 我們是誰":e==="zh-CN"?"🧬 我们是谁":e==="en"?"🧬 Who We Are":e==="ja"?"🧬 私たちについて":e==="ko"?"🧬 우리는 누구인가":e==="th"?"🧬 เราเป็นใคร":e==="vi"?"🧬 Chúng tôi là ai":e==="ms"?"🧬 Siapa Kami":"🧬 Quis sumus"}),i.jsx("a",{href:"/privacy-policy",style:{color:"#6B5BFF",textDecoration:"underline",fontSize:11},children:e==="zh-TW"?"隱私權政策":e==="zh-CN"?"隐私政策":e==="en"?"Privacy Policy":e==="ja"?"プライバシーポリシー":e==="ko"?"개인정보 처리방침":e==="th"?"นโยบายความเป็นส่วนตัว":e==="vi"?"Chính sách bảo mật":e==="ms"?"Dasar Privasi":"Consilium de Privata"}),i.jsx("a",{href:"/terms",style:{color:"#6B5BFF",textDecoration:"underline",fontSize:11},children:e==="zh-TW"?"條款/聲明":e==="zh-CN"?"条款/声明":e==="en"?"Terms/Statement":e==="ja"?"規約/声明":e==="ko"?"약관/성명":e==="th"?"ข้อกำหนด/แถลงการณ์":e==="vi"?"Điều khoản/Tuyên bố":e==="ms"?"Terma/Pernyataan":"Termini/Declaratio"})]}),i.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:16,flexWrap:"wrap"},children:[i.jsx("a",{href:"/data-deletion",style:{color:"#6B5BFF",textDecoration:"underline",fontSize:11},children:e==="zh-TW"?"資料刪除說明":e==="zh-CN"?"数据删除说明":e==="en"?"Data Deletion":e==="ja"?"データ削除について":e==="ko"?"데이터 삭제 안내":e==="th"?"คำอธิบายการลบข้อมูล":e==="vi"?"Giải thích xóa dữ liệu":e==="ms"?"Penjelasan Penghapusan Data":"Explicatio Deletionis Datae"}),i.jsx("a",{href:"/feedback",style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:600,fontSize:11},children:e==="zh-TW"?"💬 意見箱":e==="zh-CN"?"💬 意见箱":e==="en"?"💬 Feedback":e==="ja"?"💬 ご意見箱":e==="ko"?"💬 피드백":e==="th"?"💬 กล่องความคิดเห็น":e==="vi"?"💬 Hộp góp ý":e==="ms"?"💬 Kotak Maklum Balas":"💬 Arca Consilii"})]})]}):i.jsx("div",{style:{width:"100%",margin:"0 auto",marginTop:24,background:"rgba(255,255,255,0.95)",borderRadius:16,padding:"16px",boxShadow:"0 2px 12px #6B5BFF22"},children:i.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:20,flexWrap:"wrap"},children:[i.jsx("a",{href:"/about",style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12},children:e==="zh-TW"?"🧬 Restarter™｜我們是誰":e==="zh-CN"?"🧬 Restarter™｜我们是谁":e==="en"?"🧬 Restarter™｜Who We Are":e==="ja"?"🧬 Restarter™｜私たちについて":e==="ko"?"🧬 Restarter™｜우리는 누구인가":e==="th"?"🧬 Restarter™｜เราเป็นใคร":e==="vi"?"🧬 Restarter™｜Chúng tôi là ai":e==="ms"?"🧬 Restarter™｜Siapa Kami":"🧬 Restarter™｜Quis sumus"}),i.jsx("a",{href:"/privacy-policy",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12},children:e==="zh-TW"?"隱私權政策":e==="zh-CN"?"隐私政策":e==="en"?"Privacy Policy":e==="ja"?"プライバシーポリシー":e==="ko"?"개인정보 처리방침":e==="th"?"นโยบายความเป็นส่วนตัว":e==="vi"?"Chính sách bảo mật":e==="ms"?"Dasar Privasi":"Consilium de Privata"}),i.jsx("a",{href:"/terms",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12},children:e==="zh-TW"?"條款/聲明":e==="zh-CN"?"条款/声明":e==="en"?"Terms/Statement":e==="ja"?"規約/声明":e==="ko"?"약관/성명":e==="th"?"ข้อกำหนด/แถลงการณ์":e==="vi"?"Điều khoản/Tuyên bố":e==="ms"?"Terma/Pernyataan":"Termini/Declaratio"}),i.jsx("a",{href:"/data-deletion",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12},children:e==="zh-TW"?"資料刪除說明":e==="zh-CN"?"数据删除说明":e==="en"?"Data Deletion":e==="ja"?"データ削除について":e==="ko"?"데이터 삭제 안내":e==="th"?"คำอธิบายการลบข้อมูล":e==="vi"?"Giải thích xóa dữ liệu":e==="ms"?"Penjelasan Penghapusan Data":"Explicatio Deletionis Datae"}),i.jsx("a",{href:"/feedback",style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12},children:e==="zh-TW"?"💬 意見箱｜我們想聽你說":e==="zh-CN"?"💬 意见箱｜我们想听你说":e==="en"?"💬 Feedback Box｜We Want to Hear From You":e==="ja"?"💬 ご意見箱｜私たちはあなたの声を聞きたい":e==="ko"?"💬 피드백｜우리는 당신의 말을 듣고 싶습니다":e==="th"?"💬 กล่องความคิดเห็น｜เราอยากได้ยินจากคุณ":e==="vi"?"💬 Hộp góp ý｜Chúng tôi muốn nghe từ bạn":e==="ms"?"💬 Kotak Maklum Balas｜Kami Ingin Mendengar Dari Anda":"💬 Arca Consilii｜Volumus Audire a Te"})]})})]})}const qD={male:"/avatars/male.png",female:"/avatars/female.png"};function HD({avatar:n,videoUrl:e,audioUrl:t,isSpeaking:r,onAvatarChange:o,size:a=160}){const c=v.useRef(null),[d,h]=v.useState(!1),m=()=>{c.current&&(c.current.currentTime=0,c.current.play(),h(!0))},g=()=>h(!1),x=()=>n==="male"||n==="female"?qD[n]:n;return i.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",marginBottom:24},children:[i.jsxs("div",{style:{position:"relative",width:a,height:a,marginBottom:8},children:[e?i.jsx("video",{src:e,width:a,height:a,autoPlay:!0,muted:!0,loop:!0,style:{borderRadius:"50%",objectFit:"cover"}}):i.jsx("img",{src:x(),width:a,height:a,style:{borderRadius:"50%",objectFit:"cover",filter:r?"brightness(1.1)":"none"},alt:"avatar"}),o&&(n==="male"||n==="female")&&i.jsx("button",{onClick:()=>o(n==="male"?"female":"male"),style:{position:"absolute",right:8,bottom:8,background:"#fff",borderRadius:"50%",border:"none",width:36,height:36,cursor:"pointer",fontSize:18},children:"切換"})]}),t&&i.jsx("audio",{ref:c,src:t,onEnded:g}),t&&i.jsx("button",{onClick:m,style:{padding:"6px 18px",borderRadius:8,background:"#6c63ff",color:"#fff",border:"none",fontWeight:700,fontSize:16,marginTop:8},disabled:d,children:d?"播放中...":"播放語音"})]})}function sI(n,e){return function(){return n.apply(e,arguments)}}const{toString:$D}=Object.prototype,{getPrototypeOf:W0}=Object,{iterator:Zf,toStringTag:aI}=Symbol,em=(n=>e=>{const t=$D.call(e);return n[t]||(n[t]=t.slice(8,-1).toLowerCase())})(Object.create(null)),vi=n=>(n=n.toLowerCase(),e=>em(e)===n),tm=n=>e=>typeof e===n,{isArray:Mc}=Array,hd=tm("undefined");function GD(n){return n!==null&&!hd(n)&&n.constructor!==null&&!hd(n.constructor)&&Ar(n.constructor.isBuffer)&&n.constructor.isBuffer(n)}const lI=vi("ArrayBuffer");function KD(n){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(n):e=n&&n.buffer&&lI(n.buffer),e}const QD=tm("string"),Ar=tm("function"),cI=tm("number"),nm=n=>n!==null&&typeof n=="object",YD=n=>n===!0||n===!1,Bp=n=>{if(em(n)!=="object")return!1;const e=W0(n);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(aI in n)&&!(Zf in n)},XD=vi("Date"),JD=vi("File"),ZD=vi("Blob"),e8=vi("FileList"),t8=n=>nm(n)&&Ar(n.pipe),n8=n=>{let e;return n&&(typeof FormData=="function"&&n instanceof FormData||Ar(n.append)&&((e=em(n))==="formdata"||e==="object"&&Ar(n.toString)&&n.toString()==="[object FormData]"))},r8=vi("URLSearchParams"),[i8,o8,s8,a8]=["ReadableStream","Request","Response","Headers"].map(vi),l8=n=>n.trim?n.trim():n.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Ld(n,e,{allOwnKeys:t=!1}={}){if(n===null||typeof n>"u")return;let r,o;if(typeof n!="object"&&(n=[n]),Mc(n))for(r=0,o=n.length;r<o;r++)e.call(null,n[r],r,n);else{const a=t?Object.getOwnPropertyNames(n):Object.keys(n),c=a.length;let d;for(r=0;r<c;r++)d=a[r],e.call(null,n[d],d,n)}}function uI(n,e){e=e.toLowerCase();const t=Object.keys(n);let r=t.length,o;for(;r-- >0;)if(o=t[r],e===o.toLowerCase())return o;return null}const ya=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,dI=n=>!hd(n)&&n!==ya;function Zy(){const{caseless:n}=dI(this)&&this||{},e={},t=(r,o)=>{const a=n&&uI(e,o)||o;Bp(e[a])&&Bp(r)?e[a]=Zy(e[a],r):Bp(r)?e[a]=Zy({},r):Mc(r)?e[a]=r.slice():e[a]=r};for(let r=0,o=arguments.length;r<o;r++)arguments[r]&&Ld(arguments[r],t);return e}const c8=(n,e,t,{allOwnKeys:r}={})=>(Ld(e,(o,a)=>{t&&Ar(o)?n[a]=sI(o,t):n[a]=o},{allOwnKeys:r}),n),u8=n=>(n.charCodeAt(0)===65279&&(n=n.slice(1)),n),d8=(n,e,t,r)=>{n.prototype=Object.create(e.prototype,r),n.prototype.constructor=n,Object.defineProperty(n,"super",{value:e.prototype}),t&&Object.assign(n.prototype,t)},h8=(n,e,t,r)=>{let o,a,c;const d={};if(e=e||{},n==null)return e;do{for(o=Object.getOwnPropertyNames(n),a=o.length;a-- >0;)c=o[a],(!r||r(c,n,e))&&!d[c]&&(e[c]=n[c],d[c]=!0);n=t!==!1&&W0(n)}while(n&&(!t||t(n,e))&&n!==Object.prototype);return e},p8=(n,e,t)=>{n=String(n),(t===void 0||t>n.length)&&(t=n.length),t-=e.length;const r=n.indexOf(e,t);return r!==-1&&r===t},f8=n=>{if(!n)return null;if(Mc(n))return n;let e=n.length;if(!cI(e))return null;const t=new Array(e);for(;e-- >0;)t[e]=n[e];return t},m8=(n=>e=>n&&e instanceof n)(typeof Uint8Array<"u"&&W0(Uint8Array)),g8=(n,e)=>{const r=(n&&n[Zf]).call(n);let o;for(;(o=r.next())&&!o.done;){const a=o.value;e.call(n,a[0],a[1])}},y8=(n,e)=>{let t;const r=[];for(;(t=n.exec(e))!==null;)r.push(t);return r},x8=vi("HTMLFormElement"),b8=n=>n.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(t,r,o){return r.toUpperCase()+o}),PS=(({hasOwnProperty:n})=>(e,t)=>n.call(e,t))(Object.prototype),v8=vi("RegExp"),hI=(n,e)=>{const t=Object.getOwnPropertyDescriptors(n),r={};Ld(t,(o,a)=>{let c;(c=e(o,a,n))!==!1&&(r[a]=c||o)}),Object.defineProperties(n,r)},w8=n=>{hI(n,(e,t)=>{if(Ar(n)&&["arguments","caller","callee"].indexOf(t)!==-1)return!1;const r=n[t];if(Ar(r)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+t+"'")})}})},S8=(n,e)=>{const t={},r=o=>{o.forEach(a=>{t[a]=!0})};return Mc(n)?r(n):r(String(n).split(e)),t},k8=()=>{},T8=(n,e)=>n!=null&&Number.isFinite(n=+n)?n:e;function _8(n){return!!(n&&Ar(n.append)&&n[aI]==="FormData"&&n[Zf])}const j8=n=>{const e=new Array(10),t=(r,o)=>{if(nm(r)){if(e.indexOf(r)>=0)return;if(!("toJSON"in r)){e[o]=r;const a=Mc(r)?[]:{};return Ld(r,(c,d)=>{const h=t(c,o+1);!hd(h)&&(a[d]=h)}),e[o]=void 0,a}}return r};return t(n,0)},I8=vi("AsyncFunction"),C8=n=>n&&(nm(n)||Ar(n))&&Ar(n.then)&&Ar(n.catch),pI=((n,e)=>n?setImmediate:e?((t,r)=>(ya.addEventListener("message",({source:o,data:a})=>{o===ya&&a===t&&r.length&&r.shift()()},!1),o=>{r.push(o),ya.postMessage(t,"*")}))(`axios@${Math.random()}`,[]):t=>setTimeout(t))(typeof setImmediate=="function",Ar(ya.postMessage)),R8=typeof queueMicrotask<"u"?queueMicrotask.bind(ya):typeof process<"u"&&process.nextTick||pI,E8=n=>n!=null&&Ar(n[Zf]),Se={isArray:Mc,isArrayBuffer:lI,isBuffer:GD,isFormData:n8,isArrayBufferView:KD,isString:QD,isNumber:cI,isBoolean:YD,isObject:nm,isPlainObject:Bp,isReadableStream:i8,isRequest:o8,isResponse:s8,isHeaders:a8,isUndefined:hd,isDate:XD,isFile:JD,isBlob:ZD,isRegExp:v8,isFunction:Ar,isStream:t8,isURLSearchParams:r8,isTypedArray:m8,isFileList:e8,forEach:Ld,merge:Zy,extend:c8,trim:l8,stripBOM:u8,inherits:d8,toFlatObject:h8,kindOf:em,kindOfTest:vi,endsWith:p8,toArray:f8,forEachEntry:g8,matchAll:y8,isHTMLForm:x8,hasOwnProperty:PS,hasOwnProp:PS,reduceDescriptors:hI,freezeMethods:w8,toObjectSet:S8,toCamelCase:b8,noop:k8,toFiniteNumber:T8,findKey:uI,global:ya,isContextDefined:dI,isSpecCompliantForm:_8,toJSONObject:j8,isAsyncFn:I8,isThenable:C8,setImmediate:pI,asap:R8,isIterable:E8};function xt(n,e,t,r,o){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=n,this.name="AxiosError",e&&(this.code=e),t&&(this.config=t),r&&(this.request=r),o&&(this.response=o,this.status=o.status?o.status:null)}Se.inherits(xt,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Se.toJSONObject(this.config),code:this.code,status:this.status}}});const fI=xt.prototype,mI={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(n=>{mI[n]={value:n}});Object.defineProperties(xt,mI);Object.defineProperty(fI,"isAxiosError",{value:!0});xt.from=(n,e,t,r,o,a)=>{const c=Object.create(fI);return Se.toFlatObject(n,c,function(h){return h!==Error.prototype},d=>d!=="isAxiosError"),xt.call(c,n.message,e,t,r,o),c.cause=n,c.name=n.name,a&&Object.assign(c,a),c};const A8=null;function ex(n){return Se.isPlainObject(n)||Se.isArray(n)}function gI(n){return Se.endsWith(n,"[]")?n.slice(0,-2):n}function BS(n,e,t){return n?n.concat(e).map(function(o,a){return o=gI(o),!t&&a?"["+o+"]":o}).join(t?".":""):e}function P8(n){return Se.isArray(n)&&!n.some(ex)}const B8=Se.toFlatObject(Se,{},null,function(e){return/^is[A-Z]/.test(e)});function rm(n,e,t){if(!Se.isObject(n))throw new TypeError("target must be an object");e=e||new FormData,t=Se.toFlatObject(t,{metaTokens:!0,dots:!1,indexes:!1},!1,function(R,I){return!Se.isUndefined(I[R])});const r=t.metaTokens,o=t.visitor||g,a=t.dots,c=t.indexes,h=(t.Blob||typeof Blob<"u"&&Blob)&&Se.isSpecCompliantForm(e);if(!Se.isFunction(o))throw new TypeError("visitor must be a function");function m(T){if(T===null)return"";if(Se.isDate(T))return T.toISOString();if(Se.isBoolean(T))return T.toString();if(!h&&Se.isBlob(T))throw new xt("Blob is not supported. Use a Buffer instead.");return Se.isArrayBuffer(T)||Se.isTypedArray(T)?h&&typeof Blob=="function"?new Blob([T]):Buffer.from(T):T}function g(T,R,I){let F=T;if(T&&!I&&typeof T=="object"){if(Se.endsWith(R,"{}"))R=r?R:R.slice(0,-2),T=JSON.stringify(T);else if(Se.isArray(T)&&P8(T)||(Se.isFileList(T)||Se.endsWith(R,"[]"))&&(F=Se.toArray(T)))return R=gI(R),F.forEach(function(z,H){!(Se.isUndefined(z)||z===null)&&e.append(c===!0?BS([R],H,a):c===null?R:R+"[]",m(z))}),!1}return ex(T)?!0:(e.append(BS(I,R,a),m(T)),!1)}const x=[],S=Object.assign(B8,{defaultVisitor:g,convertValue:m,isVisitable:ex});function j(T,R){if(!Se.isUndefined(T)){if(x.indexOf(T)!==-1)throw Error("Circular reference detected in "+R.join("."));x.push(T),Se.forEach(T,function(F,P){(!(Se.isUndefined(F)||F===null)&&o.call(e,F,Se.isString(P)?P.trim():P,R,S))===!0&&j(F,R?R.concat(P):[P])}),x.pop()}}if(!Se.isObject(n))throw new TypeError("data must be an object");return j(n),e}function FS(n){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(n).replace(/[!'()~]|%20|%00/g,function(r){return e[r]})}function V0(n,e){this._pairs=[],n&&rm(n,this,e)}const yI=V0.prototype;yI.append=function(e,t){this._pairs.push([e,t])};yI.toString=function(e){const t=e?function(r){return e.call(this,r,FS)}:FS;return this._pairs.map(function(o){return t(o[0])+"="+t(o[1])},"").join("&")};function F8(n){return encodeURIComponent(n).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function xI(n,e,t){if(!e)return n;const r=t&&t.encode||F8;Se.isFunction(t)&&(t={serialize:t});const o=t&&t.serialize;let a;if(o?a=o(e,t):a=Se.isURLSearchParams(e)?e.toString():new V0(e,t).toString(r),a){const c=n.indexOf("#");c!==-1&&(n=n.slice(0,c)),n+=(n.indexOf("?")===-1?"?":"&")+a}return n}class zS{constructor(){this.handlers=[]}use(e,t,r){return this.handlers.push({fulfilled:e,rejected:t,synchronous:r?r.synchronous:!1,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){Se.forEach(this.handlers,function(r){r!==null&&e(r)})}}const bI={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},z8=typeof URLSearchParams<"u"?URLSearchParams:V0,D8=typeof FormData<"u"?FormData:null,N8=typeof Blob<"u"?Blob:null,M8={isBrowser:!0,classes:{URLSearchParams:z8,FormData:D8,Blob:N8},protocols:["http","https","file","blob","url","data"]},U0=typeof window<"u"&&typeof document<"u",tx=typeof navigator=="object"&&navigator||void 0,L8=U0&&(!tx||["ReactNative","NativeScript","NS"].indexOf(tx.product)<0),O8=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",W8=U0&&window.location.href||"http://localhost",V8=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:U0,hasStandardBrowserEnv:L8,hasStandardBrowserWebWorkerEnv:O8,navigator:tx,origin:W8},Symbol.toStringTag,{value:"Module"})),or={...V8,...M8};function U8(n,e){return rm(n,new or.classes.URLSearchParams,Object.assign({visitor:function(t,r,o,a){return or.isNode&&Se.isBuffer(t)?(this.append(r,t.toString("base64")),!1):a.defaultVisitor.apply(this,arguments)}},e))}function q8(n){return Se.matchAll(/\w+|\[(\w*)]/g,n).map(e=>e[0]==="[]"?"":e[1]||e[0])}function H8(n){const e={},t=Object.keys(n);let r;const o=t.length;let a;for(r=0;r<o;r++)a=t[r],e[a]=n[a];return e}function vI(n){function e(t,r,o,a){let c=t[a++];if(c==="__proto__")return!0;const d=Number.isFinite(+c),h=a>=t.length;return c=!c&&Se.isArray(o)?o.length:c,h?(Se.hasOwnProp(o,c)?o[c]=[o[c],r]:o[c]=r,!d):((!o[c]||!Se.isObject(o[c]))&&(o[c]=[]),e(t,r,o[c],a)&&Se.isArray(o[c])&&(o[c]=H8(o[c])),!d)}if(Se.isFormData(n)&&Se.isFunction(n.entries)){const t={};return Se.forEachEntry(n,(r,o)=>{e(q8(r),o,t,0)}),t}return null}function $8(n,e,t){if(Se.isString(n))try{return(e||JSON.parse)(n),Se.trim(n)}catch(r){if(r.name!=="SyntaxError")throw r}return(t||JSON.stringify)(n)}const Od={transitional:bI,adapter:["xhr","http","fetch"],transformRequest:[function(e,t){const r=t.getContentType()||"",o=r.indexOf("application/json")>-1,a=Se.isObject(e);if(a&&Se.isHTMLForm(e)&&(e=new FormData(e)),Se.isFormData(e))return o?JSON.stringify(vI(e)):e;if(Se.isArrayBuffer(e)||Se.isBuffer(e)||Se.isStream(e)||Se.isFile(e)||Se.isBlob(e)||Se.isReadableStream(e))return e;if(Se.isArrayBufferView(e))return e.buffer;if(Se.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let d;if(a){if(r.indexOf("application/x-www-form-urlencoded")>-1)return U8(e,this.formSerializer).toString();if((d=Se.isFileList(e))||r.indexOf("multipart/form-data")>-1){const h=this.env&&this.env.FormData;return rm(d?{"files[]":e}:e,h&&new h,this.formSerializer)}}return a||o?(t.setContentType("application/json",!1),$8(e)):e}],transformResponse:[function(e){const t=this.transitional||Od.transitional,r=t&&t.forcedJSONParsing,o=this.responseType==="json";if(Se.isResponse(e)||Se.isReadableStream(e))return e;if(e&&Se.isString(e)&&(r&&!this.responseType||o)){const c=!(t&&t.silentJSONParsing)&&o;try{return JSON.parse(e)}catch(d){if(c)throw d.name==="SyntaxError"?xt.from(d,xt.ERR_BAD_RESPONSE,this,null,this.response):d}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:or.classes.FormData,Blob:or.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};Se.forEach(["delete","get","head","post","put","patch"],n=>{Od.headers[n]={}});const G8=Se.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),K8=n=>{const e={};let t,r,o;return n&&n.split(`
`).forEach(function(c){o=c.indexOf(":"),t=c.substring(0,o).trim().toLowerCase(),r=c.substring(o+1).trim(),!(!t||e[t]&&G8[t])&&(t==="set-cookie"?e[t]?e[t].push(r):e[t]=[r]:e[t]=e[t]?e[t]+", "+r:r)}),e},DS=Symbol("internals");function Cu(n){return n&&String(n).trim().toLowerCase()}function Fp(n){return n===!1||n==null?n:Se.isArray(n)?n.map(Fp):String(n)}function Q8(n){const e=Object.create(null),t=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=t.exec(n);)e[r[1]]=r[2];return e}const Y8=n=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(n.trim());function ry(n,e,t,r,o){if(Se.isFunction(r))return r.call(this,e,t);if(o&&(e=t),!!Se.isString(e)){if(Se.isString(r))return e.indexOf(r)!==-1;if(Se.isRegExp(r))return r.test(e)}}function X8(n){return n.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,t,r)=>t.toUpperCase()+r)}function J8(n,e){const t=Se.toCamelCase(" "+e);["get","set","has"].forEach(r=>{Object.defineProperty(n,r+t,{value:function(o,a,c){return this[r].call(this,e,o,a,c)},configurable:!0})})}let Pr=class{constructor(e){e&&this.set(e)}set(e,t,r){const o=this;function a(d,h,m){const g=Cu(h);if(!g)throw new Error("header name must be a non-empty string");const x=Se.findKey(o,g);(!x||o[x]===void 0||m===!0||m===void 0&&o[x]!==!1)&&(o[x||h]=Fp(d))}const c=(d,h)=>Se.forEach(d,(m,g)=>a(m,g,h));if(Se.isPlainObject(e)||e instanceof this.constructor)c(e,t);else if(Se.isString(e)&&(e=e.trim())&&!Y8(e))c(K8(e),t);else if(Se.isObject(e)&&Se.isIterable(e)){let d={},h,m;for(const g of e){if(!Se.isArray(g))throw TypeError("Object iterator must return a key-value pair");d[m=g[0]]=(h=d[m])?Se.isArray(h)?[...h,g[1]]:[h,g[1]]:g[1]}c(d,t)}else e!=null&&a(t,e,r);return this}get(e,t){if(e=Cu(e),e){const r=Se.findKey(this,e);if(r){const o=this[r];if(!t)return o;if(t===!0)return Q8(o);if(Se.isFunction(t))return t.call(this,o,r);if(Se.isRegExp(t))return t.exec(o);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,t){if(e=Cu(e),e){const r=Se.findKey(this,e);return!!(r&&this[r]!==void 0&&(!t||ry(this,this[r],r,t)))}return!1}delete(e,t){const r=this;let o=!1;function a(c){if(c=Cu(c),c){const d=Se.findKey(r,c);d&&(!t||ry(r,r[d],d,t))&&(delete r[d],o=!0)}}return Se.isArray(e)?e.forEach(a):a(e),o}clear(e){const t=Object.keys(this);let r=t.length,o=!1;for(;r--;){const a=t[r];(!e||ry(this,this[a],a,e,!0))&&(delete this[a],o=!0)}return o}normalize(e){const t=this,r={};return Se.forEach(this,(o,a)=>{const c=Se.findKey(r,a);if(c){t[c]=Fp(o),delete t[a];return}const d=e?X8(a):String(a).trim();d!==a&&delete t[a],t[d]=Fp(o),r[d]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const t=Object.create(null);return Se.forEach(this,(r,o)=>{r!=null&&r!==!1&&(t[o]=e&&Se.isArray(r)?r.join(", "):r)}),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,t])=>e+": "+t).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...t){const r=new this(e);return t.forEach(o=>r.set(o)),r}static accessor(e){const r=(this[DS]=this[DS]={accessors:{}}).accessors,o=this.prototype;function a(c){const d=Cu(c);r[d]||(J8(o,c),r[d]=!0)}return Se.isArray(e)?e.forEach(a):a(e),this}};Pr.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);Se.reduceDescriptors(Pr.prototype,({value:n},e)=>{let t=e[0].toUpperCase()+e.slice(1);return{get:()=>n,set(r){this[t]=r}}});Se.freezeMethods(Pr);function iy(n,e){const t=this||Od,r=e||t,o=Pr.from(r.headers);let a=r.data;return Se.forEach(n,function(d){a=d.call(t,a,o.normalize(),e?e.status:void 0)}),o.normalize(),a}function wI(n){return!!(n&&n.__CANCEL__)}function Lc(n,e,t){xt.call(this,n??"canceled",xt.ERR_CANCELED,e,t),this.name="CanceledError"}Se.inherits(Lc,xt,{__CANCEL__:!0});function SI(n,e,t){const r=t.config.validateStatus;!t.status||!r||r(t.status)?n(t):e(new xt("Request failed with status code "+t.status,[xt.ERR_BAD_REQUEST,xt.ERR_BAD_RESPONSE][Math.floor(t.status/100)-4],t.config,t.request,t))}function Z8(n){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(n);return e&&e[1]||""}function eN(n,e){n=n||10;const t=new Array(n),r=new Array(n);let o=0,a=0,c;return e=e!==void 0?e:1e3,function(h){const m=Date.now(),g=r[a];c||(c=m),t[o]=h,r[o]=m;let x=a,S=0;for(;x!==o;)S+=t[x++],x=x%n;if(o=(o+1)%n,o===a&&(a=(a+1)%n),m-c<e)return;const j=g&&m-g;return j?Math.round(S*1e3/j):void 0}}function tN(n,e){let t=0,r=1e3/e,o,a;const c=(m,g=Date.now())=>{t=g,o=null,a&&(clearTimeout(a),a=null),n.apply(null,m)};return[(...m)=>{const g=Date.now(),x=g-t;x>=r?c(m,g):(o=m,a||(a=setTimeout(()=>{a=null,c(o)},r-x)))},()=>o&&c(o)]}const mf=(n,e,t=3)=>{let r=0;const o=eN(50,250);return tN(a=>{const c=a.loaded,d=a.lengthComputable?a.total:void 0,h=c-r,m=o(h),g=c<=d;r=c;const x={loaded:c,total:d,progress:d?c/d:void 0,bytes:h,rate:m||void 0,estimated:m&&d&&g?(d-c)/m:void 0,event:a,lengthComputable:d!=null,[e?"download":"upload"]:!0};n(x)},t)},NS=(n,e)=>{const t=n!=null;return[r=>e[0]({lengthComputable:t,total:n,loaded:r}),e[1]]},MS=n=>(...e)=>Se.asap(()=>n(...e)),nN=or.hasStandardBrowserEnv?((n,e)=>t=>(t=new URL(t,or.origin),n.protocol===t.protocol&&n.host===t.host&&(e||n.port===t.port)))(new URL(or.origin),or.navigator&&/(msie|trident)/i.test(or.navigator.userAgent)):()=>!0,rN=or.hasStandardBrowserEnv?{write(n,e,t,r,o,a){const c=[n+"="+encodeURIComponent(e)];Se.isNumber(t)&&c.push("expires="+new Date(t).toGMTString()),Se.isString(r)&&c.push("path="+r),Se.isString(o)&&c.push("domain="+o),a===!0&&c.push("secure"),document.cookie=c.join("; ")},read(n){const e=document.cookie.match(new RegExp("(^|;\\s*)("+n+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove(n){this.write(n,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function iN(n){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(n)}function oN(n,e){return e?n.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):n}function kI(n,e,t){let r=!iN(e);return n&&(r||t==!1)?oN(n,e):e}const LS=n=>n instanceof Pr?{...n}:n;function Na(n,e){e=e||{};const t={};function r(m,g,x,S){return Se.isPlainObject(m)&&Se.isPlainObject(g)?Se.merge.call({caseless:S},m,g):Se.isPlainObject(g)?Se.merge({},g):Se.isArray(g)?g.slice():g}function o(m,g,x,S){if(Se.isUndefined(g)){if(!Se.isUndefined(m))return r(void 0,m,x,S)}else return r(m,g,x,S)}function a(m,g){if(!Se.isUndefined(g))return r(void 0,g)}function c(m,g){if(Se.isUndefined(g)){if(!Se.isUndefined(m))return r(void 0,m)}else return r(void 0,g)}function d(m,g,x){if(x in e)return r(m,g);if(x in n)return r(void 0,m)}const h={url:a,method:a,data:a,baseURL:c,transformRequest:c,transformResponse:c,paramsSerializer:c,timeout:c,timeoutMessage:c,withCredentials:c,withXSRFToken:c,adapter:c,responseType:c,xsrfCookieName:c,xsrfHeaderName:c,onUploadProgress:c,onDownloadProgress:c,decompress:c,maxContentLength:c,maxBodyLength:c,beforeRedirect:c,transport:c,httpAgent:c,httpsAgent:c,cancelToken:c,socketPath:c,responseEncoding:c,validateStatus:d,headers:(m,g,x)=>o(LS(m),LS(g),x,!0)};return Se.forEach(Object.keys(Object.assign({},n,e)),function(g){const x=h[g]||o,S=x(n[g],e[g],g);Se.isUndefined(S)&&x!==d||(t[g]=S)}),t}const TI=n=>{const e=Na({},n);let{data:t,withXSRFToken:r,xsrfHeaderName:o,xsrfCookieName:a,headers:c,auth:d}=e;e.headers=c=Pr.from(c),e.url=xI(kI(e.baseURL,e.url,e.allowAbsoluteUrls),n.params,n.paramsSerializer),d&&c.set("Authorization","Basic "+btoa((d.username||"")+":"+(d.password?unescape(encodeURIComponent(d.password)):"")));let h;if(Se.isFormData(t)){if(or.hasStandardBrowserEnv||or.hasStandardBrowserWebWorkerEnv)c.setContentType(void 0);else if((h=c.getContentType())!==!1){const[m,...g]=h?h.split(";").map(x=>x.trim()).filter(Boolean):[];c.setContentType([m||"multipart/form-data",...g].join("; "))}}if(or.hasStandardBrowserEnv&&(r&&Se.isFunction(r)&&(r=r(e)),r||r!==!1&&nN(e.url))){const m=o&&a&&rN.read(a);m&&c.set(o,m)}return e},sN=typeof XMLHttpRequest<"u",aN=sN&&function(n){return new Promise(function(t,r){const o=TI(n);let a=o.data;const c=Pr.from(o.headers).normalize();let{responseType:d,onUploadProgress:h,onDownloadProgress:m}=o,g,x,S,j,T;function R(){j&&j(),T&&T(),o.cancelToken&&o.cancelToken.unsubscribe(g),o.signal&&o.signal.removeEventListener("abort",g)}let I=new XMLHttpRequest;I.open(o.method.toUpperCase(),o.url,!0),I.timeout=o.timeout;function F(){if(!I)return;const z=Pr.from("getAllResponseHeaders"in I&&I.getAllResponseHeaders()),J={data:!d||d==="text"||d==="json"?I.responseText:I.response,status:I.status,statusText:I.statusText,headers:z,config:n,request:I};SI(function(L){t(L),R()},function(L){r(L),R()},J),I=null}"onloadend"in I?I.onloadend=F:I.onreadystatechange=function(){!I||I.readyState!==4||I.status===0&&!(I.responseURL&&I.responseURL.indexOf("file:")===0)||setTimeout(F)},I.onabort=function(){I&&(r(new xt("Request aborted",xt.ECONNABORTED,n,I)),I=null)},I.onerror=function(){r(new xt("Network Error",xt.ERR_NETWORK,n,I)),I=null},I.ontimeout=function(){let H=o.timeout?"timeout of "+o.timeout+"ms exceeded":"timeout exceeded";const J=o.transitional||bI;o.timeoutErrorMessage&&(H=o.timeoutErrorMessage),r(new xt(H,J.clarifyTimeoutError?xt.ETIMEDOUT:xt.ECONNABORTED,n,I)),I=null},a===void 0&&c.setContentType(null),"setRequestHeader"in I&&Se.forEach(c.toJSON(),function(H,J){I.setRequestHeader(J,H)}),Se.isUndefined(o.withCredentials)||(I.withCredentials=!!o.withCredentials),d&&d!=="json"&&(I.responseType=o.responseType),m&&([S,T]=mf(m,!0),I.addEventListener("progress",S)),h&&I.upload&&([x,j]=mf(h),I.upload.addEventListener("progress",x),I.upload.addEventListener("loadend",j)),(o.cancelToken||o.signal)&&(g=z=>{I&&(r(!z||z.type?new Lc(null,n,I):z),I.abort(),I=null)},o.cancelToken&&o.cancelToken.subscribe(g),o.signal&&(o.signal.aborted?g():o.signal.addEventListener("abort",g)));const P=Z8(o.url);if(P&&or.protocols.indexOf(P)===-1){r(new xt("Unsupported protocol "+P+":",xt.ERR_BAD_REQUEST,n));return}I.send(a||null)})},lN=(n,e)=>{const{length:t}=n=n?n.filter(Boolean):[];if(e||t){let r=new AbortController,o;const a=function(m){if(!o){o=!0,d();const g=m instanceof Error?m:this.reason;r.abort(g instanceof xt?g:new Lc(g instanceof Error?g.message:g))}};let c=e&&setTimeout(()=>{c=null,a(new xt(`timeout ${e} of ms exceeded`,xt.ETIMEDOUT))},e);const d=()=>{n&&(c&&clearTimeout(c),c=null,n.forEach(m=>{m.unsubscribe?m.unsubscribe(a):m.removeEventListener("abort",a)}),n=null)};n.forEach(m=>m.addEventListener("abort",a));const{signal:h}=r;return h.unsubscribe=()=>Se.asap(d),h}},cN=function*(n,e){let t=n.byteLength;if(t<e){yield n;return}let r=0,o;for(;r<t;)o=r+e,yield n.slice(r,o),r=o},uN=async function*(n,e){for await(const t of dN(n))yield*cN(t,e)},dN=async function*(n){if(n[Symbol.asyncIterator]){yield*n;return}const e=n.getReader();try{for(;;){const{done:t,value:r}=await e.read();if(t)break;yield r}}finally{await e.cancel()}},OS=(n,e,t,r)=>{const o=uN(n,e);let a=0,c,d=h=>{c||(c=!0,r&&r(h))};return new ReadableStream({async pull(h){try{const{done:m,value:g}=await o.next();if(m){d(),h.close();return}let x=g.byteLength;if(t){let S=a+=x;t(S)}h.enqueue(new Uint8Array(g))}catch(m){throw d(m),m}},cancel(h){return d(h),o.return()}},{highWaterMark:2})},im=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",_I=im&&typeof ReadableStream=="function",hN=im&&(typeof TextEncoder=="function"?(n=>e=>n.encode(e))(new TextEncoder):async n=>new Uint8Array(await new Response(n).arrayBuffer())),jI=(n,...e)=>{try{return!!n(...e)}catch{return!1}},pN=_I&&jI(()=>{let n=!1;const e=new Request(or.origin,{body:new ReadableStream,method:"POST",get duplex(){return n=!0,"half"}}).headers.has("Content-Type");return n&&!e}),WS=64*1024,nx=_I&&jI(()=>Se.isReadableStream(new Response("").body)),gf={stream:nx&&(n=>n.body)};im&&(n=>{["text","arrayBuffer","blob","formData","stream"].forEach(e=>{!gf[e]&&(gf[e]=Se.isFunction(n[e])?t=>t[e]():(t,r)=>{throw new xt(`Response type '${e}' is not supported`,xt.ERR_NOT_SUPPORT,r)})})})(new Response);const fN=async n=>{if(n==null)return 0;if(Se.isBlob(n))return n.size;if(Se.isSpecCompliantForm(n))return(await new Request(or.origin,{method:"POST",body:n}).arrayBuffer()).byteLength;if(Se.isArrayBufferView(n)||Se.isArrayBuffer(n))return n.byteLength;if(Se.isURLSearchParams(n)&&(n=n+""),Se.isString(n))return(await hN(n)).byteLength},mN=async(n,e)=>{const t=Se.toFiniteNumber(n.getContentLength());return t??fN(e)},gN=im&&(async n=>{let{url:e,method:t,data:r,signal:o,cancelToken:a,timeout:c,onDownloadProgress:d,onUploadProgress:h,responseType:m,headers:g,withCredentials:x="same-origin",fetchOptions:S}=TI(n);m=m?(m+"").toLowerCase():"text";let j=lN([o,a&&a.toAbortSignal()],c),T;const R=j&&j.unsubscribe&&(()=>{j.unsubscribe()});let I;try{if(h&&pN&&t!=="get"&&t!=="head"&&(I=await mN(g,r))!==0){let J=new Request(e,{method:"POST",body:r,duplex:"half"}),O;if(Se.isFormData(r)&&(O=J.headers.get("content-type"))&&g.setContentType(O),J.body){const[L,C]=NS(I,mf(MS(h)));r=OS(J.body,WS,L,C)}}Se.isString(x)||(x=x?"include":"omit");const F="credentials"in Request.prototype;T=new Request(e,{...S,signal:j,method:t.toUpperCase(),headers:g.normalize().toJSON(),body:r,duplex:"half",credentials:F?x:void 0});let P=await fetch(T,S);const z=nx&&(m==="stream"||m==="response");if(nx&&(d||z&&R)){const J={};["status","statusText","headers"].forEach(A=>{J[A]=P[A]});const O=Se.toFiniteNumber(P.headers.get("content-length")),[L,C]=d&&NS(O,mf(MS(d),!0))||[];P=new Response(OS(P.body,WS,L,()=>{C&&C(),R&&R()}),J)}m=m||"text";let H=await gf[Se.findKey(gf,m)||"text"](P,n);return!z&&R&&R(),await new Promise((J,O)=>{SI(J,O,{data:H,headers:Pr.from(P.headers),status:P.status,statusText:P.statusText,config:n,request:T})})}catch(F){throw R&&R(),F&&F.name==="TypeError"&&/Load failed|fetch/i.test(F.message)?Object.assign(new xt("Network Error",xt.ERR_NETWORK,n,T),{cause:F.cause||F}):xt.from(F,F&&F.code,n,T)}}),rx={http:A8,xhr:aN,fetch:gN};Se.forEach(rx,(n,e)=>{if(n){try{Object.defineProperty(n,"name",{value:e})}catch{}Object.defineProperty(n,"adapterName",{value:e})}});const VS=n=>`- ${n}`,yN=n=>Se.isFunction(n)||n===null||n===!1,II={getAdapter:n=>{n=Se.isArray(n)?n:[n];const{length:e}=n;let t,r;const o={};for(let a=0;a<e;a++){t=n[a];let c;if(r=t,!yN(t)&&(r=rx[(c=String(t)).toLowerCase()],r===void 0))throw new xt(`Unknown adapter '${c}'`);if(r)break;o[c||"#"+a]=r}if(!r){const a=Object.entries(o).map(([d,h])=>`adapter ${d} `+(h===!1?"is not supported by the environment":"is not available in the build"));let c=e?a.length>1?`since :
`+a.map(VS).join(`
`):" "+VS(a[0]):"as no adapter specified";throw new xt("There is no suitable adapter to dispatch the request "+c,"ERR_NOT_SUPPORT")}return r},adapters:rx};function oy(n){if(n.cancelToken&&n.cancelToken.throwIfRequested(),n.signal&&n.signal.aborted)throw new Lc(null,n)}function US(n){return oy(n),n.headers=Pr.from(n.headers),n.data=iy.call(n,n.transformRequest),["post","put","patch"].indexOf(n.method)!==-1&&n.headers.setContentType("application/x-www-form-urlencoded",!1),II.getAdapter(n.adapter||Od.adapter)(n).then(function(r){return oy(n),r.data=iy.call(n,n.transformResponse,r),r.headers=Pr.from(r.headers),r},function(r){return wI(r)||(oy(n),r&&r.response&&(r.response.data=iy.call(n,n.transformResponse,r.response),r.response.headers=Pr.from(r.response.headers))),Promise.reject(r)})}const CI="1.10.0",om={};["object","boolean","number","function","string","symbol"].forEach((n,e)=>{om[n]=function(r){return typeof r===n||"a"+(e<1?"n ":" ")+n}});const qS={};om.transitional=function(e,t,r){function o(a,c){return"[Axios v"+CI+"] Transitional option '"+a+"'"+c+(r?". "+r:"")}return(a,c,d)=>{if(e===!1)throw new xt(o(c," has been removed"+(t?" in "+t:"")),xt.ERR_DEPRECATED);return t&&!qS[c]&&(qS[c]=!0,console.warn(o(c," has been deprecated since v"+t+" and will be removed in the near future"))),e?e(a,c,d):!0}};om.spelling=function(e){return(t,r)=>(console.warn(`${r} is likely a misspelling of ${e}`),!0)};function xN(n,e,t){if(typeof n!="object")throw new xt("options must be an object",xt.ERR_BAD_OPTION_VALUE);const r=Object.keys(n);let o=r.length;for(;o-- >0;){const a=r[o],c=e[a];if(c){const d=n[a],h=d===void 0||c(d,a,n);if(h!==!0)throw new xt("option "+a+" must be "+h,xt.ERR_BAD_OPTION_VALUE);continue}if(t!==!0)throw new xt("Unknown option "+a,xt.ERR_BAD_OPTION)}}const zp={assertOptions:xN,validators:om},Pi=zp.validators;let Sa=class{constructor(e){this.defaults=e||{},this.interceptors={request:new zS,response:new zS}}async request(e,t){try{return await this._request(e,t)}catch(r){if(r instanceof Error){let o={};Error.captureStackTrace?Error.captureStackTrace(o):o=new Error;const a=o.stack?o.stack.replace(/^.+\n/,""):"";try{r.stack?a&&!String(r.stack).endsWith(a.replace(/^.+\n.+\n/,""))&&(r.stack+=`
`+a):r.stack=a}catch{}}throw r}}_request(e,t){typeof e=="string"?(t=t||{},t.url=e):t=e||{},t=Na(this.defaults,t);const{transitional:r,paramsSerializer:o,headers:a}=t;r!==void 0&&zp.assertOptions(r,{silentJSONParsing:Pi.transitional(Pi.boolean),forcedJSONParsing:Pi.transitional(Pi.boolean),clarifyTimeoutError:Pi.transitional(Pi.boolean)},!1),o!=null&&(Se.isFunction(o)?t.paramsSerializer={serialize:o}:zp.assertOptions(o,{encode:Pi.function,serialize:Pi.function},!0)),t.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?t.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:t.allowAbsoluteUrls=!0),zp.assertOptions(t,{baseUrl:Pi.spelling("baseURL"),withXsrfToken:Pi.spelling("withXSRFToken")},!0),t.method=(t.method||this.defaults.method||"get").toLowerCase();let c=a&&Se.merge(a.common,a[t.method]);a&&Se.forEach(["delete","get","head","post","put","patch","common"],T=>{delete a[T]}),t.headers=Pr.concat(c,a);const d=[];let h=!0;this.interceptors.request.forEach(function(R){typeof R.runWhen=="function"&&R.runWhen(t)===!1||(h=h&&R.synchronous,d.unshift(R.fulfilled,R.rejected))});const m=[];this.interceptors.response.forEach(function(R){m.push(R.fulfilled,R.rejected)});let g,x=0,S;if(!h){const T=[US.bind(this),void 0];for(T.unshift.apply(T,d),T.push.apply(T,m),S=T.length,g=Promise.resolve(t);x<S;)g=g.then(T[x++],T[x++]);return g}S=d.length;let j=t;for(x=0;x<S;){const T=d[x++],R=d[x++];try{j=T(j)}catch(I){R.call(this,I);break}}try{g=US.call(this,j)}catch(T){return Promise.reject(T)}for(x=0,S=m.length;x<S;)g=g.then(m[x++],m[x++]);return g}getUri(e){e=Na(this.defaults,e);const t=kI(e.baseURL,e.url,e.allowAbsoluteUrls);return xI(t,e.params,e.paramsSerializer)}};Se.forEach(["delete","get","head","options"],function(e){Sa.prototype[e]=function(t,r){return this.request(Na(r||{},{method:e,url:t,data:(r||{}).data}))}});Se.forEach(["post","put","patch"],function(e){function t(r){return function(a,c,d){return this.request(Na(d||{},{method:e,headers:r?{"Content-Type":"multipart/form-data"}:{},url:a,data:c}))}}Sa.prototype[e]=t(),Sa.prototype[e+"Form"]=t(!0)});let bN=class RI{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let t;this.promise=new Promise(function(a){t=a});const r=this;this.promise.then(o=>{if(!r._listeners)return;let a=r._listeners.length;for(;a-- >0;)r._listeners[a](o);r._listeners=null}),this.promise.then=o=>{let a;const c=new Promise(d=>{r.subscribe(d),a=d}).then(o);return c.cancel=function(){r.unsubscribe(a)},c},e(function(a,c,d){r.reason||(r.reason=new Lc(a,c,d),t(r.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const t=this._listeners.indexOf(e);t!==-1&&this._listeners.splice(t,1)}toAbortSignal(){const e=new AbortController,t=r=>{e.abort(r)};return this.subscribe(t),e.signal.unsubscribe=()=>this.unsubscribe(t),e.signal}static source(){let e;return{token:new RI(function(o){e=o}),cancel:e}}};function vN(n){return function(t){return n.apply(null,t)}}function wN(n){return Se.isObject(n)&&n.isAxiosError===!0}const ix={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(ix).forEach(([n,e])=>{ix[e]=n});function EI(n){const e=new Sa(n),t=sI(Sa.prototype.request,e);return Se.extend(t,Sa.prototype,e,{allOwnKeys:!0}),Se.extend(t,e,null,{allOwnKeys:!0}),t.create=function(o){return EI(Na(n,o))},t}const gn=EI(Od);gn.Axios=Sa;gn.CanceledError=Lc;gn.CancelToken=bN;gn.isCancel=wI;gn.VERSION=CI;gn.toFormData=rm;gn.AxiosError=xt;gn.Cancel=gn.CanceledError;gn.all=function(e){return Promise.all(e)};gn.spread=vN;gn.isAxiosError=wN;gn.mergeConfig=Na;gn.AxiosHeaders=Pr;gn.formToJSON=n=>vI(Se.isHTMLForm(n)?new FormData(n):n);gn.getAdapter=II.getAdapter;gn.HttpStatusCode=ix;gn.default=gn;const{Axios:vM,AxiosError:wM,CanceledError:SM,isCancel:kM,CancelToken:TM,VERSION:_M,all:jM,Cancel:IM,isAxiosError:CM,spread:RM,toFormData:EM,AxiosHeaders:AM,HttpStatusCode:PM,formToJSON:BM,getAdapter:FM,mergeConfig:zM}=gn;async function*sy(n,e,t,r){try{const a=St().currentUser;if(!a)throw new Error("用戶未登入");const c=await gn.post("/api/gpt",{messages:[{sender:"user",text:n}],system_prompt:t,userId:a.uid},{headers:{"x-test-mode":r?"true":"false"}}),d=c.data.reply;if(console.log("API Response:",c.data),d&&d.trim()){const h=d.split("");for(const m of h)yield m,await new Promise(g=>setTimeout(g,50))}else throw console.error("Empty reply from API"),new Error("AI回覆為空，請稍後再試。")}catch(o){throw console.error("Error calling GPT API:",o),o instanceof Error?new Error(`API錯誤：${o.message}`):new Error("抱歉，我現在無法回應，請稍後再試。")}}const AI=["Annie.png","berlex.png","Bray.png","Cayly.png","Derxl.png","El.png","Fenny.png","Gily.png","Henny.png","Jesy.png","Karl.png","michy.png","Mily.png","Neysher.png","sandy.png","Sherl.png","Shu.png","Shyly.png"],SN=AI.map(n=>`/avatars/${n}`);AI.map(n=>n.replace(/\.png$/i,""));const HS={"zh-TW":{friend:"朋友",avatarTitle:"選我做你的朋友",companionPhrase:["🕊️ 守在海這端，","我都聽著呢。"],changeAvatar:"更換我的頭像",aiReplyTemplate:n=>`AI陪聊：我明白你的意思，「${n}」，讓我再多聽你說說...`,aiSystemPrompt:"你是一個溫暖、善解人意的虛擬人，請用鼓勵、正向語氣回應。",speechErrorBrowser:"此瀏覽器不支援語音辨識，請改用 Chrome/Edge。",speechErrorFail:"語音辨識失敗，請再試一次。",speechErrorNoDetect:"沒有偵測到語音，請再試一次。",logout:"登出",inputPlaceholder:"或者，直接輸入文字... (Enter 送出)",welcome:n=>`嗨，${n}，我是你的 AI 朋友，你可以開始跟我說話囉！`,welcomePickAvatar:n=>`嗨，${n}，先幫我選個頭像後我們再輕鬆自在，天南地北痛快聊...`,welcomeChat:(n,e)=>`${n}說：嗨，${e}，今天想聊點什麼呢？`,whoAmI:"你想我是誰？",tapToTalk:"按一下開始語音聊天...",aiReplying:"AI 正在回覆中，輸入新訊息可立即打斷",recognizing:"正在辨識中..."},"zh-CN":{friend:"朋友",avatarTitle:"选我做你的朋友",companionPhrase:["🕊️ 守在海这端，","我都听着呢。"],changeAvatar:"更换我的头像",aiReplyTemplate:n=>`AI陪聊：我明白你的意思，"${n}"，让我再多听你聊聊...`,aiSystemPrompt:"你是一个温暖、善解人意的虚拟人，请用鼓励、正向语气回应。",speechErrorBrowser:"此浏览器不支持语音识别，请改用 Chrome/Edge。",speechErrorFail:"语音识别失败，请再试一次。",speechErrorNoDetect:"没有检测到语音，请再试一次。",logout:"登出",inputPlaceholder:"或者，直接输入文字... (Enter 发送)",welcome:n=>`嗨，${n}，我是你的 AI 朋友，你可以开始跟我说话啰！`,welcomePickAvatar:n=>`嗨，${n}，先帮我选个头像后我们再轻松自在，天南地北畅快聊...`,welcomeChat:(n,e)=>`${n}说：嗨，${e}，今天想聊点什么呢？`,whoAmI:"你想我是谁？",tapToTalk:"点一下开始语音聊天...",aiReplying:"AI 正在回复中，输入新消息可立即打断",recognizing:"正在识别中..."},en:{friend:"Friend",avatarTitle:"Pick Me as Your Friend",companionPhrase:["🕊️ I'm here by the sea,","I'm listening."],changeAvatar:"Change My Avatar",aiReplyTemplate:n=>`AI Chat: I understand what you mean, "${n}", let me hear more from you...`,aiSystemPrompt:"You are a warm, empathetic virtual person. Please respond in an encouraging and positive tone.",speechErrorBrowser:"This browser does not support speech recognition. Please use Chrome/Edge.",speechErrorFail:"Speech recognition failed, please try again.",speechErrorNoDetect:"No speech detected, please try again.",logout:"Logout",inputPlaceholder:"Or, type text directly... (Enter to send)",welcome:n=>`Hi, ${n}, I'm your AI friend. You can start talking to me now!`,welcomePickAvatar:n=>`Hi, ${n}, pick my avatar and let's chat freely!`,welcomeChat:(n,e)=>`${n}: Hi, ${e}, what do you want to talk about today?`,whoAmI:"Who do you want me to be?",tapToTalk:"Tap to start voice chat...",aiReplying:"AI is replying, type a new message to interrupt.",recognizing:"Recognizing..."},ja:{friend:"友達",avatarTitle:"友達に選んでね",companionPhrase:["🕊️ この海辺で待ってるよ、","ずっと聞いているから。"],changeAvatar:"アバターを変更",aiReplyTemplate:n=>`AIチャット：あなたの言うこと、「${n}」、わかります。もっと聞かせてください...`,aiSystemPrompt:"あなたは温かく、共感的なバーチャルパーソンです。励ましとポジティブなトーンで応答してください。",speechErrorBrowser:"このブラウザは音声認識に対応していません。Chrome/Edgeを使用してください。",speechErrorFail:"音声認識に失敗しました。もう一度お試しください。",speechErrorNoDetect:"音声が検出されませんでした。もう一度お試しください。",logout:"ログアウト",inputPlaceholder:"あるいは、直接テキストを入力... (Enterで送信)",welcome:n=>`こんにちは、${n}さん。あなたのAIの友達です。さあ、話しましょう！`,welcomePickAvatar:n=>`やあ、${n}、まずは私のアバターを選んでから、気軽に何でも話そう！`,welcomeChat:(n,e)=>`${n}：やあ、${e}、今日は何を話そうか？`,whoAmI:"私が誰であってほしいですか？",tapToTalk:"タップして音声チャット開始",aiReplying:"AIが返信中です。新しいメッセージを入力するとすぐに中断できます",recognizing:"認識中..."},ko:{friend:"친구",avatarTitle:"나를 친구로 선택해줘",companionPhrase:["🕊️ 바다 이편에서 지키고 있을게,","다 듣고 있어."],changeAvatar:"내 아바타 변경",aiReplyTemplate:n=>`AI 채팅: 무슨 말인지 알겠어, "${n}", 더 얘기해줘...`,aiSystemPrompt:"당신은 따뜻하고 공감 능력이 뛰어난 가상 인간입니다. 격려하고 긍정적인 톤으로 응답해주세요.",speechErrorBrowser:"이 브라우저는 음성 인식을 지원하지 않습니다. Chrome/Edge를 사용해주세요.",speechErrorFail:"음성 인식이 실패했습니다. 다시 시도해주세요.",speechErrorNoDetect:"음성이 감지되지 않았습니다. 다시 시도해주세요.",logout:"로그아웃",inputPlaceholder:"아니면, 직접 텍스트를 입력하세요... (Enter로 전송)",welcome:n=>`안녕, ${n}. 나는 너의 AI 친구야. 이제 나에게 말을 걸 수 있어!`,welcomePickAvatar:n=>`안녕, ${n}. 먼저 내 아바타를 고르고 자유롭게 얘기하자!`,welcomeChat:(n,e)=>`${n}: 안녕, ${e}, 오늘 무슨 얘기하고 싶어?`,whoAmI:"내가 누구였으면 좋겠어?",tapToTalk:"탭하여 음성 채팅 시작...",aiReplying:"AI가 답장 중입니다. 새 메시지를 입력하여 중단할 수 있습니다.",recognizing:"인식 중..."},vi:{friend:"Bạn bè",avatarTitle:"Chọn tôi làm bạn của bạn",companionPhrase:["🕊️ Em ở đây bên bờ biển,","Em đang lắng nghe đây."],changeAvatar:"Thay đổi Avatar của tôi",aiReplyTemplate:n=>`Trò chuyện AI: Tôi hiểu ý bạn, "${n}", hãy cho tôi nghe thêm...`,aiSystemPrompt:"Bạn là một người ảo ấm áp, đồng cảm. Vui lòng trả lời bằng giọng điệu khích lệ và tích cực.",speechErrorBrowser:"Trình duyệt này không hỗ trợ nhận dạng giọng nói. Vui lòng sử dụng Chrome/Edge.",speechErrorFail:"Nhận dạng giọng nói thất bại, vui lòng thử lại.",speechErrorNoDetect:"Không phát hiện thấy giọng nói, vui lòng thử lại.",logout:"Đăng xuất",inputPlaceholder:"Hoặc, nhập văn bản trực tiếp... (Enter để gửi)",welcome:n=>`Chào, ${n}. Tôi là người bạn AI của bạn. Bây giờ bạn có thể bắt đầu nói chuyện với tôi!`,welcomePickAvatar:n=>`Chào, ${n}, hãy chọn avatar của tôi và chúng ta hãy trò chuyện thoải mái!`,welcomeChat:(n,e)=>`${n}: Chào, ${e}, hôm nay bạn muốn nói về điều gì?`,whoAmI:"Bạn muốn tôi là ai?",tapToTalk:"Nhấn để bắt đầu trò chuyện thoại...",aiReplying:"AI đang trả lời, nhập tin nhắn mới để ngắt.",recognizing:"Đang nhận dạng..."},th:{friend:"เพื่อน",avatarTitle:"เลือกฉันเป็นเพื่อนของคุณ",companionPhrase:["🕊️ ฉันอยู่ที่นี่ริมทะเล,","ฉันกำลังฟังอยู่"],changeAvatar:"เปลี่ยนอวตารของฉัน",aiReplyTemplate:n=>`แชท AI: ฉันเข้าใจที่คุณหมายถึง, "${n}", เล่าให้ฉันฟังอีกสิ...`,aiSystemPrompt:"คุณเป็นบุคคลเสมือนที่อบอุ่นและเข้าอกเข้าใจ โปรดตอบกลับด้วยน้ำเสียงที่ให้กำลังใจและเป็นบวก",speechErrorBrowser:"เบราว์เซอร์นี้ไม่รองรับการจำแนกเสียงพูด กรุณาใช้ Chrome/Edge",speechErrorFail:"การจำแนกเสียงพูดล้มเหลว กรุณาลองอีกครั้ง",speechErrorNoDetect:"ไม่พบเสียงพูด กรุณาลองอีกครั้ง",logout:"ออกจากระบบ",inputPlaceholder:"หรือพิมพ์ข้อความโดยตรง... (Enter เพื่อส่ง)",welcome:n=>`สวัสดี, ${n}. ฉันคือเพื่อน AI ของคุณ คุณสามารถเริ่มคุยกับฉันได้เลย!`,welcomePickAvatar:n=>`สวัสดี, ${n}, เลือกอวตารของฉันแล้วมาคุยกันอย่างอิสระ!`,welcomeChat:(n,e)=>`${n}: สวัสดี, ${e}, วันนี้คุณอยากคุยเรื่องอะไร?`,whoAmI:"คุณอยากให้ฉันเป็นใคร?",tapToTalk:"แตะเพื่อเริ่มแชทด้วยเสียง...",aiReplying:"AI กำลังตอบกลับ, พิมพ์ข้อความใหม่เพื่อขัดจังหวะ",recognizing:"กำลังจดจำ..."},la:{friend:"Amicus",avatarTitle:"Elige Me ut Amicum Tuum",companionPhrase:["🕊️ Hic adsum ad mare,","Audio."],changeAvatar:"Muta Imaginem Meam",aiReplyTemplate:n=>`AI Curabitur: Intellego quid velis, "${n}", sine me plura a te audire...`,aiSystemPrompt:"Tu es persona virtualis calida et empathetica. Quaeso responde sono hortanti et positivo.",speechErrorBrowser:"Hic navigator recognitionem vocis non sustinet. Quaeso utere Chrome/Edge.",speechErrorFail:"Recognitio vocis defecit, quaeso iterum conare.",speechErrorNoDetect:"Nulla oratio detecta, quaeso iterum conare.",logout:"Exire",inputPlaceholder:"Aut, textum directe scribe... (Enter mittere)",welcome:n=>`Salve, ${n}. Amicus tuus AI sum. Iam potes mecum loqui!`,welcomePickAvatar:n=>`Salve, ${n}, elige imaginem meam et libere loquamur!`,welcomeChat:(n,e)=>`${n}: Salve, ${e}, de quo hodie loqui vis?`,whoAmI:"Quis vis me esse?",tapToTalk:"Tange ut colloquium vocale incipias...",aiReplying:"AI respondet, scribe novum nuntium ad interrumpendum.",recognizing:"Agnoscens..."},ms:{friend:"Kawan",avatarTitle:"Pilih Saya sebagai Kawan Anda",companionPhrase:["🕊️ Saya di sini di tepi laut,","Saya sedang mendengar."],changeAvatar:"Tukar Avatar Saya",aiReplyTemplate:n=>`Sembang AI: Saya faham maksud awak, "${n}", beritahu saya lagi...`,aiSystemPrompt:"Anda adalah orang maya yang mesra dan empati. Sila balas dengan nada yang menggalakkan dan positif.",speechErrorBrowser:"Pelayar ini tidak menyokong pengecaman pertuturan. Sila gunakan Chrome/Edge.",speechErrorFail:"Pengecaman pertuturan gagal, sila cuba lagi.",speechErrorNoDetect:"Tiada pertuturan dikesan, sila cuba lagi.",logout:"Log keluar",inputPlaceholder:"Atau, taip teks secara terus... (Enter untuk hantar)",welcome:n=>`Hai, ${n}. Saya kawan AI anda. Anda boleh mula bercakap dengan saya sekarang!`,welcomePickAvatar:n=>`Hai, ${n}, pilih avatar saya dan mari berbual dengan bebas!`,welcomeChat:(n,e)=>`${n}: Hai, ${e}, apa yang anda mahu bualkan hari ini?`,whoAmI:"Awak nak saya jadi siapa?",tapToTalk:"Ketik untuk memulakan sembang suara...",aiReplying:"AI sedang membalas, taip mesej baru untuk mengganggu.",recognizing:"Mengecam..."}},kN={"zh-TW":"返回","zh-CN":"返回",en:"Back",ja:"戻る",ko:"뒤로",th:"ย้อนกลับ",vi:"Quay lại",ms:"Kembali",la:"Redi"},TN={"zh-TW":"更換頭像","zh-CN":"更换头像",en:"Change Avatar",ja:"アバターを変更",ko:"아바타 변경",th:"เปลี่ยนภาพประจำตัว",vi:"Đổi avatar",ms:"Tukar Avatar",la:"Muta Imaginem"};function _N(){var Tt,vt,Bt,Dt,ke;const n=Et(),[e,t]=v.useState([]),[r,o]=v.useState(""),[a,c]=v.useState(!1),d=v.useRef(null),h=v.useRef(null),m=v.useRef(null),[g,x]=v.useState(!1),[S,j]=v.useState(!1),[T,R]=v.useState(""),[I,F]=v.useState(!1),[P,z]=v.useState(""),[H,J]=v.useState(""),[O,L]=v.useState(!1),[C,A]=v.useState(!1),[D,M]=v.useState(""),[B,_]=v.useState(""),{lang:U,setLang:oe}=Lt(),X=HS[U]||HS["zh-TW"],ce=v.useRef(null),{isTestMode:le}=Bo(),[te,xe]=v.useState(!1),$=v.useRef(null),[Q,G]=v.useState(!1),{checkPermission:ne,recordUsage:se}=Nc(),[me,Ie]=v.useState(!1),[Pe,qe]=v.useState(!1),[Ge,be]=v.useState(null),ae=()=>{const W=St().currentUser;return W&&W.displayName||localStorage.getItem("nickname")||X.friend},[rt,Le]=v.useState(ae()),[$e,fe]=v.useState(()=>localStorage.getItem("lastUid")),[_e,Ce]=v.useState(()=>!localStorage.getItem("avatarWelcomed")),[ze,De]=v.useState(()=>!localStorage.getItem("aiAvatar")),[K,ie]=v.useState(""),q=v.useRef(null);v.useEffect(()=>{localStorage.setItem("lang",U),Le(ae());const W=window.SpeechRecognition||window.webkitSpeechRecognition;W?(ce.current=new W,ce.current.continuous=!0,ce.current.interimResults=!0,ce.current.lang=U,ce.current.onresult=Y=>{let ee="",ve="";for(let Te=Y.resultIndex;Te<Y.results.length;++Te)Y.results[Te].isFinal?ve+=Y.results[Te][0].transcript:ee+=Y.results[Te][0].transcript;if(o(B+ve+ee),ve){const Te=B+ve;_(Je=>Je+ve),(async()=>{const Je={id:`user-${Date.now()}`,text:Te,sender:"user"};t(Ye=>[...Ye,Je]),o(""),d.current&&clearTimeout(d.current);const He=`ai-${Date.now()}`;t(Ye=>[...Ye,{id:He,text:"",sender:"ai",status:"streaming"}]),c(!0);try{const Ye=await sy(Te,U,X.aiSystemPrompt,le);let gt="";for await(const mt of Ye)gt+=mt,t(_t=>_t.map(xn=>xn.id===He?{...xn,text:gt}:xn));t(mt=>mt.map(_t=>_t.id===He?{..._t,status:"done"}:_t))}catch(Ye){console.error("Error in AI pipeline: ",Ye);const gt=Ye instanceof Error?Ye.message:"未知錯誤";t(mt=>mt.map(_t=>_t.id===He?{..._t,text:`API錯誤：${gt}`,status:"done"}:_t))}finally{c(!1)}})()}},ce.current.onerror=Y=>{console.error("Speech recognition error",Y.error);let ee="";switch(Y.error){case"no-speech":ee=X.speechErrorNoDetect;break;case"audio-capture":case"network":ee=X.speechErrorFail;break;default:ee=""}M(ee),A(!1),j(!1)},ce.current.onend=()=>{A(!1)}):M(X.speechErrorBrowser)},[U,X.speechErrorBrowser,X.speechErrorFail,X.speechErrorNoDetect,S,B]),v.useEffect(()=>{ce.current&&(ce.current.onend=()=>{A(!1),te&&S&&!Q&&($.current=setTimeout(()=>{!S||Q||(r.trim()&&(st(r),o(""),_("")),setTimeout(()=>{S&&te&&!Q&&(ce.current.start(),A(!0))},500))},100))})},[te,S,r,Q]),v.useEffect(()=>{var ee,ve;const W=localStorage.getItem("aiAvatar");W?(R(W),F(!1)):F(!0);const Y=(ee=St().currentUser)==null?void 0:ee.uid;Y!==$e&&(localStorage.removeItem("aiAvatar"),localStorage.removeItem("avatarWelcomed"),R(""),fe(Y||null),Y&&localStorage.setItem("lastUid",Y)),St().currentUser&&Le(((ve=St().currentUser)==null?void 0:ve.displayName)||X.friend)},[$e,X.friend]),v.useEffect(()=>{m.current&&(m.current.scrollTop=m.current.scrollHeight)},[e]);const Me=W=>{R(W),localStorage.setItem("aiAvatar",W),F(!1),_e&&(t([{id:"welcome-1",text:X.welcomeChat(et(W),rt),sender:"ai"}]),localStorage.setItem("avatarWelcomed","true"),Ce(!1))},st=async(W=r)=>{if(!W.trim())return;const Y=await ne("aiChat");if(!Y.allowed){if(le){const Te={id:`user-${Date.now()}`,text:W,sender:"user"};t(He=>[...He,Te]),o(""),_(""),d.current&&clearTimeout(d.current);const Je=`ai-${Date.now()}`;t(He=>[...He,{id:Je,text:"",sender:"ai",status:"streaming"}]),c(!0);try{const He=await sy(W,U,X.aiSystemPrompt,le);let Ye="";for await(const gt of He)Ye+=gt,t(mt=>mt.map(_t=>_t.id===Je?{..._t,text:Ye}:_t));t(gt=>gt.map(mt=>mt.id===Je?{...mt,status:"done"}:mt))}catch(He){console.error("Error in AI pipeline: ",He);const Ye=He instanceof Error?He.message:"未知錯誤";t(gt=>gt.map(mt=>mt.id===Je?{...mt,text:`API錯誤：${Ye}`,status:"done"}:mt))}finally{c(!1)}return}Y.isFreeUser?qe(!0):(Y.canRenew,be(Y),Ie(!0));return}const ee={id:`user-${Date.now()}`,text:W,sender:"user"};t(Te=>[...Te,ee]),o(""),_(""),d.current&&clearTimeout(d.current);const ve=`ai-${Date.now()}`;t(Te=>[...Te,{id:ve,text:"",sender:"ai",status:"streaming"}]),c(!0);try{const Te=await sy(W,U,X.aiSystemPrompt,le);let Je="";for await(const He of Te)Je+=He,t(Ye=>Ye.map(gt=>gt.id===ve?{...gt,text:Je}:gt));t(He=>He.map(Ye=>Ye.id===ve?{...Ye,status:"done"}:Ye)),L(!0),await se("aiChat",2)}catch(Te){console.error("Error in AI pipeline: ",Te),t(Je=>Je.map(He=>He.id===ve?{...He,text:"Oops, something went wrong.",status:"done"}:He))}finally{c(!1),L(!1)}},et=W=>{if(!W)return"";const Y=W.split("/");return Y[Y.length-1].replace(/\.png$/i,"")},dt=async()=>{if(ce.current)if(S||te||C)ce.current.stop(),j(!1),A(!1),xe(!1),$.current&&clearTimeout($.current),G(!0);else{const W=await ne("aiChat");if(!W.allowed){if(le){_(""),o(""),ce.current.start(),j(!0),A(!0),M(""),xe(!0),G(!1);return}W.isFreeUser?qe(!0):(W.canRenew,be(W),Ie(!0));return}_(""),o(""),ce.current.start(),j(!0),A(!0),M(""),xe(!0),G(!1),await se("aiChat",1)}},Ht=W=>{var ee;const Y=(ee=W.target.files)==null?void 0:ee[0];if(Y){if(!Y.type.startsWith("image/")){alert("請選擇圖片文件");return}if(Y.size>5*1024*1024){alert("圖片大小不能超過 5MB");return}const ve=new FileReader;ve.onload=Te=>{var He;const Je=(He=Te.target)==null?void 0:He.result;ie(Je),Me(Je)},ve.readAsDataURL(Y)}},je=()=>{var W;(W=q.current)==null||W.click()};v.useEffect(()=>{!S&&!te&&G(!1)},[S,te]);const Qe=()=>{Ie(!1),be(null)};return i.jsxs("div",{style:{display:"flex",flexDirection:"column",height:"100vh",backgroundColor:"#f0f2f5"},children:[i.jsxs("header",{style:{display:"flex",flexDirection:"column",backgroundColor:"#fff",borderBottom:"1px solid #ddd",position:"relative",padding:0},children:[i.jsxs("div",{style:{width:"100%",display:"flex",alignItems:"center",justifyContent:"center",padding:"10px 20px 0 20px",position:"relative"},children:[i.jsx("button",{onClick:()=>n(-1),style:{position:"absolute",left:20,background:"#6B5BFF",color:"#fff",border:"none",borderRadius:8,padding:"8px 18px",fontWeight:700,fontSize:16,cursor:"pointer"},children:kN[U]}),i.jsx("span",{className:"ai-name-desktop",style:{fontWeight:700,color:"#ff9800",fontSize:18,marginRight:12,minWidth:50,textAlign:"right",maxWidth:70,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:et(T)||X.whoAmI}),i.jsx("div",{style:{fontSize:20,fontWeight:700,textAlign:"center",flexShrink:0},children:"💬 聊天了吧"}),i.jsx("span",{style:{fontWeight:700,color:"#1976d2",fontSize:18,marginLeft:12,minWidth:50,textAlign:"left",maxWidth:70,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:((Tt=St().currentUser)==null?void 0:Tt.displayName)||((vt=St().currentUser)==null?void 0:vt.email)||"用戶"})]}),i.jsx("div",{style:{textAlign:"center",marginTop:4},children:i.jsx("div",{style:{fontSize:16,color:"#888"},children:"在這裡你可以盡情,暢快,放開地聊😊"})})]}),I&&i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.8)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:100},children:i.jsxs("div",{style:{background:"#fff",padding:24,borderRadius:12,textAlign:"center",position:"relative"},children:[i.jsx("button",{onClick:()=>F(!1),style:{position:"absolute",top:12,right:12,background:"none",border:"none",fontSize:24,color:"#888",cursor:"pointer",fontWeight:700},children:"×"}),i.jsx("h2",{children:X.avatarTitle}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(5, 1fr)",gap:16,margin:"24px 0"},children:[SN.slice(0,15).map(W=>i.jsx("img",{src:W,alt:et(W),onClick:()=>Me(W),style:{width:80,height:80,borderRadius:"50%",cursor:"pointer",objectFit:"cover"}},W)),i.jsx("div",{style:{width:80,height:80,borderRadius:"50%",border:"2px dashed #6B5BFF",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",background:"#f8f8ff",color:"#6B5BFF",fontSize:12,fontWeight:600},onClick:je,children:"上傳心儀頭像"})]}),i.jsx("input",{ref:q,type:"file",accept:"image/*",style:{display:"none"},onChange:Ht})]})}),!T&&!I&&i.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",padding:24,textAlign:"center"},children:[i.jsx("p",{style:{fontSize:18,marginBottom:24},children:X.welcomePickAvatar(rt)}),i.jsx("button",{onClick:()=>F(!0),style:{padding:"10px 20px",borderRadius:8,background:"#1877f2",color:"#fff",border:"none",fontWeight:700,fontSize:16},children:X.avatarTitle})]}),T&&i.jsx("main",{ref:m,style:{flex:1,overflowY:"auto",padding:"20px",maxHeight:"calc(100vh - 240px)",scrollBehavior:"smooth",boxSizing:"border-box"},children:i.jsxs("div",{style:{maxWidth:800,margin:"0 auto",minHeight:"100%"},children:[e.length===0&&i.jsx("div",{style:{textAlign:"center",color:"#888",marginTop:40},children:i.jsx("p",{style:{fontSize:18},children:X.welcomeChat(et(T),rt)})}),e.map(W=>i.jsx("div",{style:{display:"flex",justifyContent:W.sender==="user"?"flex-end":"flex-start",margin:"10px 0",wordWrap:"break-word"},children:i.jsxs("div",{style:{backgroundColor:W.sender==="user"?"#0084ff":"#e4e6eb",color:W.sender==="user"?"#fff":"#000",padding:"12px 16px",borderRadius:18,maxWidth:"70%",wordBreak:"break-word",whiteSpace:"pre-wrap",lineHeight:"1.4"},children:[W.text,W.status==="streaming"&&"..."]})},W.id)),i.jsx("div",{style:{height:"20px"}})]})}),T&&i.jsxs("footer",{style:{padding:"10px 20px 10px 20px",backgroundColor:"#fff",borderTop:"1px solid #ddd",position:"relative",minHeight:"160px",boxSizing:"border-box"},children:[i.jsx("div",{style:{maxWidth:800,margin:"0 auto",display:"flex",alignItems:"flex-start",justifyContent:"center"},children:i.jsxs("div",{style:{flex:1,marginLeft:0,marginRight:0},children:[i.jsxs("div",{className:"mobile-avatars-row",style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:12,padding:"0 8px"},children:[i.jsxs("div",{className:"mobile-ai-avatar",style:{display:"flex",alignItems:"center",gap:8},children:[i.jsx("div",{style:{width:80,height:80,borderRadius:"50% / 45%",border:"4px solid #2196f3",display:"flex",alignItems:"center",justifyContent:"center",background:"#fff",overflow:"hidden"},children:i.jsx("div",{style:{width:72,height:72,minWidth:72,minHeight:72,borderRadius:"50%",overflow:"hidden",position:"relative"},children:i.jsx("div",{style:{width:"100%",height:"100%",position:"relative",overflow:"hidden"},children:i.jsx(HD,{avatar:T,videoUrl:P,audioUrl:H,isSpeaking:O,size:72})})})}),i.jsx("button",{onClick:()=>F(!0),style:{background:"#6B5BFF",color:"#fff",border:"none",borderRadius:6,padding:"4px 8px",fontWeight:600,fontSize:10,cursor:"pointer",boxShadow:"0 2px 4px rgba(107, 91, 255, 0.3)",whiteSpace:"nowrap"},children:TN[U]})]}),i.jsx("div",{style:{flex:1,textAlign:"center",padding:"0 12px"},children:i.jsxs("div",{style:{fontSize:14,color:"#666",lineHeight:"1.4"},children:[i.jsx("span",{style:{fontWeight:700,color:"#ff9800"},children:et(T)||"Fenny"}),i.jsx("br",{}),i.jsx("span",{style:{color:"#1976d2"},children:"讓我們來聊天..."}),i.jsx("br",{}),i.jsx("span",{style:{color:"#1976d2"},children:((Bt=St().currentUser)==null?void 0:Bt.displayName)||((Dt=St().currentUser)==null?void 0:Dt.email)||"用戶"}),i.jsx("br",{}),i.jsx("span",{style:{color:"#666"},children:"聊什麼都可以喔 😊"})]})}),i.jsx("div",{style:{width:80,height:80,borderRadius:"50% / 45%",border:"4px solid #2196f3",display:"flex",alignItems:"center",justifyContent:"center",background:"#fff",overflow:"visible"},children:i.jsx("img",{src:((ke=St().currentUser)==null?void 0:ke.photoURL)||"/ctx-logo.png",alt:"user",style:{width:72,height:72,minWidth:72,minHeight:72,borderRadius:"50%",objectFit:"cover",border:"none",verticalAlign:"bottom"}})})]}),i.jsx("div",{style:{display:"flex",alignItems:"flex-end",height:80},children:i.jsx("input",{ref:h,type:"text",value:r,onChange:W=>o(W.target.value),onKeyPress:W=>W.key==="Enter"&&st(),placeholder:a?X.aiReplying:X.inputPlaceholder,style:{width:"100%",padding:12,borderRadius:18,border:"1px solid #ccc"},disabled:a||C})}),i.jsxs("div",{className:"chat-action-row-mobile",style:{width:"100%",display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center",marginTop:12,gap:16},children:[i.jsx("button",{onClick:()=>st(),disabled:a||!r,style:{padding:"10px 28px",borderRadius:8,border:"none",background:"#1976d2",color:"#fff",fontWeight:700,fontSize:16,cursor:a||!r?"not-allowed":"pointer"},children:"送出"}),i.jsx("button",{onClick:dt,disabled:a,style:{padding:16,borderRadius:"50%",border:"none",background:S||te||C?"#ff4d4d":"#1877f2",color:"#fff",cursor:"pointer",fontSize:20},children:S||te||C?"停止":"🎤"})]}),i.jsxs("div",{className:"chat-action-row-desktop",style:{width:"100%",display:"none",flexDirection:"row",alignItems:"center",justifyContent:"center",marginTop:12,gap:16},children:[i.jsx("button",{onClick:()=>st(),disabled:a||!r,style:{padding:"10px 28px",borderRadius:8,border:"none",background:"#1976d2",color:"#fff",fontWeight:700,fontSize:16,cursor:a||!r?"not-allowed":"pointer"},children:"送出"}),i.jsx("button",{onClick:dt,disabled:a,style:{padding:16,borderRadius:"50%",border:"none",background:S||te||C?"#ff4d4d":"#1877f2",color:"#fff",cursor:"pointer",fontSize:20},children:S||te||C?"停止":"🎤"})]}),i.jsxs("div",{style:{height:40,display:"flex",alignItems:"center",justifyContent:"center"},children:[D&&i.jsx("p",{style:{color:"red",margin:0},children:D}),!D&&!r&&!C&&!a&&!S&&!te&&i.jsx("p",{style:{color:"#888",margin:0,cursor:"pointer"},onClick:dt,children:X.tapToTalk}),!D&&C&&i.jsx("p",{style:{color:"#888",margin:0},children:X.recognizing}),!D&&(r||a||S||te)&&i.jsx("p",{style:{color:"transparent",margin:0},children:"佔位"})]})]})}),i.jsx("div",{style:{textAlign:"center",marginTop:10,fontSize:12,color:"#aaa"},children:i.jsxs("p",{children:[X.companionPhrase[0],X.companionPhrase[1]]})})]}),window.innerWidth<=768?i.jsxs("footer",{style:{textAlign:"center",fontSize:12,color:"#888",marginTop:20,padding:12,background:"rgba(255,255,255,0.95)",borderTop:"1px solid #eee",display:"flex",flexDirection:"column",gap:8},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:16,flexWrap:"wrap"},children:[i.jsx("a",{href:"/about",style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:600,fontSize:11},children:U==="zh-TW"?"🧬 我們是誰":U==="zh-CN"?"🧬 我们是谁":U==="en"?"🧬 Who We Are":U==="ja"?"🧬 私たちについて":U==="ko"?"🧬 우리는 누구인가":U==="th"?"🧬 เราเป็นใคร":U==="vi"?"🧬 Chúng tôi là ai":U==="ms"?"🧬 Siapa Kami":"🧬 Quis sumus"}),i.jsx("a",{href:"/privacy-policy",style:{color:"#6B5BFF",textDecoration:"underline",fontSize:11},children:U==="zh-TW"?"隱私權政策":U==="zh-CN"?"隐私政策":U==="en"?"Privacy Policy":U==="ja"?"プライバシーポリシー":U==="ko"?"개인정보 처리방침":U==="th"?"นโยบายความเป็นส่วนตัว":U==="vi"?"Chính sách bảo mật":U==="ms"?"Dasar Privasi":"Consilium de Privata"}),i.jsx("a",{href:"/terms",style:{color:"#6B5BFF",textDecoration:"underline",fontSize:11},children:U==="zh-TW"?"條款/聲明":U==="zh-CN"?"条款/声明":U==="en"?"Terms/Statement":U==="ja"?"規約/声明":U==="ko"?"약관/성명":U==="th"?"ข้อกำหนด/แถลงการณ์":U==="vi"?"Điều khoản/Tuyên bố":U==="ms"?"Terma/Pernyataan":"Termini/Declaratio"})]}),i.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:16,flexWrap:"wrap"},children:[i.jsx("a",{href:"/data-deletion",style:{color:"#6B5BFF",textDecoration:"underline",fontSize:11},children:U==="zh-TW"?"資料刪除說明":U==="zh-CN"?"数据删除说明":U==="en"?"Data Deletion":U==="ja"?"データ削除について":U==="ko"?"데이터 삭제 안내":U==="th"?"คำอธิบายการลบข้อมูล":U==="vi"?"Giải thích xóa dữ liệu":U==="ms"?"Penjelasan Penghapusan Data":"Explicatio Deletionis Datae"}),i.jsx("a",{href:"/feedback",style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:600,fontSize:11},children:U==="zh-TW"?"💬 意見箱":U==="zh-CN"?"💬 意见箱":U==="en"?"💬 Feedback":U==="ja"?"💬 ご意見箱":U==="ko"?"💬 피드백":U==="th"?"💬 กล่องความคิดเห็น":U==="vi"?"💬 Hộp góp ý":U==="ms"?"💬 Kotak Maklum Balas":"💬 Arca Consilii"})]})]}):i.jsx("div",{style:{width:"100%",margin:"0 auto",marginTop:24,background:"rgba(255,255,255,0.95)",borderRadius:16,padding:"16px",boxShadow:"0 2px 12px #6B5BFF22"},children:i.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:20,flexWrap:"wrap"},children:[i.jsx("a",{href:"/about",style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12},children:U==="zh-TW"?"🧬 Restarter™｜我們是誰":U==="zh-CN"?"🧬 Restarter™｜我们是谁":U==="en"?"🧬 Restarter™｜Who We Are":U==="ja"?"🧬 Restarter™｜私たちについて":U==="ko"?"🧬 Restarter™｜우리는 누구인가":U==="th"?"🧬 Restarter™｜เราเป็นใคร":U==="vi"?"🧬 Restarter™｜Chúng tôi là ai":U==="ms"?"🧬 Restarter™｜Siapa Kami":"🧬 Restarter™｜Quis sumus"}),i.jsx("a",{href:"/privacy-policy",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12},children:U==="zh-TW"?"隱私權政策":U==="zh-CN"?"隐私政策":U==="en"?"Privacy Policy":U==="ja"?"プライバシーポリシー":U==="ko"?"개인정보 처리방침":U==="th"?"นโยบายความเป็นส่วนตัว":U==="vi"?"Chính sách bảo mật":U==="ms"?"Dasar Privasi":"Consilium de Privata"}),i.jsx("a",{href:"/terms",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12},children:U==="zh-TW"?"條款/聲明":U==="zh-CN"?"条款/声明":U==="en"?"Terms/Statement":U==="ja"?"規約/声明":U==="ko"?"약관/성명":U==="th"?"ข้อกำหนด/แถลงการณ์":U==="vi"?"Điều khoản/Tuyên bố":U==="ms"?"Terma/Pernyataan":"Termini/Declaratio"}),i.jsx("a",{href:"/data-deletion",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12},children:U==="zh-TW"?"資料刪除說明":U==="zh-CN"?"数据删除说明":U==="en"?"Data Deletion":U==="ja"?"データ削除について":U==="ko"?"데이터 삭제 안내":U==="th"?"คำอธิบายการลบข้อมูล":U==="vi"?"Giải thích xóa dữ liệu":U==="ms"?"Penjelasan Penghapusan Data":"Explicatio Deletionis Datae"}),i.jsx("a",{href:"/feedback",style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12},children:U==="zh-TW"?"💬 意見箱｜我們想聽你說":U==="zh-CN"?"💬 意见箱｜我们想听你说":U==="en"?"💬 Feedback Box｜We Want to Hear From You":U==="ja"?"💬 ご意見箱｜私たちはあなたの声を聞きたい":U==="ko"?"💬 피드백｜우리는 당신의 말을 듣고 싶습니다":U==="th"?"💬 กล่องความคิดเห็น｜เราอยากได้ยินจากคุณ":U==="vi"?"💬 Hộp góp ý｜Chúng tôi muốn nghe từ bạn":U==="ms"?"💬 Kotak Maklum Balas｜Kami Ingin Mendengar Dari Anda":"💬 Arca Consilii｜Volumus Audire a Te"})]})}),me&&Ge&&i.jsx(qa,{isOpen:me,onClose:Qe,currentPlan:Ge.currentPlan,remainingDays:Ge.remainingDays,usedTokens:Ge.usedTokens,totalTokens:Ge.totalTokens}),Pe&&i.jsx(oI,{isOpen:Pe,onClose:()=>qe(!1),featureName:"AI 聊天"})]})}const jN="modulepreload",IN=function(n){return"/"+n},$S={},vc=function(e,t,r){let o=Promise.resolve();if(t&&t.length>0){let c=function(m){return Promise.all(m.map(g=>Promise.resolve(g).then(x=>({status:"fulfilled",value:x}),x=>({status:"rejected",reason:x}))))};document.getElementsByTagName("link");const d=document.querySelector("meta[property=csp-nonce]"),h=(d==null?void 0:d.nonce)||(d==null?void 0:d.getAttribute("nonce"));o=c(t.map(m=>{if(m=IN(m),m in $S)return;$S[m]=!0;const g=m.endsWith(".css"),x=g?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${m}"]${x}`))return;const S=document.createElement("link");if(S.rel=g?"stylesheet":jN,g||(S.as="script"),S.crossOrigin="",S.href=m,h&&S.setAttribute("nonce",h),document.head.appendChild(S),g)return new Promise((j,T)=>{S.addEventListener("load",j),S.addEventListener("error",()=>T(new Error(`Unable to preload CSS for ${m}`)))})}))}function a(c){const d=new Event("vite:preloadError",{cancelable:!0});if(d.payload=c,window.dispatchEvent(d),!d.defaultPrevented)throw c}return o.then(c=>{for(const d of c||[])d.status==="rejected"&&a(d.reason);return e().catch(a)})},ca=St(Po),CN={"zh-TW":{heroLeftTop:"救贖不是罪，",heroLeftMain:"只是走錯太久。",heroLeftSub:"",heroLeftYellow:"野花昂首盡綻放！",heroRightTop:"我要重新開始...",heroRightMain:"每一次的經歷，都是獨一無二的篇章",heroRightSub:"而不是成長的絆腳石。",heroRightYellow:"從灰燼中重生！",title:"Restarter™ 註冊",email:"電子郵件 *必填",password:"密碼(至少6位，含英文及數字)*必填",nickname:"暱稱*必填",age:"年齡*選填",selectAge:"請選擇年齡區間*必選",country:"國家(地區)*必選",city:"城市(可選)",interest:"興趣*選填",eventType:"經歷事件**選填",whatToImprove:"想改善什麼*選填",uploadAvatar:"上傳頭像",male:"男",female:"女",genderRequired:"(必選)",register:"🚀 註冊",registering:"註冊中...",errorAvatar:"請上傳頭像",errorGender:"請選擇性別",errorEmailFormat:"電子郵件格式無效",errorPasswordFormat:"密碼必須至少8個字符，且包含字母和數字",errorNicknameFormat:"暱稱必須是6-16個字符",errorAgeFormat:"年齡必須在18到99歲之間",errorCountry:"請選擇國家/地區",errorRegion:"請輸入城市",errorInterest:"請選擇興趣",errorEventType:"請選擇事件類型",errorImprovement:"請選擇想改善的項目",formTopSlogan:"你來了，就值得被歡迎！",login:"登入",terms:"條款/聲明",privacy:"隱私權政策",deletion:"資料刪除說明",googleLogin:"使用 Google 登入",appleLogin:"使用 Apple 登入"},"zh-CN":{heroLeftTop:"救赎不是罪，",heroLeftMain:"只是走错太久。",heroLeftSub:"",heroLeftYellow:"野花昂首尽绽放！",heroRightTop:"我要重新开始...",heroRightMain:"每一次的经历，都是独一无二的篇章",heroRightSub:"而不是成长的绊脚石。",heroRightYellow:"从灰烬中重生！",title:"Restarter™ 注册",email:"电子邮件 *必填",password:"密码 (至少8位，含英文及数字) *必填",nickname:"昵称 (6-16字) *必填",age:"年龄*选填",selectAge:"请选择年龄区间*必选",country:"国家(地区)*必选",city:"城市(可选)",interest:"兴趣*选填",eventType:"经历事件**选填",whatToImprove:"想改善什么*选填",uploadAvatar:"上传头像",male:"男",female:"女",genderRequired:"(必选)",register:"🚀 注册",registering:"注册中...",errorAvatar:"请上传头像",errorGender:"请选择性别",errorEmailFormat:"电子邮件格式无效",errorPasswordFormat:"密码必须至少8个字符，且包含字母和数字",errorNicknameFormat:"昵称必须是6-16个字符",errorAgeFormat:"年龄必须在18到99岁之间",errorCountry:"请选择国家/地区",errorRegion:"请输入城市",errorInterest:"请选择兴趣",errorEventType:"请选择事件类型",errorImprovement:"请选择想改善的项目",formTopSlogan:"你來了，就值得被歡迎！",login:"登录",terms:"条款/声明",privacy:"隐私政策",deletion:"数据删除说明",googleLogin:"使用 Google 登录",appleLogin:"使用 Apple 登录"},en:{heroLeftTop:"Redemption is not a crime,",heroLeftMain:"just went down the wrong path for too long.",heroLeftSub:"",heroLeftYellow:"Wildflowers bloom bravely!",heroRightTop:"I want a new start...",heroRightMain:"Every experience is a unique chapter,",heroRightSub:"not a barrier to growth.",heroRightYellow:"Rise from the ashes!",title:"Restarter™ Registration",email:"Email *required",password:"Password (min 8 chars, letter & number) *required",nickname:"Nickname (6-16 chars) *required",age:"Age*optional",selectAge:"Select age range",country:"Country (Region)*optional",city:"City (optional)",interest:"Interest*optional",eventType:"History Event**optional",whatToImprove:"What to improve*optional",uploadAvatar:"Upload Avatar",male:"Male",female:"Female",genderRequired:"(*required)",register:"🚀 Register",registering:"Registering...",errorAvatar:"Please upload an avatar.",errorGender:"Please select a gender.",errorEmailFormat:"Invalid email format.",errorPasswordFormat:"Password must be at least 8 characters long and contain both letters and numbers.",errorNicknameFormat:"Nickname must be 6-16 characters long.",errorAgeFormat:"Age must be between 18 and 99.",errorCountry:"Please select a country.",errorRegion:"Please enter a city.",errorInterest:"Please select an interest.",errorEventType:"Please select an event type.",errorImprovement:"Please select an item to improve.",formTopSlogan:"It's not wrong to rise up!",login:"Login",terms:"Terms/Statement",privacy:"Privacy Policy",deletion:"Data Deletion",googleLogin:"Sign in with Google",appleLogin:"Sign in with Apple"},ja:{heroLeftTop:"贖いは罪ではない、",heroLeftMain:"ただ道に迷った時間が長すぎただけだ。",heroLeftSub:"",heroLeftYellow:"野の花も堂々と咲く！",heroRightTop:"私は新しく始めたい...",heroRightMain:"一つ一つの経験が、ユニークな章であり、",heroRightSub:"成長の障害ではない。",heroRightYellow:"灰の中から蘇れ！",title:"Restarter™ 登録",email:"メールアドレス *必須",password:"パスワード (8文字以上、英数字を含む) *必須",nickname:"ニックネーム (6-16文字) *必須",age:"年齢*任意",selectAge:"年齢層を選択",country:"国/地域*任意",city:"都市(任意)",interest:"興味*任意",eventType:"経験した出来事**任意",whatToImprove:"改善したいこと*任意",uploadAvatar:"アバターをアップロード",male:"男性",female:"女性",genderRequired:"(*必須)",register:"🚀 登録",registering:"登録中...",errorAvatar:"アバターをアップロードしてください。",errorGender:"性別を選択してください。",errorEmailFormat:"無効なメール形式です。",errorPasswordFormat:"パスワードは8文字以上で、文字と数字の両方を含める必要があります。",errorNicknameFormat:"ニックネームは6～16文字である必要があります。",errorAgeFormat:"年齢は18歳から99歳の間でなければなりません。",errorCountry:"国を選択してください。",errorRegion:"都市を入力してください。",errorInterest:"興味を選択してください。",errorEventType:"イベントタイプを選択してください。",errorImprovement:"改善したい項目を選択してください。",formTopSlogan:"立ち上がることは間違いじゃない！",login:"ログイン",terms:"規約/声明",privacy:"プライバシーポリシー",deletion:"データ削除について",googleLogin:"Googleでログイン",appleLogin:"Appleでログイン"},ko:{heroLeftTop:"구원은 죄가 아니며,",heroLeftMain:"그저 너무 오랫동안 길을 잃었을 뿐이다.",heroLeftSub:"",heroLeftYellow:"들꽃은 용감하게 핀다!",heroRightTop:"새로운 시작을 원해...",heroRightMain:"모든 경험은 독특한 장이며,",heroRightSub:"성장의 장벽이 아니다.",heroRightYellow:"잿더미에서 일어나라!",title:"Restarter™ 회원가입",email:"이메일 *필수",password:"비밀번호 (최소 8자, 영문/숫자 포함) *필수",nickname:"닉네임 (6-16자) *필수",age:"나이*선택",selectAge:"연령대 선택",country:"국가/지역*선택",city:"도시(선택 사항)",interest:"관심사*선택",eventType:"경험한 사건**선택",whatToImprove:"개선하고 싶은 점*선택",uploadAvatar:"아바타 업로드",male:"남성",female:"여성",genderRequired:"(*필수)",register:"🚀 가입하기",registering:"가입 중...",errorAvatar:"아바타를 업로드해주세요.",errorGender:"성별을 선택해주세요.",errorEmailFormat:"유효하지 않은 이메일 형식입니다.",errorPasswordFormat:"비밀번호는 최소 8자 이상이며, 문자와 숫자를 모두 포함해야 합니다.",errorNicknameFormat:"닉네임은 6-16자여야 합니다.",errorAgeFormat:"나이는 18세에서 99세 사이여야 합니다.",errorCountry:"국가를 선택해주세요.",errorRegion:"도시를 입력해주세요.",errorInterest:"관심사를 선택해주세요.",errorEventType:"사건 유형을 선택해주세요.",errorImprovement:"개선할 항목을 선택해주세요.",formTopSlogan:"일어서는 것은 잘못이 아니야!",login:"로그인",terms:"약관/성명서",privacy:"개인정보처리방침",deletion:"데이터 삭제 안내",googleLogin:"Google로 로그인",appleLogin:"Apple로 로그인"},th:{heroLeftTop:"การไถ่บาปไม่ใช่ความผิด",heroLeftMain:"เพียงแค่หลงทางมานานเกินไป",heroLeftSub:"",heroLeftYellow:"ดอกไม้ป่าบานอย่างกล้าหาญ!",heroRightTop:"ฉันต้องการเริ่มต้นใหม่...",heroRightMain:"ทุกประสบการณ์คือบทที่พิเศษ",heroRightSub:"ไม่ใช่อุปสรรคต่อการเติบโต",heroRightYellow:"ลุกขึ้นจากเถ้าถ่าน!",title:"Restarter™ ลงทะเบียน",email:"อีเมล *จำเป็น",password:"รหัสผ่าน (ขั้นต่ำ 8 ตัวอักษร, ประกอบด้วยตัวอักษรและตัวเลข) *จำเป็น",nickname:"ชื่อเล่น (6-16 ตัวอักษร) *จำเป็น",age:"อายุ*ไม่บังคับ",selectAge:"เลือกช่วงอายุ",country:"ประเทศ/ภูมิภาค*ไม่บังคับ",city:"เมือง (ไม่บังคับ)",interest:"ความสนใจ*ไม่บังคับ",eventType:"เหตุการณ์ที่ผ่านมา**ไม่บังคับ",whatToImprove:"สิ่งที่ต้องการปรับปรุง*ไม่บังคับ",uploadAvatar:"อัปโหลดรูปภาพ",male:"ชาย",female:"หญิง",genderRequired:"(*จำเป็น)",register:"🚀 ลงทะเบียน",registering:"กำลังลงทะเบียน...",errorAvatar:"กรุณาอัปโหลดรูปโปรไฟล์",errorGender:"กรุณาเลือกเพศ",errorEmailFormat:"รูปแบบอีเมลไม่ถูกต้อง",errorPasswordFormat:"รหัสผ่านต้องมีความยาวอย่างน้อย 8 ตัวอักษรและมีทั้งตัวอักษรและตัวเลข",errorNicknameFormat:"ชื่อเล่นต้องมีความยาว 6-16 ตัวอักษร",errorAgeFormat:"อายุต้องอยู่ระหว่าง 18 ถึง 99 ปี",errorCountry:"กรุณาเลือกประเทศ",errorRegion:"กรุณากรอกเมือง",errorInterest:"กรุณาเลือกความสนใจ",errorEventType:"กรุณาเลือกประเภทเหตุการณ์",errorImprovement:"กรุณาเลือกรายการที่ต้องการปรับปรุง",formTopSlogan:"การลุกขึ้นสู้ไม่ใช่เรื่องผิด!",login:"เข้าสู่ระบบ",terms:"ข้อกำหนด/คำชี้แจง",privacy:"นโยบายความเป็นส่วนตัว",deletion:"นโยบายการลบข้อมูล",googleLogin:"เข้าสู่ระบบด้วย Google",appleLogin:"เข้าสู่ระบบด้วย Apple"},vi:{heroLeftTop:"Sự chuộc lỗi không phải là tội ác,",heroLeftMain:"chỉ là đi sai đường quá lâu.",heroLeftSub:"",heroLeftYellow:"Hoa dại nở rộ dũng cảm!",heroRightTop:"Tôi muốn một khởi đầu mới...",heroRightMain:"Mỗi trải nghiệm là một chương độc đáo,",heroRightSub:"Không phải là rào cản cho sự phát triển.",heroRightYellow:"Vươn lên từ đống tro tàn!",title:"Đăng ký Restarter™",email:"Email *bắt buộc",password:"Mật khẩu (tối thiểu 8 ký tự, gồm chữ và số) *bắt buộc",nickname:"Biệt danh (6-16 ký tự) *bắt buộc",age:"Tuổi*không bắt buộc",selectAge:"Chọn độ tuổi",country:"Quốc gia/Khu vực*không bắt buộc",city:"Thành phố (tùy chọn)",interest:"Sở thích*không bắt buộc",eventType:"Sự kiện đã trải qua**không bắt buộc",whatToImprove:"Điều muốn cải thiện*không bắt buộc",uploadAvatar:"Tải lên hình đại diện",male:"Nam",female:"Nữ",genderRequired:"(*bắt buộc)",register:"🚀 Đăng ký",registering:"Đang đăng ký...",errorAvatar:"Vui lòng tải lên ảnh đại diện.",errorGender:"Vui lòng chọn giới tính.",errorEmailFormat:"Định dạng email không hợp lệ.",errorPasswordFormat:"Mật khẩu phải dài ít nhất 8 ký tự và chứa cả chữ cái và số.",errorNicknameFormat:"Biệt danh phải dài từ 6-16 ký tự.",errorAgeFormat:"Tuổi phải từ 18 đến 99.",errorCountry:"Vui lòng chọn một quốc gia.",errorRegion:"Vui lòng nhập thành phố.",errorInterest:"Vui lòng chọn một sở thích.",errorEventType:"Vui lòng chọn một loại sự kiện.",errorImprovement:"Vui lòng chọn một mục để cải thiện.",formTopSlogan:"Vươn lên không phải là sai!",login:"Đăng nhập",terms:"Điều khoản/Tuyên bố",privacy:"Chính sách bảo mật",deletion:"Chính sách xóa dữ liệu",googleLogin:"Đăng nhập bằng Google",appleLogin:"Đăng nhập bằng Apple"},ms:{heroLeftTop:"Penebusan bukanlah jenayah,",heroLeftMain:"hanya tersalah jalan terlalu lama.",heroLeftSub:"",heroLeftYellow:"Bunga liar mekar dengan berani!",heroRightTop:"Saya mahu permulaan yang baru...",heroRightMain:"Setiap pengalaman adalah satu bab yang unik,",heroRightSub:"bukan penghalang kepada pertumbuhan.",heroRightYellow:"Bangkit dari abu!",title:"Pendaftaran Restarter™",email:"E-mel *diperlukan",password:"Kata laluan (min 8 aksara, huruf & nombor) *diperlukan",nickname:"Nama samaran (6-16 aksara) *diperlukan",age:"Umur*pilihan",selectAge:"Pilih julat umur",country:"Negara/Wilayah*pilihan",city:"Bandar (pilihan)",interest:"Minat*pilihan",eventType:"Peristiwa Bersejarah**pilihan",whatToImprove:"Apa yang ingin diperbaiki*pilihan",uploadAvatar:"Muat naik gambar profil",male:"Lelaki",female:"Perempuan",genderRequired:"(*diperlukan)",register:"🚀 Daftar",registering:"Mendaftar...",errorAvatar:"Sila muat naik avatar.",errorGender:"Sila pilih jantina.",errorEmailFormat:"Format e-mel tidak sah.",errorPasswordFormat:"Kata laluan mesti sekurang-kurangnya 8 aksara dan mengandungi kedua-dua huruf dan nombor.",errorNicknameFormat:"Nama samaran mestilah 6-16 aksara.",errorAgeFormat:"Umur mestilah antara 18 dan 99.",errorCountry:"Sila pilih negara.",errorRegion:"Sila masukkan bandar.",errorInterest:"Sila pilih minat.",errorEventType:"Sila pilih jenis acara.",errorImprovement:"Sila pilih item untuk diperbaiki.",formTopSlogan:"Bukan salah untuk bangkit!",login:"Log masuk",terms:"Terma/Penyata",privacy:"Dasar Privasi",deletion:"Dasar Pemadaman Data",googleLogin:"Log masuk dengan Google",appleLogin:"Log masuk dengan Apple"},la:{heroLeftTop:"Redemptio non est crimen,",heroLeftMain:"modo errasse diu.",heroLeftSub:"",heroLeftYellow:"Flores feri fortiter efflorescunt!",heroRightTop:"Novum initium volo...",heroRightMain:"Omnis experientia unicum capitulum est,",heroRightSub:"non impedimentum incrementi.",heroRightYellow:"Resurge ex cineribus!",title:"Restarter™ Inscriptio",email:"Email *requiritur",password:"Password (min 8 chars, letter & number) *requiritur",nickname:"Nickname (6-16 chars) *requiritur",age:"Aetas*optio",selectAge:"Selecta aetatis spatium",country:"Patria (Regio)*optio",city:"Urbs (optio)",interest:"Studium*optio",eventType:"Eventus Historiae**optio",whatToImprove:"Quid emendare vis*optio",uploadAvatar:"Upload Avatar",male:"Male",female:"Female",genderRequired:"(*required)",register:"🚀 Register",registering:"Registering...",errorAvatar:"Please upload an avatar.",errorGender:"Please select a gender.",errorEmailFormat:"Invalid email format.",errorPasswordFormat:"Password must be at least 8 characters long and contain both letters and numbers.",errorNicknameFormat:"Nickname must be 6-16 characters long.",errorAgeFormat:"Age must be between 18 and 99.",errorCountry:"Please select a country.",errorRegion:"Please enter a city.",errorInterest:"Please select an interest.",errorEventType:"Please select an event type.",errorImprovement:"Please select an item to improve.",formTopSlogan:"Surgere non est peccatum!",login:"Inire",terms:"Termini/Declaratio",privacy:"Consilium Privacy",deletion:"Norma Deletionis Datae",googleLogin:"Intra cum Google",appleLogin:"Intra cum Apple"}},GS={"zh-TW":"請先補齊個人資料","zh-CN":"请先补齐个人资料",en:"Please complete your profile first",ja:"まずプロフィールを完成させてください",ko:"먼저 프로필을 완성해 주세요",th:"กรุณากรอกข้อมูลส่วนตัวให้ครบก่อน",vi:"Vui lòng hoàn thiện hồ sơ cá nhân trước",ms:"Sila lengkapkan profil anda terlebih dahulu",la:"Quaeso prius profile tuum comple"},KS={"zh-TW":"每一位更生人，都是世界的一員！","zh-CN":"每一位更生人，都是世界的一员！",en:"Every Restarter is still one of us.",ja:"すべての更生者は世界の一員です！",ko:"모든 Restarter는 우리 중 한 명입니다!",th:"ทุกคนที่ถูกกำพฤติกรรมก็ยังเป็นหนึ่งของเรา!",vi:"Mỗi người được định hình đều là một thành viên của chúng tôi!",ms:"Setiap Restarter masih satu di antara kita!",la:"Omnis Restarter adhuc unus ex nobis est."},RN={"zh-TW":"Restarter™ 是更生者的 副駕 / 合作人。","zh-CN":"Restarter™ 是更生者的 副驾 / 合作人。",en:"Restarter™ is a co-pilot/partner for Restarters.",ja:"Restarter™ は更生者の副操縦士・パートナーです。",ko:"Restarter™는 재생자의 부승무 또는 파트너입니다.",th:"Restarter™ เป็นคู่ควบคุมหรือพาร์ทเนอร์สำหรับ Restarters.",vi:"Restarter™ là phi công phụ hoặc đối tác cho Restarters.",ms:"Restarter™ adalah kopilot/pasukan untuk Restarters.",la:"Restarter™ est co-pilotus/socius pro Restarters."},EN={"zh-TW":"Restarter™ 是更生者的情緒管家 / 生產助手","zh-CN":"Restarter™ 是更生者的情绪管家 / 生产助手",en:"Restarter™ is an emotional steward/productivity assistant for Restarters.",ja:"Restarter™ は更生者の感情マネージャー・生産アシスタントです。",ko:"Restarter™는 재생자의 감정 관리자 및 생산 보조자입니다.",th:"Restarter™ เป็นผู้ดูแลอารมณ์และผู้ช่วยในการผลิตสำหรับ Restarters.",vi:"Restarter™ là người quản lý cảm xúc và người trợ giúp sản xuất cho Restarters.",ms:"Restarter™ adalah pengurus emosi / pembantu produktiviti untuk Restarters.",la:"Restarter™ est motus oeconomus/producentis adiutor pro Restarters."},PI={"zh-TW":["經濟","運動","閱讀","電影","旅遊","交友","唱歌","電商","做生意","電腦","AI","寵物","學技能","一個人安靜","其他"],"zh-CN":["经济","运动","阅读","电影","旅游","交友","唱歌","电商","做生意","电脑","AI","宠物","学技能","一个人安静","其他"],en:["Economy","Sports","Reading","Movie","Travel","Friendship","Singing","E-commerce","Business","Computer","AI","Pets","Learning Skills","Quiet time alone","Other"],ja:["経済","スポーツ","読書","映画","旅行","友達","カラオケ","EC","ビジネス","パソコン","AI","ペット","スキル学習","一人で静かに過ごす","その他"],ko:["경제","스포츠","독서","영화","여행","친구 사귀기","노래 부르기","전자상거래","사업","컴퓨터","AI","애완동물","기술 배우기","혼자 조용히 있기","기타"],th:["เศรษฐกิจ","กีฬา","การอ่าน","ภาพยนตร์","การเดินทาง","มิตรภาพ","การร้องเพลง","อีคอมเมิร์ซ","ธุรกิจ","คอมพิวเตอร์","AI","สัตว์เลี้ยง","การเรียนรู้ทักษะ","เวลาเงียบๆคนเดียว","อื่นๆ"],vi:["Kinh tế","Thể thao","Đọc sách","Phim ảnh","Du lịch","Tình bạn","Ca hát","Thương mại điện tử","Kinh doanh","Máy tính","AI","Thú cưng","Học kỹ năng","Ở một mình yên tĩnh","Khác"],ms:["Ekonomi","Sukan","Membaca","Filem","Melancong","Persahabatan","Menyanyi","E-dagang","Perniagaan","Komputer","AI","Haiwan Peliharaan","Belajar Kemahiran","Masa sunyi bersendirian","Lain-lain"],la:["Oeconomia","Ludi","Lectio","Pellicula","Iter","Amicitia","Cantus","E-commercium","Negotium","Computatrum","AI","Animalia Domestica","Discere Artes","Tempus quietum solus","Aliud"]},BI={"zh-TW":["台灣","中國大陸","日本","韓國","馬來西亞","新加坡","印尼","越南","菲律賓","英國","法國","德國","美國","加拿大","非洲","歐洲","南美洲","中東","其他"],"zh-CN":["台湾","中国大陆","日本","韩国","马来西亚","新加坡","印尼","越南","菲律宾","英国","法国","德国","美国","加拿大","非洲","欧洲","南美洲","中东","其他"],en:["Taiwan","China","Japan","Korea","Malaysia","Singapore","Indonesia","Vietnam","Philippines","UK","France","Germany","USA","Canada","Africa","Europe","South America","Middle East","Other"],ja:["台湾","中国","日本","韓国","マレーシア","シンガポール","インドネシア","ベトナム","フィリピン","イギリス","フランス","ドイツ","アメリカ","カナダ","アフリカ","ヨーロッパ","南アメリカ","中東","その他"],ko:["대만","중국","일본","한국","말레이시아","싱가포르","인도네시아","베트남","필리핀","영국","프랑스","독일","미국","캐나다","아프리카","유럽","남아메리카","중동","기타"],th:["ไต้หวัน","จีน","ญี่ปุ่น","เกาหลี","มาเลเซีย","สิงคโปร์","อินโดนีเซีย","เวียดนาม","ฟิลิปปินส์","สหราชอาณาจักร","ฝรั่งเศส","เยอรมนี","สหรัฐอเมริกา","แคนาดา","แอฟริกา","ยุโรป","อเมริกาใต้","ตะวันออกกลาง","อื่นๆ"],vi:["Đài Loan","Trung Quốc","Nhật Bản","Hàn Quốc","Malaysia","Singapore","Indonesia","Việt Nam","Philippines","Anh","Pháp","Đức","Mỹ","Canada","Châu Phi","Châu Âu","Nam Mỹ","Trung Đông","Khác"],ms:["Taiwan","China","Jepun","Korea","Malaysia","Singapura","Indonesia","Vietnam","Filipina","UK","Perancis","Jerman","AS","Kanada","Afrika","Eropah","Amerika Selatan","Timur Tengah","Lain-lain"],la:["Taivania","Sina","Iaponia","Corea","Malaisia","Singapura","Indonesia","Vietnamia","Philippinae","UK","Gallia","Germania","USA","Canada","Africa","Europa","America Meridionalis","Oriens Medius","Aliud"]},FI={"zh-TW":["經濟事件","毒品濫用","暴力事件","家暴加害","家暴受害","幫派背景","詐欺相關","竊盜前科","性別/身體創傷","未成年犯罪","長期失業 / 社會邊緣","其他"],"zh-CN":["经济事件","毒品滥用","暴力事件","家暴加害","家暴受害","帮派背景","诈欺相关","窃盗前科","性别/身体创伤","未成年犯罪","长期失业 / 社会边缘","其他"],en:["Economic Incident","Drug Abuse","Violent Incident","Domestic Violence Perpetrator","Domestic Violence Victim","Gang Affiliation","Fraud-related","Theft Record","Gender/Physical Trauma","Juvenile Delinquency","Long-term Unemployed / Socially Marginalized","Other"],ja:["経済事件","薬物乱用","暴力事件","DV加害","DV被害","ギャング組織所属","詐欺関連","窃盗前科","ジェンダー・身体的トラウマ","未成年犯罪","長期失業・社会的疎外","その他"],ko:["경제 사건","약물 남용","폭력 사건","가정 폭력 가해자","가정 폭력 피해자","조직 폭력배 배경","사기 관련","절도 전과","성별/신체적 트라우마","미성년 범죄","장기 실업/사회적 소외","기타"],th:["เหตุการณ์ทางเศรษฐกิจ","การใช้ยาเสพติด","เหตุการณ์รุนแรง","ผู้กระทำความรุนแรงในครอบครัว","เหยื่อความรุนแรงในครอบครัว","ประวัติแก๊ง","เกี่ยวข้องกับการฉ้อโกง","ประวัติการลักขโมย","การบาดเจ็บทางเพศ/ร่างกาย","การกระทำผิดของเยาวชน","ว่างงานระยะยาว / ถูกกีดกันทางสังคม","อื่นๆ"],vi:["Sự cố kinh tế","Lạm dụng ma túy","Vụ việc bạo lực","Thủ phạm bạo lực gia đình","Nạn nhân bạo lực gia đình","Lý lịch băng đảng","Liên quan đến gian lận","Tiền án trộm cắp","Tổn thương giới tính/thể chất","Phạm pháp vị thành niên","Thất nghiệp dài hạn / Bên lề xã hội","Khác"],ms:["Insiden Ekonomi","Penyalahgunaan Dadah","Insiden Keganasan","Pelaku Keganasan Rumah Tangga","Mangsa Keganasan Rumah Tangga","Latar Belakang Geng","Berkaitan Penipuan","Rekod Curi","Trauma Jantina/Fizikal","Kenakalan Remaja","Pengangguran Jangka Panjang / Terpinggir Sosial","Lain-lain"],la:["Casus Oeconomicus","Abusus Medicamentorum","Casus violentus","Perpetrator Violentiae Domesticae","Victima Violentiae Domesticae","Consociatio Gregis","Ad Fraudem Pertinens","Furtum Record","Trauma Genus/Corporale","Delinquentia Iuvenilis","Longum Tempus Inops / Socialiter Marginatus","Aliud"]},AN={"zh-TW":["人際","鬥志","習慣","工作","情緒","自律","其他"],"zh-CN":["人际","斗志","习惯","工作","情绪","自律","其他"],en:["Interpersonal","Motivation","Habits","Work","Emotions","Self-discipline","Other"],ja:["人間関係","闘志","習慣","仕事","感情","自己規律","その他"],ko:["대인관계","투지","습관","업무","감정","자기관리","기타"],th:["ความสัมพันธ์ระหว่างบุคคล","แรงจูงใจ","นิสัย","การงาน","อารมณ์","การมีวินัยในตนเอง","อื่นๆ"],vi:["Quan hệ giữa các cá nhân","Ý chí chiến đấu","Thói quen","Công việc","Cảm xúc","Kỷ luật tự giác","Khác"],ms:["Antara peribadi","Semangat juang","Tabiat","Kerja","Emosi","Disiplin diri","Lain-lain"],la:["Interpersonalis","Animus","Consuetudines","Opus","Affectus","Disciplina sui","Aliud"]},zI=["18-24","25-29","30-34","35-39","40-44","45-49","50-54","55-59","60-64","65-69","70+"];function PN(n){return/^[^@\s]+@[^@\s]+\.[^@\s]+$/.test(n)}function BN(n){return/^(?=.*[A-Za-z])(?=.*\d)[A-Za-z\d]{6,}$/.test(n)}function FN(n){return!(!n||n.trim()==="")}function QS(n){if(!n)return null;const e=n.match(/^(Restarter™)(.*)$/);return e?i.jsxs("span",{children:[i.jsx("span",{style:{color:"#fff",fontWeight:700},children:"Restarter™"}),i.jsx("span",{style:{color:"#ffd700",fontWeight:700},children:e[2]})]}):n}function zN({t:n,setShowLogin:e,navigate:t,setShowReset:r}){const[o,a]=v.useState(""),[c,d]=v.useState(""),[h,m]=v.useState(""),g=async x=>{x.preventDefault(),m("");try{await(await yj(ca,o,c)).user.reload(),e(!1),t("/")}catch(S){S.code==="auth/user-not-found"||S.code==="auth/wrong-password"||S.code==="auth/invalid-credential"?m("帳號或密碼錯誤，請重新確認"):S.code==="auth/user-disabled"?m("此帳號已被停用，請聯絡客服"):m(S.message||"登入失敗，請稍後再試")}};return i.jsx("div",{style:{position:"fixed",top:0,left:0,width:"100%",height:"100%",background:"rgba(0,0,0,0.6)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:200},children:i.jsxs("div",{style:{background:"white",padding:32,borderRadius:16,width:"90%",maxWidth:400,position:"relative",boxShadow:"0 8px 32px #0000004d"},children:[i.jsx("button",{onClick:()=>e(!1),style:{position:"absolute",top:8,right:12,background:"none",border:"none",fontSize:28,cursor:"pointer",color:"#888"},children:"×"}),i.jsx("h2",{style:{textAlign:"center",color:"#333",marginBottom:24},children:n.login}),h&&i.jsx("p",{style:{color:"red",textAlign:"center",marginBottom:"1rem"},children:h}),i.jsxs("form",{onSubmit:g,children:[i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:16},children:[i.jsx("input",{type:"email",autoComplete:"off",placeholder:n.email,value:o,onChange:x=>a(x.target.value),className:"reg-input",required:!0}),i.jsx("input",{type:"password",autoComplete:"off",placeholder:n.password,value:c,onChange:x=>d(x.target.value),className:"reg-input",required:!0})]}),i.jsx("button",{type:"submit",style:{width:"100%",marginTop:24,background:"linear-gradient(90deg, #6e8efb, #a777e3)",color:"white",border:"none",borderRadius:8,padding:"14px 0",fontSize:18,fontWeight:700,cursor:"pointer"},children:n.login}),i.jsx("div",{style:{textAlign:"right",marginTop:8},children:i.jsx("a",{href:"#",style:{color:"#6B5BFF",fontSize:14,textDecoration:"underline",cursor:"pointer"},onClick:x=>{x.preventDefault(),r(!0)},children:"忘記密碼？"})})]})]})})}const Ru={border:"none",borderRadius:28,padding:0,fontSize:16,fontWeight:800,cursor:"pointer",boxShadow:"0 2px 12px #a777e355",display:"flex",alignItems:"center",justifyContent:"center",gap:8,width:"100%",height:"40px"},YS={width:18,height:18,marginRight:6,verticalAlign:"middle"};function DN(){const n=Et(),e=pd(),t=new URLSearchParams(e.search),{lang:r,setLang:o}=Lt();v.useEffect(()=>{localStorage.setItem("lang",r)},[r]),v.useEffect(()=>{vc(async()=>{const{getAuth:W}=await Promise.resolve().then(()=>pS);return{getAuth:W}},void 0).then(({getAuth:W})=>{W().currentUser&&n("/")})},[n]),v.useEffect(()=>{(async()=>{var Y;try{const{getRedirectResult:ee}=await vc(async()=>{const{getRedirectResult:Te}=await Promise.resolve().then(()=>pS);return{getRedirectResult:Te}},void 0),ve=await ee(ca);if(ve){console.log("Redirect 登入成功，user.uid:",ve.user.uid),await ve.user.reload(),console.log("user reload 完成");const Te=await To(Pn(Wt,"users",ve.user.uid));console.log("Firestore 查詢結果:",{exists:Te.exists(),data:Te.data(),completed:(Y=Te.data())==null?void 0:Y.completed}),!Te.exists()||!Te.data()||!Te.data().completed?(console.log("導向 /CompleteProfile"),n("/CompleteProfile")):(console.log("導向首頁 /"),n("/"))}}catch(ee){console.error("處理 redirect 結果時發生錯誤:",ee)}})()},[n]);const a=t.get("needProfile")==="1",c=CN[r],[d,h]=v.useState(""),[m,g]=v.useState(""),[x,S]=v.useState(""),[j,T]=v.useState(""),[R,I]=v.useState(""),[F,P]=v.useState(""),[z,H]=v.useState(""),[J,O]=v.useState(null),[L,C]=v.useState(""),[A,D]=v.useState(""),[M,B]=v.useState(!1),[_,U]=v.useState(""),[oe,X]=v.useState(""),[ce,le]=v.useState(""),[te,xe]=v.useState(!1),[$,Q]=v.useState(0),[G,ne]=v.useState("idle"),[se,me]=v.useState(""),Ie=v.useRef(null),Pe=v.useRef(null);v.useEffect(()=>{if(!M)return;const W=setInterval(()=>{Q(Y=>(Y+1)%4)},400);return()=>clearInterval(W)},[M]);const[qe,Ge]=v.useState(!1),[be,ae]=v.useState(!1),[rt,Le]=v.useState(!1),[$e,fe]=v.useState(!1),[_e,Ce]=v.useState(""),[ze,De]=v.useState(!1),[K,ie]=v.useState(!1),q=async()=>{if(console.log("按鈕被點擊！驗證碼:",_e),!_e){D("請輸入驗證碼");return}console.log("前端發送驗證碼:",_e),console.log("前端發送 email:",d);try{const W={nickname:x,password:m,gender:z,country:j,region:R,age:F,interest:_,eventType:oe,improvement:ce},Y=await fetch(Qu("/email-verification/verify-code"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:d,code:_e})});console.log("驗證 API 回應狀態:",Y.status);const ee=await Y.json();console.log("驗證 API 回應資料:",ee),ee.success?await et():D(ee.error||"驗證失敗")}catch(W){D(W.message||"驗證失敗，請稍後再試")}},Me=async()=>{ie(!0),D("");try{const W={nickname:x,password:m,gender:z,country:j,region:R,age:F,interest:_,eventType:oe,improvement:ce};console.log("重發驗證碼到:",d);const ee=await(await fetch(Qu("/email-verification/send-code"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:d,registrationData:W})})).json();ee.success?(Ce(""),D("已重新發送驗證碼，請輸入新的驗證碼"),fe(!0),ae(!1)):D(ee.error||"重發驗證碼失敗")}catch(W){console.error("重發驗證碼錯誤:",W),D("重發驗證碼失敗，請稍後再試")}finally{ie(!1)}},st=async W=>{W.preventDefault(),D(""),Ge(!1);let Y=setTimeout(()=>Ge(!0),1500);try{if(!J){D(c.errorAvatar);return}if(!z){D(c.errorGender);return}if(!PN(d)){D(c.errorEmailFormat);return}if(!BN(m)){D(c.errorPasswordFormat);return}if(!FN(x)){D(c.errorNicknameFormat);return}if(!F){D(c.errorAgeFormat);return}if(!j){D(c.errorCountry);return}Le(!0);const ee={nickname:x,password:m,gender:z,country:j,region:R,age:F,interest:_,eventType:oe,improvement:ce};console.log("正在發送 email 驗證碼到:",d);const ve=await fetch(Qu("/email-verification/send-code"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:d,registrationData:ee})});console.log("Email API 回應狀態:",ve.status);const Te=await ve.json();if(console.log("Email API 回應資料:",Te),Te.success)De(!0),fe(!0),ae(!1),Ce(""),Le(!1),clearTimeout(Y),Ge(!1),D("");else throw new Error(Te.error||"生成驗證碼失敗")}catch(ee){console.error("註冊錯誤:",ee),D(ee.message||"註冊失敗，請稍後再試"),Le(!1),clearTimeout(Y),Ge(!1)}},et=async()=>{var Y,ee,ve;B(!0);let W=setTimeout(()=>Ge(!0),1500);try{const Te=await P0(ca,d,m);await df(Te.user,{displayName:x});let Je="";if(J){const He=RD(zD,`avatars/${Te.user.uid}/${J.name}`),Ye=ID(He,J);let gt=null;await Promise.race([new Promise((mt,_t)=>{Ye.on("state_changed",null,xn=>{gt=xn,_t(xn)},async()=>{Je=await CD(Ye.snapshot.ref),mt()})}),new Promise((mt,_t)=>setTimeout(()=>{gt=new Error("頭像上傳逾時，請檢查網路或稍後再試"),_t(gt)},1e4))]).catch(mt=>{throw gt||mt}),await df(Te.user,{photoURL:Je})}await Bd(Pn(Wt,"profiles",Te.user.uid),{nickname:x,email:d,avatar:Je,gender:z,country:j,region:R,age:F,interest:_,eventType:oe,improvement:ce,createdAt:new Date,updatedAt:new Date}),localStorage.removeItem("aiAvatar"),localStorage.removeItem("avatarWelcomed"),B(!1),clearTimeout(W),Ge(!1),n("/")}catch(Te){(Y=Te==null?void 0:Te.message)!=null&&Y.includes("Failed to fetch")||(ee=Te==null?void 0:Te.message)!=null&&ee.includes("NetworkError")||(ve=Te==null?void 0:Te.message)!=null&&ve.includes("ECONNREFUSED")?D("伺服器連線失敗，請稍後再試或聯絡管理員"):D((Te==null?void 0:Te.message)||"註冊失敗，請稍後再試"),B(!1),clearTimeout(W),Ge(!1)}},dt=async()=>{const W=new Di;try{console.log("開始 Google 登入..."),B(!0),Ge(!1);let Y=setTimeout(()=>Ge(!0),1500);const ee=window.innerWidth<=768;console.log("是否為手機版:",ee);let ve;if(ee)ve=await Ep(ca,W);else{ve=await Ep(ca,W),clearTimeout(Y),Ge(!1),B(!1),n("/");return}clearTimeout(Y),Ge(!1),B(!1),console.log("Google 登入成功，user.uid:",ve.user.uid),n("/")}catch(Y){B(!1),Ge(!1),console.error("Google 登入錯誤:",Y);let ee="Google 登入失敗："+Y.message;Y.code==="auth/popup-closed-by-user"?ee="登入視窗被關閉，請重新嘗試":Y.code==="auth/popup-blocked"?ee="登入視窗被瀏覽器阻擋，請允許彈出視窗後重新嘗試":Y.code==="auth/network-request-failed"?ee="網路連線失敗，請檢查網路後重新嘗試":Y.code==="auth/too-many-requests"&&(ee="登入嘗試過於頻繁，請稍後再試"),console.log("Google 登入錯誤代碼:",Y.code),console.log("Google 登入錯誤訊息:",ee),alert(ee)}},Ht=async()=>{var Y;const W=new Ql("apple.com");try{console.log("開始 Apple 登入...");const ve=(await Ep(ca,W)).user;console.log("Apple 登入成功，user.uid:",ve.uid),await ve.reload(),console.log("user reload 完成");const Te=await To(Pn(Wt,"users",ve.uid));console.log("Firestore 查詢結果:",{exists:Te.exists(),data:Te.data(),completed:(Y=Te.data())==null?void 0:Y.completed}),!Te.exists()||!Te.data()||!Te.data().completed?(console.log("導向 /CompleteProfile"),n("/CompleteProfile")):(console.log("導向首頁 /"),n("/"))}catch(ee){console.error("Apple 登入錯誤:",ee);let ve="Apple 登入失敗："+ee.message;ee.code==="auth/popup-closed-by-user"?ve="登入視窗被關閉，請重新嘗試":ee.code==="auth/popup-blocked"?ve="登入視窗被瀏覽器阻擋，請允許彈出視窗後重新嘗試":ee.code==="auth/network-request-failed"?ve="網路連線失敗，請檢查網路後重新嘗試":ee.code==="auth/too-many-requests"&&(ve="登入嘗試過於頻繁，請稍後再試"),console.log("Apple 登入錯誤代碼:",ee.code),console.log("Apple 登入錯誤訊息:",ve),alert(ve)}};async function je(){var Y,ee;if(!((ee=(Y=Ie.current)==null?void 0:Y.value)==null?void 0:ee.trim())){ne("invalid"),me("請輸入暱稱"),setTimeout(()=>{var ve;(ve=Ie.current)==null||ve.focus()},100);return}ne("ok"),me("你的名稱非常好👍"),setTimeout(()=>{var ve;(ve=Pe.current)==null||ve.focus()},200)}e.pathname;const[Qe,Tt]=v.useState(!1),[vt,Bt]=v.useState(""),[Dt,ke]=v.useState("");return i.jsxs("div",{style:{minHeight:"100vh",background:"#fff",position:"relative"},children:[a&&i.jsx("div",{style:{position:"absolute",top:"40%",left:"50%",transform:"translate(-50%, -50%)",fontSize:22,color:"#374151",fontWeight:600,textAlign:"center"},children:GS[r]||GS["zh-TW"]}),i.jsx("div",{style:{position:"relative"},children:i.jsxs("div",{style:{minHeight:"100vh",background:"url('/city-blur.jpg') center/cover no-repeat",position:"relative",display:"flex",flexDirection:"column"},children:[window.innerWidth<=768?i.jsxs(i.Fragment,{children:[i.jsxs("button",{onClick:()=>window.history.back(),style:{position:"fixed",top:16,left:16,zIndex:1e3,background:"rgba(255,255,255,0.9)",border:"none",borderRadius:"20px",padding:"8px 16px",fontSize:"14px",fontWeight:"bold",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",color:"#667eea",transition:"all 0.3s ease",boxShadow:"0 2px 8px rgba(0,0,0,0.15)",height:"36px"},onMouseEnter:W=>{W.currentTarget.style.background="#667eea",W.currentTarget.style.color="#fff",W.currentTarget.style.transform="translateY(-1px)"},onMouseLeave:W=>{W.currentTarget.style.background="rgba(255,255,255,0.9)",W.currentTarget.style.color="#667eea",W.currentTarget.style.transform="translateY(0)"},children:["← ",r==="zh-TW"||r==="zh-CN"?"返回":r==="en"?"Back":r==="ja"?"戻る":r==="ko"?"돌아가기":r==="vi"?"Quay Lại":r==="th"?"กลับ":r==="la"?"Regredi":r==="ms"?"Kembali":"Back"]}),i.jsx("div",{style:{position:"fixed",top:16,right:16,zIndex:100},children:i.jsx($n,{})}),i.jsx("div",{style:{position:"fixed",top:60,left:"50%",transform:"translateX(-50%)",zIndex:100},children:i.jsx("span",{style:{fontWeight:900,fontSize:18,color:"#ffd700",letterSpacing:1,textShadow:"0 2px 8px #23294688",whiteSpace:"nowrap",textAlign:"left",lineHeight:"1.2",marginLeft:"8px"},children:KS[r]})})]}):i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:()=>window.history.back(),style:{position:"fixed",top:24,left:24,zIndex:1e3,background:"rgba(255,255,255,0.9)",border:"none",borderRadius:"25px",padding:"8px 16px",fontSize:"14px",fontWeight:"bold",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",color:"#667eea",transition:"all 0.3s ease",boxShadow:"0 4px 12px rgba(0,0,0,0.15)"},onMouseEnter:W=>{W.currentTarget.style.background="#667eea",W.currentTarget.style.color="#fff",W.currentTarget.style.transform="translateY(-2px)"},onMouseLeave:W=>{W.currentTarget.style.background="rgba(255,255,255,0.9)",W.currentTarget.style.color="#667eea",W.currentTarget.style.transform="translateY(0)"},children:r==="zh-TW"||r==="zh-CN"?"返回":r==="en"?"Back":r==="ja"?"戻る":r==="ko"?"돌아가기":r==="vi"?"Quay Lại":r==="th"?"กลับ":r==="la"?"Regredi":r==="ms"?"Kembali":"Back"}),i.jsx("div",{style:{position:"fixed",top:24,left:"50%",transform:"translateX(-50%)",zIndex:100},children:i.jsx("span",{style:{fontWeight:900,fontSize:24,color:"#ffd700",letterSpacing:2,textShadow:"0 2px 8px #23294688",whiteSpace:"nowrap",textAlign:"left",marginLeft:"12px"},children:KS[r]})}),i.jsx("div",{style:{position:"fixed",top:24,right:24,zIndex:100},children:i.jsx($n,{style:{background:"rgba(255,255,255,0.9)",border:"none",borderRadius:"25px",padding:"8px 16px",fontSize:"14px",fontWeight:"bold",color:"#667eea",transition:"all 0.3s ease",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",width:"fit-content",minWidth:"auto",maxWidth:"fit-content"}})})]}),i.jsxs("div",{style:{display:"flex",flex:1,minHeight:"100vh",alignItems:"stretch",justifyContent:"center",width:"100%",marginTop:60,flexDirection:window.innerWidth<=768?"column":"row"},children:[i.jsxs("div",{style:{flex:1,display:window.innerWidth<=768?"none":"flex",flexDirection:"column",alignItems:"center",background:"rgba(60,40,20,0.18)",padding:"0 12px",minHeight:"calc(100vh - 60px)",boxSizing:"border-box",justifyContent:"space-between"},children:[i.jsx("div",{style:{position:"relative",width:"100%",textAlign:"center",paddingTop:78},children:i.jsx("div",{style:{fontSize:18,fontWeight:700,textShadow:"0 2px 8px #23294688"},children:QS(RN[r])})}),i.jsx("img",{src:"/left-hero.png",alt:"left hero",style:{width:300,maxWidth:"98%",objectFit:"contain"}}),i.jsxs("div",{style:{paddingBottom:80,textAlign:"center"},children:[i.jsxs("div",{style:{color:"#fff",fontWeight:700,fontSize:22,margin:"12px 0 8px"},children:[c.heroLeftTop,i.jsx("br",{}),c.heroLeftMain,i.jsx("br",{}),c.heroLeftSub]}),i.jsx("div",{style:{color:"#ffd700",fontWeight:700,fontSize:18},children:c.heroLeftYellow})]})]}),te&&i.jsx(zN,{t:c,setShowLogin:xe,navigate:n,setShowReset:Tt}),i.jsx("div",{style:{flex:window.innerWidth<=768?"1":"0 1 500px",display:"flex",justifyContent:"center",alignItems:"center",padding:window.innerWidth<=768?"10px":"20px 0",width:window.innerWidth<=768?"100%":"auto"},children:i.jsxs("form",{onSubmit:st,style:{background:"#ffffffcc",borderRadius:20,padding:window.innerWidth<=768?"20px 16px":"24px 32px",width:"100%",maxWidth:window.innerWidth<=768?"100%":500,boxShadow:"0 8px 32px #0000004d",position:"relative",boxSizing:"border-box",margin:window.innerWidth<=768?"0 10px":"0"},children:[i.jsx("img",{src:"/ctx-logo.png",alt:"Logo",style:{width:window.innerWidth<=768?60:100,height:window.innerWidth<=768?60:100,position:"absolute",top:5,left:5,zIndex:0,opacity:1}}),i.jsxs("div",{style:{position:"relative",zIndex:1},children:[i.jsx("div",{style:{width:"100%",textAlign:"center",fontWeight:900,fontSize:window.innerWidth<=768?20:26,color:"#ffd700",marginBottom:8,textShadow:"0 2px 4px #00000055"},children:c.formTopSlogan}),i.jsx("h2",{style:{textAlign:"center",color:"#333",marginBottom:16,fontSize:window.innerWidth<=768?24:28,fontWeight:800},children:c.title}),A&&i.jsx("p",{style:{color:"red",textAlign:"center",marginBottom:"1rem"},children:A}),$e&&i.jsxs("div",{style:{background:"linear-gradient(135deg, #3b82f6, #1d4ed8)",color:"white",padding:"16px",borderRadius:"12px",marginBottom:"1rem",textAlign:"center",boxShadow:"0 4px 12px rgba(59, 130, 246, 0.3)"},children:[i.jsx("div",{style:{fontSize:"20px",marginBottom:"8px"},children:"📧"}),i.jsx("div",{style:{fontWeight:"bold",marginBottom:"8px"},children:"請輸入驗證碼"}),i.jsxs("div",{style:{fontSize:"14px",marginBottom:"12px"},children:["驗證碼已發送到 ",d]}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"8px",alignItems:"center"},children:[i.jsxs("div",{style:{display:"flex",gap:"8px",alignItems:"center"},children:[i.jsx("input",{type:"text",value:_e,onChange:W=>Ce(W.target.value),placeholder:"請輸入 6 位數驗證碼",style:{width:"150px",padding:"8px 12px",borderRadius:"6px",border:"none",fontSize:"16px",textAlign:"center"},maxLength:6}),i.jsx("button",{type:"button",onClick:q,disabled:!_e||_e.length!==6,style:{background:_e&&_e.length===6?"#10b981":"#6b7280",color:"white",border:"none",padding:"8px 16px",borderRadius:"6px",fontSize:"14px",fontWeight:"bold",cursor:_e&&_e.length===6?"pointer":"not-allowed",transition:"all 0.2s ease",transform:(_e&&_e.length===6,"scale(1)"),boxShadow:_e&&_e.length===6?"0 2px 8px rgba(16, 185, 129, 0.3)":"none"},onMouseEnter:W=>{_e&&_e.length===6&&(W.currentTarget.style.background="#059669",W.currentTarget.style.transform="scale(1.05)",W.currentTarget.style.boxShadow="0 4px 12px rgba(16, 185, 129, 0.4)")},onMouseLeave:W=>{_e&&_e.length===6&&(W.currentTarget.style.background="#10b981",W.currentTarget.style.transform="scale(1)",W.currentTarget.style.boxShadow="0 2px 8px rgba(16, 185, 129, 0.3)")},onMouseDown:W=>{_e&&_e.length===6&&(W.currentTarget.style.transform="scale(0.95)")},onMouseUp:W=>{_e&&_e.length===6&&(W.currentTarget.style.transform="scale(1.05)")},children:"驗證並註冊"})]}),i.jsx("button",{type:"button",onClick:Me,disabled:K,style:{background:K?"#6b7280":"#3b82f6",color:"white",border:"none",padding:"6px 12px",borderRadius:"6px",fontSize:"12px",fontWeight:"bold",cursor:K?"not-allowed":"pointer",transition:"all 0.2s ease",transform:"scale(1)",boxShadow:K?"none":"0 2px 8px rgba(59, 130, 246, 0.3)"},onMouseEnter:W=>{K||(W.currentTarget.style.background="#2563eb",W.currentTarget.style.transform="scale(1.05)",W.currentTarget.style.boxShadow="0 4px 12px rgba(59, 130, 246, 0.4)")},onMouseLeave:W=>{K||(W.currentTarget.style.background="#3b82f6",W.currentTarget.style.transform="scale(1)",W.currentTarget.style.boxShadow="0 2px 8px rgba(59, 130, 246, 0.3)")},onMouseDown:W=>{K||(W.currentTarget.style.transform="scale(0.95)")},onMouseUp:W=>{K||(W.currentTarget.style.transform="scale(1.05)")},children:K?"重發中...":"重發驗證碼"})]})]}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"12px",width:"100%",minWidth:0},children:[i.jsx("input",{type:"text",style:{display:"none"},autoComplete:"username"}),i.jsx("input",{type:"password",style:{display:"none"},autoComplete:"current-password"}),i.jsx("input",{type:"email",autoComplete:"new-password",placeholder:c.email,value:d,onChange:W=>h(W.target.value),style:{gridColumn:"1 / -1",width:"100%",minWidth:0,maxWidth:"100%",boxSizing:"border-box",overflow:"hidden"},className:"reg-input",required:!0}),i.jsx("input",{type:"password",autoComplete:"new-password",placeholder:c.password,value:m,onChange:W=>g(W.target.value),style:{gridColumn:"1 / -1",width:"100%",minWidth:0,maxWidth:"100%",boxSizing:"border-box",overflow:"hidden"},className:"reg-input",required:!0}),i.jsx("input",{type:"text",autoComplete:"off",placeholder:c.nickname,value:x,onChange:W=>{S(W.target.value),ne("idle"),me("")},onBlur:je,className:"reg-input",style:{width:"100%",minWidth:0,maxWidth:"100%",boxSizing:"border-box",overflow:"hidden",color:"#888"},required:!0,ref:Ie}),se&&i.jsx("div",{style:{gridColumn:"1 / -1",color:G==="ok"?"#1a7f1a":G==="invalid"||G==="exists"?"red":"#333",fontSize:14,marginTop:-8,marginBottom:4},children:se}),i.jsxs("select",{value:F,onChange:W=>P(W.target.value),className:"reg-input",style:{width:"100%",minWidth:0,maxWidth:"100%",boxSizing:"border-box",overflow:"hidden",color:F?"#333":"#888"},required:!0,children:[i.jsx("option",{value:"",style:{color:"#888"},children:c.selectAge}),zI.map(W=>i.jsx("option",{value:W,children:W},W))]}),i.jsxs("select",{value:j,onChange:W=>T(W.target.value),className:"reg-input",style:{width:"100%",minWidth:0,maxWidth:"100%",boxSizing:"border-box",overflow:"hidden",color:j?"#333":"#888"},required:!0,children:[i.jsx("option",{value:"",style:{color:"#888"},children:c.country}),(BI[r]||[]).map(W=>i.jsx("option",{value:W,children:W},W))]}),i.jsx("input",{type:"text",placeholder:c.city,value:R,onChange:W=>I(W.target.value),className:"reg-input",style:{width:"100%",minWidth:0,maxWidth:"100%",boxSizing:"border-box",overflow:"hidden"}}),i.jsxs("select",{value:_,onChange:W=>U(W.target.value),className:"reg-input",style:{width:"100%",minWidth:0,maxWidth:"100%",boxSizing:"border-box",overflow:"hidden",color:_?"#333":"#888"},children:[i.jsx("option",{value:"",style:{color:"#888"},children:c.interest}),(PI[r]||[]).map(W=>i.jsx("option",{value:W,children:W},W))]}),i.jsxs("select",{value:oe,onChange:W=>X(W.target.value),className:"reg-input",style:{width:"100%",minWidth:0,maxWidth:"100%",boxSizing:"border-box",overflow:"hidden",color:oe?"#333":"#888"},children:[i.jsx("option",{value:"",style:{color:"#888"},children:c.eventType}),(FI[r]||[]).map(W=>i.jsx("option",{value:W,children:W},W))]}),i.jsxs("select",{value:ce,onChange:W=>le(W.target.value),className:"reg-input",style:{gridColumn:"1 / -1",width:"100%",minWidth:0,maxWidth:"100%",boxSizing:"border-box",overflow:"hidden",color:ce?"#333":"#888"},children:[i.jsx("option",{value:"",style:{color:"#888"},children:c.whatToImprove}),(AN[r]||[]).map(W=>i.jsx("option",{value:W,children:W},W))]}),i.jsx("div",{style:{gridColumn:"1 / -1",display:"flex",flexDirection:"column",alignItems:"center",marginBottom:8},children:i.jsxs("label",{htmlFor:"avatar-upload",style:{cursor:"pointer",display:"flex",flexDirection:"column",alignItems:"center",gap:4},children:[i.jsx("div",{style:{width:64,height:64,borderRadius:"50%",overflow:"hidden",background:"#eee",border:"2px solid #b6b6f6",marginBottom:4},children:L?i.jsx("img",{src:L,alt:"avatar",style:{width:"100%",height:"100%",objectFit:"cover"}}):i.jsx("span",{style:{display:"flex",width:"100%",height:"100%",alignItems:"center",justifyContent:"center",color:"#bbb",fontSize:32},children:"+"})}),i.jsx("span",{style:{color:"#6B5BFF",fontWeight:700,fontSize:15},children:c.uploadAvatar}),i.jsx("input",{id:"avatar-upload",type:"file",accept:"image/*",style:{display:"none"},onChange:W=>{if(W.target.files&&W.target.files[0]){O(W.target.files[0]);const Y=new FileReader;Y.onload=ee=>{var ve;return C((ve=ee.target)==null?void 0:ve.result)},Y.readAsDataURL(W.target.files[0])}}})]})}),i.jsxs("div",{style:{gridColumn:"1 / -1",display:"flex",alignItems:"center",gap:18,justifyContent:"center",marginBottom:8},children:[i.jsx("span",{style:{fontWeight:600,color:"#6B5BFF",fontSize:15},children:c.genderRequired}),i.jsxs("label",{style:{display:"flex",alignItems:"center",gap:4},children:[i.jsx("input",{type:"radio",name:"gender",value:"male",checked:z==="male",onChange:()=>H("male"),required:!0}),i.jsx("span",{children:c.male})]}),i.jsxs("label",{style:{display:"flex",alignItems:"center",gap:4},children:[i.jsx("input",{type:"radio",name:"gender",value:"female",checked:z==="female",onChange:()=>H("female"),required:!0}),i.jsx("span",{children:c.female})]})]})]}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:window.innerWidth<=768?"1fr":"1fr 1fr",gap:8,margin:"16px 0 8px 0"},children:[be?i.jsxs("div",{style:{gridColumn:"1 / -1",display:"flex",flexDirection:"column",gap:"12px",alignItems:"center"},children:[i.jsxs("div",{style:{textAlign:"center",marginBottom:"8px"},children:[i.jsx("p",{style:{color:"#6B5BFF",fontWeight:600,marginBottom:"4px"},children:"📧 確認郵件已發送到您的 email"}),i.jsx("p",{style:{color:"#666",fontSize:"14px"},children:"請檢查您的收件匣並點擊確認連結完成註冊"})]}),i.jsxs("div",{style:{background:"#f8f9ff",padding:"16px",borderRadius:"8px",border:"1px solid #e0e7ff",textAlign:"center"},children:[i.jsx("p",{style:{color:"#6B5BFF",fontWeight:600,marginBottom:"8px"},children:"📬 請查看您的 email"}),i.jsxs("p",{style:{color:"#666",fontSize:"14px",marginBottom:"12px"},children:["我們已發送確認郵件到：",i.jsx("strong",{children:d})]}),i.jsx("p",{style:{color:"#666",fontSize:"12px"},children:"點擊郵件中的「✅ 確認註冊」按鈕即可完成註冊"})]}),i.jsx("button",{type:"button",onClick:()=>{ae(!1),D("")},style:{...Ru,background:"#f5f5f5",color:"#666",border:"1px solid #ddd",width:"120px"},children:"🔄 重新發送"})]}):i.jsxs("button",{type:"submit",disabled:M||rt,style:{...Ru,background:"linear-gradient(90deg, #6e8efb, #a777e3)",color:"white",opacity:M||rt?.6:1,cursor:M||rt?"not-allowed":"pointer"},children:[M?i.jsxs("span",{style:{display:"flex",alignItems:"center",justifyContent:"center",fontWeight:700,fontSize:18},children:[c.registering,".".repeat($+1)]}):rt?i.jsx("span",{style:{display:"flex",alignItems:"center",justifyContent:"center",fontWeight:700,fontSize:18},children:"註冊中..."}):i.jsx("span",{style:{marginRight:10},children:"🚀"}),!M&&!rt&&c.register]}),i.jsxs("button",{type:"button",onClick:()=>xe(!0),disabled:M,style:{...Ru,background:"linear-gradient(90deg, #89f7fe, #66a6ff)",color:"white",opacity:M?.6:1,cursor:M?"not-allowed":"pointer"},children:[i.jsx("span",{style:{marginRight:10},children:"🔑"}),c.login]}),i.jsxs("button",{type:"button",onClick:dt,disabled:M,style:{...Ru,background:"#fff",color:"#333",opacity:M?.6:1,cursor:M?"not-allowed":"pointer"},children:[i.jsx("img",{src:"https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg",alt:"Google",style:YS}),c.googleLogin]}),i.jsxs("button",{type:"button",onClick:Ht,disabled:M,style:{...Ru,background:"#000",color:"#fff",opacity:M?.6:1,cursor:M?"not-allowed":"pointer"},children:[i.jsx("img",{src:"https://upload.wikimedia.org/wikipedia/commons/f/fa/Apple_logo_black.svg",alt:"Apple",style:{...YS,filter:"invert(1)"}}),c.appleLogin]})]}),i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:24,gap:8,flexDirection:"row",textAlign:"center",fontSize:12,flexWrap:"nowrap",overflow:"hidden"},children:[i.jsx("a",{href:"/privacy-policy",style:{color:"#6B5BFF",textDecoration:"underline",fontSize:12,flex:1,textAlign:"center",whiteSpace:"nowrap"},children:c.privacy||"隱私權政策"}),i.jsx("span",{style:{color:"#666",fontSize:12},children:"/"}),i.jsx("button",{type:"button",onClick:()=>n("/terms"),style:{background:"none",border:"none",color:"#666",textDecoration:"underline",cursor:"pointer",fontSize:12,flex:1,textAlign:"center",whiteSpace:"nowrap"},children:c.terms}),i.jsx("span",{style:{color:"#666",fontSize:12},children:"/"}),i.jsx("a",{href:"/data-deletion",style:{color:"#6B5BFF",textDecoration:"underline",fontSize:12,flex:1,textAlign:"center",whiteSpace:"nowrap"},children:c.deletion||"資料刪除說明"})]})]})]})}),i.jsxs("div",{style:{flex:1,display:window.innerWidth<=768?"none":"flex",flexDirection:"column",alignItems:"center",background:"rgba(60,40,20,0.18)",padding:"0 12px",minHeight:"calc(100vh - 60px)",boxSizing:"border-box",justifyContent:"space-between"},children:[i.jsx("div",{style:{position:"relative",width:"100%",textAlign:"center",paddingTop:78},children:i.jsx("div",{style:{fontSize:18,fontWeight:700,textShadow:"0 2px 8px #23294688"},children:QS(EN[r])})}),i.jsx("img",{src:"/right-hero.png",alt:"right hero",style:{width:280,maxWidth:"98%",objectFit:"contain"}}),i.jsxs("div",{style:{paddingBottom:80,textAlign:"center"},children:[i.jsx("div",{style:{color:"#fff",fontWeight:700,fontSize:22,margin:"12px 0 8px"},children:c.heroRightMain}),i.jsx("div",{style:{color:"#ffd700",fontWeight:700,fontSize:18},children:c.heroRightYellow})]})]})]}),i.jsx("div",{style:{position:"fixed",bottom:10,left:36,color:"#fff",textShadow:"0 1px 2px #000",fontSize:14,zIndex:10},children:"CTX Goodlife Copyright 2025"})]})}),Qe&&i.jsx("div",{style:{position:"fixed",left:0,top:0,width:"100vw",height:"100vh",background:"rgba(40,40,80,0.18)",zIndex:1e4,display:"flex",alignItems:"center",justifyContent:"center"},children:i.jsxs("div",{style:{background:"#fff",borderRadius:18,boxShadow:"0 4px 24px #6B5BFF33",padding:28,minWidth:280,maxWidth:340,width:"90vw",position:"relative",display:"flex",flexDirection:"column",gap:12},children:[i.jsx("button",{type:"button",onClick:()=>Tt(!1),style:{position:"absolute",top:10,right:12,background:"none",border:"none",fontSize:22,color:"#888",cursor:"pointer",fontWeight:700},children:"×"}),i.jsx("div",{style:{fontWeight:800,fontSize:18,color:"#6B5BFF",textAlign:"center",marginBottom:2},children:"重設密碼"}),i.jsx("input",{type:"email",value:vt,onChange:W=>Bt(W.target.value),placeholder:"請輸入註冊時的 email",style:{border:"1px solid #e0e7ff",borderRadius:8,padding:"6px 10px",fontSize:15}}),i.jsx("button",{onClick:async()=>{ke("");try{await gj(ca,vt),ke("已寄出密碼重設信，請到信箱收信！")}catch{ke("發送失敗，請確認 email 是否正確")}},style:{background:"linear-gradient(90deg, #6e8efb, #a777e3)",color:"#fff",border:"none",borderRadius:14,padding:"6px 18px",fontWeight:700,fontSize:15,cursor:"pointer",alignSelf:"center"},children:"發送重設信"}),Dt&&i.jsx("div",{style:{color:"#6B5BFF",fontWeight:700,textAlign:"center",marginTop:8},children:Dt})]})}),qe&&i.jsx("div",{style:{color:"#ff9800",textAlign:"center",marginTop:8,fontWeight:600},children:"網路較慢，請耐心等候..."})]})}const Eu={"zh-TW":{back:"← 返回上一頁",title:"我的連結",chat:"進入聊天",task:"共修任務",noLink:"目前沒有已建立的連結",goal:"目標："},"zh-CN":{back:"← 返回上一页",title:"我的连接",chat:"进入聊天",task:"共修任务",noLink:"目前没有已建立的连接",goal:"目标："},en:{back:"← Back",title:"My Links",chat:"Chat",task:"Co-Task",noLink:"No links established",goal:"Goal: "},ja:{back:"← 前のページへ",title:"私のリンク",chat:"チャットへ",task:"共修タスク",noLink:"まだリンクがありません",goal:"目標："},ko:{back:"← 이전 페이지",title:"내 링크",chat:"채팅하기",task:"공동 작업",noLink:"아직 연결된 링크가 없습니다",goal:"목표: "},th:{back:"← กลับ",title:"ลิงก์ของฉัน",chat:"แชท",task:"งานร่วมกัน",noLink:"ยังไม่มีลิงก์ที่สร้างขึ้น",goal:"เป้าหมาย: "},vi:{back:"← Quay lại",title:"Liên kết của tôi",chat:"Trò chuyện",task:"Nhiệm vụ chung",noLink:"Chưa có liên kết nào",goal:"Mục tiêu: "},ms:{back:"← Kembali",title:"Pautan Saya",chat:"Sembang",task:"Tugas Bersama",noLink:"Belum ada pautan yang dibuat",goal:"Matlamat: "},la:{back:"← Redire",title:"Nexus Mei",chat:"Colloquium",task:"Munus Commune",noLink:"Nullae nexus constitutae",goal:"Propositum: "}},NN={"zh-TW":{connected:"已配對",pending:"等待對方回覆",rejected:"已拒絕"},"zh-CN":{connected:"已配对",pending:"等待对方回复",rejected:"已拒绝"},en:{connected:"Connected",pending:"Pending",rejected:"Rejected"},ja:{connected:"マッチ済み",pending:"返事待ち",rejected:"拒否されました"},ko:{connected:"연결됨",pending:"대기 중",rejected:"거절됨"},th:{connected:"เชื่อมต่อแล้ว",pending:"รอการตอบกลับ",rejected:"ถูกปฏิเสธ"},vi:{connected:"Đã kết nối",pending:"Đang chờ",rejected:"Đã bị từ chối"},ms:{connected:"Telah dihubungkan",pending:"Menunggu",rejected:"Ditolak"},la:{connected:"Coniunctus",pending:"Exspectans",rejected:"Reiectus"}},mp={"zh-TW":"解除連結","zh-CN":"解除连接",en:"Remove",ja:"リンク解除",ko:"연결 해제",th:"ยกเลิกการเชื่อมต่อ",vi:"Hủy liên kết",ms:"Buang Pautan",la:"Remove"},gp={"zh-TW":"取消邀請","zh-CN":"取消邀请",en:"Cancel Invite",ja:"招待をキャンセル",ko:"초대 취소",th:"ยกเลิกคำเชิญ",vi:"Hủy lời mời",ms:"Batal Jemputan",la:"Invitationem Remove"};function ox(n){const e=Et(),{lang:t,setLang:r}=Lt(),[o,a]=v.useState([]),[c,d]=v.useState(null),[h,m]=v.useState(!0),[g,x]=v.useState(null),[S,j]=v.useState(null),T=t;v.useEffect(()=>{const P=Ns(ga,async z=>{z?(d(z),await R(z.uid)):e("/")});return()=>P()},[e]);const R=async P=>{try{m(!0);const z=En(Wt,"links"),H=mr(z,An("user1Id","==",P)),J=mr(z,An("user2Id","==",P)),[O,L]=await Promise.all([Vr(H),Vr(J)]),C=[];O.forEach(A=>{const D=A.data();C.push({id:A.id,...D})}),L.forEach(A=>{const D=A.data();C.push({id:A.id,user1Id:D.user2Id,user1Name:D.user2Name,user2Id:D.user1Id,user2Name:D.user1Name,role:D.role,goal:D.goal,status:D.status,createdAt:D.createdAt})}),a(C),m(!1)}catch(z){console.error("Error loading links:",z),m(!1)}},I=async P=>{try{await rf(Pn(Wt,"links",P)),x(null),alert(mp[T]+" 成功！")}catch(z){console.error("Error removing link:",z),alert("操作失敗")}},F=async P=>{try{await rf(Pn(Wt,"links",P)),j(null),alert(gp[T]+" 成功！")}catch(z){console.error("Error canceling link:",z),alert("操作失敗")}};return h?i.jsx("div",{style:n.embedded?{width:"100%",background:"none",minHeight:"unset",boxShadow:"none",padding:0}:{background:"url('/green_hut.png') center center / cover no-repeat",minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center"},children:i.jsx("div",{style:{color:"#fff",fontSize:18},children:"載入中..."})}):i.jsxs("div",{style:n.embedded?{width:"100%",background:"none",minHeight:"unset",boxShadow:"none",padding:0}:{background:"url('/green_hut.png') center center / cover no-repeat",minHeight:"100vh",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",paddingTop:40},children:[!n.embedded&&i.jsx("button",{onClick:()=>e("/friend"),style:{position:"absolute",top:24,left:24,zIndex:10,background:"#fff",border:"1.5px solid #6B5BFF",color:"#6B5BFF",borderRadius:8,padding:"6px 18px",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:"0 2px 8px #0001"},children:Eu[T].back}),!n.embedded&&i.jsx($n,{}),i.jsxs("div",{style:{maxWidth:500,margin:n.embedded?"0 auto":"40px auto",background:"#fff",borderRadius:16,boxShadow:n.embedded?"none":"0 2px 8px #0001",padding:32},children:[i.jsx("h2",{style:{fontWeight:700,fontSize:22,marginBottom:24},children:Eu[T].title}),o.length===0&&i.jsx("div",{style:{color:"#888"},children:Eu[T].noLink}),o.map(P=>i.jsxs("div",{style:{marginBottom:24,borderBottom:"1px solid #eee",paddingBottom:16,opacity:P.status==="rejected"?.5:1},children:[i.jsxs("div",{style:{fontWeight:600},children:[P.user2Name,"（",P.role,"）"]}),i.jsxs("div",{style:{color:"#666",margin:"8px 0"},children:[Eu[T].goal,P.goal]}),i.jsx("div",{style:{color:P.status==="connected"?"#23c6e6":P.status==="pending"?"#e6b800":"#e4572e",fontWeight:700,marginBottom:8},children:NN[T][P.status]}),i.jsxs("div",{style:{display:"flex",gap:12},children:[P.status==="connected"&&i.jsx("button",{onClick:()=>e("/chatroom"),style:{background:"#8ec6f7",color:"#fff",border:"none",borderRadius:6,padding:"6px 18px",fontWeight:700,cursor:"pointer"},children:Eu[T].chat}),P.status==="connected"&&i.jsx("button",{onClick:()=>x(P.id),style:{background:"#eee",color:"#888",border:"none",borderRadius:6,padding:"6px 18px",fontWeight:700,cursor:"pointer"},children:mp[T]}),P.status==="pending"&&i.jsx("button",{onClick:()=>j(P.id),style:{background:"#eee",color:"#888",border:"none",borderRadius:6,padding:"6px 18px",fontWeight:700,cursor:"pointer"},children:gp[T]})]})]},P.id))]}),g&&i.jsx("div",{style:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",background:"#0006",zIndex:9999,display:"flex",alignItems:"center",justifyContent:"center"},children:i.jsxs("div",{style:{background:"#fff",borderRadius:12,padding:32,boxShadow:"0 2px 16px #0002",minWidth:280},children:[i.jsx("div",{style:{fontWeight:700,fontSize:18,marginBottom:18},children:mp[T]}),i.jsxs("div",{style:{display:"flex",gap:16,justifyContent:"flex-end"},children:[i.jsx("button",{onClick:()=>x(null),style:{background:"#eee",color:"#888",border:"none",borderRadius:6,padding:"6px 18px",fontWeight:700,cursor:"pointer"},children:"取消"}),i.jsx("button",{onClick:()=>I(g),style:{background:"#e4572e",color:"#fff",border:"none",borderRadius:6,padding:"6px 18px",fontWeight:700,cursor:"pointer"},children:mp[T]})]})]})}),S&&i.jsx("div",{style:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",background:"#0006",zIndex:9999,display:"flex",alignItems:"center",justifyContent:"center"},children:i.jsxs("div",{style:{background:"#fff",borderRadius:12,padding:32,boxShadow:"0 2px 16px #0002",minWidth:280},children:[i.jsx("div",{style:{fontWeight:700,fontSize:18,marginBottom:18},children:gp[T]}),i.jsxs("div",{style:{display:"flex",gap:16,justifyContent:"flex-end"},children:[i.jsx("button",{onClick:()=>j(null),style:{background:"#eee",color:"#888",border:"none",borderRadius:6,padding:"6px 18px",fontWeight:700,cursor:"pointer"},children:"取消"}),i.jsx("button",{onClick:()=>F(S),style:{background:"#e4572e",color:"#fff",border:"none",borderRadius:6,padding:"6px 18px",fontWeight:700,cursor:"pointer"},children:gp[T]})]})]})})]})}const Bi={"zh-TW":{back:"← 返回上一頁",title:"邀請通知",accept:"接受",reject:"拒絕",noInvite:"目前沒有新的邀請",goal:"目標："},"zh-CN":{back:"← 返回上一页",title:"邀请通知",accept:"接受",reject:"拒绝",noInvite:"目前没有新的邀请",goal:"目标："},en:{back:"← Back",title:"Invitations",accept:"Accept",reject:"Reject",noInvite:"No new invitations",goal:"Goal: "},ja:{back:"← 前のページへ",title:"招待通知",accept:"承認",reject:"拒否",noInvite:"新しい招待はありません",goal:"目標："},ko:{back:"← 이전 페이지",title:"초대 알림",accept:"수락",reject:"거절",noInvite:"새 초대가 없습니다",goal:"목표: "},th:{back:"← กลับ",title:"การแจ้งเตือนคำเชิญ",accept:"ยอมรับ",reject:"ปฏิเสธ",noInvite:"ไม่มีคำเชิญใหม่",goal:"เป้าหมาย: "},vi:{back:"← Quay lại",title:"Thông báo mời",accept:"Chấp nhận",reject:"Từ chối",noInvite:"Không có lời mời mới",goal:"Mục tiêu: "},ms:{back:"← Kembali",title:"Notis Jemputan",accept:"Terima",reject:"Tolak",noInvite:"Tiada jemputan baru",goal:"Matlamat: "},la:{back:"← Redire",title:"Notitia Invitationis",accept:"Accipe",reject:"Reici",noInvite:"Nullae invitationes novae",goal:"Propositum: "}};function sx(n){const[e,t]=v.useState([]),{lang:r,setLang:o}=Lt(),[a,c]=v.useState(null),[d,h]=v.useState(!0),[m,g]=v.useState(null),x=Et();v.useEffect(()=>{let T;const R=Ns(ga,async I=>{I?(c(I),T=await S(I.uid)):x("/")});return()=>{R(),T&&T()}},[x]);const S=async T=>{try{h(!0);const R=En(Wt,"invites"),I=mr(R,An("toUserId","==",T),An("status","==","pending"));return w0(I,P=>{const z=[];P.forEach(H=>{z.push({id:H.id,...H.data()})}),t(z),h(!1)})}catch(R){console.error("Error loading invites:",R),h(!1);return}},j=async(T,R)=>{if(a)try{const I=Pn(Wt,"invites",T);if(R){await nf(I,{status:"accepted"});const F=e.find(P=>P.id===T);F&&await xs(En(Wt,"links"),{user1Id:F.fromUserId,user1Name:F.fromUserName,user2Id:F.toUserId,user2Name:F.toUserName,role:F.role,goal:F.goal,status:"connected",createdAt:new Date}),g(Bi[r].accept+" 成功！"),setTimeout(()=>g(null),2e3)}else await nf(I,{status:"rejected"}),g(Bi[r].reject+" 成功！"),setTimeout(()=>g(null),2e3)}catch(I){console.error("Error handling invite:",I),alert("操作失敗")}};return d?i.jsx("div",{style:n.embedded?{width:"100%",background:"none",minHeight:"unset",boxShadow:"none",padding:0}:{background:"url('/green_hut.png') center center / cover no-repeat",minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center"},children:i.jsx("div",{style:{color:"#fff",fontSize:18},children:"載入中..."})}):!d&&e.length===0?i.jsxs("div",{style:n.embedded?{width:"100%",background:"none",minHeight:"unset",boxShadow:"none",padding:0}:{background:"url('/green_hut.png') center center / cover no-repeat",minHeight:"100vh",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",paddingTop:40},children:[!n.embedded&&i.jsx("button",{onClick:()=>x("/friend"),style:{position:"absolute",top:24,left:24,zIndex:10,background:"#fff",border:"1.5px solid #6B5BFF",color:"#6B5BFF",borderRadius:8,padding:"6px 18px",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:"0 2px 8px #0001"},children:Bi[r].back}),i.jsx($n,{}),i.jsxs("div",{style:{maxWidth:500,margin:n.embedded?"0 auto":"40px auto",background:"#fff",borderRadius:16,boxShadow:n.embedded?"none":"0 2px 8px #0001",padding:32},children:[i.jsx("h2",{style:{fontWeight:700,fontSize:22,marginBottom:24},children:Bi[r].title}),i.jsx("div",{style:{color:"#888",textAlign:"center",fontSize:18},children:Bi[r].noInvite})]})]}):i.jsxs("div",{style:n.embedded?{width:"100%",background:"none",minHeight:"unset",boxShadow:"none",padding:0}:{background:"url('/green_hut.png') center center / cover no-repeat",minHeight:"100vh",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",paddingTop:40},children:[m&&i.jsx("div",{style:{position:"fixed",top:40,left:"50%",transform:"translateX(-50%)",background:"#fff",color:"#6B5BFF",fontWeight:700,fontSize:18,borderRadius:16,boxShadow:"0 4px 24px #6B5BFF22",padding:"18px 36px",zIndex:99999,textAlign:"center",letterSpacing:1},children:m}),!n.embedded&&i.jsx("button",{onClick:()=>x("/friend"),style:{position:"absolute",top:24,left:24,zIndex:10,background:"#fff",border:"1.5px solid #6B5BFF",color:"#6B5BFF",borderRadius:8,padding:"6px 18px",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:"0 2px 8px #0001"},children:Bi[r].back}),i.jsx($n,{}),i.jsxs("div",{style:{maxWidth:500,margin:n.embedded?"0 auto":"40px auto",background:"#fff",borderRadius:16,boxShadow:n.embedded?"none":"0 2px 8px #0001",padding:32},children:[i.jsx("h2",{style:{fontWeight:700,fontSize:22,marginBottom:24},children:Bi[r].title}),e.map(T=>i.jsxs("div",{style:{marginBottom:24,borderBottom:"1px solid #eee",paddingBottom:16},children:[i.jsxs("div",{style:{fontWeight:600},children:[T.fromUserName," 邀請你成為 ",T.role]}),i.jsxs("div",{style:{color:"#666",margin:"8px 0"},children:[Bi[r].goal,T.goal]}),i.jsx("button",{onClick:()=>j(T.id,!0),style:{marginRight:12,background:"#8ec6f7",color:"#fff",border:"none",borderRadius:6,padding:"6px 18px",fontWeight:700,cursor:"pointer"},children:Bi[r].accept}),i.jsx("button",{onClick:()=>j(T.id,!1),style:{background:"#eee",color:"#888",border:"none",borderRadius:6,padding:"6px 18px",fontWeight:700,cursor:"pointer"},children:Bi[r].reject})]},T.id))]})]})}const zt={backToHome:{"zh-TW":"← 返回","zh-CN":"← 返回",ja:"← 戻る",en:"← Back",ko:"← 뒤로",th:"← กลับ",vi:"← Quay lại",ms:"← Kembali",la:"← Redire"},logout:{"zh-TW":"登出","zh-CN":"登出",ja:"ログアウト",en:"Logout",ko:"로그아웃",th:"ออกจากระบบ",vi:"Đăng xuất",ms:"Log keluar",la:"Exire"},pageTitle:{"zh-TW":"【破繭重生】夥伴計畫","zh-CN":"【破茧重生】伙伴计划",ja:"【再出発】パートナー計画",en:"Project Butterfly",ko:"【새출발】 파트너 계획",th:"【เกิดใหม่】แผนพันธมิตร",vi:"【Tái sinh】Kế hoạch đối tác",ms:"【Lahir Semula】Rancangan Rakan Kongsi",la:"【Renascitur】Propositum Socius"},editProfile:{"zh-TW":"編輯我的檔案","zh-CN":"编辑我的档案",ja:"プロフィール編集",en:"Edit My Profile",ko:"내 프로필 편집",th:"แก้ไขโปรไฟล์ของฉัน",vi:"Chỉnh sửa hồ sơ của tôi",ms:"Sunting Profil Saya",la:"Meum Profilum Muta"},partnerRoleTitle:{"zh-TW":"我想尋找的夥伴角色","zh-CN":"我想寻找的伙伴角色",ja:"探している仲間",en:"I'm looking for a",ko:"찾고 있는 파트너 역할",th:"บทบาทพันธมิตรที่ฉันมองหา",vi:"Vai trò đối tác tôi đang tìm",ms:"Peranan Rakan Kongsi Yang Saya Cari",la:"Partem Socii Quam Quæro"},peer:{"zh-TW":"同行者","zh-CN":"同行者",ja:"同じ道の仲間",en:"Peer",ko:"동행자",th:"เพื่อนร่วมทาง",vi:"Bạn đồng hành",ms:"Rakan Sebaya",la:"Par"},mentor:{"zh-TW":"生命導師","zh-CN":"生命导师",ja:"人生の師",en:"Mentor",ko:"인생 멘토",th:"ที่ปรึกษาชีวิต",vi:"Người hướng dẫn",ms:"Mentor Kehidupan",la:"Mentor"},skillPartner:{"zh-TW":"技能夥伴","zh-CN":"技能伙伴",ja:"スキル仲間",en:"Skill Partner",ko:"기술 파트너",th:"พันธมิตรด้านทักษะ",vi:"Đối tác kỹ năng",ms:"Rakan Kemahiran",la:"Socius Peritiae"},mainGoalTitle:{"zh-TW":"我的主要目標","zh-CN":"我的主要目标",ja:"私の主な目標",en:"My Main Goal",ko:"나의 주요 목표",th:"เป้าหมายหลักของฉัน",vi:"Mục tiêu chính của tôi",ms:"Matlamat Utama Saya",la:"Meum Propositum Principale"},allGoals:{"zh-TW":"所有目標","zh-CN":"所有目标",ja:"すべての目標",en:"All Goals",ko:"모든 목표",th:"เป้าหมายทั้งหมด",vi:"Tất cả mục tiêu",ms:"Semua Matlamat",la:"Omnia Proposita"},goalLabel:{"zh-TW":"目標","zh-CN":"目标",ja:"目標",en:"Goal",ko:"목표",th:"เป้าหมาย",vi:"Mục tiêu",ms:"Matlamat",la:"Propositum"},goalOptions:{jobSeeking:{"zh-TW":"尋找工作","zh-CN":"寻找工作",en:"Job Seeking",ja:"仕事探し",ko:"구직",th:"หางาน",vi:"Tìm việc",ms:"Mencari Kerja",la:"Quaerere Opus"},learnNewSkills:{"zh-TW":"學習新技能","zh-CN":"学习新技能",en:"Learn New Skills",ja:"新しいスキルを学ぶ",ko:"새로운 기술 배우기",th:"เรียนรู้ทักษะใหม่",vi:"Học kỹ năng mới",ms:"Belajar Kemahiran Baru",la:"Disce Novas Artes"},emotionalSupport:{"zh-TW":"情緒支持","zh-CN":"情绪支持",en:"Emotional Support",ja:"心のサポート",ko:"정서적 지원",th:"การสนับสนุนทางอารมณ์",vi:"Hỗ trợ tinh thần",ms:"Sokongan Emosi",la:"Auxilium Emotionale"},networking:{"zh-TW":"建立人脈","zh-CN":"建立人脉",en:"Networking",ja:"人脈作り",ko:"네트워킹",th:"สร้างเครือข่าย",vi:"Xây dựng mạng lưới",ms:"Rangkaian",la:"Nexus Creare"},startupPrep:{"zh-TW":"創業準備","zh-CN":"创业准备",en:"Startup Prep",ja:"起業準備",ko:"창업 준비",th:"เตรียมตัวเริ่มต้นธุรกิจ",vi:"Chuẩn bị khởi nghiệp",ms:"Persediaan Permulaan",la:"Praeparatio Negotii"}},pass:{"zh-TW":"跳過","zh-CN":"跳过",ja:"スキップ",en:"Pass",ko:"건너뛰기",th:"ข้าม",vi:"Bỏ qua",ms:"Langkau",la:"Transilire"},like:{"zh-TW":"建立連結","zh-CN":"建立连结",ja:"繋がる",en:"Connect",ko:"연결하기",th:"เชื่อมต่อ",vi:"Kết nối",ms:"Berhubung",la:"Coniungere"},noMoreUsers:{"zh-TW":"目前沒有更多夥伴了，請稍後再試。","zh-CN":"目前没有更多伙伴了，请稍后再试。",ja:"現在、他の仲間はいません。後でもう一度お試しください。",en:"No more partners for now. Please try again later.",ko:"지금은 더 이상 파트너가 없습니다. 나중에 다시 시도해주세요.",th:"ไม่มีพันธมิตรเพิ่มเติมในขณะนี้ กรุณาลองใหม่อีกครั้งในภายหลัง",vi:"Hiện tại không có đối tác nào khác. Vui lòng thử lại sau.",ms:"Tiada lagi rakan kongsi buat masa ini. Sila cuba lagi nanti.",la:"Nulli socii nunc. Quaeso, postea iterum conare."},profileModal:{nameLabel:{"zh-TW":"暱稱 / Name","zh-CN":"昵称 / Name",en:"Name",ja:"ニックネーム",ko:"닉네임",th:"ชื่อเล่น",vi:"Biệt danh",ms:"Nama Panggilan",la:"Nomen"},bioLabel:{"zh-TW":"簡介 / Bio","zh-CN":"简介 / Bio",en:"Bio",ja:"自己紹介",ko:"소개",th:"ประวัติ",vi:"Tiểu sử",ms:"Bio",la:"Descriptio"},goalLabel:{"zh-TW":"主要目標 / Main Goal","zh-CN":"主要目标 / Main Goal",en:"Main Goal",ja:"主な目標",ko:"주요 목표",th:"เป้าหมายหลัก",vi:"Mục tiêu chính",ms:"Matlamat Utama",la:"Propositum Principale"},skillsLabel:{"zh-TW":"技能 / Skills","zh-CN":"技能 / Skills",en:"Skills",ja:"スキル",ko:"기술",th:"ทักษะ",vi:"Kỹ năng",ms:"Kemahiran",la:"Artes"},selectDefault:{"zh-TW":"請選擇","zh-CN":"请选择",en:"Please select",ja:"選択してください",ko:"선택하세요",th:"กรุณาเลือก",vi:"Vui lòng chọn",ms:"Sila pilih",la:"Quaeso selige"},cancelButton:{"zh-TW":"取消","zh-CN":"取消",en:"Cancel",ja:"キャンセル",ko:"취소",th:"ยกเลิก",vi:"Hủy bỏ",ms:"Batal",la:"Abrogare"},saveButton:{"zh-TW":"儲存","zh-CN":"保存",en:"Save",ja:"保存",ko:"저장",th:"บันทึก",vi:"Lưu",ms:"Simpan",la:"Servare"},avatarLabel:{"zh-TW":"頭像 / Avatar","zh-CN":"头像 / Avatar",en:"Avatar",ja:"アバター",ko:"아바타",th:"รูปประจำตัว",vi:"Ảnh đại diện",ms:"Avatar",la:"Imago"},uploading:{"zh-TW":"上傳中...","zh-CN":"上传中...",en:"Uploading...",ja:"アップロード中...",ko:"업로드 중...",th:"กำลังอัปโหลด...",vi:"Đang tải lên...",ms:"Memuat naik...",la:"Imponens..."}},chatroom:{"zh-TW":"聊天室","zh-CN":"聊天室",en:"Chat Room",ja:"チャットルーム",ko:"채팅방",th:"ห้องแชท",vi:"Phòng chat",ms:"Bilik Sembang",la:"Cella Colloquii"},invites:{"zh-TW":"邀請通知","zh-CN":"邀请通知",en:"Invitations",ja:"招待通知",ko:"초대 알림",th:"การแจ้งเตือนคำเชิญ",vi:"Thông báo mời",ms:"Notis Jemputan",la:"Notitia Invitationis"},mylinks:{"zh-TW":"我的連結","zh-CN":"我的连接",en:"My Links",ja:"私のリンク",ko:"내 링크",th:"ลิงก์ของฉัน",vi:"Liên kết của tôi",ms:"Pautan Saya",la:"Nexus Mei"},returnFriendStories:{"zh-TW":"返回好友故事","zh-CN":"返回好友故事",en:"Return to Friend Stories",ja:"友達のストーリーに戻る",ko:"친구 이야기로 돌아가기",th:"กลับไปที่เรื่องราวของเพื่อน",vi:"Quay lại câu chuyện bạn bè",ms:"Kembali ke Cerita Rakan",la:"Redi ad Fabulas Amicorum"},hello:{"zh-TW":"你好，","zh-CN":"你好，",ja:"こんにちは、",en:"Hello,",ko:"안녕하세요,",th:"สวัสดี,",vi:"Xin chào,",ms:"Hai,",la:"Salve,"},partnerTitle:{"zh-TW":"尋求夥伴同行","zh-CN":"寻找伙伴同行",ja:"仲間を探す",en:"Find a Partner",ko:"동행자 찾기",th:"ค้นหาคู่หู",vi:"Tìm bạn đồng hành",ms:"Cari Rakan Kongsi",la:"Socius Quaerere"},partnerSubtitle:{"zh-TW":"請選擇你的夥伴目標","zh-CN":"请选择你的伙伴目标",ja:"パートナー目標を選択してください",en:"Please select your partner goal",ko:"파트너 목표를 선택하세요",th:"โปรดเลือกเป้าหมายของคู่หู",vi:"Vui lòng chọn mục tiêu đối tác",ms:"Sila pilih matlamat rakan kongsi anda",la:"Quaeso selige propositum socii tui"},noPartnerYet:{"zh-TW":"🦋你的夥伴很快就會出現喔，請耐心等待...","zh-CN":"🦋你的伙伴很快就會出现哦，请耐心等待...",ja:"🦋あなたのパートナーはすぐに現れます。お待ちください。",en:"🦋 Your partner will appear soon. Please be patient.",ko:"🦋 당신의 파트너가 곧 나타날 것입니다. 조금만 기다려주세요.",th:"🦋พันธมิตรของคุณจะปรากฏในขณะนี้ โปรดอดทนต่อไป",vi:"🦋 Bạn đồng hành của bạn sẽ xuất hiện sớm. Vui lòng đợi để chờ đợi...",ms:"🦋 Rakan kongsi anda akan muncul segera. Sila tunggu dengan sabar...",la:"🦋 Socius tuus apparebit. Quaeso, patientia attendas..."}};function MN(){const n=Et(),[e,t]=v.useState(null),{lang:r,setLang:o}=Lt(),[a,c]=v.useState([]),[d,h]=v.useState([]),[m,g]=v.useState(0),[x,S]=v.useState("peer"),[j,T]=v.useState(""),[R,I]=v.useState(!1),[F,P]=v.useState({name:"",bio:"",goal:"",skills:"",avatar:"",customSkill:"",country:"",gender:""}),[z,H]=v.useState({name:"",bio:"",goal:"",skills:"",avatar:"",customSkill:"",country:"",gender:""}),[J,O]=v.useState(""),[L,C]=v.useState(null),[A,D]=v.useState(null),[M,B]=v.useState(!0),[_,U]=v.useState("main"),[oe,X]=v.useState("none"),[ce,le]=v.useState(null);v.useRef(m),v.useEffect(()=>{const Q=Ns(ga,async G=>{if(G){t(G);const ne=Pn(Wt,"profiles",G.uid),se=await To(ne);if(se.exists()){const me=se.data();P({name:me.nickname||me.name||"新用戶",bio:me.bio,goal:me.goal,skills:me.skills,avatar:me.avatar,customSkill:me.customSkill||"",country:me.country||"",gender:me.gender||""})}else{const me={name:G.displayName||"新用戶",bio:"",goal:"",skills:"",avatar:G.photoURL||"/avatars/Derxl.png",customSkill:"",country:"",gender:""};P(me),await Bd(ne,me)}await te(G.uid)}else n("/")});return()=>Q()},[ga,Wt,n]);const te=async Q=>{try{B(!0);const G=En(Wt,"profiles"),ne=mr(G,An("__name__","!=",Q)),se=await Vr(ne),me=[];se.forEach(Ie=>{const Pe=Ie.data();me.push({id:Ie.id,name:Pe.name||"Unknown",goal:Pe.goal||"learnNewSkills",role:Pe.role||"peer",bio:Pe.bio||{"zh-TW":"No bio available","zh-CN":"暂无简介",en:"No bio available",ja:"自己紹介なし",ko:"소개 없음",th:"ไม่มีประวัติ",vi:"Không có tiểu sử",ms:"Tiada bio",la:"Nulla descriptio"},avatar:Pe.avatar||"/avatars/Derxl.png",skills:Pe.skills||"",createdAt:Pe.createdAt,country:Pe.country||"",gender:Pe.gender||""})}),c(me),h(me)}catch(G){console.error("Error loading users:",G)}finally{B(!1)}},xe=async(Q,G)=>{if(e)try{const ne={fromUserId:e.uid,fromUserName:F.name,fromUserAvatar:F.avatar,fromUserCountry:F.country||"",fromUserGender:F.gender||"",fromUserEmail:e.email||"",fromUserNickname:F.name||"",toUserId:Q,toUserName:G.name,role:G.role,goal:G.goal,status:"pending",createdAt:k0()};await xs(En(Wt,"invites"),ne),le(zt.like[r]+" 成功！"),setTimeout(()=>le(null),2e3)}catch(ne){console.error("Error sending invite:",ne),alert("發送邀請失敗")}};v.useMemo(()=>Array(d.length).fill(0).map(Q=>Un.createRef()),[d.length]),v.useEffect(()=>{if(a.length>0){const Q=a.filter(G=>{const ne=G.role===x,se=j?G.goal===j:!0;return ne&&se});h(Q),g(Q.length-1)}},[x,j,a]),v.useEffect(()=>{R&&(H(F),O(F.avatar),D(null),C(null))},[R,F]),d[m];const $=["jobSeeking","learnNewSkills","emotionalSupport","networking","startupPrep"];return v.useEffect(()=>{if(!localStorage.getItem("lang")){const Q=navigator.language;let G="zh-TW";Q.startsWith("zh-CN")?G="zh-CN":Q.startsWith("zh-TW")?G="zh-TW":Q.startsWith("ja")?G="ja":Q.startsWith("ko")?G="ko":Q.startsWith("th")?G="th":Q.startsWith("vi")?G="vi":Q.startsWith("ms")?G="ms":Q.startsWith("la")?G="la":Q.startsWith("en")&&(G="en"),o(G),localStorage.setItem("lang",G)}},[o]),v.useEffect(()=>{if(oe==="in"){const Q=document.getElementById("user-card");Q&&Q.animate([{transform:"translateX(-120%) scale(0.4)",opacity:0},{transform:"translateX(0) scale(1)",opacity:1}],{duration:400}),setTimeout(()=>X("none"),400)}},[oe]),i.jsxs("div",{style:{width:"100vw",height:"100vh",overflow:"hidden",position:"relative"},children:[window.innerWidth<=768?i.jsxs("div",{style:{width:"100%",height:"100vh",display:"flex",flexDirection:"column",background:"url('/green_hut.png') center center / cover no-repeat fixed"},children:[i.jsxs("div",{style:{position:"fixed",top:0,left:0,right:0,zIndex:100,background:"rgba(255,255,255,0.95)",padding:"8px 16px",display:"flex",justifyContent:"space-between",alignItems:"center",boxShadow:"0 2px 8px #0001"},children:[i.jsx("button",{className:"topbar-btn",onClick:()=>n("/"),style:{fontWeight:700,fontSize:14,padding:"6px 12px",borderRadius:8,border:"1.5px solid #6B5BFF",background:"#fff",color:"#6B5BFF",cursor:"pointer"},children:zt.backToHome[r]}),i.jsxs("h2",{style:{fontSize:"1.2rem",fontWeight:900,color:"#6B5BFF",margin:0,textAlign:"center"},children:["🦋 ",zt.pageTitle[r]]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[i.jsx("button",{className:"topbar-btn",onClick:async()=>{await Er(ga),localStorage.clear(),window.location.href="/"},style:{fontWeight:700,fontSize:14,padding:"6px 12px",borderRadius:8,border:"1.5px solid #6B5BFF",background:"#fff",color:"#6B5BFF",cursor:"pointer"},children:zt.logout[r]}),i.jsx($n,{style:{width:"80px",fontSize:14,padding:"6px 10px"}})]})]}),i.jsxs("div",{style:{marginTop:60,padding:"16px",flex:1,overflowY:"auto"},children:[i.jsxs("div",{style:{background:"rgba(255,255,255,0.95)",borderRadius:16,padding:"16px",marginBottom:16,boxShadow:"0 2px 12px #6B5BFF22"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,marginBottom:12},children:[i.jsx("div",{style:{fontSize:24},children:"🦋"}),i.jsx("div",{style:{fontWeight:700,fontSize:14,color:"#6B5BFF"},children:zt.hello?zt.hello[r]:"你好，"}),i.jsx("img",{src:F.avatar,alt:"avatar",style:{width:36,height:36,borderRadius:"50%",objectFit:"cover",border:"2px solid #6B5BFF"}}),i.jsx("div",{style:{fontWeight:700,fontSize:14,color:"#333"},children:F.name})]}),i.jsxs("div",{style:{background:"rgba(128,128,128,0.1)",borderRadius:12,padding:"16px",marginBottom:16,boxShadow:"0 4px 12px rgba(0,0,0,0.15)"},children:[i.jsx("div",{style:{fontWeight:700,fontSize:16,color:"#6B5BFF",textAlign:"center",marginBottom:8},children:zt.partnerTitle?zt.partnerTitle[r]:"尋求夥伴同行"}),i.jsx("div",{style:{fontSize:12,color:"#888",textAlign:"center",marginBottom:12},children:zt.partnerSubtitle?zt.partnerSubtitle[r]:"請選擇你的夥伴目標"}),i.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:8},children:$.map(Q=>i.jsx("button",{onClick:()=>{T(Q),U("main")},style:{flex:"1 1 calc(50% - 4px)",padding:"8px 4px",borderRadius:8,border:j===Q?"2px solid #23c6e6":"1px solid #eee",background:j===Q?"#e6f7ff":"#fff",color:j===Q?"#23c6e6":"#333",fontWeight:600,fontSize:12,cursor:"pointer",boxShadow:j===Q?"0 2px 8px #23c6e622":"0 1px 4px #0001"},children:zt.goalOptions[Q][r]},Q))})]}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:8},children:[i.jsx("button",{onClick:()=>n("/chatroom"),style:{padding:"8px",borderRadius:8,border:_==="chat"?"2px solid #8ec6f7":"1px solid #eee",background:_==="chat"?"#e6f7ff":"#fff",color:_==="chat"?"#23c6e6":"#333",fontWeight:600,fontSize:14,cursor:"pointer"},children:zt.chatroom[r]}),i.jsx("button",{onClick:()=>U("invites"),style:{padding:"8px",borderRadius:8,border:_==="invites"?"2px solid #6B5BFF":"1px solid #eee",background:_==="invites"?"#f5f4ff":"#fff",color:_==="invites"?"#6B5BFF":"#333",fontWeight:600,fontSize:14,cursor:"pointer"},children:zt.invites[r]}),i.jsx("button",{onClick:()=>U("links"),style:{padding:"8px",borderRadius:8,border:_==="links"?"2px solid #6B5BFF":"1px solid #eee",background:_==="links"?"#f5f4ff":"#fff",color:_==="links"?"#6B5BFF":"#333",fontWeight:600,fontSize:14,cursor:"pointer"},children:zt.mylinks[r]}),i.jsxs("a",{href:"/storywall",style:{padding:"8px",borderRadius:8,border:"1px solid #23c6e6",background:"#fff",color:"#23c6e6",fontWeight:600,fontSize:14,cursor:"pointer",textAlign:"center",textDecoration:"none",display:"block"},children:[zt.returnFriendStories[r]," 🦋"]})]})]}),i.jsxs("div",{style:{background:"rgba(255,255,255,0.95)",borderRadius:16,padding:"16px",minHeight:400},children:[_==="main"&&i.jsx(i.Fragment,{children:(()=>{var ne,se;const Q=d.filter(me=>!j||me.goal===j);if(Q.length===0)return i.jsx("div",{style:{textAlign:"center",color:"#e74c3c",fontSize:16,marginTop:40,fontWeight:700},children:((ne=zt.noPartnerYet)==null?void 0:ne[r])||"🦋你的夥伴很快就會出現喔，請耐心等待..."});const G=Q[m>=0&&m<Q.length?m:0];return G?i.jsxs("div",{id:"user-card",style:{textAlign:"center",transition:"box-shadow 0.2s, transform 0.4s",transform:oe==="in"?"translateX(-120%) scale(0.4)":oe==="out"?"translateX(120%) scale(0.4)":"translateX(0) scale(1)",opacity:1},onAnimationEnd:()=>{oe==="in"&&X("none")},children:[i.jsx("img",{src:G.avatar,alt:"avatar",style:{width:80,height:80,borderRadius:"50%",objectFit:"cover",border:"3px solid #6B5BFF",marginBottom:12}}),i.jsx("div",{style:{fontWeight:800,fontSize:18,color:"#6B5BFF",marginBottom:8},children:G.name}),i.jsxs("div",{style:{color:"#888",fontSize:14,marginBottom:4},children:["國家/地區：",G.country||"未填寫"]}),i.jsxs("div",{style:{color:"#888",fontSize:14,marginBottom:4},children:["性別：",G.gender||"未填寫"]}),i.jsxs("div",{style:{color:"#888",fontSize:14,marginBottom:4},children:["目標：",((se=zt.goalOptions[G.goal])==null?void 0:se[r])||G.goal]}),i.jsxs("div",{style:{color:"#888",fontSize:14,marginBottom:16},children:["技能：",G.skills||"未填寫"]}),i.jsxs("div",{style:{display:"flex",gap:12,justifyContent:"center"},children:[i.jsx("button",{onClick:()=>{const me=document.getElementById("user-card");me&&(X("out"),me.animate([{transform:"translateX(0) scale(1)",opacity:1},{transform:"translateX(120%) scale(0.4)",opacity:0}],{duration:400})),setTimeout(()=>{g(Ie=>(X("in"),(Ie-1+Q.length)%Q.length))},400)},style:{padding:"8px 20px",borderRadius:8,border:"1.5px solid #bbb",background:"#fff",color:"#888",fontWeight:600,fontSize:14,cursor:"pointer"},children:"跳過"}),i.jsx("button",{onClick:()=>xe(G.id,G),style:{padding:"8px 20px",borderRadius:8,border:"1.5px solid #6B5BFF",background:"#6B5BFF",color:"#fff",fontWeight:600,fontSize:14,cursor:"pointer"},children:"建立連結"})]})]}):null})()}),_==="chat"&&i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:20,justifyContent:"center",alignItems:"center",minHeight:"50vh",padding:"20px 0"},children:[i.jsxs("div",{style:{background:"rgba(128,128,128,0.15)",borderRadius:16,padding:"24px",boxShadow:"0 6px 16px rgba(0,0,0,0.2)",width:"95%",maxWidth:320,border:"1px solid rgba(128,128,128,0.2)"},children:[i.jsx("div",{style:{fontWeight:800,fontSize:20,color:"#6B5BFF",marginBottom:16,textAlign:"center"},children:"好友列表"}),i.jsx("div",{style:{textAlign:"center",color:"#666",fontSize:15,lineHeight:1.4},children:"請先加好友,才能開始聊天"})]}),i.jsxs("div",{style:{background:"rgba(128,128,128,0.15)",borderRadius:16,padding:"24px",boxShadow:"0 6px 16px rgba(0,0,0,0.2)",width:"95%",maxWidth:320,border:"1px solid rgba(128,128,128,0.2)"},children:[i.jsx("div",{style:{fontWeight:800,fontSize:20,color:"#6B5BFF",marginBottom:16,textAlign:"center"},children:"聊天訊息框"}),i.jsx("div",{style:{textAlign:"center",color:"#666",fontSize:15,lineHeight:1.4},children:"還沒有朋友,去交友區加好友吧!"})]})]}),_==="links"&&i.jsx(ox,{embedded:!0}),_==="invites"&&i.jsx(sx,{embedded:!0})]}),i.jsx("div",{style:{width:"100%",margin:"0 auto",marginTop:24},children:i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:8},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:20,flexWrap:"wrap"},children:[i.jsx("a",{href:"/about",style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12},children:"🧬 Restarter™｜我們是誰"}),i.jsx("a",{href:"/privacy-policy",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12},children:"隱私權政策"}),i.jsx("a",{href:"/terms",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12},children:"條款/聲明"})]}),i.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:20,flexWrap:"wrap"},children:[i.jsx("a",{href:"/data-deletion",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12},children:"資料刪除說明"}),i.jsx("a",{href:"/feedback",style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12},children:"💬 意見箱｜我們想聽你說"})]})]})})]})]}):i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{position:"fixed",top:0,left:0,right:0,zIndex:100,background:"rgba(255,255,255,0.95)",padding:"12px 24px",display:"flex",justifyContent:"space-between",alignItems:"center",boxShadow:"0 2px 8px #0001"},children:[i.jsx("button",{className:"topbar-btn",onClick:()=>n("/"),style:{fontWeight:700,fontSize:16,padding:"8px 16px",borderRadius:8,border:"1.5px solid #6B5BFF",background:"#fff",color:"#6B5BFF",cursor:"pointer"},children:zt.backToHome[r]}),i.jsxs("h1",{style:{fontSize:"1.8rem",fontWeight:900,color:"#6B5BFF",margin:0,textAlign:"center"},children:["🦋 ",zt.pageTitle[r]]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[i.jsx("button",{className:"topbar-btn",onClick:async()=>{await Er(ga),localStorage.clear(),window.location.href="/"},style:{fontWeight:700,fontSize:16,padding:"8px 16px",borderRadius:8,border:"1.5px solid #6B5BFF",background:"#fff",color:"#6B5BFF",cursor:"pointer"},children:zt.logout[r]}),i.jsx($n,{style:{width:"100px",fontSize:16,padding:"8px 12px"}})]})]}),i.jsx("div",{style:{position:"fixed",left:0,top:60,width:340,height:"calc(100vh - 60px)",background:"rgba(255,255,255,0.95)",borderRight:"1px solid #eee",overflowY:"auto",zIndex:2,padding:"24px 16px"},children:i.jsxs("div",{style:{background:"rgba(255,255,255,0.95)",borderRadius:16,padding:"20px",marginBottom:24,boxShadow:"0 2px 12px #6B5BFF22"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:16,marginBottom:16},children:[i.jsx("div",{style:{fontSize:32},children:"🦋"}),i.jsx("div",{style:{fontWeight:700,fontSize:16,color:"#6B5BFF"},children:zt.hello?zt.hello[r]:"你好，"}),i.jsx("img",{src:F.avatar,alt:"avatar",style:{width:48,height:48,borderRadius:"50%",objectFit:"cover",border:"3px solid #6B5BFF"}}),i.jsx("div",{style:{fontWeight:700,fontSize:16,color:"#333"},children:F.name})]}),i.jsxs("div",{style:{background:"rgba(128,128,128,0.1)",borderRadius:12,padding:"20px",marginBottom:24,boxShadow:"0 4px 12px rgba(0,0,0,0.15)"},children:[i.jsx("div",{style:{fontWeight:700,fontSize:18,color:"#6B5BFF",textAlign:"center",marginBottom:12},children:zt.partnerTitle?zt.partnerTitle[r]:"尋求夥伴同行"}),i.jsx("div",{style:{fontSize:14,color:"#888",textAlign:"center",marginBottom:20},children:zt.partnerSubtitle?zt.partnerSubtitle[r]:"請選擇你的夥伴目標"}),i.jsx("div",{style:{display:"flex",flexDirection:"column",gap:12},children:$.map(Q=>i.jsx("button",{onClick:()=>{T(Q),U("main")},style:{width:"100%",padding:"12px 16px",borderRadius:10,border:j===Q?"2px solid #23c6e6":"1.5px solid #eee",background:j===Q?"#e6f7ff":"#fff",color:j===Q?"#23c6e6":"#333",fontWeight:700,fontSize:15,cursor:"pointer",boxShadow:j===Q?"0 2px 8px #23c6e622":"0 2px 8px #0001",transition:"all 0.2s",outline:"none",borderLeft:j===Q?"6px solid #23c6e6":"6px solid transparent",marginBottom:0},children:zt.goalOptions[Q][r]},Q))})]}),i.jsx("button",{onClick:()=>n("/chatroom"),style:{width:"100%",marginBottom:12,padding:"12px 0",borderRadius:10,border:_==="chat"?"2px solid #8ec6f7":"1.5px solid #eee",background:_==="chat"?"#e6f7ff":"#fff",color:_==="chat"?"#23c6e6":"#333",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:_==="chat"?"0 2px 8px #23c6e622":"0 2px 8px #0001",transition:"all 0.2s"},children:zt.chatroom[r]}),i.jsx("button",{onClick:()=>U("invites"),style:{width:"100%",marginBottom:12,padding:"12px 0",borderRadius:10,border:_==="invites"?"2px solid #6B5BFF":"1.5px solid #eee",background:_==="invites"?"#f5f4ff":"#fff",color:_==="invites"?"#6B5BFF":"#333",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:_==="invites"?"0 2px 8px #6B5BFF22":"0 2px 8px #0001",transition:"all 0.2s"},children:zt.invites[r]}),i.jsx("button",{onClick:()=>U("links"),style:{width:"100%",marginBottom:12,padding:"12px 0",borderRadius:10,border:_==="links"?"2px solid #6B5BFF":"1.5px solid #eee",background:_==="links"?"#f5f4ff":"#fff",color:_==="links"?"#6B5BFF":"#333",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:_==="links"?"0 2px 8px #6B5BFF22":"0 2px 8px #0001",transition:"all 0.2s"},children:zt.mylinks[r]}),i.jsxs("a",{href:"/storywall",style:{width:"100%",marginBottom:12,padding:"12px 0",borderRadius:10,border:"1.5px solid #23c6e6",background:"#fff",color:"#23c6e6",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:"0 2px 8px #23c6e622",textAlign:"center",textDecoration:"none",display:"block",transition:"all 0.2s"},children:[zt.returnFriendStories[r]," 🦋"]})]})}),i.jsx("div",{style:{position:"fixed",left:340,top:60,width:"calc(100vw - 340px)",height:"calc(100vh - 60px)",overflowY:"auto",display:"flex",flexDirection:"column",alignItems:"center",background:"url('/green_hut.png') center center / cover no-repeat fixed",zIndex:1,pointerEvents:"auto",paddingLeft:0},children:i.jsxs("div",{style:{width:"100%",maxWidth:900,marginTop:60},children:[_==="main"&&i.jsx(i.Fragment,{children:(()=>{var ne,se;const Q=d.filter(me=>!j||me.goal===j);if(Q.length===0)return i.jsx("div",{style:{textAlign:"center",color:"#e74c3c",fontSize:18,marginTop:40,fontWeight:700},children:((ne=zt.noPartnerYet)==null?void 0:ne[r])||"🦋你的夥伴很快就會出現喔，請耐心等待..."});const G=Q[m>=0&&m<Q.length?m:0];return G?i.jsxs("div",{id:"user-card",style:{width:340,margin:"0 auto",background:"#fff",borderRadius:18,boxShadow:"0 2px 16px #6B5BFF22",padding:32,display:"flex",flexDirection:"column",alignItems:"center",position:"relative",minHeight:380,transition:"box-shadow 0.2s, transform 0.4s",transform:oe==="in"?"translateX(-120%) scale(0.4)":oe==="out"?"translateX(120%) scale(0.4)":"translateX(0) scale(1)",opacity:1},onAnimationEnd:()=>{oe==="in"&&X("none")},children:[i.jsx("img",{src:G.avatar,alt:"avatar",style:{width:88,height:88,borderRadius:"50%",objectFit:"cover",border:"3px solid #6B5BFF",marginBottom:16}}),i.jsx("div",{style:{fontWeight:800,fontSize:22,color:"#6B5BFF",marginBottom:8},children:G.name}),i.jsxs("div",{style:{color:"#888",fontSize:15,marginBottom:4},children:["國家/地區：",G.country||"未填寫"]}),i.jsxs("div",{style:{color:"#888",fontSize:15,marginBottom:4},children:["性別：",G.gender||"未填寫"]}),i.jsxs("div",{style:{color:"#888",fontSize:15,marginBottom:4},children:["目標：",((se=zt.goalOptions[G.goal])==null?void 0:se[r])||G.goal]}),i.jsxs("div",{style:{color:"#888",fontSize:15,marginBottom:12},children:["技能：",G.skills||"未填寫"]}),i.jsxs("div",{style:{display:"flex",gap:16,marginTop:24},children:[i.jsx("button",{onClick:()=>{const me=document.getElementById("user-card");me&&(X("out"),me.animate([{transform:"translateX(0) scale(1)",opacity:1},{transform:"translateX(120%) scale(0.4)",opacity:0}],{duration:400})),setTimeout(()=>{g(Ie=>(X("in"),(Ie-1+Q.length)%Q.length))},400)},style:{padding:"10px 28px",borderRadius:8,border:"1.5px solid #bbb",background:"#fff",color:"#888",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:"0 2px 8px #0001",transition:"all 0.2s"},children:"跳過"}),i.jsx("button",{onClick:()=>xe(G.id,G),style:{padding:"10px 28px",borderRadius:8,border:"1.5px solid #6B5BFF",background:"#6B5BFF",color:"#fff",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:"0 2px 8px #6B5BFF22",transition:"all 0.2s"},children:"建立連結"})]})]}):null})()}),_==="chat"&&i.jsx("div",{children:"聊天室功能開發中"}),_==="links"&&i.jsx(ox,{embedded:!0}),_==="invites"&&i.jsx(sx,{embedded:!0})]})}),i.jsx("div",{style:{position:"absolute",bottom:0,left:340,right:0,zIndex:100},children:i.jsx("div",{style:{width:"100%",margin:"0 auto",marginTop:24,background:"rgba(255,255,255,0.95)",borderRadius:16,padding:"16px",boxShadow:"0 2px 12px #6B5BFF22"},children:i.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:20,flexWrap:"wrap"},children:[i.jsx("a",{href:"/about",style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12},children:r==="zh-TW"?"🧬 Restarter™｜我們是誰":r==="zh-CN"?"🧬 Restarter™｜我们是谁":r==="en"?"🧬 Restarter™｜Who We Are":r==="ja"?"🧬 Restarter™｜私たちについて":r==="ko"?"🧬 Restarter™｜우리는 누구인가":r==="th"?"🧬 Restarter™｜เราเป็นใคร":r==="vi"?"🧬 Restarter™｜Chúng tôi là ai":r==="ms"?"🧬 Restarter™｜Siapa Kami":"🧬 Restarter™｜Quis sumus"}),i.jsx("a",{href:"/privacy-policy",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12},children:r==="zh-TW"?"隱私權政策":r==="zh-CN"?"隐私政策":r==="en"?"Privacy Policy":r==="ja"?"プライバシーポリシー":r==="ko"?"개인정보 처리방침":r==="th"?"นโยบายความเป็นส่วนตัว":r==="vi"?"Chính sách bảo mật":r==="ms"?"Dasar Privasi":"Consilium de Privata"}),i.jsx("a",{href:"/terms",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12},children:r==="zh-TW"?"條款/聲明":r==="zh-CN"?"条款/声明":r==="en"?"Terms/Statement":r==="ja"?"規約/声明":r==="ko"?"약관/성명":r==="th"?"ข้อกำหนด/แถลงการณ์":r==="vi"?"Điều khoản/Tuyên bố":r==="ms"?"Terma/Pernyataan":"Termini/Declaratio"}),i.jsx("a",{href:"/data-deletion",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12},children:r==="zh-TW"?"資料刪除說明":r==="zh-CN"?"数据删除说明":r==="en"?"Data Deletion":r==="ja"?"データ削除について":r==="ko"?"데이터 삭제 안내":r==="th"?"คำอธิบายการลบข้อมูล":r==="vi"?"Giải thích xóa dữ liệu":r==="ms"?"Penjelasan Penghapusan Data":"Explicatio Deletionis Datae"}),i.jsx("a",{href:"/feedback",style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12},children:r==="zh-TW"?"💬 意見箱｜我們想聽你說":r==="zh-CN"?"💬 意见箱｜我们想听你说":r==="en"?"💬 Feedback Box｜We Want to Hear From You":r==="ja"?"💬 ご意見箱｜私たちはあなたの声を聞きたい":r==="ko"?"💬 피드백｜우리는 당신의 말을 듣고 싶습니다":r==="th"?"💬 กล่องความคิดเห็น｜เราอยากได้ยินจากคุณ":r==="vi"?"💬 Hộp góp ý｜Chúng tôi muốn nghe từ bạn":r==="ms"?"💬 Kotak Maklum Balas｜Kami Ingin Mendengar Dari Anda":"💬 Arca Consilii｜Volumus Audire a Te"})]})})})]}),ce&&i.jsx("div",{style:{position:"fixed",top:32,left:"50%",transform:"translateX(-50%)",background:"#1976d2",color:"#fff",padding:"14px 32px",borderRadius:16,fontSize:18,fontWeight:700,zIndex:9999,boxShadow:"0 2px 16px #1976d288",letterSpacing:1,textAlign:"center",opacity:.97},children:ce})]})}function LN(){try{return JSON.parse(localStorage.getItem("messages")||"[]")}catch{return[]}}function ON(){const n=localStorage.getItem("userId")||"",e=LN(),t=localStorage.getItem("lang")||"zh-TW",r={"zh-TW":{title:"我的留言箱",noMessages:"目前沒有收到任何留言",messageFrom:"留言：",aboutPost:"針對你的貼文：「"},"zh-CN":{title:"我的留言箱",noMessages:"目前没有收到任何留言",messageFrom:"留言：",aboutPost:"针对你的贴文：「"},en:{title:"My Inbox",noMessages:"No messages received yet",messageFrom:"message:",aboutPost:'About your post: "'},ja:{title:"メッセージボックス",noMessages:"まだメッセージがありません",messageFrom:"メッセージ：",aboutPost:"あなたの投稿について：「"},ko:{title:"내 메시지함",noMessages:"아직 받은 메시지가 없습니다",messageFrom:"메시지:",aboutPost:'당신의 게시물에 대해: "'},vi:{title:"Hộp thư của tôi",noMessages:"Chưa có tin nhắn nào",messageFrom:"tin nhắn:",aboutPost:'Về bài đăng của bạn: "'},th:{title:"กล่องข้อความของฉัน",noMessages:"ยังไม่มีข้อความ",messageFrom:"ข้อความ:",aboutPost:'เกี่ยวกับโพสต์ของคุณ: "'},la:{title:"Mea Inbox",noMessages:"Nondum epistulae receptae",messageFrom:"epistula:",aboutPost:'De tuo post: "'},ms:{title:"Peti Surat Saya",noMessages:"Belum ada mesej diterima",messageFrom:"mesej:",aboutPost:'Mengenai siaran anda: "'}},o=r[t]||r.en,a=e.flatMap(c=>(c.comments||[]).filter(d=>d.toUserId===n).map(d=>({...d,post:c.text,from:c.user.name})));return i.jsx("div",{className:"modern-bg",style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center"},children:i.jsxs("div",{className:"modern-container",style:{maxWidth:600,width:"100%",margin:"0 auto",padding:32},children:[i.jsx("h2",{style:{textAlign:"center",color:"#6B5BFF",fontWeight:900,marginBottom:24},children:o.title}),a.length===0&&i.jsx("div",{style:{color:"#bbb",textAlign:"center"},children:o.noMessages}),a.map((c,d)=>i.jsxs("div",{style:{background:"#f7f7ff",borderRadius:12,padding:16,boxShadow:"0 2px 8px #6B5BFF11",marginBottom:16},children:[i.jsxs("div",{style:{color:"#6B5BFF",fontWeight:700},children:[c.from," ",o.messageFrom]}),i.jsx("div",{style:{color:"#232946",margin:"8px 0"},children:c.content}),i.jsxs("div",{style:{color:"#6B4F27",fontSize:14},children:[o.aboutPost,c.post,"」"]})]},d))]})})}const XS={"zh-TW":{title:"AI 風格回覆",comingSoon:"體驗即將開放，敬請期待！",playing:"播放中...",playAudio:"播放語音"},"zh-CN":{title:"AI 风格回复",comingSoon:"体验即将开放，敬请期待！",playing:"播放中...",playAudio:"播放语音"},en:{title:"AI-Styled Reply",comingSoon:"Experience coming soon, stay tuned!",playing:"Playing...",playAudio:"Play Audio"},ja:{title:"AI風返信",comingSoon:"体験は近日公開予定です、お楽しみに！",playing:"再生中...",playAudio:"音声を再生"},ko:{title:"AI 스타일 응답",comingSoon:"체험이 곧 시작될 예정이니 기대해주세요!",playing:"재생 중...",playAudio:"오디오 재생"},vi:{title:"Trả lời theo phong cách AI",comingSoon:"Trải nghiệm sắp ra mắt, hãy theo dõi!",playing:"Đang phát...",playAudio:"Phát âm thanh"},th:{title:"การตอบกลับสไตล์ AI",comingSoon:"ประสบการณ์กำลังจะมาเร็วๆ นี้ โปรดติดตาม!",playing:"กำลังเล่น...",playAudio:"เล่นเสียง"},la:{title:"Responsum Stilo AI",comingSoon:"Experientia mox praesto erit, mane exspectans!",playing:"Ludens...",playAudio:"Sonum redde"},ms:{title:"Balasan Gaya AI",comingSoon:"Pengalaman akan datang, nantikan!",playing:"Sedang dimainkan...",playAudio:"Mainkan Audio"}};function WN(){const[n,e]=Un.useState(!1),[t,r]=Un.useState(()=>localStorage.getItem("lang")||"zh-TW"),o=XS[t]||XS["zh-TW"];Un.useEffect(()=>{localStorage.setItem("lang",t)},[t]);const a=()=>{e(!0),setTimeout(()=>e(!1),3e3)};return i.jsxs("div",{className:"modern-bg",style:{minHeight:"100vh",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",position:"relative"},children:[i.jsx($n,{}),i.jsxs("div",{className:"modern-container",style:{maxWidth:480,width:"100%",margin:"0 auto",textAlign:"center",padding:48,borderRadius:18,background:"rgba(60,40,20,0.18)",boxShadow:"0 4px 24px #0002"},children:[i.jsx("h2",{style:{color:"#6B5BFF",fontWeight:900,fontSize:28,marginBottom:24},children:o.title}),i.jsx("div",{style:{color:"#6B4F27",fontSize:22,fontWeight:700},children:o.comingSoon}),i.jsx("button",{onClick:a,style:{padding:"6px 18px",borderRadius:8,background:"#6c63ff",color:"#fff",border:"none",fontWeight:700,fontSize:16,marginTop:8},disabled:n,children:n?o.playing:o.playAudio})]})]})}const VN=[{code:"zh-TW",label:"繁中"},{code:"zh-CN",label:"简中"},{code:"en",label:"EN"},{code:"ja",label:"日本語"},{code:"ko",label:"한국어"},{code:"vi",label:"Tiếng Việt"},{code:"th",label:"ไทย"},{code:"la",label:"Latina"},{code:"ms",label:"Bahasa Melayu"}],JS={"zh-TW":{title:"擬真語音輸出",comingSoon:"體驗即將開放，敬請期待！",playing:"播放中...",playAudio:"播放語音"},"zh-CN":{title:"拟真语音输出",comingSoon:"体验即将开放，敬请期待！",playing:"播放中...",playAudio:"播放语音"},en:{title:"Realistic TTS",comingSoon:"Experience coming soon, stay tuned!",playing:"Playing...",playAudio:"Play Audio"},ja:{title:"リアルな音声出力",comingSoon:"体験は近日公開予定です、お楽しみに！",playing:"再生中...",playAudio:"音声を再生"},ko:{title:"사실적인 음성 출력",comingSoon:"체험이 곧 시작될 예정이니 기대해주세요!",playing:"재생 중...",playAudio:"오디오 재생"},vi:{title:"Đầu ra giọng nói thực tế",comingSoon:"Trải nghiệm sắp ra mắt, hãy theo dõi!",playing:"Đang phát...",playAudio:"Phát âm thanh"},th:{title:"การส่งออกเสียงที่สมจริง",comingSoon:"ประสบการณ์กำลังจะมาเร็วๆ นี้ โปรดติดตาม!",playing:"กำลังเล่น...",playAudio:"เล่นเสียง"},la:{title:"Sermo Verus Output",comingSoon:"Experientia mox praesto erit, mane exspectans!",playing:"Ludens...",playAudio:"Sonum redde"},ms:{title:"Output Suara Realistik",comingSoon:"Pengalaman akan datang, nantikan!",playing:"Sedang dimainkan...",playAudio:"Mainkan Audio"}};function ZS(){const[n,e]=Un.useState(!1),[t,r]=Un.useState("zh-TW"),o=JS[t]||JS["zh-TW"];Un.useEffect(()=>{const c=localStorage.getItem("lang");c&&VN.find(d=>d.code===c)&&r(c)},[]),Un.useEffect(()=>{localStorage.setItem("lang",t)},[t]);const a=()=>{e(!0),setTimeout(()=>e(!1),2e3)};return i.jsxs("div",{className:"modern-bg",style:{minHeight:"100vh",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",position:"relative"},children:[i.jsx("div",{style:{position:"absolute",top:24,right:36,zIndex:100},children:i.jsx($n,{})}),i.jsxs("div",{className:"modern-container",style:{maxWidth:480,width:"100%",margin:"0 auto",textAlign:"center",padding:48,borderRadius:18,background:"rgba(60,40,20,0.18)",boxShadow:"0 4px 24px #0002"},children:[i.jsx("h2",{style:{color:"#6B5BFF",fontWeight:900,fontSize:28,marginBottom:24},children:o.title}),i.jsx("div",{style:{color:"#6B4F27",fontSize:22,fontWeight:700},children:o.comingSoon}),i.jsx("button",{onClick:a,style:{padding:"6px 18px",borderRadius:8,background:"#6c63ff",color:"#fff",border:"none",fontWeight:700,fontSize:16,marginTop:8},disabled:n,children:n?o.playing:o.playAudio})]})]})}const ek={"zh-TW":{back:"返回",logout:"登出",title:"重啟之路",subtitle:"一步步走出迷霧，看見全新的自己",steps:[{title:"第一站：迷霧山谷",desc:"寫下最近一件讓你感到強烈情緒的事。不必評判自己，單純描述事情的經過、你的感受，以及這個感受帶來的影響。",placeholder:"在這裡寫下你的故事...(300字內)"},{title:"第二站：希望之丘",desc:"回顧你剛剛寫下的事件，請思考：在那個情境下，你有沒有做過什麼小小的努力或嘗試？即使很微小，也請寫下來。",placeholder:"寫下你做過的努力或嘗試...(300字內)"},{title:"第三站：勇氣森林",desc:"根據你剛剛發現的努力或資源，請設定一個你願意嘗試的小行動，並寫下你預期會遇到的困難，以及你打算怎麼面對。",placeholder:"寫下你的小行動與預期困難...(300字內)"},{title:"第四站：智慧溪流",desc:"回顧你剛剛的行動經驗，請反思：這個過程中，你學到了什麼？有沒有什麼新的發現或領悟？",placeholder:"寫下你的學習與領悟...(300字內)"},{title:"第五站：重啟之巔",desc:"綜合前面所有關卡的經歷，請寫下你給未來自己的祝福或期許，並思考：如果未來再遇到困難，你會怎麼鼓勵自己？",placeholder:"寫下給自己的祝福或期許...(300字內)"}],submit:"提交，尋求指引",loading:"請稍候...",next:"前往下一站",finish:"恭喜你完成重啟之路！",finishSub:"未來也請繼續善待自己！",error:"發生錯誤，請稍後再試。",retry:"再來一次"},"zh-CN":{back:"返回首页",logout:"登出",title:"日常任务挑战",subtitle:"一步步走出迷雾，看见全新的自己",steps:[{title:"第一站：迷雾山谷",desc:"写下最近一件让你感到强烈情绪的事。不必评判自己，单纯描述事情的经过、你的感受，以及这个感受带来的影响。",placeholder:"在这里写下你的故事...(300字内)"},{title:"第二站：希望之丘",desc:"回顾你刚刚写下的事件，请思考：在那个情境下，你有没有做过什么小小的努力或尝试？即使很微小，也请写下来。",placeholder:"写下你做过的努力或尝试...(300字内)"},{title:"第三站：勇气森林",desc:"根据你刚刚发现的努力或资源，请设定一个你愿意尝试的小行动，并写下你预期会遇到的困难，以及你打算怎么面对。",placeholder:"写下你的小行动与预期困难...(300字内)"},{title:"第四站：智慧溪流",desc:"回顾你刚刚的行动经验，请反思：这个过程中，你学到了什么？有没有什么新的发现或领悟？",placeholder:"写下你的学习与领悟...(300字内)"},{title:"第五站：重启之巅",desc:"综合前面所有关卡的经历，请写下你给未来自己的祝福或期许，并思考：如果未来再遇到困难，你会怎么鼓励自己？",placeholder:"写下给自己的祝福或期许...(300字内)"}],submit:"提交，寻求指引",loading:"请稍候...",next:"前往下一站",finish:"恭喜你完成重启之路！",finishSub:"未来也请继续善待自己！",error:"发生错误，请稍后再试。",retry:"再来一次"},en:{back:"Back to Home",logout:"Logout",title:"Restart Journey",subtitle:"Step by step out of the mist, see a new self",steps:[{title:"Step 1: Misty Valley",desc:"Write about a recent event that made you feel strong emotions. No need to judge yourself, just describe what happened, how you felt, and how it affected you.",placeholder:"Write your story here...(300 words max)"},{title:"Step 2: Hill of Hope",desc:"Review the event you just wrote. Did you make any small effort or try anything in that situation? Even if it was minor, write it down.",placeholder:"Write your effort or attempt...(300 words max)"},{title:"Step 3: Forest of Courage",desc:"Based on your discovered effort or resources, set a small action you are willing to try, and write down the difficulties you expect and how you plan to face them.",placeholder:"Write your action and expected difficulties...(300 words max)"},{title:"Step 4: Stream of Wisdom",desc:"Reflect on your action experience. What did you learn? Any new discoveries or insights?",placeholder:"Write your learning and insights...(300 words max)"},{title:"Step 5: Summit of Restart",desc:"Summarize all your experiences and write a blessing or expectation for your future self. If you face difficulties again, how will you encourage yourself?",placeholder:"Write your blessing or expectation...(300 words max)"}],submit:"Submit for Guidance",loading:"Please wait...",next:"Next Step",finish:"Congratulations on completing your restart journey!",finishSub:"Please continue to be kind to yourself in the future!",error:"An error occurred, please try again later.",retry:"Try Again"},ja:{back:"ホームに戻る",logout:"ログアウト",title:"日課ミッション挑戦",subtitle:"一歩ずつ霧を抜けて、新しい自分に出会おう",steps:[{title:"第1ステップ：霧の谷",desc:"最近あなたが強い感情を抱いた出来事について書いてください。自分を評価せず、出来事の経過や感情、その影響を素直に書きましょう。",placeholder:"ここにあなたのストーリーを書いてください...(300字以内)"},{title:"第2ステップ：希望の丘",desc:"先ほど書いた出来事を振り返り、その状況であなたが行った小さな努力や試みがあれば書いてください。些細なことでも構いません。",placeholder:"あなたの努力や試みを書いてください...(300字以内)"},{title:"第3ステップ：勇気の森",desc:"発見した努力やリソースをもとに、挑戦したい小さな行動と、予想される困難、それにどう向き合うかを書いてください。",placeholder:"行動と予想される困難を書いてください...(300字以内)"},{title:"第4ステップ：知恵の流れ",desc:"行動の経験を振り返り、学んだことや新たな気づきがあれば書いてください。",placeholder:"学びや気づきを書いてください...(300字以内)"},{title:"第5ステップ：再出発の頂",desc:"これまでの経験をまとめ、未来の自分へのメッセージや期待を書いてください。困難に直面したとき、どう自分を励ますかも考えてみましょう。",placeholder:"未来の自分へのメッセージや期待を書いてください...(300字以内)"}],submit:"提出して指導を求める",loading:"お待ちください...",next:"次のステップへ",finish:"再出発の道を完了しました！",finishSub:"これからも自分を大切にしてください！",error:"エラーが発生しました。しばらくしてから再度お試しください。",retry:"もう一度"},ko:{back:"홈으로",logout:"로그아웃",title:"일일 미션 도전",subtitle:"한 걸음씩 안개를 걷고, 새로운 나를 만나보세요",steps:[{title:"1단계: 안개의 계곡",desc:"최근에 강한 감정을 느꼈던 일을 적어보세요. 자신을 평가하지 말고, 그 일의 과정과 감정, 그리고 그 감정이 가져온 영향을 솔직하게 적어보세요.",placeholder:"여기에 당신의 이야기를 적어주세요...(300자 이내)"},{title:"2단계: 희망의 언덕",desc:"방금 적은 일을 돌아보며, 그 상황에서 했던 작은 노력이나 시도가 있다면 적어보세요. 아주 사소한 것도 괜찮아요.",placeholder:"노력이나 시도를 적어주세요...(300자 이내)"},{title:"3단계: 용기의 숲",desc:"발견한 노력이나 자원을 바탕으로, 시도해보고 싶은 작은 행동과 예상되는 어려움, 그리고 어떻게 대처할지 적어보세요.",placeholder:"행동과 예상되는 어려움을 적어주세요...(300자 이내)"},{title:"4단계: 지혜의 시냇물",desc:"행동 경험을 돌아보며, 배운 점이나 새로운 깨달음이 있다면 적어보세요.",placeholder:"배운 점이나 깨달음을 적어주세요...(300자 이내)"},{title:"5단계: 재시작의 정상",desc:"지금까지의 경험을 종합해 미래의 나에게 전하고 싶은 메시지나 기대를 적어보세요. 앞으로 어려움이 닥칠 때 어떻게 자신을 격려할지도 생각해보세요.",placeholder:"미래의 나에게 전하고 싶은 메시지나 기대를 적어주세요...(300자 이내)"}],submit:"제출하고 안내받기",loading:"잠시만 기다려주세요...",next:"다음 단계로",finish:"재시작의 여정을 완료했습니다!",finishSub:"앞으로도 자신을 소중히 하세요!",error:"오류가 발생했습니다. 잠시 후 다시 시도해주세요.",retry:"다시 시도"},th:{back:"กลับหน้าหลัก",logout:"ออกจากระบบ",title:"ภารกิจประจำวัน",subtitle:"ก้าวออกจากหมอกทีละก้าว พบกับตัวเองในมุมใหม่",steps:[{title:"ขั้นที่ 1: หุบเขาหมอก",desc:"เขียนเกี่ยวกับเหตุการณ์ล่าสุดที่ทำให้คุณรู้สึกอารมณ์รุนแรง ไม่ต้องตัดสินตัวเอง เพียงบรรยายเหตุการณ์ ความรู้สึก และผลกระทบที่เกิดขึ้น",placeholder:"เขียนเรื่องราวของคุณที่นี่...(300 คำ)"},{title:"ขั้นที่ 2: เนินแห่งความหวัง",desc:"ทบทวนเหตุการณ์ที่เพิ่งเขียนไป มีความพยายามหรือการลองทำอะไรเล็กๆ ในสถานการณ์นั้นหรือไม่ แม้จะเล็กน้อยก็เขียนได้",placeholder:"เขียนความพยายามหรือสิ่งที่ลองทำ...(300 คำ)"},{title:"ขั้นที่ 3: ป่าแห่งความกล้าหาญ",desc:"จากความพยายามหรือทรัพยากรที่ค้นพบ กำหนดการกระทำเล็กๆ ที่อยากลอง พร้อมทั้งอุปสรรคที่คาดว่าจะเจอและวิธีรับมือ",placeholder:"เขียนการกระทำและอุปสรรคที่คาดไว้...(300 คำ)"},{title:"ขั้นที่ 4: ลำธารแห่งปัญญา",desc:"ทบทวนประสบการณ์การกระทำของคุณ มีอะไรที่ได้เรียนรู้หรือค้นพบใหม่ๆ หรือไม่",placeholder:"เขียนสิ่งที่ได้เรียนรู้หรือค้นพบ...(300 คำ)"},{title:"ขั้นที่ 5: ยอดเขาแห่งการเริ่มต้นใหม่",desc:"สรุปประสบการณ์ทั้งหมด เขียนคำอวยพรหรือความคาดหวังถึงตัวเองในอนาคต หากเจออุปสรรคอีกจะให้กำลังใจตัวเองอย่างไร",placeholder:"เขียนคำอวยพรหรือความคาดหวัง...(300 คำ)"}],submit:"ส่งและขอคำแนะนำ",loading:"กรุณารอสักครู่...",next:"ไปยังขั้นถัดไป",finish:"คุณสำเร็จภารกิจเริ่มต้นใหม่แล้ว!",finishSub:"ขอให้ดูแลตัวเองต่อไป!",error:"เกิดข้อผิดพลาด กรุณาลองใหม่อีกครั้งภายหลัง",retry:"ลองอีกครั้ง"},vi:{back:"Về trang chủ",logout:"Đăng xuất",title:"Thử thách nhiệm vụ hàng ngày",subtitle:"Từng bước vượt qua sương mù, khám phá bản thân mới",steps:[{title:"Bước 1: Thung lũng sương mù",desc:"Viết về một sự kiện gần đây khiến bạn cảm xúc mạnh. Không cần phán xét bản thân, chỉ cần mô tả diễn biến, cảm xúc và ảnh hưởng của nó.",placeholder:"Viết câu chuyện của bạn tại đây...(300 từ)"},{title:"Bước 2: Đồi hy vọng",desc:"Xem lại sự kiện vừa viết, bạn có nỗ lực hoặc thử điều gì nhỏ không? Dù nhỏ cũng hãy ghi lại.",placeholder:"Viết nỗ lực hoặc điều bạn đã thử...(300 từ)"},{title:"Bước 3: Rừng dũng cảm",desc:"Dựa trên nỗ lực hoặc nguồn lực vừa phát hiện, hãy đặt ra một hành động nhỏ muốn thử, dự đoán khó khăn và cách đối mặt.",placeholder:"Viết hành động và khó khăn dự đoán...(300 từ)"},{title:"Bước 4: Suối trí tuệ",desc:"Xem lại trải nghiệm hành động, bạn học được gì? Có phát hiện hay nhận thức mới không?",placeholder:"Viết điều bạn học được hoặc nhận ra...(300 từ)"},{title:"Bước 5: Đỉnh tái khởi động",desc:"Tổng hợp mọi trải nghiệm, viết lời chúc hoặc kỳ vọng cho bản thân tương lai. Nếu gặp khó khăn, bạn sẽ động viên mình thế nào?",placeholder:"Viết lời chúc hoặc kỳ vọng...(300 từ)"}],submit:"Gửi và nhận hướng dẫn",loading:"Vui lòng chờ...",next:"Bước tiếp theo",finish:"Chúc mừng bạn đã hoàn thành hành trình tái khởi động!",finishSub:"Hãy tiếp tục yêu thương bản thân nhé!",error:"Đã xảy ra lỗi, vui lòng thử lại sau.",retry:"Thử lại"},la:{back:"Redi ad domum",logout:"Exire",title:"Provocatio Cotidiana",subtitle:"Gradatim e nebula progredere, novum te aspice",steps:[{title:"Gradus I: Vallis Nebulosa",desc:"Scribe de re nuper te vehementer commotum. Te ipsum iudicare noli, sed simpliciter rem, sensus tuos, et effectus describas.",placeholder:"Hic fabulam tuam scribe...(300 verba)"},{title:"Gradus II: Collis Spei",desc:"Recense rem modo scriptam. In illa condicione quid parvum conatus es? Etiam minima, scribe.",placeholder:"Conatum tuum scribe...(300 verba)"},{title:"Gradus III: Silva Virtutis",desc:"Ex conatu aut opibus inventis, parvam actionem temptare velis, difficultates praevides et quomodo eas superaturus sis scribe.",placeholder:"Actionem et difficultates scribe...(300 verba)"},{title:"Gradus IV: Rivus Sapientiae",desc:"Recense experientiam actionis. Quid didicisti? Quid novi invenisti?",placeholder:"Quae didicisti scribe...(300 verba)"},{title:"Gradus V: Culmen Renovationis",desc:"Omnia experientia colligens, votum aut spem tibi futuro scribe. Si iterum difficultates occurrant, quomodo te hortaberis?",placeholder:"Votum aut spem scribe...(300 verba)"}],submit:"Mitte et consilium pete",loading:"Exspecta quaeso...",next:"Ad gradum proximum",finish:"Iter renovationis confecisti!",finishSub:"Te ipsum semper cura!",error:"Error factus est, quaeso postea repete.",retry:"Iterum conare"},ms:{back:"Kembali ke Laman Utama",logout:"Log keluar",title:"Cabaran Misi Harian",subtitle:"Melangkah keluar dari kabus, temui diri baharu",steps:[{title:"Langkah 1: Lembah Berkabus",desc:"Tulis tentang peristiwa baru-baru ini yang membuatkan anda beremosi kuat. Tidak perlu menilai diri, hanya gambarkan peristiwa, perasaan dan kesannya.",placeholder:"Tulis kisah anda di sini...(300 patah perkataan)"},{title:"Langkah 2: Bukit Harapan",desc:"Imbas kembali peristiwa tadi, adakah anda berusaha atau mencuba sesuatu walaupun kecil? Catatkan walaupun kecil.",placeholder:"Tulis usaha atau percubaan anda...(300 patah perkataan)"},{title:"Langkah 3: Hutan Keberanian",desc:"Berdasarkan usaha atau sumber yang ditemui, tetapkan tindakan kecil yang ingin dicuba, jangka cabaran dan cara menghadapinya.",placeholder:"Tulis tindakan dan cabaran dijangka...(300 patah perkataan)"},{title:"Langkah 4: Sungai Kebijaksanaan",desc:"Imbas kembali pengalaman tindakan anda, apa yang anda pelajari? Ada penemuan atau kesedaran baharu?",placeholder:"Tulis apa yang anda pelajari...(300 patah perkataan)"},{title:"Langkah 5: Puncak Permulaan Semula",desc:"Gabungkan semua pengalaman, tulis harapan atau ucapan untuk diri masa depan. Jika hadapi cabaran lagi, bagaimana anda akan beri semangat pada diri?",placeholder:"Tulis harapan atau ucapan...(300 patah perkataan)"}],submit:"Hantar & mohon panduan",loading:"Sila tunggu...",next:"Langkah seterusnya",finish:"Tahniah, anda telah tamat perjalanan permulaan semula!",finishSub:"Teruskan sayangi diri anda!",error:"Ralat berlaku, sila cuba lagi kemudian.",retry:"Cuba lagi"}};function tk(){var O,L,C,A;const n=Et(),e=St(),{lang:t}=Lt(),r=ek["zh-TW"],o=ek[t]||r,a={...r,...o,steps:o.steps||r.steps,submit:o.submit||r.submit,loading:o.loading||r.loading,next:o.next||r.next,finish:o.finish||r.finish,finishSub:o.finishSub||r.finishSub,error:o.error||r.error,retry:o.retry||r.retry},[c,d]=v.useState(0),[h,m]=v.useState(""),[g,x]=v.useState([]),[S,j]=v.useState(""),[T,R]=v.useState(!1),[I,F]=v.useState(!1),P=(O=a.steps)==null?void 0:O[c];v.useEffect(()=>{var D;if(S&&c===(((D=a.steps)==null?void 0:D.length)||0)-1){F(!0);const M=setTimeout(()=>F(!1),3e3);return()=>clearTimeout(M)}},[S,c]);const z=async D=>{D.preventDefault(),R(!0),j("");try{console.log("Sending request to /api/mission-ai with:",{step:c,input:h,history:g});const M=await fetch("/api/mission-ai",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({step:c,input:h,history:g})});if(console.log("Response status:",M.status),!M.ok)throw new Error(`HTTP error! status: ${M.status}`);const B=await M.json();console.log("Response data:",B),j(B.reply||"AI教練祝福你！"),x(_=>[..._,h])}catch(M){console.error("Error in handleSubmit:",M),j("發生錯誤，請稍後再試。錯誤詳情："+(M instanceof Error?M.message:"未知錯誤"))}finally{R(!1)}},H=()=>{m(""),j(""),d(c+1)},J=()=>i.jsxs("div",{style:{position:"fixed",left:0,top:0,width:"100vw",height:"100vh",pointerEvents:"none",zIndex:9999,display:"flex",justifyContent:"center",alignItems:"center"},children:[i.jsx("iframe",{src:"https://embed.lottiefiles.com/animation/85716",style:{width:400,height:400,border:"none",background:"transparent"},title:"fireworks1"}),i.jsx("iframe",{src:"https://embed.lottiefiles.com/animation/85716",style:{width:400,height:400,border:"none",background:"transparent",position:"absolute",left:"20vw",top:"10vh"},title:"fireworks2"}),i.jsx("iframe",{src:"https://embed.lottiefiles.com/animation/85716",style:{width:400,height:400,border:"none",background:"transparent",position:"absolute",right:"20vw",top:"20vh"},title:"fireworks3"})]});return i.jsxs("div",{style:{minHeight:"100vh",width:"100vw",position:"relative",overflowX:"hidden",background:"url('/mountain.png') center center / cover no-repeat fixed, linear-gradient(to bottom, #eaf6ff 0%, #f7fafc 100%)"},children:[i.jsx("button",{onClick:()=>n("/"),style:{position:"absolute",top:"20px",left:"20px",zIndex:1e3,fontWeight:700,fontSize:16,padding:"8px 16px",borderRadius:8,border:"1.5px solid #6B5BFF",background:"#fff",color:"#6B5BFF",cursor:"pointer",minWidth:80,boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:a.back}),i.jsxs("div",{style:{position:"absolute",top:"20px",right:"20px",zIndex:1e3,display:"flex",alignItems:"center",gap:12},children:[i.jsx("button",{onClick:async()=>{await Er(e),localStorage.clear(),window.location.href="/"},style:{fontWeight:700,fontSize:16,padding:"8px 16px",borderRadius:8,border:"1.5px solid #6B5BFF",background:"#fff",color:"#6B5BFF",cursor:"pointer",minWidth:80,boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:a.logout}),i.jsx("div",{style:{width:80},children:i.jsx($n,{style:{width:"100%"}})})]}),i.jsx("div",{style:{width:"100%",maxWidth:700,margin:"20px auto 20px auto",padding:"16px 24px",background:"rgba(255,255,255,0.95)",borderRadius:16,boxShadow:"0 4px 20px rgba(0,0,0,0.1)",display:"flex",alignItems:"center",justifyContent:"center",position:"relative"},children:i.jsxs("h1",{style:{fontWeight:900,fontSize:18,color:"#6B5BFF",margin:0,lineHeight:1,textShadow:"0 2px 8px #6B5BFF88",textAlign:"center"},children:[i.jsx("span",{role:"img","aria-label":"mission",children:"🎯"})," 挑戰任務"]})}),i.jsxs("div",{style:{maxWidth:600,margin:"0 auto",padding:"2rem 0 2rem 0",background:"rgba(255,255,255,0.92)",borderRadius:24,boxShadow:"0 8px 32px rgba(0,0,0,0.08)"},children:[i.jsx("h1",{style:{textAlign:"center",fontWeight:700,fontSize:"2rem",marginBottom:8},children:a.title}),i.jsx("div",{style:{textAlign:"center",color:"#666",marginBottom:32},children:a.subtitle}),i.jsxs("div",{style:{background:"#fff",borderRadius:16,padding:32,boxShadow:"0 2px 8px #0001",marginBottom:24},children:[i.jsx("div",{style:{fontWeight:700,fontSize:"1.3rem",color:"#2a5d8f",marginBottom:8},children:(P==null?void 0:P.title)||""}),i.jsx("div",{style:{color:"#333",marginBottom:24},children:(P==null?void 0:P.desc)||""}),i.jsxs("form",{onSubmit:z,children:[i.jsx("textarea",{value:h,onChange:D=>m(D.target.value),placeholder:(P==null?void 0:P.placeholder)||"",style:{width:"100%",minHeight:100,borderRadius:8,border:"1px solid #ccc",padding:12,marginBottom:16},required:!0}),i.jsx("button",{type:"submit",disabled:T||!h,style:{width:"100%",background:"#6B5BFF",color:"#fff",fontWeight:700,fontSize:18,border:"none",borderRadius:8,padding:"12px 0",cursor:T?"not-allowed":"pointer",opacity:T?.99:1,filter:"none",textShadow:"none",transition:"background 0.18s"},children:T?a.loading:a.submit})]}),S&&i.jsx("div",{style:{marginTop:24,background:"#f5f5f5",borderRadius:8,padding:16,color:"#2a5d8f"},children:S}),S&&c<(((L=a.steps)==null?void 0:L.length)||0)-1&&i.jsx("button",{onClick:H,style:{marginTop:16,width:"100%",background:"#6B5BFF",color:"#fff",fontWeight:700,fontSize:16,border:"none",borderRadius:8,padding:"10px 0",cursor:"pointer",transition:"background 0.18s"},children:a.next}),S&&c===(((C=a.steps)==null?void 0:C.length)||0)-1&&i.jsxs("div",{style:{marginTop:24,textAlign:"center",color:"#e6b800",fontWeight:700,fontSize:20},children:[a.finish,i.jsx("br",{}),i.jsx("span",{style:{fontSize:16,color:"#888"},children:a.finishSub}),I&&i.jsx(J,{}),i.jsx("div",{style:{marginTop:24},children:i.jsx("button",{onClick:()=>{d(0),m(""),x([]),j("")},style:{background:"#6B5BFF",color:"#fff",fontWeight:700,fontSize:16,border:"none",borderRadius:8,padding:"10px 32px",cursor:"pointer",marginTop:8,boxShadow:"0 2px 8px #0001",transition:"background 0.18s"},children:a.retry})})]})]}),i.jsx("div",{style:{textAlign:"center",color:"#aaa",fontSize:14},children:(a.steps||[]).map((D,M)=>i.jsx("span",{style:{display:"inline-block",width:18,height:18,borderRadius:"50%",background:M<=c?"#8ec6f7":"#e0e0e0",margin:"0 4px",border:M===c?"2px solid #2a5d8f":"none",transition:"all 0.2s"}},M))})]}),i.jsx("div",{style:{width:"100%",margin:"0 auto",marginTop:24,background:"rgba(255,255,255,0.95)",borderRadius:16,padding:"16px",boxShadow:"0 2px 12px #6B5BFF22"},children:i.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:20,flexWrap:"wrap"},children:[i.jsx("a",{href:"/about",style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12},children:t==="zh-TW"?"🧬 Restarter™｜我們是誰":t==="zh-CN"?"🧬 Restarter™｜我们是谁":t==="en"?"🧬 Restarter™｜Who We Are":t==="ja"?"🧬 Restarter™｜私たちについて":t==="ko"?"🧬 Restarter™｜우리는 누구인가":t==="th"?"🧬 Restarter™｜เราเป็นใคร":t==="vi"?"🧬 Restarter™｜Chúng tôi là ai":t==="ms"?"🧬 Restarter™｜Siapa Kami":"🧬 Restarter™｜Quis sumus"}),i.jsx("a",{href:"/privacy-policy",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12},children:t==="zh-TW"?"隱私權政策":t==="zh-CN"?"隐私政策":t==="en"?"Privacy Policy":t==="ja"?"プライバシーポリシー":t==="ko"?"개인정보 처리방침":t==="th"?"นโยบายความเป็นส่วนตัว":t==="vi"?"Chính sách bảo mật":t==="ms"?"Dasar Privasi":"Consilium de Privata"}),i.jsx("a",{href:"/terms",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12},children:t==="zh-TW"?"條款/聲明":t==="zh-CN"?"条款/声明":t==="en"?"Terms/Statement":t==="ja"?"規約/声明":t==="ko"?"약관/성명":t==="th"?"ข้อกำหนด/แถลงการณ์":t==="vi"?"Điều khoản/Tuyên bố":t==="ms"?"Terma/Pernyataan":"Termini/Declaratio"}),i.jsx("a",{href:"/data-deletion",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12},children:t==="zh-TW"?"資料刪除說明":t==="zh-CN"?"数据删除说明":t==="en"?"Data Deletion":t==="ja"?"データ削除について":t==="ko"?"데이터 삭제 안내":t==="th"?"คำอธิบายการลบข้อมูล":t==="vi"?"Giải thích xóa dữ liệu":t==="ms"?"Penjelasan Penghapusan Data":"Explicatio Deletionis Datae"}),i.jsx("a",{href:"/feedback",style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12},children:t==="zh-TW"?"💬 意見箱｜我們想聽你說":t==="zh-CN"?"💬 意见箱｜我们想听你说":t==="en"?"💬 Feedback Box｜We Want to Hear From You":t==="ja"?"💬 ご意見箱｜私たちはあなたの声を聞きたい":t==="ko"?"💬 피드백｜우리는 당신의 말을 듣고 싶습니다":t==="th"?"💬 กล่องความคิดเห็น｜เราอยากได้ยินจากคุณ":t==="vi"?"💬 Hộp góp ý｜Chúng tôi muốn nghe từ bạn":t==="ms"?"💬 Kotak Maklum Balas｜Kami Ingin Mendengar Dari Anda":"💬 Arca Consilii｜Volumus Audire a Te"})]})}),S&&c===(((A=a.steps)==null?void 0:A.length)||0)-1&&I&&i.jsx(J,{})]})}const UN={encouragement:"/videos/encouragement.mp4",reproach:"/videos/reproach.mp4",motivation:"/videos/motivation.mp4",disappointment:"/videos/disappointment.mp4",joy:"/videos/joy.mp4",lost:"/videos/lost.mp4",breakthrough:"/videos/breakthrough.mp4",clarity:"/videos/clarity.mp4",reluctance:"/videos/reluctance.mp4",confusion:"/videos/confusion.mp4",affection:"/videos/affection.mp4",regret:"/videos/regret.mp4",admiration:"/videos/admiration.mp4",teasing:"/videos/teasing.mp4"};function qN({reactionType:n,onEnd:e,style:t,className:r="",autoPlay:o=!0,...a}){const c=v.useRef(null);return v.useEffect(()=>{o&&c.current&&(c.current.currentTime=0,c.current.play())},[n,o]),i.jsx("div",{className:`video-reaction-player ${r}`,style:{position:"fixed",left:0,top:0,width:"100vw",height:"100vh",zIndex:3e3,background:"rgba(0,0,0,0.32)",display:"flex",alignItems:"center",justifyContent:"center",...t},...a,children:i.jsx("video",{ref:c,src:UN[n],style:{maxWidth:"90vw",maxHeight:"80vh",borderRadius:18,boxShadow:"0 8px 32px #0008",background:"#000"},autoPlay:o,onEnded:e,controls:!1,playsInline:!0})})}const DI=v.createContext({setVideoReaction:()=>{}});function HN(){return v.useContext(DI)}function $N({children:n}){const[e,t]=v.useState(null);return i.jsxs(DI.Provider,{value:{setVideoReaction:t},children:[n,e&&i.jsx(qN,{reactionType:e,onEnd:()=>t(null)})]})}const Qt={backToHome:{"zh-TW":"← 返回首頁","zh-CN":"← 返回首页",ja:"← ホームへ戻る",en:"← Home",ko:"← 홈으로 돌아가기",th:"← กลับหน้าหลัก",vi:"← Về trang chủ",ms:"← Kembali ke Laman Utama",la:"← Ad domum redire"},back:{"zh-TW":"↩ 返回上一頁","zh-CN":"↩ 返回上一页",ja:"↩ 前のページへ",en:"↩ Back",ko:"↩ 이전 페이지로",th:"↩ กลับไป",vi:"↩ Quay lại",ms:"↩ Kembali",la:"↩ Redire"},logout:{"zh-TW":"登出","zh-CN":"登出",ja:"ログアウト",en:"Logout",ko:"로그아웃",th:"ออกจากระบบ",vi:"Đăng xuất",ms:"Log keluar",la:"Exire"},pageTitle:{"zh-TW":"配對對聊 PairTalk","zh-CN":"配对对聊 PairTalk",ja:"ペアトーク PairTalk",en:"PairTalk",ko:"페어톡",th:"คู่คุย",vi:"Trò chuyện đôi",ms:"PairTalk",la:"PairTalk"},subtitle:{"zh-TW":"劫後餘生的交友最珍貴，沒人怕跨出第一步！","zh-CN":"劫后余生的交友最珍贵，没人怕跨出第一步！",en:"Friendship after hardship is the most precious, no one is afraid to take the first step!",ja:"困難を乗り越えた後の友情こそが最も貴重、一歩踏み出すのは誰も怖くない！",ko:"역경 후의 우정이 가장 소중하며, 첫 걸음을 내딛는 것을 두려워하는 사람은 아무도 없습니다!",th:"มิตรภาพหลังความยากลำบากนั้นมีค่าที่สุด ไม่มีใครกลัวที่จะก้าวแรก!",vi:"Tình bạn sau gian khó là quý giá nhất, không ai ngại bước bước đầu tiên!",ms:"Persahabatan selepas kesusahan adalah yang paling berharga, tiada siapa yang takut untuk mengambil langkah pertama!",la:"Amicitia post aerumnas pretiosissima est, nemo primum gradum timere metuit!"},matchStatus:{"zh-TW":"配對狀態","zh-CN":"配对状态",ja:"マッチ状況",en:"Match Status",ko:"매칭 상태",th:"สถานะการจับคู่",vi:"Tình trạng ghép đôi",ms:"Status Padanan",la:"Status Par"},empty:{"zh-TW":"目前沒有配對，等待系統為你尋找夥伴...","zh-CN":"目前没有配对，等待系统为你寻找伙伴...",en:"No matches yet. Waiting for a companion...",ja:"まだマッチがありません。相手を探しています...",ko:"아직 매칭이 없습니다. 상대를 기다리는 중...",th:"ยังไม่มีคู่ รอระบบหาคู่ให้อยู่...",vi:"Chưa có ai được ghép đôi. Đang chờ hệ thống tìm bạn đồng hành...",ms:"Tiada padanan lagi. Menunggu teman...",la:"Nulli pares adhuc. Socium exspectans..."},todayMatch:{"zh-TW":"今日配對：","zh-CN":"今日配对：",ja:"今日のマッチ：",en:"Today's Match:",ko:"오늘의 매칭:",th:"คู่ของวันนี้:",vi:"Ghép đôi hôm nay:",ms:"Padanan Hari Ini:",la:"Par Hodiernus:"},timeLeft:{"zh-TW":"剩餘時間：","zh-CN":"剩余时间：",ja:"残り時間：",en:"Time Left:",ko:"남은 시간:",th:"เวลาที่เหลือ:",vi:"Thời gian còn lại:",ms:"Masa Tinggal:",la:"Tempus Reliquum:"},archive:{"zh-TW":"封存對話","zh-CN":"封存对话",ja:"アーカイブ",en:"Archive",ko:"보관",th:"เก็บถาวร",vi:"Lưu trữ",ms:"Arkib",la:"Archivum"},rematch:{"zh-TW":"重配","zh-CN":"重配",ja:"再マッチ",en:"Rematch",ko:"재매칭",th:"จับคู่ใหม่",vi:"Ghép lại",ms:"Padan semula",la:"Repar"},history:{"zh-TW":"歷史配對","zh-CN":"历史配对",ja:"履歴",en:"History",ko:"기록",th:"ประวัติ",vi:"Lịch sử",ms:"Sejarah",la:"Historia"},viewDetails:{"zh-TW":"查看完整資料","zh-CN":"查看完整资料",ja:"詳細を見る",en:"View Details",ko:"상세 정보 보기",th:"ดูรายละเอียด",vi:"Xem chi tiết",ms:"Lihat Butiran",la:"Singula Videre"},hideDetails:{"zh-TW":"收合資料","zh-CN":"收起资料",ja:"閉じる",en:"Hide",ko:"숨기기",th:"ซ่อน",vi:"Ẩn",ms:"Sembunyi",la:"Celare"},nickname:{"zh-TW":"暱稱","zh-CN":"昵称",ja:"ニックネーム",en:"Nickname",ko:"닉네임",th:"ชื่อเล่น",vi:"Biệt danh",ms:"Nama Samaran",la:"Agnomen"},country:{"zh-TW":"國家","zh-CN":"国家",ja:"国",en:"Country",ko:"국가",th:"ประเทศ",vi:"Quốc gia",ms:"Negara",la:"Natio"},age:{"zh-TW":"年齡","zh-CN":"年龄",ja:"年齢",en:"Age",ko:"나이",th:"อายุ",vi:"Tuổi",ms:"Umur",la:"Aetas"},gender:{"zh-TW":"性別","zh-CN":"性别",ja:"性別",en:"Gender",ko:"성별",th:"เพศ",vi:"Giới tính",ms:"Jantina",la:"Genus"},interest:{"zh-TW":"興趣","zh-CN":"兴趣",ja:"趣味",en:"Interest",ko:"관심사",th:"ความสนใจ",vi:"Sở thích",ms:"Minat",la:"Studium"},eventType:{"zh-TW":"事件類型","zh-CN":"事件类型",ja:"イベントタイプ",en:"Event Type",ko:"이벤트 유형",th:"ประเภทเหตุการณ์",vi:"Loại sự kiện",ms:"Jenis Acara",la:"Genus Eventus"},bio:{"zh-TW":"簡介","zh-CN":"简介",ja:"自己紹介",en:"Bio",ko:"소개",th:"ประวัติ",vi:"Tiểu sử",ms:"Bio",la:"Bio"},sendGift:{"zh-TW":"送出禮物","zh-CN":"送出礼物",ja:"ギフトを送る",en:"Send Gift",ko:"선물 보내기",th:"ส่งของขวัญ",vi:"Gửi quà",ms:"Hantar Hadiah",la:"Donum Mittere"},sendEmail:{"zh-TW":"發送Email","zh-CN":"发送Email",ja:"メール送信",en:"Send Email",ko:"이메일 보내기",th:"ส่งอีเมล",vi:"Gửi Email",ms:"Hantar E-mel",la:"Epistulam Mittere"},next:{"zh-TW":"下一頁","zh-CN":"下一页",ja:"次へ",en:"Next",ko:"다음",th:"ถัดไป",vi:"Tiếp",ms:"Seterusnya",la:"Proximus"},lastPage:{"zh-TW":"最後一頁","zh-CN":"最后一页",ja:"最後のページ",en:"Last page",ko:"마지막 페이지",th:"หน้าสุดท้าย",vi:"Trang cuối",ms:"Halaman terakhir",la:"Pagina Ultima"}},GN=[{id:1,partner:"小明",status:"active",aiGuide:"你可以問對方：今天過得如何？"},{id:2,partner:"Sandy",status:"archived",aiGuide:"你可以問對方：最近有什麼開心的事？"}],ay=[{id:1,nickname:"Alice",country:"台灣",age:28,gender:"female",email:"alice@example.com",bio:"喜歡閱讀與旅行",interest:"閱讀",eventType:"經濟",avatar:"/avatars/female1.jpg"},{id:2,nickname:"Bob",country:"日本",age:32,gender:"male",email:"bob@example.com",bio:"音樂愛好者",interest:"音樂",eventType:"科技",avatar:"/avatars/male1.jpg"}],nk={"zh-TW":{male:"男性",female:"女性",other:"其他"},"zh-CN":{male:"男性",female:"女性",other:"其他"},en:{male:"Male",female:"Female",other:"Other"},ja:{male:"男性",female:"女性",other:"その他"},ko:{male:"남성",female:"여성",other:"기타"},th:{male:"ชาย",female:"หญิง",other:"อื่นๆ"},vi:{male:"Nam",female:"Nữ",other:"Khác"},ms:{male:"Lelaki",female:"Perempuan",other:"Lain-lain"},la:{male:"Mas",female:"Femina",other:"Aliud"}},rk=[{value:"🌹",label:"🌹"},{value:"💍",label:"💍"},{value:"🍰",label:"🍰"},{value:"🎩",label:"🎩"},{value:"🌺",label:"🌺"},{value:"👗",label:"👗"},{value:"✒️",label:"✒️"},{value:"🏎️",label:"🏎️"}],KN={"zh-TW":"歲","zh-CN":"岁",en:"yrs",ja:"歳",ko:"세",th:"ปี",vi:"tuổi",ms:"tahun",la:"anni"};function QN(){var A,D,M,B;const n=Et(),e=St(),t=((A=e.currentUser)==null?void 0:A.email)||"",r=Lt(),[o,a]=v.useState(JSON.parse(localStorage.getItem("pairs")||"[]")||GN),[c,d]=v.useState(300),[h,m]=v.useState(((D=o.find(_=>_.status==="active"))==null?void 0:D.id)||null),[g,x]=v.useState("AI：記得保持友善，互相傾聽！"),[S,j]=v.useState(0),T=ay[S],[R,I]=v.useState(!1),[F,P]=v.useState(rk[0].value),{setVideoReaction:z}=HN();Un.useEffect(()=>{if(h){const _=setInterval(()=>d(U=>U>0?U-1:0),1e3);return()=>clearInterval(_)}},[h]);const H=_=>{a(o.map(U=>U.id===_?{...U,status:"archived"}:U)),localStorage.setItem("pairs",JSON.stringify(o.map(U=>U.id===_?{...U,status:"archived"}:U))),z("disappointment")},J=()=>{z("breakthrough")},O=()=>{alert(`${F} 已送出給 ${T.nickname}！`)},L=()=>{window.location.href=`mailto:${T.email}?subject=PairTalk&body=Hi${t?`&from=${t}`:""}`},C=()=>{if(ay.length<=1||S===ay.length-1){alert(Qt.lastPage[r]);return}I(!1),j(_=>_+1)};return i.jsxs("div",{className:"modern-bg",style:{background:"url('/valley.png') center center / cover no-repeat",minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center"},children:[i.jsxs("div",{style:{position:"absolute",top:0,left:0,zIndex:100,display:"flex",alignItems:"center",padding:"18px 32px 0 32px",background:"transparent"},children:[i.jsx("button",{className:"topbar-btn",onClick:()=>n("/"),style:{fontWeight:700,fontSize:18,padding:"6px 16px",borderRadius:8,border:"1.5px solid #6B5BFF",background:"#fff",color:"#6B5BFF",cursor:"pointer",transition:"background 0.18s, color 0.18s, border 0.18s",marginRight:8},onMouseOver:_=>{_.currentTarget.style.background="#6B5BFF",_.currentTarget.style.color="#fff"},onMouseOut:_=>{_.currentTarget.style.background="#fff",_.currentTarget.style.color="#6B5BFF"},children:Qt.backToHome[r]}),window.location.pathname!=="/pairtalk"&&i.jsx("button",{className:"topbar-btn",onClick:()=>n(-1),style:{fontWeight:700,fontSize:18,padding:"6px 16px",borderRadius:8,border:"1.5px solid #6B5BFF",background:"#fff",color:"#6B5BFF",cursor:"pointer",transition:"background 0.18s, color 0.18s, border 0.18s",marginLeft:8},onMouseOver:_=>{_.currentTarget.style.background="#6B5BFF",_.currentTarget.style.color="#fff"},onMouseOut:_=>{_.currentTarget.style.background="#fff",_.currentTarget.style.color="#6B5BFF"},children:Qt.back[r]})]}),i.jsxs("div",{style:{position:"absolute",top:0,right:0,zIndex:100,display:"flex",alignItems:"center",padding:"18px 32px 0 32px",background:"transparent",gap:12},children:[i.jsx("button",{className:"topbar-btn",onClick:async()=>{await Er(e),localStorage.clear(),window.location.href="/"},style:{fontWeight:700,fontSize:18,padding:"6px 16px",borderRadius:8,border:"1.5px solid #6B5BFF",background:"#fff",color:"#6B5BFF",cursor:"pointer",transition:"background 0.18s, color 0.18s, border 0.18s"},onMouseOver:_=>{_.currentTarget.style.background="#6B5BFF",_.currentTarget.style.color="#fff"},onMouseOut:_=>{_.currentTarget.style.background="#fff",_.currentTarget.style.color="#6B5BFF"},children:Qt.logout[r]}),i.jsx($n,{})]}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[i.jsxs("h2",{style:{fontSize:"2.2rem",fontWeight:900,color:"#6B5BFF",textShadow:"0 2px 12px #6B5BFF88, 0 4px 24px #0008",letterSpacing:1,background:"#fff",borderRadius:12,boxShadow:"0 2px 12px #6B5BFF22",padding:"12px 32px",margin:0,marginBottom:24,display:"flex",alignItems:"center",gap:12},children:["🤝 ",Qt.pageTitle[r]]}),i.jsxs("div",{style:{maxWidth:540,width:"100%",background:"#fff",borderRadius:16,padding:32,boxShadow:"0 4px 24px #0002",display:"flex",flexDirection:"column",alignItems:"center"},children:[i.jsx("div",{style:{fontSize:22,color:"#6B5BFF",fontWeight:900,marginBottom:24,textAlign:"center",textShadow:"0 2px 12px #6B5BFF88, 0 4px 24px #0008"},children:Qt.subtitle[r]}),i.jsx("h2",{style:{fontSize:28,fontWeight:900,marginBottom:18},children:Qt.pageTitle[r]}),i.jsxs("div",{style:{marginTop:18},children:[i.jsx("b",{children:Qt.matchStatus[r]}),i.jsx("div",{style:{marginTop:8},children:Qt.empty[r]})]}),h?i.jsxs("div",{style:{marginBottom:16},children:[i.jsx("b",{children:Qt.todayMatch[r]})," ",(M=o.find(_=>_.id===h))==null?void 0:M.partner,i.jsxs("div",{style:{marginTop:8,color:"#6B5BFF"},children:[Qt.timeLeft[r],Math.floor(c/60),":",(c%60).toString().padStart(2,"0")]}),i.jsx("div",{style:{marginTop:8,color:"#23c6e6"},children:(B=o.find(_=>_.id===h))==null?void 0:B.aiGuide}),i.jsx("div",{style:{marginTop:8,color:"#614425"},children:g}),i.jsx("button",{onClick:()=>H(h),style:{marginTop:10,borderRadius:8,background:"#eee",color:"#6B5BFF",border:"none",fontWeight:700,padding:"6px 18px"},children:Qt.archive[r]}),i.jsx("button",{onClick:J,style:{marginTop:10,marginLeft:10,borderRadius:8,background:"#6B5BFF",color:"#fff",border:"none",fontWeight:700,padding:"6px 18px"},children:Qt.rematch[r]})]}):i.jsx("div",{style:{color:"#614425",fontSize:18,textAlign:"center",marginTop:40},children:Qt.empty[r]}),i.jsxs("div",{style:{marginTop:18},children:[i.jsx("b",{children:Qt.history[r]}),i.jsx("ul",{style:{marginTop:8,paddingLeft:0,listStyle:"none"},children:o.filter(_=>_.status==="archived").map((_,U)=>i.jsxs("li",{style:{background:"#f7f7ff",borderRadius:8,padding:10,marginBottom:8},children:[i.jsx("div",{style:{fontWeight:700},children:_.partner}),i.jsx("div",{style:{color:"#614425",marginTop:4},children:_.aiGuide})]},U))})]}),i.jsxs("div",{style:{width:"100%",maxWidth:420,margin:"0 auto",background:"#f7f7ff",borderRadius:16,padding:24,boxShadow:"0 2px 12px #6B5BFF11",marginBottom:24,textAlign:"center",position:"relative"},children:[i.jsx("img",{src:T.avatar,alt:"avatar",style:{width:72,height:72,borderRadius:"50%",objectFit:"cover",border:"2px solid #6B5BFF",background:"#eee",marginBottom:12}}),i.jsx("div",{style:{fontWeight:700,fontSize:20,color:"#6B5BFF",marginBottom:6},children:T.nickname}),i.jsxs("div",{style:{color:"#614425",fontSize:16,marginBottom:6},children:[T.country," / ",T.age,KN[r]," / ",nk[r][T.gender]]}),i.jsx("button",{onClick:()=>I(_=>!_),style:{margin:"8px 0",padding:"6px 18px",borderRadius:8,fontWeight:700,background:"#fff",color:"#6B5BFF",border:"2px solid #6B5BFF",cursor:"pointer",fontSize:15,transition:"background 0.18s, color 0.18s, box-shadow 0.18s"},onMouseOver:_=>{_.currentTarget.style.background="#6B5BFF",_.currentTarget.style.color="#fff",_.currentTarget.style.boxShadow="0 6px 32px #6B5BFF99"},onMouseOut:_=>{_.currentTarget.style.background="#fff",_.currentTarget.style.color="#6B5BFF",_.currentTarget.style.boxShadow="none"},children:R?Qt.hideDetails[r]:Qt.viewDetails[r]}),R&&i.jsxs("div",{style:{marginTop:8,color:"#232946",fontSize:15,background:"#fff",borderRadius:8,padding:12,boxShadow:"0 2px 8px #6B5BFF11",display:"flex",flexDirection:"column",alignItems:"center",gap:8},children:[i.jsx("img",{src:T.avatar,alt:"avatar",style:{width:72,height:72,borderRadius:"50%",objectFit:"cover",border:"2px solid #6B5BFF",background:"#eee",marginBottom:6}}),i.jsxs("div",{children:[i.jsxs("b",{children:[Qt.nickname[r],"："]}),T.nickname]}),i.jsxs("div",{children:[i.jsxs("b",{children:[Qt.country[r],"："]}),T.country]}),i.jsxs("div",{children:[i.jsxs("b",{children:[Qt.age[r],"："]}),T.age]}),i.jsxs("div",{children:[i.jsxs("b",{children:[Qt.gender[r],"："]}),nk[r][T.gender]]}),i.jsxs("div",{children:[i.jsx("b",{children:"Email："}),T.email]}),i.jsxs("div",{children:[i.jsxs("b",{children:[Qt.interest[r],"："]}),T.interest]}),i.jsxs("div",{children:[i.jsxs("b",{children:[Qt.eventType[r],"："]}),T.eventType]}),i.jsxs("div",{children:[i.jsxs("b",{children:[Qt.bio[r],"："]}),T.bio]})]}),i.jsxs("div",{style:{marginTop:14,display:"flex",flexDirection:"row",gap:10,justifyContent:"center",alignItems:"center"},children:[i.jsx("select",{value:F,onChange:_=>P(_.target.value),style:{padding:"6px 12px",borderRadius:8,border:"1.5px solid #6B5BFF",fontSize:18},children:rk.map(_=>i.jsx("option",{value:_.value,children:_.label},_.value))}),i.jsx("button",{onClick:O,style:{padding:"6px 18px",borderRadius:8,fontWeight:700,background:"linear-gradient(135deg, #6B5BFF 60%, #23c6e6 100%)",color:"#fff",border:"none",fontSize:16,transition:"background 0.18s, box-shadow 0.18s"},onMouseOver:_=>{_.currentTarget.style.background="linear-gradient(135deg, #3a2fff 60%, #0e7fd6 100%)",_.currentTarget.style.boxShadow="0 6px 32px #6B5BFF99"},onMouseOut:_=>{_.currentTarget.style.background="linear-gradient(135deg, #6B5BFF 60%, #23c6e6 100%)",_.currentTarget.style.boxShadow="none"},children:Qt.sendGift[r]}),i.jsx("button",{onClick:L,style:{padding:"6px 18px",borderRadius:8,fontWeight:700,background:"#fff",color:"#6B5BFF",border:"2px solid #6B5BFF",fontSize:16,transition:"background 0.18s, color 0.18s, box-shadow 0.18s"},onMouseOver:_=>{_.currentTarget.style.background="#6B5BFF",_.currentTarget.style.color="#fff",_.currentTarget.style.boxShadow="0 6px 32px #6B5BFF99"},onMouseOut:_=>{_.currentTarget.style.background="#fff",_.currentTarget.style.color="#6B5BFF",_.currentTarget.style.boxShadow="none"},children:Qt.sendEmail[r]})]}),i.jsx("button",{onClick:C,style:{position:"absolute",right:18,bottom:0,transform:"translateY(60px)",padding:"8px 24px",borderRadius:8,fontWeight:700,background:"linear-gradient(135deg, #6B5BFF 60%, #23c6e6 100%)",color:"#fff",border:"none",fontSize:16,boxShadow:"0 2px 8px #6B5BFF33",transition:"background 0.18s, box-shadow 0.18s, transform 0.18s",cursor:"pointer"},onMouseOver:_=>{_.currentTarget.style.background="linear-gradient(135deg, #3a2fff 60%, #0e7fd6 100%)",_.currentTarget.style.boxShadow="0 6px 32px #6B5BFF99",_.currentTarget.style.transform="translateY(55px) scale(1.04)"},onMouseOut:_=>{_.currentTarget.style.background="linear-gradient(135deg, #6B5BFF 60%, #23c6e6 100%)",_.currentTarget.style.boxShadow="0 2px 8px #6B5BFF33",_.currentTarget.style.transform="translateY(60px)"},children:Qt.next[r]})]})]})]}),i.jsx("div",{style:{width:"100%",margin:"0 auto",marginTop:24,background:"rgba(255,255,255,0.95)",borderRadius:16,padding:"16px",boxShadow:"0 2px 12px #6B5BFF22"},children:i.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:20,flexWrap:"wrap"},children:[i.jsx("a",{href:"/privacy-policy",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12},children:"隱私權政策"}),i.jsx("a",{href:"/terms",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12},children:"條款/聲明"}),i.jsx("a",{href:"/data-deletion",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12},children:"資料刪除說明"}),i.jsx("a",{href:"/about",style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12},children:"🧬 Restarter™｜我們是誰"}),i.jsx("a",{href:"/feedback",style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12},children:"💬 意見箱｜我們想聽你說"})]})})]})}const co={backToHome:{"zh-TW":"← 返回","zh-CN":"← 返回",ja:"← 戻る",en:"← Back",ko:"← 뒤로",th:"← กลับ",vi:"← Quay lại",ms:"← Kembali",la:"← Redire"},logout:{"zh-TW":"登出","zh-CN":"登出",ja:"ログアウト",en:"Logout",ko:"로그아웃",th:"ออกจากระบบ",vi:"Đăng xuất",ms:"Log keluar",la:"Exire"},pageTitle:{"zh-TW":"情境模擬室 SkillBox","zh-CN":"情境模拟室 SkillBox",en:"SkillBox Scenario Room",ja:"シナリオ練習室 SkillBox",ko:"상황 시뮬레이션실 SkillBox",th:"ห้องจำลองสถานการณ์ SkillBox",vi:"Phòng mô phỏng tình huống SkillBox",ms:"Bilik Senario SkillBox",la:"Camera Scaenarii SkillBox"},subtitle:{"zh-TW":"在這裡磨練你的對話技巧，應對各種挑戰。","zh-CN":"在这里磨练你的对话技巧，应对各种挑战。",en:"Hone your conversation skills here for any challenge.",ja:"ここで会話スキルを磨き、様々な挑戦に備えましょう。",ko:"여기서 대화 기술을 연마하여 모든 도전에 대비하세요.",th:"ฝึกฝนทักษะการสนทนาของคุณที่นี่เพื่อรับมือกับทุกความท้าทาย",vi:"Rèn luyện kỹ năng trò chuyện của bạn ở đây cho mọi thử thách.",ms:"Asah kemahiran perbualan anda di sini untuk sebarang cabaran.",la:"Hic peritiam colloquii tui exacue ad quamvis provocationem."},selectScenario:{"zh-TW":"選擇一個情境開始練習","zh-CN":"选择一个情境开始练习",en:"Select a scenario to start practicing",ja:"練習を始めるシナリオを選択してください",ko:"연습을 시작할 시나리오를 선택하세요",th:"เลือกสถานการณ์เพื่อเริ่มฝึก",vi:"Chọn một kịch bản để bắt đầu luyện tập",ms:"Pilih senario untuk mula berlatih",la:"Scaenarium elige ut exercere incipias"},startPractice:{"zh-TW":"進入模擬","zh-CN":"进入模拟",en:"Enter Simulation",ja:"シミュレーションに入る",ko:"시뮬레이션 시작",th:"เข้าสู่การจำลอง",vi:"Vào mô phỏng",ms:"Masuk Simulasi",la:"Intra Simulationem"},scenarioDifficulty:{"zh-TW":"難度","zh-CN":"难度",en:"Difficulty",ja:"難易度",ko:"난이도",th:"ความยาก",vi:"Độ khó",ms:"Kesukaran",la:"Difficultas"},cancelButton:{"zh-TW":"取消","zh-CN":"取消",en:"Cancel",ja:"キャンセル",ko:"취소",th:"ยกเลิก",vi:"Hủy",ms:"Batal",la:"Abstinere"}};function YN(){const n=Et(),e=St(),{lang:t}=Lt(),r=t||localStorage.getItem("lang")||"zh-TW",[o,a]=v.useState(null),[c,d]=v.useState([]),[h,m]=v.useState(!0),[g,x]=v.useState(!1),[S,j]=v.useState(null);v.useEffect(()=>{(async()=>{m(!0);try{const P=await fetch(`/locales/${r}/scenarios.json`);if(!P.ok)throw new Error("Failed to fetch scenarios");const z=await P.json();d(z)}catch(P){console.error("Error fetching scenarios:",P),d([])}finally{m(!1)}})()},[r]);const T=F=>{j(F),a(F.id),x(!0)},R=()=>{o?n(`/skillbox/${o}`):alert(co.selectScenario[r])},I=()=>{x(!1),j(null),a(null)};return h?i.jsx("div",{children:"Loading scenarios..."}):i.jsxs("div",{className:"modern-bg",style:{background:"url('/plains.png') center center / cover no-repeat fixed",minHeight:"100vh",width:"100vw",overflow:"hidden",position:"relative"},children:[i.jsxs("div",{style:{width:"100%",maxWidth:700,margin:"20px auto 20px auto",padding:"16px 24px",background:"rgba(255,255,255,0.95)",borderRadius:16,boxShadow:"0 4px 20px rgba(0,0,0,0.1)",display:"flex",alignItems:"center",justifyContent:"space-between",position:"relative"},children:[i.jsx("button",{onClick:()=>n("/"),style:{fontWeight:700,fontSize:16,padding:"8px 16px",borderRadius:8,border:"1.5px solid #6B5BFF",background:"#fff",color:"#6B5BFF",cursor:"pointer",minWidth:80},children:co.backToHome[r]}),i.jsxs("h1",{style:{fontWeight:900,fontSize:18,color:"#6B5BFF",margin:0,lineHeight:1,textShadow:"0 2px 8px #6B5BFF88",textAlign:"center",flex:1},children:[i.jsx("span",{role:"img","aria-label":"skillbox",children:"🛠️"})," ",co.pageTitle[r]]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[i.jsx("button",{onClick:async()=>{await Er(e),localStorage.clear(),window.location.href="/"},style:{fontWeight:700,fontSize:16,padding:"8px 16px",borderRadius:8,border:"1.5px solid #6B5BFF",background:"#fff",color:"#6B5BFF",cursor:"pointer",minWidth:80},children:co.logout[r]}),i.jsx("div",{style:{width:80},children:i.jsx($n,{style:{width:"100%"}})})]})]}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",width:"100%",padding:"24px",marginTop:20,minHeight:"calc(100vh - 120px)",overflowY:"auto"},children:[i.jsx("div",{style:{fontSize:18,color:"#4A4A4A",fontWeight:500,marginBottom:24,textAlign:"center",background:"rgba(255,255,255,0.7)",padding:"8px 16px",borderRadius:8},children:co.subtitle[r]}),i.jsxs("div",{style:{maxWidth:800,width:"100%",background:"#fff",borderRadius:16,padding:"24px 32px",boxShadow:"0 4px 24px #0002",display:"flex",flexDirection:"column",alignItems:"center"},children:[i.jsx("h3",{style:{fontSize:24,fontWeight:700,color:"#6B5BFF",marginBottom:24},children:co.selectScenario[r]}),i.jsx("div",{style:{width:"100%",display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"24px"},children:c.map(F=>i.jsxs("div",{onClick:()=>T(F),style:{background:o===F.id?"linear-gradient(135deg, #6B5BFF 0%, #4D8FFF 100%)":"#f7f7ff",color:o===F.id?"#fff":"#4A4A4A",borderRadius:12,padding:20,boxShadow:o===F.id?"0 8px 24px #6B5BFF66":"0 4px 12px #0000001a",cursor:"pointer",transition:"all 0.3s ease",border:o===F.id?"2px solid #fff":"2px solid transparent",transform:o===F.id?"translateY(-5px)":"none",display:"flex",flexDirection:"column",alignItems:"center",textAlign:"center"},children:[i.jsx("div",{style:{fontSize:48,marginBottom:12},children:F.emoji}),i.jsx("h4",{style:{fontSize:18,fontWeight:700,margin:"0 0 8px 0"},children:F.title}),i.jsx("p",{style:{fontSize:14,margin:"0 0 12px 0",opacity:.8,minHeight:"40px"},children:F.description}),i.jsxs("div",{style:{fontWeight:600,fontSize:14,padding:"4px 12px",borderRadius:16,background:o===F.id?"rgba(255,255,255,0.2)":"rgba(107, 91, 255, 0.1)",color:o===F.id?"#fff":"#6B5BFF"},children:[co.scenarioDifficulty[r],": ",F.difficulty]})]},F.id))})]})]}),g&&S&&i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},onClick:I,children:i.jsxs("div",{style:{background:"#fff",borderRadius:16,padding:"32px",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.3)",maxWidth:400,width:"90%",textAlign:"center",position:"relative"},onClick:F=>F.stopPropagation(),children:[i.jsx("button",{onClick:I,style:{position:"absolute",top:12,right:12,background:"none",border:"none",fontSize:24,cursor:"pointer",color:"#999",width:32,height:32,display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"50%",transition:"background-color 0.2s"},onMouseOver:F=>F.currentTarget.style.backgroundColor="#f0f0f0",onMouseOut:F=>F.currentTarget.style.backgroundColor="transparent",children:"×"}),i.jsx("div",{style:{fontSize:48,marginBottom:16},children:S.emoji}),i.jsx("h3",{style:{fontSize:20,fontWeight:700,color:"#6B5BFF",margin:"0 0 8px 0"},children:S.title}),i.jsx("p",{style:{fontSize:14,color:"#666",margin:"0 0 16px 0",lineHeight:1.5},children:S.description}),i.jsxs("div",{style:{display:"flex",gap:12,justifyContent:"center"},children:[i.jsx("button",{onClick:I,style:{padding:"10px 20px",borderRadius:8,border:"1px solid #ddd",background:"#f8f9fa",color:"#666",cursor:"pointer",fontSize:14,fontWeight:600,transition:"all 0.2s"},onMouseOver:F=>F.currentTarget.style.background="#e9ecef",onMouseOut:F=>F.currentTarget.style.background="#f8f9fa",children:co.cancelButton[r]||"取消"}),i.jsx("button",{onClick:R,style:{padding:"10px 24px",borderRadius:8,border:"none",background:"linear-gradient(135deg, #6B5BFF 0%, #4D8FFF 100%)",color:"#fff",cursor:"pointer",fontSize:14,fontWeight:700,transition:"all 0.2s",boxShadow:"0 4px 12px rgba(107, 91, 255, 0.3)"},onMouseOver:F=>F.currentTarget.style.transform="translateY(-1px)",onMouseOut:F=>F.currentTarget.style.transform="translateY(0)",children:co.startPractice[r]})]})]})}),i.jsx("div",{style:{width:"100%",margin:"0 auto",marginTop:24,background:"rgba(255,255,255,0.95)",borderRadius:16,padding:"16px",boxShadow:"0 2px 12px #6B5BFF22"},children:i.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:20,flexWrap:"wrap"},children:[i.jsx("a",{href:"/privacy-policy",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12},children:"隱私權政策"}),i.jsx("a",{href:"/terms",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12},children:"條款/聲明"}),i.jsx("a",{href:"/data-deletion",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12},children:"資料刪除說明"}),i.jsx("a",{href:"/about",style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12},children:"🧬 Restarter™｜我們是誰"}),i.jsx("a",{href:"/feedback",style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12},children:"💬 意見箱｜我們想聽你說"})]})})]})}const XN={"zh-TW":i.jsxs("div",{children:[i.jsx("h1",{children:"Restarter™ 使用條款與更生者聲明"}),i.jsx("h2",{children:"一、平台理念聲明"}),i.jsx("p",{children:"Restarter™ 是幫助更生人社會、心理、生活自信恢復的 AI 平台。我們透過情感引導、角色扮演、任務挑戰，協助用戶釋放負面情緒、重建目標與自信，更引導使用者逐步建立內在動力與行動信心。"}),i.jsx("p",{children:"我們相信每一位更生人都值得被尊重與重新認識。即使你曾經犯錯，在這裡不再被貼標籤。"}),i.jsx("h2",{children:"二、用戶身份與行為規範"}),i.jsx("p",{children:"本平台歡迎曾經服刑、戒癮、感化、接受司法保護、霸凌或因社會排斥而渴望重新開始的個人註冊使用。"}),i.jsx("p",{children:"為確保社群安全與信任，嚴禁下列行為："}),i.jsxs("ul",{children:[i.jsx("li",{children:"冒用他人身份或誤導他人註冊資料"}),i.jsx("li",{children:"散佈仇恨、歧視、暴力、色情、違法內容"}),i.jsx("li",{children:"上傳侵犯他人肖像權或機敏資料的圖片"})]}),i.jsx("p",{children:"違反上述條款者，平台有權立即中止其帳號與使用權限。"}),i.jsx("h2",{children:"三、AI 使用與責任聲明"}),i.jsx("p",{children:"平台所提供的 AI 對話、建議與角色模擬，僅供陪伴、練習與個人成長參考，不構成法律、醫療或心理專業意見。"}),i.jsxs("ul",{children:[i.jsx("li",{children:"平台不對使用者依據 AI 輸出所做的決策承擔法律責任"}),i.jsx("li",{children:"平台不保證 AI 對話完全正確或與真實情境一致"}),i.jsx("li",{children:"請勿將 AI 對話內容散佈作為公共引用資訊"})]}),i.jsx("p",{children:"我們已設置基本風險過濾與話術限制，但 AI 存在輸出偏差或感受誤解的可能。"}),i.jsx("p",{children:"若遇到不適當內容，請透過回報機制通知我們，我們將持續優化模型。"}),i.jsx("h3",{children:"三之一、AI 對話內容使用規範"}),i.jsxs("ul",{children:[i.jsx("li",{children:"不得詢問或輸入他人私密資訊（如住址、犯罪紀錄）"}),i.jsx("li",{children:"不得操作 AI 模擬暴力、自殘或誘導非法行為"}),i.jsx("li",{children:"不得以 Restarter™ 名義散佈虛假或詐騙訊息"}),i.jsx("li",{children:"所有對話資料僅用於匿名模型優化，不作個人追蹤"}),i.jsx("li",{children:"如有必要，平台保留法律配合義務"}),i.jsx("li",{children:"未滿十八歲使用者，需經家長同意方可使用本平台"}),i.jsx("li",{children:"本平台禁止自動爬蟲或未授權系統串接"}),i.jsx("li",{children:"使用者需自負資料輸入內容之法律風險"})]}),i.jsx("h2",{children:"四、資料處理與隱私權聲明"}),i.jsx("p",{children:"平台僅會蒐集註冊所需最基本資料，如暱稱、電子信箱與使用語言偏好。"}),i.jsx("p",{children:"所有資料經加密儲存，不會轉售第三方或做商業行銷使用。"}),i.jsx("p",{children:"使用者可隨時申請帳號刪除，並請求系統清除其所有紀錄。"}),i.jsx("h2",{children:"五、帳號停用與終止權利"}),i.jsx("p",{children:"平台保留中止任何違反本條款使用者帳號的權利，且無須事前通知。"}),i.jsx("p",{children:"如帳號長期未使用，平台將主動發出提醒並保留停用處理權限。"}),i.jsx("p",{children:"用戶可自行隨時停用帳號並刪除所有資料紀錄。"}),i.jsx("h2",{children:"六、本條款之調整與最終解釋權"}),i.jsx("p",{children:"平台有權依據法律、政策與服務優化隨時修改本條款內容。"}),i.jsx("p",{children:"重大異動將透過站內公告與電子郵件通知用戶。"}),i.jsx("p",{children:"本條款之最終解釋權歸 Restarter™ 平台所有。"})]}),"zh-CN":i.jsxs("div",{children:[i.jsx("h1",{children:"Restarter™ 使用条款与更生者声明"}),i.jsx("h2",{children:"一、平台理念声明"}),i.jsx("p",{children:"Restarter™ 是帮助更生人社会、心理、生活自信恢复的 AI 平台。我们通过情感引导、角色扮演、任务挑战，协助用户释放负面情绪、重建目标与自信，并引导用户逐步建立内在动力与行动信心。"}),i.jsx("p",{children:"我们相信每一位更生人都值得被尊重与重新认识。即使你曾经犯错，在这里不再被贴标签。"}),i.jsx("h2",{children:"二、用户身份与行为规范"}),i.jsx("p",{children:"本平台欢迎曾经服刑、戒瘾、感化、接受司法保护、霸凌或因社会排斥而渴望重新开始的个人注册使用。"}),i.jsx("p",{children:"为确保社群安全与信任，严禁下列行为："}),i.jsxs("ul",{children:[i.jsx("li",{children:"冒用他人身份或误导他人注册资料"}),i.jsx("li",{children:"散布仇恨、歧视、暴力、色情、违法内容"}),i.jsx("li",{children:"上传侵犯他人肖像权或敏感资料的图片"})]}),i.jsx("p",{children:"违反上述条款者，平台有权立即中止其账号与使用权限。"}),i.jsx("h2",{children:"三、AI 使用与责任声明"}),i.jsx("p",{children:"平台所提供的 AI 对话、建议与角色模拟，仅供陪伴、练习与个人成长参考，不构成法律、医疗或心理专业意见。"}),i.jsxs("ul",{children:[i.jsx("li",{children:"平台不对用户依据 AI 输出所做的决策承担法律责任"}),i.jsx("li",{children:"平台不保证 AI 对话完全正确或与真实情境一致"}),i.jsx("li",{children:"请勿将 AI 对话内容散布作为公共引用信息"})]}),i.jsx("p",{children:"我们已设置基本风险过滤与话术限制，但 AI 存在输出偏差或感受误解的可能。"}),i.jsx("p",{children:"若遇到不适当内容，请通过举报机制通知我们，我们将持续优化模型。"}),i.jsx("h3",{children:"三之一、AI 对话内容使用规范"}),i.jsxs("ul",{children:[i.jsx("li",{children:"不得询问或输入他人私密信息（如住址、犯罪记录）"}),i.jsx("li",{children:"不得操作 AI 模拟暴力、自残或诱导非法行为"}),i.jsx("li",{children:"不得以 Restarter™ 名义散布虚假或诈骗信息"}),i.jsx("li",{children:"全对话资料仅用于匿名模型优化，不作个人追踪"}),i.jsx("li",{children:"如有必要，平台保留法律配合义务"}),i.jsx("li",{children:"未满十八岁用户，需经家长同意方可使用本平台"}),i.jsx("li",{children:"本平台禁止自动爬虫或未授权系统串接"}),i.jsx("li",{children:"用户需自负资料输入内容之法律风险"})]}),i.jsx("h2",{children:"四、资料处理与隐私权声明"}),i.jsx("p",{children:"平台仅会收集注册所需最基本资料，如昵称、电子邮箱与使用语言偏好。"}),i.jsx("p",{children:"所有资料经加密存储，不会转售第三方或做商业营销使用。"}),i.jsx("p",{children:"用户可随时申请账号删除，并请求系统清除其所有记录。"}),i.jsx("h2",{children:"五、账号停用与终止权利"}),i.jsx("p",{children:"平台保留中止任何违反本条款用户账号的权利，且无需事前通知。"}),i.jsx("p",{children:"如账号长期未使用，平台将主动发出提醒并保留停用处理权限。"}),i.jsx("p",{children:"用户可自行随时停用账号并删除所有资料记录。"}),i.jsx("h2",{children:"六、本条款之调整与最终解释权"}),i.jsx("p",{children:"平台有权依据法律、政策与服务优化随时修改本条款内容。"}),i.jsx("p",{children:"重大变动将通过站内公告与电子邮件通知用户。"}),i.jsx("p",{children:"本条款之最终解释权归 Restarter™ 平台所有。"})]}),en:i.jsxs("div",{children:[i.jsx("h1",{children:"Restarter™ Terms of Use and Ex-Offender Declaration"}),i.jsx("h2",{children:"1. Platform Philosophy Statement"}),i.jsx("p",{children:"Restarter™ is an AI platform dedicated to helping ex-offenders rebuild social, psychological, and life confidence. Through emotional guidance, role-playing, and task challenges, we help users release negative emotions, rebuild goals and confidence, and guide them to gradually build inner motivation and action confidence."}),i.jsx("p",{children:"We believe that every ex-offender deserves respect and a new recognition. Even if you have made mistakes, you will not be labeled here."}),i.jsx("h2",{children:"2. User Identity and Code of Conduct"}),i.jsx("p",{children:"This platform welcomes individuals who have served sentences, undergone rehabilitation, received judicial protection, experienced bullying, or wish to start over due to social exclusion."}),i.jsx("p",{children:"To ensure community safety and trust, the following behaviors are strictly prohibited:"}),i.jsxs("ul",{children:[i.jsx("li",{children:"Impersonating others or providing misleading registration information"}),i.jsx("li",{children:"Spreading hate, discrimination, violence, pornography, or illegal content"}),i.jsx("li",{children:"Uploading images that infringe on others' portrait rights or sensitive data"})]}),i.jsx("p",{children:"Those who violate the above terms may have their accounts and access immediately terminated by the platform."}),i.jsx("h2",{children:"3. AI Usage and Responsibility Statement"}),i.jsx("p",{children:"The AI dialogues, suggestions, and role simulations provided by the platform are for companionship, practice, and personal growth reference only, and do not constitute legal, medical, or psychological professional advice."}),i.jsxs("ul",{children:[i.jsx("li",{children:"The platform is not legally responsible for decisions made by users based on AI output"}),i.jsx("li",{children:"The platform does not guarantee that AI dialogues are completely accurate or consistent with real situations"}),i.jsx("li",{children:"Do not distribute AI dialogue content as public reference information"})]}),i.jsx("p",{children:"We have set up basic risk filtering and dialogue restrictions, but AI may still produce biased or misunderstood outputs."}),i.jsx("p",{children:"If you encounter inappropriate content, please notify us through the reporting mechanism, and we will continue to optimize the model."}),i.jsx("h3",{children:"3.1 AI Dialogue Content Usage Guidelines"}),i.jsxs("ul",{children:[i.jsx("li",{children:"Do not ask for or input others' private information (such as address or criminal record)"}),i.jsx("li",{children:"Do not use AI to simulate violence, self-harm, or induce illegal behavior"}),i.jsx("li",{children:"Do not distribute false or fraudulent information in the name of Restarter™"}),i.jsx("li",{children:"All dialogue data is used only for anonymous model optimization, not for personal tracking"}),i.jsx("li",{children:"The platform reserves the right to cooperate with legal authorities if necessary"}),i.jsx("li",{children:"Users under 18 must have parental consent to use this platform"}),i.jsx("li",{children:"The platform prohibits automated crawling or unauthorized system integration"}),i.jsx("li",{children:"Users are responsible for the legal risks of the content they input"})]}),i.jsx("h2",{children:"4. Data Processing and Privacy Statement"}),i.jsx("p",{children:"The platform only collects the most basic registration information, such as nickname, email, and language preference."}),i.jsx("p",{children:"All data is stored encrypted and will not be sold to third parties or used for commercial marketing."}),i.jsx("p",{children:"Users can request account deletion at any time and ask the system to clear all their records."}),i.jsx("h2",{children:"5. Account Suspension and Termination Rights"}),i.jsx("p",{children:"The platform reserves the right to terminate any user's account that violates these terms at any time without prior notice."}),i.jsx("p",{children:"If an account is inactive for a long period, the platform will proactively send reminders and reserves the right to suspend the account."}),i.jsx("p",{children:"Users can deactivate their accounts and delete all data records at any time."}),i.jsx("h2",{children:"6. Amendments and Final Interpretation"}),i.jsx("p",{children:"The platform reserves the right to modify these terms at any time in accordance with laws, policies, and service optimization."}),i.jsx("p",{children:"Major changes will be announced on the platform and via email notifications to users."}),i.jsx("p",{children:"The final interpretation of these terms belongs to the Restarter™ platform."})]}),ja:i.jsxs("div",{children:[i.jsx("h1",{children:"Restarter™ 利用規約および更生者宣言"}),i.jsx("h2",{children:"1. プラットフォーム理念声明"}),i.jsx("p",{children:"Restarter™ は更生者の社会的・心理的・生活的自信の回復を支援するAIプラットフォームです。感情ガイダンス、ロールプレイ、タスクチャレンジを通じて、ユーザーがネガティブな感情を解放し、目標と自信を再構築し、内面の動機と行動への自信を段階的に築くことをサポートします。"}),i.jsx("p",{children:"私たちは、すべての更生者が尊重され、新たに認識される価値があると信じています。過去に過ちを犯したとしても、ここではラベルを貼られません。"}),i.jsx("h2",{children:"2. ユーザーの身分と行動規範"}),i.jsx("p",{children:"本プラットフォームは、服役経験者、依存症克服者、感化・司法保護を受けた方、いじめや社会的排除を経験し再出発を望む方の登録を歓迎します。"}),i.jsx("p",{children:"コミュニティの安全と信頼を守るため、以下の行為を厳禁とします："}),i.jsxs("ul",{children:[i.jsx("li",{children:"他人の身分を詐称または誤った登録情報の提供"}),i.jsx("li",{children:"憎悪・差別・暴力・ポルノ・違法コンテンツの拡散"}),i.jsx("li",{children:"他人の肖像権や機密情報を侵害する画像のアップロード"})]}),i.jsx("p",{children:"上記規約に違反した場合、プラットフォームは直ちにアカウントと利用権限を停止する権利を有します。"}),i.jsx("h2",{children:"3. AI利用と責任声明"}),i.jsx("p",{children:"本プラットフォームが提供するAI対話・提案・ロールプレイは、伴走・練習・自己成長の参考用であり、法的・医療的・心理的な専門アドバイスではありません。"}),i.jsxs("ul",{children:[i.jsx("li",{children:"AI出力に基づく意思決定に対し、プラットフォームは法的責任を負いません"}),i.jsx("li",{children:"AI対話が常に正確または現実と一致することを保証しません"}),i.jsx("li",{children:"AI対話内容を公共の引用情報として拡散しないでください"})]}),i.jsx("p",{children:"基本的なリスクフィルタと発話制限を設けていますが、AIには出力の偏りや誤解が生じる可能性があります。"}),i.jsx("p",{children:"不適切な内容に遭遇した場合は、報告機能からご連絡ください。モデルの最適化に努めます。"}),i.jsx("h3",{children:"3.1 AI対話内容の利用規範"}),i.jsxs("ul",{children:[i.jsx("li",{children:"他人の個人情報（住所・犯罪歴等）を尋ねたり入力しない"}),i.jsx("li",{children:"AIで暴力・自傷・違法行為を模擬しない"}),i.jsx("li",{children:"Restarter™名義で虚偽・詐欺情報を拡散しない"}),i.jsx("li",{children:"全対話データは匿名モデル最適化のみに利用し、個人追跡はしません"}),i.jsx("li",{children:"必要に応じて法的協力義務を負います"}),i.jsx("li",{children:"未満18歳の方は保護者の同意が必要です"}),i.jsx("li",{children:"自動クローラーや未承認システム連携は禁止します"}),i.jsx("li",{children:"入力内容の法的リスクは利用者自身が負います"})]}),i.jsx("h2",{children:"4. データ処理とプライバシー声明"}),i.jsx("p",{children:"登録時に必要最低限の情報（ニックネーム・メール・言語設定）のみ収集します。"}),i.jsx("p",{children:"全データは暗号化保存され、第三者への販売や商用利用はしません。"}),i.jsx("p",{children:"アカウント削除申請と全記録の消去依頼がいつでも可能です。"}),i.jsx("h2",{children:"5. アカウント停止と終了権利"}),i.jsx("p",{children:"本規約違反者のアカウントは、事前通知なく停止できる権利を有します。"}),i.jsx("p",{children:"長期間未使用の場合、リマインダー送信や停止処理権限を保持します。"}),i.jsx("p",{children:"利用者はいつでもアカウント停止・全データ削除が可能です。"}),i.jsx("h2",{children:"6. アカウント停止と終了権利"}),i.jsx("p",{children:"本規約違反者のアカウントは、事前通知なく停止できる権利を有します。"}),i.jsx("p",{children:"長期間未使用の場合、リマインダー送信や停止処理権限を保持します。"}),i.jsx("p",{children:"利用者はいつでもアカウント停止・全データ削除が可能です。"}),i.jsx("h2",{children:"6. 本規約の改定と最終解釈権"}),i.jsx("p",{children:"法令・政策・サービス最適化に応じて本規約を随時改定します。"}),i.jsx("p",{children:"重大な変更はサイト告知やメールで通知します。"}),i.jsx("p",{children:"最終解釈権はRestarter™プラットフォームに帰属します。"})]}),ko:i.jsxs("div",{children:[i.jsx("h1",{children:"Restarter™ 이용약관 및 갱생자 선언"}),i.jsx("h2",{children:"1. 플랫폼 이념 선언"}),i.jsx("p",{children:"Restarter™는 갱생인의 사회적, 심리적, 생활적 자신감 회복을 돕는 AI 플랫폼입니다. 감정 안내, 역할극, 과제 도전을 통해 사용자가 부정적 감정을 해소하고 목표와 자신감을 재구축하며, 내면 동기와 행동 자신감을 단계적으로 쌓을 수 있도록 지원합니다."}),i.jsx("p",{children:"우리는 모든 갱생인이 존중받고 새롭게 인식받을 가치가 있다고 믿습니다. 과거에 실수했더라도 여기서는 낙인찍지 않습니다."}),i.jsx("h2",{children:"2. 사용자 신분 및 행동 규범"}),i.jsx("p",{children:"본 플랫폼은 형을 마친 자, 중독을 극복한 자, 감화를 받은 자, 사법 보호를 받은 자, 따돌림이나 사회적 배제를 경험하고 재출발을 원하는 자의 가입을 환영합니다."}),i.jsx("p",{children:"커뮤니티의 안전과 신뢰를 위해 다음 행위를 엄격히 금지합니다:"}),i.jsxs("ul",{children:[i.jsx("li",{children:"타인 신분 도용 또는 허위 등록 정보 제공"}),i.jsx("li",{children:"증오, 차별, 폭력, 음란, 불법 콘텐츠 유포"}),i.jsx("li",{children:"타인의 초상권 또는 민감 정보 침해 이미지 업로드"})]}),i.jsx("p",{children:"위 조항 위반 시 플랫폼은 즉시 계정 및 이용 권한을 중지할 수 있습니다."}),i.jsx("h2",{children:"3. AI 이용 및 책임 선언"}),i.jsx("p",{children:"플랫폼이 제공하는 AI 대화, 제안, 역할 시뮬레이션은 동반, 연습, 자기 성장 참고용이며, 법률·의료·심리 전문가의 조언이 아닙니다."}),i.jsxs("ul",{children:[i.jsx("li",{children:"플랫폼은 AI에 따른 결정에 대해 법적 책임을 지지 않습니다"}),i.jsx("li",{children:"플랫폼은 AI 대화가 항상 정확하거나 실제와 일치함을 보장하지 않습니다"}),i.jsx("li",{children:"AI 대화 내용을 공공 인용 정보로 유포하지 마십시오"})]}),i.jsx("p",{children:"기본 위험 필터와 발화 제한을 두었으나, AI는 편향되거나 오해를 불러일으킬 수 있습니다."}),i.jsx("p",{children:"부적절한 내용 발견 시 신고 기능을 통해 알려주시면 지속적으로 모델을 개선하겠습니다."}),i.jsx("h3",{children:"3.1 AI 대화 내용 이용 규범"}),i.jsxs("ul",{children:[i.jsx("li",{children:"타인 개인정보(주소, 범죄기록 등) 문의·입력 금지"}),i.jsx("li",{children:"AI로 폭력·자해·불법행위 모의 금지"}),i.jsx("li",{children:"Restarter™ 명의로 허위·사기 정보 유포 금지"}),i.jsx("li",{children:"모든 대화 데이터는 익명 모델 최적화에만 사용, 개인 추적 불가"}),i.jsx("li",{children:"필요시 법적 협조 의무 보유"}),i.jsx("li",{children:"18세 미만은 부모 동의 필요"}),i.jsx("li",{children:"자동 크롤러·미승인 시스템 연동 금지"}),i.jsx("li",{children:"입력 내용의 법적 책임은 사용자 본인에게 있음"})]}),i.jsx("h2",{children:"4. 데이터 처리 및 개인정보 보호"}),i.jsx("p",{children:"가입 시 닉네임, 이메일, 언어 설정 등 최소 정보만 수집합니다."}),i.jsx("p",{children:"모든 데이터는 암호화 저장되며, 제3자 판매·상업적 이용은 없습니다."}),i.jsx("p",{children:"언제든 계정 삭제 및 기록 삭제 요청 가능"}),i.jsx("h2",{children:"5. 계정 정지 및 종료 권리"}),i.jsx("p",{children:"플랫폼은 본 약관 위반 계정을 사전 통보 없이 정지할 수 있습니다."}),i.jsx("p",{children:"장기간 미사용 시 알림 발송 및 정지 처리 권한 보유"}),i.jsx("p",{children:"사용자는 언제든 계정 정지 및 데이터 삭제 가능"}),i.jsx("h2",{children:"6. 약관 개정 및 최종 해석권"}),i.jsx("p",{children:"법령·정책·서비스 최적화에 따라 약관을 수시로 개정할 수 있습니다."}),i.jsx("p",{children:"중대한 변경은 사이트 공지 및 이메일로 안내"}),i.jsx("p",{children:"최종 해석권은 Restarter™ 플랫폼에 있음"})]}),th:i.jsxs("div",{children:[i.jsx("h1",{children:"Restarter™ ข้อกำหนดการใช้งานและประกาศสำหรับผู้กลับตัว"}),i.jsx("h2",{children:"1. ปรัชญาแพลตฟอร์ม"}),i.jsx("p",{children:"Restarter™ เป็นแพลตฟอร์ม AI ที่ช่วยฟื้นฟูความมั่นใจทางสังคม จิตใจ และชีวิตของผู้กลับตัว ผ่านการชี้นำทางอารมณ์ บทบาทสมมติ และภารกิจท้าทาย เพื่อช่วยให้ผู้ใช้ปลดปล่อยอารมณ์ลบ สร้างเป้าหมายและความมั่นใจ และสร้างแรงบันดาลใจภายในและความมั่นใจในการลงมือทำ"}),i.jsx("p",{children:"เราเชื่อว่าทุกคนที่กลับตัวสมควรได้รับความเคารพและการยอมรับใหม่ แม้คุณจะเคยทำผิด ที่นี่จะไม่มีใครติดป้ายคุณอีก"}),i.jsx("h2",{children:"2. ตัวตนและข้อปฏิบัติของผู้ใช้"}),i.jsx("p",{children:"แพลตฟอร์มนี้ยินดีต้อนรับผู้ที่เคยต้องโทษ เลิกยา ฟื้นฟู ได้รับการคุ้มครองทางกฎหมาย ถูกกลั่นแกล้ง หรือถูกกีดกันทางสังคมและต้องการเริ่มต้นใหม่"}),i.jsx("p",{children:"เพื่อความปลอดภัยและความไว้วางใจในชุมชน ห้ามกระทำดังต่อไปนี้อย่างเด็ดขาด:"}),i.jsxs("ul",{children:[i.jsx("li",{children:"แอบอ้างตัวตนหรือให้ข้อมูลสมัครสมาชิกที่ทำให้เข้าใจผิด"}),i.jsx("li",{children:"เผยแพร่ความเกลียดชัง การเลือกปฏิบัติ ความรุนแรง สื่อลามก หรือเนื้อหาผิดกฎหมาย"}),i.jsx("li",{children:"อัปโหลดภาพที่ละเมิดสิทธิ์ในภาพบุคคลหรือข้อมูลสำคัญของผู้อื่น"})]}),i.jsx("p",{children:"หากฝ่าฝืนข้อกำหนดข้างต้น แพลตฟอร์มมีสิทธิ์ระงับบัญชีและสิทธิ์การใช้งานทันที"}),i.jsx("h2",{children:"3. การใช้ AI และคำประกาศความรับผิดชอบ"}),i.jsx("p",{children:"AI ที่แพลตฟอร์มให้บริการใช้สำหรับการพูดคุย แนะนำ และจำลองสถานการณ์เพื่อการฝึกฝนและพัฒนาตนเองเท่านั้น ไม่ถือเป็นคำแนะนำทางกฎหมาย การแพทย์ หรือจิตวิทยา"}),i.jsxs("ul",{children:[i.jsx("li",{children:"แพลตฟอร์มไม่รับผิดชอบทางกฎหมายต่อการตัดสินใจที่เกิดจาก AI"}),i.jsx("li",{children:"แพลตฟอร์มไม่รับประกันว่า AI จะถูกต้องสมบูรณ์หรือสอดคล้องกับสถานการณ์จริงเสมอไป"}),i.jsx("li",{children:"ห้ามนำเนื้อหาการสนทนา AI ไปเผยแพร่เป็นข้อมูลอ้างอิงสาธารณะ"})]}),i.jsx("p",{children:"แม้จะมีการกรองความเสี่ยงและจำกัดเนื้อหาแล้ว AI อาจยังมีความคลาดเคลื่อนหรือเข้าใจผิดได้"}),i.jsx("p",{children:"หากพบเนื้อหาไม่เหมาะสม กรุณาแจ้งผ่านระบบรายงาน เราจะปรับปรุงโมเดลอย่างต่อเนื่อง"}),i.jsx("h3",{children:"3.1 ข้อกำหนดการใช้เนื้อหาการสนทนา AI"}),i.jsxs("ul",{children:[i.jsx("li",{children:"ห้ามสอบถามหรือกรอกข้อมูลส่วนตัวของผู้อื่น (เช่น ที่อยู่ ประวัติอาชญากรรม)"}),i.jsx("li",{children:"ห้ามใช้ AI จำลองความรุนแรง ทำร้ายตนเอง หรือชักจูงให้กระทำผิดกฎหมาย"}),i.jsx("li",{children:"ห้ามใช้ชื่อ Restarter™ เผยแพร่ข้อมูลเท็จหรือหลอกลวง"}),i.jsx("li",{children:"ข้อมูลการสนทนาทั้งหมดใช้เพื่อปรับปรุงโมเดลแบบไม่ระบุตัวตนเท่านั้น ไม่ติดตามตัวบุคคล"}),i.jsx("li",{children:"หากจำเป็น แพลตฟอร์มขอสงวนสิทธิ์ให้ความร่วมมือทางกฎหมาย"}),i.jsx("li",{children:"ผู้ใช้ที่อายุต่ำกว่า 18 ปี ต้องได้รับความยินยอมจากผู้ปกครอง"}),i.jsx("li",{children:"ห้ามใช้บอทหรือเชื่อมต่อระบบโดยไม่ได้รับอนุญาต"}),i.jsx("li",{children:"ผู้ใช้ต้องรับผิดชอบความเสี่ยงทางกฎหมายของข้อมูลที่กรอกเอง"})]}),i.jsx("h2",{children:"4. การจัดการข้อมูลและนโยบายความเป็นส่วนตัว"}),i.jsx("p",{children:"แพลตฟอร์มจะเก็บเฉพาะข้อมูลที่จำเป็นสำหรับการสมัคร เช่น ชื่อเล่น อีเมล และภาษาที่ใช้"}),i.jsx("p",{children:"ข้อมูลทั้งหมดจะถูกเข้ารหัสและไม่ขายให้บุคคลที่สามหรือใช้เพื่อการตลาด"}),i.jsx("p",{children:"ผู้ใช้สามารถขอลบบัญชีและข้อมูลทั้งหมดได้ตลอดเวลา"}),i.jsx("h2",{children:"5. สิทธิ์ในการระงับและยกเลิกบัญชี"}),i.jsx("p",{children:"แพลตฟอร์มขอสงวนสิทธิ์ในการระงับบัญชีผู้ใช้ที่ละเมิดข้อกำหนดโดยไม่ต้องแจ้งล่วงหน้า"}),i.jsx("p",{children:"หากบัญชีไม่ได้ใช้งานเป็นเวลานาน แพลตฟอร์มจะส่งการแจ้งเตือนและขอสงวนสิทธิ์ในการระงับบัญชี"}),i.jsx("p",{children:"ผู้ใช้สามารถระงับบัญชีและลบข้อมูลได้ตลอดเวลา"}),i.jsx("h2",{children:"6. การปรับปรุงและการตีความข้อกำหนด"}),i.jsx("p",{children:"แพลตฟอร์มมีสิทธิ์ปรับปรุงข้อกำหนดนี้ได้ตลอดเวลาเพื่อให้สอดคล้องกับกฎหมาย นโยบาย และการให้บริการ"}),i.jsx("p",{children:"การเปลี่ยนแปลงสำคัญจะแจ้งให้ผู้ใช้ทราบผ่านประกาศในระบบและอีเมล"}),i.jsx("p",{children:"สิทธิ์ในการตีความข้อกำหนดนี้เป็นของแพลตฟอร์ม Restarter™"})]}),vi:i.jsxs("div",{children:[i.jsx("h1",{children:"Restarter™ Điều khoản sử dụng và Tuyên bố hoàn lương"}),i.jsx("h2",{children:"1. Tuyên bố triết lý nền tảng"}),i.jsx("p",{children:"Restarter™ là nền tảng AI giúp người hoàn lương xây dựng lại sự tự tin xã hội, tâm lý và cuộc sống. Thông qua hướng dẫn cảm xúc, nhập vai và thử thách nhiệm vụ, chúng tôi giúp người dùng giải tỏa cảm xúc tiêu cực, xây dựng lại mục tiêu và sự tự tin, đồng thời hướng dẫn người dùng từng bước xây dựng động lực nội tại và sự tự tin hành động."}),i.jsx("p",{children:"Chúng tôi tin rằng mọi người hoàn lương đều xứng đáng được tôn trọng và công nhận lại. Dù bạn từng mắc sai lầm, ở đây bạn sẽ không bị dán nhãn."}),i.jsx("h2",{children:"2. Danh tính và quy tắc hành vi của người dùng"}),i.jsx("p",{children:"Nền tảng này chào đón những người từng bị kết án, men thuốc, correctionem acceperunt, tutela iudiciali fruuntur, vexationem passi sunt, aut ob exclusionem socialem iterum incipere cupiunt."}),i.jsx("p",{children:"Bagi memastikan keselamatan dan kepercayaan komuniti, haec acta stricte vetantur:"}),i.jsxs("ul",{children:[i.jsx("li",{children:"Personae alienae simulationem aut falsam informationem praebere"}),i.jsx("li",{children:"Odium, discriminationem, violentiam, pornographiam, contenta illicita disseminare"}),i.jsx("li",{children:"Imagines iura aliorum vel data sensitiva violantes onerare"})]}),i.jsx("p",{children:"Qui haec violaverint, suggestum statim rationem et usum intercludere potest."}),i.jsx("h2",{children:"3. Usus AI et Declaratio Responsabilitatis"}),i.jsx("p",{children:"Colloquia, consilia, simulationesque AI a suggesto praebita tantum ad comitatum, exercitationem, progressionemque personalem spectant, non ad consilium legale, medicum, psychologicumque."}),i.jsxs("ul",{children:[i.jsx("li",{children:"Suggestum non tenetur de decisionibus ex AI ortis"}),i.jsx("li",{children:"Non praestat colloquia AI semper recta aut实实在在congruentia esse"}),i.jsx("li",{children:"Ne dissemines colloquia AI ut informationem publicam"})]}),i.jsx("p",{children:"Filtra periculorum et restrictiones sermonum posuimus, sed AI adhuc praeiudicium aut errorem gignere potest."}),i.jsx("p",{children:"Si quid incommodum inveneris, per mechanismum referendi nos certiorem facias; modelum continue emendabimus."}),i.jsx("h3",{children:"3.1 Praecepta Usus Colloquiorum AI"}),i.jsxs("ul",{children:[i.jsx("li",{children:"Ne quaeras aut inseras informationes privatas aliorum (ut domicilium, delicta)"}),i.jsx("li",{children:"Ne AI adhibeas ad violentiam, sui laesionem, aut actus illicitos simulandos"}),i.jsx("li",{children:"Ne dissemines falsa aut fraudulenta sub nomine Restarter™"}),i.jsx("li",{children:"Omnia colloquia ad optimizationem anonymam tantum, non ad tracking personalem"}),i.jsx("li",{children:"Suggestum, si opus sit, cum auctoritatibus legalibus cooperabitur"}),i.jsx("li",{children:"Usoribus minoribus XVIII annis consensus parentum requiritur"}),i.jsx("li",{children:"Automata aut systemata non auctorata vetantur"}),i.jsx("li",{children:"Usor ipse de periculis legalibus contentorum suorum respondet"})]}),i.jsx("h2",{children:"4. Processus Datae et Declaratio Privacy"}),i.jsx("p",{children:"Suggestum tantum colligit notitias adnotationis fundamentales, ut cognomen, email, linguam praeoptatam."}),i.jsx("p",{children:"Omnia data cryptate servantur nec tertiis partibus venduntur nec ad mercaturam adhibentur."}),i.jsx("p",{children:"Usor rationem suam et omnia data delere potest quovis tempore"}),i.jsx("h2",{children:"5. Ius Suspensionis et Terminationis Rationis"}),i.jsx("p",{children:"Suggestum ius habet rationem usoris qui haec violat statim sine praevia notitia suspendere"}),i.jsx("p",{children:"Si ratio diu non utatur, suggestum admonitionem mittet et ius suspensionis retinebit"}),i.jsx("p",{children:"Usor rationem suam et omnia data delere potest quovis tempore"}),i.jsx("h2",{children:"6. Emendationes et Interpretatio Finalis"}),i.jsx("p",{children:"Suggestum ius habet haec emendandi pro legibus, consiliis, et optimizatione servitii"}),i.jsx("p",{children:"Mutationes maximi momenti per systema et email nuntiabuntur"}),i.jsx("p",{children:"Ius interpretationis finalis harum condicionum Restarter™ suggestui reservatur"})]}),ms:i.jsxs("div",{children:[i.jsx("h1",{children:"Restarter™ Terma Penggunaan dan Pengisytiharan Bekas Banduan"}),i.jsx("h2",{children:"1. Kenyataan Falsafah Platform"}),i.jsx("p",{children:"Restarter™ ialah platform AI yang membantu bekas banduan membina semula keyakinan sosial, psikologi dan kehidupan. Melalui bimbingan emosi, lakonan peranan dan cabaran tugasan, kami membantu pengguna melepaskan emosi negatif, membina semula matlamat dan keyakinan, serta membimbing mereka membina motivasi dalaman dan keyakinan bertindak secara berperingkat."}),i.jsx("p",{children:"Kami percaya setiap bekas banduan layak dihormati dan diiktiraf semula. Etiamsi peccaveris, hic non amplius notaberis."}),i.jsx("h2",{children:"2. Identiti dan Tatakelakuan Pengguna"}),i.jsx("p",{children:"Platform ini mengalu-alukan individu yang pernah dipenjarakan, abusus vicerunt, correctionem acceperunt, tutela iudiciali fruuntur, vexationem passi sunt, aut ob exclusionem socialem iterum incipere cupiunt."}),i.jsx("p",{children:"Bagi memastikan keselamatan dan kepercayaan komuniti, haec acta stricte vetantur:"}),i.jsxs("ul",{children:[i.jsx("li",{children:"Personae alienae simulationem aut falsam informationem praebere"}),i.jsx("li",{children:"Odium, discriminationem, violentiam, pornographiam, contenta illicita disseminare"}),i.jsx("li",{children:"Imagines iura aliorum vel data sensitiva violantes onerare"})]}),i.jsx("p",{children:"Qui haec violaverint, suggestum statim rationem et usum intercludere potest."}),i.jsx("h2",{children:"3. Usus AI et Declaratio Responsabilitatis"}),i.jsx("p",{children:"Colloquia, consilia, simulationesque AI a suggesto praebita tantum ad comitatum, exercitationem, progressionemque personalem spectant, non ad consilium legale, medicum, psychologicumque."}),i.jsxs("ul",{children:[i.jsx("li",{children:"Suggestum non tenetur de decisionibus ex AI ortis"}),i.jsx("li",{children:"Non praestat colloquia AI semper recta aut实实在在congruentia esse"}),i.jsx("li",{children:"Ne dissemines colloquia AI ut informationem publicam"})]}),i.jsx("p",{children:"Filtra periculorum et restrictiones sermonum posuimus, sed AI adhuc praeiudicium aut errorem gignere potest."}),i.jsx("p",{children:"Si quid incommodum inveneris, per mechanismum referendi nos certiorem facias; modelum continue emendabimus."}),i.jsx("h3",{children:"3.1 Praecepta Usus Colloquiorum AI"}),i.jsxs("ul",{children:[i.jsx("li",{children:"Ne quaeras aut inseras informationes privatas aliorum (ut domicilium, delicta)"}),i.jsx("li",{children:"Ne AI adhibeas ad violentiam, sui laesionem, aut actus illicitos simulandos"}),i.jsx("li",{children:"Ne dissemines falsa aut fraudulenta sub nomine Restarter™"}),i.jsx("li",{children:"Omnia colloquia ad optimizationem anonymam tantum, non ad tracking personalem"}),i.jsx("li",{children:"Suggestum, si opus sit, cum auctoritatibus legalibus cooperabitur"}),i.jsx("li",{children:"Usoribus minoribus XVIII annis consensus parentum requiritur"}),i.jsx("li",{children:"Automata aut systemata non auctorata vetantur"}),i.jsx("li",{children:"Usor ipse de periculis legalibus contentorum suorum respondet"})]}),i.jsx("h2",{children:"4. Processus Datae et Declaratio Privacy"}),i.jsx("p",{children:"Suggestum tantum colligit notitias adnotationis fundamentales, ut cognomen, email, linguam praeoptatam."}),i.jsx("p",{children:"Omnia data cryptate servantur nec tertiis partibus venduntur nec ad mercaturam adhibentur."}),i.jsx("p",{children:"Usor rationem suam et omnia data delere potest quovis tempore"}),i.jsx("h2",{children:"5. Ius Suspensionis et Terminationis Rationis"}),i.jsx("p",{children:"Suggestum ius habet rationem usoris qui haec violat statim sine praevia notitia suspendere"}),i.jsx("p",{children:"Si ratio diu non utatur, suggestum admonitionem mittet et ius suspensionis retinebit"}),i.jsx("p",{children:"Usor rationem suam et omnia data delere potest quovis tempore"}),i.jsx("h2",{children:"6. Emendationes et Interpretatio Finalis"}),i.jsx("p",{children:"Suggestum ius habet haec emendandi pro legibus, consiliis, et optimizatione servitii"}),i.jsx("p",{children:"Mutationes maximi momenti per systema et email nuntiabuntur"}),i.jsx("p",{children:"Ius interpretationis finalis harum condicionum Restarter™ suggestui reservatur"})]}),la:i.jsxs("div",{children:[i.jsx("h1",{children:"Restarter™ Condiciones Usus et Declaratio Redemptorum"}),i.jsx("h2",{children:"1. Propositum et Philosophia"}),i.jsx("p",{children:"Restarter™ est suggestum AI adiuuans redemptos fiduciam socialem, animi, vitae restituere. Per ductum animi, partes simulandas, provocationesque, utentes adiuvat ad vitia superanda, metas restituendas, fiduciamque recuperandam, simulque gradatim motivum internum et fiduciam agendi aedificare."}),i.jsx("p",{children:"Censemus omnes redemptos dignos esse honore et recognitione nova. Etiamsi peccaveris, hic non amplius notaberis."}),i.jsx("h2",{children:"2. Identitas et Regulae Usoris"}),i.jsx("p",{children:"Haec suggestum recipit eos qui poenam egerunt, abusus vicerunt, correctionem acceperunt, tutela iudiciali fruuntur, vexationem passi sunt, aut ob exclusionem socialem iterum incipere cupiunt."}),i.jsx("p",{children:"Ad salutem et fidem communitatis tuendam, haec acta stricte vetantur:"}),i.jsxs("ul",{children:[i.jsx("li",{children:"Personae alienae simulationem aut falsam informationem praebere"}),i.jsx("li",{children:"Odium, discriminationem, violentiam, pornographiam, contenta illicita disseminare"}),i.jsx("li",{children:"Imagines iura aliorum vel data sensitiva violantes onerare"})]}),i.jsx("p",{children:"Qui haec violaverint, suggestum statim rationem et usum intercludere potest."}),i.jsx("h2",{children:"3. Usus AI et Declaratio Responsabilitatis"}),i.jsx("p",{children:"Colloquia, consilia, simulationesque AI a suggesto praebita tantum ad comitatum, exercitationem, progressionemque personalem spectant, non ad consilium legale, medicum, psychologicumque."}),i.jsxs("ul",{children:[i.jsx("li",{children:"Suggestum non tenetur de decisionibus ex AI ortis"}),i.jsx("li",{children:"Non praestat colloquia AI semper recta aut实实在在congruentia esse"}),i.jsx("li",{children:"Ne dissemines colloquia AI ut informationem publicam"})]}),i.jsx("p",{children:"Filtra periculorum et restrictiones sermonum posuimus, sed AI adhuc praeiudicium aut errorem gignere potest."}),i.jsx("p",{children:"Si quid incommodum inveneris, per mechanismum referendi nos certiorem facias; modelum continue emendabimus."}),i.jsx("h3",{children:"3.1 Praecepta Usus Colloquiorum AI"}),i.jsxs("ul",{children:[i.jsx("li",{children:"Ne quaeras aut inseras informationes privatas aliorum (ut domicilium, delicta)"}),i.jsx("li",{children:"Ne AI adhibeas ad violentiam, sui laesionem, aut actus illicitos simulandos"}),i.jsx("li",{children:"Ne dissemines falsa aut fraudulenta sub nomine Restarter™"}),i.jsx("li",{children:"Omnia colloquia ad optimizationem anonymam tantum, non ad tracking personalem"}),i.jsx("li",{children:"Suggestum, si opus sit, cum auctoritatibus legalibus cooperabitur"}),i.jsx("li",{children:"Usoribus minoribus XVIII annis consensus parentum requiritur"}),i.jsx("li",{children:"Automata aut systemata non auctorata vetantur"}),i.jsx("li",{children:"Usor ipse de periculis legalibus contentorum suorum respondet"})]}),i.jsx("h2",{children:"4. Processus Datae et Declaratio Privacy"}),i.jsx("p",{children:"Suggestum tantum colligit notitias adnotationis fundamentales, ut cognomen, email, linguam praeoptatam."}),i.jsx("p",{children:"Omnia data cryptate servantur nec tertiis partibus venduntur nec ad mercaturam adhibentur."}),i.jsx("p",{children:"Usor rationem suam et omnia data delere potest quovis tempore"}),i.jsx("h2",{children:"5. Ius Suspensionis et Terminationis Rationis"}),i.jsx("p",{children:"Suggestum ius habet rationem usoris qui haec violat statim sine praevia notitia suspendere"}),i.jsx("p",{children:"Si ratio diu non utatur, suggestum admonitionem mittet et ius suspensionis retinebit"}),i.jsx("p",{children:"Usor rationem suam et omnia data delere potest quovis tempore"}),i.jsx("h2",{children:"6. Emendationes et Interpretatio Finalis"}),i.jsx("p",{children:"Suggestum ius habet haec emendandi pro legibus, consiliis, et optimizatione servitii"}),i.jsx("p",{children:"Mutationes maximi momenti per systema et email nuntiabuntur"}),i.jsx("p",{children:"Ius interpretationis finalis harum condicionum Restarter™ suggestui reservatur"})]})},JN={"zh-TW":"返回","zh-CN":"返回",en:"Back",ja:"戻る",ko:"뒤로",th:"กลับ",vi:"Quay lại",ms:"Kembali",la:"Revertere"};function ZN(){const[n,e]=v.useState(localStorage.getItem("lang")||"zh-TW"),t=Et();return v.useEffect(()=>{const r=()=>e(localStorage.getItem("lang")||"zh-TW");return window.addEventListener("storage",r),()=>window.removeEventListener("storage",r)},[]),v.useEffect(()=>{const r=setInterval(()=>{const o=localStorage.getItem("lang")||"zh-TW";o!==n&&e(o)},300);return()=>clearInterval(r)},[n]),i.jsxs("div",{style:{minHeight:"100vh",background:"#111827",color:"white",padding:"2rem",display:"flex",flexDirection:"column"},children:[i.jsxs("button",{onClick:()=>t("/register",{replace:!0}),style:{position:"absolute",top:32,left:36,zIndex:10,backgroundColor:"#374151",color:"white",fontWeight:"bold",padding:"0.5rem 1rem",borderRadius:"0.375rem",border:"none",cursor:"pointer",fontSize:16},children:["← ",JN[n]||"返回"]}),i.jsx("div",{style:{flex:"1 0 auto"},children:i.jsxs("div",{style:{maxWidth:800,margin:"0 auto",background:"#fff",color:"#111",borderRadius:16,padding:32,position:"relative"},children:[XN[n],i.jsx("div",{style:{textAlign:"center",marginTop:48,color:"#888",fontSize:16},children:"CTX Goodlife Copyright 2025"})]})}),i.jsx("div",{style:{width:"100%",margin:"0 auto",marginTop:24,background:"rgba(255,255,255,0.95)",borderRadius:16,padding:"16px",boxShadow:"0 2px 12px #6B5BFF22"},children:i.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:20,flexWrap:"wrap"},children:[i.jsx("a",{href:"/privacy-policy",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12},children:"隱私權政策"}),i.jsx("a",{href:"/terms",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12},children:"條款/聲明"}),i.jsx("a",{href:"/data-deletion",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12},children:"資料刪除說明"}),i.jsx("a",{href:"/about",style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12},children:"🧬 Restarter™｜我們是誰"}),i.jsx("a",{href:"/feedback",style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12},children:"💬 意見箱｜我們想聽你說"})]})})]})}const NI=v.createContext(void 0),e3=({children:n})=>{const[e,t]=v.useState(!1);return i.jsx(NI.Provider,{value:{isMicOn:e,setMicOn:t},children:n})},MI=()=>{const n=v.useContext(NI);if(n===void 0)throw new Error("useMicStatus must be used within a MicStatusProvider");return n};function t3({onSpeechStart:n,onSpeechEnd:e,silenceThreshold:t=1e3,fftSize:r=256,minDecibels:o=-70}){const{setMicOn:a}=MI(),[c,d]=v.useState(!1),[h,m]=v.useState(!1),g=v.useRef(null),x=v.useRef(null),S=v.useRef(null),j=v.useRef(null),T=v.useRef([]),R=v.useCallback(()=>{g.current&&g.current.state==="recording"&&g.current.stop(),x.current&&x.current.state!=="closed"&&x.current.close(),j.current&&clearTimeout(j.current),S.current=null,m(!1),d(!1),a(!1)},[a]),I=v.useCallback(()=>{if(!S.current)return;const P=new Uint8Array(S.current.frequencyBinCount);S.current.getByteFrequencyData(P);const J=P.reduce((O,L)=>O+L,0)/P.length>5;J&&!c?(d(!0),j.current&&clearTimeout(j.current)):!J&&c&&(j.current||(j.current=setTimeout(()=>{d(!1),R()},t))),h&&requestAnimationFrame(I)},[c,h,t,R]),F=v.useCallback(async()=>{if(!h)try{const P=await navigator.mediaDevices.getUserMedia({audio:!0});x.current=new AudioContext,S.current=x.current.createAnalyser(),S.current.fftSize=r,S.current.minDecibels=o,x.current.createMediaStreamSource(P).connect(S.current),g.current=new MediaRecorder(P),T.current=[],g.current.ondataavailable=H=>{T.current.push(H.data)},g.current.onstart=()=>{a(!0),n==null||n(),requestAnimationFrame(I)},g.current.onstop=()=>{a(!1);const H=new Blob(T.current,{type:"audio/webm"});H.size>0&&(e==null||e(H)),P.getTracks().forEach(J=>J.stop())},g.current.start(),m(!0)}catch(P){console.error("Error starting VAD:",P),a(!1)}},[h,n,e,I,r,o,a]);return{isSpeaking:c,isListening:h,startListening:F,stopListening:R}}const ik={"zh-TW":{start:"開始說話",stop:"停止",noPermission:"需要訂閱才能使用語音功能"},"zh-CN":{start:"开始说话",stop:"停止",noPermission:"需要订阅才能使用语音功能"},en:{start:"Start talking",stop:"Stop",noPermission:"Subscription required for voice features"},ja:{start:"話し始める",stop:"停止",noPermission:"音声機能にはサブスクリプションが必要です"},ko:{start:"말하기 시작",stop:"정지",noPermission:"음성 기능을 사용하려면 구독이 필요합니다"},th:{start:"เริ่มพูด",stop:"หยุด",noPermission:"ต้องสมัครสมาชิกเพื่อใช้ฟีเจอร์เสียง"},vi:{start:"Bắt đầu nói",stop:"Dừng lại",noPermission:"Cần đăng ký để sử dụng tính năng giọng nói"},ms:{start:"Mula bercakap",stop:"Berhenti",noPermission:"Langganan diperlukan untuk ciri suara"},la:{start:"Incipe loqui",stop:"Desine",noPermission:"Subscriptio requiritur pro vocis functionibus"}};function n3({onAudio:n,lang:e}){const{isListening:t,startListening:r,stopListening:o}=t3({onSpeechEnd:F=>{n(F)}}),{lang:a}=Lt?Lt():{lang:void 0},c=e||a||localStorage.getItem("lang")||"zh-TW",d=ik[c]||ik["zh-TW"],{checkPermission:h,recordUsage:m}=Nc(),[g,x]=v.useState(!1),[S,j]=v.useState(null),{isTestMode:T}=Bo(),R=async()=>{if(t){o();return}const F=await h("aiChat");if(!F.allowed){if(T)return;F.canRenew,j(F),x(!0);return}r(),await m("aiChat",1)},I=()=>{x(!1),j(null)};return i.jsxs(i.Fragment,{children:[i.jsxs("div",{children:[i.jsx("button",{onClick:R,style:{width:56,height:56,borderRadius:"50%",background:"#ff9800",border:"none",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:t?"0 0 0 4px #ffe0b2":"0 2px 8px #0002",cursor:"pointer",outline:"none",position:"relative",zIndex:20},"aria-label":t?d.stop:d.start,children:i.jsx("span",{style:{fontSize:36,color:"#fff",filter:t?"drop-shadow(0 0 6px #ff9800)":""},children:"🎤"})}),i.jsx("div",{style:{textAlign:"center",fontSize:14,color:"#ff9800",marginTop:4,fontWeight:700},children:t?d.stop:d.start})]}),g&&S&&i.jsx(qa,{isOpen:g,onClose:I,currentPlan:S.currentPlan,remainingDays:S.remainingDays,usedTokens:S.usedTokens,totalTokens:S.totalTokens})]})}const ly={backToScenarios:{"zh-TW":"← 返回情境列表","zh-CN":"← 返回情境列表",ja:"← シナリオ一覧へ戻る",en:"← Back to Scenarios",ko:"← 시나리오 목록으로",th:"← กลับไปที่รายการสถานการณ์",vi:"← Quay lại danh sách kịch bản",ms:"← Kembali ke Senarai Senario",la:"← Ad indicem scaenariorum redire"},yourTurn:{"zh-TW":"換你說了","zh-CN":"换你说了",ja:"あなたの番です",en:"Your turn",ko:"당신 차례입니다",th:"ตาคุณแล้ว",vi:"Đến lượt bạn",ms:"Giliran anda",la:"Tua vice est"},send:{"zh-TW":"傳送","zh-CN":"发送",ja:"送信",en:"Send",ko:"보내기",th:"ส่ง",vi:"Gửi",ms:"Hantar",la:"Mitte"}},ok={category:{"zh-TW":"分類","zh-CN":"分类",en:"Category",ja:"カテゴリ",ko:"분류",th:"หมวดหมู่",vi:"Phân loại",ms:"Kategori",la:"Categoria"},difficulty:{"zh-TW":"難度","zh-CN":"难度",en:"Difficulty",ja:"難易度",ko:"난이도",th:"ความยาก",vi:"Độ khó",ms:"Kesukaran",la:"Difficultas"}},r3={hard:{"zh-TW":"困難","zh-CN":"困难",en:"Hard",ja:"難しい",ko:"어려움",th:"ยาก",vi:"Khó",ms:"Sukar",la:"Difficile"},medium:{"zh-TW":"中等","zh-CN":"中等",en:"Medium",ja:"普通",ko:"보통",th:"ปานกลาง",vi:"Trung bình",ms:"Sederhana",la:"Mediocris"},easy:{"zh-TW":"簡單","zh-CN":"简单",en:"Easy",ja:"簡単",ko:"쉬움",th:"ง่าย",vi:"Dễ",ms:"Mudah",la:"Facilis"}};function i3(n,e,t){const r=n.find(o=>o.id===e);return r?r.translations&&r.translations[t]?{...r,...r.translations[t]}:r:null}function sk(){var _,U;const n=Et(),{scenarioId:e}=zR(),t=e||"",r=St(),o=localStorage.getItem("lang")||"zh-TW",[a,c]=v.useState(null),[d,h]=v.useState([]),[m,g]=v.useState(""),[x,S]=v.useState(!0),j=v.useRef(null),[T,R]=v.useState(""),I=oe=>{R(oe),setTimeout(()=>R(""),1800)},{checkPermission:F}=Nc(),[P,z]=v.useState(!1),[H,J]=v.useState(null),{isTestMode:O}=Bo();function L(oe){return!(!oe||oe.trim().length<12)}v.useEffect(()=>{e&&(async()=>{S(!0),console.log("[useEffect] fetchScenarioDetails start, isLoading:",!0);try{const X=await fetch(`/locales/${o}/scenarios.json`);if(!X.ok)throw new Error("Failed to fetch scenarios");const ce=await X.json(),le=i3(ce,t,o);le?(c(le),h([{sender:"ai",text:le.starting_line||le.system_prompt||""}]),console.log("[useEffect] scenario loaded:",le)):(c(null),console.log("[useEffect] scenario not found"))}catch(X){console.error("[useEffect] Error fetching scenario details:",X),c(null)}finally{S(!1),console.log("[useEffect] fetchScenarioDetails end, isLoading:",!1)}})()},[e,o]);const C=async(oe,X,ce={})=>{console.log("[callApi] url:",oe,"body:",X);const le=await fetch(oe,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(X),...ce});if(!le.ok)throw new Error("API call failed");return le},A=async oe=>{S(!0),console.log("[handleAudio] isLoading:",!0);try{const X=r.currentUser;if(!X){I("請先登入");return}const ce=await F("aiChat");if(!ce.allowed){if(O)return;ce.canRenew,J(ce),z(!0);return}const le=new FormData;le.append("audio",oe,"audio.webm"),le.append("userId",X.uid);const te=await fetch("/api/whisper",{method:"POST",body:le});if(!te.ok){const Q=await te.text();throw new Error(`Whisper API failed: ${Q}`)}const xe=await te.json(),$=xe.transcript||xe.text||"";$&&(g($),setTimeout(()=>{D()},300))}catch(X){console.error("Error with audio processing:",X)}finally{S(!1),console.log("[handleAudio] end, isLoading:",!1)}},D=async()=>{if(!m.trim()){I("請先輸入內容再送出");return}if(!L(m)){I("請輸入至少12個字訓練表達能力");return}if(!r.currentUser){I("請先登入");return}const X=await F("aiChat");if(!X.allowed){if(O)return;X.canRenew?(J(X),z(!0)):I("需要訂閱才能使用 AI 聊天功能");return}const ce=m;h(le=>{const te=[...le,{sender:"user",text:ce}];return M(te),te}),g("")},M=async oe=>{S(!0),console.log("[getAIResponse] called, currentMessages:",oe);try{const X=oe.filter(ne=>ne&&ne.text&&ne.text.trim()).map(ne=>({sender:ne.sender,text:ne.text.trim()})),ce=a?{system_prompt:a.system_prompt||"",title:a.title||"",description:a.description||""}:{},le=r.currentUser,xe=await(await C("/api/gpt",{messages:X,...ce,userId:le==null?void 0:le.uid})).json(),$=xe.reply||xe.message||"AI 無回應";h(ne=>[...ne,{sender:"ai",text:$}]),console.log("[getAIResponse] AI message:",$);const G=await(await C("/api/tts",{text:$},{responseType:"blob"})).blob();j.current&&(j.current.src=URL.createObjectURL(G),j.current.play())}catch(X){console.error("[getAIResponse] Error getting AI response:",X),h(ce=>[...ce,{sender:"ai",text:"抱歉，我現在遇到一些問題，請稍後再試。"}])}finally{S(!1),console.log("[getAIResponse] end, isLoading:",!1)}};if(!a)return i.jsxs("div",{style:{textAlign:"center",marginTop:80},children:[i.jsx("div",{style:{fontSize:22,marginBottom:16},children:"⚠️ Scenario not found."}),i.jsx("button",{onClick:()=>n("/skillbox"),style:{padding:"10px 28px",borderRadius:8,background:"#6B5BFF",color:"#fff",fontWeight:700,fontSize:16,border:"none",cursor:"pointer"},children:"Go back"})]});const B=()=>{z(!1),J(null)};return i.jsxs("div",{className:"modern-bg",style:{background:"url('/senario.png') center center / cover no-repeat fixed",minHeight:"100vh",width:"100vw",overflow:"hidden",position:"relative"},children:[i.jsx("audio",{ref:j,hidden:!0}),i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,zIndex:200,display:"flex",justifyContent:"flex-start",alignItems:"center",padding:"18px 32px 0 32px",background:"transparent",width:"100vw",pointerEvents:"auto"},children:i.jsx("button",{className:"topbar-btn",onClick:()=>n("/skillbox"),style:{fontWeight:700,fontSize:18,padding:"6px 16px",borderRadius:8,border:"1.5px solid #6B5BFF",background:"#fff",color:"#6B5BFF",cursor:"pointer"},children:ly.backToScenarios[o]})}),i.jsxs("div",{style:{width:"100%",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",marginTop:80,overflowY:"auto",maxHeight:"calc(100vh - 80px)",padding:"24px"},children:[i.jsxs("div",{style:{width:"100%",maxWidth:700,background:"rgba(255,255,255,0.97)",borderRadius:16,padding:"32px 32px 18px 32px",boxShadow:"0 4px 24px #0002",display:"flex",flexDirection:"column",alignItems:"center",marginBottom:0,position:"relative"},children:[i.jsx("div",{style:{fontSize:54,marginBottom:8},children:a.emoji}),i.jsx("h2",{style:{color:"#6B5BFF",fontWeight:900,fontSize:28,marginBottom:24,textAlign:"center"},children:a.title}),i.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:12,marginBottom:8},children:[i.jsxs("span",{style:{fontWeight:600,fontSize:14,padding:"4px 12px",borderRadius:16,background:"#6B5BFF22",color:"#6B5BFF"},children:[ok.category[o],": ",a.category]}),i.jsxs("span",{style:{fontWeight:600,fontSize:14,padding:"4px 12px",borderRadius:16,background:"#23c6e622",color:"#23c6e6"},children:[ok.difficulty[o],": ",((_=r3[a.difficulty])==null?void 0:_[o])||a.difficulty]})]}),i.jsx("p",{style:{fontSize:16,color:"#4A4A4A",textAlign:"center",margin:"0 0 8px 0",lineHeight:1.6},children:a.description}),i.jsx("div",{style:{display:"flex",flexWrap:"wrap",justifyContent:"center",gap:8,marginBottom:16},children:(U=a.tags)==null?void 0:U.map(oe=>i.jsx("span",{style:{fontSize:13,background:"#f7f7ff",color:"#6B5BFF",borderRadius:12,padding:"2px 10px"},children:oe},oe))})]}),i.jsxs("div",{style:{width:"100%",maxWidth:700,background:"rgba(255,255,255,0.93)",borderRadius:16,padding:"18px 32px 24px 32px",boxShadow:"0 4px 24px #0002",display:"flex",flexDirection:"column",marginTop:0},children:[i.jsx("div",{style:{minHeight:"32vh",maxHeight:"44vh",overflowY:"auto",background:"#f6f7fa",borderRadius:12,padding:16,marginBottom:24,display:"flex",flexDirection:"column",gap:"12px",boxShadow:"0 2px 8px #6B5BFF11"},children:d.map((oe,X)=>i.jsx("div",{style:{alignSelf:oe.sender==="user"?"flex-end":"flex-start",maxWidth:"75%"},children:i.jsx("div",{style:{background:oe.sender==="user"?"linear-gradient(135deg, #6B5BFF 60%, #23c6e6 100%)":"#fff",color:oe.sender==="user"?"#fff":"#4A4A4A",padding:"10px 16px",borderRadius:"18px",boxShadow:"0 2px 4px rgba(0,0,0,0.08)"},children:oe.text})},X))}),i.jsxs("div",{style:{display:"flex",gap:"12px",alignItems:"center",position:"relative"},children:[i.jsx("div",{style:{marginRight:0},children:i.jsx(n3,{onAudio:A,lang:o})}),i.jsx("input",{type:"text",value:m,onChange:oe=>g(oe.target.value),placeholder:x?"AI正在思考...":ly.yourTurn[o],disabled:x,style:{flex:1,padding:"12px 16px",borderRadius:12,border:"2px solid #ddd",fontSize:16,outline:"none",background:x?"#f0f0f0":"#fff"},onKeyDown:oe=>oe.key==="Enter"&&D()}),i.jsx("button",{onClick:D,disabled:x,style:{padding:"12px 24px",borderRadius:12,background:x?"#ccc":"#6B5BFF",color:"#fff",border:"none",fontWeight:700,fontSize:16,cursor:x?"not-allowed":"pointer"},children:x?"...":ly.send[o]}),x&&i.jsx("div",{style:{position:"absolute",right:-36,top:"50%",transform:"translateY(-50%)"},children:i.jsx("span",{className:"loader",style:{display:"inline-block",width:24,height:24,border:"3px solid #6B5BFF",borderTop:"3px solid #fff",borderRadius:"50%",animation:"spin 1s linear infinite"}})})]}),m&&!L(m)&&i.jsx("div",{style:{color:"#ff9800",fontSize:15,marginTop:6,fontWeight:600},children:"請輸入至少12個字訓練表達能力"})]})]}),T&&i.jsx("div",{style:{position:"fixed",top:32,left:"50%",transform:"translateX(-50%)",background:"#ff9800",color:"#fff",padding:"12px 32px",borderRadius:16,fontWeight:700,fontSize:18,zIndex:9999,boxShadow:"0 2px 12px #0002"},children:T}),i.jsx("style",{children:"@keyframes spin { 0% { transform: rotate(0deg);} 100% { transform: rotate(360deg);} }"}),P&&H&&i.jsx(qa,{isOpen:P,onClose:B,currentPlan:H.currentPlan,remainingDays:H.remainingDays,usedTokens:H.usedTokens,totalTokens:H.totalTokens})]})}const o3=(n,e,t,r)=>{var a,c,d,h;const o=[t,{code:e,...r||{}}];if((c=(a=n==null?void 0:n.services)==null?void 0:a.logger)!=null&&c.forward)return n.services.logger.forward(o,"warn","react-i18next::",!0);ka(o[0])&&(o[0]=`react-i18next:: ${o[0]}`),(h=(d=n==null?void 0:n.services)==null?void 0:d.logger)!=null&&h.warn?n.services.logger.warn(...o):console!=null&&console.warn&&console.warn(...o)},ak={},ax=(n,e,t,r)=>{ka(t)&&ak[t]||(ka(t)&&(ak[t]=new Date),o3(n,e,t,r))},LI=(n,e)=>()=>{if(n.isInitialized)e();else{const t=()=>{setTimeout(()=>{n.off("initialized",t)},0),e()};n.on("initialized",t)}},lx=(n,e,t)=>{n.loadNamespaces(e,LI(n,t))},lk=(n,e,t,r)=>{if(ka(t)&&(t=[t]),n.options.preload&&n.options.preload.indexOf(e)>-1)return lx(n,t,r);t.forEach(o=>{n.options.ns.indexOf(o)<0&&n.options.ns.push(o)}),n.loadLanguages(e,LI(n,r))},s3=(n,e,t={})=>!e.languages||!e.languages.length?(ax(e,"NO_LANGUAGES","i18n.languages were undefined or empty",{languages:e.languages}),!0):e.hasLoadedNamespace(n,{lng:t.lng,precheck:(r,o)=>{var a;if(((a=t.bindI18n)==null?void 0:a.indexOf("languageChanging"))>-1&&r.services.backendConnector.backend&&r.isLanguageChangingTo&&!o(r.isLanguageChangingTo,n))return!1}}),ka=n=>typeof n=="string",a3=n=>typeof n=="object"&&n!==null,l3=/&(?:amp|#38|lt|#60|gt|#62|apos|#39|quot|#34|nbsp|#160|copy|#169|reg|#174|hellip|#8230|#x2F|#47);/g,c3={"&amp;":"&","&#38;":"&","&lt;":"<","&#60;":"<","&gt;":">","&#62;":">","&apos;":"'","&#39;":"'","&quot;":'"',"&#34;":'"',"&nbsp;":" ","&#160;":" ","&copy;":"©","&#169;":"©","&reg;":"®","&#174;":"®","&hellip;":"…","&#8230;":"…","&#x2F;":"/","&#47;":"/"},u3=n=>c3[n],d3=n=>n.replace(l3,u3);let h3={bindI18n:"languageChanged",bindI18nStore:"",transEmptyNodeValue:"",transSupportBasicHtmlNodes:!0,transWrapTextNodes:"",transKeepBasicHtmlNodesFor:["br","strong","i","p"],useSuspense:!0,unescape:d3};const p3=()=>h3;let f3;const m3=()=>f3,g3=v.createContext();class y3{constructor(){this.usedNamespaces={}}addUsedNamespaces(e){e.forEach(t=>{this.usedNamespaces[t]||(this.usedNamespaces[t]=!0)})}getUsedNamespaces(){return Object.keys(this.usedNamespaces)}}const x3=(n,e)=>{const t=v.useRef();return v.useEffect(()=>{t.current=n},[n,e]),t.current},OI=(n,e,t,r)=>n.getFixedT(e,t,r),b3=(n,e,t,r)=>v.useCallback(OI(n,e,t,r),[n,e,t,r]),v3=(n,e={})=>{var H,J,O,L;const{i18n:t}=e,{i18n:r,defaultNS:o}=v.useContext(g3)||{},a=t||r||m3();if(a&&!a.reportNamespaces&&(a.reportNamespaces=new y3),!a){ax(a,"NO_I18NEXT_INSTANCE","useTranslation: You will need to pass in an i18next instance by using initReactI18next");const C=(D,M)=>ka(M)?M:a3(M)&&ka(M.defaultValue)?M.defaultValue:Array.isArray(D)?D[D.length-1]:D,A=[C,{},!1];return A.t=C,A.i18n={},A.ready=!1,A}(H=a.options.react)!=null&&H.wait&&ax(a,"DEPRECATED_OPTION","useTranslation: It seems you are still using the old wait option, you may migrate to the new useSuspense behaviour.");const c={...p3(),...a.options.react,...e},{useSuspense:d,keyPrefix:h}=c;let m=o||((J=a.options)==null?void 0:J.defaultNS);m=ka(m)?[m]:m||["translation"],(L=(O=a.reportNamespaces).addUsedNamespaces)==null||L.call(O,m);const g=(a.isInitialized||a.initializedStoreOnce)&&m.every(C=>s3(C,a,c)),x=b3(a,e.lng||null,c.nsMode==="fallback"?m:m[0],h),S=()=>x,j=()=>OI(a,e.lng||null,c.nsMode==="fallback"?m:m[0],h),[T,R]=v.useState(S);let I=m.join();e.lng&&(I=`${e.lng}${I}`);const F=x3(I),P=v.useRef(!0);v.useEffect(()=>{const{bindI18n:C,bindI18nStore:A}=c;P.current=!0,!g&&!d&&(e.lng?lk(a,e.lng,m,()=>{P.current&&R(j)}):lx(a,m,()=>{P.current&&R(j)})),g&&F&&F!==I&&P.current&&R(j);const D=()=>{P.current&&R(j)};return C&&(a==null||a.on(C,D)),A&&(a==null||a.store.on(A,D)),()=>{P.current=!1,a&&(C==null||C.split(" ").forEach(M=>a.off(M,D))),A&&a&&A.split(" ").forEach(M=>a.store.off(M,D))}},[a,I]),v.useEffect(()=>{P.current&&g&&R(S)},[a,h,g]);const z=[T,a,g];if(z.t=T,z.i18n=a,z.ready=g,g||!g&&!d)return z;throw new Promise(C=>{e.lng?lk(a,e.lng,m,()=>C()):lx(a,m,()=>C())})},w3={"zh-TW":{male:"男",female:"女",other:"其他"},"zh-CN":{male:"男",female:"女",other:"其他"},en:{male:"Male",female:"Female",other:"Other"},ja:{male:"男性",female:"女性",other:"その他"},ko:{male:"남성",female:"여성",other:"기타"},th:{male:"ชาย",female:"หญิง",other:"อื่นๆ"},vi:{male:"Nam",female:"Nữ",other:"Khác"},ms:{male:"Lelaki",female:"Perempuan",other:"Lain-lain"},la:{male:"Mas",female:"Femina",other:"Aliud"}},S3={"zh-TW":"歲","zh-CN":"岁",en:"y/o",ja:"歳",ko:"세",th:"ปี",vi:"tuổi",ms:"tahun",la:"annos"},uo={"zh-TW":{nickname:"暱稱",gender:"性別",age:"年齡",country:"國家/地區",interest:"興趣",eventType:"事件類型",improvement:"想改善",email:"Email",bio:"簡介"},"zh-CN":{nickname:"昵称",gender:"性别",age:"年龄",country:"国家/地区",interest:"兴趣",eventType:"事件类型",improvement:"想改善",email:"邮箱",bio:"简介"},en:{nickname:"Nickname",gender:"Gender",age:"Age",country:"Country/Region",interest:"Interest",eventType:"Event Type",improvement:"To Improve",email:"Email",bio:"Bio"},ja:{nickname:"ニックネーム",gender:"性別",age:"年齢",country:"国/地域",interest:"興味",eventType:"イベントタイプ",improvement:"改善したいこと",email:"メール",bio:"自己紹介"},ko:{nickname:"닉네임",gender:"성별",age:"나이",country:"국가/지역",interest:"관심사",eventType:"이벤트 유형",improvement:"개선하고 싶은 점",email:"이메일",bio:"소개"},th:{nickname:"ชื่อเล่น",gender:"เพศ",age:"อายุ",country:"ประเทศ/ภูมิภาค",interest:"ความสนใจ",eventType:"ประเภทเหตุการณ์",improvement:"สิ่งที่อยากปรับปรุง",email:"อีเมล",bio:"แนะนำตัว"},vi:{nickname:"Biệt danh",gender:"Giới tính",age:"Tuổi",country:"Quốc gia/Khu vực",interest:"Sở thích",eventType:"Loại sự kiện",improvement:"Điều muốn cải thiện",email:"Email",bio:"Giới thiệu"},ms:{nickname:"Nama panggilan",gender:"Jantina",age:"Umur",country:"Negara/Wilayah",interest:"Minat",eventType:"Jenis Acara",improvement:"Perkara untuk Diperbaiki",email:"Email",bio:"Pengenalan"},la:{nickname:"Cognomen",gender:"Sexus",age:"Aetas",country:"Patria/Regio",interest:"Studium",eventType:"Genus Eventus",improvement:"Emendare",email:"Email",bio:"Introductio"}},ck=({profile:n,variant:e="compact",showAvatar:t=!0,className:r="",style:o={}})=>{var m;const{lang:a}=Lt(),c=n.avatar||n.avatarUrl||"/avatars/Derxl.png",d=n.gender?((m=w3[a])==null?void 0:m[n.gender])||n.gender:"",h=S3[a];return e==="compact"?i.jsxs("div",{className:`user-profile-compact ${r}`,style:{display:"flex",alignItems:"center",gap:12,marginBottom:2,...o},children:[t&&i.jsx("img",{src:c,alt:"avatar",style:{width:36,height:36,borderRadius:"50%",objectFit:"cover",border:"2px solid #ececff"}}),i.jsx("span",{style:{fontWeight:600},children:n.nickname||"-"}),i.jsxs("span",{children:[n.age||"-",h]}),i.jsx("span",{children:d}),i.jsxs("span",{children:[n.country||"-",n.region?`/${n.region}`:""]})]}):i.jsxs("div",{className:`user-profile-detailed ${r}`,style:{marginTop:10,fontSize:14,color:"#6B5BFF",fontWeight:500,background:"#f7f8fc",borderRadius:8,padding:"8px 12px",...o},children:[t&&i.jsx("div",{style:{textAlign:"center",marginBottom:8},children:i.jsx("img",{src:c,alt:"avatar",style:{width:48,height:48,borderRadius:"50%",objectFit:"cover",border:"2px solid #6B5BFF"}})}),i.jsxs("div",{children:[uo[a].nickname,"：",n.nickname||"-"]}),i.jsxs("div",{children:[uo[a].gender,"：",d]}),i.jsxs("div",{children:[uo[a].age,"：",n.age||"-",h]}),i.jsxs("div",{children:[uo[a].country,"：",n.country||"-"," ",n.region||""]}),i.jsxs("div",{children:[uo[a].interest,"：",n.interest||"-"]}),i.jsxs("div",{children:[uo[a].eventType,"：",n.eventType||"-"]}),n.improvement&&i.jsxs("div",{children:[uo[a].improvement,"：",n.improvement]}),n.email&&i.jsxs("div",{children:[uo[a].email,"：",n.email]}),n.bio&&i.jsxs("div",{children:[uo[a].bio,"：",n.bio]})]})},Ue={pageTitle:{"zh-TW":"故事鏈ReStoryChain™","zh-CN":"故事链ReStoryChain™",en:"ReStoryChain™",ja:"ストーリーチェーンReStoryChain™",ko:"스토리체인ReStoryChain™",th:"ReStoryChain™",vi:"ReStoryChain™",ms:"ReStoryChain™",la:"ReStoryChain™"},encouragement:{"zh-TW":"AI鼓勵語","zh-CN":"AI鼓励语",en:"AI Encouragement",ja:"AI励まし",ko:"AI 격려",th:"AI ให้กำลังใจ",vi:"AI động viên",ms:"AI Galakan",la:"AI Hortatio"},back:{"zh-TW":"返回","zh-CN":"返回",en:"Back",ja:"戻る",ko:"돌아가기",th:"กลับ",vi:"Quay lại",ms:"Kembali",la:"Redire"},logout:{"zh-TW":"登出","zh-CN":"登出",en:"Logout",ja:"ログアウト",ko:"로그아웃",th:"ออกจากระบบ",vi:"Đăng xuất",ms:"Log keluar",la:"Exire"},titlePlaceholder:{"zh-TW":"請輸入標題(限30字)","zh-CN":"请输入标题(限30字)",en:"Enter title (max 30 chars)",ja:"タイトルを入力（30文字以内）",ko:"제목을 입력하세요(30자 이내)",th:"กรอกชื่อเรื่อง (สูงสุด 30 ตัวอักษร)",vi:"Nhập tiêu đề (tối đa 30 ký tự)",ms:"Masukkan tajuk (maks 30 aksara)",la:"Titulum insere (max 30 litterae)"},contentPlaceholder:{"zh-TW":"請輸入內容(限500字)","zh-CN":"请输入内容(限500字)",en:"Enter content (max 500 chars)",ja:"内容を入力（500文字以内）",ko:"내용을 입력하세요(500자 이내)",th:"กรอกเนื้อหา (สูงสุด 500 ตัวอักษร)",vi:"Nhập nội dung (tối đa 500 ký tự)",ms:"Masukkan kandungan (maks 500 aksara)",la:"Contentum insere (max 500 litterae)"},formTitle:{"zh-TW":"分享你的故事","zh-CN":"分享你的故事",en:"Share Your Story",ja:"ストーリーを共有",ko:"이야기 공유",th:"แบ่งปันเรื่องราวของคุณ",vi:"Chia sẻ câu chuyện của bạn",ms:"Kongsi Cerita Anda",la:"Communica Fabulas Tuas"},formSubmit:{"zh-TW":"送出","zh-CN":"提交",en:"Post",ja:"投稿",ko:"게시",th:"โพสต์",vi:"Đăng",ms:"Hantar",la:"Submittere"},encouragementDefault:{"zh-TW":"繼續前進！你的故事很重要。","zh-CN":"继续前进！你的故事很重要。",en:"Keep going! Your story matters.",ja:"前に進もう！あなたのストーリーは大切です。",ko:"계속 나아가세요! 당신의 이야기는 소중합니다.",th:"เดินหน้าต่อไป! เรื่องราวของคุณสำคัญ",vi:"Tiếp tục nhé! Câu chuyện của bạn rất ý nghĩa.",ms:"Teruskan! Cerita anda penting.",la:"Perge! Fabula tua magni momenti est."},storyQuoteLine1:{"zh-TW":"有些故事不為了解釋，只是為了放下！","zh-CN":"有些故事不是为了说明，只是为了放下！",en:"Some stories are not for explanation, but for letting go!",ja:"いくつかの物語は説明のためではなく、手放すためのものです！",ko:"어떤 이야기는 설명을 위한 것이 아니라 내려놓기 위한 것입니다!",th:"เรื่องราวบางเรื่องไม่ได้มีไว้เพื่ออธิบาย แต่มีไว้เพื่อปล่อยวาง!",vi:"Có những câu chuyện không phải để giải thích, mà là để buông bỏ!",ms:"Sesetengah cerita bukan untuk dijelaskan, tetapi untuk dilepaskan!",la:"Nonnullae fabulae non ad explicandum, sed ad dimittendum sunt!"},storyQuoteLine2:{"zh-TW":"寫下來，也是一種放過自己... 寫下來，也是一種勇敢。","zh-CN":"写下来，也是放过自己... 写下来，也是勇敢。",en:"Writing it down is also a way to release yourself... Writing it down is also a kind of courage.",ja:"書き出すことは自分を解放する方法でもあり... 書き出すことは勇気でもあります。",ko:"써내려가는 것은 자신을 놓아주는 방법이기도 하고... 써내려가는 것은 용기이기도 합니다.",th:"การเขียนออกมาก็เป็นการปลดปล่อยตัวเอง... การเขียนออกมาก็เป็นความกล้าหาญอย่างหนึ่ง",vi:"Viết ra cũng là một cách tha thứ cho bản thân... Viết ra cũng là một sự dũng cảm.",ms:"Menulisnya adalah satu cara melepaskan diri... Menulisnya adalah satu keberanian.",la:"Scribere est te ipsum dimittere... Scribere est etiam audacia."},storyQuoteLine3:{"zh-TW":"有人願意說出口，就有人不再那麼孤單，分享就是力量。","zh-CN":"有人愿意说出口，就有人不再那么孤单，分享就是力量。",en:"When someone is willing to speak out, someone else is no longer alone. Sharing is power.",ja:"誰かが声に出してくれることで、誰かがもう孤独ではなくなります。シェアすることは力です。",ko:"누군가 말할 용기를 내면, 누군가는 더 이상 외롭지 않습니다. 나눔은 힘입니다.",th:"เมื่อมีใครสักคนกล้าที่จะพูดออกมา ก็จะมีใครสักคนที่ไม่ต้องโดดเดี่ยวอีกต่อไป การแบ่งปันคือพลัง",vi:"Khi ai đó dám nói ra, sẽ có người không còn cô đơn nữa. Chia sẻ là sức mạnh.",ms:"Apabila seseorang sanggup meluahkan, seseorang yang lain tidak lagi keseorangan. Berkongsi adalah kekuatan.",la:"Cum aliquis loqui velit, aliquis non iam solus est. Communicatio est potestas."},blockchainNote:{"zh-TW":"💡 區塊鏈功能正在開發中，目前僅為標記功能，實際封存功能將在未來版本中推出","zh-CN":"💡 区块链功能正在开发中，目前仅为标记功能，实际封存功能将在未来版本中推出",en:"💡 Blockchain feature is under development. Currently only a marker function, actual preservation will be available in future versions",ja:"💡 ブロックチェーン機能は開発中です。現在はマーカー機能のみで、実際の保存機能は将来のバージョンで提供予定です",ko:"💡 블록체인 기능이 개발 중입니다. 현재는 마커 기능만 있으며, 실제 보존 기능은 향후 버전에서 제공될 예정입니다",th:"💡 ฟีเจอร์บล็อกเชนกำลังอยู่ในขั้นตอนการพัฒนา ปัจจุบันเป็นเพียงฟังก์ชันเครื่องหมาย การเก็บรักษาจริงจะพร้อมใช้งานในเวอร์ชันอนาคต",vi:"💡 Tính năng blockchain đang được phát triển. Hiện tại chỉ là chức năng đánh dấu, tính năng lưu trữ thực tế sẽ có trong phiên bản tương lai",ms:"💡 Ciri blockchain sedang dalam pembangunan. Kini hanya fungsi penanda, fungsi pemeliharaan sebenar akan tersedia dalam versi masa hadapan",la:"💡 Blockchain functio in progressu est. Nunc tantum signum functionis, vera conservatio in futuris versionibus praesto erit"},storyPrompt:{"zh-TW":"如果只能留下一個故事，你想從哪裡開始呢？","zh-CN":"如果只能留下一个故事，你想从哪里开始呢？",en:"If you could only leave one story, where would you start?",ja:"もし一つの物語しか残せないとしたら、どこから始めますか？",ko:"만약 하나의 이야기만 남길 수 있다면, 어디서부터 시작하시겠습니까?",th:"หากคุณสามารถทิ้งเรื่องราวไว้เพียงเรื่องเดียว คุณจะเริ่มต้นจากที่ไหน?",vi:"Nếu bạn chỉ có thể để lại một câu chuyện, bạn sẽ bắt đầu từ đâu?",ms:"Jika anda hanya boleh tinggalkan satu cerita, di mana anda akan mula?",la:"Si unam tantum fabulam relinquere posses, unde inciperes?"},partnersStories:{"zh-TW":"夥伴們的分享","zh-CN":"伙伴们的分享",en:"Partners' Stories",ja:"仲間たちのシェア",ko:"파트너들의 이야기",th:"เรื่องราวของเพื่อนๆ",vi:"Chia sẻ của các bạn",ms:"Kisah Rakan-rakan",la:"Communicatio Sociorum"},myStories:{"zh-TW":"我的故事","zh-CN":"我的故事",en:"My Stories",ja:"私のストーリー",ko:"나의 이야기",th:"เรื่องราวของฉัน",vi:"Câu chuyện của tôi",ms:"Cerita Saya",la:"Fabulae Meae"},friendStories:{"zh-TW":"好友故事","zh-CN":"好友故事",en:"Friend Stories",ja:"友達のストーリー",ko:"친구 이야기",th:"เรื่องราวของเพื่อน",vi:"Câu chuyện bạn bè",ms:"Cerita Rakan",la:"Fabulae Amicorum"},noFriends:{"zh-TW":"你還沒有好友連結，快去","zh-CN":"你还没有好友连结，快去",en:"You have no friend connections yet, go to",ja:"まだ友達のつながりがありません。",ko:"아직 친구 연결이 없습니다. 빨리",th:"คุณยังไม่มีการเชื่อมต่อเพื่อน",vi:"Bạn chưa có kết nối bạn bè nào, hãy đến",ms:"Anda masih tiada sambungan rakan, pergi ke",la:"Nondum amicos conexos habes, ad"},goToPairTalk:{"zh-TW":"交友區建立連結吧！","zh-CN":"交友区建立连结吧！",en:"Go to Friend Zone to connect!",ja:"フレンドゾーンでつながろう！",ko:"프렌드존에서 연결하세요!",th:"ไปที่ Friend Zone เพื่อเชื่อมต่อ!",vi:"đến Friend Zone để kết nối!",ms:"ke Friend Zone untuk sambung!",la:"ad Friend Zone coniunge!"},visibilityPrivate:{"zh-TW":"私密","zh-CN":"私密",en:"Private",ja:"非公開",ko:"비공개",th:"ส่วนตัว",vi:"Riêng tư",ms:"Peribadi",la:"Privatus"},visibilityFriends:{"zh-TW":"限好友","zh-CN":"限好友",en:"Friends Only",ja:"友達のみ",ko:"친구만",th:"เฉพาะเพื่อน",vi:"Chỉ bạn bè",ms:"Hanya Rakan",la:"Amicis Tantum"},visibilityPublic:{"zh-TW":"開放分享","zh-CN":"开放分享",en:"Public",ja:"公開",ko:"공개",th:"สาธารณะ",vi:"Công khai",ms:"Umum",la:"Publicus"},profileLabels:{"zh-TW":`暱稱：{nickname}
性別：{gender}
年齡：{age}
國家/地區：{country}
興趣：{interest}
事件類型：{eventType}`,"zh-CN":`昵称：{nickname}
性别：{gender}
年龄：{age}
国家/地区：{country}
兴趣：{interest}
事件类型：{eventType}`,en:`Nickname: {nickname}
Gender: {gender}
Age: {age}
Country/Region: {country}
Interest: {interest}
Event Type: {eventType}`,ja:`ニックネーム：{nickname}
性別：{gender}
年齢：{age}
国/地域：{country}
興味：{interest}
イベントタイプ：{eventType}`,ko:`닉네임: {nickname}
성별: {gender}
나이: {age}
국가/지역: {country}
관심사: {interest}
이벤트 유형: {eventType}`,th:`ชื่อเล่น: {nickname}
เพศ: {gender}
อายุ: {age}
ประเทศ/ภูมิภาค: {country}
ความสนใจ: {interest}
ประเภทเหตุการณ์: {eventType}`,vi:`Biệt danh: {nickname}
Giới tính: {gender}
Tuổi: {age}
Quốc gia/Khu vực: {country}
Sở thích: {interest}
Loại sự kiện: {eventType}`,ms:`Nama panggilan: {nickname}
Jantina: {gender}
Umur: {age}
Negara/Wilayah: {country}
Minat: {interest}
Jenis Acara: {eventType}`,la:`Cognomen: {nickname}
Sexus: {gender}
Aetas: {age}
Patria/Regio: {country}
Studium: {interest}
Genus Eventus: {eventType}`}},cy=["bg-gradient-to-br from-[#7f8fff] to-[#b6b6f6]","bg-gradient-to-br from-[#ffb6b6] to-[#ffd6e0]","bg-gradient-to-br from-[#6be6ff] to-[#b6f6ff]","bg-gradient-to-br from-[#ffe66b] to-[#ffb86b]"];function uk(n){if(!n||typeof n!="string")return cy[0];let e=0;for(let t=0;t<n.length;t++)e+=n.charCodeAt(t);return cy[e%cy.length]}const Ot={"zh-TW":{work_restart:"工作重啟",family_trust:"家庭信任",social_treatment:"社會對待",inner_choice:"內心選擇",misunderstood_and_recovered:"誤解與復原",restart_path:"重啟之路"},"zh-CN":{work_restart:"工作重启",family_trust:"家庭信任",social_treatment:"社会对待",inner_choice:"内心选择",misunderstood_and_recovered:"误解与复原",restart_path:"重启之路"},en:{work_restart:"Work Restart",family_trust:"Family Trust",social_treatment:"Social Treatment",inner_choice:"Inner Choice",misunderstood_and_recovered:"Misunderstood & Recovered",restart_path:"Restart Path"},ja:{work_restart:"仕事の再出発",family_trust:"家族の信頼",social_treatment:"社会の扱い",inner_choice:"内なる選択",misunderstood_and_recovered:"誤解と回復",restart_path:"再出発の道"},ko:{work_restart:"일 재시작",family_trust:"가족의 신뢰",social_treatment:"사회적 대우",inner_choice:"내면의 선택",misunderstood_and_recovered:"오해와 회복",restart_path:"재시작의 길"},th:{work_restart:"เริ่มงานใหม่",family_trust:"ความไว้วางใจในครอบครัว",social_treatment:"การปฏิบัติของสังคม",inner_choice:"ทางเลือกภายในใจ",misunderstood_and_recovered:"ความเข้าใจผิดและการฟื้นฟู",restart_path:"เส้นทางเริ่มต้นใหม่"},vi:{work_restart:"Khởi động lại công việc",family_trust:"Niềm tin gia đình",social_treatment:"Cách đối xử của xã hội",inner_choice:"Lựa chọn nội tâm",misunderstood_and_recovered:"Hiểu lầm và phục hồi",restart_path:"Con đường làm lại"},ms:{work_restart:"Mula Kerja Semula",family_trust:"Kepercayaan Keluarga",social_treatment:"Layanan Sosial",inner_choice:"Pilihan Dalaman",misunderstood_and_recovered:"Salah Faham & Pemulihan",restart_path:"Jalan Permulaan Semula"},la:{work_restart:"Opus Renovatum",family_trust:"Fides Familiaris",social_treatment:"Tractatio Socialis",inner_choice:"Electio Interior",misunderstood_and_recovered:"Error et Recuperatio",restart_path:"Iter Renovationis"}},dk={"zh-TW":"✔ 我願意將這段見證封存於區塊鏈（開發中）","zh-CN":"✔ 我愿意将这段见证封存于区块链（开发中）",en:"✔ I agree to preserve this testimony on the blockchain (In Development)",ja:"✔ この証言をブロックチェーンに保存することに同意します（開発中）",ko:"✔ 이 증언을 블록체인에 보존하는 것에 동의합니다（개발 중）",th:"✔ ฉันยินยอมให้บันทึกเรื่องราวนี้บนบล็อกเชน（กำลังพัฒนา）",vi:"✔ Tôi đồng ý lưu giữ câu chuyện này trên blockchain (Đang phát triển)",ms:"✔ Saya bersetuju untuk menyimpan kisah ini di blockchain (Dalam Pembangunan)",la:"✔ Assentior hanc testificationem in blockchain servari (In Progressu)"},uy={"zh-TW":{private:"只有我",friends:"好友可見",public:"所有人",label:"誰可以看到這段故事？"},"zh-CN":{private:"只有我",friends:"好友可见",public:"所有人",label:"谁可以看到这段故事？"},en:{private:"Only me",friends:"Friends only",public:"Everyone",label:"Who can see this story?"},ja:{private:"自分だけ",friends:"友達のみ",public:"全員",label:"誰がこのストーリーを見られますか？"},ko:{private:"나만 보기",friends:"친구만 보기",public:"모두 보기",label:"이 이야기를 누가 볼 수 있나요?"},th:{private:"เฉพาะฉัน",friends:"เพื่อนเท่านั้น",public:"ทุกคน",label:"ใครสามารถเห็นเรื่องราวนี้ได้บ้าง?"},vi:{private:"Chỉ mình tôi",friends:"Chỉ bạn bè",public:"Mọi người",label:"Ai có thể xem câu chuyện này?"},ms:{private:"Hanya saya",friends:"Hanya rakan",public:"Semua orang",label:"Siapa boleh melihat cerita ini?"},la:{private:"Solus ego",friends:"Amici tantum",public:"Omnes",label:"Quis hanc historiam videre potest?"}},k3={"zh-TW":{launch:"寫下來，也是⼀種勇敢。",ask:"如果只能留下一個故事，你會從哪裡說起？",thanks:"🎉 感謝你分享，這是你的故事",success:"你寫得很好，這段經歷值得被看見。",randomEncourage:["你的過去不定義你，選擇講述它，才是你的力量。","每個故事都值得被聽見。","你願意分享真心，我們願意陪你走一段。","你的經歷很珍貴，謝謝你願意說出來。"],chain:"我要將這段故事封存於區塊鏈",anonymous:"我要匿名分享",countryName:{中國大陸:"中國大陸",台灣:"台灣",日本:"日本",韓國:"韓國",美國:"美國",其他:"其他"},eventTypeName:{家暴加害:"家暴加害",家暴受害:"家暴受害",其他:"其他"}},"zh-CN":{launch:"写下来，也是一种勇敢。",ask:"这次你想聊的是什么？",thanks:"🎉 感谢你的分享，这是你的故事",success:"你写得很好，这段经历值得被看见。",randomEncourage:["你的过去不定义你，选择讲述它，才是你的力量。","每个故事都值得被听见。","你愿意分享真心，我们愿意陪你走一段。","你的经历很珍贵，谢谢你愿意说出来。"],chain:"我要将这段故事封存于区块链",anonymous:"我要匿名分享",countryName:{中國大陸:"中国大陆",台灣:"台湾",日本:"日本",韓國:"韩国",美國:"美国",其他:"其他"},eventTypeName:{家暴加害:"家暴加害",家暴受害:"家暴受害",其他:"其他"}},en:{launch:"Writing it down is also an act of courage.",ask:"What do you want to talk about this time?",thanks:"🎉 Thank you for sharing, this is your story",success:"You wrote beautifully. This experience deserves to be seen.",randomEncourage:["Your past does not define you. Choosing to tell it is your power.","Every story deserves to be heard.","You share your heart, we walk with you.","Your experience is precious, thank you for sharing."],chain:"I want to preserve this story on the blockchain",anonymous:"I want to share anonymously",countryName:{中國大陸:"China",台灣:"Taiwan",日本:"Japan",韓國:"Korea",美國:"USA",其他:"Other"},eventTypeName:{家暴加害:"Domestic Violence Perpetrator",家暴受害:"Domestic Violence Victim",其他:"Other"}},ja:{launch:"",ask:"",thanks:"",success:"",randomEncourage:[""],chain:"",anonymous:""},ko:{launch:"",ask:"",thanks:"",success:"",randomEncourage:[""],chain:"",anonymous:""},th:{launch:"",ask:"",thanks:"",success:"",randomEncourage:[""],chain:"",anonymous:""},vi:{launch:"",ask:"",thanks:"",success:"",randomEncourage:[""],chain:"",anonymous:""},ms:{launch:"",ask:"",thanks:"",success:"",randomEncourage:[""],chain:"",anonymous:""},la:{launch:"",ask:"",thanks:"",success:"",randomEncourage:[""],chain:"",anonymous:""}};async function dy(n,e,t){var o;const r={[e]:n};for(const a of t)if(a!==e)try{const d=await(await fetch("/api/translate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:n,from:e,to:a})})).json();r[a]=d.translated||""}catch{try{const d=await(await fetch(`https://translate.googleapis.com/translate_a/single?client=gtx&sl=${e}&tl=${a}&dt=t&q=${encodeURIComponent(n)}`)).json();r[a]=((o=d[0])==null?void 0:o.map(h=>h[0]).join(""))||""}catch{r[a]=""}}return r}function zl(n,e){return n.titleLangs&&n.titleLangs[e]||n.title}function Dl(n,e){return n.contentLangs&&n.contentLangs[e]||n.content}const Nl={"zh-TW":{中國大陸:"中國大陸",台灣:"台灣",日本:"日本",韓國:"韓國",美國:"美國",其他:"其他"},"zh-CN":{中國大陸:"中国大陆",台灣:"台湾",日本:"日本",韓國:"韩国",美國:"美国",其他:"其他"},en:{中國大陸:"China",台灣:"Taiwan",日本:"Japan",韓國:"Korea",美國:"USA",其他:"Other"},ja:{中國大陸:"中国大陸",台灣:"台湾",日本:"日本",韓國:"韓国",美國:"アメリカ",其他:"その他"},ko:{中國大陸:"중국",台灣:"대만",日本:"일본",韓國:"한국",美國:"미국",其他:"기타"},th:{中國大陸:"จีน",台灣:"ไต้หวัน",日本:"ญี่ปุ่น",韓國:"เกาหลี",美國:"สหรัฐอเมริกา",其他:"อื่นๆ"},vi:{中國大陸:"Trung Quốc",台灣:"Đài Loan",日本:"Nhật Bản",韓國:"Hàn Quốc",美國:"Mỹ",其他:"Khác"},ms:{中國大陸:"China",台灣:"Taiwan",日本:"Jepun",韓國:"Korea",美國:"Amerika",其他:"Lain-lain"},la:{中國大陸:"Sina",台灣:"Taiwan",日本:"Iaponia",韓國:"Corea",美國:"CFA",其他:"Aliud"}},Ml={"zh-TW":{家暴加害:"家暴加害",家暴受害:"家暴受害",其他:"其他"},"zh-CN":{家暴加害:"家暴加害",家暴受害:"家暴受害",其他:"其他"},en:{家暴加害:"Domestic Violence Perpetrator",家暴受害:"Domestic Violence Victim",其他:"Other"},ja:{家暴加害:"家庭内暴力加害者",家暴受害:"家庭内暴力被害者",其他:"その他"},ko:{家暴加害:"가정폭력 가해자",家暴受害:"가정폭력 피해자",其他:"기타"},th:{家暴加害:"ผู้กระทำความรุนแรงในครอบครัว",家暴受害:"เหยื่อความรุนแรงในครอบครัว",其他:"อื่นๆ"},vi:{家暴加害:"Người gây bạo lực gia đình",家暴受害:"Nạn nhân bạo lực gia đình",其他:"Khác"},ms:{家暴加害:"Pelaku Keganasan Rumah Tangga",家暴受害:"Mangsa Keganasan Rumah Tangga",其他:"Lain-lain"},la:{家暴加害:"Violentus Domesticus",家暴受害:"Victima Violentiae Domesticae",其他:"Aliud"}},T3=()=>{const n=Id(Po),e=St(),t=Et(),{t:r,i18n:o}=v3(),[a,c]=v.useState("zh-TW");v.useEffect(()=>{const ie=localStorage.getItem("lang");ie&&["zh-TW","zh-CN","en","ja","ko","th","vi","ms","la"].includes(ie)&&c(ie)},[]);const[d,h]=v.useState(null),[m,g]=v.useState([]),[x,S]=v.useState(""),[j,T]=v.useState(""),[R,I]=v.useState(""),[F,P]=v.useState(null),[z,H]=v.useState(!1),[J,O]=v.useState(""),[L,C]=v.useState(!1),[A,D]=v.useState("public"),[M,B]=v.useState({tags:{}}),[_,U]=v.useState(null),[oe,X]=v.useState(!1),[ce,le]=v.useState(!1),[te,xe]=v.useState(""),[$,Q]=v.useState(null),[G,ne]=v.useState(""),[se,me]=v.useState(!1),[Ie,Pe]=v.useState({}),[qe,Ge]=v.useState({}),[be,ae]=v.useState({}),[rt,Le]=v.useState(!1),[$e,fe]=v.useState([]);v.useEffect(()=>{const ie=Ns(e,q=>h(q));return()=>ie()},[e]),v.useEffect(()=>{(async()=>{const q=mr(En(n,"stories"),tf("createdAt","desc")),Me=await Vr(q);g(Me.docs.map(st=>({id:st.id,...st.data()})))})()},[n]),v.useEffect(()=>{fetch(`/locales/${a}/tags.json`).then(ie=>ie.json()).then(ie=>B(ie)).catch(()=>B({tags:{}}))},[a]),v.useEffect(()=>{let ie;if(ce){let q=0;ie=setInterval(()=>{q=(q+1)%6,xe(".".repeat(q))},400)}else xe("");return()=>clearInterval(ie)},[ce]),v.useEffect(()=>{async function ie(){const q=await vc(()=>Promise.resolve().then(()=>of),void 0).then(st=>st.getDocs(st.collection(n,"profiles"))),Me={};q.forEach(st=>{const et=st.data();et.nickname&&(Me[et.nickname]=et),et.name&&(Me[et.name]=et)}),Ge(Me)}ie()},[]),v.useEffect(()=>{async function ie(){const q=await vc(()=>Promise.resolve().then(()=>of),void 0).then(st=>st.getDocs(st.collection(n,"profiles"))),Me={};q.forEach(st=>{const et=st.data();et.email&&(Me[et.email]=et)}),ae(Me)}ie()},[]),v.useEffect(()=>{d&&(async()=>{const q=En(n,"links"),Me=mr(q,An("user1Id","==",d.uid),An("status","==","connected")),st=mr(q,An("user2Id","==",d.uid),An("status","==","connected")),[et,dt]=await Promise.all([Vr(Me),Vr(st)]),Ht=new Set;et.forEach(je=>Ht.add(je.data().user2Id)),dt.forEach(je=>Ht.add(je.data().user1Id)),fe(Array.from(Ht))})()},[d]);const _e=async()=>{if(!x.trim()||!j.trim())return;le(!0),X(!1);let ie=0;const q=setInterval(()=>{ie=(ie+1)%6,xe(".".repeat(ie))},400);try{H(!0);const[Me,st,et]=await Promise.all([fetch("/api/gpt/encourage",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({story:j})}).then(Dt=>Dt.json()).catch(()=>({encouragement:""})),dy(x,a,["zh-TW","zh-CN","en"]),dy(j,a,["zh-TW","zh-CN","en"])]),dt=Me.encouragement||"",Ht=dt?await dy(dt,a,["zh-TW","zh-CN","en"]):{},je=k3[K].randomEncourage,Qe=je[Math.floor(Math.random()*je.length)];ne(Qe),await xs(En(n,"stories"),{title:x,content:j,author:(d==null?void 0:d.displayName)||"匿名",authorEmail:(d==null?void 0:d.email)||"",createdAt:new Date,comments:[],likes:0,encouragement:dt,encouragementLangs:Ht,tag:J,visibility:A,onChain:L,titleLangs:st,contentLangs:et}),S(""),T(""),H(!1);const Tt=mr(En(n,"stories"),tf("createdAt","desc")),Bt=(await Vr(Tt)).docs.map(Dt=>({id:Dt.id,...Dt.data()}));g(Bt),U(Bt[0]||null)}catch(Me){console.error("Error adding story:",Me),S(""),T(""),H(!1)}finally{clearInterval(q),le(!1)}};function Ce(ie){return ie.encouragementLangs&&ie.encouragementLangs[K]?ie.encouragementLangs[K]:ie.encouragement||Ue.encouragementDefault[K]}["intro.sunday","intro.monday","intro.tuesday","intro.wednesday","intro.thursday","intro.friday","intro.saturday"][new Date().getDay()];const ze=async ie=>{await rf(Pn(n,"stories",ie)),g(m.filter(q=>q.id!==ie)),_&&_.id===ie&&U(null)},De=ie=>{D(ie),ie!=="public"&&C(!1)},K=a||"zh-TW";return i.jsx("div",{children:window.innerWidth<=768?i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{position:"absolute",top:0,left:0,right:0,zIndex:100,background:"rgba(255,255,255,0.95)",borderRadius:"0 0 16px 16px",padding:"18px 16px",boxShadow:"0 2px 12px #6B5BFF22",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[i.jsx("button",{onClick:()=>t("/"),style:{fontWeight:700,fontSize:18,padding:"6px 16px",borderRadius:8,border:"1.5px solid #6B5BFF",background:"#fff",color:"#6B5BFF",cursor:"pointer"},children:Ue.back[K]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[i.jsx("span",{style:{fontSize:"1.5rem",fontWeight:900,color:"#6B5BFF"},children:"📖"}),i.jsx("span",{style:{fontSize:"1.2rem",fontWeight:900,color:"#6B5BFF"},children:Ue.pageTitle[K]})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[i.jsx("button",{onClick:async()=>{await Er(e),localStorage.clear(),t("/")},style:{fontWeight:700,fontSize:16,padding:"6px 12px",borderRadius:8,border:"1.5px solid #6B5BFF",background:"#fff",color:"#6B5BFF",cursor:"pointer"},children:Ue.logout[K]}),i.jsx($n,{})]})]}),i.jsxs("div",{style:{marginTop:80,marginBottom:16,background:"rgba(255,255,255,0.95)",borderRadius:16,padding:"16px",boxShadow:"0 2px 12px #6B5BFF22",textAlign:"center"},children:[i.jsx("div",{style:{fontSize:14,color:"#000",fontWeight:600,marginBottom:8},children:Ue.storyQuoteLine1[K]}),i.jsx("div",{style:{fontSize:14,color:"#000",fontWeight:600,marginBottom:8},children:Ue.storyQuoteLine2[K]}),i.jsx("div",{style:{fontSize:12,color:"#888",fontWeight:500},children:Ue.storyQuoteLine3[K]})]}),i.jsxs("div",{style:{background:"rgba(255,255,255,0.95)",borderRadius:16,padding:"16px",marginBottom:16,boxShadow:"0 2px 12px #6B5BFF22"},children:[i.jsx("div",{style:{padding:"12px 20px",background:"linear-gradient(135deg, #6B5BFF 60%, #23c6e6 100%)",color:"#fff",border:"none",borderRadius:10,fontWeight:900,fontSize:17,letterSpacing:1,textAlign:"center",marginBottom:16},children:Ue.formTitle[K]}),i.jsx("div",{style:{fontSize:16,color:"#6B5BFF",fontWeight:600,marginBottom:16,textAlign:"center"},children:Ue.storyPrompt[K]}),i.jsx("input",{value:x,onChange:ie=>S(ie.target.value),placeholder:Ue.titlePlaceholder[K],style:{width:"100%",boxSizing:"border-box",padding:12,borderRadius:16,border:"1px solid #ddd",fontSize:16,marginBottom:8,color:"#232946"}}),i.jsx("textarea",{value:j,onChange:ie=>T(ie.target.value),rows:3,placeholder:Ue.contentPlaceholder[K],style:{width:"100%",height:120,boxSizing:"border-box",padding:12,borderRadius:16,border:"1px solid #ddd",fontSize:16,marginBottom:8,color:"#232946",resize:"none"}}),i.jsxs("div",{style:{display:"flex",gap:16,alignItems:"center",marginBottom:8,fontSize:15},children:[i.jsxs("label",{style:{display:"flex",alignItems:"center",gap:2},children:[i.jsx("input",{type:"radio",name:"visibility",value:"private",checked:A==="private",onChange:()=>De("private")})," ",Ue.visibilityPrivate[K]]}),i.jsxs("label",{style:{display:"flex",alignItems:"center",gap:2},children:[i.jsx("input",{type:"radio",name:"visibility",value:"friends",checked:A==="friends",onChange:()=>De("friends")})," ",Ue.visibilityFriends[K]]}),i.jsxs("label",{style:{display:"flex",alignItems:"center",gap:2},children:[i.jsx("input",{type:"radio",name:"visibility",value:"public",checked:A==="public",onChange:()=>De("public")})," ",Ue.visibilityPublic[K]]})]}),A==="public"&&i.jsxs("div",{style:{marginBottom:8},children:[i.jsxs("label",{style:{display:"flex",alignItems:"center",fontSize:15},children:[i.jsx("input",{type:"checkbox",checked:L,onChange:ie=>C(ie.target.checked),style:{marginRight:4}})," ",dk[K]]}),i.jsx("div",{style:{fontSize:12,color:"#888",marginTop:4,fontStyle:"italic"},children:Ue.blockchainNote[K]})]}),i.jsx("button",{onClick:_e,disabled:z,style:{padding:"12px 20px",background:"linear-gradient(135deg, #6B5BFF 60%, #23c6e6 100%)",color:"#fff",border:"none",borderRadius:10,fontWeight:900,fontSize:17,letterSpacing:1,cursor:z?"not-allowed":"pointer",opacity:z?.6:1},children:Ue.formSubmit[K]})]}),i.jsxs("div",{style:{background:"rgba(255,255,255,0.95)",borderRadius:16,padding:"16px",marginBottom:16,boxShadow:"0 2px 12px #6B5BFF22"},children:[i.jsxs("div",{style:{display:"flex",gap:4,marginBottom:16,flexWrap:"nowrap",justifyContent:"space-between"},children:[i.jsxs("button",{onClick:()=>{X(!0),Le(!1),me(!1),Q(null)},style:{padding:"6px 8px",borderRadius:18,border:"none",background:oe?"linear-gradient(90deg,#ffb86b 60%,#6B5BFF 100%)":"#eee",color:oe?"#fff":"#6B5BFF",fontWeight:700,fontSize:12,cursor:"pointer",flex:1,marginRight:4},children:["#💬",Ue.partnersStories[K]]}),i.jsxs("button",{onClick:()=>{Le(!0),X(!1),me(!1),Q(null)},style:{padding:"6px 8px",borderRadius:18,border:"none",background:rt?"linear-gradient(90deg,#23c6e6 60%,#6B5BFF 100%)":"#eee",color:rt?"#fff":"#6B5BFF",fontWeight:700,fontSize:12,cursor:"pointer",flex:1,marginRight:4},children:["#🤝",Ue.friendStories[K]]}),i.jsxs("button",{onClick:()=>{me(!0),X(!1),Le(!1),Q(null)},style:{padding:"6px 8px",borderRadius:18,border:"none",background:se?"linear-gradient(90deg,#6B5BFF 60%,#23c6e6 100%)":"#eee",color:se?"#fff":"#6B5BFF",fontWeight:700,fontSize:12,cursor:"pointer",flex:1},children:["#📝",Ue.myStories[K]]})]}),i.jsx("div",{style:{maxHeight:400,overflowY:"auto",width:"100%",paddingRight:6},children:rt?$e.length===0?i.jsxs("div",{style:{color:"#888",fontWeight:600,fontSize:16,padding:"32px 0",textAlign:"center"},children:[Ue.noFriends[K],i.jsx("span",{onClick:()=>t("/friend"),style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,cursor:"pointer"},children:Ue.goToPairTalk[K]})]}):m.filter(ie=>ie.visibility==="friends"&&$e.includes(ie.authorEmail)).map(ie=>{const q=be[ie.authorEmail]||{};return i.jsxs("div",{style:{background:"#fff",borderRadius:14,boxShadow:"0 2px 8px #b6b6f622",padding:14,marginBottom:14,cursor:"pointer"},children:[i.jsx("div",{style:{fontWeight:700,color:"#6B5BFF",fontSize:16,marginBottom:4},onClick:Me=>{Me.stopPropagation(),Q($===ie.id?null:ie.id)},children:zl(ie,K)}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:4,fontSize:"12px",flexWrap:"nowrap",whiteSpace:"nowrap"},children:[i.jsx("img",{src:q.avatar||q.avatarUrl||"/avatars/Derxl.png",alt:"avatar",style:{width:24,height:24,borderRadius:"50%",objectFit:"cover",border:"2px solid #ececff"}}),i.jsx("span",{style:{fontWeight:600},children:q&&q.nickname?q.nickname:"-"}),i.jsxs("span",{children:["，",q&&q.age?q.age:"-"]}),i.jsxs("span",{children:["，",q&&q.gender?q.gender:"-"]})]}),$===ie.id&&i.jsxs("div",{style:{marginTop:8},children:[i.jsx("div",{style:{color:"#232946",fontSize:14,marginBottom:4,whiteSpace:"pre-line"},children:Dl(ie,K)}),i.jsxs("div",{style:{background:"linear-gradient(90deg, #f7f8fc 60%, #e3e6f3 100%)",borderRadius:12,padding:"6px 10px",margin:"6px 0",display:"flex",alignItems:"center",gap:6,boxShadow:"0 2px 8px #b6b6f622",fontSize:12},children:[i.jsxs("span",{style:{color:"#7f8fff",fontWeight:700},children:["🤖 ",Ue.encouragement[K],"："]}),i.jsx("span",{style:{color:"#4b4b6b",fontWeight:500},children:Ce(ie)})]}),ie.tag&&i.jsx("div",{style:{fontSize:12,color:"#6B5BFF",fontWeight:700,marginBottom:4},children:Ot[K][ie.tag]}),ie.onChain&&i.jsx("span",{style:{fontSize:12,color:"#23c6e6",fontWeight:700,marginLeft:8},children:"🔗 已封存"}),i.jsx("div",{style:{marginTop:8,fontSize:12,color:"#6B5BFF",fontWeight:500,background:"#f7f8fc",borderRadius:8,padding:"6px 10px"},children:i.jsxs("div",{children:[`${Ue.profileLabels[K].split(`
`)[0].split("：")[0]}：${q&&q.nickname?q.nickname:"-"}，`,`${Ue.profileLabels[K].split(`
`)[1].split("：")[0]}：${q&&q.gender?q.gender:"-"}，`,`${Ue.profileLabels[K].split(`
`)[2].split("：")[0]}：${q&&q.age?q.age:"-"}，`,`${Ue.profileLabels[K].split(`
`)[3].split("：")[0]}：${q&&typeof q.country=="string"&&q.country?Nl[K][q.country]||q.country:"-"}，`,`${Ue.profileLabels[K].split(`
`)[4].split("：")[0]}：${q&&typeof q.interest=="string"&&q.interest?Ot&&Ot[K]&&Ot[K][q.interest]?Ot[K][q.interest]:q.interest:"-"}，`,`${Ue.profileLabels[K].split(`
`)[5].split("：")[0]}：${q&&typeof q.eventType=="string"&&q.eventType?Ml[K][q.eventType]||q.eventType:"-"}`]})})]})]},ie.id)}):se?m.filter(ie=>ie.author===(d==null?void 0:d.displayName)).map(ie=>{var Me;const q=be[ie.authorEmail]||{};return i.jsxs("div",{style:{background:"#fff",borderRadius:14,boxShadow:"0 2px 8px #b6b6f622",padding:14,marginBottom:14,position:"relative"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10},children:[i.jsx("div",{className:`w-6 h-6 rounded-full flex items-center justify-center text-white font-extrabold text-sm border-2 border-[#ececff] shadow ${uk(ie.author)}`,children:((Me=ie.author)==null?void 0:Me[0])||"A"}),i.jsx("div",{style:{fontWeight:700,color:"#6B5BFF",fontSize:14,cursor:"pointer"},onClick:st=>{st.stopPropagation(),Q($===ie.id?null:ie.id)},children:zl(ie,K)}),i.jsx("button",{onClick:()=>ze(ie.id),style:{marginLeft:"auto",background:"#ff6b6b",color:"#fff",border:"none",borderRadius:6,padding:"2px 8px",fontWeight:700,cursor:"pointer",fontSize:12},children:"刪除"})]}),$===ie.id&&i.jsxs("div",{style:{marginTop:8},children:[i.jsx("div",{style:{color:"#232946",fontSize:14,marginBottom:4},children:Dl(ie,K)}),i.jsxs("div",{style:{background:"linear-gradient(90deg, #f7f8fc 60%, #e3e6f3 100%)",borderRadius:12,padding:"6px 10px",margin:"6px 0",display:"flex",alignItems:"center",gap:6,boxShadow:"0 2px 8px #b6b6f622",fontSize:12},children:[i.jsxs("span",{style:{color:"#7f8fff",fontWeight:700},children:["🤖 ",Ue.encouragement[K],"："]}),i.jsx("span",{style:{color:"#4b4b6b",fontWeight:500},children:Ce(ie)})]}),ie.tag&&i.jsx("div",{style:{fontSize:12,color:"#6B5BFF",fontWeight:700,marginBottom:4},children:Ot[K][ie.tag]}),ie.onChain&&i.jsx("span",{style:{fontSize:12,color:"#23c6e6",fontWeight:700,marginLeft:8},children:"🔗 已封存"}),i.jsx("div",{style:{marginTop:8,fontSize:12,color:"#6B5BFF",fontWeight:500,background:"#f7f8fc",borderRadius:8,padding:"6px 10px"},children:i.jsxs("div",{children:[`${Ue.profileLabels[K].split(`
`)[0].split("：")[0]}：${q&&q.nickname?q.nickname:"-"}，`,`${Ue.profileLabels[K].split(`
`)[1].split("：")[0]}：${q&&q.gender?q.gender:"-"}，`,`${Ue.profileLabels[K].split(`
`)[2].split("：")[0]}：${q&&q.age?q.age:"-"}，`,`${Ue.profileLabels[K].split(`
`)[3].split("：")[0]}：${q&&typeof q.country=="string"&&q.country?Nl[K][q.country]||q.country:"-"}，`,`${Ue.profileLabels[K].split(`
`)[4].split("：")[0]}：${q&&typeof q.interest=="string"&&q.interest?Ot&&Ot[K]&&Ot[K][q.interest]?Ot[K][q.interest]:q.interest:"-"}，`,`${Ue.profileLabels[K].split(`
`)[5].split("：")[0]}：${q&&typeof q.eventType=="string"&&q.eventType?Ml[K][q.eventType]||q.eventType:"-"}`]})})]})]},ie.id)}):m.filter(ie=>ie.visibility==="public").map(ie=>{const q=be[ie.authorEmail]||{};return i.jsxs("div",{style:{background:"#fff",borderRadius:14,boxShadow:"0 2px 8px #b6b6f622",padding:14,marginBottom:14,cursor:"pointer"},children:[i.jsx("div",{style:{fontWeight:700,color:"#6B5BFF",fontSize:16,marginBottom:4},onClick:Me=>{Me.stopPropagation(),Q($===ie.id?null:ie.id)},children:zl(ie,K)}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:4,fontSize:"12px",flexWrap:"nowrap",whiteSpace:"nowrap"},children:[i.jsx("img",{src:q.avatar||q.avatarUrl||"/avatars/Derxl.png",alt:"avatar",style:{width:24,height:24,borderRadius:"50%",objectFit:"cover",border:"2px solid #ececff"}}),i.jsx("span",{style:{fontWeight:600},children:q&&q.nickname?q.nickname:"-"}),i.jsxs("span",{children:["，",q&&q.age?q.age:"-"]}),i.jsxs("span",{children:["，",q&&q.gender?q.gender:"-"]})]}),$===ie.id&&i.jsxs("div",{style:{marginTop:8},children:[i.jsx("div",{style:{color:"#232946",fontSize:14,marginBottom:4,whiteSpace:"pre-line"},children:Dl(ie,K)}),i.jsxs("div",{style:{background:"linear-gradient(90deg, #f7f8fc 60%, #e3e6f3 100%)",borderRadius:12,padding:"6px 10px",margin:"6px 0",display:"flex",alignItems:"center",gap:6,boxShadow:"0 2px 8px #b6b6f622",fontSize:12},children:[i.jsxs("span",{style:{color:"#7f8fff",fontWeight:700},children:["🤖 ",Ue.encouragement[K],"："]}),i.jsx("span",{style:{color:"#4b4b6b",fontWeight:500},children:Ce(ie)})]}),ie.tag&&i.jsx("div",{style:{fontSize:12,color:"#6B5BFF",fontWeight:700,marginBottom:4},children:Ot[K][ie.tag]}),ie.onChain&&i.jsx("span",{style:{fontSize:12,color:"#23c6e6",fontWeight:700,marginLeft:8},children:"🔗 已封存"}),i.jsx("div",{style:{marginTop:8,fontSize:12,color:"#6B5BFF",fontWeight:500,background:"#f7f8fc",borderRadius:8,padding:"6px 10px"},children:i.jsxs("div",{children:[`${Ue.profileLabels[K].split(`
`)[0].split("：")[0]}：${q&&q.nickname?q.nickname:"-"}，`,`${Ue.profileLabels[K].split(`
`)[1].split("：")[0]}：${q&&q.gender?q.gender:"-"}，`,`${Ue.profileLabels[K].split(`
`)[2].split("：")[0]}：${q&&q.age?q.age:"-"}，`,`${Ue.profileLabels[K].split(`
`)[3].split("：")[0]}：${q&&typeof q.country=="string"&&q.country?Nl[K][q.country]||q.country:"-"}，`,`${Ue.profileLabels[K].split(`
`)[4].split("：")[0]}：${q&&typeof q.interest=="string"&&q.interest?Ot&&Ot[K]&&Ot[K][q.interest]?Ot[K][q.interest]:q.interest:"-"}，`,`${Ue.profileLabels[K].split(`
`)[5].split("：")[0]}：${q&&typeof q.eventType=="string"&&q.eventType?Ml[K][q.eventType]||q.eventType:"-"}`]})})]})]},ie.id)})})]}),i.jsx("div",{style:{width:"100%",margin:"0 auto",marginTop:24,background:"rgba(255,255,255,0.95)",borderRadius:16,padding:"16px",boxShadow:"0 2px 12px #6B5BFF22"},children:i.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:20,flexWrap:"wrap"},children:[i.jsx("a",{href:"/about",style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12},children:"🧬 Restarter™｜我們是誰"}),i.jsx("a",{href:"/privacy-policy",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12},children:"隱私權政策"}),i.jsx("a",{href:"/terms",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12},children:"條款/聲明"}),i.jsx("a",{href:"/data-deletion",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12},children:"資料刪除說明"}),i.jsx("a",{href:"/feedback",style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12},children:"💬 意見箱｜我們想聽你說"})]})})]}):i.jsxs(i.Fragment,{children:[i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundImage:"url(/skytree.png)",backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat",zIndex:-1}}),i.jsxs("div",{style:{position:"absolute",top:0,left:0,right:0,zIndex:100,display:"flex",justifyContent:"space-between",alignItems:"center",padding:"18px 32px"},children:[i.jsx("button",{onClick:()=>t("/"),style:{fontWeight:700,fontSize:18,padding:"6px 16px",borderRadius:8,border:"1.5px solid #6B5BFF",background:"#fff",color:"#6B5BFF",cursor:"pointer"},children:Ue.back[K]}),i.jsx("div",{style:{display:"flex",alignItems:"center",gap:16},children:i.jsxs("span",{style:{fontSize:"2rem",fontWeight:900,color:"#6B5BFF"},children:["📖 ",Ue.pageTitle[K]]})}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[i.jsx("button",{onClick:async()=>{await Er(e),localStorage.clear(),t("/")},style:{fontWeight:700,fontSize:18,padding:"6px 16px",borderRadius:8,border:"1.5px solid #6B5BFF",background:"#fff",color:"#6B5BFF",cursor:"pointer"},children:Ue.logout[K]}),i.jsx($n,{})]})]}),i.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"100vh",padding:"80px 20px 20px 20px"},children:i.jsxs("div",{className:"modern-container",style:{width:"90%",maxWidth:1e3,display:"flex",flexDirection:"column",gap:32,background:"rgba(255, 255, 255, 0.9)",backdropFilter:"blur(10px)",borderRadius:20,padding:32,boxShadow:"0 8px 32px 0 rgba(31, 38, 135, 0.37)"},children:[i.jsxs("div",{style:{textAlign:"center",marginBottom:24},children:[i.jsx("p",{style:{fontSize:"1rem",color:"#000",fontWeight:600,margin:"0 0 8px 0",lineHeight:1.5},children:Ue.storyQuoteLine1[K]}),i.jsx("p",{style:{fontSize:"1rem",color:"#000",fontWeight:600,margin:"0 0 8px 0",lineHeight:1.5},children:Ue.storyQuoteLine2[K]}),i.jsx("p",{style:{fontSize:"0.9rem",color:"#888",fontWeight:500,margin:0,lineHeight:1.4},children:Ue.storyQuoteLine3[K]})]}),i.jsxs("div",{style:{display:"flex",gap:32},children:[i.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",gap:24},children:[i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:16,marginBottom:16},children:[i.jsx("div",{style:{display:"flex",alignItems:"center",gap:16},children:i.jsx("div",{style:{padding:"12px 20px",background:"linear-gradient(135deg, #6B5BFF 60%, #23c6e6 100%)",color:"#fff",border:"none",borderRadius:10,fontWeight:900,fontSize:17,letterSpacing:1,textAlign:"center"},children:Ue.formTitle[K]})}),i.jsx("div",{style:{fontSize:16,color:"#6B5BFF",fontWeight:600,textAlign:"center"},children:Ue.storyPrompt[K]})]}),i.jsx("input",{value:x,onChange:ie=>S(ie.target.value),placeholder:Ue.titlePlaceholder[K],style:{width:"100%",boxSizing:"border-box",padding:12,borderRadius:16,border:"1px solid #ddd",fontSize:16,marginBottom:8,color:"#232946"}}),i.jsx("textarea",{value:j,onChange:ie=>T(ie.target.value),rows:3,placeholder:Ue.contentPlaceholder[K],style:{width:"100%",height:120,boxSizing:"border-box",padding:12,borderRadius:16,border:"1px solid #ddd",fontSize:16,marginBottom:8,color:"#232946",resize:"none"}}),i.jsxs("div",{style:{display:"flex",gap:16,alignItems:"center",marginBottom:8,fontSize:15},children:[i.jsxs("label",{style:{display:"flex",alignItems:"center",gap:2},children:[i.jsx("input",{type:"radio",name:"visibility",value:"private",checked:A==="private",onChange:()=>De("private")})," ",Ue.visibilityPrivate[K]]}),i.jsxs("label",{style:{display:"flex",alignItems:"center",gap:2},children:[i.jsx("input",{type:"radio",name:"visibility",value:"friends",checked:A==="friends",onChange:()=>De("friends")})," ",Ue.visibilityFriends[K]]}),i.jsxs("label",{style:{display:"flex",alignItems:"center",gap:2},children:[i.jsx("input",{type:"radio",name:"visibility",value:"public",checked:A==="public",onChange:()=>De("public")})," ",Ue.visibilityPublic[K]]})]}),A==="public"&&i.jsxs("div",{style:{marginBottom:8},children:[i.jsxs("label",{style:{display:"flex",alignItems:"center",fontSize:15},children:[i.jsx("input",{type:"checkbox",checked:L,onChange:ie=>C(ie.target.checked),style:{marginRight:4}})," ",dk[K]]}),i.jsx("div",{style:{fontSize:12,color:"#888",marginTop:4,fontStyle:"italic"},children:Ue.blockchainNote[K]})]}),i.jsx("button",{onClick:_e,disabled:z,style:{padding:"12px 20px",background:"linear-gradient(135deg, #6B5BFF 60%, #23c6e6 100%)",color:"#fff",border:"none",borderRadius:10,fontWeight:900,fontSize:17,letterSpacing:1,cursor:z?"not-allowed":"pointer",opacity:z?.6:1},children:Ue.formSubmit[K]})]}),i.jsxs("div",{style:{flex:2,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[i.jsxs("div",{style:{display:"flex",gap:10,marginBottom:18},children:[i.jsxs("button",{onClick:()=>{X(!0),Le(!1),me(!1),Q(null)},style:{padding:"8px 18px",borderRadius:18,border:"none",background:oe?"linear-gradient(90deg,#ffb86b 60%,#6B5BFF 100%)":"#eee",color:oe?"#fff":"#6B5BFF",fontWeight:700,fontSize:16,cursor:"pointer"},children:["#💬",Ue.partnersStories[K]]}),i.jsxs("button",{onClick:()=>{Le(!0),X(!1),me(!1),Q(null)},style:{padding:"8px 18px",borderRadius:18,border:"none",background:rt?"linear-gradient(90deg,#23c6e6 60%,#6B5BFF 100%)":"#eee",color:rt?"#fff":"#6B5BFF",fontWeight:700,fontSize:16,cursor:"pointer"},children:["#🤝",Ue.friendStories[K]]}),i.jsxs("button",{onClick:()=>{me(!0),X(!1),Le(!1),Q(null)},style:{padding:"8px 18px",borderRadius:18,border:"none",background:se?"linear-gradient(90deg,#6B5BFF 60%,#23c6e6 100%)":"#eee",color:se?"#fff":"#6B5BFF",fontWeight:700,fontSize:16,cursor:"pointer"},children:["#📝",Ue.myStories[K]]})]}),ce?i.jsxs("div",{style:{padding:"48px 0",textAlign:"center",color:"#6B5BFF",fontWeight:700,fontSize:22},children:["🤖 AI正在幫你包裝故事，請稍候",te,i.jsx("div",{style:{fontSize:15,color:"#888",marginTop:12},children:"（有時AI會偷偷加點幽默，請耐心等候...）"})]}):rt?i.jsxs("div",{style:{width:"100%",background:"#fff",borderRadius:18,boxShadow:"0 2px 12px #6B5BFF22",padding:"18px 12px",marginBottom:18},children:[i.jsxs("div",{style:{fontWeight:700,fontSize:18,marginBottom:10,background:"linear-gradient(90deg,#23c6e6 60%,#6B5BFF 100%)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text"},children:["#🤝",Ue.friendStories[K]]}),i.jsx("button",{onClick:()=>{Le(!1),X(!0),me(!1),Q(null)},style:{margin:"0 0 18px 0",padding:"8px 18px",borderRadius:18,border:"none",background:"#eee",color:"#6B5BFF",fontWeight:700,fontSize:16,cursor:"pointer"},children:"返回夥伴們的故事"}),i.jsx("div",{style:{maxHeight:420,overflowY:"auto",width:"100%",paddingRight:6},children:$e.length===0?i.jsxs("div",{style:{color:"#888",fontWeight:600,fontSize:16,padding:"32px 0",textAlign:"center"},children:[Ue.noFriends[K],i.jsx("span",{onClick:()=>t("/friend"),style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,cursor:"pointer"},children:Ue.goToPairTalk[K]})]}):m.filter(ie=>ie.visibility==="friends"&&$e.includes(ie.authorEmail)).map(ie=>{const q=be[ie.authorEmail]||{};return i.jsxs("div",{style:{background:"#fff",borderRadius:14,boxShadow:"0 2px 8px #b6b6f622",padding:14,marginBottom:14,cursor:"pointer"},children:[i.jsx("div",{style:{fontWeight:700,color:"#6B5BFF",fontSize:18,cursor:"pointer",marginBottom:4},onClick:Me=>{Me.stopPropagation(),Q($===ie.id?null:ie.id)},children:zl(ie,K)}),i.jsx(ck,{profile:q,variant:"compact"}),$===ie.id&&i.jsxs("div",{style:{marginTop:10},children:[i.jsx("div",{style:{color:"#232946",fontSize:15,marginBottom:4,whiteSpace:"pre-line"},children:Dl(ie,K)}),i.jsxs("div",{style:{background:"linear-gradient(90deg, #f7f8fc 60%, #e3e6f3 100%)",borderRadius:12,padding:"8px 12px",margin:"8px 0",display:"flex",alignItems:"center",gap:8,boxShadow:"0 2px 8px #b6b6f622",fontSize:14},children:[i.jsxs("span",{style:{color:"#7f8fff",fontWeight:700},children:["🤖 ",Ue.encouragement[K],"："]}),i.jsx("span",{style:{color:"#4b4b6b",fontWeight:500},children:Ce(ie)})]}),ie.tag&&i.jsx("div",{style:{fontSize:14,color:"#6B5BFF",fontWeight:700,marginBottom:4},children:Ot[K][ie.tag]}),ie.onChain&&i.jsx("span",{style:{fontSize:14,color:"#23c6e6",fontWeight:700,marginLeft:8},children:"🔗 已封存"}),ie.visibility&&["private","friends","public"].includes(ie.visibility)&&i.jsx("span",{style:{fontSize:13,color:"#888",marginLeft:8},children:uy[K][ie.visibility]}),i.jsx(ck,{profile:q,variant:"detailed"})]})]},ie.id)})})]}):se?i.jsxs("div",{style:{width:"100%",background:"#fff",borderRadius:18,boxShadow:"0 2px 12px #6B5BFF22",padding:"18px 12px",marginBottom:18},children:[i.jsxs("div",{style:{fontWeight:700,fontSize:18,marginBottom:10,background:"linear-gradient(90deg,#6B5BFF 0%,#23c6e6 100%)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text"},children:["#📝",Ue.myStories[K]]}),i.jsx("button",{onClick:()=>{me(!1),X(!0),Le(!1),Q(null)},style:{margin:"0 0 18px 0",padding:"8px 18px",borderRadius:18,border:"none",background:"#eee",color:"#6B5BFF",fontWeight:700,fontSize:16,cursor:"pointer"},children:"返回夥伴們的故事"}),i.jsx("div",{style:{maxHeight:420,overflowY:"auto",width:"100%",paddingRight:6},children:m.filter(ie=>ie.author===(d==null?void 0:d.displayName)).map(ie=>{var Me;const q=be[ie.authorEmail]||{};return i.jsxs("div",{style:{background:"#fff",borderRadius:14,boxShadow:"0 2px 8px #b6b6f622",padding:14,marginBottom:14,position:"relative"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10},children:[i.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-white font-extrabold text-lg border-2 border-[#ececff] shadow ${uk(ie.author)}`,children:((Me=ie.author)==null?void 0:Me[0])||"A"}),i.jsx("div",{style:{fontWeight:700,color:"#6B5BFF",fontSize:16,cursor:"pointer"},onClick:st=>{st.stopPropagation(),Q($===ie.id?null:ie.id)},children:zl(ie,K)}),i.jsx("button",{onClick:()=>ze(ie.id),style:{marginLeft:"auto",background:"#ff6b6b",color:"#fff",border:"none",borderRadius:8,padding:"4px 12px",fontWeight:700,cursor:"pointer"},children:"刪除"})]}),$===ie.id&&i.jsxs("div",{style:{marginTop:10},children:[i.jsx("div",{style:{color:"#232946",fontSize:15,marginBottom:4},children:Dl(ie,K)}),i.jsxs("div",{style:{background:"linear-gradient(90deg, #f7f8fc 60%, #e3e6f3 100%)",borderRadius:12,padding:"8px 12px",margin:"8px 0",display:"flex",alignItems:"center",gap:8,boxShadow:"0 2px 8px #b6b6f622",fontSize:14},children:[i.jsxs("span",{style:{color:"#7f8fff",fontWeight:700},children:["🤖 ",Ue.encouragement[K],"："]}),i.jsx("span",{style:{color:"#4b4b6b",fontWeight:500},children:Ce(ie)})]}),ie.tag&&i.jsx("div",{style:{fontSize:14,color:"#6B5BFF",fontWeight:700,marginBottom:4},children:Ot[K][ie.tag]}),ie.onChain&&i.jsx("span",{style:{fontSize:14,color:"#23c6e6",fontWeight:700,marginLeft:8},children:"🔗 已封存"}),ie.visibility&&["private","friends","public"].includes(ie.visibility)&&i.jsx("span",{style:{fontSize:13,color:"#888",marginLeft:8},children:uy[K][ie.visibility]}),i.jsx("div",{style:{marginTop:10,fontSize:14,color:"#6B5BFF",fontWeight:500,background:"#f7f8fc",borderRadius:8,padding:"8px 12px"},children:i.jsxs("div",{children:[`${Ue.profileLabels[K].split(`
`)[0].split("：")[0]}：${q&&q.nickname?q.nickname:"-"}，`,`${Ue.profileLabels[K].split(`
`)[1].split("：")[0]}：${q&&q.gender?q.gender:"-"}，`,`${Ue.profileLabels[K].split(`
`)[2].split("：")[0]}：${q&&q.age?q.age:"-"}，`,`${Ue.profileLabels[K].split(`
`)[3].split("：")[0]}：${q&&typeof q.country=="string"&&q.country?Nl[K][q.country]||q.country:"-"}，`,`${Ue.profileLabels[K].split(`
`)[4].split("：")[0]}：${q&&typeof q.interest=="string"&&q.interest?Ot&&Ot[K]&&Ot[K][q.interest]?Ot[K][q.interest]:q.interest:"-"}，`,`${Ue.profileLabels[K].split(`
`)[5].split("：")[0]}：${q&&typeof q.eventType=="string"&&q.eventType?Ml[K][q.eventType]||q.eventType:"-"}`]})})]})]},ie.id)})})]}):i.jsxs("div",{style:{width:"100%",background:"#fff",borderRadius:18,boxShadow:"0 2px 12px #6B5BFF22",padding:"18px 12px",marginBottom:18},children:[i.jsxs("div",{style:{fontWeight:700,fontSize:18,marginBottom:10,background:"linear-gradient(90deg,#ffb86b 60%,#6B5BFF 100%)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text"},children:["#💬",Ue.partnersStories[K]]}),i.jsx("button",{onClick:()=>{me(!0),X(!1),Le(!1),Q(null)},style:{margin:"0 0 18px 0",padding:"8px 18px",borderRadius:18,border:"none",background:"#eee",color:"#6B5BFF",fontWeight:700,fontSize:16,cursor:"pointer"},children:"返回我的故事"}),i.jsx("div",{style:{maxHeight:420,overflowY:"auto",width:"100%",paddingRight:6},children:m.filter(ie=>ie.visibility==="public").map(ie=>{const q=be[ie.authorEmail]||{};return i.jsxs("div",{style:{background:"#fff",borderRadius:14,boxShadow:"0 2px 8px #b6b6f622",padding:14,marginBottom:14,cursor:"pointer"},children:[i.jsx("div",{style:{fontWeight:700,color:"#6B5BFF",fontSize:18,cursor:"pointer",marginBottom:4},onClick:Me=>{Me.stopPropagation(),Q($===ie.id?null:ie.id)},children:zl(ie,K)}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,marginBottom:2,fontSize:"14px",flexWrap:"nowrap",whiteSpace:"nowrap"},children:[i.jsx("img",{src:q.avatar||q.avatarUrl||"/avatars/Derxl.png",alt:"avatar",style:{width:36,height:36,borderRadius:"50%",objectFit:"cover",border:"2px solid #ececff"}}),i.jsx("span",{style:{fontWeight:600},children:q&&q.nickname?q.nickname:"-"}),i.jsxs("span",{children:["，",q&&q.age?q.age:"-"]}),i.jsxs("span",{children:["，",q&&q.gender?q.gender:"-"]}),i.jsxs("span",{children:["，",q&&typeof q.country=="string"&&q.country?Nl[K][q.country]||q.country:"-"]}),i.jsxs("span",{children:["，",q&&typeof q.interest=="string"&&q.interest?Ot&&Ot[K]&&Ot[K][q.interest]?Ot[K][q.interest]:q.interest:"-"]}),i.jsxs("span",{children:["，",q&&typeof q.eventType=="string"&&q.eventType?Ml[K][q.eventType]||q.eventType:"-"]})]}),$===ie.id&&i.jsxs("div",{style:{marginTop:10},children:[i.jsx("div",{style:{color:"#232946",fontSize:15,marginBottom:4,whiteSpace:"pre-line"},children:Dl(ie,K)}),i.jsxs("div",{style:{background:"linear-gradient(90deg, #f7f8fc 60%, #e3e6f3 100%)",borderRadius:12,padding:"8px 12px",margin:"8px 0",display:"flex",alignItems:"center",gap:8,boxShadow:"0 2px 8px #b6b6f622",fontSize:14},children:[i.jsxs("span",{style:{color:"#7f8fff",fontWeight:700},children:["🤖 ",Ue.encouragement[K],"："]}),i.jsx("span",{style:{color:"#4b4b6b",fontWeight:500},children:Ce(ie)})]}),ie.tag&&i.jsx("div",{style:{fontSize:14,color:"#6B5BFF",fontWeight:700,marginBottom:4},children:Ot[K][ie.tag]}),ie.onChain&&i.jsx("span",{style:{fontSize:14,color:"#23c6e6",fontWeight:700,marginLeft:8},children:"🔗 已封存"}),ie.visibility&&["private","friends","public"].includes(ie.visibility)&&i.jsx("span",{style:{fontSize:13,color:"#888",marginLeft:8},children:uy[K][ie.visibility]}),i.jsx("div",{style:{marginTop:10,fontSize:14,color:"#6B5BFF",fontWeight:500,background:"#f7f8fc",borderRadius:8,padding:"8px 12px"},children:i.jsxs("div",{children:[`${Ue.profileLabels[K].split(`
`)[0].split("：")[0]}：${q&&q.nickname?q.nickname:"-"}，`,`${Ue.profileLabels[K].split(`
`)[1].split("：")[0]}：${q&&q.gender?q.gender:"-"}，`,`${Ue.profileLabels[K].split(`
`)[2].split("：")[0]}：${q&&q.age?q.age:"-"}，`,`${Ue.profileLabels[K].split(`
`)[3].split("：")[0]}：${q&&typeof q.country=="string"&&q.country?Nl[K][q.country]||q.country:"-"}，`,`${Ue.profileLabels[K].split(`
`)[4].split("：")[0]}：${q&&typeof q.interest=="string"&&q.interest?Ot&&Ot[K]&&Ot[K][q.interest]?Ot[K][q.interest]:q.interest:"-"}，`,`${Ue.profileLabels[K].split(`
`)[5].split("：")[0]}：${q&&typeof q.eventType=="string"&&q.eventType?Ml[K][q.eventType]||q.eventType:"-"}`]})})]})]},ie.id)})})]})]})]})]})}),i.jsx("div",{style:{width:"100%",margin:"0 auto",marginTop:24,background:"rgba(255,255,255,0.95)",borderRadius:16,padding:"16px",boxShadow:"0 2px 12px #6B5BFF22"},children:i.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:20,flexWrap:"wrap"},children:[i.jsx("a",{href:"/privacy-policy",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12},children:K==="zh-TW"?"隱私權政策":K==="zh-CN"?"隐私政策":K==="en"?"Privacy Policy":K==="ja"?"プライバシーポリシー":K==="ko"?"개인정보 처리방침":K==="th"?"นโยบายความเป็นส่วนตัว":K==="vi"?"Chính sách bảo mật":K==="ms"?"Dasar Privasi":"Consilium de Privata"}),i.jsx("a",{href:"/terms",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12},children:K==="zh-TW"?"條款/聲明":K==="zh-CN"?"条款/声明":K==="en"?"Terms/Statement":K==="ja"?"規約/声明":K==="ko"?"약관/성명":K==="th"?"ข้อกำหนด/แถลงการณ์":K==="vi"?"Điều khoản/Tuyên bố":K==="ms"?"Terma/Pernyataan":"Termini/Declaratio"}),i.jsx("a",{href:"/data-deletion",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12},children:K==="zh-TW"?"資料刪除說明":K==="zh-CN"?"数据删除说明":K==="en"?"Data Deletion":K==="ja"?"データ削除について":K==="ko"?"데이터 삭제 안내":K==="th"?"คำอธิบายการลบข้อมูล":K==="vi"?"Giải thích xóa dữ liệu":K==="ms"?"Penjelasan Penghapusan Data":"Explicatio Deletionis Datae"}),i.jsx("a",{href:"/about",style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12},children:K==="zh-TW"?"🧬 Restarter™｜我們是誰":K==="zh-CN"?"🧬 Restarter™｜我们是谁":K==="en"?"🧬 Restarter™｜Who We Are":K==="ja"?"🧬 Restarter™｜私たちについて":K==="ko"?"🧬 Restarter™｜우리는 누구인가":K==="th"?"🧬 Restarter™｜เราเป็นใคร":K==="vi"?"🧬 Restarter™｜Chúng tôi là ai":K==="ms"?"🧬 Restarter™｜Siapa Kami":"🧬 Restarter™｜Quis sumus"}),i.jsx("a",{href:"/feedback",style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12},children:K==="zh-TW"?"💬 意見箱｜我們想聽你說":K==="zh-CN"?"💬 意见箱｜我们想听你说":K==="en"?"💬 Feedback Box｜We Want to Hear From You":K==="ja"?"💬 ご意見箱｜私たちはあなたの声を聞きたい":K==="ko"?"💬 피드백｜우리는 당신의 말을 듣고 싶습니다":K==="th"?"💬 กล่องความคิดเห็น｜เราอยากได้ยินจากคุณ":K==="vi"?"💬 Hộp góp ý｜Chúng tôi muốn nghe từ bạn":K==="ms"?"💬 Kotak Maklum Balas｜Kami Ingin Mendengar Dari Anda":"💬 Arca Consilii｜Volumus Audire a Te"})]})})]})})},WI=[{id:1,name_zh:"書吏",name_en:"Scribe",icon:"📜",upgrade_cost:10},{id:2,name_zh:"縣丞",name_en:"County Clerk",icon:"🪪",upgrade_cost:10},{id:3,name_zh:"通判",name_en:"Overseer",icon:"🧾",upgrade_cost:10},{id:4,name_zh:"巡撫",name_en:"Inspector",icon:"🛡️",upgrade_cost:10},{id:5,name_zh:"尚書",name_en:"Minister",icon:"🏛️",upgrade_cost:10},{id:6,name_zh:"太保",name_en:"Imperial Counselor",icon:"📯",upgrade_cost:10},{id:7,name_zh:"宰相",name_en:"Chancellor",icon:"🏯",upgrade_cost:10},{id:8,name_zh:"皇帝",name_en:"Emperor",icon:"🏰🫅",upgrade_cost:0}];function VI(n){return WI.find(e=>e.id===n)}function _3(n){return WI.find(e=>e.id===n+1)}function j3(n,e){const t=VI(e);return!!t&&t.upgrade_cost>0&&n>=t.upgrade_cost}const I3=v.createContext(void 0);function C3({children:n}){const[e,t]=v.useState(parseInt(localStorage.getItem("badges")||"0",10)),[r,o]=v.useState(parseInt(localStorage.getItem("rankId")||"1",10)),[a,c]=v.useState(!1);function d(){let g=e+1,x=r,S=!1;return j3(g,r)&&(x=r+1,g=0,S=!0,c(!0),setTimeout(()=>c(!1),3e3)),t(g),o(x),localStorage.setItem("badges",String(g)),localStorage.setItem("rankId",String(x)),S}const h=VI(r),m=_3(r);return i.jsx(I3.Provider,{value:{badges:e,rankId:r,rank:h,nextRank:m,promotion:a,addBadge:d,setBadges:t,setRankId:o},children:n})}const R3=v.createContext(null);function E3({children:n}){const e=v.useRef(null);return v.useEffect(()=>{try{return console.log("嘗試連接 WebSocket..."),e.current=new WebSocket(LD()),e.current.onopen=()=>{console.log("WebSocket 連接成功")},e.current.onerror=t=>{console.error("WebSocket 連接錯誤:",t)},e.current.onclose=()=>{console.log("WebSocket 連接關閉")},()=>{var t;return(t=e.current)==null?void 0:t.close()}}catch(t){console.error("WebSocket 初始化錯誤:",t)}},[]),i.jsx(R3.Provider,{value:e.current,children:n})}const On={backToHome:{"zh-TW":"返回","zh-CN":"返回",ja:"戻る",en:"Back",ko:"뒤로",th:"กลับ",vi:"Quay lại",ms:"Kembali",la:"Redire"},logout:{"zh-TW":"登出","zh-CN":"登出",ja:"ログアウト",en:"Logout",ko:"로그아웃",th:"ออกจากระบบ",vi:"Đăng xuất",ms:"Log keluar",la:"Exire"},pageTitle:{"zh-TW":"心情解鎖盒","zh-CN":"心情解锁盒",ja:"気持ちアンロックボックス",en:"Mood Unlock Box",ko:"감정 언락 박스",th:"กล่องปลดล็อกอารมณ์",vi:"Hộp Mở Khóa Cảm Xúc",ms:"Kotak Buka Kunci Emosi",la:"Arca Unlock Affectus"},subtitle:{"zh-TW":"每天自我反思，抒發心情，追蹤情緒，照顧自己","zh-CN":"每天自我反思，抒發心情，追蹤情緒，照顧自己",ja:"毎日自分を見つめ、気持ちを表現し、感情を追いかけ、自分を大切に",en:"Daily self-reflection, express your feelings, track emotions, take care of yourself",ko:"매일 자기 성찰, 감정 표현, 감정 추적, 자신을 돌보기",th:"สะท้อนตนเองทุกวัน ระบายความรู้สึก ติดตามอารมณ์ ดูแลตัวเอง",vi:"Tự phản ánh mỗi ngày, bày tỏ cảm xúc, theo dõi cảm xúc, chăm sóc bản thân",ms:"Refleksi diri setiap hari, luahkan perasaan, jejak emosi, jaga diri",la:"Cotidie te ipsum considera, affectus exprime, motus tuos persequere, te ipsum cura"},inputPlaceholder:{"zh-TW":"請寫下你的心情...(30字內)","zh-CN":"请写下你的心情...(30字内)",en:"Write your mood... (max 30 chars)",ja:"あなたの気持ちを書いてください...(30文字以内)",ko:"당신의 기분을 적어주세요...(30자 이내)",th:"เขียนความรู้สึกของคุณ...(ไม่เกิน 30 ตัวอักษร)",vi:"Hãy viết tâm trạng của bạn...(tối đa 30 ký tự)",ms:"Tulis perasaan anda...(maksimum 30 aksara)",la:"Animum tuum scribe...(max 30 litterae)"},plantButton:{"zh-TW":"記錄此刻心情","zh-CN":"记录此刻心情",ja:"今の気持ちを記録する",en:"Record Today's Mood",ko:"오늘의 기분 기록",th:"บันทึกอารมณ์วันนี้",vi:"Ghi lại tâm trạng hôm nay",ms:"Catat Perasaan Hari Ini",la:"Inscribere hodiernum animum"},completeTitle:{"zh-TW":"🎉 恭喜你完成拼圖！🎉","zh-CN":"🎉 恭喜你完成拼图！🎉",en:"🎉 Puzzle Completed! 🎉",ja:"🎉 パズル完成！🎉",ko:"🎉 퍼즐 완성! 🎉",th:"🎉 ต่อจิ๊กซอว์สำเร็จ! 🎉",vi:"🎉 Hoàn thành ghép hình! 🎉",ms:"🎉 Teka-teki Selesai! 🎉",la:"🎉 Puzzle Perfectum! 🎉"},completeDesc:{"zh-TW":"你已經解鎖全部心情拼圖，準備好迎接下一個挑戰了嗎？","zh-CN":"你已经解锁全部心情拼图，准备好迎接下一个挑战了吗？",en:"You have unlocked all mood puzzle pieces. Ready for the next challenge?",ja:"すべての気持ちパズルを解放しました。次のチャレンジの準備はできましたか？",ko:"모든 감정 퍼즐을 해제했습니다. 다음 도전을 준비하세요!",th:"คุณได้ปลดล็อกจิ๊กซอว์อารมณ์ทั้งหมดแล้ว พร้อมสำหรับความท้าทายถัดไปหรือยัง?",vi:"Bạn đã mở khóa tất cả các mảnh ghép cảm xúc. Sẵn sàng cho thử thách tiếp theo chưa?",ms:"Anda telah membuka semua kepingan teka-teki emosi. Sedia untuk cabaran seterusnya?",la:"Omnes partes animi puzzle aperuisti. Paratus es ad provocationem sequentem?"},nextChallenge:{"zh-TW":"前往{size}x{size}新挑戰","zh-CN":"前往{size}x{size}新挑战",en:"Next {size}x{size} Challenge",ja:"{size}x{size}新しいチャレンジへ",ko:"{size}x{size} 새 도전으로",th:"ไปยังความท้าทาย {size}x{size} ถัดไป",vi:"Thử thách {size}x{size} tiếp theo",ms:"Cabaran {size}x{size} Seterusnya",la:"Ad novam provocationem {size}x{size}"},encouragement:{"zh-TW":"有時候，記錄心情，就是給自己一份溫柔的陪伴。","zh-CN":"有时候，记录心情，就是给自己一份温柔的陪伴。",en:"Sometimes, recording your feelings is a gentle way to accompany yourself.",ja:"ときどき、気持ちを記録することは自分へのやさしい寄り添いです。",ko:"가끔은 마음을 기록하는 것이 자신에게 주는 따뜻한 동행입니다.",th:"บางครั้งการบันทึกความรู้สึก คือการมอบความอ่อนโยนให้ตัวเอง",vi:"Đôi khi, ghi lại cảm xúc là cách dịu dàng để đồng hành cùng chính mình.",ms:"Kadang-kadang, mencatat perasaan adalah teman yang lembut untuk diri sendiri.",la:"Aliquando, animum inscribere est tibi ipsum leniter comitari."},toastInput:{"zh-TW":"請先輸入你的心情！","zh-CN":"请先输入你的心情！",en:"Please enter your mood first!",ja:"まず気持ちを入力してください！",ko:"먼저 기분을 입력해주세요!",th:"กรุณากรอกความรู้สึกของคุณก่อน!",vi:"Vui lòng nhập tâm trạng của bạn trước!",ms:"Sila masukkan perasaan anda dahulu!",la:"Primum animum tuum inscribe!"},invalidMood:{"zh-TW":"請輸入有意義的心情內容（不能全是數字、符號或重複字元）","zh-CN":"请输入有意义的心情内容（不能全是数字、符号或重复字符）",en:"Please enter a meaningful mood (not just numbers, symbols, or repeated characters)",ja:"意味のある気持ちを入力してください（数字や記号、同じ文字だけは不可）",ko:"의미 있는 기분을 입력해주세요(숫자, 기호, 반복문자만은 불가)",th:"กรุณากรอกความรู้สึกที่มีความหมาย (ห้ามเป็นตัวเลข สัญลักษณ์ หรืออักษรซ้ำ)",vi:"Vui lòng nhập tâm trạng có ý nghĩa (không chỉ là số, ký hiệu hoặc ký tự lặp lại)",ms:"Sila masukkan perasaan yang bermakna (bukan hanya nombor, simbol atau aksara berulang)",la:"Sententiam significantem inscribe (non solum numeri, signa aut litterae repetitae)"},completeNext:{"zh-TW":"已完成本關，請點擊前往新挑戰","zh-CN":"已完成本关，请点击前往新挑战",en:"Puzzle completed! Please proceed to the next challenge.",ja:"このステージはクリアしました。次のチャレンジへ進んでください。",ko:"이 단계는 완료되었습니다. 다음 도전으로 이동하세요.",th:"คุณผ่านด่านนี้แล้ว กรุณาไปยังความท้าทายถัดไป",vi:"Bạn đã hoàn thành màn này, hãy chuyển sang thử thách tiếp theo.",ms:"Tahap ini telah selesai. Sila ke cabaran seterusnya.",la:"Hoc gradum perfecisti. Ad provocationem sequentem procede."},finalCompleteTitle:{"zh-TW":"🎉🎉 你已經完成所有心情拼圖！ 🎉🎉","zh-CN":"🎉🎉 你已经完成所有心情拼图！ 🎉🎉",en:"🎉🎉 You have completed all mood puzzles! 🎉🎉",ja:"🎉🎉 すべての気持ちパズルを完成しました！ 🎉🎉",ko:"🎉🎉 모든 감정 퍼즐을 완성했습니다! 🎉🎉",th:"🎉🎉 คุณได้ต่อจิ๊กซอว์อารมณ์ครบทุกชิ้นแล้ว! 🎉🎉",vi:"🎉🎉 Bạn đã hoàn thành tất cả các mảnh ghép cảm xúc! 🎉🎉",ms:"🎉🎉 Anda telah melengkapkan semua teka-teki emosi! 🎉🎉",la:"🎉🎉 Omnes partes animi puzzle perfecisti! 🎉🎉"},finalCompleteDesc:{"zh-TW":"你已經解鎖所有拼圖碎片，這是屬於你的堅持與成就！請繼續相信自己，未來每一天都值得被記錄與慶祝！","zh-CN":"你已经解锁所有拼图碎片，这是属于你的坚持与成就！请继续相信自己，未来每一天都值得被记录与庆祝！",en:"You have unlocked every puzzle piece. This is your perseverance and achievement! Keep believing in yourself—every day ahead is worth celebrating!",ja:"すべてのピースをアンロックしました。これはあなたの努力と成果です！これからも自分を信じて、毎日を大切にしてください！",ko:"모든 퍼즐 조각을 해제했습니다. 이것은 당신의 끈기와 성취입니다! 앞으로도 자신을 믿고, 매일을 소중히 하세요!",th:"คุณได้ปลดล็อกจิ๊กซอว์ทุกชิ้นแล้ว นี่คือความพยายามและความสำเร็จของคุณ! จงเชื่อมั่นในตัวเองและเฉลิมฉลองทุกวัน!",vi:"Bạn đã mở khóa mọi mảnh ghép. Đây là sự kiên trì và thành tựu của bạn! Hãy tiếp tục tin vào bản thân và ăn mừng mỗi ngày!",ms:"Anda telah membuka semua kepingan teka-teki. Ini adalah ketabahan dan pencapaian anda! Teruskan percaya pada diri sendiri dan raikan setiap hari!",la:"Omnia fragmenta aenigmatis aperuisti. Haec est constantia et perfectio tua! Crede tibi et diem quemque celebra!"}};function A3(){var ne;const n=Et(),e=St(),{lang:t,setLang:r}=Lt(),[o,a]=v.useState(""),[c,d]=v.useState(!1),[h,m]=v.useState([]),g=((ne=e.currentUser)==null?void 0:ne.uid)||"",[x,S]=v.useState(!1),[j,T]=v.useState(""),R=new Date().toISOString().slice(0,10);v.useEffect(()=>{g&&fetch(`/api/mood?userId=${g}`).then(se=>se.json()).then(se=>m(se))},[g]);const[I,F]=Un.useState(()=>{const se=localStorage.getItem("puzzleStage");return se?JSON.parse(se):{size:3,unlocked:0,completed:!1,lastDate:""}});Un.useEffect(()=>{localStorage.setItem("puzzleStage",JSON.stringify(I))},[I]);const P=I.size||3,z=P+1,J=`/puzzle${P-2}.png`,O=P,L=O*O;function C(se){return Array.from({length:L},(me,Ie)=>Ie<se)}function A(){const se={size:z,unlocked:0,completed:!1,lastDate:new Date().toISOString().slice(0,10)};F(se),m([]),X(null)}const D=async()=>{if(!g){T("請先登入才能解鎖拼圖"),S(!0),setTimeout(()=>S(!1),2e3);return}let se=!1;if(I.lastDate===R&&(se=!0),!se&&Array.isArray(h)){for(const Ie of h)if(Ie&&Array.isArray(Ie.petals)&&Ie.petals.some(Pe=>typeof Pe.date=="string"&&Pe.date.slice(0,10)===R)){se=!0;break}}if(!se){const Ie=`mood_${g}_${R}`;localStorage.getItem(Ie)&&(se=!0)}if(se){T("今天已經記錄過心情了，明天再來解鎖新的拼圖吧！✨"),S(!0),setTimeout(()=>S(!1),2e3);return}if(ce){T(On.completeNext[t]),S(!0),setTimeout(()=>S(!1),2e3);return}if(!o){T(On.toastInput[t]),S(!0),setTimeout(()=>S(!1),2e3);return}const me=o.replace(/\s/g,"");if(/^\d+$/.test(me)){T(On.invalidMood[t]),S(!0),setTimeout(()=>S(!1),2e3);return}if(/^[\p{P}\p{S}]+$/u.test(me)){T(On.invalidMood[t]),S(!0),setTimeout(()=>S(!1),2e3);return}if(me.length>=4&&/^(.)\1+$/.test(me)){T(On.invalidMood[t]),S(!0),setTimeout(()=>S(!1),2e3);return}if(me.length<4){T(On.invalidMood[t]),S(!0),setTimeout(()=>S(!1),2e3);return}d(!0);try{await fetch("/api/mood",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:g,mood:o,date:new Date().toISOString().slice(0,10)+"-"+Math.random()})}),a(""),fetch(`/api/mood?userId=${g}`).then(Ge=>Ge.json()).then(Ge=>m(Ge)),d(!1),F(Ge=>({...Ge,unlocked:Ge.unlocked+1,lastDate:new Date().toISOString().slice(0,10)}));const Ie=`mood_${g}_${R}`;localStorage.setItem(Ie,JSON.stringify({date:R,mood:o,timestamp:Date.now()}));const Pe=new Date,qe=Pe.getDay();X({date:Pe.toISOString().slice(0,10),mood:Q[qe],isTodayNewPiece:!0})}catch{d(!1),T("解鎖失敗，請稍後再試"),S(!0),setTimeout(()=>S(!1),2e3)}},M=I.unlocked,B=C(M),[_,U]=Un.useState(!1),[oe,X]=Un.useState(null),ce=M>=L;function le(){const se={size:3,unlocked:0,completed:!1,lastDate:""};localStorage.setItem("puzzleStage",JSON.stringify(se)),window.location.reload()}function te(){const se={...I,unlocked:0,lastDate:""};localStorage.setItem("puzzleStage",JSON.stringify(se)),window.location.reload()}const xe={};if(Array.isArray(h)&&(console.log("處理 garden 數據，項目數量:",h.length),h.forEach((se,me)=>{console.log(`garden[${me}]:`,se);let Ie=null;se&&Array.isArray(se.petals)?Ie=se.petals:se&&Array.isArray(se)?Ie=se:se&&typeof se=="object"&&se.mood&&se.date&&(Ie=[se]),Ie?(console.log("找到 petals 數據:",Ie),Ie.forEach((Pe,qe)=>{if(console.log(`petal[${qe}]:`,Pe),Pe&&typeof Pe.mood=="string"&&typeof Pe.date=="string"){const Ge=Pe.date.slice(0,10);xe[Ge]={mood:Pe.mood,date:Ge},console.log("成功解析心情數據:",{date:Ge,mood:Pe.mood})}else Pe&&typeof Pe=="object"&&console.log("petal 結構不符合預期:",Pe)})):console.log("未找到有效的 petals 數據結構")})),Object.keys(xe).length===0){console.log("嘗試從本地存儲獲取心情數據...");for(let se=0;se<localStorage.length;se++){const me=localStorage.key(se);if(me&&me.startsWith("mood_"))try{const Ie=JSON.parse(localStorage.getItem(me)||"{}");if(Ie.date&&Ie.mood){const Pe=Ie.date.slice(0,10);xe[Pe]={mood:Ie.mood,date:Pe}}}catch{console.log("解析本地存儲數據失敗:",me)}}}const $=Object.values(xe).sort((se,me)=>se.date.localeCompare(me.date));console.log("DEBUG garden:",h),console.log("DEBUG moodByDate:",xe),console.log("DEBUG allPetals:",$);const Q=["明天記得再來喔 🌈","每天一點點，心情拼圖就會完成！🧩","你的心情很重要，明天也來記錄吧！📝","給自己一個鼓勵，明天見！💪","一天一片，慢慢拼出美好心情！🌟","明天再來解鎖新拼圖吧！🔓","保持好心情，明天繼續加油！😊"],G={"zh-TW":"用心情解鎖拼圖","zh-CN":"用心情解锁拼图",en:"Unlock puzzles with your mood",ja:"気持ちでパズルを解こう",ko:"마음으로 퍼즐을 해제하세요",th:"ปลดล็อกจิ๊กซอว์ด้วยอารมณ์",vi:"Mở khóa ghép hình bằng cảm xúc",ms:"Buka teka-teki dengan perasaan",la:"Affectibus tuis aenigmata solve"};return i.jsxs("div",{style:{width:"100vw",position:"relative",overflowX:"hidden",background:"url('/snowmountain.png') center center / cover no-repeat fixed, linear-gradient(to bottom, #eaf6ff 0%, #f7fafc 100%)",minHeight:"0"},children:[x&&i.jsx("div",{style:{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",background:"rgba(255,255,255,0.98)",color:"#6B5BFF",fontWeight:700,fontSize:20,padding:"28px 48px",borderRadius:18,boxShadow:"0 4px 32px #6B5BFF33",zIndex:3e3,textAlign:"center",letterSpacing:1.5,transition:"opacity 0.3s"},children:j}),i.jsxs("div",{style:{width:"100%",maxWidth:700,margin:"20px auto 20px auto",padding:"16px 24px",background:"rgba(255,255,255,0.95)",borderRadius:16,boxShadow:"0 4px 20px rgba(0,0,0,0.1)",display:"flex",alignItems:"center",justifyContent:"space-between",position:"relative"},children:[i.jsx("button",{className:"topbar-btn",onClick:()=>n("/"),style:{fontWeight:700,fontSize:16,padding:"8px 16px",borderRadius:8,border:"1.5px solid #6B5BFF",background:"#fff",color:"#6B5BFF",cursor:"pointer",minWidth:80},children:On.backToHome[t]}),i.jsxs("h1",{style:{fontWeight:900,fontSize:18,color:"#6B5BFF",margin:0,lineHeight:1,textShadow:"0 2px 8px #6B5BFF88",textAlign:"center",flex:1},children:[i.jsx("span",{role:"img","aria-label":"mood",children:"🌱"})," ",On.pageTitle[t]]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[i.jsx("button",{className:"topbar-btn",onClick:async()=>{await Er(e),localStorage.clear(),window.location.href="/"},style:{fontWeight:700,fontSize:16,padding:"8px 16px",borderRadius:8,border:"1.5px solid #6B5BFF",background:"#fff",color:"#6B5BFF",cursor:"pointer",minWidth:80},children:On.logout[t]}),i.jsx($n,{style:{width:80,height:"auto",padding:"8px 16px",fontSize:16,fontWeight:700,borderRadius:8,border:"1.5px solid #6B5BFF",background:"#fff",color:"#6B5BFF",cursor:"pointer",minWidth:80}})]})]}),i.jsxs("div",{style:{maxWidth:700,margin:"0 auto 0 auto",padding:"1.2rem 2vw 0 2vw",background:"rgba(255,255,255,0.92)",borderRadius:24,boxShadow:"0 8px 32px rgba(0,0,0,0.08)",position:"relative"},children:[i.jsx("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center",gap:12,flexWrap:"nowrap",marginBottom:8},children:i.jsx("span",{style:{fontSize:15,color:"#888",fontWeight:700,letterSpacing:1,textShadow:"0 2px 12px #6B5BFF55",whiteSpace:"nowrap"},children:G[t]||G.en})}),i.jsx("div",{style:{color:"#888",fontSize:18,marginBottom:0,textAlign:"center",fontWeight:700,letterSpacing:1,textShadow:"0 2px 12px #6B5BFF55"},children:On.subtitle[t]}),i.jsxs("div",{style:{width:"100%",textAlign:"center",color:"#232323",fontSize:17,fontWeight:500,margin:"0 0 10px 0",letterSpacing:.5,lineHeight:1.5,textShadow:"0 2px 8px #bbb8"},children:[On.encouragement[t],i.jsx("span",{role:"img","aria-label":"rainbow",children:"🌈"})]}),i.jsxs("div",{style:{display:"flex",flexDirection:"row",alignItems:"flex-end",gap:12,width:"100%",justifyContent:"center",marginBottom:8},children:[i.jsx("textarea",{value:o,onChange:se=>a(se.target.value),placeholder:On.inputPlaceholder[t],maxLength:30,rows:3,style:{width:260,minWidth:180,maxWidth:320,padding:12,borderRadius:8,border:"1.5px solid #ddd",fontSize:16,resize:"vertical",marginRight:0}}),i.jsx("button",{onClick:D,disabled:c,style:{width:140,minWidth:100,padding:"14px 0",background:c?"#ccc":"linear-gradient(135deg, #6B5BFF 60%, #23c6e6 100%)",color:"#fff",border:"none",borderRadius:10,fontWeight:900,fontSize:16,letterSpacing:1,cursor:c?"not-allowed":"pointer",transition:"all 0.2s ease",marginLeft:0,marginBottom:0},children:c?"...":On.plantButton[t]})]}),i.jsx("div",{style:{borderTop:"1px solid #eee",margin:"16px 0"}}),i.jsx("div",{children:i.jsxs("div",{style:{minHeight:0,background:"#f0f8ff",borderRadius:12,display:"block",color:"#aaa",position:"relative",width:"100%",maxWidth:540,overflow:"hidden",margin:"0 auto",padding:"0 0 24px 0"},children:[i.jsx("div",{style:{display:"grid",gridTemplateColumns:`repeat(${O}, 1fr)`,gridTemplateRows:`repeat(${O}, 1fr)`,width:"100%",maxWidth:"100%",margin:"0 auto",aspectRatio:"1 / 1",position:"relative",zIndex:1,gap:0,background:"#fff",boxShadow:"0 2px 24px #6B5BFF22",boxSizing:"border-box"},children:B.map((se,me)=>{const Ie=$[me]||null,Pe=(Ie==null?void 0:Ie.mood)||"",qe=(Ie==null?void 0:Ie.date)||"",Ge=Math.floor(me/O),be=me%O,ae=se&&!!Ie;return i.jsxs("div",{style:{width:"100%",height:"100%",aspectRatio:"1/1",overflow:"hidden",position:"relative",border:"none",boxSizing:"border-box",cursor:ae?"pointer":"default",display:"flex",alignItems:"center",justifyContent:"center"},onClick:()=>{console.log("點擊拼圖:",{idx:me,canClick:ae,petal:Ie,date:qe,mood:Pe}),ae&&(console.log("設置 showInfo:",{date:qe,mood:Pe}),X({date:qe,mood:Pe}))},children:[i.jsx("img",{src:J,alt:"puzzle",style:{width:`calc(100% * ${O})`,height:`calc(100% * ${O})`,objectFit:"cover",position:"absolute",left:`-${be*100}%`,top:`-${Ge*100}%`,filter:se?"none":"blur(8px) grayscale(1) brightness(1.2)",opacity:se?1:.5,transition:"filter 0.3s, opacity 0.3s"}}),!se&&i.jsx("div",{style:{position:"absolute",inset:0,background:"rgba(255,255,255,0.7)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:32},children:"?"})]},me)})}),oe&&!ce&&i.jsx("div",{style:{position:"fixed",left:0,top:0,width:"100vw",height:"100vh",zIndex:2e3,display:"flex",alignItems:"center",justifyContent:"center"},onClick:()=>X(null),children:i.jsxs("div",{style:{background:"#fff",borderRadius:16,padding:"32px 40px",boxShadow:"0 4px 32px #0008",minWidth:260,maxWidth:320,textAlign:"center",fontSize:18,fontWeight:700},children:[i.jsx("div",{style:{fontSize:16,color:"#6B5BFF",marginBottom:8},children:oe.date}),i.jsx("div",{style:{fontSize:22,color:"#232946",marginBottom:8},children:oe.mood}),oe.isTodayNewPiece&&i.jsx("div",{style:{fontSize:15,color:"#888",marginTop:8},children:"(一天只能解鎖一片，明天再來！)"}),i.jsx("div",{style:{fontSize:14,color:"#888"},children:"（點擊空白處關閉）"})]})}),ce&&i.jsx(i.Fragment,{children:i.jsx("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",zIndex:2,pointerEvents:"auto",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",textAlign:"center",background:"rgba(255,255,255,0.0)"},children:I.size===22?i.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",width:"100%",maxWidth:"90vw",margin:"0 auto"},children:[i.jsx("div",{style:{fontSize:32,fontWeight:900,color:"#ff9800",textShadow:"0 2px 12px #fff,0 4px 24px #ff980088",letterSpacing:2,marginBottom:12,lineHeight:1.2,wordBreak:"break-word",maxWidth:"100%"},children:On.finalCompleteTitle[t]}),i.jsx("div",{style:{fontSize:18,fontWeight:600,color:"#6B5BFF",textShadow:"0 2px 12px #6B5BFF88",letterSpacing:1,lineHeight:1.5,wordBreak:"break-word",maxWidth:"100%",marginBottom:24},children:On.finalCompleteDesc[t]}),i.jsx("button",{onClick:le,style:{padding:"14px 40px",background:"linear-gradient(135deg,#6B5BFF 60%,#23c6e6 100%)",color:"#fff",border:"none",borderRadius:16,fontWeight:900,fontSize:22,boxShadow:"0 2px 12px #6B5BFF44",cursor:"pointer",letterSpacing:2,transition:"transform 0.2s",outline:"none",display:"block"},children:"再來一次"})]}):i.jsxs(i.Fragment,{children:[i.jsx("div",{style:{position:"relative",fontSize:24,fontWeight:900,color:"#ff9800",textShadow:"0 2px 12px #fff,0 4px 24px #ff980088",transform:"scale(0.7)",opacity:1,animation:"flyIn1 0.5s 0.1s cubic-bezier(.68,-0.55,.27,1.55) forwards"},children:On.completeTitle[t]}),i.jsx("div",{style:{position:"relative",fontSize:20,fontWeight:700,color:"#6B5BFF",marginTop:18,opacity:0,animation:"flyIn2 0.5s 0.6s cubic-bezier(.68,-0.55,.27,1.55) forwards"},children:On.completeDesc[t]}),i.jsx("div",{style:{position:"relative",marginTop:32,opacity:0,animation:"flyIn3 0.5s 1.1s cubic-bezier(.68,-0.55,.27,1.55) forwards"},children:i.jsx("button",{type:"button",onClick:A,style:{padding:"18px 48px",background:"linear-gradient(135deg,#6B5BFF 60%,#23c6e6 100%)",color:"#fff",borderRadius:16,fontWeight:900,fontSize:24,boxShadow:"0 2px 12px #6B5BFF44",border:"none",cursor:"pointer",letterSpacing:2,transition:"transform 0.2s",outline:"none",display:"block"},children:On.nextChallenge[t].replace(/\{size\}/g,String(z))})}),i.jsx("style",{children:`
@keyframes flyIn1 { from { opacity:0; transform:translateY(40px) scale(0.7);} to { opacity:1; transform:translateY(0) scale(1);} }
@keyframes flyIn2 { from { opacity:0; transform:translateY(40px) scale(0.7);} to { opacity:1; transform:translateY(0) scale(1);} }
@keyframes flyIn3 { from { opacity:0; transform:translateY(40px) scale(0.7);} to { opacity:1; transform:translateY(0) scale(1);} }
`})]})})})]})})]}),i.jsx("div",{style:{width:"100%",maxWidth:700,margin:"20px auto 0 auto",background:"rgba(255,255,255,0.95)",borderRadius:16,padding:"16px",boxShadow:"0 2px 12px #6B5BFF22"},children:i.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:12,flexWrap:"wrap"},children:[i.jsx("button",{onClick:te,style:{padding:"8px 16px",background:"linear-gradient(135deg,#ff6b6b 60%,#ff8e8e 100%)",color:"#fff",border:"none",borderRadius:8,fontWeight:700,fontSize:14,cursor:"pointer",letterSpacing:1},children:"清理當前拼圖"}),i.jsx("button",{onClick:le,style:{padding:"8px 16px",background:"linear-gradient(135deg,#4ecdc4 60%,#6bcfc4 100%)",color:"#fff",border:"none",borderRadius:8,fontWeight:700,fontSize:14,cursor:"pointer",letterSpacing:1},children:"重置到第一關"})]})}),i.jsx("div",{style:{width:"100%",margin:"0 auto",marginTop:24,background:"rgba(255,255,255,0.95)",borderRadius:16,padding:"16px",boxShadow:"0 2px 12px #6B5BFF22"},children:i.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:20,flexWrap:"wrap"},children:[i.jsx("a",{href:"/about",style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12},children:t==="zh-TW"?"🧬 Restarter™｜我們是誰":t==="zh-CN"?"🧬 Restarter™｜我们是谁":t==="en"?"🧬 Restarter™｜Who We Are":t==="ja"?"🧬 Restarter™｜私たちについて":t==="ko"?"🧬 Restarter™｜우리는 누구인가":t==="th"?"🧬 Restarter™｜เราเป็นใคร":t==="vi"?"🧬 Restarter™｜Chúng tôi là ai":t==="ms"?"🧬 Restarter™｜Siapa Kami":"🧬 Restarter™｜Quis sumus"}),i.jsx("a",{href:"/privacy-policy",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12},children:t==="zh-TW"?"隱私權政策":t==="zh-CN"?"隐私政策":t==="en"?"Privacy Policy":t==="ja"?"プライバシーポリシー":t==="ko"?"개인정보 처리방침":t==="th"?"นโยบายความเป็นส่วนตัว":t==="vi"?"Chính sách bảo mật":t==="ms"?"Dasar Privasi":"Consilium de Privata"}),i.jsx("a",{href:"/terms",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12},children:t==="zh-TW"?"條款/聲明":t==="zh-CN"?"条款/声明":t==="en"?"Terms/Statement":t==="ja"?"規約/声明":t==="ko"?"약관/성명":t==="th"?"ข้อกำหนด/แถลงการณ์":t==="vi"?"Điều khoản/Tuyên bố":t==="ms"?"Terma/Pernyataan":"Termini/Declaratio"}),i.jsx("a",{href:"/data-deletion",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12},children:t==="zh-TW"?"資料刪除說明":t==="zh-CN"?"数据删除说明":t==="en"?"Data Deletion":t==="ja"?"データ削除について":t==="ko"?"데이터 삭제 안내":t==="th"?"คำอธิบายการลบข้อมูล":t==="vi"?"Giải thích xóa dữ liệu":t==="ms"?"Penjelasan Penghapusan Data":"Explicatio Deletionis Datae"}),i.jsx("a",{href:"/feedback",style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12},children:t==="zh-TW"?"💬 意見箱｜我們想聽你說":t==="zh-CN"?"💬 意见箱｜我们想听你说":t==="en"?"💬 Feedback Box｜We Want to Hear From You":t==="ja"?"💬 ご意見箱｜私たちはあなたの声を聞きたい":t==="ko"?"💬 피드백｜우리는 당신의 말을 듣고 싶습니다":t==="th"?"💬 กล่องความคิดเห็น｜เราอยากได้ยินจากคุณ":t==="vi"?"💬 Hộp góp ý｜Chúng tôi muốn nghe từ bạn":t==="ms"?"💬 Kotak Maklum Balas｜Kami Ingin Mendengar Dari Anda":"💬 Arca Consilii｜Volumus Audire a Te"})]})})]})}const yp={"zh-TW":{back:"← 返回上一頁",title:"聊天室",send:"送出",placeholder:"輸入訊息..."},"zh-CN":{back:"← 返回上一页",title:"聊天室",send:"发送",placeholder:"输入信息..."},en:{back:"← Back",title:"Chat Room",send:"Send",placeholder:"Type a message..."},ja:{back:"← 前のページへ",title:"チャットルーム",send:"送信",placeholder:"メッセージを入力..."},ko:{back:"← 이전 페이지",title:"채팅방",send:"보내기",placeholder:"메시지 입력..."},th:{back:"← กลับ",title:"ห้องแชท",send:"ส่ง",placeholder:"พิมพ์ข้อความ..."},vi:{back:"← Quay lại",title:"Phòng chat",send:"Gửi",placeholder:"Nhập tin nhắn..."},ms:{back:"← Kembali",title:"Bilik Sembang",send:"Hantar",placeholder:"Taip mesej..."},la:{back:"← Redire",title:"Cella Colloquii",send:"Mitte",placeholder:"Nuntium insere..."}};function P3({open:n,onClose:e,roomId:t,friendName:r}){const[o,a]=v.useState(!1),[c,d]=v.useState(!0),[h,m]=v.useState(""),[g,x]=v.useState([]),S=v.useRef(null),j=v.useRef(null),[T,R]=v.useState(null);v.useEffect(()=>{n&&I()},[n]);const I=async()=>{try{const J=await navigator.mediaDevices.getUserMedia({video:!0,audio:!0});R(J),S.current&&(S.current.srcObject=J);const O=J.getAudioTracks()[0];O&&(O.enabled=!1)}catch(J){console.error("無法取得視訊權限:",J),alert("無法取得視訊權限，請檢查瀏覽器設定")}},F=()=>{if(T){const J=T.getAudioTracks()[0];J&&(J.enabled=!J.enabled,a(J.enabled))}},P=()=>{if(T){const J=T.getVideoTracks()[0];J&&(J.enabled=!J.enabled,d(J.enabled))}},z=()=>{if(h.trim()){const J={id:Date.now().toString(),text:h,sender:"我",time:new Date().toLocaleTimeString()};x(O=>[...O,J]),m("")}},H=J=>{J.key==="Enter"&&z()};return n?i.jsx("div",{style:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",background:"#0007",zIndex:9999,display:"flex",alignItems:"center",justifyContent:"center"},children:i.jsxs("div",{style:{background:"#fff",borderRadius:16,padding:24,boxShadow:"0 2px 16px #0003",width:"80%",maxWidth:800,height:"80%",maxHeight:600,position:"relative",display:"flex",flexDirection:"column"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[i.jsx("h2",{style:{color:"#6B5BFF",fontWeight:700,fontSize:20,margin:0},children:"免費一對一視訊聊天"}),i.jsx("button",{onClick:e,style:{background:"#eee",border:"none",borderRadius:8,padding:"6px 14px",fontWeight:700,cursor:"pointer"},children:"關閉"})]}),i.jsxs("div",{style:{display:"flex",flex:1,gap:16},children:[i.jsxs("div",{style:{flex:2,display:"flex",flexDirection:"column",gap:12},children:[i.jsxs("div",{style:{display:"flex",gap:12,flex:1},children:[i.jsxs("div",{style:{flex:1},children:[i.jsx("div",{style:{fontWeight:700,marginBottom:8,fontSize:14},children:"我"}),i.jsx("video",{ref:S,autoPlay:!0,playsInline:!0,muted:!0,style:{width:"100%",height:120,background:"#000",borderRadius:8,objectFit:"cover",transform:"scaleX(-1)"}})]}),i.jsxs("div",{style:{flex:1},children:[i.jsx("div",{style:{fontWeight:700,marginBottom:8,fontSize:14},children:r}),i.jsx("video",{ref:j,autoPlay:!0,playsInline:!0,style:{width:"100%",height:120,background:"#000",borderRadius:8,objectFit:"cover"}})]})]}),i.jsxs("div",{style:{display:"flex",gap:8,justifyContent:"center"},children:[i.jsx("button",{onClick:F,style:{background:"#6B5BFF",color:"#fff",border:"none",borderRadius:6,padding:"8px 16px",fontWeight:700,fontSize:14,cursor:"pointer"},children:o?"關閉語音":"開啟語音"}),i.jsx("button",{onClick:P,style:{background:"#6B5BFF",color:"#fff",border:"none",borderRadius:6,padding:"8px 16px",fontWeight:700,fontSize:14,cursor:"pointer"},children:c?"關閉視訊":"開啟視訊"})]})]}),i.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",border:"1px solid #eee",borderRadius:8,padding:12},children:[i.jsx("div",{style:{fontWeight:700,marginBottom:8,fontSize:14},children:"即時聊天"}),i.jsx("div",{style:{flex:1,background:"#f7f7f7",borderRadius:6,padding:8,marginBottom:8,overflowY:"auto",minHeight:100},children:g.length===0?i.jsx("div",{style:{fontSize:12,color:"#666",textAlign:"center",marginTop:20},children:"視訊聊天中，可以同時打字聊天"}):g.map(J=>i.jsxs("div",{style:{marginBottom:8,fontSize:12},children:[i.jsx("div",{style:{fontWeight:600,color:"#6B5BFF"},children:J.sender}),i.jsx("div",{style:{color:"#333",marginTop:2},children:J.text}),i.jsx("div",{style:{fontSize:10,color:"#999",marginTop:2},children:J.time})]},J.id))}),i.jsxs("div",{style:{display:"flex",gap:8},children:[i.jsx("input",{value:h,onChange:J=>m(J.target.value),onKeyPress:H,placeholder:"輸入訊息...",style:{flex:1,borderRadius:6,border:"1px solid #ccc",padding:"6px 8px",fontSize:12}}),i.jsx("button",{onClick:z,style:{background:"#6B5BFF",color:"#fff",border:"none",borderRadius:6,padding:"6px 12px",fontWeight:700,fontSize:12,cursor:"pointer"},children:"發送"})]})]})]})]})}):null}function B3(){const[n,e]=v.useState([]),[t,r]=v.useState(null),[o,a]=v.useState([]),[c,d]=v.useState(""),{lang:h,setLang:m}=Lt(),[g,x]=v.useState(null),[S,j]=v.useState(!0),T=v.useRef(null),R=Et(),[I,F]=v.useState(!1),{isTestMode:P}=Bo();v.useEffect(()=>{const O=Ns(ga,async L=>{L?(x(L),await z(L.uid)):R("/")});return()=>O()},[R]);const z=async O=>{j(!0);const L=En(Wt,"links"),C=mr(L,An("user1Id","==",O),An("status","==","connected")),A=mr(L,An("user2Id","==",O),An("status","==","connected")),[D,M]=await Promise.all([Vr(C),Vr(A)]),B=new Set;D.forEach(U=>B.add(U.data().user2Id)),M.forEach(U=>B.add(U.data().user1Id));const _=[];for(const U of B){const oe=Pn(Wt,"profiles",U),X=await To(oe);if(X.exists()){const ce=X.data();_.push({id:U,name:ce.name||"好友",avatar:ce.avatar||"/avatars/Derxl.png",online:!!ce.online})}}if(P&&_.push({id:"test-friend-1",name:"測試好友 1",avatar:"/avatars/Annie.png",online:!0},{id:"test-friend-2",name:"測試好友 2",avatar:"/avatars/Bray.png",online:!1},{id:"test-friend-3",name:"測試好友 3",avatar:"/avatars/berlex.png",online:!0}),e(_),j(!1),P&&_.length>0){const U=_.find(oe=>oe.id.startsWith("test-friend-"));U&&r(U)}};v.useEffect(()=>{if(g&&t){if(j(!0),P&&t.id.startsWith("test-friend-")){const A=[{id:"test-msg-1",fromUserId:t.id,fromUserName:t.name,toUserId:g.uid,toUserName:g.displayName||"我",text:"你好！很高興認識你 😊",participants:[g.uid,t.id],createdAt:new Date(Date.now()-3e5)},{id:"test-msg-2",fromUserId:g.uid,fromUserName:g.displayName||"我",toUserId:t.id,toUserName:t.name,text:"你好！我也很高興認識你 👋",participants:[g.uid,t.id],createdAt:new Date(Date.now()-24e4)},{id:"test-msg-3",fromUserId:t.id,fromUserName:t.name,toUserId:g.uid,toUserName:g.displayName||"我",text:"今天天氣真不錯，你有什麼計劃嗎？",participants:[g.uid,t.id],createdAt:new Date(Date.now()-18e4)},{id:"test-msg-4",fromUserId:g.uid,fromUserName:g.displayName||"我",toUserId:t.id,toUserName:t.name,text:"我想去公園散步，你要一起嗎？",participants:[g.uid,t.id],createdAt:new Date(Date.now()-12e4)},{id:"test-msg-5",fromUserId:t.id,fromUserName:t.name,toUserId:g.uid,toUserName:g.displayName||"我",text:"好啊！聽起來很有趣 🌳",participants:[g.uid,t.id],createdAt:new Date(Date.now()-6e4)}];a(A),j(!1);return}const O=En(Wt,"messages"),L=mr(O,An("participants","array-contains",g.uid),tf("createdAt","asc")),C=w0(L,A=>{const D=[];A.forEach(M=>{const B=M.data();B.participants.includes(t.id)&&D.push({...B,id:M.id})}),a(D),j(!1)});return()=>C()}},[g,t,P]),v.useEffect(()=>{var O;(O=T.current)==null||O.scrollIntoView({behavior:"smooth"})},[o]);const H=async()=>{if(!(!c.trim()||!g||!t)){if(P&&t.id.startsWith("test-friend-")){const O={id:`test-msg-${Date.now()}`,fromUserId:g.uid,fromUserName:g.displayName||"我",toUserId:t.id,toUserName:t.name,text:c,participants:[g.uid,t.id],createdAt:new Date};a(L=>[...L,O]),d("");return}try{const O={fromUserId:g.uid,fromUserName:g.displayName||"我",toUserId:t.id,toUserName:t.name,text:c,participants:[g.uid,t.id],createdAt:k0()};await xs(En(Wt,"messages"),O),d("")}catch{alert("發送訊息失敗")}}},J=O=>{O.key==="Enter"&&!O.shiftKey&&(O.preventDefault(),H())};return S?i.jsx("div",{style:{background:"url('/green_hut.png') center center / cover no-repeat",minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center"},children:i.jsx("div",{style:{color:"#fff",fontSize:18},children:"載入中..."})}):i.jsxs("div",{style:{background:"url('/green_hut.png') center center / cover no-repeat",minHeight:"100vh",display:(window.innerWidth<=768,"flex"),flexDirection:window.innerWidth<=768?"column":"row",alignItems:window.innerWidth<=768?"center":"flex-start",justifyContent:"center",paddingTop:window.innerWidth<=768?20:40,position:"relative"},children:[i.jsx("button",{onClick:()=>R("/friend"),style:{position:"fixed",top:24,left:24,zIndex:10001,background:"#fff",border:"1.5px solid #6B5BFF",color:"#6B5BFF",borderRadius:8,padding:"6px 18px",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:"0 2px 8px #0001"},children:"返回上一頁"}),window.innerWidth<=768?i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:20,justifyContent:"center",alignItems:"center",width:"100%",maxWidth:400,padding:"20px"},children:[P&&i.jsxs("div",{style:{background:"rgba(255,255,255,0.9)",padding:"8px 12px",borderRadius:8,fontSize:12,color:"#666",marginBottom:10},children:["測試模式：好友數量 ",n.length,"，選中好友 ",(t==null?void 0:t.name)||"無"]}),i.jsxs("div",{style:{background:"rgba(255,255,255,0.95)",borderRadius:16,padding:"24px",boxShadow:"0 8px 24px rgba(0,0,0,0.3)",width:"95%",maxWidth:320,border:"2px solid rgba(107,91,255,0.3)"},children:[i.jsx("div",{style:{fontWeight:800,fontSize:22,color:"#6B5BFF",marginBottom:16,textAlign:"center",textShadow:"0 1px 2px rgba(0,0,0,0.1)"},children:"好友列表"}),i.jsx("div",{style:{textAlign:"center",color:"#333",fontSize:16,lineHeight:1.5,fontWeight:500,marginBottom:16},children:n.length===0?P?"測試模式已啟用，但沒有測試好友":"請先加好友,才能開始聊天":"選擇好友開始聊天"}),n.length>0&&i.jsx("div",{style:{maxHeight:200,overflowY:"auto"},children:n.map(O=>i.jsxs("div",{onClick:()=>O.online&&r(O),style:{display:"flex",alignItems:"center",gap:12,marginBottom:12,cursor:O.online?"pointer":"not-allowed",padding:"8px",borderRadius:8,background:(t==null?void 0:t.id)===O.id?"rgba(107,91,255,0.1)":"transparent",border:(t==null?void 0:t.id)===O.id?"1px solid #6B5BFF":"1px solid transparent",opacity:O.online?1:.5},children:[i.jsx("img",{src:O.avatar,alt:O.name,style:{width:36,height:36,borderRadius:"50%",filter:O.online?"none":"grayscale(1)",border:(t==null?void 0:t.id)===O.id?"2px solid #6B5BFF":"2px solid #eee"}}),i.jsxs("div",{style:{flex:1},children:[i.jsxs("div",{style:{fontWeight:600,color:O.online?"#222":"#aaa",fontSize:14},children:[O.name,P&&O.id.startsWith("test-friend-")&&i.jsx("span",{style:{fontSize:"10px",background:"#ff6b6b",color:"white",padding:"2px 6px",borderRadius:"4px",marginLeft:"6px",fontWeight:"normal"},children:"測試"})]}),i.jsx("div",{style:{fontSize:11,color:O.online?"#23c6e6":"#aaa"},children:O.online?"在線":"離線"})]})]},O.id))})]}),i.jsxs("div",{style:{background:"rgba(255,255,255,0.95)",borderRadius:16,padding:"24px",boxShadow:"0 8px 24px rgba(0,0,0,0.3)",width:"95%",maxWidth:320,border:"2px solid rgba(107,91,255,0.3)"},children:[i.jsx("div",{style:{fontWeight:800,fontSize:22,color:"#6B5BFF",marginBottom:16,textAlign:"center",textShadow:"0 1px 2px rgba(0,0,0,0.1)"},children:"聊天訊息框"}),i.jsx("div",{style:{textAlign:"center",color:"#333",fontSize:16,lineHeight:1.5,fontWeight:500,marginBottom:16},children:n.length===0?P?"測試模式已啟用，請選擇測試好友開始聊天！":"還沒有朋友,去交友區加好友吧!":t?`與 ${t.name} 聊天`:"請選擇好友開始聊天"}),t&&i.jsx("div",{style:{maxHeight:150,overflowY:"auto",background:"#f7f7f7",borderRadius:8,padding:12,marginBottom:16},children:o.length===0?i.jsx("div",{style:{textAlign:"center",color:"#888",fontSize:14},children:P&&t.id.startsWith("test-friend-")?"開始測試聊天吧！":"開始聊天吧！"}):o.map((O,L)=>i.jsxs("div",{style:{textAlign:O.fromUserId===(g==null?void 0:g.uid)?"right":"left",marginBottom:8},children:[i.jsxs("span",{style:{fontWeight:600,color:O.fromUserId===(g==null?void 0:g.uid)?"#2a5d8f":"#888",fontSize:12},children:[O.fromUserName,"："]}),i.jsx("span",{style:{marginLeft:4,fontSize:12},children:O.text})]},O.id||L))}),i.jsxs("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",gap:8,minHeight:48},children:[i.jsx("input",{value:c,onChange:O=>d(O.target.value),onKeyPress:J,style:{flex:1,borderRadius:6,border:"1px solid #ccc",padding:8,fontSize:14},placeholder:P&&(t!=null&&t.id.startsWith("test-friend-"))?"輸入測試訊息...":yp[h].placeholder,disabled:n.length===0||!t}),i.jsx("button",{onClick:t?H:void 0,disabled:n.length===0||!t,style:{background:"#6B5BFF",color:"#fff",border:"none",borderRadius:6,padding:"8px 12px",fontWeight:700,fontSize:14,cursor:n.length===0||!t?"not-allowed":"pointer",opacity:n.length===0||!t?.5:1},children:P&&(t!=null&&t.id.startsWith("test-friend-"))?"發送":yp[h].send}),i.jsx("button",{onClick:t?()=>F(!0):void 0,disabled:n.length===0||!t,style:{background:"#6B5BFF",color:"#fff",border:"none",borderRadius:6,padding:"8px 12px",fontWeight:700,fontSize:14,cursor:n.length===0||!t?"not-allowed":"pointer",opacity:n.length===0||!t?.5:1},children:P&&(t!=null&&t.id.startsWith("test-friend-"))?"視訊":"視訊聊天"})]})]})]}):i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{width:220,background:"#fff",borderRadius:16,boxShadow:"0 2px 8px #0001",padding:16,marginRight:32,minHeight:600},children:[i.jsx("div",{style:{fontWeight:700,fontSize:20,marginBottom:16},children:"好友列表"}),n.length===0?i.jsx("div",{style:{color:"#888",textAlign:"center",marginTop:80,fontSize:16,fontWeight:600},children:P?i.jsxs(i.Fragment,{children:["測試模式已啟用，但沒有測試好友",i.jsx("br",{}),i.jsx("span",{style:{fontSize:32},children:"🧪"})]}):i.jsxs(i.Fragment,{children:["你暫時沒有連結朋友，再繼續加油 💪",i.jsx("br",{}),i.jsx("span",{style:{fontSize:32},children:"🦋"})]})}):n.map(O=>i.jsxs("div",{onClick:()=>O.online&&r(O),style:{display:"flex",alignItems:"center",gap:12,marginBottom:16,cursor:O.online?"pointer":"not-allowed",opacity:O.online?(t==null?void 0:t.id)===O.id?1:.7:.3},children:[i.jsx("img",{src:O.avatar,alt:O.name,style:{width:44,height:44,borderRadius:"50%",filter:O.online?"none":"grayscale(1)",border:(t==null?void 0:t.id)===O.id?"2px solid #6B5BFF":"2px solid #eee"}}),i.jsxs("div",{children:[i.jsxs("div",{style:{fontWeight:600,color:O.online?"#222":"#aaa"},children:[O.name,P&&O.id.startsWith("test-friend-")&&i.jsx("span",{style:{fontSize:"10px",background:"#ff6b6b",color:"white",padding:"2px 6px",borderRadius:"4px",marginLeft:"6px",fontWeight:"normal"},children:"測試"})]}),i.jsx("div",{style:{fontSize:12,color:O.online?"#23c6e6":"#aaa"},children:O.online?"在線":"離線"})]})]},O.id))]}),i.jsxs("div",{style:{flex:1,maxWidth:500,background:"#fff",borderRadius:16,boxShadow:"0 2px 8px #0001",padding:32,minHeight:600,display:"flex",flexDirection:"column",position:"relative"},children:[i.jsx("div",{style:{fontWeight:700,fontSize:22,marginBottom:16,marginTop:8},children:t?P&&t.id.startsWith("test-friend-")?`與 ${t.name} 聊天 (測試模式)`:`與 ${t.name} 聊天`:n.length===0?P?"測試模式已啟用，請選擇測試好友開始聊天":"請先加好友，才能開始聊天":"請選擇好友開始聊天"}),i.jsxs("div",{style:{flex:1,overflowY:"auto",marginBottom:16,background:"#f7f7f7",borderRadius:8,padding:16,minHeight:240,maxHeight:340},children:[(!t||o.length===0)&&i.jsx("div",{style:{textAlign:"center",color:"#888",marginTop:20},children:t?P&&t.id.startsWith("test-friend-")?"開始測試聊天吧！":"開始聊天吧！":n.length===0?P?"測試模式已啟用，請選擇測試好友開始聊天！":"還沒有朋友，去交友區加好友吧！":"請先選擇好友"}),t&&o.map((O,L)=>i.jsxs("div",{style:{textAlign:O.fromUserId===(g==null?void 0:g.uid)?"right":"left",marginBottom:10},children:[i.jsxs("span",{style:{fontWeight:600,color:O.fromUserId===(g==null?void 0:g.uid)?"#2a5d8f":"#888"},children:[O.fromUserName,"："]}),i.jsx("span",{style:{marginLeft:8},children:O.text})]},O.id||L)),i.jsx("div",{ref:T})]}),i.jsxs("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",gap:8,minHeight:48,marginTop:8},children:[i.jsx("input",{value:c,onChange:O=>d(O.target.value),onKeyPress:J,style:{flex:1,borderRadius:6,border:"1px solid #ccc",padding:10,fontSize:16},placeholder:P&&(t!=null&&t.id.startsWith("test-friend-"))?"輸入測試訊息...":yp[h].placeholder,disabled:n.length===0||!t}),i.jsx("button",{onClick:t?H:void 0,disabled:n.length===0||!t,style:{background:"#6B5BFF",color:"#fff",border:"none",borderRadius:6,padding:"10px 20px",fontWeight:700,fontSize:16,cursor:n.length===0||!t?"not-allowed":"pointer",opacity:n.length===0||!t?.5:1},children:P&&(t!=null&&t.id.startsWith("test-friend-"))?"發送":yp[h].send}),i.jsx("button",{onClick:t?()=>F(!0):void 0,disabled:n.length===0||!t,style:{background:"#6B5BFF",color:"#fff",border:"none",borderRadius:6,padding:"10px 20px",fontWeight:700,fontSize:16,cursor:n.length===0||!t?"not-allowed":"pointer",opacity:n.length===0||!t?.5:1},children:P&&(t!=null&&t.id.startsWith("test-friend-"))?"視訊":"視訊聊天"})]}),i.jsx(P3,{open:I,onClose:()=>F(!1),roomId:g&&t?`${g.uid}_${t.id}`:"",friendName:(t==null?void 0:t.name)||"對方"})]})]})]})}const ho={"zh-TW":"每個人都值得一個能「重啟」的起點。","zh-CN":"每个人都值得一个能“重启”的起点。",en:"Everyone deserves a new beginning.",ja:"誰もが「再出発」できるスタート地点を持つべきです。",ko:'모든 사람은 "다시 시작"할 수 있는 출발점이 필요합니다.',th:"ทุกคนสมควรได้รับจุดเริ่มต้นใหม่",vi:"Mỗi người đều xứng đáng có một khởi đầu mới.",ms:"Setiap orang layak mendapat permulaan semula.",la:"Omnis novum initium meretur."},F3={"zh-TW":{title:"我們是誰",subtitle:"🧬 Restarter™｜我們是誰（關於我們）",story:`${ho["zh-TW"]}
你可能來自一場重創，或正走在一條孤獨的路上。
在這個被標籤和數據主導的世界裡，我們知道——有些情緒，不是一句「加油」能解決的。

Restarter™ 是專為「曾經失去節奏的人」打造的 AI 陪伴平台。
我們不但教你怎麼變強、不單告訴你要正能量，
我們更提供一個空間,讓你可以呼吸、可以交流、可以說實話、可以重新選擇。

這裡沒有社會的審判，只有一群「曾經也痛過的人」在用技術把陪伴具體化。
透過 AI，我們讓每一次對話、每一段情緒，都有人接得住。`,quote:"「我們不是修復你，我們是來陪你重啟。」",restart:"Restarter™，是你重新定義自己的起點。",founder:"創辦者的話",founderStory:`我曾經失去自由十年。<br/>
那不是旅居、不是修行，而是被法律與命運關進去的十年。<br/>
在一間不大的房間裡，和一群同樣頂著光頭、穿著另類制服的人擠在一起，日子一開始像是一場長夢，到了後來，連夢都不做了。我以為這一生就這樣被定義了。<br/><br/>
出去那天，天空灰得刺眼。我笑著走出來，但心裡卻是空的。<br/>
社會沒有在等你，家人不知如何面對你，朋友的問候也帶著距離。<br/>
起初的很多時候，我甚至不敢正眼看便利商店的收銀員，因為<span style='color:#e4572e;font-weight:700;'>我忘了怎麼當一個「普通人」</span>。<br/><br/>
我一直想問：<br/>
<span style='color:#614425;font-weight:900;'>我還有沒有機會，重新開始？</span><br/><br/>
後來我才明白——<br/>
<span style='color:#e4572e;font-weight:900;'>不是世界不給機會，是我們被迫忘了怎麼伸手抓。</span><br/><br/>
這就是 <span style='color:#6B5BFF;font-weight:900;'>Restarter™</span> 存在的原因。<br/>
不是來修復你，不是總告訴你「要振作」，<br/>
而是給你一個空間，一個能慢慢重新建立自己的容器。<br/>
讓你在失落裡還能大聲說話，在混亂中依然有人接得住。<br/><br/>
<span style='color:#6B5BFF;font-weight:900;'>Restarter™</span>，不只是技術產品，<br/>
是我從自己生命最底部捧出來的一個火種，<br/>
我希望它能為你，也為更多人，點起一盞燈。<br/><br/>
<span style='color:#614425;font-weight:900;'>不論你是誰，經歷什麼，來自世界哪個角落，<br/>在這裡你可以大膽放下那些標籤、包裝、包袱。</span><br/>
因為我們相信——<br/>
<span style='color:#e4572e;font-weight:900;'>「破碎過的人，不僅能堅強，也能很溫柔。」</span><br/><br/>
<span style='color:#6B5BFF;font-weight:900;'>我們不是修復你，我們是來陪你重啟。</span><br/>
<div style='text-align:right;margin-top:24px;font-size:18px;color:#232946;font-weight:700;'>發起人：Ben<br/>May,21,2025</div>`},"zh-CN":{title:"我们是谁",subtitle:"🧬 Restarter™｜我们是谁（关于我们）",story:`${ho["zh-CN"]}
你可能来自一场重创，或正走在一条孤独的路上。
在这个被标签和数据主导的世界里，我们知道——有些情绪，不是一句「加油」能解决的。

Restarter™ 是专为「曾经失去节奏的人」打造的 AI 陪伴平台。
我们不教你怎么变强、不告诉你要正能量，
我们只提供一个空间，让你可以呼吸、可以说实话、可以重新选择。

这里没有社会的审判，只有一群「曾经也痛过的人」在用技术把陪伴实体化。
通过 AI，我们让每一次对话、每一段情绪，都有人接得住。`,quote:"「我们不是修复你，我们陪你重启。」",restart:"Restarter™，是你重新定义自己的起点。",founder:"创办者的话",founderStory:`我曾经失去自由十年。<br/>
那不是旅行、不是修行，而是被法律和命运关进去了十年。<br/>
在一间不大的房间里，和一群同样光头、穿着统一服装的人挤在一起，日子一开始像是一场长梦，后来连梦都不做了。我以为这一生就这样被定义了。<br/><br/>
出去那天，天空灰得刺眼。我笑着走出来，但心里却是空的。<br/>
社会没有在等你，家人不知如何面对你，朋友的问候也带着距离。<br/>
很多时候，我甚至不敢正眼看便利店的收银员，因为<span style='color:#e4572e;font-weight:700;'>我忘了怎么当一个"普通人"</span>。<br/><br/>
我一直想问：<br/>
<span style='color:#614425;font-weight:900;'>我还有没有机会，重新开始？</span><br/><br/>
后来我才明白——<br/>
<span style='color:#e4572e;font-weight:900;'>不是世界不给机会，是我们被迫忘了怎么伸手抓。</span><br/><br/>
这就是 <span style='color:#6B5BFF;font-weight:900;'>Restarter™</span> 存在的原因。<br/>
不是来修复你，不是总告诉你"要振作"，<br/>
而是给你一个空间，一个能慢慢重新建立自己的容器。<br/>
让你在失落里还能大声说话，在混乱中有人接得住。<br/><br/>
<span style='color:#6B5BFF;font-weight:900;'>Restarter™</span>，不只是技术产品，<br/>
是我从自己生命最底部捧出来的一束火种，<br/>
我希望它能为你，也为更多人，点亮一盏灯。<br/><br/>
<span style='color:#614425;font-weight:900;'>无论你是谁，经历什么，来自世界哪个角落，<br/>在这里你可以大胆放下那些伪装。</span><br/>
因为我们相信——<br/>
<span style='color:#e4572e;font-weight:900;'>"破碎过的人，不仅能坚强，也能很温柔。"</span><br/><br/>
<span style='color:#6B5BFF;font-weight:900;'>我们不是修复你，我们是来陪你重启。</span><br/>
<div style='text-align:right;margin-top:24px;font-size:18px;color:#232946;font-weight:700;'>发起人：Ben<br/>2025年5月21日</div>`},en:{title:"About Us",subtitle:"🧬 Restarter™｜Who We Are",story:`${ho.en}
You may have come from a major setback, or are walking a lonely road.
In a world dominated by labels and data, we know—some feelings can't be fixed by a simple "cheer up".

Restarter™ is an AI companion platform built for those who have lost their rhythm.
We don't teach you how to be strong, nor tell you to be positive.
We simply offer a space where you can breathe, speak your truth, and choose again.

There is no judgment here—only people who have also suffered, using technology to make companionship real.
Through AI, every conversation and every emotion is caught and cared for.`,quote:"“We are not here to fix you, we are here to restart with you.”",restart:"Restarter™ is your new beginning to redefine yourself.",founder:"Founder's Message",founderStory:`I lost my freedom for ten years.<br/>
It wasn't travel or spiritual retreat, but ten years locked away by law and fate.<br/>
In a small room, crowded with others in the same uniform, the days first felt like a long dream, then even dreams faded. I thought my life was defined forever.<br/><br/>
The day I got out, the sky was a blinding gray. I walked out smiling, but my heart was empty.<br/>
Society wasn't waiting for me, my family didn't know how to face me, and friends' greetings felt distant.<br/>
Many times, I couldn't even look a cashier in the eye, because <span style='color:#e4572e;font-weight:700;'>I'd forgotten how to be "normal"</span>.<br/><br/>
I kept asking myself:<br/>
<span style='color:#614425;font-weight:900;'>Do I still have a chance to start over?</span><br/><br/>
Later, I realized—<br/>
<span style='color:#e4572e;font-weight:900;'>It's not that the world doesn't give chances, but that we've forgotten how to reach for them.</span><br/><br/>
That's why <span style='color:#6B5BFF;font-weight:900;'>Restarter™</span> exists.<br/>
Not to fix you, not to always tell you to "cheer up,"<br/>
but to give you a space—a container to slowly rebuild yourself.<br/>
A place where you can speak up in your loss, and someone will catch you in your chaos.<br/><br/>
<span style='color:#6B5BFF;font-weight:900;'>Restarter™</span> is not just a tech product;<br/>
it's a spark I brought up from the bottom of my life.<br/>
I hope it lights a lamp for you, and for many others.<br/><br/>
<span style='color:#614425;font-weight:900;'>Whoever you are, whatever you've been through, wherever you're from—<br/>here, you can let go of all the masks.</span><br/>
Because we believe—<br/>
<span style='color:#e4572e;font-weight:900;'>"Those who have been broken can be strong, and gentle too."</span><br/><br/>
<span style='color:#6B5BFF;font-weight:900;'>We are not here to fix you, we are here to restart with you.</span><br/>
<div style='text-align:right;margin-top:24px;font-size:18px;color:#232946;font-weight:700;'>Founder: Ben<br/>May 21, 2025</div>`},ja:{title:"私たちについて",subtitle:"🧬 Restarter™｜私たちについて",story:`${ho.ja}
あなたは大きな挫折から来たかもしれないし、孤独な道を歩んでいるかもしれません。
ラベルやデータが支配するこの世界で、私たちは知っています——「頑張って」だけでは解決できない感情があることを。

Restarter™は「リズムを失った人」のためのAI伴走プラットフォームです。
強くなる方法を教えたり、ポジティブになれと言ったりはしません。
ただ、呼吸できて、本音を言えて、もう一度選び直せる空間を提供します。

ここには社会の裁きはなく、「かつて痛みを知った人たち」が技術で寄り添っています。
AIを通じて、すべての対話と感情が、誰かに受け止められます。`,quote:"「私たちはあなたを修復するのではなく、一緒に再出発します。」",restart:"Restarter™は、あなたが自分を再定義する新たなスタート地点です。",founder:"創業者の言葉",founderStory:`私は10年間、自由を失いました。<br/>
それは旅でも修行でもなく、法律と運命によって閉じ込められた10年でした。<br/>
小さな部屋で、同じ服を着た仲間たちと押し込められ、最初は長い夢のようで、やがて夢さえ見なくなりました。人生はもう決まったものだと思っていました。<br/><br/>
出所の日、空は眩しいほど灰色でした。我笑顔で外に出たけれど、心は空っぽ。<br/>
社會は待っていない、家族もどう接していいかわからない、友人の声もどこか遠い。<br/>
何度も、コンビニの店員の目を見られなかった。<span style='color:#e4572e;font-weight:700;'>「普通の人」になる方法を忘れてしまった</span>から。<br/><br/>
ずっと自問していました：<br/>
<span style='color:#614425;font-weight:900;'>もう一度やり直すチャンスはあるのか？</span><br/><br/>
やがて気づきました——<br/>
<span style='color:#e4572e;font-weight:900;'>世界がチャンスをくれないのではなく、手を伸ばす方法を忘れてしまったのだと。</span><br/><br/>
これが <span style='color:#6B5BFF;font-weight:900;'>Restarter™</span> の存在理由です。<br/>
あなたを修復するためでも、無理に「元気を出して」と言うためでもなく、<br/>
ゆっくり自分を取り戻せる場所を作りたかった。<br/>
失意の中でも声を上げられ、混乱の中でも誰かが受け止めてくれる場所を。<br/><br/>
<span style='color:#6B5BFF;font-weight:900;'>Restarter™</span> は単なる技術製品ではありません。<br/>
人生のどん底からすくい上げた火種です。<br/>
あなたや多くの人のために、灯りをともしたい。<br/><br/>
<span style='color:#614425;font-weight:900;'>あなたが誰であれ、どんな経験をしてきたとしても、<br/>ここではすべての仮面を外していい。</span><br/>
私たちは信じています——<br/>
<span style='color:#e4572e;font-weight:900;'>「壊れた人は、強くもなれるし、優しくもなれる。」</span><br/><br/>
<span style='color:#6B5BFF;font-weight:900;'>私たちはあなたを修復するのではなく、一緒に再出発します。</span><br/>
<div style='text-align:right;margin-top:24px;font-size:18px;color:#232946;font-weight:700;'>発起人：Ben<br/>2025年5月21日</div>`},ko:{title:"우리는 누구인가",subtitle:"🧬 Restarter™｜우리는 누구인가",story:`${ho.ko}
당신은 큰 시련을 겪었거나, 외로운 길을 걷고 있을지도 모릅니다.
라벨과 데이터가 지배하는 세상에서, 우리는 압니다—어떤 감정은 "힘내"라는 말로 해결되지 않는다는 것을.

Restarter™는 "한때 리듬을 잃었던 사람"을 위한 AI 동반자 플랫폼입니다.
우리는 당신에게 강해지는 법을 가르치지 않고, 긍정적이 되라고 말하지 않습니다.
우리는 단지 숨 쉴 수 있고, 진실을 말할 수 있고, 다시 선택할 수 있는 공간을 제공합니다.

여기에는 사회의 심판이 없고, "한때 아팠던 사람들"이 기술로 동행합니다.
AI를 통해 모든 대화와 감정이 누군가에게 받아들여집니다。`,quote:'"우리는 당신을 고치는 것이 아니라, 함께 다시 시작합니다."',restart:"Restarter™는 당신이 자신을 새롭게 정의하는 출발점입니다。",founder:"창업자의 말",founderStory:`저는 10년 동안 자유를 잃었습니다.<br/>
그것은 여행도, 수련도 아니었고, 법과 운명에 의해 갇혀 있던 10년이었습니다.<br/>
작은 방에서 같은 옷을 입은 사람들과 함께 지내며, 처음에는 긴 꿈을 꾸는 것 같았지만, 나중에는 꿈조차 꾸지 않게 되었습니다. 저는 제 인생이 그렇게 정의될 거라 생각했습니다.<br/><br/>
밖으로 나왔던 날, 하늘은 눈부시게 회색이었습니다. 저는 웃으며 나왔지만, 마음은 텅 비어 있었습니다.<br/>
사회는 저를 기다려주지 않았고, 가족도 저를 어떻게 대해야 할지 몰랐으며, 친구들의 인사도 어딘가 멀게 느껴졌습니다.<br/>
처음에는 편의점 계산원의 눈을 제대로 쳐다보지도 못했습니다. <span style='color:#e4572e;font-weight:700;'>"평범한 사람"이 되는 법을 잊어버렸기 때문입니다</span>.<br/><br/>
저는 계속해서 스스로에게 물었습니다:<br/>
<span style='color:#614425;font-weight:900;'>나는 다시 시작할 기회가 있을까?</span><br/><br/>
나중에야 깨달았습니다——<br/>
<span style='color:#e4572e;font-weight:900;'>세상이 기회를 주지 않는 것이 아니라, 우리가 손을 내미는 법을 잊어버린 것입니다.</span><br/><br/>
이것이 <span style='color:#6B5BFF;font-weight:900;'>Restarter™</span>가 존재하는 이유입니다.<br/>
당신을 고치기 위해서도, 항상 "힘내라"고 말하기 위해서도 아닙니다.<br/>
당신이 천천히 자신을 다시 세울 수 있는 공간, 그릇을 주고 싶었습니다.<br/>
상실 속에서도 목소리를 낼 수 있고, 혼란 속에서도 누군가가 당신을 받아줄 수 있는 곳.<br/><br/>
<span style='color:#6B5BFF;font-weight:900;'>Restarter™</span>는 단순한 기술 제품이 아닙니다.<br/>
제 인생의 가장 밑바닥에서 끌어올린 불씨입니다.<br/>
이 불씨가 당신과 더 많은 사람들에게 등불이 되길 바랍니다.<br/><br/>
<span style='color:#614425;font-weight:900;'>당신이 누구든, 어떤 경험을 했든, 어디에서 왔든,<br/>여기서는 모든 가면을 내려놓을 수 있습니다.</span><br/>
우리는 믿습니다——<br/>
<span style='color:#e4572e;font-weight:900;'>"부서진 사람도 강해질 수 있고, 아주 다정해질 수도 있습니다."</span><br/><br/>
<span style='color:#6B5BFF;font-weight:900;'>우리는 당신을 고치는 것이 아니라, 함께 다시 시작합니다.</span><br/>
<div style='text-align:right;margin-top:24px;font-size:18px;color:#232946;font-weight:700;'>발기인: Ben<br/>2025년 5월 21일</div>`},th:{title:"เราเป็นใคร",subtitle:"🧬 Restarter™｜เราเป็นใคร",story:`${ho.th}
คุณอาจมาจากความสูญเสียครั้งใหญ่ หรือกำลังเดินอยู่บนเส้นทางที่โดดเดี่ยว
ในโลกที่เต็มไปด้วยป้ายและข้อมูล เรารู้ว่าบางความรู้สึกไม่ได้แค่พูดว่า "สู้ๆ" แล้วจะดีขึ้น

Restarter™ คือแพลตฟอร์ม AI สำหรับผู้ที่เคยหลงจังหวะชีวิต
เราไม่สอนให้คุณเข้มแข็ง ไม่บอกให้คุณคิดบวก
เราแค่ให้พื้นที่ที่คุณจะได้หายใจ พูดความจริง และเลือกใหม่อีกครั้ง

ที่นี่ไม่มีการตัดสินจากสังคม มีแต่คนที่เคยเจ็บปวดมาก่อน ใช้เทคโนโลยีสร้างการอยู่ร่วมกัน
ผ่าน AI ทุกบทสนทนา ทุกอารมณ์ จะมีคนรับฟังเสมอ`,quote:"“เราไม่ได้ซ่อมคุณ เราอยู่กับคุณเพื่อเริ่มต้นใหม่”",restart:"Restarter™ คือจุดเริ่มต้นใหม่ในการนิยามตัวเองของคุณ",founder:"คำจากผู้ก่อตั้ง",founderStory:`ฉันเคยสูญเสียอิสรภาพสิบปี<br/>
ไม่ใช่การเดินทางหรือการบำเพ็ญตน แต่เป็นสิบปีที่ถูกกฎหมายและโชคชะตากักขังไว้<br/>
ในห้องเล็ก ๆ กับผู้คนที่สวมชุดเหมือนกัน วันเวลาช่วงแรกเหมือนฝันยาว ๆ สุดท้ายแม้แต่ฝันก็ไม่มี ฉันคิดว่าชีวิตคงถูกกำหนดไว้แล้ว<br/><br/>
วันที่ออกมา ท้องฟ้าสีเทาจนแสบตา ฉันยิ้มออกมาแต่ในใจว่างเปล่า<br/>
สังคมไม่ได้รอคุณ ครอบครัวไม่รู้จะรับมืออย่างไร เพื่อน ๆ ก็ทักทายด้วยความห่างเหิน<br/>
หลายครั้งฉันไม่กล้ามองตาแคชเชียร์ เพราะ<span style='color:#e4572e;font-weight:700;'>ฉันลืมไปแล้วว่าต้องเป็น "คนธรรมดา" อย่างไร</span><br/><br/>
ฉันถามตัวเองเสมอว่า:<br/>
<span style='color:#614425;font-weight:900;'>ฉันยังมีโอกาสเริ่มต้นใหม่อีกไหม?</span><br/><br/>
ต่อมาฉันจึงเข้าใจ——<br/>
<span style='color:#e4572e;font-weight:900;'>ไม่ใช่โลกที่ไม่ให้โอกาส แต่เราเองที่ลืมวิธีเอื้อมมือคว้า</span><br/><br/>
นี่คือเหตุผลที่ <span style='color:#6B5BFF;font-weight:900;'>Restarter™</span> มีอยู่<br/>
ไม่ใช่เพื่อซ่อมคุณ ไม่ใช่เพื่อบอกให้ "สู้ ๆ"<br/>
แต่เพื่อให้คุณมีพื้นที่ค่อย ๆ สร้างตัวเองขึ้นใหม่<br/>
ให้คุณได้เปล่งเสียงในความสูญเสีย และมีใครสักคนรับฟังในความสับสน<br/><br/>
<span style='color:#6B5BFF;font-weight:900;'>Restarter™</span> ไม่ใช่แค่เทคโนโลยี<br/>
แต่เป็นประกายไฟที่ฉันหยิบขึ้นมาจากก้นบึ้งของชีวิต<br/>
หวังว่าจะเป็นแสงสว่างให้คุณและอีกหลาย ๆ คน<br/><br/>
<span style='color:#614425;font-weight:900;'>ไม่ว่าคุณจะเป็นใคร ผ่านอะไรมาก็ตาม มาจากที่ไหน—<br/>ที่นี่คุณสามารถถอดหน้ากากเหล่านั้นได้อย่างกล้าหาญ</span><br/>
เพราะเราเชื่อว่า——<br/>
<span style='color:#e4572e;font-weight:900;'>"คนที่เคยแตกสลาย ไม่เพียงแต่จะแข็งแกร่ง แต่ยังอ่อนโยนได้ด้วย"</span><br/><br/>
<span style='color:#6B5BFF;font-weight:900;'>เราไม่ได้ซ่อมคุณ เราอยู่กับคุณเพื่อเริ่มต้นใหม่</span><br/>
<div style='text-align:right;margin-top:24px;font-size:18px;color:#232946;font-weight:700;'>ผู้ก่อตั้ง: Ben<br/>21 พฤษภาคม 2025</div>`},vi:{title:"Chúng tôi là ai",subtitle:"🧬 Restarter™｜Chúng tôi là ai",story:`${ho.vi}
Bạn có thể đến từ một cú sốc lớn, hoặc đang đi trên con đường cô đơn
Trong thế giới bị chi phối bởi nhãn mác và dữ liệu, chúng tôi biết—có những cảm xúc không thể giải quyết chỉ bằng một câu "Cố lên"

Restarter™ là nền tảng AI đồng hành dành cho những người từng mất nhịp sống
Chúng tôi không dạy bạn cách mạnh mẽ, không bảo bạn phải tích cực
Chúng tôi chỉ mang đến một không gian để bạn được thở, được nói thật, được chọn lại

Ở đây không có phán xét xã hội, chỉ có những người từng đau đớn dùng công nghệ để đồng hành
Thông qua AI, mọi cuộc trò chuyện, mọi cảm xúc đều có người lắng nghe`,quote:"“Chúng tôi không sửa chữa bạn, chúng tôi đồng hành cùng bạn để bắt đầu lại”",restart:"Restarter™ là điểm khởi đầu mới để bạn định nghĩa lại chính mình",founder:"Lời người sáng lập",founderStory:`Tôi đã từng mất tự do mười năm<br/>
Không phải là đi du lịch hay tu hành, mà là mười năm bị pháp luật và số phận giam giữ<br/>
Trong một căn phòng nhỏ với những người cùng mặc đồng phục, ban đầu những ngày tháng như một giấc mơ dài, sau đó ngay cả mơ cũng không còn. Tôi nghĩ đời mình đã bị định nghĩa như thế.<br/><br/>
Ngày ra ngoài, bầu trời xám xịt chói mắt. Tôi mỉm cười bước ra, nhưng trong lòng trống rỗng.<br/>
Mặt trận không chờ bạn, gia đình không biết đối diện ra sao, bạn bè hỏi thăm cũng đầy khoảng cách.<br/>
Nhiều lần tôi không dám nhìn thẳng vào mắt thu ngân, vì <span style='color:#e4572e;font-weight:700;'>tôi đã quên cách làm "người bình thường"</span>.<br/><br/>
Tôi luôn tự hỏi:<br/>
<span style='color:#614425;font-weight:900;'>Liệu tôi còn cơ hội để bắt đầu lại không?</span><br/><br/>
Sau này tôi mới hiểu——<br/>
<span style='color:#e4572e;font-weight:900;'>Không phải thế giới không cho cơ hội, mà là chúng ta quên cách với lấy nó.</span><br/><br/>
Đó là lý do <span style='color:#6B5BFF;font-weight:900;'>Restarter™</span> tồn tại<br/>
Không phải để sửa chữa bạn, không phải để luôn nói "cố lên"<br/>
mà là để cho bạn một không gian, một nơi để từ từ xây dựng lại chính mình<br/>
Để bạn có thể cất tiếng nói trong nỗi mất mát, và có người lắng nghe giữa hỗn loạn<br/><br/>
<span style='color:#6B5BFF;font-weight:900;'>Restarter™</span> không chỉ là sản phẩm công nghệ<br/>
mà là tia lửa tôi mang lên từ tận đáy cuộc đời mình<br/>
Tôi hy vọng nó sẽ thắp sáng cho bạn, và cho nhiều người khác<br/><br/>
<span style='color:#614425;font-weight:900;'>Dù bạn là ai, đã trải qua điều gì, đến từ đâu—<br/>ở đây bạn có thể mạnh dạn bỏ đi mọi lớp vỏ bọc</span><br/>
Bởi vì chúng tôi tin rằng——<br/>
<span style='color:#e4572e;font-weight:900;'>"Những người từng vỡ vụn không chỉ mạnh mẽ mà còn rất dịu dàng."</span><br/><br/>
<span style='color:#6B5BFF;font-weight:900;'>Chúng tôi không sửa chữa bạn, chúng tôi đồng hành cùng bạn để bắt đầu lại</span><br/>
<div style='text-align:right;margin-top:24px;font-size:18px;color:#232946;font-weight:700;'>Người sáng lập: Ben<br/>21/05/2025</div>`},ms:{title:"Siapa Kami",subtitle:"🧬 Restarter™｜Siapa Kami",story:`${ho.ms}
Anda mungkin datang dari kejatuhan besar, atau sedang berjalan di jalan yang sunyi
Dalam dunia yang dikuasai label dan data, kami tahu—ada perasaan yang tidak dapat diselesaikan hanya dengan "semangat"

Restarter™ ialah platform AI teman untuk mereka yang pernah kehilangan rentak hidup
Kami tidak mengajar anda menjadi kuat, tidak menyuruh anda sentiasa positif
Kami hanya menyediakan ruang untuk anda bernafas, berkata benar, dan memilih semula

Di sini tiada penghakiman masyarakat, hanya mereka yang pernah sakit menggunakan teknologi untuk menemani
Melalui AI, setiap perbualan, setiap emosi, sentiasa ada yang mendengar`,quote:"“Kami bukan untuk membaiki anda, kami bersama anda untuk bermula semula”",restart:"Restarter™ ialah permulaan baru untuk anda mentakrifkan diri sendiri",founder:"Kata Pengasas",founderStory:`Saya pernah kehilangan kebebasan selama sepuluh tahun<br/>
Bukan melancong atau bertapa, tetapi sepuluh tahun dikurung oleh undang-undang dan takdir<br/>
Dalam bilik kecil bersama mereka yang berpakaian seragam sama, initio dies ut somnium longum, postea ne somnia quidem. Putavi vitam meam ita definitam esse.<br/><br/>
Die exeundi, caelum erat oculis acerrime cinereum. Ridebam egrediens, sed cor vacuum erat.<br/>
Societas non exspectabat, familia nesciebat quomodo me exciperet, amici quoque salutationes longinquae erant.<br/>
Saepe ne oculos quidem ad tabernarii aspicere audebam, quia <span style='color:#e4572e;font-weight:700;'>oblitus sum quomodo "homo communis" essem</span>.<br/><br/>
Me semper interrogabam:<br/>
<span style='color:#614425;font-weight:900;'>Adakah saya masih berpeluang untuk bermula semula?</span><br/><br/>
Akhirnya saya faham——<br/>
<span style='color:#e4572e;font-weight:900;'>Bukan dunia tidak memberi peluang, tetapi kita yang lupa cara untuk menggapainya.</span><br/><br/>
Itulah sebabnya <span style='color:#6B5BFF;font-weight:900;'>Restarter™</span> wujud<br/>
Bukan untuk membaiki anda, bukan untuk sentiasa berkata "semangat"<br/>
tetapi untuk memberi anda ruang, satu wadah untuk perlahan-lahan membina semula diri<br/>
Agar anda boleh bersuara dalam kehilangan, dan ada yang menyambut anda dalam kekacauan<br/><br/>
<span style='color:#6B5BFF;font-weight:900;'>Restarter™</span> bukan sekadar produk teknologi<br/>
tetapi percikan api yang saya bawa dari dasar hidup saya<br/>
Saya harap ia dapat menerangi anda, dan ramai lagi<br/><br/>
<span style='color:#614425;font-weight:900;'>Siapa pun anda, apa pun yang anda lalui, dari mana pun anda datang—<br/>di sini anda boleh berani melepaskan semua topeng itu</span><br/>
Kerana kami percaya——<br/>
<span style='color:#e4572e;font-weight:900;'>"Orang yang pernah hancur bukan sahaja boleh menjadi kuat, tetapi juga sangat lembut."</span><br/><br/>
<span style='color:#6B5BFF;font-weight:900;'>Kami bukan untuk membaiki anda, kami bersama anda untuk bermula semula</span><br/>
<div style='text-align:right;margin-top:24px;font-size:18px;color:#232946;font-weight:700;'>Pengasas: Ben<br/>21 Mei 2025</div>`},la:{title:"Quis sumus",subtitle:"🧬 Restarter™｜Quis sumus",story:`${ho.la}
Forsitan ex gravi casu veneris, aut solus iter facias
In mundo titulis et notitiis imperato, scimus—sunt animi motus quos "bene age" solvere non potest

Restarter™ est suggestum AI comitans iis qui cursum vitae amiserunt
Non docemus quomodo fortis fias, nec dicimus te semper positivum esse
Praebemus tantum spatium ut respirare possis, vera loqui, iterum eligere

Hic iudicium societatis non est, sed ii qui olim doluerunt technologia utuntur ad comitatum
Per AI, omnis sermo, omnis affectus, ab aliquo auditur`,quote:"“Non te reficimus, sed tecum iterum incipimus”",restart:"Restarter™ initium novum est ad te ipsum denuo definiendum",founder:"Verba Conditoris",founderStory:`Decem annos libertatem amisi<br/>
Non iter aut meditatio erat, sed decem anni lege et fato inclusi<br/>
In cella parva cum aliis eiusdem vestis, initio dies ut somnium longum, postea ne somnia quidem. Putavi vitam meam ita definitam esse.<br/><br/>
Die exeundi, caelum erat oculis acerrime cinereum. Ridebam egrediens, sed cor vacuum erat.<br/>
Societas non exspectabat, familia nesciebat quomodo me exciperet, amici quoque salutationes longinquae erant.<br/>
Saepe ne oculos quidem ad tabernarii aspicere audebam, quia <span style='color:#e4572e;font-weight:700;'>oblitus sum quomodo "homo communis" essem</span>.<br/><br/>
Me semper interrogabam:<br/>
<span style='color:#614425;font-weight:900;'>Num adhuc mihi occasio est iterum incipere?</span><br/><br/>
Postea intellexi——<br/>
<span style='color:#e4572e;font-weight:900;'>Non est quod mundus occasiones non praebeat, sed quod obliti sumus quomodo eas arripere.</span><br/><br/>
Hoc est cur <span style='color:#6B5BFF;font-weight:900;'>Restarter™</span> existat<br/>
Non ut te reficiamus, non ut semper dicamus "bene age"<br/>
sed ut tibi spatium demus, vas in quo te paulatim reficere possis<br/>
Ut in amissione tua loqui possis, et aliquis in confusione te excipiat<br/><br/>
<span style='color:#6B5BFF;font-weight:900;'>Restarter™</span> non solum productum technologicum est<br/>
sed scintilla quam ex imis vitae meae attuli<br/>
Spero eam tibi et multis aliis lucem afferre<br/><br/>
<span style='color:#614425;font-weight:900;'>Quisquis es, quidquid expertus es, undeque venis—<br/>hic audacter omnes personas deponere potes</span><br/>
Quia credimus——<br/>
<span style='color:#e4572e;font-weight:900;'>"Qui fracti sunt, non solum fortes esse possunt, sed etiam valde mites."</span><br/><br/>
<span style='color:#6B5BFF;font-weight:900;'>Non te reficimus, sed tecum iterum incipimus</span><br/>
<div style='text-align:right;margin-top:24px;font-size:18px;color:#232946;font-weight:700;'>Conditor: Ben<br/>21 Maii 2025</div>`}},hk={"zh-TW":"返回","zh-CN":"返回",en:"Back",ja:"戻る",ko:"돌아가기",th:"กลับ",vi:"Quay lại",ms:"Kembali",la:"Redi"};function z3(){const[n,e]=v.useState(localStorage.getItem("lang")||"zh-TW");v.useEffect(()=>{const o=()=>e(localStorage.getItem("lang")||"zh-TW");return window.addEventListener("storage",o),()=>window.removeEventListener("storage",o)},[]),v.useEffect(()=>{const o=setInterval(()=>{const a=localStorage.getItem("lang")||"zh-TW";a!==n&&e(a)},300);return()=>clearInterval(o)},[n]);const t=F3[n],r=Et();return i.jsxs("div",{style:{minHeight:"100vh",background:"linear-gradient(135deg, #b7cfff 0%, #e0e7ff 100%)",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"flex-start",padding:"48px 0 0 0"},children:[i.jsx("button",{onClick:()=>r("/"),style:{position:"absolute",top:24,left:24,zIndex:10,background:"#fff",border:"2.5px solid #6B5BFF",color:"#6B5BFF",borderRadius:12,padding:"10px 28px",fontWeight:900,fontSize:20,cursor:"pointer",boxShadow:"0 2px 8px #0001",letterSpacing:1},children:hk[n]||hk["zh-TW"]}),i.jsxs("div",{style:{maxWidth:680,background:"#fff",borderRadius:18,boxShadow:"0 2px 16px #6B5BFF22",padding:40,marginTop:48},children:[i.jsx("h1",{style:{fontSize:36,fontWeight:900,color:"#6B5BFF",marginBottom:12},children:t.subtitle}),i.jsx("div",{style:{fontSize:20,color:"#232946",fontWeight:700,marginBottom:24,whiteSpace:"pre-line"},children:t.story}),i.jsx("div",{style:{fontSize:22,color:"#614425",fontWeight:900,margin:"24px 0 8px 0",textAlign:"center"},children:t.quote}),i.jsx("div",{style:{fontSize:18,color:"#232946",fontWeight:700,marginBottom:32,textAlign:"center"},children:t.restart}),i.jsx("h2",{style:{fontSize:22,color:"#6B5BFF",fontWeight:900,marginBottom:8},children:t.founder}),i.jsx("div",{style:{fontSize:18,color:"#232946",fontWeight:500,whiteSpace:"pre-line"},dangerouslySetInnerHTML:{__html:t.founderStory}})]}),i.jsx("div",{style:{width:"100%",margin:"0 auto",marginTop:24,background:"rgba(255,255,255,0.95)",borderRadius:16,padding:"16px",boxShadow:"0 2px 12px #6B5BFF22"},children:i.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:20,flexWrap:"wrap"},children:[i.jsx("a",{href:"/privacy-policy",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12},children:n==="zh-TW"?"隱私權政策":n==="zh-CN"?"隐私政策":n==="en"?"Privacy Policy":n==="ja"?"プライバシーポリシー":n==="ko"?"개인정보 처리방침":n==="th"?"นโยบายความเป็นส่วนตัว":n==="vi"?"Chính sách bảo mật":n==="ms"?"Dasar Privasi":"Consilium de Privata"}),i.jsx("a",{href:"/terms",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12},children:n==="zh-TW"?"條款/聲明":n==="zh-CN"?"条款/声明":n==="en"?"Terms/Statement":n==="ja"?"規約/声明":n==="ko"?"약관/성명":n==="th"?"ข้อกำหนด/แถลงการณ์":n==="vi"?"Điều khoản/Tuyên bố":n==="ms"?"Terma/Pernyataan":"Termini/Declaratio"}),i.jsx("a",{href:"/data-deletion",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12},children:n==="zh-TW"?"資料刪除說明":n==="zh-CN"?"数据删除说明":n==="en"?"Data Deletion":n==="ja"?"データ削除について":n==="ko"?"데이터 삭제 안내":n==="th"?"คำอธิบายการลบข้อมูล":n==="vi"?"Giải thích xóa dữ liệu":n==="ms"?"Penjelasan Penghapusan Data":"Explicatio Deletionis Datae"}),i.jsx("a",{href:"/about",style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12},children:n==="zh-TW"?"🧬 Restarter™｜我們是誰":n==="zh-CN"?"🧬 Restarter™｜我们是谁":n==="en"?"🧬 Restarter™｜Who We Are":n==="ja"?"🧬 Restarter™｜私たちについて":n==="ko"?"🧬 Restarter™｜우리는 누구인가":n==="th"?"🧬 Restarter™｜เราเป็นใคร":n==="vi"?"🧬 Restarter™｜Chúng tôi là ai":n==="ms"?"🧬 Restarter™｜Siapa Kami":"🧬 Restarter™｜Quis sumus"}),i.jsx("a",{href:"/feedback",style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12},children:n==="zh-TW"?"💬 意見箱｜我們想聽你說":n==="zh-CN"?"💬 意见箱｜我们想听你说":n==="en"?"💬 Feedback Box｜We Want to Hear From You":n==="ja"?"💬 ご意見箱｜私たちはあなたの声を聞きたい":n==="ko"?"💬 피드백｜우리는 당신의 말을 듣고 싶습니다":n==="th"?"💬 กล่องความคิดเห็น｜เราอยากได้ยินจากคุณ":n==="vi"?"💬 Hộp góp ý｜Chúng tôi muốn nghe từ bạn":n==="ms"?"💬 Kotak Maklum Balas｜Kami Ingin Mendengar Dari Anda":"💬 Arca Consilii｜Volumus Audire a Te"})]})})]})}const pk={"zh-TW":["💡 你希望多一個什麼功能？","💬 有沒有讓你感動，或失望的使用時刻？","🔧 你覺得哪裡還不夠順、不夠暖、不夠真？","今天我想說...","如果我能改一件事，我會..."],"zh-CN":["💡 你希望多一个什么功能？","💬 有没有让你感动，或失望的使用时刻？","🔧 你觉得哪里还不够顺、不够暖、不够真？","今天我想说...","如果我能改一件事，我会..."],en:["💡 What feature do you wish for?","💬 Any moment that moved or disappointed you?","🔧 Where could we be smoother, warmer, or more real?","Today I want to say...","If I could change one thing, I would..."],ja:["💡 どんな機能が欲しいですか？","💬 感動した、またはがっかりした瞬間はありますか？","🔧 どこがもっとスムーズで、温かく、リアルになれると思いますか？","今日はこう言いたい...","もし一つ変えられるなら、私は..."],ko:["💡 어떤 기능이 더 있었으면 하나요?","💬 감동하거나 실망했던 순간이 있나요?","🔧 어디가 더 부드럽고, 따뜻하고, 진실해질 수 있을까요?","오늘 나는 이렇게 말하고 싶어요...","만약 한 가지를 바꿀 수 있다면, 나는..."],th:["💡 คุณอยากได้ฟีเจอร์อะไรเพิ่ม?","💬 มีช่วงเวลาไหนที่คุณประทับใจหรือผิดหวังไหม?","🔧 ตรงไหนที่คุณคิดว่ายังไม่ลื่นไหล ไม่อบอุ่น หรือไม่จริงใจ?","วันนี้ฉันอยากพูดว่า...","ถ้าฉันเปลี่ยนอะไรได้สักอย่าง ฉันจะ..."],vi:["💡 Bạn muốn có thêm tính năng gì?","💬 Có khoảnh khắc nào khiến bạn cảm động hoặc thất vọng không?","🔧 Bạn nghĩ chỗ nào chưa đủ mượt, chưa đủ ấm, chưa đủ thật?","Hôm nay tôi muốn nói...","Nếu tôi có thể thay đổi một điều, tôi sẽ..."],ms:["💡 Apa ciri yang anda inginkan?","💬 Ada detik yang menyentuh atau mengecewakan anda?","🔧 Di mana yang anda rasa belum cukup lancar, hangat, atau benar?","Hari ini saya ingin berkata...","Jika saya boleh ubah satu perkara, saya akan..."],la:["💡 Quam rem novam optas?","💬 Estne momentum quod te movit aut destituit?","🔧 Ubi putas nondum satis lenem, calidum, verum esse?","Hodie dicere volo...","Si unum mutare possem, id facerem..."]},fk={"zh-TW":{title:"💬 意見箱｜我們想聽你說",submit:"送出",success:"我們聽見你了，感謝你願意說出來。",subtitle:"你的建議，可能會成為下一版的靈魂！"},"zh-CN":{title:"💬 意见箱｜我们想听你说",submit:"提交",success:"我们听见你了，感谢你愿意说出来。",subtitle:"你的建议，可能会成为下一个版本的灵魂！"},en:{title:"💬 Feedback｜We Want to Hear You",submit:"Send",success:"We hear you. Thank you for sharing your thoughts.",subtitle:"Your suggestion could be the soul of our next update!"},ja:{title:"💬 ご意見箱｜あなたの声を聞かせて",submit:"送信",success:"あなたの声が届きました。伝えてくれてありがとう。",subtitle:"あなたの提案が次のアップデートの魂になるかも！"},ko:{title:"💬 의견함｜당신의 이야기를 듣고 싶어요",submit:"보내기",success:"당신의 목소리를 들었습니다. 말해줘서 고마워요.",subtitle:"당신의 제안이 다음 업데이트의 영혼이 될 수 있어요!"},th:{title:"💬 กล่องความคิดเห็น｜เราอยากฟังคุณ",submit:"ส่ง",success:"เราได้รับข้อความของคุณแล้ว ขอบคุณที่แบ่งปันความคิดของคุณ",subtitle:"ข้อเสนอของคุณอาจเป็นหัวใจของอัปเดตถัดไป!"},vi:{title:"💬 Hộp góp ý｜Chúng tôi muốn lắng nghe bạn",submit:"Gửi",success:"Chúng tôi đã nghe bạn. Cảm ơn bạn đã chia sẻ.",subtitle:"Góp ý của bạn có thể là linh hồn của bản cập nhật tiếp theo!"},ms:{title:"💬 Kotak Maklum Balas｜Kami ingin mendengar anda",submit:"Hantar",success:"Kami telah mendengar anda. Terima kasih kerana berkongsi.",subtitle:"Cadangan anda mungkin menjadi jiwa kemas kini kami yang seterusnya!"},la:{title:"💬 Arca Consilii｜Te audire volumus",submit:"Mitte",success:"Te audivimus. Gratias quod communicasti.",subtitle:"Consilium tuum animam versionis proximæ efficere potest!"}};function D3(){const n=Et(),e=St(),[t,r]=v.useState(""),[o,a]=v.useState(!1),[c,d]=v.useState(!1),[h,m]=v.useState(""),[g,x]=v.useState("zh-TW"),[S,j]=v.useState(0),T=fk[g]||fk["zh-TW"];v.useEffect(()=>{const I=()=>x(localStorage.getItem("lang")||"zh-TW");return I(),window.addEventListener("storage",I),()=>window.removeEventListener("storage",I)},[]),v.useEffect(()=>{const I=setInterval(()=>{j(F=>(F+1)%pk[g].length)},3e3);return()=>clearInterval(I)},[g]);const R=async()=>{if(t.trim()){d(!0),m("");try{const I=e.currentUser,F=await fetch("/api/feedback",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:t.trim(),userEmail:(I==null?void 0:I.email)||"",userNickname:(I==null?void 0:I.displayName)||"匿名",userLang:g})}),P=await F.json();F.ok?(a(!0),r("")):m(P.error||"提交失敗，請稍後再試")}catch{m("網路錯誤，請稍後再試")}finally{d(!1)}}};return i.jsxs("div",{style:{minHeight:"100vh",background:"linear-gradient(135deg, #e0e7ff 0%, #b7cfff 100%)",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"flex-start",padding:"48px 0 120px 0"},children:[i.jsx("button",{onClick:()=>n("/"),style:{position:"absolute",top:24,left:24,zIndex:10,background:"#fff",border:"1.5px solid #6B5BFF",color:"#6B5BFF",borderRadius:8,padding:"6px 18px",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:"0 2px 8px #0001"},children:"返回"}),i.jsxs("div",{style:{maxWidth:520,background:"#fff",borderRadius:18,boxShadow:"0 2px 16px #6B5BFF22",padding:40,marginTop:64,display:"flex",flexDirection:"column",alignItems:"center"},children:[i.jsx("h1",{style:{fontSize:32,fontWeight:900,color:"#6B5BFF",marginBottom:8},children:T.title}),i.jsx("div",{style:{fontSize:18,color:"#614425",fontWeight:700,marginBottom:18,textAlign:"center"},children:T.subtitle}),o?i.jsx("div",{style:{fontSize:22,color:"#614425",fontWeight:900,marginTop:32,textAlign:"center",minHeight:80},children:T.success}):i.jsxs(i.Fragment,{children:[i.jsx("textarea",{value:t,onChange:I=>r(I.target.value),placeholder:pk[g][S],style:{width:"100%",minHeight:160,fontSize:20,border:"none",outline:"none",resize:"vertical",background:"#f7f8fa",borderRadius:12,padding:18,marginBottom:18,boxShadow:"0 2px 8px #6B5BFF11"}}),h&&i.jsx("div",{style:{color:"#ff4d4f",fontSize:14,marginBottom:12,textAlign:"center"},children:h}),i.jsx("button",{onClick:R,style:{background:c?"#ccc":"#6B5BFF",color:"#fff",border:"none",borderRadius:8,padding:"12px 32px",fontWeight:900,fontSize:20,cursor:c?"not-allowed":"pointer",boxShadow:"0 2px 8px #6B5BFF33",marginTop:8},disabled:!t.trim()||c,children:c?"送出中...":T.submit})]})]}),i.jsx(iI,{})]})}const N3=()=>{const[n,e]=v.useState([]),[t,r]=v.useState(!0),[o,a]=v.useState(""),[c,d]=v.useState(""),[h,m]=v.useState(!1),g=async()=>{try{const j=await gn.get(`/api/admin-feedback?adminKey=${c}`);e(j.data.feedbacks),r(!1)}catch{a("取得意見列表失敗"),r(!1)}},x=()=>{c==="restarter_admin_2024"?(m(!0),g()):a("管理員密碼錯誤")},S=async()=>{try{const j=await gn.post("/api/admin-feedback/export",{adminKey:c});alert(`意見已匯出，共 ${j.data.totalExported} 條`)}catch{alert("匯出失敗")}};return h?i.jsx("div",{className:"min-h-screen bg-gradient-to-br from-purple-50 to-blue-50 p-4",children:i.jsx("div",{className:"max-w-6xl mx-auto",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[i.jsxs("div",{className:"flex justify-between items-center mb-6",children:[i.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:"意見管理系統"}),i.jsxs("div",{className:"space-x-4",children:[i.jsx("button",{onClick:g,className:"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 transition-colors",children:"重新整理"}),i.jsx("button",{onClick:S,className:"bg-green-600 text-white px-4 py-2 rounded-md hover:bg-green-700 transition-colors",children:"匯出意見"})]})]}),t?i.jsxs("div",{className:"text-center py-8",children:[i.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-600 mx-auto"}),i.jsx("p",{className:"mt-4 text-gray-600",children:"載入中..."})]}):o?i.jsx("div",{className:"text-center py-8",children:i.jsx("p",{className:"text-red-500",children:o})}):i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"text-sm text-gray-600 mb-4",children:["共 ",n.length," 條意見"]}),n.map(j=>i.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow",children:[i.jsxs("div",{className:"flex justify-between items-start mb-3",children:[i.jsxs("div",{children:[i.jsx("h3",{className:"font-semibold text-gray-800",children:j.userNickname||"匿名用戶"}),i.jsx("p",{className:"text-sm text-gray-500",children:j.userEmail||"未提供 Email"})]}),i.jsxs("div",{className:"text-right",children:[i.jsx("span",{className:"text-xs text-gray-500",children:j.timestamp}),i.jsx("div",{className:"mt-1",children:i.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${j.source==="local"?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"}`,children:j.source==="local"?"本地儲存":"Firebase"})})]})]}),i.jsx("div",{className:"bg-gray-50 rounded-md p-3 mb-3",children:i.jsx("p",{className:"text-gray-700 whitespace-pre-wrap",children:j.content})}),i.jsxs("div",{className:"flex justify-between items-center text-sm text-gray-500",children:[i.jsxs("span",{children:["語言: ",j.userLang]}),i.jsxs("span",{children:["狀態: ",j.status]})]}),j.adminNotes&&i.jsx("div",{className:"mt-3 p-3 bg-blue-50 rounded-md",children:i.jsxs("p",{className:"text-sm text-blue-800",children:[i.jsx("strong",{children:"管理員備註:"})," ",j.adminNotes]})})]},j.id)),n.length===0&&i.jsx("div",{className:"text-center py-8 text-gray-500",children:"目前沒有意見"})]})]})})}):i.jsx("div",{className:"min-h-screen bg-gradient-to-br from-purple-50 to-blue-50 flex items-center justify-center",children:i.jsxs("div",{className:"bg-white p-8 rounded-lg shadow-lg max-w-md w-full",children:[i.jsx("h1",{className:"text-2xl font-bold text-center mb-6 text-gray-800",children:"管理員登入"}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"管理員密碼"}),i.jsx("input",{type:"password",value:c,onChange:j=>d(j.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500",placeholder:"輸入管理員密碼"})]}),i.jsx("button",{onClick:x,className:"w-full bg-purple-600 text-white py-2 px-4 rounded-md hover:bg-purple-700 transition-colors",children:"登入"}),o&&i.jsx("p",{className:"text-red-500 text-sm text-center",children:o})]})]})})},M3={"zh-TW":"返回","zh-CN":"返回",en:"Back",ja:"戻る",ko:"뒤로",th:"กลับ",vi:"Quay lại",ms:"Kembali",la:"Revertere"};function L3(){const n=Et(),e=St(),t=e.currentUser,r=localStorage.getItem("lang")||"zh-TW";v.useEffect(()=>{t||n("/register",{replace:!0})},[t,n]);const[o,a]=v.useState((t==null?void 0:t.displayName)||""),[c]=v.useState((t==null?void 0:t.email)||""),[d,h]=v.useState((t==null?void 0:t.photoURL)||""),[m,g]=v.useState(""),[x,S]=v.useState(""),[j,T]=v.useState(""),[R,I]=v.useState(""),[F,P]=v.useState(""),[z,H]=v.useState(""),[J,O]=v.useState(""),[L,C]=v.useState(""),[A,D]=v.useState(!1);v.useEffect(()=>{let B=!1;const _=async()=>{B||(B=!0,await Er(e),n("/register?needProfile=1",{replace:!0}))},U=X=>{X.preventDefault(),X.returnValue="",_()},oe=X=>{var ce;(ce=X==null?void 0:X.preventDefault)==null||ce.call(X),_(),window.history.pushState(null,"","/CompleteProfile")};return window.addEventListener("beforeunload",U),window.addEventListener("popstate",oe),window.history.pushState(null,"","/CompleteProfile"),()=>{window.removeEventListener("beforeunload",U),window.removeEventListener("popstate",oe)}},[e,n]);const M=async B=>{if(B.preventDefault(),C(""),!o||!m||!x||!R||!F||!z||!J){C("請填寫所有欄位");return}D(!0);try{await Bd(Pn(Wt,"users",t.uid),{nickname:o,email:c,avatarUrl:d,gender:m,country:x,region:j,age:R,interest:F,eventType:z,improvement:J,completed:!0,updatedAt:new Date}),D(!1),n("/",{replace:!0})}catch(_){C(_.message),D(!1)}};return v.useEffect(()=>{(async()=>{if(t!=null&&t.uid){const _=await vc(()=>Promise.resolve().then(()=>of),void 0).then(U=>U.getDoc(U.doc(Wt,"users",t.uid)));_.exists()&&_.data().completed&&(await Er(e),n("/register",{replace:!0}))}})()},[t,e,n]),i.jsxs("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",background:"#f7f7fa",position:"relative"},children:[i.jsxs("button",{onClick:()=>n("/register",{replace:!0}),style:{position:"absolute",top:32,left:36,zIndex:10,backgroundColor:"#374151",color:"white",fontWeight:"bold",padding:"0.5rem 1rem",borderRadius:"0.375rem",border:"none",cursor:"pointer",fontSize:16},children:["← ",M3[r]||"返回"]}),i.jsxs("form",{onSubmit:M,style:{background:"#fff",borderRadius:16,padding:32,boxShadow:"0 4px 24px #0001",width:360,position:"relative"},children:[i.jsx("button",{type:"button",onClick:async()=>{await Er(e),n("/register?needProfile=1",{replace:!0})},style:{position:"absolute",top:16,right:16,background:"none",border:"none",fontSize:22,color:"#888",cursor:"pointer"},children:"×"}),i.jsx("h2",{style:{textAlign:"center",marginBottom:16},children:"補充個人資料"}),L&&i.jsx("div",{style:{color:"red",marginBottom:12},children:L}),i.jsxs("div",{style:{marginBottom:12},children:[i.jsx("label",{children:"暱稱："}),i.jsx("input",{value:o,onChange:B=>a(B.target.value),required:!0,style:{width:"100%"}})]}),i.jsxs("div",{style:{marginBottom:12},children:[i.jsx("label",{children:"電子郵件："}),i.jsx("input",{value:c,disabled:!0,style:{width:"100%",background:"#eee"}})]}),i.jsxs("div",{style:{marginBottom:12},children:[i.jsx("label",{children:"頭像網址："}),i.jsx("input",{value:d,onChange:B=>h(B.target.value),style:{width:"100%"}})]}),i.jsxs("div",{style:{marginBottom:12},children:[i.jsx("label",{children:"性別："}),i.jsxs("select",{value:m,onChange:B=>g(B.target.value),required:!0,style:{width:"100%"},children:[i.jsx("option",{value:"",children:"請選擇"}),i.jsx("option",{value:"male",children:"男"}),i.jsx("option",{value:"female",children:"女"})]})]}),i.jsxs("div",{style:{marginBottom:12},children:[i.jsx("label",{children:"國家/地區："}),i.jsxs("select",{value:x,onChange:B=>S(B.target.value),required:!0,style:{width:"100%"},children:[i.jsx("option",{value:"",children:"請選擇"}),(BI["zh-TW"]||[]).map(B=>i.jsx("option",{value:B,children:B},B))]})]}),i.jsxs("div",{style:{marginBottom:12},children:[i.jsx("label",{children:"城市："}),i.jsx("input",{value:j,onChange:B=>T(B.target.value),style:{width:"100%"}})]}),i.jsxs("div",{style:{marginBottom:12},children:[i.jsx("label",{children:"年齡："}),i.jsxs("select",{value:R,onChange:B=>I(B.target.value),required:!0,style:{width:"100%"},children:[i.jsx("option",{value:"",children:"請選擇"}),zI.map(B=>i.jsx("option",{value:B,children:B},B))]})]}),i.jsxs("div",{style:{marginBottom:12},children:[i.jsx("label",{children:"興趣："}),i.jsxs("select",{value:F,onChange:B=>P(B.target.value),required:!0,style:{width:"100%"},children:[i.jsx("option",{value:"",children:"請選擇"}),(PI["zh-TW"]||[]).map(B=>i.jsx("option",{value:B,children:B},B))]})]}),i.jsxs("div",{style:{marginBottom:12},children:[i.jsx("label",{children:"事件類別："}),i.jsxs("select",{value:z,onChange:B=>H(B.target.value),required:!0,style:{width:"100%"},children:[i.jsx("option",{value:"",children:"請選擇"}),(FI["zh-TW"]||[]).map(B=>i.jsx("option",{value:B,children:B},B))]})]}),i.jsxs("div",{style:{marginBottom:12},children:[i.jsx("label",{children:"想改善什麼："}),i.jsx("input",{value:J,onChange:B=>O(B.target.value),required:!0,style:{width:"100%"}})]}),i.jsx("button",{type:"submit",disabled:A,style:{width:"100%",padding:10,fontWeight:700,fontSize:18,background:"#4caf50",color:"#fff",border:"none",borderRadius:8},children:A?"儲存中...":"完成"})]})]})}const O3={"zh-TW":"返回","zh-CN":"返回",en:"Back",ja:"戻る",ko:"뒤로",th:"กลับ",vi:"Quay lại",ms:"Kembali",la:"Revertere"},mk={"zh-TW":i.jsxs("div",{children:[i.jsx("h1",{children:"Restarter™ App 隱私權政策"}),i.jsx("p",{children:"本應用程式由 Restarter™ 團隊開發，致力於保護您的個人資料與隱私權。本政策說明我們如何收集、使用、儲存、保護及分享您的個人資料，並說明您對於個人資料的權利。"}),i.jsx("h2",{children:"一、我們收集的資料"}),i.jsxs("ul",{children:[i.jsx("li",{children:"電子郵件地址（Email）"}),i.jsx("li",{children:"使用者名稱/暱稱"}),i.jsx("li",{children:"頭像（如有上傳）"}),i.jsx("li",{children:"性別、年齡、國家/地區、城市（如用戶自願填寫）"}),i.jsx("li",{children:"興趣、經歷事件、個人描述等自願填寫的資料"}),i.jsx("li",{children:"登入紀錄、操作紀錄（僅用於安全與服務優化）"})]}),i.jsx("h2",{children:"二、資料用途"}),i.jsxs("ul",{children:[i.jsx("li",{children:"用於身份驗證、帳號管理與個人化服務"}),i.jsx("li",{children:"用於社群互動、配對、任務、花園等功能"}),i.jsx("li",{children:"用於服務安全、錯誤偵測與防止濫用"}),i.jsx("li",{children:"用於統計分析與產品優化（僅以匿名方式）"}),i.jsx("li",{children:"不會將您的個人資料出售、出租或未經授權分享給第三方"})]}),i.jsx("h2",{children:"三、第三方服務"}),i.jsxs("p",{children:["本應用程式使用 Google Firebase 作為後端服務平台，Firebase 可能會根據其 ",i.jsx("a",{href:"https://firebase.google.com/support/privacy",target:"_blank",rel:"noopener noreferrer",children:"隱私政策"})," 處理技術資料（如裝置資訊、IP、操作紀錄等）。"]}),i.jsx("p",{children:"如您使用 Google、Apple、Facebook 等第三方帳號登入，僅會取得必要的公開資訊（如 email、暱稱、頭像），不會取得您的密碼。"}),i.jsx("h2",{children:"四、Cookie 與追蹤技術"}),i.jsx("p",{children:"本應用程式可能使用 Cookie 或類似技術以提升用戶體驗與安全性。您可於瀏覽器設定中管理 Cookie 偏好。"}),i.jsx("h2",{children:"五、資料儲存與保護"}),i.jsxs("ul",{children:[i.jsx("li",{children:"所有個人資料均儲存於 Google Firebase 雲端，並採用業界標準的加密與安全措施。"}),i.jsx("li",{children:"僅授權人員可存取您的個人資料，且僅限於服務維護與法規要求。"})]}),i.jsx("h2",{children:"六、您的權利"}),i.jsxs("ul",{children:[i.jsx("li",{children:"您有權查詢、更正、下載或刪除您的個人資料。"}),i.jsx("li",{children:"您可隨時於 App 內或來信要求刪除帳號與所有資料，我們將於 3-5 個工作天內完成。"}),i.jsxs("li",{children:["聯絡信箱：",i.jsx("a",{href:"mailto:rbben521@gmail.com",children:"rbben521@gmail.com"})]})]}),i.jsx("h2",{children:"七、政策變更"}),i.jsx("p",{children:"如本政策有重大變更，將於 App 內公告並更新本頁內容。"})]}),"zh-CN":i.jsxs("div",{children:[i.jsx("h1",{children:"Restarter™ App 隐私政策"}),i.jsx("p",{children:"本应用程序由 Restarter™ 团队开发，致力于保护您的个人资料与隐私权。本政策说明我们如何收集、使用、存储、保护及分享您的个人资料，并说明您对于个人资料的权利。"}),i.jsx("h2",{children:"一、我们收集的资料"}),i.jsxs("ul",{children:[i.jsx("li",{children:"电子邮件地址（Email）"}),i.jsx("li",{children:"用户名/昵称"}),i.jsx("li",{children:"头像（如有上传）"}),i.jsx("li",{children:"性别、年龄、国家/地区、城市（如用户自愿填写）"}),i.jsx("li",{children:"兴趣、经历事件、个人描述等自愿填写的资料"}),i.jsx("li",{children:"登录记录、操作记录（仅用于安全与服务优化）"})]}),i.jsx("h2",{children:"二、资料用途"}),i.jsxs("ul",{children:[i.jsx("li",{children:"用于身份验证、账号管理与个性化服务"}),i.jsx("li",{children:"用于社群互动、配对、任务、花园等功能"}),i.jsx("li",{children:"用于服务安全、错误检测与防止滥用"}),i.jsx("li",{children:"用于统计分析与产品优化（仅以匿名方式）"}),i.jsx("li",{children:"不会将您的个人资料出售、出租或未经授权分享给第三方"})]}),i.jsx("h2",{children:"三、第三方服务"}),i.jsxs("p",{children:["本应用程序使用 Google Firebase 作为后端服务平台，Firebase 可能会根据其 ",i.jsx("a",{href:"https://firebase.google.com/support/privacy",target:"_blank",rel:"noopener noreferrer",children:"隐私政策"})," 处理技术资料（如设备信息、IP、操作记录等）。"]}),i.jsx("p",{children:"如您使用 Google、Apple、Facebook 等第三方账号登录，仅会取得必要的公开信息（如 email、昵称、头像），不会取得您的密码。"}),i.jsx("h2",{children:"四、Cookie 与追踪技术"}),i.jsx("p",{children:"本应用程序可能使用 Cookie 或类似技术以提升用户体验与安全性。您可于浏览器设置中管理 Cookie 偏好。"}),i.jsx("h2",{children:"五、资料存储与保护"}),i.jsxs("ul",{children:[i.jsx("li",{children:"所有个人资料均存储于 Google Firebase 云端，并采用业界标准的加密与安全措施。"}),i.jsx("li",{children:"仅授权人员可存取您的个人资料，且仅限于服务维护与法规要求。"})]}),i.jsx("h2",{children:"六、您的权利"}),i.jsxs("ul",{children:[i.jsx("li",{children:"您有权查询、更正、下载或删除您的个人资料。"}),i.jsx("li",{children:"您可随时于 App 内或来信要求删除账号与所有资料，我们将于 3-5 个工作天内完成。"}),i.jsxs("li",{children:["联系邮箱：",i.jsx("a",{href:"mailto:rbben521@gmail.com",children:"rbben521@gmail.com"})]})]}),i.jsx("h2",{children:"七、政策变更"}),i.jsx("p",{children:"如本政策有重大变更，将于 App 内公告并更新本页内容。"})]}),en:i.jsxs("div",{children:[i.jsx("h1",{children:"Privacy Policy for Restarter™ App"}),i.jsx("p",{children:"Restarter™ is committed to protecting your privacy. This policy explains how we collect, use, store, and protect your personal information, and your rights regarding your data."}),i.jsx("h2",{children:"1. Information We Collect"}),i.jsxs("ul",{children:[i.jsx("li",{children:"Email address"}),i.jsx("li",{children:"Username/Nickname"}),i.jsx("li",{children:"Avatar (if uploaded)"}),i.jsx("li",{children:"Gender, age, country/region, city (if provided)"}),i.jsx("li",{children:"Interests, life events, personal description (if provided)"}),i.jsx("li",{children:"Login and activity logs (for security and service improvement)"})]}),i.jsx("h2",{children:"2. Purpose of Collection"}),i.jsxs("ul",{children:[i.jsx("li",{children:"Authentication, account management, and personalized services"}),i.jsx("li",{children:"Community interaction, matching, missions, garden features"}),i.jsx("li",{children:"Service security, error detection, and abuse prevention"}),i.jsx("li",{children:"Statistical analysis and product improvement (anonymized)"}),i.jsx("li",{children:"We do not sell, rent, or share your personal data with third parties without your consent"})]}),i.jsx("h2",{children:"3. Third-Party Services"}),i.jsxs("p",{children:["This app uses Google Firebase as its backend. Firebase may process technical data according to its ",i.jsx("a",{href:"https://firebase.google.com/support/privacy",target:"_blank",rel:"noopener noreferrer",children:"Privacy Policy"})," (e.g., device info, IP, activity logs)."]}),i.jsx("p",{children:"If you log in via Google, Apple, or Facebook, we only access your public info (email, nickname, avatar), never your password."}),i.jsx("h2",{children:"4. Cookies and Tracking"}),i.jsx("p",{children:"We may use cookies or similar technologies to enhance your experience and security. You can manage cookie preferences in your browser settings."}),i.jsx("h2",{children:"5. Data Storage and Protection"}),i.jsxs("ul",{children:[i.jsx("li",{children:"All personal data is stored on Google Firebase cloud with industry-standard encryption and security."}),i.jsx("li",{children:"Only authorized personnel can access your data, solely for service maintenance or legal compliance."})]}),i.jsx("h2",{children:"6. Your Rights"}),i.jsxs("ul",{children:[i.jsx("li",{children:"You have the right to access, correct, download, or delete your personal data."}),i.jsx("li",{children:"You may request account/data deletion at any time via the app or by email. We will process your request within 3-5 business days."}),i.jsxs("li",{children:["Contact: ",i.jsx("a",{href:"mailto:rbben521@gmail.com",children:"rbben521@gmail.com"})]})]}),i.jsx("h2",{children:"7. Policy Updates"}),i.jsx("p",{children:"We will notify users of major changes to this policy via in-app announcements and update this page accordingly."})]}),ja:i.jsxs("div",{children:[i.jsx("h1",{children:"Restarter™ アプリ プライバシーポリシー"}),i.jsx("p",{children:"本アプリはRestarter™チームによって開発され、ユーザーの個人情報とプライバシーの保護に努めています。本ポリシーは、どのように個人情報を収集・利用・保存・保護・共有するか、またユーザーの権利について説明します。"}),i.jsx("h2",{children:"1. 収集する情報"}),i.jsxs("ul",{children:[i.jsx("li",{children:"メールアドレス"}),i.jsx("li",{children:"ユーザー名/ニックネーム"}),i.jsx("li",{children:"アバター（アップロードした場合）"}),i.jsx("li",{children:"性別、年齢、国/地域、都市（任意）"}),i.jsx("li",{children:"興味、経験イベント、自己紹介（任意）"}),i.jsx("li",{children:"ログイン・操作履歴（セキュリティ・サービス向上のため）"})]}),i.jsx("h2",{children:"2. 利用目的"}),i.jsxs("ul",{children:[i.jsx("li",{children:"認証、アカウント管理、パーソナライズサービス"}),i.jsx("li",{children:"コミュニティ交流、マッチング、ミッション、ガーデン機能"}),i.jsx("li",{children:"サービスの安全性、エラー検出、不正防止"}),i.jsx("li",{children:"統計分析・製品改善（匿名化）"}),i.jsx("li",{children:"同意なく第三者に個人情報を販売・共有しません"})]}),i.jsx("h2",{children:"3. サードパーティサービス"}),i.jsxs("p",{children:["本アプリはGoogle Firebaseをバックエンドとして使用しています。Firebaseは ",i.jsx("a",{href:"https://firebase.google.com/support/privacy",target:"_blank",rel:"noopener noreferrer",children:"プライバシーポリシー"})," に従い技術情報（デバイス情報、IP、操作履歴など）を処理する場合があります。"]}),i.jsx("p",{children:"Google、Apple、Facebook等でログインした場合、公開情報（メール、ニックネーム、アバター）のみ取得し、パスワードは取得しません。"}),i.jsx("h2",{children:"4. Cookieとトラッキング技術"}),i.jsx("p",{children:"本アプリはユーザー体験と安全性向上のため コッキー または類似技術を使用する場合があります。ブラウザ設定でCookieの管理が可能です。"}),i.jsx("h2",{children:"5. データ保存と保護"}),i.jsxs("ul",{children:[i.jsx("li",{children:"全ての個人情報はGoogle Firebaseクラウドに保存され、業界標準の暗号化とセキュリティで保護されます。"}),i.jsx("li",{children:"認可された担当者のみがサービス保守や法令遵守のためにアクセス可能です。"})]}),i.jsx("h2",{children:"6. ユーザーの権利"}),i.jsxs("ul",{children:[i.jsx("li",{children:"個人情報の照会、訂正、ダウンロード、削除が可能です。"}),i.jsx("li",{children:"アプリ内またはメールでいつでも削除依頼ができ、3～5営業日以内に対応します。"}),i.jsxs("li",{children:["連絡先：",i.jsx("a",{href:"mailto:rbben521@gmail.com",children:"rbben521@gmail.com"})]})]}),i.jsx("h2",{children:"7. ポリシーの変更"}),i.jsx("p",{children:"本ポリシーに重大な変更がある場合、アプリ内で告知し本ページを更新します。"})]}),ko:i.jsxs("div",{children:[i.jsx("h1",{children:"Restarter™ 앱 개인정보처리방침"}),i.jsx("p",{children:"본 앱은 Restarter™ 팀이 개발하였으며, 사용자의 개인정보와 프라이버시 보호에 최선을 다합니다. 본 정책은 개인정보의 수집, 이용, 저장, 보호, 공유 방법과 사용자의 권리에 대해 설명합니다."}),i.jsx("h2",{children:"1. 수집하는 정보"}),i.jsxs("ul",{children:[i.jsx("li",{children:"이메일 주소"}),i.jsx("li",{children:"사용자명/닉네임"}),i.jsx("li",{children:"아바타(업로드한 경우)"}),i.jsx("li",{children:"성별, 나이, 국가/지역, 도시(선택사항)"}),i.jsx("li",{children:"관심사, 경험 이벤트, 자기소개(선택사항)"}),i.jsx("li",{children:"로그인 및 활동 기록(보안 및 서비스 개선 목적)"})]}),i.jsx("h2",{children:"2. 수집 목적"}),i.jsxs("ul",{children:[i.jsx("li",{children:"인증, 계정 관리, 개인화 서비스"}),i.jsx("li",{children:"커뮤니티 상호작용, 매칭, 미션, 가든 기능"}),i.jsx("li",{children:"서비스 보안, 오류 탐지, 오용 방지"}),i.jsx("li",{children:"통계 분석 및 제품 개선(익명화)"}),i.jsx("li",{children:"동의 없이 제3자에게 개인정보를 판매, 임대, 공유하지 않습니다"})]}),i.jsx("h2",{children:"3. 제3자 서비스"}),i.jsxs("p",{children:["본 앱은 Google Firebase를 백엔드로 사용합니다. Firebase는 ",i.jsx("a",{href:"https://firebase.google.com/support/privacy",target:"_blank",rel:"noopener noreferrer",children:"개인정보처리방침"}),"에 따라 기술 정보를 처리할 수 있습니다(예: 기기 정보, IP, 활동 기록 등)."]}),i.jsx("p",{children:"Google, Apple, Facebook 등으로 로그인 시 공개 정보(이메일, 닉네임, 아바타)만 수집하며, 비밀번호는 수집하지 않습니다."}),i.jsx("h2",{children:"4. 쿠키 및 추적 기술"}),i.jsx("p",{children:"본 앱은 사용자 경험 및 보안 향상을 위해 쿠키 또는 유사 기술을 사용할 수 있습니다. 브라우저 설정에서 쿠키 환경설정이 가능합니다."}),i.jsx("h2",{children:"5. 데이터 저장 및 보호"}),i.jsxs("ul",{children:[i.jsx("li",{children:"모든 개인정보는 Google Firebase 클라우드에 저장되며, 업계 표준 암호화 및 보안이 적용됩니다."}),i.jsx("li",{children:"서비스 유지보수 및 법적 요구에 한해 인가된 인원만 접근할 수 있습니다."})]}),i.jsx("h2",{children:"6. 사용자의 권리"}),i.jsxs("ul",{children:[i.jsx("li",{children:"개인정보의 조회, 수정, 다운로드, 삭제가 가능합니다."}),i.jsx("li",{children:"앱 내 또는 이메일로 언제든 삭제 요청이 가능하며, 3~5영업일 이내에 처리됩니다."}),i.jsxs("li",{children:["연락처: ",i.jsx("a",{href:"mailto:rbben521@gmail.com",children:"rbben521@gmail.com"})]})]}),i.jsx("h2",{children:"7. 정책 변경"}),i.jsx("p",{children:"정책에 중대한 변경이 있을 경우 앱 내 공지 및 본 페이지를 업데이트합니다."})]}),th:i.jsxs("div",{children:[i.jsx("h1",{children:"นโยบายความเป็นส่วนตัวของแอป Restarter™"}),i.jsx("p",{children:"แอปนี้พัฒนาโดยทีมงาน Restarter™ มุ่งมั่นในการปกป้องข้อมูลส่วนบุคคลและความเป็นส่วนตัวของคุณ นโยบายนี้อธิบายวิธีการเก็บรวบรวม ใช้ จัดเก็บ ปกป้อง และแบ่งปันข้อมูลส่วนบุคคลของคุณ รวมถึงสิทธิ์ของคุณ"}),i.jsx("h2",{children:"1. ข้อมูลที่เราเก็บรวบรวม"}),i.jsxs("ul",{children:[i.jsx("li",{children:"ที่อยู่อีเมล"}),i.jsx("li",{children:"ชื่อผู้ใช้/ชื่อเล่น"}),i.jsx("li",{children:"อวาตาร์ (ถ้าอัปโหลด)"}),i.jsx("li",{children:"เพศ อายุ ประเทศ/ภูมิภาค เมือง (ถ้าระบุ)"}),i.jsx("li",{children:"ความสนใจ เหตุการณ์ในชีวิต คำอธิบายส่วนตัว (ถ้าระบุ)"}),i.jsx("li",{children:"บันทึกการเข้าสู่ระบบและกิจกรรม (เพื่อความปลอดภัยและปรับปรุงบริการ)"})]}),i.jsx("h2",{children:"2. วัตถุประสงค์ของการเก็บข้อมูล"}),i.jsxs("ul",{children:[i.jsx("li",{children:"การยืนยันตัวตน การจัดการบัญชี และบริการส่วนบุคคล"}),i.jsx("li",{children:"การมีปฏิสัมพันธ์ในชุมชน การจับคู่ ภารกิจ ฟีเจอร์สวน"}),i.jsx("li",{children:"ความปลอดภัยของบริการ การตรวจจับข้อผิดพลาด และป้องกันการละเมิด"}),i.jsx("li",{children:"การวิเคราะห์สถิติและปรับปรุงผลิตภัณฑ์ (แบบไม่ระบุตัวตน)"}),i.jsx("li",{children:"จะไม่ขาย ให้เช่า หรือแบ่งปันข้อมูลส่วนบุคคลของคุณกับบุคคลที่สามโดยไม่ได้รับความยินยอม"})]}),i.jsx("h2",{children:"3. บริการของบุคคลที่สาม"}),i.jsxs("p",{children:["แอปนี้ใช้ Google Firebase เป็นแบ็กเอนด์ Firebase อาจประมวลผลข้อมูลทางเทคนิคตาม ",i.jsx("a",{href:"https://firebase.google.com/support/privacy",target:"_blank",rel:"noopener noreferrer",children:"นโยบายความเป็นส่วนตัว"})," (เช่น ข้อมูลอุปกรณ์ IP บันทึกกิจกรรม)"]}),i.jsx("p",{children:"หากคุณเข้าสู่ระบบผ่าน Google, Apple หรือ Facebook เราจะเข้าถึงเฉพาะข้อมูลสาธารณะ (อีเมล ชื่อเล่น อวาตาร์) ไม่เคยเข้าถึงรหัสผ่านของคุณ"}),i.jsx("h2",{children:"4. คุกกี้และการติดตาม"}),i.jsx("p",{children:"เราอาจใช้คุกกี้หรือเทคโนโลยีที่คล้ายกันเพื่อปรับปรุงประสบการณ์และความปลอดภัยของคุณ คุณสามารถจัดการคุกกี้ได้ในเบราว์เซอร์ของคุณ"}),i.jsx("h2",{children:"5. การจัดเก็บและปกป้องข้อมูล"}),i.jsxs("ul",{children:[i.jsx("li",{children:"ข้อมูลส่วนบุคคลทั้งหมดจะถูกจัดเก็บบนคลาวด์ Google Firebase ด้วยการเข้ารหัสและความปลอดภัยตามมาตรฐานอุตสาหกรรม"}),i.jsx("li",{children:"มีเพียงบุคลากรที่ได้รับอนุญาตเท่านั้นที่สามารถเข้าถึงข้อมูลของคุณเพื่อการบำรุงรักษาบริการหรือปฏิบัติตามกฎหมาย"})]}),i.jsx("h2",{children:"6. สิทธิ์ของคุณ"}),i.jsxs("ul",{children:[i.jsx("li",{children:"คุณมีสิทธิ์เข้าถึง แก้ไข ดาวน์โหลด หรือขอลบข้อมูลส่วนบุคคลของคุณ"}),i.jsx("li",{children:"คุณสามารถขอลบบัญชี/ข้อมูลได้ตลอดเวลาผ่านแอปหรืออีเมล เราจะดำเนินการภายใน 3-5 วันทำการ"}),i.jsxs("li",{children:["ติดต่อ: ",i.jsx("a",{href:"mailto:rbben521@gmail.com",children:"rbben521@gmail.com"})]})]}),i.jsx("h2",{children:"7. การอัปเดตนโยบาย"}),i.jsx("p",{children:"เราจะแจ้งให้ผู้ใช้ทราบถึงการเปลี่ยนแปลงที่สำคัญของนโยบายนี้ผ่านการประกาศในแอปและอัปเดตหน้านี้ตามความเหมาะสม"})]}),vi:i.jsxs("div",{children:[i.jsx("h1",{children:"Chính sách bảo mật cho ứng dụng Restarter™"}),i.jsx("p",{children:"Restarter™ cam kết bảo vệ quyền riêng tư của bạn. Chính sách này giải thích cách chúng tôi thu thập, sử dụng, lưu trữ và bảo vệ thông tin cá nhân của bạn, cũng như quyền của bạn đối với dữ liệu đó."}),i.jsx("h2",{children:"1. Thông tin chúng tôi thu thập"}),i.jsxs("ul",{children:[i.jsx("li",{children:"Địa chỉ email"}),i.jsx("li",{children:"Tên người dùng/Biệt danh"}),i.jsx("li",{children:"Ảnh đại diện (nếu tải lên)"}),i.jsx("li",{children:"Giới tính, tuổi, quốc gia/khu vực, thành phố (nếu cung cấp)"}),i.jsx("li",{children:"Sở thích, sự kiện cuộc sống, mô tả cá nhân (nếu cung cấp)"}),i.jsx("li",{children:"Nhật ký đăng nhập và hoạt động (để bảo mật và cải thiện dịch vụ)"})]}),i.jsx("h2",{children:"2. Mục đích thu thập"}),i.jsxs("ul",{children:[i.jsx("li",{children:"Xác thực, quản lý tài khoản và dịch vụ cá nhân hóa"}),i.jsx("li",{children:"Tương tác cộng đồng, ghép đôi, nhiệm vụ, tính năng vườn"}),i.jsx("li",{children:"Bảo mật dịch vụ, phát hiện lỗi và ngăn chặn lạm dụng"}),i.jsx("li",{children:"Phân tích thống kê và cải tiến sản phẩm (ẩn danh)"}),i.jsx("li",{children:"Chúng tôi không bán, cho thuê hoặc chia sẻ dữ liệu cá nhân của bạn với bên thứ ba nếu không có sự đồng ý của bạn"})]}),i.jsx("h2",{children:"3. Dịch vụ của bên thứ ba"}),i.jsxs("p",{children:["Ứng dụng này sử dụng Google Firebase làm backend. Firebase có thể xử lý dữ liệu kỹ thuật theo ",i.jsx("a",{href:"https://firebase.google.com/support/privacy",target:"_blank",rel:"noopener noreferrer",children:"Chính sách bảo mật"})," (ví dụ: thông tin thiết bị, IP, nhật ký hoạt động)."]}),i.jsx("p",{children:"Nếu bạn đăng nhập qua Google, Apple hoặc Facebook, chúng tôi chỉ truy cập thông tin công khai của bạn (email, biệt danh, ảnh đại diện), không bao giờ truy cập mật khẩu của bạn."}),i.jsx("h2",{children:"4. Cookie và theo dõi"}),i.jsx("p",{children:"Chúng tôi có thể sử dụng cookie hoặc các công nghệ tương tự để nâng cao trải nghiệm và bảo mật của bạn. Bạn có thể quản lý cookie trong cài đặt trình duyệt của mình."}),i.jsx("h2",{children:"5. Lưu trữ và bảo vệ dữ liệu"}),i.jsxs("ul",{children:[i.jsx("li",{children:"Tất cả dữ liệu cá nhân được lưu trữ trên đám mây Google Firebase với mã hóa và bảo mật tiêu chuẩn ngành."}),i.jsx("li",{children:"Chỉ những nhân viên được ủy quyền mới có thể truy cập dữ liệu của bạn, chỉ để bảo trì dịch vụ hoặc tuân thủ pháp luật."})]}),i.jsx("h2",{children:"6. Quyền của bạn"}),i.jsxs("ul",{children:[i.jsx("li",{children:"Bạn có quyền truy cập, chỉnh sửa, tải xuống hoặc xóa dữ liệu cá nhân của mình."}),i.jsx("li",{children:"Bạn có thể yêu cầu xóa tài khoản/dữ liệu bất cứ lúc nào qua ứng dụng hoặc email. Chúng tôi sẽ xử lý yêu cầu của bạn trong vòng 3-5 ngày làm việc."}),i.jsxs("li",{children:["Liên hệ: ",i.jsx("a",{href:"mailto:rbben521@gmail.com",children:"rbben521@gmail.com"})]})]}),i.jsx("h2",{children:"7. Cập nhật chính sách"}),i.jsx("p",{children:"Chúng tôi sẽ thông báo cho người dùng về những thay đổi lớn đối với chính sách này qua thông báo trong ứng dụng và cập nhật trang này cho phù hợp."})]}),ms:i.jsxs("div",{children:[i.jsx("h1",{children:"Dasar Privasi untuk Aplikasi Restarter™"}),i.jsx("p",{children:"Restarter™ komited untuk melindungi privasi anda. Polisi ini menerangkan bagaimana kami mengumpul, menggunakan, menyimpan dan melindungi maklumat peribadi anda, serta hak anda terhadap data tersebut."}),i.jsx("h2",{children:"1. Maklumat yang Kami Kumpul"}),i.jsxs("ul",{children:[i.jsx("li",{children:"Alamat emel"}),i.jsx("li",{children:"Nama pengguna/Nama samaran"}),i.jsx("li",{children:"Avatar (jika dimuat naik)"}),i.jsx("li",{children:"Jantina, umur, negara/wilayah, bandar (jika diberikan)"}),i.jsx("li",{children:"Minat, peristiwa hidup, keterangan peribadi (jika diberikan)"}),i.jsx("li",{children:"Log masuk dan aktiviti (untuk keselamatan dan penambahbaikan perkhidmatan)"})]}),i.jsx("h2",{children:"2. Tujuan Pengumpulan"}),i.jsxs("ul",{children:[i.jsx("li",{children:"Pengesahan, pengurusan akaun dan perkhidmatan peribadi"}),i.jsx("li",{children:"Interaksi komuniti, padanan, misi, ciri taman"}),i.jsx("li",{children:"Keselamatan perkhidmatan, pengesanan ralat dan pencegahan penyalahgunaan"}),i.jsx("li",{children:"Analisis statistik dan penambahbaikan produk (tanpa nama)"}),i.jsx("li",{children:"Kami tidak akan menjual, menyewa atau berkongsi data peribadi anda dengan pihak ketiga tanpa kebenaran anda"})]}),i.jsx("h2",{children:"3. Perkhidmatan Pihak Ketiga"}),i.jsxs("p",{children:["Aplikasi ini menggunakan Google Firebase sebagai backend. Firebase mungkin memproses data teknikal mengikut ",i.jsx("a",{href:"https://firebase.google.com/support/privacy",target:"_blank",rel:"noopener noreferrer",children:"Dasar Privasi"})," (cth: maklumat peranti, IP, log aktiviti)."]}),i.jsx("p",{children:"Jika anda log masuk melalui Google, Apple atau Facebook, kami hanya mengakses maklumat awam anda (emel, nama samaran, avatar), tidak pernah kata laluan anda."}),i.jsx("h2",{children:"4. Kuki dan Penjejakan"}),i.jsx("p",{children:"Kami mungkin menggunakan kuki atau teknologi serupa untuk meningkatkan pengalaman dan keselamatan anda. Anda boleh mengurus pilihan kuki dalam tetapan pelayar anda."}),i.jsx("h2",{children:"5. Penyimpanan dan Perlindungan Data"}),i.jsxs("ul",{children:[i.jsx("li",{children:"Semua data peribadi disimpan di awan Google Firebase dengan penyulitan dan keselamatan piawaian industri."}),i.jsx("li",{children:"Soli homines auctoritate praediti possunt tuas notitias accedere, tantum ad servitium vel leges tuendas."})]}),i.jsx("h2",{children:"6. Hak Anda"}),i.jsxs("ul",{children:[i.jsx("li",{children:"Anda berhak untuk mengakses, membetulkan, memuat turun atau memadam data peribadi anda."}),i.jsx("li",{children:"Anda boleh meminta pemadaman akaun/data pada bila-bila masa melalui aplikasi atau e-mel. Kami akan memproses permintaan anda dalam masa 3-5 hari bekerja."}),i.jsxs("li",{children:["Hubungi: ",i.jsx("a",{href:"mailto:rbben521@gmail.com",children:"rbben521@gmail.com"})]})]}),i.jsx("h2",{children:"7. Kemas Kini Polisi"}),i.jsx("p",{children:"Kami akan memaklumkan pengguna tentang perubahan besar pada polisi ini melalui pengumuman dalam aplikasi dan mengemas kini halaman ini dengan sewajarnya."})]}),la:i.jsxs("div",{children:[i.jsx("h1",{children:"Consilium Privacy pro Restarter™ App"}),i.jsx("p",{children:"Restarter™ ad tuendam tuam privacy studet. Haec consilia explicat quomodo notitias personales colligamus, utamur, condamus, tueamur, et iura tua de notitiis exponat."}),i.jsx("h2",{children:"1. Quae colligimus"}),i.jsxs("ul",{children:[i.jsx("li",{children:"Inscriptionem electronicam"}),i.jsx("li",{children:"Nomen usoris/Sobriquet"}),i.jsx("li",{children:"Avatar (si sublatus)"}),i.jsx("li",{children:"Sexus, aetas, regio/natio, urbs (si praebetur)"}),i.jsx("li",{children:"Studia, eventus vitae, descriptio personalis (si praebetur)"}),i.jsx("li",{children:"Acta login et actio (ad securitatem et emendationem servitii)"})]}),i.jsx("h2",{children:"2. Propositum collectionis"}),i.jsxs("ul",{children:[i.jsx("li",{children:"Authenticatio, administratio rationis, officia personalia"}),i.jsx("li",{children:"Communitas, paria, missiones, hortus"}),i.jsx("li",{children:"Securitas servitii, errorum detectio, abusus praeventio"}),i.jsx("li",{children:"Analysis statistica et emendatio producti (anonymizata)"}),i.jsx("li",{children:"Notitias tuas non vendimus, locamus, nec sine consensu communicamus"})]}),i.jsx("h2",{children:"3. Officia tertiarum partium"}),i.jsxs("p",{children:["Haec app utitur Google Firebase ut backend. Firebase potest notitias technicas tractare secundum ",i.jsx("a",{href:"https://firebase.google.com/support/privacy",target:"_blank",rel:"noopener noreferrer",children:"Consilium Privacy"})," (ex. info de machina, IP, acta actionum)."]}),i.jsx("p",{children:"Si per Google, Apple, Facebook ingredieris, solum publicas notitias tuas accedimus (email, sobriquet, avatar), numquam tesseram tuam."}),i.jsx("h2",{children:"4. Cookies et vestigatio"}),i.jsx("p",{children:"Possumus uti cookies aut similibus technologiis ad experientiam et securitatem tuam augendam. Praeferentias cookies in navigatoris tuis regere potes."}),i.jsx("h2",{children:"5. Reconditio et tutela notitiarum"}),i.jsxs("ul",{children:[i.jsx("li",{children:"Omnes notitiae personales in Google Firebase nube servantur, cum encryptione et securitate industriae."}),i.jsx("li",{children:"Soli homines auctoritate praediti possunt tuas notitias accedere, tantum ad servitium vel leges tuendas."})]}),i.jsx("h2",{children:"6. Iura tua"}),i.jsxs("ul",{children:[i.jsx("li",{children:"Ius habes accedere, corrigere, extrahere, aut delere notitias tuas personales."}),i.jsx("li",{children:"Potes petere deletionem rationis/datae quovis tempore per app vel email. Processum intra 3-5 dies negotiales perficimus."}),i.jsxs("li",{children:["Contactus: ",i.jsx("a",{href:"mailto:rbben521@gmail.com",children:"rbben521@gmail.com"})]})]}),i.jsx("h2",{children:"7. Renovatio consilii"}),i.jsx("p",{children:"De mutationibus maioribus huius consilii usores per nuntios in app certiorem faciemus et hanc paginam proinde renovabimus."})]})};function W3(){const n=localStorage.getItem("lang")||"zh-TW",e=Et();return i.jsxs("div",{style:{minHeight:"100vh",background:"#111827",color:"white",padding:"2rem",display:"flex",flexDirection:"column"},children:[i.jsxs("button",{onClick:()=>e("/register",{replace:!0}),style:{position:"absolute",top:32,left:36,zIndex:10,backgroundColor:"#374151",color:"white",fontWeight:"bold",padding:"0.5rem 1rem",borderRadius:"0.375rem",border:"none",cursor:"pointer",fontSize:16},children:["← ",O3[n]||"返回"]}),i.jsx("div",{style:{flex:"1 0 auto"},children:i.jsxs("div",{style:{maxWidth:800,margin:"0 auto",background:"#fff",color:"#111",borderRadius:16,padding:32,position:"relative"},children:[mk[n]||mk["zh-TW"],i.jsx("div",{style:{textAlign:"center",marginTop:48,color:"#888",fontSize:16},children:"CTX Goodlife Copyright 2025"})]})}),i.jsx("div",{style:{width:"100%",margin:"0 auto",marginTop:24,background:"rgba(255,255,255,0.95)",borderRadius:16,padding:"16px",boxShadow:"0 2px 12px #6B5BFF22"},children:i.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:20,flexWrap:"wrap"},children:[i.jsx("a",{href:"/privacy-policy",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12},children:"隱私權政策"}),i.jsx("a",{href:"/terms",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12},children:"條款/聲明"}),i.jsx("a",{href:"/data-deletion",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12},children:"資料刪除說明"}),i.jsx("a",{href:"/about",style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12},children:"🧬 Restarter™｜我們是誰"}),i.jsx("a",{href:"/feedback",style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12},children:"💬 意見箱｜我們想聽你說"})]})})]})}const gk={"zh-TW":i.jsxs("div",{children:[i.jsx("h1",{children:"資料刪除說明"}),i.jsx("p",{children:"若您希望刪除在 Restarter App 中儲存的個人資料，請來信至："}),i.jsx("p",{children:i.jsx("strong",{children:"rbben521@gmail.com"})}),i.jsx("p",{children:"我們會在 3-5 個工作天內完成資料刪除作業。"})]}),"zh-CN":i.jsxs("div",{children:[i.jsx("h1",{children:"资料删除说明"}),i.jsx("p",{children:"如需删除在 Restarter App 中存储的个人资料，请发送邮件至："}),i.jsx("p",{children:i.jsx("strong",{children:"rbben521@gmail.com"})}),i.jsx("p",{children:"我们将在 3-5 个工作日内完成资料删除。"})]}),en:i.jsxs("div",{children:[i.jsx("h1",{children:"Data Deletion Policy"}),i.jsx("p",{children:"If you wish to delete your personal data stored in the Restarter App, please contact:"}),i.jsx("p",{children:i.jsx("strong",{children:"rbben521@gmail.com"})}),i.jsx("p",{children:"We will complete the deletion process within 3-5 business days."})]}),ja:i.jsxs("div",{children:[i.jsx("h1",{children:"データ削除のご案内"}),i.jsx("p",{children:"Restarterアプリに保存されている個人データの削除をご希望の場合は、以下までご連絡ください："}),i.jsx("p",{children:i.jsx("strong",{children:"rbben521@gmail.com"})}),i.jsx("p",{children:"3～5営業日以内に削除手続きを完了します。"})]}),ko:i.jsxs("div",{children:[i.jsx("h1",{children:"데이터 삭제 안내"}),i.jsx("p",{children:"Restarter 앱에 저장된 개인 데이터를 삭제하려면 다음으로 문의해 주세요:"}),i.jsx("p",{children:i.jsx("strong",{children:"rbben521@gmail.com"})}),i.jsx("p",{children:"3~5 영업일 이내에 삭제를 완료해 드립니다."})]}),th:i.jsxs("div",{children:[i.jsx("h1",{children:"นโยบายการลบข้อมูล"}),i.jsx("p",{children:"หากคุณต้องการลบข้อมูลส่วนบุคคลที่จัดเก็บในแอป Restarter กรุณาติดต่อ:"}),i.jsx("p",{children:i.jsx("strong",{children:"rbben521@gmail.com"})}),i.jsx("p",{children:"เราจะดำเนินการลบข้อมูลภายใน 3-5 วันทำการ"})]}),vi:i.jsxs("div",{children:[i.jsx("h1",{children:"Chính sách xóa dữ liệu"}),i.jsx("p",{children:"Nếu bạn muốn xóa dữ liệu cá nhân được lưu trữ trong ứng dụng Restarter, vui lòng liên hệ:"}),i.jsx("p",{children:i.jsx("strong",{children:"rbben521@gmail.com"})}),i.jsx("p",{children:"Chúng tôi sẽ hoàn tất việc xóa dữ liệu trong vòng 3-5 ngày làm việc."})]}),ms:i.jsxs("div",{children:[i.jsx("h1",{children:"Dasar Pemadaman Data"}),i.jsx("p",{children:"Jika anda ingin memadam data peribadi yang disimpan dalam Aplikasi Restarter, sila hubungi:"}),i.jsx("p",{children:i.jsx("strong",{children:"rbben521@gmail.com"})}),i.jsx("p",{children:"Kami akan menyelesaikan proses pemadaman dalam masa 3-5 hari bekerja."})]}),la:i.jsxs("div",{children:[i.jsx("h1",{children:"Norma Deletionis Datae"}),i.jsx("p",{children:"Si vis delere data personalia in Restarter App reposita, quaeso contactum:"}),i.jsx("p",{children:i.jsx("strong",{children:"rbben521@gmail.com"})}),i.jsx("p",{children:"Processum deletionis intra 3-5 dies negotiales perficimus."})]})},V3={"zh-TW":"返回","zh-CN":"返回",en:"Back",ja:"戻る",ko:"뒤로",th:"กลับ",vi:"Quay lại",ms:"Kembali",la:"Revertere"};function U3(){const n=localStorage.getItem("lang")||"zh-TW",e=Et();return i.jsxs("div",{style:{minHeight:"100vh",background:"#111827",color:"white",padding:"2rem",display:"flex",flexDirection:"column"},children:[i.jsxs("button",{onClick:()=>e("/register",{replace:!0}),style:{position:"absolute",top:32,left:36,zIndex:10,backgroundColor:"#374151",color:"white",fontWeight:"bold",padding:"0.5rem 1rem",borderRadius:"0.375rem",border:"none",cursor:"pointer",fontSize:16},children:["← ",V3[n]||"返回"]}),i.jsx("div",{style:{flex:"1 0 auto"},children:i.jsxs("div",{style:{maxWidth:800,margin:"0 auto",background:"#fff",color:"#111",borderRadius:16,padding:32,position:"relative"},children:[gk[n]||gk["zh-TW"],i.jsx("div",{style:{textAlign:"center",marginTop:48,color:"#888",fontSize:16},children:"CTX Goodlife Copyright 2025"})]})}),i.jsx("div",{style:{width:"100%",margin:"0 auto",marginTop:24,background:"rgba(255,255,255,0.95)",borderRadius:16,padding:"16px",boxShadow:"0 2px 12px #6B5BFF22"},children:i.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:20,flexWrap:"wrap"},children:[i.jsx("a",{href:"/privacy-policy",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12},children:"隱私權政策"}),i.jsx("a",{href:"/terms",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12},children:"條款/聲明"}),i.jsx("a",{href:"/data-deletion",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12},children:"資料刪除說明"}),i.jsx("a",{href:"/about",style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12},children:"🧬 Restarter™｜我們是誰"}),i.jsx("a",{href:"/feedback",style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12},children:"💬 意見箱｜我們想聽你說"})]})})]})}const en={"zh-TW":{title:"互相幫助&合作實驗室",provide:"提供幫助",supply:"供應圈",need:"需要幫助",room:"互助房",intro:"在重啟的路上，我們都需要彼此的支持。請選擇你想要參與的方式：",introNeed:"如果你正在經歷困難，請告訴我們，社群夥伴會主動協助你。",needBtn:"我需要幫助",rule:"※ 所有資訊僅供社群內部交流使用，請尊重彼此隱私",msgTo:"留言給：",msgPlaceholder:"請輸入留言...",msgSent:"留言發送成功！",backToHome:"返回首頁",sections:{provide:{title:"我可提供幫助 & 合作室",desc:"分享你的專長、資源或想合作的領域，讓更多人找到你。",btn:"我要提供"},need:{title:"我需要幫助 or 合作屋",desc:"說出你目前遇到的困難或想找合作夥伴，讓社群支援你。",btn:"我需要幫助"},supply:{title:"幫助 & 合作供應圈",desc:"瀏覽大家能提供的幫助與合作資源，主動聯繫彼此。",btn:"探索供應圈"},room:{title:"進入互助房",desc:"即時交流，互助成長",btn:"進入互助房"}},modals:{provide:{title:"我可以提供幫助 & 合作",subtitle:"在重啟路上，我的經歷和優勢也許可以幫上忙！",experience:"我的經歷（可複選）：",current:"我的現狀(可複選)：",target:"我想優先幫助的對象（可複選）：",helpType:"我可以提供幫助形式：",statement:"我的特別聲明（50字內）：",frequency:"我可幫助的頻率：",cancel:"取消",submit:"送出",other:"其他...",enterPlaceholder:"請輸入...",messageTo:"留言給：",messagePlaceholder:"請輸入留言...",sendMessage:"送出留言",messageSent:"需求已成功送出！"},need:{title:"我需要幫助",subtitle:"請描述你遇到的困難或需要協助的地方，讓社群夥伴能更好幫助你！",experience:"我的經歷（可複選）：",current:"我的現狀(可複選)：",target:"我想優先幫助的對象（可複選）：",helpType:"我可以提供幫助形式：",statement:"我的特別聲明（50字內）：",frequency:"我可幫助的頻率：",cancel:"取消",submit:"送出",other:"其他...",enterPlaceholder:"請輸入...",messageTo:"留言給：",messagePlaceholder:"請輸入留言...",sendMessage:"送出留言",messageSent:"需求已成功送出！"}},options:{experience:["成功創業","家庭重建","就業輔導","法律協助","戒癮經驗","志工","社區服務","其他"],advantage:["經濟困難","無固定工作","缺乏家庭支持","健康問題","法律糾紛","心理壓力","缺乏居住地","人際關係困難","正在創業中","其他"],target:["找工作/就業協助","經濟急難救助","心理諮詢/陪伴","法律協助","醫療協助","住宿協助","家庭修復","戒癮支持","人際關係協助","生活重建","商業輔導","其他"],helpType:["線上","線下"],frequency:["每天","每週","每月","依需要者而定","其他"]},messages:{messageSent:"留言發送成功！",messageFailed:"留言發送失敗，請稍後再試",noMessages:"暫無留言",markRead:"標記已讀",delete:"刪除",confirmDelete:"你確定要刪除這條留言嗎？（一旦刪除將無法復原）",inboxTitle:"站內訊息",messageFrom:"給你的留言：",contactUser:"聯絡對方"},date:"日期",avatar:"頭像",name:"名稱",gender:"性別",age:"年齡",country:"國家"},"zh-CN":{sections:{provide:{title:"我可提供帮助 & 合作室",desc:"分享你的专长、资源或想合作的领域，让更多人找到你。",btn:"我要提供"},need:{title:"我需要帮助 or 合作屋",desc:"说出你目前遇到的困难或想找合作伙伴，让社群支援你。",btn:"我需要帮助"},supply:{title:"帮助 & 合作供应圈",desc:"浏览大家能提供的帮助与合作资源，主动联系彼此。",btn:"探索供应圈"},room:{title:"进入互助房",desc:"即时交流，互助成长",btn:"进入互助房"}},modals:{provide:{title:"我可以提供帮助 & 合作",subtitle:"在重启路上，我的经历和优势也许可以帮上忙！",experience:"我的经历（可复选）：",current:"我的现状(可复选)：",target:"我想优先帮助的对象（可复选）：",helpType:"我可以提供帮助形式：",statement:"我的特别声明（50字内）：",frequency:"我可帮助的频率：",cancel:"取消",submit:"送出",other:"其他...",enterPlaceholder:"请输入...",messageTo:"留言给：",messagePlaceholder:"请输入留言...",sendMessage:"送出留言",messageSent:"需求已成功送出！"},need:{title:"我需要帮助",subtitle:"请描述你遇到的困难或需要协助的地方，让社群伙伴能更好帮助你！",experience:"我的经历（可复选）：",current:"我的现状(可复选)：",target:"我遇到的困难/需求（可复选）：",helpType:"希望获得协助形式：",statement:"补充说明（50字内）：",frequency:"希望获得协助频率：",cancel:"取消",submit:"送出",other:"其他...",enterPlaceholder:"请输入...",messageTo:"留言给：",messagePlaceholder:"请输入留言...",sendMessage:"送出留言",messageSent:"需求已成功送出！"}},options:{experience:["成功创业","家庭重建","就业辅导","法律协助","戒瘾经验","志工","社区服务","其他"],advantage:["经济困难","无固定工作","缺乏家庭支持","健康问题","法律纠纷","心理压力","缺乏居住地","人际关系困难","正在创业中","其他"],target:["找工作/就业协助","经济急难救助","心理咨询/陪伴","法律协助","医疗协助","住宿协助","家庭修复","戒瘾支持","人际关系协助","生活重建","商业辅导","其他"],helpType:["线上","线下"],frequency:["每天","每周","每月","依需要者而定","其他"]},messages:{messageSent:"留言发送成功！",messageFailed:"留言发送失败，请稍后再试",noMessages:"暂无留言",markRead:"标记已读",delete:"删除",confirmDelete:"你确定要删除这条留言吗？（一旦删除将无法复原）",inboxTitle:"站内消息",messageFrom:"给你的留言：",contactUser:"联络对方"},date:"日期",avatar:"头像",name:"名称",gender:"性别",age:"年龄",country:"国家"},en:{sections:{provide:{title:"I can provide help & cooperation room",desc:"Share your expertise, resources or areas you want to collaborate on, so more people can find you.",btn:"I want to provide"},need:{title:"I need help or cooperation house",desc:"Tell us about the difficulties you're currently facing or partners you want to find, so the community can support you.",btn:"I need help"},supply:{title:"Help & cooperation supply circle",desc:"Browse the help and cooperation resources everyone can provide, actively contact each other.",btn:"Explore supply circle"},room:{title:"Enter mutual aid room",desc:"Real-time communication, mutual growth",btn:"Enter mutual aid room"}},modals:{provide:{title:"I can provide help & cooperation",subtitle:"On the restart journey, my experience and advantages might be helpful!",experience:"My experience (multiple choice):",current:"My current situation (multiple choice):",target:"People I want to help first (multiple choice):",helpType:"I can provide help in the form of:",statement:"My special statement (within 50 characters):",frequency:"My help frequency:",cancel:"Cancel",submit:"Submit",other:"Other...",enterPlaceholder:"Please enter...",messageTo:"Message to:",messagePlaceholder:"Please enter message...",sendMessage:"Send message",messageSent:"Request sent successfully!",backToHome:"Back to Home"},need:{title:"I need help",subtitle:"Please describe the difficulties you're facing or areas where you need assistance, so community partners can better help you!",experience:"My experience (multiple choice):",current:"My current situation (multiple choice):",target:"People I want to help first (multiple choice):",helpType:"I can provide help in the form of:",statement:"My special statement (within 50 characters):",frequency:"My help frequency:",cancel:"Cancel",submit:"Submit",other:"Other...",enterPlaceholder:"Please enter...",messageTo:"Message to:",messagePlaceholder:"Please enter message...",sendMessage:"Send message",messageSent:"Request sent successfully!",backToHome:"Back to Home"}},options:{experience:["Successful entrepreneurship","Family reconstruction","Employment guidance","Legal assistance","Addiction recovery experience","Volunteer","Community service","Other"],advantage:["Financial difficulties","No fixed job","Lack of family support","Health problems","Legal disputes","Psychological pressure","Lack of housing","Interpersonal difficulties","Currently starting a business","Other"],target:["Job search/employment assistance","Emergency financial assistance","Psychological counseling/companionship","Legal assistance","Medical assistance","Housing assistance","Family repair","Addiction support","Interpersonal assistance","Life reconstruction","Business guidance","Other"],helpType:["Online","Offline"],frequency:["Daily","Weekly","Monthly","As needed","Other"]},messages:{messageSent:"Message sent successfully!",messageFailed:"Message sending failed, please try again later",noMessages:"No messages yet",markRead:"Mark as read",delete:"Delete",confirmDelete:"Are you sure you want to delete this message? (Once deleted, it cannot be restored)",inboxTitle:"Inbox Messages",messageFrom:" sent you a message:",contactUser:"Contact User"},date:"Date",avatar:"Avatar",name:"Name",gender:"Gender",age:"Age",country:"Country"},ja:{sections:{provide:{title:"私は助けと協力の部屋を提供できます",desc:"あなたの専門知識、リソース、または協力したい分野を共有して、より多くの人にあなたを見つけてもらいましょう。",btn:"提供したい"},need:{title:"私は助けまたは協力の家が必要です",desc:"現在直面している困難や見つけたいパートナーについて教えてください。コミュニティがあなたをサポートできるようにします。",btn:"助けが必要です"},supply:{title:"助けと協力の供給サークル",desc:"みんなが提供できる助けと協力のリソースを閲覧し、積極的にお互いに連絡を取り合いましょう。",btn:"供給サークルを探索"},room:{title:"相互扶助の部屋に入る",desc:"リアルタイムコミュニケーション、相互成長",btn:"相互扶助の部屋に入る"}},modals:{provide:{title:"私は助けと協力を提供できます",subtitle:"再出発の道のりで、私の経験と強みがお役に立てるかもしれません！",experience:"私の経験（複数選択可）：",current:"私の現状（複数選択可）：",target:"私が優先的に助けたい人（複数選択可）：",helpType:"私が提供できる助けの形式：",statement:"私の特別な声明（50文字以内）：",frequency:"私が助けられる頻度：",cancel:"キャンセル",submit:"送信",other:"その他...",enterPlaceholder:"入力してください...",messageTo:"メッセージを送る：",messagePlaceholder:"メッセージを入力してください...",sendMessage:"メッセージを送信",messageSent:"リクエストが正常に送信されました！",backToHome:"ホームへ戻る"},need:{title:"助けが必要です",subtitle:"直面している困難や支援が必要な領域を説明してください。コミュニティのパートナーがより良くあなたを助けられるようにします！",experience:"私の経験（複数選択可）：",current:"私の現状（複数選択可）：",target:"私が優先的に助けたい人（複数選択可）：",helpType:"私が提供できる助けの形式：",statement:"私の特別な声明（50文字以内）：",frequency:"私が助けられる頻度：",cancel:"キャンセル",submit:"送信",other:"その他...",enterPlaceholder:"入力してください...",messageTo:"メッセージを送る：",messagePlaceholder:"メッセージを入力してください...",sendMessage:"メッセージを送信",messageSent:"リクエストが正常に送信されました！",backToHome:"ホームへ戻る"}},options:{experience:["成功した起業","家族の再構築","就職支援","法的支援","依存症回復経験","ボランティア","コミュニティサービス","その他"],advantage:["経済的困難","固定職なし","家族のサポート不足","健康問題","法的紛争","心理的プレッシャー","住居不足","人間関係の困難","現在起業中","その他"],target:["仕事探し/就職支援","緊急経済支援","心理カウンセリング/同伴","法的支援","医療支援","住居支援","家族修復","依存症支援","人間関係支援","生活再建","ビジネス指導","その他"],helpType:["オンライン","オフライン"],frequency:["毎日","毎週","毎月","必要に応じて","その他"]},messages:{messageSent:"メッセージが正常に送信されました！",messageFailed:"メッセージの送信に失敗しました。後でもう一度お試しください",noMessages:"まだメッセージがありません",markRead:"既読にする",delete:"削除",confirmDelete:"このメッセージを削除してもよろしいですか？（削除すると復元できません）",inboxTitle:"受信メッセージ",messageFrom:"からメッセージ：",contactUser:"ユーザーに連絡",backToHome:"ホームへ戻る"},date:"日付",avatar:"アイコン",name:"名前",gender:"性別",age:"年齢",country:"国"},ko:{sections:{provide:{title:"나는 도움과 협력 방을 제공할 수 있습니다",desc:"당신의 전문 지식, 자원 또는 협력하고 싶은 분야를 공유하여 더 많은 사람들이 당신을 찾을 수 있도록 하세요.",btn:"제공하고 싶습니다"},need:{title:"나는 도움이나 협력 집이 필요합니다",desc:"현재 직면한 어려움이나 찾고 싶은 파트너에 대해 말씀해 주세요. 커뮤니티가 당신을 지원할 수 있도록 합니다.",btn:"도움이 필요합니다"},supply:{title:"도움과 협력 공급 서클",desc:"모든 사람이 제공할 수 있는 도움과 협력 자원을 둘러보고, 적극적으로 서로 연락하세요.",btn:"공급 서클 탐색"},room:{title:"상호 원조 방에 들어가기",desc:"실시간 소통, 상호 성장",btn:"상호 원조 방에 들어가기"}},modals:{provide:{title:"나는 도움과 협력을 제공할 수 있습니다",subtitle:"재시작 여정에서 제 경험과 장점이 도움이 될 수 있습니다!",experience:"제 경험 (복수 선택 가능):",current:"제 현재 상황 (복수 선택 가능):",target:"제가 우선적으로 도우고 싶은 사람 (복수 선택 가능):",helpType:"제가 제공할 수 있는 도움의 형태:",statement:"제 특별한 선언 (50자 이내):",frequency:"제가 도울 수 있는 빈도:",cancel:"취소",submit:"제출",other:"기타...",enterPlaceholder:"입력하세요...",messageTo:"메시지 보내기:",messagePlaceholder:"메시지를 입력하세요...",sendMessage:"메시지 보내기",messageSent:"요청이 성공적으로 전송되었습니다!",backToHome:"홈으로 돌아가기"},need:{title:"도움이 필요합니다",subtitle:"당신이 직면한 어려움이나 도움이 필요한 분야를 설명해 주세요. 커뮤니티 파트너가 더 잘 당신을 도울 수 있도록 합니다!",experience:"제 경험 (복수 선택 가능):",current:"제 현재 상황 (복수 선택 가능):",target:"제가 우선적으로 도우고 싶은 사람 (복수 선택 가능):",helpType:"제가 제공할 수 있는 도움의 형태:",statement:"제 특별한 선언 (50자 이내):",frequency:"제가 도울 수 있는 빈도:",cancel:"취소",submit:"제출",other:"기타...",enterPlaceholder:"입력하세요...",messageTo:"메시지 보내기:",messagePlaceholder:"메시지를 입력하세요...",sendMessage:"메시지 보내기",messageSent:"요청이 성공적으로 전송되었습니다!",backToHome:"홈으로 돌아가기"}},options:{experience:["성공한 창업","가족 재건","취업 지도","법적 지원","중독 회복 경험","자원봉사","커뮤니티 서비스","기타"],advantage:["경제적 어려움","고정 직업 없음","가족 지원 부족","건강 문제","법적 분쟁","심리적 압박","주거지 부족","인간관계 어려움","현재 창업 중","기타"],target:["일자리 찾기/취업 지원","긴급 경제 지원","심리 상담/동반","법적 지원","의료 지원","주거 지원","가족 회복","중독 지원","인간관계 지원","생활 재건","비즈니스 지도","기타"],helpType:["온라인","오프라인"],frequency:["매일","매주","매월","필요에 따라","기타"]},messages:{messageSent:"메시지가 성공적으로 전송되었습니다!",messageFailed:"메시지 전송에 실패했습니다. 나중에 다시 시도해 주세요",noMessages:"아직 메시지가 없습니다",markRead:"읽음 표시",delete:"삭제",confirmDelete:"이 메시지를 삭제하시겠습니까? (삭제하면 복원할 수 없습니다)",inboxTitle:"받은 메시지",messageFrom:"님이 보낸 메시지:",contactUser:"사용자에게 연락",backToHome:"홈으로 돌아가기"},date:"날짜",avatar:"아바타",name:"이름",gender:"성별",age:"나이",country:"국가"},vi:{sections:{provide:{title:"Tôi có thể cung cấp phòng trợ giúp & hợp tác",desc:"Chia sẻ chuyên môn, tài nguyên hoặc lĩnh vực bạn muốn hợp tác, để nhiều người có thể tìm thấy bạn.",btn:"Tôi muốn cung cấp"},need:{title:"Tôi cần trợ giúp hoặc nhà hợp tác",desc:"Hãy nói về những khó khăn bạn đang gặp phải hoặc đối tác bạn muốn tìm, để cộng đồng có thể hỗ trợ bạn.",btn:"Tôi cần trợ giúp"},supply:{title:"Vòng tròn cung cấp trợ giúp & hợp tác",desc:"Duyệt qua các tài nguyên trợ giúp và hợp tác mà mọi người có thể cung cấp, chủ động liên lạc với nhau.",btn:"Khám phá vòng tròn cung cấp"},room:{title:"Vào phòng hỗ trợ lẫn nhau",desc:"Giao tiếp thời gian thực, cùng nhau phát triển",btn:"Vào phòng hỗ trợ lẫn nhau"}},modals:{provide:{title:"Tôi có thể cung cấp trợ giúp & hợp tác",subtitle:"Trên hành trình khởi động lại, kinh nghiệm và lợi thế của tôi có thể hữu ích!",experience:"Kinh nghiệm của tôi (chọn nhiều):",current:"Tình trạng hiện tại của tôi (chọn nhiều):",target:"Những người tôi muốn ưu tiên giúp đỡ (chọn nhiều):",helpType:"Tôi có thể cung cấp trợ giúp dưới hình thức:",statement:"Tuyên bố đặc biệt của tôi (trong vòng 50 ký tự):",frequency:"Tần suất tôi có thể giúp:",cancel:"Hủy",submit:"Gửi",other:"Khác...",enterPlaceholder:"Vui lòng nhập...",messageTo:"Nhắn tin cho:",messagePlaceholder:"Vui lòng nhập tin nhắn...",sendMessage:"Gửi tin nhắn",messageSent:"Yêu cầu đã được gửi thành công!",backToHome:"Về trang chủ"},need:{title:"Tôi cần trợ giúp",subtitle:"Vui lòng mô tả những khó khăn bạn đang gặp phải hoặc những lĩnh vực cần hỗ trợ, để các đối tác cộng đồng có thể giúp bạn tốt hơn!",experience:"Kinh nghiệm của tôi (chọn nhiều):",current:"Tình trạng hiện tại của tôi (chọn nhiều):",target:"Những người tôi muốn ưu tiên giúp đỡ (chọn nhiều):",helpType:"Tôi có thể cung cấp trợ giúp dưới hình thức:",statement:"Tuyên bố đặc biệt của tôi (trong vòng 50 ký tự):",frequency:"Tần suất tôi có thể giúp:",cancel:"Hủy",submit:"Gửi",other:"Khác...",enterPlaceholder:"Vui lòng nhập...",messageTo:"Nhắn tin cho:",messagePlaceholder:"Vui lòng nhập tin nhắn...",sendMessage:"Gửi tin nhắn",messageSent:"Yêu cầu đã được gửi thành công!",backToHome:"Về trang chủ"}},options:{experience:["Khởi nghiệp thành công","Tái thiết gia đình","Hướng dẫn việc làm","Hỗ trợ pháp lý","Kinh nghiệm cai nghiện","Tình nguyện viên","Dịch vụ cộng đồng","Khác"],advantage:["Khó khăn tài chính","Không có việc làm cố định","Thiếu hỗ trợ gia đình","Vấn đề sức khỏe","Tranh chấp pháp lý","Áp lực tâm lý","Thiếu nơi ở","Khó khăn trong mối quan hệ","Đang khởi nghiệp","Khác"],target:["Tìm việc/hỗ trợ việc làm","Hỗ trợ tài chính khẩn cấp","Tư vấn tâm lý/đồng hành","Hỗ trợ pháp lý","Hỗ trợ y tế","Hỗ trợ nhà ở","Sửa chữa gia đình","Hỗ trợ cai nghiện","Hỗ trợ mối quan hệ","Tái thiết cuộc sống","Hướng dẫn kinh doanh","Khác"],helpType:["Trực tuyến","Ngoại tuyến"],frequency:["Hàng ngày","Hàng tuần","Hàng tháng","Theo nhu cầu","Khác"]},messages:{messageSent:"Tin nhắn đã được gửi thành công!",messageFailed:"Gửi tin nhắn thất bại, vui lòng thử lại sau",noMessages:"Chưa có tin nhắn",markRead:"Đánh dấu đã đọc",delete:"Xóa",confirmDelete:"Bạn có chắc chắn muốn xóa tin nhắn này không? (Một khi xóa sẽ không thể khôi phục)",inboxTitle:"Tin nhắn đến",messageFrom:" đã gửi tin nhắn cho bạn:",contactUser:"Liên hệ người dùng",backToHome:"Về trang chủ"},date:"Ngày",avatar:"Ảnh đại diện",name:"Tên",gender:"Giới tính",age:"Tuổi",country:"Quốc gia"},th:{sections:{provide:{title:"ฉันสามารถให้ความช่วยเหลือและห้องความร่วมมือ",desc:"แบ่งปันความเชี่ยวชาญ ทรัพยากร หรือพื้นที่ที่คุณต้องการร่วมมือ เพื่อให้คนอื่นๆ หาคุณเจอ",btn:"ฉันต้องการให้"},need:{title:"ฉันต้องการความช่วยเหลือหรือบ้านความร่วมมือ",desc:"บอกเราเกี่ยวกับความยากลำบากที่คุณกำลังเผชิญหรือคู่ค้าที่คุณต้องการหา เพื่อให้ชุมชนสามารถสนับสนุนคุณได้",btn:"ฉันต้องการความช่วยเหลือ"},supply:{title:"วงกลมอุปทานความช่วยเหลือและความร่วมมือ",desc:"เรียกดูทรัพยากรความช่วยเหลือและความร่วมมือที่ทุกคนสามารถให้ได้ ติดต่อกันอย่างกระตือรือร้น",btn:"สำรวจวงกลมอุปทาน"},room:{title:"เข้าห้องช่วยเหลือซึ่งกันและกัน",desc:"การสื่อสารแบบเรียลไทม์ การเติบโตร่วมกัน",btn:"เข้าห้องช่วยเหลือซึ่งกันและกัน"}},modals:{provide:{title:"ฉันสามารถให้ความช่วยเหลือและความร่วมมือ",subtitle:"ในการเดินทางเริ่มต้นใหม่ ประสบการณ์และข้อได้เปรียบของฉันอาจเป็นประโยชน์!",experience:"ประสบการณ์ของฉัน (เลือกได้หลายข้อ):",current:"สถานการณ์ปัจจุบันของฉัน (เลือกได้หลายข้อ):",target:"คนที่ฉันต้องการช่วยเป็นอันดับแรก (เลือกได้หลายข้อ):",helpType:"ฉันสามารถให้ความช่วยเหลือในรูปแบบ:",statement:"คำแถลงพิเศษของฉัน (ไม่เกิน 50 ตัวอักษร):",frequency:"ความถี่ที่ฉันสามารถช่วยได้:",cancel:"ยกเลิก",submit:"ส่ง",other:"อื่นๆ...",enterPlaceholder:"กรุณาป้อน...",messageTo:"ส่งข้อความถึง:",messagePlaceholder:"กรุณาป้อนข้อความ...",sendMessage:"ส่งข้อความ",messageSent:"ส่งคำขอสำเร็จแล้ว!",backToHome:"กลับหน้าหลัก"},need:{title:"ฉันต้องการความช่วยเหลือ",subtitle:"กรุณาอธิบายความยากลำบากที่คุณกำลังเผชิญหรือพื้นที่ที่ต้องการความช่วยเหลือ เพื่อให้คู่ค้าชุมชนสามารถช่วยคุณได้ดีขึ้น!",experience:"ประสบการณ์ของฉัน (เลือกได้หลายข้อ):",current:"สถานการณ์ปัจจุบันของฉัน (เลือกได้หลายข้อ):",target:"คนที่ฉันต้องการช่วยเป็นอันดับแรก (เลือกได้หลายข้อ):",helpType:"ฉันสามารถให้ความช่วยเหลือในรูปแบบ:",statement:"คำแถลงพิเศษของฉัน (ไม่เกิน 50 ตัวอักษร):",frequency:"ความถี่ที่ฉันสามารถช่วยได้:",cancel:"ยกเลิก",submit:"ส่ง",other:"อื่นๆ...",enterPlaceholder:"กรุณาป้อน...",messageTo:"ส่งข้อความถึง:",messagePlaceholder:"กรุณาป้อนข้อความ...",sendMessage:"ส่งข้อความ",messageSent:"ส่งคำขอสำเร็จแล้ว!",backToHome:"กลับหน้าหลัก"}},options:{experience:["การเริ่มต้นธุรกิจที่ประสบความสำเร็จ","การสร้างครอบครัวใหม่","การแนะแนวการจ้างงาน","การช่วยเหลือทางกฎหมาย","ประสบการณ์การเลิกเสพติด","อาสาสมัคร","บริการชุมชน","อื่นๆ"],advantage:["ความยากลำบากทางการเงิน","ไม่มีงานประจำ","ขาดการสนับสนุนจากครอบครัว","ปัญหาสุขภาพ","ข้อพิพาททางกฎหมาย","ความกดดันทางจิตใจ","ขาดที่อยู่อาศัย","ความยากลำบากในความสัมพันธ์","กำลังเริ่มต้นธุรกิจ","อื่นๆ"],target:["การหางาน/ความช่วยเหลือการจ้างงาน","ความช่วยเหลือทางการเงินฉุกเฉิน","การให้คำปรึกษาทางจิตวิทยา/การเป็นเพื่อน","การช่วยเหลือทางกฎหมาย","ความช่วยเหลือทางการแพทย์","ความช่วยเหลือที่อยู่อาศัย","การซ่อมแซมครอบครัว","การสนับสนุนการเลิกเสพติด","ความช่วยเหลือความสัมพันธ์","การสร้างชีวิตใหม่","การแนะแนวธุรกิจ","อื่นๆ"],helpType:["ออนไลน์","ออฟไลน์"],frequency:["ทุกวัน","ทุกสัปดาห์","ทุกเดือน","ตามความต้องการ","อื่นๆ"]},messages:{messageSent:"ส่งข้อความสำเร็จแล้ว!",messageFailed:"การส่งข้อความล้มเหลว กรุณาลองใหม่อีกครั้ง",noMessages:"ยังไม่มีข้อความ",markRead:"ทำเครื่องหมายว่าอ่านแล้ว",delete:"ลบ",confirmDelete:"คุณแน่ใจหรือไม่ที่จะลบข้อความนี้? (เมื่อลบแล้วจะไม่สามารถกู้คืนได้)",inboxTitle:"受信メッセージ",messageFrom:"からメッセージ：",contactUser:"ユーザーに連絡",backToHome:"ホームへ戻る"},date:"วันที่",avatar:"รูปภาพ",name:"ชื่อ",gender:"เพศ",age:"อายุ",country:"ประเทศ"},ms:{sections:{provide:{title:"Saya boleh menyediakan bilik bantuan & kerjasama",desc:"Kongsi kepakaran, sumber atau bidang yang anda ingin bekerjasama, supaya lebih ramai orang dapat mencari anda.",btn:"Saya ingin menyediakan"},need:{title:"Saya memerlukan bantuan atau rumah kerjasama",desc:"Beritahu kami tentang kesukaran yang anda hadapi atau rakan kongsi yang anda ingin cari, supaya komuniti dapat menyokong anda.",btn:"Saya memerlukan bantuan"},supply:{title:"Bulatan bekalan bantuan & kerjasama",desc:"Semak imbas sumber bantuan dan kerjasama yang semua orang boleh sediakan, hubungi antara satu sama lain secara aktif.",btn:"Jelajah bulatan bekalan"},room:{title:"Masuk bilik bantuan bersama",desc:"Komunikasi masa nyata, pertumbuhan bersama",btn:"Masuk bilik bantuan bersama"}},modals:{provide:{title:"Saya boleh menyediakan bantuan & kerjasama",subtitle:"Dalam perjalanan memulakan semula, pengalaman dan kelebihan saya mungkin boleh membantu!",experience:"Pengalaman saya (pilihan berganda):",current:"Keadaan semasa saya (pilihan berganda):",target:"Orang yang saya ingin bantu terlebih dahulu (pilihan berganda):",helpType:"Saya boleh menyediakan bantuan dalam bentuk:",statement:"Pernyataan khas saya (dalam 50 aksara):",frequency:"Kekerapan saya boleh membantu:",cancel:"Batal",submit:"Hantar",other:"Lain-lain...",enterPlaceholder:"Sila masukkan...",messageTo:"Mesej kepada:",messagePlaceholder:"Sila masukkan mesej...",sendMessage:"Hantar mesej",messageSent:"Permintaan berjaya dihantar!",backToHome:"Kembali ke Laman Utama"},need:{title:"Saya memerlukan bantuan",subtitle:"Sila terangkan kesukaran yang anda hadapi atau bidang yang memerlukan bantuan, supaya rakan kongsi komuniti dapat membantu anda dengan lebih baik!",experience:"Pengalaman saya (pilihan berganda):",current:"Keadaan semasa saya (pilihan berganda):",target:"Orang yang saya ingin bantu terlebih dahulu (pilihan berganda):",helpType:"Saya boleh menyediakan bantuan dalam bentuk:",statement:"Pernyataan khas saya (dalam 50 aksara):",frequency:"Kekerapan saya boleh membantu:",cancel:"Batal",submit:"Hantar",other:"Lain-lain...",enterPlaceholder:"Sila masukkan...",messageTo:"Mesej kepada:",messagePlaceholder:"Sila masukkan mesej...",sendMessage:"Hantar mesej",messageSent:"Permintaan berjaya dihantar!",backToHome:"Kembali ke Laman Utama"}},options:{experience:["Keusahawanan berjaya","Pembinaan semula keluarga","Bimbingan pekerjaan","Bantuan undang-undang","Pengalaman pemulihan ketagihan","Sukarelawan","Perkhidmatan komuniti","Lain-lain"],advantage:["Kesukaran kewangan","Tiada pekerjaan tetap","Kekurangan sokongan keluarga","Masalah kesihatan","Pertikaian undang-undang","Tekanan psikologi","Kekurangan tempat tinggal","Kesukaran hubungan interpersonal","Sedang memulakan perniagaan","Lain-lain"],target:["Mencari kerja/bantuan pekerjaan","Bantuan kewangan kecemasan","Kaunseling psikologi/teman","Bantuan undang-undang","Bantuan perubatan","Bantuan tempat tinggal","Pembaikan keluarga","Sokongan ketagihan","Bantuan hubungan interpersonal","Pembinaan semula kehidupan","Bimbingan perniagaan","Lain-lain"],helpType:["Dalam talian","Luar talian"],frequency:["Setiap hari","Setiap minggu","Setiap bulan","Mengikut keperluan","Lain-lain"]},messages:{messageSent:"Mesej berjaya dihantar!",messageFailed:"Penghantaran mesej gagal, sila cuba lagi kemudian",noMessages:"Tiada mesej lagi",markRead:"Tandakan sebagai dibaca",delete:"Padam",confirmDelete:"Adakah anda pasti mahu memadamkan mesej ini? (Sebaik sahaja dipadamkan, ia tidak dapat dipulihkan)",inboxTitle:"受信メッセージ",messageFrom:"からメッセージ：",contactUser:"ユーザーに連絡",backToHome:"ホームへ戻る"},date:"Tarikh",avatar:"Avatar",name:"Nama",gender:"Jantina",age:"Umur",country:"Negara"},la:{sections:{provide:{title:"Possum praebere auxilium & cooperationis cubiculum",desc:"Partiri peritiam, opes vel regiones quas cooperari vis, ut plures te invenire possint.",btn:"Volo praebere"},need:{title:"Egeo auxilii vel cooperationis domus",desc:"Dic nobis de difficultatibus quas nunc patieris vel sociis quos quaeris, ut communitas te sustentare possit.",btn:"Egeo auxilii"},supply:{title:"Auxilii & cooperationis copiae circulus",desc:"Perlustra auxilii et cooperationis opes quas omnes praebere possunt, active inter se communicare.",btn:"Explora copiae circulum"},room:{title:"Intra mutuum auxilium cubiculum",desc:"Temporis realis communicatio, mutuus incrementum",btn:"Intra mutuum auxilium cubiculum"}},modals:{provide:{title:"Possum praebere auxilium & cooperationem",subtitle:"In itinere redintegrationis, mea experientia et commoda forsitan prodesse possunt!",experience:"Mea experientia (multiplex electio):",current:"Mea praesens condicio (multiplex electio):",target:"Homines quos primum adiuvare volo (multiplex electio):",helpType:"Possum praebere auxilium in forma:",statement:"Mea specialis declaratio (intra 50 characteres):",frequency:"Mea auxilii frequentia:",cancel:"Cancella",submit:"Submitte",other:"Alia...",enterPlaceholder:"Quaeso intra...",messageTo:"Nuntius ad:",messagePlaceholder:"Quaeso intra nuntium...",sendMessage:"Mitte nuntium",messageSent:"Petitio feliciter missa est!",backToHome:"Ad domum redire"},need:{title:"Egeo auxilii",subtitle:"Quaeso describe difficultates quas patieris vel regiones quae auxilio indigent, ut socii communitatis te melius adiuvare possint!",experience:"Mea experientia (multiplex electio):",current:"Mea praesens condicio (multiplex electio):",target:"Homines quos primum adiuvare volo (multiplex electio):",helpType:"Possum praebere auxilium in forma:",statement:"Mea specialis declaratio (intra 50 characteres):",frequency:"Mea auxilii frequentia:",cancel:"Cancella",submit:"Submitte",other:"Alia...",enterPlaceholder:"Quaeso intra...",messageTo:"Nuntius ad:",messagePlaceholder:"Quaeso intra nuntium...",sendMessage:"Mitte nuntium",messageSent:"Petitio feliciter missa est!",backToHome:"Ad domum redire"}},options:{experience:["Felix initium negotii","Familiae reconstructio","Orientatio laboris","Auxilium legale","Experientia liberationis ab addictione","Voluntarius","Servitium communitatis","Alia"],advantage:["Difficultates oeconomicae","Nullus labor fixus","Defectus sustentationis familiae","Problema sanitatis","Controversia legalis","Pressura psychologica","Defectus habitationis","Difficultates relationum","Nunc initium negotii faciens","Alia"],target:["Quaerere laborem/auxilium laboris","Auxilium oeconomicum urgentis","Consilium psychologicum/societas","Auxilium legale","Auxilium medicum","Auxilium habitationis","Reparatio familiae","Sustentatio liberationis","Auxilium relationum","Reconstructio vitae","Orientatio negotii","Alia"],helpType:["Online","Offline"],frequency:["Quotidie","Quot hebdomadis","Quot mensibus","Secundum necessitatem","Alia"]},messages:{messageSent:"Nuntius feliciter missus est!",messageFailed:"Missio nuntii defecit, quaeso postea denuo tenta",noMessages:"Nondum nuntii",markRead:"Nota ut lectum",delete:"Dele",confirmDelete:"Esne certus hunc nuntium delere velle? (Semel deletus, restitui non potest)",inboxTitle:"Inbox Messages",messageFrom:" sent you a message:",contactUser:"Contact User",backToHome:"Back to Home"},date:"Dies",avatar:"Imago",name:"Nomen",gender:"Genus",age:"Aetas",country:"Patria"}},q3=n=>{const e=en[n]||en["zh-TW"];return[{emoji:"🤝",title:e.sections.provide.title,desc:e.sections.provide.desc,btn:e.sections.provide.btn,color:"#e0f7fa"},{emoji:"🆘",title:e.sections.need.title,desc:e.sections.need.desc,btn:e.sections.need.btn,color:"#fff3e0"},{emoji:"🌐",title:e.sections.supply.title,desc:e.sections.supply.desc,btn:e.sections.supply.btn,color:"#e8f5e9"},{emoji:"🏠",title:e.sections.room.title,desc:e.sections.room.desc,btn:e.sections.room.btn,color:"#f3e5f5"}]},UI=n=>{const e={"zh-TW":{experience:["成功創業","家庭重建","就業輔導","法律協助","戒癮經驗","志工","社區服務","其他"],advantage:["經濟困難","無固定工作","缺乏家庭支持","健康問題","法律糾紛","心理壓力","缺乏居住地","人際關係困難","正在創業中","其他"],target:["找工作/就業協助","經濟急難救助","心理諮詢/陪伴","法律協助","醫療協助","住宿協助","家庭修復","戒癮支持","人際關係協助","生活重建","商業輔導","其他"],helpType:["線上","線下"],frequency:["每天","每週","每月","依需要者而定","其他"]},"zh-CN":{experience:["成功创业","家庭重建","就业辅导","法律协助","戒瘾经验","志工","社区服务","其他"],advantage:["经济困难","无固定工作","缺乏家庭支持","健康问题","法律纠纷","心理压力","缺乏居住地","人际关系困难","正在创业中","其他"],target:["找工作/就业协助","经济急难救助","心理咨询/陪伴","法律协助","医疗协助","住宿协助","家庭修复","戒瘾支持","人际关系协助","生活重建","商业辅导","其他"],helpType:["线上","线下"],frequency:["每天","每周","每月","依需要者而定","其他"]},en:{experience:["Successful entrepreneurship","Family reconstruction","Employment guidance","Legal assistance","Addiction recovery experience","Volunteer","Community service","Other"],advantage:["Financial difficulties","No fixed job","Lack of family support","Health problems","Legal disputes","Psychological pressure","Lack of housing","Interpersonal difficulties","Currently starting a business","Other"],target:["Job search/employment assistance","Emergency financial assistance","Psychological counseling/companionship","Legal assistance","Medical assistance","Housing assistance","Family repair","Addiction support","Interpersonal assistance","Life reconstruction","Business guidance","Other"],helpType:["Online","Offline"],frequency:["Daily","Weekly","Monthly","As needed","Other"]},ja:{experience:["成功した起業","家族の再構築","就職支援","法的支援","依存症回復経験","ボランティア","コミュニティサービス","その他"],advantage:["経済的困難","固定職なし","家族のサポート不足","健康問題","法的紛争","心理的プレッシャー","住居不足","人間関係の困難","現在起業中","その他"],target:["仕事探し/就職支援","緊急経済支援","心理カウンセリング/同伴","法的支援","医療支援","住居支援","家族修復","依存症支援","人間関係支援","生活再建","ビジネス指導","その他"],helpType:["オンライン","オフライン"],frequency:["毎日","毎週","毎月","必要に応じて","その他"]},ko:{experience:["성공한 창업","가족 재건","취업 지도","법적 지원","중독 회복 경험","자원봉사","커뮤니티 서비스","기타"],advantage:["경제적 어려움","고정 직업 없음","가족 지원 부족","건강 문제","법적 분쟁","심리적 압박","주거지 부족","인간관계 어려움","현재 창업 중","기타"],target:["일자리 찾기/취업 지원","긴급 경제 지원","심리 상담/동반","법적 지원","의료 지원","주거 지원","가족 회복","중독 지원","인간관계 지원","생활 재건","비즈니스 지도","기타"],helpType:["온라인","오프라인"],frequency:["매일","매주","매월","필요에 따라","기타"]},vi:{experience:["Khởi nghiệp thành công","Tái thiết gia đình","Hướng dẫn việc làm","Hỗ trợ pháp lý","Kinh nghiệm cai nghiện","Tình nguyện viên","Dịch vụ cộng đồng","Khác"],advantage:["Khó khăn tài chính","Không có việc làm cố định","Thiếu hỗ trợ gia đình","Vấn đề sức khỏe","Tranh chấp pháp lý","Áp lực tâm lý","Thiếu nơi ở","Khó khăn trong mối quan hệ","Đang khởi nghiệp","Khác"],target:["Tìm việc/hỗ trợ việc làm","Hỗ trợ tài chính khẩn cấp","Tư vấn tâm lý/đồng hành","Hỗ trợ pháp lý","Hỗ trợ y tế","Hỗ trợ nhà ở","Sửa chữa gia đình","Hỗ trợ cai nghiện","Hỗ trợ mối quan hệ","Tái thiết cuộc sống","Hướng dẫn kinh doanh","Khác"],helpType:["Trực tuyến","Ngoại tuyến"],frequency:["Hàng ngày","Hàng tuần","Hàng tháng","Theo nhu cầu","Khác"]},th:{experience:["การเริ่มต้นธุรกิจที่ประสบความสำเร็จ","การสร้างครอบครัวใหม่","การแนะแนวการจ้างงาน","การช่วยเหลือทางกฎหมาย","ประสบการณ์การเลิกเสพติด","อาสาสมัคร","บริการชุมชน","อื่นๆ"],advantage:["ความยากลำบากทางการเงิน","ไม่มีงานประจำ","ขาดการสนับสนุนจากครอบครัว","ปัญหาสุขภาพ","ข้อพิพาททางกฎหมาย","ความกดดันทางจิตใจ","ขาดที่อยู่อาศัย","ความยากลำบากในความสัมพันธ์","กำลังเริ่มต้นธุรกิจ","อื่นๆ"],target:["การหางาน/ความช่วยเหลือการจ้างงาน","ความช่วยเหลือทางการเงินฉุกเฉิน","การให้คำปรึกษาทางจิตวิทยา/การเป็นเพื่อน","การช่วยเหลือทางกฎหมาย","ความช่วยเหลือทางการแพทย์","ความช่วยเหลือที่อยู่อาศัย","การซ่อมแซมครอบครัว","การสนับสนุนการเลิกเสพติด","ความช่วยเหลือความสัมพันธ์","การสร้างชีวิตใหม่","การแนะแนวธุรกิจ","อื่นๆ"],helpType:["ออนไลน์","ออฟไลน์"],frequency:["ทุกวัน","ทุกสัปดาห์","ทุกเดือน","ตามความต้องการ","อื่นๆ"]},ms:{experience:["Keusahawanan berjaya","Pembinaan semula keluarga","Bimbingan pekerjaan","Bantuan undang-undang","Pengalaman pemulihan ketagihan","Sukarelawan","Perkhidmatan komuniti","Lain-lain"],advantage:["Kesukaran kewangan","Tiada pekerjaan tetap","Kekurangan sokongan keluarga","Masalah kesihatan","Pertikaian undang-undang","Tekanan psikologi","Kekurangan tempat tinggal","Kesukaran hubungan interpersonal","Sedang memulakan perniagaan","Lain-lain"],target:["Mencari kerja/bantuan pekerjaan","Bantuan kewangan kecemasan","Kaunseling psikologi/teman","Bantuan undang-undang","Bantuan perubatan","Bantuan tempat tinggal","Pembaikan keluarga","Sokongan ketagihan","Bantuan hubungan interpersonal","Pembinaan semula kehidupan","Bimbingan perniagaan","Lain-lain"],helpType:["Dalam talian","Luar talian"],frequency:["Setiap hari","Setiap minggu","Setiap bulan","Mengikut keperluan","Lain-lain"]},la:{experience:["Felix initium negotii","Familiae reconstructio","Orientatio laboris","Auxilium legale","Experientia liberationis ab addictione","Voluntarius","Servitium communitatis","Alia"],advantage:["Difficultates oeconomicae","Nullus labor fixus","Defectus sustentationis familiae","Problema sanitatis","Controversia legalis","Pressura psychologica","Defectus habitationis","Difficultates relationum","Nunc initium negotii faciens","Alia"],target:["Quaerere laborem/auxilium laboris","Auxilium oeconomicum urgentis","Consilium psychologicum/societas","Auxilium legale","Auxilium medicum","Auxilium habitationis","Reparatio familiae","Sustentatio liberationis","Auxilium relationum","Reconstructio vitae","Orientatio negotii","Alia"],helpType:["Online","Offline"],frequency:["Quotidie","Quot hebdomadis","Quot mensibus","Secundum necessitatem","Alia"]}};return e[n]||e["zh-TW"]};function H3({open:n,onClose:e,userInfo:t,onSubmit:r}){var le,te,xe,$,Q,G,ne,se,me,Ie,Pe,qe,Ge,be,ae,rt,Le,$e,fe,_e,Ce,ze,De,K,ie,q,Me,st,et,dt,Ht,je,Qe,Tt,vt,Bt,Dt,ke,W,Y,ee,ve,Te,Je,He,Ye,gt,mt,_t,xn,lr,Br,Xt,Gt,gr,wi,Si;const{lang:o}=Lt(),a=UI(o),[c,d]=v.useState([]),[h,m]=v.useState(""),[g,x]=v.useState([]),[S,j]=v.useState(""),[T,R]=v.useState([]),[I,F]=v.useState(""),[P,z]=v.useState(a.helpType[0]),[H,J]=v.useState(""),[O,L]=v.useState(a.frequency[0]),[C,A]=v.useState(""),[D,M]=v.useState(!1),[B,_]=v.useState(!1),[U,oe]=v.useState("");if(!n)return null;const X=(pt,cr,Qi)=>{cr(pt.includes(Qi)?pt.filter(Oc=>Oc!==Qi):[...pt,Qi])},ce=async pt=>{pt.preventDefault();try{console.log("ProvideModal 開始提交數據"),await r({exp:c,expOther:h,adv:g,advOther:S,target:T,targetOther:I,helpType:P,statement:H,freq:O,freqOther:C}),console.log("ProvideModal 數據提交成功")}catch(cr){console.error("ProvideModal 數據提交失敗:",cr)}};return i.jsx("div",{style:{position:"fixed",zIndex:9999,left:0,top:0,width:"100vw",height:"100vh",background:"rgba(40,40,80,0.18)",display:"flex",alignItems:"center",justifyContent:"center",padding:"16px"},children:i.jsxs("form",{onSubmit:ce,style:{background:"#fff",borderRadius:24,boxShadow:"0 8px 40px #6B5BFF33",padding:24,minWidth:360,width:"100%",maxWidth:"500px",position:"relative",display:"flex",flexDirection:"column",gap:18,maxHeight:"calc(100vh - 32px)"},children:[i.jsx("button",{type:"button",onClick:e,style:{position:"absolute",top:18,right:18,background:"none",border:"none",fontSize:26,color:"#888",cursor:"pointer",fontWeight:700,zIndex:1},children:"×"}),i.jsxs("div",{style:{overflow:"auto",flex:1,paddingRight:"8px",paddingBottom:"8px",maxHeight:"calc(100vh - 120px)"},children:[i.jsx("div",{style:{fontWeight:900,fontSize:22,color:"#6B5BFF",textAlign:"center",marginBottom:2},children:((xe=(te=(le=en[o])==null?void 0:le.modals)==null?void 0:te.provide)==null?void 0:xe.title)||"我可以提供幫助 & 合作"}),i.jsx("div",{style:{color:"#888",fontSize:15,textAlign:"center",marginBottom:8},children:((G=(Q=($=en[o])==null?void 0:$.modals)==null?void 0:Q.provide)==null?void 0:G.subtitle)||"在重啟路上，我的經歷和優勢也許可以幫上忙！"}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:14,marginBottom:6},children:[i.jsx("img",{src:t.avatarUrl,alt:"avatar",style:{width:54,height:54,borderRadius:"50%",border:"2px solid #e0e7ff",objectFit:"cover"}}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:2},children:[i.jsx("span",{style:{color:"#1976d2",fontWeight:700,cursor:"pointer",textDecoration:"underline"},onClick:()=>M(!0),children:t.nickname}),i.jsx("span",{style:{color:"#1976d2",fontWeight:500,cursor:"pointer",textDecoration:"underline"},onClick:()=>window.open(`mailto:${t.email}`),children:t.email}),i.jsxs("span",{style:{color:"#555",fontSize:14},children:[t.country,"｜",t.gender,"｜",t.age]})]})]}),i.jsx("div",{style:{fontWeight:700,marginTop:8,fontSize:15},children:((me=(se=(ne=en[o])==null?void 0:ne.modals)==null?void 0:se.provide)==null?void 0:me.experience)||"我的經歷（可複選）："}),i.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:8,fontSize:14},children:[a.experience.map(pt=>i.jsxs("label",{style:{display:"flex",alignItems:"center",gap:4,fontWeight:500},children:[i.jsx("input",{type:"checkbox",checked:c.includes(pt),onChange:()=>X(c,d,pt)}),pt]},pt)),i.jsx("input",{placeholder:((qe=(Pe=(Ie=en[o])==null?void 0:Ie.modals)==null?void 0:Pe.provide)==null?void 0:qe.other)||"其他...",value:h,onChange:pt=>m(pt.target.value),style:{border:"1px solid #e0e7ff",borderRadius:8,padding:"2px 8px",minWidth:60,fontSize:14}})]}),i.jsx("div",{style:{fontWeight:700,marginTop:8,fontSize:15},children:((ae=(be=(Ge=en[o])==null?void 0:Ge.modals)==null?void 0:be.provide)==null?void 0:ae.current)||"我的現狀(可複選)："}),i.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:8,fontSize:14},children:[a.advantage.map(pt=>i.jsxs("label",{style:{display:"flex",alignItems:"center",gap:4,fontWeight:500},children:[i.jsx("input",{type:"checkbox",checked:g.includes(pt),onChange:()=>X(g,x,pt)}),pt]},pt)),i.jsx("input",{placeholder:(($e=(Le=(rt=en[o])==null?void 0:rt.modals)==null?void 0:Le.provide)==null?void 0:$e.other)||"其他...",value:S,onChange:pt=>j(pt.target.value),style:{border:"1px solid #e0e7ff",borderRadius:8,padding:"2px 8px",minWidth:60,fontSize:14}})]}),i.jsx("div",{style:{fontWeight:700,marginTop:8,fontSize:15},children:((Ce=(_e=(fe=en[o])==null?void 0:fe.modals)==null?void 0:_e.provide)==null?void 0:Ce.target)||"我想優先幫助的對象（可複選）："}),i.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:8,fontSize:14},children:[a.target.map(pt=>i.jsxs("label",{style:{display:"flex",alignItems:"center",gap:4,fontWeight:500},children:[i.jsx("input",{type:"checkbox",checked:T.includes(pt),onChange:()=>X(T,R,pt)}),pt]},pt)),i.jsx("input",{placeholder:((K=(De=(ze=en[o])==null?void 0:ze.modals)==null?void 0:De.provide)==null?void 0:K.other)||"其他...",value:I,onChange:pt=>F(pt.target.value),style:{border:"1px solid #e0e7ff",borderRadius:8,padding:"2px 8px",minWidth:60,fontSize:14}})]}),i.jsx("div",{style:{fontWeight:700,marginTop:8,fontSize:15},children:((Me=(q=(ie=en[o])==null?void 0:ie.modals)==null?void 0:q.provide)==null?void 0:Me.helpType)||"我可以提供幫助形式："}),i.jsx("div",{style:{display:"flex",gap:16,fontSize:14},children:a.helpType.map(pt=>i.jsxs("label",{style:{display:"flex",alignItems:"center",gap:4,fontWeight:500},children:[i.jsx("input",{type:"radio",name:"helptype",checked:P===pt,onChange:()=>z(pt)}),pt]},pt))}),i.jsx("div",{style:{fontWeight:700,marginTop:8,fontSize:15},children:((dt=(et=(st=en[o])==null?void 0:st.modals)==null?void 0:et.provide)==null?void 0:dt.statement)||"我的特別聲明（50字內）："}),i.jsx("input",{maxLength:50,value:H,onChange:pt=>J(pt.target.value),placeholder:((Qe=(je=(Ht=en[o])==null?void 0:Ht.modals)==null?void 0:je.provide)==null?void 0:Qe.enterPlaceholder)||"請輸入...",style:{border:"1px solid #e0e7ff",borderRadius:8,padding:"4px 10px",fontSize:14}}),i.jsxs("div",{style:{color:"#888",fontSize:13,textAlign:"right",marginTop:-8},children:[H.length,"/50"]}),i.jsx("div",{style:{fontWeight:700,marginTop:8,fontSize:15},children:((Bt=(vt=(Tt=en[o])==null?void 0:Tt.modals)==null?void 0:vt.provide)==null?void 0:Bt.frequency)||"我可幫助的頻率："}),i.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:16,fontSize:14},children:[a.frequency.map(pt=>i.jsxs("label",{style:{display:"flex",alignItems:"center",gap:4,fontWeight:500,marginRight:12},children:[i.jsx("input",{type:"radio",name:"freq",checked:O===pt,onChange:()=>L(pt)}),pt]},pt)),i.jsx("input",{placeholder:((W=(ke=(Dt=en[o])==null?void 0:Dt.modals)==null?void 0:ke.provide)==null?void 0:W.other)||"其他...",value:C,onChange:pt=>A(pt.target.value),style:{border:"1px solid #e0e7ff",borderRadius:8,padding:"2px 8px",minWidth:60,fontSize:14}})]}),i.jsxs("div",{style:{display:"flex",gap:18,marginTop:18,justifyContent:"center",padding:"8px 0",minHeight:"44px",background:"#fff",zIndex:10,borderTop:"1px solid #f0f0f0"},children:[i.jsx("button",{type:"button",onClick:e,style:{background:"#eee",color:"#555",border:"none",borderRadius:18,padding:"8px 28px",fontWeight:700,fontSize:16,cursor:"pointer",minHeight:"44px",touchAction:"manipulation",flex:1,maxWidth:"120px"},children:((ve=(ee=(Y=en[o])==null?void 0:Y.modals)==null?void 0:ee.provide)==null?void 0:ve.cancel)||"取消"}),i.jsx("button",{type:"submit",style:{background:"linear-gradient(90deg, #6e8efb, #a777e3)",color:"#fff",border:"none",borderRadius:18,padding:"8px 28px",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:"0 2px 8px #a777e355",minHeight:"44px",touchAction:"manipulation",flex:1,maxWidth:"120px"},children:((He=(Je=(Te=en[o])==null?void 0:Te.modals)==null?void 0:Je.provide)==null?void 0:He.submit)||"送出"})]})]}),D&&i.jsx("div",{style:{position:"fixed",left:0,top:0,width:"100vw",height:"100vh",background:"rgba(40,40,80,0.18)",zIndex:1e4,display:"flex",alignItems:"center",justifyContent:"center"},children:i.jsxs("div",{style:{background:"#fff",borderRadius:18,boxShadow:"0 4px 24px #6B5BFF33",padding:28,minWidth:280,maxWidth:340,width:"90vw",position:"relative",display:"flex",flexDirection:"column",gap:12},children:[i.jsx("button",{type:"button",onClick:()=>M(!1),style:{position:"absolute",top:10,right:12,background:"none",border:"none",fontSize:22,color:"#888",cursor:"pointer",fontWeight:700},children:"×"}),i.jsxs("div",{style:{fontWeight:800,fontSize:18,color:"#6B5BFF",textAlign:"center",marginBottom:2},children:[((mt=(gt=(Ye=en[o])==null?void 0:Ye.modals)==null?void 0:gt.provide)==null?void 0:mt.messageTo)||"留言給：",t.nickname]}),i.jsx("textarea",{value:U,onChange:pt=>oe(pt.target.value),rows:3,maxLength:100,placeholder:((lr=(xn=(_t=en[o])==null?void 0:_t.modals)==null?void 0:xn.provide)==null?void 0:lr.messagePlaceholder)||"請輸入留言...",style:{border:"1px solid #e0e7ff",borderRadius:8,padding:"6px 10px",fontSize:15,resize:"none"}}),i.jsx("button",{onClick:async()=>{M(!1);try{await fetch("/api/send-message",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:U,toUid:t.uid,toEmail:t.email,toNickname:t.nickname,fromUid:window.currentUserUid||"",fromEmail:window.currentUserEmail||"",fromNickname:window.currentUserNickname||""})}),_(!0),setTimeout(()=>_(!1),1500)}catch{alert("留言發送失敗，請稍後再試")}},style:{background:"linear-gradient(90deg, #6e8efb, #a777e3)",color:"#fff",border:"none",borderRadius:14,padding:"6px 18px",fontWeight:700,fontSize:15,cursor:"pointer",alignSelf:"center"},children:((Gt=(Xt=(Br=en[o])==null?void 0:Br.modals)==null?void 0:Xt.provide)==null?void 0:Gt.sendMessage)||"送出留言"})]})}),B&&i.jsx("div",{style:{position:"fixed",left:0,top:0,width:"100vw",height:"100vh",background:"rgba(40,40,80,0.08)",zIndex:10001,display:"flex",alignItems:"center",justifyContent:"center"},children:i.jsx("div",{style:{background:"#fff",borderRadius:14,boxShadow:"0 2px 12px #ffb74d55",padding:"18px 32px",fontWeight:700,color:"#ff4d4f",fontSize:18},children:((Si=(wi=(gr=en[o])==null?void 0:gr.modals)==null?void 0:wi.provide)==null?void 0:Si.messageSent)||"需求已成功送出！"})})]})})}function $3({open:n,onClose:e,userInfo:t,onSubmit:r,showMsgSent:o}){const{lang:a}=Lt(),c=UI(a),[d,h]=v.useState([]),[m,g]=v.useState(""),[x,S]=v.useState([]),[j,T]=v.useState(""),[R,I]=v.useState([]),[F,P]=v.useState(""),[z,H]=v.useState(c.helpType[0]),[J,O]=v.useState(""),[L,C]=v.useState(c.frequency[0]),[A,D]=v.useState(""),[M,B]=v.useState(!1),[_,U]=v.useState(""),[oe,X]=v.useState(!1);if(!n)return null;const ce=(te,xe,$)=>{xe(te.includes($)?te.filter(Q=>Q!==$):[...te,$])},le=async te=>{te.preventDefault();try{console.log("NeedHelpModal 開始提交數據"),await r({exp:d,expOther:m,adv:x,advOther:j,target:R,targetOther:F,helpType:z,statement:J,freq:L,freqOther:A}),console.log("NeedHelpModal 數據提交成功")}catch(xe){console.error("NeedHelpModal 數據提交失敗:",xe)}};return i.jsx("div",{style:{position:"fixed",zIndex:9999,left:0,top:0,width:"100vw",height:"100vh",background:"rgba(40,40,80,0.18)",display:"flex",alignItems:"center",justifyContent:"center",padding:"16px"},children:i.jsxs("form",{onSubmit:le,style:{background:"#fff",borderRadius:24,boxShadow:"0 8px 40px #6B5BFF33",padding:24,minWidth:360,width:"100%",maxWidth:"500px",position:"relative",display:"flex",flexDirection:"column",gap:18,maxHeight:"calc(100vh - 32px)"},children:[i.jsx("button",{type:"button",onClick:e,style:{position:"absolute",top:18,right:18,background:"none",border:"none",fontSize:26,color:"#888",cursor:"pointer",fontWeight:700,zIndex:1},children:"×"}),i.jsxs("div",{style:{overflow:"auto",flex:1,paddingRight:"8px",paddingBottom:"8px",maxHeight:"calc(100vh - 120px)"},children:[i.jsx("div",{style:{fontWeight:900,fontSize:22,color:"#ff4d4f",textAlign:"center",marginBottom:2},children:"我需要幫助"}),i.jsx("div",{style:{color:"#888",fontSize:15,textAlign:"center",marginBottom:8},children:"請描述你遇到的困難或需要協助的地方，讓社群夥伴能更好幫助你！"}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:14,marginBottom:6},children:[i.jsx("img",{src:t.avatarUrl,alt:"avatar",style:{width:54,height:54,borderRadius:"50%",border:"2px solid #e0e7ff",objectFit:"cover"}}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:2},children:[i.jsx("span",{style:{color:"#1976d2",fontWeight:700,cursor:"pointer",textDecoration:"underline"},onClick:()=>B(!0),children:t.nickname}),i.jsx("span",{style:{color:"#1976d2",fontWeight:500,cursor:"pointer",textDecoration:"underline"},onClick:()=>window.open(`mailto:${t.email}`),children:t.email}),i.jsxs("span",{style:{color:"#555",fontSize:14},children:[t.country,"｜",t.gender,"｜",t.age]})]})]}),i.jsx("div",{style:{fontWeight:700,marginTop:8,fontSize:15},children:"我的經歷（可複選）："}),i.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:8,fontSize:14},children:[c.experience.map(te=>i.jsxs("label",{style:{display:"flex",alignItems:"center",gap:4,fontWeight:500},children:[i.jsx("input",{type:"checkbox",checked:d.includes(te),onChange:()=>ce(d,h,te)}),te]},te)),i.jsx("input",{placeholder:"其他...",value:m,onChange:te=>g(te.target.value),style:{border:"1px solid #e0e7ff",borderRadius:8,padding:"2px 8px",minWidth:60,fontSize:14}})]}),i.jsx("div",{style:{fontWeight:700,marginTop:8,fontSize:15},children:"我的現狀(可複選)："}),i.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:8,fontSize:14},children:[c.advantage.map(te=>i.jsxs("label",{style:{display:"flex",alignItems:"center",gap:4,fontWeight:500},children:[i.jsx("input",{type:"checkbox",checked:x.includes(te),onChange:()=>ce(x,S,te)}),te]},te)),i.jsx("input",{placeholder:"其他...",value:j,onChange:te=>T(te.target.value),style:{border:"1px solid #e0e7ff",borderRadius:8,padding:"2px 8px",minWidth:60,fontSize:14}})]}),i.jsx("div",{style:{fontWeight:700,marginTop:8,fontSize:15},children:"我遇到的困難/需求（可複選）："}),i.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:8,fontSize:14},children:[c.target.map(te=>i.jsxs("label",{style:{display:"flex",alignItems:"center",gap:4,fontWeight:500},children:[i.jsx("input",{type:"checkbox",checked:R.includes(te),onChange:()=>ce(R,I,te)}),te]},te)),i.jsx("input",{placeholder:"其他...",value:F,onChange:te=>P(te.target.value),style:{border:"1px solid #e0e7ff",borderRadius:8,padding:"2px 8px",minWidth:60,fontSize:14}})]}),i.jsx("div",{style:{fontWeight:700,marginTop:8,fontSize:15},children:"希望獲得協助形式："}),i.jsx("div",{style:{display:"flex",gap:16,fontSize:14},children:c.helpType.map(te=>i.jsxs("label",{style:{display:"flex",alignItems:"center",gap:4,fontWeight:500},children:[i.jsx("input",{type:"radio",name:"helptype",checked:z===te,onChange:()=>H(te)}),te]},te))}),i.jsx("div",{style:{fontWeight:700,marginTop:8,fontSize:15},children:"補充說明（50字內）："}),i.jsx("input",{maxLength:50,value:J,onChange:te=>O(te.target.value),placeholder:"請輸入...",style:{border:"1px solid #e0e7ff",borderRadius:8,padding:"4px 10px",fontSize:14}}),i.jsxs("div",{style:{color:"#888",fontSize:13,textAlign:"right",marginTop:-8},children:[J.length,"/50"]}),i.jsx("div",{style:{fontWeight:700,marginTop:8,fontSize:15},children:"希望獲得協助頻率："}),i.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:16,fontSize:14},children:[c.frequency.map(te=>i.jsxs("label",{style:{display:"flex",alignItems:"center",gap:4,fontWeight:500,marginRight:12},children:[i.jsx("input",{type:"radio",name:"freq",checked:L===te,onChange:()=>C(te)}),te]},te)),i.jsx("input",{placeholder:"其他...",value:A,onChange:te=>D(te.target.value),style:{border:"1px solid #e0e7ff",borderRadius:8,padding:"2px 8px",minWidth:60,fontSize:14}})]}),i.jsxs("div",{style:{display:"flex",gap:18,marginTop:18,justifyContent:"center",padding:"8px 0",minHeight:"44px",background:"#fff",zIndex:10,borderTop:"1px solid #f0f0f0"},children:[i.jsx("button",{type:"button",onClick:e,style:{background:"#eee",color:"#555",border:"none",borderRadius:18,padding:"8px 28px",fontWeight:700,fontSize:16,cursor:"pointer",minHeight:"44px",touchAction:"manipulation",flex:1,maxWidth:"120px"},children:"取消"}),i.jsx("button",{type:"submit",style:{background:"linear-gradient(90deg, #6e8efb, #a777e3)",color:"#fff",border:"none",borderRadius:18,padding:"8px 28px",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:"0 2px 8px #a777e355",minHeight:"44px",touchAction:"manipulation",flex:1,maxWidth:"120px"},children:"送出"})]})]}),M&&i.jsx("div",{style:{position:"fixed",left:0,top:0,width:"100vw",height:"100vh",background:"rgba(40,40,80,0.18)",zIndex:1e4,display:"flex",alignItems:"center",justifyContent:"center"},children:i.jsxs("div",{style:{background:"#fff",borderRadius:18,boxShadow:"0 4px 24px #6B5BFF33",padding:28,minWidth:280,maxWidth:340,width:"90vw",position:"relative",display:"flex",flexDirection:"column",gap:12},children:[i.jsx("button",{type:"button",onClick:()=>B(!1),style:{position:"absolute",top:10,right:12,background:"none",border:"none",fontSize:22,color:"#888",cursor:"pointer",fontWeight:700},children:"×"}),i.jsxs("div",{style:{fontWeight:800,fontSize:18,color:"#6B5BFF",textAlign:"center",marginBottom:2},children:["留言給：",t.nickname]}),i.jsx("textarea",{value:_,onChange:te=>U(te.target.value),rows:3,maxLength:100,placeholder:"請輸入留言...",style:{border:"1px solid #e0e7ff",borderRadius:8,padding:"6px 10px",fontSize:15,resize:"none"}}),i.jsx("button",{onClick:async()=>{B(!1);try{await fetch("/api/send-message",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:_,toUid:t.uid,toEmail:t.email,toNickname:t.nickname,fromUid:window.currentUserUid||"",fromEmail:window.currentUserEmail||"",fromNickname:window.currentUserNickname||""})}),X(!0),setTimeout(()=>X(!1),1500)}catch{alert("留言發送失敗，請稍後再試")}},style:{background:"linear-gradient(90deg, #6e8efb, #a777e3)",color:"#fff",border:"none",borderRadius:14,padding:"6px 18px",fontWeight:700,fontSize:15,cursor:"pointer",alignSelf:"center"},children:"送出留言"})]})}),oe&&i.jsx("div",{style:{position:"fixed",left:0,top:0,width:"100vw",height:"100vh",background:"rgba(40,40,80,0.08)",zIndex:10001,display:"flex",alignItems:"center",justifyContent:"center"},children:i.jsx("div",{style:{background:"#fff",borderRadius:14,boxShadow:"0 2px 12px #ffb74d55",padding:"18px 32px",fontWeight:700,color:"#ff4d4f",fontSize:18},children:"需求已成功送出！"})})]})})}function G3(){var ae,rt,Le,$e;const{lang:n}=Lt(),e=q3(n),t=fe=>{var Ce;const _e={"zh-TW":{title:"互相幫助&合作實驗室",provide:"提供幫助",supply:"供應圈",need:"需要幫助",room:"互助房",intro:"在重啟的路上，我們都需要彼此的支持。請選擇你想要參與的方式：",introNeed:"如果你正在經歷困難，請告訴我們，社群夥伴會主動協助你。",needBtn:"我需要幫助",rule:"※ 所有資訊僅供社群內部交流使用，請尊重彼此隱私",msgTo:"留言給：",msgPlaceholder:"請輸入留言...",msgSent:"留言發送成功！",backToHome:"返回首頁",back:"返回",date:"日期",avatar:"頭像",name:"名稱",gender:"性別",age:"年齡",country:"國家"},"zh-CN":{title:"互相帮助&合作实验室",provide:"提供帮助",supply:"供应圈",need:"需要帮助",room:"互助房",intro:"在重启的路上，我们都需要彼此的支持。请选择你想要参与的方式：",introNeed:"如果你正在经历困难，请告诉我们，社群伙伴会主动协助你。",needBtn:"我需要帮助",rule:"※ 所有信息仅供社群内部交流使用，请尊重彼此隐私",msgTo:"留言给：",msgPlaceholder:"请输入留言...",msgSent:"留言发送成功！",backToHome:"返回首页",back:"返回",date:"日期",avatar:"头像",name:"名称",gender:"性别",age:"年龄",country:"国家"},en:{title:"Mutual Help & Cooperation Laboratory",provide:"Provide Help",supply:"Supply Circle",need:"Need Help",room:"Mutual Aid Room",intro:"On the restart journey, we all need each other's support. Please choose how you want to participate:",introNeed:"If you are experiencing difficulties, please tell us, and community partners will actively assist you.",needBtn:"I Need Help",rule:"※ All information is for internal community communication only, please respect each other's privacy",msgTo:"Message to:",msgPlaceholder:"Please enter message...",msgSent:"Message sent successfully!",backToHome:"Back to Home",back:"Back",date:"Date",avatar:"Avatar",name:"Name",gender:"Gender",age:"Age",country:"Country"},ja:{title:"相互支援&協力実験室",provide:"支援を提供",supply:"供給サークル",need:"支援が必要",room:"相互扶助の部屋",intro:"再出発の道のりで、私たちは皆お互いのサポートが必要です。参加したい方法を選択してください：",introNeed:"困難を経験している場合は、お知らせください。コミュニティのパートナーが積極的にサポートします。",needBtn:"支援が必要です",rule:"※ すべての情報はコミュニティ内の交流のみに使用され、お互いのプライバシーを尊重してください",msgTo:"メッセージを送る：",msgPlaceholder:"メッセージを入力してください...",msgSent:"メッセージが正常に送信されました！",backToHome:"ホームへ戻る",back:"戻る",date:"日付",avatar:"アバター",name:"名前",gender:"性別",age:"年齢",country:"国"},ko:{title:"상호 도움&협력 실험실",provide:"도움 제공",supply:"공급 서클",need:"도움 필요",room:"상호 원조 방",intro:"재시작 여정에서 우리 모두는 서로의 지원이 필요합니다. 참여하고 싶은 방법을 선택하세요:",introNeed:"어려움을 겪고 있다면 알려주세요. 커뮤니티 파트너가 적극적으로 도와드릴 것입니다.",needBtn:"도움이 필요합니다",rule:"※ 모든 정보는 커뮤니티 내부 교류용으로만 사용되며, 서로의 개인정보를 존중해 주세요",msgTo:"메시지 보내기:",msgPlaceholder:"메시지를 입력하세요...",msgSent:"메시지가 성공적으로 전송되었습니다!",backToHome:"홈으로 돌아가기",back:"돌아가기",date:"날짜",avatar:"아바타",name:"이름",gender:"성별",age:"나이",country:"국가"},vi:{title:"Phòng thí nghiệm trợ giúp",provide:"Cung cấp trợ giúp",supply:"Vòng tròn cung cấp",need:"Cần trợ giúp",room:"Phòng hỗ trợ lẫn nhau",intro:"Trên hành trình khởi động lại, tất cả chúng ta đều cần sự hỗ trợ của nhau. Vui lòng chọn cách bạn muốn tham gia:",introNeed:"Nếu bạn đang gặp khó khăn, hãy cho chúng tôi biết, các đối tác cộng đồng sẽ tích cực hỗ trợ bạn.",needBtn:"Tôi cần trợ giúp",rule:"※ Tất cả thông tin chỉ dành cho giao tiếp nội bộ cộng đồng, vui lòng tôn trọng quyền riêng tư của nhau",msgTo:"Nhắn tin cho:",msgPlaceholder:"Vui lòng nhập tin nhắn...",msgSent:"Tin nhắn đã được gửi thành công!",backToHome:"Về trang chủ",back:"Quay lại",date:"Ngày",avatar:"Ảnh đại diện",name:"Tên",gender:"Giới tính",age:"Tuổi",country:"Quốc gia"},th:{title:"ห้องทดลองช่วยเหลือ",provide:"ให้ความช่วยเหลือ",supply:"วงกลมอุปทาน",need:"ต้องการความช่วยเหลือ",room:"ห้องช่วยเหลือซึ่งกันและกัน",intro:"ในการเดินทางเริ่มต้นใหม่ เราทุกคนต้องการการสนับสนุนจากกันและกัน กรุณาเลือกวิธีที่คุณต้องการมีส่วนร่วม:",introNeed:"หากคุณกำลังประสบความยากลำบาก กรุณาบอกเรา คู่ค้าชุมชนจะช่วยเหลือคุณอย่างกระตือรือร้น",needBtn:"ฉันต้องการความช่วยเหลือ",rule:"※ ข้อมูลทั้งหมดใช้สำหรับการสื่อสารภายในชุมชนเท่านั้น กรุณาเคารพความเป็นส่วนตัวของกันและกัน",msgTo:"ส่งข้อความถึง:",msgPlaceholder:"กรุณาป้อนข้อความ...",msgSent:"ส่งข้อความสำเร็จแล้ว!",backToHome:"กลับหน้าหลัก",back:"กลับ",date:"วันที่",avatar:"รูปโปรไฟล์",name:"ชื่อ",gender:"เพศ",age:"อายุ",country:"ประเทศ"},ms:{title:"Makmal Bantuan & Kerjasama Bersama",provide:"Sediakan Bantuan",supply:"Bulatan Bekalan",need:"Memerlukan Bantuan",room:"Bilik Bantuan Bersama",intro:"Dalam perjalanan memulakan semula, kita semua memerlukan sokongan antara satu sama lain. Sila pilih cara anda ingin mengambil bahagian:",introNeed:"Jika anda menghadapi kesukaran, sila beritahu kami, rakan kongsi komuniti akan membantu anda secara aktif.",needBtn:"Saya Memerlukan Bantuan",rule:"※ Semua maklumat adalah untuk komunikasi dalaman komuniti sahaja, sila hormati privasi antara satu sama lain",msgTo:"Mesej kepada:",msgPlaceholder:"Sila masukkan mesej...",msgSent:"Mesej berjaya dihantar!",backToHome:"Kembali ke Laman Utama",back:"Kembali",date:"Tarikh",avatar:"Avatar",name:"Nama",gender:"Jantina",age:"Umur",country:"Negara"},la:{title:"Laboratorium Auxilii",provide:"Praebere Auxilium",supply:"Copiae Circulus",need:"Egere Auxilii",room:"Mutuum Auxilium Cubiculum",intro:"In itinere redintegrationis, omnes indigemus sustentatione mutua. Quaeso elige quomodo participare vis:",introNeed:"Si difficultates patieris, quaeso nobis dic, socii communitatis te active adiuvabunt.",needBtn:"Egeo Auxilii",rule:"※ Omnia notitia ad communicationem internam communitatis tantum sunt, quaeso honora privaciam inter se",msgTo:"Nuntius ad:",msgPlaceholder:"Quaeso intra nuntium...",msgSent:"Nuntius feliciter missus est!",backToHome:"Ad domum redire",back:"Redire",date:"Dies",avatar:"Imago",name:"Nomen",gender:"Sexus",age:"Aetas",country:"Patria"}};return((Ce=_e[n])==null?void 0:Ce[fe])||_e["zh-TW"][fe]||fe},[r,o]=v.useState(!1),[a,c]=v.useState({avatarUrl:"/ctx-logo.png",nickname:"",email:"",country:"",gender:"",age:""}),[d,h]=v.useState("provide"),[m,g]=v.useState([]),[x,S]=v.useState(null),T=St(Po).currentUser,[R,I]=v.useState(""),[F,P]=v.useState(!1),[z,H]=v.useState(null),[J,O]=v.useState(""),[L,C]=v.useState(!1),[A,D]=v.useState(!1),[M,B]=v.useState([]),[_,U]=v.useState(""),[oe,X]=v.useState(!1),[ce,le]=v.useState(!1),[te,xe]=v.useState([]),[$,Q]=v.useState(!1),[G,ne]=v.useState({});v.useEffect(()=>{if(!T)return;(async()=>{try{const _e=await To(Pn(Wt,"profiles",T.uid)),Ce=_e.exists()?_e.data():{};let ze=!1;const De={};if(Ce.country||(De.country="台灣",ze=!0),Ce.gender||(De.gender="男",ze=!0),Ce.age||(De.age="30",ze=!0),ze){const{setDoc:K}=await vc(async()=>{const{setDoc:Me}=await Promise.resolve().then(()=>of);return{setDoc:Me}},void 0);await K(Pn(Wt,"profiles",T.uid),{...Ce,...De},{merge:!0});const ie=await To(Pn(Wt,"profiles",T.uid)),q=ie.exists()?ie.data():{};c({avatarUrl:q.avatar||T.photoURL||"/ctx-logo.png",nickname:q.nickname||T.displayName||"Restarter",email:q.email||T.email||"",country:q.country||"",gender:q.gender||"",age:q.age||""});return}c({avatarUrl:Ce.avatar||T.photoURL||"/ctx-logo.png",nickname:Ce.nickname||T.displayName||"Restarter",email:Ce.email||T.email||"",country:Ce.country||"",gender:Ce.gender||"",age:Ce.age||""})}catch{c({avatarUrl:T.photoURL||"/ctx-logo.png",nickname:T.displayName||"Restarter",email:T.email||"",country:"",gender:"",age:""})}})()},[T]);async function se(fe){try{if(console.log("開始保存提供幫助數據:",fe),console.log("用戶信息:",a),console.log("當前用戶:",T),!T){console.error("用戶未登入"),I("❌ 請先登入後再送出"),setTimeout(()=>I(""),3e3);return}const _e=await xs(En(Wt,"helpSupplies"),{...fe,type:"provide",avatarUrl:a.avatarUrl,nickname:a.nickname,email:a.email,country:a.country,gender:a.gender,age:a.age,createdAt:Yt.now(),uid:(T==null?void 0:T.uid)||""});console.log("數據保存成功，文檔ID:",_e.id),o(!1),I("🎉 已成功送出，感謝你的溫暖分享！"),setTimeout(()=>I(""),3e3),me()}catch(_e){console.error("保存提供幫助數據失敗:",_e),I("❌ 保存失敗，請稍後再試"),setTimeout(()=>I(""),3e3)}}async function me(){try{console.log("開始獲取供應圈列表");const fe=mr(En(Wt,"helpSupplies"),An("type","==","provide")),ze=(await Vr(fe)).docs.map(De=>({id:De.id,...De.data()})).sort((De,K)=>{var Me,st,et,dt;const ie=((st=(Me=De.createdAt)==null?void 0:Me.toDate)==null?void 0:st.call(Me))||new Date(De.createdAt);return(((dt=(et=K.createdAt)==null?void 0:et.toDate)==null?void 0:dt.call(et))||new Date(K.createdAt))-ie});console.log("獲取到的供應圈數據:",ze),g(ze)}catch(fe){console.error("獲取供應圈列表失敗:",fe),I("❌ 獲取數據失敗，請稍後再試"),setTimeout(()=>I(""),3e3)}}v.useEffect(()=>{d==="supply"&&me()},[d]);async function Ie(fe,_e){if(console.log("留言送出偵錯：",{user:T,fromUid:T==null?void 0:T.uid,toUid:fe==null?void 0:fe.uid,fromEmail:T==null?void 0:T.email,toEmail:fe==null?void 0:fe.email,content:_e}),!T){U("偵錯：user 為 null，請確認已登入");return}if(!T.uid){U("偵錯：user.uid 為空");return}if(!(fe!=null&&fe.uid)){U("偵錯：toUser.uid 為空");return}if(!_e.trim()){U("請輸入留言內容");return}X(!0),U("");try{await xs(En(Wt,"messages"),{toUid:fe.uid,toEmail:fe.email,toNickname:fe.nickname,fromUid:T.uid,fromEmail:T.email,fromNickname:a.nickname,content:_e,timestamp:Yt.now(),read:!1}),C(!0),setTimeout(()=>{P(!1),C(!1),O("")},1500)}catch(Ce){U("留言發送失敗，請稍後再試 (偵錯: "+((Ce==null?void 0:Ce.message)||Ce)+")")}finally{X(!1)}}async function Pe(){if(!T)return;const fe=mr(En(Wt,"messages"),An("toUid","==",T.uid),An("read","==",!1)),_e=await Vr(fe);B(_e.docs.map(Ce=>({id:Ce.id,...Ce.data()})))}v.useEffect(()=>{Pe()},[T,A]);async function qe(fe){await nf(Pn(Wt,"messages",fe),{read:!0}),Pe()}async function Ge(fe){try{if(console.log("開始保存需要幫助數據:",fe),console.log("用戶信息:",a),console.log("當前用戶:",T),!T){console.error("用戶未登入"),I("❌ 請先登入後再送出"),setTimeout(()=>I(""),3e3);return}const _e=await xs(En(Wt,"helpSupplies"),{...fe,type:"need",avatarUrl:a.avatarUrl,nickname:a.nickname,email:a.email,country:a.country,gender:a.gender,age:a.age,createdAt:Yt.now(),uid:(T==null?void 0:T.uid)||""});console.log("數據保存成功，文檔ID:",_e.id),Q(!0),setTimeout(()=>{Q(!1),le(!1)},1800),I("🎉 你的需求已送出，社群夥伴會看到！"),setTimeout(()=>I(""),3e3),be()}catch(_e){console.error("保存需要幫助數據失敗:",_e),I("❌ 保存失敗，請稍後再試"),setTimeout(()=>I(""),3e3)}}async function be(){try{console.log("開始獲取需要幫助列表");const fe=mr(En(Wt,"helpSupplies"),An("type","==","need")),ze=(await Vr(fe)).docs.map(De=>({id:De.id,...De.data()})).sort((De,K)=>{var Me,st,et,dt;const ie=((st=(Me=De.createdAt)==null?void 0:Me.toDate)==null?void 0:st.call(Me))||new Date(De.createdAt);return(((dt=(et=K.createdAt)==null?void 0:et.toDate)==null?void 0:dt.call(et))||new Date(K.createdAt))-ie});console.log("獲取到的需要幫助數據:",ze),xe(ze)}catch(fe){console.error("獲取需要幫助列表失敗:",fe),I("❌ 獲取數據失敗，請稍後再試"),setTimeout(()=>I(""),3e3)}}return v.useEffect(()=>{d==="room"&&be()},[d]),i.jsxs("div",{style:{minHeight:"100vh",background:"linear-gradient(135deg, #f8fafc 0%, #e0e7ff 100%)",padding:"0 0 48px 0",position:"relative"},children:[A&&i.jsxs(i.Fragment,{children:[i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.3)",zIndex:1e4},onClick:()=>D(!1)}),i.jsxs("div",{style:{position:"fixed",top:70,right:36,background:"#fff",borderRadius:18,boxShadow:"0 4px 24px #6B5BFF33",padding:24,minWidth:320,zIndex:10001},children:[i.jsx("div",{style:{fontWeight:900,fontSize:20,color:"#6B5BFF",marginBottom:12},children:((rt=(ae=en[n])==null?void 0:ae.messages)==null?void 0:rt.inboxTitle)||"站內訊息"}),M.length===0&&i.jsx("div",{style:{color:"#888",fontSize:15},children:(($e=(Le=en[n])==null?void 0:Le.messages)==null?void 0:$e.noMessages)||"目前沒有新訊息"}),M.map(fe=>{var _e,Ce,ze,De,K,ie,q,Me,st,et;return i.jsxs("div",{style:{background:"#f7f7ff",borderRadius:12,padding:12,marginBottom:12,boxShadow:"0 2px 8px #6B5BFF11",cursor:"pointer"},onClick:()=>{ne(dt=>({...dt,[fe.id]:!dt[fe.id]}))},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[i.jsxs("div",{style:{fontWeight:700,color:"#1976d2"},children:[fe.fromNickname," ",((Ce=(_e=en[n])==null?void 0:_e.messages)==null?void 0:Ce.messageFrom)||"給你的留言："]}),i.jsx("span",{style:{fontSize:12,color:"#888"},children:G[fe.id]?"收起":"展開"})]}),G[fe.id]&&i.jsxs("div",{style:{background:"rgba(255,255,255,0.8)",borderRadius:8,padding:12,marginBottom:8,border:"1px solid #e0e7ff"},children:[i.jsx("div",{style:{color:"#232946",marginBottom:8,lineHeight:"1.5"},children:fe.content}),i.jsx("div",{style:{color:"#888",fontSize:13,marginBottom:8},children:(ie=(De=(ze=fe.timestamp)==null?void 0:ze.toDate)==null?void 0:(K=De.call(ze)).toLocaleString)==null?void 0:ie.call(K)}),i.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:[i.jsx("a",{href:`mailto:${fe.fromEmail}`,style:{color:"#6B5BFF",fontWeight:700,textDecoration:"underline",fontSize:13},children:((Me=(q=en[n])==null?void 0:q.messages)==null?void 0:Me.contactUser)||"聯絡對方"}),i.jsx("button",{onClick:dt=>{dt.stopPropagation(),qe(fe.id)},style:{background:"#eee",color:"#6B5BFF",border:"none",borderRadius:6,padding:"4px 12px",fontWeight:700,fontSize:13,cursor:"pointer"},children:((et=(st=en[n])==null?void 0:st.messages)==null?void 0:et.markRead)||"標記已讀"})]})]}),!G[fe.id]&&i.jsx("div",{style:{color:"#666",fontSize:14,fontStyle:"italic"},children:fe.content.length>30?`${fe.content.substring(0,30)}...`:fe.content})]},fe.id)})]})]}),R&&i.jsx("div",{style:{position:"fixed",top:40,left:"50%",transform:"translateX(-50%)",background:"#fff",color:"#6B5BFF",fontWeight:700,fontSize:18,borderRadius:16,boxShadow:"0 4px 24px #6B5BFF22",padding:"18px 36px",zIndex:99999,textAlign:"center",letterSpacing:1},children:R}),i.jsx("button",{onClick:()=>window.location.href="/",style:{position:"absolute",top:"20px",left:"20px",zIndex:1e3,fontWeight:700,fontSize:16,padding:"8px 16px",borderRadius:8,border:"1.5px solid #6B5BFF",background:"#fff",color:"#6B5BFF",cursor:"pointer",minWidth:80,boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:t("back")}),i.jsx("div",{style:{width:"100%",maxWidth:700,margin:"20px auto 20px auto",padding:"16px 24px",background:"rgba(255,255,255,0.95)",borderRadius:16,boxShadow:"0 4px 20px rgba(0,0,0,0.1)",display:"flex",alignItems:"center",justifyContent:"center",position:"relative"},children:i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,justifyContent:"center"},children:[i.jsxs("h1",{style:{fontWeight:900,fontSize:18,color:"#6B5BFF",margin:0,lineHeight:1,textShadow:"0 2px 8px #6B5BFF88",textAlign:"center"},children:[i.jsx("span",{role:"img","aria-label":"helplab",children:"🧪"})," ",t("title")]}),i.jsxs("button",{onClick:()=>D(fe=>!fe),style:{background:"none",border:"none",cursor:"pointer",position:"relative",padding:"8px",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",marginLeft:8},children:[i.jsx("span",{style:{fontSize:24,color:"#6B5BFF"},children:"🔔"}),M.length>0&&i.jsx("span",{style:{position:"absolute",top:0,right:0,minWidth:18,height:18,background:"#ff4d4f",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",border:"2px solid #fff",color:"#fff",fontWeight:900,fontSize:13,padding:"0 5px",boxShadow:"0 2px 8px #ff4d4f88",zIndex:1},children:M.length})]})]})}),i.jsxs("div",{style:{maxWidth:600,margin:"0 auto",padding:"20px 16px 0 16px",background:"#fff",borderRadius:32,boxShadow:"0 8px 40px #b6b6f633, 0 1.5px 8px #6B5BFF22",border:"1.5px solid #e0e7ff"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:24,marginBottom:24},children:[i.jsx("button",{onClick:()=>h("provide"),style:{fontWeight:900,fontSize:18,color:d==="provide"?"#6B5BFF":"#888",background:"#fff",border:d==="provide"?"3px solid #6B5BFF":"2px solid #e0e7ff",borderRadius:16,boxShadow:"0 2px 8px #b6b6f633",padding:"8px 24px",cursor:"pointer",marginBottom:2},children:t("provide")}),i.jsx("button",{onClick:()=>h("supply"),style:{fontWeight:900,fontSize:18,color:d==="supply"?"#6B5BFF":"#888",background:"#fff",border:d==="supply"?"3px solid #6B5BFF":"2px solid #e0e7ff",borderRadius:16,boxShadow:"0 2px 8px #b6b6f633",padding:"8px 24px",cursor:"pointer",marginBottom:2},children:t("supply")}),i.jsx("button",{onClick:()=>h("need"),style:{fontWeight:900,fontSize:18,color:d==="need"?"#ff4d4f":"#888",background:"#fff",border:d==="need"?"3px solid #ff4d4f":"2px solid #e0e7ff",borderRadius:16,boxShadow:"0 2px 8px #ffb74d55",padding:"8px 24px",cursor:"pointer",marginBottom:2},children:t("need")}),i.jsx("button",{onClick:()=>h("room"),style:{fontWeight:900,fontSize:18,color:d==="room"?"#ff4d4f":"#888",background:"#fff",border:d==="room"?"3px solid #ff4d4f":"2px solid #e0e7ff",borderRadius:16,boxShadow:"0 2px 8px #ffb74d55",padding:"8px 24px",cursor:"pointer",marginBottom:2},children:t("room")})]}),d==="provide"&&i.jsxs(i.Fragment,{children:[i.jsx("p",{style:{textAlign:"center",color:"#555",fontSize:18,marginBottom:36},children:t("intro")}),i.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:32,justifyContent:"center"},children:e.map((fe,_e)=>i.jsxs("div",{style:{background:fe.color,borderRadius:20,boxShadow:"0 4px 24px #0001",padding:"32px 28px",minWidth:260,maxWidth:320,flex:"1 1 260px",display:"flex",flexDirection:"column",alignItems:"center",marginBottom:12},children:[i.jsx("div",{style:{fontSize:48,marginBottom:12},children:fe.emoji}),i.jsx("div",{style:{fontWeight:800,fontSize:22,marginBottom:8,color:"#333",letterSpacing:1},children:fe.title}),i.jsx("div",{style:{color:"#666",fontSize:15,marginBottom:18,textAlign:"center",minHeight:44},children:fe.desc}),_e===0?i.jsx("button",{onClick:()=>{h("provide"),o(!0)},style:{background:"linear-gradient(90deg, #6e8efb, #a777e3)",color:"#fff",border:"none",borderRadius:24,padding:"10px 28px",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:"0 2px 8px #a777e355",marginTop:"auto",transition:"background 0.2s"},children:fe.btn}):_e===1?i.jsx("button",{onClick:()=>{h("need"),le(!0)},style:{background:"linear-gradient(90deg, #ff4d4f, #ffb74d)",color:"#fff",border:"none",borderRadius:24,padding:"10px 28px",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:"0 2px 8px #ffb74d55",marginTop:"auto",transition:"background 0.2s"},children:fe.btn}):_e===2?i.jsx("button",{onClick:()=>h("supply"),style:{background:"linear-gradient(90deg, #6e8efb, #a777e3)",color:"#fff",border:"none",borderRadius:24,padding:"10px 28px",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:"0 2px 8px #a777e355",marginTop:"auto",transition:"background 0.2s"},children:fe.btn}):i.jsx("button",{onClick:()=>h("room"),style:{background:"linear-gradient(90deg, #ff4d4f, #ffb74d)",color:"#fff",border:"none",borderRadius:24,padding:"10px 28px",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:"0 2px 8px #ffb74d55",marginTop:"auto",transition:"background 0.2s"},children:fe.btn})]},_e))}),i.jsx("div",{style:{textAlign:"center",color:"#888",fontSize:15,marginTop:40},children:t("rule")}),i.jsx(H3,{open:r,onClose:()=>o(!1),userInfo:a,onSubmit:se})]}),d==="supply"&&i.jsx("div",{style:{marginTop:24},children:i.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:15,tableLayout:"fixed"},children:[i.jsxs("colgroup",{children:[i.jsx("col",{style:{width:"28%"}}),i.jsx("col",{style:{width:"14%"}}),i.jsx("col",{style:{width:"22%"}}),i.jsx("col",{style:{width:"12%"}}),i.jsx("col",{style:{width:"12%"}}),i.jsx("col",{style:{width:"12%"}})]}),i.jsx("thead",{children:i.jsxs("tr",{style:{background:"#f3f3ff",color:"#6B5BFF"},children:[i.jsx("th",{style:{padding:"8px 4px",textAlign:"left"},children:t("date")}),i.jsx("th",{style:{textAlign:"center"},children:t("avatar")}),i.jsx("th",{style:{textAlign:"left"},children:t("name")}),i.jsx("th",{style:{textAlign:"center"},children:t("gender")}),i.jsx("th",{style:{textAlign:"center"},children:t("age")}),i.jsx("th",{style:{textAlign:"center"},children:t("country")})]})}),i.jsx("tbody",{children:m.map((fe,_e)=>{var Ce,ze,De,K;return i.jsxs(Un.Fragment,{children:[i.jsxs("tr",{style:{cursor:"pointer",borderBottom:"1px solid #eee"},onClick:()=>S(x===_e?null:_e),children:[i.jsx("td",{children:((K=(De=(ze=(Ce=fe.createdAt)==null?void 0:Ce.toDate)==null?void 0:ze.call(Ce))==null?void 0:De.toLocaleString)==null?void 0:K.call(De))||""}),i.jsx("td",{children:i.jsx("img",{src:fe.avatarUrl||"/ctx-logo.png",alt:"avatar",style:{width:36,height:36,borderRadius:"50%"}})}),i.jsx("td",{style:{color:"#1976d2",fontWeight:700,textDecoration:"underline",cursor:"pointer"},onClick:()=>{H(fe),P(!0)},children:fe.nickname}),i.jsx("td",{children:fe.gender}),i.jsx("td",{children:fe.age}),i.jsx("td",{children:fe.country})]}),x===_e&&i.jsx("tr",{children:i.jsxs("td",{colSpan:6,style:{background:"#f8f8ff",padding:18},children:[i.jsx("div",{style:{fontWeight:700,color:"#6B5BFF",marginBottom:8},children:"【你的困難也是我們的困難，讓我們一起面對並解決】"}),i.jsxs("div",{style:{marginBottom:8},children:[i.jsx("b",{children:"經歷："}),(fe.exp||[]).join("、"),fe.expOther?`、${fe.expOther}`:""]}),i.jsxs("div",{style:{marginBottom:8},children:[i.jsx("b",{children:"優勢："}),(fe.adv||[]).join("、"),fe.advOther?`、${fe.advOther}`:""]}),i.jsxs("div",{style:{marginBottom:8},children:[i.jsx("b",{children:"優先幫助對象："}),(fe.target||[]).join("、"),fe.targetOther?`、${fe.targetOther}`:""]}),i.jsxs("div",{style:{marginBottom:8},children:[i.jsx("b",{children:"幫助形式："}),fe.helpType]}),i.jsxs("div",{style:{marginBottom:8},children:[i.jsx("b",{children:"特別聲明："}),fe.statement]}),i.jsxs("div",{style:{marginBottom:8},children:[i.jsx("b",{children:"幫助頻率："}),fe.freq,fe.freqOther?`、${fe.freqOther}`:""]}),i.jsx("div",{style:{marginTop:12},children:i.jsx("a",{href:`mailto:${fe.email}`,style:{color:"#6B5BFF",textDecoration:"underline",marginLeft:12},children:fe.email})})]})})]},fe.id)})})]})}),d==="need"&&i.jsxs(i.Fragment,{children:[i.jsx("p",{style:{textAlign:"center",color:"#555",fontSize:18,marginBottom:36},children:t("introNeed")}),i.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:32,justifyContent:"center"},children:i.jsx("button",{onClick:()=>le(!0),style:{background:"linear-gradient(90deg, #ff4d4f, #ffb74d)",color:"#fff",border:"none",borderRadius:24,padding:"10px 28px",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:"0 2px 8px #ffb74d55",marginTop:"auto",transition:"background 0.2s"},children:t("needBtn")})}),i.jsx($3,{open:ce,onClose:()=>le(!1),userInfo:a,onSubmit:Ge,showMsgSent:$})]}),d==="room"&&i.jsx("div",{style:{marginTop:24},children:i.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:15},children:[i.jsx("thead",{children:i.jsxs("tr",{style:{background:"#fff3e0",color:"#ff4d4f"},children:[i.jsx("th",{style:{padding:"8px 4px",textAlign:"left"},children:t("date")}),i.jsx("th",{style:{textAlign:"center"},children:t("avatar")}),i.jsx("th",{style:{textAlign:"left"},children:t("name")}),i.jsx("th",{style:{textAlign:"center"},children:t("gender")}),i.jsx("th",{style:{textAlign:"center"},children:t("age")}),i.jsx("th",{style:{textAlign:"center"},children:t("country")})]})}),i.jsx("tbody",{children:te.map((fe,_e)=>{var Ce,ze,De,K;return i.jsxs(Un.Fragment,{children:[i.jsxs("tr",{style:{cursor:"pointer",borderBottom:"1px solid #eee"},onClick:()=>S(x===_e?null:_e),children:[i.jsx("td",{children:((K=(De=(ze=(Ce=fe.createdAt)==null?void 0:Ce.toDate)==null?void 0:ze.call(Ce))==null?void 0:De.toLocaleString)==null?void 0:K.call(De))||""}),i.jsx("td",{children:i.jsx("img",{src:fe.avatarUrl||"/ctx-logo.png",alt:"avatar",style:{width:36,height:36,borderRadius:"50%"}})}),i.jsx("td",{style:{color:"#ff4d4f",fontWeight:700,textDecoration:"underline",cursor:"pointer"},onClick:()=>{H(fe),P(!0)},children:fe.nickname}),i.jsx("td",{children:fe.gender}),i.jsx("td",{children:fe.age}),i.jsx("td",{children:fe.country})]}),x===_e&&i.jsx("tr",{children:i.jsxs("td",{colSpan:6,style:{background:"#fff8f0",padding:18},children:[i.jsx("div",{style:{fontWeight:700,color:"#ff4d4f",marginBottom:8},children:"【你的困難我們一起面對，社群夥伴會主動協助你】"}),i.jsxs("div",{style:{marginBottom:8},children:[i.jsx("b",{children:"經歷："}),(fe.exp||[]).join("、"),fe.expOther?`、${fe.expOther}`:""]}),i.jsxs("div",{style:{marginBottom:8},children:[i.jsx("b",{children:"優勢："}),(fe.adv||[]).join("、"),fe.advOther?`、${fe.advOther}`:""]}),i.jsxs("div",{style:{marginBottom:8},children:[i.jsx("b",{children:"困難/需求："}),(fe.target||[]).join("、"),fe.targetOther?`、${fe.targetOther}`:""]}),i.jsxs("div",{style:{marginBottom:8},children:[i.jsx("b",{children:"協助形式："}),fe.helpType]}),i.jsxs("div",{style:{marginBottom:8},children:[i.jsx("b",{children:"補充說明："}),fe.statement]}),i.jsxs("div",{style:{marginBottom:8},children:[i.jsx("b",{children:"協助頻率："}),fe.freq,fe.freqOther?`、${fe.freqOther}`:""]}),i.jsx("div",{style:{marginTop:12},children:i.jsx("a",{href:`mailto:${fe.email}`,style:{color:"#ff4d4f",textDecoration:"underline",marginLeft:12},children:fe.email})})]})})]},fe.id)})})]})})]}),F&&z&&i.jsx("div",{style:{position:"fixed",left:0,top:0,width:"100vw",height:"100vh",background:"rgba(40,40,80,0.18)",zIndex:1e4,display:"flex",alignItems:"center",justifyContent:"center"},children:i.jsxs("div",{style:{background:"#fff",borderRadius:18,boxShadow:"0 4px 24px #6B5BFF33",padding:28,minWidth:280,maxWidth:340,width:"90vw",position:"relative",display:"flex",flexDirection:"column",gap:12},children:[i.jsx("button",{type:"button",onClick:()=>P(!1),style:{position:"absolute",top:10,right:12,background:"none",border:"none",fontSize:22,color:"#888",cursor:"pointer",fontWeight:700},children:"×"}),i.jsxs("div",{style:{fontWeight:800,fontSize:18,color:"#6B5BFF",textAlign:"center",marginBottom:2},children:[t("msgTo"),z.nickname]}),i.jsx("textarea",{value:J,onChange:fe=>O(fe.target.value),rows:3,maxLength:100,placeholder:t("msgPlaceholder"),style:{border:"1px solid #e0e7ff",borderRadius:8,padding:"6px 10px",fontSize:15,resize:"none"}}),_&&i.jsx("div",{style:{color:"#ff4d4f",fontWeight:700,textAlign:"center",marginTop:4},children:_}),i.jsx("button",{onClick:()=>Ie(z,J),disabled:!J.trim()||oe,style:{background:"linear-gradient(90deg, #6e8efb, #a777e3)",color:"#fff",border:"none",borderRadius:14,padding:"6px 18px",fontWeight:700,fontSize:15,cursor:!J.trim()||oe?"not-allowed":"pointer",alignSelf:"center",opacity:!J.trim()||oe?.6:1},children:oe?"送出中...":"送出留言"}),L&&i.jsx("div",{style:{color:"#6B5BFF",fontWeight:700,textAlign:"center",marginTop:8},children:t("msgSent")})]})}),i.jsx("div",{style:{width:"100%",margin:"0 auto",marginTop:24,background:"rgba(255,255,255,0.95)",borderRadius:16,padding:"16px",boxShadow:"0 2px 12px #6B5BFF22"},children:i.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:20,flexWrap:"wrap"},children:[i.jsx("a",{href:"/about",style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12},children:n==="zh-TW"?"🧬 Restarter™｜我們是誰":n==="zh-CN"?"🧬 Restarter™｜我们是谁":n==="en"?"🧬 Restarter™｜Who We Are":n==="ja"?"🧬 Restarter™｜私たちについて":n==="ko"?"🧬 Restarter™｜우리는 누구인가":n==="th"?"🧬 Restarter™｜เราเป็นใคร":n==="vi"?"🧬 Restarter™｜Chúng tôi là ai":n==="ms"?"🧬 Restarter™｜Siapa Kami":"🧬 Restarter™｜Quis sumus"}),i.jsx("a",{href:"/privacy-policy",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12},children:n==="zh-TW"?"隱私權政策":n==="zh-CN"?"隐私政策":n==="en"?"Privacy Policy":n==="ja"?"プライバシーポリシー":n==="ko"?"개인정보 처리방침":n==="th"?"นโยบายความเป็นส่วนตัว":n==="vi"?"Chính sách bảo mật":n==="ms"?"Dasar Privasi":"Consilium de Privata"}),i.jsx("a",{href:"/terms",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12},children:n==="zh-TW"?"條款/聲明":n==="zh-CN"?"条款/声明":n==="en"?"Terms/Statement":n==="ja"?"規約/声明":n==="ko"?"약관/성명":n==="th"?"ข้อกำหนด/แถลงการณ์":n==="vi"?"Điều khoản/Tuyên bố":n==="ms"?"Terma/Pernyataan":"Termini/Declaratio"}),i.jsx("a",{href:"/data-deletion",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12},children:n==="zh-TW"?"資料刪除說明":n==="zh-CN"?"数据删除说明":n==="en"?"Data Deletion":n==="ja"?"データ削除について":n==="ko"?"데이터 삭제 안내":n==="th"?"คำอธิบายการลบข้อมูล":n==="vi"?"Giải thích xóa dữ liệu":n==="ms"?"Penjelasan Penghapusan Data":"Explicatio Deletionis Datae"}),i.jsx("a",{href:"/feedback",style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12},children:n==="zh-TW"?"💬 意見箱｜我們想聽你說":n==="zh-CN"?"💬 意见箱｜我们想听你说":n==="en"?"💬 Feedback Box｜We Want to Hear From You":n==="ja"?"💬 ご意見箱｜私たちはあなたの声を聞きたい":n==="ko"?"💬 피드백｜우리는 당신의 말을 듣고 싶습니다":n==="th"?"💬 กล่องความคิดเห็น｜เราอยากได้ยินจากคุณ":n==="vi"?"💬 Hộp góp ý｜Chúng tôi muốn nghe từ bạn":n==="ms"?"💬 Kotak Maklum Balas｜Kami Ingin Mendengar Dari Anda":"💬 Arca Consilii｜Volumus Audire a Te"})]})})]})}const Wd=(n,e)=>{try{localStorage.setItem(`emotionRelease_${n}`,JSON.stringify(e))}catch{console.log("無法保存遊戲進度到本地存儲")}},Vd=n=>{try{const e=localStorage.getItem(`emotionRelease_${n}`);return e?JSON.parse(e):null}catch{return console.log("無法從本地存儲載入遊戲進度"),null}};function K3(){const{lang:n}=Lt(),[e,t]=v.useState(null),[r,o]=v.useState(!1);v.useEffect(()=>{const h=new Image;h.onload=()=>o(!0),h.onerror=()=>o(!0);const m=setTimeout(()=>{o(!0)},3e3);return h.src="/stress.png",()=>clearTimeout(m)},[]);const a=h=>{var g;const m={"zh-TW":{title:"情緒發洩區",subtitle:"選擇適合的遊戲來釋放你的情緒",farm:"生活農場",farmDesc:"點擊種植，感受成長的喜悅",whackAMole:"打地鼠",whackAMoleDesc:"快速點擊，釋放壓力",fruitPicking:"採水果",fruitPickingDesc:"點擊收集，享受豐收",targetShooting:"情緒泡泡爆破",targetShootingDesc:"戳破情緒泡泡，釋放內心壓力",racing:"極速賽車",racingDesc:"駕駛賽車，體驗速度與激情",rhythm:"音樂節奏",rhythmDesc:"跟隨節奏，釋放音樂能量",rules:"遊戲規則",back:"返回",start:"開始遊戲",close:"關閉"},"zh-CN":{title:"情绪发泄区",subtitle:"选择适合的游戏来释放你的情绪",farm:"生活农场",farmDesc:"点击种植，感受成长的喜悦",whackAMole:"打地鼠",whackAMoleDesc:"快速点击，释放压力",fruitPicking:"采水果",fruitPickingDesc:"点击收集，享受丰收",targetShooting:"飞靶射击",targetShootingDesc:"瞄准射击，提升专注力",racing:"极速赛车",racingDesc:"驾驶赛车，体验速度与激情",rhythm:"音乐节奏",rhythmDesc:"跟随节奏，释放音乐能量",rules:"游戏规则",back:"返回",start:"开始游戏",close:"关闭"},en:{title:"Emotion Release Zone",subtitle:"Choose a game to release your emotions",farm:"Life Farm",farmDesc:"Click to plant, feel the joy of growth",whackAMole:"Whack-a-Mole",whackAMoleDesc:"Quick clicks to release stress",fruitPicking:"Fruit Picking",fruitPickingDesc:"Click to collect, enjoy the harvest",targetShooting:"Target Shooting",targetShootingDesc:"Aim and shoot, improve focus",racing:"Speed Racing",racingDesc:"Drive racing cars, experience speed and excitement",rhythm:"Music Rhythm",rhythmDesc:"Follow the rhythm, release musical energy",rules:"Game Rules",back:"Back",start:"Start Game",close:"Close"},ja:{title:"感情発散エリア",subtitle:"感情を解放するゲームを選択してください",farm:"ライフファーム",farmDesc:"クリックして植える、成長の喜びを感じる",whackAMole:"モグラたたき",whackAMoleDesc:"素早くクリックしてストレスを解放",fruitPicking:"フルーツ収穫",fruitPickingDesc:"クリックして収穫、収穫を楽しむ",targetShooting:"ターゲット射撃",targetShootingDesc:"狙って撃つ、集中力を向上",racing:"スピードレーシング",racingDesc:"レーシングカーを運転、スピードと興奮を体験",rhythm:"音楽リズム",rhythmDesc:"リズムに合わせて、音楽エネルギーを解放",rules:"ゲームルール",back:"戻る",start:"ゲーム開始",close:"閉じる"},ko:{title:"감정 발산 구역",subtitle:"감정을 해방할 게임을 선택하세요",farm:"라이프 팜",farmDesc:"클릭하여 심고, 성장의 기쁨을 느끼세요",whackAMole:"두더지 잡기",whackAMoleDesc:"빠르게 클릭하여 스트레스를 해방하세요",fruitPicking:"과일 수확",fruitPickingDesc:"클릭하여 수확하고, 수확의 기쁨을 누리세요",targetShooting:"타겟 사격",targetShootingDesc:"조준하고 쏘기, 집중력 향상",racing:"스피드 레이싱",racingDesc:"레이싱카 운전, 속도와 흥분을 경험",rhythm:"음악 리듬",rhythmDesc:"리듬에 맞춰 음악 에너지를 해방",rules:"게임 규칙",back:"돌아가기",start:"게임 시작",close:"닫기"},vi:{title:"Khu Vực Giải Tỏa Cảm Xúc",subtitle:"Chọn trò chơi để giải tỏa cảm xúc của bạn",farm:"Nông Trại Cuộc Sống",farmDesc:"Nhấp để trồng, cảm nhận niềm vui của sự phát triển",whackAMole:"Đập Chuột",whackAMoleDesc:"Nhấp nhanh để giải tỏa căng thẳng",fruitPicking:"Hái Trái Cây",fruitPickingDesc:"Nhấp để thu hoạch, tận hưởng mùa màng",targetShooting:"Bắn Bia",targetShootingDesc:"Nhắm và bắn, cải thiện sự tập trung",racing:"Đua Xe Tốc Độ",racingDesc:"Lái xe đua, trải nghiệm tốc độ và sự phấn khích",rhythm:"Nhịp Điệu Âm Nhạc",rhythmDesc:"Theo nhịp điệu, giải phóng năng lượng âm nhạc",rules:"Luật Chơi",back:"Quay Lại",start:"Bắt Đầu Trò Chơi",close:"Đóng"},th:{title:"พื้นที่ระบายอารมณ์",subtitle:"เลือกเกมเพื่อระบายอารมณ์ของคุณ",farm:"ฟาร์มชีวิต",farmDesc:"คลิกเพื่อปลูก รู้สึกถึงความสุขของการเติบโต",whackAMole:"ตีตุ่น",whackAMoleDesc:"คลิกเร็วเพื่อระบายความเครียด",fruitPicking:"เก็บผลไม้",fruitPickingDesc:"คลิกเพื่อเก็บเกี่ยว สนุกกับการเก็บเกี่ยว",targetShooting:"ยิงเป้า",targetShootingDesc:"เล็งและยิง ปรับปรุงสมาธิ",racing:"แข่งรถความเร็ว",racingDesc:"ขับรถแข่ง ประสบการณ์ความเร็วและความตื่นเต้น",rhythm:"จังหวะดนตรี",rhythmDesc:"ตามจังหวะ ปลดปล่อยพลังงานดนตรี",rules:"กฎเกม",back:"กลับ",start:"เริ่มเกม",close:"ปิด"},la:{title:"Zona Emotio Liberationis",subtitle:"Elige ludum ad liberationem emotionum tuarum",farm:"Villa Vitae",farmDesc:"Clicca ad plantandum, senti gaudium incrementi",whackAMole:"Talpa Percutere",whackAMoleDesc:"Clicca celeriter ad liberationem tensionis",fruitPicking:"Fructus Colligere",fruitPickingDesc:"Clicca ad colligendum, fruere messe",targetShooting:"Scopum Iaculare",targetShootingDesc:"Intende et iacula, meliora attentionem",racing:"Cursus Velocitatis",racingDesc:"Guberna currus cursus, experire velocitatem et excitationem",rhythm:"Rhythmus Musicae",rhythmDesc:"Sequere rhythmum, libera energiam musicam",rules:"Regulae Ludi",back:"Regredi",start:"Ludum Incipere",close:"Claudere"},ms:{title:"Zon Pelepasan Emosi",subtitle:"Pilih permainan untuk melepaskan emosi anda",farm:"Ladang Kehidupan",farmDesc:"Klik untuk menanam, rasakan kegembiraan pertumbuhan",whackAMole:"Pukul Tikus",whackAMoleDesc:"Klik pantas untuk melepaskan tekanan",fruitPicking:"Kutip Buah",fruitPickingDesc:"Klik untuk mengutip, nikmati hasil tuaian",targetShooting:"Tembak Sasaran",targetShootingDesc:"Arah dan tembak, tingkatkan fokus",racing:"Lumba Kereta Laju",racingDesc:"Pandu kereta lumba, alami kelajuan dan keseronokan",rhythm:"Irama Muzik",rhythmDesc:"Ikut irama, lepaskan tenaga muzik",rules:"Peraturan Permainan",back:"Kembali",start:"Mulakan Permainan",close:"Tutup"}};return((g=m[n])==null?void 0:g[h])||m["zh-TW"][h]||h},c=[{id:"farm",title:a("farm"),description:a("farmDesc"),icon:"🌱",color:"#4CAF50"},{id:"whackAMole",title:a("whackAMole"),description:a("whackAMoleDesc"),icon:"🔨",color:"#FF5722"},{id:"fruitPicking",title:a("fruitPicking"),description:a("fruitPickingDesc"),icon:"🍎",color:"#FF9800"},{id:"targetShooting",title:a("targetShooting"),description:a("targetShootingDesc"),icon:"🫧",color:"#9C27B0"},{id:"racing",title:a("racing"),description:a("racingDesc"),icon:"🏎️",color:"#E91E63"},{id:"rhythm",title:a("rhythm"),description:a("rhythmDesc"),icon:"🎵",color:"#00BCD4"}],d=()=>{switch(e){case"farm":return i.jsx(Q3,{onClose:()=>t(null)});case"whackAMole":return i.jsx(Y3,{onClose:()=>t(null)});case"fruitPicking":return i.jsx(X3,{onClose:()=>t(null)});case"targetShooting":return i.jsx(J3,{onClose:()=>t(null)});case"racing":return i.jsx(Z3,{onClose:()=>t(null)});case"rhythm":return i.jsx(eM,{onClose:()=>t(null)});default:return null}};return i.jsxs("div",{style:{minHeight:"100vh",background:r?"linear-gradient(135deg, rgba(102, 126, 234, 0.8) 0%, rgba(118, 75, 162, 0.8) 100%), url('/stress.png')":"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat",padding:"clamp(10px, 2vw, 20px)",fontFamily:"Arial, sans-serif",boxSizing:"border-box",position:"relative"},children:[!r&&i.jsxs("div",{style:{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",background:"rgba(255,255,255,0.9)",padding:"20px",borderRadius:"10px",zIndex:2e3,textAlign:"center"},children:[i.jsx("div",{style:{fontSize:"18px",marginBottom:"10px"},children:"載入中..."}),i.jsx("div",{style:{width:"40px",height:"40px",border:"4px solid #f3f3f3",borderTop:"4px solid #667eea",borderRadius:"50%",margin:"0 auto",animation:"spin 1s linear infinite"}}),i.jsx("style",{children:`
            @keyframes spin {
              0% { transform: rotate(0deg); }
              100% { transform: rotate(360deg); }
            }
          `})]}),!e&&i.jsxs("button",{onClick:()=>{console.log("返回按鈕被點擊"),window.history.back()},style:{position:"absolute",top:"clamp(20px, 4vw, 40px)",left:"clamp(20px, 4vw, 40px)",zIndex:9999,background:"rgba(255,255,255,0.9)",border:"none",borderRadius:"25px",padding:"clamp(8px, 2vw, 12px) clamp(16px, 3vw, 24px)",fontSize:"clamp(14px, 2.5vw, 18px)",fontWeight:"bold",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",color:"#667eea",transition:"all 0.3s ease",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",pointerEvents:"auto"},onMouseEnter:h=>{h.currentTarget.style.background="#667eea",h.currentTarget.style.color="#fff",h.currentTarget.style.transform="translateY(-2px)"},onMouseLeave:h=>{h.currentTarget.style.background="rgba(255,255,255,0.9)",h.currentTarget.style.color="#667eea",h.currentTarget.style.transform="translateY(0)"},children:["← ",a("back")]}),e?i.jsx("div",{style:{position:"relative",height:"100vh"},children:d()}):i.jsxs("div",{style:{maxWidth:"1200px",margin:"0 auto"},children:[i.jsxs("div",{style:{textAlign:"center",marginBottom:"clamp(20px, 4vw, 40px)",marginTop:"clamp(60px, 8vw, 80px)"},children:[i.jsx("h1",{style:{color:"#fff",fontSize:"clamp(1.5rem, 4vw, 2.5rem)",fontWeight:"bold",marginBottom:"10px",textShadow:"2px 2px 4px rgba(0,0,0,0.3)"},children:a("title")}),i.jsx("p",{style:{color:"#fff",fontSize:"clamp(1rem, 2.5vw, 1.2rem)",opacity:.9,textShadow:"1px 1px 2px rgba(0,0,0,0.3)"},children:a("subtitle")})]}),i.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(280px, 1fr))",gap:"clamp(15px, 3vw, 30px)",padding:"clamp(10px, 2vw, 20px)"},children:c.map(h=>i.jsxs("div",{onClick:()=>t(h.id),style:{background:"rgba(255,255,255,0.95)",borderRadius:"20px",padding:"clamp(20px, 4vw, 30px)",textAlign:"center",cursor:"pointer",transition:"all 0.3s ease",boxShadow:"0 8px 32px rgba(0,0,0,0.1)",border:`3px solid ${h.color}`,position:"relative",overflow:"hidden"},onMouseEnter:m=>{m.currentTarget.style.transform="translateY(-5px)",m.currentTarget.style.boxShadow="0 12px 40px rgba(0,0,0,0.2)"},onMouseLeave:m=>{m.currentTarget.style.transform="translateY(0)",m.currentTarget.style.boxShadow="0 8px 32px rgba(0,0,0,0.1)"},children:[i.jsx("div",{style:{fontSize:"clamp(3rem, 8vw, 4rem)",marginBottom:"20px",filter:"drop-shadow(2px 2px 4px rgba(0,0,0,0.2))"},children:h.icon}),i.jsx("h3",{style:{color:h.color,fontSize:"clamp(1.2rem, 3vw, 1.5rem)",fontWeight:"bold",marginBottom:"15px"},children:h.title}),i.jsx("p",{style:{color:"#666",fontSize:"clamp(0.9rem, 2vw, 1rem)",lineHeight:"1.5"},children:h.description}),i.jsx("button",{style:{background:h.color,color:"#fff",border:"none",borderRadius:"25px",padding:"clamp(8px, 2vw, 12px) clamp(20px, 4vw, 30px)",fontSize:"clamp(0.9rem, 2vw, 1rem)",fontWeight:"bold",marginTop:"20px",cursor:"pointer",transition:"all 0.3s ease"},children:a("start")})]},h.id))})]}),e===null&&i.jsx(i.Fragment,{children:window.innerWidth<=768?i.jsx("div",{style:{width:"100%",margin:"0 auto",marginTop:24,background:"rgba(255,255,255,0.95)",borderRadius:16,padding:"16px",boxShadow:"0 2px 12px #6B5BFF22"},children:i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:8},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:20,flexWrap:"wrap"},children:[i.jsx("a",{href:"/about",style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12},children:"🧬 Restarter™｜我們是誰"}),i.jsx("a",{href:"/privacy-policy",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12},children:"隱私權政策"}),i.jsx("a",{href:"/terms",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12},children:"條款/聲明"})]}),i.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:20,flexWrap:"wrap"},children:[i.jsx("a",{href:"/data-deletion",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12},children:"資料刪除說明"}),i.jsx("a",{href:"/feedback",style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12},children:"💬 意見箱｜我們想聽你說"})]})]})}):i.jsx("div",{style:{width:"100%",margin:"0 auto",marginTop:24,background:"rgba(255,255,255,0.95)",borderRadius:16,padding:"16px",boxShadow:"0 2px 12px #6B5BFF22"},children:i.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:20,flexWrap:"wrap"},children:[i.jsx("a",{href:"/about",style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12},children:n==="zh-TW"?"🧬 Restarter™｜我們是誰":n==="zh-CN"?"🧬 Restarter™｜我们是谁":n==="en"?"🧬 Restarter™｜Who We Are":n==="ja"?"🧬 Restarter™｜私たちについて":n==="ko"?"🧬 Restarter™｜우리는 누구인가":n==="th"?"🧬 Restarter™｜เราเป็นใคร":n==="vi"?"🧬 Restarter™｜Chúng tôi là ai":n==="ms"?"🧬 Restarter™｜Siapa Kami":"🧬 Restarter™｜Quis sumus"}),i.jsx("a",{href:"/privacy-policy",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12},children:n==="zh-TW"?"隱私權政策":n==="zh-CN"?"隐私政策":n==="en"?"Privacy Policy":n==="ja"?"プライバシーポリシー":n==="ko"?"개인정보 처리방침":n==="th"?"นโยบายความเป็นส่วนตัว":n==="vi"?"Chính sách bảo mật":n==="ms"?"Dasar Privasi":"Consilium de Privata"}),i.jsx("a",{href:"/terms",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12},children:n==="zh-TW"?"條款/聲明":n==="zh-CN"?"条款/声明":n==="en"?"Terms/Statement":n==="ja"?"規約/声明":n==="ko"?"약관/성명":n==="th"?"ข้อกำหนด/แถลงการณ์":n==="vi"?"Điều khoản/Tuyên bố":n==="ms"?"Terma/Pernyataan":"Termini/Declaratio"}),i.jsx("a",{href:"/data-deletion",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12},children:n==="zh-TW"?"資料刪除說明":n==="zh-CN"?"数据删除说明":n==="en"?"Data Deletion":n==="ja"?"データ削除について":n==="ko"?"데이터 삭제 안내":n==="th"?"คำอธิบายการลบข้อมูล":n==="vi"?"Giải thích xóa dữ liệu":n==="ms"?"Penjelasan Penghapusan Data":"Explicatio Deletionis Datae"}),i.jsx("a",{href:"/feedback",style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12},children:n==="zh-TW"?"💬 意見箱｜我們想聽你說":n==="zh-CN"?"💬 意见箱｜我们想听你说":n==="en"?"💬 Feedback Box｜We Want to Hear From You":n==="ja"?"💬 ご意見箱｜私たちはあなたの声を聞きたい":n==="ko"?"💬 피드백｜우리는 당신의 말을 듣고 싶습니다":n==="th"?"💬 กล่องความคิดเห็น｜เราอยากได้ยินจากคุณ":n==="vi"?"💬 Hộp góp ý｜Chúng tôi muốn nghe từ bạn":n==="ms"?"💬 Kotak Maklum Balas｜Kami Ingin Mendengar Dari Anda":"💬 Arca Consilii｜Volumus Audire a Te"})]})})})]})}function Q3({onClose:n}){const{lang:e}=Lt(),[t,r]=v.useState([]),[o,a]=v.useState(0),[c,d]=v.useState("carrot"),[h,m]=v.useState(!1),g=R=>{var F;const I={"zh-TW":{title:"生活農場",rules:"遊戲規則",hideRules:"隱藏規則",seedSelection:"種子選擇：",score:"分數",gameRules:"遊戲規則",plantStage:"種植階段：",harvestStage:"收穫階段：",plantStep1:"1. 選擇種子（6種作物可選）",plantStep2:"2. 點擊空地種植 → 獲得種植分數",plantStep3:"3. 作物會自動生長（幼苗→成熟）",harvestStep1:"1. 點擊成熟的作物進行收穫",harvestStep2:"2. 收穫後獲得更高分數",harvestStep3:"3. 空地可以重新種植",scoring:"計分系統：",scoring1:"• 種植分數：10-25分（根據作物類型）",scoring2:"• 收穫分數：50-125分（根據作物類型）",scoring3:"• 作物生長時間：3-8秒",plant:"種植",harvest:"收穫",growthTime:"生長時間",seconds:"秒",carrot:"胡蘿蔔",tomato:"番茄",corn:"玉米",potato:"馬鈴薯",strawberry:"草莓",watermelon:"西瓜"},"zh-CN":{title:"生活农场",rules:"游戏规则",hideRules:"隐藏规则",seedSelection:"种子选择：",score:"分数",gameRules:"游戏规则",plantStage:"种植阶段：",harvestStage:"收获阶段：",plantStep1:"1. 选择种子（6种作物可选）",plantStep2:"2. 点击空地种植 → 获得种植分数",plantStep3:"3. 作物会自动生长（幼苗→成熟）",harvestStep1:"1. 点击成熟的作物进行收获",harvestStep2:"2. 收获后获得更高分数",harvestStep3:"3. 空地可以重新种植",scoring:"计分系统：",scoring1:"• 种植分数：10-25分（根据作物类型）",scoring2:"• 收获分数：50-125分（根据作物类型）",scoring3:"• 作物生长时间：3-8秒",plant:"种植",harvest:"收获",growthTime:"生长时间",seconds:"秒",carrot:"胡萝卜",tomato:"番茄",corn:"玉米",potato:"马铃薯",strawberry:"草莓",watermelon:"西瓜"},en:{title:"Life Farm",rules:"Game Rules",hideRules:"Hide Rules",seedSelection:"Seed Selection:",score:"Score",gameRules:"Game Rules",plantStage:"Planting Stage:",harvestStage:"Harvest Stage:",plantStep1:"1. Select seeds (6 crop types available)",plantStep2:"2. Click empty plots to plant → Get planting score",plantStep3:"3. Crops grow automatically (seedling→mature)",harvestStep1:"1. Click mature crops to harvest",harvestStep2:"2. Get higher score after harvest",harvestStep3:"3. Empty plots can be replanted",scoring:"Scoring System:",scoring1:"• Planting score: 10-25 points (by crop type)",scoring2:"• Harvest score: 50-125 points (by crop type)",scoring3:"• Growth time: 3-8 seconds",plant:"Plant",harvest:"Harvest",growthTime:"Growth Time",seconds:"seconds",carrot:"Carrot",tomato:"Tomato",corn:"Corn",potato:"Potato",strawberry:"Strawberry",watermelon:"Watermelon"},ja:{title:"ライフファーム",rules:"ゲームルール",hideRules:"ルールを隠す",seedSelection:"種子選択：",score:"スコア",gameRules:"ゲームルール",plantStage:"植栽段階：",harvestStage:"収穫段階：",plantStep1:"1. 種子を選択（6種類の作物）",plantStep2:"2. 空き地をクリックして植栽 → 植栽スコア獲得",plantStep3:"3. 作物は自動で成長（苗→成熟）",harvestStep1:"1. 成熟した作物をクリックして収穫",harvestStep2:"2. 収穫後により高いスコア獲得",harvestStep3:"3. 空き地は再植栽可能",scoring:"スコアシステム：",scoring1:"• 植栽スコア：10-25ポイント（作物タイプ別）",scoring2:"• 収穫スコア：50-125ポイント（作物タイプ別）",scoring3:"• 成長時間：3-8秒",plant:"植栽",harvest:"収穫",growthTime:"成長時間",seconds:"秒",carrot:"ニンジン",tomato:"トマト",corn:"トウモロコシ",potato:"ジャガイモ",strawberry:"イチゴ",watermelon:"スイカ"},ko:{title:"라이프 팜",rules:"게임 규칙",hideRules:"규칙 숨기기",seedSelection:"씨앗 선택:",score:"점수",gameRules:"게임 규칙",plantStage:"심기 단계:",harvestStage:"수확 단계:",plantStep1:"1. 씨앗 선택 (6가지 작물)",plantStep2:"2. 빈 땅 클릭하여 심기 → 심기 점수 획득",plantStep3:"3. 작물 자동 성장 (묘목→성숙)",harvestStep1:"1. 성숙한 작물 클릭하여 수확",harvestStep2:"2. 수확 후 더 높은 점수 획득",harvestStep3:"3. 빈 땅 재심기 가능",scoring:"점수 시스템:",scoring1:"• 심기 점수: 10-25점 (작물 타입별)",scoring2:"• 수확 점수: 50-125점 (작물 타입별)",scoring3:"• 성장 시간: 3-8초",plant:"심기",harvest:"수확",growthTime:"성장 시간",seconds:"초",carrot:"당근",tomato:"토마토",corn:"옥수수",potato:"감자",strawberry:"딸기",watermelon:"수박"},vi:{title:"Nông Trại Cuộc Sống",rules:"Luật Chơi",hideRules:"Ẩn Luật",seedSelection:"Chọn Hạt Giống:",score:"Điểm",gameRules:"Luật Chơi",plantStage:"Giai Đoạn Trồng:",harvestStage:"Giai Đoạn Thu Hoạch:",plantStep1:"1. Chọn hạt giống (6 loại cây trồng)",plantStep2:"2. Nhấp vào ô trống để trồng → Nhận điểm trồng",plantStep3:"3. Cây trồng tự động phát triển (mầm→trưởng thành)",harvestStep1:"1. Nhấp vào cây trưởng thành để thu hoạch",harvestStep2:"2. Nhận điểm cao hơn sau thu hoạch",harvestStep3:"3. Ô trống có thể trồng lại",scoring:"Hệ Thống Điểm:",scoring1:"• Điểm trồng: 10-25 điểm (theo loại cây)",scoring2:"• Điểm thu hoạch: 50-125 điểm (theo loại cây)",scoring3:"• Thời gian phát triển: 3-8 giây",plant:"Trồng",harvest:"Thu hoạch",growthTime:"Thời gian phát triển",seconds:"giây",carrot:"Cà Rốt",tomato:"Cà Chua",corn:"Ngô",potato:"Khoai Tây",strawberry:"Dâu Tây",watermelon:"Dưa Hấu"},th:{title:"ฟาร์มชีวิต",rules:"กฎเกม",hideRules:"ซ่อนกฎ",seedSelection:"เลือกเมล็ด:",score:"คะแนน",gameRules:"กฎเกม",plantStage:"ขั้นตอนปลูก:",harvestStage:"ขั้นตอนเก็บเกี่ยว:",plantStep1:"1. เลือกเมล็ด (6 ชนิดพืช)",plantStep2:"2. คลิกที่แปลงว่างเพื่อปลูก → ได้คะแนนปลูก",plantStep3:"3. พืชเติบโตอัตโนมัติ (ต้นกล้า→สุก)",harvestStep1:"1. คลิกพืชที่สุกแล้วเพื่อเก็บเกี่ยว",harvestStep2:"2. ได้คะแนนสูงขึ้นหลังเก็บเกี่ยว",harvestStep3:"3. แปลงว่างสามารถปลูกใหม่ได้",scoring:"ระบบคะแนน:",scoring1:"• คะแนนปลูก: 10-25 คะแนน (ตามชนิดพืช)",scoring2:"• คะแนนเก็บเกี่ยว: 50-125 คะแนน (ตามชนิดพืช)",scoring3:"• เวลาเติบโต: 3-8 วินาที",plant:"ปลูก",harvest:"เก็บเกี่ยว",growthTime:"เวลาเติบโต",seconds:"วินาที",carrot:"แครอท",tomato:"มะเขือเทศ",corn:"ข้าวโพด",potato:"มันฝรั่ง",strawberry:"สตรอเบอร์รี่",watermelon:"แตงโม"},la:{title:"Villa Vitae",rules:"Regulae Ludi",hideRules:"Occulta Regulas",seedSelection:"Selectio Seminis:",score:"Puncta",gameRules:"Regulae Ludi",plantStage:"Stadium Plantandi:",harvestStage:"Stadium Messis:",plantStep1:"1. Elige semina (6 genera culturarum)",plantStep2:"2. Clicca in agros vacuos ad plantandum → Accipe puncta",plantStep3:"3. Culturae crescunt automatice (plantula→maturus)",harvestStep1:"1. Clicca culturas maturas ad messem",harvestStep2:"2. Accipe puncta altiora post messem",harvestStep3:"3. Agri vacui possunt replantari",scoring:"Systema Punctorum:",scoring1:"• Puncta plantandi: 10-25 (secundum genus)",scoring2:"• Puncta messis: 50-125 (secundum genus)",scoring3:"• Tempus crescendi: 3-8 secundis",plant:"Planta",harvest:"Messis",growthTime:"Tempus Crescendi",seconds:"secundis",carrot:"Daucus",tomato:"Lycopersicum",corn:"Zea",potato:"Solanum",strawberry:"Fragaria",watermelon:"Citrullus"},ms:{title:"Ladang Kehidupan",rules:"Peraturan Permainan",hideRules:"Sembunyikan Peraturan",seedSelection:"Pilihan Benih:",score:"Markah",gameRules:"Peraturan Permainan",plantStage:"Peringkat Menanam:",harvestStage:"Peringkat Menuai:",plantStep1:"1. Pilih benih (6 jenis tanaman)",plantStep2:"2. Klik plot kosong untuk menanam → Dapat markah menanam",plantStep3:"3. Tanaman tumbuh secara automatik (anak benih→matang)",harvestStep1:"1. Klik tanaman matang untuk menuai",harvestStep2:"2. Dapat markah lebih tinggi selepas menuai",harvestStep3:"3. Plot kosong boleh ditanam semula",scoring:"Sistem Markah:",scoring1:"• Markah menanam: 10-25 mata (mengikut jenis tanaman)",scoring2:"• Markah menuai: 50-125 mata (mengikut jenis tanaman)",scoring3:"• Masa tumbuh: 3-8 saat",plant:"Tanam",harvest:"Tuai",growthTime:"Masa Tumbuh",seconds:"saat",carrot:"Lobak Merah",tomato:"Tomato",corn:"Jagung",potato:"Kentang",strawberry:"Strawberi",watermelon:"Tembikai"}};return((F=I[e])==null?void 0:F[R])||I["zh-TW"][R]||R};v.useEffect(()=>{const R=Vd("farm");R&&(r(R.plants||[]),a(R.score||0))},[]),v.useEffect(()=>{Wd("farm",{plants:t,score:o})},[t,o]);const x=[{id:"carrot",name:"胡蘿蔔",emoji:"🥕",growthTime:3e3,color:"#FF6B35",plantScore:10,harvestScore:50},{id:"tomato",name:"番茄",emoji:"🍅",growthTime:5e3,color:"#FF4444",plantScore:15,harvestScore:75},{id:"corn",name:"玉米",emoji:"🌽",growthTime:7e3,color:"#FFD700",plantScore:20,harvestScore:100},{id:"potato",name:"馬鈴薯",emoji:"🥔",growthTime:4e3,color:"#8B4513",plantScore:12,harvestScore:60},{id:"strawberry",name:"草莓",emoji:"🍓",growthTime:6e3,color:"#FF69B4",plantScore:18,harvestScore:90},{id:"watermelon",name:"西瓜",emoji:"🍉",growthTime:8e3,color:"#FF6347",plantScore:25,harvestScore:125}],S=(R,I)=>{if(t.find(H=>H.x===R&&H.y===I))return;const P=x.find(H=>H.id===c);if(!P)return;const z={id:Date.now(),type:c,growth:0,planted:Date.now(),x:R,y:I};r(H=>[...H,z]),a(H=>H+P.plantScore),setTimeout(()=>{r(H=>H.map(J=>J.id===z.id?{...J,growth:50}:J))},P.growthTime/2),setTimeout(()=>{r(H=>H.map(J=>J.id===z.id?{...J,growth:100}:J))},P.growthTime)},j=R=>{const I=t.find(F=>F.id===R);if(I&&I.growth>=100){const F=x.find(P=>P.id===I.type);r(P=>P.filter(z=>z.id!==R)),a(P=>P+((F==null?void 0:F.harvestScore)||50))}},T=(R,I)=>t.find(F=>F.x===R&&F.y===I);return i.jsx("div",{style:{height:"100vh",background:"linear-gradient(180deg, #87CEEB 0%, #90EE90 100%)",padding:"clamp(10px, 2vw, 20px)",position:"relative",display:"flex",flexDirection:"column",overflow:"hidden"},children:i.jsxs("div",{style:{display:"grid",gridTemplateColumns:window.innerWidth<=768?"1fr":"clamp(200px, 25vw, 250px) 1fr",gap:"clamp(10px, 2vw, 20px)",height:"calc(100% - 60px)",marginTop:"60px",overflow:"visible",minHeight:"0",width:"100%"},children:[i.jsxs("div",{style:{background:"rgba(255,255,255,0.95)",borderRadius:"15px",padding:"clamp(15px, 3vw, 20px)",height:"fit-content",maxHeight:window.innerWidth<=768?"200px":"100%",overflow:"auto",boxShadow:"0 4px 20px rgba(0,0,0,0.1)",alignSelf:"start",display:window.innerWidth<=768?"none":"block"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",fontSize:"clamp(1.2rem, 3vw, 1.5rem)",fontWeight:"bold",color:"#333"},children:["🌱 ",g("title")]}),i.jsx("button",{onClick:()=>m(!h),style:{background:"#4CAF50",color:"#fff",border:"none",borderRadius:"15px",padding:"4px 12px",fontSize:"clamp(0.7rem, 1.8vw, 0.8rem)",cursor:"pointer"},children:g(h?"hideRules":"rules")})]}),i.jsxs("div",{style:{marginBottom:"20px"},children:[i.jsx("h4",{style:{marginBottom:"10px",fontSize:"clamp(1rem, 2.5vw, 1.2rem)",color:"#333",fontWeight:"bold"},children:g("seedSelection")}),x.map(R=>i.jsxs("div",{onClick:()=>d(R.id),style:{padding:"clamp(8px, 2vw, 10px)",margin:"5px 0",borderRadius:"8px",cursor:"pointer",background:c===R.id?"#e8f5e8":"#f5f5f5",border:c===R.id?"2px solid #4CAF50":"2px solid transparent",fontSize:"clamp(0.9rem, 2vw, 1rem)",display:"flex",alignItems:"center",gap:"8px",transition:"all 0.3s ease"},children:[i.jsx("span",{style:{fontSize:"1.2em"},children:R.emoji}),i.jsx("span",{children:g(R.id)})]},R.id))]}),i.jsx("div",{style:{marginBottom:"20px"},children:i.jsxs("h4",{style:{fontSize:"clamp(1rem, 2.5vw, 1.2rem)",color:"#333",fontWeight:"bold"},children:[g("score"),"：",o]})}),h&&i.jsxs("div",{style:{background:"rgba(255,255,255,0.8)",borderRadius:"10px",padding:"12px",marginBottom:"15px",textAlign:"left",fontSize:"clamp(0.7rem, 1.8vw, 0.8rem)",lineHeight:"1.3"},children:[i.jsxs("h4",{style:{marginBottom:"8px",color:"#333"},children:["🎯 ",g("gameRules"),"："]}),i.jsx("p",{style:{marginBottom:"6px"},children:i.jsx("strong",{children:g("plantStage")})}),i.jsx("p",{style:{marginBottom:"6px"},children:g("plantStep1")}),i.jsx("p",{style:{marginBottom:"6px"},children:g("plantStep2")}),i.jsx("p",{style:{marginBottom:"6px"},children:g("plantStep3")}),i.jsx("p",{style:{marginBottom:"6px",marginTop:"8px"},children:i.jsx("strong",{children:g("harvestStage")})}),i.jsx("p",{style:{marginBottom:"6px"},children:g("harvestStep1")}),i.jsx("p",{style:{marginBottom:"6px"},children:g("harvestStep2")}),i.jsx("p",{style:{marginBottom:"6px"},children:g("harvestStep3")}),i.jsx("p",{style:{marginBottom:"6px",marginTop:"8px"},children:i.jsx("strong",{children:g("scoring")})}),i.jsxs("p",{style:{marginBottom:"4px"},children:["🥕 ",g("carrot"),"：",g("plant"),"+10 ",g("harvest"),"+50"]}),i.jsxs("p",{style:{marginBottom:"4px"},children:["🍅 ",g("tomato"),"：",g("plant"),"+15 ",g("harvest"),"+75"]}),i.jsxs("p",{style:{marginBottom:"4px"},children:["🌽 ",g("corn"),"：",g("plant"),"+20 ",g("harvest"),"+100"]}),i.jsxs("p",{style:{marginBottom:"4px"},children:["🥔 ",g("potato"),"：",g("plant"),"+12 ",g("harvest"),"+60"]}),i.jsxs("p",{style:{marginBottom:"4px"},children:["🍓 ",g("strawberry"),"：",g("plant"),"+18 ",g("harvest"),"+90"]}),i.jsxs("p",{style:{marginBottom:"4px"},children:["🍉 ",g("watermelon"),"：",g("plant"),"+25 ",g("harvest"),"+125"]}),i.jsx("p",{style:{marginBottom:"6px",marginTop:"8px"},children:i.jsxs("strong",{children:[g("growthTime"),"："]})}),i.jsxs("p",{style:{marginBottom:"4px"},children:["🥕 ",g("carrot"),"：3",g("seconds")]}),i.jsxs("p",{style:{marginBottom:"4px"},children:["🍅 ",g("tomato"),"：5",g("seconds")]}),i.jsxs("p",{style:{marginBottom:"4px"},children:["🌽 ",g("corn"),"：7",g("seconds")]}),i.jsxs("p",{style:{marginBottom:"4px"},children:["🥔 ",g("potato"),"：4",g("seconds")]}),i.jsxs("p",{style:{marginBottom:"4px"},children:["🍓 ",g("strawberry"),"：6",g("seconds")]}),i.jsxs("p",{style:{marginBottom:"4px"},children:["🍉 ",g("watermelon"),"：8",g("seconds")]})]})]}),i.jsxs("div",{style:{background:"rgba(255,255,255,0.9)",borderRadius:"15px",padding:window.innerWidth<=768?"clamp(5px, 1vw, 10px)":"clamp(10px, 2vw, 20px)",position:"relative",overflow:"visible",boxShadow:"0 4px 20px rgba(0,0,0,0.1)",display:"flex",flexDirection:"column",zIndex:1,minHeight:"0",width:"100%"},children:[window.innerWidth<=768&&i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"10px",marginBottom:"15px"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"10px",background:"rgba(255,255,255,0.8)",borderRadius:"10px",fontSize:"14px",position:"relative",zIndex:1},children:[i.jsxs("div",{style:{fontWeight:"bold"},children:[g("score"),"：",o]}),i.jsx("div",{style:{display:"flex",gap:"8px"},children:x.map(R=>i.jsx("button",{onClick:()=>d(R.id),style:{padding:"4px 8px",borderRadius:"6px",border:c===R.id?"2px solid #4CAF50":"1px solid #ddd",background:c===R.id?"#e8f5e8":"#fff",cursor:"pointer",fontSize:"12px"},children:R.emoji},R.id))})]}),i.jsx("div",{style:{display:"flex",justifyContent:"center"},children:i.jsx("button",{onClick:()=>m(!h),style:{background:"#4CAF50",color:"#fff",border:"none",borderRadius:"15px",padding:"6px 16px",fontSize:"12px",cursor:"pointer"},children:g(h?"hideRules":"rules")})}),h&&i.jsxs("div",{style:{background:"rgba(255,255,255,0.9)",borderRadius:"10px",padding:"12px",fontSize:"11px",lineHeight:"1.3",textAlign:"left"},children:[i.jsxs("h4",{style:{marginBottom:"6px",color:"#333"},children:["🎯 ",g("gameRules"),"："]}),i.jsxs("p",{style:{marginBottom:"4px"},children:[i.jsx("strong",{children:"種植："}),"選擇種子 → 點擊空地種植"]}),i.jsxs("p",{style:{marginBottom:"4px"},children:[i.jsx("strong",{children:"收穫："}),"點擊成熟作物收穫"]}),i.jsxs("p",{style:{marginBottom:"4px"},children:[i.jsx("strong",{children:"分數："}),"種植+10~25分，收穫+50~125分"]}),i.jsxs("p",{style:{marginBottom:"4px"},children:[i.jsx("strong",{children:"時間："}),"3~8秒成熟"]})]})]}),i.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(10, 1fr)",gridTemplateRows:"repeat(7, 1fr)",gap:"clamp(5px, 1vw, 10px)",width:"100%",height:"fit-content",minHeight:"0",overflow:"visible"},children:Array.from({length:70},(R,I)=>{const F=I%10,P=Math.floor(I/10),z=T(F,P),H=z?x.find(O=>O.id===z.type):null,J=z&&z.growth>=100;return i.jsx("div",{onClick:()=>{z&&J?j(z.id):z||S(F,P)},style:{background:z?J?"#4CAF50":"#8BC34A":"#DEB887",border:"2px solid #A0522D",borderRadius:"8px",display:"flex",alignItems:"center",justifyContent:"center",cursor:z&&!J?"not-allowed":"pointer",fontSize:z?"clamp(1.5rem, 4vw, 2rem)":"clamp(0.8rem, 2vw, 1rem)",transition:"all 0.3s ease",position:"relative",aspectRatio:"1",boxShadow:z?"0 2px 8px rgba(0,0,0,0.2)":"none",opacity:z&&!J?.7:1},children:z?i.jsx("div",{style:{fontSize:J?"clamp(1.5rem, 4vw, 2rem)":"clamp(0.8rem, 2vw, 1rem)",opacity:z.growth/100},children:H==null?void 0:H.emoji}):i.jsx("span",{style:{color:"#8B4513",fontSize:"1.5em"},children:"+"})},I)})})]})]})})}function Y3({onClose:n}){const{lang:e}=Lt(),[t,r]=v.useState(0),[o,a]=v.useState(30),[c,d]=v.useState(!1),[h,m]=v.useState(null),g=v.useRef({}),x=oe=>{var ce;const X={"zh-TW":{start:"開始遊戲",restart:"重新開始",score:"分數",time:"時間",level:"等級",hits:"擊中",accuracy:"準確率",combo:"連擊",highScore:"最高分",highCombo:"最高連擊",title:"打地鼠",rules:"遊戲規則",close:"關閉",gameOver:"遊戲結束",finalScore:"最終分數",basicGameplay:"基本玩法",scoreSystem:"分數系統",levelSystem:"等級系統",clickMole:"點擊出現的地鼠",getScore:"獲得分數",gameTime:"遊戲時間",seconds:"秒",moleSpeed:"地鼠出現時間會隨等級縮短",baseScore:"基礎分數",points:"分",levelBonus:"等級獎勵",perLevel:"每級",comboBonus:"連擊獎勵",per3Combo:"每3連擊",level1:"1級",level2:"2級",level3:"3級",level4:"4級",molesFaster:"地鼠更快",moreFrequent:"更頻繁",extremeSpeed:"極限速度"},"zh-CN":{start:"开始游戏",restart:"重新开始",score:"分数",time:"时间",level:"等级",hits:"击中",accuracy:"准确率",combo:"连击",highScore:"最高分",highCombo:"最高连击",title:"打地鼠",rules:"游戏规则",close:"关闭",basicGameplay:"基本玩法",scoreSystem:"分数系统",levelSystem:"等级系统",clickMole:"点击出现的地鼠",getScore:"获得分数",gameTime:"游戏时间",seconds:"秒",moleSpeed:"地鼠出现时间会随等级缩短",baseScore:"基础分数",points:"分",levelBonus:"等级奖励",perLevel:"每级",comboBonus:"连击奖励",per3Combo:"每3连击",level1:"1级",level2:"2级",level3:"3级",level4:"4级",molesFaster:"地鼠更快",moreFrequent:"更频繁",extremeSpeed:"极限速度"},en:{start:"Start Game",restart:"Restart",score:"Score",time:"Time",level:"Level",hits:"Hits",accuracy:"Accuracy",combo:"Combo",highScore:"High Score",highCombo:"High Combo",title:"Whack-a-Mole",rules:"Game Rules",close:"Close",basicGameplay:"Basic Gameplay",scoreSystem:"Score System",levelSystem:"Level System",clickMole:"Click appearing moles",getScore:"to get points",gameTime:"Game Time",seconds:"seconds",moleSpeed:"Mole appearance time shortens with level",baseScore:"Base Score",points:"points",levelBonus:"Level Bonus",perLevel:"per level",comboBonus:"Combo Bonus",per3Combo:"per 3 combos",level1:"Level 1",level2:"Level 2",level3:"Level 3",level4:"Level 4",molesFaster:"moles faster",moreFrequent:"more frequent",extremeSpeed:"extreme speed"},ja:{start:"ゲーム開始",restart:"再開",score:"スコア",time:"時間",level:"レベル",hits:"ヒット",accuracy:"精度",combo:"コンボ",highScore:"ハイスコア",highCombo:"ハイコンボ",title:"モグラたたき",rules:"ゲームルール",close:"閉じる",basicGameplay:"基本プレイ",scoreSystem:"スコアシステム",levelSystem:"レベルシステム",clickMole:"現れるモグラをクリック",getScore:"してポイントを獲得",gameTime:"ゲーム時間",seconds:"秒",moleSpeed:"モグラの出現時間はレベルに応じて短縮",baseScore:"ベーススコア",points:"ポイント",levelBonus:"レベルボーナス",perLevel:"レベルごと",comboBonus:"コンボボーナス",per3Combo:"3コンボごと",level1:"レベル1",level2:"レベル2",level3:"レベル3",level4:"レベル4",molesFaster:"モグラがより速く",moreFrequent:"より頻繁に",extremeSpeed:"極限速度"},ko:{start:"게임 시작",restart:"다시 시작",score:"점수",time:"시간",level:"레벨",hits:"타격",accuracy:"정확도",combo:"콤보",highScore:"최고 점수",highCombo:"최고 콤보",title:"두더지 잡기",rules:"게임 규칙",close:"닫기",basicGameplay:"기본 플레이",scoreSystem:"점수 시스템",levelSystem:"레벨 시스템",clickMole:"나타나는 두더지를 클릭",getScore:"하여 점수 획득",gameTime:"게임 시간",seconds:"초",moleSpeed:"두더지 출현 시간은 레벨에 따라 단축",baseScore:"기본 점수",points:"점",levelBonus:"레벨 보너스",perLevel:"레벨당",comboBonus:"콤보 보너스",per3Combo:"3콤보당",level1:"레벨 1",level2:"레벨 2",level3:"레벨 3",level4:"레벨 4",molesFaster:"두더지가 더 빠르게",moreFrequent:"더 자주",extremeSpeed:"극한 속도"},vi:{start:"Bắt Đầu Trò Chơi",restart:"Chơi Lại",score:"Điểm",time:"Thời Gian",level:"Cấp Độ",hits:"Trúng",accuracy:"Độ Chính Xác",combo:"Combo",highScore:"Điểm Cao Nhất",highCombo:"Combo Cao Nhất",title:"Đập Chuột",rules:"Luật Chơi",close:"Đóng",basicGameplay:"Cách Chơi Cơ Bản",scoreSystem:"Hệ Thống Điểm",levelSystem:"Hệ Thống Cấp Độ",clickMole:"Nhấp vào chuột xuất hiện",getScore:"để nhận điểm",gameTime:"Thời Gian Chơi",seconds:"giây",moleSpeed:"Thời gian xuất hiện chuột rút ngắn theo cấp độ",baseScore:"Điểm Cơ Bản",points:"điểm",levelBonus:"Thưởng Cấp Độ",perLevel:"mỗi cấp",comboBonus:"Thưởng Combo",per3Combo:"mỗi 3 combo",level1:"Cấp 1",level2:"Cấp 2",level3:"Cấp 3",level4:"Cấp 4",molesFaster:"chuột nhanh hơn",moreFrequent:"thường xuyên hơn",extremeSpeed:"tốc độ cực hạn"},th:{start:"เริ่มเกม",restart:"เริ่มใหม่",score:"คะแนน",time:"เวลา",level:"ระดับ",hits:"ตีถูก",accuracy:"ความแม่นยำ",combo:"คอมโบ",highScore:"คะแนนสูงสุด",highCombo:"คอมโบสูงสุด",title:"ตีตุ่น",rules:"กฎเกม",close:"ปิด",basicGameplay:"วิธีเล่นพื้นฐาน",scoreSystem:"ระบบคะแนน",levelSystem:"ระบบระดับ",clickMole:"คลิกตุ่นที่ปรากฏ",getScore:"เพื่อได้คะแนน",gameTime:"เวลาเกม",seconds:"วินาที",moleSpeed:"เวลาปรากฏของตุ่นจะสั้นลงตามระดับ",baseScore:"คะแนนพื้นฐาน",points:"คะแนน",levelBonus:"โบนัสระดับ",perLevel:"ต่อระดับ",comboBonus:"โบนัสคอมโบ",per3Combo:"ต่อ 3 คอมโบ",level1:"ระดับ 1",level2:"ระดับ 2",level3:"ระดับ 3",level4:"ระดับ 4",molesFaster:"ตุ่นเร็วขึ้น",moreFrequent:"บ่อยขึ้น",extremeSpeed:"ความเร็วสุดขีด"},la:{start:"Ludum Incipere",restart:"Iterum Incipere",score:"Puncta",time:"Tempus",level:"Gradus",hits:"Ictus",accuracy:"Accuratio",combo:"Combo",highScore:"Puncta Maxima",highCombo:"Combo Maxima",title:"Talpa Percutere",rules:"Regulae Ludi",close:"Claudere",basicGameplay:"Ludus Basicus",scoreSystem:"Systema Punctorum",levelSystem:"Systema Gradus",clickMole:"Clicca talpam apparentem",getScore:"ut puncta accipias",gameTime:"Tempus Ludi",seconds:"secundis",moleSpeed:"Tempus apparentiae talpae cum gradu brevior fit",baseScore:"Puncta Basica",points:"puncta",levelBonus:"Bonus Gradus",perLevel:"per gradum",comboBonus:"Bonus Combo",per3Combo:"per 3 combos",level1:"Gradus 1",level2:"Gradus 2",level3:"Gradus 3",level4:"Gradus 4",molesFaster:"talpae velociores",moreFrequent:"frequentiores",extremeSpeed:"velocitas extrema"},ms:{start:"Mulakan Permainan",restart:"Mulakan Semula",score:"Markah",time:"Masa",level:"Tahap",hits:"Pukulan",accuracy:"Ketepatan",combo:"Combo",highScore:"Markah Tertinggi",highCombo:"Combo Tertinggi",title:"Pukul Tikus",rules:"Peraturan Permainan",close:"Tutup",basicGameplay:"Cara Bermain Asas",scoreSystem:"Sistem Markah",levelSystem:"Sistem Tahap",clickMole:"Klik tikus yang muncul",getScore:"untuk dapat markah",gameTime:"Masa Permainan",seconds:"saat",moleSpeed:"Masa kemunculan tikus memendek dengan tahap",baseScore:"Markah Asas",points:"markah",levelBonus:"Bonus Tahap",perLevel:"setiap tahap",comboBonus:"Bonus Combo",per3Combo:"setiap 3 combo",level1:"Tahap 1",level2:"Tahap 2",level3:"Tahap 3",level4:"Tahap 4",molesFaster:"tikus lebih cepat",moreFrequent:"lebih kerap",extremeSpeed:"kelajuan melampau"}};return((ce=X[e])==null?void 0:ce[oe])||X["zh-TW"][oe]||oe},[S,j]=v.useState(0),[T,R]=v.useState(1),[I,F]=v.useState(0),[P,z]=v.useState(0),[H,J]=v.useState(!1),[O,L]=v.useState(0),[C,A]=v.useState(0),[D,M]=v.useState(0);v.useEffect(()=>{const oe=Vd("whackAMole");oe&&j(oe.highScore||0)},[]),v.useEffect(()=>{t>S&&(j(t),Wd("whackAMole",{highScore:t}))},[t,S]),v.useEffect(()=>{const oe=I+P;if(oe>0){const X=I/oe;T===1&&X>=.7?R(2):T===2&&X>=.6?R(3):T===3&&X>=.5&&R(4)}},[I,P,T]);const B=()=>t<0?"😅 負分？地鼠在笑你！":t<50?"🐹 新手地鼠獵人！":t<100?"🎯 有點手感了！":t<200?"⚡ 地鼠殺手！":t<300?"🔥 地鼠剋星！":t<500?"💪 地鼠終結者！":"👑 地鼠之王！";v.useEffect(()=>{},[T]),v.useEffect(()=>{const oe=I+P;oe>0&&M(Math.round(I/oe*100))},[I,P]);const _=()=>{d(!0),r(0),a(30),R(1),F(0),z(0),L(0),A(0),M(0),m(null);let oe,X;oe=setInterval(()=>{a(ce=>ce<=1?(clearInterval(oe),clearInterval(X),d(!1),0):ce-1)},1e3),setTimeout(()=>{const ce=Math.floor(Math.random()*9);m(ce);const te=setTimeout(()=>{m(null),z(xe=>xe+1),r(xe=>xe-1),L(0)},T===1?900:T===2?700:T===3?500:350);g.current[ce]=te},300),X=setInterval(()=>{const ce=Math.floor(Math.random()*9);m(ce);const te=setTimeout(()=>{m(null),z(xe=>xe+1),r(xe=>xe-1),L(0)},T===1?900:T===2?700:T===3?500:350);g.current[ce]=te},T===1?1100:T===2?900:T===3?700:500)},U=oe=>{h===oe?(r(X=>X+1),F(X=>X+1),L(X=>{const ce=X+1;return ce>C&&A(ce),ce}),m(null),g.current[oe]&&(clearTimeout(g.current[oe]),g.current[oe]=null)):(r(X=>X-1),L(0))};return i.jsxs("div",{style:{height:"100vh",background:"linear-gradient(180deg, #8B4513 0%, #A0522D 100%)",padding:"clamp(10px, 2vw, 20px)",display:"flex",flexDirection:"column",alignItems:"center",position:"relative"},children:[i.jsx("button",{onClick:n,style:{position:"absolute",top:"clamp(20px, 4vw, 40px)",left:"clamp(20px, 4vw, 40px)",background:"#fff",border:"2px solid #6B5BFF",borderRadius:"50%",width:"clamp(40px, 8vw, 50px)",height:"clamp(40px, 8vw, 50px)",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",zIndex:20,fontSize:"clamp(1.2rem, 3vw, 1.5rem)",color:"#6B5BFF"},children:"←"}),i.jsxs("div",{style:{background:"rgba(255,255,255,0.9)",borderRadius:"15px",padding:"clamp(10px, 2vw, 15px)",marginTop:"clamp(60px, 12vw, 80px)",marginBottom:"clamp(8px, 1.5vw, 15px)",textAlign:"center",width:"100%",maxWidth:"300px"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"10px"},children:[i.jsxs("h2",{style:{fontSize:"clamp(1.5rem, 4vw, 2rem)",margin:0},children:["🔨 ",x("title")]}),i.jsx("button",{onClick:()=>J(!H),style:{background:"#4CAF50",color:"#fff",border:"none",borderRadius:"20px",padding:"5px 15px",fontSize:"clamp(0.8rem, 2vw, 1rem)",cursor:"pointer"},children:x(H?"close":"rules")})]}),H&&i.jsxs("div",{style:{background:"rgba(255,255,255,0.8)",borderRadius:"10px",padding:"10px",marginBottom:"10px",textAlign:"left",fontSize:"clamp(0.7rem, 1.8vw, 0.8rem)",lineHeight:"1.3"},children:[i.jsxs("h4",{style:{marginBottom:"8px",color:"#333"},children:["🎯 ",x("rules"),"："]}),i.jsx("p",{style:{marginBottom:"6px"},children:i.jsxs("strong",{children:[x("basicGameplay"),"："]})}),i.jsxs("p",{style:{marginBottom:"6px"},children:["• ",x("clickMole")," 🐹 ",x("getScore")]}),i.jsxs("p",{style:{marginBottom:"6px"},children:["• ",x("gameTime"),"：30",x("seconds")]}),i.jsxs("p",{style:{marginBottom:"6px"},children:["• ",x("moleSpeed")]}),i.jsx("p",{style:{marginBottom:"6px",marginTop:"8px"},children:i.jsxs("strong",{children:[x("scoreSystem"),"："]})}),i.jsx("p",{style:{marginBottom:"6px"},children:"• 點擊到地鼠身上 → +1分"}),i.jsx("p",{style:{marginBottom:"6px"},children:"• 地鼠消失時沒有點擊 → -1分"}),i.jsx("p",{style:{marginBottom:"6px"},children:"• 地鼠消失後才點擊 → -1分"}),i.jsx("p",{style:{marginBottom:"6px"},children:"• 點擊地鼠坑但沒點擊到地鼠 → -1分"}),i.jsx("p",{style:{marginBottom:"6px"},children:"• 從0分開始，無正負限制"}),i.jsx("p",{style:{marginBottom:"6px",marginTop:"8px"},children:i.jsxs("strong",{children:[x("levelSystem"),"："]})}),i.jsx("p",{style:{marginBottom:"6px"},children:"• 1級：70%成功 → 2級（地鼠更快）"}),i.jsx("p",{style:{marginBottom:"6px"},children:"• 2級：60%成功 → 3級（更頻繁）"}),i.jsx("p",{style:{marginBottom:"6px"},children:"• 3級：50%成功 → 4級（極限速度）"}),i.jsx("p",{style:{marginBottom:"6px"},children:"• 成功率基於30秒內的成功比率計算"})]}),!H&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{display:"flex",gap:"clamp(6px, 1.5vw, 12px)",justifyContent:"center",flexWrap:"wrap",marginBottom:"8px"},children:[i.jsxs("div",{style:{fontSize:"clamp(0.8rem, 2.2vw, 1rem)"},children:[x("score"),"：",t]}),i.jsxs("div",{style:{fontSize:"clamp(0.8rem, 2.2vw, 1rem)"},children:[x("time"),"：",o,"秒"]}),i.jsxs("div",{style:{fontSize:"clamp(0.8rem, 2.2vw, 1rem)"},children:[x("level"),"：",T]})]}),i.jsxs("div",{style:{display:"flex",gap:"clamp(6px, 1.5vw, 12px)",justifyContent:"center",flexWrap:"wrap",marginBottom:"8px"},children:[i.jsxs("div",{style:{fontSize:"clamp(0.7rem, 1.8vw, 0.9rem)"},children:[x("hits"),"：",I]}),i.jsxs("div",{style:{fontSize:"clamp(0.7rem, 1.8vw, 0.9rem)"},children:[x("accuracy"),"：",D,"%"]}),i.jsxs("div",{style:{fontSize:"clamp(0.7rem, 1.8vw, 0.9rem)"},children:[x("combo"),"：",O]})]}),i.jsxs("div",{style:{display:"flex",gap:"clamp(6px, 1.5vw, 12px)",justifyContent:"center",flexWrap:"wrap"},children:[i.jsxs("div",{style:{fontSize:"clamp(0.7rem, 1.8vw, 0.9rem)"},children:[x("highScore"),"：",S]}),i.jsxs("div",{style:{fontSize:"clamp(0.7rem, 1.8vw, 0.9rem)"},children:[x("highCombo"),"：",C]})]}),i.jsx("div",{style:{fontSize:"clamp(0.8rem, 2vw, 1rem)",color:"#FF5722",fontWeight:"bold",marginTop:"8px",textAlign:"center"},children:B()}),!c&&i.jsx("button",{onClick:_,style:{background:"#FF5722",color:"#fff",border:"none",borderRadius:"25px",padding:"clamp(6px, 1.5vw, 8px) clamp(16px, 3vw, 24px)",fontSize:"clamp(0.9rem, 2.2vw, 1rem)",fontWeight:"bold",marginTop:"10px",cursor:"pointer",transition:"all 0.3s ease"},children:x(o===30?"start":"restart")})]})]}),!H&&i.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"clamp(8px, 1.5vw, 15px)",maxWidth:"300px",width:"100%",marginTop:"10px",padding:"clamp(10px, 2vw, 15px)",background:"rgba(255,255,255,0.9)",borderRadius:"15px",boxSizing:"border-box"},children:Array.from({length:9},(oe,X)=>i.jsx("div",{onClick:()=>U(X),style:{width:"clamp(60px, 10vw, 80px)",height:"clamp(60px, 10vw, 80px)",background:"#654321",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",border:"3px solid #8B4513",position:"relative",overflow:"hidden"},children:h===X&&i.jsx("div",{style:{position:"absolute",bottom:"0",width:"100%",height:"60%",background:"#8B4513",borderRadius:"50% 50% 0 0",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"clamp(1.5rem, 4vw, 2rem)",animation:"molePop 0.3s ease-out",cursor:"pointer"},children:"🐹"})},X))}),i.jsx("style",{children:`
        @keyframes molePop {
          0% { transform: translateY(100%); }
          100% { transform: translateY(0); }
        }
        
        @keyframes whack {
          0% { transform: scale(1); }
          50% { transform: scale(0.8); }
          100% { transform: scale(1); }
        }
        
        @keyframes scorePop {
          0% { opacity: 0; transform: translateY(0); }
          50% { opacity: 1; transform: translateY(-20px); }
          100% { opacity: 0; transform: translateY(-40px); }
        }
      `})]})}function X3({onClose:n}){const{lang:e}=Lt(),[t,r]=v.useState(0),[o,a]=v.useState([]),c=U=>{var X;const oe={"zh-TW":{title:"採水果",start:"開始遊戲",restart:"重新開始",score:"分數",time:"時間",level:"等級",collected:"收集",highScore:"最高分",rules:"遊戲規則",close:"關閉",hideRules:"隱藏規則",basicGameplay:"基本玩法",scoreSystem:"分數系統",levelSystem:"等級系統",tips:"技巧提示",newFeatures:"新增功能",gameOver:"遊戲結束",clickFruit:"點擊掉落的水果收集分數",putFruitInBasket:"把採到的水果裝進下面的水果籃裡",gameTime:"遊戲時間",seconds:"秒",fruitSpeed:"水果會不定向掉落且速度加快",apple:"蘋果",orange:"橘子",banana:"香蕉",strawberry:"草莓",grape:"葡萄",peach:"桃子",points:"分",level1:"1級",level2:"2級",level3:"3級",level4:"4級",fruitFaster:"水果更快",moreFrequent:"更頻繁",extremeSpeed:"極限速度",prioritizeHighScore:"優先收集高分水果",stayFocused:"保持專注，快速反應",buildHighScore:"建立高分記錄",fruitFromFourDirections:"水果會從四個方向隨機出現",curvedTrajectory:"水果掉落時會呈現彎曲動線",realTimeFeedback:"遊戲中會顯示即時收集反饋",detailedStats:"遊戲結束時顯示詳細統計",fixedBasketPosition:"籃子位置完全固定不震動",increasedFrequency:"水果出現頻率大幅提升"},"zh-CN":{title:"采水果",start:"开始游戏",restart:"重新开始",score:"分数",time:"时间",level:"等级",collected:"收集",highScore:"最高分",rules:"游戏规则",close:"关闭",hideRules:"隐藏规则",basicGameplay:"基本玩法",scoreSystem:"分数系统",levelSystem:"等级系统",tips:"技巧提示",newFeatures:"新增功能",clickFruit:"点击掉落的水果收集分数",putFruitInBasket:"把采到的水果装进下面的水果篮里",gameTime:"游戏时间",seconds:"秒",fruitSpeed:"水果会不定向掉落且速度加快",apple:"苹果",orange:"橘子",banana:"香蕉",strawberry:"草莓",grape:"葡萄",peach:"桃子",points:"分",level1:"1级",level2:"2级",level3:"3级",level4:"4级",fruitFaster:"水果更快",moreFrequent:"更频繁",extremeSpeed:"极限速度",prioritizeHighScore:"优先收集高分水果",stayFocused:"保持专注，快速反应",buildHighScore:"建立高分记录",fruitFromFourDirections:"水果会从四个方向随机出现",curvedTrajectory:"水果掉落时会呈现弯曲动线",realTimeFeedback:"游戏中会显示即时收集反馈",detailedStats:"游戏结束时显示详细统计",fixedBasketPosition:"篮子位置完全固定不震动",increasedFrequency:"水果出现频率大幅提升"},en:{title:"Fruit Picking",start:"Start Game",restart:"Restart",score:"Score",time:"Time",level:"Level",collected:"Collected",highScore:"High Score",rules:"Game Rules",close:"Close",hideRules:"Hide Rules",basicGameplay:"Basic Gameplay",scoreSystem:"Score System",levelSystem:"Level System",tips:"Tips",newFeatures:"New Features",clickFruit:"Click falling fruit to collect points",putFruitInBasket:"Put collected fruit into the basket below",gameTime:"Game Time",seconds:"seconds",fruitSpeed:"Fruit will fall randomly and speed up",apple:"Apple",orange:"Orange",banana:"Banana",strawberry:"Strawberry",grape:"Grape",peach:"Peach",points:"points",level1:"Level 1",level2:"Level 2",level3:"Level 3",level4:"Level 4",fruitFaster:"fruit faster",moreFrequent:"more frequent",extremeSpeed:"extreme speed",prioritizeHighScore:"Prioritize high-score fruits",stayFocused:"Stay focused, react quickly",buildHighScore:"Build high score records",fruitFromFourDirections:"Fruit appears from four directions randomly",curvedTrajectory:"Fruit falls with curved trajectories",realTimeFeedback:"Real-time collection feedback during game",detailedStats:"Detailed statistics when game ends",fixedBasketPosition:"Basket position completely fixed without vibration",increasedFrequency:"Significantly increased fruit appearance frequency"},ja:{title:"フルーツ収穫",start:"ゲーム開始",restart:"再開",score:"スコア",time:"時間",level:"レベル",collected:"収穫",highScore:"ハイスコア",rules:"ゲームルール",close:"閉じる",hideRules:"ルール非表示",basicGameplay:"基本ゲームプレイ",scoreSystem:"スコアシステム",levelSystem:"レベルシステム",tips:"ヒント",newFeatures:"新機能",clickFruit:"落ちる果物をクリックしてポイントを獲得",putFruitInBasket:"収穫した果物を下のバスケットに入れる",gameTime:"ゲーム時間",seconds:"秒",fruitSpeed:"果物はランダムに落ちて速度が上がる",apple:"りんご",orange:"みかん",banana:"バナナ",strawberry:"いちご",grape:"ぶどう",peach:"もも",points:"ポイント",level1:"レベル1",level2:"レベル2",level3:"レベル3",level4:"レベル4",fruitFaster:"果物がより速く",moreFrequent:"より頻繁に",extremeSpeed:"極限速度",prioritizeHighScore:"高得点の果物を優先",stayFocused:"集中して素早く反応",buildHighScore:"高得点記録を築く",fruitFromFourDirections:"果物は4方向からランダムに出現",curvedTrajectory:"果物は曲線軌道で落下",realTimeFeedback:"ゲーム中のリアルタイム収穫フィードバック",detailedStats:"ゲーム終了時の詳細統計",fixedBasketPosition:"バスケット位置は完全固定で震動なし",increasedFrequency:"果物出現頻度が大幅に向上"},ko:{title:"과일 수확",start:"게임 시작",restart:"다시 시작",score:"점수",time:"시간",level:"레벨",collected:"수확",highScore:"최고 점수",rules:"게임 규칙",close:"닫기",hideRules:"규칙 숨기기",basicGameplay:"기본 게임플레이",scoreSystem:"점수 시스템",levelSystem:"레벨 시스템",tips:"팁",newFeatures:"새 기능",clickFruit:"떨어지는 과일을 클릭하여 점수 획득",putFruitInBasket:"수확한 과일을 아래 바구니에 넣기",gameTime:"게임 시간",seconds:"초",fruitSpeed:"과일이 무작위로 떨어지고 속도가 빨라짐",apple:"사과",orange:"귤",banana:"바나나",strawberry:"딸기",grape:"포도",peach:"복숭아",points:"점",level1:"레벨 1",level2:"레벨 2",level3:"레벨 3",level4:"레벨 4",fruitFaster:"과일이 더 빠르게",moreFrequent:"더 자주",extremeSpeed:"극한 속도",prioritizeHighScore:"고점수 과일 우선 수집",stayFocused:"집중하고 빠르게 반응",buildHighScore:"고점수 기록 구축",fruitFromFourDirections:"과일이 네 방향에서 무작위로 나타남",curvedTrajectory:"과일이 곡선 궤적으로 떨어짐",realTimeFeedback:"게임 중 실시간 수확 피드백",detailedStats:"게임 종료 시 상세 통계",fixedBasketPosition:"바구니 위치 완전 고정으로 진동 없음",increasedFrequency:"과일 출현 빈도 대폭 증가"},vi:{title:"Hái Trái Cây",start:"Bắt Đầu Trò Chơi",restart:"Chơi Lại",score:"Điểm",time:"Thời Gian",level:"Cấp Độ",collected:"Thu Hoạch",highScore:"Điểm Cao Nhất",rules:"Luật Chơi",close:"Đóng",hideRules:"Ẩn Luật",basicGameplay:"Cách Chơi Cơ Bản",scoreSystem:"Hệ Thống Điểm",levelSystem:"Hệ Thống Cấp Độ",tips:"Mẹo",newFeatures:"Tính Năng Mới",clickFruit:"Nhấp vào trái cây rơi để nhận điểm",putFruitInBasket:"Đặt trái cây thu hoạch vào giỏ bên dưới",gameTime:"Thời Gian Chơi",seconds:"giây",fruitSpeed:"Trái cây sẽ rơi ngẫu nhiên và tăng tốc",apple:"Táo",orange:"Cam",banana:"Chuối",strawberry:"Dâu tây",grape:"Nho",peach:"Đào",points:"điểm",level1:"Cấp 1",level2:"Cấp 2",level3:"Cấp 3",level4:"Cấp 4",fruitFaster:"trái cây nhanh hơn",moreFrequent:"thường xuyên hơn",extremeSpeed:"tốc độ cực hạn",prioritizeHighScore:"Ưu tiên trái cây điểm cao",stayFocused:"Tập trung, phản ứng nhanh",buildHighScore:"Xây dựng kỷ lục điểm cao",fruitFromFourDirections:"Trái cây xuất hiện từ bốn hướng ngẫu nhiên",curvedTrajectory:"Trái cây rơi theo quỹ đạo cong",realTimeFeedback:"Phản hồi thu hoạch thời gian thực trong game",detailedStats:"Thống kê chi tiết khi kết thúc game",fixedBasketPosition:"Vị trí giỏ hoàn toàn cố định không rung",increasedFrequency:"Tần suất xuất hiện trái cây tăng đáng kể"},th:{title:"เก็บผลไม้",start:"เริ่มเกม",restart:"เริ่มใหม่",score:"คะแนน",time:"เวลา",level:"ระดับ",collected:"เก็บ",highScore:"คะแนนสูงสุด",rules:"กฎเกม",close:"ปิด",hideRules:"ซ่อนกฎ",basicGameplay:"การเล่นพื้นฐาน",scoreSystem:"ระบบคะแนน",levelSystem:"ระบบระดับ",tips:"เคล็ดลับ",newFeatures:"คุณสมบัติใหม่",clickFruit:"คลิกผลไม้ที่ตกลงมาเพื่อได้คะแนน",putFruitInBasket:"ใส่ผลไม้ที่เก็บได้ลงในตะกร้าข้างล่าง",gameTime:"เวลาเกม",seconds:"วินาที",fruitSpeed:"ผลไม้จะตกลงมาแบบสุ่มและเร็วขึ้น",apple:"แอปเปิ้ล",orange:"ส้ม",banana:"กล้วย",strawberry:"สตรอเบอร์รี่",grape:"องุ่น",peach:"พีช",points:"คะแนน",level1:"ระดับ 1",level2:"ระดับ 2",level3:"ระดับ 3",level4:"ระดับ 4",fruitFaster:"ผลไม้เร็วขึ้น",moreFrequent:"บ่อยขึ้น",extremeSpeed:"ความเร็วสุดขีด",prioritizeHighScore:"ให้ความสำคัญกับผลไม้คะแนนสูง",stayFocused:"มีสมาธิและตอบสนองเร็ว",buildHighScore:"สร้างสถิติคะแนนสูง",fruitFromFourDirections:"ผลไม้ปรากฏจากสี่ทิศทางแบบสุ่ม",curvedTrajectory:"ผลไม้ตกลงมาด้วยวิถีโค้ง",realTimeFeedback:"การตอบสนองการเก็บเกี่ยวแบบเรียลไทม์ในเกม",detailedStats:"สถิติรายละเอียดเมื่อเกมจบ",fixedBasketPosition:"ตำแหน่งตะกร้าคงที่โดยไม่สั่น",increasedFrequency:"ความถี่การปรากฏของผลไม้เพิ่มขึ้นอย่างมาก"},la:{title:"Fructus Colligere",start:"Ludum Incipere",restart:"Iterum Incipere",score:"Puncta",time:"Tempus",level:"Gradus",collected:"Collecta",highScore:"Puncta Maxima",rules:"Regulae Ludi",close:"Claudere",hideRules:"Regulae Occultare",basicGameplay:"Ludus Basicus",scoreSystem:"Systema Punctorum",levelSystem:"Systema Graduum",tips:"Consilia",newFeatures:"Facultates Novae",clickFruit:"Clicca fructus cadentes ut puncta accipias",putFruitInBasket:"Pone fructus collectos in corbem infra",gameTime:"Tempus Ludi",seconds:"secundis",fruitSpeed:"Fructus cadent temere et velocitate crescente",apple:"Malum",orange:"Aurantium",banana:"Musa",strawberry:"Fragum",grape:"Uva",peach:"Persicum",points:"puncta",level1:"Gradus 1",level2:"Gradus 2",level3:"Gradus 3",level4:"Gradus 4",fruitFaster:"fructus velociores",moreFrequent:"frequentiores",extremeSpeed:"velocitas extrema",prioritizeHighScore:"Prioritiza fructus punctis altis",stayFocused:"Mane attentus, reage celeriter",buildHighScore:"Aedifica puncta alta",fruitFromFourDirections:"Fructus apparent ex quattuor directionibus temere",curvedTrajectory:"Fructus cadunt cum trajectoriis curvis",realTimeFeedback:"Feedback collectionis tempore reali in ludo",detailedStats:"Statisticae detaillatae cum ludus finitur",fixedBasketPosition:"Positio corbis omnino fixa sine vibratione",increasedFrequency:"Frequentia fructuum apparendi multum aucta"},ms:{title:"Kutip Buah",start:"Mulakan Permainan",restart:"Mulakan Semula",score:"Markah",time:"Masa",level:"Tahap",collected:"Kutip",highScore:"Markah Tertinggi",rules:"Peraturan Permainan",close:"Tutup",hideRules:"Sembunyikan Peraturan",basicGameplay:"Permainan Asas",scoreSystem:"Sistem Markah",levelSystem:"Sistem Tahap",tips:"Petua",newFeatures:"Ciri Baharu",clickFruit:"Klik buah yang jatuh untuk dapat markah",putFruitInBasket:"Letakkan buah yang dikutip ke dalam bakul di bawah",gameTime:"Masa Permainan",seconds:"saat",fruitSpeed:"Buah akan jatuh secara rawak dan laju bertambah",apple:"Epal",orange:"Oren",banana:"Pisang",strawberry:"Strawberi",grape:"Anggur",peach:"Pic",points:"markah",level1:"Tahap 1",level2:"Tahap 2",level3:"Tahap 3",level4:"Tahap 4",fruitFaster:"buah lebih cepat",moreFrequent:"lebih kerap",extremeSpeed:"kelajuan melampau",prioritizeHighScore:"Utamakan buah markah tinggi",stayFocused:"Kekal fokus, bertindak pantas",buildHighScore:"Bina rekod markah tinggi",fruitFromFourDirections:"Buah muncul dari empat arah secara rawak",curvedTrajectory:"Buah jatuh dengan trajektori melengkung",realTimeFeedback:"Maklum balas kutipan masa nyata semasa permainan",detailedStats:"Statistik terperinci apabila permainan tamat",fixedBasketPosition:"Kedudukan bakul tetap sepenuhnya tanpa getaran",increasedFrequency:"Kekerapan kemunculan buah meningkat dengan ketara"}};return((X=oe[e])==null?void 0:X[U])||oe["zh-TW"][U]||U},[d,h]=v.useState([]),[m,g]=v.useState({}),[x,S]=v.useState([]),[j,T]=v.useState(0),[R,I]=v.useState(!1),[F,P]=v.useState(30),[z,H]=v.useState(!1),[J,O]=v.useState(1),[L,C]=v.useState(0);v.useEffect(()=>{const U=Vd("fruitPicking");U&&T(U.highScore||0)},[]),v.useEffect(()=>{if(!z||o.length===0)return;const U=setInterval(()=>{a(oe=>oe.map(ce=>{const le=ce.curveOffset||0,te=ce.curveSpeed||.05,xe=Date.now()*.001,$=Math.sin(xe*te+le)*4,Q=Math.cos(xe*te+le)*2,G=Math.sin(xe*te*2+le)*2,ne=Math.cos(xe*te*1.5+le)*1,se=Math.sin(xe*te*.5+le)*3,me=$+G+se,Ie=Q+ne;return{...ce,y:ce.y+(ce.directionY||ce.speed||1)+Ie,x:ce.x+(ce.directionX||ce.direction||0)+me}}).filter(ce=>ce.y>-20&&ce.y<120&&ce.x>-20&&ce.x<120))},100);return()=>clearInterval(U)},[z,o.length]),v.useEffect(()=>{t>j&&(T(t),Wd("fruitPicking",{highScore:t}))},[t,j]),v.useEffect(()=>{t>=100&&J===1?O(2):t>=250&&J===2?O(3):t>=500&&J===3&&O(4)},[t,J]);const A=[{type:"apple",emoji:"🍎",points:10},{type:"orange",emoji:"🍊",points:15},{type:"banana",emoji:"🍌",points:20},{type:"strawberry",emoji:"🍓",points:25},{type:"grape",emoji:"🍇",points:30},{type:"peach",emoji:"🍑",points:35}],D=()=>{H(!0),r(0),P(30),O(1),C(0),h([]),a([]),g({}),S([]);let U,oe;U=setInterval(()=>{P(X=>X<=1?(clearInterval(U),clearInterval(oe),H(!1),0):X-1)},1e3),setTimeout(()=>{M(),oe=setInterval(()=>{M(),J>=3&&setTimeout(()=>M(),200),J>=4&&setTimeout(()=>M(),400)},J===1?1200:J===2?800:J===3?600:400)},100)},M=()=>{const U=A[Math.floor(Math.random()*A.length)],oe=J===1?1:J===2?1.5:J===3?2:2.5,X=Math.floor(Math.random()*4),ce=Math.random()<.3;let le,te,xe,$;switch(X){case 0:le=Math.random()*80+10,te=-10,xe=(Math.random()-.5)*.3,$=oe;break;case 1:le=Math.random()*80+10,te=110,xe=(Math.random()-.5)*.3,$=-oe;break;case 2:le=-10,te=Math.random()*80+10,xe=oe,$=(Math.random()-.5)*.3;break;case 3:le=110,te=Math.random()*80+10,xe=-oe,$=(Math.random()-.5)*.3;break;default:le=Math.random()*80+10,te=-10,xe=(Math.random()-.5)*.3,$=oe}const Q={id:Date.now()+Math.random(),x:le,y:te,type:U.type,emoji:U.emoji,speed:oe,direction:0,directionX:xe,directionY:$,curveOffset:Math.random()*Math.PI*2,curveSpeed:Math.random()*.15+.08};if(a(G=>[...G,Q]),ce){const G=A[Math.floor(Math.random()*A.length)],ne=Math.random()*80+10,me={id:Date.now()+Math.random()+1,x:ne,y:-10,type:G.type,emoji:G.emoji,speed:oe,direction:0,directionX:(Math.random()-.5)*.3,directionY:oe,curveOffset:Math.random()*Math.PI*2,curveSpeed:Math.random()*.15+.08};a(Ie=>[...Ie,me])}},B=U=>{const oe=o.find(X=>X.id===U);if(oe){const X=A.find(ce=>ce.type===oe.type);a(ce=>ce.filter(le=>le.id!==U)),r(ce=>{const le=ce+((X==null?void 0:X.points)||10);return le>j&&T(le),le}),C(ce=>ce+1),h(ce=>[...ce,{type:oe.type,emoji:oe.emoji}]),g(ce=>{const le={...ce};return le[oe.type]=(le[oe.type]||0)+1,le}),S(ce=>ce.find(te=>te.type===oe.type)?ce.map(te=>te.type===oe.type?{...te,count:te.count+1}:te):[...ce,{type:oe.type,emoji:oe.emoji,count:1}])}},_=()=>L<5?"😅 新手採果者！":L<10?"🍎 有點手感了！":L<15?"🍊 水果獵人！":L<20?"🍌 採果高手！":L<25?"🍓 水果大師！":"👑 採果之王！";return v.useEffect(()=>{if(x.length>0&&z){const U=setTimeout(()=>{S([])},3e3);return()=>clearTimeout(U)}},[x,z]),i.jsxs("div",{style:{height:"100vh",background:"linear-gradient(180deg, #87CEEB 0%, #98FB98 100%)",padding:"clamp(10px, 2vw, 20px)",position:"relative",overflow:"hidden",isolation:"isolate"},children:[i.jsx("button",{onClick:n,style:{position:"absolute",top:"clamp(20px, 4vw, 40px)",left:window.innerWidth>=768?"clamp(10px, 2vw, 15px)":"clamp(20px, 4vw, 40px)",background:"#fff",border:"2px solid #6B5BFF",borderRadius:"50%",width:"clamp(40px, 8vw, 50px)",height:"clamp(40px, 8vw, 50px)",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",zIndex:20,fontSize:"clamp(1.2rem, 3vw, 1.5rem)",color:"#6B5BFF"},children:"←"}),i.jsxs("div",{style:{position:"absolute",top:"clamp(20px, 4vw, 40px)",left:"clamp(60px, 12vw, 70px)",background:"rgba(255,255,255,0.9)",borderRadius:"15px",padding:"clamp(12px, 2.5vw, 16px)",zIndex:10,maxWidth:"180px"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"8px"},children:[i.jsxs("h3",{style:{fontSize:"clamp(1rem, 2.5vw, 1.2rem)",margin:0,lineHeight:"1.2"},children:["🍎 ",c("title")]}),i.jsx("button",{onClick:()=>I(!R),style:{background:"#4CAF50",color:"#fff",border:"none",borderRadius:"12px",padding:"2px 8px",fontSize:"clamp(0.6rem, 1.5vw, 0.7rem)",cursor:"pointer"},children:c(R?"hideRules":"rules")})]}),R&&i.jsxs("div",{style:{background:"rgba(255,255,255,0.8)",borderRadius:"10px",padding:"10px",marginBottom:"10px",textAlign:"left",fontSize:"clamp(0.7rem, 1.8vw, 0.8rem)",lineHeight:"1.3",maxHeight:"clamp(200px, 40vh, 300px)",overflowY:"auto",overflowX:"hidden",scrollbarWidth:"thin",scrollbarColor:"#4CAF50 #f0f0f0"},children:[i.jsxs("h4",{style:{marginBottom:"8px",color:"#333"},children:["🍎 ",c("rules"),"："]}),i.jsx("p",{style:{marginBottom:"6px"},children:i.jsxs("strong",{children:[c("basicGameplay"),"："]})}),i.jsxs("p",{style:{marginBottom:"6px"},children:["• ",c("clickFruit")]}),i.jsxs("p",{style:{marginBottom:"6px"},children:["• ",c("putFruitInBasket")]}),i.jsxs("p",{style:{marginBottom:"6px"},children:["• ",c("gameTime"),"：30",c("seconds")]}),i.jsxs("p",{style:{marginBottom:"6px"},children:["• ",c("fruitSpeed")]}),i.jsx("p",{style:{marginBottom:"6px",marginTop:"8px"},children:i.jsxs("strong",{children:[c("scoreSystem"),"："]})}),i.jsxs("p",{style:{marginBottom:"6px"},children:["• 🍎 ",c("apple"),"：10",c("points")]}),i.jsxs("p",{style:{marginBottom:"6px"},children:["• 🍊 ",c("orange"),"：15",c("points")]}),i.jsxs("p",{style:{marginBottom:"6px"},children:["• 🍌 ",c("banana"),"：20",c("points")]}),i.jsxs("p",{style:{marginBottom:"6px"},children:["• 🍓 ",c("strawberry"),"：25",c("points")]}),i.jsxs("p",{style:{marginBottom:"6px"},children:["• 🍇 ",c("grape"),"：30",c("points")]}),i.jsxs("p",{style:{marginBottom:"6px"},children:["• 🍑 ",c("peach"),"：35",c("points")]}),i.jsx("p",{style:{marginBottom:"6px",marginTop:"8px"},children:i.jsxs("strong",{children:[c("levelSystem"),"："]})}),i.jsxs("p",{style:{marginBottom:"6px"},children:["• ",c("level1"),"：100",c("points")," → ",c("level2"),"（",c("fruitFaster"),"）"]}),i.jsxs("p",{style:{marginBottom:"6px"},children:["• ",c("level2"),"：250",c("points")," → ",c("level3"),"（",c("moreFrequent"),"）"]}),i.jsxs("p",{style:{marginBottom:"6px"},children:["• ",c("level3"),"：500",c("points")," → ",c("level4"),"（",c("extremeSpeed"),"）"]}),i.jsx("p",{style:{marginBottom:"6px",marginTop:"8px"},children:i.jsxs("strong",{children:[c("tips"),"："]})}),i.jsxs("p",{style:{marginBottom:"6px"},children:["• ",c("prioritizeHighScore")]}),i.jsxs("p",{style:{marginBottom:"6px"},children:["• ",c("stayFocused")]}),i.jsxs("p",{style:{marginBottom:"6px"},children:["• ",c("buildHighScore")]}),i.jsx("p",{style:{marginBottom:"6px",marginTop:"8px"},children:i.jsxs("strong",{children:[c("newFeatures"),"："]})}),i.jsxs("p",{style:{marginBottom:"6px"},children:["• ",c("fruitFromFourDirections")]}),i.jsxs("p",{style:{marginBottom:"6px"},children:["• ",c("curvedTrajectory")]}),i.jsxs("p",{style:{marginBottom:"6px"},children:["• ",c("realTimeFeedback")]}),i.jsxs("p",{style:{marginBottom:"6px"},children:["• ",c("detailedStats")]}),i.jsxs("p",{style:{marginBottom:"6px"},children:["• ",c("fixedBasketPosition")]}),i.jsxs("p",{style:{marginBottom:"6px"},children:["• ",c("increasedFrequency")]})]}),!R&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{display:"flex",gap:"clamp(4px, 1vw, 8px)",justifyContent:"center",flexWrap:"wrap",marginBottom:"6px"},children:[i.jsxs("div",{style:{fontSize:"clamp(0.7rem, 1.8vw, 0.85rem)"},children:[c("score"),"：",t]}),i.jsxs("div",{style:{fontSize:"clamp(0.7rem, 1.8vw, 0.85rem)"},children:[c("time"),"：",F,"秒"]}),i.jsxs("div",{style:{fontSize:"clamp(0.7rem, 1.8vw, 0.85rem)"},children:[c("level"),"：",J]})]}),i.jsxs("div",{style:{display:"flex",gap:"clamp(4px, 1vw, 8px)",justifyContent:"center",flexWrap:"wrap"},children:[i.jsxs("div",{style:{fontSize:"clamp(0.6rem, 1.5vw, 0.75rem)"},children:[c("collected"),"：",L,"個"]}),i.jsxs("div",{style:{fontSize:"clamp(0.6rem, 1.5vw, 0.75rem)"},children:[c("highScore"),"：",j]})]}),i.jsx("div",{style:{fontSize:"clamp(0.7rem, 1.8vw, 0.85rem)",color:"#FF5722",fontWeight:"bold",marginTop:"6px",textAlign:"center"},children:_()}),!z&&i.jsx("button",{onClick:D,style:{background:"#FF9800",color:"#fff",border:"none",borderRadius:"20px",padding:"clamp(5px, 1.2vw, 6px) clamp(12px, 2.5vw, 18px)",fontSize:"clamp(0.8rem, 2vw, 0.9rem)",fontWeight:"bold",marginTop:"8px",cursor:"pointer",transition:"all 0.3s ease"},children:c(F===30?"start":"restart")})]})]}),!z&&F===0&&i.jsx("div",{style:{position:"absolute",bottom:"clamp(120px, 20vw, 140px)",left:"50%",transform:"translateX(-50%)",display:"flex",gap:"15px",flexWrap:"wrap",justifyContent:"center",zIndex:10},children:Object.entries(m).map(([U,oe])=>{const X=A.find(ce=>ce.type===U);return i.jsxs("div",{style:{position:"relative",display:"flex",flexDirection:"column",alignItems:"center",gap:"2px"},children:[i.jsx("span",{style:{fontSize:"clamp(2rem, 5vw, 3rem)",filter:"drop-shadow(0 2px 4px rgba(0,0,0,0.3))"},children:X==null?void 0:X.emoji}),i.jsx("span",{style:{position:"absolute",top:"-5px",right:"-5px",background:"#FF5722",color:"white",borderRadius:"50%",width:"clamp(20px, 4vw, 25px)",height:"clamp(20px, 4vw, 25px)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"clamp(0.6rem, 1.5vw, 0.8rem)",fontWeight:"bold",boxShadow:"0 2px 4px rgba(0,0,0,0.3)"},children:oe})]},U)})}),i.jsx("div",{style:{position:"fixed",bottom:"clamp(10px, 2vw, 20px)",left:"50%",transform:"translateX(-50%)",display:"flex",alignItems:"flex-end",justifyContent:"center",zIndex:5,width:"clamp(200px, 30vw, 250px)",pointerEvents:"none",userSelect:"none",touchAction:"none",willChange:"auto",backfaceVisibility:"hidden",contain:"layout style paint",isolation:"isolate"},children:i.jsx("div",{style:{background:"#8B4513",width:"clamp(150px, 25vw, 200px)",height:"clamp(75px, 12vw, 100px)",borderRadius:"50% 50% 0 0",border:"4px solid #654321",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"clamp(1.5rem, 4vw, 2rem)",overflow:"hidden",position:"relative",zIndex:6,pointerEvents:"none",transform:"translateZ(0)",willChange:"auto",userSelect:"none",touchAction:"none",backfaceVisibility:"hidden",perspective:"none",transformStyle:"flat",contain:"layout style paint",isolation:"isolate"},children:d.length>0?i.jsxs("div",{style:{display:"flex",flexWrap:"wrap",justifyContent:"center",alignItems:"center",gap:"2px",maxWidth:"90%",maxHeight:"90%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",pointerEvents:"none",userSelect:"none",touchAction:"none",willChange:"auto",backfaceVisibility:"hidden"},children:[x.slice(-4).map((U,oe)=>i.jsxs("span",{style:{fontSize:"clamp(0.8rem, 2vw, 1rem)",position:"relative"},children:[U.emoji,i.jsx("span",{style:{position:"absolute",top:"-8px",right:"-8px",background:"#FF5722",color:"white",borderRadius:"50%",width:"clamp(12px, 2.5vw, 16px)",height:"clamp(12px, 2.5vw, 16px)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"clamp(0.5rem, 1.2vw, 0.7rem)",fontWeight:"bold"},children:U.count})]},oe)),x.length===0&&d.slice(-6).map((U,oe)=>i.jsx("span",{style:{fontSize:"clamp(0.8rem, 2vw, 1rem)"},children:U.emoji},oe)),d.length>6&&x.length===0&&i.jsxs("span",{style:{fontSize:"clamp(0.6rem, 1.5vw, 0.8rem)",color:"#fff"},children:["+",d.length-6]})]}):i.jsx("span",{style:{color:"#654321"},children:"🧺"})})}),o.map(U=>i.jsx("div",{onClick:oe=>{oe.stopPropagation(),oe.preventDefault(),B(U.id)},onTouchStart:oe=>{oe.stopPropagation(),oe.preventDefault(),B(U.id)},style:{position:"absolute",left:`${U.x}%`,top:`${U.y}%`,fontSize:"clamp(1.5rem, 4vw, 2rem)",cursor:"pointer",userSelect:"none",transition:"all 0.1s ease",zIndex:20,touchAction:"manipulation",willChange:"transform",WebkitUserSelect:"none",MozUserSelect:"none",msUserSelect:"none"},children:U.emoji},U.id))]})}function J3({onClose:n}){const{lang:e}=Lt(),[t,r]=v.useState(!1),[o,a]=v.useState(0),c=be=>{var rt;const ae={"zh-TW":{title:"情緒泡泡爆破",start:"開始遊戲",restart:"重新開始",score:"分數",time:"時間",combo:"連擊",accuracy:"準確率",highScore:"最高分",rules:"遊戲規則",close:"關閉",hideRules:"隱藏規則",gameOver:"遊戲結束",soundOn:"音效開",soundOff:"音效關",rhythmGame:"音樂節奏",gameplay:"遊戲玩法",clickStartButton:"點擊「開始遊戲」按鈕",preciseBubblePop:"精準戳破泡泡",computer:"電腦",preciseClickCenter:"精準點擊泡泡中心戳破",mobile:"手機",preciseTouchCenter:"精準觸摸泡泡中心戳破",highAccuracyRequired:"需要高精準度，點擊泡泡邊緣無效",fastBubbles:"快速泡泡",harderToPop:"更難戳破，需要更高精準度",slowBubbles:"慢速泡泡",easierToPop:"相對容易戳破",emotionBubbleScore:"情緒泡泡分數",angryBubble:"憤怒泡泡",anxiousBubble:"焦慮泡泡",depressedBubble:"憂鬱泡泡",stressedBubble:"壓力泡泡",irritatedBubble:"暴躁泡泡",frustratedBubble:"沮喪泡泡",points:"分",specialBubbles:"特殊泡泡",bombBubble:"炸彈泡泡",clearAllNearby:"清除周圍所有泡泡",goldenBubble:"金色泡泡",doubleScore:"雙倍分數",ghostBubble:"幽靈泡泡",clickTwice:"需要點擊兩次",chainBubble:"連鎖泡泡",clearSameType:"清除同類型泡泡",timeBubble:"時間泡泡",add5Seconds:"增加5秒時間",accuracySystem:"精準度系統",above:"以上",triggerPowerMode:"觸發能量模式",goodAccuracy:"良好精準度",below:"以下",needImproveAccuracy:"需要提高精準度",powerMode:"能量模式",autoTrigger:"自動觸發",powerModeEasier:"能量模式下更容易戳破泡泡",last10Seconds:"持續10秒後自動結束",comboSystem:"連擊系統",continuousPopExtraScore:"連續戳破泡泡可獲得額外分數",timeLimit:"時間限制",sixtySecondsHighestScore:"60秒內獲得最高分數",gameGoal:"遊戲目標",precisePopEmotionBubbles:"精準戳破情緒泡泡，釋放內心壓力",accuracyChallenge:"精準度挑戰",onlyClickCenterToPop:"只有點擊泡泡中心才能戳破",fastBubblesNeedHigherAccuracy:"快速泡泡需要更高精準度"},"zh-CN":{title:"情绪泡泡爆破",start:"开始游戏",restart:"重新开始",score:"分数",time:"时间",combo:"连击",accuracy:"准确率",highScore:"最高分",rules:"游戏规则",close:"关闭",hideRules:"隐藏规则",gameplay:"游戏玩法",clickStartButton:"点击「开始游戏」按钮",preciseBubblePop:"精准戳破泡泡",computer:"电脑",preciseClickCenter:"精准点击泡泡中心戳破",mobile:"手机",preciseTouchCenter:"精准触摸泡泡中心戳破",highAccuracyRequired:"需要高精准度，点击泡泡边缘无效",fastBubbles:"快速泡泡",harderToPop:"更难戳破，需要更高精准度",slowBubbles:"慢速泡泡",easierToPop:"相对容易戳破",emotionBubbleScore:"情绪泡泡分数",angryBubble:"愤怒泡泡",anxiousBubble:"焦虑泡泡",depressedBubble:"忧郁泡泡",stressedBubble:"压力泡泡",irritatedBubble:"暴躁泡泡",frustratedBubble:"沮丧泡泡",points:"分",specialBubbles:"特殊泡泡",bombBubble:"炸弹泡泡",clearAllNearby:"清除周围所有泡泡",goldenBubble:"金色泡泡",doubleScore:"双倍分数",ghostBubble:"幽灵泡泡",clickTwice:"需要点击两次",chainBubble:"连锁泡泡",clearSameType:"清除同类型泡泡",timeBubble:"时间泡泡",add5Seconds:"增加5秒时间",accuracySystem:"精准度系统",above:"以上",triggerPowerMode:"触发能量模式",goodAccuracy:"良好精准度",below:"以下",needImproveAccuracy:"需要提高精准度",powerMode:"能量模式",autoTrigger:"自动触发",powerModeEasier:"能量模式下更容易戳破泡泡",last10Seconds:"持续10秒后自动结束",comboSystem:"连击系统",continuousPopExtraScore:"连续戳破泡泡可获得额外分数",timeLimit:"时间限制",sixtySecondsHighestScore:"60秒内获得最高分数",gameGoal:"游戏目标",precisePopEmotionBubbles:"精准戳破情绪泡泡，释放内心压力",accuracyChallenge:"精准度挑战",onlyClickCenterToPop:"只有点击泡泡中心才能戳破",fastBubblesNeedHigherAccuracy:"快速泡泡需要更高精准度"},en:{title:"Bubble Pop",start:"Start Game",restart:"Restart",score:"Score",time:"Time",combo:"Combo",accuracy:"Accuracy",highScore:"High Score",rules:"Game Rules",close:"Close",hideRules:"Hide Rules",gameplay:"Gameplay",clickStartButton:'Click "Start Game" button',preciseBubblePop:"Precise Bubble Pop",computer:"Computer",preciseClickCenter:"Precisely click bubble center to pop",mobile:"Mobile",preciseTouchCenter:"Precisely touch bubble center to pop",highAccuracyRequired:"High accuracy required, clicking bubble edge is invalid",fastBubbles:"Fast bubbles",harderToPop:"Harder to pop, requires higher accuracy",slowBubbles:"Slow bubbles",easierToPop:"Relatively easier to pop",emotionBubbleScore:"Emotion Bubble Score",angryBubble:"Angry bubble",anxiousBubble:"Anxious bubble",depressedBubble:"Depressed bubble",stressedBubble:"Stressed bubble",irritatedBubble:"Irritated bubble",frustratedBubble:"Frustrated bubble",points:"points",specialBubbles:"Special Bubbles",bombBubble:"Bomb bubble",clearAllNearby:"Clear all nearby bubbles",goldenBubble:"Golden bubble",doubleScore:"Double score",ghostBubble:"Ghost bubble",clickTwice:"Need to click twice",chainBubble:"Chain bubble",clearSameType:"Clear same type bubbles",timeBubble:"Time bubble",add5Seconds:"Add 5 seconds",accuracySystem:"Accuracy System",above:"above",triggerPowerMode:"Trigger power mode",goodAccuracy:"Good accuracy",below:"below",needImproveAccuracy:"Need to improve accuracy",powerMode:"Power Mode",autoTrigger:"Auto trigger",powerModeEasier:"Easier to pop bubbles in power mode",last10Seconds:"Last 10 seconds then auto end",comboSystem:"Combo System",continuousPopExtraScore:"Continuous pop for extra score",timeLimit:"Time Limit",sixtySecondsHighestScore:"60 seconds to get highest score",gameGoal:"Game Goal",precisePopEmotionBubbles:"Precisely pop emotion bubbles, release inner pressure",accuracyChallenge:"Accuracy Challenge",onlyClickCenterToPop:"Only by clicking the center of the bubble can you pop it",fastBubblesNeedHigherAccuracy:"Fast bubbles require higher accuracy"},ja:{title:"バブルポップ",start:"ゲーム開始",restart:"再開",score:"スコア",time:"時間",combo:"コンボ",accuracy:"精度",highScore:"ハイスコア",rules:"ゲームルール",close:"閉じる",hideRules:"ルール非表示",gameplay:"ゲームプレイ",clickStartButton:"「ゲーム開始」ボタンをクリック",preciseBubblePop:"精密バブルポップ",computer:"パソコン",preciseClickCenter:"バブルの中心を精密にクリックしてポップ",mobile:"モバイル",preciseTouchCenter:"バブルの中心を精密にタッチしてポップ",highAccuracyRequired:"高精度が必要、バブルの端をクリックは無効",fastBubbles:"高速バブル",harderToPop:"ポップしにくい、より高い精度が必要",slowBubbles:"低速バブル",easierToPop:"比較的ポップしやすい",emotionBubbleScore:"感情バブルスコア",angryBubble:"怒りバブル",anxiousBubble:"不安バブル",depressedBubble:"憂鬱バブル",stressedBubble:"ストレスバブル",irritatedBubble:"イライラバブル",frustratedBubble:"フラストレーションバブル",points:"ポイント",specialBubbles:"特殊バブル",bombBubble:"爆弾バブル",clearAllNearby:"周辺のすべてのバブルをクリア",goldenBubble:"ゴールデンバブル",doubleScore:"ダブルスコア",ghostBubble:"ゴーストバブル",clickTwice:"2回クリックが必要",chainBubble:"チェーンバブル",clearSameType:"同じタイプのバブルをクリア",timeBubble:"タイムバブル",add5Seconds:"5秒追加",accuracySystem:"精度システム",above:"以上",triggerPowerMode:"パワーモード発動",goodAccuracy:"良好な精度",below:"以下",needImproveAccuracy:"精度向上が必要",powerMode:"パワーモード",autoTrigger:"自動発動",powerModeEasier:"パワーモードでバブルがポップしやすい",last10Seconds:"10秒間続いて自動終了",comboSystem:"コンボシステム",continuousPopExtraScore:"連続ポップでボーナススコア",timeLimit:"時間制限",sixtySecondsHighestScore:"60秒で最高スコアを獲得",gameGoal:"ゲーム目標",precisePopEmotionBubbles:"感情バブルを精密にポップして、内なる圧力を解放",accuracyChallenge:"精度チャレンジ",onlyClickCenterToPop:"バブルの中心をクリックするだけでポップできる",fastBubblesNeedHigherAccuracy:"高速バブルはより高い精度が必要"},ko:{title:"버블 팝",start:"게임 시작",restart:"다시 시작",score:"점수",time:"시간",combo:"콤보",accuracy:"정확도",highScore:"최고 점수",rules:"게임 규칙",close:"닫기",hideRules:"규칙 숨기기",gameplay:"게임 플레이",clickStartButton:"「게임 시작」버튼 클릭",preciseBubblePop:"정밀 버블 팝",computer:"컴퓨터",preciseClickCenter:"버블 중심을 정밀하게 클릭하여 팝",mobile:"모바일",preciseTouchCenter:"버블 중심을 정밀하게 터치하여 팝",highAccuracyRequired:"높은 정확도 필요, 버블 가장자리 클릭은 무효",fastBubbles:"빠른 버블",harderToPop:"팝하기 어려움, 더 높은 정확도 필요",slowBubbles:"느린 버블",easierToPop:"상대적으로 팝하기 쉬움",emotionBubbleScore:"감정 버블 점수",angryBubble:"분노 버블",anxiousBubble:"불안 버블",depressedBubble:"우울 버블",stressedBubble:"스트레스 버블",irritatedBubble:"짜증 버블",frustratedBubble:"좌절 버블",points:"점",specialBubbles:"특수 버블",bombBubble:"폭탄 버블",clearAllNearby:"주변 모든 버블 제거",goldenBubble:"골든 버블",doubleScore:"더블 점수",ghostBubble:"고스트 버블",clickTwice:"두 번 클릭 필요",chainBubble:"체인 버블",clearSameType:"같은 타입 버블 제거",timeBubble:"타임 버블",add5Seconds:"5초 추가",accuracySystem:"정확도 시스템",above:"이상",triggerPowerMode:"파워 모드 발동",goodAccuracy:"좋은 정확도",below:"이하",needImproveAccuracy:"정확도 향상 필요",powerMode:"파워 모드",autoTrigger:"자동 발동",powerModeEasier:"파워 모드에서 버블이 팝하기 쉬움",last10Seconds:"10초간 지속 후 자동 종료",comboSystem:"콤보 시스템",continuousPopExtraScore:"연속 팝으로 보너스 점수",timeLimit:"시간 제한",sixtySecondsHighestScore:"60초 내 최고 점수 획득",gameGoal:"게임 목표",precisePopEmotionBubbles:"감정 버블을 정밀하게 팝하여 내면의 압력을 해방",accuracyChallenge:"정확도 챌린지",onlyClickCenterToPop:"버블의 중심을 클릭해야만 팝할 수 있다",fastBubblesNeedHigherAccuracy:"빠른 버블은 더 높은 정확도가 필요하다"},vi:{title:"Bong Bóng Nổ",start:"Bắt Đầu Trò Chơi",restart:"Chơi Lại",score:"Điểm",time:"Thời Gian",combo:"Combo",accuracy:"Độ Chính Xác",highScore:"Điểm Cao Nhất",rules:"Luật Chơi",close:"Đóng",hideRules:"Ẩn Luật",gameplay:"Cách Chơi",clickStartButton:'Nhấp vào nút "Bắt Đầu Trò Chơi"',preciseBubblePop:"Bong Bóng Nổ Chính Xác",computer:"Máy tính",preciseClickCenter:"Nhấp chính xác vào trung tâm bong bóng để nổ",mobile:"Điện thoại",preciseTouchCenter:"Chạm chính xác vào trung tâm bong bóng để nổ",highAccuracyRequired:"Cần độ chính xác cao, nhấp vào cạnh bong bóng không hiệu quả",fastBubbles:"Bong bóng nhanh",harderToPop:"Khó nổ hơn, cần độ chính xác cao hơn",slowBubbles:"Bong bóng chậm",easierToPop:"Tương đối dễ nổ",emotionBubbleScore:"Điểm Bong Bóng Cảm Xúc",angryBubble:"Bong bóng giận dữ",anxiousBubble:"Bong bóng lo lắng",depressedBubble:"Bong bóng trầm cảm",stressedBubble:"Bong bóng căng thẳng",irritatedBubble:"Bong bóng khó chịu",frustratedBubble:"Bong bóng thất vọng",points:"điểm",specialBubbles:"Bong Bóng Đặc Biệt",bombBubble:"Bong bóng bom",clearAllNearby:"Xóa tất cả bong bóng gần đó",goldenBubble:"Bong bóng vàng",doubleScore:"Điểm gấp đôi",ghostBubble:"Bong bóng ma",clickTwice:"Cần nhấp hai lần",chainBubble:"Bong bóng chuỗi",clearSameType:"Xóa bong bóng cùng loại",timeBubble:"Bong bóng thời gian",add5Seconds:"Thêm 5 giây",accuracySystem:"Hệ Thống Chính Xác",above:"trên",triggerPowerMode:"Kích hoạt chế độ năng lượng",goodAccuracy:"Độ chính xác tốt",below:"dưới",needImproveAccuracy:"Cần cải thiện độ chính xác",powerMode:"Chế Độ Năng Lượng",autoTrigger:"Tự động kích hoạt",powerModeEasier:"Dễ nổ bong bóng hơn trong chế độ năng lượng",last10Seconds:"Kéo dài 10 giây rồi tự động kết thúc",comboSystem:"Hệ Thống Combo",continuousPopExtraScore:"Nổ liên tục để có điểm thêm",timeLimit:"Giới Hạn Thời Gian",sixtySecondsHighestScore:"60 giây để đạt điểm cao nhất",gameGoal:"Mục Tiêu Trò Chơi",precisePopEmotionBubbles:"Nổ chính xác bong bóng cảm xúc, giải phóng áp lực bên trong",accuracyChallenge:"Thử Thách Độ Chính Xác",onlyClickCenterToPop:"Chỉ bằng cách nhấp vào trung tâm bong bóng mới có thể nổ",fastBubblesNeedHigherAccuracy:"Bong bóng nhanh cần độ chính xác cao hơn"},th:{title:"ป๊อปบับเบิล",start:"เริ่มเกม",restart:"เริ่มใหม่",score:"คะแนน",time:"เวลา",combo:"คอมโบ",accuracy:"ความแม่นยำ",highScore:"คะแนนสูงสุด",rules:"กฎเกม",close:"ปิด",hideRules:"ซ่อนกฎ",gameplay:"วิธีเล่น",clickStartButton:'คลิกปุ่ม "เริ่มเกม"',preciseBubblePop:"ป๊อปบับเบิลอย่างแม่นยำ",computer:"คอมพิวเตอร์",preciseClickCenter:"คลิกตรงกลางบับเบิลอย่างแม่นยำเพื่อป๊อป",mobile:"มือถือ",preciseTouchCenter:"แตะตรงกลางบับเบิลอย่างแม่นยำเพื่อป๊อป",highAccuracyRequired:"ต้องการความแม่นยำสูง การคลิกขอบบับเบิลไม่นับ",fastBubbles:"บับเบิลเร็ว",harderToPop:"ป๊อปยากขึ้น ต้องการความแม่นยำสูงขึ้น",slowBubbles:"บับเบิลช้า",easierToPop:"ค่อนข้างป๊อปง่าย",emotionBubbleScore:"คะแนนบับเบิลอารมณ์",angryBubble:"บับเบิลโกรธ",anxiousBubble:"บับเบิลกังวล",depressedBubble:"บับเบิลเศร้า",stressedBubble:"บับเบิลเครียด",irritatedBubble:"บับเบิลหงุดหงิด",frustratedBubble:"บับเบิลหงุดหงิด",points:"คะแนน",specialBubbles:"บับเบิลพิเศษ",bombBubble:"บับเบิลระเบิด",clearAllNearby:"ลบบับเบิลใกล้เคียงทั้งหมด",goldenBubble:"บับเบิลทอง",doubleScore:"คะแนนสองเท่า",ghostBubble:"บับเบิลผี",clickTwice:"ต้องคลิกสองครั้ง",chainBubble:"บับเบิลโซ่",clearSameType:"ลบบับเบิลประเภทเดียวกัน",timeBubble:"บับเบิลเวลา",add5Seconds:"เพิ่ม 5 วินาที",accuracySystem:"ระบบความแม่นยำ",above:"ขึ้นไป",triggerPowerMode:"เปิดโหมดพลัง",goodAccuracy:"ความแม่นยำดี",below:"ลงมา",needImproveAccuracy:"ต้องปรับปรุงความแม่นยำ",powerMode:"โหมดพลัง",autoTrigger:"เปิดอัตโนมัติ",powerModeEasier:"ป๊อปบับเบิลง่ายขึ้นในโหมดพลัง",last10Seconds:"คงอยู่ 10 วินาทีแล้วปิดอัตโนมัติ",comboSystem:"ระบบคอมโบ",continuousPopExtraScore:"ป๊อปต่อเนื่องเพื่อคะแนนเพิ่ม",timeLimit:"จำกัดเวลา",sixtySecondsHighestScore:"60 วินาทีเพื่อคะแนนสูงสุด",gameGoal:"เป้าหมายเกม",precisePopEmotionBubbles:"ป๊อปบับเบิลอารมณ์อย่างแม่นยำ ปลดปล่อยแรงกดดันภายใน",accuracyChallenge:"ความท้าทายความแม่นยำ",onlyClickCenterToPop:"เฉพาะการคลิกตรงกลางบับเบิลเท่านั้นที่สามารถป๊อปได้",fastBubblesNeedHigherAccuracy:"บับเบิลเร็วต้องการความแม่นยำสูงขึ้น"},la:{title:"Bulla Explodere",start:"Ludum Incipere",restart:"Iterum Incipere",score:"Puncta",time:"Tempus",combo:"Combo",accuracy:"Accuratio",highScore:"Puncta Maxima",rules:"Regulae Ludi",close:"Claudere",hideRules:"Regulae Occultare",gameplay:"Ludus",clickStartButton:'Clicca "Ludum Incipere" pugnum',preciseBubblePop:"Bulla Accurata Explodere",computer:"Computatrum",preciseClickCenter:"Clicca accurate centrum bullae ut explodat",mobile:"Mobile",preciseTouchCenter:"Tange accurate centrum bullae ut explodat",highAccuracyRequired:"Accuratio alta requiritur, cliccare marginem bullae invalidum est",fastBubbles:"Bullae veloces",harderToPop:"Difficilius explodere, accuratio altior requiritur",slowBubbles:"Bullae tardae",easierToPop:"Relativiter facilius explodere",emotionBubbleScore:"Puncta Bullae Emotionis",angryBubble:"Bulla irata",anxiousBubble:"Bulla anxia",depressedBubble:"Bulla depressa",stressedBubble:"Bulla pressa",irritatedBubble:"Bulla irritata",frustratedBubble:"Bulla frustrata",points:"puncta",specialBubbles:"Bullae Speciales",bombBubble:"Bulla bomba",clearAllNearby:"Clara omnes bullas proximas",goldenBubble:"Bulla aurea",doubleScore:"Puncta dupla",ghostBubble:"Bulla phantasma",clickTwice:"Opus est bis cliccare",chainBubble:"Bulla catena",clearSameType:"Clara bullas eiusdem generis",timeBubble:"Bulla temporis",add5Seconds:"Adde 5 secundis",accuracySystem:"Systema Accurationis",above:"supra",triggerPowerMode:"Activa modum potentiae",goodAccuracy:"Accuratio bona",below:"infra",needImproveAccuracy:"Opus est accuratio meliorare",powerMode:"Modus Potentiae",autoTrigger:"Auto activa",powerModeEasier:"Facilius explodere bullas in modo potentiae",last10Seconds:"Dura 10 secundis deinde auto finis",comboSystem:"Systema Combo",continuousPopExtraScore:"Explodere continuum pro punctis extra",timeLimit:"Finis Temporis",sixtySecondsHighestScore:"60 secundis pro punctis maximis",gameGoal:"Finis Ludi",precisePopEmotionBubbles:"Explodere accurate bullas emotionis, libera pressionem internam",accuracyChallenge:"Provocatio Accurationis",onlyClickCenterToPop:"Solum cliccare centrum bullae potest explodere",fastBubblesNeedHigherAccuracy:"Bullae veloces accuratio altior requiritur"},ms:{title:"Letup Buih",start:"Mulakan Permainan",restart:"Mulakan Semula",score:"Markah",time:"Masa",combo:"Combo",accuracy:"Ketepatan",highScore:"Markah Tertinggi",rules:"Peraturan Permainan",close:"Tutup",hideRules:"Sembunyikan Peraturan",gameplay:"Cara Bermain",clickStartButton:'Klik butang "Mulakan Permainan"',preciseBubblePop:"Letup Buih Tepat",computer:"Komputer",preciseClickCenter:"Klik tepat di tengah buih untuk meletup",mobile:"Mudah alih",preciseTouchCenter:"Sentuh tepat di tengah buih untuk meletup",highAccuracyRequired:"Ketepatan tinggi diperlukan, mengklik tepi buih tidak sah",fastBubbles:"Buih pantas",harderToPop:"Lebih sukar untuk meletup, memerlukan ketepatan lebih tinggi",slowBubbles:"Buih perlahan",easierToPop:"Relatif lebih mudah untuk meletup",emotionBubbleScore:"Markah Buih Emosi",angryBubble:"Buih marah",anxiousBubble:"Buih cemas",depressedBubble:"Buih tertekan",stressedBubble:"Buih tertekan",irritatedBubble:"Buih jengkel",frustratedBubble:"Buih kecewa",points:"markah",specialBubbles:"Buih Khas",bombBubble:"Buih bom",clearAllNearby:"Kosongkan semua buih berdekatan",goldenBubble:"Buih emas",doubleScore:"Markah berganda",ghostBubble:"Buih hantu",clickTwice:"Perlu klik dua kali",chainBubble:"Buih rantai",clearSameType:"Kosongkan buih jenis sama",timeBubble:"Buih masa",add5Seconds:"Tambah 5 saat",accuracySystem:"Sistem Ketepatan",above:"ke atas",triggerPowerMode:"Pencetus mod kuasa",goodAccuracy:"Ketepatan baik",below:"ke bawah",needImproveAccuracy:"Perlu tingkatkan ketepatan",powerMode:"Mod Kuasa",autoTrigger:"Pencetus automatik",powerModeEasier:"Lebih mudah meletup buih dalam mod kuasa",last10Seconds:"Bertahan 10 saat kemudian tamat automatik",comboSystem:"Sistem Combo",continuousPopExtraScore:"Letup berterusan untuk markah tambahan",timeLimit:"Had Masa",sixtySecondsHighestScore:"60 saat untuk markah tertinggi",gameGoal:"Matlamat Permainan",precisePopEmotionBubbles:"Letup tepat buih emosi, lepaskan tekanan dalaman",accuracyChallenge:"Cabaran Ketepatan",onlyClickCenterToPop:"Hanya dengan mengklik pusat buih boleh meletup",fastBubblesNeedHigherAccuracy:"Buih pantas memerlukan ketepatan lebih tinggi"}};return((rt=ae[e])==null?void 0:rt[be])||ae["zh-TW"][be]||be},[d,h]=v.useState(60),[m,g]=v.useState(0),[x,S]=v.useState(0),[j,T]=v.useState(!1),[R,I]=v.useState(0),[F,P]=v.useState(!1),[z,H]=v.useState(0),[J,O]=v.useState(0),[L,C]=v.useState(0),[A,D]=v.useState(!1),[M,B]=v.useState(0),[_,U]=v.useState([]),[oe,X]=v.useState([]);v.useEffect(()=>{const be=localStorage.getItem("bubblePopHighScore");be&&S(parseInt(be))},[]);const ce=[{color:"#ff6b6b",emotion:"😠",points:10,name:"憤怒"},{color:"#4ecdc4",emotion:"😰",points:15,name:"焦慮"},{color:"#ffe66d",emotion:"😔",points:20,name:"憂鬱"},{color:"#a8e6cf",emotion:"😤",points:25,name:"壓力"},{color:"#ff8a80",emotion:"😡",points:30,name:"暴躁"},{color:"#9575cd",emotion:"😞",points:35,name:"沮喪"}],le=()=>{const be=["戳破煩惱，釋放心情！","泡泡爆破，壓力全消！","情緒泡泡，一戳就爆！","連擊模式，心情舒暢！","泡泡療法，治癒心靈！"];return be[Math.floor(Math.random()*be.length)]},[te]=v.useState(le()),xe=()=>{r(!0),a(0),h(60),g(0),U([]),X([]),H(0),O(0),C(0),D(!1),B(0)},$=()=>{if(!t)return;const be=ce[Math.floor(Math.random()*ce.length)],ae=Math.random()*80+10,rt=Math.random()*80+10,Le=Math.random();let $e;Le<.3?$e=Math.random()*10+15:Le<.6?$e=Math.random()*15+25:Le<.85?$e=Math.random()*20+40:$e=Math.random()*25+60;const fe=Math.random();let _e="normal",Ce=be.points,ze=be.color,De=be.emotion;if(fe<.05)_e="bomb",Ce=50,ze="#ff4757",De="💣",$e=Math.random()*15+45;else if(fe<.1)_e="golden",Ce=100,ze="#ffa502",De="⭐",$e=Math.random()*20+50;else{if(fe<.15)return _e="ghost",Ce=30,ze="#a4b0be",De="👻",$e=Math.random()*10+20,{id:Date.now(),x:ae,y:rt,size:$e,color:ze,emotion:De,points:Ce,speed:Math.random()*3+2,opacity:.8+Math.random()*.2,type:_e,health:2};fe<.2?(_e="chain",Ce=40,ze="#2ed573",De="🔗",$e=Math.random()*15+35):fe<.25&&(_e="time",Ce=25,ze="#3742fa",De="⏰",$e=Math.random()*12+25)}const K={id:Date.now(),x:ae,y:rt,size:$e,color:ze,emotion:De,points:Ce,speed:Math.random()*3+1.5,opacity:.8+Math.random()*.2,type:_e,chainId:_e==="chain"?Math.floor(Math.random()*1e3):void 0,timeBonus:_e==="time"?5:void 0};U(ie=>[...ie,K])},Q=be=>{const ae=_.find(_e=>_e.id===be);if(!ae)return;const rt=Math.floor(m/5)*5;let Le=ae.points+rt;if(ae.type==="bomb"){const _e=_.filter(Ce=>Ce.id!==be&&Math.sqrt((Ce.x-ae.x)**2+(Ce.y-ae.y)**2)<15);_e.forEach(Ce=>{Le+=Ce.points,g(ze=>ze+1)}),U(Ce=>Ce.filter(ze=>ze.id!==be&&!_e.find(De=>De.id===ze.id)))}else if(ae.type==="golden")Le*=2,U(_e=>_e.filter(Ce=>Ce.id!==be));else if(ae.type==="ghost"){if(ae.health&&ae.health>1){U(_e=>_e.map(Ce=>Ce.id===be?{...Ce,health:Ce.health-1}:Ce));return}U(_e=>_e.filter(Ce=>Ce.id!==be))}else if(ae.type==="chain"){const _e=_.filter(Ce=>Ce.id!==be&&Ce.chainId===ae.chainId);_e.forEach(Ce=>{Le+=Ce.points,g(ze=>ze+1)}),U(Ce=>Ce.filter(ze=>ze.id!==be&&!_e.find(De=>De.id===ze.id)))}else ae.type==="time"?(h(_e=>_e+(ae.timeBonus||5)),U(_e=>_e.filter(Ce=>Ce.id!==be))):U(_e=>_e.filter(Ce=>Ce.id!==be));a(_e=>_e+Le),g(_e=>_e+1),I(3),m>=4&&(P(!0),qe(),setTimeout(()=>P(!1),1e3));const $e=ae.type==="bomb"?15:8,fe=[];for(let _e=0;_e<$e;_e++){const Ce=_e/$e*Math.PI*2,ze=2+Math.random()*3;fe.push({id:Date.now()+_e,x:ae.x,y:ae.y,vx:Math.cos(Ce)*ze,vy:Math.sin(Ce)*ze,color:ae.color,life:1})}X(_e=>[..._e,...fe])},G=()=>{r(!1),o>x&&(S(o),localStorage.setItem("bubblePopHighScore",o.toString()))};v.useEffect(()=>{if(!t)return;const be=setInterval(()=>{const ae=.03+(60-d)*.001,rt=Math.min(.15,ae*1.8);Math.random()<rt&&$(),U(Le=>Le.map($e=>({...$e,y:$e.y-$e.speed*1.2,opacity:$e.opacity-.003,x:$e.x+(Math.random()-.5)*.4})).filter($e=>$e.y>-10&&$e.opacity>.1)),X(Le=>Le.map($e=>({...$e,x:$e.x+$e.vx,y:$e.y+$e.vy,vy:$e.vy+.1,life:$e.life-.02})).filter($e=>$e.life>0)),R>0?I(Le=>Le-.05):m>0&&g(0),M>0?B(Le=>Le-.05):A&&D(!1)},30);return()=>clearInterval(be)},[t]),v.useEffect(()=>{if(!t||d<=0)return;const be=setInterval(()=>{h(ae=>ae<=1?(G(),0):ae-1)},1e3);return()=>clearInterval(be)},[t,d]),v.useEffect(()=>{},[t,_]);const[ne,se]=v.useState(null),[me,Ie]=v.useState(!0);v.useEffect(()=>{if(typeof window<"u"&&window.AudioContext){const be=new AudioContext;se(be)}},[]);const Pe=()=>{if(!(!ne||!me))try{const be=ne.createOscillator(),ae=ne.createGain();be.connect(ae),ae.connect(ne.destination),be.type="sine",be.frequency.setValueAtTime(800,ne.currentTime),be.frequency.exponentialRampToValueAtTime(200,ne.currentTime+.1),ae.gain.setValueAtTime(.3,ne.currentTime),ae.gain.exponentialRampToValueAtTime(.01,ne.currentTime+.1),be.start(ne.currentTime),be.stop(ne.currentTime+.1)}catch(be){console.log("音效播放失敗:",be)}},qe=()=>{if(!(!ne||!me))try{const be=ne.createOscillator(),ae=ne.createGain();be.connect(ae),ae.connect(ne.destination),be.type="square",be.frequency.setValueAtTime(1e3,ne.currentTime),be.frequency.exponentialRampToValueAtTime(400,ne.currentTime+.2),ae.gain.setValueAtTime(.2,ne.currentTime),ae.gain.exponentialRampToValueAtTime(.01,ne.currentTime+.2),be.start(ne.currentTime),be.stop(ne.currentTime+.2)}catch(be){console.log("連擊音效播放失敗:",be)}},Ge=()=>{if(!(!ne||!me))try{const be=ne.createOscillator(),ae=ne.createGain();be.connect(ae),ae.connect(ne.destination),be.type="sawtooth",be.frequency.setValueAtTime(600,ne.currentTime),be.frequency.exponentialRampToValueAtTime(1200,ne.currentTime+.3),ae.gain.setValueAtTime(.15,ne.currentTime),ae.gain.exponentialRampToValueAtTime(.01,ne.currentTime+.3),be.start(ne.currentTime),be.stop(ne.currentTime+.3)}catch(be){console.log("能量模式音效播放失敗:",be)}};return i.jsxs("div",{style:{width:"100vw",height:"100vh",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",position:"relative",overflow:"auto",cursor:t?"pointer":"default",touchAction:"pan-y",userSelect:"none",WebkitUserSelect:"none",WebkitTouchCallout:"none"},onClick:be=>{be.preventDefault(),be.stopPropagation()},onMouseDown:be=>{be.preventDefault(),be.stopPropagation()},children:[i.jsx("style",{children:`
          @keyframes float {
            0%, 100% { transform: translate(-50%, -50%) translateY(0px); }
            50% { transform: translate(-50%, -50%) translateY(-10px); }
          }
          @keyframes comboEffect {
            0% { 
              transform: translate(-50%, -50%) scale(0.5);
              opacity: 0;
            }
            50% { 
              transform: translate(-50%, -50%) scale(1.2);
              opacity: 1;
            }
            100% { 
              transform: translate(-50%, -50%) scale(1);
              opacity: 0;
            }
          }
          @keyframes powerMode {
            0% { 
              opacity: 0.7;
              textShadow: 0 0 5px #FF5722;
            }
            100% { 
              opacity: 1;
              textShadow: 0 0 15px #FF5722, 0 0 25px #FF5722;
            }
          }
          @keyframes popEffect {
            0% { 
              transform: translate(-50%, -50%) scale(1);
              opacity: 1;
            }
            50% { 
              transform: translate(-50%, -50%) scale(1.3);
              opacity: 0.8;
            }
            100% { 
              transform: translate(-50%, -50%) scale(0);
              opacity: 0;
            }
          }
        `}),i.jsx("button",{onClick:n,style:{position:"absolute",top:"clamp(20px, 4vw, 40px)",left:"clamp(20px, 4vw, 40px)",background:"#fff",border:"2px solid #9C27B0",borderRadius:"50%",width:"clamp(40px, 8vw, 50px)",height:"clamp(40px, 8vw, 50px)",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",fontSize:"clamp(1.2rem, 3vw, 1.5rem)",zIndex:10,boxShadow:"0 2px 8px rgba(0,0,0,0.2)"},children:"←"}),i.jsxs("div",{style:{position:"absolute",top:"clamp(20px, 4vw, 40px)",left:"clamp(80px, 16vw, 100px)",background:"rgba(255,255,255,0.9)",borderRadius:"15px",padding:"clamp(12px, 2.5vw, 16px)",zIndex:5,maxWidth:"180px"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"8px"},children:[i.jsxs("h3",{style:{fontSize:"clamp(1rem, 2.5vw, 1.2rem)",margin:0,lineHeight:"1.2"},children:["🫧 ",c("title")]}),i.jsx("button",{onClick:()=>T(!j),style:{background:"#9C27B0",color:"#fff",border:"none",borderRadius:"12px",padding:"2px 8px",fontSize:"clamp(0.6rem, 1.5vw, 0.7rem)",cursor:"pointer"},children:c(j?"hideRules":"rules")})]}),!j&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{display:"flex",gap:"clamp(4px, 1vw, 8px)",justifyContent:"center",flexWrap:"wrap",marginBottom:"6px"},children:[i.jsxs("div",{style:{fontSize:"clamp(0.7rem, 1.8vw, 0.85rem)"},children:[c("score"),"：",o]}),i.jsxs("div",{style:{fontSize:"clamp(0.7rem, 1.8vw, 0.85rem)"},children:[c("time"),"：",d,"秒"]}),i.jsxs("div",{style:{fontSize:"clamp(0.7rem, 1.8vw, 0.85rem)",color:m>=5?"#ff6b6b":m>=3?"#ffa502":"#333",fontWeight:m>=3?"bold":"normal"},children:[c("combo"),"：",m]})]}),i.jsxs("div",{style:{display:"flex",gap:"clamp(4px, 1vw, 8px)",justifyContent:"center",flexWrap:"wrap",marginBottom:"6px"},children:[i.jsxs("div",{style:{fontSize:"clamp(0.7rem, 1.8vw, 0.85rem)",color:z>=80?"#4CAF50":z>=60?"#FF9800":"#F44336"},children:[c("accuracy"),"：",z.toFixed(1),"%"]}),A&&i.jsx("div",{style:{fontSize:"clamp(0.7rem, 1.8vw, 0.85rem)",color:"#FF5722",fontWeight:"bold",animation:"powerMode 0.5s ease-in-out infinite alternate"},children:"⚡能量模式"})]}),i.jsxs("div",{style:{display:"flex",gap:"clamp(4px, 1vw, 8px)",justifyContent:"center",flexWrap:"wrap"},children:[i.jsxs("div",{style:{fontSize:"clamp(0.6rem, 1.5vw, 0.75rem)"},children:["泡泡：",_.length]}),i.jsxs("div",{style:{fontSize:"clamp(0.6rem, 1.5vw, 0.75rem)"},children:[c("highScore"),"：",x]}),i.jsx("div",{style:{fontSize:"clamp(0.6rem, 1.5vw, 0.75rem)",color:_.some(be=>be.speed>=3)?"#ff6b6b":_.some(be=>be.speed>=2)?"#ffa502":"#4CAF50"},children:_.some(be=>be.speed>=3)?"🚀 快速":_.some(be=>be.speed>=2)?"⚡ 中速":"🐌 慢速"})]}),i.jsx("div",{style:{display:"flex",justifyContent:"center",marginTop:"clamp(4px, 1vw, 8px)",gap:"clamp(4px, 1vw, 8px)"},children:i.jsxs("button",{onClick:()=>Ie(!me),style:{background:me?"#4CAF50":"#f44336",color:"white",border:"none",borderRadius:"8px",padding:"clamp(2px, 0.5vw, 4px) clamp(6px, 1.5vw, 8px)",fontSize:"clamp(0.5rem, 1.2vw, 0.6rem)",cursor:"pointer",display:"flex",alignItems:"center",gap:"2px"},children:[me?"🔊":"🔇"," ",c(me?"soundOn":"soundOff")]})}),i.jsx("div",{style:{fontSize:"clamp(0.7rem, 1.8vw, 0.85rem)",color:"#9C27B0",fontWeight:"bold",marginTop:"6px",textAlign:"center"},children:te}),!t&&i.jsx("button",{onClick:xe,style:{background:"#9C27B0",color:"#fff",border:"none",borderRadius:"20px",padding:"clamp(5px, 1.2vw, 6px) clamp(12px, 2.5vw, 18px)",fontSize:"clamp(0.8rem, 2vw, 0.9rem)",fontWeight:"bold",marginTop:"8px",cursor:"pointer",transition:"all 0.3s ease"},children:c("start")})]}),j&&i.jsxs("div",{style:{maxHeight:"200px",overflowY:"auto",fontSize:"clamp(0.7rem, 1.8vw, 0.85rem)",lineHeight:"1.4"},children:[i.jsxs("h4",{style:{margin:"0 0 8px 0",color:"#9C27B0"},children:[c("gameplay"),"："]}),i.jsxs("ul",{style:{margin:"0",paddingLeft:"15px"},children:[i.jsxs("li",{children:[i.jsx("strong",{children:c("start")}),"：",c("clickStartButton")]}),i.jsxs("li",{children:[i.jsx("strong",{children:c("preciseBubblePop")}),"：",i.jsx("br",{}),c("computer"),"：",c("preciseClickCenter"),i.jsx("br",{}),c("mobile"),"：",c("preciseTouchCenter"),i.jsx("br",{}),"⚠️ ",c("highAccuracyRequired"),i.jsx("br",{}),"🚀 ",c("fastBubbles"),"：",c("harderToPop"),i.jsx("br",{}),"🐌 ",c("slowBubbles"),"：",c("easierToPop")]}),i.jsxs("li",{children:[i.jsx("strong",{children:c("emotionBubbleScore")}),"：",i.jsx("br",{}),"😠 ",c("angryBubble"),"：10",c("points"),i.jsx("br",{}),"😰 ",c("anxiousBubble"),"：15",c("points"),i.jsx("br",{}),"😔 ",c("depressedBubble"),"：20",c("points"),i.jsx("br",{}),"😤 ",c("stressedBubble"),"：25",c("points"),i.jsx("br",{}),"😡 ",c("irritatedBubble"),"：30",c("points"),i.jsx("br",{}),"😞 ",c("frustratedBubble"),"：35",c("points")]}),i.jsxs("li",{children:[i.jsx("strong",{children:c("specialBubbles")}),"：",i.jsx("br",{}),"💣 ",c("bombBubble"),"：50",c("points"),"，",c("clearAllNearby"),i.jsx("br",{}),"⭐ ",c("goldenBubble"),"：100",c("points"),"，",c("doubleScore"),i.jsx("br",{}),"👻 ",c("ghostBubble"),"：30",c("points"),"，",c("clickTwice"),i.jsx("br",{}),"🔗 ",c("chainBubble"),"：40",c("points"),"，",c("clearSameType"),i.jsx("br",{}),"⏰ ",c("timeBubble"),"：25",c("points"),"，",c("add5Seconds")]}),i.jsxs("li",{children:[i.jsx("strong",{children:c("accuracySystem")}),"：",i.jsx("br",{}),"🟢 80%",c("above"),"：",c("triggerPowerMode"),i.jsx("br",{}),"🟡 60-79%：",c("goodAccuracy"),i.jsx("br",{}),"🔴 60%",c("below"),"：",c("needImproveAccuracy")]}),i.jsxs("li",{children:[i.jsx("strong",{children:c("powerMode")}),"：",i.jsx("br",{}),"⚡ 80%",c("above"),c("autoTrigger"),i.jsx("br",{}),"🎯 ",c("powerModeEasier"),i.jsx("br",{}),"⏱️ ",c("last10Seconds")]}),i.jsxs("li",{children:[i.jsx("strong",{children:c("comboSystem")}),"：",c("continuousPopExtraScore")]}),i.jsxs("li",{children:[i.jsx("strong",{children:c("timeLimit")}),"：",c("60SecondsHighestScore")]}),i.jsxs("li",{children:[i.jsx("strong",{children:c("gameGoal")}),"：",c("precisePopEmotionBubbles"),"！"]})]})]})]}),_.map(be=>{const ae=be.type==="bomb"?{animation:"float 2s ease-in-out infinite",boxShadow:"0 0 20px #ff4757"}:be.type==="golden"?{animation:"float 1.5s ease-in-out infinite",boxShadow:"0 0 25px #ffa502"}:be.type==="ghost"?{animation:"float 1s ease-in-out infinite",opacity:.6}:be.type==="chain"?{animation:"float 1.8s ease-in-out infinite",boxShadow:"0 0 15px #2ed573"}:be.type==="time"?{animation:"float 1.2s ease-in-out infinite",boxShadow:"0 0 18px #3742fa"}:{};return i.jsx("div",{style:{position:"absolute",left:`${be.x}%`,top:`${be.y}%`,transform:"translate(-50%, -50%)",width:`${be.size*1.8}px`,height:`${be.size*1.8}px`,background:`radial-gradient(circle at 30% 30%, ${be.color}40, ${be.color})`,borderRadius:"50%",border:`2px solid ${be.color}80`,display:"flex",alignItems:"center",justifyContent:"center",fontSize:`${Math.max(12,be.size*.4)}px`,opacity:be.opacity,cursor:"pointer",transition:"all 0.2s ease",zIndex:20,...ae},onMouseEnter:rt=>{rt.currentTarget.style.transform="translate(-50%, -50%) scale(1.1)"},onMouseLeave:rt=>{rt.currentTarget.style.transform="translate(-50%, -50%) scale(1)"},onClick:rt=>{if(rt.preventDefault(),rt.stopPropagation(),console.log("泡泡被點擊:",be.id),t){const Le=rt.currentTarget;Le.style.animation="popEffect 0.4s ease-out forwards";const $e=Le.getBoundingClientRect(),fe=$e.left+$e.width/2,_e=$e.top+$e.height/2;for(let Ce=0;Ce<12;Ce++){const ze=document.createElement("div");ze.style.position="fixed",ze.style.left=fe+"px",ze.style.top=_e+"px",ze.style.width="6px",ze.style.height="6px",ze.style.background=be.color,ze.style.borderRadius="50%",ze.style.pointerEvents="none",ze.style.zIndex="1000",ze.style.boxShadow=`0 0 8px ${be.color}`,ze.style.transition="all 0.6s ease",document.body.appendChild(ze);const De=Ce*30*Math.PI/180,K=60+Math.random()*40,ie=fe+Math.cos(De)*K,q=_e+Math.sin(De)*K;setTimeout(()=>{ze.style.left=ie+"px",ze.style.top=q+"px",ze.style.opacity="0",ze.style.transform="scale(0)"},10),setTimeout(()=>{document.body.contains(ze)&&document.body.removeChild(ze)},600)}O(Ce=>Ce+1),C(Ce=>Ce+1),Q(be.id),Pe(),z>=80&&!A&&(D(!0),B(10),Ge()),H(J>0?L/J*100:0)}},onTouchStart:rt=>{rt.preventDefault(),rt.stopPropagation(),console.log("泡泡被觸摸:",be.id);const Le=rt.currentTarget;if(Le.style.transform="translate(-50%, -50%) scale(1.2)",Le.style.transition="transform 0.1s ease",setTimeout(()=>{Le.style.transform="translate(-50%, -50%) scale(1)"},100),t){console.log("手機版直接爆破泡泡:",be.id);const $e=rt.currentTarget;$e.style.animation="popEffect 0.4s ease-out forwards";const fe=$e.getBoundingClientRect(),_e=fe.left+fe.width/2,Ce=fe.top+fe.height/2;for(let ze=0;ze<12;ze++){const De=document.createElement("div");De.style.position="fixed",De.style.left=_e+"px",De.style.top=Ce+"px",De.style.width="6px",De.style.height="6px",De.style.background=be.color,De.style.borderRadius="50%",De.style.pointerEvents="none",De.style.zIndex="1000",De.style.boxShadow=`0 0 8px ${be.color}`,De.style.transition="all 0.6s ease",document.body.appendChild(De);const K=ze*30*Math.PI/180,ie=60+Math.random()*40,q=_e+Math.cos(K)*ie,Me=Ce+Math.sin(K)*ie;setTimeout(()=>{De.style.left=q+"px",De.style.top=Me+"px",De.style.opacity="0",De.style.transform="scale(0)"},10),setTimeout(()=>{document.body.contains(De)&&document.body.removeChild(De)},600)}O(ze=>ze+1),C(ze=>ze+1),Q(be.id),Pe(),z>=80&&!A&&(D(!0),B(10),Ge()),H(J>0?L/J*100:0)}},children:be.emotion},be.id)}),oe.map(be=>i.jsx("div",{style:{position:"absolute",left:`${be.x}%`,top:`${be.y}%`,transform:"translate(-50%, -50%)",width:"4px",height:"4px",background:be.color,borderRadius:"50%",opacity:be.life,pointerEvents:"none"}},be.id)),F&&i.jsxs("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",fontSize:"clamp(2rem, 5vw, 3rem)",fontWeight:"bold",color:"#ff6b6b",textShadow:"0 0 20px #ff6b6b",animation:"comboEffect 1s ease-out forwards",pointerEvents:"none",zIndex:1e3},children:["COMBO x",m,"!"]}),!t&&i.jsxs("div",{style:{position:"absolute",bottom:"clamp(20px, 4vw, 40px)",left:"50%",transform:"translateX(-50%)",background:"rgba(0,0,0,0.7)",color:"#fff",padding:"clamp(8px, 2vw, 12px)",borderRadius:"10px",fontSize:"clamp(0.7rem, 1.8vw, 0.85rem)",textAlign:"center",zIndex:100},children:["🎯 ",c("accuracyChallenge"),"：",c("onlyClickCenterToPop"),"！",i.jsx("br",{}),"🚀 ",c("fastBubblesNeedHigherAccuracy"),"！"]}),!t&&o>0&&i.jsxs("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",background:"rgba(255,255,255,0.95)",borderRadius:"20px",padding:"clamp(20px, 4vw, 30px)",textAlign:"center",zIndex:1001,minWidth:"clamp(250px, 50vw, 350px)"},children:[i.jsx("h2",{style:{fontSize:"clamp(1.5rem, 3.5vw, 2rem)",margin:"0 0 15px 0",color:"#9C27B0"},children:"遊戲結束！"}),i.jsxs("div",{style:{fontSize:"clamp(1rem, 2.5vw, 1.2rem)",marginBottom:"10px"},children:["最終分數：",o]}),i.jsxs("div",{style:{fontSize:"clamp(0.9rem, 2vw, 1rem)",marginBottom:"20px",color:"#666"},children:["最高分數：",x]}),i.jsxs("div",{style:{display:"flex",gap:"10px",justifyContent:"center"},children:[i.jsx("button",{onClick:xe,style:{background:"#9C27B0",color:"#fff",border:"none",borderRadius:"15px",padding:"clamp(8px, 1.5vw, 12px) clamp(16px, 3vw, 24px)",fontSize:"clamp(0.9rem, 2vw, 1rem)",cursor:"pointer"},children:"再玩一次"}),i.jsx("button",{onClick:n,style:{background:"#666",color:"#fff",border:"none",borderRadius:"15px",padding:"clamp(8px, 1.5vw, 12px) clamp(16px, 3vw, 24px)",fontSize:"clamp(0.9rem, 2vw, 1rem)",cursor:"pointer"},children:"返回"})]})]})]})}function Z3({onClose:n}){const{lang:e}=Lt(),[t,r]=v.useState(0),[o,a]=v.useState(0),[c,d]=v.useState(!1),[h,m]=v.useState(60),[g,x]=v.useState(50),[S,j]=v.useState([]),[T,R]=v.useState(3),[I,F]=v.useState(1),[P,z]=v.useState(0),[H,J]=v.useState(!1),[O,L]=v.useState(!1),[C,A]=v.useState(!1),[D,M]=v.useState(!1),[B,_]=v.useState(!1),[U,oe]=v.useState({x:0,y:0}),X=ne=>{var me;const se={"zh-TW":{score:"分數",time:"時間",level:"等級",combo:"連擊",title:"極速賽車",rules:"遊戲規則",close:"關閉",gameOver:"遊戲結束",controlMethod:"控制方式",useArrowKeysOrButtons:"使用方向鍵 ← → 或螢幕按鈕控制賽車",moveLeftRightToAvoid:"左右移動避開障礙物",gameObjective:"遊戲目標",avoidAllObstacles:"避開所有障礙物（石頭、汽車、卡車）",successfulAvoidance:"成功避開獲得5分 + 連擊獎勵",collisionPenalty:"碰撞障礙物扣10分並重置連擊",scoringSystem:"計分系統",baseScore:"基礎分數：避開障礙物 +5分",comboBonus:"連擊獎勵：每次連擊額外 +1分",levelUp:"等級提升：每100分提升一個等級",speedIncrease:"速度增加：等級越高，障礙物移動越快",gameTime:"遊戲時間",sixtySecondsPerGame:"每局遊戲60秒",autoScoreWhenTimeUp:"時間結束自動結算分數"},"zh-CN":{score:"分数",time:"时间",level:"等级",combo:"连击",title:"极速赛车",rules:"游戏规则",close:"关闭",controlMethod:"控制方式",useArrowKeysOrButtons:"使用方向键 ← → 或屏幕按钮控制赛车",moveLeftRightToAvoid:"左右移动避开障碍物",gameObjective:"游戏目标",avoidAllObstacles:"避开所有障碍物（石头、汽车、卡车）",successfulAvoidance:"成功避开获得5分 + 连击奖励",collisionPenalty:"碰撞障碍物扣10分并重置连击",scoringSystem:"计分系统",baseScore:"基础分数：避开障碍物 +5分",comboBonus:"连击奖励：每次连击额外 +1分",levelUp:"等级提升：每100分提升一个等级",speedIncrease:"速度增加：等级越高，障碍物移动越快",gameTime:"游戏时间",sixtySecondsPerGame:"每局游戏60秒",autoScoreWhenTimeUp:"时间结束自动结算分数"},en:{score:"Score",time:"Time",level:"Level",combo:"Combo",title:"Speed Racing",rules:"Game Rules",close:"Close",controlMethod:"Control Method",useArrowKeysOrButtons:"Use arrow keys ← → or screen buttons to control the race car",moveLeftRightToAvoid:"Move left and right to avoid obstacles",gameObjective:"Game Objective",avoidAllObstacles:"Avoid all obstacles (stones, cars, trucks)",successfulAvoidance:"Successfully avoid to get 5 points + combo bonus",collisionPenalty:"Colliding with obstacles deducts 10 points and resets combo",scoringSystem:"Scoring System",baseScore:"Base score: avoid obstacles +5 points",comboBonus:"Combo bonus: +1 point for each combo",levelUp:"Level up: gain one level every 100 points",speedIncrease:"Speed increase: the higher the level, the faster obstacles move",gameTime:"Game Time",sixtySecondsPerGame:"60 seconds per game",autoScoreWhenTimeUp:"Auto score when time is up"},ja:{score:"スコア",time:"時間",level:"レベル",combo:"コンボ",title:"スピードレーシング",rules:"ゲームルール",close:"閉じる",controlMethod:"操作方法",useArrowKeysOrButtons:"矢印キー ← → または画面ボタンでレーシングカーを操作",moveLeftRightToAvoid:"左右に移動して障害物を避ける",gameObjective:"ゲーム目標",avoidAllObstacles:"すべての障害物（石、車、トラック）を避ける",successfulAvoidance:"成功して避けると5ポイント + コンボボーナス",collisionPenalty:"障害物に衝突すると10ポイント減点しコンボリセット",scoringSystem:"スコアシステム",baseScore:"基本スコア：障害物を避けると +5ポイント",comboBonus:"コンボボーナス：各コンボで +1ポイント",levelUp:"レベルアップ：100ポイントごとに1レベルアップ",speedIncrease:"速度増加：レベルが高いほど障害物が速く動く",gameTime:"ゲーム時間",sixtySecondsPerGame:"ゲームあたり60秒",autoScoreWhenTimeUp:"時間切れで自動スコア"},ko:{score:"점수",time:"시간",level:"레벨",combo:"콤보",title:"스피드 레이싱",rules:"게임 규칙",close:"닫기",controlMethod:"조작 방법",useArrowKeysOrButtons:"화살표 키 ← → 또는 화면 버튼으로 레이싱카 조작",moveLeftRightToAvoid:"좌우로 이동하여 장애물 피하기",gameObjective:"게임 목표",avoidAllObstacles:"모든 장애물（돌、자동차、트럭）피하기",successfulAvoidance:"성공적으로 피하면 5점 + 콤보 보너스",collisionPenalty:"장애물과 충돌하면 10점 감점하고 콤보 리셋",scoringSystem:"점수 시스템",baseScore:"기본 점수：장애물 피하기 +5점",comboBonus:"콤보 보너스：각 콤보마다 +1점",levelUp:"레벨 업：100점마다 1레벨 상승",speedIncrease:"속도 증가：레벨이 높을수록 장애물이 빨리 움직임",gameTime:"게임 시간",sixtySecondsPerGame:"게임당 60초",autoScoreWhenTimeUp:"시간 종료 시 자동 점수"},vi:{score:"Điểm",time:"Thời Gian",level:"Cấp Độ",combo:"Combo",title:"Đua Xe Tốc Độ",rules:"Luật Chơi",close:"Đóng",controlMethod:"Phương Pháp Điều Khiển",useArrowKeysOrButtons:"Sử dụng phím mũi tên ← → hoặc nút màn hình để điều khiển xe đua",moveLeftRightToAvoid:"Di chuyển trái phải để tránh chướng ngại vật",gameObjective:"Mục Tiêu Trò Chơi",avoidAllObstacles:"Tránh tất cả chướng ngại vật (đá, xe hơi, xe tải)",successfulAvoidance:"Tránh thành công được 5 điểm + phần thưởng combo",collisionPenalty:"Va chạm với chướng ngại vật trừ 10 điểm và reset combo",scoringSystem:"Hệ Thống Điểm",baseScore:"Điểm cơ bản: tránh chướng ngại vật +5 điểm",comboBonus:"Phần thưởng combo: +1 điểm cho mỗi combo",levelUp:"Tăng cấp: tăng 1 cấp mỗi 100 điểm",speedIncrease:"Tăng tốc độ: cấp càng cao, chướng ngại vật di chuyển càng nhanh",gameTime:"Thời Gian Trò Chơi",sixtySecondsPerGame:"60 giây mỗi trò chơi",autoScoreWhenTimeUp:"Tự động tính điểm khi hết thời gian"},th:{score:"คะแนน",time:"เวลา",level:"ระดับ",combo:"คอมโบ",title:"แข่งรถความเร็ว",rules:"กฎเกม",close:"ปิด",controlMethod:"วิธีการควบคุม",useArrowKeysOrButtons:"ใช้ปุ่มลูกศร ← → หรือปุ่มหน้าจอควบคุมรถแข่ง",moveLeftRightToAvoid:"เคลื่อนที่ซ้ายขวาเพื่อหลบหลีกสิ่งกีดขวาง",gameObjective:"เป้าหมายเกม",avoidAllObstacles:"หลบหลีกสิ่งกีดขวางทั้งหมด（หิน、รถยนต์、รถบรรทุก）",successfulAvoidance:"หลบหลีกสำเร็จได้ 5 คะแนน + โบนัสคอมโบ",collisionPenalty:"ชนสิ่งกีดขวางหัก 10 คะแนนและรีเซ็ตคอมโบ",scoringSystem:"ระบบคะแนน",baseScore:"คะแนนพื้นฐาน：หลบหลีกสิ่งกีดขวาง +5 คะแนน",comboBonus:"โบนัสคอมโบ：+1 คะแนนสำหรับแต่ละคอมโบ",levelUp:"เลเวลอัพ：เพิ่ม 1 เลเวลทุก 100 คะแนน",speedIncrease:"เพิ่มความเร็ว：เลเวลสูงขึ้นสิ่งกีดขวางเคลื่อนที่เร็วขึ้น",gameTime:"เวลาเกม",sixtySecondsPerGame:"60 วินาทีต่อเกม",autoScoreWhenTimeUp:"คะแนนอัตโนมัติเมื่อหมดเวลา"},la:{score:"Puncta",time:"Tempus",level:"Gradus",combo:"Combo",title:"Cursus Velocitatis",rules:"Regulae Ludi",close:"Claudere",controlMethod:"Methodus Controllandi",useArrowKeysOrButtons:"Utere clavis sagittarum ← → vel pugnis scaenae ad currum regendum",moveLeftRightToAvoid:"Move sinistra dextraque ad impedimenta vitanda",gameObjective:"Finis Ludi",avoidAllObstacles:"Vita omnia impedimenta (lapides, currus, plaustra)",successfulAvoidance:"Vitando feliciter accipe 5 puncta + praemium combo",collisionPenalty:"Collidendo cum impedimentis minus 10 puncta et reset combo",scoringSystem:"Systema Punctandi",baseScore:"Puncta fundamentalia: vitando impedimenta +5 puncta",comboBonus:"Praemium combo: +1 punctum pro quaque combo",levelUp:"Gradus sursum: accipe unum gradum pro quaque 100 punctis",speedIncrease:"Auctio velocitatis: altior gradus, velocius impedimenta moventur",gameTime:"Tempus Ludi",sixtySecondsPerGame:"60 secundis pro quaque ludo",autoScoreWhenTimeUp:"Auto puncta quando tempus finitum est"},ms:{score:"Markah",time:"Masa",level:"Tahap",combo:"Combo",title:"Lumba Kereta Laju",rules:"Peraturan Permainan",close:"Tutup",controlMethod:"Kaedah Kawalan",useArrowKeysOrButtons:"Gunakan kekunci anak panah ← → atau butang skrin untuk mengawal kereta lumba",moveLeftRightToAvoid:"Gerakkan kiri kanan untuk mengelakkan halangan",gameObjective:"Objektif Permainan",avoidAllObstacles:"Elakkan semua halangan (batu, kereta, lori)",successfulAvoidance:"Berjaya elakkan dapat 5 markah + bonus combo",collisionPenalty:"Berlanggar dengan halangan tolak 10 markah dan reset combo",scoringSystem:"Sistem Markah",baseScore:"Markah asas: elakkan halangan +5 markah",comboBonus:"Bonus combo: +1 markah untuk setiap combo",levelUp:"Naik tahap: dapat 1 tahap setiap 100 markah",speedIncrease:"Tambah kelajuan: tahap lebih tinggi, halangan bergerak lebih pantas",gameTime:"Masa Permainan",sixtySecondsPerGame:"60 saat setiap permainan",autoScoreWhenTimeUp:"Markah automatik apabila masa habis"}};return((me=se[e])==null?void 0:me[ne])||se["zh-TW"][ne]||ne};v.useEffect(()=>{const ne=Vd("racing");ne&&a(ne.highScore||0)},[]),v.useEffect(()=>{o>0&&Wd("racing",{highScore:o})},[o]);const ce=()=>{r(0),m(60),x(50),j([]),R(3),F(1),z(0),d(!0)},le=()=>{d(!1),t>o&&a(t)},te=ne=>{c&&x(se=>{const me=ne==="left"?se-8:se+8;return Math.max(10,Math.min(90,me))})},xe=()=>{if(!c)return;const ne=["rock","car","truck"],se=ne[Math.floor(Math.random()*ne.length)],me=[15,50,85],Pe=me[Math.floor(Math.random()*me.length)]+(Math.random()-.5)*20;j(qe=>[...qe,{id:Date.now(),x:Pe,y:0,type:se}])},$=(ne,se)=>Math.abs(ne-se)<20/2;v.useEffect(()=>{if(!c)return;const ne=setInterval(()=>{m(se=>se<=.1?(le(),0):se-.1),Math.random()<.9+I*.15&&xe(),j(se=>{const me=se.map(qe=>({...qe,y:qe.y+T})).filter(qe=>qe.y<100);let Ie=!1;return me.filter(qe=>{if(qe.y>70&&qe.y<85){if($(g,qe.x))return Ie||(z(0),r(Ge=>Math.max(0,Ge-10)),M(!0),A(!0),oe({x:g,y:75}),_(!0),setTimeout(()=>{M(!1),A(!1),_(!1)},800),Ie=!0),!1;z(Ge=>Ge+1),r(Ge=>Ge+5+P),P>=5&&(J(!0),setTimeout(()=>J(!1),1e3))}return!0})}),t>I*100&&(F(se=>se+1),R(se=>Math.min(8,se+.5)))},100);return()=>clearInterval(ne)},[c,T,I,g,P]),v.useEffect(()=>{const ne=se=>{c&&(se.key==="ArrowLeft"||se.key==="a"?te("left"):(se.key==="ArrowRight"||se.key==="d")&&te("right"))};return window.addEventListener("keydown",ne),()=>window.removeEventListener("keydown",ne)},[c]);const Q=ne=>{const se={rock:{background:"#8B4513",borderRadius:"50%"},car:{background:"#FF4444",borderRadius:"5px"},truck:{background:"#FF8800",borderRadius:"8px"}};return se[ne]||se.rock},G=ne=>{if(!c)return;ne.preventDefault();const se=ne.touches[0],me=window.innerWidth;se.clientX<me/2?te("left"):te("right")};return i.jsxs("div",{style:{width:"100vw",height:"100vh",background:"linear-gradient(180deg, #87CEEB 0%, #98FB98 100%)",position:"relative",overflow:"auto",fontFamily:"Arial, sans-serif",touchAction:"pan-y"},onTouchStart:G,children:[i.jsx("button",{onClick:n,style:{position:"absolute",top:"clamp(20px, 4vw, 40px)",left:"clamp(20px, 4vw, 40px)",background:"#fff",border:"2px solid #9C27B0",borderRadius:"50%",width:"clamp(40px, 8vw, 50px)",height:"clamp(40px, 8vw, 50px)",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",fontSize:"clamp(1.2rem, 3vw, 1.5rem)",zIndex:1e3,boxShadow:"0 2px 8px rgba(0,0,0,0.2)"},children:"←"}),i.jsxs("div",{style:{position:"absolute",top:"clamp(20px, 4vw, 40px)",left:"clamp(80px, 16vw, 100px)",background:"rgba(255,255,255,0.9)",padding:"clamp(8px, 1.5vw, 12px)",borderRadius:"10px",fontSize:"clamp(0.8rem, 2vw, 1rem)",zIndex:100},children:[i.jsxs("div",{children:[X("score"),": ",t]}),i.jsxs("div",{children:[X("time"),": ",h,"s"]}),i.jsxs("div",{children:[X("level"),": ",I]}),i.jsxs("div",{children:[X("combo"),": ",P]})]}),i.jsx("div",{style:{position:"absolute",bottom:"20%",left:"0",right:"0",height:"60%",background:"linear-gradient(90deg, #696969 0%, #A9A9A9 20%, #696969 40%, #A9A9A9 60%, #696969 80%, #A9A9A9 100%)",borderTop:"4px solid #FFD700",borderBottom:"4px solid #FFD700"}}),i.jsx("div",{style:{position:"absolute",bottom:"25%",left:`${g}%`,transform:"translateX(-50%)",width:"clamp(40px, 8vw, 60px)",height:"clamp(20px, 4vw, 30px)",background:D?"linear-gradient(45deg, #FF0000, #FF4444)":"linear-gradient(45deg, #FF4444, #FF6666)",borderRadius:"8px",border:D?"3px solid #FF0000":"2px solid #CC0000",zIndex:10,transition:"left 0.1s ease",animation:D?"collisionShake 0.5s ease-in-out":"none"},children:i.jsx("div",{style:{position:"absolute",top:"-8px",left:"50%",transform:"translateX(-50%)",width:"clamp(20px, 4vw, 30px)",height:"clamp(8px, 1.5vw, 12px)",background:"#444",borderRadius:"4px"}})}),S.map(ne=>i.jsx("div",{style:{position:"absolute",top:`${ne.y}%`,left:`${ne.x}%`,transform:"translateX(-50%)",width:"clamp(30px, 6vw, 45px)",height:"clamp(15px, 3vw, 22px)",...Q(ne.type),zIndex:5}},ne.id)),H&&i.jsxs("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",fontSize:"clamp(2rem, 5vw, 3rem)",fontWeight:"bold",color:"#FFD700",textShadow:"0 0 20px #FFD700",animation:"comboEffect 1s ease-out forwards",pointerEvents:"none",zIndex:1e3},children:["COMBO x",P,"!"]}),C&&i.jsx("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",fontSize:"clamp(2rem, 5vw, 3rem)",fontWeight:"bold",color:"#FF0000",textShadow:"0 0 20px #FF0000",animation:"collisionEffect 0.5s ease-out forwards",pointerEvents:"none",zIndex:1e3},children:"BOOM!"}),B&&i.jsx("div",{style:{position:"absolute",left:`${U.x}%`,top:`${U.y}%`,transform:"translate(-50%, -50%)",width:"clamp(60px, 12vw, 80px)",height:"clamp(60px, 12vw, 80px)",animation:"explosionEffect 0.8s ease-out forwards",pointerEvents:"none",zIndex:999},children:i.jsx("div",{style:{width:"100%",height:"100%",background:"radial-gradient(circle, #FFD700 0%, #FF8800 30%, #FF4444 60%, #FF0000 100%)",borderRadius:"50%",boxShadow:"0 0 30px #FFD700, 0 0 60px #FF8800, 0 0 90px #FF4444"}})}),i.jsx("style",{children:`
          @keyframes collisionShake {
            0%, 100% { transform: translateX(-50%) translateY(0px); }
            25% { transform: translateX(-50%) translateY(-5px) translateX(-3px); }
            50% { transform: translateX(-50%) translateY(0px) translateX(3px); }
            75% { transform: translateX(-50%) translateY(-5px) translateX(-3px); }
          }
          @keyframes collisionEffect {
            0% { 
              transform: translate(-50%, -50%) scale(0.5);
              opacity: 0;
            }
            50% { 
              transform: translate(-50%, -50%) scale(1.2);
              opacity: 1;
            }
            100% { 
              transform: translate(-50%, -50%) scale(1);
              opacity: 0;
            }
          }
          @keyframes explosionEffect {
            0% { 
              transform: translate(-50%, -50%) scale(0.1);
              opacity: 1;
            }
            50% { 
              transform: translate(-50%, -50%) scale(1.5);
              opacity: 1;
            }
            100% { 
              transform: translate(-50%, -50%) scale(2);
              opacity: 0;
            }
          }
        `}),i.jsxs("div",{style:{position:"absolute",bottom:"clamp(10px, 2vw, 20px)",left:"50%",transform:"translateX(-50%)",display:"flex",gap:"clamp(10px, 2vw, 20px)",zIndex:100},children:[i.jsx("button",{onClick:()=>te("left"),style:{background:"#FF4444",color:"#fff",border:"none",borderRadius:"50%",width:"clamp(50px, 10vw, 70px)",height:"clamp(50px, 10vw, 70px)",fontSize:"clamp(1.5rem, 3vw, 2rem)",cursor:"pointer",fontWeight:"bold"},children:"←"}),i.jsx("button",{onClick:()=>te("right"),style:{background:"#FF4444",color:"#fff",border:"none",borderRadius:"50%",width:"clamp(50px, 10vw, 70px)",height:"clamp(50px, 10vw, 70px)",fontSize:"clamp(1.5rem, 3vw, 2rem)",cursor:"pointer",fontWeight:"bold"},children:"→"})]}),!c&&i.jsxs("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",background:"rgba(255,255,255,0.95)",borderRadius:"20px",padding:"clamp(20px, 4vw, 30px)",textAlign:"center",zIndex:1001},children:[i.jsx("h2",{style:{fontSize:"clamp(1.5rem, 3.5vw, 2rem)",margin:"0 0 15px 0",color:"#E91E63"},children:X("title")}),i.jsx("p",{style:{fontSize:"clamp(0.9rem, 2vw, 1rem)",marginBottom:"20px",color:"#666"},children:"使用方向鍵或按鈕控制賽車，避開障礙物！"}),i.jsxs("div",{style:{display:"flex",gap:"10px",justifyContent:"center"},children:[i.jsx("button",{onClick:ce,style:{background:"#E91E63",color:"#fff",border:"none",borderRadius:"15px",padding:"clamp(10px, 2vw, 15px) clamp(20px, 4vw, 30px)",fontSize:"clamp(1rem, 2.5vw, 1.2rem)",cursor:"pointer",fontWeight:"bold"},children:X("start")}),i.jsx("button",{onClick:()=>L(!0),style:{background:"#666",color:"#fff",border:"none",borderRadius:"15px",padding:"clamp(10px, 2vw, 15px) clamp(20px, 4vw, 30px)",fontSize:"clamp(1rem, 2.5vw, 1.2rem)",cursor:"pointer"},children:X("rules")})]})]}),O&&i.jsx("div",{style:{position:"absolute",top:"0",left:"0",right:"0",bottom:"0",background:"rgba(0,0,0,0.8)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1002},children:i.jsxs("div",{style:{background:"rgba(255,255,255,0.95)",borderRadius:"20px",padding:"clamp(20px, 4vw, 30px)",maxWidth:"clamp(300px, 80vw, 500px)",maxHeight:"clamp(400px, 80vh, 600px)",overflow:"auto"},children:[i.jsxs("h3",{style:{fontSize:"clamp(1.2rem, 3vw, 1.5rem)",margin:"0 0 15px 0",color:"#E91E63",textAlign:"center"},children:[X("title")," - ",X("rules")]}),i.jsxs("div",{style:{fontSize:"clamp(0.9rem, 2vw, 1rem)",lineHeight:"1.6"},children:[i.jsx("p",{children:i.jsxs("strong",{children:["🎮 ",X("controlMethod"),"："]})}),i.jsxs("ul",{children:[i.jsx("li",{children:X("useArrowKeysOrButtons")}),i.jsx("li",{children:X("moveLeftRightToAvoid")})]}),i.jsx("p",{children:i.jsxs("strong",{children:["🎯 ",X("gameObjective"),"："]})}),i.jsxs("ul",{children:[i.jsx("li",{children:X("avoidAllObstacles")}),i.jsx("li",{children:X("successfulAvoidance")}),i.jsx("li",{children:X("collisionPenalty")})]}),i.jsx("p",{children:i.jsxs("strong",{children:["🏆 ",X("scoringSystem"),"："]})}),i.jsxs("ul",{children:[i.jsx("li",{children:X("baseScore")}),i.jsx("li",{children:X("comboBonus")}),i.jsx("li",{children:X("levelUp")}),i.jsx("li",{children:X("speedIncrease")})]}),i.jsx("p",{children:i.jsxs("strong",{children:["⏰ ",X("gameTime"),"："]})}),i.jsxs("ul",{children:[i.jsx("li",{children:X("sixtySecondsPerGame")}),i.jsx("li",{children:X("autoScoreWhenTimeUp")})]})]}),i.jsx("button",{onClick:()=>L(!1),style:{background:"#E91E63",color:"#fff",border:"none",borderRadius:"15px",padding:"clamp(8px, 1.5vw, 12px) clamp(16px, 3vw, 24px)",fontSize:"clamp(0.9rem, 2vw, 1rem)",cursor:"pointer",marginTop:"20px",width:"100%"},children:X("close")})]})}),!c&&t>0&&i.jsxs("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",background:"rgba(255,255,255,0.95)",borderRadius:"20px",padding:"clamp(20px, 4vw, 30px)",textAlign:"center",zIndex:1001},children:[i.jsxs("h2",{style:{fontSize:"clamp(1.5rem, 3.5vw, 2rem)",margin:"0 0 15px 0",color:"#E91E63"},children:[X("gameOver"),"！"]}),i.jsxs("div",{style:{fontSize:"clamp(1rem, 2.5vw, 1.2rem)",marginBottom:"10px"},children:[X("finalScore"),"：",t]}),i.jsxs("div",{style:{fontSize:"clamp(0.9rem, 2vw, 1rem)",marginBottom:"20px",color:"#666"},children:[X("highScore"),"：",o]}),i.jsxs("div",{style:{display:"flex",gap:"10px",justifyContent:"center"},children:[i.jsx("button",{onClick:ce,style:{background:"#E91E63",color:"#fff",border:"none",borderRadius:"15px",padding:"clamp(8px, 1.5vw, 12px) clamp(16px, 3vw, 24px)",fontSize:"clamp(0.9rem, 2vw, 1rem)",cursor:"pointer"},children:X("restart")}),i.jsx("button",{onClick:n,style:{background:"#666",color:"#fff",border:"none",borderRadius:"15px",padding:"clamp(8px, 1.5vw, 12px) clamp(16px, 3vw, 24px)",fontSize:"clamp(0.9rem, 2vw, 1rem)",cursor:"pointer"},children:X("back")})]})]})]})}function eM({onClose:n}){const{lang:e}=Lt(),[t,r]=v.useState(0),[o,a]=v.useState(0),[c,d]=v.useState(!1),[h,m]=v.useState(60),[g,x]=v.useState([]),[S,j]=v.useState(0),[T,R]=v.useState(!1),[I,F]=v.useState(null),[P,z]=v.useState(!0),[H,J]=v.useState(!1),O=B=>{var U;const _={"zh-TW":{score:"分數",time:"時間",combo:"連擊",title:"音樂節奏",rules:"遊戲規則",close:"關閉",gameOver:"遊戲結束",gameplay:"遊戲玩法",clickMovingRhythmPoints:"點擊從上往下移動的節奏點",fourColorsCorrespondToDifferentAudio:"四種顏色的節奏點對應不同音頻",redBlueGreenYellowFrequencies:"紅色(440Hz)、藍色(523Hz)、綠色(659Hz)、黃色(784Hz)",accuracyScoring:"精準度計分",perfect100ms:"Perfect (100ms內)：+10分",good200ms:"Good (200ms內)：+5分",ok300ms:"OK (300ms內)：+2分",missOver300ms:"Miss (超過300ms)：0分",scoring:"計分",eachSuccessfulClickIncreasesCombo:"每次成功點擊增加連擊數",combo5TimesTriggersEffect:"連擊5次以上觸發特效",missingRhythmPointResetsCombo:"錯過節奏點重置連擊",soundControl:"音效控制",soundSwitchInTopRight:"右上角音效開關控制",clickRhythmPointPlaysAudio:"點擊節奏點會播放對應音頻",canTurnSoundOnOffAnytime:"可隨時開啟/關閉音效",gameTime:"遊戲時間",sixtySecondsPerGame:"每局遊戲60秒",autoScoreWhenTimeUp:"時間結束自動結算分數",clickRhythmPointsFollowMusic:"點擊節奏點，跟隨音樂節奏！"},"zh-CN":{score:"分数",time:"时间",combo:"连击",title:"音乐节奏",rules:"游戏规则",close:"关闭",gameplay:"游戏玩法",clickMovingRhythmPoints:"点击从上往下移动的节奏点",fourColorsCorrespondToDifferentAudio:"四种颜色的节奏点对应不同音频",redBlueGreenYellowFrequencies:"红色(440Hz)、蓝色(523Hz)、绿色(659Hz)、黄色(784Hz)",accuracyScoring:"精准度计分",perfect100ms:"Perfect (100ms内)：+10分",good200ms:"Good (200ms内)：+5分",ok300ms:"OK (300ms内)：+2分",missOver300ms:"Miss (超过300ms)：0分",scoring:"计分",eachSuccessfulClickIncreasesCombo:"每次成功点击增加连击数",combo5TimesTriggersEffect:"连击5次以上触发特效",missingRhythmPointResetsCombo:"错过节奏点重置连击",soundControl:"音效控制",soundSwitchInTopRight:"右上角音效开关控制",clickRhythmPointPlaysAudio:"点击节奏点会播放对应音频",canTurnSoundOnOffAnytime:"可随时开启/关闭音效",gameTime:"游戏时间",sixtySecondsPerGame:"每局游戏60秒",autoScoreWhenTimeUp:"时间结束自动结算分数",clickRhythmPointsFollowMusic:"点击节奏点，跟随音乐节奏！"},en:{score:"Score",time:"Time",combo:"Combo",title:"Music Rhythm",rules:"Game Rules",close:"Close",gameplay:"Gameplay",clickMovingRhythmPoints:"Click rhythm points moving from top to bottom",fourColorsCorrespondToDifferentAudio:"Four colors of rhythm points correspond to different audio",redBlueGreenYellowFrequencies:"Red (440Hz), Blue (523Hz), Green (659Hz), Yellow (784Hz)",accuracyScoring:"Accuracy Scoring",perfect100ms:"Perfect (within 100ms): +10 points",good200ms:"Good (within 200ms): +5 points",ok300ms:"OK (within 300ms): +2 points",missOver300ms:"Miss (over 300ms): 0 points",scoring:"Scoring",eachSuccessfulClickIncreasesCombo:"Each successful click increases combo count",combo5TimesTriggersEffect:"Combo 5 times or more triggers special effects",missingRhythmPointResetsCombo:"Missing rhythm point resets combo",soundControl:"Sound Control",soundSwitchInTopRight:"Sound switch control in top right corner",clickRhythmPointPlaysAudio:"Clicking rhythm points plays corresponding audio",canTurnSoundOnOffAnytime:"Can turn sound on/off anytime",gameTime:"Game Time",sixtySecondsPerGame:"60 seconds per game",autoScoreWhenTimeUp:"Auto score when time is up",clickRhythmPointsFollowMusic:"Click rhythm points, follow the music rhythm!"},ja:{score:"スコア",time:"時間",combo:"コンボ",title:"音楽リズム",rules:"ゲームルール",close:"閉じる",gameplay:"ゲームプレイ",clickMovingRhythmPoints:"上から下に移動するリズムポイントをクリック",fourColorsCorrespondToDifferentAudio:"4色のリズムポイントが異なる音声に対応",redBlueGreenYellowFrequencies:"赤(440Hz)、青(523Hz)、緑(659Hz)、黄(784Hz)",accuracyScoring:"精度スコアリング",perfect100ms:"Perfect (100ms以内)：+10ポイント",good200ms:"Good (200ms以内)：+5ポイント",ok300ms:"OK (300ms以内)：+2ポイント",missOver300ms:"Miss (300ms超過)：0ポイント",scoring:"スコアリング",eachSuccessfulClickIncreasesCombo:"各成功クリックでコンボ数増加",combo5TimesTriggersEffect:"コンボ5回以上でエフェクト発動",missingRhythmPointResetsCombo:"リズムポイントを逃すとコンボリセット",soundControl:"サウンドコントロール",soundSwitchInTopRight:"右上のサウンドスイッチ制御",clickRhythmPointPlaysAudio:"リズムポイントクリックで対応音声再生",canTurnSoundOnOffAnytime:"いつでもサウンドオン/オフ可能",gameTime:"ゲーム時間",sixtySecondsPerGame:"ゲームあたり60秒",autoScoreWhenTimeUp:"時間切れで自動スコア",clickRhythmPointsFollowMusic:"リズムポイントをクリックして、音楽のリズムに従ってください！"},ko:{score:"점수",time:"시간",combo:"콤보",title:"음악 리듬",rules:"게임 규칙",close:"닫기",gameplay:"게임 플레이",clickMovingRhythmPoints:"위에서 아래로 이동하는 리듬 포인트 클릭",fourColorsCorrespondToDifferentAudio:"4가지 색상의 리듬 포인트가 다른 오디오에 대응",redBlueGreenYellowFrequencies:"빨강(440Hz)、파랑(523Hz)、초록(659Hz)、노랑(784Hz)",accuracyScoring:"정확도 점수",perfect100ms:"Perfect (100ms 이내)：+10점",good200ms:"Good (200ms 이내)：+5점",ok300ms:"OK (300ms 이내)：+2점",missOver300ms:"Miss (300ms 초과)：0점",scoring:"점수",eachSuccessfulClickIncreasesCombo:"각 성공 클릭마다 콤보 수 증가",combo5TimesTriggersEffect:"콤보 5회 이상 시 특수 효과 발동",missingRhythmPointResetsCombo:"리듬 포인트 놓치면 콤보 리셋",soundControl:"사운드 제어",soundSwitchInTopRight:"우상단 사운드 스위치 제어",clickRhythmPointPlaysAudio:"리듬 포인트 클릭 시 해당 오디오 재생",canTurnSoundOnOffAnytime:"언제든지 사운드 켜기/끄기 가능",gameTime:"게임 시간",sixtySecondsPerGame:"게임당 60초",autoScoreWhenTimeUp:"시간 종료 시 자동 점수",clickRhythmPointsFollowMusic:"리듬 포인트를 클릭하고 음악 리듬을 따라가세요!"},vi:{score:"Điểm",time:"Thời Gian",combo:"Combo",title:"Nhịp Điệu Âm Nhạc",rules:"Luật Chơi",close:"Đóng",gameplay:"Cách Chơi",clickMovingRhythmPoints:"Nhấp vào các điểm nhịp điệu di chuyển từ trên xuống dưới",fourColorsCorrespondToDifferentAudio:"Bốn màu của điểm nhịp điệu tương ứng với âm thanh khác nhau",redBlueGreenYellowFrequencies:"Đỏ (440Hz), Xanh dương (523Hz), Xanh lá (659Hz), Vàng (784Hz)",accuracyScoring:"Điểm Độ Chính Xác",perfect100ms:"Perfect (trong 100ms): +10 điểm",good200ms:"Good (trong 200ms): +5 điểm",ok300ms:"OK (trong 300ms): +2 điểm",missOver300ms:"Miss (trên 300ms): 0 điểm",scoring:"Điểm Số",eachSuccessfulClickIncreasesCombo:"Mỗi lần nhấp thành công tăng số combo",combo5TimesTriggersEffect:"Combo 5 lần trở lên kích hoạt hiệu ứng đặc biệt",missingRhythmPointResetsCombo:"Bỏ lỡ điểm nhịp điệu reset combo",soundControl:"Điều Khiển Âm Thanh",soundSwitchInTopRight:"Công tắc âm thanh ở góc trên bên phải",clickRhythmPointPlaysAudio:"Nhấp điểm nhịp điệu phát âm thanh tương ứng",canTurnSoundOnOffAnytime:"Có thể bật/tắt âm thanh bất cứ lúc nào",gameTime:"Thời Gian Trò Chơi",sixtySecondsPerGame:"60 giây mỗi trò chơi",autoScoreWhenTimeUp:"Tự động tính điểm khi hết thời gian",clickRhythmPointsFollowMusic:"Nhấp vào điểm nhịp điệu, theo nhịp điệu âm nhạc!"},th:{score:"คะแนน",time:"เวลา",combo:"คอมโบ",title:"จังหวะดนตรี",rules:"กฎเกม",close:"ปิด",gameplay:"วิธีเล่น",clickMovingRhythmPoints:"คลิกจุดจังหวะที่เคลื่อนที่จากบนลงล่าง",fourColorsCorrespondToDifferentAudio:"สี่สีของจุดจังหวะสอดคล้องกับเสียงที่แตกต่างกัน",redBlueGreenYellowFrequencies:"แดง (440Hz)、น้ำเงิน (523Hz)、เขียว (659Hz)、เหลือง (784Hz)",accuracyScoring:"คะแนนความแม่นยำ",perfect100ms:"Perfect (ภายใน 100ms)：+10 คะแนน",good200ms:"Good (ภายใน 200ms)：+5 คะแนน",ok300ms:"OK (ภายใน 300ms)：+2 คะแนน",missOver300ms:"Miss (เกิน 300ms)：0 คะแนน",scoring:"คะแนน",eachSuccessfulClickIncreasesCombo:"แต่ละการคลิกที่สำเร็จเพิ่มจำนวนคอมโบ",combo5TimesTriggersEffect:"คอมโบ 5 ครั้งขึ้นไปกระตุ้นเอฟเฟกต์พิเศษ",missingRhythmPointResetsCombo:"พลาดจุดจังหวะรีเซ็ตคอมโบ",soundControl:"ควบคุมเสียง",soundSwitchInTopRight:"สวิตช์เสียงควบคุมที่มุมขวาบน",clickRhythmPointPlaysAudio:"คลิกจุดจังหวะเล่นเสียงที่สอดคล้องกัน",canTurnSoundOnOffAnytime:"สามารถเปิด/ปิดเสียงได้ทุกเมื่อ",gameTime:"เวลาเกม",sixtySecondsPerGame:"60 วินาทีต่อเกม",autoScoreWhenTimeUp:"คะแนนอัตโนมัติเมื่อหมดเวลา",clickRhythmPointsFollowMusic:"คลิกจุดจังหวะและตามจังหวะดนตรี!"},la:{score:"Puncta",time:"Tempus",combo:"Combo",title:"Rhythmus Musicae",rules:"Regulae Ludi",close:"Claudere",gameplay:"Ludus",clickMovingRhythmPoints:"Clicca puncta rhythmi moventia de superiore ad inferiorem",fourColorsCorrespondToDifferentAudio:"Quattuor colores punctorum rhythmi correspondent diversis auditis",redBlueGreenYellowFrequencies:"Rubrum (440Hz), Caeruleum (523Hz), Viride (659Hz), Flavum (784Hz)",accuracyScoring:"Punctatio Accurationis",perfect100ms:"Perfect (intra 100ms): +10 puncta",good200ms:"Good (intra 200ms): +5 puncta",ok300ms:"OK (intra 300ms): +2 puncta",missOver300ms:"Miss (super 300ms): 0 puncta",scoring:"Punctatio",eachSuccessfulClickIncreasesCombo:"Quaelibet felix cliccatio auget numerum combo",combo5TimesTriggersEffect:"Combo 5 vicibus vel plus activat effectus speciales",missingRhythmPointResetsCombo:"Amittendo punctum rhythmi reset combo",soundControl:"Controllatio Sonorum",soundSwitchInTopRight:"Sonorum commutator in angulo superiore dextro",clickRhythmPointPlaysAudio:"Cliccando puncta rhythmi ludit auditum correspondentem",canTurnSoundOnOffAnytime:"Potest sonos aperire/claudere quandocumque",gameTime:"Tempus Ludi",sixtySecondsPerGame:"60 secundis pro quaque ludo",autoScoreWhenTimeUp:"Auto puncta quando tempus finitum est",clickRhythmPointsFollowMusic:"Puncta rhythmi preme et musicam sequere!"},ms:{score:"Markah",time:"Masa",combo:"Combo",title:"Irama Muzik",rules:"Peraturan Permainan",close:"Tutup",gameplay:"Cara Bermain",clickMovingRhythmPoints:"Klik titik irama yang bergerak dari atas ke bawah",fourColorsCorrespondToDifferentAudio:"Empat warna titik irama sepadan dengan audio berbeza",redBlueGreenYellowFrequencies:"Merah (440Hz), Biru (523Hz), Hijau (659Hz), Kuning (784Hz)",accuracyScoring:"Penilaian Ketepatan",perfect100ms:"Perfect (dalam 100ms): +10 markah",good200ms:"Good (dalam 200ms): +5 markah",ok300ms:"OK (dalam 300ms): +2 markah",missOver300ms:"Miss (melebihi 300ms): 0 markah",scoring:"Penilaian",eachSuccessfulClickIncreasesCombo:"Setiap klik berjaya menambah bilangan combo",combo5TimesTriggersEffect:"Combo 5 kali atau lebih mencetuskan kesan khas",missingRhythmPointResetsCombo:"Terlepas titik irama reset combo",soundControl:"Kawalan Bunyi",soundSwitchInTopRight:"Suis bunyi kawalan di sudut kanan atas",clickRhythmPointPlaysAudio:"Klik titik irama memainkan audio sepadan",canTurnSoundOnOffAnytime:"Boleh hidupkan/matikan bunyi bila-bila masa",gameTime:"Masa Permainan",sixtySecondsPerGame:"60 saat setiap permainan",autoScoreWhenTimeUp:"Markah automatik apabila masa habis",clickRhythmPointsFollowMusic:"Klik titik irama, ikut rentak muzik!"}};return((U=_[e])==null?void 0:U[B])||_["zh-TW"][B]||B};v.useEffect(()=>{const B=Vd("rhythm");B&&a(B.highScore||0)},[]),v.useEffect(()=>{o>0&&Wd("rhythm",{highScore:o})},[o]),v.useEffect(()=>{typeof window<"u"&&window.AudioContext&&F(new AudioContext)},[]);const L=()=>{r(0),m(60),x([]),j(0),d(!0)},C=()=>{d(!1),t>o&&a(t)},A=()=>{if(!c)return;const B=["red","blue","green","yellow"],_=B[Math.floor(Math.random()*B.length)],U=Math.random()*80+10;x(oe=>[...oe,{id:Date.now(),x:U,y:-10,type:_,timing:Date.now()}])},D=B=>{const _=g.find(X=>X.id===B);if(!_)return;const U=Date.now()-_.timing;let oe=0;if(U<100?oe=10:U<200?oe=5:U<300?oe=2:oe=0,r(X=>X+oe),j(X=>X+1),S>=5&&(R(!0),setTimeout(()=>R(!1),1e3)),I&&P){const X=I.createOscillator(),ce=I.createGain();X.connect(ce),ce.connect(I.destination);const le={red:440,blue:523,green:659,yellow:784};X.frequency.setValueAtTime(le[_.type],I.currentTime),X.type="sine",ce.gain.setValueAtTime(.3,I.currentTime),ce.gain.exponentialRampToValueAtTime(.01,I.currentTime+.1),X.start(I.currentTime),X.stop(I.currentTime+.1)}x(X=>X.filter(ce=>ce.id!==B))};v.useEffect(()=>{if(!c)return;const B=setInterval(()=>{m(_=>_<=1?(C(),0):_-1),Math.random()<.03&&A(),x(_=>{const U=_.map(oe=>({...oe,y:oe.y+2})).filter(oe=>oe.y<110);return U.forEach(oe=>{oe.y>90&&(j(0),x(X=>X.filter(ce=>ce.id!==oe.id)))}),U})},50);return()=>clearInterval(B)},[c]);const M=B=>({red:"#FF4444",blue:"#4444FF",green:"#44FF44",yellow:"#FFFF44"})[B]||"#FF4444";return i.jsxs("div",{style:{width:"100vw",height:"100vh",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",position:"relative",overflow:"hidden",fontFamily:"Arial, sans-serif"},children:[i.jsxs("div",{style:{position:"absolute",top:"clamp(20px, 4vw, 40px)",left:"clamp(80px, 16vw, 100px)",background:"rgba(255,255,255,0.9)",padding:"clamp(8px, 1.5vw, 12px)",borderRadius:"10px",fontSize:"clamp(0.8rem, 2vw, 1rem)",zIndex:100},children:[i.jsxs("div",{children:[O("score"),": ",t]}),i.jsxs("div",{children:[O("time"),": ",h,"s"]}),i.jsxs("div",{children:[O("combo"),": ",S]})]}),i.jsx("button",{onClick:()=>z(!P),style:{position:"absolute",top:"clamp(10px, 2vw, 20px)",right:"clamp(10px, 2vw, 20px)",background:P?"#4CAF50":"#f44336",color:"#fff",border:"none",borderRadius:"25px",padding:"clamp(8px, 1.5vw, 12px) clamp(16px, 3vw, 24px)",fontSize:"clamp(0.8rem, 2vw, 1rem)",cursor:"pointer",zIndex:100},children:P?"🔊":"🔇"}),i.jsx("div",{style:{position:"absolute",bottom:"20%",left:"10%",right:"10%",height:"60%",background:"rgba(0,0,0,0.3)",borderRadius:"20px",border:"2px solid rgba(255,255,255,0.3)"}}),g.map(B=>i.jsx("div",{onClick:()=>D(B.id),style:{position:"absolute",bottom:`${B.y}%`,left:`${B.x}%`,transform:"translateX(-50%)",width:"clamp(40px, 8vw, 60px)",height:"clamp(40px, 8vw, 60px)",background:M(B.type),borderRadius:"50%",cursor:"pointer",zIndex:10,boxShadow:`0 0 20px ${M(B.type)}`,animation:"pulse 0.5s ease-in-out infinite alternate"}},B.id)),T&&i.jsxs("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",fontSize:"clamp(2rem, 5vw, 3rem)",fontWeight:"bold",color:"#00BCD4",textShadow:"0 0 20px #00BCD4",animation:"comboEffect 1s ease-out forwards",pointerEvents:"none",zIndex:1e3},children:["COMBO x",S,"!"]}),!c&&i.jsxs("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",background:"rgba(255,255,255,0.95)",borderRadius:"20px",padding:"clamp(20px, 4vw, 30px)",textAlign:"center",zIndex:1001},children:[i.jsx("h2",{style:{fontSize:"clamp(1.5rem, 3.5vw, 2rem)",margin:"0 0 15px 0",color:"#00BCD4"},children:O("title")}),i.jsx("p",{style:{fontSize:"clamp(0.9rem, 2vw, 1rem)",marginBottom:"20px",color:"#666"},children:O("clickRhythmPointsFollowMusic")}),i.jsxs("div",{style:{display:"flex",gap:"10px",justifyContent:"center"},children:[i.jsx("button",{onClick:L,style:{background:"#00BCD4",color:"#fff",border:"none",borderRadius:"15px",padding:"clamp(10px, 2vw, 15px) clamp(20px, 4vw, 30px)",fontSize:"clamp(1rem, 2.5vw, 1.2rem)",cursor:"pointer",fontWeight:"bold"},children:O("start")}),i.jsx("button",{onClick:()=>J(!0),style:{background:"#666",color:"#fff",border:"none",borderRadius:"15px",padding:"clamp(10px, 2vw, 15px) clamp(20px, 4vw, 30px)",fontSize:"clamp(1rem, 2.5vw, 1.2rem)",cursor:"pointer"},children:O("rules")})]})]}),H&&i.jsx("div",{style:{position:"absolute",top:"0",left:"0",right:"0",bottom:"0",background:"rgba(0,0,0,0.8)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1002},children:i.jsxs("div",{style:{background:"rgba(255,255,255,0.95)",borderRadius:"20px",padding:"clamp(20px, 4vw, 30px)",maxWidth:"clamp(300px, 80vw, 500px)",maxHeight:"clamp(400px, 80vh, 600px)",overflow:"auto"},children:[i.jsxs("h3",{style:{fontSize:"clamp(1.2rem, 3vw, 1.5rem)",margin:"0 0 15px 0",color:"#00BCD4",textAlign:"center"},children:[O("rhythmGame")," - ",O("rules")]}),i.jsxs("div",{style:{fontSize:"clamp(0.9rem, 2vw, 1rem)",lineHeight:"1.6"},children:[i.jsx("p",{children:i.jsxs("strong",{children:["🎵 ",O("gameplay"),"："]})}),i.jsxs("ul",{children:[i.jsx("li",{children:O("clickMovingRhythmPoints")}),i.jsx("li",{children:O("fourColorsCorrespondToDifferentAudio")}),i.jsx("li",{children:O("redBlueGreenYellowFrequencies")})]}),i.jsx("p",{children:i.jsxs("strong",{children:["🎯 ",O("accuracyScoring"),"："]})}),i.jsxs("ul",{children:[i.jsx("li",{children:O("perfect100ms")}),i.jsx("li",{children:O("good200ms")}),i.jsx("li",{children:O("ok300ms")}),i.jsx("li",{children:O("missOver300ms")})]}),i.jsx("p",{children:i.jsxs("strong",{children:["🏆 ",O("scoring"),"："]})}),i.jsxs("ul",{children:[i.jsx("li",{children:O("eachSuccessfulClickIncreasesCombo")}),i.jsx("li",{children:O("combo5TimesTriggersEffect")}),i.jsx("li",{children:O("missingRhythmPointResetsCombo")})]}),i.jsx("p",{children:i.jsxs("strong",{children:["🔊 ",O("soundControl"),"："]})}),i.jsxs("ul",{children:[i.jsx("li",{children:O("soundSwitchInTopRight")}),i.jsx("li",{children:O("clickRhythmPointPlaysAudio")}),i.jsx("li",{children:O("canTurnSoundOnOffAnytime")})]}),i.jsx("p",{children:i.jsxs("strong",{children:["⏰ ",O("gameTime"),"："]})}),i.jsxs("ul",{children:[i.jsx("li",{children:O("sixtySecondsPerGame")}),i.jsx("li",{children:O("autoScoreWhenTimeUp")})]})]}),i.jsx("button",{onClick:()=>J(!1),style:{background:"#00BCD4",color:"#fff",border:"none",borderRadius:"15px",padding:"clamp(8px, 1.5vw, 12px) clamp(16px, 3vw, 24px)",fontSize:"clamp(0.9rem, 2vw, 1rem)",cursor:"pointer",marginTop:"20px",width:"100%"},children:O("close")})]})}),!c&&t>0&&i.jsxs("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",background:"rgba(255,255,255,0.95)",borderRadius:"20px",padding:"clamp(20px, 4vw, 30px)",textAlign:"center",zIndex:1001},children:[i.jsxs("h2",{style:{fontSize:"clamp(1.5rem, 3.5vw, 2rem)",margin:"0 0 15px 0",color:"#00BCD4"},children:[O("gameOver"),"！"]}),i.jsxs("div",{style:{fontSize:"clamp(1rem, 2.5vw, 1.2rem)",marginBottom:"10px"},children:[O("finalScore"),"：",t]}),i.jsxs("div",{style:{fontSize:"clamp(0.9rem, 2vw, 1rem)",marginBottom:"20px",color:"#666"},children:[O("highScore"),"：",o]}),i.jsxs("div",{style:{display:"flex",gap:"10px",justifyContent:"center"},children:[i.jsx("button",{onClick:L,style:{background:"#00BCD4",color:"#fff",border:"none",borderRadius:"15px",padding:"clamp(8px, 1.5vw, 12px) clamp(16px, 3vw, 24px)",fontSize:"clamp(0.9rem, 2vw, 1rem)",cursor:"pointer"},children:O("restart")}),i.jsx("button",{onClick:n,style:{background:"#666",color:"#fff",border:"none",borderRadius:"15px",padding:"clamp(8px, 1.5vw, 12px) clamp(16px, 3vw, 24px)",fontSize:"clamp(0.9rem, 2vw, 1rem)",cursor:"pointer"},children:O("back")})]})]}),i.jsx("style",{children:`
        @keyframes pulse {
          0% { transform: translateX(-50%) scale(1); }
          100% { transform: translateX(-50%) scale(1.1); }
        }
        @keyframes comboEffect {
          0% { opacity: 0; transform: translate(-50%, -50%) scale(0.5); }
          50% { opacity: 1; transform: translate(-50%, -50%) scale(1.2); }
          100% { opacity: 0; transform: translate(-50%, -50%) scale(1); }
        }
      `})]})}const yk={"zh-TW":{title:"社會融入度評估",subtitle:"評估您的社會融入度，獲得專業建議",subtitle2:"勇敢面對並定期檢測自身社會融入程度進步狀況，每一次評估都是成長的機會",backToHome:"返回",startAssessment:"開始評估",submitAssessment:"提交評估",cancelAssessment:"取消",closeAssessment:"關閉",assessmentComplete:"評估完成",viewReport:"查看報告",closeReport:"關閉報告",q1Title:"人際關係",q1Desc:"最近3個月，您與他人的互動和社交能力如何？包括與同事、朋友、鄰居的日常交流，以及在新環境中建立關係的能力。您是否能夠主動與他人溝通，建立信任關係，並在社交場合中感到自在？",q2Title:"就業狀況",q2Desc:"最近1年，您的工作穩定性和發展前景如何？包括工作滿意度、薪資待遇、職業發展機會、工作環境適應性，以及對未來職業規劃的清晰度。您是否對當前工作感到滿意，並有明確的職業發展目標？",q3Title:"家庭關係",q3Desc:"最近6個月，您與家人的相處和溝通狀況如何？包括與配偶、子女、父母或其他家庭成員的關係質量，溝通頻率和效果，以及家庭氛圍的和諧程度。您是否能夠有效處理家庭衝突，並為家庭成員提供情感支持？",q4Title:"未來信心",q4Desc:"您對未來1年的樂觀程度和規劃如何？包括對個人發展的信心，對生活目標的清晰度，以及面對挑戰時的積極態度。您是否對未來有明確的規劃，並相信自己能夠實現目標？",q5Title:"社會接納",q5Desc:"最近6個月，您感覺被社會接受和認可的程度如何？包括在社區中的融入度，社會地位的認同感，以及對社會規範的適應能力。您是否感到被社會接納，並對自己的社會角色感到滿意？",q6Title:"情緒管理",q6Desc:"最近3個月，您處理壓力和負面情緒的能力如何？包括面對挫折時的情緒反應，壓力調節方法，以及心理健康維護的意識。您是否能夠有效管理負面情緒，並在壓力下保持冷靜？",q7Title:"生活規律",q7Desc:"最近6個月，您的生活作息和規律性如何？包括日常作息時間，飲食習慣，運動頻率，以及生活節奏的穩定性。您是否能夠維持健康的生活習慣，並建立規律的日常生活？",q8Title:"學習成長",q8Desc:"最近1年，您在技能學習和個人成長方面的投入如何？包括新技能學習，知識更新，自我提升的積極性，以及對個人發展的投資。您是否持續學習新知識，並主動尋求個人成長機會？",q9Title:"財務管理",q9Desc:"最近1年，您的財務規劃和理財能力如何？包括收入支出管理，儲蓄習慣，投資理財意識，以及對未來財務安全的規劃。您是否能夠有效管理個人財務，並為未來做好財務準備？",q10Title:"健康狀況",q10Desc:"最近6個月，您的身體和心理健康狀況如何？包括身體健康狀況，心理健康狀態，醫療保健意識，以及對健康問題的預防和處理能力。您是否重視健康管理，並採取積極的健康維護措施？",q11Title:"社交網絡",q11Desc:"最近3個月，您建立和維護社交關係的能力如何？包括朋友數量，社交活動參與度，人際關係質量，以及社交網絡的廣度和深度。您是否擁有穩定的社交圈，並能夠與他人建立有意義的關係？",q12Title:"目標設定",q12Desc:"最近1年，您設定和追求個人目標的能力如何？包括目標的明確性，計劃的可行性，執行力，以及對目標達成度的評估。您是否能夠設定清晰的目標，並有效執行計劃？",q13Title:"適應能力",q13Desc:"最近6個月，您適應環境變化和挑戰的能力如何？包括面對新環境的適應速度，應對變化的靈活性，以及從挫折中恢復的能力。您是否能夠快速適應新環境，並在變化中保持穩定？",q14Title:"責任感",q14Desc:"最近1年，您對自己和他人負責的態度如何？包括對個人行為的責任感，對他人承諾的履行，以及對社會責任的認知。您是否能夠承擔個人責任，並對他人和社會負責？",q15Title:"自我認同",q15Desc:"最近6個月，您對自我價值和身份的認同感如何？包括對個人價值的認知，自我接納程度，以及對個人身份的滿意度。您是否對自己有清晰的認知，並能夠接納自己的優缺點？",q16Title:"社區參與",q16Desc:"最近1年，您參與社區活動和公益服務的情況如何？包括志願服務參與度，社區活動貢獻，以及對社會公益的關注和參與。您是否積極參與社區活動，並為社會做出貢獻？",q17Title:"職業發展",q17Desc:"最近1年，您在職業技能提升和職涯規劃方面的表現如何？包括專業技能發展，職業規劃清晰度，以及對職業發展機會的把握。您是否持續提升職業技能，並有明確的職業發展路徑？",q18Title:"人際衝突處理",q18Desc:"最近3個月，您處理人際衝突和分歧的能力如何？包括衝突解決技巧，溝通協調能力，以及維護關係的智慧。您是否能夠有效處理人際衝突，並在分歧中尋求共識？",q19Title:"時間管理",q19Desc:"最近1年，您合理安排時間和優先級的能力如何？包括時間規劃效率，任務優先級設定，以及工作生活平衡的維持。您是否能夠有效管理時間，並在多重任務中保持效率？",q20Title:"整體滿意度",q20Desc:"最近6個月，您對整體生活狀況的滿意度如何？包括對生活質量的整體評價，對個人成就的滿意度，以及對未來生活前景的樂觀程度。您是否對當前的生活狀況感到滿意，並對未來充滿希望？",excellent:"非常好",good:"良好",fair:"一般",poor:"需要改善",terrible:"非常糟糕",scoreLabel:"評估分數",resultLabel:"評估結果",descriptionLabel:"詳細分析",recommendationsLabel:"改善建議",analysisLabel:"專業分析",privacyPolicy:"隱私權政策",terms:"條款/聲明",dataDeletion:"資料刪除說明",about:"🧬 Restarter™｜我們是誰",feedback:"💬 意見箱｜我們想聽你說"},"zh-CN":{title:"社会融入度评估",subtitle:"评估您的社会融入度，获得专业建议",subtitle2:"勇敢面对并定期检测自身社会融入程度进步状况，每一次评估都是成长的机会",backToHome:"返回",startAssessment:"开始评估",submitAssessment:"提交评估",cancelAssessment:"取消",closeAssessment:"关闭",assessmentComplete:"评估完成",viewReport:"查看报告",closeReport:"关闭报告",q1Title:"人际关系",q1Desc:"最近3个月，您与他人的互动和社交能力如何？包括与同事、朋友、邻居的日常交流，以及在新环境中建立关系的能力。您是否能够主动与他人沟通，建立信任关系，并在社交场合中感到自在？",q2Title:"就业状况",q2Desc:"最近1年，您的工作稳定性和发展前景如何？包括工作满意度、薪资待遇、职业发展机会、工作环境适应性，以及对未来职业规划的清晰度。您是否对当前工作感到满意，并有明确的职业发展目标？",q3Title:"家庭关系",q3Desc:"最近6个月，您与家人的相处和沟通状况如何？包括与配偶、子女、父母或其他家庭成员的关系质量，沟通频率和效果，以及家庭氛围的和谐程度。您是否能够有效处理家庭冲突，并为家庭成员提供情感支持？",q4Title:"未来信心",q4Desc:"您对未来1年的乐观程度和规划如何？包括对个人发展的信心，对生活目标的清晰度，以及面对挑战时的积极态度。您是否对未来有明确的规划，并相信自己能够实现目标？",q5Title:"社会接纳",q5Desc:"最近6个月，您感觉被社会接受和认可的程度如何？包括在社区中的融入度，社会地位的认同感，以及对社会规范的适应能力。您是否感到被社会接纳，并对自己的社会角色感到满意？",q6Title:"情绪管理",q6Desc:"最近3个月，您处理压力和负面情绪的能力如何？包括面对挫折时的情绪反应，压力调节方法，以及心理健康维护的意识。您是否能够有效管理负面情绪，并在压力下保持冷静？",q7Title:"生活规律",q7Desc:"最近6个月，您的生活作息和规律性如何？包括日常作息时间，饮食习惯，运动频率，以及生活节奏的稳定性。您是否能够维持健康的生活习惯，并建立规律的日常生活？",q8Title:"学习成长",q8Desc:"最近1年，您在技能学习和个人成长方面的投入如何？包括新技能学习，知识更新，自我提升的积极性，以及对个人发展的投资。您是否持续学习新知识，并主动寻求个人成长机会？",q9Title:"财务管理",q9Desc:"最近1年，您的财务规划和理财能力如何？包括收入支出管理，储蓄习惯，投资理财意识，以及对未来财务安全的规划。您是否能够有效管理个人财务，并为未来做好财务准备？",q10Title:"健康状况",q10Desc:"最近6个月，您的身体和心理健康状况如何？包括身体健康状况，心理健康状态，医疗保健意识，以及对健康问题的预防和处理能力。您是否重视健康管理，并采取积极的健康维护措施？",q11Title:"社交网络",q11Desc:"最近3个月，您建立和维护社交关系的能力如何？包括朋友数量，社交活动参与度，人际关系质量，以及社交网络的广度和深度。您是否拥有稳定的社交圈，并能够与他人建立有意义的关系？",q12Title:"目标设定",q12Desc:"最近1年，您设定和追求个人目标的能力如何？包括目标的明确性，计划的可行性，执行力，以及对目标达成度的评估。您是否能够设定清晰的目标，并有效执行计划？",q13Title:"适应能力",q13Desc:"最近6个月，您适应环境变化和挑战的能力如何？包括面对新环境的适应速度，应对变化的灵活性，以及从挫折中恢复的能力。您是否能够快速适应新环境，并在变化中保持稳定？",q14Title:"责任感",q14Desc:"最近1年，您对自己和他人负责的态度如何？包括对个人行为的责任感，对他人承诺的履行，以及对社会责任的认识。您是否能够承担个人责任，并对他人和社会负责？",q15Title:"自我认同",q15Desc:"最近6个月，您对自我价值和身份的认同感如何？包括对个人价值的认知，自我接纳程度，以及对个人身份的满意度。您是否对自己有清晰的认知，并能够接纳自己的优缺点？",q16Title:"社区参与",q16Desc:"最近1年，您参与社区活动和公益服务的情况如何？包括志愿服务参与度，社区活动贡献，以及对社会公益的关注和参与。您是否积极参与社区活动，并为社会做出贡献？",q17Title:"职业发展",q17Desc:"最近1年，您在职业技能提升和职涯规划方面的表现如何？包括专业技能发展，职业规划清晰度，以及对职业发展机会的把握。您是否持续提升职业技能，并有明确的职业发展路径？",q18Title:"人际冲突处理",q18Desc:"最近3个月，您处理人际冲突和分歧的能力如何？包括冲突解决技巧，沟通协调能力，以及维护关系的智慧。您是否能够有效处理人际冲突，并在分歧中寻求共识？",q19Title:"时间管理",q19Desc:"最近1年，您合理安排时间和优先级的能力如何？包括时间规划效率，任务优先级设定，以及工作生活平衡的维持。您是否能够有效管理时间，并在多重任务中保持效率？",q20Title:"整体满意度",q20Desc:"最近6个月，您对整体生活状况的满意度如何？包括对生活质量的整体评价，对个人成就的满意度，以及对未来生活前景的乐观程度。您是否对当前的生活状况感到满意，并对未来充满希望？",excellent:"非常好",good:"良好",fair:"一般",poor:"需要改善",terrible:"非常糟糕",scoreLabel:"评估分数",resultLabel:"评估结果",descriptionLabel:"详细分析",recommendationsLabel:"改善建议",analysisLabel:"专业分析",privacyPolicy:"隐私权政策",terms:"条款/声明",dataDeletion:"资料删除说明",about:"🧬 Restarter™｜我们是谁",feedback:"💬 意见箱｜我们想听你说"},en:{title:"Social Integration Assessment",subtitle:"Assess your social integration and get professional advice",subtitle2:"Face challenges bravely and regularly monitor your social integration progress, every assessment is an opportunity for growth",backToHome:"Back",startAssessment:"Start Assessment",submitAssessment:"Submit Assessment",cancelAssessment:"Cancel",closeAssessment:"Close",assessmentComplete:"Assessment Complete",viewReport:"View Report",closeReport:"Close Report",q1Title:"Interpersonal Relationships",q1Desc:"In the past 3 months, how is your interaction and social ability with others? Including daily communication with colleagues, friends, and neighbors, as well as the ability to build relationships in new environments. Are you able to actively communicate with others, build trust relationships, and feel comfortable in social situations?",q2Title:"Employment Status",q2Desc:"In the past year, how is your job stability and development prospects? Including job satisfaction, salary benefits, career development opportunities, work environment adaptability, and clarity of future career planning. Are you satisfied with your current job and have clear career development goals?",q3Title:"Family Relationships",q3Desc:"In the past 6 months, how is your relationship and communication with family? Including relationship quality with spouse, children, parents or other family members, communication frequency and effectiveness, and family atmosphere harmony. Are you able to effectively handle family conflicts and provide emotional support to family members?",q4Title:"Future Confidence",q4Desc:"In the past year, how optimistic are you about the future and your planning? Including confidence in personal development, clarity of life goals, and positive attitude when facing challenges. Do you have clear plans for the future and believe you can achieve your goals?",q5Title:"Social Acceptance",q5Desc:"In the past 6 months, how accepted and recognized do you feel by society? Including community integration, social status recognition, and adaptation to social norms. Do you feel accepted by society and satisfied with your social role?",q6Title:"Emotional Management",q6Desc:"In the past 3 months, how well do you handle stress and negative emotions? Including emotional responses when facing setbacks, stress regulation methods, and awareness of mental health maintenance. Are you able to effectively manage negative emotions and stay calm under pressure?",q7Title:"Life Routine",q7Desc:"In the past year, how regular is your daily routine and lifestyle? Including daily schedule, eating habits, exercise frequency, and stability of life rhythm. Are you able to maintain healthy living habits and establish regular daily life?",q8Title:"Learning & Growth",q8Desc:"In the past year, how much have you invested in skill learning and personal growth? Including new skill learning, knowledge updates, self-improvement initiative, and investment in personal development. Do you continuously learn new knowledge and actively seek personal growth opportunities?",q9Title:"Financial Management",q9Desc:"In the past year, how is your financial planning and money management? Including income and expense management, saving habits, investment awareness, and planning for future financial security. Are you able to effectively manage personal finances and prepare for the future?",q10Title:"Health Status",q10Desc:"In the past 6 months, how is your physical and mental health? Including physical health condition, mental health status, healthcare awareness, and ability to prevent and handle health issues. Do you value health management and take active health maintenance measures?",q11Title:"Social Network",q11Desc:"In the past 3 months, how well do you build and maintain social relationships? Including number of friends, social activity participation, relationship quality, and breadth and depth of social network. Do you have a stable social circle and can build meaningful relationships with others?",q12Title:"Goal Setting",q12Desc:"In the past year, how well do you set and pursue personal goals? Including goal clarity, plan feasibility, execution ability, and assessment of goal achievement. Are you able to set clear goals and effectively execute plans?",q13Title:"Adaptability",q13Desc:"In the past 6 months, how well do you adapt to environmental changes and challenges? Including adaptation speed to new environments, flexibility in coping with changes, and ability to recover from setbacks. Are you able to quickly adapt to new environments and maintain stability in changes?",q14Title:"Responsibility",q14Desc:"In the past year, how responsible are you towards yourself and others? Including personal behavior responsibility, fulfillment of commitments to others, and awareness of social responsibility. Are you able to take personal responsibility and be responsible for others and society?",q15Title:"Self-Identity",q15Desc:"In the past 6 months, how strong is your sense of self-worth and identity? Including awareness of personal value, self-acceptance level, and satisfaction with personal identity. Do you have a clear understanding of yourself and can accept your strengths and weaknesses?",q16Title:"Community Participation",q16Desc:"In the past 3 years, how involved are you in community activities and public service? Including volunteer service participation, community activity contribution, and attention and participation in social welfare. Do you actively participate in community activities and contribute to society?",q17Title:"Career Development",q17Desc:"In the past year, how well have you performed in skill enhancement and career planning? Including professional skill development, career planning clarity, and grasp of career development opportunities. Do you continuously improve professional skills and have clear career development paths?",q18Title:"Conflict Resolution",q18Desc:"In the past 3 months, how well do you handle interpersonal conflicts and disagreements? Including conflict resolution skills, communication coordination ability, and wisdom in maintaining relationships. Are you able to effectively handle interpersonal conflicts and seek consensus in disagreements?",q19Title:"Time Management",q19Desc:"In the past year, how well do you manage time and prioritize tasks? Including time planning efficiency, task priority setting, and maintenance of work-life balance. Are you able to effectively manage time and maintain efficiency in multiple tasks?",q20Title:"Overall Satisfaction",q20Desc:"In the past 6 months, how satisfied are you with your overall life situation? Including overall evaluation of life quality, satisfaction with personal achievements, and optimism about future life prospects. Are you satisfied with your current life situation and hopeful about the future?",excellent:"Excellent",good:"Good",fair:"Fair",poor:"Needs Improvement",terrible:"Very Poor",scoreLabel:"Assessment Score",resultLabel:"Assessment Result",descriptionLabel:"Detailed Analysis",recommendationsLabel:"Improvement Suggestions",analysisLabel:"Professional Analysis",privacyPolicy:"Privacy Policy",terms:"Terms/Statement",dataDeletion:"Data Deletion Guide",about:"🧬 Restarter™｜Who We Are",feedback:"💬 Feedback｜We Want to Hear You"},ko:{title:"사회 통합도 평가",subtitle:"사회 통합도를 평가하고 전문적인 조언을 받으세요",subtitle2:"용감하게 직면하고 정기적으로 자신의 사회 통합도 진전 상황을 점검하세요. 모든 평가는 성장의 기회입니다",backToHome:"돌아가기",startAssessment:"평가 시작",submitAssessment:"평가 제출",cancelAssessment:"취소",closeAssessment:"닫기",assessmentComplete:"평가 완료",viewReport:"보고서 보기",closeReport:"보고서 닫기",q1Title:"인간관계",q1Desc:"최근 3개월간 타인과의 상호작용과 사회적 능력은 어떠한가요? 동료, 친구, 이웃과의 일상적 교류와 새로운 환경에서 관계를 구축하는 능력을 포함합니다. 적극적으로 타인과 소통하고 신뢰 관계를 구축하며 사회적 상황에서 편안함을 느낄 수 있나요?",q2Title:"고용 상황",q2Desc:"최근 1년간 직업의 안정성과 발전 전망은 어떠한가요? 직업 만족도, 급여 대우, 직업 발전 기회, 직장 환경 적응성, 그리고 미래 직업 계획의 명확성을 포함합니다. 현재 직업에 만족하며 명확한 직업 발전 목표가 있나요?",q3Title:"가족 관계",q3Desc:"최근 6개월간 가족과의 생활과 소통 상황은 어떠한가요? 배우자, 자녀, 부모 또는 다른 가족 구성원과의 관계 품질, 소통 빈도와 효과, 그리고 가족 분위기의 조화를 포함합니다. 가족 갈등을 효과적으로 처리하고 가족 구성원에게 감정적 지원을 제공할 수 있나요?",q4Title:"미래에 대한 신뢰",q4Desc:"미래 1년에 대한 낙관적 정도와 계획은 어떠한가요? 개인 발전에 대한 신뢰, 삶의 목표에 대한 명확성, 그리고 도전에 직면할 때의 적극적 태도를 포함합니다. 미래에 대한 명확한 계획이 있으며 목표를 달성할 수 있다고 믿나요?",q5Title:"사회적 수용",q5Desc:"최근 6개월간 사회로부터 받아들여지고 인정받는다고 느끼는 정도는 어떠한가요? 지역사회에서의 통합도, 사회적 지위에 대한 동일시, 그리고 사회적 규범에 대한 적응 능력을 포함합니다. 사회로부터 받아들여진다고 느끼며 자신의 사회적 역할에 만족하나요?",q6Title:"감정 관리",q6Desc:"최근 3개월간 스트레스와 부정적 감정을 처리하는 능력은 어떠한가요? 좌절에 직면할 때의 감정적 반응, 스트레스 조절 방법, 그리고 정신 건강 유지에 대한 의식을 포함합니다. 부정적 감정을 효과적으로 관리하고 스트레스 하에서도 침착함을 유지할 수 있나요?",q7Title:"생활 규칙",q7Desc:"최근 6개월간 생활 습관과 규칙성은 어떠한가요? 일상 생활 시간, 식습관, 운동 빈도, 그리고 생활 리듬의 안정성을 포함합니다. 건강한 생활 습관을 유지하고 규칙적인 일상 생활을 구축할 수 있나요?",q8Title:"학습 성장",q8Desc:"최근 1년간 기술 학습과 개인 성장에 대한 투자는 어떠한가요? 새로운 기술 학습, 지식 업데이트, 자기 향상에 대한 적극성, 그리고 개인 발전에 대한 투자를 포함합니다. 새로운 지식을 지속적으로 학습하고 개인 성장 기회를 적극적으로 찾나요?",q9Title:"재정 관리",q9Desc:"최근 1년간 재정 계획과 재정 관리 능력은 어떠한가요? 수입 지출 관리, 저축 습관, 투자 재정 의식, 그리고 미래 재정 안전에 대한 계획을 포함합니다. 개인 재정을 효과적으로 관리하고 미래를 위한 재정 준비를 할 수 있나요?",q10Title:"건강 상태",q10Desc:"최근 6개월간 신체적, 정신적 건강 상태는 어떠한가요? 신체 건강 상태, 정신 건강 상태, 의료 보건 의식, 그리고 건강 문제에 대한 예방과 처리 능력을 포함합니다. 건강 관리에 중점을 두고 적극적인 건강 유지 조치를 취하나요?",q11Title:"사회적 네트워크",q11Desc:"최근 3개월간 사회적 관계를 구축하고 유지하는 능력은 어떠한가요? 친구 수, 사회적 활동 참여도, 인간관계 품질, 그리고 사회적 네트워크의 폭과 깊이를 포함합니다. 안정적인 사회적 서클을 가지고 타인과 의미 있는 관계를 구축할 수 있나요?",q12Title:"목표 설정",q12Desc:"최근 1년간 개인 목표를 설정하고 추구하는 능력은 어떠한가요? 목표의 명확성, 계획의 실현 가능성, 실행력, 그리고 목표 달성도에 대한 평가를 포함합니다. 명확한 목표를 설정하고 계획을 효과적으로 실행할 수 있나요?",q13Title:"적응 능력",q13Desc:"최근 6개월간 환경 변화와 도전에 적응하는 능력은 어떠한가요? 새로운 환경에 대한 적응 속도, 변화에 대응하는 유연성, 그리고 좌절에서 회복하는 능력을 포함합니다. 새로운 환경에 빠르게 적응하고 변화 속에서도 안정을 유지할 수 있나요?",q14Title:"책임감",q14Desc:"최근 1년간 자신과 타인에 대한 책임감 있는 태도는 어떠한가요? 개인 행동에 대한 책임감, 타인에 대한 약속 이행, 그리고 사회적 책임에 대한 인식을 포함합니다. 개인적 책임을 질 수 있고 타인과 사회에 대해 책임을 질 수 있나요?",q15Title:"자아 정체성",q15Desc:"최근 6개월간 자아 가치와 정체성에 대한 동일시는 어떠한가요? 개인 가치에 대한 인식, 자기 수용 정도, 그리고 개인 정체성에 대한 만족도를 포함합니다. 자신에 대한 명확한 인식이 있으며 자신의 장단점을 받아들일 수 있나요?",q16Title:"지역사회 참여",q16Desc:"최근 1년간 지역사회 활동과 공익 서비스 참여 상황은 어떠한가요? 자원봉사 참여도, 지역사회 활동 기여, 그리고 사회 복지에 대한 관심과 참여를 포함합니다. 지역사회 활동에 적극적으로 참여하고 사회에 기여하나요?",q17Title:"직업 발전",q17Desc:"최근 1년간 직업 기술 향상과 경력 계획 측면에서의 성과는 어떠한가요? 전문 기술 발전, 경력 계획 명확성, 그리고 경력 발전 기회에 대한 파악을 포함합니다. 직업 기술을 지속적으로 향상시키고 명확한 경력 발전 경로가 있나요?",q18Title:"인간관계 갈등 처리",q18Desc:"최근 3개월간 인간관계 갈등과 의견 차이를 처리하는 능력은 어떠한가요? 갈등 해결 기술, 소통 조정 능력, 그리고 관계 유지의 지혜를 포함합니다. 인간관계 갈등을 효과적으로 처리하고 의견 차이에서 합의를 찾을 수 있나요?",q19Title:"시간 관리",q19Desc:"최근 1년간 시간을 합리적으로 배치하고 우선순위를 설정하는 능력은 어떠한가요? 시간 계획 효율성, 작업 우선순위 설정, 그리고 업무와 생활의 균형 유지를 포함합니다. 시간을 효과적으로 관리하고 다중 작업에서도 효율성을 유지할 수 있나요?",q20Title:"전체 만족도",q20Desc:"최근 6개월간 전체적인 생활 상황에 대한 만족도는 어떠한가요? 생활 품질에 대한 전체적 평가, 개인 성취에 대한 만족도, 그리고 미래 생활 전망에 대한 낙관적 정도를 포함합니다. 현재의 생활 상황에 만족하며 미래에 대한 희망을 가지고 있나요?",excellent:"매우 좋음",good:"좋음",fair:"보통",poor:"개선 필요",terrible:"매우 나쁨",scoreLabel:"평가 점수",resultLabel:"평가 결과",descriptionLabel:"상세 분석",recommendationsLabel:"개선 제안",analysisLabel:"전문 분석",privacyPolicy:"개인정보 보호정책",terms:"약관/성명",dataDeletion:"데이터 삭제 안내",about:"🧬 Restarter™｜우리는 누구인가",feedback:"💬 의견함｜우리는 당신의 말을 듣고 싶습니다"}};function tM(){const{lang:n}=Lt(),e=Et(),{isTestMode:t}=Bo(),[r,o]=v.useState(0),a=yk[n]||yk["zh-TW"];v.useEffect(()=>{console.log("Language changed to:",n),o(P=>P+1)},[n]);const[c,d]=v.useState(!1),[h,m]=v.useState(!1),[g,x]=v.useState({q1:"",q2:"",q3:"",q4:"",q5:"",q6:"",q7:"",q8:"",q9:"",q10:"",q11:"",q12:"",q13:"",q14:"",q15:"",q16:"",q17:"",q18:"",q19:"",q20:""}),[S,j]=v.useState(null),T=P=>{const z={excellent:5,good:4,fair:3,poor:2,terrible:1},H=[z[P.q1]||3,z[P.q2]||3,z[P.q3]||3,z[P.q4]||3,z[P.q5]||3,z[P.q6]||3,z[P.q7]||3,z[P.q8]||3,z[P.q9]||3,z[P.q10]||3,z[P.q11]||3,z[P.q12]||3,z[P.q13]||3,z[P.q14]||3,z[P.q15]||3,z[P.q16]||3,z[P.q17]||3,z[P.q18]||3,z[P.q19]||3,z[P.q20]||3],O=H.reduce((D,M)=>D+M,0)/20,L={interpersonal:(H[0]+H[10]+H[17])/3,career:(H[1]+H[16])/2,family:H[2],emotional:(H[5]+H[14])/2,lifestyle:(H[6]+H[9]+H[18])/3,learning:(H[7]+H[11]+H[12])/3,financial:H[8],responsibility:H[13],community:H[15],satisfaction:H[19]},C=Object.entries(L).filter(([D,M])=>M>=4).map(([D,M])=>D),A=Object.entries(L).filter(([D,M])=>M<=2).map(([D,M])=>D);if(O>=4.5){const M=[{condition:C.includes("interpersonal")&&C.includes("career"),description:"你的社會融入度表現卓越！在人際關係和職業發展方面表現特別突出，顯示出優秀的社交能力和職業素養。",recommendations:["繼續保持優秀的人際交往能力","可以考慮擔任職場導師幫助其他更生人","分享你的職業成功經驗","參與專業社群擴大影響力"],analysis:"你在人際關係和職業發展方面的優秀表現，表明你已經完全融入社會。建議繼續發揮這些優勢，並幫助其他需要支持的人。"},{condition:C.includes("emotional")&&C.includes("family"),description:"你的社會融入度表現優秀！在情緒管理和家庭關係方面表現特別突出，顯示出良好的心理素質和家庭和諧。",recommendations:["繼續保持穩定的情緒狀態","可以擔任家庭關係諮詢志工","分享你的家庭和諧經驗","參與心理健康推廣活動"],analysis:"你在情緒管理和家庭關係方面的優秀表現，表明你具備良好的心理素質和家庭責任感。建議繼續保持這種狀態。"},{condition:C.includes("lifestyle")&&C.includes("learning"),description:"你的社會融入度表現優秀！在生活規律和學習成長方面表現特別突出，顯示出良好的自律能力和進取精神。",recommendations:["繼續保持規律的生活習慣","可以擔任學習輔導志工","分享你的學習方法和經驗","參與教育推廣活動"],analysis:"你在生活規律和學習成長方面的優秀表現，表明你具備良好的自律能力和進取精神。建議繼續發揮這些優勢。"},{condition:C.includes("financial")&&C.includes("responsibility"),description:"你的社會融入度表現優秀！在財務管理和責任感方面表現特別突出，顯示出良好的理財能力和社會責任感。",recommendations:["繼續保持穩健的財務管理","可以擔任財務規劃志工","分享你的理財經驗","參與社會責任活動"],analysis:"你在財務管理和責任感方面的優秀表現，表明你具備良好的理財能力和社會責任感。建議繼續發揮這些優勢。"},{condition:C.includes("community")&&C.includes("satisfaction"),description:"你的社會融入度表現優秀！在社區參與和整體滿意度方面表現特別突出，顯示出良好的社會參與度和生活滿意度。",recommendations:["繼續積極參與社區活動","可以擔任社區志工領袖","分享你的社區參與經驗","參與更多公益活動"],analysis:"你在社區參與和整體滿意度方面的優秀表現，表明你已經完全融入社會並對生活感到滿意。建議繼續保持這種狀態。"}].find(B=>B.condition)||{description:`恭喜您！您的社會融入度評估結果顯示您已經達到了優秀水平。在${C.length>0?C.map(B=>({interpersonal:"人際關係",career:"職業發展",family:"家庭關係",emotional:"情緒管理",lifestyle:"生活規律",learning:"學習成長",financial:"財務管理",responsibility:"責任感",community:"社區參與",satisfaction:"整體滿意度"})[B]||B).join("、"):"多個重要維度"}方面，您展現出了卓越的能力和積極的態度。這表明您已經成功建立了穩定的社會支持網絡，具備了良好的生活技能和職業素養，並且對未來充滿信心。您的表現不僅為自己創造了美好的生活，也為其他更生人樹立了積極的榜樣。`,recommendations:["繼續保持現有的優秀表現，定期進行自我評估以維持高水準","考慮擔任更生人互助團體的導師或志工，分享您的成功經驗","參與專業社群和行業交流，進一步提升職業技能和社會影響力","建立個人品牌，成為更生人融入社會的典範","定期參與公益活動，回饋社會並擴大正面影響力","考慮擔任職場導師，幫助其他更生人提升就業競爭力","建立個人發展檔案，記錄成長歷程並分享給需要支持的人"],analysis:`基於您完成的20項詳細評估，我們發現您在${C.length>0?C.map(B=>({interpersonal:"人際關係",career:"職業發展",family:"家庭關係",emotional:"情緒管理",lifestyle:"生活規律",learning:"學習成長",financial:"財務管理",responsibility:"責任感",community:"社區參與",satisfaction:"整體滿意度"})[B]||B).join("、"):"各個關鍵維度"}都表現出色。這表明您已經完全融入了社會，具備了優秀的社會適應能力、職業素養和生活技能。您的成功不僅體現在個人成就上，更重要的是您展現出了積極的生活態度和對未來的清晰規劃。建議您繼續保持這種優秀狀態，並考慮將您的經驗分享給其他需要支持的人，成為更生人融入社會的典範。您的表現證明了更生人完全有能力重新融入社會並創造美好生活。`};return{score:O,result:"優秀",description:M.description,recommendations:M.recommendations,analysis:M.analysis}}else if(O>=3.5){const M=[{condition:A.includes("interpersonal")&&C.includes("career"),description:"你的社會融入度良好，在職業發展方面表現不錯，但人際關係需要改善。",recommendations:["參加人際溝通技巧培訓","主動參與社交活動","尋求人際關係諮詢","繼續保持職業發展優勢"],analysis:"你在職業發展方面表現良好，但人際關係需要改善。建議重點提升社交能力，同時保持職業優勢。"},{condition:A.includes("emotional")&&C.includes("family"),description:"你的社會融入度良好，在家庭關係方面表現不錯，但情緒管理需要改善。",recommendations:["參加情緒管理課程","尋求心理諮商服務","學習壓力調節技巧","繼續維護良好的家庭關係"],analysis:"你在家庭關係方面表現良好，但情緒管理需要改善。建議重點提升情緒管理能力。"},{condition:A.includes("lifestyle")&&C.includes("learning"),description:"你的社會融入度良好，在學習成長方面表現不錯，但生活規律需要改善。",recommendations:["制定規律的作息時間表","建立健康的生活習慣","參加時間管理課程","繼續保持學習熱情"],analysis:"你在學習成長方面表現良好，但生活規律需要改善。建議重點建立規律的生活習慣。"},{condition:A.includes("financial")&&C.includes("responsibility"),description:"你的社會融入度良好，在責任感方面表現不錯，但財務管理需要改善。",recommendations:["參加財務規劃課程","制定個人預算計劃","學習理財知識","繼續保持責任感"],analysis:"你在責任感方面表現良好，但財務管理需要改善。建議重點提升財務管理能力。"},{condition:A.includes("community")&&C.includes("satisfaction"),description:"你的社會融入度良好，對生活滿意度不錯，但社區參與需要改善。",recommendations:["主動參與社區活動","加入志願服務團體","參與公益活動","繼續保持積極的生活態度"],analysis:"你對生活滿意度不錯，但社區參與需要改善。建議重點提升社會參與度。"}].find(B=>B.condition)||{description:`您的社會融入度評估結果顯示您達到了良好水平。在${C.length>0?C.map(B=>({interpersonal:"人際關係",career:"職業發展",family:"家庭關係",emotional:"情緒管理",lifestyle:"生活規律",learning:"學習成長",financial:"財務管理",responsibility:"責任感",community:"社區參與",satisfaction:"整體滿意度"})[B]||B).join("、"):"多個重要維度"}方面，您展現出了穩定的能力和積極的態度。這表明您已經建立了基本的社會支持網絡，具備了良好的生活技能和職業素養，並且對未來有一定的規劃。雖然在某些方面還有提升空間，但您的整體表現已經為進一步發展奠定了堅實的基礎。`,recommendations:["繼續保持現有的良好狀態，建立定期自我評估機制",A.length>0?`制定${A.join("、")}方面的具體改善計劃，設定明確的目標和時間表`:"進一步提升各方面能力，設定更具挑戰性的目標","參加專業技能培訓和認證課程，提升職業競爭力","加強與社區的互動和參與，擴大社交網絡","尋求導師指導，學習成功人士的經驗和方法","建立個人發展檔案，記錄進步歷程和成就","參與更生人互助團體，與同路人分享經驗和互相支持"],analysis:`基於您完成的20項詳細評估，我們發現您在${C.length>0?C.map(B=>({interpersonal:"人際關係",career:"職業發展",family:"家庭關係",emotional:"情緒管理",lifestyle:"生活規律",learning:"學習成長",financial:"財務管理",responsibility:"責任感",community:"社區參與",satisfaction:"整體滿意度"})[B]||B).join("、"):"多個關鍵維度"}表現良好，具備了基本的社會適應能力和生活技能。${A.length>0?`特別是在${A.map(B=>({interpersonal:"人際關係",career:"職業發展",family:"家庭關係",emotional:"情緒管理",lifestyle:"生活規律",learning:"學習成長",financial:"財務管理",responsibility:"責任感",community:"社區參與",satisfaction:"整體滿意度"})[B]||B).join("、")}方面，建議您制定具體的改善計劃，尋求專業指導和支持。`:""}您的整體表現表明您已經成功融入了社會，並且具備了進一步發展的潛力。建議您繼續保持積極的態度，設定更具挑戰性的目標，並尋求更多學習和成長的機會。您的進步證明了更生人完全有能力重新融入社會並創造美好生活。`};return{score:O,result:"良好",description:M.description,recommendations:M.recommendations,analysis:M.analysis}}else if(O>=2.5){const M=[{condition:A.includes("interpersonal")&&A.includes("career"),description:"你的社會融入度一般，在人際關係和職業發展方面都需要改善。",recommendations:["參加人際溝通技巧培訓","尋求職業技能培訓","參加更生人互助團體","建立職業發展計劃","尋求專業輔導師幫助"],analysis:"你在人際關係和職業發展方面都需要改善。建議同時提升社交能力和職業技能，尋求專業支持。"},{condition:A.includes("emotional")&&A.includes("family"),description:"你的社會融入度一般，在情緒管理和家庭關係方面都需要改善。",recommendations:["尋求心理諮商服務","參加情緒管理課程","改善家庭溝通方式","建立家庭支持系統","尋求專業輔導師幫助"],analysis:"你在情緒管理和家庭關係方面都需要改善。建議重點提升心理健康和家庭關係。"},{condition:A.includes("lifestyle")&&A.includes("learning"),description:"你的社會融入度一般，在生活規律和學習成長方面都需要改善。",recommendations:["制定規律的作息時間表","參加時間管理課程","建立學習計劃","尋找學習夥伴","尋求專業輔導師幫助"],analysis:"你在生活規律和學習成長方面都需要改善。建議重點建立規律的生活習慣和學習計劃。"},{condition:A.includes("financial")&&A.includes("responsibility"),description:"你的社會融入度一般，在財務管理和責任感方面都需要改善。",recommendations:["參加財務規劃課程","制定個人預算計劃","提升責任感意識","建立財務目標","尋求專業輔導師幫助"],analysis:"你在財務管理和責任感方面都需要改善。建議重點提升理財能力和責任感。"},{condition:A.includes("community")&&A.includes("satisfaction"),description:"你的社會融入度一般，在社區參與和整體滿意度方面都需要改善。",recommendations:["主動參與社區活動","加入志願服務團體","提升生活滿意度","建立社交網絡","尋求專業輔導師幫助"],analysis:"你在社區參與和整體滿意度方面都需要改善。建議重點提升社會參與度和生活滿意度。"}].find(B=>B.condition)||{description:`您的社會融入度評估結果顯示您目前處於一般水平。在${A.length>0?A.map(B=>({interpersonal:"人際關係",career:"職業發展",family:"家庭關係",emotional:"情緒管理",lifestyle:"生活規律",learning:"學習成長",financial:"財務管理",responsibility:"責任感",community:"社區參與",satisfaction:"整體滿意度"})[B]||B).join("、"):"某些重要維度"}方面，您需要更多的支持和改善。這表明您在社會融入過程中遇到了一些挑戰，但這並不意味著失敗，而是需要更多專業指導和支持的表現。${C.length>0?`同時，您在${C.map(B=>({interpersonal:"人際關係",career:"職業發展",family:"家庭關係",emotional:"情緒管理",lifestyle:"生活規律",learning:"學習成長",financial:"財務管理",responsibility:"責任感",community:"社區參與",satisfaction:"整體滿意度"})[B]||B).join("、")}方面的表現值得肯定，這些優勢將成為您改善其他方面的基礎。`:""}建議您積極尋求專業支持，制定系統性的改善計劃。`,recommendations:["立即聯繫專業輔導師，制定個人化的改善計劃","參加更生人支持計劃和互助團體，獲得同路人支持","建立穩定的生活規律，包括作息時間、飲食習慣和運動計劃","加強人際關係建設，學習有效的溝通技巧",C.length>0?`充分發揮${C.map(B=>({interpersonal:"人際關係",career:"職業發展",family:"家庭關係",emotional:"情緒管理",lifestyle:"生活規律",learning:"學習成長",financial:"財務管理",responsibility:"責任感",community:"社區參與",satisfaction:"整體滿意度"})[B]||B).join("、")}方面的優勢，建立自信心`:"尋找個人優勢並加以發揮，建立自信心","參加職業技能培訓，提升就業競爭力","建立支持網絡，包括家人、朋友和專業人士","制定短期和長期目標，逐步改善各方面能力","定期進行自我評估，追蹤改善進度"],analysis:`基於您完成的20項詳細評估，我們發現您在${A.length>0?A.map(B=>({interpersonal:"人際關係",career:"職業發展",family:"家庭關係",emotional:"情緒管理",lifestyle:"生活規律",learning:"學習成長",financial:"財務管理",responsibility:"責任感",community:"社區參與",satisfaction:"整體滿意度"})[B]||B).join("、"):"某些關鍵維度"}需要更多支持。${A.length>0?`特別是在${A.map(B=>({interpersonal:"人際關係",career:"職業發展",family:"家庭關係",emotional:"情緒管理",lifestyle:"生活規律",learning:"學習成長",financial:"財務管理",responsibility:"責任感",community:"社區參與",satisfaction:"整體滿意度"})[B]||B).join("、")}方面，建議您制定具體的改善計劃，尋求專業指導和支持。`:""}${C.length>0?`同時，您在${C.map(B=>({interpersonal:"人際關係",career:"職業發展",family:"家庭關係",emotional:"情緒管理",lifestyle:"生活規律",learning:"學習成長",financial:"財務管理",responsibility:"責任感",community:"社區參與",satisfaction:"整體滿意度"})[B]||B).join("、")}方面的表現值得肯定，這些優勢將成為您改善其他方面的基礎。`:""}您的評估結果表明您在社會融入過程中遇到了一些挑戰，但這並不意味著失敗。每個人的改善路徑都是不同的，重要的是您願意正視這些挑戰並尋求幫助。建議您積極尋求專業支持，制定系統性的改善計劃，並相信通過持續的努力，您一定能夠取得進步。`};return{score:O,result:"一般",description:M.description,recommendations:M.recommendations,analysis:M.analysis}}else{const M=[{condition:A.includes("interpersonal")&&A.includes("emotional"),description:"你的社會融入度需要改善，在人際關係和情緒管理方面都需要專業支持。",recommendations:["立即聯繫專業輔導師","尋求心理諮商服務","參加人際溝通技巧培訓","參加情緒管理課程","建立支持網絡"],analysis:"你在人際關係和情緒管理方面都需要專業支持。建議立即尋求專業幫助，逐步改善這些方面。"},{condition:A.includes("career")&&A.includes("financial"),description:"你的社會融入度需要改善，在職業發展和財務管理方面都需要專業支持。",recommendations:["立即聯繫專業輔導師","參加職業技能培訓","參加財務規劃課程","制定職業發展計劃","建立財務目標"],analysis:"你在職業發展和財務管理方面都需要專業支持。建議立即尋求專業幫助，制定改善計劃。"},{condition:A.includes("family")&&A.includes("lifestyle"),description:"你的社會融入度需要改善，在家庭關係和生活規律方面都需要專業支持。",recommendations:["立即聯繫專業輔導師","改善家庭溝通方式","制定規律的作息時間表","建立家庭支持系統","參加家庭關係諮詢"],analysis:"你在家庭關係和生活規律方面都需要專業支持。建議立即尋求專業幫助，改善這些方面。"},{condition:A.includes("learning")&&A.includes("responsibility"),description:"你的社會融入度需要改善，在學習成長和責任感方面都需要專業支持。",recommendations:["立即聯繫專業輔導師","制定學習計劃","提升責任感意識","尋找學習夥伴","建立目標管理系統"],analysis:"你在學習成長和責任感方面都需要專業支持。建議立即尋求專業幫助，制定改善計劃。"},{condition:A.includes("community")&&A.includes("satisfaction"),description:"你的社會融入度需要改善，在社區參與和整體滿意度方面都需要專業支持。",recommendations:["立即聯繫專業輔導師","主動參與社區活動","提升生活滿意度","加入志願服務團體","建立社交網絡"],analysis:"你在社區參與和整體滿意度方面都需要專業支持。建議立即尋求專業幫助，改善這些方面。"}].find(B=>B.condition)||{description:`您的社會融入度評估結果顯示您目前面臨較大的挑戰，在${A.length>0?A.map(B=>({interpersonal:"人際關係",career:"職業發展",family:"家庭關係",emotional:"情緒管理",lifestyle:"生活規律",learning:"學習成長",financial:"財務管理",responsibility:"責任感",community:"社區參與",satisfaction:"整體滿意度"})[B]||B).join("、"):"多個重要維度"}都需要專業支持和改善。這表明您在社會融入過程中遇到了較多的困難，但這絕對不是失敗，而是需要更多專業幫助的表現。每個人的改善路徑都是不同的，重要的是您願意正視這些挑戰並積極尋求幫助。建議您立即聯繫專業輔導師，制定系統性的改善計劃，並相信通過持續的努力和專業支持，您一定能夠逐步改善並重新融入社會。`,recommendations:["立即聯繫專業輔導師，制定個人化的改善計劃和時間表","參加更生人支持計劃和互助團體，獲得同路人支持和理解","尋求專業心理諮商服務，處理可能的情緒和心理問題","建立穩定的生活規律，包括規律的作息、健康的飲食和適度的運動","尋求家人和朋友的支持，建立穩定的支持網絡","參加職業技能培訓和就業輔導，提升就業競爭力","建立短期和長期目標，逐步改善各方面能力","定期進行自我評估，追蹤改善進度並調整計劃","學習有效的壓力管理和情緒調節技巧","參與社區活動，逐步建立社交網絡"],analysis:`基於您完成的20項詳細評估，我們發現您在${A.length>0?A.map(B=>({interpersonal:"人際關係",career:"職業發展",family:"家庭關係",emotional:"情緒管理",lifestyle:"生活規律",learning:"學習成長",financial:"財務管理",responsibility:"責任感",community:"社區參與",satisfaction:"整體滿意度"})[B]||B).join("、"):"多個關鍵維度"}需要專業支持。您的評估結果表明您目前在社會融入過程中遇到了較多的挑戰，但這絕對不是失敗。每個人的改善路徑都是不同的，重要的是您願意正視這些挑戰並積極尋求幫助。專業輔導師可以幫助您制定適合的改善計劃，提供系統性的支持和指導。建議您立即聯繫專業輔導師，制定個人化的改善計劃，並相信通過持續的努力和專業支持，您一定能夠逐步改善並重新融入社會。記住，尋求幫助是勇敢的表現，也是成功改善的第一步。`};return{score:O,result:"需要改善",description:M.description,recommendations:M.recommendations,analysis:M.analysis}}},R=()=>{if(!Object.values(g).every(J=>J!=="")){alert("請回答所有問題");return}const z=T(g),H={score:z.score,result:z.result,description:z.description,recommendations:z.recommendations,analysis:z.analysis,details:{relationships:g.q1,employment:g.q2,family:g.q3,confidence:g.q4,acceptance:g.q5,emotional:g.q6,routine:g.q7,learning:g.q8,financial:g.q9,health:g.q10,social:g.q11,goals:g.q12,adaptability:g.q13,responsibility:g.q14,identity:g.q15,community:g.q16,career:g.q17,conflict:g.q18,time:g.q19,satisfaction:g.q20}};j(H),d(!1),m(!0)},I=[{key:"q1",title:a.q1Title,desc:a.q1Desc},{key:"q2",title:a.q2Title,desc:a.q2Desc},{key:"q3",title:a.q3Title,desc:a.q3Desc},{key:"q4",title:a.q4Title,desc:a.q4Desc},{key:"q5",title:a.q5Title,desc:a.q5Desc},{key:"q6",title:a.q6Title,desc:a.q6Desc},{key:"q7",title:a.q7Title,desc:a.q7Desc},{key:"q8",title:a.q8Title,desc:a.q8Desc},{key:"q9",title:a.q9Title,desc:a.q9Desc},{key:"q10",title:a.q10Title,desc:a.q10Desc},{key:"q11",title:a.q11Title,desc:a.q11Desc},{key:"q12",title:a.q12Title,desc:a.q12Desc},{key:"q13",title:a.q13Title,desc:a.q13Desc},{key:"q14",title:a.q14Title,desc:a.q14Desc},{key:"q15",title:a.q15Title,desc:a.q15Desc},{key:"q16",title:a.q16Title,desc:a.q16Desc},{key:"q17",title:a.q17Title,desc:a.q17Desc},{key:"q18",title:a.q18Title,desc:a.q18Desc},{key:"q19",title:a.q19Title,desc:a.q19Desc},{key:"q20",title:a.q20Title,desc:a.q20Desc}],F=[{value:"excellent",label:a.excellent},{value:"good",label:a.good},{value:"fair",label:a.fair},{value:"poor",label:a.poor},{value:"terrible",label:a.terrible}];return i.jsxs("div",{style:{minHeight:"100vh",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",padding:"20px",display:"flex",flexDirection:"column"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"30px"},children:[i.jsx("button",{onClick:()=>e("/"),style:{background:"rgba(255,255,255,0.9)",border:"none",borderRadius:"12px",padding:"12px 20px",fontSize:"16px",fontWeight:"600",cursor:"pointer",display:"flex",alignItems:"center",gap:"8px",boxShadow:"0 4px 12px rgba(0,0,0,0.1)"},children:a.backToHome}),i.jsxs("h1",{style:{color:"white",fontSize:"24px",fontWeight:"700",margin:0,textAlign:"center",position:"absolute",top:"24px",left:"50%",transform:"translateX(-50%)",zIndex:1e3},children:["📊 ",a.title]})]}),i.jsx("div",{style:{flex:1,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:"30px"},children:i.jsxs("div",{style:{background:"rgba(255,255,255,0.95)",borderRadius:"20px",padding:"40px",maxWidth:"600px",width:"100%",textAlign:"center",boxShadow:"0 8px 32px rgba(0,0,0,0.1)"},children:[i.jsx("div",{style:{fontSize:"64px",marginBottom:"20px"},children:"📊"}),i.jsx("h2",{style:{fontSize:"28px",fontWeight:"700",color:"#333",marginBottom:"16px"},children:a.title}),i.jsx("p",{style:{fontSize:"16px",color:"#666",lineHeight:"1.6",marginBottom:"20px"},children:a.subtitle}),i.jsx("p",{style:{fontSize:"14px",color:"#888",lineHeight:"1.5",marginBottom:"30px",fontStyle:"italic"},children:a.subtitle2}),i.jsx("button",{onClick:()=>d(!0),style:{background:"linear-gradient(135deg, #6B5BFF, #5A4FCF)",color:"white",border:"none",borderRadius:"16px",padding:"16px 32px",fontSize:"18px",fontWeight:"600",cursor:"pointer",boxShadow:"0 4px 16px rgba(107, 91, 255, 0.3)",transition:"all 0.3s ease"},onMouseEnter:P=>{P.currentTarget.style.transform="translateY(-2px)",P.currentTarget.style.boxShadow="0 6px 20px rgba(107, 91, 255, 0.4)"},onMouseLeave:P=>{P.currentTarget.style.transform="translateY(0)",P.currentTarget.style.boxShadow="0 4px 16px rgba(107, 91, 255, 0.3)"},children:a.startAssessment})]})}),c&&i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,padding:"20px"},children:i.jsxs("div",{style:{background:"white",borderRadius:"20px",padding:"30px",maxWidth:"600px",width:"100%",maxHeight:"80vh",overflowY:"auto",position:"relative"},children:[i.jsx("button",{onClick:()=>d(!1),style:{position:"absolute",top:"15px",right:"20px",background:"none",border:"none",fontSize:"24px",color:"#666",cursor:"pointer",width:"30px",height:"30px",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"50%",transition:"all 0.2s ease"},onMouseEnter:P=>{P.currentTarget.style.background="#f0f0f0",P.currentTarget.style.color="#333"},onMouseLeave:P=>{P.currentTarget.style.background="none",P.currentTarget.style.color="#666"},children:"×"}),i.jsx("h3",{style:{fontSize:"24px",fontWeight:"700",color:"#333",marginBottom:"20px",textAlign:"center",paddingRight:"40px"},children:a.title}),i.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"24px"},children:I.map((P,z)=>i.jsxs("div",{style:{border:"2px solid #f0f0f0",borderRadius:"16px",padding:"20px",background:"#fafafa"},children:[i.jsxs("h4",{style:{fontSize:"18px",fontWeight:"600",color:"#333",marginBottom:"8px"},children:[z+1,". ",P.title]}),i.jsx("p",{style:{fontSize:"14px",color:"#666",marginBottom:"16px"},children:P.desc}),i.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:F.map(H=>i.jsxs("label",{style:{display:"flex",alignItems:"center",padding:"10px",borderRadius:"8px",cursor:"pointer",background:g[P.key]===H.value?"#6B5BFF":"white",color:g[P.key]===H.value?"white":"#333",border:`2px solid ${g[P.key]===H.value?"#6B5BFF":"#ddd"}`,transition:"all 0.2s ease",fontSize:"13px"},children:[i.jsx("input",{type:"radio",name:P.key,value:H.value,checked:g[P.key]===H.value,onChange:J=>x({...g,[P.key]:J.target.value}),style:{marginRight:"10px"}}),H.label]},H.value))})]},P.key))}),i.jsxs("div",{style:{display:"flex",gap:"12px",marginTop:"30px",justifyContent:"center"},children:[i.jsx("button",{onClick:()=>d(!1),style:{background:"#f0f0f0",color:"#666",border:"none",borderRadius:"12px",padding:"12px 24px",fontSize:"16px",fontWeight:"600",cursor:"pointer"},children:a.cancelAssessment}),i.jsx("button",{onClick:R,style:{background:"linear-gradient(135deg, #6B5BFF, #5A4FCF)",color:"white",border:"none",borderRadius:"12px",padding:"12px 24px",fontSize:"16px",fontWeight:"600",cursor:"pointer"},children:a.submitAssessment})]})]})}),h&&S&&i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,padding:"20px"},children:i.jsxs("div",{style:{background:"white",borderRadius:"20px",padding:"30px",maxWidth:"600px",width:"100%",maxHeight:"80vh",overflowY:"auto"},children:[i.jsxs("div",{style:{textAlign:"center",marginBottom:"30px"},children:[i.jsx("div",{style:{fontSize:"48px",marginBottom:"16px"},children:"📊"}),i.jsx("h3",{style:{fontSize:"24px",fontWeight:"700",color:"#333",marginBottom:"8px"},children:a.assessmentComplete})]}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"20px"},children:[i.jsxs("div",{style:{background:"linear-gradient(135deg, #6B5BFF, #5A4FCF)",color:"white",borderRadius:"16px",padding:"24px",textAlign:"center"},children:[i.jsxs("div",{style:{fontSize:"36px",fontWeight:"700",marginBottom:"8px"},children:[S.score.toFixed(1),"/5.0"]}),i.jsx("div",{style:{fontSize:"20px",fontWeight:"600"},children:S.result})]}),i.jsxs("div",{style:{border:"2px solid #f0f0f0",borderRadius:"16px",padding:"20px",background:"#fafafa"},children:[i.jsx("h4",{style:{fontSize:"18px",fontWeight:"600",color:"#333",marginBottom:"12px"},children:a.descriptionLabel}),i.jsx("p",{style:{fontSize:"16px",color:"#666",lineHeight:"1.6"},children:S.description})]}),i.jsxs("div",{style:{border:"2px solid #f0f0f0",borderRadius:"16px",padding:"20px",background:"#fafafa"},children:[i.jsx("h4",{style:{fontSize:"18px",fontWeight:"600",color:"#333",marginBottom:"12px"},children:a.analysisLabel}),i.jsx("p",{style:{fontSize:"16px",color:"#666",lineHeight:"1.6"},children:S.analysis})]}),i.jsxs("div",{style:{border:"2px solid #FFE4E1",borderRadius:"16px",padding:"20px",background:"linear-gradient(135deg, #FFF5F5, #FFE4E1)",boxShadow:"0 4px 12px rgba(255, 182, 193, 0.2)"},children:[i.jsxs("h4",{style:{fontSize:"18px",fontWeight:"600",color:"#D63384",marginBottom:"12px",display:"flex",alignItems:"center",gap:"8px"},children:["💡 ",a.recommendationsLabel]}),i.jsx("ul",{style:{fontSize:"16px",color:"#666",lineHeight:"1.6",paddingLeft:"20px"},children:S.recommendations.map((P,z)=>i.jsx("li",{style:{marginBottom:"8px"},children:P},z))})]})]}),i.jsx("div",{style:{display:"flex",justifyContent:"center",marginTop:"30px"},children:i.jsx("button",{onClick:()=>m(!1),style:{background:"linear-gradient(135deg, #6B5BFF, #5A4FCF)",color:"white",border:"none",borderRadius:"12px",padding:"12px 24px",fontSize:"16px",fontWeight:"600",cursor:"pointer"},children:a.closeReport})})]})}),i.jsx("div",{style:{width:"100%",margin:"0 auto",marginTop:24,background:"rgba(255,255,255,0.95)",borderRadius:16,padding:"16px",boxShadow:"0 2px 12px #6B5BFF22"},children:i.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:20,flexWrap:"wrap"},children:[i.jsx("a",{href:"/about",style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12},children:a.about}),i.jsx("a",{href:"/privacy-policy",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12},children:a.privacyPolicy}),i.jsx("a",{href:"/terms",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12},children:a.terms}),i.jsx("a",{href:"/data-deletion",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12},children:a.dataDeletion}),i.jsx("a",{href:"/feedback",style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12},children:a.feedback})]})})]})}const nM=St(Po),xk={"zh-TW":{title:"確認註冊",confirming:"正在確認註冊...",success:"註冊成功！",error:"確認失敗",invalidToken:"確認連結無效或已過期",networkError:"網路連線失敗，請稍後再試",redirecting:"正在跳轉到首頁..."},"zh-CN":{title:"确认注册",confirming:"正在确认注册...",success:"注册成功！",error:"确认失败",invalidToken:"确认链接无效或已过期",networkError:"网络连接失败，请稍后再试",redirecting:"正在跳转到首页..."},en:{title:"Confirm Registration",confirming:"Confirming registration...",success:"Registration successful!",error:"Confirmation failed",invalidToken:"Confirmation link is invalid or expired",networkError:"Network connection failed, please try again later",redirecting:"Redirecting to homepage..."}};function rM(){const n=Et(),[e]=Pk(),{lang:t}=Lt(),r=xk[t]||xk["zh-TW"],[o,a]=v.useState("confirming"),[c,d]=v.useState("");return v.useEffect(()=>{const h=e.get("token");if(!h){a("error"),d(r.invalidToken);return}(async()=>{var g,x;try{const j=await(await fetch(Qu("/email-verification/confirm-registration"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:h})})).json();if(j.success){const{email:T,registrationData:R}=j,I=await P0(nM,T,R.password);await df(I.user,{displayName:R.nickname}),await Bd(Pn(Wt,"profiles",I.user.uid),{nickname:R.nickname,email:T,avatar:"",gender:R.gender,country:R.country,region:R.region,age:R.age,interest:R.interest,eventType:R.eventType,improvement:R.improvement,createdAt:new Date,updatedAt:new Date}),a("success"),d(r.success),setTimeout(()=>{n("/")},3e3)}else a("error"),d(j.error||r.error)}catch(S){console.error("確認註冊錯誤:",S),a("error"),(g=S==null?void 0:S.message)!=null&&g.includes("Failed to fetch")||(x=S==null?void 0:S.message)!=null&&x.includes("NetworkError")?d(r.networkError):d((S==null?void 0:S.message)||r.error)}})()},[e,n,r]),i.jsx("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},children:i.jsxs("div",{style:{background:"white",borderRadius:"16px",padding:"40px",boxShadow:"0 20px 40px rgba(0, 0, 0, 0.1)",textAlign:"center",maxWidth:"400px",width:"90%"},children:[i.jsxs("div",{style:{marginBottom:"24px"},children:[o==="confirming"&&i.jsx("div",{style:{fontSize:"48px",marginBottom:"16px"},children:"⏳"}),o==="success"&&i.jsx("div",{style:{fontSize:"48px",marginBottom:"16px"},children:"✅"}),o==="error"&&i.jsx("div",{style:{fontSize:"48px",marginBottom:"16px"},children:"❌"}),i.jsxs("h1",{style:{color:o==="success"?"#10b981":o==="error"?"#ef4444":"#6B5BFF",fontSize:"24px",fontWeight:"bold",marginBottom:"8px"},children:[o==="confirming"&&r.confirming,o==="success"&&r.success,o==="error"&&r.error]}),i.jsx("p",{style:{color:"#666",fontSize:"16px",lineHeight:"1.5"},children:c})]}),o==="success"&&i.jsx("div",{style:{background:"#f0f9ff",padding:"16px",borderRadius:"8px",border:"1px solid #0ea5e9",marginTop:"16px"},children:i.jsx("p",{style:{color:"#0c4a6e",fontSize:"14px"},children:r.redirecting})}),o==="error"&&i.jsx("button",{onClick:()=>n("/register"),style:{background:"linear-gradient(90deg, #6e8efb, #a777e3)",color:"white",border:"none",padding:"12px 24px",borderRadius:"8px",fontSize:"16px",fontWeight:"bold",cursor:"pointer",marginTop:"16px"},children:"返回註冊頁面"})]})})}const iM=[{name:"免費版",price:"NT$0",period:"永久免費",features:["❌ 無語音功能權限","❌ 無權限使用OpenAI API功能","❌ 無法與其他使用者互動","✅ 基礎功能使用15次/月","💰 成本限制: NT$0/月"],highlight:!1,buttonText:"立即註冊",buttonAction:"register"},{name:"基礎版",price:"NT$149",period:"/月 或 NT$1490/年",features:["🤖 AI Token 限制: 50K tokens/月","👥 用戶互動: 100次/月","💬 留言/里程碑/AI聊天: 各30次/月","🎯 基礎功能: 300次/月","⚡ Token 用完僅暫停語音功能"],highlight:!0,buttonText:"選擇基礎版",buttonAction:"basic"},{name:"進階版",price:"NT$249",period:"/月 或 NT$2490/年",features:["🤖 AI Token 限制: 100K tokens/月","👥 用戶互動: 300次/月","💬 留言/里程碑/AI聊天: 各80次/月","🎯 基礎功能: 600次/月","⚡ Token 用完僅暫停語音功能"],highlight:!1,buttonText:"選擇進階版",buttonAction:"advanced"},{name:"專業版",price:"NT$349",period:"/月 或 NT$3490/年",features:["🤖 AI Token 限制: 200K tokens/月","👥 用戶互動: 800次/月","💬 留言/里程碑/AI聊天: 各150次/月","🎯 基礎功能: 1000次/月","⚡ Token 用完僅暫停語音功能"],highlight:!1,buttonText:"選擇專業版",buttonAction:"professional"},{name:"無限版",price:"NT$499",period:"/月 或 NT$4990/年",features:["🤖 AI Token 限制: 500K tokens/月","♾️ 用戶互動: 無限制","♾️ 留言/里程碑/AI聊天: 無限制","♾️ 基礎功能: 無限制","⚡ 僅受 Token 上限限制"],highlight:!1,buttonText:"選擇無限版",buttonAction:"unlimited"}],oM=["選擇適合您的訂閱方案","完成付款（支援信用卡/Apple Pay/Google Pay）","付款成功後自動升級，立即享有所有訂閱權益"],sM=[{q:"升級後可以隨時取消嗎？",a:"可以，訂閱會員可隨時取消，權益將保留至本期結束。"},{q:"付款方式有哪些？",a:"支援信用卡、Apple Pay、Google Pay 等多種方式。"},{q:"各版本的AI功能限制是什麼？",a:"Token 用完僅暫停語音功能，文字功能可繼續使用至各自限制。各功能獨立檢查使用次數。"},{q:"Token 用完可以續購嗎？",a:"可以！Token 用完但未滿一個月時，可以續購並從今天重新計算使用期，更划算。"},{q:"無限版真的無限制嗎？",a:"無限版除了AI Token上限外，其他功能都無限制使用。"},{q:"可以中途升級或降級嗎？",a:"可以，升級立即生效，降級將在當前週期結束後生效。"}];function aM(){const n=Et(),t=St().currentUser;localStorage.getItem("lang");const[r,o]=v.useState(!1),[a,c]=v.useState(null),d=h=>{if(!t){o(!0);return}c(h),n(`/payment?plan=${h.buttonAction}`)};return i.jsxs("div",{style:{fontFamily:"-apple-system,BlinkMacSystemFont,sans-serif",background:"#f7f8fc",minHeight:"100vh",padding:"32px 0"},children:[i.jsx("button",{onClick:()=>n("/"),style:{position:"absolute",top:24,left:24,zIndex:10,background:"#fff",border:"1.5px solid #6B5BFF",color:"#6B5BFF",borderRadius:8,padding:"6px 18px",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:"0 2px 8px #0001"},children:"← 返回"}),i.jsxs("div",{style:{maxWidth:1200,margin:"0 auto",background:"#fff",borderRadius:18,boxShadow:"0 4px 24px #6B5BFF22",padding:32},children:[i.jsx("h1",{style:{fontSize:36,fontWeight:900,letterSpacing:2,background:"linear-gradient(90deg,#6B5BFF,#00CFFF)",WebkitBackgroundClip:"text",color:"transparent",marginBottom:24,textAlign:"center"},children:"Restarter 訂閱方案"}),i.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(280px, 1fr))",gap:24,marginBottom:32},children:iM.map((h,m)=>i.jsxs("div",{style:{background:h.highlight?"linear-gradient(135deg, #f3f7ff 0%, #e8f4ff 100%)":"#fff",border:h.highlight?"2px solid #6B5BFF":"1px solid #e0e0e0",borderRadius:16,padding:24,position:"relative",boxShadow:h.highlight?"0 8px 32px #6B5BFF22":"0 4px 16px #0001",transition:"all 0.3s ease",cursor:"pointer"},onClick:()=>d(h),children:[h.highlight&&i.jsx("div",{style:{position:"absolute",top:-12,left:"50%",transform:"translateX(-50%)",background:"#6B5BFF",color:"#fff",padding:"4px 16px",borderRadius:12,fontSize:14,fontWeight:700},children:"推薦方案"}),i.jsx("h3",{style:{fontSize:24,fontWeight:800,color:h.highlight?"#6B5BFF":"#333",marginBottom:8,textAlign:"center"},children:h.name}),i.jsxs("div",{style:{textAlign:"center",marginBottom:20},children:[i.jsx("span",{style:{fontSize:32,fontWeight:900,color:h.highlight?"#6B5BFF":"#333"},children:h.price}),i.jsx("span",{style:{fontSize:16,color:"#666"},children:h.period})]}),i.jsx("ul",{style:{margin:0,padding:0,listStyle:"none"},children:h.features.map((g,x)=>i.jsx("li",{style:{marginBottom:12,fontSize:14,lineHeight:1.5,color:"#555",display:"flex",alignItems:"flex-start",gap:8},children:i.jsx("span",{style:{fontSize:16,marginTop:1},children:g})},x))}),i.jsx("button",{style:{width:"100%",background:h.highlight?"linear-gradient(90deg, #6B5BFF, #00CFFF)":"#f0f0f0",color:h.highlight?"#fff":"#666",border:"none",borderRadius:8,padding:"12px 0",fontSize:16,fontWeight:700,cursor:"pointer",marginTop:20,transition:"all 0.2s ease"},children:h.buttonText})]},h.name))}),i.jsx("h2",{style:{fontSize:24,fontWeight:800,margin:"32px 0 12px",color:"#6B5BFF"},children:"升級流程"}),i.jsx("ol",{style:{fontSize:18,lineHeight:1.8,marginBottom:32,paddingLeft:24},children:oM.map((h,m)=>i.jsx("li",{children:h},m))}),i.jsx("h2",{style:{fontSize:24,fontWeight:800,margin:"32px 0 12px",color:"#6B5BFF"},children:"常見問題"}),i.jsx("div",{style:{marginBottom:32},children:sM.map((h,m)=>i.jsxs("div",{style:{marginBottom:18},children:[i.jsx("div",{style:{fontWeight:700,fontSize:18,color:"#6B5BFF"},children:h.q}),i.jsx("div",{style:{fontSize:17,color:"#444",marginLeft:8,marginTop:2},children:h.a})]},m))}),i.jsx("div",{style:{display:"flex",justifyContent:"center",marginTop:32},children:i.jsx("button",{onClick:()=>n("/register"),style:{background:"#00CFFF",color:"#fff",fontWeight:700,fontSize:20,padding:"14px 38px",borderRadius:10,boxShadow:"0 2px 8px #00CFFF33",border:"none",cursor:"pointer",transition:"0.2s"},children:"立即註冊免費版"})}),r&&i.jsx("div",{style:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",background:"rgba(0,0,0,0.5)",zIndex:9999,display:"flex",alignItems:"center",justifyContent:"center"},children:i.jsxs("div",{style:{background:"#fff",borderRadius:20,padding:32,boxShadow:"0 8px 32px rgba(0,0,0,0.2)",minWidth:380,textAlign:"center"},children:[i.jsx("div",{style:{fontSize:48,marginBottom:16,color:"#6B5BFF"},children:"🎯"}),i.jsx("div",{style:{fontSize:22,fontWeight:700,color:"#6B5BFF",marginBottom:12},children:"歡迎加入 Restarter！"}),i.jsx("div",{style:{fontSize:16,color:"#666",marginBottom:20,lineHeight:1.5},children:"註冊後即可選擇適合您的訂閱方案，開始您的重啟之旅"}),i.jsxs("div",{style:{background:"linear-gradient(135deg, #f8f9ff 0%, #e8f4ff 100%)",borderRadius:12,padding:16,marginBottom:24,border:"1px solid #e0e8ff"},children:[i.jsx("div",{style:{fontSize:14,color:"#6B5BFF",fontWeight:600,marginBottom:8},children:"💡 註冊好處"}),i.jsxs("div",{style:{fontSize:13,color:"#666",lineHeight:1.4},children:["• 免費體驗基礎功能",i.jsx("br",{}),"• 個人化使用記錄",i.jsx("br",{}),"• 安全可靠的服務"]})]}),i.jsxs("div",{style:{display:"flex",gap:12,justifyContent:"center"},children:[i.jsx("button",{onClick:()=>{o(!1),n("/register")},style:{background:"linear-gradient(135deg, #6B5BFF 0%, #00CFFF 100%)",color:"#fff",border:"none",borderRadius:12,padding:"12px 28px",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:"0 4px 12px #6B5BFF33",transition:"all 0.3s ease"},onMouseEnter:h=>{h.currentTarget.style.transform="translateY(-2px)",h.currentTarget.style.boxShadow="0 6px 16px #6B5BFF44"},onMouseLeave:h=>{h.currentTarget.style.transform="translateY(0)",h.currentTarget.style.boxShadow="0 4px 12px #6B5BFF33"},children:"🚀 立即註冊"}),i.jsx("button",{onClick:()=>o(!1),style:{background:"#f8f9ff",color:"#6B5BFF",border:"2px solid #6B5BFF",borderRadius:12,padding:"12px 28px",fontWeight:600,fontSize:16,cursor:"pointer",transition:"all 0.3s ease"},onMouseEnter:h=>{h.currentTarget.style.background="#6B5BFF",h.currentTarget.style.color="#fff"},onMouseLeave:h=>{h.currentTarget.style.background="#f8f9ff",h.currentTarget.style.color="#6B5BFF"},children:"💭 稍後再說"})]})]})})]})]})}const bk={basic:{name:"基礎版",price:"NT$149",period:"/月",features:["🤖 AI Token 限制: 50K tokens/月","👥 用戶互動: 100次/月","💬 留言/里程碑/AI聊天: 各30次/月","🎯 基礎功能: 300次/月"],buttonAction:"basic"},advanced:{name:"進階版",price:"NT$249",period:"/月",features:["🤖 AI Token 限制: 100K tokens/月","👥 用戶互動: 300次/月","💬 留言/里程碑/AI聊天: 各80次/月","🎯 基礎功能: 600次/月"],buttonAction:"advanced"},professional:{name:"專業版",price:"NT$349",period:"/月",features:["🤖 AI Token 限制: 200K tokens/月","👥 用戶互動: 800次/月","💬 留言/里程碑/AI聊天: 各150次/月","🎯 基礎功能: 1000次/月"],buttonAction:"professional"},unlimited:{name:"無限版",price:"NT$499",period:"/月",features:["🤖 AI Token 限制: 500K tokens/月","♾️ 用戶互動: 無限制","♾️ 留言/里程碑/AI聊天: 無限制","♾️ 基礎功能: 無限制"],buttonAction:"unlimited"}};function lM(){const n=Et(),[e]=Pk(),r=St().currentUser,[o,a]=v.useState(null),[c,d]=v.useState("credit"),[h,m]=v.useState(!1),[g,x]=v.useState(!1);v.useEffect(()=>{const j=e.get("plan");j&&bk[j]?a(bk[j]):n("/plans")},[e,n]);const S=async()=>{if(!r){n("/login");return}m(!0),setTimeout(()=>{m(!1),x(!0),setTimeout(()=>{n("/")},3e3)},2e3)};return o?i.jsxs("div",{style:{fontFamily:"-apple-system,BlinkMacSystemFont,sans-serif",background:"#f7f8fc",minHeight:"100vh",padding:"32px 0"},children:[i.jsx("button",{onClick:()=>n("/plans"),style:{position:"absolute",top:24,left:24,zIndex:10,background:"#fff",border:"1.5px solid #6B5BFF",color:"#6B5BFF",borderRadius:8,padding:"6px 18px",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:"0 2px 8px #0001"},children:"← 返回"}),i.jsxs("div",{style:{maxWidth:600,margin:"0 auto",background:"#fff",borderRadius:18,boxShadow:"0 4px 24px #6B5BFF22",padding:32},children:[i.jsx("h1",{style:{fontSize:32,fontWeight:900,letterSpacing:2,background:"linear-gradient(90deg,#6B5BFF,#00CFFF)",WebkitBackgroundClip:"text",color:"transparent",marginBottom:24,textAlign:"center"},children:"完成訂閱"}),i.jsxs("div",{style:{background:"#f8f9ff",borderRadius:12,padding:24,marginBottom:32},children:[i.jsx("h2",{style:{fontSize:20,fontWeight:700,color:"#6B5BFF",marginBottom:16},children:"選擇的方案"}),i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[i.jsx("span",{style:{fontSize:18,fontWeight:600},children:o.name}),i.jsxs("span",{style:{fontSize:24,fontWeight:900,color:"#6B5BFF"},children:[o.price,o.period]})]}),i.jsx("ul",{style:{margin:0,padding:0,listStyle:"none"},children:o.features.map((j,T)=>i.jsxs("li",{style:{marginBottom:8,fontSize:14,color:"#666"},children:["• ",j]},T))})]}),i.jsxs("div",{style:{marginBottom:32},children:[i.jsx("h2",{style:{fontSize:20,fontWeight:700,color:"#6B5BFF",marginBottom:16},children:"付款方式"}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:12},children:[i.jsxs("label",{style:{display:"flex",alignItems:"center",gap:12,cursor:"pointer"},children:[i.jsx("input",{type:"radio",name:"payment",value:"credit",checked:c==="credit",onChange:j=>d(j.target.value),style:{width:18,height:18}}),i.jsx("span",{style:{fontSize:16},children:"💳 信用卡"})]}),i.jsxs("label",{style:{display:"flex",alignItems:"center",gap:12,cursor:"pointer"},children:[i.jsx("input",{type:"radio",name:"payment",value:"apple",checked:c==="apple",onChange:j=>d(j.target.value),style:{width:18,height:18}}),i.jsx("span",{style:{fontSize:16},children:"🍎 Apple Pay"})]}),i.jsxs("label",{style:{display:"flex",alignItems:"center",gap:12,cursor:"pointer"},children:[i.jsx("input",{type:"radio",name:"payment",value:"google",checked:c==="google",onChange:j=>d(j.target.value),style:{width:18,height:18}}),i.jsx("span",{style:{fontSize:16},children:"🤖 Google Pay"})]})]})]}),i.jsx("button",{onClick:S,disabled:h,style:{width:"100%",background:h?"#ccc":"linear-gradient(90deg,#6B5BFF,#00CFFF)",color:"#fff",border:"none",borderRadius:12,padding:"16px 0",fontSize:18,fontWeight:700,cursor:h?"not-allowed":"pointer",transition:"all 0.2s ease"},children:h?"處理中...":`立即付款 ${o.price}`}),g&&i.jsx("div",{style:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",background:"#0008",zIndex:9999,display:"flex",alignItems:"center",justifyContent:"center"},children:i.jsxs("div",{style:{background:"#fff",borderRadius:16,padding:32,boxShadow:"0 4px 24px #0002",minWidth:320,textAlign:"center"},children:[i.jsx("div",{style:{fontSize:48,marginBottom:16},children:"✅"}),i.jsx("div",{style:{fontSize:20,fontWeight:700,color:"#6B5BFF",marginBottom:8},children:"付款成功！"}),i.jsx("div",{style:{fontSize:16,color:"#666",marginBottom:16},children:"您的訂閱已生效，即將跳轉到首頁..."})]})})]})]}):i.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"},children:i.jsx("div",{children:"載入中..."})})}const hy={basic:{name:"基礎版",price:"NT$ 149",period:"/月",features:["🤖 AI Token 限制: 50K tokens/月","👥 用戶互動: 100次/月","💬 留言/里程碑/AI聊天: 各30次/月","🎯 基礎功能: 300次/月","⚡ Token 用完僅暫停語音功能"],stripeLink:"https://buy.stripe.com/your_basic_monthly_link",paypalLink:"https://www.paypal.com/your_basic_monthly_link",ecpayLink:"https://payment.ecpay.com.tw/your_basic_monthly_link",newebpayLink:"https://ccore.newebpay.com/your_basic_monthly_link"},advanced:{name:"進階版",price:"NT$ 249",period:"/月",features:["🤖 AI Token 限制: 100K tokens/月","👥 用戶互動: 300次/月","💬 留言/里程碑/AI聊天: 各80次/月","🎯 基礎功能: 600次/月","⚡ Token 用完僅暫停語音功能"],stripeLink:"https://buy.stripe.com/your_advanced_monthly_link",paypalLink:"https://www.paypal.com/your_advanced_monthly_link",ecpayLink:"https://payment.ecpay.com.tw/your_advanced_monthly_link",newebpayLink:"https://ccore.newebpay.com/your_advanced_monthly_link"},professional:{name:"專業版",price:"NT$ 349",period:"/月",features:["🤖 AI Token 限制: 200K tokens/月","👥 用戶互動: 800次/月","💬 留言/里程碑/AI聊天: 各150次/月","🎯 基礎功能: 1000次/月","⚡ Token 用完僅暫停語音功能"],stripeLink:"https://buy.stripe.com/your_professional_monthly_link",paypalLink:"https://www.paypal.com/your_professional_monthly_link",ecpayLink:"https://payment.ecpay.com.tw/your_professional_monthly_link",newebpayLink:"https://ccore.newebpay.com/your_professional_monthly_link"},unlimited:{name:"無限版",price:"NT$ 499",period:"/月",features:["🤖 AI Token 限制: 500K tokens/月","♾️ 用戶互動: 無限制","♾️ 留言/里程碑/AI聊天: 無限制","♾️ 基礎功能: 無限制","⚡ 僅受 Token 上限限制"],stripeLink:"https://buy.stripe.com/your_unlimited_monthly_link",paypalLink:"https://www.paypal.com/your_unlimited_monthly_link",ecpayLink:"https://payment.ecpay.com.tw/your_unlimited_monthly_link",newebpayLink:"https://ccore.newebpay.com/your_unlimited_monthly_link"}};function cM(){const n=Et(),t=St().currentUser,[r,o]=v.useState(!1),[a,c]=v.useState("basic"),[d,h]=v.useState("stripe"),[m,g]=v.useState(!1),[x,S]=v.useState(null);localStorage.getItem("lang");const j=()=>{if(!t){o(!0);return}const F=hy[a],P=F[`${d}Link`];P&&!P.includes("your_")?T():alert(`請聯絡客服完成付款設定

選擇方案：${F.name}
付款方式：${d==="stripe"?"Stripe":d==="paypal"?"PayPal":d==="ecpay"?"綠界":"藍新"}

客服 Email：support@restarter.com`)},T=async()=>{if(t)try{const F=`TXN_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,P=await fetch("/api/subscription/payment-success",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:t.uid,plan:a,paymentMethod:d,transactionId:F,amount:R(a),currency:"TWD"})});if(P.ok){const z=await P.json();S(z),g(!0),setTimeout(()=>{n("/home")},3e3)}else alert("付款處理失敗，請聯絡客服")}catch(F){console.error("付款處理錯誤:",F),alert("付款處理失敗，請聯絡客服")}},R=F=>({basic:149,advanced:249,professional:349,unlimited:499})[F]||0,I=F=>({basic:"基礎版",advanced:"進階版",professional:"專業版",unlimited:"無限版"})[F]||F;return i.jsxs("div",{style:{minHeight:"100vh",background:"#f7faff",padding:0,overflowY:"auto"},children:[i.jsx("button",{onClick:()=>n("/plans"),style:{position:"absolute",top:24,left:24,zIndex:10,background:"#fff",border:"1.5px solid #6B5BFF",color:"#6B5BFF",borderRadius:8,padding:"6px 18px",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:"0 2px 8px #0001"},children:"← 返回"}),i.jsx("div",{style:{maxWidth:900,margin:"0 auto",padding:"80px 24px 32px"},children:i.jsxs("div",{style:{background:"#fff",borderRadius:18,boxShadow:"0 4px 24px #6B5BFF11",padding:"32px 24px"},children:[i.jsx("h2",{style:{color:"#4B5BFF",fontWeight:900,fontSize:32,marginBottom:8,letterSpacing:2,textAlign:"center"},children:"升級訂閱"}),i.jsx("p",{style:{color:"#666",fontSize:18,textAlign:"center",marginBottom:32},children:"選擇最適合您的訂閱方案，立即享有完整功能"}),i.jsx("div",{style:{display:"flex",gap:24,marginBottom:32,justifyContent:"center"},children:Object.entries(hy).map(([F,P])=>i.jsxs("div",{onClick:()=>c(F),style:{background:a===F?"#6B5BFF":"#fff",color:a===F?"#fff":"#333",border:`2px solid ${a===F?"#6B5BFF":"#ddd"}`,borderRadius:12,padding:"24px",cursor:"pointer",minWidth:200,textAlign:"center",transition:"all 0.3s ease"},children:[i.jsx("div",{style:{fontWeight:700,fontSize:20,marginBottom:8},children:P.name}),i.jsxs("div",{style:{fontSize:32,fontWeight:900,marginBottom:4},children:[P.price,i.jsx("span",{style:{fontSize:16,fontWeight:400},children:P.period})]}),P.originalPrice&&i.jsx("div",{style:{fontSize:14,textDecoration:"line-through",opacity:.7,marginBottom:4},children:P.originalPrice}),P.discount&&i.jsx("div",{style:{fontSize:14,color:"#ff6b6b",fontWeight:700},children:P.discount})]},F))}),i.jsxs("div",{style:{marginBottom:32},children:[i.jsx("h3",{style:{color:"#333",fontWeight:700,fontSize:20,marginBottom:16},children:"選擇付款方式"}),i.jsx("div",{style:{display:"flex",gap:16,flexWrap:"wrap"},children:[{key:"stripe",name:"Stripe",icon:"💳"},{key:"paypal",name:"PayPal",icon:"🔵"},{key:"ecpay",name:"綠界",icon:"🟢"},{key:"newebpay",name:"藍新",icon:"🔵"}].map(F=>i.jsxs("button",{onClick:()=>h(F.key),style:{background:d===F.key?"#6B5BFF":"#fff",color:d===F.key?"#fff":"#333",border:`2px solid ${d===F.key?"#6B5BFF":"#ddd"}`,borderRadius:8,padding:"12px 20px",cursor:"pointer",fontSize:16,fontWeight:600,transition:"all 0.3s ease"},children:[F.icon," ",F.name]},F.key))})]}),i.jsxs("div",{style:{marginBottom:32},children:[i.jsx("h3",{style:{color:"#333",fontWeight:700,fontSize:20,marginBottom:16},children:"訂閱權益"}),i.jsx("div",{style:{display:"grid",gap:12},children:hy[a].features.map((F,P)=>i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[i.jsx("span",{style:{color:"#6B5BFF",fontSize:18},children:"✓"}),i.jsx("span",{style:{color:"#333",fontSize:16},children:F})]},P))})]}),i.jsx("div",{style:{textAlign:"center",marginTop:24},children:i.jsx("button",{onClick:j,style:{background:"linear-gradient(90deg,#6B5BFF 60%,#23c6e6 100%)",color:"#fff",border:"none",borderRadius:12,fontWeight:900,fontSize:20,padding:"12px 48px",boxShadow:"0 2px 12px #6B5BFF33",letterSpacing:2,cursor:"pointer"},children:"立即升級"})}),i.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:24,marginTop:32},children:[i.jsx("button",{onClick:()=>n("/payment-info"),style:{background:"#fff",color:"#6B5BFF",border:"1.5px solid #6B5BFF",borderRadius:8,padding:"10px 32px",fontWeight:600,cursor:"pointer"},children:"付款說明"}),i.jsx("button",{onClick:()=>n("/contact"),style:{background:"#fff",color:"#6B5BFF",border:"1.5px solid #6B5BFF",borderRadius:8,padding:"10px 32px",fontWeight:600,cursor:"pointer"},children:"聯絡客服"})]})]})}),r&&i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:i.jsxs("div",{style:{background:"#fff",borderRadius:20,padding:32,maxWidth:450,textAlign:"center",boxShadow:"0 8px 32px rgba(0,0,0,0.2)"},children:[i.jsx("div",{style:{fontSize:48,marginBottom:16,color:"#6B5BFF"},children:"🎯"}),i.jsx("h3",{style:{color:"#6B5BFF",fontWeight:700,fontSize:22,marginBottom:12},children:"歡迎加入 Restarter！"}),i.jsx("p",{style:{color:"#666",marginBottom:20,lineHeight:1.5,fontSize:16},children:"註冊後即可選擇適合您的訂閱方案，開始您的重啟之旅"}),i.jsxs("div",{style:{background:"linear-gradient(135deg, #f8f9ff 0%, #e8f4ff 100%)",borderRadius:12,padding:16,marginBottom:24,border:"1px solid #e0e8ff"},children:[i.jsx("div",{style:{fontSize:14,color:"#6B5BFF",fontWeight:600,marginBottom:8},children:"💡 註冊好處"}),i.jsxs("div",{style:{fontSize:13,color:"#666",lineHeight:1.4},children:["• 免費體驗基礎功能",i.jsx("br",{}),"• 個人化使用記錄",i.jsx("br",{}),"• 安全可靠的服務"]})]}),i.jsxs("div",{style:{display:"flex",gap:12,justifyContent:"center"},children:[i.jsx("button",{onClick:()=>n("/register"),style:{background:"linear-gradient(135deg, #6B5BFF 0%, #00CFFF 100%)",color:"#fff",border:"none",borderRadius:12,padding:"12px 28px",fontWeight:700,cursor:"pointer",fontSize:16,boxShadow:"0 4px 12px #6B5BFF33",transition:"all 0.3s ease"},onMouseEnter:F=>{F.currentTarget.style.transform="translateY(-2px)",F.currentTarget.style.boxShadow="0 6px 16px #6B5BFF44"},onMouseLeave:F=>{F.currentTarget.style.transform="translateY(0)",F.currentTarget.style.boxShadow="0 4px 12px #6B5BFF33"},children:"🚀 立即註冊"}),i.jsx("button",{onClick:()=>o(!1),style:{background:"#f8f9ff",color:"#6B5BFF",border:"2px solid #6B5BFF",borderRadius:12,padding:"12px 28px",fontWeight:600,cursor:"pointer",fontSize:16,transition:"all 0.3s ease"},onMouseEnter:F=>{F.currentTarget.style.background="#6B5BFF",F.currentTarget.style.color="#fff"},onMouseLeave:F=>{F.currentTarget.style.background="#f8f9ff",F.currentTarget.style.color="#6B5BFF"},children:"💭 稍後再說"})]})]})}),m&&x&&i.jsx("div",{style:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",background:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e4},children:i.jsxs("div",{style:{background:"#fff",borderRadius:20,padding:32,maxWidth:480,width:"90%",textAlign:"center",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.2)"},children:[i.jsx("div",{style:{fontSize:64,marginBottom:16,color:"#52c41a"},children:"✅"}),i.jsx("h2",{style:{fontSize:24,fontWeight:700,color:"#333",marginBottom:12},children:"付款成功！"}),i.jsx("p",{style:{fontSize:16,color:"#666",marginBottom:20,lineHeight:1.6},children:x.message}),i.jsxs("div",{style:{background:"linear-gradient(135deg, #f6ffed 0%, #d9f7be 100%)",borderRadius:12,padding:16,marginBottom:24,border:"1px solid #b7eb8f"},children:[i.jsx("div",{style:{fontSize:14,color:"#52c41a",fontWeight:600,marginBottom:8},children:"🎉 訂閱詳情"}),i.jsxs("div",{style:{fontSize:13,color:"#666",lineHeight:1.4},children:["• 方案：",I(a),i.jsx("br",{}),"• 剩餘天數：",x.remainingDays," 天",i.jsx("br",{}),"• AI Token：",x.plan.limits.aiCostLimit,"K tokens",i.jsx("br",{}),"• 立即生效，可開始使用所有 AI 功能"]})]}),i.jsx("div",{style:{display:"flex",gap:12,justifyContent:"center"},children:i.jsx("button",{onClick:()=>n("/home"),style:{background:"linear-gradient(135deg, #52c41a 0%, #73d13d 100%)",color:"#fff",border:"none",borderRadius:12,padding:"14px 28px",fontSize:16,fontWeight:700,cursor:"pointer",flex:1,boxShadow:"0 4px 12px #52c41a33",transition:"all 0.3s ease"},onMouseEnter:F=>{F.currentTarget.style.transform="translateY(-2px)",F.currentTarget.style.boxShadow="0 6px 16px #52c41a44"},onMouseLeave:F=>{F.currentTarget.style.transform="translateY(0)",F.currentTarget.style.boxShadow="0 4px 12px #52c41a33"},children:"🚀 立即開始使用"})}),i.jsx("div",{style:{marginTop:16,fontSize:14,color:"#888"},children:"3秒後自動跳轉到首頁..."})]})})]})}function uM(){const n=Et(),t=St().currentUser;return localStorage.getItem("lang"),t?i.jsxs("div",{style:{minHeight:"100vh",background:"#f7faff",padding:0},children:[i.jsx("button",{onClick:()=>n("/"),style:{position:"absolute",top:24,left:24,zIndex:10,background:"#fff",border:"1.5px solid #6B5BFF",color:"#6B5BFF",borderRadius:8,padding:"6px 18px",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:"0 2px 8px #0001"},children:"← 返回首頁"}),i.jsxs("div",{style:{maxWidth:500,margin:"0 auto",background:"#fff",borderRadius:18,boxShadow:"0 4px 24px #6B5BFF11",padding:"32px 24px",marginTop:64,textAlign:"center"},children:[i.jsx("img",{src:t.photoURL||"/avatars/Derxl.png",alt:"avatar",style:{width:88,height:88,borderRadius:"50%",objectFit:"cover",border:"2px solid #ececff",background:"#eee",marginBottom:18}}),i.jsx("div",{style:{fontSize:24,fontWeight:900,color:"#6B5BFF",marginBottom:8},children:t.displayName||t.email||"用戶"}),i.jsx("div",{style:{fontSize:16,color:"#888",marginBottom:18},children:t.email}),i.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:18,marginTop:24},children:[i.jsx("button",{onClick:()=>n("/CompleteProfile"),style:{background:"#00CFFF",color:"#fff",fontWeight:700,fontSize:18,padding:"10px 32px",borderRadius:10,boxShadow:"0 2px 8px #00CFFF33",border:"none",cursor:"pointer"},children:"編輯個人資料"}),i.jsx("button",{onClick:()=>n("/upgrade"),style:{background:"#6B5BFF",color:"#fff",fontWeight:700,fontSize:18,padding:"10px 32px",borderRadius:10,boxShadow:"0 2px 8px #6B5BFF33",border:"none",cursor:"pointer"},children:"升級訂閱"})]})]})]}):i.jsx("div",{style:{minHeight:"100vh",background:"#f7faff",display:"flex",alignItems:"center",justifyContent:"center"},children:i.jsxs("div",{style:{background:"#fff",borderRadius:16,padding:32,boxShadow:"0 4px 24px #0002",minWidth:320,textAlign:"center"},children:[i.jsx("div",{style:{fontSize:20,fontWeight:700,color:"#6B5BFF",marginBottom:18},children:"請先註冊/登入才能進入個人中心"}),i.jsx("button",{onClick:()=>n("/register"),style:{background:"#6B5BFF",color:"#fff",border:"none",borderRadius:8,padding:"8px 32px",fontWeight:700,fontSize:18,cursor:"pointer",marginTop:8},children:"前往註冊/登入"})]})})}function dM(){const n=Et();return i.jsxs("div",{style:{minHeight:"100vh",background:"#f7faff",padding:0},children:[i.jsx("button",{onClick:()=>n("/upgrade"),style:{position:"absolute",top:24,left:24,zIndex:10,background:"#fff",border:"1.5px solid #6B5BFF",color:"#6B5BFF",borderRadius:8,padding:"6px 18px",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:"0 2px 8px #0001"},children:"← 返回"}),i.jsx("div",{style:{maxWidth:900,margin:"0 auto",padding:"80px 24px 32px"},children:i.jsxs("div",{style:{background:"#fff",borderRadius:18,boxShadow:"0 4px 24px #6B5BFF11",padding:"32px 24px"},children:[i.jsx("h2",{style:{color:"#4B5BFF",fontWeight:900,fontSize:32,marginBottom:8,letterSpacing:2,textAlign:"center"},children:"付款設定說明"}),i.jsx("p",{style:{color:"#666",fontSize:18,textAlign:"center",marginBottom:32},children:"了解如何設定付款方式與完成訂閱"}),i.jsxs("div",{style:{marginBottom:32},children:[i.jsx("h3",{style:{color:"#333",fontWeight:700,fontSize:20,marginBottom:16},children:"支援的付款方式"}),i.jsxs("div",{style:{display:"grid",gap:16},children:[i.jsxs("div",{style:{border:"1px solid #e0e7ff",borderRadius:12,padding:20},children:[i.jsx("h4",{style:{color:"#6B5BFF",fontWeight:700,fontSize:18,marginBottom:8},children:"💳 Stripe"}),i.jsx("p",{style:{color:"#666",fontSize:16,lineHeight:1.6},children:"國際信用卡支付，支援 Visa、Mastercard、American Express 等主要信用卡。"})]}),i.jsxs("div",{style:{border:"1px solid #e0e7ff",borderRadius:12,padding:20},children:[i.jsx("h4",{style:{color:"#6B5BFF",fontWeight:700,fontSize:18,marginBottom:8},children:"🔵 PayPal"}),i.jsx("p",{style:{color:"#666",fontSize:16,lineHeight:1.6},children:"國際電子錢包，支援 PayPal 帳戶或信用卡付款。"})]}),i.jsxs("div",{style:{border:"1px solid #e0e7ff",borderRadius:12,padding:20},children:[i.jsx("h4",{style:{color:"#6B5BFF",fontWeight:700,fontSize:18,marginBottom:8},children:"🟢 綠界"}),i.jsx("p",{style:{color:"#666",fontSize:16,lineHeight:1.6},children:"台灣本地支付，支援信用卡、ATM 轉帳、超商付款等。"})]}),i.jsxs("div",{style:{border:"1px solid #e0e7ff",borderRadius:12,padding:20},children:[i.jsx("h4",{style:{color:"#6B5BFF",fontWeight:700,fontSize:18,marginBottom:8},children:"🔵 藍新"}),i.jsx("p",{style:{color:"#666",fontSize:16,lineHeight:1.6},children:"台灣本地支付，支援信用卡、ATM 轉帳、超商付款等。"})]})]})]}),i.jsxs("div",{style:{marginBottom:32},children:[i.jsx("h3",{style:{color:"#333",fontWeight:700,fontSize:20,marginBottom:16},children:"付款設定步驟"}),i.jsxs("ol",{style:{fontSize:16,lineHeight:1.8,paddingLeft:24},children:[i.jsx("li",{children:"選擇您想要的訂閱方案（月費或年費）"}),i.jsx("li",{children:"選擇付款方式（Stripe、PayPal、綠界、藍新）"}),i.jsx("li",{children:"點擊「立即升級」按鈕"}),i.jsx("li",{children:"系統會導向對應的付款頁面"}),i.jsx("li",{children:"完成付款後自動升級會員權益"})]})]}),i.jsxs("div",{style:{marginBottom:32},children:[i.jsx("h3",{style:{color:"#333",fontWeight:700,fontSize:20,marginBottom:16},children:"注意事項"}),i.jsxs("ul",{style:{fontSize:16,lineHeight:1.8,paddingLeft:24},children:[i.jsx("li",{children:"付款成功後，會員權益會立即生效"}),i.jsx("li",{children:"月費方案每月自動續費，年費方案每年自動續費"}),i.jsx("li",{children:"可隨時在會員中心取消自動續費"}),i.jsx("li",{children:"如有付款問題，請聯絡客服：support@restarter.com"})]})]}),i.jsx("div",{style:{textAlign:"center",marginTop:32},children:i.jsx("button",{onClick:()=>n("/upgrade"),style:{background:"linear-gradient(90deg,#6B5BFF 60%,#23c6e6 100%)",color:"#fff",border:"none",borderRadius:12,fontWeight:900,fontSize:20,padding:"12px 48px",boxShadow:"0 2px 12px #6B5BFF33",letterSpacing:2,cursor:"pointer"},children:"返回升級頁面"})})]})})]})}function hM(){const n=Et();return i.jsxs("div",{style:{minHeight:"100vh",background:"#f7faff",padding:0},children:[i.jsx("button",{onClick:()=>n("/plans"),style:{position:"absolute",top:24,left:24,zIndex:10,background:"#fff",border:"1.5px solid #6B5BFF",color:"#6B5BFF",borderRadius:8,padding:"6px 18px",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:"0 2px 8px #0001"},children:"← 返回"}),i.jsxs("div",{style:{maxWidth:600,margin:"0 auto",background:"#fff",borderRadius:18,boxShadow:"0 4px 24px #6B5BFF11",padding:"32px 24px",marginTop:64},children:[i.jsx("h2",{style:{color:"#4B5BFF",fontWeight:900,fontSize:32,marginBottom:24,letterSpacing:1},children:"聯絡客服"}),i.jsx("div",{style:{fontSize:18,color:"#333",marginBottom:24,lineHeight:1.8},children:"如有任何問題、付款疑問、升級需求，歡迎透過以下方式聯絡我們："}),i.jsxs("ul",{style:{fontSize:17,color:"#666",marginBottom:32,marginLeft:24},children:[i.jsxs("li",{children:["Email：",i.jsx("a",{href:"mailto:support@restarter.app",style:{color:"#6B5BFF",textDecoration:"underline"},children:"support@restarter.app"})]}),i.jsxs("li",{children:["LINE 客服：",i.jsx("a",{href:"https://line.me/R/ti/p/@restarter",target:"_blank",rel:"noopener noreferrer",style:{color:"#6B5BFF",textDecoration:"underline"},children:"@restarter"})]}),i.jsxs("li",{children:["Messenger：",i.jsx("a",{href:"https://m.me/restarterapp",target:"_blank",rel:"noopener noreferrer",style:{color:"#6B5BFF",textDecoration:"underline"},children:"Restarter 粉專"})]}),i.jsxs("li",{children:["線上表單：",i.jsx("a",{href:"https://forms.gle/xxxxxx",target:"_blank",rel:"noopener noreferrer",style:{color:"#6B5BFF",textDecoration:"underline"},children:"填寫表單"})]})]}),i.jsx("div",{style:{fontSize:16,color:"#888",marginTop:24},children:"客服回覆時間：週一至週五 10:00-18:00"})]})]})}const pM=({onTestModeChange:n})=>{const[e,t]=v.useState(!1);v.useEffect(()=>{const o=localStorage.getItem("testMode")==="true";t(o),n(o)},[n]);const r=()=>{const o=!e;t(o),localStorage.setItem("testMode",o.toString()),n(o)};return i.jsxs("div",{style:{position:"fixed",top:"20px",right:"20px",zIndex:1e4,display:"flex",flexDirection:"column",alignItems:"center",gap:"8px"},children:[i.jsx("button",{onClick:r,style:{background:e?"#ff6b6b":"#4ecdc4",color:"white",border:"none",borderRadius:"8px",padding:"8px 12px",fontSize:"12px",fontWeight:"bold",cursor:"pointer",boxShadow:"0 2px 8px rgba(0,0,0,0.2)",transition:"all 0.3s ease",minWidth:"80px"},onMouseEnter:o=>{o.currentTarget.style.transform="scale(1.05)"},onMouseLeave:o=>{o.currentTarget.style.transform="scale(1)"},children:e?"測試模式 ON":"測試模式 OFF"}),e&&i.jsx("div",{style:{background:"rgba(255, 107, 107, 0.9)",color:"white",padding:"6px 10px",borderRadius:"6px",fontSize:"10px",textAlign:"center",maxWidth:"120px",lineHeight:"1.2"},children:"語音功能已解鎖"})]})},qI=Un.createContext({isTestMode:!1,setIsTestMode:()=>{}}),Bo=()=>Un.useContext(qI);function fM(){const{isMicOn:n}=MI();return n?i.jsx("div",{style:{position:"fixed",top:"12px",left:"50%",transform:"translateX(-50%)",zIndex:9999,background:"#ff6347",borderRadius:"50%",padding:"12px",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"0 4px 20px rgba(0,0,0,0.35)",border:"2px solid white"},children:i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"30",height:"30",viewBox:"0 0 24 24",fill:"white",children:i.jsx("path",{d:"M12 14c1.66 0 3-1.34 3-3V5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3zm5.3-3c0 3-2.54 5.1-5.3 5.1S6.7 14 6.7 11H5c0 3.41 2.72 6.23 6 6.72V21h2v-3.28c3.28-.49 6-3.31 6-6.72h-1.7z"})})}):null}function mM(){const[n,e]=v.useState(null),[t,r]=v.useState(!0),[o,a]=v.useState(!1),c=St(Po);return v.useEffect(()=>{const d=Ns(c,h=>{e(h),r(!1)});return()=>d()},[c]),t?i.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh",fontSize:"2rem"},children:"Loading..."}):i.jsx(DD,{children:i.jsx(e3,{children:i.jsx(E3,{children:i.jsx($N,{children:i.jsx(tE,{children:i.jsxs(qI.Provider,{value:{isTestMode:o,setIsTestMode:a},children:[i.jsx(pM,{onTestModeChange:a}),i.jsx(fM,{}),i.jsx(C3,{children:i.jsxs(XR,{children:[i.jsx(yt,{path:"/splash",element:i.jsx(nE,{})}),i.jsx(yt,{path:"/terms",element:i.jsx(ZN,{})}),i.jsx(yt,{path:"/",element:i.jsx(CS,{})}),i.jsx(yt,{path:"/home",element:i.jsx(CS,{})}),i.jsx(yt,{path:"/register",element:i.jsx(DN,{})}),i.jsx(yt,{path:"/confirm-registration",element:i.jsx(rM,{})}),n&&i.jsx(yt,{path:"/wall",element:i.jsx(WD,{})}),n&&i.jsx(yt,{path:"/echo-box",element:i.jsx(VD,{})}),n&&i.jsx(yt,{path:"/my-story",element:i.jsx(UD,{})}),n&&i.jsx(yt,{path:"/chat",element:i.jsx(_N,{})}),n&&i.jsx(yt,{path:"/friend",element:i.jsx(MN,{})}),n&&i.jsx(yt,{path:"/inbox",element:i.jsx(ON,{})}),n&&i.jsx(yt,{path:"/ai",element:i.jsx(WN,{})}),n&&i.jsx(yt,{path:"/tts",element:i.jsx(ZS,{})}),n&&i.jsx(yt,{path:"/journal",element:i.jsx(A3,{})}),n&&i.jsx(yt,{path:"/missions",element:i.jsx(tk,{})}),n&&i.jsx(yt,{path:"/restart-missions",element:i.jsx(tk,{})}),n&&i.jsx(yt,{path:"/pairtalk",element:i.jsx(QN,{})}),n&&i.jsx(yt,{path:"/skillbox",element:i.jsx(YN,{})}),n&&i.jsx(yt,{path:"/skillbox/:scenarioId",element:i.jsx(sk,{})}),n&&i.jsx(yt,{path:"/practice",element:i.jsx(sk,{})}),n&&i.jsx(yt,{path:"/realistic-tts",element:i.jsx(ZS,{})}),n&&i.jsx(yt,{path:"/storywall",element:i.jsx(T3,{})}),n&&i.jsx(yt,{path:"/chatroom",element:i.jsx(B3,{})}),n&&i.jsx(yt,{path:"/invites",element:i.jsx(sx,{})}),n&&i.jsx(yt,{path:"/mylinks",element:i.jsx(ox,{})}),i.jsx(yt,{path:"/about",element:i.jsx(z3,{})}),i.jsx(yt,{path:"/feedback",element:i.jsx(D3,{})}),i.jsx(yt,{path:"/admin/feedback",element:i.jsx(N3,{})}),i.jsx(yt,{path:"/CompleteProfile",element:i.jsx(L3,{})}),i.jsx(yt,{path:"/privacy-policy",element:i.jsx(W3,{})}),i.jsx(yt,{path:"/data-deletion",element:i.jsx(U3,{})}),i.jsx(yt,{path:"/HelpLab",element:i.jsx(G3,{})}),i.jsx(yt,{path:"/emotion-release",element:i.jsx(K3,{})}),n&&i.jsx(yt,{path:"/social-integration",element:i.jsx(tM,{})}),i.jsx(yt,{path:"/plans",element:i.jsx(aM,{})}),i.jsx(yt,{path:"/payment",element:i.jsx(lM,{})}),i.jsx(yt,{path:"/upgrade",element:i.jsx(cM,{})}),i.jsx(yt,{path:"/profile",element:i.jsx(uM,{})}),i.jsx(yt,{path:"/payment-info",element:i.jsx(dM,{})}),i.jsx(yt,{path:"/contact",element:i.jsx(hM,{})}),!1]})})]})})})})})})}const gM=rR.createRoot(document.getElementById("root"));gM.render(i.jsx(mM,{}));
