function BC(n,e){for(var t=0;t<e.length;t++){const r=e[t];if(typeof r!="string"&&!Array.isArray(r)){for(const o in r)if(o!=="default"&&!(o in n)){const a=Object.getOwnPropertyDescriptor(r,o);a&&Object.defineProperty(n,o,a.get?a:{enumerable:!0,get:()=>r[o]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const a of o)if(a.type==="childList")for(const c of a.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&r(c)}).observe(document,{childList:!0,subtree:!0});function t(o){const a={};return o.integrity&&(a.integrity=o.integrity),o.referrerPolicy&&(a.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?a.credentials="include":o.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(o){if(o.ep)return;o.ep=!0;const a=t(o);fetch(o.href,a)}})();function FC(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var Cg={exports:{}},xu={},Rg={exports:{}},kt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Gv;function zC(){if(Gv)return kt;Gv=1;var n=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),c=Symbol.for("react.context"),d=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),m=Symbol.for("react.memo"),g=Symbol.for("react.lazy"),x=Symbol.iterator;function S(D){return D===null||typeof D!="object"?null:(D=x&&D[x]||D["@@iterator"],typeof D=="function"?D:null)}var C={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},_=Object.assign,I={};function T(D,G,ie){this.props=D,this.context=G,this.refs=I,this.updater=ie||C}T.prototype.isReactComponent={},T.prototype.setState=function(D,G){if(typeof D!="object"&&typeof D!="function"&&D!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,D,G,"setState")},T.prototype.forceUpdate=function(D){this.updater.enqueueForceUpdate(this,D,"forceUpdate")};function F(){}F.prototype=T.prototype;function P(D,G,ie){this.props=D,this.context=G,this.refs=I,this.updater=ie||C}var B=P.prototype=new F;B.constructor=P,_(B,T.prototype),B.isPureReactComponent=!0;var q=Array.isArray,te=Object.prototype.hasOwnProperty,W={current:null},L={key:!0,ref:!0,__self:!0,__source:!0};function R(D,G,ie){var ee,Se={},we=null,Oe=null;if(G!=null)for(ee in G.ref!==void 0&&(Oe=G.ref),G.key!==void 0&&(we=""+G.key),G)te.call(G,ee)&&!L.hasOwnProperty(ee)&&(Se[ee]=G[ee]);var Ne=arguments.length-2;if(Ne===1)Se.children=ie;else if(1<Ne){for(var Ye=Array(Ne),it=0;it<Ne;it++)Ye[it]=arguments[it+2];Se.children=Ye}if(D&&D.defaultProps)for(ee in Ne=D.defaultProps,Ne)Se[ee]===void 0&&(Se[ee]=Ne[ee]);return{$$typeof:n,type:D,key:we,ref:Oe,props:Se,_owner:W.current}}function A(D,G){return{$$typeof:n,type:D.type,key:G,ref:D.ref,props:D.props,_owner:D._owner}}function N(D){return typeof D=="object"&&D!==null&&D.$$typeof===n}function O(D){var G={"=":"=0",":":"=2"};return"$"+D.replace(/[=:]/g,function(ie){return G[ie]})}var z=/\/+/g;function j(D,G){return typeof D=="object"&&D!==null&&D.key!=null?O(""+D.key):G.toString(36)}function V(D,G,ie,ee,Se){var we=typeof D;(we==="undefined"||we==="boolean")&&(D=null);var Oe=!1;if(D===null)Oe=!0;else switch(we){case"string":case"number":Oe=!0;break;case"object":switch(D.$$typeof){case n:case e:Oe=!0}}if(Oe)return Oe=D,Se=Se(Oe),D=ee===""?"."+j(Oe,0):ee,q(Se)?(ie="",D!=null&&(ie=D.replace(z,"$&/")+"/"),V(Se,G,ie,"",function(it){return it})):Se!=null&&(N(Se)&&(Se=A(Se,ie+(!Se.key||Oe&&Oe.key===Se.key?"":(""+Se.key).replace(z,"$&/")+"/")+D)),G.push(Se)),1;if(Oe=0,ee=ee===""?".":ee+":",q(D))for(var Ne=0;Ne<D.length;Ne++){we=D[Ne];var Ye=ee+j(we,Ne);Oe+=V(we,G,ie,Ye,Se)}else if(Ye=S(D),typeof Ye=="function")for(D=Ye.call(D),Ne=0;!(we=D.next()).done;)we=we.value,Ye=ee+j(we,Ne++),Oe+=V(we,G,ie,Ye,Se);else if(we==="object")throw G=String(D),Error("Objects are not valid as a React child (found: "+(G==="[object Object]"?"object with keys {"+Object.keys(D).join(", ")+"}":G)+"). If you meant to render a collection of children, use an array instead.");return Oe}function X(D,G,ie){if(D==null)return D;var ee=[],Se=0;return V(D,ee,"","",function(we){return G.call(ie,we,Se++)}),ee}function $(D){if(D._status===-1){var G=D._result;G=G(),G.then(function(ie){(D._status===0||D._status===-1)&&(D._status=1,D._result=ie)},function(ie){(D._status===0||D._status===-1)&&(D._status=2,D._result=ie)}),D._status===-1&&(D._status=0,D._result=G)}if(D._status===1)return D._result.default;throw D._result}var ne={current:null},oe={transition:null},J={ReactCurrentDispatcher:ne,ReactCurrentBatchConfig:oe,ReactCurrentOwner:W};function Q(){throw Error("act(...) is not supported in production builds of React.")}return kt.Children={map:X,forEach:function(D,G,ie){X(D,function(){G.apply(this,arguments)},ie)},count:function(D){var G=0;return X(D,function(){G++}),G},toArray:function(D){return X(D,function(G){return G})||[]},only:function(D){if(!N(D))throw Error("React.Children.only expected to receive a single React element child.");return D}},kt.Component=T,kt.Fragment=t,kt.Profiler=o,kt.PureComponent=P,kt.StrictMode=r,kt.Suspense=h,kt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=J,kt.act=Q,kt.cloneElement=function(D,G,ie){if(D==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+D+".");var ee=_({},D.props),Se=D.key,we=D.ref,Oe=D._owner;if(G!=null){if(G.ref!==void 0&&(we=G.ref,Oe=W.current),G.key!==void 0&&(Se=""+G.key),D.type&&D.type.defaultProps)var Ne=D.type.defaultProps;for(Ye in G)te.call(G,Ye)&&!L.hasOwnProperty(Ye)&&(ee[Ye]=G[Ye]===void 0&&Ne!==void 0?Ne[Ye]:G[Ye])}var Ye=arguments.length-2;if(Ye===1)ee.children=ie;else if(1<Ye){Ne=Array(Ye);for(var it=0;it<Ye;it++)Ne[it]=arguments[it+2];ee.children=Ne}return{$$typeof:n,type:D.type,key:Se,ref:we,props:ee,_owner:Oe}},kt.createContext=function(D){return D={$$typeof:c,_currentValue:D,_currentValue2:D,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},D.Provider={$$typeof:a,_context:D},D.Consumer=D},kt.createElement=R,kt.createFactory=function(D){var G=R.bind(null,D);return G.type=D,G},kt.createRef=function(){return{current:null}},kt.forwardRef=function(D){return{$$typeof:d,render:D}},kt.isValidElement=N,kt.lazy=function(D){return{$$typeof:g,_payload:{_status:-1,_result:D},_init:$}},kt.memo=function(D,G){return{$$typeof:m,type:D,compare:G===void 0?null:G}},kt.startTransition=function(D){var G=oe.transition;oe.transition={};try{D()}finally{oe.transition=G}},kt.unstable_act=Q,kt.useCallback=function(D,G){return ne.current.useCallback(D,G)},kt.useContext=function(D){return ne.current.useContext(D)},kt.useDebugValue=function(){},kt.useDeferredValue=function(D){return ne.current.useDeferredValue(D)},kt.useEffect=function(D,G){return ne.current.useEffect(D,G)},kt.useId=function(){return ne.current.useId()},kt.useImperativeHandle=function(D,G,ie){return ne.current.useImperativeHandle(D,G,ie)},kt.useInsertionEffect=function(D,G){return ne.current.useInsertionEffect(D,G)},kt.useLayoutEffect=function(D,G){return ne.current.useLayoutEffect(D,G)},kt.useMemo=function(D,G){return ne.current.useMemo(D,G)},kt.useReducer=function(D,G,ie){return ne.current.useReducer(D,G,ie)},kt.useRef=function(D){return ne.current.useRef(D)},kt.useState=function(D){return ne.current.useState(D)},kt.useSyncExternalStore=function(D,G,ie){return ne.current.useSyncExternalStore(D,G,ie)},kt.useTransition=function(){return ne.current.useTransition()},kt.version="18.3.1",kt}var Kv;function sx(){return Kv||(Kv=1,Rg.exports=zC()),Rg.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Qv;function DC(){if(Qv)return xu;Qv=1;var n=sx(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,o=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,a={key:!0,ref:!0,__self:!0,__source:!0};function c(d,h,m){var g,x={},S=null,C=null;m!==void 0&&(S=""+m),h.key!==void 0&&(S=""+h.key),h.ref!==void 0&&(C=h.ref);for(g in h)r.call(h,g)&&!a.hasOwnProperty(g)&&(x[g]=h[g]);if(d&&d.defaultProps)for(g in h=d.defaultProps,h)x[g]===void 0&&(x[g]=h[g]);return{$$typeof:e,type:d,key:S,ref:C,props:x,_owner:o.current}}return xu.Fragment=t,xu.jsx=c,xu.jsxs=c,xu}var Yv;function NC(){return Yv||(Yv=1,Cg.exports=DC()),Cg.exports}var i=NC(),ep={},Eg={exports:{}},wr={},Ag={exports:{}},Pg={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Xv;function MC(){return Xv||(Xv=1,function(n){function e(oe,J){var Q=oe.length;oe.push(J);e:for(;0<Q;){var D=Q-1>>>1,G=oe[D];if(0<o(G,J))oe[D]=J,oe[Q]=G,Q=D;else break e}}function t(oe){return oe.length===0?null:oe[0]}function r(oe){if(oe.length===0)return null;var J=oe[0],Q=oe.pop();if(Q!==J){oe[0]=Q;e:for(var D=0,G=oe.length,ie=G>>>1;D<ie;){var ee=2*(D+1)-1,Se=oe[ee],we=ee+1,Oe=oe[we];if(0>o(Se,Q))we<G&&0>o(Oe,Se)?(oe[D]=Oe,oe[we]=Q,D=we):(oe[D]=Se,oe[ee]=Q,D=ee);else if(we<G&&0>o(Oe,Q))oe[D]=Oe,oe[we]=Q,D=we;else break e}}return J}function o(oe,J){var Q=oe.sortIndex-J.sortIndex;return Q!==0?Q:oe.id-J.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;n.unstable_now=function(){return a.now()}}else{var c=Date,d=c.now();n.unstable_now=function(){return c.now()-d}}var h=[],m=[],g=1,x=null,S=3,C=!1,_=!1,I=!1,T=typeof setTimeout=="function"?setTimeout:null,F=typeof clearTimeout=="function"?clearTimeout:null,P=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function B(oe){for(var J=t(m);J!==null;){if(J.callback===null)r(m);else if(J.startTime<=oe)r(m),J.sortIndex=J.expirationTime,e(h,J);else break;J=t(m)}}function q(oe){if(I=!1,B(oe),!_)if(t(h)!==null)_=!0,$(te);else{var J=t(m);J!==null&&ne(q,J.startTime-oe)}}function te(oe,J){_=!1,I&&(I=!1,F(R),R=-1),C=!0;var Q=S;try{for(B(J),x=t(h);x!==null&&(!(x.expirationTime>J)||oe&&!O());){var D=x.callback;if(typeof D=="function"){x.callback=null,S=x.priorityLevel;var G=D(x.expirationTime<=J);J=n.unstable_now(),typeof G=="function"?x.callback=G:x===t(h)&&r(h),B(J)}else r(h);x=t(h)}if(x!==null)var ie=!0;else{var ee=t(m);ee!==null&&ne(q,ee.startTime-J),ie=!1}return ie}finally{x=null,S=Q,C=!1}}var W=!1,L=null,R=-1,A=5,N=-1;function O(){return!(n.unstable_now()-N<A)}function z(){if(L!==null){var oe=n.unstable_now();N=oe;var J=!0;try{J=L(!0,oe)}finally{J?j():(W=!1,L=null)}}else W=!1}var j;if(typeof P=="function")j=function(){P(z)};else if(typeof MessageChannel<"u"){var V=new MessageChannel,X=V.port2;V.port1.onmessage=z,j=function(){X.postMessage(null)}}else j=function(){T(z,0)};function $(oe){L=oe,W||(W=!0,j())}function ne(oe,J){R=T(function(){oe(n.unstable_now())},J)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(oe){oe.callback=null},n.unstable_continueExecution=function(){_||C||(_=!0,$(te))},n.unstable_forceFrameRate=function(oe){0>oe||125<oe?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):A=0<oe?Math.floor(1e3/oe):5},n.unstable_getCurrentPriorityLevel=function(){return S},n.unstable_getFirstCallbackNode=function(){return t(h)},n.unstable_next=function(oe){switch(S){case 1:case 2:case 3:var J=3;break;default:J=S}var Q=S;S=J;try{return oe()}finally{S=Q}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(oe,J){switch(oe){case 1:case 2:case 3:case 4:case 5:break;default:oe=3}var Q=S;S=oe;try{return J()}finally{S=Q}},n.unstable_scheduleCallback=function(oe,J,Q){var D=n.unstable_now();switch(typeof Q=="object"&&Q!==null?(Q=Q.delay,Q=typeof Q=="number"&&0<Q?D+Q:D):Q=D,oe){case 1:var G=-1;break;case 2:G=250;break;case 5:G=1073741823;break;case 4:G=1e4;break;default:G=5e3}return G=Q+G,oe={id:g++,callback:J,priorityLevel:oe,startTime:Q,expirationTime:G,sortIndex:-1},Q>D?(oe.sortIndex=Q,e(m,oe),t(h)===null&&oe===t(m)&&(I?(F(R),R=-1):I=!0,ne(q,Q-D))):(oe.sortIndex=G,e(h,oe),_||C||(_=!0,$(te))),oe},n.unstable_shouldYield=O,n.unstable_wrapCallback=function(oe){var J=S;return function(){var Q=S;S=J;try{return oe.apply(this,arguments)}finally{S=Q}}}}(Pg)),Pg}var Jv;function LC(){return Jv||(Jv=1,Ag.exports=MC()),Ag.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Zv;function OC(){if(Zv)return wr;Zv=1;var n=sx(),e=LC();function t(s){for(var l="https://reactjs.org/docs/error-decoder.html?invariant="+s,u=1;u<arguments.length;u++)l+="&args[]="+encodeURIComponent(arguments[u]);return"Minified React error #"+s+"; visit "+l+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var r=new Set,o={};function a(s,l){c(s,l),c(s+"Capture",l)}function c(s,l){for(o[s]=l,s=0;s<l.length;s++)r.add(l[s])}var d=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),h=Object.prototype.hasOwnProperty,m=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,g={},x={};function S(s){return h.call(x,s)?!0:h.call(g,s)?!1:m.test(s)?x[s]=!0:(g[s]=!0,!1)}function C(s,l,u,f){if(u!==null&&u.type===0)return!1;switch(typeof l){case"function":case"symbol":return!0;case"boolean":return f?!1:u!==null?!u.acceptsBooleans:(s=s.toLowerCase().slice(0,5),s!=="data-"&&s!=="aria-");default:return!1}}function _(s,l,u,f){if(l===null||typeof l>"u"||C(s,l,u,f))return!0;if(f)return!1;if(u!==null)switch(u.type){case 3:return!l;case 4:return l===!1;case 5:return isNaN(l);case 6:return isNaN(l)||1>l}return!1}function I(s,l,u,f,y,w,E){this.acceptsBooleans=l===2||l===3||l===4,this.attributeName=f,this.attributeNamespace=y,this.mustUseProperty=u,this.propertyName=s,this.type=l,this.sanitizeURL=w,this.removeEmptyString=E}var T={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(s){T[s]=new I(s,0,!1,s,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(s){var l=s[0];T[l]=new I(l,1,!1,s[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(s){T[s]=new I(s,2,!1,s.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(s){T[s]=new I(s,2,!1,s,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(s){T[s]=new I(s,3,!1,s.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(s){T[s]=new I(s,3,!0,s,null,!1,!1)}),["capture","download"].forEach(function(s){T[s]=new I(s,4,!1,s,null,!1,!1)}),["cols","rows","size","span"].forEach(function(s){T[s]=new I(s,6,!1,s,null,!1,!1)}),["rowSpan","start"].forEach(function(s){T[s]=new I(s,5,!1,s.toLowerCase(),null,!1,!1)});var F=/[\-:]([a-z])/g;function P(s){return s[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(s){var l=s.replace(F,P);T[l]=new I(l,1,!1,s,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(s){var l=s.replace(F,P);T[l]=new I(l,1,!1,s,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(s){var l=s.replace(F,P);T[l]=new I(l,1,!1,s,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(s){T[s]=new I(s,1,!1,s.toLowerCase(),null,!1,!1)}),T.xlinkHref=new I("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(s){T[s]=new I(s,1,!1,s.toLowerCase(),null,!0,!0)});function B(s,l,u,f){var y=T.hasOwnProperty(l)?T[l]:null;(y!==null?y.type!==0:f||!(2<l.length)||l[0]!=="o"&&l[0]!=="O"||l[1]!=="n"&&l[1]!=="N")&&(_(l,u,y,f)&&(u=null),f||y===null?S(l)&&(u===null?s.removeAttribute(l):s.setAttribute(l,""+u)):y.mustUseProperty?s[y.propertyName]=u===null?y.type===3?!1:"":u:(l=y.attributeName,f=y.attributeNamespace,u===null?s.removeAttribute(l):(y=y.type,u=y===3||y===4&&u===!0?"":""+u,f?s.setAttributeNS(f,l,u):s.setAttribute(l,u))))}var q=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,te=Symbol.for("react.element"),W=Symbol.for("react.portal"),L=Symbol.for("react.fragment"),R=Symbol.for("react.strict_mode"),A=Symbol.for("react.profiler"),N=Symbol.for("react.provider"),O=Symbol.for("react.context"),z=Symbol.for("react.forward_ref"),j=Symbol.for("react.suspense"),V=Symbol.for("react.suspense_list"),X=Symbol.for("react.memo"),$=Symbol.for("react.lazy"),ne=Symbol.for("react.offscreen"),oe=Symbol.iterator;function J(s){return s===null||typeof s!="object"?null:(s=oe&&s[oe]||s["@@iterator"],typeof s=="function"?s:null)}var Q=Object.assign,D;function G(s){if(D===void 0)try{throw Error()}catch(u){var l=u.stack.trim().match(/\n( *(at )?)/);D=l&&l[1]||""}return`
`+D+s}var ie=!1;function ee(s,l){if(!s||ie)return"";ie=!0;var u=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(l)if(l=function(){throw Error()},Object.defineProperty(l.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(l,[])}catch(ge){var f=ge}Reflect.construct(s,[],l)}else{try{l.call()}catch(ge){f=ge}s.call(l.prototype)}else{try{throw Error()}catch(ge){f=ge}s()}}catch(ge){if(ge&&f&&typeof ge.stack=="string"){for(var y=ge.stack.split(`
`),w=f.stack.split(`
`),E=y.length-1,U=w.length-1;1<=E&&0<=U&&y[E]!==w[U];)U--;for(;1<=E&&0<=U;E--,U--)if(y[E]!==w[U]){if(E!==1||U!==1)do if(E--,U--,0>U||y[E]!==w[U]){var Y=`
`+y[E].replace(" at new "," at ");return s.displayName&&Y.includes("<anonymous>")&&(Y=Y.replace("<anonymous>",s.displayName)),Y}while(1<=E&&0<=U);break}}}finally{ie=!1,Error.prepareStackTrace=u}return(s=s?s.displayName||s.name:"")?G(s):""}function Se(s){switch(s.tag){case 5:return G(s.type);case 16:return G("Lazy");case 13:return G("Suspense");case 19:return G("SuspenseList");case 0:case 2:case 15:return s=ee(s.type,!1),s;case 11:return s=ee(s.type.render,!1),s;case 1:return s=ee(s.type,!0),s;default:return""}}function we(s){if(s==null)return null;if(typeof s=="function")return s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case L:return"Fragment";case W:return"Portal";case A:return"Profiler";case R:return"StrictMode";case j:return"Suspense";case V:return"SuspenseList"}if(typeof s=="object")switch(s.$$typeof){case O:return(s.displayName||"Context")+".Consumer";case N:return(s._context.displayName||"Context")+".Provider";case z:var l=s.render;return s=s.displayName,s||(s=l.displayName||l.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case X:return l=s.displayName||null,l!==null?l:we(s.type)||"Memo";case $:l=s._payload,s=s._init;try{return we(s(l))}catch{}}return null}function Oe(s){var l=s.type;switch(s.tag){case 24:return"Cache";case 9:return(l.displayName||"Context")+".Consumer";case 10:return(l._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return s=l.render,s=s.displayName||s.name||"",l.displayName||(s!==""?"ForwardRef("+s+")":"ForwardRef");case 7:return"Fragment";case 5:return l;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return we(l);case 8:return l===R?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof l=="function")return l.displayName||l.name||null;if(typeof l=="string")return l}return null}function Ne(s){switch(typeof s){case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function Ye(s){var l=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(l==="checkbox"||l==="radio")}function it(s){var l=Ye(s)?"checked":"value",u=Object.getOwnPropertyDescriptor(s.constructor.prototype,l),f=""+s[l];if(!s.hasOwnProperty(l)&&typeof u<"u"&&typeof u.get=="function"&&typeof u.set=="function"){var y=u.get,w=u.set;return Object.defineProperty(s,l,{configurable:!0,get:function(){return y.call(this)},set:function(E){f=""+E,w.call(this,E)}}),Object.defineProperty(s,l,{enumerable:u.enumerable}),{getValue:function(){return f},setValue:function(E){f=""+E},stopTracking:function(){s._valueTracker=null,delete s[l]}}}}function me(s){s._valueTracker||(s._valueTracker=it(s))}function Ve(s){if(!s)return!1;var l=s._valueTracker;if(!l)return!0;var u=l.getValue(),f="";return s&&(f=Ye(s)?s.checked?"true":"false":s.value),s=f,s!==u?(l.setValue(s),!0):!1}function Xe(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}function Je(s,l){var u=l.checked;return Q({},l,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:u??s._wrapperState.initialChecked})}function He(s,l){var u=l.defaultValue==null?"":l.defaultValue,f=l.checked!=null?l.checked:l.defaultChecked;u=Ne(l.value!=null?l.value:u),s._wrapperState={initialChecked:f,initialValue:u,controlled:l.type==="checkbox"||l.type==="radio"?l.checked!=null:l.value!=null}}function fe(s,l){l=l.checked,l!=null&&B(s,"checked",l,!1)}function Te(s,l){fe(s,l);var u=Ne(l.value),f=l.type;if(u!=null)f==="number"?(u===0&&s.value===""||s.value!=u)&&(s.value=""+u):s.value!==""+u&&(s.value=""+u);else if(f==="submit"||f==="reset"){s.removeAttribute("value");return}l.hasOwnProperty("value")?Fe(s,l.type,u):l.hasOwnProperty("defaultValue")&&Fe(s,l.type,Ne(l.defaultValue)),l.checked==null&&l.defaultChecked!=null&&(s.defaultChecked=!!l.defaultChecked)}function _e(s,l,u){if(l.hasOwnProperty("value")||l.hasOwnProperty("defaultValue")){var f=l.type;if(!(f!=="submit"&&f!=="reset"||l.value!==void 0&&l.value!==null))return;l=""+s._wrapperState.initialValue,u||l===s.value||(s.value=l),s.defaultValue=l}u=s.name,u!==""&&(s.name=""),s.defaultChecked=!!s._wrapperState.initialChecked,u!==""&&(s.name=u)}function Fe(s,l,u){(l!=="number"||Xe(s.ownerDocument)!==s)&&(u==null?s.defaultValue=""+s._wrapperState.initialValue:s.defaultValue!==""+u&&(s.defaultValue=""+u))}var Be=Array.isArray;function K(s,l,u,f){if(s=s.options,l){l={};for(var y=0;y<u.length;y++)l["$"+u[y]]=!0;for(u=0;u<s.length;u++)y=l.hasOwnProperty("$"+s[u].value),s[u].selected!==y&&(s[u].selected=y),y&&f&&(s[u].defaultSelected=!0)}else{for(u=""+Ne(u),l=null,y=0;y<s.length;y++){if(s[y].value===u){s[y].selected=!0,f&&(s[y].defaultSelected=!0);return}l!==null||s[y].disabled||(l=s[y])}l!==null&&(l.selected=!0)}}function re(s,l){if(l.dangerouslySetInnerHTML!=null)throw Error(t(91));return Q({},l,{value:void 0,defaultValue:void 0,children:""+s._wrapperState.initialValue})}function H(s,l){var u=l.value;if(u==null){if(u=l.children,l=l.defaultValue,u!=null){if(l!=null)throw Error(t(92));if(Be(u)){if(1<u.length)throw Error(t(93));u=u[0]}l=u}l==null&&(l=""),u=l}s._wrapperState={initialValue:Ne(u)}}function Ue(s,l){var u=Ne(l.value),f=Ne(l.defaultValue);u!=null&&(u=""+u,u!==s.value&&(s.value=u),l.defaultValue==null&&s.defaultValue!==u&&(s.defaultValue=u)),f!=null&&(s.defaultValue=""+f)}function ue(s){var l=s.textContent;l===s._wrapperState.initialValue&&l!==""&&l!==null&&(s.value=l)}function le(s){switch(s){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Re(s,l){return s==null||s==="http://www.w3.org/1999/xhtml"?le(l):s==="http://www.w3.org/2000/svg"&&l==="foreignObject"?"http://www.w3.org/1999/xhtml":s}var rt,xe=function(s){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(l,u,f,y){MSApp.execUnsafeLocalFunction(function(){return s(l,u,f,y)})}:s}(function(s,l){if(s.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in s)s.innerHTML=l;else{for(rt=rt||document.createElement("div"),rt.innerHTML="<svg>"+l.valueOf().toString()+"</svg>",l=rt.firstChild;s.firstChild;)s.removeChild(s.firstChild);for(;l.firstChild;)s.appendChild(l.firstChild)}});function Ae(s,l){if(l){var u=s.firstChild;if(u&&u===s.lastChild&&u.nodeType===3){u.nodeValue=l;return}}s.textContent=l}var Ge={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},ft=["Webkit","ms","Moz","O"];Object.keys(Ge).forEach(function(s){ft.forEach(function(l){l=l+s.charAt(0).toUpperCase()+s.substring(1),Ge[l]=Ge[s]})});function ke(s,l,u){return l==null||typeof l=="boolean"||l===""?"":u||typeof l!="number"||l===0||Ge.hasOwnProperty(s)&&Ge[s]?(""+l).trim():l+"px"}function at(s,l){s=s.style;for(var u in l)if(l.hasOwnProperty(u)){var f=u.indexOf("--")===0,y=ke(u,l[u],f);u==="float"&&(u="cssFloat"),f?s.setProperty(u,y):s[u]=y}}var pe=Q({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function de(s,l){if(l){if(pe[s]&&(l.children!=null||l.dangerouslySetInnerHTML!=null))throw Error(t(137,s));if(l.dangerouslySetInnerHTML!=null){if(l.children!=null)throw Error(t(60));if(typeof l.dangerouslySetInnerHTML!="object"||!("__html"in l.dangerouslySetInnerHTML))throw Error(t(61))}if(l.style!=null&&typeof l.style!="object")throw Error(t(62))}}function De(s,l){if(s.indexOf("-")===-1)return typeof l.is=="string";switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var $e=null;function lt(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var pt=null,bt=null,gt=null;function Et(s){if(s=ru(s)){if(typeof pt!="function")throw Error(t(280));var l=s.stateNode;l&&(l=mh(l),pt(s.stateNode,s.type,l))}}function Nt(s){bt?gt?gt.push(s):gt=[s]:bt=s}function rn(){if(bt){var s=bt,l=gt;if(gt=bt=null,Et(s),l)for(s=0;s<l.length;s++)Et(l[s])}}function on(s,l){return s(l)}function Vr(){}var Ur=!1;function Po(s,l,u){if(Ur)return s(l,u);Ur=!0;try{return on(s,l,u)}finally{Ur=!1,(bt!==null||gt!==null)&&(Vr(),rn())}}function sn(s,l){var u=s.stateNode;if(u===null)return null;var f=mh(u);if(f===null)return null;u=f[l];e:switch(l){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(f=!f.disabled)||(s=s.type,f=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!f;break e;default:s=!1}if(s)return null;if(u&&typeof u!="function")throw Error(t(231,l,typeof u));return u}var Gi=!1;if(d)try{var pr={};Object.defineProperty(pr,"passive",{get:function(){Gi=!0}}),window.addEventListener("test",pr,pr),window.removeEventListener("test",pr,pr)}catch{Gi=!1}function bi(s,l,u,f,y,w,E,U,Y){var ge=Array.prototype.slice.call(arguments,3);try{l.apply(u,ge)}catch(Ee){this.onError(Ee)}}var vi=!1,mt=null,sr=!1,Ki=null,Nc={onError:function(s){vi=!0,mt=s}};function Ha(s,l,u,f,y,w,E,U,Y){vi=!1,mt=null,bi.apply(Nc,arguments)}function Od(s,l,u,f,y,w,E,U,Y){if(Ha.apply(this,arguments),vi){if(vi){var ge=mt;vi=!1,mt=null}else throw Error(t(198));sr||(sr=!0,Ki=ge)}}function ei(s){var l=s,u=s;if(s.alternate)for(;l.return;)l=l.return;else{s=l;do l=s,(l.flags&4098)!==0&&(u=l.return),s=l.return;while(s)}return l.tag===3?u:null}function Os(s){if(s.tag===13){var l=s.memoizedState;if(l===null&&(s=s.alternate,s!==null&&(l=s.memoizedState)),l!==null)return l.dehydrated}return null}function ti(s){if(ei(s)!==s)throw Error(t(188))}function Wd(s){var l=s.alternate;if(!l){if(l=ei(s),l===null)throw Error(t(188));return l!==s?null:s}for(var u=s,f=l;;){var y=u.return;if(y===null)break;var w=y.alternate;if(w===null){if(f=y.return,f!==null){u=f;continue}break}if(y.child===w.child){for(w=y.child;w;){if(w===u)return ti(y),s;if(w===f)return ti(y),l;w=w.sibling}throw Error(t(188))}if(u.return!==f.return)u=y,f=w;else{for(var E=!1,U=y.child;U;){if(U===u){E=!0,u=y,f=w;break}if(U===f){E=!0,f=y,u=w;break}U=U.sibling}if(!E){for(U=w.child;U;){if(U===u){E=!0,u=w,f=y;break}if(U===f){E=!0,f=w,u=y;break}U=U.sibling}if(!E)throw Error(t(189))}}if(u.alternate!==f)throw Error(t(190))}if(u.tag!==3)throw Error(t(188));return u.stateNode.current===u?s:l}function Mc(s){return s=Wd(s),s!==null?$a(s):null}function $a(s){if(s.tag===5||s.tag===6)return s;for(s=s.child;s!==null;){var l=$a(s);if(l!==null)return l;s=s.sibling}return null}var Ga=e.unstable_scheduleCallback,Lc=e.unstable_cancelCallback,Vd=e.unstable_shouldYield,rm=e.unstable_requestPaint,Kt=e.unstable_now,Ud=e.unstable_getCurrentPriorityLevel,Ws=e.unstable_ImmediatePriority,Bo=e.unstable_UserBlockingPriority,qr=e.unstable_NormalPriority,Oc=e.unstable_LowPriority,qd=e.unstable_IdlePriority,Vs=null,Er=null;function Hd(s){if(Er&&typeof Er.onCommitFiberRoot=="function")try{Er.onCommitFiberRoot(Vs,s,void 0,(s.current.flags&128)===128)}catch{}}var ar=Math.clz32?Math.clz32:Gd,Wc=Math.log,$d=Math.LN2;function Gd(s){return s>>>=0,s===0?32:31-(Wc(s)/$d|0)|0}var Ka=64,Qa=4194304;function Fo(s){switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return s&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return s}}function Us(s,l){var u=s.pendingLanes;if(u===0)return 0;var f=0,y=s.suspendedLanes,w=s.pingedLanes,E=u&268435455;if(E!==0){var U=E&~y;U!==0?f=Fo(U):(w&=E,w!==0&&(f=Fo(w)))}else E=u&~y,E!==0?f=Fo(E):w!==0&&(f=Fo(w));if(f===0)return 0;if(l!==0&&l!==f&&(l&y)===0&&(y=f&-f,w=l&-l,y>=w||y===16&&(w&4194240)!==0))return l;if((f&4)!==0&&(f|=u&16),l=s.entangledLanes,l!==0)for(s=s.entanglements,l&=f;0<l;)u=31-ar(l),y=1<<u,f|=s[u],l&=~y;return f}function im(s,l){switch(s){case 1:case 2:case 4:return l+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return l+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Qi(s,l){for(var u=s.suspendedLanes,f=s.pingedLanes,y=s.expirationTimes,w=s.pendingLanes;0<w;){var E=31-ar(w),U=1<<E,Y=y[E];Y===-1?((U&u)===0||(U&f)!==0)&&(y[E]=im(U,l)):Y<=l&&(s.expiredLanes|=U),w&=~U}}function Ar(s){return s=s.pendingLanes&-1073741825,s!==0?s:s&1073741824?1073741824:0}function qs(){var s=Ka;return Ka<<=1,(Ka&4194240)===0&&(Ka=64),s}function zo(s){for(var l=[],u=0;31>u;u++)l.push(s);return l}function Do(s,l,u){s.pendingLanes|=l,l!==536870912&&(s.suspendedLanes=0,s.pingedLanes=0),s=s.eventTimes,l=31-ar(l),s[l]=u}function Ht(s,l){var u=s.pendingLanes&~l;s.pendingLanes=l,s.suspendedLanes=0,s.pingedLanes=0,s.expiredLanes&=l,s.mutableReadLanes&=l,s.entangledLanes&=l,l=s.entanglements;var f=s.eventTimes;for(s=s.expirationTimes;0<u;){var y=31-ar(u),w=1<<y;l[y]=0,f[y]=-1,s[y]=-1,u&=~w}}function No(s,l){var u=s.entangledLanes|=l;for(s=s.entanglements;u;){var f=31-ar(u),y=1<<f;y&l|s[f]&l&&(s[f]|=l),u&=~y}}var Rt=0;function Mo(s){return s&=-s,1<s?4<s?(s&268435455)!==0?16:536870912:4:1}var Kd,Ya,Qd,Yd,Xd,Vc=!1,wi=[],Hn=null,ni=null,ri=null,Lo=new Map,Hr=new Map,Si=[],om="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Jd(s,l){switch(s){case"focusin":case"focusout":Hn=null;break;case"dragenter":case"dragleave":ni=null;break;case"mouseover":case"mouseout":ri=null;break;case"pointerover":case"pointerout":Lo.delete(l.pointerId);break;case"gotpointercapture":case"lostpointercapture":Hr.delete(l.pointerId)}}function fr(s,l,u,f,y,w){return s===null||s.nativeEvent!==w?(s={blockedOn:l,domEventName:u,eventSystemFlags:f,nativeEvent:w,targetContainers:[y]},l!==null&&(l=ru(l),l!==null&&Ya(l)),s):(s.eventSystemFlags|=f,l=s.targetContainers,y!==null&&l.indexOf(y)===-1&&l.push(y),s)}function sm(s,l,u,f,y){switch(l){case"focusin":return Hn=fr(Hn,s,l,u,f,y),!0;case"dragenter":return ni=fr(ni,s,l,u,f,y),!0;case"mouseover":return ri=fr(ri,s,l,u,f,y),!0;case"pointerover":var w=y.pointerId;return Lo.set(w,fr(Lo.get(w)||null,s,l,u,f,y)),!0;case"gotpointercapture":return w=y.pointerId,Hr.set(w,fr(Hr.get(w)||null,s,l,u,f,y)),!0}return!1}function Zd(s){var l=Qs(s.target);if(l!==null){var u=ei(l);if(u!==null){if(l=u.tag,l===13){if(l=Os(u),l!==null){s.blockedOn=l,Xd(s.priority,function(){Qd(u)});return}}else if(l===3&&u.stateNode.current.memoizedState.isDehydrated){s.blockedOn=u.tag===3?u.stateNode.containerInfo:null;return}}}s.blockedOn=null}function Yi(s){if(s.blockedOn!==null)return!1;for(var l=s.targetContainers;0<l.length;){var u=Xa(s.domEventName,s.eventSystemFlags,l[0],s.nativeEvent);if(u===null){u=s.nativeEvent;var f=new u.constructor(u.type,u);$e=f,u.target.dispatchEvent(f),$e=null}else return l=ru(u),l!==null&&Ya(l),s.blockedOn=u,!1;l.shift()}return!0}function Hs(s,l,u){Yi(s)&&u.delete(l)}function eh(){Vc=!1,Hn!==null&&Yi(Hn)&&(Hn=null),ni!==null&&Yi(ni)&&(ni=null),ri!==null&&Yi(ri)&&(ri=null),Lo.forEach(Hs),Hr.forEach(Hs)}function ii(s,l){s.blockedOn===l&&(s.blockedOn=null,Vc||(Vc=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,eh)))}function oi(s){function l(y){return ii(y,s)}if(0<wi.length){ii(wi[0],s);for(var u=1;u<wi.length;u++){var f=wi[u];f.blockedOn===s&&(f.blockedOn=null)}}for(Hn!==null&&ii(Hn,s),ni!==null&&ii(ni,s),ri!==null&&ii(ri,s),Lo.forEach(l),Hr.forEach(l),u=0;u<Si.length;u++)f=Si[u],f.blockedOn===s&&(f.blockedOn=null);for(;0<Si.length&&(u=Si[0],u.blockedOn===null);)Zd(u),u.blockedOn===null&&Si.shift()}var Xi=q.ReactCurrentBatchConfig,Oo=!0;function an(s,l,u,f){var y=Rt,w=Xi.transition;Xi.transition=null;try{Rt=1,Uc(s,l,u,f)}finally{Rt=y,Xi.transition=w}}function am(s,l,u,f){var y=Rt,w=Xi.transition;Xi.transition=null;try{Rt=4,Uc(s,l,u,f)}finally{Rt=y,Xi.transition=w}}function Uc(s,l,u,f){if(Oo){var y=Xa(s,l,u,f);if(y===null)xm(s,l,f,$s,u),Jd(s,f);else if(sm(y,s,l,u,f))f.stopPropagation();else if(Jd(s,f),l&4&&-1<om.indexOf(s)){for(;y!==null;){var w=ru(y);if(w!==null&&Kd(w),w=Xa(s,l,u,f),w===null&&xm(s,l,f,$s,u),w===y)break;y=w}y!==null&&f.stopPropagation()}else xm(s,l,f,null,u)}}var $s=null;function Xa(s,l,u,f){if($s=null,s=lt(f),s=Qs(s),s!==null)if(l=ei(s),l===null)s=null;else if(u=l.tag,u===13){if(s=Os(l),s!==null)return s;s=null}else if(u===3){if(l.stateNode.current.memoizedState.isDehydrated)return l.tag===3?l.stateNode.containerInfo:null;s=null}else l!==s&&(s=null);return $s=s,null}function qc(s){switch(s){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Ud()){case Ws:return 1;case Bo:return 4;case qr:case Oc:return 16;case qd:return 536870912;default:return 16}default:return 16}}var Pr=null,Ja=null,mr=null;function Hc(){if(mr)return mr;var s,l=Ja,u=l.length,f,y="value"in Pr?Pr.value:Pr.textContent,w=y.length;for(s=0;s<u&&l[s]===y[s];s++);var E=u-s;for(f=1;f<=E&&l[u-f]===y[w-f];f++);return mr=y.slice(s,1<f?1-f:void 0)}function Za(s){var l=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&l===13&&(s=13)):s=l,s===10&&(s=13),32<=s||s===13?s:0}function ki(){return!0}function $c(){return!1}function $n(s){function l(u,f,y,w,E){this._reactName=u,this._targetInst=y,this.type=f,this.nativeEvent=w,this.target=E,this.currentTarget=null;for(var U in s)s.hasOwnProperty(U)&&(u=s[U],this[U]=u?u(w):w[U]);return this.isDefaultPrevented=(w.defaultPrevented!=null?w.defaultPrevented:w.returnValue===!1)?ki:$c,this.isPropagationStopped=$c,this}return Q(l.prototype,{preventDefault:function(){this.defaultPrevented=!0;var u=this.nativeEvent;u&&(u.preventDefault?u.preventDefault():typeof u.returnValue!="unknown"&&(u.returnValue=!1),this.isDefaultPrevented=ki)},stopPropagation:function(){var u=this.nativeEvent;u&&(u.stopPropagation?u.stopPropagation():typeof u.cancelBubble!="unknown"&&(u.cancelBubble=!0),this.isPropagationStopped=ki)},persist:function(){},isPersistent:ki}),l}var si={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},el=$n(si),Ti=Q({},si,{view:0,detail:0}),lm=$n(Ti),tl,Ji,Wo,Gs=Q({},Ti,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:_i,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==Wo&&(Wo&&s.type==="mousemove"?(tl=s.screenX-Wo.screenX,Ji=s.screenY-Wo.screenY):Ji=tl=0,Wo=s),tl)},movementY:function(s){return"movementY"in s?s.movementY:Ji}}),nl=$n(Gs),Gc=Q({},Gs,{dataTransfer:0}),th=$n(Gc),rl=Q({},Ti,{relatedTarget:0}),il=$n(rl),nh=Q({},si,{animationName:0,elapsedTime:0,pseudoElement:0}),Zi=$n(nh),rh=Q({},si,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),ih=$n(rh),oh=Q({},si,{data:0}),Kc=$n(oh),ol={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},lr={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},sh={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function ah(s){var l=this.nativeEvent;return l.getModifierState?l.getModifierState(s):(s=sh[s])?!!l[s]:!1}function _i(){return ah}var p=Q({},Ti,{key:function(s){if(s.key){var l=ol[s.key]||s.key;if(l!=="Unidentified")return l}return s.type==="keypress"?(s=Za(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?lr[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:_i,charCode:function(s){return s.type==="keypress"?Za(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?Za(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),b=$n(p),k=Q({},Gs,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),M=$n(k),ae=Q({},Ti,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:_i}),be=$n(ae),Me=Q({},si,{propertyName:0,elapsedTime:0,pseudoElement:0}),Ot=$n(Me),_n=Q({},Gs,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),At=$n(_n),zn=[9,13,27,32],Sn=d&&"CompositionEvent"in window,$r=null;d&&"documentMode"in document&&($r=document.documentMode);var Br=d&&"TextEvent"in window&&!$r,Ks=d&&(!Sn||$r&&8<$r&&11>=$r),sl=" ",W0=!1;function V0(s,l){switch(s){case"keyup":return zn.indexOf(l.keyCode)!==-1;case"keydown":return l.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function U0(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var al=!1;function EI(s,l){switch(s){case"compositionend":return U0(l);case"keypress":return l.which!==32?null:(W0=!0,sl);case"textInput":return s=l.data,s===sl&&W0?null:s;default:return null}}function AI(s,l){if(al)return s==="compositionend"||!Sn&&V0(s,l)?(s=Hc(),mr=Ja=Pr=null,al=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(l.ctrlKey||l.altKey||l.metaKey)||l.ctrlKey&&l.altKey){if(l.char&&1<l.char.length)return l.char;if(l.which)return String.fromCharCode(l.which)}return null;case"compositionend":return Ks&&l.locale!=="ko"?null:l.data;default:return null}}var PI={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function q0(s){var l=s&&s.nodeName&&s.nodeName.toLowerCase();return l==="input"?!!PI[s.type]:l==="textarea"}function H0(s,l,u,f){Nt(f),l=hh(l,"onChange"),0<l.length&&(u=new el("onChange","change",null,u,f),s.push({event:u,listeners:l}))}var Qc=null,Yc=null;function BI(s){cb(s,0)}function lh(s){var l=hl(s);if(Ve(l))return s}function FI(s,l){if(s==="change")return l}var $0=!1;if(d){var cm;if(d){var um="oninput"in document;if(!um){var G0=document.createElement("div");G0.setAttribute("oninput","return;"),um=typeof G0.oninput=="function"}cm=um}else cm=!1;$0=cm&&(!document.documentMode||9<document.documentMode)}function K0(){Qc&&(Qc.detachEvent("onpropertychange",Q0),Yc=Qc=null)}function Q0(s){if(s.propertyName==="value"&&lh(Yc)){var l=[];H0(l,Yc,s,lt(s)),Po(BI,l)}}function zI(s,l,u){s==="focusin"?(K0(),Qc=l,Yc=u,Qc.attachEvent("onpropertychange",Q0)):s==="focusout"&&K0()}function DI(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return lh(Yc)}function NI(s,l){if(s==="click")return lh(l)}function MI(s,l){if(s==="input"||s==="change")return lh(l)}function LI(s,l){return s===l&&(s!==0||1/s===1/l)||s!==s&&l!==l}var ai=typeof Object.is=="function"?Object.is:LI;function Xc(s,l){if(ai(s,l))return!0;if(typeof s!="object"||s===null||typeof l!="object"||l===null)return!1;var u=Object.keys(s),f=Object.keys(l);if(u.length!==f.length)return!1;for(f=0;f<u.length;f++){var y=u[f];if(!h.call(l,y)||!ai(s[y],l[y]))return!1}return!0}function Y0(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function X0(s,l){var u=Y0(s);s=0;for(var f;u;){if(u.nodeType===3){if(f=s+u.textContent.length,s<=l&&f>=l)return{node:u,offset:l-s};s=f}e:{for(;u;){if(u.nextSibling){u=u.nextSibling;break e}u=u.parentNode}u=void 0}u=Y0(u)}}function J0(s,l){return s&&l?s===l?!0:s&&s.nodeType===3?!1:l&&l.nodeType===3?J0(s,l.parentNode):"contains"in s?s.contains(l):s.compareDocumentPosition?!!(s.compareDocumentPosition(l)&16):!1:!1}function Z0(){for(var s=window,l=Xe();l instanceof s.HTMLIFrameElement;){try{var u=typeof l.contentWindow.location.href=="string"}catch{u=!1}if(u)s=l.contentWindow;else break;l=Xe(s.document)}return l}function dm(s){var l=s&&s.nodeName&&s.nodeName.toLowerCase();return l&&(l==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||l==="textarea"||s.contentEditable==="true")}function OI(s){var l=Z0(),u=s.focusedElem,f=s.selectionRange;if(l!==u&&u&&u.ownerDocument&&J0(u.ownerDocument.documentElement,u)){if(f!==null&&dm(u)){if(l=f.start,s=f.end,s===void 0&&(s=l),"selectionStart"in u)u.selectionStart=l,u.selectionEnd=Math.min(s,u.value.length);else if(s=(l=u.ownerDocument||document)&&l.defaultView||window,s.getSelection){s=s.getSelection();var y=u.textContent.length,w=Math.min(f.start,y);f=f.end===void 0?w:Math.min(f.end,y),!s.extend&&w>f&&(y=f,f=w,w=y),y=X0(u,w);var E=X0(u,f);y&&E&&(s.rangeCount!==1||s.anchorNode!==y.node||s.anchorOffset!==y.offset||s.focusNode!==E.node||s.focusOffset!==E.offset)&&(l=l.createRange(),l.setStart(y.node,y.offset),s.removeAllRanges(),w>f?(s.addRange(l),s.extend(E.node,E.offset)):(l.setEnd(E.node,E.offset),s.addRange(l)))}}for(l=[],s=u;s=s.parentNode;)s.nodeType===1&&l.push({element:s,left:s.scrollLeft,top:s.scrollTop});for(typeof u.focus=="function"&&u.focus(),u=0;u<l.length;u++)s=l[u],s.element.scrollLeft=s.left,s.element.scrollTop=s.top}}var WI=d&&"documentMode"in document&&11>=document.documentMode,ll=null,hm=null,Jc=null,pm=!1;function eb(s,l,u){var f=u.window===u?u.document:u.nodeType===9?u:u.ownerDocument;pm||ll==null||ll!==Xe(f)||(f=ll,"selectionStart"in f&&dm(f)?f={start:f.selectionStart,end:f.selectionEnd}:(f=(f.ownerDocument&&f.ownerDocument.defaultView||window).getSelection(),f={anchorNode:f.anchorNode,anchorOffset:f.anchorOffset,focusNode:f.focusNode,focusOffset:f.focusOffset}),Jc&&Xc(Jc,f)||(Jc=f,f=hh(hm,"onSelect"),0<f.length&&(l=new el("onSelect","select",null,l,u),s.push({event:l,listeners:f}),l.target=ll)))}function ch(s,l){var u={};return u[s.toLowerCase()]=l.toLowerCase(),u["Webkit"+s]="webkit"+l,u["Moz"+s]="moz"+l,u}var cl={animationend:ch("Animation","AnimationEnd"),animationiteration:ch("Animation","AnimationIteration"),animationstart:ch("Animation","AnimationStart"),transitionend:ch("Transition","TransitionEnd")},fm={},tb={};d&&(tb=document.createElement("div").style,"AnimationEvent"in window||(delete cl.animationend.animation,delete cl.animationiteration.animation,delete cl.animationstart.animation),"TransitionEvent"in window||delete cl.transitionend.transition);function uh(s){if(fm[s])return fm[s];if(!cl[s])return s;var l=cl[s],u;for(u in l)if(l.hasOwnProperty(u)&&u in tb)return fm[s]=l[u];return s}var nb=uh("animationend"),rb=uh("animationiteration"),ib=uh("animationstart"),ob=uh("transitionend"),sb=new Map,ab="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Vo(s,l){sb.set(s,l),a(l,[s])}for(var mm=0;mm<ab.length;mm++){var gm=ab[mm],VI=gm.toLowerCase(),UI=gm[0].toUpperCase()+gm.slice(1);Vo(VI,"on"+UI)}Vo(nb,"onAnimationEnd"),Vo(rb,"onAnimationIteration"),Vo(ib,"onAnimationStart"),Vo("dblclick","onDoubleClick"),Vo("focusin","onFocus"),Vo("focusout","onBlur"),Vo(ob,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),a("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),a("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),a("onBeforeInput",["compositionend","keypress","textInput","paste"]),a("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Zc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),qI=new Set("cancel close invalid load scroll toggle".split(" ").concat(Zc));function lb(s,l,u){var f=s.type||"unknown-event";s.currentTarget=u,Od(f,l,void 0,s),s.currentTarget=null}function cb(s,l){l=(l&4)!==0;for(var u=0;u<s.length;u++){var f=s[u],y=f.event;f=f.listeners;e:{var w=void 0;if(l)for(var E=f.length-1;0<=E;E--){var U=f[E],Y=U.instance,ge=U.currentTarget;if(U=U.listener,Y!==w&&y.isPropagationStopped())break e;lb(y,U,ge),w=Y}else for(E=0;E<f.length;E++){if(U=f[E],Y=U.instance,ge=U.currentTarget,U=U.listener,Y!==w&&y.isPropagationStopped())break e;lb(y,U,ge),w=Y}}}if(sr)throw s=Ki,sr=!1,Ki=null,s}function Jt(s,l){var u=l[Tm];u===void 0&&(u=l[Tm]=new Set);var f=s+"__bubble";u.has(f)||(ub(l,s,2,!1),u.add(f))}function ym(s,l,u){var f=0;l&&(f|=4),ub(u,s,f,l)}var dh="_reactListening"+Math.random().toString(36).slice(2);function eu(s){if(!s[dh]){s[dh]=!0,r.forEach(function(u){u!=="selectionchange"&&(qI.has(u)||ym(u,!1,s),ym(u,!0,s))});var l=s.nodeType===9?s:s.ownerDocument;l===null||l[dh]||(l[dh]=!0,ym("selectionchange",!1,l))}}function ub(s,l,u,f){switch(qc(l)){case 1:var y=an;break;case 4:y=am;break;default:y=Uc}u=y.bind(null,l,u,s),y=void 0,!Gi||l!=="touchstart"&&l!=="touchmove"&&l!=="wheel"||(y=!0),f?y!==void 0?s.addEventListener(l,u,{capture:!0,passive:y}):s.addEventListener(l,u,!0):y!==void 0?s.addEventListener(l,u,{passive:y}):s.addEventListener(l,u,!1)}function xm(s,l,u,f,y){var w=f;if((l&1)===0&&(l&2)===0&&f!==null)e:for(;;){if(f===null)return;var E=f.tag;if(E===3||E===4){var U=f.stateNode.containerInfo;if(U===y||U.nodeType===8&&U.parentNode===y)break;if(E===4)for(E=f.return;E!==null;){var Y=E.tag;if((Y===3||Y===4)&&(Y=E.stateNode.containerInfo,Y===y||Y.nodeType===8&&Y.parentNode===y))return;E=E.return}for(;U!==null;){if(E=Qs(U),E===null)return;if(Y=E.tag,Y===5||Y===6){f=w=E;continue e}U=U.parentNode}}f=f.return}Po(function(){var ge=w,Ee=lt(u),Pe=[];e:{var Ce=sb.get(s);if(Ce!==void 0){var Qe=el,et=s;switch(s){case"keypress":if(Za(u)===0)break e;case"keydown":case"keyup":Qe=b;break;case"focusin":et="focus",Qe=il;break;case"focusout":et="blur",Qe=il;break;case"beforeblur":case"afterblur":Qe=il;break;case"click":if(u.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Qe=nl;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Qe=th;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Qe=be;break;case nb:case rb:case ib:Qe=Zi;break;case ob:Qe=Ot;break;case"scroll":Qe=lm;break;case"wheel":Qe=At;break;case"copy":case"cut":case"paste":Qe=ih;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Qe=M}var nt=(l&4)!==0,xn=!nt&&s==="scroll",ce=nt?Ce!==null?Ce+"Capture":null:Ce;nt=[];for(var Z=ge,he;Z!==null;){he=Z;var ze=he.stateNode;if(he.tag===5&&ze!==null&&(he=ze,ce!==null&&(ze=sn(Z,ce),ze!=null&&nt.push(tu(Z,ze,he)))),xn)break;Z=Z.return}0<nt.length&&(Ce=new Qe(Ce,et,null,u,Ee),Pe.push({event:Ce,listeners:nt}))}}if((l&7)===0){e:{if(Ce=s==="mouseover"||s==="pointerover",Qe=s==="mouseout"||s==="pointerout",Ce&&u!==$e&&(et=u.relatedTarget||u.fromElement)&&(Qs(et)||et[eo]))break e;if((Qe||Ce)&&(Ce=Ee.window===Ee?Ee:(Ce=Ee.ownerDocument)?Ce.defaultView||Ce.parentWindow:window,Qe?(et=u.relatedTarget||u.toElement,Qe=ge,et=et?Qs(et):null,et!==null&&(xn=ei(et),et!==xn||et.tag!==5&&et.tag!==6)&&(et=null)):(Qe=null,et=ge),Qe!==et)){if(nt=nl,ze="onMouseLeave",ce="onMouseEnter",Z="mouse",(s==="pointerout"||s==="pointerover")&&(nt=M,ze="onPointerLeave",ce="onPointerEnter",Z="pointer"),xn=Qe==null?Ce:hl(Qe),he=et==null?Ce:hl(et),Ce=new nt(ze,Z+"leave",Qe,u,Ee),Ce.target=xn,Ce.relatedTarget=he,ze=null,Qs(Ee)===ge&&(nt=new nt(ce,Z+"enter",et,u,Ee),nt.target=he,nt.relatedTarget=xn,ze=nt),xn=ze,Qe&&et)t:{for(nt=Qe,ce=et,Z=0,he=nt;he;he=ul(he))Z++;for(he=0,ze=ce;ze;ze=ul(ze))he++;for(;0<Z-he;)nt=ul(nt),Z--;for(;0<he-Z;)ce=ul(ce),he--;for(;Z--;){if(nt===ce||ce!==null&&nt===ce.alternate)break t;nt=ul(nt),ce=ul(ce)}nt=null}else nt=null;Qe!==null&&db(Pe,Ce,Qe,nt,!1),et!==null&&xn!==null&&db(Pe,xn,et,nt,!0)}}e:{if(Ce=ge?hl(ge):window,Qe=Ce.nodeName&&Ce.nodeName.toLowerCase(),Qe==="select"||Qe==="input"&&Ce.type==="file")var ot=FI;else if(q0(Ce))if($0)ot=MI;else{ot=DI;var ct=zI}else(Qe=Ce.nodeName)&&Qe.toLowerCase()==="input"&&(Ce.type==="checkbox"||Ce.type==="radio")&&(ot=NI);if(ot&&(ot=ot(s,ge))){H0(Pe,ot,u,Ee);break e}ct&&ct(s,Ce,ge),s==="focusout"&&(ct=Ce._wrapperState)&&ct.controlled&&Ce.type==="number"&&Fe(Ce,"number",Ce.value)}switch(ct=ge?hl(ge):window,s){case"focusin":(q0(ct)||ct.contentEditable==="true")&&(ll=ct,hm=ge,Jc=null);break;case"focusout":Jc=hm=ll=null;break;case"mousedown":pm=!0;break;case"contextmenu":case"mouseup":case"dragend":pm=!1,eb(Pe,u,Ee);break;case"selectionchange":if(WI)break;case"keydown":case"keyup":eb(Pe,u,Ee)}var ut;if(Sn)e:{switch(s){case"compositionstart":var yt="onCompositionStart";break e;case"compositionend":yt="onCompositionEnd";break e;case"compositionupdate":yt="onCompositionUpdate";break e}yt=void 0}else al?V0(s,u)&&(yt="onCompositionEnd"):s==="keydown"&&u.keyCode===229&&(yt="onCompositionStart");yt&&(Ks&&u.locale!=="ko"&&(al||yt!=="onCompositionStart"?yt==="onCompositionEnd"&&al&&(ut=Hc()):(Pr=Ee,Ja="value"in Pr?Pr.value:Pr.textContent,al=!0)),ct=hh(ge,yt),0<ct.length&&(yt=new Kc(yt,s,null,u,Ee),Pe.push({event:yt,listeners:ct}),ut?yt.data=ut:(ut=U0(u),ut!==null&&(yt.data=ut)))),(ut=Br?EI(s,u):AI(s,u))&&(ge=hh(ge,"onBeforeInput"),0<ge.length&&(Ee=new Kc("onBeforeInput","beforeinput",null,u,Ee),Pe.push({event:Ee,listeners:ge}),Ee.data=ut))}cb(Pe,l)})}function tu(s,l,u){return{instance:s,listener:l,currentTarget:u}}function hh(s,l){for(var u=l+"Capture",f=[];s!==null;){var y=s,w=y.stateNode;y.tag===5&&w!==null&&(y=w,w=sn(s,u),w!=null&&f.unshift(tu(s,w,y)),w=sn(s,l),w!=null&&f.push(tu(s,w,y))),s=s.return}return f}function ul(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5);return s||null}function db(s,l,u,f,y){for(var w=l._reactName,E=[];u!==null&&u!==f;){var U=u,Y=U.alternate,ge=U.stateNode;if(Y!==null&&Y===f)break;U.tag===5&&ge!==null&&(U=ge,y?(Y=sn(u,w),Y!=null&&E.unshift(tu(u,Y,U))):y||(Y=sn(u,w),Y!=null&&E.push(tu(u,Y,U)))),u=u.return}E.length!==0&&s.push({event:l,listeners:E})}var HI=/\r\n?/g,$I=/\u0000|\uFFFD/g;function hb(s){return(typeof s=="string"?s:""+s).replace(HI,`
`).replace($I,"")}function ph(s,l,u){if(l=hb(l),hb(s)!==l&&u)throw Error(t(425))}function fh(){}var bm=null,vm=null;function wm(s,l){return s==="textarea"||s==="noscript"||typeof l.children=="string"||typeof l.children=="number"||typeof l.dangerouslySetInnerHTML=="object"&&l.dangerouslySetInnerHTML!==null&&l.dangerouslySetInnerHTML.__html!=null}var Sm=typeof setTimeout=="function"?setTimeout:void 0,GI=typeof clearTimeout=="function"?clearTimeout:void 0,pb=typeof Promise=="function"?Promise:void 0,KI=typeof queueMicrotask=="function"?queueMicrotask:typeof pb<"u"?function(s){return pb.resolve(null).then(s).catch(QI)}:Sm;function QI(s){setTimeout(function(){throw s})}function km(s,l){var u=l,f=0;do{var y=u.nextSibling;if(s.removeChild(u),y&&y.nodeType===8)if(u=y.data,u==="/$"){if(f===0){s.removeChild(y),oi(l);return}f--}else u!=="$"&&u!=="$?"&&u!=="$!"||f++;u=y}while(u);oi(l)}function Uo(s){for(;s!=null;s=s.nextSibling){var l=s.nodeType;if(l===1||l===3)break;if(l===8){if(l=s.data,l==="$"||l==="$!"||l==="$?")break;if(l==="/$")return null}}return s}function fb(s){s=s.previousSibling;for(var l=0;s;){if(s.nodeType===8){var u=s.data;if(u==="$"||u==="$!"||u==="$?"){if(l===0)return s;l--}else u==="/$"&&l++}s=s.previousSibling}return null}var dl=Math.random().toString(36).slice(2),ji="__reactFiber$"+dl,nu="__reactProps$"+dl,eo="__reactContainer$"+dl,Tm="__reactEvents$"+dl,YI="__reactListeners$"+dl,XI="__reactHandles$"+dl;function Qs(s){var l=s[ji];if(l)return l;for(var u=s.parentNode;u;){if(l=u[eo]||u[ji]){if(u=l.alternate,l.child!==null||u!==null&&u.child!==null)for(s=fb(s);s!==null;){if(u=s[ji])return u;s=fb(s)}return l}s=u,u=s.parentNode}return null}function ru(s){return s=s[ji]||s[eo],!s||s.tag!==5&&s.tag!==6&&s.tag!==13&&s.tag!==3?null:s}function hl(s){if(s.tag===5||s.tag===6)return s.stateNode;throw Error(t(33))}function mh(s){return s[nu]||null}var _m=[],pl=-1;function qo(s){return{current:s}}function Zt(s){0>pl||(s.current=_m[pl],_m[pl]=null,pl--)}function Qt(s,l){pl++,_m[pl]=s.current,s.current=l}var Ho={},Xn=qo(Ho),gr=qo(!1),Ys=Ho;function fl(s,l){var u=s.type.contextTypes;if(!u)return Ho;var f=s.stateNode;if(f&&f.__reactInternalMemoizedUnmaskedChildContext===l)return f.__reactInternalMemoizedMaskedChildContext;var y={},w;for(w in u)y[w]=l[w];return f&&(s=s.stateNode,s.__reactInternalMemoizedUnmaskedChildContext=l,s.__reactInternalMemoizedMaskedChildContext=y),y}function yr(s){return s=s.childContextTypes,s!=null}function gh(){Zt(gr),Zt(Xn)}function mb(s,l,u){if(Xn.current!==Ho)throw Error(t(168));Qt(Xn,l),Qt(gr,u)}function gb(s,l,u){var f=s.stateNode;if(l=l.childContextTypes,typeof f.getChildContext!="function")return u;f=f.getChildContext();for(var y in f)if(!(y in l))throw Error(t(108,Oe(s)||"Unknown",y));return Q({},u,f)}function yh(s){return s=(s=s.stateNode)&&s.__reactInternalMemoizedMergedChildContext||Ho,Ys=Xn.current,Qt(Xn,s),Qt(gr,gr.current),!0}function yb(s,l,u){var f=s.stateNode;if(!f)throw Error(t(169));u?(s=gb(s,l,Ys),f.__reactInternalMemoizedMergedChildContext=s,Zt(gr),Zt(Xn),Qt(Xn,s)):Zt(gr),Qt(gr,u)}var to=null,xh=!1,jm=!1;function xb(s){to===null?to=[s]:to.push(s)}function JI(s){xh=!0,xb(s)}function $o(){if(!jm&&to!==null){jm=!0;var s=0,l=Rt;try{var u=to;for(Rt=1;s<u.length;s++){var f=u[s];do f=f(!0);while(f!==null)}to=null,xh=!1}catch(y){throw to!==null&&(to=to.slice(s+1)),Ga(Ws,$o),y}finally{Rt=l,jm=!1}}return null}var ml=[],gl=0,bh=null,vh=0,Gr=[],Kr=0,Xs=null,no=1,ro="";function Js(s,l){ml[gl++]=vh,ml[gl++]=bh,bh=s,vh=l}function bb(s,l,u){Gr[Kr++]=no,Gr[Kr++]=ro,Gr[Kr++]=Xs,Xs=s;var f=no;s=ro;var y=32-ar(f)-1;f&=~(1<<y),u+=1;var w=32-ar(l)+y;if(30<w){var E=y-y%5;w=(f&(1<<E)-1).toString(32),f>>=E,y-=E,no=1<<32-ar(l)+y|u<<y|f,ro=w+s}else no=1<<w|u<<y|f,ro=s}function Im(s){s.return!==null&&(Js(s,1),bb(s,1,0))}function Cm(s){for(;s===bh;)bh=ml[--gl],ml[gl]=null,vh=ml[--gl],ml[gl]=null;for(;s===Xs;)Xs=Gr[--Kr],Gr[Kr]=null,ro=Gr[--Kr],Gr[Kr]=null,no=Gr[--Kr],Gr[Kr]=null}var Fr=null,zr=null,ln=!1,li=null;function vb(s,l){var u=Jr(5,null,null,0);u.elementType="DELETED",u.stateNode=l,u.return=s,l=s.deletions,l===null?(s.deletions=[u],s.flags|=16):l.push(u)}function wb(s,l){switch(s.tag){case 5:var u=s.type;return l=l.nodeType!==1||u.toLowerCase()!==l.nodeName.toLowerCase()?null:l,l!==null?(s.stateNode=l,Fr=s,zr=Uo(l.firstChild),!0):!1;case 6:return l=s.pendingProps===""||l.nodeType!==3?null:l,l!==null?(s.stateNode=l,Fr=s,zr=null,!0):!1;case 13:return l=l.nodeType!==8?null:l,l!==null?(u=Xs!==null?{id:no,overflow:ro}:null,s.memoizedState={dehydrated:l,treeContext:u,retryLane:1073741824},u=Jr(18,null,null,0),u.stateNode=l,u.return=s,s.child=u,Fr=s,zr=null,!0):!1;default:return!1}}function Rm(s){return(s.mode&1)!==0&&(s.flags&128)===0}function Em(s){if(ln){var l=zr;if(l){var u=l;if(!wb(s,l)){if(Rm(s))throw Error(t(418));l=Uo(u.nextSibling);var f=Fr;l&&wb(s,l)?vb(f,u):(s.flags=s.flags&-4097|2,ln=!1,Fr=s)}}else{if(Rm(s))throw Error(t(418));s.flags=s.flags&-4097|2,ln=!1,Fr=s}}}function Sb(s){for(s=s.return;s!==null&&s.tag!==5&&s.tag!==3&&s.tag!==13;)s=s.return;Fr=s}function wh(s){if(s!==Fr)return!1;if(!ln)return Sb(s),ln=!0,!1;var l;if((l=s.tag!==3)&&!(l=s.tag!==5)&&(l=s.type,l=l!=="head"&&l!=="body"&&!wm(s.type,s.memoizedProps)),l&&(l=zr)){if(Rm(s))throw kb(),Error(t(418));for(;l;)vb(s,l),l=Uo(l.nextSibling)}if(Sb(s),s.tag===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(t(317));e:{for(s=s.nextSibling,l=0;s;){if(s.nodeType===8){var u=s.data;if(u==="/$"){if(l===0){zr=Uo(s.nextSibling);break e}l--}else u!=="$"&&u!=="$!"&&u!=="$?"||l++}s=s.nextSibling}zr=null}}else zr=Fr?Uo(s.stateNode.nextSibling):null;return!0}function kb(){for(var s=zr;s;)s=Uo(s.nextSibling)}function yl(){zr=Fr=null,ln=!1}function Am(s){li===null?li=[s]:li.push(s)}var ZI=q.ReactCurrentBatchConfig;function iu(s,l,u){if(s=u.ref,s!==null&&typeof s!="function"&&typeof s!="object"){if(u._owner){if(u=u._owner,u){if(u.tag!==1)throw Error(t(309));var f=u.stateNode}if(!f)throw Error(t(147,s));var y=f,w=""+s;return l!==null&&l.ref!==null&&typeof l.ref=="function"&&l.ref._stringRef===w?l.ref:(l=function(E){var U=y.refs;E===null?delete U[w]:U[w]=E},l._stringRef=w,l)}if(typeof s!="string")throw Error(t(284));if(!u._owner)throw Error(t(290,s))}return s}function Sh(s,l){throw s=Object.prototype.toString.call(l),Error(t(31,s==="[object Object]"?"object with keys {"+Object.keys(l).join(", ")+"}":s))}function Tb(s){var l=s._init;return l(s._payload)}function _b(s){function l(ce,Z){if(s){var he=ce.deletions;he===null?(ce.deletions=[Z],ce.flags|=16):he.push(Z)}}function u(ce,Z){if(!s)return null;for(;Z!==null;)l(ce,Z),Z=Z.sibling;return null}function f(ce,Z){for(ce=new Map;Z!==null;)Z.key!==null?ce.set(Z.key,Z):ce.set(Z.index,Z),Z=Z.sibling;return ce}function y(ce,Z){return ce=es(ce,Z),ce.index=0,ce.sibling=null,ce}function w(ce,Z,he){return ce.index=he,s?(he=ce.alternate,he!==null?(he=he.index,he<Z?(ce.flags|=2,Z):he):(ce.flags|=2,Z)):(ce.flags|=1048576,Z)}function E(ce){return s&&ce.alternate===null&&(ce.flags|=2),ce}function U(ce,Z,he,ze){return Z===null||Z.tag!==6?(Z=Sg(he,ce.mode,ze),Z.return=ce,Z):(Z=y(Z,he),Z.return=ce,Z)}function Y(ce,Z,he,ze){var ot=he.type;return ot===L?Ee(ce,Z,he.props.children,ze,he.key):Z!==null&&(Z.elementType===ot||typeof ot=="object"&&ot!==null&&ot.$$typeof===$&&Tb(ot)===Z.type)?(ze=y(Z,he.props),ze.ref=iu(ce,Z,he),ze.return=ce,ze):(ze=$h(he.type,he.key,he.props,null,ce.mode,ze),ze.ref=iu(ce,Z,he),ze.return=ce,ze)}function ge(ce,Z,he,ze){return Z===null||Z.tag!==4||Z.stateNode.containerInfo!==he.containerInfo||Z.stateNode.implementation!==he.implementation?(Z=kg(he,ce.mode,ze),Z.return=ce,Z):(Z=y(Z,he.children||[]),Z.return=ce,Z)}function Ee(ce,Z,he,ze,ot){return Z===null||Z.tag!==7?(Z=sa(he,ce.mode,ze,ot),Z.return=ce,Z):(Z=y(Z,he),Z.return=ce,Z)}function Pe(ce,Z,he){if(typeof Z=="string"&&Z!==""||typeof Z=="number")return Z=Sg(""+Z,ce.mode,he),Z.return=ce,Z;if(typeof Z=="object"&&Z!==null){switch(Z.$$typeof){case te:return he=$h(Z.type,Z.key,Z.props,null,ce.mode,he),he.ref=iu(ce,null,Z),he.return=ce,he;case W:return Z=kg(Z,ce.mode,he),Z.return=ce,Z;case $:var ze=Z._init;return Pe(ce,ze(Z._payload),he)}if(Be(Z)||J(Z))return Z=sa(Z,ce.mode,he,null),Z.return=ce,Z;Sh(ce,Z)}return null}function Ce(ce,Z,he,ze){var ot=Z!==null?Z.key:null;if(typeof he=="string"&&he!==""||typeof he=="number")return ot!==null?null:U(ce,Z,""+he,ze);if(typeof he=="object"&&he!==null){switch(he.$$typeof){case te:return he.key===ot?Y(ce,Z,he,ze):null;case W:return he.key===ot?ge(ce,Z,he,ze):null;case $:return ot=he._init,Ce(ce,Z,ot(he._payload),ze)}if(Be(he)||J(he))return ot!==null?null:Ee(ce,Z,he,ze,null);Sh(ce,he)}return null}function Qe(ce,Z,he,ze,ot){if(typeof ze=="string"&&ze!==""||typeof ze=="number")return ce=ce.get(he)||null,U(Z,ce,""+ze,ot);if(typeof ze=="object"&&ze!==null){switch(ze.$$typeof){case te:return ce=ce.get(ze.key===null?he:ze.key)||null,Y(Z,ce,ze,ot);case W:return ce=ce.get(ze.key===null?he:ze.key)||null,ge(Z,ce,ze,ot);case $:var ct=ze._init;return Qe(ce,Z,he,ct(ze._payload),ot)}if(Be(ze)||J(ze))return ce=ce.get(he)||null,Ee(Z,ce,ze,ot,null);Sh(Z,ze)}return null}function et(ce,Z,he,ze){for(var ot=null,ct=null,ut=Z,yt=Z=0,Mn=null;ut!==null&&yt<he.length;yt++){ut.index>yt?(Mn=ut,ut=null):Mn=ut.sibling;var zt=Ce(ce,ut,he[yt],ze);if(zt===null){ut===null&&(ut=Mn);break}s&&ut&&zt.alternate===null&&l(ce,ut),Z=w(zt,Z,yt),ct===null?ot=zt:ct.sibling=zt,ct=zt,ut=Mn}if(yt===he.length)return u(ce,ut),ln&&Js(ce,yt),ot;if(ut===null){for(;yt<he.length;yt++)ut=Pe(ce,he[yt],ze),ut!==null&&(Z=w(ut,Z,yt),ct===null?ot=ut:ct.sibling=ut,ct=ut);return ln&&Js(ce,yt),ot}for(ut=f(ce,ut);yt<he.length;yt++)Mn=Qe(ut,ce,yt,he[yt],ze),Mn!==null&&(s&&Mn.alternate!==null&&ut.delete(Mn.key===null?yt:Mn.key),Z=w(Mn,Z,yt),ct===null?ot=Mn:ct.sibling=Mn,ct=Mn);return s&&ut.forEach(function(ts){return l(ce,ts)}),ln&&Js(ce,yt),ot}function nt(ce,Z,he,ze){var ot=J(he);if(typeof ot!="function")throw Error(t(150));if(he=ot.call(he),he==null)throw Error(t(151));for(var ct=ot=null,ut=Z,yt=Z=0,Mn=null,zt=he.next();ut!==null&&!zt.done;yt++,zt=he.next()){ut.index>yt?(Mn=ut,ut=null):Mn=ut.sibling;var ts=Ce(ce,ut,zt.value,ze);if(ts===null){ut===null&&(ut=Mn);break}s&&ut&&ts.alternate===null&&l(ce,ut),Z=w(ts,Z,yt),ct===null?ot=ts:ct.sibling=ts,ct=ts,ut=Mn}if(zt.done)return u(ce,ut),ln&&Js(ce,yt),ot;if(ut===null){for(;!zt.done;yt++,zt=he.next())zt=Pe(ce,zt.value,ze),zt!==null&&(Z=w(zt,Z,yt),ct===null?ot=zt:ct.sibling=zt,ct=zt);return ln&&Js(ce,yt),ot}for(ut=f(ce,ut);!zt.done;yt++,zt=he.next())zt=Qe(ut,ce,yt,zt.value,ze),zt!==null&&(s&&zt.alternate!==null&&ut.delete(zt.key===null?yt:zt.key),Z=w(zt,Z,yt),ct===null?ot=zt:ct.sibling=zt,ct=zt);return s&&ut.forEach(function(PC){return l(ce,PC)}),ln&&Js(ce,yt),ot}function xn(ce,Z,he,ze){if(typeof he=="object"&&he!==null&&he.type===L&&he.key===null&&(he=he.props.children),typeof he=="object"&&he!==null){switch(he.$$typeof){case te:e:{for(var ot=he.key,ct=Z;ct!==null;){if(ct.key===ot){if(ot=he.type,ot===L){if(ct.tag===7){u(ce,ct.sibling),Z=y(ct,he.props.children),Z.return=ce,ce=Z;break e}}else if(ct.elementType===ot||typeof ot=="object"&&ot!==null&&ot.$$typeof===$&&Tb(ot)===ct.type){u(ce,ct.sibling),Z=y(ct,he.props),Z.ref=iu(ce,ct,he),Z.return=ce,ce=Z;break e}u(ce,ct);break}else l(ce,ct);ct=ct.sibling}he.type===L?(Z=sa(he.props.children,ce.mode,ze,he.key),Z.return=ce,ce=Z):(ze=$h(he.type,he.key,he.props,null,ce.mode,ze),ze.ref=iu(ce,Z,he),ze.return=ce,ce=ze)}return E(ce);case W:e:{for(ct=he.key;Z!==null;){if(Z.key===ct)if(Z.tag===4&&Z.stateNode.containerInfo===he.containerInfo&&Z.stateNode.implementation===he.implementation){u(ce,Z.sibling),Z=y(Z,he.children||[]),Z.return=ce,ce=Z;break e}else{u(ce,Z);break}else l(ce,Z);Z=Z.sibling}Z=kg(he,ce.mode,ze),Z.return=ce,ce=Z}return E(ce);case $:return ct=he._init,xn(ce,Z,ct(he._payload),ze)}if(Be(he))return et(ce,Z,he,ze);if(J(he))return nt(ce,Z,he,ze);Sh(ce,he)}return typeof he=="string"&&he!==""||typeof he=="number"?(he=""+he,Z!==null&&Z.tag===6?(u(ce,Z.sibling),Z=y(Z,he),Z.return=ce,ce=Z):(u(ce,Z),Z=Sg(he,ce.mode,ze),Z.return=ce,ce=Z),E(ce)):u(ce,Z)}return xn}var xl=_b(!0),jb=_b(!1),kh=qo(null),Th=null,bl=null,Pm=null;function Bm(){Pm=bl=Th=null}function Fm(s){var l=kh.current;Zt(kh),s._currentValue=l}function zm(s,l,u){for(;s!==null;){var f=s.alternate;if((s.childLanes&l)!==l?(s.childLanes|=l,f!==null&&(f.childLanes|=l)):f!==null&&(f.childLanes&l)!==l&&(f.childLanes|=l),s===u)break;s=s.return}}function vl(s,l){Th=s,Pm=bl=null,s=s.dependencies,s!==null&&s.firstContext!==null&&((s.lanes&l)!==0&&(xr=!0),s.firstContext=null)}function Qr(s){var l=s._currentValue;if(Pm!==s)if(s={context:s,memoizedValue:l,next:null},bl===null){if(Th===null)throw Error(t(308));bl=s,Th.dependencies={lanes:0,firstContext:s}}else bl=bl.next=s;return l}var Zs=null;function Dm(s){Zs===null?Zs=[s]:Zs.push(s)}function Ib(s,l,u,f){var y=l.interleaved;return y===null?(u.next=u,Dm(l)):(u.next=y.next,y.next=u),l.interleaved=u,io(s,f)}function io(s,l){s.lanes|=l;var u=s.alternate;for(u!==null&&(u.lanes|=l),u=s,s=s.return;s!==null;)s.childLanes|=l,u=s.alternate,u!==null&&(u.childLanes|=l),u=s,s=s.return;return u.tag===3?u.stateNode:null}var Go=!1;function Nm(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Cb(s,l){s=s.updateQueue,l.updateQueue===s&&(l.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,effects:s.effects})}function oo(s,l){return{eventTime:s,lane:l,tag:0,payload:null,callback:null,next:null}}function Ko(s,l,u){var f=s.updateQueue;if(f===null)return null;if(f=f.shared,(Bt&2)!==0){var y=f.pending;return y===null?l.next=l:(l.next=y.next,y.next=l),f.pending=l,io(s,u)}return y=f.interleaved,y===null?(l.next=l,Dm(f)):(l.next=y.next,y.next=l),f.interleaved=l,io(s,u)}function _h(s,l,u){if(l=l.updateQueue,l!==null&&(l=l.shared,(u&4194240)!==0)){var f=l.lanes;f&=s.pendingLanes,u|=f,l.lanes=u,No(s,u)}}function Rb(s,l){var u=s.updateQueue,f=s.alternate;if(f!==null&&(f=f.updateQueue,u===f)){var y=null,w=null;if(u=u.firstBaseUpdate,u!==null){do{var E={eventTime:u.eventTime,lane:u.lane,tag:u.tag,payload:u.payload,callback:u.callback,next:null};w===null?y=w=E:w=w.next=E,u=u.next}while(u!==null);w===null?y=w=l:w=w.next=l}else y=w=l;u={baseState:f.baseState,firstBaseUpdate:y,lastBaseUpdate:w,shared:f.shared,effects:f.effects},s.updateQueue=u;return}s=u.lastBaseUpdate,s===null?u.firstBaseUpdate=l:s.next=l,u.lastBaseUpdate=l}function jh(s,l,u,f){var y=s.updateQueue;Go=!1;var w=y.firstBaseUpdate,E=y.lastBaseUpdate,U=y.shared.pending;if(U!==null){y.shared.pending=null;var Y=U,ge=Y.next;Y.next=null,E===null?w=ge:E.next=ge,E=Y;var Ee=s.alternate;Ee!==null&&(Ee=Ee.updateQueue,U=Ee.lastBaseUpdate,U!==E&&(U===null?Ee.firstBaseUpdate=ge:U.next=ge,Ee.lastBaseUpdate=Y))}if(w!==null){var Pe=y.baseState;E=0,Ee=ge=Y=null,U=w;do{var Ce=U.lane,Qe=U.eventTime;if((f&Ce)===Ce){Ee!==null&&(Ee=Ee.next={eventTime:Qe,lane:0,tag:U.tag,payload:U.payload,callback:U.callback,next:null});e:{var et=s,nt=U;switch(Ce=l,Qe=u,nt.tag){case 1:if(et=nt.payload,typeof et=="function"){Pe=et.call(Qe,Pe,Ce);break e}Pe=et;break e;case 3:et.flags=et.flags&-65537|128;case 0:if(et=nt.payload,Ce=typeof et=="function"?et.call(Qe,Pe,Ce):et,Ce==null)break e;Pe=Q({},Pe,Ce);break e;case 2:Go=!0}}U.callback!==null&&U.lane!==0&&(s.flags|=64,Ce=y.effects,Ce===null?y.effects=[U]:Ce.push(U))}else Qe={eventTime:Qe,lane:Ce,tag:U.tag,payload:U.payload,callback:U.callback,next:null},Ee===null?(ge=Ee=Qe,Y=Pe):Ee=Ee.next=Qe,E|=Ce;if(U=U.next,U===null){if(U=y.shared.pending,U===null)break;Ce=U,U=Ce.next,Ce.next=null,y.lastBaseUpdate=Ce,y.shared.pending=null}}while(!0);if(Ee===null&&(Y=Pe),y.baseState=Y,y.firstBaseUpdate=ge,y.lastBaseUpdate=Ee,l=y.shared.interleaved,l!==null){y=l;do E|=y.lane,y=y.next;while(y!==l)}else w===null&&(y.shared.lanes=0);na|=E,s.lanes=E,s.memoizedState=Pe}}function Eb(s,l,u){if(s=l.effects,l.effects=null,s!==null)for(l=0;l<s.length;l++){var f=s[l],y=f.callback;if(y!==null){if(f.callback=null,f=u,typeof y!="function")throw Error(t(191,y));y.call(f)}}}var ou={},Ii=qo(ou),su=qo(ou),au=qo(ou);function ea(s){if(s===ou)throw Error(t(174));return s}function Mm(s,l){switch(Qt(au,l),Qt(su,s),Qt(Ii,ou),s=l.nodeType,s){case 9:case 11:l=(l=l.documentElement)?l.namespaceURI:Re(null,"");break;default:s=s===8?l.parentNode:l,l=s.namespaceURI||null,s=s.tagName,l=Re(l,s)}Zt(Ii),Qt(Ii,l)}function wl(){Zt(Ii),Zt(su),Zt(au)}function Ab(s){ea(au.current);var l=ea(Ii.current),u=Re(l,s.type);l!==u&&(Qt(su,s),Qt(Ii,u))}function Lm(s){su.current===s&&(Zt(Ii),Zt(su))}var hn=qo(0);function Ih(s){for(var l=s;l!==null;){if(l.tag===13){var u=l.memoizedState;if(u!==null&&(u=u.dehydrated,u===null||u.data==="$?"||u.data==="$!"))return l}else if(l.tag===19&&l.memoizedProps.revealOrder!==void 0){if((l.flags&128)!==0)return l}else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===s)break;for(;l.sibling===null;){if(l.return===null||l.return===s)return null;l=l.return}l.sibling.return=l.return,l=l.sibling}return null}var Om=[];function Wm(){for(var s=0;s<Om.length;s++)Om[s]._workInProgressVersionPrimary=null;Om.length=0}var Ch=q.ReactCurrentDispatcher,Vm=q.ReactCurrentBatchConfig,ta=0,pn=null,jn=null,Dn=null,Rh=!1,lu=!1,cu=0,eC=0;function Jn(){throw Error(t(321))}function Um(s,l){if(l===null)return!1;for(var u=0;u<l.length&&u<s.length;u++)if(!ai(s[u],l[u]))return!1;return!0}function qm(s,l,u,f,y,w){if(ta=w,pn=l,l.memoizedState=null,l.updateQueue=null,l.lanes=0,Ch.current=s===null||s.memoizedState===null?iC:oC,s=u(f,y),lu){w=0;do{if(lu=!1,cu=0,25<=w)throw Error(t(301));w+=1,Dn=jn=null,l.updateQueue=null,Ch.current=sC,s=u(f,y)}while(lu)}if(Ch.current=Ph,l=jn!==null&&jn.next!==null,ta=0,Dn=jn=pn=null,Rh=!1,l)throw Error(t(300));return s}function Hm(){var s=cu!==0;return cu=0,s}function Ci(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Dn===null?pn.memoizedState=Dn=s:Dn=Dn.next=s,Dn}function Yr(){if(jn===null){var s=pn.alternate;s=s!==null?s.memoizedState:null}else s=jn.next;var l=Dn===null?pn.memoizedState:Dn.next;if(l!==null)Dn=l,jn=s;else{if(s===null)throw Error(t(310));jn=s,s={memoizedState:jn.memoizedState,baseState:jn.baseState,baseQueue:jn.baseQueue,queue:jn.queue,next:null},Dn===null?pn.memoizedState=Dn=s:Dn=Dn.next=s}return Dn}function uu(s,l){return typeof l=="function"?l(s):l}function $m(s){var l=Yr(),u=l.queue;if(u===null)throw Error(t(311));u.lastRenderedReducer=s;var f=jn,y=f.baseQueue,w=u.pending;if(w!==null){if(y!==null){var E=y.next;y.next=w.next,w.next=E}f.baseQueue=y=w,u.pending=null}if(y!==null){w=y.next,f=f.baseState;var U=E=null,Y=null,ge=w;do{var Ee=ge.lane;if((ta&Ee)===Ee)Y!==null&&(Y=Y.next={lane:0,action:ge.action,hasEagerState:ge.hasEagerState,eagerState:ge.eagerState,next:null}),f=ge.hasEagerState?ge.eagerState:s(f,ge.action);else{var Pe={lane:Ee,action:ge.action,hasEagerState:ge.hasEagerState,eagerState:ge.eagerState,next:null};Y===null?(U=Y=Pe,E=f):Y=Y.next=Pe,pn.lanes|=Ee,na|=Ee}ge=ge.next}while(ge!==null&&ge!==w);Y===null?E=f:Y.next=U,ai(f,l.memoizedState)||(xr=!0),l.memoizedState=f,l.baseState=E,l.baseQueue=Y,u.lastRenderedState=f}if(s=u.interleaved,s!==null){y=s;do w=y.lane,pn.lanes|=w,na|=w,y=y.next;while(y!==s)}else y===null&&(u.lanes=0);return[l.memoizedState,u.dispatch]}function Gm(s){var l=Yr(),u=l.queue;if(u===null)throw Error(t(311));u.lastRenderedReducer=s;var f=u.dispatch,y=u.pending,w=l.memoizedState;if(y!==null){u.pending=null;var E=y=y.next;do w=s(w,E.action),E=E.next;while(E!==y);ai(w,l.memoizedState)||(xr=!0),l.memoizedState=w,l.baseQueue===null&&(l.baseState=w),u.lastRenderedState=w}return[w,f]}function Pb(){}function Bb(s,l){var u=pn,f=Yr(),y=l(),w=!ai(f.memoizedState,y);if(w&&(f.memoizedState=y,xr=!0),f=f.queue,Km(Db.bind(null,u,f,s),[s]),f.getSnapshot!==l||w||Dn!==null&&Dn.memoizedState.tag&1){if(u.flags|=2048,du(9,zb.bind(null,u,f,y,l),void 0,null),Nn===null)throw Error(t(349));(ta&30)!==0||Fb(u,l,y)}return y}function Fb(s,l,u){s.flags|=16384,s={getSnapshot:l,value:u},l=pn.updateQueue,l===null?(l={lastEffect:null,stores:null},pn.updateQueue=l,l.stores=[s]):(u=l.stores,u===null?l.stores=[s]:u.push(s))}function zb(s,l,u,f){l.value=u,l.getSnapshot=f,Nb(l)&&Mb(s)}function Db(s,l,u){return u(function(){Nb(l)&&Mb(s)})}function Nb(s){var l=s.getSnapshot;s=s.value;try{var u=l();return!ai(s,u)}catch{return!0}}function Mb(s){var l=io(s,1);l!==null&&hi(l,s,1,-1)}function Lb(s){var l=Ci();return typeof s=="function"&&(s=s()),l.memoizedState=l.baseState=s,s={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:uu,lastRenderedState:s},l.queue=s,s=s.dispatch=rC.bind(null,pn,s),[l.memoizedState,s]}function du(s,l,u,f){return s={tag:s,create:l,destroy:u,deps:f,next:null},l=pn.updateQueue,l===null?(l={lastEffect:null,stores:null},pn.updateQueue=l,l.lastEffect=s.next=s):(u=l.lastEffect,u===null?l.lastEffect=s.next=s:(f=u.next,u.next=s,s.next=f,l.lastEffect=s)),s}function Ob(){return Yr().memoizedState}function Eh(s,l,u,f){var y=Ci();pn.flags|=s,y.memoizedState=du(1|l,u,void 0,f===void 0?null:f)}function Ah(s,l,u,f){var y=Yr();f=f===void 0?null:f;var w=void 0;if(jn!==null){var E=jn.memoizedState;if(w=E.destroy,f!==null&&Um(f,E.deps)){y.memoizedState=du(l,u,w,f);return}}pn.flags|=s,y.memoizedState=du(1|l,u,w,f)}function Wb(s,l){return Eh(8390656,8,s,l)}function Km(s,l){return Ah(2048,8,s,l)}function Vb(s,l){return Ah(4,2,s,l)}function Ub(s,l){return Ah(4,4,s,l)}function qb(s,l){if(typeof l=="function")return s=s(),l(s),function(){l(null)};if(l!=null)return s=s(),l.current=s,function(){l.current=null}}function Hb(s,l,u){return u=u!=null?u.concat([s]):null,Ah(4,4,qb.bind(null,l,s),u)}function Qm(){}function $b(s,l){var u=Yr();l=l===void 0?null:l;var f=u.memoizedState;return f!==null&&l!==null&&Um(l,f[1])?f[0]:(u.memoizedState=[s,l],s)}function Gb(s,l){var u=Yr();l=l===void 0?null:l;var f=u.memoizedState;return f!==null&&l!==null&&Um(l,f[1])?f[0]:(s=s(),u.memoizedState=[s,l],s)}function Kb(s,l,u){return(ta&21)===0?(s.baseState&&(s.baseState=!1,xr=!0),s.memoizedState=u):(ai(u,l)||(u=qs(),pn.lanes|=u,na|=u,s.baseState=!0),l)}function tC(s,l){var u=Rt;Rt=u!==0&&4>u?u:4,s(!0);var f=Vm.transition;Vm.transition={};try{s(!1),l()}finally{Rt=u,Vm.transition=f}}function Qb(){return Yr().memoizedState}function nC(s,l,u){var f=Jo(s);if(u={lane:f,action:u,hasEagerState:!1,eagerState:null,next:null},Yb(s))Xb(l,u);else if(u=Ib(s,l,u,f),u!==null){var y=ur();hi(u,s,f,y),Jb(u,l,f)}}function rC(s,l,u){var f=Jo(s),y={lane:f,action:u,hasEagerState:!1,eagerState:null,next:null};if(Yb(s))Xb(l,y);else{var w=s.alternate;if(s.lanes===0&&(w===null||w.lanes===0)&&(w=l.lastRenderedReducer,w!==null))try{var E=l.lastRenderedState,U=w(E,u);if(y.hasEagerState=!0,y.eagerState=U,ai(U,E)){var Y=l.interleaved;Y===null?(y.next=y,Dm(l)):(y.next=Y.next,Y.next=y),l.interleaved=y;return}}catch{}finally{}u=Ib(s,l,y,f),u!==null&&(y=ur(),hi(u,s,f,y),Jb(u,l,f))}}function Yb(s){var l=s.alternate;return s===pn||l!==null&&l===pn}function Xb(s,l){lu=Rh=!0;var u=s.pending;u===null?l.next=l:(l.next=u.next,u.next=l),s.pending=l}function Jb(s,l,u){if((u&4194240)!==0){var f=l.lanes;f&=s.pendingLanes,u|=f,l.lanes=u,No(s,u)}}var Ph={readContext:Qr,useCallback:Jn,useContext:Jn,useEffect:Jn,useImperativeHandle:Jn,useInsertionEffect:Jn,useLayoutEffect:Jn,useMemo:Jn,useReducer:Jn,useRef:Jn,useState:Jn,useDebugValue:Jn,useDeferredValue:Jn,useTransition:Jn,useMutableSource:Jn,useSyncExternalStore:Jn,useId:Jn,unstable_isNewReconciler:!1},iC={readContext:Qr,useCallback:function(s,l){return Ci().memoizedState=[s,l===void 0?null:l],s},useContext:Qr,useEffect:Wb,useImperativeHandle:function(s,l,u){return u=u!=null?u.concat([s]):null,Eh(4194308,4,qb.bind(null,l,s),u)},useLayoutEffect:function(s,l){return Eh(4194308,4,s,l)},useInsertionEffect:function(s,l){return Eh(4,2,s,l)},useMemo:function(s,l){var u=Ci();return l=l===void 0?null:l,s=s(),u.memoizedState=[s,l],s},useReducer:function(s,l,u){var f=Ci();return l=u!==void 0?u(l):l,f.memoizedState=f.baseState=l,s={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:l},f.queue=s,s=s.dispatch=nC.bind(null,pn,s),[f.memoizedState,s]},useRef:function(s){var l=Ci();return s={current:s},l.memoizedState=s},useState:Lb,useDebugValue:Qm,useDeferredValue:function(s){return Ci().memoizedState=s},useTransition:function(){var s=Lb(!1),l=s[0];return s=tC.bind(null,s[1]),Ci().memoizedState=s,[l,s]},useMutableSource:function(){},useSyncExternalStore:function(s,l,u){var f=pn,y=Ci();if(ln){if(u===void 0)throw Error(t(407));u=u()}else{if(u=l(),Nn===null)throw Error(t(349));(ta&30)!==0||Fb(f,l,u)}y.memoizedState=u;var w={value:u,getSnapshot:l};return y.queue=w,Wb(Db.bind(null,f,w,s),[s]),f.flags|=2048,du(9,zb.bind(null,f,w,u,l),void 0,null),u},useId:function(){var s=Ci(),l=Nn.identifierPrefix;if(ln){var u=ro,f=no;u=(f&~(1<<32-ar(f)-1)).toString(32)+u,l=":"+l+"R"+u,u=cu++,0<u&&(l+="H"+u.toString(32)),l+=":"}else u=eC++,l=":"+l+"r"+u.toString(32)+":";return s.memoizedState=l},unstable_isNewReconciler:!1},oC={readContext:Qr,useCallback:$b,useContext:Qr,useEffect:Km,useImperativeHandle:Hb,useInsertionEffect:Vb,useLayoutEffect:Ub,useMemo:Gb,useReducer:$m,useRef:Ob,useState:function(){return $m(uu)},useDebugValue:Qm,useDeferredValue:function(s){var l=Yr();return Kb(l,jn.memoizedState,s)},useTransition:function(){var s=$m(uu)[0],l=Yr().memoizedState;return[s,l]},useMutableSource:Pb,useSyncExternalStore:Bb,useId:Qb,unstable_isNewReconciler:!1},sC={readContext:Qr,useCallback:$b,useContext:Qr,useEffect:Km,useImperativeHandle:Hb,useInsertionEffect:Vb,useLayoutEffect:Ub,useMemo:Gb,useReducer:Gm,useRef:Ob,useState:function(){return Gm(uu)},useDebugValue:Qm,useDeferredValue:function(s){var l=Yr();return jn===null?l.memoizedState=s:Kb(l,jn.memoizedState,s)},useTransition:function(){var s=Gm(uu)[0],l=Yr().memoizedState;return[s,l]},useMutableSource:Pb,useSyncExternalStore:Bb,useId:Qb,unstable_isNewReconciler:!1};function ci(s,l){if(s&&s.defaultProps){l=Q({},l),s=s.defaultProps;for(var u in s)l[u]===void 0&&(l[u]=s[u]);return l}return l}function Ym(s,l,u,f){l=s.memoizedState,u=u(f,l),u=u==null?l:Q({},l,u),s.memoizedState=u,s.lanes===0&&(s.updateQueue.baseState=u)}var Bh={isMounted:function(s){return(s=s._reactInternals)?ei(s)===s:!1},enqueueSetState:function(s,l,u){s=s._reactInternals;var f=ur(),y=Jo(s),w=oo(f,y);w.payload=l,u!=null&&(w.callback=u),l=Ko(s,w,y),l!==null&&(hi(l,s,y,f),_h(l,s,y))},enqueueReplaceState:function(s,l,u){s=s._reactInternals;var f=ur(),y=Jo(s),w=oo(f,y);w.tag=1,w.payload=l,u!=null&&(w.callback=u),l=Ko(s,w,y),l!==null&&(hi(l,s,y,f),_h(l,s,y))},enqueueForceUpdate:function(s,l){s=s._reactInternals;var u=ur(),f=Jo(s),y=oo(u,f);y.tag=2,l!=null&&(y.callback=l),l=Ko(s,y,f),l!==null&&(hi(l,s,f,u),_h(l,s,f))}};function Zb(s,l,u,f,y,w,E){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(f,w,E):l.prototype&&l.prototype.isPureReactComponent?!Xc(u,f)||!Xc(y,w):!0}function ev(s,l,u){var f=!1,y=Ho,w=l.contextType;return typeof w=="object"&&w!==null?w=Qr(w):(y=yr(l)?Ys:Xn.current,f=l.contextTypes,w=(f=f!=null)?fl(s,y):Ho),l=new l(u,w),s.memoizedState=l.state!==null&&l.state!==void 0?l.state:null,l.updater=Bh,s.stateNode=l,l._reactInternals=s,f&&(s=s.stateNode,s.__reactInternalMemoizedUnmaskedChildContext=y,s.__reactInternalMemoizedMaskedChildContext=w),l}function tv(s,l,u,f){s=l.state,typeof l.componentWillReceiveProps=="function"&&l.componentWillReceiveProps(u,f),typeof l.UNSAFE_componentWillReceiveProps=="function"&&l.UNSAFE_componentWillReceiveProps(u,f),l.state!==s&&Bh.enqueueReplaceState(l,l.state,null)}function Xm(s,l,u,f){var y=s.stateNode;y.props=u,y.state=s.memoizedState,y.refs={},Nm(s);var w=l.contextType;typeof w=="object"&&w!==null?y.context=Qr(w):(w=yr(l)?Ys:Xn.current,y.context=fl(s,w)),y.state=s.memoizedState,w=l.getDerivedStateFromProps,typeof w=="function"&&(Ym(s,l,w,u),y.state=s.memoizedState),typeof l.getDerivedStateFromProps=="function"||typeof y.getSnapshotBeforeUpdate=="function"||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(l=y.state,typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount(),l!==y.state&&Bh.enqueueReplaceState(y,y.state,null),jh(s,u,y,f),y.state=s.memoizedState),typeof y.componentDidMount=="function"&&(s.flags|=4194308)}function Sl(s,l){try{var u="",f=l;do u+=Se(f),f=f.return;while(f);var y=u}catch(w){y=`
Error generating stack: `+w.message+`
`+w.stack}return{value:s,source:l,stack:y,digest:null}}function Jm(s,l,u){return{value:s,source:null,stack:u??null,digest:l??null}}function Zm(s,l){try{console.error(l.value)}catch(u){setTimeout(function(){throw u})}}var aC=typeof WeakMap=="function"?WeakMap:Map;function nv(s,l,u){u=oo(-1,u),u.tag=3,u.payload={element:null};var f=l.value;return u.callback=function(){Oh||(Oh=!0,fg=f),Zm(s,l)},u}function rv(s,l,u){u=oo(-1,u),u.tag=3;var f=s.type.getDerivedStateFromError;if(typeof f=="function"){var y=l.value;u.payload=function(){return f(y)},u.callback=function(){Zm(s,l)}}var w=s.stateNode;return w!==null&&typeof w.componentDidCatch=="function"&&(u.callback=function(){Zm(s,l),typeof f!="function"&&(Yo===null?Yo=new Set([this]):Yo.add(this));var E=l.stack;this.componentDidCatch(l.value,{componentStack:E!==null?E:""})}),u}function iv(s,l,u){var f=s.pingCache;if(f===null){f=s.pingCache=new aC;var y=new Set;f.set(l,y)}else y=f.get(l),y===void 0&&(y=new Set,f.set(l,y));y.has(u)||(y.add(u),s=wC.bind(null,s,l,u),l.then(s,s))}function ov(s){do{var l;if((l=s.tag===13)&&(l=s.memoizedState,l=l!==null?l.dehydrated!==null:!0),l)return s;s=s.return}while(s!==null);return null}function sv(s,l,u,f,y){return(s.mode&1)===0?(s===l?s.flags|=65536:(s.flags|=128,u.flags|=131072,u.flags&=-52805,u.tag===1&&(u.alternate===null?u.tag=17:(l=oo(-1,1),l.tag=2,Ko(u,l,1))),u.lanes|=1),s):(s.flags|=65536,s.lanes=y,s)}var lC=q.ReactCurrentOwner,xr=!1;function cr(s,l,u,f){l.child=s===null?jb(l,null,u,f):xl(l,s.child,u,f)}function av(s,l,u,f,y){u=u.render;var w=l.ref;return vl(l,y),f=qm(s,l,u,f,w,y),u=Hm(),s!==null&&!xr?(l.updateQueue=s.updateQueue,l.flags&=-2053,s.lanes&=~y,so(s,l,y)):(ln&&u&&Im(l),l.flags|=1,cr(s,l,f,y),l.child)}function lv(s,l,u,f,y){if(s===null){var w=u.type;return typeof w=="function"&&!wg(w)&&w.defaultProps===void 0&&u.compare===null&&u.defaultProps===void 0?(l.tag=15,l.type=w,cv(s,l,w,f,y)):(s=$h(u.type,null,f,l,l.mode,y),s.ref=l.ref,s.return=l,l.child=s)}if(w=s.child,(s.lanes&y)===0){var E=w.memoizedProps;if(u=u.compare,u=u!==null?u:Xc,u(E,f)&&s.ref===l.ref)return so(s,l,y)}return l.flags|=1,s=es(w,f),s.ref=l.ref,s.return=l,l.child=s}function cv(s,l,u,f,y){if(s!==null){var w=s.memoizedProps;if(Xc(w,f)&&s.ref===l.ref)if(xr=!1,l.pendingProps=f=w,(s.lanes&y)!==0)(s.flags&131072)!==0&&(xr=!0);else return l.lanes=s.lanes,so(s,l,y)}return eg(s,l,u,f,y)}function uv(s,l,u){var f=l.pendingProps,y=f.children,w=s!==null?s.memoizedState:null;if(f.mode==="hidden")if((l.mode&1)===0)l.memoizedState={baseLanes:0,cachePool:null,transitions:null},Qt(Tl,Dr),Dr|=u;else{if((u&1073741824)===0)return s=w!==null?w.baseLanes|u:u,l.lanes=l.childLanes=1073741824,l.memoizedState={baseLanes:s,cachePool:null,transitions:null},l.updateQueue=null,Qt(Tl,Dr),Dr|=s,null;l.memoizedState={baseLanes:0,cachePool:null,transitions:null},f=w!==null?w.baseLanes:u,Qt(Tl,Dr),Dr|=f}else w!==null?(f=w.baseLanes|u,l.memoizedState=null):f=u,Qt(Tl,Dr),Dr|=f;return cr(s,l,y,u),l.child}function dv(s,l){var u=l.ref;(s===null&&u!==null||s!==null&&s.ref!==u)&&(l.flags|=512,l.flags|=2097152)}function eg(s,l,u,f,y){var w=yr(u)?Ys:Xn.current;return w=fl(l,w),vl(l,y),u=qm(s,l,u,f,w,y),f=Hm(),s!==null&&!xr?(l.updateQueue=s.updateQueue,l.flags&=-2053,s.lanes&=~y,so(s,l,y)):(ln&&f&&Im(l),l.flags|=1,cr(s,l,u,y),l.child)}function hv(s,l,u,f,y){if(yr(u)){var w=!0;yh(l)}else w=!1;if(vl(l,y),l.stateNode===null)zh(s,l),ev(l,u,f),Xm(l,u,f,y),f=!0;else if(s===null){var E=l.stateNode,U=l.memoizedProps;E.props=U;var Y=E.context,ge=u.contextType;typeof ge=="object"&&ge!==null?ge=Qr(ge):(ge=yr(u)?Ys:Xn.current,ge=fl(l,ge));var Ee=u.getDerivedStateFromProps,Pe=typeof Ee=="function"||typeof E.getSnapshotBeforeUpdate=="function";Pe||typeof E.UNSAFE_componentWillReceiveProps!="function"&&typeof E.componentWillReceiveProps!="function"||(U!==f||Y!==ge)&&tv(l,E,f,ge),Go=!1;var Ce=l.memoizedState;E.state=Ce,jh(l,f,E,y),Y=l.memoizedState,U!==f||Ce!==Y||gr.current||Go?(typeof Ee=="function"&&(Ym(l,u,Ee,f),Y=l.memoizedState),(U=Go||Zb(l,u,U,f,Ce,Y,ge))?(Pe||typeof E.UNSAFE_componentWillMount!="function"&&typeof E.componentWillMount!="function"||(typeof E.componentWillMount=="function"&&E.componentWillMount(),typeof E.UNSAFE_componentWillMount=="function"&&E.UNSAFE_componentWillMount()),typeof E.componentDidMount=="function"&&(l.flags|=4194308)):(typeof E.componentDidMount=="function"&&(l.flags|=4194308),l.memoizedProps=f,l.memoizedState=Y),E.props=f,E.state=Y,E.context=ge,f=U):(typeof E.componentDidMount=="function"&&(l.flags|=4194308),f=!1)}else{E=l.stateNode,Cb(s,l),U=l.memoizedProps,ge=l.type===l.elementType?U:ci(l.type,U),E.props=ge,Pe=l.pendingProps,Ce=E.context,Y=u.contextType,typeof Y=="object"&&Y!==null?Y=Qr(Y):(Y=yr(u)?Ys:Xn.current,Y=fl(l,Y));var Qe=u.getDerivedStateFromProps;(Ee=typeof Qe=="function"||typeof E.getSnapshotBeforeUpdate=="function")||typeof E.UNSAFE_componentWillReceiveProps!="function"&&typeof E.componentWillReceiveProps!="function"||(U!==Pe||Ce!==Y)&&tv(l,E,f,Y),Go=!1,Ce=l.memoizedState,E.state=Ce,jh(l,f,E,y);var et=l.memoizedState;U!==Pe||Ce!==et||gr.current||Go?(typeof Qe=="function"&&(Ym(l,u,Qe,f),et=l.memoizedState),(ge=Go||Zb(l,u,ge,f,Ce,et,Y)||!1)?(Ee||typeof E.UNSAFE_componentWillUpdate!="function"&&typeof E.componentWillUpdate!="function"||(typeof E.componentWillUpdate=="function"&&E.componentWillUpdate(f,et,Y),typeof E.UNSAFE_componentWillUpdate=="function"&&E.UNSAFE_componentWillUpdate(f,et,Y)),typeof E.componentDidUpdate=="function"&&(l.flags|=4),typeof E.getSnapshotBeforeUpdate=="function"&&(l.flags|=1024)):(typeof E.componentDidUpdate!="function"||U===s.memoizedProps&&Ce===s.memoizedState||(l.flags|=4),typeof E.getSnapshotBeforeUpdate!="function"||U===s.memoizedProps&&Ce===s.memoizedState||(l.flags|=1024),l.memoizedProps=f,l.memoizedState=et),E.props=f,E.state=et,E.context=Y,f=ge):(typeof E.componentDidUpdate!="function"||U===s.memoizedProps&&Ce===s.memoizedState||(l.flags|=4),typeof E.getSnapshotBeforeUpdate!="function"||U===s.memoizedProps&&Ce===s.memoizedState||(l.flags|=1024),f=!1)}return tg(s,l,u,f,w,y)}function tg(s,l,u,f,y,w){dv(s,l);var E=(l.flags&128)!==0;if(!f&&!E)return y&&yb(l,u,!1),so(s,l,w);f=l.stateNode,lC.current=l;var U=E&&typeof u.getDerivedStateFromError!="function"?null:f.render();return l.flags|=1,s!==null&&E?(l.child=xl(l,s.child,null,w),l.child=xl(l,null,U,w)):cr(s,l,U,w),l.memoizedState=f.state,y&&yb(l,u,!0),l.child}function pv(s){var l=s.stateNode;l.pendingContext?mb(s,l.pendingContext,l.pendingContext!==l.context):l.context&&mb(s,l.context,!1),Mm(s,l.containerInfo)}function fv(s,l,u,f,y){return yl(),Am(y),l.flags|=256,cr(s,l,u,f),l.child}var ng={dehydrated:null,treeContext:null,retryLane:0};function rg(s){return{baseLanes:s,cachePool:null,transitions:null}}function mv(s,l,u){var f=l.pendingProps,y=hn.current,w=!1,E=(l.flags&128)!==0,U;if((U=E)||(U=s!==null&&s.memoizedState===null?!1:(y&2)!==0),U?(w=!0,l.flags&=-129):(s===null||s.memoizedState!==null)&&(y|=1),Qt(hn,y&1),s===null)return Em(l),s=l.memoizedState,s!==null&&(s=s.dehydrated,s!==null)?((l.mode&1)===0?l.lanes=1:s.data==="$!"?l.lanes=8:l.lanes=1073741824,null):(E=f.children,s=f.fallback,w?(f=l.mode,w=l.child,E={mode:"hidden",children:E},(f&1)===0&&w!==null?(w.childLanes=0,w.pendingProps=E):w=Gh(E,f,0,null),s=sa(s,f,u,null),w.return=l,s.return=l,w.sibling=s,l.child=w,l.child.memoizedState=rg(u),l.memoizedState=ng,s):ig(l,E));if(y=s.memoizedState,y!==null&&(U=y.dehydrated,U!==null))return cC(s,l,E,f,U,y,u);if(w){w=f.fallback,E=l.mode,y=s.child,U=y.sibling;var Y={mode:"hidden",children:f.children};return(E&1)===0&&l.child!==y?(f=l.child,f.childLanes=0,f.pendingProps=Y,l.deletions=null):(f=es(y,Y),f.subtreeFlags=y.subtreeFlags&14680064),U!==null?w=es(U,w):(w=sa(w,E,u,null),w.flags|=2),w.return=l,f.return=l,f.sibling=w,l.child=f,f=w,w=l.child,E=s.child.memoizedState,E=E===null?rg(u):{baseLanes:E.baseLanes|u,cachePool:null,transitions:E.transitions},w.memoizedState=E,w.childLanes=s.childLanes&~u,l.memoizedState=ng,f}return w=s.child,s=w.sibling,f=es(w,{mode:"visible",children:f.children}),(l.mode&1)===0&&(f.lanes=u),f.return=l,f.sibling=null,s!==null&&(u=l.deletions,u===null?(l.deletions=[s],l.flags|=16):u.push(s)),l.child=f,l.memoizedState=null,f}function ig(s,l){return l=Gh({mode:"visible",children:l},s.mode,0,null),l.return=s,s.child=l}function Fh(s,l,u,f){return f!==null&&Am(f),xl(l,s.child,null,u),s=ig(l,l.pendingProps.children),s.flags|=2,l.memoizedState=null,s}function cC(s,l,u,f,y,w,E){if(u)return l.flags&256?(l.flags&=-257,f=Jm(Error(t(422))),Fh(s,l,E,f)):l.memoizedState!==null?(l.child=s.child,l.flags|=128,null):(w=f.fallback,y=l.mode,f=Gh({mode:"visible",children:f.children},y,0,null),w=sa(w,y,E,null),w.flags|=2,f.return=l,w.return=l,f.sibling=w,l.child=f,(l.mode&1)!==0&&xl(l,s.child,null,E),l.child.memoizedState=rg(E),l.memoizedState=ng,w);if((l.mode&1)===0)return Fh(s,l,E,null);if(y.data==="$!"){if(f=y.nextSibling&&y.nextSibling.dataset,f)var U=f.dgst;return f=U,w=Error(t(419)),f=Jm(w,f,void 0),Fh(s,l,E,f)}if(U=(E&s.childLanes)!==0,xr||U){if(f=Nn,f!==null){switch(E&-E){case 4:y=2;break;case 16:y=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:y=32;break;case 536870912:y=268435456;break;default:y=0}y=(y&(f.suspendedLanes|E))!==0?0:y,y!==0&&y!==w.retryLane&&(w.retryLane=y,io(s,y),hi(f,s,y,-1))}return vg(),f=Jm(Error(t(421))),Fh(s,l,E,f)}return y.data==="$?"?(l.flags|=128,l.child=s.child,l=SC.bind(null,s),y._reactRetry=l,null):(s=w.treeContext,zr=Uo(y.nextSibling),Fr=l,ln=!0,li=null,s!==null&&(Gr[Kr++]=no,Gr[Kr++]=ro,Gr[Kr++]=Xs,no=s.id,ro=s.overflow,Xs=l),l=ig(l,f.children),l.flags|=4096,l)}function gv(s,l,u){s.lanes|=l;var f=s.alternate;f!==null&&(f.lanes|=l),zm(s.return,l,u)}function og(s,l,u,f,y){var w=s.memoizedState;w===null?s.memoizedState={isBackwards:l,rendering:null,renderingStartTime:0,last:f,tail:u,tailMode:y}:(w.isBackwards=l,w.rendering=null,w.renderingStartTime=0,w.last=f,w.tail=u,w.tailMode=y)}function yv(s,l,u){var f=l.pendingProps,y=f.revealOrder,w=f.tail;if(cr(s,l,f.children,u),f=hn.current,(f&2)!==0)f=f&1|2,l.flags|=128;else{if(s!==null&&(s.flags&128)!==0)e:for(s=l.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&gv(s,u,l);else if(s.tag===19)gv(s,u,l);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===l)break e;for(;s.sibling===null;){if(s.return===null||s.return===l)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}f&=1}if(Qt(hn,f),(l.mode&1)===0)l.memoizedState=null;else switch(y){case"forwards":for(u=l.child,y=null;u!==null;)s=u.alternate,s!==null&&Ih(s)===null&&(y=u),u=u.sibling;u=y,u===null?(y=l.child,l.child=null):(y=u.sibling,u.sibling=null),og(l,!1,y,u,w);break;case"backwards":for(u=null,y=l.child,l.child=null;y!==null;){if(s=y.alternate,s!==null&&Ih(s)===null){l.child=y;break}s=y.sibling,y.sibling=u,u=y,y=s}og(l,!0,u,null,w);break;case"together":og(l,!1,null,null,void 0);break;default:l.memoizedState=null}return l.child}function zh(s,l){(l.mode&1)===0&&s!==null&&(s.alternate=null,l.alternate=null,l.flags|=2)}function so(s,l,u){if(s!==null&&(l.dependencies=s.dependencies),na|=l.lanes,(u&l.childLanes)===0)return null;if(s!==null&&l.child!==s.child)throw Error(t(153));if(l.child!==null){for(s=l.child,u=es(s,s.pendingProps),l.child=u,u.return=l;s.sibling!==null;)s=s.sibling,u=u.sibling=es(s,s.pendingProps),u.return=l;u.sibling=null}return l.child}function uC(s,l,u){switch(l.tag){case 3:pv(l),yl();break;case 5:Ab(l);break;case 1:yr(l.type)&&yh(l);break;case 4:Mm(l,l.stateNode.containerInfo);break;case 10:var f=l.type._context,y=l.memoizedProps.value;Qt(kh,f._currentValue),f._currentValue=y;break;case 13:if(f=l.memoizedState,f!==null)return f.dehydrated!==null?(Qt(hn,hn.current&1),l.flags|=128,null):(u&l.child.childLanes)!==0?mv(s,l,u):(Qt(hn,hn.current&1),s=so(s,l,u),s!==null?s.sibling:null);Qt(hn,hn.current&1);break;case 19:if(f=(u&l.childLanes)!==0,(s.flags&128)!==0){if(f)return yv(s,l,u);l.flags|=128}if(y=l.memoizedState,y!==null&&(y.rendering=null,y.tail=null,y.lastEffect=null),Qt(hn,hn.current),f)break;return null;case 22:case 23:return l.lanes=0,uv(s,l,u)}return so(s,l,u)}var xv,sg,bv,vv;xv=function(s,l){for(var u=l.child;u!==null;){if(u.tag===5||u.tag===6)s.appendChild(u.stateNode);else if(u.tag!==4&&u.child!==null){u.child.return=u,u=u.child;continue}if(u===l)break;for(;u.sibling===null;){if(u.return===null||u.return===l)return;u=u.return}u.sibling.return=u.return,u=u.sibling}},sg=function(){},bv=function(s,l,u,f){var y=s.memoizedProps;if(y!==f){s=l.stateNode,ea(Ii.current);var w=null;switch(u){case"input":y=Je(s,y),f=Je(s,f),w=[];break;case"select":y=Q({},y,{value:void 0}),f=Q({},f,{value:void 0}),w=[];break;case"textarea":y=re(s,y),f=re(s,f),w=[];break;default:typeof y.onClick!="function"&&typeof f.onClick=="function"&&(s.onclick=fh)}de(u,f);var E;u=null;for(ge in y)if(!f.hasOwnProperty(ge)&&y.hasOwnProperty(ge)&&y[ge]!=null)if(ge==="style"){var U=y[ge];for(E in U)U.hasOwnProperty(E)&&(u||(u={}),u[E]="")}else ge!=="dangerouslySetInnerHTML"&&ge!=="children"&&ge!=="suppressContentEditableWarning"&&ge!=="suppressHydrationWarning"&&ge!=="autoFocus"&&(o.hasOwnProperty(ge)?w||(w=[]):(w=w||[]).push(ge,null));for(ge in f){var Y=f[ge];if(U=y!=null?y[ge]:void 0,f.hasOwnProperty(ge)&&Y!==U&&(Y!=null||U!=null))if(ge==="style")if(U){for(E in U)!U.hasOwnProperty(E)||Y&&Y.hasOwnProperty(E)||(u||(u={}),u[E]="");for(E in Y)Y.hasOwnProperty(E)&&U[E]!==Y[E]&&(u||(u={}),u[E]=Y[E])}else u||(w||(w=[]),w.push(ge,u)),u=Y;else ge==="dangerouslySetInnerHTML"?(Y=Y?Y.__html:void 0,U=U?U.__html:void 0,Y!=null&&U!==Y&&(w=w||[]).push(ge,Y)):ge==="children"?typeof Y!="string"&&typeof Y!="number"||(w=w||[]).push(ge,""+Y):ge!=="suppressContentEditableWarning"&&ge!=="suppressHydrationWarning"&&(o.hasOwnProperty(ge)?(Y!=null&&ge==="onScroll"&&Jt("scroll",s),w||U===Y||(w=[])):(w=w||[]).push(ge,Y))}u&&(w=w||[]).push("style",u);var ge=w;(l.updateQueue=ge)&&(l.flags|=4)}},vv=function(s,l,u,f){u!==f&&(l.flags|=4)};function hu(s,l){if(!ln)switch(s.tailMode){case"hidden":l=s.tail;for(var u=null;l!==null;)l.alternate!==null&&(u=l),l=l.sibling;u===null?s.tail=null:u.sibling=null;break;case"collapsed":u=s.tail;for(var f=null;u!==null;)u.alternate!==null&&(f=u),u=u.sibling;f===null?l||s.tail===null?s.tail=null:s.tail.sibling=null:f.sibling=null}}function Zn(s){var l=s.alternate!==null&&s.alternate.child===s.child,u=0,f=0;if(l)for(var y=s.child;y!==null;)u|=y.lanes|y.childLanes,f|=y.subtreeFlags&14680064,f|=y.flags&14680064,y.return=s,y=y.sibling;else for(y=s.child;y!==null;)u|=y.lanes|y.childLanes,f|=y.subtreeFlags,f|=y.flags,y.return=s,y=y.sibling;return s.subtreeFlags|=f,s.childLanes=u,l}function dC(s,l,u){var f=l.pendingProps;switch(Cm(l),l.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Zn(l),null;case 1:return yr(l.type)&&gh(),Zn(l),null;case 3:return f=l.stateNode,wl(),Zt(gr),Zt(Xn),Wm(),f.pendingContext&&(f.context=f.pendingContext,f.pendingContext=null),(s===null||s.child===null)&&(wh(l)?l.flags|=4:s===null||s.memoizedState.isDehydrated&&(l.flags&256)===0||(l.flags|=1024,li!==null&&(yg(li),li=null))),sg(s,l),Zn(l),null;case 5:Lm(l);var y=ea(au.current);if(u=l.type,s!==null&&l.stateNode!=null)bv(s,l,u,f,y),s.ref!==l.ref&&(l.flags|=512,l.flags|=2097152);else{if(!f){if(l.stateNode===null)throw Error(t(166));return Zn(l),null}if(s=ea(Ii.current),wh(l)){f=l.stateNode,u=l.type;var w=l.memoizedProps;switch(f[ji]=l,f[nu]=w,s=(l.mode&1)!==0,u){case"dialog":Jt("cancel",f),Jt("close",f);break;case"iframe":case"object":case"embed":Jt("load",f);break;case"video":case"audio":for(y=0;y<Zc.length;y++)Jt(Zc[y],f);break;case"source":Jt("error",f);break;case"img":case"image":case"link":Jt("error",f),Jt("load",f);break;case"details":Jt("toggle",f);break;case"input":He(f,w),Jt("invalid",f);break;case"select":f._wrapperState={wasMultiple:!!w.multiple},Jt("invalid",f);break;case"textarea":H(f,w),Jt("invalid",f)}de(u,w),y=null;for(var E in w)if(w.hasOwnProperty(E)){var U=w[E];E==="children"?typeof U=="string"?f.textContent!==U&&(w.suppressHydrationWarning!==!0&&ph(f.textContent,U,s),y=["children",U]):typeof U=="number"&&f.textContent!==""+U&&(w.suppressHydrationWarning!==!0&&ph(f.textContent,U,s),y=["children",""+U]):o.hasOwnProperty(E)&&U!=null&&E==="onScroll"&&Jt("scroll",f)}switch(u){case"input":me(f),_e(f,w,!0);break;case"textarea":me(f),ue(f);break;case"select":case"option":break;default:typeof w.onClick=="function"&&(f.onclick=fh)}f=y,l.updateQueue=f,f!==null&&(l.flags|=4)}else{E=y.nodeType===9?y:y.ownerDocument,s==="http://www.w3.org/1999/xhtml"&&(s=le(u)),s==="http://www.w3.org/1999/xhtml"?u==="script"?(s=E.createElement("div"),s.innerHTML="<script><\/script>",s=s.removeChild(s.firstChild)):typeof f.is=="string"?s=E.createElement(u,{is:f.is}):(s=E.createElement(u),u==="select"&&(E=s,f.multiple?E.multiple=!0:f.size&&(E.size=f.size))):s=E.createElementNS(s,u),s[ji]=l,s[nu]=f,xv(s,l,!1,!1),l.stateNode=s;e:{switch(E=De(u,f),u){case"dialog":Jt("cancel",s),Jt("close",s),y=f;break;case"iframe":case"object":case"embed":Jt("load",s),y=f;break;case"video":case"audio":for(y=0;y<Zc.length;y++)Jt(Zc[y],s);y=f;break;case"source":Jt("error",s),y=f;break;case"img":case"image":case"link":Jt("error",s),Jt("load",s),y=f;break;case"details":Jt("toggle",s),y=f;break;case"input":He(s,f),y=Je(s,f),Jt("invalid",s);break;case"option":y=f;break;case"select":s._wrapperState={wasMultiple:!!f.multiple},y=Q({},f,{value:void 0}),Jt("invalid",s);break;case"textarea":H(s,f),y=re(s,f),Jt("invalid",s);break;default:y=f}de(u,y),U=y;for(w in U)if(U.hasOwnProperty(w)){var Y=U[w];w==="style"?at(s,Y):w==="dangerouslySetInnerHTML"?(Y=Y?Y.__html:void 0,Y!=null&&xe(s,Y)):w==="children"?typeof Y=="string"?(u!=="textarea"||Y!=="")&&Ae(s,Y):typeof Y=="number"&&Ae(s,""+Y):w!=="suppressContentEditableWarning"&&w!=="suppressHydrationWarning"&&w!=="autoFocus"&&(o.hasOwnProperty(w)?Y!=null&&w==="onScroll"&&Jt("scroll",s):Y!=null&&B(s,w,Y,E))}switch(u){case"input":me(s),_e(s,f,!1);break;case"textarea":me(s),ue(s);break;case"option":f.value!=null&&s.setAttribute("value",""+Ne(f.value));break;case"select":s.multiple=!!f.multiple,w=f.value,w!=null?K(s,!!f.multiple,w,!1):f.defaultValue!=null&&K(s,!!f.multiple,f.defaultValue,!0);break;default:typeof y.onClick=="function"&&(s.onclick=fh)}switch(u){case"button":case"input":case"select":case"textarea":f=!!f.autoFocus;break e;case"img":f=!0;break e;default:f=!1}}f&&(l.flags|=4)}l.ref!==null&&(l.flags|=512,l.flags|=2097152)}return Zn(l),null;case 6:if(s&&l.stateNode!=null)vv(s,l,s.memoizedProps,f);else{if(typeof f!="string"&&l.stateNode===null)throw Error(t(166));if(u=ea(au.current),ea(Ii.current),wh(l)){if(f=l.stateNode,u=l.memoizedProps,f[ji]=l,(w=f.nodeValue!==u)&&(s=Fr,s!==null))switch(s.tag){case 3:ph(f.nodeValue,u,(s.mode&1)!==0);break;case 5:s.memoizedProps.suppressHydrationWarning!==!0&&ph(f.nodeValue,u,(s.mode&1)!==0)}w&&(l.flags|=4)}else f=(u.nodeType===9?u:u.ownerDocument).createTextNode(f),f[ji]=l,l.stateNode=f}return Zn(l),null;case 13:if(Zt(hn),f=l.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(ln&&zr!==null&&(l.mode&1)!==0&&(l.flags&128)===0)kb(),yl(),l.flags|=98560,w=!1;else if(w=wh(l),f!==null&&f.dehydrated!==null){if(s===null){if(!w)throw Error(t(318));if(w=l.memoizedState,w=w!==null?w.dehydrated:null,!w)throw Error(t(317));w[ji]=l}else yl(),(l.flags&128)===0&&(l.memoizedState=null),l.flags|=4;Zn(l),w=!1}else li!==null&&(yg(li),li=null),w=!0;if(!w)return l.flags&65536?l:null}return(l.flags&128)!==0?(l.lanes=u,l):(f=f!==null,f!==(s!==null&&s.memoizedState!==null)&&f&&(l.child.flags|=8192,(l.mode&1)!==0&&(s===null||(hn.current&1)!==0?In===0&&(In=3):vg())),l.updateQueue!==null&&(l.flags|=4),Zn(l),null);case 4:return wl(),sg(s,l),s===null&&eu(l.stateNode.containerInfo),Zn(l),null;case 10:return Fm(l.type._context),Zn(l),null;case 17:return yr(l.type)&&gh(),Zn(l),null;case 19:if(Zt(hn),w=l.memoizedState,w===null)return Zn(l),null;if(f=(l.flags&128)!==0,E=w.rendering,E===null)if(f)hu(w,!1);else{if(In!==0||s!==null&&(s.flags&128)!==0)for(s=l.child;s!==null;){if(E=Ih(s),E!==null){for(l.flags|=128,hu(w,!1),f=E.updateQueue,f!==null&&(l.updateQueue=f,l.flags|=4),l.subtreeFlags=0,f=u,u=l.child;u!==null;)w=u,s=f,w.flags&=14680066,E=w.alternate,E===null?(w.childLanes=0,w.lanes=s,w.child=null,w.subtreeFlags=0,w.memoizedProps=null,w.memoizedState=null,w.updateQueue=null,w.dependencies=null,w.stateNode=null):(w.childLanes=E.childLanes,w.lanes=E.lanes,w.child=E.child,w.subtreeFlags=0,w.deletions=null,w.memoizedProps=E.memoizedProps,w.memoizedState=E.memoizedState,w.updateQueue=E.updateQueue,w.type=E.type,s=E.dependencies,w.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext}),u=u.sibling;return Qt(hn,hn.current&1|2),l.child}s=s.sibling}w.tail!==null&&Kt()>_l&&(l.flags|=128,f=!0,hu(w,!1),l.lanes=4194304)}else{if(!f)if(s=Ih(E),s!==null){if(l.flags|=128,f=!0,u=s.updateQueue,u!==null&&(l.updateQueue=u,l.flags|=4),hu(w,!0),w.tail===null&&w.tailMode==="hidden"&&!E.alternate&&!ln)return Zn(l),null}else 2*Kt()-w.renderingStartTime>_l&&u!==1073741824&&(l.flags|=128,f=!0,hu(w,!1),l.lanes=4194304);w.isBackwards?(E.sibling=l.child,l.child=E):(u=w.last,u!==null?u.sibling=E:l.child=E,w.last=E)}return w.tail!==null?(l=w.tail,w.rendering=l,w.tail=l.sibling,w.renderingStartTime=Kt(),l.sibling=null,u=hn.current,Qt(hn,f?u&1|2:u&1),l):(Zn(l),null);case 22:case 23:return bg(),f=l.memoizedState!==null,s!==null&&s.memoizedState!==null!==f&&(l.flags|=8192),f&&(l.mode&1)!==0?(Dr&1073741824)!==0&&(Zn(l),l.subtreeFlags&6&&(l.flags|=8192)):Zn(l),null;case 24:return null;case 25:return null}throw Error(t(156,l.tag))}function hC(s,l){switch(Cm(l),l.tag){case 1:return yr(l.type)&&gh(),s=l.flags,s&65536?(l.flags=s&-65537|128,l):null;case 3:return wl(),Zt(gr),Zt(Xn),Wm(),s=l.flags,(s&65536)!==0&&(s&128)===0?(l.flags=s&-65537|128,l):null;case 5:return Lm(l),null;case 13:if(Zt(hn),s=l.memoizedState,s!==null&&s.dehydrated!==null){if(l.alternate===null)throw Error(t(340));yl()}return s=l.flags,s&65536?(l.flags=s&-65537|128,l):null;case 19:return Zt(hn),null;case 4:return wl(),null;case 10:return Fm(l.type._context),null;case 22:case 23:return bg(),null;case 24:return null;default:return null}}var Dh=!1,er=!1,pC=typeof WeakSet=="function"?WeakSet:Set,Ze=null;function kl(s,l){var u=s.ref;if(u!==null)if(typeof u=="function")try{u(null)}catch(f){gn(s,l,f)}else u.current=null}function ag(s,l,u){try{u()}catch(f){gn(s,l,f)}}var wv=!1;function fC(s,l){if(bm=Oo,s=Z0(),dm(s)){if("selectionStart"in s)var u={start:s.selectionStart,end:s.selectionEnd};else e:{u=(u=s.ownerDocument)&&u.defaultView||window;var f=u.getSelection&&u.getSelection();if(f&&f.rangeCount!==0){u=f.anchorNode;var y=f.anchorOffset,w=f.focusNode;f=f.focusOffset;try{u.nodeType,w.nodeType}catch{u=null;break e}var E=0,U=-1,Y=-1,ge=0,Ee=0,Pe=s,Ce=null;t:for(;;){for(var Qe;Pe!==u||y!==0&&Pe.nodeType!==3||(U=E+y),Pe!==w||f!==0&&Pe.nodeType!==3||(Y=E+f),Pe.nodeType===3&&(E+=Pe.nodeValue.length),(Qe=Pe.firstChild)!==null;)Ce=Pe,Pe=Qe;for(;;){if(Pe===s)break t;if(Ce===u&&++ge===y&&(U=E),Ce===w&&++Ee===f&&(Y=E),(Qe=Pe.nextSibling)!==null)break;Pe=Ce,Ce=Pe.parentNode}Pe=Qe}u=U===-1||Y===-1?null:{start:U,end:Y}}else u=null}u=u||{start:0,end:0}}else u=null;for(vm={focusedElem:s,selectionRange:u},Oo=!1,Ze=l;Ze!==null;)if(l=Ze,s=l.child,(l.subtreeFlags&1028)!==0&&s!==null)s.return=l,Ze=s;else for(;Ze!==null;){l=Ze;try{var et=l.alternate;if((l.flags&1024)!==0)switch(l.tag){case 0:case 11:case 15:break;case 1:if(et!==null){var nt=et.memoizedProps,xn=et.memoizedState,ce=l.stateNode,Z=ce.getSnapshotBeforeUpdate(l.elementType===l.type?nt:ci(l.type,nt),xn);ce.__reactInternalSnapshotBeforeUpdate=Z}break;case 3:var he=l.stateNode.containerInfo;he.nodeType===1?he.textContent="":he.nodeType===9&&he.documentElement&&he.removeChild(he.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(ze){gn(l,l.return,ze)}if(s=l.sibling,s!==null){s.return=l.return,Ze=s;break}Ze=l.return}return et=wv,wv=!1,et}function pu(s,l,u){var f=l.updateQueue;if(f=f!==null?f.lastEffect:null,f!==null){var y=f=f.next;do{if((y.tag&s)===s){var w=y.destroy;y.destroy=void 0,w!==void 0&&ag(l,u,w)}y=y.next}while(y!==f)}}function Nh(s,l){if(l=l.updateQueue,l=l!==null?l.lastEffect:null,l!==null){var u=l=l.next;do{if((u.tag&s)===s){var f=u.create;u.destroy=f()}u=u.next}while(u!==l)}}function lg(s){var l=s.ref;if(l!==null){var u=s.stateNode;switch(s.tag){case 5:s=u;break;default:s=u}typeof l=="function"?l(s):l.current=s}}function Sv(s){var l=s.alternate;l!==null&&(s.alternate=null,Sv(l)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(l=s.stateNode,l!==null&&(delete l[ji],delete l[nu],delete l[Tm],delete l[YI],delete l[XI])),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}function kv(s){return s.tag===5||s.tag===3||s.tag===4}function Tv(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||kv(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function cg(s,l,u){var f=s.tag;if(f===5||f===6)s=s.stateNode,l?u.nodeType===8?u.parentNode.insertBefore(s,l):u.insertBefore(s,l):(u.nodeType===8?(l=u.parentNode,l.insertBefore(s,u)):(l=u,l.appendChild(s)),u=u._reactRootContainer,u!=null||l.onclick!==null||(l.onclick=fh));else if(f!==4&&(s=s.child,s!==null))for(cg(s,l,u),s=s.sibling;s!==null;)cg(s,l,u),s=s.sibling}function ug(s,l,u){var f=s.tag;if(f===5||f===6)s=s.stateNode,l?u.insertBefore(s,l):u.appendChild(s);else if(f!==4&&(s=s.child,s!==null))for(ug(s,l,u),s=s.sibling;s!==null;)ug(s,l,u),s=s.sibling}var Gn=null,ui=!1;function Qo(s,l,u){for(u=u.child;u!==null;)_v(s,l,u),u=u.sibling}function _v(s,l,u){if(Er&&typeof Er.onCommitFiberUnmount=="function")try{Er.onCommitFiberUnmount(Vs,u)}catch{}switch(u.tag){case 5:er||kl(u,l);case 6:var f=Gn,y=ui;Gn=null,Qo(s,l,u),Gn=f,ui=y,Gn!==null&&(ui?(s=Gn,u=u.stateNode,s.nodeType===8?s.parentNode.removeChild(u):s.removeChild(u)):Gn.removeChild(u.stateNode));break;case 18:Gn!==null&&(ui?(s=Gn,u=u.stateNode,s.nodeType===8?km(s.parentNode,u):s.nodeType===1&&km(s,u),oi(s)):km(Gn,u.stateNode));break;case 4:f=Gn,y=ui,Gn=u.stateNode.containerInfo,ui=!0,Qo(s,l,u),Gn=f,ui=y;break;case 0:case 11:case 14:case 15:if(!er&&(f=u.updateQueue,f!==null&&(f=f.lastEffect,f!==null))){y=f=f.next;do{var w=y,E=w.destroy;w=w.tag,E!==void 0&&((w&2)!==0||(w&4)!==0)&&ag(u,l,E),y=y.next}while(y!==f)}Qo(s,l,u);break;case 1:if(!er&&(kl(u,l),f=u.stateNode,typeof f.componentWillUnmount=="function"))try{f.props=u.memoizedProps,f.state=u.memoizedState,f.componentWillUnmount()}catch(U){gn(u,l,U)}Qo(s,l,u);break;case 21:Qo(s,l,u);break;case 22:u.mode&1?(er=(f=er)||u.memoizedState!==null,Qo(s,l,u),er=f):Qo(s,l,u);break;default:Qo(s,l,u)}}function jv(s){var l=s.updateQueue;if(l!==null){s.updateQueue=null;var u=s.stateNode;u===null&&(u=s.stateNode=new pC),l.forEach(function(f){var y=kC.bind(null,s,f);u.has(f)||(u.add(f),f.then(y,y))})}}function di(s,l){var u=l.deletions;if(u!==null)for(var f=0;f<u.length;f++){var y=u[f];try{var w=s,E=l,U=E;e:for(;U!==null;){switch(U.tag){case 5:Gn=U.stateNode,ui=!1;break e;case 3:Gn=U.stateNode.containerInfo,ui=!0;break e;case 4:Gn=U.stateNode.containerInfo,ui=!0;break e}U=U.return}if(Gn===null)throw Error(t(160));_v(w,E,y),Gn=null,ui=!1;var Y=y.alternate;Y!==null&&(Y.return=null),y.return=null}catch(ge){gn(y,l,ge)}}if(l.subtreeFlags&12854)for(l=l.child;l!==null;)Iv(l,s),l=l.sibling}function Iv(s,l){var u=s.alternate,f=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:if(di(l,s),Ri(s),f&4){try{pu(3,s,s.return),Nh(3,s)}catch(nt){gn(s,s.return,nt)}try{pu(5,s,s.return)}catch(nt){gn(s,s.return,nt)}}break;case 1:di(l,s),Ri(s),f&512&&u!==null&&kl(u,u.return);break;case 5:if(di(l,s),Ri(s),f&512&&u!==null&&kl(u,u.return),s.flags&32){var y=s.stateNode;try{Ae(y,"")}catch(nt){gn(s,s.return,nt)}}if(f&4&&(y=s.stateNode,y!=null)){var w=s.memoizedProps,E=u!==null?u.memoizedProps:w,U=s.type,Y=s.updateQueue;if(s.updateQueue=null,Y!==null)try{U==="input"&&w.type==="radio"&&w.name!=null&&fe(y,w),De(U,E);var ge=De(U,w);for(E=0;E<Y.length;E+=2){var Ee=Y[E],Pe=Y[E+1];Ee==="style"?at(y,Pe):Ee==="dangerouslySetInnerHTML"?xe(y,Pe):Ee==="children"?Ae(y,Pe):B(y,Ee,Pe,ge)}switch(U){case"input":Te(y,w);break;case"textarea":Ue(y,w);break;case"select":var Ce=y._wrapperState.wasMultiple;y._wrapperState.wasMultiple=!!w.multiple;var Qe=w.value;Qe!=null?K(y,!!w.multiple,Qe,!1):Ce!==!!w.multiple&&(w.defaultValue!=null?K(y,!!w.multiple,w.defaultValue,!0):K(y,!!w.multiple,w.multiple?[]:"",!1))}y[nu]=w}catch(nt){gn(s,s.return,nt)}}break;case 6:if(di(l,s),Ri(s),f&4){if(s.stateNode===null)throw Error(t(162));y=s.stateNode,w=s.memoizedProps;try{y.nodeValue=w}catch(nt){gn(s,s.return,nt)}}break;case 3:if(di(l,s),Ri(s),f&4&&u!==null&&u.memoizedState.isDehydrated)try{oi(l.containerInfo)}catch(nt){gn(s,s.return,nt)}break;case 4:di(l,s),Ri(s);break;case 13:di(l,s),Ri(s),y=s.child,y.flags&8192&&(w=y.memoizedState!==null,y.stateNode.isHidden=w,!w||y.alternate!==null&&y.alternate.memoizedState!==null||(pg=Kt())),f&4&&jv(s);break;case 22:if(Ee=u!==null&&u.memoizedState!==null,s.mode&1?(er=(ge=er)||Ee,di(l,s),er=ge):di(l,s),Ri(s),f&8192){if(ge=s.memoizedState!==null,(s.stateNode.isHidden=ge)&&!Ee&&(s.mode&1)!==0)for(Ze=s,Ee=s.child;Ee!==null;){for(Pe=Ze=Ee;Ze!==null;){switch(Ce=Ze,Qe=Ce.child,Ce.tag){case 0:case 11:case 14:case 15:pu(4,Ce,Ce.return);break;case 1:kl(Ce,Ce.return);var et=Ce.stateNode;if(typeof et.componentWillUnmount=="function"){f=Ce,u=Ce.return;try{l=f,et.props=l.memoizedProps,et.state=l.memoizedState,et.componentWillUnmount()}catch(nt){gn(f,u,nt)}}break;case 5:kl(Ce,Ce.return);break;case 22:if(Ce.memoizedState!==null){Ev(Pe);continue}}Qe!==null?(Qe.return=Ce,Ze=Qe):Ev(Pe)}Ee=Ee.sibling}e:for(Ee=null,Pe=s;;){if(Pe.tag===5){if(Ee===null){Ee=Pe;try{y=Pe.stateNode,ge?(w=y.style,typeof w.setProperty=="function"?w.setProperty("display","none","important"):w.display="none"):(U=Pe.stateNode,Y=Pe.memoizedProps.style,E=Y!=null&&Y.hasOwnProperty("display")?Y.display:null,U.style.display=ke("display",E))}catch(nt){gn(s,s.return,nt)}}}else if(Pe.tag===6){if(Ee===null)try{Pe.stateNode.nodeValue=ge?"":Pe.memoizedProps}catch(nt){gn(s,s.return,nt)}}else if((Pe.tag!==22&&Pe.tag!==23||Pe.memoizedState===null||Pe===s)&&Pe.child!==null){Pe.child.return=Pe,Pe=Pe.child;continue}if(Pe===s)break e;for(;Pe.sibling===null;){if(Pe.return===null||Pe.return===s)break e;Ee===Pe&&(Ee=null),Pe=Pe.return}Ee===Pe&&(Ee=null),Pe.sibling.return=Pe.return,Pe=Pe.sibling}}break;case 19:di(l,s),Ri(s),f&4&&jv(s);break;case 21:break;default:di(l,s),Ri(s)}}function Ri(s){var l=s.flags;if(l&2){try{e:{for(var u=s.return;u!==null;){if(kv(u)){var f=u;break e}u=u.return}throw Error(t(160))}switch(f.tag){case 5:var y=f.stateNode;f.flags&32&&(Ae(y,""),f.flags&=-33);var w=Tv(s);ug(s,w,y);break;case 3:case 4:var E=f.stateNode.containerInfo,U=Tv(s);cg(s,U,E);break;default:throw Error(t(161))}}catch(Y){gn(s,s.return,Y)}s.flags&=-3}l&4096&&(s.flags&=-4097)}function mC(s,l,u){Ze=s,Cv(s)}function Cv(s,l,u){for(var f=(s.mode&1)!==0;Ze!==null;){var y=Ze,w=y.child;if(y.tag===22&&f){var E=y.memoizedState!==null||Dh;if(!E){var U=y.alternate,Y=U!==null&&U.memoizedState!==null||er;U=Dh;var ge=er;if(Dh=E,(er=Y)&&!ge)for(Ze=y;Ze!==null;)E=Ze,Y=E.child,E.tag===22&&E.memoizedState!==null?Av(y):Y!==null?(Y.return=E,Ze=Y):Av(y);for(;w!==null;)Ze=w,Cv(w),w=w.sibling;Ze=y,Dh=U,er=ge}Rv(s)}else(y.subtreeFlags&8772)!==0&&w!==null?(w.return=y,Ze=w):Rv(s)}}function Rv(s){for(;Ze!==null;){var l=Ze;if((l.flags&8772)!==0){var u=l.alternate;try{if((l.flags&8772)!==0)switch(l.tag){case 0:case 11:case 15:er||Nh(5,l);break;case 1:var f=l.stateNode;if(l.flags&4&&!er)if(u===null)f.componentDidMount();else{var y=l.elementType===l.type?u.memoizedProps:ci(l.type,u.memoizedProps);f.componentDidUpdate(y,u.memoizedState,f.__reactInternalSnapshotBeforeUpdate)}var w=l.updateQueue;w!==null&&Eb(l,w,f);break;case 3:var E=l.updateQueue;if(E!==null){if(u=null,l.child!==null)switch(l.child.tag){case 5:u=l.child.stateNode;break;case 1:u=l.child.stateNode}Eb(l,E,u)}break;case 5:var U=l.stateNode;if(u===null&&l.flags&4){u=U;var Y=l.memoizedProps;switch(l.type){case"button":case"input":case"select":case"textarea":Y.autoFocus&&u.focus();break;case"img":Y.src&&(u.src=Y.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(l.memoizedState===null){var ge=l.alternate;if(ge!==null){var Ee=ge.memoizedState;if(Ee!==null){var Pe=Ee.dehydrated;Pe!==null&&oi(Pe)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}er||l.flags&512&&lg(l)}catch(Ce){gn(l,l.return,Ce)}}if(l===s){Ze=null;break}if(u=l.sibling,u!==null){u.return=l.return,Ze=u;break}Ze=l.return}}function Ev(s){for(;Ze!==null;){var l=Ze;if(l===s){Ze=null;break}var u=l.sibling;if(u!==null){u.return=l.return,Ze=u;break}Ze=l.return}}function Av(s){for(;Ze!==null;){var l=Ze;try{switch(l.tag){case 0:case 11:case 15:var u=l.return;try{Nh(4,l)}catch(Y){gn(l,u,Y)}break;case 1:var f=l.stateNode;if(typeof f.componentDidMount=="function"){var y=l.return;try{f.componentDidMount()}catch(Y){gn(l,y,Y)}}var w=l.return;try{lg(l)}catch(Y){gn(l,w,Y)}break;case 5:var E=l.return;try{lg(l)}catch(Y){gn(l,E,Y)}}}catch(Y){gn(l,l.return,Y)}if(l===s){Ze=null;break}var U=l.sibling;if(U!==null){U.return=l.return,Ze=U;break}Ze=l.return}}var gC=Math.ceil,Mh=q.ReactCurrentDispatcher,dg=q.ReactCurrentOwner,Xr=q.ReactCurrentBatchConfig,Bt=0,Nn=null,kn=null,Kn=0,Dr=0,Tl=qo(0),In=0,fu=null,na=0,Lh=0,hg=0,mu=null,br=null,pg=0,_l=1/0,ao=null,Oh=!1,fg=null,Yo=null,Wh=!1,Xo=null,Vh=0,gu=0,mg=null,Uh=-1,qh=0;function ur(){return(Bt&6)!==0?Kt():Uh!==-1?Uh:Uh=Kt()}function Jo(s){return(s.mode&1)===0?1:(Bt&2)!==0&&Kn!==0?Kn&-Kn:ZI.transition!==null?(qh===0&&(qh=qs()),qh):(s=Rt,s!==0||(s=window.event,s=s===void 0?16:qc(s.type)),s)}function hi(s,l,u,f){if(50<gu)throw gu=0,mg=null,Error(t(185));Do(s,u,f),((Bt&2)===0||s!==Nn)&&(s===Nn&&((Bt&2)===0&&(Lh|=u),In===4&&Zo(s,Kn)),vr(s,f),u===1&&Bt===0&&(l.mode&1)===0&&(_l=Kt()+500,xh&&$o()))}function vr(s,l){var u=s.callbackNode;Qi(s,l);var f=Us(s,s===Nn?Kn:0);if(f===0)u!==null&&Lc(u),s.callbackNode=null,s.callbackPriority=0;else if(l=f&-f,s.callbackPriority!==l){if(u!=null&&Lc(u),l===1)s.tag===0?JI(Bv.bind(null,s)):xb(Bv.bind(null,s)),KI(function(){(Bt&6)===0&&$o()}),u=null;else{switch(Mo(f)){case 1:u=Ws;break;case 4:u=Bo;break;case 16:u=qr;break;case 536870912:u=qd;break;default:u=qr}u=Wv(u,Pv.bind(null,s))}s.callbackPriority=l,s.callbackNode=u}}function Pv(s,l){if(Uh=-1,qh=0,(Bt&6)!==0)throw Error(t(327));var u=s.callbackNode;if(jl()&&s.callbackNode!==u)return null;var f=Us(s,s===Nn?Kn:0);if(f===0)return null;if((f&30)!==0||(f&s.expiredLanes)!==0||l)l=Hh(s,f);else{l=f;var y=Bt;Bt|=2;var w=zv();(Nn!==s||Kn!==l)&&(ao=null,_l=Kt()+500,ia(s,l));do try{bC();break}catch(U){Fv(s,U)}while(!0);Bm(),Mh.current=w,Bt=y,kn!==null?l=0:(Nn=null,Kn=0,l=In)}if(l!==0){if(l===2&&(y=Ar(s),y!==0&&(f=y,l=gg(s,y))),l===1)throw u=fu,ia(s,0),Zo(s,f),vr(s,Kt()),u;if(l===6)Zo(s,f);else{if(y=s.current.alternate,(f&30)===0&&!yC(y)&&(l=Hh(s,f),l===2&&(w=Ar(s),w!==0&&(f=w,l=gg(s,w))),l===1))throw u=fu,ia(s,0),Zo(s,f),vr(s,Kt()),u;switch(s.finishedWork=y,s.finishedLanes=f,l){case 0:case 1:throw Error(t(345));case 2:oa(s,br,ao);break;case 3:if(Zo(s,f),(f&130023424)===f&&(l=pg+500-Kt(),10<l)){if(Us(s,0)!==0)break;if(y=s.suspendedLanes,(y&f)!==f){ur(),s.pingedLanes|=s.suspendedLanes&y;break}s.timeoutHandle=Sm(oa.bind(null,s,br,ao),l);break}oa(s,br,ao);break;case 4:if(Zo(s,f),(f&4194240)===f)break;for(l=s.eventTimes,y=-1;0<f;){var E=31-ar(f);w=1<<E,E=l[E],E>y&&(y=E),f&=~w}if(f=y,f=Kt()-f,f=(120>f?120:480>f?480:1080>f?1080:1920>f?1920:3e3>f?3e3:4320>f?4320:1960*gC(f/1960))-f,10<f){s.timeoutHandle=Sm(oa.bind(null,s,br,ao),f);break}oa(s,br,ao);break;case 5:oa(s,br,ao);break;default:throw Error(t(329))}}}return vr(s,Kt()),s.callbackNode===u?Pv.bind(null,s):null}function gg(s,l){var u=mu;return s.current.memoizedState.isDehydrated&&(ia(s,l).flags|=256),s=Hh(s,l),s!==2&&(l=br,br=u,l!==null&&yg(l)),s}function yg(s){br===null?br=s:br.push.apply(br,s)}function yC(s){for(var l=s;;){if(l.flags&16384){var u=l.updateQueue;if(u!==null&&(u=u.stores,u!==null))for(var f=0;f<u.length;f++){var y=u[f],w=y.getSnapshot;y=y.value;try{if(!ai(w(),y))return!1}catch{return!1}}}if(u=l.child,l.subtreeFlags&16384&&u!==null)u.return=l,l=u;else{if(l===s)break;for(;l.sibling===null;){if(l.return===null||l.return===s)return!0;l=l.return}l.sibling.return=l.return,l=l.sibling}}return!0}function Zo(s,l){for(l&=~hg,l&=~Lh,s.suspendedLanes|=l,s.pingedLanes&=~l,s=s.expirationTimes;0<l;){var u=31-ar(l),f=1<<u;s[u]=-1,l&=~f}}function Bv(s){if((Bt&6)!==0)throw Error(t(327));jl();var l=Us(s,0);if((l&1)===0)return vr(s,Kt()),null;var u=Hh(s,l);if(s.tag!==0&&u===2){var f=Ar(s);f!==0&&(l=f,u=gg(s,f))}if(u===1)throw u=fu,ia(s,0),Zo(s,l),vr(s,Kt()),u;if(u===6)throw Error(t(345));return s.finishedWork=s.current.alternate,s.finishedLanes=l,oa(s,br,ao),vr(s,Kt()),null}function xg(s,l){var u=Bt;Bt|=1;try{return s(l)}finally{Bt=u,Bt===0&&(_l=Kt()+500,xh&&$o())}}function ra(s){Xo!==null&&Xo.tag===0&&(Bt&6)===0&&jl();var l=Bt;Bt|=1;var u=Xr.transition,f=Rt;try{if(Xr.transition=null,Rt=1,s)return s()}finally{Rt=f,Xr.transition=u,Bt=l,(Bt&6)===0&&$o()}}function bg(){Dr=Tl.current,Zt(Tl)}function ia(s,l){s.finishedWork=null,s.finishedLanes=0;var u=s.timeoutHandle;if(u!==-1&&(s.timeoutHandle=-1,GI(u)),kn!==null)for(u=kn.return;u!==null;){var f=u;switch(Cm(f),f.tag){case 1:f=f.type.childContextTypes,f!=null&&gh();break;case 3:wl(),Zt(gr),Zt(Xn),Wm();break;case 5:Lm(f);break;case 4:wl();break;case 13:Zt(hn);break;case 19:Zt(hn);break;case 10:Fm(f.type._context);break;case 22:case 23:bg()}u=u.return}if(Nn=s,kn=s=es(s.current,null),Kn=Dr=l,In=0,fu=null,hg=Lh=na=0,br=mu=null,Zs!==null){for(l=0;l<Zs.length;l++)if(u=Zs[l],f=u.interleaved,f!==null){u.interleaved=null;var y=f.next,w=u.pending;if(w!==null){var E=w.next;w.next=y,f.next=E}u.pending=f}Zs=null}return s}function Fv(s,l){do{var u=kn;try{if(Bm(),Ch.current=Ph,Rh){for(var f=pn.memoizedState;f!==null;){var y=f.queue;y!==null&&(y.pending=null),f=f.next}Rh=!1}if(ta=0,Dn=jn=pn=null,lu=!1,cu=0,dg.current=null,u===null||u.return===null){In=1,fu=l,kn=null;break}e:{var w=s,E=u.return,U=u,Y=l;if(l=Kn,U.flags|=32768,Y!==null&&typeof Y=="object"&&typeof Y.then=="function"){var ge=Y,Ee=U,Pe=Ee.tag;if((Ee.mode&1)===0&&(Pe===0||Pe===11||Pe===15)){var Ce=Ee.alternate;Ce?(Ee.updateQueue=Ce.updateQueue,Ee.memoizedState=Ce.memoizedState,Ee.lanes=Ce.lanes):(Ee.updateQueue=null,Ee.memoizedState=null)}var Qe=ov(E);if(Qe!==null){Qe.flags&=-257,sv(Qe,E,U,w,l),Qe.mode&1&&iv(w,ge,l),l=Qe,Y=ge;var et=l.updateQueue;if(et===null){var nt=new Set;nt.add(Y),l.updateQueue=nt}else et.add(Y);break e}else{if((l&1)===0){iv(w,ge,l),vg();break e}Y=Error(t(426))}}else if(ln&&U.mode&1){var xn=ov(E);if(xn!==null){(xn.flags&65536)===0&&(xn.flags|=256),sv(xn,E,U,w,l),Am(Sl(Y,U));break e}}w=Y=Sl(Y,U),In!==4&&(In=2),mu===null?mu=[w]:mu.push(w),w=E;do{switch(w.tag){case 3:w.flags|=65536,l&=-l,w.lanes|=l;var ce=nv(w,Y,l);Rb(w,ce);break e;case 1:U=Y;var Z=w.type,he=w.stateNode;if((w.flags&128)===0&&(typeof Z.getDerivedStateFromError=="function"||he!==null&&typeof he.componentDidCatch=="function"&&(Yo===null||!Yo.has(he)))){w.flags|=65536,l&=-l,w.lanes|=l;var ze=rv(w,U,l);Rb(w,ze);break e}}w=w.return}while(w!==null)}Nv(u)}catch(ot){l=ot,kn===u&&u!==null&&(kn=u=u.return);continue}break}while(!0)}function zv(){var s=Mh.current;return Mh.current=Ph,s===null?Ph:s}function vg(){(In===0||In===3||In===2)&&(In=4),Nn===null||(na&268435455)===0&&(Lh&268435455)===0||Zo(Nn,Kn)}function Hh(s,l){var u=Bt;Bt|=2;var f=zv();(Nn!==s||Kn!==l)&&(ao=null,ia(s,l));do try{xC();break}catch(y){Fv(s,y)}while(!0);if(Bm(),Bt=u,Mh.current=f,kn!==null)throw Error(t(261));return Nn=null,Kn=0,In}function xC(){for(;kn!==null;)Dv(kn)}function bC(){for(;kn!==null&&!Vd();)Dv(kn)}function Dv(s){var l=Ov(s.alternate,s,Dr);s.memoizedProps=s.pendingProps,l===null?Nv(s):kn=l,dg.current=null}function Nv(s){var l=s;do{var u=l.alternate;if(s=l.return,(l.flags&32768)===0){if(u=dC(u,l,Dr),u!==null){kn=u;return}}else{if(u=hC(u,l),u!==null){u.flags&=32767,kn=u;return}if(s!==null)s.flags|=32768,s.subtreeFlags=0,s.deletions=null;else{In=6,kn=null;return}}if(l=l.sibling,l!==null){kn=l;return}kn=l=s}while(l!==null);In===0&&(In=5)}function oa(s,l,u){var f=Rt,y=Xr.transition;try{Xr.transition=null,Rt=1,vC(s,l,u,f)}finally{Xr.transition=y,Rt=f}return null}function vC(s,l,u,f){do jl();while(Xo!==null);if((Bt&6)!==0)throw Error(t(327));u=s.finishedWork;var y=s.finishedLanes;if(u===null)return null;if(s.finishedWork=null,s.finishedLanes=0,u===s.current)throw Error(t(177));s.callbackNode=null,s.callbackPriority=0;var w=u.lanes|u.childLanes;if(Ht(s,w),s===Nn&&(kn=Nn=null,Kn=0),(u.subtreeFlags&2064)===0&&(u.flags&2064)===0||Wh||(Wh=!0,Wv(qr,function(){return jl(),null})),w=(u.flags&15990)!==0,(u.subtreeFlags&15990)!==0||w){w=Xr.transition,Xr.transition=null;var E=Rt;Rt=1;var U=Bt;Bt|=4,dg.current=null,fC(s,u),Iv(u,s),OI(vm),Oo=!!bm,vm=bm=null,s.current=u,mC(u),rm(),Bt=U,Rt=E,Xr.transition=w}else s.current=u;if(Wh&&(Wh=!1,Xo=s,Vh=y),w=s.pendingLanes,w===0&&(Yo=null),Hd(u.stateNode),vr(s,Kt()),l!==null)for(f=s.onRecoverableError,u=0;u<l.length;u++)y=l[u],f(y.value,{componentStack:y.stack,digest:y.digest});if(Oh)throw Oh=!1,s=fg,fg=null,s;return(Vh&1)!==0&&s.tag!==0&&jl(),w=s.pendingLanes,(w&1)!==0?s===mg?gu++:(gu=0,mg=s):gu=0,$o(),null}function jl(){if(Xo!==null){var s=Mo(Vh),l=Xr.transition,u=Rt;try{if(Xr.transition=null,Rt=16>s?16:s,Xo===null)var f=!1;else{if(s=Xo,Xo=null,Vh=0,(Bt&6)!==0)throw Error(t(331));var y=Bt;for(Bt|=4,Ze=s.current;Ze!==null;){var w=Ze,E=w.child;if((Ze.flags&16)!==0){var U=w.deletions;if(U!==null){for(var Y=0;Y<U.length;Y++){var ge=U[Y];for(Ze=ge;Ze!==null;){var Ee=Ze;switch(Ee.tag){case 0:case 11:case 15:pu(8,Ee,w)}var Pe=Ee.child;if(Pe!==null)Pe.return=Ee,Ze=Pe;else for(;Ze!==null;){Ee=Ze;var Ce=Ee.sibling,Qe=Ee.return;if(Sv(Ee),Ee===ge){Ze=null;break}if(Ce!==null){Ce.return=Qe,Ze=Ce;break}Ze=Qe}}}var et=w.alternate;if(et!==null){var nt=et.child;if(nt!==null){et.child=null;do{var xn=nt.sibling;nt.sibling=null,nt=xn}while(nt!==null)}}Ze=w}}if((w.subtreeFlags&2064)!==0&&E!==null)E.return=w,Ze=E;else e:for(;Ze!==null;){if(w=Ze,(w.flags&2048)!==0)switch(w.tag){case 0:case 11:case 15:pu(9,w,w.return)}var ce=w.sibling;if(ce!==null){ce.return=w.return,Ze=ce;break e}Ze=w.return}}var Z=s.current;for(Ze=Z;Ze!==null;){E=Ze;var he=E.child;if((E.subtreeFlags&2064)!==0&&he!==null)he.return=E,Ze=he;else e:for(E=Z;Ze!==null;){if(U=Ze,(U.flags&2048)!==0)try{switch(U.tag){case 0:case 11:case 15:Nh(9,U)}}catch(ot){gn(U,U.return,ot)}if(U===E){Ze=null;break e}var ze=U.sibling;if(ze!==null){ze.return=U.return,Ze=ze;break e}Ze=U.return}}if(Bt=y,$o(),Er&&typeof Er.onPostCommitFiberRoot=="function")try{Er.onPostCommitFiberRoot(Vs,s)}catch{}f=!0}return f}finally{Rt=u,Xr.transition=l}}return!1}function Mv(s,l,u){l=Sl(u,l),l=nv(s,l,1),s=Ko(s,l,1),l=ur(),s!==null&&(Do(s,1,l),vr(s,l))}function gn(s,l,u){if(s.tag===3)Mv(s,s,u);else for(;l!==null;){if(l.tag===3){Mv(l,s,u);break}else if(l.tag===1){var f=l.stateNode;if(typeof l.type.getDerivedStateFromError=="function"||typeof f.componentDidCatch=="function"&&(Yo===null||!Yo.has(f))){s=Sl(u,s),s=rv(l,s,1),l=Ko(l,s,1),s=ur(),l!==null&&(Do(l,1,s),vr(l,s));break}}l=l.return}}function wC(s,l,u){var f=s.pingCache;f!==null&&f.delete(l),l=ur(),s.pingedLanes|=s.suspendedLanes&u,Nn===s&&(Kn&u)===u&&(In===4||In===3&&(Kn&130023424)===Kn&&500>Kt()-pg?ia(s,0):hg|=u),vr(s,l)}function Lv(s,l){l===0&&((s.mode&1)===0?l=1:(l=Qa,Qa<<=1,(Qa&130023424)===0&&(Qa=4194304)));var u=ur();s=io(s,l),s!==null&&(Do(s,l,u),vr(s,u))}function SC(s){var l=s.memoizedState,u=0;l!==null&&(u=l.retryLane),Lv(s,u)}function kC(s,l){var u=0;switch(s.tag){case 13:var f=s.stateNode,y=s.memoizedState;y!==null&&(u=y.retryLane);break;case 19:f=s.stateNode;break;default:throw Error(t(314))}f!==null&&f.delete(l),Lv(s,u)}var Ov;Ov=function(s,l,u){if(s!==null)if(s.memoizedProps!==l.pendingProps||gr.current)xr=!0;else{if((s.lanes&u)===0&&(l.flags&128)===0)return xr=!1,uC(s,l,u);xr=(s.flags&131072)!==0}else xr=!1,ln&&(l.flags&1048576)!==0&&bb(l,vh,l.index);switch(l.lanes=0,l.tag){case 2:var f=l.type;zh(s,l),s=l.pendingProps;var y=fl(l,Xn.current);vl(l,u),y=qm(null,l,f,s,y,u);var w=Hm();return l.flags|=1,typeof y=="object"&&y!==null&&typeof y.render=="function"&&y.$$typeof===void 0?(l.tag=1,l.memoizedState=null,l.updateQueue=null,yr(f)?(w=!0,yh(l)):w=!1,l.memoizedState=y.state!==null&&y.state!==void 0?y.state:null,Nm(l),y.updater=Bh,l.stateNode=y,y._reactInternals=l,Xm(l,f,s,u),l=tg(null,l,f,!0,w,u)):(l.tag=0,ln&&w&&Im(l),cr(null,l,y,u),l=l.child),l;case 16:f=l.elementType;e:{switch(zh(s,l),s=l.pendingProps,y=f._init,f=y(f._payload),l.type=f,y=l.tag=_C(f),s=ci(f,s),y){case 0:l=eg(null,l,f,s,u);break e;case 1:l=hv(null,l,f,s,u);break e;case 11:l=av(null,l,f,s,u);break e;case 14:l=lv(null,l,f,ci(f.type,s),u);break e}throw Error(t(306,f,""))}return l;case 0:return f=l.type,y=l.pendingProps,y=l.elementType===f?y:ci(f,y),eg(s,l,f,y,u);case 1:return f=l.type,y=l.pendingProps,y=l.elementType===f?y:ci(f,y),hv(s,l,f,y,u);case 3:e:{if(pv(l),s===null)throw Error(t(387));f=l.pendingProps,w=l.memoizedState,y=w.element,Cb(s,l),jh(l,f,null,u);var E=l.memoizedState;if(f=E.element,w.isDehydrated)if(w={element:f,isDehydrated:!1,cache:E.cache,pendingSuspenseBoundaries:E.pendingSuspenseBoundaries,transitions:E.transitions},l.updateQueue.baseState=w,l.memoizedState=w,l.flags&256){y=Sl(Error(t(423)),l),l=fv(s,l,f,u,y);break e}else if(f!==y){y=Sl(Error(t(424)),l),l=fv(s,l,f,u,y);break e}else for(zr=Uo(l.stateNode.containerInfo.firstChild),Fr=l,ln=!0,li=null,u=jb(l,null,f,u),l.child=u;u;)u.flags=u.flags&-3|4096,u=u.sibling;else{if(yl(),f===y){l=so(s,l,u);break e}cr(s,l,f,u)}l=l.child}return l;case 5:return Ab(l),s===null&&Em(l),f=l.type,y=l.pendingProps,w=s!==null?s.memoizedProps:null,E=y.children,wm(f,y)?E=null:w!==null&&wm(f,w)&&(l.flags|=32),dv(s,l),cr(s,l,E,u),l.child;case 6:return s===null&&Em(l),null;case 13:return mv(s,l,u);case 4:return Mm(l,l.stateNode.containerInfo),f=l.pendingProps,s===null?l.child=xl(l,null,f,u):cr(s,l,f,u),l.child;case 11:return f=l.type,y=l.pendingProps,y=l.elementType===f?y:ci(f,y),av(s,l,f,y,u);case 7:return cr(s,l,l.pendingProps,u),l.child;case 8:return cr(s,l,l.pendingProps.children,u),l.child;case 12:return cr(s,l,l.pendingProps.children,u),l.child;case 10:e:{if(f=l.type._context,y=l.pendingProps,w=l.memoizedProps,E=y.value,Qt(kh,f._currentValue),f._currentValue=E,w!==null)if(ai(w.value,E)){if(w.children===y.children&&!gr.current){l=so(s,l,u);break e}}else for(w=l.child,w!==null&&(w.return=l);w!==null;){var U=w.dependencies;if(U!==null){E=w.child;for(var Y=U.firstContext;Y!==null;){if(Y.context===f){if(w.tag===1){Y=oo(-1,u&-u),Y.tag=2;var ge=w.updateQueue;if(ge!==null){ge=ge.shared;var Ee=ge.pending;Ee===null?Y.next=Y:(Y.next=Ee.next,Ee.next=Y),ge.pending=Y}}w.lanes|=u,Y=w.alternate,Y!==null&&(Y.lanes|=u),zm(w.return,u,l),U.lanes|=u;break}Y=Y.next}}else if(w.tag===10)E=w.type===l.type?null:w.child;else if(w.tag===18){if(E=w.return,E===null)throw Error(t(341));E.lanes|=u,U=E.alternate,U!==null&&(U.lanes|=u),zm(E,u,l),E=w.sibling}else E=w.child;if(E!==null)E.return=w;else for(E=w;E!==null;){if(E===l){E=null;break}if(w=E.sibling,w!==null){w.return=E.return,E=w;break}E=E.return}w=E}cr(s,l,y.children,u),l=l.child}return l;case 9:return y=l.type,f=l.pendingProps.children,vl(l,u),y=Qr(y),f=f(y),l.flags|=1,cr(s,l,f,u),l.child;case 14:return f=l.type,y=ci(f,l.pendingProps),y=ci(f.type,y),lv(s,l,f,y,u);case 15:return cv(s,l,l.type,l.pendingProps,u);case 17:return f=l.type,y=l.pendingProps,y=l.elementType===f?y:ci(f,y),zh(s,l),l.tag=1,yr(f)?(s=!0,yh(l)):s=!1,vl(l,u),ev(l,f,y),Xm(l,f,y,u),tg(null,l,f,!0,s,u);case 19:return yv(s,l,u);case 22:return uv(s,l,u)}throw Error(t(156,l.tag))};function Wv(s,l){return Ga(s,l)}function TC(s,l,u,f){this.tag=s,this.key=u,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=l,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=f,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Jr(s,l,u,f){return new TC(s,l,u,f)}function wg(s){return s=s.prototype,!(!s||!s.isReactComponent)}function _C(s){if(typeof s=="function")return wg(s)?1:0;if(s!=null){if(s=s.$$typeof,s===z)return 11;if(s===X)return 14}return 2}function es(s,l){var u=s.alternate;return u===null?(u=Jr(s.tag,l,s.key,s.mode),u.elementType=s.elementType,u.type=s.type,u.stateNode=s.stateNode,u.alternate=s,s.alternate=u):(u.pendingProps=l,u.type=s.type,u.flags=0,u.subtreeFlags=0,u.deletions=null),u.flags=s.flags&14680064,u.childLanes=s.childLanes,u.lanes=s.lanes,u.child=s.child,u.memoizedProps=s.memoizedProps,u.memoizedState=s.memoizedState,u.updateQueue=s.updateQueue,l=s.dependencies,u.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext},u.sibling=s.sibling,u.index=s.index,u.ref=s.ref,u}function $h(s,l,u,f,y,w){var E=2;if(f=s,typeof s=="function")wg(s)&&(E=1);else if(typeof s=="string")E=5;else e:switch(s){case L:return sa(u.children,y,w,l);case R:E=8,y|=8;break;case A:return s=Jr(12,u,l,y|2),s.elementType=A,s.lanes=w,s;case j:return s=Jr(13,u,l,y),s.elementType=j,s.lanes=w,s;case V:return s=Jr(19,u,l,y),s.elementType=V,s.lanes=w,s;case ne:return Gh(u,y,w,l);default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case N:E=10;break e;case O:E=9;break e;case z:E=11;break e;case X:E=14;break e;case $:E=16,f=null;break e}throw Error(t(130,s==null?s:typeof s,""))}return l=Jr(E,u,l,y),l.elementType=s,l.type=f,l.lanes=w,l}function sa(s,l,u,f){return s=Jr(7,s,f,l),s.lanes=u,s}function Gh(s,l,u,f){return s=Jr(22,s,f,l),s.elementType=ne,s.lanes=u,s.stateNode={isHidden:!1},s}function Sg(s,l,u){return s=Jr(6,s,null,l),s.lanes=u,s}function kg(s,l,u){return l=Jr(4,s.children!==null?s.children:[],s.key,l),l.lanes=u,l.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},l}function jC(s,l,u,f,y){this.tag=l,this.containerInfo=s,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=zo(0),this.expirationTimes=zo(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=zo(0),this.identifierPrefix=f,this.onRecoverableError=y,this.mutableSourceEagerHydrationData=null}function Tg(s,l,u,f,y,w,E,U,Y){return s=new jC(s,l,u,U,Y),l===1?(l=1,w===!0&&(l|=8)):l=0,w=Jr(3,null,null,l),s.current=w,w.stateNode=s,w.memoizedState={element:f,isDehydrated:u,cache:null,transitions:null,pendingSuspenseBoundaries:null},Nm(w),s}function IC(s,l,u){var f=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:W,key:f==null?null:""+f,children:s,containerInfo:l,implementation:u}}function Vv(s){if(!s)return Ho;s=s._reactInternals;e:{if(ei(s)!==s||s.tag!==1)throw Error(t(170));var l=s;do{switch(l.tag){case 3:l=l.stateNode.context;break e;case 1:if(yr(l.type)){l=l.stateNode.__reactInternalMemoizedMergedChildContext;break e}}l=l.return}while(l!==null);throw Error(t(171))}if(s.tag===1){var u=s.type;if(yr(u))return gb(s,u,l)}return l}function Uv(s,l,u,f,y,w,E,U,Y){return s=Tg(u,f,!0,s,y,w,E,U,Y),s.context=Vv(null),u=s.current,f=ur(),y=Jo(u),w=oo(f,y),w.callback=l??null,Ko(u,w,y),s.current.lanes=y,Do(s,y,f),vr(s,f),s}function Kh(s,l,u,f){var y=l.current,w=ur(),E=Jo(y);return u=Vv(u),l.context===null?l.context=u:l.pendingContext=u,l=oo(w,E),l.payload={element:s},f=f===void 0?null:f,f!==null&&(l.callback=f),s=Ko(y,l,E),s!==null&&(hi(s,y,E,w),_h(s,y,E)),E}function Qh(s){if(s=s.current,!s.child)return null;switch(s.child.tag){case 5:return s.child.stateNode;default:return s.child.stateNode}}function qv(s,l){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var u=s.retryLane;s.retryLane=u!==0&&u<l?u:l}}function _g(s,l){qv(s,l),(s=s.alternate)&&qv(s,l)}function CC(){return null}var Hv=typeof reportError=="function"?reportError:function(s){console.error(s)};function jg(s){this._internalRoot=s}Yh.prototype.render=jg.prototype.render=function(s){var l=this._internalRoot;if(l===null)throw Error(t(409));Kh(s,l,null,null)},Yh.prototype.unmount=jg.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var l=s.containerInfo;ra(function(){Kh(null,s,null,null)}),l[eo]=null}};function Yh(s){this._internalRoot=s}Yh.prototype.unstable_scheduleHydration=function(s){if(s){var l=Yd();s={blockedOn:null,target:s,priority:l};for(var u=0;u<Si.length&&l!==0&&l<Si[u].priority;u++);Si.splice(u,0,s),u===0&&Zd(s)}};function Ig(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function Xh(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11&&(s.nodeType!==8||s.nodeValue!==" react-mount-point-unstable "))}function $v(){}function RC(s,l,u,f,y){if(y){if(typeof f=="function"){var w=f;f=function(){var ge=Qh(E);w.call(ge)}}var E=Uv(l,f,s,0,null,!1,!1,"",$v);return s._reactRootContainer=E,s[eo]=E.current,eu(s.nodeType===8?s.parentNode:s),ra(),E}for(;y=s.lastChild;)s.removeChild(y);if(typeof f=="function"){var U=f;f=function(){var ge=Qh(Y);U.call(ge)}}var Y=Tg(s,0,!1,null,null,!1,!1,"",$v);return s._reactRootContainer=Y,s[eo]=Y.current,eu(s.nodeType===8?s.parentNode:s),ra(function(){Kh(l,Y,u,f)}),Y}function Jh(s,l,u,f,y){var w=u._reactRootContainer;if(w){var E=w;if(typeof y=="function"){var U=y;y=function(){var Y=Qh(E);U.call(Y)}}Kh(l,E,s,y)}else E=RC(u,l,s,y,f);return Qh(E)}Kd=function(s){switch(s.tag){case 3:var l=s.stateNode;if(l.current.memoizedState.isDehydrated){var u=Fo(l.pendingLanes);u!==0&&(No(l,u|1),vr(l,Kt()),(Bt&6)===0&&(_l=Kt()+500,$o()))}break;case 13:ra(function(){var f=io(s,1);if(f!==null){var y=ur();hi(f,s,1,y)}}),_g(s,1)}},Ya=function(s){if(s.tag===13){var l=io(s,134217728);if(l!==null){var u=ur();hi(l,s,134217728,u)}_g(s,134217728)}},Qd=function(s){if(s.tag===13){var l=Jo(s),u=io(s,l);if(u!==null){var f=ur();hi(u,s,l,f)}_g(s,l)}},Yd=function(){return Rt},Xd=function(s,l){var u=Rt;try{return Rt=s,l()}finally{Rt=u}},pt=function(s,l,u){switch(l){case"input":if(Te(s,u),l=u.name,u.type==="radio"&&l!=null){for(u=s;u.parentNode;)u=u.parentNode;for(u=u.querySelectorAll("input[name="+JSON.stringify(""+l)+'][type="radio"]'),l=0;l<u.length;l++){var f=u[l];if(f!==s&&f.form===s.form){var y=mh(f);if(!y)throw Error(t(90));Ve(f),Te(f,y)}}}break;case"textarea":Ue(s,u);break;case"select":l=u.value,l!=null&&K(s,!!u.multiple,l,!1)}},on=xg,Vr=ra;var EC={usingClientEntryPoint:!1,Events:[ru,hl,mh,Nt,rn,xg]},yu={findFiberByHostInstance:Qs,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},AC={bundleType:yu.bundleType,version:yu.version,rendererPackageName:yu.rendererPackageName,rendererConfig:yu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:q.ReactCurrentDispatcher,findHostInstanceByFiber:function(s){return s=Mc(s),s===null?null:s.stateNode},findFiberByHostInstance:yu.findFiberByHostInstance||CC,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Zh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Zh.isDisabled&&Zh.supportsFiber)try{Vs=Zh.inject(AC),Er=Zh}catch{}}return wr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=EC,wr.createPortal=function(s,l){var u=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Ig(l))throw Error(t(200));return IC(s,l,null,u)},wr.createRoot=function(s,l){if(!Ig(s))throw Error(t(299));var u=!1,f="",y=Hv;return l!=null&&(l.unstable_strictMode===!0&&(u=!0),l.identifierPrefix!==void 0&&(f=l.identifierPrefix),l.onRecoverableError!==void 0&&(y=l.onRecoverableError)),l=Tg(s,1,!1,null,null,u,!1,f,y),s[eo]=l.current,eu(s.nodeType===8?s.parentNode:s),new jg(l)},wr.findDOMNode=function(s){if(s==null)return null;if(s.nodeType===1)return s;var l=s._reactInternals;if(l===void 0)throw typeof s.render=="function"?Error(t(188)):(s=Object.keys(s).join(","),Error(t(268,s)));return s=Mc(l),s=s===null?null:s.stateNode,s},wr.flushSync=function(s){return ra(s)},wr.hydrate=function(s,l,u){if(!Xh(l))throw Error(t(200));return Jh(null,s,l,!0,u)},wr.hydrateRoot=function(s,l,u){if(!Ig(s))throw Error(t(405));var f=u!=null&&u.hydratedSources||null,y=!1,w="",E=Hv;if(u!=null&&(u.unstable_strictMode===!0&&(y=!0),u.identifierPrefix!==void 0&&(w=u.identifierPrefix),u.onRecoverableError!==void 0&&(E=u.onRecoverableError)),l=Uv(l,null,s,1,u??null,y,!1,w,E),s[eo]=l.current,eu(s),f)for(s=0;s<f.length;s++)u=f[s],y=u._getVersion,y=y(u._source),l.mutableSourceEagerHydrationData==null?l.mutableSourceEagerHydrationData=[u,y]:l.mutableSourceEagerHydrationData.push(u,y);return new Yh(l)},wr.render=function(s,l,u){if(!Xh(l))throw Error(t(200));return Jh(null,s,l,!1,u)},wr.unmountComponentAtNode=function(s){if(!Xh(s))throw Error(t(40));return s._reactRootContainer?(ra(function(){Jh(null,null,s,!1,function(){s._reactRootContainer=null,s[eo]=null})}),!0):!1},wr.unstable_batchedUpdates=xg,wr.unstable_renderSubtreeIntoContainer=function(s,l,u,f){if(!Xh(u))throw Error(t(200));if(s==null||s._reactInternals===void 0)throw Error(t(38));return Jh(s,l,u,!1,f)},wr.version="18.3.1-next-f1338f8080-20240426",wr}var ew;function uk(){if(ew)return Eg.exports;ew=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),Eg.exports=OC(),Eg.exports}var tw;function WC(){if(tw)return ep;tw=1;var n=uk();return ep.createRoot=n.createRoot,ep.hydrateRoot=n.hydrateRoot,ep}var VC=WC(),v=sx();const En=FC(v),UC=BC({__proto__:null,default:En},[v]);uk();/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Gu(){return Gu=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},Gu.apply(this,arguments)}var cs;(function(n){n.Pop="POP",n.Push="PUSH",n.Replace="REPLACE"})(cs||(cs={}));const nw="popstate";function qC(n){n===void 0&&(n={});function e(r,o){let{pathname:a,search:c,hash:d}=r.location;return cy("",{pathname:a,search:c,hash:d},o.state&&o.state.usr||null,o.state&&o.state.key||"default")}function t(r,o){return typeof o=="string"?o:hk(o)}return $C(e,t,null,n)}function An(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function dk(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function HC(){return Math.random().toString(36).substr(2,8)}function rw(n,e){return{usr:n.state,key:n.key,idx:e}}function cy(n,e,t,r){return t===void 0&&(t=null),Gu({pathname:typeof n=="string"?n:n.pathname,search:"",hash:""},typeof e=="string"?bc(e):e,{state:t,key:e&&e.key||r||HC()})}function hk(n){let{pathname:e="/",search:t="",hash:r=""}=n;return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function bc(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substr(t),n=n.substr(0,t));let r=n.indexOf("?");r>=0&&(e.search=n.substr(r),n=n.substr(0,r)),n&&(e.pathname=n)}return e}function $C(n,e,t,r){r===void 0&&(r={});let{window:o=document.defaultView,v5Compat:a=!1}=r,c=o.history,d=cs.Pop,h=null,m=g();m==null&&(m=0,c.replaceState(Gu({},c.state,{idx:m}),""));function g(){return(c.state||{idx:null}).idx}function x(){d=cs.Pop;let T=g(),F=T==null?null:T-m;m=T,h&&h({action:d,location:I.location,delta:F})}function S(T,F){d=cs.Push;let P=cy(I.location,T,F);m=g()+1;let B=rw(P,m),q=I.createHref(P);try{c.pushState(B,"",q)}catch(te){if(te instanceof DOMException&&te.name==="DataCloneError")throw te;o.location.assign(q)}a&&h&&h({action:d,location:I.location,delta:1})}function C(T,F){d=cs.Replace;let P=cy(I.location,T,F);m=g();let B=rw(P,m),q=I.createHref(P);c.replaceState(B,"",q),a&&h&&h({action:d,location:I.location,delta:0})}function _(T){let F=o.location.origin!=="null"?o.location.origin:o.location.href,P=typeof T=="string"?T:hk(T);return P=P.replace(/ $/,"%20"),An(F,"No window.location.(origin|href) available to create URL for href: "+P),new URL(P,F)}let I={get action(){return d},get location(){return n(o,c)},listen(T){if(h)throw new Error("A history only accepts one active listener");return o.addEventListener(nw,x),h=T,()=>{o.removeEventListener(nw,x),h=null}},createHref(T){return e(o,T)},createURL:_,encodeLocation(T){let F=_(T);return{pathname:F.pathname,search:F.search,hash:F.hash}},push:S,replace:C,go(T){return c.go(T)}};return I}var iw;(function(n){n.data="data",n.deferred="deferred",n.redirect="redirect",n.error="error"})(iw||(iw={}));function GC(n,e,t){return t===void 0&&(t="/"),KC(n,e,t)}function KC(n,e,t,r){let o=typeof e=="string"?bc(e):e,a=mk(o.pathname||"/",t);if(a==null)return null;let c=pk(n);QC(c);let d=null;for(let h=0;d==null&&h<c.length;++h){let m=aR(a);d=iR(c[h],m)}return d}function pk(n,e,t,r){e===void 0&&(e=[]),t===void 0&&(t=[]),r===void 0&&(r="");let o=(a,c,d)=>{let h={relativePath:d===void 0?a.path||"":d,caseSensitive:a.caseSensitive===!0,childrenIndex:c,route:a};h.relativePath.startsWith("/")&&(An(h.relativePath.startsWith(r),'Absolute route path "'+h.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),h.relativePath=h.relativePath.slice(r.length));let m=ba([r,h.relativePath]),g=t.concat(h);a.children&&a.children.length>0&&(An(a.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+m+'".')),pk(a.children,e,g,m)),!(a.path==null&&!a.index)&&e.push({path:m,score:nR(m,a.index),routesMeta:g})};return n.forEach((a,c)=>{var d;if(a.path===""||!((d=a.path)!=null&&d.includes("?")))o(a,c);else for(let h of fk(a.path))o(a,c,h)}),e}function fk(n){let e=n.split("/");if(e.length===0)return[];let[t,...r]=e,o=t.endsWith("?"),a=t.replace(/\?$/,"");if(r.length===0)return o?[a,""]:[a];let c=fk(r.join("/")),d=[];return d.push(...c.map(h=>h===""?a:[a,h].join("/"))),o&&d.push(...c),d.map(h=>n.startsWith("/")&&h===""?"/":h)}function QC(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:rR(e.routesMeta.map(r=>r.childrenIndex),t.routesMeta.map(r=>r.childrenIndex)))}const YC=/^:[\w-]+$/,XC=3,JC=2,ZC=1,eR=10,tR=-2,ow=n=>n==="*";function nR(n,e){let t=n.split("/"),r=t.length;return t.some(ow)&&(r+=tR),e&&(r+=JC),t.filter(o=>!ow(o)).reduce((o,a)=>o+(YC.test(a)?XC:a===""?ZC:eR),r)}function rR(n,e){return n.length===e.length&&n.slice(0,-1).every((r,o)=>r===e[o])?n[n.length-1]-e[e.length-1]:0}function iR(n,e,t){let{routesMeta:r}=n,o={},a="/",c=[];for(let d=0;d<r.length;++d){let h=r[d],m=d===r.length-1,g=a==="/"?e:e.slice(a.length)||"/",x=oR({path:h.relativePath,caseSensitive:h.caseSensitive,end:m},g),S=h.route;if(!x)return null;Object.assign(o,x.params),c.push({params:o,pathname:ba([a,x.pathname]),pathnameBase:pR(ba([a,x.pathnameBase])),route:S}),x.pathnameBase!=="/"&&(a=ba([a,x.pathnameBase]))}return c}function oR(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,r]=sR(n.path,n.caseSensitive,n.end),o=e.match(t);if(!o)return null;let a=o[0],c=a.replace(/(.)\/+$/,"$1"),d=o.slice(1);return{params:r.reduce((m,g,x)=>{let{paramName:S,isOptional:C}=g;if(S==="*"){let I=d[x]||"";c=a.slice(0,a.length-I.length).replace(/(.)\/+$/,"$1")}const _=d[x];return C&&!_?m[S]=void 0:m[S]=(_||"").replace(/%2F/g,"/"),m},{}),pathname:a,pathnameBase:c,pattern:n}}function sR(n,e,t){e===void 0&&(e=!1),t===void 0&&(t=!0),dk(n==="*"||!n.endsWith("*")||n.endsWith("/*"),'Route path "'+n+'" will be treated as if it were '+('"'+n.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+n.replace(/\*$/,"/*")+'".'));let r=[],o="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(c,d,h)=>(r.push({paramName:d,isOptional:h!=null}),h?"/?([^\\/]+)?":"/([^\\/]+)"));return n.endsWith("*")?(r.push({paramName:"*"}),o+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?o+="\\/*$":n!==""&&n!=="/"&&(o+="(?:(?=\\/|$))"),[new RegExp(o,e?void 0:"i"),r]}function aR(n){try{return n.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return dk(!1,'The URL path "'+n+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),n}}function mk(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,r=n.charAt(t);return r&&r!=="/"?null:n.slice(t)||"/"}function lR(n,e){e===void 0&&(e="/");let{pathname:t,search:r="",hash:o=""}=typeof n=="string"?bc(n):n;return{pathname:t?t.startsWith("/")?t:cR(t,e):e,search:fR(r),hash:mR(o)}}function cR(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(o=>{o===".."?t.length>1&&t.pop():o!=="."&&t.push(o)}),t.length>1?t.join("/"):"/"}function Bg(n,e,t,r){return"Cannot include a '"+n+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+t+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function uR(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function dR(n,e){let t=uR(n);return e?t.map((r,o)=>o===t.length-1?r.pathname:r.pathnameBase):t.map(r=>r.pathnameBase)}function hR(n,e,t,r){r===void 0&&(r=!1);let o;typeof n=="string"?o=bc(n):(o=Gu({},n),An(!o.pathname||!o.pathname.includes("?"),Bg("?","pathname","search",o)),An(!o.pathname||!o.pathname.includes("#"),Bg("#","pathname","hash",o)),An(!o.search||!o.search.includes("#"),Bg("#","search","hash",o)));let a=n===""||o.pathname==="",c=a?"/":o.pathname,d;if(c==null)d=t;else{let x=e.length-1;if(!r&&c.startsWith("..")){let S=c.split("/");for(;S[0]==="..";)S.shift(),x-=1;o.pathname=S.join("/")}d=x>=0?e[x]:"/"}let h=lR(o,d),m=c&&c!=="/"&&c.endsWith("/"),g=(a||c===".")&&t.endsWith("/");return!h.pathname.endsWith("/")&&(m||g)&&(h.pathname+="/"),h}const ba=n=>n.join("/").replace(/\/\/+/g,"/"),pR=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),fR=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,mR=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n;function gR(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}const gk=["post","put","patch","delete"];new Set(gk);const yR=["get",...gk];new Set(yR);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Ku(){return Ku=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},Ku.apply(this,arguments)}const ax=v.createContext(null),xR=v.createContext(null),pf=v.createContext(null),ff=v.createContext(null),La=v.createContext({outlet:null,matches:[],isDataRoute:!1}),yk=v.createContext(null);function mf(){return v.useContext(ff)!=null}function gf(){return mf()||An(!1),v.useContext(ff).location}function xk(n){v.useContext(pf).static||v.useLayoutEffect(n)}function _t(){let{isDataRoute:n}=v.useContext(La);return n?PR():bR()}function bR(){mf()||An(!1);let n=v.useContext(ax),{basename:e,future:t,navigator:r}=v.useContext(pf),{matches:o}=v.useContext(La),{pathname:a}=gf(),c=JSON.stringify(dR(o,t.v7_relativeSplatPath)),d=v.useRef(!1);return xk(()=>{d.current=!0}),v.useCallback(function(m,g){if(g===void 0&&(g={}),!d.current)return;if(typeof m=="number"){r.go(m);return}let x=hR(m,JSON.parse(c),a,g.relative==="path");n==null&&e!=="/"&&(x.pathname=x.pathname==="/"?e:ba([e,x.pathname])),(g.replace?r.replace:r.push)(x,g.state,g)},[e,r,c,a,n])}function vR(){let{matches:n}=v.useContext(La),e=n[n.length-1];return e?e.params:{}}function wR(n,e){return SR(n,e)}function SR(n,e,t,r){mf()||An(!1);let{navigator:o}=v.useContext(pf),{matches:a}=v.useContext(La),c=a[a.length-1],d=c?c.params:{};c&&c.pathname;let h=c?c.pathnameBase:"/";c&&c.route;let m=gf(),g;if(e){var x;let T=typeof e=="string"?bc(e):e;h==="/"||(x=T.pathname)!=null&&x.startsWith(h)||An(!1),g=T}else g=m;let S=g.pathname||"/",C=S;if(h!=="/"){let T=h.replace(/^\//,"").split("/");C="/"+S.replace(/^\//,"").split("/").slice(T.length).join("/")}let _=GC(n,{pathname:C}),I=IR(_&&_.map(T=>Object.assign({},T,{params:Object.assign({},d,T.params),pathname:ba([h,o.encodeLocation?o.encodeLocation(T.pathname).pathname:T.pathname]),pathnameBase:T.pathnameBase==="/"?h:ba([h,o.encodeLocation?o.encodeLocation(T.pathnameBase).pathname:T.pathnameBase])})),a,t,r);return e&&I?v.createElement(ff.Provider,{value:{location:Ku({pathname:"/",search:"",hash:"",state:null,key:"default"},g),navigationType:cs.Pop}},I):I}function kR(){let n=AR(),e=gR(n)?n.status+" "+n.statusText:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,o={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return v.createElement(v.Fragment,null,v.createElement("h2",null,"Unexpected Application Error!"),v.createElement("h3",{style:{fontStyle:"italic"}},e),t?v.createElement("pre",{style:o},t):null,null)}const TR=v.createElement(kR,null);class _R extends v.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return this.state.error!==void 0?v.createElement(La.Provider,{value:this.props.routeContext},v.createElement(yk.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function jR(n){let{routeContext:e,match:t,children:r}=n,o=v.useContext(ax);return o&&o.static&&o.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(o.staticContext._deepestRenderedBoundaryId=t.route.id),v.createElement(La.Provider,{value:e},r)}function IR(n,e,t,r){var o;if(e===void 0&&(e=[]),t===void 0&&(t=null),r===void 0&&(r=null),n==null){var a;if(!t)return null;if(t.errors)n=t.matches;else if((a=r)!=null&&a.v7_partialHydration&&e.length===0&&!t.initialized&&t.matches.length>0)n=t.matches;else return null}let c=n,d=(o=t)==null?void 0:o.errors;if(d!=null){let g=c.findIndex(x=>x.route.id&&(d==null?void 0:d[x.route.id])!==void 0);g>=0||An(!1),c=c.slice(0,Math.min(c.length,g+1))}let h=!1,m=-1;if(t&&r&&r.v7_partialHydration)for(let g=0;g<c.length;g++){let x=c[g];if((x.route.HydrateFallback||x.route.hydrateFallbackElement)&&(m=g),x.route.id){let{loaderData:S,errors:C}=t,_=x.route.loader&&S[x.route.id]===void 0&&(!C||C[x.route.id]===void 0);if(x.route.lazy||_){h=!0,m>=0?c=c.slice(0,m+1):c=[c[0]];break}}}return c.reduceRight((g,x,S)=>{let C,_=!1,I=null,T=null;t&&(C=d&&x.route.id?d[x.route.id]:void 0,I=x.route.errorElement||TR,h&&(m<0&&S===0?(BR("route-fallback"),_=!0,T=null):m===S&&(_=!0,T=x.route.hydrateFallbackElement||null)));let F=e.concat(c.slice(0,S+1)),P=()=>{let B;return C?B=I:_?B=T:x.route.Component?B=v.createElement(x.route.Component,null):x.route.element?B=x.route.element:B=g,v.createElement(jR,{match:x,routeContext:{outlet:g,matches:F,isDataRoute:t!=null},children:B})};return t&&(x.route.ErrorBoundary||x.route.errorElement||S===0)?v.createElement(_R,{location:t.location,revalidation:t.revalidation,component:I,error:C,children:P(),routeContext:{outlet:null,matches:F,isDataRoute:!0}}):P()},null)}var bk=function(n){return n.UseBlocker="useBlocker",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n}(bk||{}),vk=function(n){return n.UseBlocker="useBlocker",n.UseLoaderData="useLoaderData",n.UseActionData="useActionData",n.UseRouteError="useRouteError",n.UseNavigation="useNavigation",n.UseRouteLoaderData="useRouteLoaderData",n.UseMatches="useMatches",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n.UseRouteId="useRouteId",n}(vk||{});function CR(n){let e=v.useContext(ax);return e||An(!1),e}function RR(n){let e=v.useContext(xR);return e||An(!1),e}function ER(n){let e=v.useContext(La);return e||An(!1),e}function wk(n){let e=ER(),t=e.matches[e.matches.length-1];return t.route.id||An(!1),t.route.id}function AR(){var n;let e=v.useContext(yk),t=RR(),r=wk();return e!==void 0?e:(n=t.errors)==null?void 0:n[r]}function PR(){let{router:n}=CR(bk.UseNavigateStable),e=wk(vk.UseNavigateStable),t=v.useRef(!1);return xk(()=>{t.current=!0}),v.useCallback(function(o,a){a===void 0&&(a={}),t.current&&(typeof o=="number"?n.navigate(o):n.navigate(o,Ku({fromRouteId:e},a)))},[n,e])}const sw={};function BR(n,e,t){sw[n]||(sw[n]=!0)}function FR(n,e){n==null||n.v7_startTransition,n==null||n.v7_relativeSplatPath}function xt(n){An(!1)}function zR(n){let{basename:e="/",children:t=null,location:r,navigationType:o=cs.Pop,navigator:a,static:c=!1,future:d}=n;mf()&&An(!1);let h=e.replace(/^\/*/,"/"),m=v.useMemo(()=>({basename:h,navigator:a,static:c,future:Ku({v7_relativeSplatPath:!1},d)}),[h,d,a,c]);typeof r=="string"&&(r=bc(r));let{pathname:g="/",search:x="",hash:S="",state:C=null,key:_="default"}=r,I=v.useMemo(()=>{let T=mk(g,h);return T==null?null:{location:{pathname:T,search:x,hash:S,state:C,key:_},navigationType:o}},[h,g,x,S,C,_,o]);return I==null?null:v.createElement(pf.Provider,{value:m},v.createElement(ff.Provider,{children:t,value:I}))}function DR(n){let{children:e,location:t}=n;return wR(uy(e),t)}new Promise(()=>{});function uy(n,e){e===void 0&&(e=[]);let t=[];return v.Children.forEach(n,(r,o)=>{if(!v.isValidElement(r))return;let a=[...e,o];if(r.type===v.Fragment){t.push.apply(t,uy(r.props.children,a));return}r.type!==xt&&An(!1),!r.props.index||!r.props.children||An(!1);let c={id:r.props.id||a.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(c.children=uy(r.props.children,a)),t.push(c)}),t}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function dy(n){return n===void 0&&(n=""),new URLSearchParams(typeof n=="string"||Array.isArray(n)||n instanceof URLSearchParams?n:Object.keys(n).reduce((e,t)=>{let r=n[t];return e.concat(Array.isArray(r)?r.map(o=>[t,o]):[[t,r]])},[]))}function NR(n,e){let t=dy(n);return e&&e.forEach((r,o)=>{t.has(o)||e.getAll(o).forEach(a=>{t.append(o,a)})}),t}const MR="6";try{window.__reactRouterVersion=MR}catch{}const LR="startTransition",aw=UC[LR];function OR(n){let{basename:e,children:t,future:r,window:o}=n,a=v.useRef();a.current==null&&(a.current=qC({window:o,v5Compat:!0}));let c=a.current,[d,h]=v.useState({action:c.action,location:c.location}),{v7_startTransition:m}=r||{},g=v.useCallback(x=>{m&&aw?aw(()=>h(x)):h(x)},[h,m]);return v.useLayoutEffect(()=>c.listen(g),[c,g]),v.useEffect(()=>FR(r),[r]),v.createElement(zR,{basename:e,children:t,location:d.location,navigationType:d.action,navigator:c,future:r})}var lw;(function(n){n.UseScrollRestoration="useScrollRestoration",n.UseSubmit="useSubmit",n.UseSubmitFetcher="useSubmitFetcher",n.UseFetcher="useFetcher",n.useViewTransitionState="useViewTransitionState"})(lw||(lw={}));var cw;(function(n){n.UseFetcher="useFetcher",n.UseFetchers="useFetchers",n.UseScrollRestoration="useScrollRestoration"})(cw||(cw={}));function Sk(n){let e=v.useRef(dy(n)),t=v.useRef(!1),r=gf(),o=v.useMemo(()=>NR(r.search,t.current?null:e.current),[r.search]),a=_t(),c=v.useCallback((d,h)=>{const m=dy(typeof d=="function"?d(o):d);t.current=!0,a("?"+m,h)},[a,o]);return[o,c]}const uw=()=>{const[n,e]=v.useState(!0),[t,r]=v.useState(0),[o,a]=v.useState(!1),[c,d]=v.useState(!1),h=_t();return v.useEffect(()=>{(async()=>{r(1),a(!0),d(!0),await new Promise(g=>setTimeout(g,2e3)),await new Promise(g=>setTimeout(g,500)),r(0),await new Promise(g=>setTimeout(g,400)),h("/home")})()},[h]),i.jsxs("div",{style:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",background:"radial-gradient(ellipse 80% 60% at 50% 50%, #fff 0%, #e3eafc 70%, #b3c6f7 100%)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1e4,opacity:n?1:0,transition:"opacity 0.5s ease-in-out",overflow:"hidden"},children:[i.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",opacity:t,transition:"opacity 0.7s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative"},children:[i.jsx("div",{style:{position:"absolute",width:320,height:220,borderRadius:"50% / 40%",top:"50%",left:"50%",transform:"translate(-50%, -50%)",zIndex:1,pointerEvents:"none",animation:o?"halo-rotate 2.5s linear forwards":"none",opacity:.85,background:"conic-gradient(from 0deg, #fff 0deg, #ffd700 60deg, #b3c6f7 180deg, #fff 300deg, #fff 360deg)",filter:"blur(2px)"}}),i.jsx("div",{style:{position:"absolute",width:260,height:260,borderRadius:"50%",background:"radial-gradient(circle, #fff 0%, rgba(255,255,255,0.7) 50%, transparent 80%)",zIndex:2,top:"50%",left:"50%",transform:"translate(-50%, -50%)",pointerEvents:"none"}}),i.jsx("img",{src:"/ctx-logo.png",alt:"CTX Logo",style:{width:"200px",height:"200px",filter:"drop-shadow(0 8px 32px rgba(40, 40, 40, 0.35)) drop-shadow(0 2px 8px #fff)",zIndex:3,animation:c?"logo-scale-rotate 2.5s cubic-bezier(0.4,0,0.2,1) forwards":"none",transformOrigin:"50% 50%",transform:c?void 0:"scale(1) rotate(0deg)",opacity:c?void 0:1}}),i.jsx("div",{style:{marginTop:"20px",color:"#232946",fontSize:"24px",fontWeight:"bold",textAlign:"center",textShadow:"0 2px 8px rgba(255,255,255,0.5)",zIndex:3},children:"Restarter™"}),i.jsx("div",{style:{marginTop:"8px",color:"#ffd700",fontSize:"16px",textAlign:"center",textShadow:"0 2px 8px rgba(0, 0, 0, 0.1)",zIndex:3},children:"重啟人生的平台"})]}),i.jsx("style",{children:`
        @keyframes halo-rotate {
          0% { transform: translate(-50%, -50%) rotate(0deg); }
          100% { transform: translate(-50%, -50%) rotate(360deg); }
        }
        @keyframes logo-scale-rotate {
          0% { transform: scale(0.1) rotate(-180deg); opacity: 0.2; }
          20% { opacity: 1; }
          100% { transform: scale(1) rotate(0deg); opacity: 1; }
        }
      `})]})},WR=()=>{};var dw={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kk=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let o=n.charCodeAt(r);o<128?e[t++]=o:o<2048?(e[t++]=o>>6|192,e[t++]=o&63|128):(o&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(o=65536+((o&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=o>>18|240,e[t++]=o>>12&63|128,e[t++]=o>>6&63|128,e[t++]=o&63|128):(e[t++]=o>>12|224,e[t++]=o>>6&63|128,e[t++]=o&63|128)}return e},VR=function(n){const e=[];let t=0,r=0;for(;t<n.length;){const o=n[t++];if(o<128)e[r++]=String.fromCharCode(o);else if(o>191&&o<224){const a=n[t++];e[r++]=String.fromCharCode((o&31)<<6|a&63)}else if(o>239&&o<365){const a=n[t++],c=n[t++],d=n[t++],h=((o&7)<<18|(a&63)<<12|(c&63)<<6|d&63)-65536;e[r++]=String.fromCharCode(55296+(h>>10)),e[r++]=String.fromCharCode(56320+(h&1023))}else{const a=n[t++],c=n[t++];e[r++]=String.fromCharCode((o&15)<<12|(a&63)<<6|c&63)}}return e.join("")},Tk={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let o=0;o<n.length;o+=3){const a=n[o],c=o+1<n.length,d=c?n[o+1]:0,h=o+2<n.length,m=h?n[o+2]:0,g=a>>2,x=(a&3)<<4|d>>4;let S=(d&15)<<2|m>>6,C=m&63;h||(C=64,c||(S=64)),r.push(t[g],t[x],t[S],t[C])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(kk(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):VR(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let o=0;o<n.length;){const a=t[n.charAt(o++)],d=o<n.length?t[n.charAt(o)]:0;++o;const m=o<n.length?t[n.charAt(o)]:64;++o;const x=o<n.length?t[n.charAt(o)]:64;if(++o,a==null||d==null||m==null||x==null)throw new UR;const S=a<<2|d>>4;if(r.push(S),m!==64){const C=d<<4&240|m>>2;if(r.push(C),x!==64){const _=m<<6&192|x;r.push(_)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class UR extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const qR=function(n){const e=kk(n);return Tk.encodeByteArray(e,!0)},Pp=function(n){return qR(n).replace(/\./g,"")},_k=function(n){try{return Tk.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jk(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HR=()=>jk().__FIREBASE_DEFAULTS__,$R=()=>{if(typeof process>"u"||typeof dw>"u")return;const n=dw.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},GR=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&_k(n[1]);return e&&JSON.parse(e)},yf=()=>{try{return WR()||HR()||$R()||GR()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},Ik=n=>{var e,t;return(t=(e=yf())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},Ck=n=>{const e=Ik(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},Rk=()=>{var n;return(n=yf())===null||n===void 0?void 0:n.config},Ek=n=>{var e;return(e=yf())===null||e===void 0?void 0:e[`_${n}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KR{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function To(n){return n.endsWith(".cloudworkstations.dev")}async function xf(n){return(await fetch(n,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ak(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},r=e||"demo-project",o=n.iat||0,a=n.sub||n.user_id;if(!a)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const c=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:o,exp:o+3600,auth_time:o,sub:a,user_id:a,firebase:{sign_in_provider:"custom",identities:{}}},n);return[Pp(JSON.stringify(t)),Pp(JSON.stringify(c)),""].join(".")}const zu={};function QR(){const n={prod:[],emulator:[]};for(const e of Object.keys(zu))zu[e]?n.emulator.push(e):n.prod.push(e);return n}function YR(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let hw=!1;function lx(n,e){if(typeof window>"u"||typeof document>"u"||!To(window.location.host)||zu[n]===e||zu[n]||hw)return;zu[n]=e;function t(S){return`__firebase__banner__${S}`}const r="__firebase__banner",a=QR().prod.length>0;function c(){const S=document.getElementById(r);S&&S.remove()}function d(S){S.style.display="flex",S.style.background="#7faaf0",S.style.position="fixed",S.style.bottom="5px",S.style.left="5px",S.style.padding=".5em",S.style.borderRadius="5px",S.style.alignItems="center"}function h(S,C){S.setAttribute("width","24"),S.setAttribute("id",C),S.setAttribute("height","24"),S.setAttribute("viewBox","0 0 24 24"),S.setAttribute("fill","none"),S.style.marginLeft="-6px"}function m(){const S=document.createElement("span");return S.style.cursor="pointer",S.style.marginLeft="16px",S.style.fontSize="24px",S.innerHTML=" &times;",S.onclick=()=>{hw=!0,c()},S}function g(S,C){S.setAttribute("id",C),S.innerText="Learn more",S.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",S.setAttribute("target","__blank"),S.style.paddingLeft="5px",S.style.textDecoration="underline"}function x(){const S=YR(r),C=t("text"),_=document.getElementById(C)||document.createElement("span"),I=t("learnmore"),T=document.getElementById(I)||document.createElement("a"),F=t("preprendIcon"),P=document.getElementById(F)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(S.created){const B=S.element;d(B),g(T,I);const q=m();h(P,F),B.append(P,_,T,q),document.body.appendChild(B)}a?(_.innerText="Preview backend disconnected.",P.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(P.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,_.innerText="Preview backend running in this workspace."),_.setAttribute("id",C)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",x):x()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function XR(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Pn())}function Pk(){var n;const e=(n=yf())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function JR(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function ZR(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function eE(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function tE(){const n=Pn();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function Bk(){return!Pk()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Fk(){return!Pk()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function zk(){try{return typeof indexedDB=="object"}catch{return!1}}function nE(){return new Promise((n,e)=>{try{let t=!0;const r="validate-browser-context-for-indexeddb-analytics-module",o=self.indexedDB.open(r);o.onsuccess=()=>{o.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},o.onupgradeneeded=()=>{t=!1},o.onerror=()=>{var a;e(((a=o.error)===null||a===void 0?void 0:a.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rE="FirebaseError";class qi extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=rE,Object.setPrototypeOf(this,qi.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,dd.prototype.create)}}class dd{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){const r=t[0]||{},o=`${this.service}/${e}`,a=this.errors[e],c=a?iE(a,r):"Error",d=`${this.serviceName}: ${c} (${o}).`;return new qi(o,d,r)}}function iE(n,e){return n.replace(oE,(t,r)=>{const o=e[r];return o!=null?String(o):`<${r}?>`})}const oE=/\{\$([^}]+)}/g;function sE(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function yi(n,e){if(n===e)return!0;const t=Object.keys(n),r=Object.keys(e);for(const o of t){if(!r.includes(o))return!1;const a=n[o],c=e[o];if(pw(a)&&pw(c)){if(!yi(a,c))return!1}else if(a!==c)return!1}for(const o of r)if(!t.includes(o))return!1;return!0}function pw(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hd(n){const e=[];for(const[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(o=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(o))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function Cu(n){const e={};return n.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[o,a]=r.split("=");e[decodeURIComponent(o)]=decodeURIComponent(a)}}),e}function Ru(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function aE(n,e){const t=new lE(n,e);return t.subscribe.bind(t)}class lE{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let o;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");cE(e,["next","error","complete"])?o=e:o={next:e,error:t,complete:r},o.next===void 0&&(o.next=Fg),o.error===void 0&&(o.error=Fg),o.complete===void 0&&(o.complete=Fg);const a=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?o.error(this.finalError):o.complete()}catch{}}),this.observers.push(o),a}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function cE(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Fg(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dt(n){return n&&n._delegate?n._delegate:n}class xs{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const la="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uE{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const r=new KR;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{const o=this.getOrInitializeService({instanceIdentifier:t});o&&r.resolve(o)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),o=(t=e==null?void 0:e.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(a){if(o)return null;throw a}else{if(o)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(hE(e))try{this.getOrInitializeService({instanceIdentifier:la})}catch{}for(const[t,r]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(t);try{const a=this.getOrInitializeService({instanceIdentifier:o});r.resolve(a)}catch{}}}}clearInstance(e=la){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=la){return this.instances.has(e)}getOptions(e=la){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const o=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[a,c]of this.instancesDeferred.entries()){const d=this.normalizeInstanceIdentifier(a);r===d&&c.resolve(o)}return o}onInit(e,t){var r;const o=this.normalizeInstanceIdentifier(t),a=(r=this.onInitCallbacks.get(o))!==null&&r!==void 0?r:new Set;a.add(e),this.onInitCallbacks.set(o,a);const c=this.instances.get(o);return c&&e(c,o),()=>{a.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const o of r)try{o(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:dE(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=la){return this.component?this.component.multipleInstances?e:la:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function dE(n){return n===la?void 0:n}function hE(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pE{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new uE(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var jt;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(jt||(jt={}));const fE={debug:jt.DEBUG,verbose:jt.VERBOSE,info:jt.INFO,warn:jt.WARN,error:jt.ERROR,silent:jt.SILENT},mE=jt.INFO,gE={[jt.DEBUG]:"log",[jt.VERBOSE]:"log",[jt.INFO]:"info",[jt.WARN]:"warn",[jt.ERROR]:"error"},yE=(n,e,...t)=>{if(e<n.logLevel)return;const r=new Date().toISOString(),o=gE[e];if(o)console[o](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class cx{constructor(e){this.name=e,this._logLevel=mE,this._logHandler=yE,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in jt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?fE[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,jt.DEBUG,...e),this._logHandler(this,jt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,jt.VERBOSE,...e),this._logHandler(this,jt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,jt.INFO,...e),this._logHandler(this,jt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,jt.WARN,...e),this._logHandler(this,jt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,jt.ERROR,...e),this._logHandler(this,jt.ERROR,...e)}}const xE=(n,e)=>e.some(t=>n instanceof t);let fw,mw;function bE(){return fw||(fw=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function vE(){return mw||(mw=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Dk=new WeakMap,hy=new WeakMap,Nk=new WeakMap,zg=new WeakMap,ux=new WeakMap;function wE(n){const e=new Promise((t,r)=>{const o=()=>{n.removeEventListener("success",a),n.removeEventListener("error",c)},a=()=>{t(ps(n.result)),o()},c=()=>{r(n.error),o()};n.addEventListener("success",a),n.addEventListener("error",c)});return e.then(t=>{t instanceof IDBCursor&&Dk.set(t,n)}).catch(()=>{}),ux.set(e,n),e}function SE(n){if(hy.has(n))return;const e=new Promise((t,r)=>{const o=()=>{n.removeEventListener("complete",a),n.removeEventListener("error",c),n.removeEventListener("abort",c)},a=()=>{t(),o()},c=()=>{r(n.error||new DOMException("AbortError","AbortError")),o()};n.addEventListener("complete",a),n.addEventListener("error",c),n.addEventListener("abort",c)});hy.set(n,e)}let py={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return hy.get(n);if(e==="objectStoreNames")return n.objectStoreNames||Nk.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return ps(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function kE(n){py=n(py)}function TE(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const r=n.call(Dg(this),e,...t);return Nk.set(r,e.sort?e.sort():[e]),ps(r)}:vE().includes(n)?function(...e){return n.apply(Dg(this),e),ps(Dk.get(this))}:function(...e){return ps(n.apply(Dg(this),e))}}function _E(n){return typeof n=="function"?TE(n):(n instanceof IDBTransaction&&SE(n),xE(n,bE())?new Proxy(n,py):n)}function ps(n){if(n instanceof IDBRequest)return wE(n);if(zg.has(n))return zg.get(n);const e=_E(n);return e!==n&&(zg.set(n,e),ux.set(e,n)),e}const Dg=n=>ux.get(n);function jE(n,e,{blocked:t,upgrade:r,blocking:o,terminated:a}={}){const c=indexedDB.open(n,e),d=ps(c);return r&&c.addEventListener("upgradeneeded",h=>{r(ps(c.result),h.oldVersion,h.newVersion,ps(c.transaction),h)}),t&&c.addEventListener("blocked",h=>t(h.oldVersion,h.newVersion,h)),d.then(h=>{a&&h.addEventListener("close",()=>a()),o&&h.addEventListener("versionchange",m=>o(m.oldVersion,m.newVersion,m))}).catch(()=>{}),d}const IE=["get","getKey","getAll","getAllKeys","count"],CE=["put","add","delete","clear"],Ng=new Map;function gw(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Ng.get(e))return Ng.get(e);const t=e.replace(/FromIndex$/,""),r=e!==t,o=CE.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(o||IE.includes(t)))return;const a=async function(c,...d){const h=this.transaction(c,o?"readwrite":"readonly");let m=h.store;return r&&(m=m.index(d.shift())),(await Promise.all([m[t](...d),o&&h.done]))[0]};return Ng.set(e,a),a}kE(n=>({...n,get:(e,t,r)=>gw(e,t)||n.get(e,t,r),has:(e,t)=>!!gw(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RE{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(EE(t)){const r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}}function EE(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const fy="@firebase/app",yw="0.13.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vo=new cx("@firebase/app"),AE="@firebase/app-compat",PE="@firebase/analytics-compat",BE="@firebase/analytics",FE="@firebase/app-check-compat",zE="@firebase/app-check",DE="@firebase/auth",NE="@firebase/auth-compat",ME="@firebase/database",LE="@firebase/data-connect",OE="@firebase/database-compat",WE="@firebase/functions",VE="@firebase/functions-compat",UE="@firebase/installations",qE="@firebase/installations-compat",HE="@firebase/messaging",$E="@firebase/messaging-compat",GE="@firebase/performance",KE="@firebase/performance-compat",QE="@firebase/remote-config",YE="@firebase/remote-config-compat",XE="@firebase/storage",JE="@firebase/storage-compat",ZE="@firebase/firestore",eA="@firebase/ai",tA="@firebase/firestore-compat",nA="firebase",rA="11.9.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bp="[DEFAULT]",iA={[fy]:"fire-core",[AE]:"fire-core-compat",[BE]:"fire-analytics",[PE]:"fire-analytics-compat",[zE]:"fire-app-check",[FE]:"fire-app-check-compat",[DE]:"fire-auth",[NE]:"fire-auth-compat",[ME]:"fire-rtdb",[LE]:"fire-data-connect",[OE]:"fire-rtdb-compat",[WE]:"fire-fn",[VE]:"fire-fn-compat",[UE]:"fire-iid",[qE]:"fire-iid-compat",[HE]:"fire-fcm",[$E]:"fire-fcm-compat",[GE]:"fire-perf",[KE]:"fire-perf-compat",[QE]:"fire-rc",[YE]:"fire-rc-compat",[XE]:"fire-gcs",[JE]:"fire-gcs-compat",[ZE]:"fire-fst",[tA]:"fire-fst-compat",[eA]:"fire-vertex","fire-js":"fire-js",[nA]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fp=new Map,oA=new Map,my=new Map;function xw(n,e){try{n.container.addComponent(e)}catch(t){vo.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function _a(n){const e=n.name;if(my.has(e))return vo.debug(`There were multiple attempts to register component ${e}.`),!1;my.set(e,n);for(const t of Fp.values())xw(t,n);for(const t of oA.values())xw(t,n);return!0}function vc(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function sA(n,e,t=Bp){vc(n,e).clearInstance(t)}function kr(n){return n==null?!1:n.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aA={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},fs=new dd("app","Firebase",aA);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lA{constructor(e,t,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new xs("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw fs.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Oa=rA;function Mk(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const r=Object.assign({name:Bp,automaticDataCollectionEnabled:!0},e),o=r.name;if(typeof o!="string"||!o)throw fs.create("bad-app-name",{appName:String(o)});if(t||(t=Rk()),!t)throw fs.create("no-options");const a=Fp.get(o);if(a){if(yi(t,a.options)&&yi(r,a.config))return a;throw fs.create("duplicate-app",{appName:o})}const c=new pE(o);for(const h of my.values())c.addComponent(h);const d=new lA(t,r,c);return Fp.set(o,d),d}function dx(n=Bp){const e=Fp.get(n);if(!e&&n===Bp&&Rk())return Mk();if(!e)throw fs.create("no-app",{appName:n});return e}function Mi(n,e,t){var r;let o=(r=iA[n])!==null&&r!==void 0?r:n;t&&(o+=`-${t}`);const a=o.match(/\s|\//),c=e.match(/\s|\//);if(a||c){const d=[`Unable to register library "${o}" with version "${e}":`];a&&d.push(`library name "${o}" contains illegal characters (whitespace or "/")`),a&&c&&d.push("and"),c&&d.push(`version name "${e}" contains illegal characters (whitespace or "/")`),vo.warn(d.join(" "));return}_a(new xs(`${o}-version`,()=>({library:o,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cA="firebase-heartbeat-database",uA=1,Qu="firebase-heartbeat-store";let Mg=null;function Lk(){return Mg||(Mg=jE(cA,uA,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Qu)}catch(t){console.warn(t)}}}}).catch(n=>{throw fs.create("idb-open",{originalErrorMessage:n.message})})),Mg}async function dA(n){try{const t=(await Lk()).transaction(Qu),r=await t.objectStore(Qu).get(Ok(n));return await t.done,r}catch(e){if(e instanceof qi)vo.warn(e.message);else{const t=fs.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});vo.warn(t.message)}}}async function bw(n,e){try{const r=(await Lk()).transaction(Qu,"readwrite");await r.objectStore(Qu).put(e,Ok(n)),await r.done}catch(t){if(t instanceof qi)vo.warn(t.message);else{const r=fs.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});vo.warn(r.message)}}}function Ok(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hA=1024,pA=30;class fA{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new gA(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,t;try{const o=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),a=vw();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===a||this._heartbeatsCache.heartbeats.some(c=>c.date===a))return;if(this._heartbeatsCache.heartbeats.push({date:a,agent:o}),this._heartbeatsCache.heartbeats.length>pA){const c=yA(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(c,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){vo.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=vw(),{heartbeatsToSend:r,unsentEntries:o}=mA(this._heartbeatsCache.heartbeats),a=Pp(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,o.length>0?(this._heartbeatsCache.heartbeats=o,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),a}catch(t){return vo.warn(t),""}}}function vw(){return new Date().toISOString().substring(0,10)}function mA(n,e=hA){const t=[];let r=n.slice();for(const o of n){const a=t.find(c=>c.agent===o.agent);if(a){if(a.dates.push(o.date),ww(t)>e){a.dates.pop();break}}else if(t.push({agent:o.agent,dates:[o.date]}),ww(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}class gA{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return zk()?nE().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await dA(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const o=await this.read();return bw(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:o.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const o=await this.read();return bw(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:o.lastSentHeartbeatDate,heartbeats:[...o.heartbeats,...e.heartbeats]})}else return}}function ww(n){return Pp(JSON.stringify({version:2,heartbeats:n})).length}function yA(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let r=1;r<n.length;r++)n[r].date<t&&(t=n[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xA(n){_a(new xs("platform-logger",e=>new RE(e),"PRIVATE")),_a(new xs("heartbeat",e=>new fA(e),"PRIVATE")),Mi(fy,yw,n),Mi(fy,yw,"esm2017"),Mi("fire-js","")}xA("");var bA="firebase",vA="11.9.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Mi(bA,vA,"app");var Sw=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var ms,Wk;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(L,R){function A(){}A.prototype=R.prototype,L.D=R.prototype,L.prototype=new A,L.prototype.constructor=L,L.C=function(N,O,z){for(var j=Array(arguments.length-2),V=2;V<arguments.length;V++)j[V-2]=arguments[V];return R.prototype[O].apply(N,j)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,t),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function o(L,R,A){A||(A=0);var N=Array(16);if(typeof R=="string")for(var O=0;16>O;++O)N[O]=R.charCodeAt(A++)|R.charCodeAt(A++)<<8|R.charCodeAt(A++)<<16|R.charCodeAt(A++)<<24;else for(O=0;16>O;++O)N[O]=R[A++]|R[A++]<<8|R[A++]<<16|R[A++]<<24;R=L.g[0],A=L.g[1],O=L.g[2];var z=L.g[3],j=R+(z^A&(O^z))+N[0]+3614090360&4294967295;R=A+(j<<7&4294967295|j>>>25),j=z+(O^R&(A^O))+N[1]+3905402710&4294967295,z=R+(j<<12&4294967295|j>>>20),j=O+(A^z&(R^A))+N[2]+606105819&4294967295,O=z+(j<<17&4294967295|j>>>15),j=A+(R^O&(z^R))+N[3]+3250441966&4294967295,A=O+(j<<22&4294967295|j>>>10),j=R+(z^A&(O^z))+N[4]+4118548399&4294967295,R=A+(j<<7&4294967295|j>>>25),j=z+(O^R&(A^O))+N[5]+1200080426&4294967295,z=R+(j<<12&4294967295|j>>>20),j=O+(A^z&(R^A))+N[6]+2821735955&4294967295,O=z+(j<<17&4294967295|j>>>15),j=A+(R^O&(z^R))+N[7]+4249261313&4294967295,A=O+(j<<22&4294967295|j>>>10),j=R+(z^A&(O^z))+N[8]+1770035416&4294967295,R=A+(j<<7&4294967295|j>>>25),j=z+(O^R&(A^O))+N[9]+2336552879&4294967295,z=R+(j<<12&4294967295|j>>>20),j=O+(A^z&(R^A))+N[10]+4294925233&4294967295,O=z+(j<<17&4294967295|j>>>15),j=A+(R^O&(z^R))+N[11]+2304563134&4294967295,A=O+(j<<22&4294967295|j>>>10),j=R+(z^A&(O^z))+N[12]+1804603682&4294967295,R=A+(j<<7&4294967295|j>>>25),j=z+(O^R&(A^O))+N[13]+4254626195&4294967295,z=R+(j<<12&4294967295|j>>>20),j=O+(A^z&(R^A))+N[14]+2792965006&4294967295,O=z+(j<<17&4294967295|j>>>15),j=A+(R^O&(z^R))+N[15]+1236535329&4294967295,A=O+(j<<22&4294967295|j>>>10),j=R+(O^z&(A^O))+N[1]+4129170786&4294967295,R=A+(j<<5&4294967295|j>>>27),j=z+(A^O&(R^A))+N[6]+3225465664&4294967295,z=R+(j<<9&4294967295|j>>>23),j=O+(R^A&(z^R))+N[11]+643717713&4294967295,O=z+(j<<14&4294967295|j>>>18),j=A+(z^R&(O^z))+N[0]+3921069994&4294967295,A=O+(j<<20&4294967295|j>>>12),j=R+(O^z&(A^O))+N[5]+3593408605&4294967295,R=A+(j<<5&4294967295|j>>>27),j=z+(A^O&(R^A))+N[10]+38016083&4294967295,z=R+(j<<9&4294967295|j>>>23),j=O+(R^A&(z^R))+N[15]+3634488961&4294967295,O=z+(j<<14&4294967295|j>>>18),j=A+(z^R&(O^z))+N[4]+3889429448&4294967295,A=O+(j<<20&4294967295|j>>>12),j=R+(O^z&(A^O))+N[9]+568446438&4294967295,R=A+(j<<5&4294967295|j>>>27),j=z+(A^O&(R^A))+N[14]+3275163606&4294967295,z=R+(j<<9&4294967295|j>>>23),j=O+(R^A&(z^R))+N[3]+4107603335&4294967295,O=z+(j<<14&4294967295|j>>>18),j=A+(z^R&(O^z))+N[8]+1163531501&4294967295,A=O+(j<<20&4294967295|j>>>12),j=R+(O^z&(A^O))+N[13]+2850285829&4294967295,R=A+(j<<5&4294967295|j>>>27),j=z+(A^O&(R^A))+N[2]+4243563512&4294967295,z=R+(j<<9&4294967295|j>>>23),j=O+(R^A&(z^R))+N[7]+1735328473&4294967295,O=z+(j<<14&4294967295|j>>>18),j=A+(z^R&(O^z))+N[12]+2368359562&4294967295,A=O+(j<<20&4294967295|j>>>12),j=R+(A^O^z)+N[5]+4294588738&4294967295,R=A+(j<<4&4294967295|j>>>28),j=z+(R^A^O)+N[8]+2272392833&4294967295,z=R+(j<<11&4294967295|j>>>21),j=O+(z^R^A)+N[11]+1839030562&4294967295,O=z+(j<<16&4294967295|j>>>16),j=A+(O^z^R)+N[14]+4259657740&4294967295,A=O+(j<<23&4294967295|j>>>9),j=R+(A^O^z)+N[1]+2763975236&4294967295,R=A+(j<<4&4294967295|j>>>28),j=z+(R^A^O)+N[4]+1272893353&4294967295,z=R+(j<<11&4294967295|j>>>21),j=O+(z^R^A)+N[7]+4139469664&4294967295,O=z+(j<<16&4294967295|j>>>16),j=A+(O^z^R)+N[10]+3200236656&4294967295,A=O+(j<<23&4294967295|j>>>9),j=R+(A^O^z)+N[13]+681279174&4294967295,R=A+(j<<4&4294967295|j>>>28),j=z+(R^A^O)+N[0]+3936430074&4294967295,z=R+(j<<11&4294967295|j>>>21),j=O+(z^R^A)+N[3]+3572445317&4294967295,O=z+(j<<16&4294967295|j>>>16),j=A+(O^z^R)+N[6]+76029189&4294967295,A=O+(j<<23&4294967295|j>>>9),j=R+(A^O^z)+N[9]+3654602809&4294967295,R=A+(j<<4&4294967295|j>>>28),j=z+(R^A^O)+N[12]+3873151461&4294967295,z=R+(j<<11&4294967295|j>>>21),j=O+(z^R^A)+N[15]+530742520&4294967295,O=z+(j<<16&4294967295|j>>>16),j=A+(O^z^R)+N[2]+3299628645&4294967295,A=O+(j<<23&4294967295|j>>>9),j=R+(O^(A|~z))+N[0]+4096336452&4294967295,R=A+(j<<6&4294967295|j>>>26),j=z+(A^(R|~O))+N[7]+1126891415&4294967295,z=R+(j<<10&4294967295|j>>>22),j=O+(R^(z|~A))+N[14]+2878612391&4294967295,O=z+(j<<15&4294967295|j>>>17),j=A+(z^(O|~R))+N[5]+4237533241&4294967295,A=O+(j<<21&4294967295|j>>>11),j=R+(O^(A|~z))+N[12]+1700485571&4294967295,R=A+(j<<6&4294967295|j>>>26),j=z+(A^(R|~O))+N[3]+2399980690&4294967295,z=R+(j<<10&4294967295|j>>>22),j=O+(R^(z|~A))+N[10]+4293915773&4294967295,O=z+(j<<15&4294967295|j>>>17),j=A+(z^(O|~R))+N[1]+2240044497&4294967295,A=O+(j<<21&4294967295|j>>>11),j=R+(O^(A|~z))+N[8]+1873313359&4294967295,R=A+(j<<6&4294967295|j>>>26),j=z+(A^(R|~O))+N[15]+4264355552&4294967295,z=R+(j<<10&4294967295|j>>>22),j=O+(R^(z|~A))+N[6]+2734768916&4294967295,O=z+(j<<15&4294967295|j>>>17),j=A+(z^(O|~R))+N[13]+1309151649&4294967295,A=O+(j<<21&4294967295|j>>>11),j=R+(O^(A|~z))+N[4]+4149444226&4294967295,R=A+(j<<6&4294967295|j>>>26),j=z+(A^(R|~O))+N[11]+3174756917&4294967295,z=R+(j<<10&4294967295|j>>>22),j=O+(R^(z|~A))+N[2]+718787259&4294967295,O=z+(j<<15&4294967295|j>>>17),j=A+(z^(O|~R))+N[9]+3951481745&4294967295,L.g[0]=L.g[0]+R&4294967295,L.g[1]=L.g[1]+(O+(j<<21&4294967295|j>>>11))&4294967295,L.g[2]=L.g[2]+O&4294967295,L.g[3]=L.g[3]+z&4294967295}r.prototype.u=function(L,R){R===void 0&&(R=L.length);for(var A=R-this.blockSize,N=this.B,O=this.h,z=0;z<R;){if(O==0)for(;z<=A;)o(this,L,z),z+=this.blockSize;if(typeof L=="string"){for(;z<R;)if(N[O++]=L.charCodeAt(z++),O==this.blockSize){o(this,N),O=0;break}}else for(;z<R;)if(N[O++]=L[z++],O==this.blockSize){o(this,N),O=0;break}}this.h=O,this.o+=R},r.prototype.v=function(){var L=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);L[0]=128;for(var R=1;R<L.length-8;++R)L[R]=0;var A=8*this.o;for(R=L.length-8;R<L.length;++R)L[R]=A&255,A/=256;for(this.u(L),L=Array(16),R=A=0;4>R;++R)for(var N=0;32>N;N+=8)L[A++]=this.g[R]>>>N&255;return L};function a(L,R){var A=d;return Object.prototype.hasOwnProperty.call(A,L)?A[L]:A[L]=R(L)}function c(L,R){this.h=R;for(var A=[],N=!0,O=L.length-1;0<=O;O--){var z=L[O]|0;N&&z==R||(A[O]=z,N=!1)}this.g=A}var d={};function h(L){return-128<=L&&128>L?a(L,function(R){return new c([R|0],0>R?-1:0)}):new c([L|0],0>L?-1:0)}function m(L){if(isNaN(L)||!isFinite(L))return x;if(0>L)return T(m(-L));for(var R=[],A=1,N=0;L>=A;N++)R[N]=L/A|0,A*=4294967296;return new c(R,0)}function g(L,R){if(L.length==0)throw Error("number format error: empty string");if(R=R||10,2>R||36<R)throw Error("radix out of range: "+R);if(L.charAt(0)=="-")return T(g(L.substring(1),R));if(0<=L.indexOf("-"))throw Error('number format error: interior "-" character');for(var A=m(Math.pow(R,8)),N=x,O=0;O<L.length;O+=8){var z=Math.min(8,L.length-O),j=parseInt(L.substring(O,O+z),R);8>z?(z=m(Math.pow(R,z)),N=N.j(z).add(m(j))):(N=N.j(A),N=N.add(m(j)))}return N}var x=h(0),S=h(1),C=h(16777216);n=c.prototype,n.m=function(){if(I(this))return-T(this).m();for(var L=0,R=1,A=0;A<this.g.length;A++){var N=this.i(A);L+=(0<=N?N:4294967296+N)*R,R*=4294967296}return L},n.toString=function(L){if(L=L||10,2>L||36<L)throw Error("radix out of range: "+L);if(_(this))return"0";if(I(this))return"-"+T(this).toString(L);for(var R=m(Math.pow(L,6)),A=this,N="";;){var O=q(A,R).g;A=F(A,O.j(R));var z=((0<A.g.length?A.g[0]:A.h)>>>0).toString(L);if(A=O,_(A))return z+N;for(;6>z.length;)z="0"+z;N=z+N}},n.i=function(L){return 0>L?0:L<this.g.length?this.g[L]:this.h};function _(L){if(L.h!=0)return!1;for(var R=0;R<L.g.length;R++)if(L.g[R]!=0)return!1;return!0}function I(L){return L.h==-1}n.l=function(L){return L=F(this,L),I(L)?-1:_(L)?0:1};function T(L){for(var R=L.g.length,A=[],N=0;N<R;N++)A[N]=~L.g[N];return new c(A,~L.h).add(S)}n.abs=function(){return I(this)?T(this):this},n.add=function(L){for(var R=Math.max(this.g.length,L.g.length),A=[],N=0,O=0;O<=R;O++){var z=N+(this.i(O)&65535)+(L.i(O)&65535),j=(z>>>16)+(this.i(O)>>>16)+(L.i(O)>>>16);N=j>>>16,z&=65535,j&=65535,A[O]=j<<16|z}return new c(A,A[A.length-1]&-2147483648?-1:0)};function F(L,R){return L.add(T(R))}n.j=function(L){if(_(this)||_(L))return x;if(I(this))return I(L)?T(this).j(T(L)):T(T(this).j(L));if(I(L))return T(this.j(T(L)));if(0>this.l(C)&&0>L.l(C))return m(this.m()*L.m());for(var R=this.g.length+L.g.length,A=[],N=0;N<2*R;N++)A[N]=0;for(N=0;N<this.g.length;N++)for(var O=0;O<L.g.length;O++){var z=this.i(N)>>>16,j=this.i(N)&65535,V=L.i(O)>>>16,X=L.i(O)&65535;A[2*N+2*O]+=j*X,P(A,2*N+2*O),A[2*N+2*O+1]+=z*X,P(A,2*N+2*O+1),A[2*N+2*O+1]+=j*V,P(A,2*N+2*O+1),A[2*N+2*O+2]+=z*V,P(A,2*N+2*O+2)}for(N=0;N<R;N++)A[N]=A[2*N+1]<<16|A[2*N];for(N=R;N<2*R;N++)A[N]=0;return new c(A,0)};function P(L,R){for(;(L[R]&65535)!=L[R];)L[R+1]+=L[R]>>>16,L[R]&=65535,R++}function B(L,R){this.g=L,this.h=R}function q(L,R){if(_(R))throw Error("division by zero");if(_(L))return new B(x,x);if(I(L))return R=q(T(L),R),new B(T(R.g),T(R.h));if(I(R))return R=q(L,T(R)),new B(T(R.g),R.h);if(30<L.g.length){if(I(L)||I(R))throw Error("slowDivide_ only works with positive integers.");for(var A=S,N=R;0>=N.l(L);)A=te(A),N=te(N);var O=W(A,1),z=W(N,1);for(N=W(N,2),A=W(A,2);!_(N);){var j=z.add(N);0>=j.l(L)&&(O=O.add(A),z=j),N=W(N,1),A=W(A,1)}return R=F(L,O.j(R)),new B(O,R)}for(O=x;0<=L.l(R);){for(A=Math.max(1,Math.floor(L.m()/R.m())),N=Math.ceil(Math.log(A)/Math.LN2),N=48>=N?1:Math.pow(2,N-48),z=m(A),j=z.j(R);I(j)||0<j.l(L);)A-=N,z=m(A),j=z.j(R);_(z)&&(z=S),O=O.add(z),L=F(L,j)}return new B(O,L)}n.A=function(L){return q(this,L).h},n.and=function(L){for(var R=Math.max(this.g.length,L.g.length),A=[],N=0;N<R;N++)A[N]=this.i(N)&L.i(N);return new c(A,this.h&L.h)},n.or=function(L){for(var R=Math.max(this.g.length,L.g.length),A=[],N=0;N<R;N++)A[N]=this.i(N)|L.i(N);return new c(A,this.h|L.h)},n.xor=function(L){for(var R=Math.max(this.g.length,L.g.length),A=[],N=0;N<R;N++)A[N]=this.i(N)^L.i(N);return new c(A,this.h^L.h)};function te(L){for(var R=L.g.length+1,A=[],N=0;N<R;N++)A[N]=L.i(N)<<1|L.i(N-1)>>>31;return new c(A,L.h)}function W(L,R){var A=R>>5;R%=32;for(var N=L.g.length-A,O=[],z=0;z<N;z++)O[z]=0<R?L.i(z+A)>>>R|L.i(z+A+1)<<32-R:L.i(z+A);return new c(O,L.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,Wk=r,c.prototype.add=c.prototype.add,c.prototype.multiply=c.prototype.j,c.prototype.modulo=c.prototype.A,c.prototype.compare=c.prototype.l,c.prototype.toNumber=c.prototype.m,c.prototype.toString=c.prototype.toString,c.prototype.getBits=c.prototype.i,c.fromNumber=m,c.fromString=g,ms=c}).apply(typeof Sw<"u"?Sw:typeof self<"u"?self:typeof window<"u"?window:{});var tp=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Vk,Eu,Uk,mp,gy,qk,Hk,$k;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(p,b,k){return p==Array.prototype||p==Object.prototype||(p[b]=k.value),p};function t(p){p=[typeof globalThis=="object"&&globalThis,p,typeof window=="object"&&window,typeof self=="object"&&self,typeof tp=="object"&&tp];for(var b=0;b<p.length;++b){var k=p[b];if(k&&k.Math==Math)return k}throw Error("Cannot find global object")}var r=t(this);function o(p,b){if(b)e:{var k=r;p=p.split(".");for(var M=0;M<p.length-1;M++){var ae=p[M];if(!(ae in k))break e;k=k[ae]}p=p[p.length-1],M=k[p],b=b(M),b!=M&&b!=null&&e(k,p,{configurable:!0,writable:!0,value:b})}}function a(p,b){p instanceof String&&(p+="");var k=0,M=!1,ae={next:function(){if(!M&&k<p.length){var be=k++;return{value:b(be,p[be]),done:!1}}return M=!0,{done:!0,value:void 0}}};return ae[Symbol.iterator]=function(){return ae},ae}o("Array.prototype.values",function(p){return p||function(){return a(this,function(b,k){return k})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var c=c||{},d=this||self;function h(p){var b=typeof p;return b=b!="object"?b:p?Array.isArray(p)?"array":b:"null",b=="array"||b=="object"&&typeof p.length=="number"}function m(p){var b=typeof p;return b=="object"&&p!=null||b=="function"}function g(p,b,k){return p.call.apply(p.bind,arguments)}function x(p,b,k){if(!p)throw Error();if(2<arguments.length){var M=Array.prototype.slice.call(arguments,2);return function(){var ae=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(ae,M),p.apply(b,ae)}}return function(){return p.apply(b,arguments)}}function S(p,b,k){return S=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?g:x,S.apply(null,arguments)}function C(p,b){var k=Array.prototype.slice.call(arguments,1);return function(){var M=k.slice();return M.push.apply(M,arguments),p.apply(this,M)}}function _(p,b){function k(){}k.prototype=b.prototype,p.aa=b.prototype,p.prototype=new k,p.prototype.constructor=p,p.Qb=function(M,ae,be){for(var Me=Array(arguments.length-2),Ot=2;Ot<arguments.length;Ot++)Me[Ot-2]=arguments[Ot];return b.prototype[ae].apply(M,Me)}}function I(p){const b=p.length;if(0<b){const k=Array(b);for(let M=0;M<b;M++)k[M]=p[M];return k}return[]}function T(p,b){for(let k=1;k<arguments.length;k++){const M=arguments[k];if(h(M)){const ae=p.length||0,be=M.length||0;p.length=ae+be;for(let Me=0;Me<be;Me++)p[ae+Me]=M[Me]}else p.push(M)}}class F{constructor(b,k){this.i=b,this.j=k,this.h=0,this.g=null}get(){let b;return 0<this.h?(this.h--,b=this.g,this.g=b.next,b.next=null):b=this.i(),b}}function P(p){return/^[\s\xa0]*$/.test(p)}function B(){var p=d.navigator;return p&&(p=p.userAgent)?p:""}function q(p){return q[" "](p),p}q[" "]=function(){};var te=B().indexOf("Gecko")!=-1&&!(B().toLowerCase().indexOf("webkit")!=-1&&B().indexOf("Edge")==-1)&&!(B().indexOf("Trident")!=-1||B().indexOf("MSIE")!=-1)&&B().indexOf("Edge")==-1;function W(p,b,k){for(const M in p)b.call(k,p[M],M,p)}function L(p,b){for(const k in p)b.call(void 0,p[k],k,p)}function R(p){const b={};for(const k in p)b[k]=p[k];return b}const A="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function N(p,b){let k,M;for(let ae=1;ae<arguments.length;ae++){M=arguments[ae];for(k in M)p[k]=M[k];for(let be=0;be<A.length;be++)k=A[be],Object.prototype.hasOwnProperty.call(M,k)&&(p[k]=M[k])}}function O(p){var b=1;p=p.split(":");const k=[];for(;0<b&&p.length;)k.push(p.shift()),b--;return p.length&&k.push(p.join(":")),k}function z(p){d.setTimeout(()=>{throw p},0)}function j(){var p=J;let b=null;return p.g&&(b=p.g,p.g=p.g.next,p.g||(p.h=null),b.next=null),b}class V{constructor(){this.h=this.g=null}add(b,k){const M=X.get();M.set(b,k),this.h?this.h.next=M:this.g=M,this.h=M}}var X=new F(()=>new $,p=>p.reset());class ${constructor(){this.next=this.g=this.h=null}set(b,k){this.h=b,this.g=k,this.next=null}reset(){this.next=this.g=this.h=null}}let ne,oe=!1,J=new V,Q=()=>{const p=d.Promise.resolve(void 0);ne=()=>{p.then(D)}};var D=()=>{for(var p;p=j();){try{p.h.call(p.g)}catch(k){z(k)}var b=X;b.j(p),100>b.h&&(b.h++,p.next=b.g,b.g=p)}oe=!1};function G(){this.s=this.s,this.C=this.C}G.prototype.s=!1,G.prototype.ma=function(){this.s||(this.s=!0,this.N())},G.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function ie(p,b){this.type=p,this.g=this.target=b,this.defaultPrevented=!1}ie.prototype.h=function(){this.defaultPrevented=!0};var ee=function(){if(!d.addEventListener||!Object.defineProperty)return!1;var p=!1,b=Object.defineProperty({},"passive",{get:function(){p=!0}});try{const k=()=>{};d.addEventListener("test",k,b),d.removeEventListener("test",k,b)}catch{}return p}();function Se(p,b){if(ie.call(this,p?p.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,p){var k=this.type=p.type,M=p.changedTouches&&p.changedTouches.length?p.changedTouches[0]:null;if(this.target=p.target||p.srcElement,this.g=b,b=p.relatedTarget){if(te){e:{try{q(b.nodeName);var ae=!0;break e}catch{}ae=!1}ae||(b=null)}}else k=="mouseover"?b=p.fromElement:k=="mouseout"&&(b=p.toElement);this.relatedTarget=b,M?(this.clientX=M.clientX!==void 0?M.clientX:M.pageX,this.clientY=M.clientY!==void 0?M.clientY:M.pageY,this.screenX=M.screenX||0,this.screenY=M.screenY||0):(this.clientX=p.clientX!==void 0?p.clientX:p.pageX,this.clientY=p.clientY!==void 0?p.clientY:p.pageY,this.screenX=p.screenX||0,this.screenY=p.screenY||0),this.button=p.button,this.key=p.key||"",this.ctrlKey=p.ctrlKey,this.altKey=p.altKey,this.shiftKey=p.shiftKey,this.metaKey=p.metaKey,this.pointerId=p.pointerId||0,this.pointerType=typeof p.pointerType=="string"?p.pointerType:we[p.pointerType]||"",this.state=p.state,this.i=p,p.defaultPrevented&&Se.aa.h.call(this)}}_(Se,ie);var we={2:"touch",3:"pen",4:"mouse"};Se.prototype.h=function(){Se.aa.h.call(this);var p=this.i;p.preventDefault?p.preventDefault():p.returnValue=!1};var Oe="closure_listenable_"+(1e6*Math.random()|0),Ne=0;function Ye(p,b,k,M,ae){this.listener=p,this.proxy=null,this.src=b,this.type=k,this.capture=!!M,this.ha=ae,this.key=++Ne,this.da=this.fa=!1}function it(p){p.da=!0,p.listener=null,p.proxy=null,p.src=null,p.ha=null}function me(p){this.src=p,this.g={},this.h=0}me.prototype.add=function(p,b,k,M,ae){var be=p.toString();p=this.g[be],p||(p=this.g[be]=[],this.h++);var Me=Xe(p,b,M,ae);return-1<Me?(b=p[Me],k||(b.fa=!1)):(b=new Ye(b,this.src,be,!!M,ae),b.fa=k,p.push(b)),b};function Ve(p,b){var k=b.type;if(k in p.g){var M=p.g[k],ae=Array.prototype.indexOf.call(M,b,void 0),be;(be=0<=ae)&&Array.prototype.splice.call(M,ae,1),be&&(it(b),p.g[k].length==0&&(delete p.g[k],p.h--))}}function Xe(p,b,k,M){for(var ae=0;ae<p.length;++ae){var be=p[ae];if(!be.da&&be.listener==b&&be.capture==!!k&&be.ha==M)return ae}return-1}var Je="closure_lm_"+(1e6*Math.random()|0),He={};function fe(p,b,k,M,ae){if(Array.isArray(b)){for(var be=0;be<b.length;be++)fe(p,b[be],k,M,ae);return null}return k=ue(k),p&&p[Oe]?p.K(b,k,m(M)?!!M.capture:!1,ae):Te(p,b,k,!1,M,ae)}function Te(p,b,k,M,ae,be){if(!b)throw Error("Invalid event type");var Me=m(ae)?!!ae.capture:!!ae,Ot=H(p);if(Ot||(p[Je]=Ot=new me(p)),k=Ot.add(b,k,M,Me,be),k.proxy)return k;if(M=_e(),k.proxy=M,M.src=p,M.listener=k,p.addEventListener)ee||(ae=Me),ae===void 0&&(ae=!1),p.addEventListener(b.toString(),M,ae);else if(p.attachEvent)p.attachEvent(K(b.toString()),M);else if(p.addListener&&p.removeListener)p.addListener(M);else throw Error("addEventListener and attachEvent are unavailable.");return k}function _e(){function p(k){return b.call(p.src,p.listener,k)}const b=re;return p}function Fe(p,b,k,M,ae){if(Array.isArray(b))for(var be=0;be<b.length;be++)Fe(p,b[be],k,M,ae);else M=m(M)?!!M.capture:!!M,k=ue(k),p&&p[Oe]?(p=p.i,b=String(b).toString(),b in p.g&&(be=p.g[b],k=Xe(be,k,M,ae),-1<k&&(it(be[k]),Array.prototype.splice.call(be,k,1),be.length==0&&(delete p.g[b],p.h--)))):p&&(p=H(p))&&(b=p.g[b.toString()],p=-1,b&&(p=Xe(b,k,M,ae)),(k=-1<p?b[p]:null)&&Be(k))}function Be(p){if(typeof p!="number"&&p&&!p.da){var b=p.src;if(b&&b[Oe])Ve(b.i,p);else{var k=p.type,M=p.proxy;b.removeEventListener?b.removeEventListener(k,M,p.capture):b.detachEvent?b.detachEvent(K(k),M):b.addListener&&b.removeListener&&b.removeListener(M),(k=H(b))?(Ve(k,p),k.h==0&&(k.src=null,b[Je]=null)):it(p)}}}function K(p){return p in He?He[p]:He[p]="on"+p}function re(p,b){if(p.da)p=!0;else{b=new Se(b,this);var k=p.listener,M=p.ha||p.src;p.fa&&Be(p),p=k.call(M,b)}return p}function H(p){return p=p[Je],p instanceof me?p:null}var Ue="__closure_events_fn_"+(1e9*Math.random()>>>0);function ue(p){return typeof p=="function"?p:(p[Ue]||(p[Ue]=function(b){return p.handleEvent(b)}),p[Ue])}function le(){G.call(this),this.i=new me(this),this.M=this,this.F=null}_(le,G),le.prototype[Oe]=!0,le.prototype.removeEventListener=function(p,b,k,M){Fe(this,p,b,k,M)};function Re(p,b){var k,M=p.F;if(M)for(k=[];M;M=M.F)k.push(M);if(p=p.M,M=b.type||b,typeof b=="string")b=new ie(b,p);else if(b instanceof ie)b.target=b.target||p;else{var ae=b;b=new ie(M,p),N(b,ae)}if(ae=!0,k)for(var be=k.length-1;0<=be;be--){var Me=b.g=k[be];ae=rt(Me,M,!0,b)&&ae}if(Me=b.g=p,ae=rt(Me,M,!0,b)&&ae,ae=rt(Me,M,!1,b)&&ae,k)for(be=0;be<k.length;be++)Me=b.g=k[be],ae=rt(Me,M,!1,b)&&ae}le.prototype.N=function(){if(le.aa.N.call(this),this.i){var p=this.i,b;for(b in p.g){for(var k=p.g[b],M=0;M<k.length;M++)it(k[M]);delete p.g[b],p.h--}}this.F=null},le.prototype.K=function(p,b,k,M){return this.i.add(String(p),b,!1,k,M)},le.prototype.L=function(p,b,k,M){return this.i.add(String(p),b,!0,k,M)};function rt(p,b,k,M){if(b=p.i.g[String(b)],!b)return!0;b=b.concat();for(var ae=!0,be=0;be<b.length;++be){var Me=b[be];if(Me&&!Me.da&&Me.capture==k){var Ot=Me.listener,_n=Me.ha||Me.src;Me.fa&&Ve(p.i,Me),ae=Ot.call(_n,M)!==!1&&ae}}return ae&&!M.defaultPrevented}function xe(p,b,k){if(typeof p=="function")k&&(p=S(p,k));else if(p&&typeof p.handleEvent=="function")p=S(p.handleEvent,p);else throw Error("Invalid listener argument");return 2147483647<Number(b)?-1:d.setTimeout(p,b||0)}function Ae(p){p.g=xe(()=>{p.g=null,p.i&&(p.i=!1,Ae(p))},p.l);const b=p.h;p.h=null,p.m.apply(null,b)}class Ge extends G{constructor(b,k){super(),this.m=b,this.l=k,this.h=null,this.i=!1,this.g=null}j(b){this.h=arguments,this.g?this.i=!0:Ae(this)}N(){super.N(),this.g&&(d.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function ft(p){G.call(this),this.h=p,this.g={}}_(ft,G);var ke=[];function at(p){W(p.g,function(b,k){this.g.hasOwnProperty(k)&&Be(b)},p),p.g={}}ft.prototype.N=function(){ft.aa.N.call(this),at(this)},ft.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var pe=d.JSON.stringify,de=d.JSON.parse,De=class{stringify(p){return d.JSON.stringify(p,void 0)}parse(p){return d.JSON.parse(p,void 0)}};function $e(){}$e.prototype.h=null;function lt(p){return p.h||(p.h=p.i())}function pt(){}var bt={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function gt(){ie.call(this,"d")}_(gt,ie);function Et(){ie.call(this,"c")}_(Et,ie);var Nt={},rn=null;function on(){return rn=rn||new le}Nt.La="serverreachability";function Vr(p){ie.call(this,Nt.La,p)}_(Vr,ie);function Ur(p){const b=on();Re(b,new Vr(b))}Nt.STAT_EVENT="statevent";function Po(p,b){ie.call(this,Nt.STAT_EVENT,p),this.stat=b}_(Po,ie);function sn(p){const b=on();Re(b,new Po(b,p))}Nt.Ma="timingevent";function Gi(p,b){ie.call(this,Nt.Ma,p),this.size=b}_(Gi,ie);function pr(p,b){if(typeof p!="function")throw Error("Fn must not be null and must be a function");return d.setTimeout(function(){p()},b)}function bi(){this.g=!0}bi.prototype.xa=function(){this.g=!1};function vi(p,b,k,M,ae,be){p.info(function(){if(p.g)if(be)for(var Me="",Ot=be.split("&"),_n=0;_n<Ot.length;_n++){var At=Ot[_n].split("=");if(1<At.length){var zn=At[0];At=At[1];var Sn=zn.split("_");Me=2<=Sn.length&&Sn[1]=="type"?Me+(zn+"="+At+"&"):Me+(zn+"=redacted&")}}else Me=null;else Me=be;return"XMLHTTP REQ ("+M+") [attempt "+ae+"]: "+b+`
`+k+`
`+Me})}function mt(p,b,k,M,ae,be,Me){p.info(function(){return"XMLHTTP RESP ("+M+") [ attempt "+ae+"]: "+b+`
`+k+`
`+be+" "+Me})}function sr(p,b,k,M){p.info(function(){return"XMLHTTP TEXT ("+b+"): "+Nc(p,k)+(M?" "+M:"")})}function Ki(p,b){p.info(function(){return"TIMEOUT: "+b})}bi.prototype.info=function(){};function Nc(p,b){if(!p.g)return b;if(!b)return null;try{var k=JSON.parse(b);if(k){for(p=0;p<k.length;p++)if(Array.isArray(k[p])){var M=k[p];if(!(2>M.length)){var ae=M[1];if(Array.isArray(ae)&&!(1>ae.length)){var be=ae[0];if(be!="noop"&&be!="stop"&&be!="close")for(var Me=1;Me<ae.length;Me++)ae[Me]=""}}}}return pe(k)}catch{return b}}var Ha={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Od={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},ei;function Os(){}_(Os,$e),Os.prototype.g=function(){return new XMLHttpRequest},Os.prototype.i=function(){return{}},ei=new Os;function ti(p,b,k,M){this.j=p,this.i=b,this.l=k,this.R=M||1,this.U=new ft(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Wd}function Wd(){this.i=null,this.g="",this.h=!1}var Mc={},$a={};function Ga(p,b,k){p.L=1,p.v=No(Ar(b)),p.m=k,p.P=!0,Lc(p,null)}function Lc(p,b){p.F=Date.now(),Kt(p),p.A=Ar(p.v);var k=p.A,M=p.R;Array.isArray(M)||(M=[String(M)]),Lo(k.i,"t",M),p.C=0,k=p.j.J,p.h=new Wd,p.g=oh(p.j,k?b:null,!p.m),0<p.O&&(p.M=new Ge(S(p.Y,p,p.g),p.O)),b=p.U,k=p.g,M=p.ca;var ae="readystatechange";Array.isArray(ae)||(ae&&(ke[0]=ae.toString()),ae=ke);for(var be=0;be<ae.length;be++){var Me=fe(k,ae[be],M||b.handleEvent,!1,b.h||b);if(!Me)break;b.g[Me.key]=Me}b=p.H?R(p.H):{},p.m?(p.u||(p.u="POST"),b["Content-Type"]="application/x-www-form-urlencoded",p.g.ea(p.A,p.u,p.m,b)):(p.u="GET",p.g.ea(p.A,p.u,null,b)),Ur(),vi(p.i,p.u,p.A,p.l,p.R,p.m)}ti.prototype.ca=function(p){p=p.target;const b=this.M;b&&mr(p)==3?b.j():this.Y(p)},ti.prototype.Y=function(p){try{if(p==this.g)e:{const Sn=mr(this.g);var b=this.g.Ba();const $r=this.g.Z();if(!(3>Sn)&&(Sn!=3||this.g&&(this.h.h||this.g.oa()||Hc(this.g)))){this.J||Sn!=4||b==7||(b==8||0>=$r?Ur(3):Ur(2)),Ws(this);var k=this.g.Z();this.X=k;t:if(Vd(this)){var M=Hc(this.g);p="";var ae=M.length,be=mr(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){qr(this),Bo(this);var Me="";break t}this.h.i=new d.TextDecoder}for(b=0;b<ae;b++)this.h.h=!0,p+=this.h.i.decode(M[b],{stream:!(be&&b==ae-1)});M.length=0,this.h.g+=p,this.C=0,Me=this.h.g}else Me=this.g.oa();if(this.o=k==200,mt(this.i,this.u,this.A,this.l,this.R,Sn,k),this.o){if(this.T&&!this.K){t:{if(this.g){var Ot,_n=this.g;if((Ot=_n.g?_n.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!P(Ot)){var At=Ot;break t}}At=null}if(k=At)sr(this.i,this.l,k,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Oc(this,k);else{this.o=!1,this.s=3,sn(12),qr(this),Bo(this);break e}}if(this.P){k=!0;let Br;for(;!this.J&&this.C<Me.length;)if(Br=rm(this,Me),Br==$a){Sn==4&&(this.s=4,sn(14),k=!1),sr(this.i,this.l,null,"[Incomplete Response]");break}else if(Br==Mc){this.s=4,sn(15),sr(this.i,this.l,Me,"[Invalid Chunk]"),k=!1;break}else sr(this.i,this.l,Br,null),Oc(this,Br);if(Vd(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Sn!=4||Me.length!=0||this.h.h||(this.s=1,sn(16),k=!1),this.o=this.o&&k,!k)sr(this.i,this.l,Me,"[Invalid Chunked Response]"),qr(this),Bo(this);else if(0<Me.length&&!this.W){this.W=!0;var zn=this.j;zn.g==this&&zn.ba&&!zn.M&&(zn.j.info("Great, no buffering proxy detected. Bytes received: "+Me.length),Gc(zn),zn.M=!0,sn(11))}}else sr(this.i,this.l,Me,null),Oc(this,Me);Sn==4&&qr(this),this.o&&!this.J&&(Sn==4?il(this.j,this):(this.o=!1,Kt(this)))}else Za(this.g),k==400&&0<Me.indexOf("Unknown SID")?(this.s=3,sn(12)):(this.s=0,sn(13)),qr(this),Bo(this)}}}catch{}finally{}};function Vd(p){return p.g?p.u=="GET"&&p.L!=2&&p.j.Ca:!1}function rm(p,b){var k=p.C,M=b.indexOf(`
`,k);return M==-1?$a:(k=Number(b.substring(k,M)),isNaN(k)?Mc:(M+=1,M+k>b.length?$a:(b=b.slice(M,M+k),p.C=M+k,b)))}ti.prototype.cancel=function(){this.J=!0,qr(this)};function Kt(p){p.S=Date.now()+p.I,Ud(p,p.I)}function Ud(p,b){if(p.B!=null)throw Error("WatchDog timer not null");p.B=pr(S(p.ba,p),b)}function Ws(p){p.B&&(d.clearTimeout(p.B),p.B=null)}ti.prototype.ba=function(){this.B=null;const p=Date.now();0<=p-this.S?(Ki(this.i,this.A),this.L!=2&&(Ur(),sn(17)),qr(this),this.s=2,Bo(this)):Ud(this,this.S-p)};function Bo(p){p.j.G==0||p.J||il(p.j,p)}function qr(p){Ws(p);var b=p.M;b&&typeof b.ma=="function"&&b.ma(),p.M=null,at(p.U),p.g&&(b=p.g,p.g=null,b.abort(),b.ma())}function Oc(p,b){try{var k=p.j;if(k.G!=0&&(k.g==p||ar(k.h,p))){if(!p.K&&ar(k.h,p)&&k.G==3){try{var M=k.Da.g.parse(b)}catch{M=null}if(Array.isArray(M)&&M.length==3){var ae=M;if(ae[0]==0){e:if(!k.u){if(k.g)if(k.g.F+3e3<p.F)rl(k),si(k);else break e;nl(k),sn(18)}}else k.za=ae[1],0<k.za-k.T&&37500>ae[2]&&k.F&&k.v==0&&!k.C&&(k.C=pr(S(k.Za,k),6e3));if(1>=Hd(k.h)&&k.ca){try{k.ca()}catch{}k.ca=void 0}}else Zi(k,11)}else if((p.K||k.g==p)&&rl(k),!P(b))for(ae=k.Da.g.parse(b),b=0;b<ae.length;b++){let At=ae[b];if(k.T=At[0],At=At[1],k.G==2)if(At[0]=="c"){k.K=At[1],k.ia=At[2];const zn=At[3];zn!=null&&(k.la=zn,k.j.info("VER="+k.la));const Sn=At[4];Sn!=null&&(k.Aa=Sn,k.j.info("SVER="+k.Aa));const $r=At[5];$r!=null&&typeof $r=="number"&&0<$r&&(M=1.5*$r,k.L=M,k.j.info("backChannelRequestTimeoutMs_="+M)),M=k;const Br=p.g;if(Br){const Ks=Br.g?Br.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Ks){var be=M.h;be.g||Ks.indexOf("spdy")==-1&&Ks.indexOf("quic")==-1&&Ks.indexOf("h2")==-1||(be.j=be.l,be.g=new Set,be.h&&(Wc(be,be.h),be.h=null))}if(M.D){const sl=Br.g?Br.g.getResponseHeader("X-HTTP-Session-Id"):null;sl&&(M.ya=sl,Ht(M.I,M.D,sl))}}k.G=3,k.l&&k.l.ua(),k.ba&&(k.R=Date.now()-p.F,k.j.info("Handshake RTT: "+k.R+"ms")),M=k;var Me=p;if(M.qa=ih(M,M.J?M.ia:null,M.W),Me.K){$d(M.h,Me);var Ot=Me,_n=M.L;_n&&(Ot.I=_n),Ot.B&&(Ws(Ot),Kt(Ot)),M.g=Me}else Gs(M);0<k.i.length&&Ti(k)}else At[0]!="stop"&&At[0]!="close"||Zi(k,7);else k.G==3&&(At[0]=="stop"||At[0]=="close"?At[0]=="stop"?Zi(k,7):$n(k):At[0]!="noop"&&k.l&&k.l.ta(At),k.v=0)}}Ur(4)}catch{}}var qd=class{constructor(p,b){this.g=p,this.map=b}};function Vs(p){this.l=p||10,d.PerformanceNavigationTiming?(p=d.performance.getEntriesByType("navigation"),p=0<p.length&&(p[0].nextHopProtocol=="hq"||p[0].nextHopProtocol=="h2")):p=!!(d.chrome&&d.chrome.loadTimes&&d.chrome.loadTimes()&&d.chrome.loadTimes().wasFetchedViaSpdy),this.j=p?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Er(p){return p.h?!0:p.g?p.g.size>=p.j:!1}function Hd(p){return p.h?1:p.g?p.g.size:0}function ar(p,b){return p.h?p.h==b:p.g?p.g.has(b):!1}function Wc(p,b){p.g?p.g.add(b):p.h=b}function $d(p,b){p.h&&p.h==b?p.h=null:p.g&&p.g.has(b)&&p.g.delete(b)}Vs.prototype.cancel=function(){if(this.i=Gd(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const p of this.g.values())p.cancel();this.g.clear()}};function Gd(p){if(p.h!=null)return p.i.concat(p.h.D);if(p.g!=null&&p.g.size!==0){let b=p.i;for(const k of p.g.values())b=b.concat(k.D);return b}return I(p.i)}function Ka(p){if(p.V&&typeof p.V=="function")return p.V();if(typeof Map<"u"&&p instanceof Map||typeof Set<"u"&&p instanceof Set)return Array.from(p.values());if(typeof p=="string")return p.split("");if(h(p)){for(var b=[],k=p.length,M=0;M<k;M++)b.push(p[M]);return b}b=[],k=0;for(M in p)b[k++]=p[M];return b}function Qa(p){if(p.na&&typeof p.na=="function")return p.na();if(!p.V||typeof p.V!="function"){if(typeof Map<"u"&&p instanceof Map)return Array.from(p.keys());if(!(typeof Set<"u"&&p instanceof Set)){if(h(p)||typeof p=="string"){var b=[];p=p.length;for(var k=0;k<p;k++)b.push(k);return b}b=[],k=0;for(const M in p)b[k++]=M;return b}}}function Fo(p,b){if(p.forEach&&typeof p.forEach=="function")p.forEach(b,void 0);else if(h(p)||typeof p=="string")Array.prototype.forEach.call(p,b,void 0);else for(var k=Qa(p),M=Ka(p),ae=M.length,be=0;be<ae;be++)b.call(void 0,M[be],k&&k[be],p)}var Us=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function im(p,b){if(p){p=p.split("&");for(var k=0;k<p.length;k++){var M=p[k].indexOf("="),ae=null;if(0<=M){var be=p[k].substring(0,M);ae=p[k].substring(M+1)}else be=p[k];b(be,ae?decodeURIComponent(ae.replace(/\+/g," ")):"")}}}function Qi(p){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,p instanceof Qi){this.h=p.h,qs(this,p.j),this.o=p.o,this.g=p.g,zo(this,p.s),this.l=p.l;var b=p.i,k=new wi;k.i=b.i,b.g&&(k.g=new Map(b.g),k.h=b.h),Do(this,k),this.m=p.m}else p&&(b=String(p).match(Us))?(this.h=!1,qs(this,b[1]||"",!0),this.o=Rt(b[2]||""),this.g=Rt(b[3]||"",!0),zo(this,b[4]),this.l=Rt(b[5]||"",!0),Do(this,b[6]||"",!0),this.m=Rt(b[7]||"")):(this.h=!1,this.i=new wi(null,this.h))}Qi.prototype.toString=function(){var p=[],b=this.j;b&&p.push(Mo(b,Ya,!0),":");var k=this.g;return(k||b=="file")&&(p.push("//"),(b=this.o)&&p.push(Mo(b,Ya,!0),"@"),p.push(encodeURIComponent(String(k)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),k=this.s,k!=null&&p.push(":",String(k))),(k=this.l)&&(this.g&&k.charAt(0)!="/"&&p.push("/"),p.push(Mo(k,k.charAt(0)=="/"?Yd:Qd,!0))),(k=this.i.toString())&&p.push("?",k),(k=this.m)&&p.push("#",Mo(k,Vc)),p.join("")};function Ar(p){return new Qi(p)}function qs(p,b,k){p.j=k?Rt(b,!0):b,p.j&&(p.j=p.j.replace(/:$/,""))}function zo(p,b){if(b){if(b=Number(b),isNaN(b)||0>b)throw Error("Bad port number "+b);p.s=b}else p.s=null}function Do(p,b,k){b instanceof wi?(p.i=b,Si(p.i,p.h)):(k||(b=Mo(b,Xd)),p.i=new wi(b,p.h))}function Ht(p,b,k){p.i.set(b,k)}function No(p){return Ht(p,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),p}function Rt(p,b){return p?b?decodeURI(p.replace(/%25/g,"%2525")):decodeURIComponent(p):""}function Mo(p,b,k){return typeof p=="string"?(p=encodeURI(p).replace(b,Kd),k&&(p=p.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),p):null}function Kd(p){return p=p.charCodeAt(0),"%"+(p>>4&15).toString(16)+(p&15).toString(16)}var Ya=/[#\/\?@]/g,Qd=/[#\?:]/g,Yd=/[#\?]/g,Xd=/[#\?@]/g,Vc=/#/g;function wi(p,b){this.h=this.g=null,this.i=p||null,this.j=!!b}function Hn(p){p.g||(p.g=new Map,p.h=0,p.i&&im(p.i,function(b,k){p.add(decodeURIComponent(b.replace(/\+/g," ")),k)}))}n=wi.prototype,n.add=function(p,b){Hn(this),this.i=null,p=Hr(this,p);var k=this.g.get(p);return k||this.g.set(p,k=[]),k.push(b),this.h+=1,this};function ni(p,b){Hn(p),b=Hr(p,b),p.g.has(b)&&(p.i=null,p.h-=p.g.get(b).length,p.g.delete(b))}function ri(p,b){return Hn(p),b=Hr(p,b),p.g.has(b)}n.forEach=function(p,b){Hn(this),this.g.forEach(function(k,M){k.forEach(function(ae){p.call(b,ae,M,this)},this)},this)},n.na=function(){Hn(this);const p=Array.from(this.g.values()),b=Array.from(this.g.keys()),k=[];for(let M=0;M<b.length;M++){const ae=p[M];for(let be=0;be<ae.length;be++)k.push(b[M])}return k},n.V=function(p){Hn(this);let b=[];if(typeof p=="string")ri(this,p)&&(b=b.concat(this.g.get(Hr(this,p))));else{p=Array.from(this.g.values());for(let k=0;k<p.length;k++)b=b.concat(p[k])}return b},n.set=function(p,b){return Hn(this),this.i=null,p=Hr(this,p),ri(this,p)&&(this.h-=this.g.get(p).length),this.g.set(p,[b]),this.h+=1,this},n.get=function(p,b){return p?(p=this.V(p),0<p.length?String(p[0]):b):b};function Lo(p,b,k){ni(p,b),0<k.length&&(p.i=null,p.g.set(Hr(p,b),I(k)),p.h+=k.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const p=[],b=Array.from(this.g.keys());for(var k=0;k<b.length;k++){var M=b[k];const be=encodeURIComponent(String(M)),Me=this.V(M);for(M=0;M<Me.length;M++){var ae=be;Me[M]!==""&&(ae+="="+encodeURIComponent(String(Me[M]))),p.push(ae)}}return this.i=p.join("&")};function Hr(p,b){return b=String(b),p.j&&(b=b.toLowerCase()),b}function Si(p,b){b&&!p.j&&(Hn(p),p.i=null,p.g.forEach(function(k,M){var ae=M.toLowerCase();M!=ae&&(ni(this,M),Lo(this,ae,k))},p)),p.j=b}function om(p,b){const k=new bi;if(d.Image){const M=new Image;M.onload=C(fr,k,"TestLoadImage: loaded",!0,b,M),M.onerror=C(fr,k,"TestLoadImage: error",!1,b,M),M.onabort=C(fr,k,"TestLoadImage: abort",!1,b,M),M.ontimeout=C(fr,k,"TestLoadImage: timeout",!1,b,M),d.setTimeout(function(){M.ontimeout&&M.ontimeout()},1e4),M.src=p}else b(!1)}function Jd(p,b){const k=new bi,M=new AbortController,ae=setTimeout(()=>{M.abort(),fr(k,"TestPingServer: timeout",!1,b)},1e4);fetch(p,{signal:M.signal}).then(be=>{clearTimeout(ae),be.ok?fr(k,"TestPingServer: ok",!0,b):fr(k,"TestPingServer: server error",!1,b)}).catch(()=>{clearTimeout(ae),fr(k,"TestPingServer: error",!1,b)})}function fr(p,b,k,M,ae){try{ae&&(ae.onload=null,ae.onerror=null,ae.onabort=null,ae.ontimeout=null),M(k)}catch{}}function sm(){this.g=new De}function Zd(p,b,k){const M=k||"";try{Fo(p,function(ae,be){let Me=ae;m(ae)&&(Me=pe(ae)),b.push(M+be+"="+encodeURIComponent(Me))})}catch(ae){throw b.push(M+"type="+encodeURIComponent("_badmap")),ae}}function Yi(p){this.l=p.Ub||null,this.j=p.eb||!1}_(Yi,$e),Yi.prototype.g=function(){return new Hs(this.l,this.j)},Yi.prototype.i=function(p){return function(){return p}}({});function Hs(p,b){le.call(this),this.D=p,this.o=b,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}_(Hs,le),n=Hs.prototype,n.open=function(p,b){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=p,this.A=b,this.readyState=1,oi(this)},n.send=function(p){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const b={headers:this.u,method:this.B,credentials:this.m,cache:void 0};p&&(b.body=p),(this.D||d).fetch(new Request(this.A,b)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,ii(this)),this.readyState=0},n.Sa=function(p){if(this.g&&(this.l=p,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=p.headers,this.readyState=2,oi(this)),this.g&&(this.readyState=3,oi(this),this.g)))if(this.responseType==="arraybuffer")p.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof d.ReadableStream<"u"&&"body"in p){if(this.j=p.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;eh(this)}else p.text().then(this.Ra.bind(this),this.ga.bind(this))};function eh(p){p.j.read().then(p.Pa.bind(p)).catch(p.ga.bind(p))}n.Pa=function(p){if(this.g){if(this.o&&p.value)this.response.push(p.value);else if(!this.o){var b=p.value?p.value:new Uint8Array(0);(b=this.v.decode(b,{stream:!p.done}))&&(this.response=this.responseText+=b)}p.done?ii(this):oi(this),this.readyState==3&&eh(this)}},n.Ra=function(p){this.g&&(this.response=this.responseText=p,ii(this))},n.Qa=function(p){this.g&&(this.response=p,ii(this))},n.ga=function(){this.g&&ii(this)};function ii(p){p.readyState=4,p.l=null,p.j=null,p.v=null,oi(p)}n.setRequestHeader=function(p,b){this.u.append(p,b)},n.getResponseHeader=function(p){return this.h&&this.h.get(p.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const p=[],b=this.h.entries();for(var k=b.next();!k.done;)k=k.value,p.push(k[0]+": "+k[1]),k=b.next();return p.join(`\r
`)};function oi(p){p.onreadystatechange&&p.onreadystatechange.call(p)}Object.defineProperty(Hs.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(p){this.m=p?"include":"same-origin"}});function Xi(p){let b="";return W(p,function(k,M){b+=M,b+=":",b+=k,b+=`\r
`}),b}function Oo(p,b,k){e:{for(M in k){var M=!1;break e}M=!0}M||(k=Xi(k),typeof p=="string"?k!=null&&encodeURIComponent(String(k)):Ht(p,b,k))}function an(p){le.call(this),this.headers=new Map,this.o=p||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}_(an,le);var am=/^https?$/i,Uc=["POST","PUT"];n=an.prototype,n.Ha=function(p){this.J=p},n.ea=function(p,b,k,M){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+p);b=b?b.toUpperCase():"GET",this.D=p,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():ei.g(),this.v=this.o?lt(this.o):lt(ei),this.g.onreadystatechange=S(this.Ea,this);try{this.B=!0,this.g.open(b,String(p),!0),this.B=!1}catch(be){$s(this,be);return}if(p=k||"",k=new Map(this.headers),M)if(Object.getPrototypeOf(M)===Object.prototype)for(var ae in M)k.set(ae,M[ae]);else if(typeof M.keys=="function"&&typeof M.get=="function")for(const be of M.keys())k.set(be,M.get(be));else throw Error("Unknown input type for opt_headers: "+String(M));M=Array.from(k.keys()).find(be=>be.toLowerCase()=="content-type"),ae=d.FormData&&p instanceof d.FormData,!(0<=Array.prototype.indexOf.call(Uc,b,void 0))||M||ae||k.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[be,Me]of k)this.g.setRequestHeader(be,Me);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Ja(this),this.u=!0,this.g.send(p),this.u=!1}catch(be){$s(this,be)}};function $s(p,b){p.h=!1,p.g&&(p.j=!0,p.g.abort(),p.j=!1),p.l=b,p.m=5,Xa(p),Pr(p)}function Xa(p){p.A||(p.A=!0,Re(p,"complete"),Re(p,"error"))}n.abort=function(p){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=p||7,Re(this,"complete"),Re(this,"abort"),Pr(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Pr(this,!0)),an.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?qc(this):this.bb())},n.bb=function(){qc(this)};function qc(p){if(p.h&&typeof c<"u"&&(!p.v[1]||mr(p)!=4||p.Z()!=2)){if(p.u&&mr(p)==4)xe(p.Ea,0,p);else if(Re(p,"readystatechange"),mr(p)==4){p.h=!1;try{const Me=p.Z();e:switch(Me){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var b=!0;break e;default:b=!1}var k;if(!(k=b)){var M;if(M=Me===0){var ae=String(p.D).match(Us)[1]||null;!ae&&d.self&&d.self.location&&(ae=d.self.location.protocol.slice(0,-1)),M=!am.test(ae?ae.toLowerCase():"")}k=M}if(k)Re(p,"complete"),Re(p,"success");else{p.m=6;try{var be=2<mr(p)?p.g.statusText:""}catch{be=""}p.l=be+" ["+p.Z()+"]",Xa(p)}}finally{Pr(p)}}}}function Pr(p,b){if(p.g){Ja(p);const k=p.g,M=p.v[0]?()=>{}:null;p.g=null,p.v=null,b||Re(p,"ready");try{k.onreadystatechange=M}catch{}}}function Ja(p){p.I&&(d.clearTimeout(p.I),p.I=null)}n.isActive=function(){return!!this.g};function mr(p){return p.g?p.g.readyState:0}n.Z=function(){try{return 2<mr(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(p){if(this.g){var b=this.g.responseText;return p&&b.indexOf(p)==0&&(b=b.substring(p.length)),de(b)}};function Hc(p){try{if(!p.g)return null;if("response"in p.g)return p.g.response;switch(p.H){case"":case"text":return p.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in p.g)return p.g.mozResponseArrayBuffer}return null}catch{return null}}function Za(p){const b={};p=(p.g&&2<=mr(p)&&p.g.getAllResponseHeaders()||"").split(`\r
`);for(let M=0;M<p.length;M++){if(P(p[M]))continue;var k=O(p[M]);const ae=k[0];if(k=k[1],typeof k!="string")continue;k=k.trim();const be=b[ae]||[];b[ae]=be,be.push(k)}L(b,function(M){return M.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function ki(p,b,k){return k&&k.internalChannelParams&&k.internalChannelParams[p]||b}function $c(p){this.Aa=0,this.i=[],this.j=new bi,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=ki("failFast",!1,p),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=ki("baseRetryDelayMs",5e3,p),this.cb=ki("retryDelaySeedMs",1e4,p),this.Wa=ki("forwardChannelMaxRetries",2,p),this.wa=ki("forwardChannelRequestTimeoutMs",2e4,p),this.pa=p&&p.xmlHttpFactory||void 0,this.Xa=p&&p.Tb||void 0,this.Ca=p&&p.useFetchStreams||!1,this.L=void 0,this.J=p&&p.supportsCrossDomainXhr||!1,this.K="",this.h=new Vs(p&&p.concurrentRequestLimit),this.Da=new sm,this.P=p&&p.fastHandshake||!1,this.O=p&&p.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=p&&p.Rb||!1,p&&p.xa&&this.j.xa(),p&&p.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&p&&p.detectBufferingProxy||!1,this.ja=void 0,p&&p.longPollingTimeout&&0<p.longPollingTimeout&&(this.ja=p.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=$c.prototype,n.la=8,n.G=1,n.connect=function(p,b,k,M){sn(0),this.W=p,this.H=b||{},k&&M!==void 0&&(this.H.OSID=k,this.H.OAID=M),this.F=this.X,this.I=ih(this,null,this.W),Ti(this)};function $n(p){if(el(p),p.G==3){var b=p.U++,k=Ar(p.I);if(Ht(k,"SID",p.K),Ht(k,"RID",b),Ht(k,"TYPE","terminate"),Ji(p,k),b=new ti(p,p.j,b),b.L=2,b.v=No(Ar(k)),k=!1,d.navigator&&d.navigator.sendBeacon)try{k=d.navigator.sendBeacon(b.v.toString(),"")}catch{}!k&&d.Image&&(new Image().src=b.v,k=!0),k||(b.g=oh(b.j,null),b.g.ea(b.v)),b.F=Date.now(),Kt(b)}rh(p)}function si(p){p.g&&(Gc(p),p.g.cancel(),p.g=null)}function el(p){si(p),p.u&&(d.clearTimeout(p.u),p.u=null),rl(p),p.h.cancel(),p.s&&(typeof p.s=="number"&&d.clearTimeout(p.s),p.s=null)}function Ti(p){if(!Er(p.h)&&!p.s){p.s=!0;var b=p.Ga;ne||Q(),oe||(ne(),oe=!0),J.add(b,p),p.B=0}}function lm(p,b){return Hd(p.h)>=p.h.j-(p.s?1:0)?!1:p.s?(p.i=b.D.concat(p.i),!0):p.G==1||p.G==2||p.B>=(p.Va?0:p.Wa)?!1:(p.s=pr(S(p.Ga,p,b),nh(p,p.B)),p.B++,!0)}n.Ga=function(p){if(this.s)if(this.s=null,this.G==1){if(!p){this.U=Math.floor(1e5*Math.random()),p=this.U++;const ae=new ti(this,this.j,p);let be=this.o;if(this.S&&(be?(be=R(be),N(be,this.S)):be=this.S),this.m!==null||this.O||(ae.H=be,be=null),this.P)e:{for(var b=0,k=0;k<this.i.length;k++){t:{var M=this.i[k];if("__data__"in M.map&&(M=M.map.__data__,typeof M=="string")){M=M.length;break t}M=void 0}if(M===void 0)break;if(b+=M,4096<b){b=k;break e}if(b===4096||k===this.i.length-1){b=k+1;break e}}b=1e3}else b=1e3;b=Wo(this,ae,b),k=Ar(this.I),Ht(k,"RID",p),Ht(k,"CVER",22),this.D&&Ht(k,"X-HTTP-Session-Id",this.D),Ji(this,k),be&&(this.O?b="headers="+encodeURIComponent(String(Xi(be)))+"&"+b:this.m&&Oo(k,this.m,be)),Wc(this.h,ae),this.Ua&&Ht(k,"TYPE","init"),this.P?(Ht(k,"$req",b),Ht(k,"SID","null"),ae.T=!0,Ga(ae,k,null)):Ga(ae,k,b),this.G=2}}else this.G==3&&(p?tl(this,p):this.i.length==0||Er(this.h)||tl(this))};function tl(p,b){var k;b?k=b.l:k=p.U++;const M=Ar(p.I);Ht(M,"SID",p.K),Ht(M,"RID",k),Ht(M,"AID",p.T),Ji(p,M),p.m&&p.o&&Oo(M,p.m,p.o),k=new ti(p,p.j,k,p.B+1),p.m===null&&(k.H=p.o),b&&(p.i=b.D.concat(p.i)),b=Wo(p,k,1e3),k.I=Math.round(.5*p.wa)+Math.round(.5*p.wa*Math.random()),Wc(p.h,k),Ga(k,M,b)}function Ji(p,b){p.H&&W(p.H,function(k,M){Ht(b,M,k)}),p.l&&Fo({},function(k,M){Ht(b,M,k)})}function Wo(p,b,k){k=Math.min(p.i.length,k);var M=p.l?S(p.l.Na,p.l,p):null;e:{var ae=p.i;let be=-1;for(;;){const Me=["count="+k];be==-1?0<k?(be=ae[0].g,Me.push("ofs="+be)):be=0:Me.push("ofs="+be);let Ot=!0;for(let _n=0;_n<k;_n++){let At=ae[_n].g;const zn=ae[_n].map;if(At-=be,0>At)be=Math.max(0,ae[_n].g-100),Ot=!1;else try{Zd(zn,Me,"req"+At+"_")}catch{M&&M(zn)}}if(Ot){M=Me.join("&");break e}}}return p=p.i.splice(0,k),b.D=p,M}function Gs(p){if(!p.g&&!p.u){p.Y=1;var b=p.Fa;ne||Q(),oe||(ne(),oe=!0),J.add(b,p),p.v=0}}function nl(p){return p.g||p.u||3<=p.v?!1:(p.Y++,p.u=pr(S(p.Fa,p),nh(p,p.v)),p.v++,!0)}n.Fa=function(){if(this.u=null,th(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var p=2*this.R;this.j.info("BP detection timer enabled: "+p),this.A=pr(S(this.ab,this),p)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,sn(10),si(this),th(this))};function Gc(p){p.A!=null&&(d.clearTimeout(p.A),p.A=null)}function th(p){p.g=new ti(p,p.j,"rpc",p.Y),p.m===null&&(p.g.H=p.o),p.g.O=0;var b=Ar(p.qa);Ht(b,"RID","rpc"),Ht(b,"SID",p.K),Ht(b,"AID",p.T),Ht(b,"CI",p.F?"0":"1"),!p.F&&p.ja&&Ht(b,"TO",p.ja),Ht(b,"TYPE","xmlhttp"),Ji(p,b),p.m&&p.o&&Oo(b,p.m,p.o),p.L&&(p.g.I=p.L);var k=p.g;p=p.ia,k.L=1,k.v=No(Ar(b)),k.m=null,k.P=!0,Lc(k,p)}n.Za=function(){this.C!=null&&(this.C=null,si(this),nl(this),sn(19))};function rl(p){p.C!=null&&(d.clearTimeout(p.C),p.C=null)}function il(p,b){var k=null;if(p.g==b){rl(p),Gc(p),p.g=null;var M=2}else if(ar(p.h,b))k=b.D,$d(p.h,b),M=1;else return;if(p.G!=0){if(b.o)if(M==1){k=b.m?b.m.length:0,b=Date.now()-b.F;var ae=p.B;M=on(),Re(M,new Gi(M,k)),Ti(p)}else Gs(p);else if(ae=b.s,ae==3||ae==0&&0<b.X||!(M==1&&lm(p,b)||M==2&&nl(p)))switch(k&&0<k.length&&(b=p.h,b.i=b.i.concat(k)),ae){case 1:Zi(p,5);break;case 4:Zi(p,10);break;case 3:Zi(p,6);break;default:Zi(p,2)}}}function nh(p,b){let k=p.Ta+Math.floor(Math.random()*p.cb);return p.isActive()||(k*=2),k*b}function Zi(p,b){if(p.j.info("Error code "+b),b==2){var k=S(p.fb,p),M=p.Xa;const ae=!M;M=new Qi(M||"//www.google.com/images/cleardot.gif"),d.location&&d.location.protocol=="http"||qs(M,"https"),No(M),ae?om(M.toString(),k):Jd(M.toString(),k)}else sn(2);p.G=0,p.l&&p.l.sa(b),rh(p),el(p)}n.fb=function(p){p?(this.j.info("Successfully pinged google.com"),sn(2)):(this.j.info("Failed to ping google.com"),sn(1))};function rh(p){if(p.G=0,p.ka=[],p.l){const b=Gd(p.h);(b.length!=0||p.i.length!=0)&&(T(p.ka,b),T(p.ka,p.i),p.h.i.length=0,I(p.i),p.i.length=0),p.l.ra()}}function ih(p,b,k){var M=k instanceof Qi?Ar(k):new Qi(k);if(M.g!="")b&&(M.g=b+"."+M.g),zo(M,M.s);else{var ae=d.location;M=ae.protocol,b=b?b+"."+ae.hostname:ae.hostname,ae=+ae.port;var be=new Qi(null);M&&qs(be,M),b&&(be.g=b),ae&&zo(be,ae),k&&(be.l=k),M=be}return k=p.D,b=p.ya,k&&b&&Ht(M,k,b),Ht(M,"VER",p.la),Ji(p,M),M}function oh(p,b,k){if(b&&!p.J)throw Error("Can't create secondary domain capable XhrIo object.");return b=p.Ca&&!p.pa?new an(new Yi({eb:k})):new an(p.pa),b.Ha(p.J),b}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Kc(){}n=Kc.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function ol(){}ol.prototype.g=function(p,b){return new lr(p,b)};function lr(p,b){le.call(this),this.g=new $c(b),this.l=p,this.h=b&&b.messageUrlParams||null,p=b&&b.messageHeaders||null,b&&b.clientProtocolHeaderRequired&&(p?p["X-Client-Protocol"]="webchannel":p={"X-Client-Protocol":"webchannel"}),this.g.o=p,p=b&&b.initMessageHeaders||null,b&&b.messageContentType&&(p?p["X-WebChannel-Content-Type"]=b.messageContentType:p={"X-WebChannel-Content-Type":b.messageContentType}),b&&b.va&&(p?p["X-WebChannel-Client-Profile"]=b.va:p={"X-WebChannel-Client-Profile":b.va}),this.g.S=p,(p=b&&b.Sb)&&!P(p)&&(this.g.m=p),this.v=b&&b.supportsCrossDomainXhr||!1,this.u=b&&b.sendRawJson||!1,(b=b&&b.httpSessionIdParam)&&!P(b)&&(this.g.D=b,p=this.h,p!==null&&b in p&&(p=this.h,b in p&&delete p[b])),this.j=new _i(this)}_(lr,le),lr.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},lr.prototype.close=function(){$n(this.g)},lr.prototype.o=function(p){var b=this.g;if(typeof p=="string"){var k={};k.__data__=p,p=k}else this.u&&(k={},k.__data__=pe(p),p=k);b.i.push(new qd(b.Ya++,p)),b.G==3&&Ti(b)},lr.prototype.N=function(){this.g.l=null,delete this.j,$n(this.g),delete this.g,lr.aa.N.call(this)};function sh(p){gt.call(this),p.__headers__&&(this.headers=p.__headers__,this.statusCode=p.__status__,delete p.__headers__,delete p.__status__);var b=p.__sm__;if(b){e:{for(const k in b){p=k;break e}p=void 0}(this.i=p)&&(p=this.i,b=b!==null&&p in b?b[p]:void 0),this.data=b}else this.data=p}_(sh,gt);function ah(){Et.call(this),this.status=1}_(ah,Et);function _i(p){this.g=p}_(_i,Kc),_i.prototype.ua=function(){Re(this.g,"a")},_i.prototype.ta=function(p){Re(this.g,new sh(p))},_i.prototype.sa=function(p){Re(this.g,new ah)},_i.prototype.ra=function(){Re(this.g,"b")},ol.prototype.createWebChannel=ol.prototype.g,lr.prototype.send=lr.prototype.o,lr.prototype.open=lr.prototype.m,lr.prototype.close=lr.prototype.close,$k=function(){return new ol},Hk=function(){return on()},qk=Nt,gy={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Ha.NO_ERROR=0,Ha.TIMEOUT=8,Ha.HTTP_ERROR=6,mp=Ha,Od.COMPLETE="complete",Uk=Od,pt.EventType=bt,bt.OPEN="a",bt.CLOSE="b",bt.ERROR="c",bt.MESSAGE="d",le.prototype.listen=le.prototype.K,Eu=pt,an.prototype.listenOnce=an.prototype.L,an.prototype.getLastError=an.prototype.Ka,an.prototype.getLastErrorCode=an.prototype.Ba,an.prototype.getStatus=an.prototype.Z,an.prototype.getResponseJson=an.prototype.Oa,an.prototype.getResponseText=an.prototype.oa,an.prototype.send=an.prototype.ea,an.prototype.setWithCredentials=an.prototype.Ha,Vk=an}).apply(typeof tp<"u"?tp:typeof self<"u"?self:typeof window<"u"?window:{});const kw="@firebase/firestore",Tw="4.7.17";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wn{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Wn.UNAUTHENTICATED=new Wn(null),Wn.GOOGLE_CREDENTIALS=new Wn("google-credentials-uid"),Wn.FIRST_PARTY=new Wn("first-party-uid"),Wn.MOCK_USER=new Wn("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let wc="11.9.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bs=new cx("@firebase/firestore");function Ml(){return bs.logLevel}function wA(n){bs.setLogLevel(n)}function Ie(n,...e){if(bs.logLevel<=jt.DEBUG){const t=e.map(hx);bs.debug(`Firestore (${wc}): ${n}`,...t)}}function bn(n,...e){if(bs.logLevel<=jt.ERROR){const t=e.map(hx);bs.error(`Firestore (${wc}): ${n}`,...t)}}function Or(n,...e){if(bs.logLevel<=jt.WARN){const t=e.map(hx);bs.warn(`Firestore (${wc}): ${n}`,...t)}}function hx(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(t){return JSON.stringify(t)}(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ke(n,e,t){let r="Unexpected state";typeof e=="string"?r=e:t=e,Gk(n,r,t)}function Gk(n,e,t){let r=`FIRESTORE (${wc}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{r+=" CONTEXT: "+JSON.stringify(t)}catch{r+=" CONTEXT: "+t}throw bn(r),new Error(r)}function tt(n,e,t,r){let o="Unexpected state";typeof t=="string"?o=t:r=t,n||Gk(e,o,r)}function SA(n,e){n||Ke(57014,e)}function Le(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ye={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class je extends qi{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Un{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kk{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class Qk{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(Wn.UNAUTHENTICATED))}shutdown(){}}class kA{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class TA{constructor(e){this.t=e,this.currentUser=Wn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){tt(this.o===void 0,42304);let r=this.i;const o=h=>this.i!==r?(r=this.i,t(h)):Promise.resolve();let a=new Un;this.o=()=>{this.i++,this.currentUser=this.u(),a.resolve(),a=new Un,e.enqueueRetryable(()=>o(this.currentUser))};const c=()=>{const h=a;e.enqueueRetryable(async()=>{await h.promise,await o(this.currentUser)})},d=h=>{Ie("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=h,this.o&&(this.auth.addAuthTokenListener(this.o),c())};this.t.onInit(h=>d(h)),setTimeout(()=>{if(!this.auth){const h=this.t.getImmediate({optional:!0});h?d(h):(Ie("FirebaseAuthCredentialsProvider","Auth not yet detected"),a.resolve(),a=new Un)}},0),c()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(Ie("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(tt(typeof r.accessToken=="string",31837,{l:r}),new Kk(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return tt(e===null||typeof e=="string",2055,{h:e}),new Wn(e)}}class _A{constructor(e,t,r){this.P=e,this.T=t,this.I=r,this.type="FirstParty",this.user=Wn.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class jA{constructor(e,t,r){this.P=e,this.T=t,this.I=r}getToken(){return Promise.resolve(new _A(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t(Wn.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class yy{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class IA{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,kr(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){tt(this.o===void 0,3512);const r=a=>{a.error!=null&&Ie("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${a.error.message}`);const c=a.token!==this.m;return this.m=a.token,Ie("FirebaseAppCheckTokenProvider",`Received ${c?"new":"existing"} token.`),c?t(a.token):Promise.resolve()};this.o=a=>{e.enqueueRetryable(()=>r(a))};const o=a=>{Ie("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=a,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(a=>o(a)),setTimeout(()=>{if(!this.appCheck){const a=this.V.getImmediate({optional:!0});a?o(a):Ie("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new yy(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(tt(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new yy(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}class CA{getToken(){return Promise.resolve(new yy(""))}invalidateToken(){}start(e,t){}shutdown(){}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RA(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function px(){return new TextEncoder}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fx{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const o=RA(40);for(let a=0;a<o.length;++a)r.length<20&&o[a]<t&&(r+=e.charAt(o[a]%62))}return r}}function dt(n,e){return n<e?-1:n>e?1:0}function xy(n,e){let t=0;for(;t<n.length&&t<e.length;){const r=n.codePointAt(t),o=e.codePointAt(t);if(r!==o){if(r<128&&o<128)return dt(r,o);{const a=px(),c=EA(a.encode(_w(n,t)),a.encode(_w(e,t)));return c!==0?c:dt(r,o)}}t+=r>65535?2:1}return dt(n.length,e.length)}function _w(n,e){return n.codePointAt(e)>65535?n.substring(e,e+2):n.substring(e,e+1)}function EA(n,e){for(let t=0;t<n.length&&t<e.length;++t)if(n[t]!==e[t])return dt(n[t],e[t]);return dt(n.length,e.length)}function Ql(n,e,t){return n.length===e.length&&n.every((r,o)=>t(r,e[o]))}function Yk(n){return n+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jw=-62135596800,Iw=1e6;class Gt{static now(){return Gt.fromMillis(Date.now())}static fromDate(e){return Gt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor((e-1e3*t)*Iw);return new Gt(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new je(ye.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new je(ye.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<jw)throw new je(ye.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new je(ye.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/Iw}_compareTo(e){return this.seconds===e.seconds?dt(this.nanoseconds,e.nanoseconds):dt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds-jw;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class st{static fromTimestamp(e){return new st(e)}static min(){return new st(new Gt(0,0))}static max(){return new st(new Gt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const by="__name__";class Pi{constructor(e,t,r){t===void 0?t=0:t>e.length&&Ke(637,{offset:t,range:e.length}),r===void 0?r=e.length-t:r>e.length-t&&Ke(1746,{length:r,range:e.length-t}),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return Pi.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Pi?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let o=0;o<r;o++){const a=Pi.compareSegments(e.get(o),t.get(o));if(a!==0)return a}return dt(e.length,t.length)}static compareSegments(e,t){const r=Pi.isNumericId(e),o=Pi.isNumericId(t);return r&&!o?-1:!r&&o?1:r&&o?Pi.extractNumericId(e).compare(Pi.extractNumericId(t)):xy(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return ms.fromString(e.substring(4,e.length-2))}}class It extends Pi{construct(e,t,r){return new It(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new je(ye.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(o=>o.length>0))}return new It(t)}static emptyPath(){return new It([])}}const AA=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class tn extends Pi{construct(e,t,r){return new tn(e,t,r)}static isValidIdentifier(e){return AA.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),tn.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===by}static keyField(){return new tn([by])}static fromServerFormat(e){const t=[];let r="",o=0;const a=()=>{if(r.length===0)throw new je(ye.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let c=!1;for(;o<e.length;){const d=e[o];if(d==="\\"){if(o+1===e.length)throw new je(ye.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const h=e[o+1];if(h!=="\\"&&h!=="."&&h!=="`")throw new je(ye.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=h,o+=2}else d==="`"?(c=!c,o++):d!=="."||c?(r+=d,o++):(a(),o++)}if(a(),c)throw new je(ye.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new tn(t)}static emptyPath(){return new tn([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class We{constructor(e){this.path=e}static fromPath(e){return new We(It.fromString(e))}static fromName(e){return new We(It.fromString(e).popFirst(5))}static empty(){return new We(It.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&It.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return It.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new We(new It(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yl=-1;class Xl{constructor(e,t,r,o){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=o}}function vy(n){return n.fields.find(e=>e.kind===2)}function ca(n){return n.fields.filter(e=>e.kind!==2)}function PA(n,e){let t=dt(n.collectionGroup,e.collectionGroup);if(t!==0)return t;for(let r=0;r<Math.min(n.fields.length,e.fields.length);++r)if(t=BA(n.fields[r],e.fields[r]),t!==0)return t;return dt(n.fields.length,e.fields.length)}Xl.UNKNOWN_ID=-1;class va{constructor(e,t){this.fieldPath=e,this.kind=t}}function BA(n,e){const t=tn.comparator(n.fieldPath,e.fieldPath);return t!==0?t:dt(n.kind,e.kind)}class Jl{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new Jl(0,Wr.min())}}function Xk(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,o=st.fromTimestamp(r===1e9?new Gt(t+1,0):new Gt(t,r));return new Wr(o,We.empty(),e)}function Jk(n){return new Wr(n.readTime,n.key,Yl)}class Wr{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new Wr(st.min(),We.empty(),Yl)}static max(){return new Wr(st.max(),We.empty(),Yl)}}function mx(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=We.comparator(n.documentKey,e.documentKey),t!==0?t:dt(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zk="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class eT{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Rs(n){if(n.code!==ye.FAILED_PRECONDITION||n.message!==Zk)throw n;Ie("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class se{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Ke(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new se((r,o)=>{this.nextCallback=a=>{this.wrapSuccess(e,a).next(r,o)},this.catchCallback=a=>{this.wrapFailure(t,a).next(r,o)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof se?t:se.resolve(t)}catch(t){return se.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):se.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):se.reject(t)}static resolve(e){return new se((t,r)=>{t(e)})}static reject(e){return new se((t,r)=>{r(e)})}static waitFor(e){return new se((t,r)=>{let o=0,a=0,c=!1;e.forEach(d=>{++o,d.next(()=>{++a,c&&a===o&&t()},h=>r(h))}),c=!0,a===o&&t()})}static or(e){let t=se.resolve(!1);for(const r of e)t=t.next(o=>o?se.resolve(o):r());return t}static forEach(e,t){const r=[];return e.forEach((o,a)=>{r.push(t.call(this,o,a))}),this.waitFor(r)}static mapArray(e,t){return new se((r,o)=>{const a=e.length,c=new Array(a);let d=0;for(let h=0;h<a;h++){const m=h;t(e[m]).next(g=>{c[m]=g,++d,d===a&&r(c)},g=>o(g))}})}static doWhile(e,t){return new se((r,o)=>{const a=()=>{e()===!0?t().next(()=>{a()},o):r()};a()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nr="SimpleDb";class bf{static open(e,t,r,o){try{return new bf(t,e.transaction(o,r))}catch(a){throw new Du(t,a)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.S=new Un,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{t.error?this.S.reject(new Du(e,t.error)):this.S.resolve()},this.transaction.onerror=r=>{const o=gx(r.target.error);this.S.reject(new Du(e,o))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(Ie(Nr,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}v(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new zA(t)}}class Li{static delete(e){return Ie(Nr,"Removing database:",e),da(jk().indexedDB.deleteDatabase(e)).toPromise()}static C(){if(!zk())return!1;if(Li.F())return!0;const e=Pn(),t=Li.M(e),r=0<t&&t<10,o=tT(e),a=0<o&&o<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||a)}static F(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.O)==="YES"}static N(e,t){return e.store(t)}static M(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)}constructor(e,t,r){this.name=e,this.version=t,this.B=r,this.L=null,Li.M(Pn())===12.2&&bn("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async k(e){return this.db||(Ie(Nr,"Opening database:",this.name),this.db=await new Promise((t,r)=>{const o=indexedDB.open(this.name,this.version);o.onsuccess=a=>{const c=a.target.result;t(c)},o.onblocked=()=>{r(new Du(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},o.onerror=a=>{const c=a.target.error;c.name==="VersionError"?r(new je(ye.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):c.name==="InvalidStateError"?r(new je(ye.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+c)):r(new Du(e,c))},o.onupgradeneeded=a=>{Ie(Nr,'Database "'+this.name+'" requires upgrade from version:',a.oldVersion);const c=a.target.result;if(this.L!==null&&this.L!==a.oldVersion)throw new Error(`refusing to open IndexedDB database due to potential corruption of the IndexedDB database data; this corruption could be caused by clicking the "clear site data" button in a web browser; try reloading the web page to re-initialize the IndexedDB database: lastClosedDbVersion=${this.L}, event.oldVersion=${a.oldVersion}, event.newVersion=${a.newVersion}, db.version=${c.version}`);this.B.q(c,o.transaction,a.oldVersion,this.version).next(()=>{Ie(Nr,"Database upgrade to version "+this.version+" complete")})}}),this.db.addEventListener("close",t=>{const r=t.target;this.L=r.version},{passive:!0})),this.$&&(this.db.onversionchange=t=>this.$(t)),this.db}U(e){this.$=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,r,o){const a=t==="readonly";let c=0;for(;;){++c;try{this.db=await this.k(e);const d=bf.open(this.db,e,a?"readonly":"readwrite",r),h=o(d).next(m=>(d.v(),m)).catch(m=>(d.abort(m),se.reject(m))).toPromise();return h.catch(()=>{}),await d.D,h}catch(d){const h=d,m=h.name!=="FirebaseError"&&c<3;if(Ie(Nr,"Transaction failed with error:",h.message,"Retrying:",m),this.close(),!m)return Promise.reject(h)}}}close(){this.db&&this.db.close(),this.db=void 0}}function tT(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class FA{constructor(e){this.K=e,this.W=!1,this.G=null}get isDone(){return this.W}get j(){return this.G}set cursor(e){this.K=e}done(){this.W=!0}H(e){this.G=e}delete(){return da(this.K.delete())}}class Du extends je{constructor(e,t){super(ye.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function Es(n){return n.name==="IndexedDbTransactionError"}class zA{constructor(e){this.store=e}put(e,t){let r;return t!==void 0?(Ie(Nr,"PUT",this.store.name,e,t),r=this.store.put(t,e)):(Ie(Nr,"PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),da(r)}add(e){return Ie(Nr,"ADD",this.store.name,e,e),da(this.store.add(e))}get(e){return da(this.store.get(e)).next(t=>(t===void 0&&(t=null),Ie(Nr,"GET",this.store.name,e,t),t))}delete(e){return Ie(Nr,"DELETE",this.store.name,e),da(this.store.delete(e))}count(){return Ie(Nr,"COUNT",this.store.name),da(this.store.count())}J(e,t){const r=this.options(e,t),o=r.index?this.store.index(r.index):this.store;if(typeof o.getAll=="function"){const a=o.getAll(r.range);return new se((c,d)=>{a.onerror=h=>{d(h.target.error)},a.onsuccess=h=>{c(h.target.result)}})}{const a=this.cursor(r),c=[];return this.Y(a,(d,h)=>{c.push(h)}).next(()=>c)}}Z(e,t){const r=this.store.getAll(e,t===null?void 0:t);return new se((o,a)=>{r.onerror=c=>{a(c.target.error)},r.onsuccess=c=>{o(c.target.result)}})}X(e,t){Ie(Nr,"DELETE ALL",this.store.name);const r=this.options(e,t);r.ee=!1;const o=this.cursor(r);return this.Y(o,(a,c,d)=>d.delete())}te(e,t){let r;t?r=e:(r={},t=e);const o=this.cursor(r);return this.Y(o,t)}ne(e){const t=this.cursor({});return new se((r,o)=>{t.onerror=a=>{const c=gx(a.target.error);o(c)},t.onsuccess=a=>{const c=a.target.result;c?e(c.primaryKey,c.value).next(d=>{d?c.continue():r()}):r()}})}Y(e,t){const r=[];return new se((o,a)=>{e.onerror=c=>{a(c.target.error)},e.onsuccess=c=>{const d=c.target.result;if(!d)return void o();const h=new FA(d),m=t(d.primaryKey,d.value,h);if(m instanceof se){const g=m.catch(x=>(h.done(),se.reject(x)));r.push(g)}h.isDone?o():h.j===null?d.continue():d.continue(h.j)}}).next(()=>se.waitFor(r))}options(e,t){let r;return e!==void 0&&(typeof e=="string"?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const r=this.store.index(e.index);return e.ee?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function da(n){return new se((e,t)=>{n.onsuccess=r=>{const o=r.target.result;e(o)},n.onerror=r=>{const o=gx(r.target.error);t(o)}})}let Cw=!1;function gx(n){const e=Li.M(Pn());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const r=new je("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return Cw||(Cw=!0,setTimeout(()=>{throw r},0)),r}}return n}const Nu="IndexBackfiller";class DA{constructor(e,t){this.asyncQueue=e,this.re=t,this.task=null}start(){this.ie(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}ie(e){Ie(Nu,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{const t=await this.re.se();Ie(Nu,`Documents written: ${t}`)}catch(t){Es(t)?Ie(Nu,"Ignoring IndexedDB error during index backfill: ",t):await Rs(t)}await this.ie(6e4)})}}class NA{constructor(e,t){this.localStore=e,this.persistence=t}async se(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",t=>this.oe(t,e))}oe(e,t){const r=new Set;let o=t,a=!0;return se.doWhile(()=>a===!0&&o>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(c=>{if(c!==null&&!r.has(c))return Ie(Nu,`Processing collection: ${c}`),this._e(e,c,o).next(d=>{o-=d,r.add(c)});a=!1})).next(()=>t-o)}_e(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(o=>this.localStore.localDocuments.getNextDocuments(e,t,o,r).next(a=>{const c=a.changes;return this.localStore.indexManager.updateIndexEntries(e,c).next(()=>this.ae(o,a)).next(d=>(Ie(Nu,`Updating offset: ${d}`),this.localStore.indexManager.updateCollectionGroup(e,t,d))).next(()=>c.size)}))}ae(e,t){let r=e;return t.changes.forEach((o,a)=>{const c=Jk(a);mx(c,r)>0&&(r=c)}),new Wr(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tr{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this.ue(r),this.ce=r=>t.writeSequenceNumber(r))}ue(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ce&&this.ce(e),e}}Tr.le=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gs=-1;function pd(n){return n==null}function Yu(n){return n===0&&1/n==-1/0}function nT(n){return typeof n=="number"&&Number.isInteger(n)&&!Yu(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zp="";function ir(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=Rw(e)),e=MA(n.get(t),e);return Rw(e)}function MA(n,e){let t=e;const r=n.length;for(let o=0;o<r;o++){const a=n.charAt(o);switch(a){case"\0":t+="";break;case zp:t+="";break;default:t+=a}}return t}function Rw(n){return n+zp+""}function zi(n){const e=n.length;if(tt(e>=2,64408,{path:n}),e===2)return tt(n.charAt(0)===zp&&n.charAt(1)==="",56145,{path:n}),It.emptyPath();const t=e-2,r=[];let o="";for(let a=0;a<e;){const c=n.indexOf(zp,a);switch((c<0||c>t)&&Ke(50515,{path:n}),n.charAt(c+1)){case"":const d=n.substring(a,c);let h;o.length===0?h=d:(o+=d,h=o,o=""),r.push(h);break;case"":o+=n.substring(a,c),o+="\0";break;case"":o+=n.substring(a,c+1);break;default:Ke(61167,{path:n})}a=c+2}return new It(r)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ua="remoteDocuments",fd="owner",Il="owner",Xu="mutationQueues",LA="userId",pi="mutations",Ew="batchId",ma="userMutationsIndex",Aw=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gp(n,e){return[n,ir(e)]}function rT(n,e,t){return[n,ir(e),t]}const OA={},Zl="documentMutations",Dp="remoteDocumentsV14",WA=["prefixPath","collectionGroup","readTime","documentId"],yp="documentKeyIndex",VA=["prefixPath","collectionGroup","documentId"],iT="collectionGroupIndex",UA=["collectionGroup","readTime","prefixPath","documentId"],Ju="remoteDocumentGlobal",wy="remoteDocumentGlobalKey",ec="targets",oT="queryTargetsIndex",qA=["canonicalId","targetId"],tc="targetDocuments",HA=["targetId","path"],yx="documentTargetsIndex",$A=["path","targetId"],Np="targetGlobalKey",wa="targetGlobal",Zu="collectionParents",GA=["collectionId","parent"],nc="clientMetadata",KA="clientId",vf="bundles",QA="bundleId",wf="namedQueries",YA="name",xx="indexConfiguration",XA="indexId",Sy="collectionGroupIndex",JA="collectionGroup",Mu="indexState",ZA=["indexId","uid"],sT="sequenceNumberIndex",e6=["uid","sequenceNumber"],Lu="indexEntries",t6=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],aT="documentKeyIndex",n6=["indexId","uid","orderedDocumentKey"],Sf="documentOverlays",r6=["userId","collectionPath","documentId"],ky="collectionPathOverlayIndex",i6=["userId","collectionPath","largestBatchId"],lT="collectionGroupOverlayIndex",o6=["userId","collectionGroup","largestBatchId"],bx="globals",s6="name",cT=[Xu,pi,Zl,ua,ec,fd,wa,tc,nc,Ju,Zu,vf,wf],a6=[...cT,Sf],uT=[Xu,pi,Zl,Dp,ec,fd,wa,tc,nc,Ju,Zu,vf,wf,Sf],dT=uT,vx=[...dT,xx,Mu,Lu],l6=vx,hT=[...vx,bx],c6=hT;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ty extends eT{constructor(e,t){super(),this.he=e,this.currentSequenceNumber=t}}function Fn(n,e){const t=Le(n);return Li.N(t.he,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pw(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function As(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function pT(n,e){const t=[];for(const r in n)Object.prototype.hasOwnProperty.call(n,r)&&t.push(e(n[r],r,n));return t}function fT(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xt{constructor(e,t){this.comparator=e,this.root=t||Qn.EMPTY}insert(e,t){return new Xt(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Qn.BLACK,null,null))}remove(e){return new Xt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Qn.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const o=this.comparator(e,r.key);if(o===0)return t+r.left.size;o<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){const e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new np(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new np(this.root,e,this.comparator,!1)}getReverseIterator(){return new np(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new np(this.root,e,this.comparator,!0)}}class np{constructor(e,t,r,o){this.isReverse=o,this.nodeStack=[];let a=1;for(;!e.isEmpty();)if(a=t?r(e.key,t):1,t&&o&&(a*=-1),a<0)e=this.isReverse?e.left:e.right;else{if(a===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Qn{constructor(e,t,r,o,a){this.key=e,this.value=t,this.color=r??Qn.RED,this.left=o??Qn.EMPTY,this.right=a??Qn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,o,a){return new Qn(e??this.key,t??this.value,r??this.color,o??this.left,a??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let o=this;const a=r(e,o.key);return o=a<0?o.copy(null,null,null,o.left.insert(e,t,r),null):a===0?o.copy(null,t,null,null,null):o.copy(null,null,null,null,o.right.insert(e,t,r)),o.fixUp()}removeMin(){if(this.left.isEmpty())return Qn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,o=this;if(t(e,o.key)<0)o.left.isEmpty()||o.left.isRed()||o.left.left.isRed()||(o=o.moveRedLeft()),o=o.copy(null,null,null,o.left.remove(e,t),null);else{if(o.left.isRed()&&(o=o.rotateRight()),o.right.isEmpty()||o.right.isRed()||o.right.left.isRed()||(o=o.moveRedRight()),t(e,o.key)===0){if(o.right.isEmpty())return Qn.EMPTY;r=o.right.min(),o=o.copy(r.key,r.value,null,null,o.right.removeMin())}o=o.copy(null,null,null,null,o.right.remove(e,t))}return o.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Qn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Qn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Ke(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Ke(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Ke(27949);return e+(this.isRed()?0:1)}}Qn.EMPTY=null,Qn.RED=!0,Qn.BLACK=!1;Qn.EMPTY=new class{constructor(){this.size=0}get key(){throw Ke(57766)}get value(){throw Ke(16141)}get color(){throw Ke(16727)}get left(){throw Ke(29726)}get right(){throw Ke(36894)}copy(e,t,r,o,a){return this}insert(e,t,r){return new Qn(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ut{constructor(e){this.comparator=e,this.data=new Xt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const o=r.getNext();if(this.comparator(o.key,e[1])>=0)return;t(o.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Bw(this.data.getIterator())}getIteratorFrom(e){return new Bw(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof Ut)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const o=t.getNext().key,a=r.getNext().key;if(this.comparator(o,a)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new Ut(this.comparator);return t.data=e,t}}class Bw{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Cl(n){return n.hasNext()?n.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _r{constructor(e){this.fields=e,e.sort(tn.comparator)}static empty(){return new _r([])}unionWith(e){let t=new Ut(tn.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new _r(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Ql(this.fields,e.fields,(t,r)=>t.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mT extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function u6(){return typeof atob<"u"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fn{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(o){try{return atob(o)}catch(a){throw typeof DOMException<"u"&&a instanceof DOMException?new mT("Invalid base64 string: "+a):a}}(e);return new fn(t)}static fromUint8Array(e){const t=function(o){let a="";for(let c=0;c<o.length;++c)a+=String.fromCharCode(o[c]);return a}(e);return new fn(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){const r=new Uint8Array(t.length);for(let o=0;o<t.length;o++)r[o]=t.charCodeAt(o);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return dt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}fn.EMPTY_BYTE_STRING=new fn("");const d6=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function wo(n){if(tt(!!n,39018),typeof n=="string"){let e=0;const t=d6.exec(n);if(tt(!!t,46558,{timestamp:n}),t[1]){let o=t[1];o=(o+"000000000").substr(0,9),e=Number(o)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:cn(n.seconds),nanos:cn(n.nanos)}}function cn(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function So(n){return typeof n=="string"?fn.fromBase64String(n):fn.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gT="server_timestamp",yT="__type__",xT="__previous_value__",bT="__local_write_time__";function kf(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{})[yT])===null||t===void 0?void 0:t.stringValue)===gT}function Tf(n){const e=n.mapValue.fields[xT];return kf(e)?Tf(e):e}function ed(n){const e=wo(n.mapValue.fields[bT].timestampValue);return new Gt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h6{constructor(e,t,r,o,a,c,d,h,m,g){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=o,this.ssl=a,this.forceLongPolling=c,this.autoDetectLongPolling=d,this.longPollingOptions=h,this.useFetchStreams=m,this.isUsingEmulator=g}}const td="(default)";class vs{constructor(e,t){this.projectId=e,this.database=t||td}static empty(){return new vs("","")}get isDefaultDatabase(){return this.database===td}isEqual(e){return e instanceof vs&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wx="__type__",vT="__max__",us={mapValue:{fields:{__type__:{stringValue:vT}}}},Sx="__vector__",rc="value",xp={nullValue:"NULL_VALUE"};function ws(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?kf(n)?4:wT(n)?9007199254740991:_f(n)?10:11:Ke(28295,{value:n})}function Vi(n,e){if(n===e)return!0;const t=ws(n);if(t!==ws(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return ed(n).isEqual(ed(e));case 3:return function(o,a){if(typeof o.timestampValue=="string"&&typeof a.timestampValue=="string"&&o.timestampValue.length===a.timestampValue.length)return o.timestampValue===a.timestampValue;const c=wo(o.timestampValue),d=wo(a.timestampValue);return c.seconds===d.seconds&&c.nanos===d.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(o,a){return So(o.bytesValue).isEqual(So(a.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(o,a){return cn(o.geoPointValue.latitude)===cn(a.geoPointValue.latitude)&&cn(o.geoPointValue.longitude)===cn(a.geoPointValue.longitude)}(n,e);case 2:return function(o,a){if("integerValue"in o&&"integerValue"in a)return cn(o.integerValue)===cn(a.integerValue);if("doubleValue"in o&&"doubleValue"in a){const c=cn(o.doubleValue),d=cn(a.doubleValue);return c===d?Yu(c)===Yu(d):isNaN(c)&&isNaN(d)}return!1}(n,e);case 9:return Ql(n.arrayValue.values||[],e.arrayValue.values||[],Vi);case 10:case 11:return function(o,a){const c=o.mapValue.fields||{},d=a.mapValue.fields||{};if(Pw(c)!==Pw(d))return!1;for(const h in c)if(c.hasOwnProperty(h)&&(d[h]===void 0||!Vi(c[h],d[h])))return!1;return!0}(n,e);default:return Ke(52216,{left:n})}}function nd(n,e){return(n.values||[]).find(t=>Vi(t,e))!==void 0}function Ss(n,e){if(n===e)return 0;const t=ws(n),r=ws(e);if(t!==r)return dt(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return dt(n.booleanValue,e.booleanValue);case 2:return function(a,c){const d=cn(a.integerValue||a.doubleValue),h=cn(c.integerValue||c.doubleValue);return d<h?-1:d>h?1:d===h?0:isNaN(d)?isNaN(h)?0:-1:1}(n,e);case 3:return Fw(n.timestampValue,e.timestampValue);case 4:return Fw(ed(n),ed(e));case 5:return xy(n.stringValue,e.stringValue);case 6:return function(a,c){const d=So(a),h=So(c);return d.compareTo(h)}(n.bytesValue,e.bytesValue);case 7:return function(a,c){const d=a.split("/"),h=c.split("/");for(let m=0;m<d.length&&m<h.length;m++){const g=dt(d[m],h[m]);if(g!==0)return g}return dt(d.length,h.length)}(n.referenceValue,e.referenceValue);case 8:return function(a,c){const d=dt(cn(a.latitude),cn(c.latitude));return d!==0?d:dt(cn(a.longitude),cn(c.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return zw(n.arrayValue,e.arrayValue);case 10:return function(a,c){var d,h,m,g;const x=a.fields||{},S=c.fields||{},C=(d=x[rc])===null||d===void 0?void 0:d.arrayValue,_=(h=S[rc])===null||h===void 0?void 0:h.arrayValue,I=dt(((m=C==null?void 0:C.values)===null||m===void 0?void 0:m.length)||0,((g=_==null?void 0:_.values)===null||g===void 0?void 0:g.length)||0);return I!==0?I:zw(C,_)}(n.mapValue,e.mapValue);case 11:return function(a,c){if(a===us.mapValue&&c===us.mapValue)return 0;if(a===us.mapValue)return 1;if(c===us.mapValue)return-1;const d=a.fields||{},h=Object.keys(d),m=c.fields||{},g=Object.keys(m);h.sort(),g.sort();for(let x=0;x<h.length&&x<g.length;++x){const S=xy(h[x],g[x]);if(S!==0)return S;const C=Ss(d[h[x]],m[g[x]]);if(C!==0)return C}return dt(h.length,g.length)}(n.mapValue,e.mapValue);default:throw Ke(23264,{Pe:t})}}function Fw(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return dt(n,e);const t=wo(n),r=wo(e),o=dt(t.seconds,r.seconds);return o!==0?o:dt(t.nanos,r.nanos)}function zw(n,e){const t=n.values||[],r=e.values||[];for(let o=0;o<t.length&&o<r.length;++o){const a=Ss(t[o],r[o]);if(a)return a}return dt(t.length,r.length)}function ic(n){return _y(n)}function _y(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){const r=wo(t);return`time(${r.seconds},${r.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return So(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return We.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let r="[",o=!0;for(const a of t.values||[])o?o=!1:r+=",",r+=_y(a);return r+"]"}(n.arrayValue):"mapValue"in n?function(t){const r=Object.keys(t.fields||{}).sort();let o="{",a=!0;for(const c of r)a?a=!1:o+=",",o+=`${c}:${_y(t.fields[c])}`;return o+"}"}(n.mapValue):Ke(61005,{value:n})}function bp(n){switch(ws(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Tf(n);return e?16+bp(e):16;case 5:return 2*n.stringValue.length;case 6:return So(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((o,a)=>o+bp(a),0)}(n.arrayValue);case 10:case 11:return function(r){let o=0;return As(r.fields,(a,c)=>{o+=a.length+bp(c)}),o}(n.mapValue);default:throw Ke(13486,{value:n})}}function ja(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function jy(n){return!!n&&"integerValue"in n}function rd(n){return!!n&&"arrayValue"in n}function Dw(n){return!!n&&"nullValue"in n}function Nw(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function vp(n){return!!n&&"mapValue"in n}function _f(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{})[wx])===null||t===void 0?void 0:t.stringValue)===Sx}function Ou(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return As(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=Ou(r)),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Ou(n.arrayValue.values[t]);return e}return Object.assign({},n)}function wT(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===vT}const ST={mapValue:{fields:{[wx]:{stringValue:Sx},[rc]:{arrayValue:{}}}}};function p6(n){return"nullValue"in n?xp:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?ja(vs.empty(),We.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?_f(n)?ST:{mapValue:{}}:Ke(35942,{value:n})}function f6(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?ja(vs.empty(),We.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?ST:"mapValue"in n?_f(n)?{mapValue:{}}:us:Ke(61959,{value:n})}function Mw(n,e){const t=Ss(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function Lw(n,e){const t=Ss(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yn{constructor(e){this.value=e}static empty(){return new Yn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!vp(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Ou(t)}setAll(e){let t=tn.emptyPath(),r={},o=[];e.forEach((c,d)=>{if(!t.isImmediateParentOf(d)){const h=this.getFieldsMap(t);this.applyChanges(h,r,o),r={},o=[],t=d.popLast()}c?r[d.lastSegment()]=Ou(c):o.push(d.lastSegment())});const a=this.getFieldsMap(t);this.applyChanges(a,r,o)}delete(e){const t=this.field(e.popLast());vp(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Vi(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let o=t.mapValue.fields[e.get(r)];vp(o)&&o.mapValue.fields||(o={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=o),t=o}return t.mapValue.fields}applyChanges(e,t,r){As(t,(o,a)=>e[o]=a);for(const o of r)delete e[o]}clone(){return new Yn(Ou(this.value))}}function kT(n){const e=[];return As(n.fields,(t,r)=>{const o=new tn([t]);if(vp(r)){const a=kT(r.mapValue).fields;if(a.length===0)e.push(o);else for(const c of a)e.push(o.child(c))}else e.push(o)}),new _r(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class en{constructor(e,t,r,o,a,c,d){this.key=e,this.documentType=t,this.version=r,this.readTime=o,this.createTime=a,this.data=c,this.documentState=d}static newInvalidDocument(e){return new en(e,0,st.min(),st.min(),st.min(),Yn.empty(),0)}static newFoundDocument(e,t,r,o){return new en(e,1,t,st.min(),r,o,0)}static newNoDocument(e,t){return new en(e,2,t,st.min(),st.min(),Yn.empty(),0)}static newUnknownDocument(e,t){return new en(e,3,t,st.min(),st.min(),Yn.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(st.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Yn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Yn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=st.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof en&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new en(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ks{constructor(e,t){this.position=e,this.inclusive=t}}function Ow(n,e,t){let r=0;for(let o=0;o<n.position.length;o++){const a=e[o],c=n.position[o];if(a.field.isKeyField()?r=We.comparator(We.fromName(c.referenceValue),t.key):r=Ss(c,t.data.field(a.field)),a.dir==="desc"&&(r*=-1),r!==0)break}return r}function Ww(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Vi(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class id{constructor(e,t="asc"){this.field=e,this.dir=t}}function m6(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TT{}class Ct extends TT{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new g6(e,t,r):t==="array-contains"?new b6(e,r):t==="in"?new ET(e,r):t==="not-in"?new v6(e,r):t==="array-contains-any"?new w6(e,r):new Ct(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new y6(e,r):new x6(e,r)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Ss(t,this.value)):t!==null&&ws(this.value)===ws(t)&&this.matchesComparison(Ss(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Ke(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Vt extends TT{constructor(e,t){super(),this.filters=e,this.op=t,this.Te=null}static create(e,t){return new Vt(e,t)}matches(e){return oc(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.Te!==null||(this.Te=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.Te}getFilters(){return Object.assign([],this.filters)}}function oc(n){return n.op==="and"}function Iy(n){return n.op==="or"}function kx(n){return _T(n)&&oc(n)}function _T(n){for(const e of n.filters)if(e instanceof Vt)return!1;return!0}function Cy(n){if(n instanceof Ct)return n.field.canonicalString()+n.op.toString()+ic(n.value);if(kx(n))return n.filters.map(e=>Cy(e)).join(",");{const e=n.filters.map(t=>Cy(t)).join(",");return`${n.op}(${e})`}}function jT(n,e){return n instanceof Ct?function(r,o){return o instanceof Ct&&r.op===o.op&&r.field.isEqual(o.field)&&Vi(r.value,o.value)}(n,e):n instanceof Vt?function(r,o){return o instanceof Vt&&r.op===o.op&&r.filters.length===o.filters.length?r.filters.reduce((a,c,d)=>a&&jT(c,o.filters[d]),!0):!1}(n,e):void Ke(19439)}function IT(n,e){const t=n.filters.concat(e);return Vt.create(t,n.op)}function CT(n){return n instanceof Ct?function(t){return`${t.field.canonicalString()} ${t.op} ${ic(t.value)}`}(n):n instanceof Vt?function(t){return t.op.toString()+" {"+t.getFilters().map(CT).join(" ,")+"}"}(n):"Filter"}class g6 extends Ct{constructor(e,t,r){super(e,t,r),this.key=We.fromName(r.referenceValue)}matches(e){const t=We.comparator(e.key,this.key);return this.matchesComparison(t)}}class y6 extends Ct{constructor(e,t){super(e,"in",t),this.keys=RT("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class x6 extends Ct{constructor(e,t){super(e,"not-in",t),this.keys=RT("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function RT(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(r=>We.fromName(r.referenceValue))}class b6 extends Ct{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return rd(t)&&nd(t.arrayValue,this.value)}}class ET extends Ct{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&nd(this.value.arrayValue,t)}}class v6 extends Ct{constructor(e,t){super(e,"not-in",t)}matches(e){if(nd(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!nd(this.value.arrayValue,t)}}class w6 extends Ct{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!rd(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>nd(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S6{constructor(e,t=null,r=[],o=[],a=null,c=null,d=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=o,this.limit=a,this.startAt=c,this.endAt=d,this.Ie=null}}function Ry(n,e=null,t=[],r=[],o=null,a=null,c=null){return new S6(n,e,t,r,o,a,c)}function Ia(n){const e=Le(n);if(e.Ie===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>Cy(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>function(a){return a.field.canonicalString()+a.dir}(r)).join(","),pd(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>ic(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>ic(r)).join(",")),e.Ie=t}return e.Ie}function md(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!m6(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!jT(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!Ww(n.startAt,e.startAt)&&Ww(n.endAt,e.endAt)}function Mp(n){return We.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function Lp(n,e){return n.filters.filter(t=>t instanceof Ct&&t.field.isEqual(e))}function Vw(n,e,t){let r=xp,o=!0;for(const a of Lp(n,e)){let c=xp,d=!0;switch(a.op){case"<":case"<=":c=p6(a.value);break;case"==":case"in":case">=":c=a.value;break;case">":c=a.value,d=!1;break;case"!=":case"not-in":c=xp}Mw({value:r,inclusive:o},{value:c,inclusive:d})<0&&(r=c,o=d)}if(t!==null){for(let a=0;a<n.orderBy.length;++a)if(n.orderBy[a].field.isEqual(e)){const c=t.position[a];Mw({value:r,inclusive:o},{value:c,inclusive:t.inclusive})<0&&(r=c,o=t.inclusive);break}}return{value:r,inclusive:o}}function Uw(n,e,t){let r=us,o=!0;for(const a of Lp(n,e)){let c=us,d=!0;switch(a.op){case">=":case">":c=f6(a.value),d=!1;break;case"==":case"in":case"<=":c=a.value;break;case"<":c=a.value,d=!1;break;case"!=":case"not-in":c=us}Lw({value:r,inclusive:o},{value:c,inclusive:d})>0&&(r=c,o=d)}if(t!==null){for(let a=0;a<n.orderBy.length;++a)if(n.orderBy[a].field.isEqual(e)){const c=t.position[a];Lw({value:r,inclusive:o},{value:c,inclusive:t.inclusive})>0&&(r=c,o=t.inclusive);break}}return{value:r,inclusive:o}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _o{constructor(e,t=null,r=[],o=[],a=null,c="F",d=null,h=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=o,this.limit=a,this.limitType=c,this.startAt=d,this.endAt=h,this.Ee=null,this.de=null,this.Ae=null,this.startAt,this.endAt}}function AT(n,e,t,r,o,a,c,d){return new _o(n,e,t,r,o,a,c,d)}function Sc(n){return new _o(n)}function qw(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function Tx(n){return n.collectionGroup!==null}function Ul(n){const e=Le(n);if(e.Ee===null){e.Ee=[];const t=new Set;for(const a of e.explicitOrderBy)e.Ee.push(a),t.add(a.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(c){let d=new Ut(tn.comparator);return c.filters.forEach(h=>{h.getFlattenedFilters().forEach(m=>{m.isInequality()&&(d=d.add(m.field))})}),d})(e).forEach(a=>{t.has(a.canonicalString())||a.isKeyField()||e.Ee.push(new id(a,r))}),t.has(tn.keyField().canonicalString())||e.Ee.push(new id(tn.keyField(),r))}return e.Ee}function or(n){const e=Le(n);return e.de||(e.de=BT(e,Ul(n))),e.de}function PT(n){const e=Le(n);return e.Ae||(e.Ae=BT(e,n.explicitOrderBy)),e.Ae}function BT(n,e){if(n.limitType==="F")return Ry(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(o=>{const a=o.dir==="desc"?"asc":"desc";return new id(o.field,a)});const t=n.endAt?new ks(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new ks(n.startAt.position,n.startAt.inclusive):null;return Ry(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function Ey(n,e){const t=n.filters.concat([e]);return new _o(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function Op(n,e,t){return new _o(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function gd(n,e){return md(or(n),or(e))&&n.limitType===e.limitType}function FT(n){return`${Ia(or(n))}|lt:${n.limitType}`}function Ll(n){return`Query(target=${function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(o=>CT(o)).join(", ")}]`),pd(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(o=>function(c){return`${c.field.canonicalString()} (${c.dir})`}(o)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(o=>ic(o)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(o=>ic(o)).join(",")),`Target(${r})`}(or(n))}; limitType=${n.limitType})`}function yd(n,e){return e.isFoundDocument()&&function(r,o){const a=o.key.path;return r.collectionGroup!==null?o.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(a):We.isDocumentKey(r.path)?r.path.isEqual(a):r.path.isImmediateParentOf(a)}(n,e)&&function(r,o){for(const a of Ul(r))if(!a.field.isKeyField()&&o.data.field(a.field)===null)return!1;return!0}(n,e)&&function(r,o){for(const a of r.filters)if(!a.matches(o))return!1;return!0}(n,e)&&function(r,o){return!(r.startAt&&!function(c,d,h){const m=Ow(c,d,h);return c.inclusive?m<=0:m<0}(r.startAt,Ul(r),o)||r.endAt&&!function(c,d,h){const m=Ow(c,d,h);return c.inclusive?m>=0:m>0}(r.endAt,Ul(r),o))}(n,e)}function zT(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function DT(n){return(e,t)=>{let r=!1;for(const o of Ul(n)){const a=k6(o,e,t);if(a!==0)return a;r=r||o.field.isKeyField()}return 0}}function k6(n,e,t){const r=n.field.isKeyField()?We.comparator(e.key,t.key):function(a,c,d){const h=c.data.field(a),m=d.data.field(a);return h!==null&&m!==null?Ss(h,m):Ke(42886)}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return Ke(19790,{direction:n.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jo{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(const[o,a]of r)if(this.equalsFn(o,e))return a}}has(e){return this.get(e)!==void 0}set(e,t){const r=this.mapKeyFn(e),o=this.inner[r];if(o===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let a=0;a<o.length;a++)if(this.equalsFn(o[a][0],e))return void(o[a]=[e,t]);o.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let o=0;o<r.length;o++)if(this.equalsFn(r[o][0],e))return r.length===1?delete this.inner[t]:r.splice(o,1),this.innerSize--,!0;return!1}forEach(e){As(this.inner,(t,r)=>{for(const[o,a]of r)e(o,a)})}isEmpty(){return fT(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const T6=new Xt(We.comparator);function jr(){return T6}const NT=new Xt(We.comparator);function Au(...n){let e=NT;for(const t of n)e=e.insert(t.key,t);return e}function MT(n){let e=NT;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function Di(){return Wu()}function LT(){return Wu()}function Wu(){return new jo(n=>n.toString(),(n,e)=>n.isEqual(e))}const _6=new Xt(We.comparator),j6=new Ut(We.comparator);function wt(...n){let e=j6;for(const t of n)e=e.add(t);return e}const I6=new Ut(dt);function _x(){return I6}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jx(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Yu(e)?"-0":e}}function OT(n){return{integerValue:""+n}}function WT(n,e){return nT(e)?OT(e):jx(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jf{constructor(){this._=void 0}}function C6(n,e,t){return n instanceof sc?function(o,a){const c={fields:{[yT]:{stringValue:gT},[bT]:{timestampValue:{seconds:o.seconds,nanos:o.nanoseconds}}}};return a&&kf(a)&&(a=Tf(a)),a&&(c.fields[xT]=a),{mapValue:c}}(t,e):n instanceof Ca?UT(n,e):n instanceof Ra?qT(n,e):function(o,a){const c=VT(o,a),d=Hw(c)+Hw(o.Re);return jy(c)&&jy(o.Re)?OT(d):jx(o.serializer,d)}(n,e)}function R6(n,e,t){return n instanceof Ca?UT(n,e):n instanceof Ra?qT(n,e):t}function VT(n,e){return n instanceof ac?function(r){return jy(r)||function(a){return!!a&&"doubleValue"in a}(r)}(e)?e:{integerValue:0}:null}class sc extends jf{}class Ca extends jf{constructor(e){super(),this.elements=e}}function UT(n,e){const t=HT(e);for(const r of n.elements)t.some(o=>Vi(o,r))||t.push(r);return{arrayValue:{values:t}}}class Ra extends jf{constructor(e){super(),this.elements=e}}function qT(n,e){let t=HT(e);for(const r of n.elements)t=t.filter(o=>!Vi(o,r));return{arrayValue:{values:t}}}class ac extends jf{constructor(e,t){super(),this.serializer=e,this.Re=t}}function Hw(n){return cn(n.integerValue||n.doubleValue)}function HT(n){return rd(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xd{constructor(e,t){this.field=e,this.transform=t}}function E6(n,e){return n.field.isEqual(e.field)&&function(r,o){return r instanceof Ca&&o instanceof Ca||r instanceof Ra&&o instanceof Ra?Ql(r.elements,o.elements,Vi):r instanceof ac&&o instanceof ac?Vi(r.Re,o.Re):r instanceof sc&&o instanceof sc}(n.transform,e.transform)}class A6{constructor(e,t){this.version=e,this.transformResults=t}}class un{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new un}static exists(e){return new un(void 0,e)}static updateTime(e){return new un(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function wp(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class If{}function $T(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Tc(n.key,un.none()):new kc(n.key,n.data,un.none());{const t=n.data,r=Yn.empty();let o=new Ut(tn.comparator);for(let a of e.fields)if(!o.has(a)){let c=t.field(a);c===null&&a.length>1&&(a=a.popLast(),c=t.field(a)),c===null?r.delete(a):r.set(a,c),o=o.add(a)}return new Io(n.key,r,new _r(o.toArray()),un.none())}}function P6(n,e,t){n instanceof kc?function(o,a,c){const d=o.value.clone(),h=Gw(o.fieldTransforms,a,c.transformResults);d.setAll(h),a.convertToFoundDocument(c.version,d).setHasCommittedMutations()}(n,e,t):n instanceof Io?function(o,a,c){if(!wp(o.precondition,a))return void a.convertToUnknownDocument(c.version);const d=Gw(o.fieldTransforms,a,c.transformResults),h=a.data;h.setAll(GT(o)),h.setAll(d),a.convertToFoundDocument(c.version,h).setHasCommittedMutations()}(n,e,t):function(o,a,c){a.convertToNoDocument(c.version).setHasCommittedMutations()}(0,e,t)}function Vu(n,e,t,r){return n instanceof kc?function(a,c,d,h){if(!wp(a.precondition,c))return d;const m=a.value.clone(),g=Kw(a.fieldTransforms,h,c);return m.setAll(g),c.convertToFoundDocument(c.version,m).setHasLocalMutations(),null}(n,e,t,r):n instanceof Io?function(a,c,d,h){if(!wp(a.precondition,c))return d;const m=Kw(a.fieldTransforms,h,c),g=c.data;return g.setAll(GT(a)),g.setAll(m),c.convertToFoundDocument(c.version,g).setHasLocalMutations(),d===null?null:d.unionWith(a.fieldMask.fields).unionWith(a.fieldTransforms.map(x=>x.field))}(n,e,t,r):function(a,c,d){return wp(a.precondition,c)?(c.convertToNoDocument(c.version).setHasLocalMutations(),null):d}(n,e,t)}function B6(n,e){let t=null;for(const r of n.fieldTransforms){const o=e.data.field(r.field),a=VT(r.transform,o||null);a!=null&&(t===null&&(t=Yn.empty()),t.set(r.field,a))}return t||null}function $w(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(r,o){return r===void 0&&o===void 0||!(!r||!o)&&Ql(r,o,(a,c)=>E6(a,c))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class kc extends If{constructor(e,t,r,o=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=o,this.type=0}getFieldMask(){return null}}class Io extends If{constructor(e,t,r,o,a=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=o,this.fieldTransforms=a,this.type=1}getFieldMask(){return this.fieldMask}}function GT(n){const e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}}),e}function Gw(n,e,t){const r=new Map;tt(n.length===t.length,32656,{Ve:t.length,me:n.length});for(let o=0;o<t.length;o++){const a=n[o],c=a.transform,d=e.data.field(a.field);r.set(a.field,R6(c,d,t[o]))}return r}function Kw(n,e,t){const r=new Map;for(const o of n){const a=o.transform,c=t.data.field(o.field);r.set(o.field,C6(a,c,e))}return r}class Tc extends If{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Ix extends If{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cx{constructor(e,t,r,o){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=o}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let o=0;o<this.mutations.length;o++){const a=this.mutations[o];a.key.isEqual(e.key)&&P6(a,e,r[o])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=Vu(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=Vu(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=LT();return this.mutations.forEach(o=>{const a=e.get(o.key),c=a.overlayedDocument;let d=this.applyToLocalView(c,a.mutatedFields);d=t.has(o.key)?null:d;const h=$T(c,d);h!==null&&r.set(o.key,h),c.isValidDocument()||c.convertToNoDocument(st.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),wt())}isEqual(e){return this.batchId===e.batchId&&Ql(this.mutations,e.mutations,(t,r)=>$w(t,r))&&Ql(this.baseMutations,e.baseMutations,(t,r)=>$w(t,r))}}class Rx{constructor(e,t,r,o){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=o}static from(e,t,r){tt(e.mutations.length===r.length,58842,{fe:e.mutations.length,ge:r.length});let o=function(){return _6}();const a=e.mutations;for(let c=0;c<a.length;c++)o=o.insert(a[c].key,r[c].version);return new Rx(e,t,r,o)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ex{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KT{constructor(e,t,r){this.alias=e,this.aggregateType=t,this.fieldPath=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F6{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Tn,Pt;function QT(n){switch(n){case ye.OK:return Ke(64938);case ye.CANCELLED:case ye.UNKNOWN:case ye.DEADLINE_EXCEEDED:case ye.RESOURCE_EXHAUSTED:case ye.INTERNAL:case ye.UNAVAILABLE:case ye.UNAUTHENTICATED:return!1;case ye.INVALID_ARGUMENT:case ye.NOT_FOUND:case ye.ALREADY_EXISTS:case ye.PERMISSION_DENIED:case ye.FAILED_PRECONDITION:case ye.ABORTED:case ye.OUT_OF_RANGE:case ye.UNIMPLEMENTED:case ye.DATA_LOSS:return!0;default:return Ke(15467,{code:n})}}function YT(n){if(n===void 0)return bn("GRPC error has no .code"),ye.UNKNOWN;switch(n){case Tn.OK:return ye.OK;case Tn.CANCELLED:return ye.CANCELLED;case Tn.UNKNOWN:return ye.UNKNOWN;case Tn.DEADLINE_EXCEEDED:return ye.DEADLINE_EXCEEDED;case Tn.RESOURCE_EXHAUSTED:return ye.RESOURCE_EXHAUSTED;case Tn.INTERNAL:return ye.INTERNAL;case Tn.UNAVAILABLE:return ye.UNAVAILABLE;case Tn.UNAUTHENTICATED:return ye.UNAUTHENTICATED;case Tn.INVALID_ARGUMENT:return ye.INVALID_ARGUMENT;case Tn.NOT_FOUND:return ye.NOT_FOUND;case Tn.ALREADY_EXISTS:return ye.ALREADY_EXISTS;case Tn.PERMISSION_DENIED:return ye.PERMISSION_DENIED;case Tn.FAILED_PRECONDITION:return ye.FAILED_PRECONDITION;case Tn.ABORTED:return ye.ABORTED;case Tn.OUT_OF_RANGE:return ye.OUT_OF_RANGE;case Tn.UNIMPLEMENTED:return ye.UNIMPLEMENTED;case Tn.DATA_LOSS:return ye.DATA_LOSS;default:return Ke(39323,{code:n})}}(Pt=Tn||(Tn={}))[Pt.OK=0]="OK",Pt[Pt.CANCELLED=1]="CANCELLED",Pt[Pt.UNKNOWN=2]="UNKNOWN",Pt[Pt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Pt[Pt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Pt[Pt.NOT_FOUND=5]="NOT_FOUND",Pt[Pt.ALREADY_EXISTS=6]="ALREADY_EXISTS",Pt[Pt.PERMISSION_DENIED=7]="PERMISSION_DENIED",Pt[Pt.UNAUTHENTICATED=16]="UNAUTHENTICATED",Pt[Pt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Pt[Pt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Pt[Pt.ABORTED=10]="ABORTED",Pt[Pt.OUT_OF_RANGE=11]="OUT_OF_RANGE",Pt[Pt.UNIMPLEMENTED=12]="UNIMPLEMENTED",Pt[Pt.INTERNAL=13]="INTERNAL",Pt[Pt.UNAVAILABLE=14]="UNAVAILABLE",Pt[Pt.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Wp=null;/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z6=new ms([4294967295,4294967295],0);function Qw(n){const e=px().encode(n),t=new Wk;return t.update(e),new Uint8Array(t.digest())}function Yw(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),o=e.getUint32(8,!0),a=e.getUint32(12,!0);return[new ms([t,r],0),new ms([o,a],0)]}class Ax{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new Pu(`Invalid padding: ${t}`);if(r<0)throw new Pu(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Pu(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new Pu(`Invalid padding when bitmap length is 0: ${t}`);this.pe=8*e.length-t,this.ye=ms.fromNumber(this.pe)}we(e,t,r){let o=e.add(t.multiply(ms.fromNumber(r)));return o.compare(z6)===1&&(o=new ms([o.getBits(0),o.getBits(1)],0)),o.modulo(this.ye).toNumber()}be(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.pe===0)return!1;const t=Qw(e),[r,o]=Yw(t);for(let a=0;a<this.hashCount;a++){const c=this.we(r,o,a);if(!this.be(c))return!1}return!0}static create(e,t,r){const o=e%8==0?0:8-e%8,a=new Uint8Array(Math.ceil(e/8)),c=new Ax(a,o,t);return r.forEach(d=>c.insert(d)),c}insert(e){if(this.pe===0)return;const t=Qw(e),[r,o]=Yw(t);for(let a=0;a<this.hashCount;a++){const c=this.we(r,o,a);this.Se(c)}}Se(e){const t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}}class Pu extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bd{constructor(e,t,r,o,a){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=o,this.resolvedLimboDocuments=a}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const o=new Map;return o.set(e,vd.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new bd(st.min(),o,new Xt(dt),jr(),wt())}}class vd{constructor(e,t,r,o,a){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=o,this.removedDocuments=a}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new vd(r,t,wt(),wt(),wt())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sp{constructor(e,t,r,o){this.De=e,this.removedTargetIds=t,this.key=r,this.ve=o}}class XT{constructor(e,t){this.targetId=e,this.Ce=t}}class JT{constructor(e,t,r=fn.EMPTY_BYTE_STRING,o=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=o}}class Xw{constructor(){this.Fe=0,this.Me=Jw(),this.xe=fn.EMPTY_BYTE_STRING,this.Oe=!1,this.Ne=!0}get current(){return this.Oe}get resumeToken(){return this.xe}get Be(){return this.Fe!==0}get Le(){return this.Ne}ke(e){e.approximateByteSize()>0&&(this.Ne=!0,this.xe=e)}qe(){let e=wt(),t=wt(),r=wt();return this.Me.forEach((o,a)=>{switch(a){case 0:e=e.add(o);break;case 2:t=t.add(o);break;case 1:r=r.add(o);break;default:Ke(38017,{changeType:a})}}),new vd(this.xe,this.Oe,e,t,r)}Qe(){this.Ne=!1,this.Me=Jw()}$e(e,t){this.Ne=!0,this.Me=this.Me.insert(e,t)}Ue(e){this.Ne=!0,this.Me=this.Me.remove(e)}Ke(){this.Fe+=1}We(){this.Fe-=1,tt(this.Fe>=0,3241,{Fe:this.Fe})}Ge(){this.Ne=!0,this.Oe=!0}}class D6{constructor(e){this.ze=e,this.je=new Map,this.He=jr(),this.Je=rp(),this.Ye=rp(),this.Ze=new Xt(dt)}Xe(e){for(const t of e.De)e.ve&&e.ve.isFoundDocument()?this.et(t,e.ve):this.tt(t,e.key,e.ve);for(const t of e.removedTargetIds)this.tt(t,e.key,e.ve)}nt(e){this.forEachTarget(e,t=>{const r=this.rt(t);switch(e.state){case 0:this.it(t)&&r.ke(e.resumeToken);break;case 1:r.We(),r.Be||r.Qe(),r.ke(e.resumeToken);break;case 2:r.We(),r.Be||this.removeTarget(t);break;case 3:this.it(t)&&(r.Ge(),r.ke(e.resumeToken));break;case 4:this.it(t)&&(this.st(t),r.ke(e.resumeToken));break;default:Ke(56790,{state:e.state})}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.je.forEach((r,o)=>{this.it(o)&&t(o)})}ot(e){const t=e.targetId,r=e.Ce.count,o=this._t(t);if(o){const a=o.target;if(Mp(a))if(r===0){const c=new We(a.path);this.tt(t,c,en.newNoDocument(c,st.min()))}else tt(r===1,20013,{expectedCount:r});else{const c=this.ut(t);if(c!==r){const d=this.ct(e),h=d?this.lt(d,e,c):1;if(h!==0){this.st(t);const m=h===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(t,m)}Wp==null||Wp.ht(function(g,x,S,C,_){var I,T,F,P,B,q;const te={localCacheCount:g,existenceFilterCount:x.count,databaseId:S.database,projectId:S.projectId},W=x.unchangedNames;return W&&(te.bloomFilter={applied:_===0,hashCount:(I=W==null?void 0:W.hashCount)!==null&&I!==void 0?I:0,bitmapLength:(P=(F=(T=W==null?void 0:W.bits)===null||T===void 0?void 0:T.bitmap)===null||F===void 0?void 0:F.length)!==null&&P!==void 0?P:0,padding:(q=(B=W==null?void 0:W.bits)===null||B===void 0?void 0:B.padding)!==null&&q!==void 0?q:0,mightContain:L=>{var R;return(R=C==null?void 0:C.mightContain(L))!==null&&R!==void 0&&R}}),te}(c,e.Ce,this.ze.Pt(),d,h))}}}}ct(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:r="",padding:o=0},hashCount:a=0}=t;let c,d;try{c=So(r).toUint8Array()}catch(h){if(h instanceof mT)return Or("Decoding the base64 bloom filter in existence filter failed ("+h.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw h}try{d=new Ax(c,o,a)}catch(h){return Or(h instanceof Pu?"BloomFilter error: ":"Applying bloom filter failed: ",h),null}return d.pe===0?null:d}lt(e,t,r){return t.Ce.count===r-this.Tt(e,t.targetId)?0:2}Tt(e,t){const r=this.ze.getRemoteKeysForTarget(t);let o=0;return r.forEach(a=>{const c=this.ze.Pt(),d=`projects/${c.projectId}/databases/${c.database}/documents/${a.path.canonicalString()}`;e.mightContain(d)||(this.tt(t,a,null),o++)}),o}It(e){const t=new Map;this.je.forEach((a,c)=>{const d=this._t(c);if(d){if(a.current&&Mp(d.target)){const h=new We(d.target.path);this.Et(h).has(c)||this.dt(c,h)||this.tt(c,h,en.newNoDocument(h,e))}a.Le&&(t.set(c,a.qe()),a.Qe())}});let r=wt();this.Ye.forEach((a,c)=>{let d=!0;c.forEachWhile(h=>{const m=this._t(h);return!m||m.purpose==="TargetPurposeLimboResolution"||(d=!1,!1)}),d&&(r=r.add(a))}),this.He.forEach((a,c)=>c.setReadTime(e));const o=new bd(e,t,this.Ze,this.He,r);return this.He=jr(),this.Je=rp(),this.Ye=rp(),this.Ze=new Xt(dt),o}et(e,t){if(!this.it(e))return;const r=this.dt(e,t.key)?2:0;this.rt(e).$e(t.key,r),this.He=this.He.insert(t.key,t),this.Je=this.Je.insert(t.key,this.Et(t.key).add(e)),this.Ye=this.Ye.insert(t.key,this.At(t.key).add(e))}tt(e,t,r){if(!this.it(e))return;const o=this.rt(e);this.dt(e,t)?o.$e(t,1):o.Ue(t),this.Ye=this.Ye.insert(t,this.At(t).delete(e)),this.Ye=this.Ye.insert(t,this.At(t).add(e)),r&&(this.He=this.He.insert(t,r))}removeTarget(e){this.je.delete(e)}ut(e){const t=this.rt(e).qe();return this.ze.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ke(e){this.rt(e).Ke()}rt(e){let t=this.je.get(e);return t||(t=new Xw,this.je.set(e,t)),t}At(e){let t=this.Ye.get(e);return t||(t=new Ut(dt),this.Ye=this.Ye.insert(e,t)),t}Et(e){let t=this.Je.get(e);return t||(t=new Ut(dt),this.Je=this.Je.insert(e,t)),t}it(e){const t=this._t(e)!==null;return t||Ie("WatchChangeAggregator","Detected inactive target",e),t}_t(e){const t=this.je.get(e);return t&&t.Be?null:this.ze.Rt(e)}st(e){this.je.set(e,new Xw),this.ze.getRemoteKeysForTarget(e).forEach(t=>{this.tt(e,t,null)})}dt(e,t){return this.ze.getRemoteKeysForTarget(e).has(t)}}function rp(){return new Xt(We.comparator)}function Jw(){return new Xt(We.comparator)}const N6={asc:"ASCENDING",desc:"DESCENDING"},M6={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},L6={and:"AND",or:"OR"};class O6{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Ay(n,e){return n.useProto3Json||pd(e)?e:{value:e}}function lc(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function ZT(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function W6(n,e){return lc(n,e.toTimestamp())}function vn(n){return tt(!!n,49232),st.fromTimestamp(function(t){const r=wo(t);return new Gt(r.seconds,r.nanos)}(n))}function Px(n,e){return Py(n,e).canonicalString()}function Py(n,e){const t=function(o){return new It(["projects",o.projectId,"databases",o.database])}(n).child("documents");return e===void 0?t:t.child(e)}function e_(n){const e=It.fromString(n);return tt(u_(e),10190,{key:e.toString()}),e}function od(n,e){return Px(n.databaseId,e.path)}function Oi(n,e){const t=e_(e);if(t.get(1)!==n.databaseId.projectId)throw new je(ye.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new je(ye.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new We(r_(t))}function t_(n,e){return Px(n.databaseId,e)}function n_(n){const e=e_(n);return e.length===4?It.emptyPath():r_(e)}function By(n){return new It(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function r_(n){return tt(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function Zw(n,e,t){return{name:od(n,e),fields:t.value.mapValue.fields}}function i_(n,e,t){const r=Oi(n,e.name),o=vn(e.updateTime),a=e.createTime?vn(e.createTime):st.min(),c=new Yn({mapValue:{fields:e.fields}}),d=en.newFoundDocument(r,o,a,c);return t&&d.setHasCommittedMutations(),t?d.setHasCommittedMutations():d}function V6(n,e){return"found"in e?function(r,o){tt(!!o.found,43571),o.found.name,o.found.updateTime;const a=Oi(r,o.found.name),c=vn(o.found.updateTime),d=o.found.createTime?vn(o.found.createTime):st.min(),h=new Yn({mapValue:{fields:o.found.fields}});return en.newFoundDocument(a,c,d,h)}(n,e):"missing"in e?function(r,o){tt(!!o.missing,3894),tt(!!o.readTime,22933);const a=Oi(r,o.missing),c=vn(o.readTime);return en.newNoDocument(a,c)}(n,e):Ke(7234,{result:e})}function U6(n,e){let t;if("targetChange"in e){e.targetChange;const r=function(m){return m==="NO_CHANGE"?0:m==="ADD"?1:m==="REMOVE"?2:m==="CURRENT"?3:m==="RESET"?4:Ke(39313,{state:m})}(e.targetChange.targetChangeType||"NO_CHANGE"),o=e.targetChange.targetIds||[],a=function(m,g){return m.useProto3Json?(tt(g===void 0||typeof g=="string",58123),fn.fromBase64String(g||"")):(tt(g===void 0||g instanceof Buffer||g instanceof Uint8Array,16193),fn.fromUint8Array(g||new Uint8Array))}(n,e.targetChange.resumeToken),c=e.targetChange.cause,d=c&&function(m){const g=m.code===void 0?ye.UNKNOWN:YT(m.code);return new je(g,m.message||"")}(c);t=new JT(r,o,a,d||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const o=Oi(n,r.document.name),a=vn(r.document.updateTime),c=r.document.createTime?vn(r.document.createTime):st.min(),d=new Yn({mapValue:{fields:r.document.fields}}),h=en.newFoundDocument(o,a,c,d),m=r.targetIds||[],g=r.removedTargetIds||[];t=new Sp(m,g,h.key,h)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const o=Oi(n,r.document),a=r.readTime?vn(r.readTime):st.min(),c=en.newNoDocument(o,a),d=r.removedTargetIds||[];t=new Sp([],d,c.key,c)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const o=Oi(n,r.document),a=r.removedTargetIds||[];t=new Sp([],a,o,null)}else{if(!("filter"in e))return Ke(11601,{Vt:e});{e.filter;const r=e.filter;r.targetId;const{count:o=0,unchangedNames:a}=r,c=new F6(o,a),d=r.targetId;t=new XT(d,c)}}return t}function sd(n,e){let t;if(e instanceof kc)t={update:Zw(n,e.key,e.value)};else if(e instanceof Tc)t={delete:od(n,e.key)};else if(e instanceof Io)t={update:Zw(n,e.key,e.data),updateMask:Q6(e.fieldMask)};else{if(!(e instanceof Ix))return Ke(16599,{ft:e.type});t={verify:od(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(a,c){const d=c.transform;if(d instanceof sc)return{fieldPath:c.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(d instanceof Ca)return{fieldPath:c.field.canonicalString(),appendMissingElements:{values:d.elements}};if(d instanceof Ra)return{fieldPath:c.field.canonicalString(),removeAllFromArray:{values:d.elements}};if(d instanceof ac)return{fieldPath:c.field.canonicalString(),increment:d.Re};throw Ke(20930,{transform:c.transform})}(0,r))),e.precondition.isNone||(t.currentDocument=function(o,a){return a.updateTime!==void 0?{updateTime:W6(o,a.updateTime)}:a.exists!==void 0?{exists:a.exists}:Ke(27497)}(n,e.precondition)),t}function Fy(n,e){const t=e.currentDocument?function(a){return a.updateTime!==void 0?un.updateTime(vn(a.updateTime)):a.exists!==void 0?un.exists(a.exists):un.none()}(e.currentDocument):un.none(),r=e.updateTransforms?e.updateTransforms.map(o=>function(c,d){let h=null;if("setToServerValue"in d)tt(d.setToServerValue==="REQUEST_TIME",16630,{proto:d}),h=new sc;else if("appendMissingElements"in d){const g=d.appendMissingElements.values||[];h=new Ca(g)}else if("removeAllFromArray"in d){const g=d.removeAllFromArray.values||[];h=new Ra(g)}else"increment"in d?h=new ac(c,d.increment):Ke(16584,{proto:d});const m=tn.fromServerFormat(d.fieldPath);return new xd(m,h)}(n,o)):[];if(e.update){e.update.name;const o=Oi(n,e.update.name),a=new Yn({mapValue:{fields:e.update.fields}});if(e.updateMask){const c=function(h){const m=h.fieldPaths||[];return new _r(m.map(g=>tn.fromServerFormat(g)))}(e.updateMask);return new Io(o,a,c,t,r)}return new kc(o,a,t,r)}if(e.delete){const o=Oi(n,e.delete);return new Tc(o,t)}if(e.verify){const o=Oi(n,e.verify);return new Ix(o,t)}return Ke(1463,{proto:e})}function q6(n,e){return n&&n.length>0?(tt(e!==void 0,14353),n.map(t=>function(o,a){let c=o.updateTime?vn(o.updateTime):vn(a);return c.isEqual(st.min())&&(c=vn(a)),new A6(c,o.transformResults||[])}(t,e))):[]}function o_(n,e){return{documents:[t_(n,e.path)]}}function Cf(n,e){const t={structuredQuery:{}},r=e.path;let o;e.collectionGroup!==null?(o=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(o=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=t_(n,o);const a=function(m){if(m.length!==0)return c_(Vt.create(m,"and"))}(e.filters);a&&(t.structuredQuery.where=a);const c=function(m){if(m.length!==0)return m.map(g=>function(S){return{field:ss(S.field),direction:$6(S.dir)}}(g))}(e.orderBy);c&&(t.structuredQuery.orderBy=c);const d=Ay(n,e.limit);return d!==null&&(t.structuredQuery.limit=d),e.startAt&&(t.structuredQuery.startAt=function(m){return{before:m.inclusive,values:m.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(m){return{before:!m.inclusive,values:m.position}}(e.endAt)),{gt:t,parent:o}}function s_(n,e,t,r){const{gt:o,parent:a}=Cf(n,e),c={},d=[];let h=0;return t.forEach(m=>{const g=r?m.alias:"aggregate_"+h++;c[g]=m.alias,m.aggregateType==="count"?d.push({alias:g,count:{}}):m.aggregateType==="avg"?d.push({alias:g,avg:{field:ss(m.fieldPath)}}):m.aggregateType==="sum"&&d.push({alias:g,sum:{field:ss(m.fieldPath)}})}),{request:{structuredAggregationQuery:{aggregations:d,structuredQuery:o.structuredQuery},parent:o.parent},yt:c,parent:a}}function a_(n){let e=n_(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let o=null;if(r>0){tt(r===1,65062);const g=t.from[0];g.allDescendants?o=g.collectionId:e=e.child(g.collectionId)}let a=[];t.where&&(a=function(x){const S=l_(x);return S instanceof Vt&&kx(S)?S.getFilters():[S]}(t.where));let c=[];t.orderBy&&(c=function(x){return x.map(S=>function(_){return new id(Ol(_.field),function(T){switch(T){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(_.direction))}(S))}(t.orderBy));let d=null;t.limit&&(d=function(x){let S;return S=typeof x=="object"?x.value:x,pd(S)?null:S}(t.limit));let h=null;t.startAt&&(h=function(x){const S=!!x.before,C=x.values||[];return new ks(C,S)}(t.startAt));let m=null;return t.endAt&&(m=function(x){const S=!x.before,C=x.values||[];return new ks(C,S)}(t.endAt)),AT(e,o,c,a,d,"F",h,m)}function H6(n,e){const t=function(o){switch(o){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Ke(28987,{purpose:o})}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function l_(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":const r=Ol(t.unaryFilter.field);return Ct.create(r,"==",{doubleValue:NaN});case"IS_NULL":const o=Ol(t.unaryFilter.field);return Ct.create(o,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const a=Ol(t.unaryFilter.field);return Ct.create(a,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const c=Ol(t.unaryFilter.field);return Ct.create(c,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Ke(61313);default:return Ke(60726)}}(n):n.fieldFilter!==void 0?function(t){return Ct.create(Ol(t.fieldFilter.field),function(o){switch(o){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Ke(58110);default:return Ke(50506)}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return Vt.create(t.compositeFilter.filters.map(r=>l_(r)),function(o){switch(o){case"AND":return"and";case"OR":return"or";default:return Ke(1026)}}(t.compositeFilter.op))}(n):Ke(30097,{filter:n})}function $6(n){return N6[n]}function G6(n){return M6[n]}function K6(n){return L6[n]}function ss(n){return{fieldPath:n.canonicalString()}}function Ol(n){return tn.fromServerFormat(n.fieldPath)}function c_(n){return n instanceof Ct?function(t){if(t.op==="=="){if(Nw(t.value))return{unaryFilter:{field:ss(t.field),op:"IS_NAN"}};if(Dw(t.value))return{unaryFilter:{field:ss(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(Nw(t.value))return{unaryFilter:{field:ss(t.field),op:"IS_NOT_NAN"}};if(Dw(t.value))return{unaryFilter:{field:ss(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ss(t.field),op:G6(t.op),value:t.value}}}(n):n instanceof Vt?function(t){const r=t.getFilters().map(o=>c_(o));return r.length===1?r[0]:{compositeFilter:{op:K6(t.op),filters:r}}}(n):Ke(54877,{filter:n})}function Q6(n){const e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function u_(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mo{constructor(e,t,r,o,a=st.min(),c=st.min(),d=fn.EMPTY_BYTE_STRING,h=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=o,this.snapshotVersion=a,this.lastLimboFreeSnapshotVersion=c,this.resumeToken=d,this.expectedCount=h}withSequenceNumber(e){return new mo(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new mo(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new mo(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new mo(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d_{constructor(e){this.wt=e}}function Y6(n,e){let t;if(e.document)t=i_(n.wt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=We.fromSegments(e.noDocument.path),o=Aa(e.noDocument.readTime);t=en.newNoDocument(r,o),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return Ke(56709);{const r=We.fromSegments(e.unknownDocument.path),o=Aa(e.unknownDocument.version);t=en.newUnknownDocument(r,o)}}return e.readTime&&t.setReadTime(function(o){const a=new Gt(o[0],o[1]);return st.fromTimestamp(a)}(e.readTime)),t}function e1(n,e){const t=e.key,r={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:Vp(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(a,c){return{name:od(a,c.key),fields:c.data.value.mapValue.fields,updateTime:lc(a,c.version.toTimestamp()),createTime:lc(a,c.createTime.toTimestamp())}}(n.wt,e);else if(e.isNoDocument())r.noDocument={path:t.path.toArray(),readTime:Ea(e.version)};else{if(!e.isUnknownDocument())return Ke(57904,{document:e});r.unknownDocument={path:t.path.toArray(),version:Ea(e.version)}}return r}function Vp(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function Ea(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Aa(n){const e=new Gt(n.seconds,n.nanoseconds);return st.fromTimestamp(e)}function ha(n,e){const t=(e.baseMutations||[]).map(a=>Fy(n.wt,a));for(let a=0;a<e.mutations.length-1;++a){const c=e.mutations[a];if(a+1<e.mutations.length&&e.mutations[a+1].transform!==void 0){const d=e.mutations[a+1];c.updateTransforms=d.transform.fieldTransforms,e.mutations.splice(a+1,1),++a}}const r=e.mutations.map(a=>Fy(n.wt,a)),o=Gt.fromMillis(e.localWriteTimeMs);return new Cx(e.batchId,o,t,r)}function Bu(n){const e=Aa(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?Aa(n.lastLimboFreeSnapshotVersion):st.min();let r;return r=function(a){return a.documents!==void 0}(n.query)?function(a){const c=a.documents.length;return tt(c===1,1966,{count:c}),or(Sc(n_(a.documents[0])))}(n.query):function(a){return or(a_(a))}(n.query),new mo(r,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,fn.fromBase64String(n.resumeToken))}function h_(n,e){const t=Ea(e.snapshotVersion),r=Ea(e.lastLimboFreeSnapshotVersion);let o;o=Mp(e.target)?o_(n.wt,e.target):Cf(n.wt,e.target).gt;const a=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Ia(e.target),readTime:t,resumeToken:a,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:o}}function Bx(n){const e=a_({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Op(e,e.limit,"L"):e}function Lg(n,e){return new Ex(e.largestBatchId,Fy(n.wt,e.overlayMutation))}function t1(n,e){const t=e.path.lastSegment();return[n,ir(e.path.popLast()),t]}function n1(n,e,t,r){return{indexId:n,uid:e,sequenceNumber:t,readTime:Ea(r.readTime),documentKey:ir(r.documentKey.path),largestBatchId:r.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X6{getBundleMetadata(e,t){return r1(e).get(t).next(r=>{if(r)return function(a){return{id:a.bundleId,createTime:Aa(a.createTime),version:a.version}}(r)})}saveBundleMetadata(e,t){return r1(e).put(function(o){return{bundleId:o.id,createTime:Ea(vn(o.createTime)),version:o.version}}(t))}getNamedQuery(e,t){return i1(e).get(t).next(r=>{if(r)return function(a){return{name:a.name,query:Bx(a.bundledQuery),readTime:Aa(a.readTime)}}(r)})}saveNamedQuery(e,t){return i1(e).put(function(o){return{name:o.name,readTime:Ea(vn(o.readTime)),bundledQuery:o.bundledQuery}}(t))}}function r1(n){return Fn(n,vf)}function i1(n){return Fn(n,wf)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rf{constructor(e,t){this.serializer=e,this.userId=t}static bt(e,t){const r=t.uid||"";return new Rf(e,r)}getOverlay(e,t){return bu(e).get(t1(this.userId,t)).next(r=>r?Lg(this.serializer,r):null)}getOverlays(e,t){const r=Di();return se.forEach(t,o=>this.getOverlay(e,o).next(a=>{a!==null&&r.set(o,a)})).next(()=>r)}saveOverlays(e,t,r){const o=[];return r.forEach((a,c)=>{const d=new Ex(t,c);o.push(this.St(e,d))}),se.waitFor(o)}removeOverlaysForBatchId(e,t,r){const o=new Set;t.forEach(c=>o.add(ir(c.getCollectionPath())));const a=[];return o.forEach(c=>{const d=IDBKeyRange.bound([this.userId,c,r],[this.userId,c,r+1],!1,!0);a.push(bu(e).X(ky,d))}),se.waitFor(a)}getOverlaysForCollection(e,t,r){const o=Di(),a=ir(t),c=IDBKeyRange.bound([this.userId,a,r],[this.userId,a,Number.POSITIVE_INFINITY],!0);return bu(e).J(ky,c).next(d=>{for(const h of d){const m=Lg(this.serializer,h);o.set(m.getKey(),m)}return o})}getOverlaysForCollectionGroup(e,t,r,o){const a=Di();let c;const d=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,Number.POSITIVE_INFINITY],!0);return bu(e).te({index:lT,range:d},(h,m,g)=>{const x=Lg(this.serializer,m);a.size()<o||x.largestBatchId===c?(a.set(x.getKey(),x),c=x.largestBatchId):g.done()}).next(()=>a)}St(e,t){return bu(e).put(function(o,a,c){const[d,h,m]=t1(a,c.mutation.key);return{userId:a,collectionPath:h,documentId:m,collectionGroup:c.mutation.key.getCollectionGroup(),largestBatchId:c.largestBatchId,overlayMutation:sd(o.wt,c.mutation)}}(this.serializer,this.userId,t))}}function bu(n){return Fn(n,Sf)}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J6{Dt(e){return Fn(e,bx)}getSessionToken(e){return this.Dt(e).get("sessionToken").next(t=>{const r=t==null?void 0:t.value;return r?fn.fromUint8Array(r):fn.EMPTY_BYTE_STRING})}setSessionToken(e,t){return this.Dt(e).put({name:"sessionToken",value:t.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pa{constructor(){}vt(e,t){this.Ct(e,t),t.Ft()}Ct(e,t){if("nullValue"in e)this.Mt(t,5);else if("booleanValue"in e)this.Mt(t,10),t.xt(e.booleanValue?1:0);else if("integerValue"in e)this.Mt(t,15),t.xt(cn(e.integerValue));else if("doubleValue"in e){const r=cn(e.doubleValue);isNaN(r)?this.Mt(t,13):(this.Mt(t,15),Yu(r)?t.xt(0):t.xt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Mt(t,20),typeof r=="string"&&(r=wo(r)),t.Ot(`${r.seconds||""}`),t.xt(r.nanos||0)}else if("stringValue"in e)this.Nt(e.stringValue,t),this.Bt(t);else if("bytesValue"in e)this.Mt(t,30),t.Lt(So(e.bytesValue)),this.Bt(t);else if("referenceValue"in e)this.kt(e.referenceValue,t);else if("geoPointValue"in e){const r=e.geoPointValue;this.Mt(t,45),t.xt(r.latitude||0),t.xt(r.longitude||0)}else"mapValue"in e?wT(e)?this.Mt(t,Number.MAX_SAFE_INTEGER):_f(e)?this.qt(e.mapValue,t):(this.Qt(e.mapValue,t),this.Bt(t)):"arrayValue"in e?(this.$t(e.arrayValue,t),this.Bt(t)):Ke(19022,{Ut:e})}Nt(e,t){this.Mt(t,25),this.Kt(e,t)}Kt(e,t){t.Ot(e)}Qt(e,t){const r=e.fields||{};this.Mt(t,55);for(const o of Object.keys(r))this.Nt(o,t),this.Ct(r[o],t)}qt(e,t){var r,o;const a=e.fields||{};this.Mt(t,53);const c=rc,d=((o=(r=a[c].arrayValue)===null||r===void 0?void 0:r.values)===null||o===void 0?void 0:o.length)||0;this.Mt(t,15),t.xt(cn(d)),this.Nt(c,t),this.Ct(a[c],t)}$t(e,t){const r=e.values||[];this.Mt(t,50);for(const o of r)this.Ct(o,t)}kt(e,t){this.Mt(t,37),We.fromName(e).path.forEach(r=>{this.Mt(t,60),this.Kt(r,t)})}Mt(e,t){e.xt(t)}Bt(e){e.xt(2)}}pa.Wt=new pa;/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law | agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES | CONDITIONS OF ANY KIND, either express | implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rl=255;function Z6(n){if(n===0)return 8;let e=0;return n>>4||(e+=4,n<<=4),n>>6||(e+=2,n<<=2),n>>7||(e+=1),e}function o1(n){const e=64-function(r){let o=0;for(let a=0;a<8;++a){const c=Z6(255&r[a]);if(o+=c,c!==8)break}return o}(n);return Math.ceil(e/8)}class e5{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Gt(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.zt(r.value),r=t.next();this.jt()}Ht(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Jt(r.value),r=t.next();this.Yt()}Zt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.zt(r);else if(r<2048)this.zt(960|r>>>6),this.zt(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.zt(480|r>>>12),this.zt(128|63&r>>>6),this.zt(128|63&r);else{const o=t.codePointAt(0);this.zt(240|o>>>18),this.zt(128|63&o>>>12),this.zt(128|63&o>>>6),this.zt(128|63&o)}}this.jt()}Xt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Jt(r);else if(r<2048)this.Jt(960|r>>>6),this.Jt(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Jt(480|r>>>12),this.Jt(128|63&r>>>6),this.Jt(128|63&r);else{const o=t.codePointAt(0);this.Jt(240|o>>>18),this.Jt(128|63&o>>>12),this.Jt(128|63&o>>>6),this.Jt(128|63&o)}}this.Yt()}en(e){const t=this.tn(e),r=o1(t);this.nn(1+r),this.buffer[this.position++]=255&r;for(let o=t.length-r;o<t.length;++o)this.buffer[this.position++]=255&t[o]}rn(e){const t=this.tn(e),r=o1(t);this.nn(1+r),this.buffer[this.position++]=~(255&r);for(let o=t.length-r;o<t.length;++o)this.buffer[this.position++]=~(255&t[o])}sn(){this._n(Rl),this._n(255)}an(){this.un(Rl),this.un(255)}reset(){this.position=0}seed(e){this.nn(e.length),this.buffer.set(e,this.position),this.position+=e.length}cn(){return this.buffer.slice(0,this.position)}tn(e){const t=function(a){const c=new DataView(new ArrayBuffer(8));return c.setFloat64(0,a,!1),new Uint8Array(c.buffer)}(e),r=!!(128&t[0]);t[0]^=r?255:128;for(let o=1;o<t.length;++o)t[o]^=r?255:0;return t}zt(e){const t=255&e;t===0?(this._n(0),this._n(255)):t===Rl?(this._n(Rl),this._n(0)):this._n(t)}Jt(e){const t=255&e;t===0?(this.un(0),this.un(255)):t===Rl?(this.un(Rl),this.un(0)):this.un(e)}jt(){this._n(0),this._n(1)}Yt(){this.un(0),this.un(1)}_n(e){this.nn(1),this.buffer[this.position++]=e}un(e){this.nn(1),this.buffer[this.position++]=~e}nn(e){const t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);const o=new Uint8Array(r);o.set(this.buffer),this.buffer=o}}class t5{constructor(e){this.ln=e}Lt(e){this.ln.Gt(e)}Ot(e){this.ln.Zt(e)}xt(e){this.ln.en(e)}Ft(){this.ln.sn()}}class n5{constructor(e){this.ln=e}Lt(e){this.ln.Ht(e)}Ot(e){this.ln.Xt(e)}xt(e){this.ln.rn(e)}Ft(){this.ln.an()}}class vu{constructor(){this.ln=new e5,this.hn=new t5(this.ln),this.Pn=new n5(this.ln)}seed(e){this.ln.seed(e)}Tn(e){return e===0?this.hn:this.Pn}cn(){return this.ln.cn()}reset(){this.ln.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fa{constructor(e,t,r,o){this.In=e,this.En=t,this.dn=r,this.An=o}Rn(){const e=this.An.length,t=e===0||this.An[e-1]===255?e+1:e,r=new Uint8Array(t);return r.set(this.An,0),t!==e?r.set([0],this.An.length):++r[r.length-1],new fa(this.In,this.En,this.dn,r)}Vn(e,t,r){return{indexId:this.In,uid:e,arrayValue:kp(this.dn),directionalValue:kp(this.An),orderedDocumentKey:kp(t),documentKey:r.path.toArray()}}mn(e,t,r){const o=this.Vn(e,t,r);return[o.indexId,o.uid,o.arrayValue,o.directionalValue,o.orderedDocumentKey,o.documentKey]}}function ns(n,e){let t=n.In-e.In;return t!==0?t:(t=s1(n.dn,e.dn),t!==0?t:(t=s1(n.An,e.An),t!==0?t:We.comparator(n.En,e.En)))}function s1(n,e){for(let t=0;t<n.length&&t<e.length;++t){const r=n[t]-e[t];if(r!==0)return r}return n.length-e.length}function kp(n){return Fk()?function(t){let r="";for(let o=0;o<t.length;o++)r+=String.fromCharCode(t[o]);return r}(n):n}function a1(n){return typeof n!="string"?n:function(t){const r=new Uint8Array(t.length);for(let o=0;o<t.length;o++)r[o]=t.charCodeAt(o);return r}(n)}class l1{constructor(e){this.fn=new Ut((t,r)=>tn.comparator(t.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.gn=e.orderBy,this.pn=[];for(const t of e.filters){const r=t;r.isInequality()?this.fn=this.fn.add(r):this.pn.push(r)}}get yn(){return this.fn.size>1}wn(e){if(tt(e.collectionGroup===this.collectionId,49279),this.yn)return!1;const t=vy(e);if(t!==void 0&&!this.bn(t))return!1;const r=ca(e);let o=new Set,a=0,c=0;for(;a<r.length&&this.bn(r[a]);++a)o=o.add(r[a].fieldPath.canonicalString());if(a===r.length)return!0;if(this.fn.size>0){const d=this.fn.getIterator().getNext();if(!o.has(d.field.canonicalString())){const h=r[a];if(!this.Sn(d,h)||!this.Dn(this.gn[c++],h))return!1}++a}for(;a<r.length;++a){const d=r[a];if(c>=this.gn.length||!this.Dn(this.gn[c++],d))return!1}return!0}vn(){if(this.yn)return null;let e=new Ut(tn.comparator);const t=[];for(const r of this.pn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")t.push(new va(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),t.push(new va(r.field,0))}for(const r of this.gn)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),t.push(new va(r.field,r.dir==="asc"?0:1)));return new Xl(Xl.UNKNOWN_ID,this.collectionId,t,Jl.empty())}bn(e){for(const t of this.pn)if(this.Sn(t,e))return!0;return!1}Sn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===r}Dn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function p_(n){var e,t;if(tt(n instanceof Ct||n instanceof Vt,20012),n instanceof Ct){if(n instanceof ET){const o=((t=(e=n.value.arrayValue)===null||e===void 0?void 0:e.values)===null||t===void 0?void 0:t.map(a=>Ct.create(n.field,"==",a)))||[];return Vt.create(o,"or")}return n}const r=n.filters.map(o=>p_(o));return Vt.create(r,n.op)}function r5(n){if(n.getFilters().length===0)return[];const e=Ny(p_(n));return tt(f_(e),7391),zy(e)||Dy(e)?[e]:e.getFilters()}function zy(n){return n instanceof Ct}function Dy(n){return n instanceof Vt&&kx(n)}function f_(n){return zy(n)||Dy(n)||function(t){if(t instanceof Vt&&Iy(t)){for(const r of t.getFilters())if(!zy(r)&&!Dy(r))return!1;return!0}return!1}(n)}function Ny(n){if(tt(n instanceof Ct||n instanceof Vt,34018),n instanceof Ct)return n;if(n.filters.length===1)return Ny(n.filters[0]);const e=n.filters.map(r=>Ny(r));let t=Vt.create(e,n.op);return t=Up(t),f_(t)?t:(tt(t instanceof Vt,64498),tt(oc(t),40251),tt(t.filters.length>1,57927),t.filters.reduce((r,o)=>Fx(r,o)))}function Fx(n,e){let t;return tt(n instanceof Ct||n instanceof Vt,38388),tt(e instanceof Ct||e instanceof Vt,25473),t=n instanceof Ct?e instanceof Ct?function(o,a){return Vt.create([o,a],"and")}(n,e):c1(n,e):e instanceof Ct?c1(e,n):function(o,a){if(tt(o.filters.length>0&&a.filters.length>0,48005),oc(o)&&oc(a))return IT(o,a.getFilters());const c=Iy(o)?o:a,d=Iy(o)?a:o,h=c.filters.map(m=>Fx(m,d));return Vt.create(h,"or")}(n,e),Up(t)}function c1(n,e){if(oc(e))return IT(e,n.getFilters());{const t=e.filters.map(r=>Fx(n,r));return Vt.create(t,"or")}}function Up(n){if(tt(n instanceof Ct||n instanceof Vt,11850),n instanceof Ct)return n;const e=n.getFilters();if(e.length===1)return Up(e[0]);if(_T(n))return n;const t=e.map(o=>Up(o)),r=[];return t.forEach(o=>{o instanceof Ct?r.push(o):o instanceof Vt&&(o.op===n.op?r.push(...o.filters):r.push(o))}),r.length===1?r[0]:Vt.create(r,n.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i5{constructor(){this.Cn=new zx}addToCollectionParentIndex(e,t){return this.Cn.add(t),se.resolve()}getCollectionParents(e,t){return se.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return se.resolve()}deleteFieldIndex(e,t){return se.resolve()}deleteAllFieldIndexes(e){return se.resolve()}createTargetIndexes(e,t){return se.resolve()}getDocumentsMatchingTarget(e,t){return se.resolve(null)}getIndexType(e,t){return se.resolve(0)}getFieldIndexes(e,t){return se.resolve([])}getNextCollectionGroupToUpdate(e){return se.resolve(null)}getMinOffset(e,t){return se.resolve(Wr.min())}getMinOffsetFromCollectionGroup(e,t){return se.resolve(Wr.min())}updateCollectionGroup(e,t,r){return se.resolve()}updateIndexEntries(e,t){return se.resolve()}}class zx{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),o=this.index[t]||new Ut(It.comparator),a=!o.has(r);return this.index[t]=o.add(r),a}has(e){const t=e.lastSegment(),r=e.popLast(),o=this.index[t];return o&&o.has(r)}getEntries(e){return(this.index[e]||new Ut(It.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const u1="IndexedDbIndexManager",ip=new Uint8Array(0);class o5{constructor(e,t){this.databaseId=t,this.Fn=new zx,this.Mn=new jo(r=>Ia(r),(r,o)=>md(r,o)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.Fn.has(t)){const r=t.lastSegment(),o=t.popLast();e.addOnCommittedListener(()=>{this.Fn.add(t)});const a={collectionId:r,parent:ir(o)};return d1(e).put(a)}return se.resolve()}getCollectionParents(e,t){const r=[],o=IDBKeyRange.bound([t,""],[Yk(t),""],!1,!0);return d1(e).J(o).next(a=>{for(const c of a){if(c.collectionId!==t)break;r.push(zi(c.parent))}return r})}addFieldIndex(e,t){const r=wu(e),o=function(d){return{indexId:d.indexId,collectionGroup:d.collectionGroup,fields:d.fields.map(h=>[h.fieldPath.canonicalString(),h.kind])}}(t);delete o.indexId;const a=r.add(o);if(t.indexState){const c=Al(e);return a.next(d=>{c.put(n1(d,this.uid,t.indexState.sequenceNumber,t.indexState.offset))})}return a.next()}deleteFieldIndex(e,t){const r=wu(e),o=Al(e),a=El(e);return r.delete(t.indexId).next(()=>o.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>a.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const t=wu(e),r=El(e),o=Al(e);return t.X().next(()=>r.X()).next(()=>o.X())}createTargetIndexes(e,t){return se.forEach(this.xn(t),r=>this.getIndexType(e,r).next(o=>{if(o===0||o===1){const a=new l1(r).vn();if(a!=null)return this.addFieldIndex(e,a)}}))}getDocumentsMatchingTarget(e,t){const r=El(e);let o=!0;const a=new Map;return se.forEach(this.xn(t),c=>this.On(e,c).next(d=>{o&&(o=!!d),a.set(c,d)})).next(()=>{if(o){let c=wt();const d=[];return se.forEach(a,(h,m)=>{Ie(u1,`Using index ${function(B){return`id=${B.indexId}|cg=${B.collectionGroup}|f=${B.fields.map(q=>`${q.fieldPath}:${q.kind}`).join(",")}`}(h)} to execute ${Ia(t)}`);const g=function(B,q){const te=vy(q);if(te===void 0)return null;for(const W of Lp(B,te.fieldPath))switch(W.op){case"array-contains-any":return W.value.arrayValue.values||[];case"array-contains":return[W.value]}return null}(m,h),x=function(B,q){const te=new Map;for(const W of ca(q))for(const L of Lp(B,W.fieldPath))switch(L.op){case"==":case"in":te.set(W.fieldPath.canonicalString(),L.value);break;case"not-in":case"!=":return te.set(W.fieldPath.canonicalString(),L.value),Array.from(te.values())}return null}(m,h),S=function(B,q){const te=[];let W=!0;for(const L of ca(q)){const R=L.kind===0?Vw(B,L.fieldPath,B.startAt):Uw(B,L.fieldPath,B.startAt);te.push(R.value),W&&(W=R.inclusive)}return new ks(te,W)}(m,h),C=function(B,q){const te=[];let W=!0;for(const L of ca(q)){const R=L.kind===0?Uw(B,L.fieldPath,B.endAt):Vw(B,L.fieldPath,B.endAt);te.push(R.value),W&&(W=R.inclusive)}return new ks(te,W)}(m,h),_=this.Nn(h,m,S),I=this.Nn(h,m,C),T=this.Bn(h,m,x),F=this.Ln(h.indexId,g,_,S.inclusive,I,C.inclusive,T);return se.forEach(F,P=>r.Z(P,t.limit).next(B=>{B.forEach(q=>{const te=We.fromSegments(q.documentKey);c.has(te)||(c=c.add(te),d.push(te))})}))}).next(()=>d)}return se.resolve(null)})}xn(e){let t=this.Mn.get(e);return t||(e.filters.length===0?t=[e]:t=r5(Vt.create(e.filters,"and")).map(r=>Ry(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.Mn.set(e,t),t)}Ln(e,t,r,o,a,c,d){const h=(t!=null?t.length:1)*Math.max(r.length,a.length),m=h/(t!=null?t.length:1),g=[];for(let x=0;x<h;++x){const S=t?this.kn(t[x/m]):ip,C=this.qn(e,S,r[x%m],o),_=this.Qn(e,S,a[x%m],c),I=d.map(T=>this.qn(e,S,T,!0));g.push(...this.createRange(C,_,I))}return g}qn(e,t,r,o){const a=new fa(e,We.empty(),t,r);return o?a:a.Rn()}Qn(e,t,r,o){const a=new fa(e,We.empty(),t,r);return o?a.Rn():a}On(e,t){const r=new l1(t),o=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,o).next(a=>{let c=null;for(const d of a)r.wn(d)&&(!c||d.fields.length>c.fields.length)&&(c=d);return c})}getIndexType(e,t){let r=2;const o=this.xn(t);return se.forEach(o,a=>this.On(e,a).next(c=>{c?r!==0&&c.fields.length<function(h){let m=new Ut(tn.comparator),g=!1;for(const x of h.filters)for(const S of x.getFlattenedFilters())S.field.isKeyField()||(S.op==="array-contains"||S.op==="array-contains-any"?g=!0:m=m.add(S.field));for(const x of h.orderBy)x.field.isKeyField()||(m=m.add(x.field));return m.size+(g?1:0)}(a)&&(r=1):r=0})).next(()=>function(c){return c.limit!==null}(t)&&o.length>1&&r===2?1:r)}$n(e,t){const r=new vu;for(const o of ca(e)){const a=t.data.field(o.fieldPath);if(a==null)return null;const c=r.Tn(o.kind);pa.Wt.vt(a,c)}return r.cn()}kn(e){const t=new vu;return pa.Wt.vt(e,t.Tn(0)),t.cn()}Un(e,t){const r=new vu;return pa.Wt.vt(ja(this.databaseId,t),r.Tn(function(a){const c=ca(a);return c.length===0?0:c[c.length-1].kind}(e))),r.cn()}Bn(e,t,r){if(r===null)return[];let o=[];o.push(new vu);let a=0;for(const c of ca(e)){const d=r[a++];for(const h of o)if(this.Kn(t,c.fieldPath)&&rd(d))o=this.Wn(o,c,d);else{const m=h.Tn(c.kind);pa.Wt.vt(d,m)}}return this.Gn(o)}Nn(e,t,r){return this.Bn(e,t,r.position)}Gn(e){const t=[];for(let r=0;r<e.length;++r)t[r]=e[r].cn();return t}Wn(e,t,r){const o=[...e],a=[];for(const c of r.arrayValue.values||[])for(const d of o){const h=new vu;h.seed(d.cn()),pa.Wt.vt(c,h.Tn(t.kind)),a.push(h)}return a}Kn(e,t){return!!e.filters.find(r=>r instanceof Ct&&r.field.isEqual(t)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,t){const r=wu(e),o=Al(e);return(t?r.J(Sy,IDBKeyRange.bound(t,t)):r.J()).next(a=>{const c=[];return se.forEach(a,d=>o.get([d.indexId,this.uid]).next(h=>{c.push(function(g,x){const S=x?new Jl(x.sequenceNumber,new Wr(Aa(x.readTime),new We(zi(x.documentKey)),x.largestBatchId)):Jl.empty(),C=g.fields.map(([_,I])=>new va(tn.fromServerFormat(_),I));return new Xl(g.indexId,g.collectionGroup,C,S)}(d,h))})).next(()=>c)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(t=>t.length===0?null:(t.sort((r,o)=>{const a=r.indexState.sequenceNumber-o.indexState.sequenceNumber;return a!==0?a:dt(r.collectionGroup,o.collectionGroup)}),t[0].collectionGroup))}updateCollectionGroup(e,t,r){const o=wu(e),a=Al(e);return this.zn(e).next(c=>o.J(Sy,IDBKeyRange.bound(t,t)).next(d=>se.forEach(d,h=>a.put(n1(h.indexId,this.uid,c,r)))))}updateIndexEntries(e,t){const r=new Map;return se.forEach(t,(o,a)=>{const c=r.get(o.collectionGroup);return(c?se.resolve(c):this.getFieldIndexes(e,o.collectionGroup)).next(d=>(r.set(o.collectionGroup,d),se.forEach(d,h=>this.jn(e,o,h).next(m=>{const g=this.Hn(a,h);return m.isEqual(g)?se.resolve():this.Jn(e,a,h,m,g)}))))})}Yn(e,t,r,o){return El(e).put(o.Vn(this.uid,this.Un(r,t.key),t.key))}Zn(e,t,r,o){return El(e).delete(o.mn(this.uid,this.Un(r,t.key),t.key))}jn(e,t,r){const o=El(e);let a=new Ut(ns);return o.te({index:aT,range:IDBKeyRange.only([r.indexId,this.uid,kp(this.Un(r,t))])},(c,d)=>{a=a.add(new fa(r.indexId,t,a1(d.arrayValue),a1(d.directionalValue)))}).next(()=>a)}Hn(e,t){let r=new Ut(ns);const o=this.$n(t,e);if(o==null)return r;const a=vy(t);if(a!=null){const c=e.data.field(a.fieldPath);if(rd(c))for(const d of c.arrayValue.values||[])r=r.add(new fa(t.indexId,e.key,this.kn(d),o))}else r=r.add(new fa(t.indexId,e.key,ip,o));return r}Jn(e,t,r,o,a){Ie(u1,"Updating index entries for document '%s'",t.key);const c=[];return function(h,m,g,x,S){const C=h.getIterator(),_=m.getIterator();let I=Cl(C),T=Cl(_);for(;I||T;){let F=!1,P=!1;if(I&&T){const B=g(I,T);B<0?P=!0:B>0&&(F=!0)}else I!=null?P=!0:F=!0;F?(x(T),T=Cl(_)):P?(S(I),I=Cl(C)):(I=Cl(C),T=Cl(_))}}(o,a,ns,d=>{c.push(this.Yn(e,t,r,d))},d=>{c.push(this.Zn(e,t,r,d))}),se.waitFor(c)}zn(e){let t=1;return Al(e).te({index:sT,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,o,a)=>{a.done(),t=o.sequenceNumber+1}).next(()=>t)}createRange(e,t,r){r=r.sort((c,d)=>ns(c,d)).filter((c,d,h)=>!d||ns(c,h[d-1])!==0);const o=[];o.push(e);for(const c of r){const d=ns(c,e),h=ns(c,t);if(d===0)o[0]=e.Rn();else if(d>0&&h<0)o.push(c),o.push(c.Rn());else if(h>0)break}o.push(t);const a=[];for(let c=0;c<o.length;c+=2){if(this.Xn(o[c],o[c+1]))return[];const d=o[c].mn(this.uid,ip,We.empty()),h=o[c+1].mn(this.uid,ip,We.empty());a.push(IDBKeyRange.bound(d,h))}return a}Xn(e,t){return ns(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(h1)}getMinOffset(e,t){return se.mapArray(this.xn(t),r=>this.On(e,r).next(o=>o||Ke(44426))).next(h1)}}function d1(n){return Fn(n,Zu)}function El(n){return Fn(n,Lu)}function wu(n){return Fn(n,xx)}function Al(n){return Fn(n,Mu)}function h1(n){tt(n.length!==0,28825);let e=n[0].indexState.offset,t=e.largestBatchId;for(let r=1;r<n.length;r++){const o=n[r].indexState.offset;mx(o,e)<0&&(e=o),t<o.largestBatchId&&(t=o.largestBatchId)}return new Wr(e.readTime,e.documentKey,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const p1={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},m_=41943040;class nr{static withCacheSize(e){return new nr(e,nr.DEFAULT_COLLECTION_PERCENTILE,nr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function g_(n,e,t){const r=n.store(pi),o=n.store(Zl),a=[],c=IDBKeyRange.only(t.batchId);let d=0;const h=r.te({range:c},(g,x,S)=>(d++,S.delete()));a.push(h.next(()=>{tt(d===1,47070,{batchId:t.batchId})}));const m=[];for(const g of t.mutations){const x=rT(e,g.key.path,t.batchId);a.push(o.delete(x)),m.push(g.key)}return se.waitFor(a).next(()=>m)}function qp(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw Ke(14731);e=n.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */nr.DEFAULT_COLLECTION_PERCENTILE=10,nr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,nr.DEFAULT=new nr(m_,nr.DEFAULT_COLLECTION_PERCENTILE,nr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),nr.DISABLED=new nr(-1,0,0);class Ef{constructor(e,t,r,o){this.userId=e,this.serializer=t,this.indexManager=r,this.referenceDelegate=o,this.er={}}static bt(e,t,r,o){tt(e.uid!=="",64387);const a=e.isAuthenticated()?e.uid:"";return new Ef(a,t,r,o)}checkEmpty(e){let t=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return rs(e).te({index:ma,range:r},(o,a,c)=>{t=!1,c.done()}).next(()=>t)}addMutationBatch(e,t,r,o){const a=Wl(e),c=rs(e);return c.add({}).next(d=>{tt(typeof d=="number",49019);const h=new Cx(d,t,r,o),m=function(C,_,I){const T=I.baseMutations.map(P=>sd(C.wt,P)),F=I.mutations.map(P=>sd(C.wt,P));return{userId:_,batchId:I.batchId,localWriteTimeMs:I.localWriteTime.toMillis(),baseMutations:T,mutations:F}}(this.serializer,this.userId,h),g=[];let x=new Ut((S,C)=>dt(S.canonicalString(),C.canonicalString()));for(const S of o){const C=rT(this.userId,S.key.path,d);x=x.add(S.key.path.popLast()),g.push(c.put(m)),g.push(a.put(C,OA))}return x.forEach(S=>{g.push(this.indexManager.addToCollectionParentIndex(e,S))}),e.addOnCommittedListener(()=>{this.er[d]=h.keys()}),se.waitFor(g).next(()=>h)})}lookupMutationBatch(e,t){return rs(e).get(t).next(r=>r?(tt(r.userId===this.userId,48,"Unexpected user for mutation batch",{userId:r.userId,batchId:t}),ha(this.serializer,r)):null)}tr(e,t){return this.er[t]?se.resolve(this.er[t]):this.lookupMutationBatch(e,t).next(r=>{if(r){const o=r.keys();return this.er[t]=o,o}return null})}getNextMutationBatchAfterBatchId(e,t){const r=t+1,o=IDBKeyRange.lowerBound([this.userId,r]);let a=null;return rs(e).te({index:ma,range:o},(c,d,h)=>{d.userId===this.userId&&(tt(d.batchId>=r,47524,{nr:r}),a=ha(this.serializer,d)),h.done()}).next(()=>a)}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=gs;return rs(e).te({index:ma,range:t,reverse:!0},(o,a,c)=>{r=a.batchId,c.done()}).next(()=>r)}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,gs],[this.userId,Number.POSITIVE_INFINITY]);return rs(e).J(ma,t).next(r=>r.map(o=>ha(this.serializer,o)))}getAllMutationBatchesAffectingDocumentKey(e,t){const r=gp(this.userId,t.path),o=IDBKeyRange.lowerBound(r),a=[];return Wl(e).te({range:o},(c,d,h)=>{const[m,g,x]=c,S=zi(g);if(m===this.userId&&t.path.isEqual(S))return rs(e).get(x).next(C=>{if(!C)throw Ke(61480,{rr:c,batchId:x});tt(C.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:C.userId,batchId:x}),a.push(ha(this.serializer,C))});h.done()}).next(()=>a)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Ut(dt);const o=[];return t.forEach(a=>{const c=gp(this.userId,a.path),d=IDBKeyRange.lowerBound(c),h=Wl(e).te({range:d},(m,g,x)=>{const[S,C,_]=m,I=zi(C);S===this.userId&&a.path.isEqual(I)?r=r.add(_):x.done()});o.push(h)}),se.waitFor(o).next(()=>this.ir(e,r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,o=r.length+1,a=gp(this.userId,r),c=IDBKeyRange.lowerBound(a);let d=new Ut(dt);return Wl(e).te({range:c},(h,m,g)=>{const[x,S,C]=h,_=zi(S);x===this.userId&&r.isPrefixOf(_)?_.length===o&&(d=d.add(C)):g.done()}).next(()=>this.ir(e,d))}ir(e,t){const r=[],o=[];return t.forEach(a=>{o.push(rs(e).get(a).next(c=>{if(c===null)throw Ke(35274,{batchId:a});tt(c.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:c.userId,batchId:a}),r.push(ha(this.serializer,c))}))}),se.waitFor(o).next(()=>r)}removeMutationBatch(e,t){return g_(e.he,this.userId,t).next(r=>(e.addOnCommittedListener(()=>{this.sr(t.batchId)}),se.forEach(r,o=>this.referenceDelegate.markPotentiallyOrphaned(e,o))))}sr(e){delete this.er[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return se.resolve();const r=IDBKeyRange.lowerBound(function(c){return[c]}(this.userId)),o=[];return Wl(e).te({range:r},(a,c,d)=>{if(a[0]===this.userId){const h=zi(a[1]);o.push(h)}else d.done()}).next(()=>{tt(o.length===0,56720,{_r:o.map(a=>a.canonicalString())})})})}containsKey(e,t){return y_(e,this.userId,t)}ar(e){return x_(e).get(this.userId).next(t=>t||{userId:this.userId,lastAcknowledgedBatchId:gs,lastStreamToken:""})}}function y_(n,e,t){const r=gp(e,t.path),o=r[1],a=IDBKeyRange.lowerBound(r);let c=!1;return Wl(n).te({range:a,ee:!0},(d,h,m)=>{const[g,x,S]=d;g===e&&x===o&&(c=!0),m.done()}).next(()=>c)}function rs(n){return Fn(n,pi)}function Wl(n){return Fn(n,Zl)}function x_(n){return Fn(n,Xu)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pa{constructor(e){this.ur=e}next(){return this.ur+=2,this.ur}static cr(){return new Pa(0)}static lr(){return new Pa(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s5{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.hr(e).next(t=>{const r=new Pa(t.highestTargetId);return t.highestTargetId=r.next(),this.Pr(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.hr(e).next(t=>st.fromTimestamp(new Gt(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.hr(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,r){return this.hr(e).next(o=>(o.highestListenSequenceNumber=t,r&&(o.lastRemoteSnapshotVersion=r.toTimestamp()),t>o.highestListenSequenceNumber&&(o.highestListenSequenceNumber=t),this.Pr(e,o)))}addTargetData(e,t){return this.Tr(e,t).next(()=>this.hr(e).next(r=>(r.targetCount+=1,this.Ir(t,r),this.Pr(e,r))))}updateTargetData(e,t){return this.Tr(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>Pl(e).delete(t.targetId)).next(()=>this.hr(e)).next(r=>(tt(r.targetCount>0,8065),r.targetCount-=1,this.Pr(e,r)))}removeTargets(e,t,r){let o=0;const a=[];return Pl(e).te((c,d)=>{const h=Bu(d);h.sequenceNumber<=t&&r.get(h.targetId)===null&&(o++,a.push(this.removeTargetData(e,h)))}).next(()=>se.waitFor(a)).next(()=>o)}forEachTarget(e,t){return Pl(e).te((r,o)=>{const a=Bu(o);t(a)})}hr(e){return f1(e).get(Np).next(t=>(tt(t!==null,2888),t))}Pr(e,t){return f1(e).put(Np,t)}Tr(e,t){return Pl(e).put(h_(this.serializer,t))}Ir(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.hr(e).next(t=>t.targetCount)}getTargetData(e,t){const r=Ia(t),o=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let a=null;return Pl(e).te({range:o,index:oT},(c,d,h)=>{const m=Bu(d);md(t,m.target)&&(a=m,h.done())}).next(()=>a)}addMatchingKeys(e,t,r){const o=[],a=as(e);return t.forEach(c=>{const d=ir(c.path);o.push(a.put({targetId:r,path:d})),o.push(this.referenceDelegate.addReference(e,r,c))}),se.waitFor(o)}removeMatchingKeys(e,t,r){const o=as(e);return se.forEach(t,a=>{const c=ir(a.path);return se.waitFor([o.delete([r,c]),this.referenceDelegate.removeReference(e,r,a)])})}removeMatchingKeysForTargetId(e,t){const r=as(e),o=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(o)}getMatchingKeysForTargetId(e,t){const r=IDBKeyRange.bound([t],[t+1],!1,!0),o=as(e);let a=wt();return o.te({range:r,ee:!0},(c,d,h)=>{const m=zi(c[1]),g=new We(m);a=a.add(g)}).next(()=>a)}containsKey(e,t){const r=ir(t.path),o=IDBKeyRange.bound([r],[Yk(r)],!1,!0);let a=0;return as(e).te({index:yx,ee:!0,range:o},([c,d],h,m)=>{c!==0&&(a++,m.done())}).next(()=>a>0)}Rt(e,t){return Pl(e).get(t).next(r=>r?Bu(r):null)}}function Pl(n){return Fn(n,ec)}function f1(n){return Fn(n,wa)}function as(n){return Fn(n,tc)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m1="LruGarbageCollector",b_=1048576;function g1([n,e],[t,r]){const o=dt(n,t);return o===0?dt(e,r):o}class a5{constructor(e){this.Er=e,this.buffer=new Ut(g1),this.dr=0}Ar(){return++this.dr}Rr(e){const t=[e,this.Ar()];if(this.buffer.size<this.Er)this.buffer=this.buffer.add(t);else{const r=this.buffer.last();g1(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}}class v_{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Vr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.mr(6e4)}stop(){this.Vr&&(this.Vr.cancel(),this.Vr=null)}get started(){return this.Vr!==null}mr(e){Ie(m1,`Garbage collection scheduled in ${e}ms`),this.Vr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Vr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Es(t)?Ie(m1,"Ignoring IndexedDB error during garbage collection: ",t):await Rs(t)}await this.mr(3e5)})}}class l5{constructor(e,t){this.gr=e,this.params=t}calculateTargetCount(e,t){return this.gr.pr(e).next(r=>Math.floor(t/100*r))}nthSequenceNumber(e,t){if(t===0)return se.resolve(Tr.le);const r=new a5(t);return this.gr.forEachTarget(e,o=>r.Rr(o.sequenceNumber)).next(()=>this.gr.yr(e,o=>r.Rr(o))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.gr.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.gr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(Ie("LruGarbageCollector","Garbage collection skipped; disabled"),se.resolve(p1)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(Ie("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),p1):this.wr(e,t))}getCacheSize(e){return this.gr.getCacheSize(e)}wr(e,t){let r,o,a,c,d,h,m;const g=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(x=>(x>this.params.maximumSequenceNumbersToCollect?(Ie("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${x}`),o=this.params.maximumSequenceNumbersToCollect):o=x,c=Date.now(),this.nthSequenceNumber(e,o))).next(x=>(r=x,d=Date.now(),this.removeTargets(e,r,t))).next(x=>(a=x,h=Date.now(),this.removeOrphanedDocuments(e,r))).next(x=>(m=Date.now(),Ml()<=jt.DEBUG&&Ie("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${c-g}ms
	Determined least recently used ${o} in `+(d-c)+`ms
	Removed ${a} targets in `+(h-d)+`ms
	Removed ${x} documents in `+(m-h)+`ms
Total Duration: ${m-g}ms`),se.resolve({didRun:!0,sequenceNumbersCollected:o,targetsRemoved:a,documentsRemoved:x})))}}function w_(n,e){return new l5(n,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c5{constructor(e,t){this.db=e,this.garbageCollector=w_(this,t)}pr(e){const t=this.br(e);return this.db.getTargetCache().getTargetCount(e).next(r=>t.next(o=>r+o))}br(e){let t=0;return this.yr(e,r=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}yr(e,t){return this.Sr(e,(r,o)=>t(o))}addReference(e,t,r){return op(e,r)}removeReference(e,t,r){return op(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return op(e,t)}Dr(e,t){return function(o,a){let c=!1;return x_(o).ne(d=>y_(o,d,a).next(h=>(h&&(c=!0),se.resolve(!h)))).next(()=>c)}(e,t)}removeOrphanedDocuments(e,t){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),o=[];let a=0;return this.Sr(e,(c,d)=>{if(d<=t){const h=this.Dr(e,c).next(m=>{if(!m)return a++,r.getEntry(e,c).next(()=>(r.removeEntry(c,st.min()),as(e).delete(function(x){return[0,ir(x.path)]}(c))))});o.push(h)}}).next(()=>se.waitFor(o)).next(()=>r.apply(e)).next(()=>a)}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return op(e,t)}Sr(e,t){const r=as(e);let o,a=Tr.le;return r.te({index:yx},([c,d],{path:h,sequenceNumber:m})=>{c===0?(a!==Tr.le&&t(new We(zi(o)),a),a=m,o=h):a=Tr.le}).next(()=>{a!==Tr.le&&t(new We(zi(o)),a)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function op(n,e){return as(n).put(function(r,o){return{targetId:0,path:ir(r.path),sequenceNumber:o}}(e,n.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S_{constructor(){this.changes=new jo(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,en.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return r!==void 0?se.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u5{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return aa(e).put(r)}removeEntry(e,t,r){return aa(e).delete(function(a,c){const d=a.path.toArray();return[d.slice(0,d.length-2),d[d.length-2],Vp(c),d[d.length-1]]}(t,r))}updateMetadata(e,t){return this.getMetadata(e).next(r=>(r.byteSize+=t,this.vr(e,r)))}getEntry(e,t){let r=en.newInvalidDocument(t);return aa(e).te({index:yp,range:IDBKeyRange.only(Su(t))},(o,a)=>{r=this.Cr(t,a)}).next(()=>r)}Fr(e,t){let r={size:0,document:en.newInvalidDocument(t)};return aa(e).te({index:yp,range:IDBKeyRange.only(Su(t))},(o,a)=>{r={document:this.Cr(t,a),size:qp(a)}}).next(()=>r)}getEntries(e,t){let r=jr();return this.Mr(e,t,(o,a)=>{const c=this.Cr(o,a);r=r.insert(o,c)}).next(()=>r)}Or(e,t){let r=jr(),o=new Xt(We.comparator);return this.Mr(e,t,(a,c)=>{const d=this.Cr(a,c);r=r.insert(a,d),o=o.insert(a,qp(c))}).next(()=>({documents:r,Nr:o}))}Mr(e,t,r){if(t.isEmpty())return se.resolve();let o=new Ut(b1);t.forEach(h=>o=o.add(h));const a=IDBKeyRange.bound(Su(o.first()),Su(o.last())),c=o.getIterator();let d=c.getNext();return aa(e).te({index:yp,range:a},(h,m,g)=>{const x=We.fromSegments([...m.prefixPath,m.collectionGroup,m.documentId]);for(;d&&b1(d,x)<0;)r(d,null),d=c.getNext();d&&d.isEqual(x)&&(r(d,m),d=c.hasNext()?c.getNext():null),d?g.H(Su(d)):g.done()}).next(()=>{for(;d;)r(d,null),d=c.hasNext()?c.getNext():null})}getDocumentsMatchingQuery(e,t,r,o,a){const c=t.path,d=[c.popLast().toArray(),c.lastSegment(),Vp(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],h=[c.popLast().toArray(),c.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return aa(e).J(IDBKeyRange.bound(d,h,!0)).next(m=>{a==null||a.incrementDocumentReadCount(m.length);let g=jr();for(const x of m){const S=this.Cr(We.fromSegments(x.prefixPath.concat(x.collectionGroup,x.documentId)),x);S.isFoundDocument()&&(yd(t,S)||o.has(S.key))&&(g=g.insert(S.key,S))}return g})}getAllFromCollectionGroup(e,t,r,o){let a=jr();const c=x1(t,r),d=x1(t,Wr.max());return aa(e).te({index:iT,range:IDBKeyRange.bound(c,d,!0)},(h,m,g)=>{const x=this.Cr(We.fromSegments(m.prefixPath.concat(m.collectionGroup,m.documentId)),m);a=a.insert(x.key,x),a.size===o&&g.done()}).next(()=>a)}newChangeBuffer(e){return new d5(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return y1(e).get(wy).next(t=>(tt(!!t,20021),t))}vr(e,t){return y1(e).put(wy,t)}Cr(e,t){if(t){const r=Y6(this.serializer,t);if(!(r.isNoDocument()&&r.version.isEqual(st.min())))return r}return en.newInvalidDocument(e)}}function k_(n){return new u5(n)}class d5 extends S_{constructor(e,t){super(),this.Br=e,this.trackRemovals=t,this.Lr=new jo(r=>r.toString(),(r,o)=>r.isEqual(o))}applyChanges(e){const t=[];let r=0,o=new Ut((a,c)=>dt(a.canonicalString(),c.canonicalString()));return this.changes.forEach((a,c)=>{const d=this.Lr.get(a);if(t.push(this.Br.removeEntry(e,a,d.readTime)),c.isValidDocument()){const h=e1(this.Br.serializer,c);o=o.add(a.path.popLast());const m=qp(h);r+=m-d.size,t.push(this.Br.addEntry(e,a,h))}else if(r-=d.size,this.trackRemovals){const h=e1(this.Br.serializer,c.convertToNoDocument(st.min()));t.push(this.Br.addEntry(e,a,h))}}),o.forEach(a=>{t.push(this.Br.indexManager.addToCollectionParentIndex(e,a))}),t.push(this.Br.updateMetadata(e,r)),se.waitFor(t)}getFromCache(e,t){return this.Br.Fr(e,t).next(r=>(this.Lr.set(t,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,t){return this.Br.Or(e,t).next(({documents:r,Nr:o})=>(o.forEach((a,c)=>{this.Lr.set(a,{size:c,readTime:r.get(a).readTime})}),r))}}function y1(n){return Fn(n,Ju)}function aa(n){return Fn(n,Dp)}function Su(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function x1(n,e){const t=e.documentKey.path.toArray();return[n,Vp(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function b1(n,e){const t=n.path.toArray(),r=e.path.toArray();let o=0;for(let a=0;a<t.length-2&&a<r.length-2;++a)if(o=dt(t[a],r[a]),o)return o;return o=dt(t.length,r.length),o||(o=dt(t[t.length-2],r[r.length-2]),o||dt(t[t.length-1],r[r.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h5{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T_{constructor(e,t,r,o){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=o}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(o=>(r=o,this.remoteDocumentCache.getEntry(e,t))).next(o=>(r!==null&&Vu(r.mutation,o,_r.empty(),Gt.now()),o))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,wt()).next(()=>r))}getLocalViewOfDocuments(e,t,r=wt()){const o=Di();return this.populateOverlays(e,o,t).next(()=>this.computeViews(e,t,o,r).next(a=>{let c=Au();return a.forEach((d,h)=>{c=c.insert(d,h.overlayedDocument)}),c}))}getOverlayedDocuments(e,t){const r=Di();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,wt()))}populateOverlays(e,t,r){const o=[];return r.forEach(a=>{t.has(a)||o.push(a)}),this.documentOverlayCache.getOverlays(e,o).next(a=>{a.forEach((c,d)=>{t.set(c,d)})})}computeViews(e,t,r,o){let a=jr();const c=Wu(),d=function(){return Wu()}();return t.forEach((h,m)=>{const g=r.get(m.key);o.has(m.key)&&(g===void 0||g.mutation instanceof Io)?a=a.insert(m.key,m):g!==void 0?(c.set(m.key,g.mutation.getFieldMask()),Vu(g.mutation,m,g.mutation.getFieldMask(),Gt.now())):c.set(m.key,_r.empty())}),this.recalculateAndSaveOverlays(e,a).next(h=>(h.forEach((m,g)=>c.set(m,g)),t.forEach((m,g)=>{var x;return d.set(m,new h5(g,(x=c.get(m))!==null&&x!==void 0?x:null))}),d))}recalculateAndSaveOverlays(e,t){const r=Wu();let o=new Xt((c,d)=>c-d),a=wt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(c=>{for(const d of c)d.keys().forEach(h=>{const m=t.get(h);if(m===null)return;let g=r.get(h)||_r.empty();g=d.applyToLocalView(m,g),r.set(h,g);const x=(o.get(d.batchId)||wt()).add(h);o=o.insert(d.batchId,x)})}).next(()=>{const c=[],d=o.getReverseIterator();for(;d.hasNext();){const h=d.getNext(),m=h.key,g=h.value,x=LT();g.forEach(S=>{if(!a.has(S)){const C=$T(t.get(S),r.get(S));C!==null&&x.set(S,C),a=a.add(S)}}),c.push(this.documentOverlayCache.saveOverlays(e,m,x))}return se.waitFor(c)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,o){return function(c){return We.isDocumentKey(c.path)&&c.collectionGroup===null&&c.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Tx(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,o):this.getDocumentsMatchingCollectionQuery(e,t,r,o)}getNextDocuments(e,t,r,o){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,o).next(a=>{const c=o-a.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,o-a.size):se.resolve(Di());let d=Yl,h=a;return c.next(m=>se.forEach(m,(g,x)=>(d<x.largestBatchId&&(d=x.largestBatchId),a.get(g)?se.resolve():this.remoteDocumentCache.getEntry(e,g).next(S=>{h=h.insert(g,S)}))).next(()=>this.populateOverlays(e,m,a)).next(()=>this.computeViews(e,h,m,wt())).next(g=>({batchId:d,changes:MT(g)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new We(t)).next(r=>{let o=Au();return r.isFoundDocument()&&(o=o.insert(r.key,r)),o})}getDocumentsMatchingCollectionGroupQuery(e,t,r,o){const a=t.collectionGroup;let c=Au();return this.indexManager.getCollectionParents(e,a).next(d=>se.forEach(d,h=>{const m=function(x,S){return new _o(S,null,x.explicitOrderBy.slice(),x.filters.slice(),x.limit,x.limitType,x.startAt,x.endAt)}(t,h.child(a));return this.getDocumentsMatchingCollectionQuery(e,m,r,o).next(g=>{g.forEach((x,S)=>{c=c.insert(x,S)})})}).next(()=>c))}getDocumentsMatchingCollectionQuery(e,t,r,o){let a;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(c=>(a=c,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,a,o))).next(c=>{a.forEach((h,m)=>{const g=m.getKey();c.get(g)===null&&(c=c.insert(g,en.newInvalidDocument(g)))});let d=Au();return c.forEach((h,m)=>{const g=a.get(h);g!==void 0&&Vu(g.mutation,m,_r.empty(),Gt.now()),yd(t,m)&&(d=d.insert(h,m))}),d})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p5{constructor(e){this.serializer=e,this.kr=new Map,this.qr=new Map}getBundleMetadata(e,t){return se.resolve(this.kr.get(t))}saveBundleMetadata(e,t){return this.kr.set(t.id,function(o){return{id:o.id,version:o.version,createTime:vn(o.createTime)}}(t)),se.resolve()}getNamedQuery(e,t){return se.resolve(this.qr.get(t))}saveNamedQuery(e,t){return this.qr.set(t.name,function(o){return{name:o.name,query:Bx(o.bundledQuery),readTime:vn(o.readTime)}}(t)),se.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f5{constructor(){this.overlays=new Xt(We.comparator),this.Qr=new Map}getOverlay(e,t){return se.resolve(this.overlays.get(t))}getOverlays(e,t){const r=Di();return se.forEach(t,o=>this.getOverlay(e,o).next(a=>{a!==null&&r.set(o,a)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((o,a)=>{this.St(e,t,a)}),se.resolve()}removeOverlaysForBatchId(e,t,r){const o=this.Qr.get(r);return o!==void 0&&(o.forEach(a=>this.overlays=this.overlays.remove(a)),this.Qr.delete(r)),se.resolve()}getOverlaysForCollection(e,t,r){const o=Di(),a=t.length+1,c=new We(t.child("")),d=this.overlays.getIteratorFrom(c);for(;d.hasNext();){const h=d.getNext().value,m=h.getKey();if(!t.isPrefixOf(m.path))break;m.path.length===a&&h.largestBatchId>r&&o.set(h.getKey(),h)}return se.resolve(o)}getOverlaysForCollectionGroup(e,t,r,o){let a=new Xt((m,g)=>m-g);const c=this.overlays.getIterator();for(;c.hasNext();){const m=c.getNext().value;if(m.getKey().getCollectionGroup()===t&&m.largestBatchId>r){let g=a.get(m.largestBatchId);g===null&&(g=Di(),a=a.insert(m.largestBatchId,g)),g.set(m.getKey(),m)}}const d=Di(),h=a.getIterator();for(;h.hasNext()&&(h.getNext().value.forEach((m,g)=>d.set(m,g)),!(d.size()>=o)););return se.resolve(d)}St(e,t,r){const o=this.overlays.get(r.key);if(o!==null){const c=this.Qr.get(o.largestBatchId).delete(r.key);this.Qr.set(o.largestBatchId,c)}this.overlays=this.overlays.insert(r.key,new Ex(t,r));let a=this.Qr.get(t);a===void 0&&(a=wt(),this.Qr.set(t,a)),this.Qr.set(t,a.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m5{constructor(){this.sessionToken=fn.EMPTY_BYTE_STRING}getSessionToken(e){return se.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,se.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dx{constructor(){this.$r=new Ut(On.Ur),this.Kr=new Ut(On.Wr)}isEmpty(){return this.$r.isEmpty()}addReference(e,t){const r=new On(e,t);this.$r=this.$r.add(r),this.Kr=this.Kr.add(r)}Gr(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.zr(new On(e,t))}jr(e,t){e.forEach(r=>this.removeReference(r,t))}Hr(e){const t=new We(new It([])),r=new On(t,e),o=new On(t,e+1),a=[];return this.Kr.forEachInRange([r,o],c=>{this.zr(c),a.push(c.key)}),a}Jr(){this.$r.forEach(e=>this.zr(e))}zr(e){this.$r=this.$r.delete(e),this.Kr=this.Kr.delete(e)}Yr(e){const t=new We(new It([])),r=new On(t,e),o=new On(t,e+1);let a=wt();return this.Kr.forEachInRange([r,o],c=>{a=a.add(c.key)}),a}containsKey(e){const t=new On(e,0),r=this.$r.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}}class On{constructor(e,t){this.key=e,this.Zr=t}static Ur(e,t){return We.comparator(e.key,t.key)||dt(e.Zr,t.Zr)}static Wr(e,t){return dt(e.Zr,t.Zr)||We.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g5{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.nr=1,this.Xr=new Ut(On.Ur)}checkEmpty(e){return se.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,o){const a=this.nr;this.nr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const c=new Cx(a,t,r,o);this.mutationQueue.push(c);for(const d of o)this.Xr=this.Xr.add(new On(d.key,a)),this.indexManager.addToCollectionParentIndex(e,d.key.path.popLast());return se.resolve(c)}lookupMutationBatch(e,t){return se.resolve(this.ei(t))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,o=this.ti(r),a=o<0?0:o;return se.resolve(this.mutationQueue.length>a?this.mutationQueue[a]:null)}getHighestUnacknowledgedBatchId(){return se.resolve(this.mutationQueue.length===0?gs:this.nr-1)}getAllMutationBatches(e){return se.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new On(t,0),o=new On(t,Number.POSITIVE_INFINITY),a=[];return this.Xr.forEachInRange([r,o],c=>{const d=this.ei(c.Zr);a.push(d)}),se.resolve(a)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Ut(dt);return t.forEach(o=>{const a=new On(o,0),c=new On(o,Number.POSITIVE_INFINITY);this.Xr.forEachInRange([a,c],d=>{r=r.add(d.Zr)})}),se.resolve(this.ni(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,o=r.length+1;let a=r;We.isDocumentKey(a)||(a=a.child(""));const c=new On(new We(a),0);let d=new Ut(dt);return this.Xr.forEachWhile(h=>{const m=h.key.path;return!!r.isPrefixOf(m)&&(m.length===o&&(d=d.add(h.Zr)),!0)},c),se.resolve(this.ni(d))}ni(e){const t=[];return e.forEach(r=>{const o=this.ei(r);o!==null&&t.push(o)}),t}removeMutationBatch(e,t){tt(this.ri(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Xr;return se.forEach(t.mutations,o=>{const a=new On(o.key,t.batchId);return r=r.delete(a),this.referenceDelegate.markPotentiallyOrphaned(e,o.key)}).next(()=>{this.Xr=r})}sr(e){}containsKey(e,t){const r=new On(t,0),o=this.Xr.firstAfterOrEqual(r);return se.resolve(t.isEqual(o&&o.key))}performConsistencyCheck(e){return this.mutationQueue.length,se.resolve()}ri(e,t){return this.ti(e)}ti(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}ei(e){const t=this.ti(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y5{constructor(e){this.ii=e,this.docs=function(){return new Xt(We.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,o=this.docs.get(r),a=o?o.size:0,c=this.ii(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:c}),this.size+=c-a,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return se.resolve(r?r.document.mutableCopy():en.newInvalidDocument(t))}getEntries(e,t){let r=jr();return t.forEach(o=>{const a=this.docs.get(o);r=r.insert(o,a?a.document.mutableCopy():en.newInvalidDocument(o))}),se.resolve(r)}getDocumentsMatchingQuery(e,t,r,o){let a=jr();const c=t.path,d=new We(c.child("__id-9223372036854775808__")),h=this.docs.getIteratorFrom(d);for(;h.hasNext();){const{key:m,value:{document:g}}=h.getNext();if(!c.isPrefixOf(m.path))break;m.path.length>c.length+1||mx(Jk(g),r)<=0||(o.has(g.key)||yd(t,g))&&(a=a.insert(g.key,g.mutableCopy()))}return se.resolve(a)}getAllFromCollectionGroup(e,t,r,o){Ke(9500)}si(e,t){return se.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new x5(this)}getSize(e){return se.resolve(this.size)}}class x5 extends S_{constructor(e){super(),this.Br=e}applyChanges(e){const t=[];return this.changes.forEach((r,o)=>{o.isValidDocument()?t.push(this.Br.addEntry(e,o)):this.Br.removeEntry(r)}),se.waitFor(t)}getFromCache(e,t){return this.Br.getEntry(e,t)}getAllFromCache(e,t){return this.Br.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b5{constructor(e){this.persistence=e,this.oi=new jo(t=>Ia(t),md),this.lastRemoteSnapshotVersion=st.min(),this.highestTargetId=0,this._i=0,this.ai=new Dx,this.targetCount=0,this.ui=Pa.cr()}forEachTarget(e,t){return this.oi.forEach((r,o)=>t(o)),se.resolve()}getLastRemoteSnapshotVersion(e){return se.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return se.resolve(this._i)}allocateTargetId(e){return this.highestTargetId=this.ui.next(),se.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this._i&&(this._i=t),se.resolve()}Tr(e){this.oi.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ui=new Pa(t),this.highestTargetId=t),e.sequenceNumber>this._i&&(this._i=e.sequenceNumber)}addTargetData(e,t){return this.Tr(t),this.targetCount+=1,se.resolve()}updateTargetData(e,t){return this.Tr(t),se.resolve()}removeTargetData(e,t){return this.oi.delete(t.target),this.ai.Hr(t.targetId),this.targetCount-=1,se.resolve()}removeTargets(e,t,r){let o=0;const a=[];return this.oi.forEach((c,d)=>{d.sequenceNumber<=t&&r.get(d.targetId)===null&&(this.oi.delete(c),a.push(this.removeMatchingKeysForTargetId(e,d.targetId)),o++)}),se.waitFor(a).next(()=>o)}getTargetCount(e){return se.resolve(this.targetCount)}getTargetData(e,t){const r=this.oi.get(t)||null;return se.resolve(r)}addMatchingKeys(e,t,r){return this.ai.Gr(t,r),se.resolve()}removeMatchingKeys(e,t,r){this.ai.jr(t,r);const o=this.persistence.referenceDelegate,a=[];return o&&t.forEach(c=>{a.push(o.markPotentiallyOrphaned(e,c))}),se.waitFor(a)}removeMatchingKeysForTargetId(e,t){return this.ai.Hr(t),se.resolve()}getMatchingKeysForTargetId(e,t){const r=this.ai.Yr(t);return se.resolve(r)}containsKey(e,t){return se.resolve(this.ai.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nx{constructor(e,t){this.ci={},this.overlays={},this.li=new Tr(0),this.hi=!1,this.hi=!0,this.Pi=new m5,this.referenceDelegate=e(this),this.Ti=new b5(this),this.indexManager=new i5,this.remoteDocumentCache=function(o){return new y5(o)}(r=>this.referenceDelegate.Ii(r)),this.serializer=new d_(t),this.Ei=new p5(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.hi=!1,Promise.resolve()}get started(){return this.hi}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new f5,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.ci[e.toKey()];return r||(r=new g5(t,this.referenceDelegate),this.ci[e.toKey()]=r),r}getGlobalsCache(){return this.Pi}getTargetCache(){return this.Ti}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ei}runTransaction(e,t,r){Ie("MemoryPersistence","Starting transaction:",e);const o=new v5(this.li.next());return this.referenceDelegate.di(),r(o).next(a=>this.referenceDelegate.Ai(o).next(()=>a)).toPromise().then(a=>(o.raiseOnCommittedEvent(),a))}Ri(e,t){return se.or(Object.values(this.ci).map(r=>()=>r.containsKey(e,t)))}}class v5 extends eT{constructor(e){super(),this.currentSequenceNumber=e}}class Af{constructor(e){this.persistence=e,this.Vi=new Dx,this.mi=null}static fi(e){return new Af(e)}get gi(){if(this.mi)return this.mi;throw Ke(60996)}addReference(e,t,r){return this.Vi.addReference(r,t),this.gi.delete(r.toString()),se.resolve()}removeReference(e,t,r){return this.Vi.removeReference(r,t),this.gi.add(r.toString()),se.resolve()}markPotentiallyOrphaned(e,t){return this.gi.add(t.toString()),se.resolve()}removeTarget(e,t){this.Vi.Hr(t.targetId).forEach(o=>this.gi.add(o.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(o=>{o.forEach(a=>this.gi.add(a.toString()))}).next(()=>r.removeTargetData(e,t))}di(){this.mi=new Set}Ai(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return se.forEach(this.gi,r=>{const o=We.fromPath(r);return this.pi(e,o).next(a=>{a||t.removeEntry(o,st.min())})}).next(()=>(this.mi=null,t.apply(e)))}updateLimboDocument(e,t){return this.pi(e,t).next(r=>{r?this.gi.delete(t.toString()):this.gi.add(t.toString())})}Ii(e){return 0}pi(e,t){return se.or([()=>se.resolve(this.Vi.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ri(e,t)])}}class Hp{constructor(e,t){this.persistence=e,this.yi=new jo(r=>ir(r.path),(r,o)=>r.isEqual(o)),this.garbageCollector=w_(this,t)}static fi(e,t){return new Hp(e,t)}di(){}Ai(e){return se.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}pr(e){const t=this.br(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>t.next(o=>r+o))}br(e){let t=0;return this.yr(e,r=>{t++}).next(()=>t)}yr(e,t){return se.forEach(this.yi,(r,o)=>this.Dr(e,r,o).next(a=>a?se.resolve():t(o)))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0;const o=this.persistence.getRemoteDocumentCache(),a=o.newChangeBuffer();return o.si(e,c=>this.Dr(e,c,t).next(d=>{d||(r++,a.removeEntry(c,st.min()))})).next(()=>a.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,t){return this.yi.set(t,e.currentSequenceNumber),se.resolve()}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.yi.set(r,e.currentSequenceNumber),se.resolve()}removeReference(e,t,r){return this.yi.set(r,e.currentSequenceNumber),se.resolve()}updateLimboDocument(e,t){return this.yi.set(t,e.currentSequenceNumber),se.resolve()}Ii(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=bp(e.data.value)),t}Dr(e,t,r){return se.or([()=>this.persistence.Ri(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const o=this.yi.get(t);return se.resolve(o!==void 0&&o>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w5{constructor(e){this.serializer=e}q(e,t,r,o){const a=new bf("createOrUpgrade",t);r<1&&o>=1&&(function(h){h.createObjectStore(fd)}(e),function(h){h.createObjectStore(Xu,{keyPath:LA}),h.createObjectStore(pi,{keyPath:Ew,autoIncrement:!0}).createIndex(ma,Aw,{unique:!0}),h.createObjectStore(Zl)}(e),v1(e),function(h){h.createObjectStore(ua)}(e));let c=se.resolve();return r<3&&o>=3&&(r!==0&&(function(h){h.deleteObjectStore(tc),h.deleteObjectStore(ec),h.deleteObjectStore(wa)}(e),v1(e)),c=c.next(()=>function(h){const m=h.store(wa),g={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:st.min().toTimestamp(),targetCount:0};return m.put(Np,g)}(a))),r<4&&o>=4&&(r!==0&&(c=c.next(()=>function(h,m){return m.store(pi).J().next(x=>{h.deleteObjectStore(pi),h.createObjectStore(pi,{keyPath:Ew,autoIncrement:!0}).createIndex(ma,Aw,{unique:!0});const S=m.store(pi),C=x.map(_=>S.put(_));return se.waitFor(C)})}(e,a))),c=c.next(()=>{(function(h){h.createObjectStore(nc,{keyPath:KA})})(e)})),r<5&&o>=5&&(c=c.next(()=>this.wi(a))),r<6&&o>=6&&(c=c.next(()=>(function(h){h.createObjectStore(Ju)}(e),this.bi(a)))),r<7&&o>=7&&(c=c.next(()=>this.Si(a))),r<8&&o>=8&&(c=c.next(()=>this.Di(e,a))),r<9&&o>=9&&(c=c.next(()=>{(function(h){h.objectStoreNames.contains("remoteDocumentChanges")&&h.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&o>=10&&(c=c.next(()=>this.Ci(a))),r<11&&o>=11&&(c=c.next(()=>{(function(h){h.createObjectStore(vf,{keyPath:QA})})(e),function(h){h.createObjectStore(wf,{keyPath:YA})}(e)})),r<12&&o>=12&&(c=c.next(()=>{(function(h){const m=h.createObjectStore(Sf,{keyPath:r6});m.createIndex(ky,i6,{unique:!1}),m.createIndex(lT,o6,{unique:!1})})(e)})),r<13&&o>=13&&(c=c.next(()=>function(h){const m=h.createObjectStore(Dp,{keyPath:WA});m.createIndex(yp,VA),m.createIndex(iT,UA)}(e)).next(()=>this.Fi(e,a)).next(()=>e.deleteObjectStore(ua))),r<14&&o>=14&&(c=c.next(()=>this.Mi(e,a))),r<15&&o>=15&&(c=c.next(()=>function(h){h.createObjectStore(xx,{keyPath:XA,autoIncrement:!0}).createIndex(Sy,JA,{unique:!1}),h.createObjectStore(Mu,{keyPath:ZA}).createIndex(sT,e6,{unique:!1}),h.createObjectStore(Lu,{keyPath:t6}).createIndex(aT,n6,{unique:!1})}(e))),r<16&&o>=16&&(c=c.next(()=>{t.objectStore(Mu).clear()}).next(()=>{t.objectStore(Lu).clear()})),r<17&&o>=17&&(c=c.next(()=>{(function(h){h.createObjectStore(bx,{keyPath:s6})})(e)})),r<18&&o>=18&&Fk()&&(c=c.next(()=>{t.objectStore(Mu).clear()}).next(()=>{t.objectStore(Lu).clear()})),c}bi(e){let t=0;return e.store(ua).te((r,o)=>{t+=qp(o)}).next(()=>{const r={byteSize:t};return e.store(Ju).put(wy,r)})}wi(e){const t=e.store(Xu),r=e.store(pi);return t.J().next(o=>se.forEach(o,a=>{const c=IDBKeyRange.bound([a.userId,gs],[a.userId,a.lastAcknowledgedBatchId]);return r.J(ma,c).next(d=>se.forEach(d,h=>{tt(h.userId===a.userId,18650,"Cannot process batch from unexpected user",{batchId:h.batchId});const m=ha(this.serializer,h);return g_(e,a.userId,m).next(()=>{})}))}))}Si(e){const t=e.store(tc),r=e.store(ua);return e.store(wa).get(Np).next(o=>{const a=[];return r.te((c,d)=>{const h=new It(c),m=function(x){return[0,ir(x)]}(h);a.push(t.get(m).next(g=>g?se.resolve():(x=>t.put({targetId:0,path:ir(x),sequenceNumber:o.highestListenSequenceNumber}))(h)))}).next(()=>se.waitFor(a))})}Di(e,t){e.createObjectStore(Zu,{keyPath:GA});const r=t.store(Zu),o=new zx,a=c=>{if(o.add(c)){const d=c.lastSegment(),h=c.popLast();return r.put({collectionId:d,parent:ir(h)})}};return t.store(ua).te({ee:!0},(c,d)=>{const h=new It(c);return a(h.popLast())}).next(()=>t.store(Zl).te({ee:!0},([c,d,h],m)=>{const g=zi(d);return a(g.popLast())}))}Ci(e){const t=e.store(ec);return t.te((r,o)=>{const a=Bu(o),c=h_(this.serializer,a);return t.put(c)})}Fi(e,t){const r=t.store(ua),o=[];return r.te((a,c)=>{const d=t.store(Dp),h=function(x){return x.document?new We(It.fromString(x.document.name).popFirst(5)):x.noDocument?We.fromSegments(x.noDocument.path):x.unknownDocument?We.fromSegments(x.unknownDocument.path):Ke(36783)}(c).path.toArray(),m={prefixPath:h.slice(0,h.length-2),collectionGroup:h[h.length-2],documentId:h[h.length-1],readTime:c.readTime||[0,0],unknownDocument:c.unknownDocument,noDocument:c.noDocument,document:c.document,hasCommittedMutations:!!c.hasCommittedMutations};o.push(d.put(m))}).next(()=>se.waitFor(o))}Mi(e,t){const r=t.store(pi),o=k_(this.serializer),a=new Nx(Af.fi,this.serializer.wt);return r.J().next(c=>{const d=new Map;return c.forEach(h=>{var m;let g=(m=d.get(h.userId))!==null&&m!==void 0?m:wt();ha(this.serializer,h).keys().forEach(x=>g=g.add(x)),d.set(h.userId,g)}),se.forEach(d,(h,m)=>{const g=new Wn(m),x=Rf.bt(this.serializer,g),S=a.getIndexManager(g),C=Ef.bt(g,this.serializer,S,a.referenceDelegate);return new T_(o,C,x,S).recalculateAndSaveOverlaysForDocumentKeys(new Ty(t,Tr.le),h).next()})})}}function v1(n){n.createObjectStore(tc,{keyPath:HA}).createIndex(yx,$A,{unique:!0}),n.createObjectStore(ec,{keyPath:"targetId"}).createIndex(oT,qA,{unique:!0}),n.createObjectStore(wa)}const is="IndexedDbPersistence",Og=18e5,Wg=5e3,Vg="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",__="main";class Mx{constructor(e,t,r,o,a,c,d,h,m,g,x=18){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.xi=a,this.window=c,this.document=d,this.Oi=m,this.Ni=g,this.Bi=x,this.li=null,this.hi=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Li=null,this.inForeground=!1,this.ki=null,this.qi=null,this.Qi=Number.NEGATIVE_INFINITY,this.$i=S=>Promise.resolve(),!Mx.C())throw new je(ye.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new c5(this,o),this.Ui=t+__,this.serializer=new d_(h),this.Ki=new Li(this.Ui,this.Bi,new w5(this.serializer)),this.Pi=new J6,this.Ti=new s5(this.referenceDelegate,this.serializer),this.remoteDocumentCache=k_(this.serializer),this.Ei=new X6,this.window&&this.window.localStorage?this.Wi=this.window.localStorage:(this.Wi=null,g===!1&&bn(is,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Gi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new je(ye.FAILED_PRECONDITION,Vg);return this.zi(),this.ji(),this.Hi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Ti.getHighestSequenceNumber(e))}).then(e=>{this.li=new Tr(e,this.Oi)}).then(()=>{this.hi=!0}).catch(e=>(this.Ki&&this.Ki.close(),Promise.reject(e)))}Ji(e){return this.$i=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ki.U(async t=>{t.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.xi.enqueueAndForget(async()=>{this.started&&await this.Gi()}))}Gi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>sp(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.Yi(e).next(t=>{t||(this.isPrimary=!1,this.xi.enqueueRetryable(()=>this.$i(!1)))})}).next(()=>this.Zi(e)).next(t=>this.isPrimary&&!t?this.Xi(e).next(()=>!1):!!t&&this.es(e).next(()=>!0))).catch(e=>{if(Es(e))return Ie(is,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return Ie(is,"Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.xi.enqueueRetryable(()=>this.$i(e)),this.isPrimary=e})}Yi(e){return ku(e).get(Il).next(t=>se.resolve(this.ts(t)))}ns(e){return sp(e).delete(this.clientId)}async rs(){if(this.isPrimary&&!this.ss(this.Qi,Og)){this.Qi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",t=>{const r=Fn(t,nc);return r.J().next(o=>{const a=this._s(o,Og),c=o.filter(d=>a.indexOf(d)===-1);return se.forEach(c,d=>r.delete(d.clientId)).next(()=>c)})}).catch(()=>[]);if(this.Wi)for(const t of e)this.Wi.removeItem(this.us(t.clientId))}}Hi(){this.qi=this.xi.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.Gi().then(()=>this.rs()).then(()=>this.Hi()))}ts(e){return!!e&&e.ownerId===this.clientId}Zi(e){return this.Ni?se.resolve(!0):ku(e).get(Il).next(t=>{if(t!==null&&this.ss(t.leaseTimestampMs,Wg)&&!this.cs(t.ownerId)){if(this.ts(t)&&this.networkEnabled)return!0;if(!this.ts(t)){if(!t.allowTabSynchronization)throw new je(ye.FAILED_PRECONDITION,Vg);return!1}}return!(!this.networkEnabled||!this.inForeground)||sp(e).J().next(r=>this._s(r,Wg).find(o=>{if(this.clientId!==o.clientId){const a=!this.networkEnabled&&o.networkEnabled,c=!this.inForeground&&o.inForeground,d=this.networkEnabled===o.networkEnabled;if(a||c&&d)return!0}return!1})===void 0)}).next(t=>(this.isPrimary!==t&&Ie(is,`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}async shutdown(){this.hi=!1,this.ls(),this.qi&&(this.qi.cancel(),this.qi=null),this.hs(),this.Ps(),await this.Ki.runTransaction("shutdown","readwrite",[fd,nc],e=>{const t=new Ty(e,Tr.le);return this.Xi(t).next(()=>this.ns(t))}),this.Ki.close(),this.Ts()}_s(e,t){return e.filter(r=>this.ss(r.updateTimeMs,t)&&!this.cs(r.clientId))}Is(){return this.runTransaction("getActiveClients","readonly",e=>sp(e).J().next(t=>this._s(t,Og).map(r=>r.clientId)))}get started(){return this.hi}getGlobalsCache(){return this.Pi}getMutationQueue(e,t){return Ef.bt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Ti}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new o5(e,this.serializer.wt.databaseId)}getDocumentOverlayCache(e){return Rf.bt(this.serializer,e)}getBundleCache(){return this.Ei}runTransaction(e,t,r){Ie(is,"Starting transaction:",e);const o=t==="readonly"?"readonly":"readwrite",a=function(h){return h===18?c6:h===17?hT:h===16?l6:h===15?vx:h===14?dT:h===13?uT:h===12?a6:h===11?cT:void Ke(60245)}(this.Bi);let c;return this.Ki.runTransaction(e,o,a,d=>(c=new Ty(d,this.li?this.li.next():Tr.le),t==="readwrite-primary"?this.Yi(c).next(h=>!!h||this.Zi(c)).next(h=>{if(!h)throw bn(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.xi.enqueueRetryable(()=>this.$i(!1)),new je(ye.FAILED_PRECONDITION,Zk);return r(c)}).next(h=>this.es(c).next(()=>h)):this.Es(c).next(()=>r(c)))).then(d=>(c.raiseOnCommittedEvent(),d))}Es(e){return ku(e).get(Il).next(t=>{if(t!==null&&this.ss(t.leaseTimestampMs,Wg)&&!this.cs(t.ownerId)&&!this.ts(t)&&!(this.Ni||this.allowTabSynchronization&&t.allowTabSynchronization))throw new je(ye.FAILED_PRECONDITION,Vg)})}es(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return ku(e).put(Il,t)}static C(){return Li.C()}Xi(e){const t=ku(e);return t.get(Il).next(r=>this.ts(r)?(Ie(is,"Releasing primary lease."),t.delete(Il)):se.resolve())}ss(e,t){const r=Date.now();return!(e<r-t)&&(!(e>r)||(bn(`Detected an update time that is in the future: ${e} > ${r}`),!1))}zi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.ki=()=>{this.xi.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.Gi()))},this.document.addEventListener("visibilitychange",this.ki),this.inForeground=this.document.visibilityState==="visible")}hs(){this.ki&&(this.document.removeEventListener("visibilitychange",this.ki),this.ki=null)}ji(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.Li=()=>{this.ls();const t=/(?:Version|Mobile)\/1[456]/;Bk()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.xi.enterRestrictedMode(!0),this.xi.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Li))}Ps(){this.Li&&(this.window.removeEventListener("pagehide",this.Li),this.Li=null)}cs(e){var t;try{const r=((t=this.Wi)===null||t===void 0?void 0:t.getItem(this.us(e)))!==null;return Ie(is,`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return bn(is,"Failed to get zombied client id.",r),!1}}ls(){if(this.Wi)try{this.Wi.setItem(this.us(this.clientId),String(Date.now()))}catch(e){bn("Failed to set zombie client id.",e)}}Ts(){if(this.Wi)try{this.Wi.removeItem(this.us(this.clientId))}catch{}}us(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function ku(n){return Fn(n,fd)}function sp(n){return Fn(n,nc)}function Lx(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ox{constructor(e,t,r,o){this.targetId=e,this.fromCache=t,this.ds=r,this.As=o}static Rs(e,t){let r=wt(),o=wt();for(const a of t.docChanges)switch(a.type){case 0:r=r.add(a.doc.key);break;case 1:o=o.add(a.doc.key)}return new Ox(e,t.fromCache,r,o)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S5{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j_{constructor(){this.Vs=!1,this.fs=!1,this.gs=100,this.ps=function(){return Bk()?8:tT(Pn())>0?6:4}()}initialize(e,t){this.ys=e,this.indexManager=t,this.Vs=!0}getDocumentsMatchingQuery(e,t,r,o){const a={result:null};return this.ws(e,t).next(c=>{a.result=c}).next(()=>{if(!a.result)return this.bs(e,t,o,r).next(c=>{a.result=c})}).next(()=>{if(a.result)return;const c=new S5;return this.Ss(e,t,c).next(d=>{if(a.result=d,this.fs)return this.Ds(e,t,c,d.size)})}).next(()=>a.result)}Ds(e,t,r,o){return r.documentReadCount<this.gs?(Ml()<=jt.DEBUG&&Ie("QueryEngine","SDK will not create cache indexes for query:",Ll(t),"since it only creates cache indexes for collection contains","more than or equal to",this.gs,"documents"),se.resolve()):(Ml()<=jt.DEBUG&&Ie("QueryEngine","Query:",Ll(t),"scans",r.documentReadCount,"local documents and returns",o,"documents as results."),r.documentReadCount>this.ps*o?(Ml()<=jt.DEBUG&&Ie("QueryEngine","The SDK decides to create cache indexes for query:",Ll(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,or(t))):se.resolve())}ws(e,t){if(qw(t))return se.resolve(null);let r=or(t);return this.indexManager.getIndexType(e,r).next(o=>o===0?null:(t.limit!==null&&o===1&&(t=Op(t,null,"F"),r=or(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(a=>{const c=wt(...a);return this.ys.getDocuments(e,c).next(d=>this.indexManager.getMinOffset(e,r).next(h=>{const m=this.vs(t,d);return this.Cs(t,m,c,h.readTime)?this.ws(e,Op(t,null,"F")):this.Fs(e,m,t,h)}))})))}bs(e,t,r,o){return qw(t)||o.isEqual(st.min())?se.resolve(null):this.ys.getDocuments(e,r).next(a=>{const c=this.vs(t,a);return this.Cs(t,c,r,o)?se.resolve(null):(Ml()<=jt.DEBUG&&Ie("QueryEngine","Re-using previous result from %s to execute query: %s",o.toString(),Ll(t)),this.Fs(e,c,t,Xk(o,Yl)).next(d=>d))})}vs(e,t){let r=new Ut(DT(e));return t.forEach((o,a)=>{yd(e,a)&&(r=r.add(a))}),r}Cs(e,t,r,o){if(e.limit===null)return!1;if(r.size!==t.size)return!0;const a=e.limitType==="F"?t.last():t.first();return!!a&&(a.hasPendingWrites||a.version.compareTo(o)>0)}Ss(e,t,r){return Ml()<=jt.DEBUG&&Ie("QueryEngine","Using full collection scan to execute query:",Ll(t)),this.ys.getDocumentsMatchingQuery(e,t,Wr.min(),r)}Fs(e,t,r,o){return this.ys.getDocumentsMatchingQuery(e,r,o).next(a=>(t.forEach(c=>{a=a.insert(c.key,c)}),a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wx="LocalStore",k5=3e8;class T5{constructor(e,t,r,o){this.persistence=e,this.Ms=t,this.serializer=o,this.xs=new Xt(dt),this.Os=new jo(a=>Ia(a),md),this.Ns=new Map,this.Bs=e.getRemoteDocumentCache(),this.Ti=e.getTargetCache(),this.Ei=e.getBundleCache(),this.Ls(r)}Ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new T_(this.Bs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Bs.setIndexManager(this.indexManager),this.Ms.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.xs))}}function I_(n,e,t,r){return new T5(n,e,t,r)}async function C_(n,e){const t=Le(n);return await t.persistence.runTransaction("Handle user change","readonly",r=>{let o;return t.mutationQueue.getAllMutationBatches(r).next(a=>(o=a,t.Ls(e),t.mutationQueue.getAllMutationBatches(r))).next(a=>{const c=[],d=[];let h=wt();for(const m of o){c.push(m.batchId);for(const g of m.mutations)h=h.add(g.key)}for(const m of a){d.push(m.batchId);for(const g of m.mutations)h=h.add(g.key)}return t.localDocuments.getDocuments(r,h).next(m=>({ks:m,removedBatchIds:c,addedBatchIds:d}))})})}function _5(n,e){const t=Le(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const o=e.batch.keys(),a=t.Bs.newChangeBuffer({trackRemovals:!0});return function(d,h,m,g){const x=m.batch,S=x.keys();let C=se.resolve();return S.forEach(_=>{C=C.next(()=>g.getEntry(h,_)).next(I=>{const T=m.docVersions.get(_);tt(T!==null,48541),I.version.compareTo(T)<0&&(x.applyToRemoteDocument(I,m),I.isValidDocument()&&(I.setReadTime(m.commitVersion),g.addEntry(I)))})}),C.next(()=>d.mutationQueue.removeMutationBatch(h,x))}(t,r,e,a).next(()=>a.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,o,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(d){let h=wt();for(let m=0;m<d.mutationResults.length;++m)d.mutationResults[m].transformResults.length>0&&(h=h.add(d.batch.mutations[m].key));return h}(e))).next(()=>t.localDocuments.getDocuments(r,o))})}function R_(n){const e=Le(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Ti.getLastRemoteSnapshotVersion(t))}function j5(n,e){const t=Le(n),r=e.snapshotVersion;let o=t.xs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",a=>{const c=t.Bs.newChangeBuffer({trackRemovals:!0});o=t.xs;const d=[];e.targetChanges.forEach((g,x)=>{const S=o.get(x);if(!S)return;d.push(t.Ti.removeMatchingKeys(a,g.removedDocuments,x).next(()=>t.Ti.addMatchingKeys(a,g.addedDocuments,x)));let C=S.withSequenceNumber(a.currentSequenceNumber);e.targetMismatches.get(x)!==null?C=C.withResumeToken(fn.EMPTY_BYTE_STRING,st.min()).withLastLimboFreeSnapshotVersion(st.min()):g.resumeToken.approximateByteSize()>0&&(C=C.withResumeToken(g.resumeToken,r)),o=o.insert(x,C),function(I,T,F){return I.resumeToken.approximateByteSize()===0||T.snapshotVersion.toMicroseconds()-I.snapshotVersion.toMicroseconds()>=k5?!0:F.addedDocuments.size+F.modifiedDocuments.size+F.removedDocuments.size>0}(S,C,g)&&d.push(t.Ti.updateTargetData(a,C))});let h=jr(),m=wt();if(e.documentUpdates.forEach(g=>{e.resolvedLimboDocuments.has(g)&&d.push(t.persistence.referenceDelegate.updateLimboDocument(a,g))}),d.push(E_(a,c,e.documentUpdates).next(g=>{h=g.qs,m=g.Qs})),!r.isEqual(st.min())){const g=t.Ti.getLastRemoteSnapshotVersion(a).next(x=>t.Ti.setTargetsMetadata(a,a.currentSequenceNumber,r));d.push(g)}return se.waitFor(d).next(()=>c.apply(a)).next(()=>t.localDocuments.getLocalViewOfDocuments(a,h,m)).next(()=>h)}).then(a=>(t.xs=o,a))}function E_(n,e,t){let r=wt(),o=wt();return t.forEach(a=>r=r.add(a)),e.getEntries(n,r).next(a=>{let c=jr();return t.forEach((d,h)=>{const m=a.get(d);h.isFoundDocument()!==m.isFoundDocument()&&(o=o.add(d)),h.isNoDocument()&&h.version.isEqual(st.min())?(e.removeEntry(d,h.readTime),c=c.insert(d,h)):!m.isValidDocument()||h.version.compareTo(m.version)>0||h.version.compareTo(m.version)===0&&m.hasPendingWrites?(e.addEntry(h),c=c.insert(d,h)):Ie(Wx,"Ignoring outdated watch update for ",d,". Current version:",m.version," Watch version:",h.version)}),{qs:c,Qs:o}})}function I5(n,e){const t=Le(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=gs),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function cc(n,e){const t=Le(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let o;return t.Ti.getTargetData(r,e).next(a=>a?(o=a,se.resolve(o)):t.Ti.allocateTargetId(r).next(c=>(o=new mo(e,c,"TargetPurposeListen",r.currentSequenceNumber),t.Ti.addTargetData(r,o).next(()=>o))))}).then(r=>{const o=t.xs.get(r.targetId);return(o===null||r.snapshotVersion.compareTo(o.snapshotVersion)>0)&&(t.xs=t.xs.insert(r.targetId,r),t.Os.set(e,r.targetId)),r})}async function uc(n,e,t){const r=Le(n),o=r.xs.get(e),a=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",a,c=>r.persistence.referenceDelegate.removeTarget(c,o))}catch(c){if(!Es(c))throw c;Ie(Wx,`Failed to update sequence numbers for target ${e}: ${c}`)}r.xs=r.xs.remove(e),r.Os.delete(o.target)}function $p(n,e,t){const r=Le(n);let o=st.min(),a=wt();return r.persistence.runTransaction("Execute query","readwrite",c=>function(h,m,g){const x=Le(h),S=x.Os.get(g);return S!==void 0?se.resolve(x.xs.get(S)):x.Ti.getTargetData(m,g)}(r,c,or(e)).next(d=>{if(d)return o=d.lastLimboFreeSnapshotVersion,r.Ti.getMatchingKeysForTargetId(c,d.targetId).next(h=>{a=h})}).next(()=>r.Ms.getDocumentsMatchingQuery(c,e,t?o:st.min(),t?a:wt())).next(d=>(B_(r,zT(e),d),{documents:d,$s:a})))}function A_(n,e){const t=Le(n),r=Le(t.Ti),o=t.xs.get(e);return o?Promise.resolve(o.target):t.persistence.runTransaction("Get target data","readonly",a=>r.Rt(a,e).next(c=>c?c.target:null))}function P_(n,e){const t=Le(n),r=t.Ns.get(e)||st.min();return t.persistence.runTransaction("Get new document changes","readonly",o=>t.Bs.getAllFromCollectionGroup(o,e,Xk(r,Yl),Number.MAX_SAFE_INTEGER)).then(o=>(B_(t,e,o),o))}function B_(n,e,t){let r=n.Ns.get(e)||st.min();t.forEach((o,a)=>{a.readTime.compareTo(r)>0&&(r=a.readTime)}),n.Ns.set(e,r)}async function C5(n,e,t,r){const o=Le(n);let a=wt(),c=jr();for(const m of t){const g=e.Us(m.metadata.name);m.document&&(a=a.add(g));const x=e.Ks(m);x.setReadTime(e.Ws(m.metadata.readTime)),c=c.insert(g,x)}const d=o.Bs.newChangeBuffer({trackRemovals:!0}),h=await cc(o,function(g){return or(Sc(It.fromString(`__bundle__/docs/${g}`)))}(r));return o.persistence.runTransaction("Apply bundle documents","readwrite",m=>E_(m,d,c).next(g=>(d.apply(m),g)).next(g=>o.Ti.removeMatchingKeysForTargetId(m,h.targetId).next(()=>o.Ti.addMatchingKeys(m,a,h.targetId)).next(()=>o.localDocuments.getLocalViewOfDocuments(m,g.qs,g.Qs)).next(()=>g.qs)))}async function R5(n,e,t=wt()){const r=await cc(n,or(Bx(e.bundledQuery))),o=Le(n);return o.persistence.runTransaction("Save named query","readwrite",a=>{const c=vn(e.readTime);if(r.snapshotVersion.compareTo(c)>=0)return o.Ei.saveNamedQuery(a,e);const d=r.withResumeToken(fn.EMPTY_BYTE_STRING,c);return o.xs=o.xs.insert(d.targetId,d),o.Ti.updateTargetData(a,d).next(()=>o.Ti.removeMatchingKeysForTargetId(a,r.targetId)).next(()=>o.Ti.addMatchingKeys(a,t,r.targetId)).next(()=>o.Ei.saveNamedQuery(a,e))})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F_="firestore_clients";function w1(n,e){return`${F_}_${n}_${e}`}const z_="firestore_mutations";function S1(n,e,t){let r=`${z_}_${n}_${t}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}const D_="firestore_targets";function Ug(n,e){return`${D_}_${n}_${e}`}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bi="SharedClientState";class Gp{constructor(e,t,r,o){this.user=e,this.batchId=t,this.state=r,this.error=o}static Gs(e,t,r){const o=JSON.parse(r);let a,c=typeof o=="object"&&["pending","acknowledged","rejected"].indexOf(o.state)!==-1&&(o.error===void 0||typeof o.error=="object");return c&&o.error&&(c=typeof o.error.message=="string"&&typeof o.error.code=="string",c&&(a=new je(o.error.code,o.error.message))),c?new Gp(e,t,o.state,a):(bn(Bi,`Failed to parse mutation state for ID '${t}': ${r}`),null)}zs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Uu{constructor(e,t,r){this.targetId=e,this.state=t,this.error=r}static Gs(e,t){const r=JSON.parse(t);let o,a=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return a&&r.error&&(a=typeof r.error.message=="string"&&typeof r.error.code=="string",a&&(o=new je(r.error.code,r.error.message))),a?new Uu(e,r.state,o):(bn(Bi,`Failed to parse target state for ID '${e}': ${t}`),null)}zs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Kp{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Gs(e,t){const r=JSON.parse(t);let o=typeof r=="object"&&r.activeTargetIds instanceof Array,a=_x();for(let c=0;o&&c<r.activeTargetIds.length;++c)o=nT(r.activeTargetIds[c]),a=a.add(r.activeTargetIds[c]);return o?new Kp(e,a):(bn(Bi,`Failed to parse client data for instance '${e}': ${t}`),null)}}class Vx{constructor(e,t){this.clientId=e,this.onlineState=t}static Gs(e){const t=JSON.parse(e);return typeof t=="object"&&["Unknown","Online","Offline"].indexOf(t.onlineState)!==-1&&typeof t.clientId=="string"?new Vx(t.clientId,t.onlineState):(bn(Bi,`Failed to parse online state: ${e}`),null)}}class My{constructor(){this.activeTargetIds=_x()}js(e){this.activeTargetIds=this.activeTargetIds.add(e)}Hs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}zs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class qg{constructor(e,t,r,o,a){this.window=e,this.xi=t,this.persistenceKey=r,this.Js=o,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.Ys=this.Zs.bind(this),this.Xs=new Xt(dt),this.started=!1,this.eo=[];const c=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=a,this.no=w1(this.persistenceKey,this.Js),this.ro=function(h){return`firestore_sequence_number_${h}`}(this.persistenceKey),this.Xs=this.Xs.insert(this.Js,new My),this.io=new RegExp(`^${F_}_${c}_([^_]*)$`),this.so=new RegExp(`^${z_}_${c}_(\\d+)(?:_(.*))?$`),this.oo=new RegExp(`^${D_}_${c}_(\\d+)$`),this._o=function(h){return`firestore_online_state_${h}`}(this.persistenceKey),this.ao=function(h){return`firestore_bundle_loaded_v2_${h}`}(this.persistenceKey),this.window.addEventListener("storage",this.Ys)}static C(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.Is();for(const r of e){if(r===this.Js)continue;const o=this.getItem(w1(this.persistenceKey,r));if(o){const a=Kp.Gs(r,o);a&&(this.Xs=this.Xs.insert(a.clientId,a))}}this.uo();const t=this.storage.getItem(this._o);if(t){const r=this.co(t);r&&this.lo(r)}for(const r of this.eo)this.Zs(r);this.eo=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0}writeSequenceNumber(e){this.setItem(this.ro,JSON.stringify(e))}getAllActiveQueryTargets(){return this.ho(this.Xs)}isActiveQueryTarget(e){let t=!1;return this.Xs.forEach((r,o)=>{o.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this.Po(e,"pending")}updateMutationState(e,t,r){this.Po(e,t,r),this.To(e)}addLocalQueryTarget(e,t=!0){let r="not-current";if(this.isActiveQueryTarget(e)){const o=this.storage.getItem(Ug(this.persistenceKey,e));if(o){const a=Uu.Gs(e,o);a&&(r=a.state)}}return t&&this.Io.js(e),this.uo(),r}removeLocalQueryTarget(e){this.Io.Hs(e),this.uo()}isLocalQueryTarget(e){return this.Io.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(Ug(this.persistenceKey,e))}updateQueryState(e,t,r){this.Eo(e,t,r)}handleUserChange(e,t,r){t.forEach(o=>{this.To(o)}),this.currentUser=e,r.forEach(o=>{this.addPendingMutation(o)})}setOnlineState(e){this.Ao(e)}notifyBundleLoaded(e){this.Ro(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.Ys),this.removeItem(this.no),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return Ie(Bi,"READ",e,t),t}setItem(e,t){Ie(Bi,"SET",e,t),this.storage.setItem(e,t)}removeItem(e){Ie(Bi,"REMOVE",e),this.storage.removeItem(e)}Zs(e){const t=e;if(t.storageArea===this.storage){if(Ie(Bi,"EVENT",t.key,t.newValue),t.key===this.no)return void bn("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.xi.enqueueRetryable(async()=>{if(this.started){if(t.key!==null){if(this.io.test(t.key)){if(t.newValue==null){const r=this.Vo(t.key);return this.mo(r,null)}{const r=this.fo(t.key,t.newValue);if(r)return this.mo(r.clientId,r)}}else if(this.so.test(t.key)){if(t.newValue!==null){const r=this.po(t.key,t.newValue);if(r)return this.yo(r)}}else if(this.oo.test(t.key)){if(t.newValue!==null){const r=this.wo(t.key,t.newValue);if(r)return this.bo(r)}}else if(t.key===this._o){if(t.newValue!==null){const r=this.co(t.newValue);if(r)return this.lo(r)}}else if(t.key===this.ro){const r=function(a){let c=Tr.le;if(a!=null)try{const d=JSON.parse(a);tt(typeof d=="number",30636,{So:a}),c=d}catch(d){bn(Bi,"Failed to read sequence number from WebStorage",d)}return c}(t.newValue);r!==Tr.le&&this.sequenceNumberHandler(r)}else if(t.key===this.ao){const r=this.Do(t.newValue);await Promise.all(r.map(o=>this.syncEngine.vo(o)))}}}else this.eo.push(t)})}}get Io(){return this.Xs.get(this.Js)}uo(){this.setItem(this.no,this.Io.zs())}Po(e,t,r){const o=new Gp(this.currentUser,e,t,r),a=S1(this.persistenceKey,this.currentUser,e);this.setItem(a,o.zs())}To(e){const t=S1(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Ao(e){const t={clientId:this.Js,onlineState:e};this.storage.setItem(this._o,JSON.stringify(t))}Eo(e,t,r){const o=Ug(this.persistenceKey,e),a=new Uu(e,t,r);this.setItem(o,a.zs())}Ro(e){const t=JSON.stringify(Array.from(e));this.setItem(this.ao,t)}Vo(e){const t=this.io.exec(e);return t?t[1]:null}fo(e,t){const r=this.Vo(e);return Kp.Gs(r,t)}po(e,t){const r=this.so.exec(e),o=Number(r[1]),a=r[2]!==void 0?r[2]:null;return Gp.Gs(new Wn(a),o,t)}wo(e,t){const r=this.oo.exec(e),o=Number(r[1]);return Uu.Gs(o,t)}co(e){return Vx.Gs(e)}Do(e){return JSON.parse(e)}async yo(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.Co(e.batchId,e.state,e.error);Ie(Bi,`Ignoring mutation for non-active user ${e.user.uid}`)}bo(e){return this.syncEngine.Fo(e.targetId,e.state,e.error)}mo(e,t){const r=t?this.Xs.insert(e,t):this.Xs.remove(e),o=this.ho(this.Xs),a=this.ho(r),c=[],d=[];return a.forEach(h=>{o.has(h)||c.push(h)}),o.forEach(h=>{a.has(h)||d.push(h)}),this.syncEngine.Mo(c,d).then(()=>{this.Xs=r})}lo(e){this.Xs.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}ho(e){let t=_x();return e.forEach((r,o)=>{t=t.unionWith(o.activeTargetIds)}),t}}class N_{constructor(){this.xo=new My,this.Oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.xo.js(e),this.Oo[e]||"not-current"}updateQueryState(e,t,r){this.Oo[e]=t}removeLocalQueryTarget(e){this.xo.Hs(e)}isLocalQueryTarget(e){return this.xo.activeTargetIds.has(e)}clearQueryState(e){delete this.Oo[e]}getAllActiveQueryTargets(){return this.xo.activeTargetIds}isActiveQueryTarget(e){return this.xo.activeTargetIds.has(e)}start(){return this.xo=new My,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E5{No(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const k1="ConnectivityMonitor";class T1{constructor(){this.Bo=()=>this.Lo(),this.ko=()=>this.qo(),this.Qo=[],this.$o()}No(e){this.Qo.push(e)}shutdown(){window.removeEventListener("online",this.Bo),window.removeEventListener("offline",this.ko)}$o(){window.addEventListener("online",this.Bo),window.addEventListener("offline",this.ko)}Lo(){Ie(k1,"Network connectivity changed: AVAILABLE");for(const e of this.Qo)e(0)}qo(){Ie(k1,"Network connectivity changed: UNAVAILABLE");for(const e of this.Qo)e(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ap=null;function Ly(){return ap===null?ap=function(){return 268435456+Math.round(2147483648*Math.random())}():ap++,"0x"+ap.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hg="RestConnection",A5={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class P5{get Uo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),o=encodeURIComponent(this.databaseId.database);this.Ko=t+"://"+e.host,this.Wo=`projects/${r}/databases/${o}`,this.Go=this.databaseId.database===td?`project_id=${r}`:`project_id=${r}&database_id=${o}`}zo(e,t,r,o,a){const c=Ly(),d=this.jo(e,t.toUriEncodedString());Ie(Hg,`Sending RPC '${e}' ${c}:`,d,r);const h={"google-cloud-resource-prefix":this.Wo,"x-goog-request-params":this.Go};this.Ho(h,o,a);const{host:m}=new URL(d),g=To(m);return this.Jo(e,d,h,r,g).then(x=>(Ie(Hg,`Received RPC '${e}' ${c}: `,x),x),x=>{throw Or(Hg,`RPC '${e}' ${c} failed with error: `,x,"url: ",d,"request:",r),x})}Yo(e,t,r,o,a,c){return this.zo(e,t,r,o,a)}Ho(e,t,r){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+wc}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((o,a)=>e[a]=o),r&&r.headers.forEach((o,a)=>e[a]=o)}jo(e,t){const r=A5[e];return`${this.Ko}/v1/${t}:${r}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B5{constructor(e){this.Zo=e.Zo,this.Xo=e.Xo}e_(e){this.t_=e}n_(e){this.r_=e}i_(e){this.s_=e}onMessage(e){this.o_=e}close(){this.Xo()}send(e){this.Zo(e)}__(){this.t_()}a_(){this.r_()}u_(e){this.s_(e)}c_(e){this.o_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tr="WebChannelConnection";class F5 extends P5{constructor(e){super(e),this.l_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,r,o,a){const c=Ly();return new Promise((d,h)=>{const m=new Vk;m.setWithCredentials(!0),m.listenOnce(Uk.COMPLETE,()=>{try{switch(m.getLastErrorCode()){case mp.NO_ERROR:const x=m.getResponseJson();Ie(tr,`XHR for RPC '${e}' ${c} received:`,JSON.stringify(x)),d(x);break;case mp.TIMEOUT:Ie(tr,`RPC '${e}' ${c} timed out`),h(new je(ye.DEADLINE_EXCEEDED,"Request time out"));break;case mp.HTTP_ERROR:const S=m.getStatus();if(Ie(tr,`RPC '${e}' ${c} failed with status:`,S,"response text:",m.getResponseText()),S>0){let C=m.getResponseJson();Array.isArray(C)&&(C=C[0]);const _=C==null?void 0:C.error;if(_&&_.status&&_.message){const I=function(F){const P=F.toLowerCase().replace(/_/g,"-");return Object.values(ye).indexOf(P)>=0?P:ye.UNKNOWN}(_.status);h(new je(I,_.message))}else h(new je(ye.UNKNOWN,"Server responded with status "+m.getStatus()))}else h(new je(ye.UNAVAILABLE,"Connection failed."));break;default:Ke(9055,{h_:e,streamId:c,P_:m.getLastErrorCode(),T_:m.getLastError()})}}finally{Ie(tr,`RPC '${e}' ${c} completed.`)}});const g=JSON.stringify(o);Ie(tr,`RPC '${e}' ${c} sending request:`,o),m.send(t,"POST",g,r,15)})}I_(e,t,r){const o=Ly(),a=[this.Ko,"/","google.firestore.v1.Firestore","/",e,"/channel"],c=$k(),d=Hk(),h={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},m=this.longPollingOptions.timeoutSeconds;m!==void 0&&(h.longPollingTimeout=Math.round(1e3*m)),this.useFetchStreams&&(h.useFetchStreams=!0),this.Ho(h.initMessageHeaders,t,r),h.encodeInitMessageHeaders=!0;const g=a.join("");Ie(tr,`Creating RPC '${e}' stream ${o}: ${g}`,h);const x=c.createWebChannel(g,h);this.E_(x);let S=!1,C=!1;const _=new B5({Zo:T=>{C?Ie(tr,`Not sending because RPC '${e}' stream ${o} is closed:`,T):(S||(Ie(tr,`Opening RPC '${e}' stream ${o} transport.`),x.open(),S=!0),Ie(tr,`RPC '${e}' stream ${o} sending:`,T),x.send(T))},Xo:()=>x.close()}),I=(T,F,P)=>{T.listen(F,B=>{try{P(B)}catch(q){setTimeout(()=>{throw q},0)}})};return I(x,Eu.EventType.OPEN,()=>{C||(Ie(tr,`RPC '${e}' stream ${o} transport opened.`),_.__())}),I(x,Eu.EventType.CLOSE,()=>{C||(C=!0,Ie(tr,`RPC '${e}' stream ${o} transport closed`),_.u_(),this.d_(x))}),I(x,Eu.EventType.ERROR,T=>{C||(C=!0,Or(tr,`RPC '${e}' stream ${o} transport errored. Name:`,T.name,"Message:",T.message),_.u_(new je(ye.UNAVAILABLE,"The operation could not be completed")))}),I(x,Eu.EventType.MESSAGE,T=>{var F;if(!C){const P=T.data[0];tt(!!P,16349);const B=P,q=(B==null?void 0:B.error)||((F=B[0])===null||F===void 0?void 0:F.error);if(q){Ie(tr,`RPC '${e}' stream ${o} received error:`,q);const te=q.status;let W=function(A){const N=Tn[A];if(N!==void 0)return YT(N)}(te),L=q.message;W===void 0&&(W=ye.INTERNAL,L="Unknown error status: "+te+" with message "+q.message),C=!0,_.u_(new je(W,L)),x.close()}else Ie(tr,`RPC '${e}' stream ${o} received:`,P),_.c_(P)}}),I(d,qk.STAT_EVENT,T=>{T.stat===gy.PROXY?Ie(tr,`RPC '${e}' stream ${o} detected buffering proxy`):T.stat===gy.NOPROXY&&Ie(tr,`RPC '${e}' stream ${o} detected no buffering proxy`)}),setTimeout(()=>{_.a_()},0),_}terminate(){this.l_.forEach(e=>e.close()),this.l_=[]}E_(e){this.l_.push(e)}d_(e){this.l_=this.l_.filter(t=>t===e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function M_(){return typeof window<"u"?window:null}function Tp(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wd(n){return new O6(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ux{constructor(e,t,r=1e3,o=1.5,a=6e4){this.xi=e,this.timerId=t,this.A_=r,this.R_=o,this.V_=a,this.m_=0,this.f_=null,this.g_=Date.now(),this.reset()}reset(){this.m_=0}p_(){this.m_=this.V_}y_(e){this.cancel();const t=Math.floor(this.m_+this.w_()),r=Math.max(0,Date.now()-this.g_),o=Math.max(0,t-r);o>0&&Ie("ExponentialBackoff",`Backing off for ${o} ms (base delay: ${this.m_} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.f_=this.xi.enqueueAfterDelay(this.timerId,o,()=>(this.g_=Date.now(),e())),this.m_*=this.R_,this.m_<this.A_&&(this.m_=this.A_),this.m_>this.V_&&(this.m_=this.V_)}b_(){this.f_!==null&&(this.f_.skipDelay(),this.f_=null)}cancel(){this.f_!==null&&(this.f_.cancel(),this.f_=null)}w_(){return(Math.random()-.5)*this.m_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _1="PersistentStream";class L_{constructor(e,t,r,o,a,c,d,h){this.xi=e,this.S_=r,this.D_=o,this.connection=a,this.authCredentialsProvider=c,this.appCheckCredentialsProvider=d,this.listener=h,this.state=0,this.v_=0,this.C_=null,this.F_=null,this.stream=null,this.M_=0,this.x_=new Ux(e,t)}O_(){return this.state===1||this.state===5||this.N_()}N_(){return this.state===2||this.state===3}start(){this.M_=0,this.state!==4?this.auth():this.B_()}async stop(){this.O_()&&await this.close(0)}L_(){this.state=0,this.x_.reset()}k_(){this.N_()&&this.C_===null&&(this.C_=this.xi.enqueueAfterDelay(this.S_,6e4,()=>this.q_()))}Q_(e){this.U_(),this.stream.send(e)}async q_(){if(this.N_())return this.close(0)}U_(){this.C_&&(this.C_.cancel(),this.C_=null)}K_(){this.F_&&(this.F_.cancel(),this.F_=null)}async close(e,t){this.U_(),this.K_(),this.x_.cancel(),this.v_++,e!==4?this.x_.reset():t&&t.code===ye.RESOURCE_EXHAUSTED?(bn(t.toString()),bn("Using maximum backoff delay to prevent overloading the backend."),this.x_.p_()):t&&t.code===ye.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.i_(t)}W_(){}auth(){this.state=1;const e=this.G_(this.v_),t=this.v_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,o])=>{this.v_===t&&this.z_(r,o)},r=>{e(()=>{const o=new je(ye.UNKNOWN,"Fetching auth token failed: "+r.message);return this.j_(o)})})}z_(e,t){const r=this.G_(this.v_);this.stream=this.H_(e,t),this.stream.e_(()=>{r(()=>this.listener.e_())}),this.stream.n_(()=>{r(()=>(this.state=2,this.F_=this.xi.enqueueAfterDelay(this.D_,1e4,()=>(this.N_()&&(this.state=3),Promise.resolve())),this.listener.n_()))}),this.stream.i_(o=>{r(()=>this.j_(o))}),this.stream.onMessage(o=>{r(()=>++this.M_==1?this.J_(o):this.onNext(o))})}B_(){this.state=5,this.x_.y_(async()=>{this.state=0,this.start()})}j_(e){return Ie(_1,`close with error: ${e}`),this.stream=null,this.close(4,e)}G_(e){return t=>{this.xi.enqueueAndForget(()=>this.v_===e?t():(Ie(_1,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class z5 extends L_{constructor(e,t,r,o,a,c){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,o,c),this.serializer=a}H_(e,t){return this.connection.I_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.x_.reset();const t=U6(this.serializer,e),r=function(a){if(!("targetChange"in a))return st.min();const c=a.targetChange;return c.targetIds&&c.targetIds.length?st.min():c.readTime?vn(c.readTime):st.min()}(e);return this.listener.Y_(t,r)}Z_(e){const t={};t.database=By(this.serializer),t.addTarget=function(a,c){let d;const h=c.target;if(d=Mp(h)?{documents:o_(a,h)}:{query:Cf(a,h).gt},d.targetId=c.targetId,c.resumeToken.approximateByteSize()>0){d.resumeToken=ZT(a,c.resumeToken);const m=Ay(a,c.expectedCount);m!==null&&(d.expectedCount=m)}else if(c.snapshotVersion.compareTo(st.min())>0){d.readTime=lc(a,c.snapshotVersion.toTimestamp());const m=Ay(a,c.expectedCount);m!==null&&(d.expectedCount=m)}return d}(this.serializer,e);const r=H6(this.serializer,e);r&&(t.labels=r),this.Q_(t)}X_(e){const t={};t.database=By(this.serializer),t.removeTarget=e,this.Q_(t)}}class D5 extends L_{constructor(e,t,r,o,a,c){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,o,c),this.serializer=a}get ea(){return this.M_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.ea&&this.ta([])}H_(e,t){return this.connection.I_("Write",e,t)}J_(e){return tt(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,tt(!e.writeResults||e.writeResults.length===0,55816),this.listener.na()}onNext(e){tt(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.x_.reset();const t=q6(e.writeResults,e.commitTime),r=vn(e.commitTime);return this.listener.ra(r,t)}ia(){const e={};e.database=By(this.serializer),this.Q_(e)}ta(e){const t={streamToken:this.lastStreamToken,writes:e.map(r=>sd(this.serializer,r))};this.Q_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N5{}class M5 extends N5{constructor(e,t,r,o){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=o,this.sa=!1}oa(){if(this.sa)throw new je(ye.FAILED_PRECONDITION,"The client has already been terminated.")}zo(e,t,r,o){return this.oa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,c])=>this.connection.zo(e,Py(t,r),o,a,c)).catch(a=>{throw a.name==="FirebaseError"?(a.code===ye.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new je(ye.UNKNOWN,a.toString())})}Yo(e,t,r,o,a){return this.oa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([c,d])=>this.connection.Yo(e,Py(t,r),o,c,d,a)).catch(c=>{throw c.name==="FirebaseError"?(c.code===ye.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),c):new je(ye.UNKNOWN,c.toString())})}terminate(){this.sa=!0,this.connection.terminate()}}class L5{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this._a=0,this.aa=null,this.ua=!0}ca(){this._a===0&&(this.la("Unknown"),this.aa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.aa=null,this.ha("Backend didn't respond within 10 seconds."),this.la("Offline"),Promise.resolve())))}Pa(e){this.state==="Online"?this.la("Unknown"):(this._a++,this._a>=1&&(this.Ta(),this.ha(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.la("Offline")))}set(e){this.Ta(),this._a=0,e==="Online"&&(this.ua=!1),this.la(e)}la(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ha(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.ua?(bn(t),this.ua=!1):Ie("OnlineStateTracker",t)}Ta(){this.aa!==null&&(this.aa.cancel(),this.aa=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ba="RemoteStore";class O5{constructor(e,t,r,o,a){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.Ia=[],this.Ea=new Map,this.da=new Set,this.Aa=[],this.Ra=a,this.Ra.No(c=>{r.enqueueAndForget(async()=>{Ps(this)&&(Ie(Ba,"Restarting streams for network reachability change."),await async function(h){const m=Le(h);m.da.add(4),await _c(m),m.Va.set("Unknown"),m.da.delete(4),await Sd(m)}(this))})}),this.Va=new L5(r,o)}}async function Sd(n){if(Ps(n))for(const e of n.Aa)await e(!0)}async function _c(n){for(const e of n.Aa)await e(!1)}function Pf(n,e){const t=Le(n);t.Ea.has(e.targetId)||(t.Ea.set(e.targetId,e),$x(t)?Hx(t):Ic(t).N_()&&qx(t,e))}function dc(n,e){const t=Le(n),r=Ic(t);t.Ea.delete(e),r.N_()&&O_(t,e),t.Ea.size===0&&(r.N_()?r.k_():Ps(t)&&t.Va.set("Unknown"))}function qx(n,e){if(n.ma.Ke(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(st.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Ic(n).Z_(e)}function O_(n,e){n.ma.Ke(e),Ic(n).X_(e)}function Hx(n){n.ma=new D6({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),Rt:e=>n.Ea.get(e)||null,Pt:()=>n.datastore.serializer.databaseId}),Ic(n).start(),n.Va.ca()}function $x(n){return Ps(n)&&!Ic(n).O_()&&n.Ea.size>0}function Ps(n){return Le(n).da.size===0}function W_(n){n.ma=void 0}async function W5(n){n.Va.set("Online")}async function V5(n){n.Ea.forEach((e,t)=>{qx(n,e)})}async function U5(n,e){W_(n),$x(n)?(n.Va.Pa(e),Hx(n)):n.Va.set("Unknown")}async function q5(n,e,t){if(n.Va.set("Online"),e instanceof JT&&e.state===2&&e.cause)try{await async function(o,a){const c=a.cause;for(const d of a.targetIds)o.Ea.has(d)&&(await o.remoteSyncer.rejectListen(d,c),o.Ea.delete(d),o.ma.removeTarget(d))}(n,e)}catch(r){Ie(Ba,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Qp(n,r)}else if(e instanceof Sp?n.ma.Xe(e):e instanceof XT?n.ma.ot(e):n.ma.nt(e),!t.isEqual(st.min()))try{const r=await R_(n.localStore);t.compareTo(r)>=0&&await function(a,c){const d=a.ma.It(c);return d.targetChanges.forEach((h,m)=>{if(h.resumeToken.approximateByteSize()>0){const g=a.Ea.get(m);g&&a.Ea.set(m,g.withResumeToken(h.resumeToken,c))}}),d.targetMismatches.forEach((h,m)=>{const g=a.Ea.get(h);if(!g)return;a.Ea.set(h,g.withResumeToken(fn.EMPTY_BYTE_STRING,g.snapshotVersion)),O_(a,h);const x=new mo(g.target,h,m,g.sequenceNumber);qx(a,x)}),a.remoteSyncer.applyRemoteEvent(d)}(n,t)}catch(r){Ie(Ba,"Failed to raise snapshot:",r),await Qp(n,r)}}async function Qp(n,e,t){if(!Es(e))throw e;n.da.add(1),await _c(n),n.Va.set("Offline"),t||(t=()=>R_(n.localStore)),n.asyncQueue.enqueueRetryable(async()=>{Ie(Ba,"Retrying IndexedDB access"),await t(),n.da.delete(1),await Sd(n)})}function V_(n,e){return e().catch(t=>Qp(n,t,e))}async function jc(n){const e=Le(n),t=Ts(e);let r=e.Ia.length>0?e.Ia[e.Ia.length-1].batchId:gs;for(;H5(e);)try{const o=await I5(e.localStore,r);if(o===null){e.Ia.length===0&&t.k_();break}r=o.batchId,$5(e,o)}catch(o){await Qp(e,o)}U_(e)&&q_(e)}function H5(n){return Ps(n)&&n.Ia.length<10}function $5(n,e){n.Ia.push(e);const t=Ts(n);t.N_()&&t.ea&&t.ta(e.mutations)}function U_(n){return Ps(n)&&!Ts(n).O_()&&n.Ia.length>0}function q_(n){Ts(n).start()}async function G5(n){Ts(n).ia()}async function K5(n){const e=Ts(n);for(const t of n.Ia)e.ta(t.mutations)}async function Q5(n,e,t){const r=n.Ia.shift(),o=Rx.from(r,e,t);await V_(n,()=>n.remoteSyncer.applySuccessfulWrite(o)),await jc(n)}async function Y5(n,e){e&&Ts(n).ea&&await async function(r,o){if(function(c){return QT(c)&&c!==ye.ABORTED}(o.code)){const a=r.Ia.shift();Ts(r).L_(),await V_(r,()=>r.remoteSyncer.rejectFailedWrite(a.batchId,o)),await jc(r)}}(n,e),U_(n)&&q_(n)}async function j1(n,e){const t=Le(n);t.asyncQueue.verifyOperationInProgress(),Ie(Ba,"RemoteStore received new credentials");const r=Ps(t);t.da.add(3),await _c(t),r&&t.Va.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.da.delete(3),await Sd(t)}async function Oy(n,e){const t=Le(n);e?(t.da.delete(2),await Sd(t)):e||(t.da.add(2),await _c(t),t.Va.set("Unknown"))}function Ic(n){return n.fa||(n.fa=function(t,r,o){const a=Le(t);return a.oa(),new z5(r,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,o)}(n.datastore,n.asyncQueue,{e_:W5.bind(null,n),n_:V5.bind(null,n),i_:U5.bind(null,n),Y_:q5.bind(null,n)}),n.Aa.push(async e=>{e?(n.fa.L_(),$x(n)?Hx(n):n.Va.set("Unknown")):(await n.fa.stop(),W_(n))})),n.fa}function Ts(n){return n.ga||(n.ga=function(t,r,o){const a=Le(t);return a.oa(),new D5(r,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,o)}(n.datastore,n.asyncQueue,{e_:()=>Promise.resolve(),n_:G5.bind(null,n),i_:Y5.bind(null,n),na:K5.bind(null,n),ra:Q5.bind(null,n)}),n.Aa.push(async e=>{e?(n.ga.L_(),await jc(n)):(await n.ga.stop(),n.Ia.length>0&&(Ie(Ba,`Stopping write stream with ${n.Ia.length} pending writes`),n.Ia=[]))})),n.ga}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gx{constructor(e,t,r,o,a){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=o,this.removalCallback=a,this.deferred=new Un,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(c=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,o,a){const c=Date.now()+r,d=new Gx(e,t,c,o,a);return d.start(r),d}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new je(ye.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Cc(n,e){if(bn("AsyncQueue",`${e}: ${n}`),Es(n))return new je(ye.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ql{static emptySet(e){return new ql(e.comparator)}constructor(e){this.comparator=e?(t,r)=>e(t,r)||We.comparator(t.key,r.key):(t,r)=>We.comparator(t.key,r.key),this.keyedMap=Au(),this.sortedSet=new Xt(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof ql)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const o=t.getNext().key,a=r.getNext().key;if(!o.isEqual(a))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const r=new ql;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I1{constructor(){this.pa=new Xt(We.comparator)}track(e){const t=e.doc.key,r=this.pa.get(t);r?e.type!==0&&r.type===3?this.pa=this.pa.insert(t,e):e.type===3&&r.type!==1?this.pa=this.pa.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.pa=this.pa.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.pa=this.pa.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.pa=this.pa.remove(t):e.type===1&&r.type===2?this.pa=this.pa.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.pa=this.pa.insert(t,{type:2,doc:e.doc}):Ke(63341,{Vt:e,ya:r}):this.pa=this.pa.insert(t,e)}wa(){const e=[];return this.pa.inorderTraversal((t,r)=>{e.push(r)}),e}}class hc{constructor(e,t,r,o,a,c,d,h,m){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=o,this.mutatedKeys=a,this.fromCache=c,this.syncStateChanged=d,this.excludesMetadataChanges=h,this.hasCachedResults=m}static fromInitialDocuments(e,t,r,o,a){const c=[];return t.forEach(d=>{c.push({type:0,doc:d})}),new hc(e,t,ql.emptySet(t),c,r,o,!0,!1,a)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&gd(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let o=0;o<t.length;o++)if(t[o].type!==r[o].type||!t[o].doc.isEqual(r[o].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X5{constructor(){this.ba=void 0,this.Sa=[]}Da(){return this.Sa.some(e=>e.va())}}class J5{constructor(){this.queries=C1(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,r){const o=Le(t),a=o.queries;o.queries=C1(),a.forEach((c,d)=>{for(const h of d.Sa)h.onError(r)})})(this,new je(ye.ABORTED,"Firestore shutting down"))}}function C1(){return new jo(n=>FT(n),gd)}async function Kx(n,e){const t=Le(n);let r=3;const o=e.query;let a=t.queries.get(o);a?!a.Da()&&e.va()&&(r=2):(a=new X5,r=e.va()?0:1);try{switch(r){case 0:a.ba=await t.onListen(o,!0);break;case 1:a.ba=await t.onListen(o,!1);break;case 2:await t.onFirstRemoteStoreListen(o)}}catch(c){const d=Cc(c,`Initialization of query '${Ll(e.query)}' failed`);return void e.onError(d)}t.queries.set(o,a),a.Sa.push(e),e.Fa(t.onlineState),a.ba&&e.Ma(a.ba)&&Yx(t)}async function Qx(n,e){const t=Le(n),r=e.query;let o=3;const a=t.queries.get(r);if(a){const c=a.Sa.indexOf(e);c>=0&&(a.Sa.splice(c,1),a.Sa.length===0?o=e.va()?0:1:!a.Da()&&e.va()&&(o=2))}switch(o){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}}function Z5(n,e){const t=Le(n);let r=!1;for(const o of e){const a=o.query,c=t.queries.get(a);if(c){for(const d of c.Sa)d.Ma(o)&&(r=!0);c.ba=o}}r&&Yx(t)}function eP(n,e,t){const r=Le(n),o=r.queries.get(e);if(o)for(const a of o.Sa)a.onError(t);r.queries.delete(e)}function Yx(n){n.Ca.forEach(e=>{e.next()})}var Wy,R1;(R1=Wy||(Wy={})).xa="default",R1.Cache="cache";class Xx{constructor(e,t,r){this.query=e,this.Oa=t,this.Na=!1,this.Ba=null,this.onlineState="Unknown",this.options=r||{}}Ma(e){if(!this.options.includeMetadataChanges){const r=[];for(const o of e.docChanges)o.type!==3&&r.push(o);e=new hc(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Na?this.La(e)&&(this.Oa.next(e),t=!0):this.ka(e,this.onlineState)&&(this.qa(e),t=!0),this.Ba=e,t}onError(e){this.Oa.error(e)}Fa(e){this.onlineState=e;let t=!1;return this.Ba&&!this.Na&&this.ka(this.Ba,e)&&(this.qa(this.Ba),t=!0),t}ka(e,t){if(!e.fromCache||!this.va())return!0;const r=t!=="Offline";return(!this.options.Qa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}La(e){if(e.docChanges.length>0)return!0;const t=this.Ba&&this.Ba.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}qa(e){e=hc.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Na=!0,this.Oa.next(e)}va(){return this.options.source!==Wy.Cache}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tP{constructor(e,t){this.$a=e,this.byteLength=t}Ua(){return"metadata"in this.$a}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E1{constructor(e){this.serializer=e}Us(e){return Oi(this.serializer,e)}Ks(e){return e.metadata.exists?i_(this.serializer,e.document,!1):en.newNoDocument(this.Us(e.metadata.name),this.Ws(e.metadata.readTime))}Ws(e){return vn(e)}}class nP{constructor(e,t,r){this.Ka=e,this.localStore=t,this.serializer=r,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=H_(e)}Wa(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.$a.namedQuery)this.queries.push(e.$a.namedQuery);else if(e.$a.documentMetadata){this.documents.push({metadata:e.$a.documentMetadata}),e.$a.documentMetadata.exists||++t;const r=It.fromString(e.$a.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.$a.document&&(this.documents[this.documents.length-1].document=e.$a.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}Ga(e){const t=new Map,r=new E1(this.serializer);for(const o of e)if(o.metadata.queries){const a=r.Us(o.metadata.name);for(const c of o.metadata.queries){const d=(t.get(c)||wt()).add(a);t.set(c,d)}}return t}async complete(){const e=await C5(this.localStore,new E1(this.serializer),this.documents,this.Ka.id),t=this.Ga(this.documents);for(const r of this.queries)await R5(this.localStore,r,t.get(r.name));return this.progress.taskState="Success",{progress:this.progress,za:this.collectionGroups,ja:e}}}function H_(n){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:n.totalDocuments,totalBytes:n.totalBytes}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $_{constructor(e){this.key=e}}class G_{constructor(e){this.key=e}}class K_{constructor(e,t){this.query=e,this.Ha=t,this.Ja=null,this.hasCachedResults=!1,this.current=!1,this.Ya=wt(),this.mutatedKeys=wt(),this.Za=DT(e),this.Xa=new ql(this.Za)}get eu(){return this.Ha}tu(e,t){const r=t?t.nu:new I1,o=t?t.Xa:this.Xa;let a=t?t.mutatedKeys:this.mutatedKeys,c=o,d=!1;const h=this.query.limitType==="F"&&o.size===this.query.limit?o.last():null,m=this.query.limitType==="L"&&o.size===this.query.limit?o.first():null;if(e.inorderTraversal((g,x)=>{const S=o.get(g),C=yd(this.query,x)?x:null,_=!!S&&this.mutatedKeys.has(S.key),I=!!C&&(C.hasLocalMutations||this.mutatedKeys.has(C.key)&&C.hasCommittedMutations);let T=!1;S&&C?S.data.isEqual(C.data)?_!==I&&(r.track({type:3,doc:C}),T=!0):this.ru(S,C)||(r.track({type:2,doc:C}),T=!0,(h&&this.Za(C,h)>0||m&&this.Za(C,m)<0)&&(d=!0)):!S&&C?(r.track({type:0,doc:C}),T=!0):S&&!C&&(r.track({type:1,doc:S}),T=!0,(h||m)&&(d=!0)),T&&(C?(c=c.add(C),a=I?a.add(g):a.delete(g)):(c=c.delete(g),a=a.delete(g)))}),this.query.limit!==null)for(;c.size>this.query.limit;){const g=this.query.limitType==="F"?c.last():c.first();c=c.delete(g.key),a=a.delete(g.key),r.track({type:1,doc:g})}return{Xa:c,nu:r,Cs:d,mutatedKeys:a}}ru(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,o){const a=this.Xa;this.Xa=e.Xa,this.mutatedKeys=e.mutatedKeys;const c=e.nu.wa();c.sort((g,x)=>function(C,_){const I=T=>{switch(T){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ke(20277,{Vt:T})}};return I(C)-I(_)}(g.type,x.type)||this.Za(g.doc,x.doc)),this.iu(r),o=o!=null&&o;const d=t&&!o?this.su():[],h=this.Ya.size===0&&this.current&&!o?1:0,m=h!==this.Ja;return this.Ja=h,c.length!==0||m?{snapshot:new hc(this.query,e.Xa,a,c,e.mutatedKeys,h===0,m,!1,!!r&&r.resumeToken.approximateByteSize()>0),ou:d}:{ou:d}}Fa(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Xa:this.Xa,nu:new I1,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{ou:[]}}_u(e){return!this.Ha.has(e)&&!!this.Xa.has(e)&&!this.Xa.get(e).hasLocalMutations}iu(e){e&&(e.addedDocuments.forEach(t=>this.Ha=this.Ha.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ha=this.Ha.delete(t)),this.current=e.current)}su(){if(!this.current)return[];const e=this.Ya;this.Ya=wt(),this.Xa.forEach(r=>{this._u(r.key)&&(this.Ya=this.Ya.add(r.key))});const t=[];return e.forEach(r=>{this.Ya.has(r)||t.push(new G_(r))}),this.Ya.forEach(r=>{e.has(r)||t.push(new $_(r))}),t}au(e){this.Ha=e.$s,this.Ya=wt();const t=this.tu(e.documents);return this.applyChanges(t,!0)}uu(){return hc.fromInitialDocuments(this.query,this.Xa,this.mutatedKeys,this.Ja===0,this.hasCachedResults)}}const Bs="SyncEngine";class rP{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class iP{constructor(e){this.key=e,this.cu=!1}}class oP{constructor(e,t,r,o,a,c){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=o,this.currentUser=a,this.maxConcurrentLimboResolutions=c,this.lu={},this.hu=new jo(d=>FT(d),gd),this.Pu=new Map,this.Tu=new Set,this.Iu=new Xt(We.comparator),this.Eu=new Map,this.du=new Dx,this.Au={},this.Ru=new Map,this.Vu=Pa.lr(),this.onlineState="Unknown",this.mu=void 0}get isPrimaryClient(){return this.mu===!0}}async function sP(n,e,t=!0){const r=Bf(n);let o;const a=r.hu.get(e);return a?(r.sharedClientState.addLocalQueryTarget(a.targetId),o=a.view.uu()):o=await Q_(r,e,t,!0),o}async function aP(n,e){const t=Bf(n);await Q_(t,e,!0,!1)}async function Q_(n,e,t,r){const o=await cc(n.localStore,or(e)),a=o.targetId,c=n.sharedClientState.addLocalQueryTarget(a,t);let d;return r&&(d=await Jx(n,e,a,c==="current",o.resumeToken)),n.isPrimaryClient&&t&&Pf(n.remoteStore,o),d}async function Jx(n,e,t,r,o){n.fu=(x,S,C)=>async function(I,T,F,P){let B=T.view.tu(F);B.Cs&&(B=await $p(I.localStore,T.query,!1).then(({documents:L})=>T.view.tu(L,B)));const q=P&&P.targetChanges.get(T.targetId),te=P&&P.targetMismatches.get(T.targetId)!=null,W=T.view.applyChanges(B,I.isPrimaryClient,q,te);return Vy(I,T.targetId,W.ou),W.snapshot}(n,x,S,C);const a=await $p(n.localStore,e,!0),c=new K_(e,a.$s),d=c.tu(a.documents),h=vd.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",o),m=c.applyChanges(d,n.isPrimaryClient,h);Vy(n,t,m.ou);const g=new rP(e,t,c);return n.hu.set(e,g),n.Pu.has(t)?n.Pu.get(t).push(e):n.Pu.set(t,[e]),m.snapshot}async function lP(n,e,t){const r=Le(n),o=r.hu.get(e),a=r.Pu.get(o.targetId);if(a.length>1)return r.Pu.set(o.targetId,a.filter(c=>!gd(c,e))),void r.hu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(o.targetId),r.sharedClientState.isActiveQueryTarget(o.targetId)||await uc(r.localStore,o.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(o.targetId),t&&dc(r.remoteStore,o.targetId),pc(r,o.targetId)}).catch(Rs)):(pc(r,o.targetId),await uc(r.localStore,o.targetId,!0))}async function cP(n,e){const t=Le(n),r=t.hu.get(e),o=t.Pu.get(r.targetId);t.isPrimaryClient&&o.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),dc(t.remoteStore,r.targetId))}async function uP(n,e,t){const r=n0(n);try{const o=await function(c,d){const h=Le(c),m=Gt.now(),g=d.reduce((C,_)=>C.add(_.key),wt());let x,S;return h.persistence.runTransaction("Locally write mutations","readwrite",C=>{let _=jr(),I=wt();return h.Bs.getEntries(C,g).next(T=>{_=T,_.forEach((F,P)=>{P.isValidDocument()||(I=I.add(F))})}).next(()=>h.localDocuments.getOverlayedDocuments(C,_)).next(T=>{x=T;const F=[];for(const P of d){const B=B6(P,x.get(P.key).overlayedDocument);B!=null&&F.push(new Io(P.key,B,kT(B.value.mapValue),un.exists(!0)))}return h.mutationQueue.addMutationBatch(C,m,F,d)}).next(T=>{S=T;const F=T.applyToLocalDocumentSet(x,I);return h.documentOverlayCache.saveOverlays(C,T.batchId,F)})}).then(()=>({batchId:S.batchId,changes:MT(x)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(o.batchId),function(c,d,h){let m=c.Au[c.currentUser.toKey()];m||(m=new Xt(dt)),m=m.insert(d,h),c.Au[c.currentUser.toKey()]=m}(r,o.batchId,t),await Co(r,o.changes),await jc(r.remoteStore)}catch(o){const a=Cc(o,"Failed to persist write");t.reject(a)}}async function Y_(n,e){const t=Le(n);try{const r=await j5(t.localStore,e);e.targetChanges.forEach((o,a)=>{const c=t.Eu.get(a);c&&(tt(o.addedDocuments.size+o.modifiedDocuments.size+o.removedDocuments.size<=1,22616),o.addedDocuments.size>0?c.cu=!0:o.modifiedDocuments.size>0?tt(c.cu,14607):o.removedDocuments.size>0&&(tt(c.cu,42227),c.cu=!1))}),await Co(t,r,e)}catch(r){await Rs(r)}}function A1(n,e,t){const r=Le(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){const o=[];r.hu.forEach((a,c)=>{const d=c.view.Fa(e);d.snapshot&&o.push(d.snapshot)}),function(c,d){const h=Le(c);h.onlineState=d;let m=!1;h.queries.forEach((g,x)=>{for(const S of x.Sa)S.Fa(d)&&(m=!0)}),m&&Yx(h)}(r.eventManager,e),o.length&&r.lu.Y_(o),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function dP(n,e,t){const r=Le(n);r.sharedClientState.updateQueryState(e,"rejected",t);const o=r.Eu.get(e),a=o&&o.key;if(a){let c=new Xt(We.comparator);c=c.insert(a,en.newNoDocument(a,st.min()));const d=wt().add(a),h=new bd(st.min(),new Map,new Xt(dt),c,d);await Y_(r,h),r.Iu=r.Iu.remove(a),r.Eu.delete(e),t0(r)}else await uc(r.localStore,e,!1).then(()=>pc(r,e,t)).catch(Rs)}async function hP(n,e){const t=Le(n),r=e.batch.batchId;try{const o=await _5(t.localStore,e);e0(t,r,null),Zx(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await Co(t,o)}catch(o){await Rs(o)}}async function pP(n,e,t){const r=Le(n);try{const o=await function(c,d){const h=Le(c);return h.persistence.runTransaction("Reject batch","readwrite-primary",m=>{let g;return h.mutationQueue.lookupMutationBatch(m,d).next(x=>(tt(x!==null,37113),g=x.keys(),h.mutationQueue.removeMutationBatch(m,x))).next(()=>h.mutationQueue.performConsistencyCheck(m)).next(()=>h.documentOverlayCache.removeOverlaysForBatchId(m,g,d)).next(()=>h.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(m,g)).next(()=>h.localDocuments.getDocuments(m,g))})}(r.localStore,e);e0(r,e,t),Zx(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await Co(r,o)}catch(o){await Rs(o)}}async function fP(n,e){const t=Le(n);Ps(t.remoteStore)||Ie(Bs,"The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const r=await function(c){const d=Le(c);return d.persistence.runTransaction("Get highest unacknowledged batch id","readonly",h=>d.mutationQueue.getHighestUnacknowledgedBatchId(h))}(t.localStore);if(r===gs)return void e.resolve();const o=t.Ru.get(r)||[];o.push(e),t.Ru.set(r,o)}catch(r){const o=Cc(r,"Initialization of waitForPendingWrites() operation failed");e.reject(o)}}function Zx(n,e){(n.Ru.get(e)||[]).forEach(t=>{t.resolve()}),n.Ru.delete(e)}function e0(n,e,t){const r=Le(n);let o=r.Au[r.currentUser.toKey()];if(o){const a=o.get(e);a&&(t?a.reject(t):a.resolve(),o=o.remove(e)),r.Au[r.currentUser.toKey()]=o}}function pc(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.Pu.get(e))n.hu.delete(r),t&&n.lu.gu(r,t);n.Pu.delete(e),n.isPrimaryClient&&n.du.Hr(e).forEach(r=>{n.du.containsKey(r)||X_(n,r)})}function X_(n,e){n.Tu.delete(e.path.canonicalString());const t=n.Iu.get(e);t!==null&&(dc(n.remoteStore,t),n.Iu=n.Iu.remove(e),n.Eu.delete(t),t0(n))}function Vy(n,e,t){for(const r of t)r instanceof $_?(n.du.addReference(r.key,e),mP(n,r)):r instanceof G_?(Ie(Bs,"Document no longer in limbo: "+r.key),n.du.removeReference(r.key,e),n.du.containsKey(r.key)||X_(n,r.key)):Ke(19791,{pu:r})}function mP(n,e){const t=e.key,r=t.path.canonicalString();n.Iu.get(t)||n.Tu.has(r)||(Ie(Bs,"New document in limbo: "+t),n.Tu.add(r),t0(n))}function t0(n){for(;n.Tu.size>0&&n.Iu.size<n.maxConcurrentLimboResolutions;){const e=n.Tu.values().next().value;n.Tu.delete(e);const t=new We(It.fromString(e)),r=n.Vu.next();n.Eu.set(r,new iP(t)),n.Iu=n.Iu.insert(t,r),Pf(n.remoteStore,new mo(or(Sc(t.path)),r,"TargetPurposeLimboResolution",Tr.le))}}async function Co(n,e,t){const r=Le(n),o=[],a=[],c=[];r.hu.isEmpty()||(r.hu.forEach((d,h)=>{c.push(r.fu(h,e,t).then(m=>{var g;if((m||t)&&r.isPrimaryClient){const x=m?!m.fromCache:(g=t==null?void 0:t.targetChanges.get(h.targetId))===null||g===void 0?void 0:g.current;r.sharedClientState.updateQueryState(h.targetId,x?"current":"not-current")}if(m){o.push(m);const x=Ox.Rs(h.targetId,m);a.push(x)}}))}),await Promise.all(c),r.lu.Y_(o),await async function(h,m){const g=Le(h);try{await g.persistence.runTransaction("notifyLocalViewChanges","readwrite",x=>se.forEach(m,S=>se.forEach(S.ds,C=>g.persistence.referenceDelegate.addReference(x,S.targetId,C)).next(()=>se.forEach(S.As,C=>g.persistence.referenceDelegate.removeReference(x,S.targetId,C)))))}catch(x){if(!Es(x))throw x;Ie(Wx,"Failed to update sequence numbers: "+x)}for(const x of m){const S=x.targetId;if(!x.fromCache){const C=g.xs.get(S),_=C.snapshotVersion,I=C.withLastLimboFreeSnapshotVersion(_);g.xs=g.xs.insert(S,I)}}}(r.localStore,a))}async function gP(n,e){const t=Le(n);if(!t.currentUser.isEqual(e)){Ie(Bs,"User change. New user:",e.toKey());const r=await C_(t.localStore,e);t.currentUser=e,function(a,c){a.Ru.forEach(d=>{d.forEach(h=>{h.reject(new je(ye.CANCELLED,c))})}),a.Ru.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Co(t,r.ks)}}function yP(n,e){const t=Le(n),r=t.Eu.get(e);if(r&&r.cu)return wt().add(r.key);{let o=wt();const a=t.Pu.get(e);if(!a)return o;for(const c of a){const d=t.hu.get(c);o=o.unionWith(d.view.eu)}return o}}async function xP(n,e){const t=Le(n),r=await $p(t.localStore,e.query,!0),o=e.view.au(r);return t.isPrimaryClient&&Vy(t,e.targetId,o.ou),o}async function bP(n,e){const t=Le(n);return P_(t.localStore,e).then(r=>Co(t,r))}async function vP(n,e,t,r){const o=Le(n),a=await function(d,h){const m=Le(d),g=Le(m.mutationQueue);return m.persistence.runTransaction("Lookup mutation documents","readonly",x=>g.tr(x,h).next(S=>S?m.localDocuments.getDocuments(x,S):se.resolve(null)))}(o.localStore,e);a!==null?(t==="pending"?await jc(o.remoteStore):t==="acknowledged"||t==="rejected"?(e0(o,e,r||null),Zx(o,e),function(d,h){Le(Le(d).mutationQueue).sr(h)}(o.localStore,e)):Ke(6720,"Unknown batchState",{yu:t}),await Co(o,a)):Ie(Bs,"Cannot apply mutation batch with id: "+e)}async function wP(n,e){const t=Le(n);if(Bf(t),n0(t),e===!0&&t.mu!==!0){const r=t.sharedClientState.getAllActiveQueryTargets(),o=await P1(t,r.toArray());t.mu=!0,await Oy(t.remoteStore,!0);for(const a of o)Pf(t.remoteStore,a)}else if(e===!1&&t.mu!==!1){const r=[];let o=Promise.resolve();t.Pu.forEach((a,c)=>{t.sharedClientState.isLocalQueryTarget(c)?r.push(c):o=o.then(()=>(pc(t,c),uc(t.localStore,c,!0))),dc(t.remoteStore,c)}),await o,await P1(t,r),function(c){const d=Le(c);d.Eu.forEach((h,m)=>{dc(d.remoteStore,m)}),d.du.Jr(),d.Eu=new Map,d.Iu=new Xt(We.comparator)}(t),t.mu=!1,await Oy(t.remoteStore,!1)}}async function P1(n,e,t){const r=Le(n),o=[],a=[];for(const c of e){let d;const h=r.Pu.get(c);if(h&&h.length!==0){d=await cc(r.localStore,or(h[0]));for(const m of h){const g=r.hu.get(m),x=await xP(r,g);x.snapshot&&a.push(x.snapshot)}}else{const m=await A_(r.localStore,c);d=await cc(r.localStore,m),await Jx(r,J_(m),c,!1,d.resumeToken)}o.push(d)}return r.lu.Y_(a),o}function J_(n){return AT(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function SP(n){return function(t){return Le(Le(t).persistence).Is()}(Le(n).localStore)}async function kP(n,e,t,r){const o=Le(n);if(o.mu)return void Ie(Bs,"Ignoring unexpected query state notification.");const a=o.Pu.get(e);if(a&&a.length>0)switch(t){case"current":case"not-current":{const c=await P_(o.localStore,zT(a[0])),d=bd.createSynthesizedRemoteEventForCurrentChange(e,t==="current",fn.EMPTY_BYTE_STRING);await Co(o,c,d);break}case"rejected":await uc(o.localStore,e,!0),pc(o,e,r);break;default:Ke(64155,t)}}async function TP(n,e,t){const r=Bf(n);if(r.mu){for(const o of e){if(r.Pu.has(o)&&r.sharedClientState.isActiveQueryTarget(o)){Ie(Bs,"Adding an already active target "+o);continue}const a=await A_(r.localStore,o),c=await cc(r.localStore,a);await Jx(r,J_(a),c.targetId,!1,c.resumeToken),Pf(r.remoteStore,c)}for(const o of t)r.Pu.has(o)&&await uc(r.localStore,o,!1).then(()=>{dc(r.remoteStore,o),pc(r,o)}).catch(Rs)}}function Bf(n){const e=Le(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=Y_.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=yP.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=dP.bind(null,e),e.lu.Y_=Z5.bind(null,e.eventManager),e.lu.gu=eP.bind(null,e.eventManager),e}function n0(n){const e=Le(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=hP.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=pP.bind(null,e),e}function _P(n,e,t){const r=Le(n);(async function(a,c,d){try{const h=await c.getMetadata();if(await function(C,_){const I=Le(C),T=vn(_.createTime);return I.persistence.runTransaction("hasNewerBundle","readonly",F=>I.Ei.getBundleMetadata(F,_.id)).then(F=>!!F&&F.createTime.compareTo(T)>=0)}(a.localStore,h))return await c.close(),d._completeWith(function(C){return{taskState:"Success",documentsLoaded:C.totalDocuments,bytesLoaded:C.totalBytes,totalDocuments:C.totalDocuments,totalBytes:C.totalBytes}}(h)),Promise.resolve(new Set);d._updateProgress(H_(h));const m=new nP(h,a.localStore,c.serializer);let g=await c.wu();for(;g;){const S=await m.Wa(g);S&&d._updateProgress(S),g=await c.wu()}const x=await m.complete();return await Co(a,x.ja,void 0),await function(C,_){const I=Le(C);return I.persistence.runTransaction("Save bundle","readwrite",T=>I.Ei.saveBundleMetadata(T,_))}(a.localStore,h),d._completeWith(x.progress),Promise.resolve(x.za)}catch(h){return Or(Bs,`Loading bundle failed with ${h}`),d._failWith(h),Promise.resolve(new Set)}})(r,e,t).then(o=>{r.sharedClientState.notifyBundleLoaded(o)})}class fc{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=wd(e.databaseInfo.databaseId),this.sharedClientState=this.bu(e),this.persistence=this.Su(e),await this.persistence.start(),this.localStore=this.Du(e),this.gcScheduler=this.vu(e,this.localStore),this.indexBackfillerScheduler=this.Cu(e,this.localStore)}vu(e,t){return null}Cu(e,t){return null}Du(e){return I_(this.persistence,new j_,e.initialUser,this.serializer)}Su(e){return new Nx(Af.fi,this.serializer)}bu(e){return new N_}async terminate(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}fc.provider={build:()=>new fc};class r0 extends fc{constructor(e){super(),this.cacheSizeBytes=e}vu(e,t){tt(this.persistence.referenceDelegate instanceof Hp,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new v_(r,e.asyncQueue,t)}Su(e){const t=this.cacheSizeBytes!==void 0?nr.withCacheSize(this.cacheSizeBytes):nr.DEFAULT;return new Nx(r=>Hp.fi(r,t),this.serializer)}}class i0 extends fc{constructor(e,t,r){super(),this.Fu=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.Fu.initialize(this,e),await n0(this.Fu.syncEngine),await jc(this.Fu.remoteStore),await this.persistence.Ji(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}Du(e){return I_(this.persistence,new j_,e.initialUser,this.serializer)}vu(e,t){const r=this.persistence.referenceDelegate.garbageCollector;return new v_(r,e.asyncQueue,t)}Cu(e,t){const r=new NA(t,this.persistence);return new DA(e.asyncQueue,r)}Su(e){const t=Lx(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?nr.withCacheSize(this.cacheSizeBytes):nr.DEFAULT;return new Mx(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,M_(),Tp(),this.serializer,this.sharedClientState,!!this.forceOwnership)}bu(e){return new N_}}class Z_ extends i0{constructor(e,t){super(e,t,!1),this.Fu=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const t=this.Fu.syncEngine;this.sharedClientState instanceof qg&&(this.sharedClientState.syncEngine={Co:vP.bind(null,t),Fo:kP.bind(null,t),Mo:TP.bind(null,t),Is:SP.bind(null,t),vo:bP.bind(null,t)},await this.sharedClientState.start()),await this.persistence.Ji(async r=>{await wP(this.Fu.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())})}bu(e){const t=M_();if(!qg.C(t))throw new je(ye.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const r=Lx(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new qg(t,e.asyncQueue,r,e.clientId,e.initialUser)}}class _s{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>A1(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=gP.bind(null,this.syncEngine),await Oy(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new J5}()}createDatastore(e){const t=wd(e.databaseInfo.databaseId),r=function(a){return new F5(a)}(e.databaseInfo);return function(a,c,d,h){return new M5(a,c,d,h)}(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return function(r,o,a,c,d){return new O5(r,o,a,c,d)}(this.localStore,this.datastore,e.asyncQueue,t=>A1(this.syncEngine,t,0),function(){return T1.C()?new T1:new E5}())}createSyncEngine(e,t){return function(o,a,c,d,h,m,g){const x=new oP(o,a,c,d,h,m);return g&&(x.mu=!0),x}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(o){const a=Le(o);Ie(Ba,"RemoteStore shutting down."),a.da.add(5),await _c(a),a.Ra.shutdown(),a.Va.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(t=this.eventManager)===null||t===void 0||t.terminate()}}_s.provider={build:()=>new _s};function B1(n,e=10240){let t=0;return{async read(){if(t<n.byteLength){const r={value:n.slice(t,t+e),done:!1};return t+=e,r}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ff{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Mu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Mu(this.observer.error,e):bn("Uncaught Error in snapshot listener:",e.toString()))}xu(){this.muted=!0}Mu(e,t){setTimeout(()=>{this.muted||e(t)},0)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jP{constructor(e,t){this.Ou=e,this.serializer=t,this.metadata=new Un,this.buffer=new Uint8Array,this.Nu=function(){return new TextDecoder("utf-8")}(),this.Bu().then(r=>{r&&r.Ua()?this.metadata.resolve(r.$a.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(r==null?void 0:r.$a)}`))},r=>this.metadata.reject(r))}close(){return this.Ou.cancel()}async getMetadata(){return this.metadata.promise}async wu(){return await this.getMetadata(),this.Bu()}async Bu(){const e=await this.Lu();if(e===null)return null;const t=this.Nu.decode(e),r=Number(t);isNaN(r)&&this.ku(`length string (${t}) is not valid number`);const o=await this.qu(r);return new tP(JSON.parse(o),e.length+r)}Qu(){return this.buffer.findIndex(e=>e===123)}async Lu(){for(;this.Qu()<0&&!await this.$u(););if(this.buffer.length===0)return null;const e=this.Qu();e<0&&this.ku("Reached the end of bundle when a length string is expected.");const t=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),t}async qu(e){for(;this.buffer.length<e;)await this.$u()&&this.ku("Reached the end of bundle when more is expected.");const t=this.Nu.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),t}ku(e){throw this.Ou.cancel(),new Error(`Invalid bundle format: ${e}`)}async $u(){const e=await this.Ou.read();if(!e.done){const t=new Uint8Array(this.buffer.length+e.value.length);t.set(this.buffer),t.set(e.value,this.buffer.length),this.buffer=t}return e.done}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IP{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new je(ye.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const t=await async function(o,a){const c=Le(o),d={documents:a.map(x=>od(c.serializer,x))},h=await c.Yo("BatchGetDocuments",c.serializer.databaseId,It.emptyPath(),d,a.length),m=new Map;h.forEach(x=>{const S=V6(c.serializer,x);m.set(S.key.toString(),S)});const g=[];return a.forEach(x=>{const S=m.get(x.toString());tt(!!S,55234,{key:x}),g.push(S)}),g}(this.datastore,e);return t.forEach(r=>this.recordVersion(r)),t}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastTransactionError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new Tc(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach(t=>{e.delete(t.key.toString())}),e.forEach((t,r)=>{const o=We.fromPath(r);this.mutations.push(new Ix(o,this.precondition(o)))}),await async function(r,o){const a=Le(r),c={writes:o.map(d=>sd(a.serializer,d))};await a.zo("Commit",a.serializer.databaseId,It.emptyPath(),c)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw Ke(50498,{Uu:e.constructor.name});t=st.min()}const r=this.readVersions.get(e.key.toString());if(r){if(!t.isEqual(r))throw new je(ye.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(st.min())?un.exists(!1):un.updateTime(t):un.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(st.min()))throw new je(ye.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return un.updateTime(t)}return un.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CP{constructor(e,t,r,o,a){this.asyncQueue=e,this.datastore=t,this.options=r,this.updateFunction=o,this.deferred=a,this.Ku=r.maxAttempts,this.x_=new Ux(this.asyncQueue,"transaction_retry")}Wu(){this.Ku-=1,this.Gu()}Gu(){this.x_.y_(async()=>{const e=new IP(this.datastore),t=this.zu(e);t&&t.then(r=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(r)}).catch(o=>{this.ju(o)}))}).catch(r=>{this.ju(r)})})}zu(e){try{const t=this.updateFunction(e);return!pd(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}ju(e){this.Ku>0&&this.Hu(e)?(this.Ku-=1,this.asyncQueue.enqueueAndForget(()=>(this.Gu(),Promise.resolve()))):this.deferred.reject(e)}Hu(e){if(e.name==="FirebaseError"){const t=e.code;return t==="aborted"||t==="failed-precondition"||t==="already-exists"||!QT(t)}return!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const js="FirestoreClient";class RP{constructor(e,t,r,o,a){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=o,this.user=Wn.UNAUTHENTICATED,this.clientId=fx.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=a,this.authCredentials.start(r,async c=>{Ie(js,"Received user=",c.uid),await this.authCredentialListener(c),this.user=c}),this.appCheckCredentials.start(r,c=>(Ie(js,"Received new app check token=",c),this.appCheckCredentialListener(c,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Un;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const r=Cc(t,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function $g(n,e){n.asyncQueue.verifyOperationInProgress(),Ie(js,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(async o=>{r.isEqual(o)||(await C_(e.localStore,o),r=o)}),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e}async function F1(n,e){n.asyncQueue.verifyOperationInProgress();const t=await o0(n);Ie(js,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>j1(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,o)=>j1(e.remoteStore,o)),n._onlineComponents=e}async function o0(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){Ie(js,"Using user provided OfflineComponentProvider");try{await $g(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!function(o){return o.name==="FirebaseError"?o.code===ye.FAILED_PRECONDITION||o.code===ye.UNIMPLEMENTED:!(typeof DOMException<"u"&&o instanceof DOMException)||o.code===22||o.code===20||o.code===11}(t))throw t;Or("Error using user provided cache. Falling back to memory cache: "+t),await $g(n,new fc)}}else Ie(js,"Using default OfflineComponentProvider"),await $g(n,new r0(void 0));return n._offlineComponents}async function zf(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(Ie(js,"Using user provided OnlineComponentProvider"),await F1(n,n._uninitializedComponentsProvider._online)):(Ie(js,"Using default OnlineComponentProvider"),await F1(n,new _s))),n._onlineComponents}function e2(n){return o0(n).then(e=>e.persistence)}function Rc(n){return o0(n).then(e=>e.localStore)}function t2(n){return zf(n).then(e=>e.remoteStore)}function s0(n){return zf(n).then(e=>e.syncEngine)}function n2(n){return zf(n).then(e=>e.datastore)}async function mc(n){const e=await zf(n),t=e.eventManager;return t.onListen=sP.bind(null,e.syncEngine),t.onUnlisten=lP.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=aP.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=cP.bind(null,e.syncEngine),t}function EP(n){return n.asyncQueue.enqueue(async()=>{const e=await e2(n),t=await t2(n);return e.setNetworkEnabled(!0),function(o){const a=Le(o);return a.da.delete(0),Sd(a)}(t)})}function AP(n){return n.asyncQueue.enqueue(async()=>{const e=await e2(n),t=await t2(n);return e.setNetworkEnabled(!1),async function(o){const a=Le(o);a.da.add(0),await _c(a),a.Va.set("Offline")}(t)})}function PP(n,e){const t=new Un;return n.asyncQueue.enqueueAndForget(async()=>async function(o,a,c){try{const d=await function(m,g){const x=Le(m);return x.persistence.runTransaction("read document","readonly",S=>x.localDocuments.getDocument(S,g))}(o,a);d.isFoundDocument()?c.resolve(d):d.isNoDocument()?c.resolve(null):c.reject(new je(ye.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(d){const h=Cc(d,`Failed to get document '${a} from cache`);c.reject(h)}}(await Rc(n),e,t)),t.promise}function r2(n,e,t={}){const r=new Un;return n.asyncQueue.enqueueAndForget(async()=>function(a,c,d,h,m){const g=new Ff({next:S=>{g.xu(),c.enqueueAndForget(()=>Qx(a,x));const C=S.docs.has(d);!C&&S.fromCache?m.reject(new je(ye.UNAVAILABLE,"Failed to get document because the client is offline.")):C&&S.fromCache&&h&&h.source==="server"?m.reject(new je(ye.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):m.resolve(S)},error:S=>m.reject(S)}),x=new Xx(Sc(d.path),g,{includeMetadataChanges:!0,Qa:!0});return Kx(a,x)}(await mc(n),n.asyncQueue,e,t,r)),r.promise}function BP(n,e){const t=new Un;return n.asyncQueue.enqueueAndForget(async()=>async function(o,a,c){try{const d=await $p(o,a,!0),h=new K_(a,d.$s),m=h.tu(d.documents),g=h.applyChanges(m,!1);c.resolve(g.snapshot)}catch(d){const h=Cc(d,`Failed to execute query '${a} against cache`);c.reject(h)}}(await Rc(n),e,t)),t.promise}function i2(n,e,t={}){const r=new Un;return n.asyncQueue.enqueueAndForget(async()=>function(a,c,d,h,m){const g=new Ff({next:S=>{g.xu(),c.enqueueAndForget(()=>Qx(a,x)),S.fromCache&&h.source==="server"?m.reject(new je(ye.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):m.resolve(S)},error:S=>m.reject(S)}),x=new Xx(d,g,{includeMetadataChanges:!0,Qa:!0});return Kx(a,x)}(await mc(n),n.asyncQueue,e,t,r)),r.promise}function FP(n,e,t){const r=new Un;return n.asyncQueue.enqueueAndForget(async()=>{try{const o=await n2(n);r.resolve(async function(c,d,h){var m;const g=Le(c),{request:x,yt:S,parent:C}=s_(g.serializer,PT(d),h);g.connection.Uo||delete x.parent;const _=(await g.Yo("RunAggregationQuery",g.serializer.databaseId,C,x,1)).filter(T=>!!T.result);tt(_.length===1,64727);const I=(m=_[0].result)===null||m===void 0?void 0:m.aggregateFields;return Object.keys(I).reduce((T,F)=>(T[S[F]]=I[F],T),{})}(o,e,t))}catch(o){r.reject(o)}}),r.promise}function zP(n,e){const t=new Ff(e);return n.asyncQueue.enqueueAndForget(async()=>function(o,a){Le(o).Ca.add(a),a.next()}(await mc(n),t)),()=>{t.xu(),n.asyncQueue.enqueueAndForget(async()=>function(o,a){Le(o).Ca.delete(a)}(await mc(n),t))}}function DP(n,e,t,r){const o=function(c,d){let h;return h=typeof c=="string"?px().encode(c):c,function(g,x){return new jP(g,x)}(function(g,x){if(g instanceof Uint8Array)return B1(g,x);if(g instanceof ArrayBuffer)return B1(new Uint8Array(g),x);if(g instanceof ReadableStream)return g.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(h),d)}(t,wd(e));n.asyncQueue.enqueueAndForget(async()=>{_P(await s0(n),o,r)})}function NP(n,e){return n.asyncQueue.enqueue(async()=>function(r,o){const a=Le(r);return a.persistence.runTransaction("Get named query","readonly",c=>a.Ei.getNamedQuery(c,o))}(await Rc(n),e))}function MP(n,e){return n.asyncQueue.enqueue(async()=>async function(r,o){const a=Le(r),c=a.indexManager,d=[];return a.persistence.runTransaction("Configure indexes","readwrite",h=>c.getFieldIndexes(h).next(m=>function(x,S,C,_,I){x=[...x],S=[...S],x.sort(C),S.sort(C);const T=x.length,F=S.length;let P=0,B=0;for(;P<F&&B<T;){const q=C(x[B],S[P]);q<0?I(x[B++]):q>0?_(S[P++]):(P++,B++)}for(;P<F;)_(S[P++]);for(;B<T;)I(x[B++])}(m,o,PA,g=>{d.push(c.addFieldIndex(h,g))},g=>{d.push(c.deleteFieldIndex(h,g))})).next(()=>se.waitFor(d)))}(await Rc(n),e))}function LP(n,e){return n.asyncQueue.enqueue(async()=>function(r,o){Le(r).Ms.fs=o}(await Rc(n),e))}function OP(n){return n.asyncQueue.enqueue(async()=>function(t){const r=Le(t),o=r.indexManager;return r.persistence.runTransaction("Delete All Indexes","readwrite",a=>o.deleteAllFieldIndexes(a))}(await Rc(n)))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function o2(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z1=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function a0(n,e,t){if(!t)throw new je(ye.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function s2(n,e,t,r){if(e===!0&&r===!0)throw new je(ye.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function D1(n){if(!We.isDocumentKey(n))throw new je(ye.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function N1(n){if(We.isDocumentKey(n))throw new je(ye.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function Df(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":Ke(12329,{type:typeof n})}function Tt(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new je(ye.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=Df(n);throw new je(ye.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function a2(n,e){if(e<=0)throw new je(ye.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const l2="firestore.googleapis.com",M1=!0;class L1{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new je(ye.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=l2,this.ssl=M1}else this.host=e.host,this.ssl=(t=e.ssl)!==null&&t!==void 0?t:M1;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=m_;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<b_)throw new je(ye.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}s2("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=o2((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(a){if(a.timeoutSeconds!==void 0){if(isNaN(a.timeoutSeconds))throw new je(ye.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (must not be NaN)`);if(a.timeoutSeconds<5)throw new je(ye.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (minimum allowed value is 5)`);if(a.timeoutSeconds>30)throw new je(ye.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,o){return r.timeoutSeconds===o.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class kd{constructor(e,t,r,o){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=o,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new L1({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new je(ye.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new je(ye.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new L1(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new Qk;switch(r.type){case"firstParty":return new jA(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new je(ye.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const r=z1.get(t);r&&(Ie("ComponentProvider","Removing Datastore"),z1.delete(t),r.terminate())}(this),Promise.resolve()}}function c2(n,e,t,r={}){var o;n=Tt(n,kd);const a=To(e),c=n._getSettings(),d=Object.assign(Object.assign({},c),{emulatorOptions:n._getEmulatorOptions()}),h=`${e}:${t}`;a&&(xf(`https://${h}`),lx("Firestore",!0)),c.host!==l2&&c.host!==h&&Or("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const m=Object.assign(Object.assign({},c),{host:h,ssl:a,emulatorOptions:r});if(!yi(m,d)&&(n._setSettings(m),r.mockUserToken)){let g,x;if(typeof r.mockUserToken=="string")g=r.mockUserToken,x=Wn.MOCK_USER;else{g=Ak(r.mockUserToken,(o=n._app)===null||o===void 0?void 0:o.options.projectId);const S=r.mockUserToken.sub||r.mockUserToken.user_id;if(!S)throw new je(ye.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");x=new Wn(S)}n._authCredentials=new kA(new Kk(g,x))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qn{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new qn(this.firestore,e,this._query)}}class yn{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new mi(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new yn(this.firestore,e,this._key)}}class mi extends qn{constructor(e,t,r){super(e,t,Sc(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new yn(this.firestore,null,new We(e))}withConverter(e){return new mi(this.firestore,e,this._path)}}function Cn(n,e,...t){if(n=Dt(n),a0("collection","path",e),n instanceof kd){const r=It.fromString(e,...t);return N1(r),new mi(n,null,r)}{if(!(n instanceof yn||n instanceof mi))throw new je(ye.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(It.fromString(e,...t));return N1(r),new mi(n.firestore,null,r)}}function WP(n,e){if(n=Tt(n,kd),a0("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new je(ye.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new qn(n,null,function(r){return new _o(It.emptyPath(),r)}(e))}function Vn(n,e,...t){if(n=Dt(n),arguments.length===1&&(e=fx.newId()),a0("doc","path",e),n instanceof kd){const r=It.fromString(e,...t);return D1(r),new yn(n,null,new We(r))}{if(!(n instanceof yn||n instanceof mi))throw new je(ye.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(It.fromString(e,...t));return D1(r),new yn(n.firestore,n instanceof mi?n.converter:null,new We(r))}}function VP(n,e){return n=Dt(n),e=Dt(e),(n instanceof yn||n instanceof mi)&&(e instanceof yn||e instanceof mi)&&n.firestore===e.firestore&&n.path===e.path&&n.converter===e.converter}function l0(n,e){return n=Dt(n),e=Dt(e),n instanceof qn&&e instanceof qn&&n.firestore===e.firestore&&gd(n._query,e._query)&&n.converter===e.converter}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const O1="AsyncQueue";class W1{constructor(e=Promise.resolve()){this.Ju=[],this.Yu=!1,this.Zu=[],this.Xu=null,this.ec=!1,this.tc=!1,this.nc=[],this.x_=new Ux(this,"async_queue_retry"),this.rc=()=>{const r=Tp();r&&Ie(O1,"Visibility state changed to "+r.visibilityState),this.x_.b_()},this.sc=e;const t=Tp();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.rc)}get isShuttingDown(){return this.Yu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.oc(),this._c(e)}enterRestrictedMode(e){if(!this.Yu){this.Yu=!0,this.tc=e||!1;const t=Tp();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.rc)}}enqueue(e){if(this.oc(),this.Yu)return new Promise(()=>{});const t=new Un;return this._c(()=>this.Yu&&this.tc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Ju.push(e),this.ac()))}async ac(){if(this.Ju.length!==0){try{await this.Ju[0](),this.Ju.shift(),this.x_.reset()}catch(e){if(!Es(e))throw e;Ie(O1,"Operation failed with retryable error: "+e)}this.Ju.length>0&&this.x_.y_(()=>this.ac())}}_c(e){const t=this.sc.then(()=>(this.ec=!0,e().catch(r=>{throw this.Xu=r,this.ec=!1,bn("INTERNAL UNHANDLED ERROR: ",V1(r)),r}).then(r=>(this.ec=!1,r))));return this.sc=t,t}enqueueAfterDelay(e,t,r){this.oc(),this.nc.indexOf(e)>-1&&(t=0);const o=Gx.createAndSchedule(this,e,t,r,a=>this.uc(a));return this.Zu.push(o),o}oc(){this.Xu&&Ke(47125,{cc:V1(this.Xu)})}verifyOperationInProgress(){}async lc(){let e;do e=this.sc,await e;while(e!==this.sc)}hc(e){for(const t of this.Zu)if(t.timerId===e)return!0;return!1}Pc(e){return this.lc().then(()=>{this.Zu.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(const t of this.Zu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.lc()})}Tc(e){this.nc.push(e)}uc(e){const t=this.Zu.indexOf(e);this.Zu.splice(t,1)}}function V1(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Uy(n){return function(t,r){if(typeof t!="object"||t===null)return!1;const o=t;for(const a of r)if(a in o&&typeof o[a]=="function")return!0;return!1}(n,["next","error","complete"])}class u2{constructor(){this._progressObserver={},this._taskCompletionResolver=new Un,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,r){this._progressObserver={next:e,error:t,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UP=-1;class qt extends kd{constructor(e,t,r,o){super(e,t,r,o),this.type="firestore",this._queue=new W1,this._persistenceKey=(o==null?void 0:o.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new W1(e),this._firestoreClient=void 0,await e}}}function qP(n,e,t){t||(t=td);const r=vc(n,"firestore");if(r.isInitialized(t)){const o=r.getImmediate({identifier:t}),a=r.getOptions(t);if(yi(a,e))return o;throw new je(ye.FAILED_PRECONDITION,"initializeFirestore() has already been called with different options. To avoid this error, call initializeFirestore() with the same options as when it was originally called, or call getFirestore() to return the already initialized instance.")}if(e.cacheSizeBytes!==void 0&&e.localCache!==void 0)throw new je(ye.INVALID_ARGUMENT,"cache and cacheSizeBytes cannot be specified at the same time as cacheSizeBytes willbe deprecated. Instead, specify the cache size in the cache object");if(e.cacheSizeBytes!==void 0&&e.cacheSizeBytes!==-1&&e.cacheSizeBytes<b_)throw new je(ye.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");return e.host&&To(e.host)&&xf(e.host),r.initialize({options:e,instanceIdentifier:t})}function Td(n,e){const t=typeof n=="object"?n:dx(),r=typeof n=="string"?n:e||td,o=vc(t,"firestore").getImmediate({identifier:r});if(!o._initialized){const a=Ck("firestore");a&&c2(o,...a)}return o}function dn(n){if(n._terminated)throw new je(ye.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||d2(n),n._firestoreClient}function d2(n){var e,t,r;const o=n._freezeSettings(),a=function(d,h,m,g){return new h6(d,h,m,g.host,g.ssl,g.experimentalForceLongPolling,g.experimentalAutoDetectLongPolling,o2(g.experimentalLongPollingOptions),g.useFetchStreams,g.isUsingEmulator)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,o);n._componentsProvider||!((t=o.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((r=o.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(n._componentsProvider={_offline:o.localCache._offlineComponentProvider,_online:o.localCache._onlineComponentProvider}),n._firestoreClient=new RP(n._authCredentials,n._appCheckCredentials,n._queue,a,n._componentsProvider&&function(d){const h=d==null?void 0:d._online.build();return{_offline:d==null?void 0:d._offline.build(h),_online:h}}(n._componentsProvider))}function HP(n,e){Or("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=n._freezeSettings();return h2(n,_s.provider,{build:r=>new i0(r,t.cacheSizeBytes,e==null?void 0:e.forceOwnership)}),Promise.resolve()}async function $P(n){Or("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const e=n._freezeSettings();h2(n,_s.provider,{build:t=>new Z_(t,e.cacheSizeBytes)})}function h2(n,e,t){if((n=Tt(n,qt))._firestoreClient||n._terminated)throw new je(ye.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(n._componentsProvider||n._getSettings().localCache)throw new je(ye.FAILED_PRECONDITION,"SDK cache is already specified.");n._componentsProvider={_online:e,_offline:t},d2(n)}function GP(n){if(n._initialized&&!n._terminated)throw new je(ye.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new Un;return n._queue.enqueueAndForgetEvenWhileRestricted(async()=>{try{await async function(r){if(!Li.C())return Promise.resolve();const o=r+__;await Li.delete(o)}(Lx(n._databaseId,n._persistenceKey)),e.resolve()}catch(t){e.reject(t)}}),e.promise}function KP(n){return function(t){const r=new Un;return t.asyncQueue.enqueueAndForget(async()=>fP(await s0(t),r)),r.promise}(dn(n=Tt(n,qt)))}function QP(n){return EP(dn(n=Tt(n,qt)))}function YP(n){return AP(dn(n=Tt(n,qt)))}function XP(n){return sA(n.app,"firestore",n._databaseId.database),n._delete()}function JP(n,e){const t=dn(n=Tt(n,qt)),r=new u2;return DP(t,n._databaseId,e,r),r}function ZP(n,e){return NP(dn(n=Tt(n,qt)),e).then(t=>t?new qn(n,null,t.query):null)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gc{constructor(e="count",t){this._internalFieldPath=t,this.type="AggregateField",this.aggregateType=e}}class p2{constructor(e,t,r){this._userDataWriter=t,this._data=r,this.type="AggregateQuerySnapshot",this.query=e}data(){return this._userDataWriter.convertObjectMap(this._data)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Is{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Is(fn.fromBase64String(e))}catch(t){throw new je(ye.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Is(fn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fs{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new je(ye.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new tn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}function eB(){return new Fs(by)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zs{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nf{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new je(ye.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new je(ye.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return dt(this._lat,e._lat)||dt(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _d{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,o){if(r.length!==o.length)return!1;for(let a=0;a<r.length;++a)if(r[a]!==o[a])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tB=/^__.*__$/;class nB{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new Io(e,this.data,this.fieldMask,t,this.fieldTransforms):new kc(e,this.data,t,this.fieldTransforms)}}class f2{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new Io(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function m2(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Ke(40011,{Ic:n})}}class Mf{constructor(e,t,r,o,a,c){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=o,a===void 0&&this.Ec(),this.fieldTransforms=a||[],this.fieldMask=c||[]}get path(){return this.settings.path}get Ic(){return this.settings.Ic}dc(e){return new Mf(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Ac(e){var t;const r=(t=this.path)===null||t===void 0?void 0:t.child(e),o=this.dc({path:r,Rc:!1});return o.Vc(e),o}mc(e){var t;const r=(t=this.path)===null||t===void 0?void 0:t.child(e),o=this.dc({path:r,Rc:!1});return o.Ec(),o}fc(e){return this.dc({path:void 0,Rc:!0})}gc(e){return Yp(e,this.settings.methodName,this.settings.yc||!1,this.path,this.settings.wc)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}Ec(){if(this.path)for(let e=0;e<this.path.length;e++)this.Vc(this.path.get(e))}Vc(e){if(e.length===0)throw this.gc("Document fields must not be empty");if(m2(this.Ic)&&tB.test(e))throw this.gc('Document fields cannot begin and end with "__"')}}class rB{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||wd(e)}bc(e,t,r,o=!1){return new Mf({Ic:e,methodName:t,wc:r,path:tn.emptyPath(),Rc:!1,yc:o},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Wa(n){const e=n._freezeSettings(),t=wd(n._databaseId);return new rB(n._databaseId,!!e.ignoreUndefinedProperties,t)}function Lf(n,e,t,r,o,a={}){const c=n.bc(a.merge||a.mergeFields?2:0,e,t,o);m0("Data must be an object, but it was:",c,r);const d=x2(r,c);let h,m;if(a.merge)h=new _r(c.fieldMask),m=c.fieldTransforms;else if(a.mergeFields){const g=[];for(const x of a.mergeFields){const S=ad(e,x,t);if(!c.contains(S))throw new je(ye.INVALID_ARGUMENT,`Field '${S}' is specified in your field mask but missing from your input data.`);v2(g,S)||g.push(S)}h=new _r(g),m=c.fieldTransforms.filter(x=>h.covers(x.field))}else h=null,m=c.fieldTransforms;return new nB(new Yn(d),h,m)}class jd extends zs{_toFieldTransform(e){if(e.Ic!==2)throw e.Ic===1?e.gc(`${this._methodName}() can only appear at the top level of your update data`):e.gc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof jd}}function g2(n,e,t){return new Mf({Ic:3,wc:e.settings.wc,methodName:n._methodName,Rc:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class c0 extends zs{_toFieldTransform(e){return new xd(e.path,new sc)}isEqual(e){return e instanceof c0}}class u0 extends zs{constructor(e,t){super(e),this.Sc=t}_toFieldTransform(e){const t=g2(this,e,!0),r=this.Sc.map(a=>Va(a,t)),o=new Ca(r);return new xd(e.path,o)}isEqual(e){return e instanceof u0&&yi(this.Sc,e.Sc)}}class d0 extends zs{constructor(e,t){super(e),this.Sc=t}_toFieldTransform(e){const t=g2(this,e,!0),r=this.Sc.map(a=>Va(a,t)),o=new Ra(r);return new xd(e.path,o)}isEqual(e){return e instanceof d0&&yi(this.Sc,e.Sc)}}class h0 extends zs{constructor(e,t){super(e),this.Dc=t}_toFieldTransform(e){const t=new ac(e.serializer,WT(e.serializer,this.Dc));return new xd(e.path,t)}isEqual(e){return e instanceof h0&&this.Dc===e.Dc}}function p0(n,e,t,r){const o=n.bc(1,e,t);m0("Data must be an object, but it was:",o,r);const a=[],c=Yn.empty();As(r,(h,m)=>{const g=Of(e,h,t);m=Dt(m);const x=o.mc(g);if(m instanceof jd)a.push(g);else{const S=Va(m,x);S!=null&&(a.push(g),c.set(g,S))}});const d=new _r(a);return new f2(c,d,o.fieldTransforms)}function f0(n,e,t,r,o,a){const c=n.bc(1,e,t),d=[ad(e,r,t)],h=[o];if(a.length%2!=0)throw new je(ye.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let S=0;S<a.length;S+=2)d.push(ad(e,a[S])),h.push(a[S+1]);const m=[],g=Yn.empty();for(let S=d.length-1;S>=0;--S)if(!v2(m,d[S])){const C=d[S];let _=h[S];_=Dt(_);const I=c.mc(C);if(_ instanceof jd)m.push(C);else{const T=Va(_,I);T!=null&&(m.push(C),g.set(C,T))}}const x=new _r(m);return new f2(g,x,c.fieldTransforms)}function y2(n,e,t,r=!1){return Va(t,n.bc(r?4:3,e))}function Va(n,e){if(b2(n=Dt(n)))return m0("Unsupported field value:",e,n),x2(n,e);if(n instanceof zs)return function(r,o){if(!m2(o.Ic))throw o.gc(`${r._methodName}() can only be used with update() and set()`);if(!o.path)throw o.gc(`${r._methodName}() is not currently supported inside arrays`);const a=r._toFieldTransform(o);a&&o.fieldTransforms.push(a)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.Rc&&e.Ic!==4)throw e.gc("Nested arrays are not supported");return function(r,o){const a=[];let c=0;for(const d of r){let h=Va(d,o.fc(c));h==null&&(h={nullValue:"NULL_VALUE"}),a.push(h),c++}return{arrayValue:{values:a}}}(n,e)}return function(r,o){if((r=Dt(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return WT(o.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const a=Gt.fromDate(r);return{timestampValue:lc(o.serializer,a)}}if(r instanceof Gt){const a=new Gt(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:lc(o.serializer,a)}}if(r instanceof Nf)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Is)return{bytesValue:ZT(o.serializer,r._byteString)};if(r instanceof yn){const a=o.databaseId,c=r.firestore._databaseId;if(!c.isEqual(a))throw o.gc(`Document reference is for database ${c.projectId}/${c.database} but should be for database ${a.projectId}/${a.database}`);return{referenceValue:Px(r.firestore._databaseId||o.databaseId,r._key.path)}}if(r instanceof _d)return function(c,d){return{mapValue:{fields:{[wx]:{stringValue:Sx},[rc]:{arrayValue:{values:c.toArray().map(m=>{if(typeof m!="number")throw d.gc("VectorValues must only contain numeric values.");return jx(d.serializer,m)})}}}}}}(r,o);throw o.gc(`Unsupported field value: ${Df(r)}`)}(n,e)}function x2(n,e){const t={};return fT(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):As(n,(r,o)=>{const a=Va(o,e.Ac(r));a!=null&&(t[r]=a)}),{mapValue:{fields:t}}}function b2(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Gt||n instanceof Nf||n instanceof Is||n instanceof yn||n instanceof zs||n instanceof _d)}function m0(n,e,t){if(!b2(t)||!function(o){return typeof o=="object"&&o!==null&&(Object.getPrototypeOf(o)===Object.prototype||Object.getPrototypeOf(o)===null)}(t)){const r=Df(t);throw r==="an object"?e.gc(n+" a custom object"):e.gc(n+" "+r)}}function ad(n,e,t){if((e=Dt(e))instanceof Fs)return e._internalPath;if(typeof e=="string")return Of(n,e);throw Yp("Field path arguments must be of type string or ",n,!1,void 0,t)}const iB=new RegExp("[~\\*/\\[\\]]");function Of(n,e,t){if(e.search(iB)>=0)throw Yp(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Fs(...e.split("."))._internalPath}catch{throw Yp(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Yp(n,e,t,r,o){const a=r&&!r.isEmpty(),c=o!==void 0;let d=`Function ${e}() called with invalid data`;t&&(d+=" (via `toFirestore()`)"),d+=". ";let h="";return(a||c)&&(h+=" (found",a&&(h+=` in field ${r}`),c&&(h+=` in document ${o}`),h+=")"),new je(ye.INVALID_ARGUMENT,d+n+h)}function v2(n,e){return n.some(t=>t.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ld{constructor(e,t,r,o,a){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=o,this._converter=a}get id(){return this._key.path.lastSegment()}get ref(){return new yn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new oB(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(Wf("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class oB extends ld{data(){return super.data()}}function Wf(n,e){return typeof e=="string"?Of(n,e):e instanceof Fs?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function w2(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new je(ye.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class g0{}class Ec extends g0{}function hr(n,e,...t){let r=[];e instanceof g0&&r.push(e),r=r.concat(t),function(a){const c=a.filter(h=>h instanceof Ua).length,d=a.filter(h=>h instanceof Ac).length;if(c>1||c>0&&d>0)throw new je(ye.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const o of r)n=o._apply(n);return n}class Ac extends Ec{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new Ac(e,t,r)}_apply(e){const t=this._parse(e);return k2(e._query,t),new qn(e.firestore,e.converter,Ey(e._query,t))}_parse(e){const t=Wa(e.firestore);return function(a,c,d,h,m,g,x){let S;if(m.isKeyField()){if(g==="array-contains"||g==="array-contains-any")throw new je(ye.INVALID_ARGUMENT,`Invalid Query. You can't perform '${g}' queries on documentId().`);if(g==="in"||g==="not-in"){q1(x,g);const _=[];for(const I of x)_.push(U1(h,a,I));S={arrayValue:{values:_}}}else S=U1(h,a,x)}else g!=="in"&&g!=="not-in"&&g!=="array-contains-any"||q1(x,g),S=y2(d,c,x,g==="in"||g==="not-in");return Ct.create(m,g,S)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function Rn(n,e,t){const r=e,o=Wf("where",n);return Ac._create(o,r,t)}class Ua extends g0{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new Ua(e,t)}_parse(e){const t=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return t.length===1?t[0]:Vt.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:(function(o,a){let c=o;const d=a.getFlattenedFilters();for(const h of d)k2(c,h),c=Ey(c,h)}(e._query,t),new qn(e.firestore,e.converter,Ey(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function sB(...n){return n.forEach(e=>T2("or",e)),Ua._create("or",n)}function aB(...n){return n.forEach(e=>T2("and",e)),Ua._create("and",n)}class Vf extends Ec{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new Vf(e,t)}_apply(e){const t=function(o,a,c){if(o.startAt!==null)throw new je(ye.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(o.endAt!==null)throw new je(ye.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new id(a,c)}(e._query,this._field,this._direction);return new qn(e.firestore,e.converter,function(o,a){const c=o.explicitOrderBy.concat([a]);return new _o(o.path,o.collectionGroup,c,o.filters.slice(),o.limit,o.limitType,o.startAt,o.endAt)}(e._query,t))}}function Xp(n,e="asc"){const t=e,r=Wf("orderBy",n);return Vf._create(r,t)}class Id extends Ec{constructor(e,t,r){super(),this.type=e,this._limit=t,this._limitType=r}static _create(e,t,r){return new Id(e,t,r)}_apply(e){return new qn(e.firestore,e.converter,Op(e._query,this._limit,this._limitType))}}function lB(n){return a2("limit",n),Id._create("limit",n,"F")}function cB(n){return a2("limitToLast",n),Id._create("limitToLast",n,"L")}class Cd extends Ec{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new Cd(e,t,r)}_apply(e){const t=S2(e,this.type,this._docOrFields,this._inclusive);return new qn(e.firestore,e.converter,function(o,a){return new _o(o.path,o.collectionGroup,o.explicitOrderBy.slice(),o.filters.slice(),o.limit,o.limitType,a,o.endAt)}(e._query,t))}}function uB(...n){return Cd._create("startAt",n,!0)}function dB(...n){return Cd._create("startAfter",n,!1)}class Rd extends Ec{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new Rd(e,t,r)}_apply(e){const t=S2(e,this.type,this._docOrFields,this._inclusive);return new qn(e.firestore,e.converter,function(o,a){return new _o(o.path,o.collectionGroup,o.explicitOrderBy.slice(),o.filters.slice(),o.limit,o.limitType,o.startAt,a)}(e._query,t))}}function hB(...n){return Rd._create("endBefore",n,!1)}function pB(...n){return Rd._create("endAt",n,!0)}function S2(n,e,t,r){if(t[0]=Dt(t[0]),t[0]instanceof ld)return function(a,c,d,h,m){if(!h)throw new je(ye.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${d}().`);const g=[];for(const x of Ul(a))if(x.field.isKeyField())g.push(ja(c,h.key));else{const S=h.data.field(x.field);if(kf(S))throw new je(ye.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+x.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(S===null){const C=x.field.canonicalString();throw new je(ye.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${C}' (used as the orderBy) does not exist.`)}g.push(S)}return new ks(g,m)}(n._query,n.firestore._databaseId,e,t[0]._document,r);{const o=Wa(n.firestore);return function(c,d,h,m,g,x){const S=c.explicitOrderBy;if(g.length>S.length)throw new je(ye.INVALID_ARGUMENT,`Too many arguments provided to ${m}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const C=[];for(let _=0;_<g.length;_++){const I=g[_];if(S[_].field.isKeyField()){if(typeof I!="string")throw new je(ye.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${m}(), but got a ${typeof I}`);if(!Tx(c)&&I.indexOf("/")!==-1)throw new je(ye.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${m}() must be a plain document ID, but '${I}' contains a slash.`);const T=c.path.child(It.fromString(I));if(!We.isDocumentKey(T))throw new je(ye.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${m}() must result in a valid document path, but '${T}' is not because it contains an odd number of segments.`);const F=new We(T);C.push(ja(d,F))}else{const T=y2(h,m,I);C.push(T)}}return new ks(C,x)}(n._query,n.firestore._databaseId,o,e,t,r)}}function U1(n,e,t){if(typeof(t=Dt(t))=="string"){if(t==="")throw new je(ye.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Tx(e)&&t.indexOf("/")!==-1)throw new je(ye.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const r=e.path.child(It.fromString(t));if(!We.isDocumentKey(r))throw new je(ye.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return ja(n,new We(r))}if(t instanceof yn)return ja(n,t._key);throw new je(ye.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Df(t)}.`)}function q1(n,e){if(!Array.isArray(n)||n.length===0)throw new je(ye.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function k2(n,e){const t=function(o,a){for(const c of o)for(const d of c.getFlattenedFilters())if(a.indexOf(d.op)>=0)return d.op;return null}(n.filters,function(o){switch(o){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new je(ye.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new je(ye.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}function T2(n,e){if(!(e instanceof Ac||e instanceof Ua))throw new je(ye.INVALID_ARGUMENT,`Function ${n}() requires AppliableConstraints created with a call to 'where(...)', 'or(...)', or 'and(...)'.`)}class y0{convertValue(e,t="none"){switch(ws(e)){case 0:return null;case 1:return e.booleanValue;case 2:return cn(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(So(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Ke(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const r={};return As(e,(o,a)=>{r[o]=this.convertValue(a,t)}),r}convertVectorValue(e){var t,r,o;const a=(o=(r=(t=e.fields)===null||t===void 0?void 0:t[rc].arrayValue)===null||r===void 0?void 0:r.values)===null||o===void 0?void 0:o.map(c=>cn(c.doubleValue));return new _d(a)}convertGeoPoint(e){return new Nf(cn(e.latitude),cn(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":const r=Tf(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(ed(e));default:return null}}convertTimestamp(e){const t=wo(e);return new Gt(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=It.fromString(e);tt(u_(r),9688,{name:e});const o=new vs(r.get(1),r.get(3)),a=new We(r.popFirst(5));return o.isEqual(t)||bn(`Document ${a} contains a document reference within a different database (${o.projectId}/${o.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),a}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Uf(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}class fB extends y0{constructor(e){super(),this.firestore=e}convertBytes(e){return new Is(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new yn(this.firestore,null,t)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mB(n){return new gc("sum",ad("sum",n))}function gB(n){return new gc("avg",ad("average",n))}function _2(){return new gc("count")}function yB(n,e){var t,r;return n instanceof gc&&e instanceof gc&&n.aggregateType===e.aggregateType&&((t=n._internalFieldPath)===null||t===void 0?void 0:t.canonicalString())===((r=e._internalFieldPath)===null||r===void 0?void 0:r.canonicalString())}function xB(n,e){return l0(n.query,e.query)&&yi(n.data(),e.data())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ds{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Fa extends ld{constructor(e,t,r,o,a,c){super(e,t,r,o,c),this._firestore=e,this._firestoreImpl=e,this.metadata=a}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new qu(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(Wf("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}}class qu extends Fa{data(e={}){return super.data(e)}}class za{constructor(e,t,r,o){this._firestore=e,this._userDataWriter=t,this._snapshot=o,this.metadata=new ds(o.hasPendingWrites,o.fromCache),this.query=r}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new qu(this._firestore,this._userDataWriter,r.key,r,new ds(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new je(ye.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(o,a){if(o._snapshot.oldDocs.isEmpty()){let c=0;return o._snapshot.docChanges.map(d=>{const h=new qu(o._firestore,o._userDataWriter,d.doc.key,d.doc,new ds(o._snapshot.mutatedKeys.has(d.doc.key),o._snapshot.fromCache),o.query.converter);return d.doc,{type:"added",doc:h,oldIndex:-1,newIndex:c++}})}{let c=o._snapshot.oldDocs;return o._snapshot.docChanges.filter(d=>a||d.type!==3).map(d=>{const h=new qu(o._firestore,o._userDataWriter,d.doc.key,d.doc,new ds(o._snapshot.mutatedKeys.has(d.doc.key),o._snapshot.fromCache),o.query.converter);let m=-1,g=-1;return d.type!==0&&(m=c.indexOf(d.doc.key),c=c.delete(d.doc.key)),d.type!==1&&(c=c.add(d.doc),g=c.indexOf(d.doc.key)),{type:bB(d.type),doc:h,oldIndex:m,newIndex:g}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function bB(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ke(61501,{type:n})}}function vB(n,e){return n instanceof Fa&&e instanceof Fa?n._firestore===e._firestore&&n._key.isEqual(e._key)&&(n._document===null?e._document===null:n._document.isEqual(e._document))&&n._converter===e._converter:n instanceof za&&e instanceof za&&n._firestore===e._firestore&&l0(n.query,e.query)&&n.metadata.isEqual(e.metadata)&&n._snapshot.isEqual(e._snapshot)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cs(n){n=Tt(n,yn);const e=Tt(n.firestore,qt);return r2(dn(e),n._key).then(t=>b0(e,n,t))}class Ds extends y0{constructor(e){super(),this.firestore=e}convertBytes(e){return new Is(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new yn(this.firestore,null,t)}}function wB(n){n=Tt(n,yn);const e=Tt(n.firestore,qt),t=dn(e),r=new Ds(e);return PP(t,n._key).then(o=>new Fa(e,r,n._key,o,new ds(o!==null&&o.hasLocalMutations,!0),n.converter))}function SB(n){n=Tt(n,yn);const e=Tt(n.firestore,qt);return r2(dn(e),n._key,{source:"server"}).then(t=>b0(e,n,t))}function Mr(n){n=Tt(n,qn);const e=Tt(n.firestore,qt),t=dn(e),r=new Ds(e);return w2(n._query),i2(t,n._query).then(o=>new za(e,r,n,o))}function kB(n){n=Tt(n,qn);const e=Tt(n.firestore,qt),t=dn(e),r=new Ds(e);return BP(t,n._query).then(o=>new za(e,r,n,o))}function TB(n){n=Tt(n,qn);const e=Tt(n.firestore,qt),t=dn(e),r=new Ds(e);return i2(t,n._query,{source:"server"}).then(o=>new za(e,r,n,o))}function Ed(n,e,t){n=Tt(n,yn);const r=Tt(n.firestore,qt),o=Uf(n.converter,e,t);return Pc(r,[Lf(Wa(r),"setDoc",n._key,o,n.converter!==null,t).toMutation(n._key,un.none())])}function Jp(n,e,t,...r){n=Tt(n,yn);const o=Tt(n.firestore,qt),a=Wa(o);let c;return c=typeof(e=Dt(e))=="string"||e instanceof Fs?f0(a,"updateDoc",n._key,e,t,r):p0(a,"updateDoc",n._key,e),Pc(o,[c.toMutation(n._key,un.exists(!0))])}function Zp(n){return Pc(Tt(n.firestore,qt),[new Tc(n._key,un.none())])}function ys(n,e){const t=Tt(n.firestore,qt),r=Vn(n),o=Uf(n.converter,e);return Pc(t,[Lf(Wa(n.firestore),"addDoc",r._key,o,n.converter!==null,{}).toMutation(r._key,un.exists(!1))]).then(()=>r)}function x0(n,...e){var t,r,o;n=Dt(n);let a={includeMetadataChanges:!1,source:"default"},c=0;typeof e[c]!="object"||Uy(e[c])||(a=e[c],c++);const d={includeMetadataChanges:a.includeMetadataChanges,source:a.source};if(Uy(e[c])){const x=e[c];e[c]=(t=x.next)===null||t===void 0?void 0:t.bind(x),e[c+1]=(r=x.error)===null||r===void 0?void 0:r.bind(x),e[c+2]=(o=x.complete)===null||o===void 0?void 0:o.bind(x)}let h,m,g;if(n instanceof yn)m=Tt(n.firestore,qt),g=Sc(n._key.path),h={next:x=>{e[c]&&e[c](b0(m,n,x))},error:e[c+1],complete:e[c+2]};else{const x=Tt(n,qn);m=Tt(x.firestore,qt),g=x._query;const S=new Ds(m);h={next:C=>{e[c]&&e[c](new za(m,S,x,C))},error:e[c+1],complete:e[c+2]},w2(n._query)}return function(S,C,_,I){const T=new Ff(I),F=new Xx(C,T,_);return S.asyncQueue.enqueueAndForget(async()=>Kx(await mc(S),F)),()=>{T.xu(),S.asyncQueue.enqueueAndForget(async()=>Qx(await mc(S),F))}}(dn(m),g,d,h)}function _B(n,e){return zP(dn(n=Tt(n,qt)),Uy(e)?e:{next:e})}function Pc(n,e){return function(r,o){const a=new Un;return r.asyncQueue.enqueueAndForget(async()=>uP(await s0(r),o,a)),a.promise}(dn(n),e)}function b0(n,e,t){const r=t.docs.get(e._key),o=new Ds(n);return new Fa(n,o,e._key,r,new ds(t.hasPendingWrites,t.fromCache),e.converter)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jB(n){return j2(n,{count:_2()})}function j2(n,e){const t=Tt(n.firestore,qt),r=dn(t),o=pT(e,(a,c)=>new KT(c,a.aggregateType,a._internalFieldPath));return FP(r,n._query,o).then(a=>function(d,h,m){const g=new Ds(d);return new p2(h,g,m)}(t,n,a))}class IB{constructor(e){this.kind="memory",this._onlineComponentProvider=_s.provider,e!=null&&e.garbageCollector?this._offlineComponentProvider=e.garbageCollector._offlineComponentProvider:this._offlineComponentProvider={build:()=>new r0(void 0)}}toJSON(){return{kind:this.kind}}}class CB{constructor(e){let t;this.kind="persistent",e!=null&&e.tabManager?(e.tabManager._initialize(e),t=e.tabManager):(t=I2(void 0),t._initialize(e)),this._onlineComponentProvider=t._onlineComponentProvider,this._offlineComponentProvider=t._offlineComponentProvider}toJSON(){return{kind:this.kind}}}class RB{constructor(){this.kind="memoryEager",this._offlineComponentProvider=fc.provider}toJSON(){return{kind:this.kind}}}class EB{constructor(e){this.kind="memoryLru",this._offlineComponentProvider={build:()=>new r0(e)}}toJSON(){return{kind:this.kind}}}function AB(){return new RB}function PB(n){return new EB(n==null?void 0:n.cacheSizeBytes)}function BB(n){return new IB(n)}function FB(n){return new CB(n)}class zB{constructor(e){this.forceOwnership=e,this.kind="persistentSingleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=_s.provider,this._offlineComponentProvider={build:t=>new i0(t,e==null?void 0:e.cacheSizeBytes,this.forceOwnership)}}}class DB{constructor(){this.kind="PersistentMultipleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=_s.provider,this._offlineComponentProvider={build:t=>new Z_(t,e==null?void 0:e.cacheSizeBytes)}}}function I2(n){return new zB(n==null?void 0:n.forceOwnership)}function NB(){return new DB}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MB={maxAttempts:5};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C2{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=Wa(e)}set(e,t,r){this._verifyNotCommitted();const o=hs(e,this._firestore),a=Uf(o.converter,t,r),c=Lf(this._dataReader,"WriteBatch.set",o._key,a,o.converter!==null,r);return this._mutations.push(c.toMutation(o._key,un.none())),this}update(e,t,r,...o){this._verifyNotCommitted();const a=hs(e,this._firestore);let c;return c=typeof(t=Dt(t))=="string"||t instanceof Fs?f0(this._dataReader,"WriteBatch.update",a._key,t,r,o):p0(this._dataReader,"WriteBatch.update",a._key,t),this._mutations.push(c.toMutation(a._key,un.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=hs(e,this._firestore);return this._mutations=this._mutations.concat(new Tc(t._key,un.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new je(ye.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function hs(n,e){if((n=Dt(n)).firestore!==e)throw new je(ye.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LB{constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=Wa(e)}get(e){const t=hs(e,this._firestore),r=new fB(this._firestore);return this._transaction.lookup([t._key]).then(o=>{if(!o||o.length!==1)return Ke(24041);const a=o[0];if(a.isFoundDocument())return new ld(this._firestore,r,a.key,a,t.converter);if(a.isNoDocument())return new ld(this._firestore,r,t._key,null,t.converter);throw Ke(18433,{doc:a})})}set(e,t,r){const o=hs(e,this._firestore),a=Uf(o.converter,t,r),c=Lf(this._dataReader,"Transaction.set",o._key,a,o.converter!==null,r);return this._transaction.set(o._key,c),this}update(e,t,r,...o){const a=hs(e,this._firestore);let c;return c=typeof(t=Dt(t))=="string"||t instanceof Fs?f0(this._dataReader,"Transaction.update",a._key,t,r,o):p0(this._dataReader,"Transaction.update",a._key,t),this._transaction.update(a._key,c),this}delete(e){const t=hs(e,this._firestore);return this._transaction.delete(t._key),this}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R2 extends LB{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=hs(e,this._firestore),r=new Ds(this._firestore);return super.get(e).then(o=>new Fa(this._firestore,r,t._key,o._document,new ds(!1,!1),t.converter))}}function OB(n,e,t){n=Tt(n,qt);const r=Object.assign(Object.assign({},MB),t);return function(a){if(a.maxAttempts<1)throw new je(ye.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(a,c,d){const h=new Un;return a.asyncQueue.enqueueAndForget(async()=>{const m=await n2(a);new CP(a.asyncQueue,m,d,c,h).Wu()}),h.promise}(dn(n),o=>e(new R2(n,o)),r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WB(){return new jd("deleteField")}function v0(){return new c0("serverTimestamp")}function VB(...n){return new u0("arrayUnion",n)}function UB(...n){return new d0("arrayRemove",n)}function qB(n){return new h0("increment",n)}function HB(n){return new _d(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $B(n){return dn(n=Tt(n,qt)),new C2(n,e=>Pc(n,e))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GB(n,e){const t=dn(n=Tt(n,qt));if(!t._uninitializedComponentsProvider||t._uninitializedComponentsProvider._offline.kind==="memory")return Or("Cannot enable indexes when persistence is disabled"),Promise.resolve();const r=function(a){const c=typeof a=="string"?function(m){try{return JSON.parse(m)}catch(g){throw new je(ye.INVALID_ARGUMENT,"Failed to parse JSON: "+(g==null?void 0:g.message))}}(a):a,d=[];if(Array.isArray(c.indexes))for(const h of c.indexes){const m=H1(h,"collectionGroup"),g=[];if(Array.isArray(h.fields))for(const x of h.fields){const S=Of("setIndexConfiguration",H1(x,"fieldPath"));x.arrayConfig==="CONTAINS"?g.push(new va(S,2)):x.order==="ASCENDING"?g.push(new va(S,0)):x.order==="DESCENDING"&&g.push(new va(S,1))}d.push(new Xl(Xl.UNKNOWN_ID,m,g,Jl.empty()))}return d}(e);return MP(t,r)}function H1(n,e){if(typeof n[e]!="string")throw new je(ye.INVALID_ARGUMENT,"Missing string value for: "+e);return n[e]}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E2{constructor(e){this._firestore=e,this.type="PersistentCacheIndexManager"}}function KB(n){var e;n=Tt(n,qt);const t=$1.get(n);if(t)return t;if(((e=dn(n)._uninitializedComponentsProvider)===null||e===void 0?void 0:e._offline.kind)!=="persistent")return null;const r=new E2(n);return $1.set(n,r),r}function QB(n){A2(n,!0)}function YB(n){A2(n,!1)}function XB(n){OP(dn(n._firestore)).then(e=>Ie("deleting all persistent cache indexes succeeded")).catch(e=>Or("deleting all persistent cache indexes failed",e))}function A2(n,e){LP(dn(n._firestore),e).then(t=>Ie(`setting persistent cache index auto creation isEnabled=${e} succeeded`)).catch(t=>Or(`setting persistent cache index auto creation isEnabled=${e} failed`,t))}const $1=new WeakMap;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JB(n){var e;const t=(e=dn(Tt(n.firestore,qt))._onlineComponents)===null||e===void 0?void 0:e.datastore.serializer;return t===void 0?null:Cf(t,or(n._query)).gt}function ZB(n,e){var t;const r=pT(e,(a,c)=>new KT(c,a.aggregateType,a._internalFieldPath)),o=(t=dn(Tt(n.firestore,qt))._onlineComponents)===null||t===void 0?void 0:t.datastore.serializer;return o===void 0?null:s_(o,PT(n._query),r,!0).request}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eF{constructor(){throw new Error("instances of this class should not be created")}static onExistenceFilterMismatch(e){return w0.instance.onExistenceFilterMismatch(e)}}class w0{constructor(){this.vc=new Map}static get instance(){return lp||(lp=new w0,function(t){if(Wp)throw new Error("a TestingHooksSpi instance is already set");Wp=t}(lp)),lp}ht(e){this.vc.forEach(t=>t(e))}onExistenceFilterMismatch(e){const t=Symbol(),r=this.vc;return r.set(t,e),()=>r.delete(t)}}let lp=null;(function(e,t=!0){(function(o){wc=o})(Oa),_a(new xs("firestore",(r,{instanceIdentifier:o,options:a})=>{const c=r.getProvider("app").getImmediate(),d=new qt(new TA(r.getProvider("auth-internal")),new IA(c,r.getProvider("app-check-internal")),function(m,g){if(!Object.prototype.hasOwnProperty.apply(m.options,["projectId"]))throw new je(ye.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new vs(m.options.projectId,g)}(c,o),c);return a=Object.assign({useFetchStreams:t},a),d._setSettings(a),d},"PUBLIC").setMultipleInstances(!0)),Mi(kw,Tw,e),Mi(kw,Tw,"esm2017")})();const ef=Object.freeze(Object.defineProperty({__proto__:null,AbstractUserDataWriter:y0,AggregateField:gc,AggregateQuerySnapshot:p2,Bytes:Is,CACHE_SIZE_UNLIMITED:UP,CollectionReference:mi,DocumentReference:yn,DocumentSnapshot:Fa,FieldPath:Fs,FieldValue:zs,Firestore:qt,FirestoreError:je,GeoPoint:Nf,LoadBundleTask:u2,PersistentCacheIndexManager:E2,Query:qn,QueryCompositeFilterConstraint:Ua,QueryConstraint:Ec,QueryDocumentSnapshot:qu,QueryEndAtConstraint:Rd,QueryFieldFilterConstraint:Ac,QueryLimitConstraint:Id,QueryOrderByConstraint:Vf,QuerySnapshot:za,QueryStartAtConstraint:Cd,SnapshotMetadata:ds,Timestamp:Gt,Transaction:R2,VectorValue:_d,WriteBatch:C2,_AutoId:fx,_ByteString:fn,_DatabaseId:vs,_DocumentKey:We,_EmptyAppCheckTokenProvider:CA,_EmptyAuthCredentialsProvider:Qk,_FieldPath:tn,_TestingHooks:eF,_cast:Tt,_debugAssert:SA,_internalAggregationQueryToProtoRunAggregationQueryRequest:ZB,_internalQueryToProtoQueryTarget:JB,_isBase64Available:u6,_logWarn:Or,_validateIsNotUsedTogether:s2,addDoc:ys,aggregateFieldEqual:yB,aggregateQuerySnapshotEqual:xB,and:aB,arrayRemove:UB,arrayUnion:VB,average:gB,clearIndexedDbPersistence:GP,collection:Cn,collectionGroup:WP,connectFirestoreEmulator:c2,count:_2,deleteAllPersistentCacheIndexes:XB,deleteDoc:Zp,deleteField:WB,disableNetwork:YP,disablePersistentCacheIndexAutoCreation:YB,doc:Vn,documentId:eB,enableIndexedDbPersistence:HP,enableMultiTabIndexedDbPersistence:$P,enableNetwork:QP,enablePersistentCacheIndexAutoCreation:QB,endAt:pB,endBefore:hB,ensureFirestoreConfigured:dn,executeWrite:Pc,getAggregateFromServer:j2,getCountFromServer:jB,getDoc:Cs,getDocFromCache:wB,getDocFromServer:SB,getDocs:Mr,getDocsFromCache:kB,getDocsFromServer:TB,getFirestore:Td,getPersistentCacheIndexManager:KB,increment:qB,initializeFirestore:qP,limit:lB,limitToLast:cB,loadBundle:JP,memoryEagerGarbageCollector:AB,memoryLocalCache:BB,memoryLruGarbageCollector:PB,namedQuery:ZP,onSnapshot:x0,onSnapshotsInSync:_B,or:sB,orderBy:Xp,persistentLocalCache:FB,persistentMultipleTabManager:NB,persistentSingleTabManager:I2,query:hr,queryEqual:l0,refEqual:VP,runTransaction:OB,serverTimestamp:v0,setDoc:Ed,setIndexConfiguration:GB,setLogLevel:wA,snapshotEqual:vB,startAfter:dB,startAt:uB,sum:mB,terminate:XP,updateDoc:Jp,vector:HB,waitForPendingWrites:KP,where:Rn,writeBatch:$B},Symbol.toStringTag,{value:"Module"}));function S0(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(n);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(n,r[o])&&(t[r[o]]=n[r[o]]);return t}function P2(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const B2=P2,F2=new dd("auth","Firebase",P2());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tf=new cx("@firebase/auth");function tF(n,...e){tf.logLevel<=jt.WARN&&tf.warn(`Auth (${Oa}): ${n}`,...e)}function _p(n,...e){tf.logLevel<=jt.ERROR&&tf.error(`Auth (${Oa}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zr(n,...e){throw T0(n,...e)}function gi(n,...e){return T0(n,...e)}function k0(n,e,t){const r=Object.assign(Object.assign({},B2()),{[e]:t});return new dd("auth","Firebase",r).create(e,{appName:n.name})}function xo(n){return k0(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function nF(n,e,t){const r=t;if(!(e instanceof r))throw r.name!==e.constructor.name&&Zr(n,"argument-error"),k0(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function T0(n,...e){if(typeof n!="string"){const t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return F2.create(n,...e)}function ht(n,e,...t){if(!n)throw T0(e,...t)}function go(n){const e="INTERNAL ASSERTION FAILED: "+n;throw _p(e),new Error(e)}function ko(n,e){n||go(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qy(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function rF(){return G1()==="http:"||G1()==="https:"}function G1(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iF(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(rF()||ZR()||"connection"in navigator)?navigator.onLine:!0}function oF(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ad{constructor(e,t){this.shortDelay=e,this.longDelay=t,ko(t>e,"Short delay should be less than long delay!"),this.isMobile=XR()||eE()}get(){return iF()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _0(n,e){ko(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z2{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;go("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;go("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;go("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sF={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aF=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],lF=new Ad(3e4,6e4);function Ro(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}async function Hi(n,e,t,r,o={}){return D2(n,o,async()=>{let a={},c={};r&&(e==="GET"?c=r:a={body:JSON.stringify(r)});const d=hd(Object.assign({key:n.config.apiKey},c)).slice(1),h=await n._getAdditionalHeaders();h["Content-Type"]="application/json",n.languageCode&&(h["X-Firebase-Locale"]=n.languageCode);const m=Object.assign({method:e,headers:h},a);return JR()||(m.referrerPolicy="no-referrer"),n.emulatorConfig&&To(n.emulatorConfig.host)&&(m.credentials="include"),z2.fetch()(await N2(n,n.config.apiHost,t,d),m)})}async function D2(n,e,t){n._canInitEmulator=!1;const r=Object.assign(Object.assign({},sF),e);try{const o=new uF(n),a=await Promise.race([t(),o.promise]);o.clearNetworkTimeout();const c=await a.json();if("needConfirmation"in c)throw cp(n,"account-exists-with-different-credential",c);if(a.ok&&!("errorMessage"in c))return c;{const d=a.ok?c.errorMessage:c.error.message,[h,m]=d.split(" : ");if(h==="FEDERATED_USER_ID_ALREADY_LINKED")throw cp(n,"credential-already-in-use",c);if(h==="EMAIL_EXISTS")throw cp(n,"email-already-in-use",c);if(h==="USER_DISABLED")throw cp(n,"user-disabled",c);const g=r[h]||h.toLowerCase().replace(/[_\s]+/g,"-");if(m)throw k0(n,g,m);Zr(n,g)}}catch(o){if(o instanceof qi)throw o;Zr(n,"network-request-failed",{message:String(o)})}}async function Pd(n,e,t,r,o={}){const a=await Hi(n,e,t,r,o);return"mfaPendingCredential"in a&&Zr(n,"multi-factor-auth-required",{_serverResponse:a}),a}async function N2(n,e,t,r){const o=`${e}${t}?${r}`,a=n,c=a.config.emulator?_0(n.config,o):`${n.config.apiScheme}://${o}`;return aF.includes(t)&&(await a._persistenceManagerAvailable,a._getPersistenceType()==="COOKIE")?a._getPersistence()._getFinalTarget(c).toString():c}function cF(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class uF{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(gi(this.auth,"network-request-failed")),lF.get())})}}function cp(n,e,t){const r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);const o=gi(n,e,r);return o.customData._tokenResponse=t,o}function K1(n){return n!==void 0&&n.enterprise!==void 0}class dF{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return cF(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function hF(n,e){return Hi(n,"GET","/v2/recaptchaConfig",Ro(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function pF(n,e){return Hi(n,"POST","/v1/accounts:delete",e)}async function nf(n,e){return Hi(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hu(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function M2(n,e=!1){const t=Dt(n),r=await t.getIdToken(e),o=j0(r);ht(o&&o.exp&&o.auth_time&&o.iat,t.auth,"internal-error");const a=typeof o.firebase=="object"?o.firebase:void 0,c=a==null?void 0:a.sign_in_provider;return{claims:o,token:r,authTime:Hu(Gg(o.auth_time)),issuedAtTime:Hu(Gg(o.iat)),expirationTime:Hu(Gg(o.exp)),signInProvider:c||null,signInSecondFactor:(a==null?void 0:a.sign_in_second_factor)||null}}function Gg(n){return Number(n)*1e3}function j0(n){const[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return _p("JWT malformed, contained fewer than 3 sections"),null;try{const o=_k(t);return o?JSON.parse(o):(_p("Failed to decode base64 JWT payload"),null)}catch(o){return _p("Caught error parsing JWT payload as JSON",o==null?void 0:o.toString()),null}}function Q1(n){const e=j0(n);return ht(e,"internal-error"),ht(typeof e.exp<"u","internal-error"),ht(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function yc(n,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof qi&&fF(r)&&n.auth.currentUser===n&&await n.auth.signOut(),r}}function fF({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mF{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const o=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,o)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hy{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Hu(this.lastLoginAt),this.creationTime=Hu(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function rf(n){var e;const t=n.auth,r=await n.getIdToken(),o=await yc(n,nf(t,{idToken:r}));ht(o==null?void 0:o.users.length,t,"internal-error");const a=o.users[0];n._notifyReloadListener(a);const c=!((e=a.providerUserInfo)===null||e===void 0)&&e.length?O2(a.providerUserInfo):[],d=gF(n.providerData,c),h=n.isAnonymous,m=!(n.email&&a.passwordHash)&&!(d!=null&&d.length),g=h?m:!1,x={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:d,metadata:new Hy(a.createdAt,a.lastLoginAt),isAnonymous:g};Object.assign(n,x)}async function L2(n){const e=Dt(n);await rf(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function gF(n,e){return[...n.filter(r=>!e.some(o=>o.providerId===r.providerId)),...e]}function O2(n){return n.map(e=>{var{providerId:t}=e,r=S0(e,["providerId"]);return{providerId:t,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function yF(n,e){const t=await D2(n,{},async()=>{const r=hd({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:o,apiKey:a}=n.config,c=await N2(n,o,"/v1/token",`key=${a}`),d=await n._getAdditionalHeaders();d["Content-Type"]="application/x-www-form-urlencoded";const h={method:"POST",headers:d,body:r};return n.emulatorConfig&&To(n.emulatorConfig.host)&&(h.credentials="include"),z2.fetch()(c,h)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function xF(n,e){return Hi(n,"POST","/v2/accounts:revokeToken",Ro(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hl{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){ht(e.idToken,"internal-error"),ht(typeof e.idToken<"u","internal-error"),ht(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Q1(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){ht(e.length!==0,"internal-error");const t=Q1(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(ht(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:r,refreshToken:o,expiresIn:a}=await yF(e,t);this.updateTokensAndExpiration(r,o,Number(a))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){const{refreshToken:r,accessToken:o,expirationTime:a}=t,c=new Hl;return r&&(ht(typeof r=="string","internal-error",{appName:e}),c.refreshToken=r),o&&(ht(typeof o=="string","internal-error",{appName:e}),c.accessToken=o),a&&(ht(typeof a=="number","internal-error",{appName:e}),c.expirationTime=a),c}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Hl,this.toJSON())}_performRefresh(){return go("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function os(n,e){ht(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class fi{constructor(e){var{uid:t,auth:r,stsTokenManager:o}=e,a=S0(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new mF(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=r,this.stsTokenManager=o,this.accessToken=o.accessToken,this.displayName=a.displayName||null,this.email=a.email||null,this.emailVerified=a.emailVerified||!1,this.phoneNumber=a.phoneNumber||null,this.photoURL=a.photoURL||null,this.isAnonymous=a.isAnonymous||!1,this.tenantId=a.tenantId||null,this.providerData=a.providerData?[...a.providerData]:[],this.metadata=new Hy(a.createdAt||void 0,a.lastLoginAt||void 0)}async getIdToken(e){const t=await yc(this,this.stsTokenManager.getToken(this.auth,e));return ht(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return M2(this,e)}reload(){return L2(this)}_assign(e){this!==e&&(ht(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new fi(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){ht(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await rf(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(kr(this.auth.app))return Promise.reject(xo(this.auth));const e=await this.getIdToken();return await yc(this,pF(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var r,o,a,c,d,h,m,g;const x=(r=t.displayName)!==null&&r!==void 0?r:void 0,S=(o=t.email)!==null&&o!==void 0?o:void 0,C=(a=t.phoneNumber)!==null&&a!==void 0?a:void 0,_=(c=t.photoURL)!==null&&c!==void 0?c:void 0,I=(d=t.tenantId)!==null&&d!==void 0?d:void 0,T=(h=t._redirectEventId)!==null&&h!==void 0?h:void 0,F=(m=t.createdAt)!==null&&m!==void 0?m:void 0,P=(g=t.lastLoginAt)!==null&&g!==void 0?g:void 0,{uid:B,emailVerified:q,isAnonymous:te,providerData:W,stsTokenManager:L}=t;ht(B&&L,e,"internal-error");const R=Hl.fromJSON(this.name,L);ht(typeof B=="string",e,"internal-error"),os(x,e.name),os(S,e.name),ht(typeof q=="boolean",e,"internal-error"),ht(typeof te=="boolean",e,"internal-error"),os(C,e.name),os(_,e.name),os(I,e.name),os(T,e.name),os(F,e.name),os(P,e.name);const A=new fi({uid:B,auth:e,email:S,emailVerified:q,displayName:x,isAnonymous:te,photoURL:_,phoneNumber:C,tenantId:I,stsTokenManager:R,createdAt:F,lastLoginAt:P});return W&&Array.isArray(W)&&(A.providerData=W.map(N=>Object.assign({},N))),T&&(A._redirectEventId=T),A}static async _fromIdTokenResponse(e,t,r=!1){const o=new Hl;o.updateFromServerResponse(t);const a=new fi({uid:t.localId,auth:e,stsTokenManager:o,isAnonymous:r});return await rf(a),a}static async _fromGetAccountInfoResponse(e,t,r){const o=t.users[0];ht(o.localId!==void 0,"internal-error");const a=o.providerUserInfo!==void 0?O2(o.providerUserInfo):[],c=!(o.email&&o.passwordHash)&&!(a!=null&&a.length),d=new Hl;d.updateFromIdToken(r);const h=new fi({uid:o.localId,auth:e,stsTokenManager:d,isAnonymous:c}),m={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:a,metadata:new Hy(o.createdAt,o.lastLoginAt),isAnonymous:!(o.email&&o.passwordHash)&&!(a!=null&&a.length)};return Object.assign(h,m),h}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Y1=new Map;function yo(n){ko(n instanceof Function,"Expected a class definition");let e=Y1.get(n);return e?(ko(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,Y1.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W2{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}W2.type="NONE";const $y=W2;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jp(n,e,t){return`firebase:${n}:${e}:${t}`}class $l{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;const{config:o,name:a}=this.auth;this.fullUserKey=jp(this.userKey,o.apiKey,a),this.fullPersistenceKey=jp("persistence",o.apiKey,a),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await nf(this.auth,{idToken:e}).catch(()=>{});return t?fi._fromGetAccountInfoResponse(this.auth,t,e):null}return fi._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new $l(yo($y),e,r);const o=(await Promise.all(t.map(async m=>{if(await m._isAvailable())return m}))).filter(m=>m);let a=o[0]||yo($y);const c=jp(r,e.config.apiKey,e.name);let d=null;for(const m of t)try{const g=await m._get(c);if(g){let x;if(typeof g=="string"){const S=await nf(e,{idToken:g}).catch(()=>{});if(!S)break;x=await fi._fromGetAccountInfoResponse(e,S,g)}else x=fi._fromJSON(e,g);m!==a&&(d=x),a=m;break}}catch{}const h=o.filter(m=>m._shouldAllowMigration);return!a._shouldAllowMigration||!h.length?new $l(a,e,r):(a=h[0],d&&await a._set(c,d.toJSON()),await Promise.all(t.map(async m=>{if(m!==a)try{await m._remove(c)}catch{}})),new $l(a,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function X1(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(H2(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(V2(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(G2(e))return"Blackberry";if(K2(e))return"Webos";if(U2(e))return"Safari";if((e.includes("chrome/")||q2(e))&&!e.includes("edge/"))return"Chrome";if($2(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function V2(n=Pn()){return/firefox\//i.test(n)}function U2(n=Pn()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function q2(n=Pn()){return/crios\//i.test(n)}function H2(n=Pn()){return/iemobile/i.test(n)}function $2(n=Pn()){return/android/i.test(n)}function G2(n=Pn()){return/blackberry/i.test(n)}function K2(n=Pn()){return/webos/i.test(n)}function I0(n=Pn()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function bF(n=Pn()){var e;return I0(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function vF(){return tE()&&document.documentMode===10}function Q2(n=Pn()){return I0(n)||$2(n)||K2(n)||G2(n)||/windows phone/i.test(n)||H2(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Y2(n,e=[]){let t;switch(n){case"Browser":t=X1(Pn());break;case"Worker":t=`${X1(Pn())}-${n}`;break;default:t=n}const r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Oa}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wF{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const r=a=>new Promise((c,d)=>{try{const h=e(a);c(h)}catch(h){d(h)}});r.onAbort=t,this.queue.push(r);const o=this.queue.length-1;return()=>{this.queue[o]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(const o of t)try{o()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function SF(n,e={}){return Hi(n,"GET","/v2/passwordPolicy",Ro(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kF=6;class TF{constructor(e){var t,r,o,a;const c=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=c.minPasswordLength)!==null&&t!==void 0?t:kF,c.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=c.maxPasswordLength),c.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=c.containsLowercaseCharacter),c.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=c.containsUppercaseCharacter),c.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=c.containsNumericCharacter),c.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=c.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(o=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&o!==void 0?o:"",this.forceUpgradeOnSignin=(a=e.forceUpgradeOnSignin)!==null&&a!==void 0?a:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,r,o,a,c,d;const h={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,h),this.validatePasswordCharacterOptions(e,h),h.isValid&&(h.isValid=(t=h.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),h.isValid&&(h.isValid=(r=h.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),h.isValid&&(h.isValid=(o=h.containsLowercaseLetter)!==null&&o!==void 0?o:!0),h.isValid&&(h.isValid=(a=h.containsUppercaseLetter)!==null&&a!==void 0?a:!0),h.isValid&&(h.isValid=(c=h.containsNumericCharacter)!==null&&c!==void 0?c:!0),h.isValid&&(h.isValid=(d=h.containsNonAlphanumericCharacter)!==null&&d!==void 0?d:!0),h}validatePasswordLengthOptions(e,t){const r=this.customStrengthOptions.minPasswordLength,o=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),o&&(t.meetsMaxPasswordLength=e.length<=o)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let o=0;o<e.length;o++)r=e.charAt(o),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,o,a){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=o)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _F{constructor(e,t,r,o){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=o,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new J1(this),this.idTokenSubscription=new J1(this),this.beforeStateQueue=new wF(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=F2,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=o.sdkClientVersion,this._persistenceManagerAvailable=new Promise(a=>this._resolvePersistenceManagerAvailable=a)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=yo(t)),this._initializationPromise=this.queue(async()=>{var r,o,a;if(!this._deleted&&(this.persistenceManager=await $l.create(this,e),(r=this._resolvePersistenceManagerAvailable)===null||r===void 0||r.call(this),!this._deleted)){if(!((o=this._popupRedirectResolver)===null||o===void 0)&&o._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((a=this.currentUser)===null||a===void 0?void 0:a.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await nf(this,{idToken:e}),r=await fi._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(kr(this.app)){const c=this.app.settings.authIdToken;return c?new Promise(d=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(c).then(d,d))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let o=r,a=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const c=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,d=o==null?void 0:o._redirectEventId,h=await this.tryRedirectSignIn(e);(!c||c===d)&&(h!=null&&h.user)&&(o=h.user,a=!0)}if(!o)return this.directlySetCurrentUser(null);if(!o._redirectEventId){if(a)try{await this.beforeStateQueue.runMiddleware(o)}catch(c){o=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(c))}return o?this.reloadAndSetCurrentUserOrClear(o):this.directlySetCurrentUser(null)}return ht(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===o._redirectEventId?this.directlySetCurrentUser(o):this.reloadAndSetCurrentUserOrClear(o)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await rf(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=oF()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(kr(this.app))return Promise.reject(xo(this));const t=e?Dt(e):null;return t&&ht(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&ht(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return kr(this.app)?Promise.reject(xo(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return kr(this.app)?Promise.reject(xo(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(yo(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await SF(this),t=new TF(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new dd("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),await xF(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,t){const r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&yo(e)||this._popupRedirectResolver;ht(t,this,"argument-error"),this.redirectPersistenceManager=await $l.create(this,[yo(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,r;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,o){if(this._deleted)return()=>{};const a=typeof t=="function"?t:t.next.bind(t);let c=!1;const d=this._isInitialized?Promise.resolve():this._initializationPromise;if(ht(d,this,"internal-error"),d.then(()=>{c||a(this.currentUser)}),typeof t=="function"){const h=e.addObserver(t,r,o);return()=>{c=!0,h()}}else{const h=e.addObserver(t);return()=>{c=!0,h()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return ht(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Y2(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(t["X-Firebase-Client"]=r);const o=await this._getAppCheckToken();return o&&(t["X-Firebase-AppCheck"]=o),t}async _getAppCheckToken(){var e;if(kr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const t=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return t!=null&&t.error&&tF(`Error while retrieving App Check token: ${t.error}`),t==null?void 0:t.token}}function Eo(n){return Dt(n)}class J1{constructor(e){this.auth=e,this.observer=null,this.addObserver=aE(t=>this.observer=t)}get next(){return ht(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let qf={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function jF(n){qf=n}function X2(n){return qf.loadJS(n)}function IF(){return qf.recaptchaEnterpriseScript}function CF(){return qf.gapiScript}function RF(n){return`__${n}${Math.floor(Math.random()*1e6)}`}class EF{constructor(){this.enterprise=new AF}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class AF{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const PF="recaptcha-enterprise",J2="NO_RECAPTCHA";class BF{constructor(e){this.type=PF,this.auth=Eo(e)}async verify(e="verify",t=!1){async function r(a){if(!t){if(a.tenantId==null&&a._agentRecaptchaConfig!=null)return a._agentRecaptchaConfig.siteKey;if(a.tenantId!=null&&a._tenantRecaptchaConfigs[a.tenantId]!==void 0)return a._tenantRecaptchaConfigs[a.tenantId].siteKey}return new Promise(async(c,d)=>{hF(a,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(h=>{if(h.recaptchaKey===void 0)d(new Error("recaptcha Enterprise site key undefined"));else{const m=new dF(h);return a.tenantId==null?a._agentRecaptchaConfig=m:a._tenantRecaptchaConfigs[a.tenantId]=m,c(m.siteKey)}}).catch(h=>{d(h)})})}function o(a,c,d){const h=window.grecaptcha;K1(h)?h.enterprise.ready(()=>{h.enterprise.execute(a,{action:e}).then(m=>{c(m)}).catch(()=>{c(J2)})}):d(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new EF().execute("siteKey",{action:"verify"}):new Promise((a,c)=>{r(this.auth).then(d=>{if(!t&&K1(window.grecaptcha))o(d,a,c);else{if(typeof window>"u"){c(new Error("RecaptchaVerifier is only supported in browser"));return}let h=IF();h.length!==0&&(h+=d),X2(h).then(()=>{o(d,a,c)}).catch(m=>{c(m)})}}).catch(d=>{c(d)})})}}async function Z1(n,e,t,r=!1,o=!1){const a=new BF(n);let c;if(o)c=J2;else try{c=await a.verify(t)}catch{c=await a.verify(t,!0)}const d=Object.assign({},e);if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in d){const h=d.phoneEnrollmentInfo.phoneNumber,m=d.phoneEnrollmentInfo.recaptchaToken;Object.assign(d,{phoneEnrollmentInfo:{phoneNumber:h,recaptchaToken:m,captchaResponse:c,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in d){const h=d.phoneSignInInfo.recaptchaToken;Object.assign(d,{phoneSignInInfo:{recaptchaToken:h,captchaResponse:c,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return d}return r?Object.assign(d,{captchaResp:c}):Object.assign(d,{captchaResponse:c}),Object.assign(d,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(d,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),d}async function of(n,e,t,r,o){var a;if(!((a=n._getRecaptchaConfig())===null||a===void 0)&&a.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const c=await Z1(n,e,t,t==="getOobCode");return r(n,c)}else return r(n,e).catch(async c=>{if(c.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const d=await Z1(n,e,t,t==="getOobCode");return r(n,d)}else return Promise.reject(c)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Z2(n,e){const t=vc(n,"auth");if(t.isInitialized()){const o=t.getImmediate(),a=t.getOptions();if(yi(a,e??{}))return o;Zr(o,"already-initialized")}return t.initialize({options:e})}function FF(n,e){const t=(e==null?void 0:e.persistence)||[],r=(Array.isArray(t)?t:[t]).map(yo);e!=null&&e.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function ej(n,e,t){const r=Eo(n);ht(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const o=!1,a=tj(e),{host:c,port:d}=zF(e),h=d===null?"":`:${d}`,m={url:`${a}//${c}${h}/`},g=Object.freeze({host:c,port:d,protocol:a.replace(":",""),options:Object.freeze({disableWarnings:o})});if(!r._canInitEmulator){ht(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),ht(yi(m,r.config.emulator)&&yi(g,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=m,r.emulatorConfig=g,r.settings.appVerificationDisabledForTesting=!0,To(c)?(xf(`${a}//${c}${h}`),lx("Auth",!0)):DF()}function tj(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function zF(n){const e=tj(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const r=t[2].split("@").pop()||"",o=/^(\[[^\]]+\])(:|$)/.exec(r);if(o){const a=o[1];return{host:a,port:eS(r.substr(a.length+1))}}else{const[a,c]=r.split(":");return{host:a,port:eS(c)}}}function eS(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function DF(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hf{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return go("not implemented")}_getIdTokenResponse(e){return go("not implemented")}_linkToIdToken(e,t){return go("not implemented")}_getReauthenticationResolver(e){return go("not implemented")}}async function NF(n,e){return Hi(n,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function MF(n,e){return Pd(n,"POST","/v1/accounts:signInWithPassword",Ro(n,e))}async function LF(n,e){return Hi(n,"POST","/v1/accounts:sendOobCode",Ro(n,e))}async function OF(n,e){return LF(n,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function WF(n,e){return Pd(n,"POST","/v1/accounts:signInWithEmailLink",Ro(n,e))}async function VF(n,e){return Pd(n,"POST","/v1/accounts:signInWithEmailLink",Ro(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xc extends Hf{constructor(e,t,r,o=null){super("password",r),this._email=e,this._password=t,this._tenantId=o}static _fromEmailAndPassword(e,t){return new xc(e,t,"password")}static _fromEmailAndCode(e,t,r=null){return new xc(e,t,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t!=null&&t.email&&(t!=null&&t.password)){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return of(e,t,"signInWithPassword",MF);case"emailLink":return WF(e,{email:this._email,oobCode:this._password});default:Zr(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const r={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return of(e,r,"signUpPassword",NF);case"emailLink":return VF(e,{idToken:t,email:this._email,oobCode:this._password});default:Zr(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Gl(n,e){return Pd(n,"POST","/v1/accounts:signInWithIdp",Ro(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UF="http://localhost";class Ui extends Hf{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Ui(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Zr("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:o}=t,a=S0(t,["providerId","signInMethod"]);if(!r||!o)return null;const c=new Ui(r,o);return c.idToken=a.idToken||void 0,c.accessToken=a.accessToken||void 0,c.secret=a.secret,c.nonce=a.nonce,c.pendingToken=a.pendingToken||null,c}_getIdTokenResponse(e){const t=this.buildRequest();return Gl(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,Gl(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Gl(e,t)}buildRequest(){const e={requestUri:UF,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=hd(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qF(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function HF(n){const e=Cu(Ru(n)).link,t=e?Cu(Ru(e)).deep_link_id:null,r=Cu(Ru(n)).deep_link_id;return(r?Cu(Ru(r)).link:null)||r||t||e||n}class $f{constructor(e){var t,r,o,a,c,d;const h=Cu(Ru(e)),m=(t=h.apiKey)!==null&&t!==void 0?t:null,g=(r=h.oobCode)!==null&&r!==void 0?r:null,x=qF((o=h.mode)!==null&&o!==void 0?o:null);ht(m&&g&&x,"argument-error"),this.apiKey=m,this.operation=x,this.code=g,this.continueUrl=(a=h.continueUrl)!==null&&a!==void 0?a:null,this.languageCode=(c=h.lang)!==null&&c!==void 0?c:null,this.tenantId=(d=h.tenantId)!==null&&d!==void 0?d:null}static parseLink(e){const t=HF(e);try{return new $f(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qa{constructor(){this.providerId=qa.PROVIDER_ID}static credential(e,t){return xc._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const r=$f.parseLink(t);return ht(r,"argument-error"),xc._fromEmailAndCode(e,r.code,r.tenantId)}}qa.PROVIDER_ID="password";qa.EMAIL_PASSWORD_SIGN_IN_METHOD="password";qa.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C0{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bc extends C0{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Kl extends Bc{static credentialFromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;return ht("providerId"in t&&"signInMethod"in t,"argument-error"),Ui._fromParams(t)}credential(e){return this._credential(Object.assign(Object.assign({},e),{nonce:e.rawNonce}))}_credential(e){return ht(e.idToken||e.accessToken,"argument-error"),Ui._fromParams(Object.assign(Object.assign({},e),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(e){return Kl.oauthCredentialFromTaggedObject(e)}static credentialFromError(e){return Kl.oauthCredentialFromTaggedObject(e.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r,oauthTokenSecret:o,pendingToken:a,nonce:c,providerId:d}=e;if(!r&&!o&&!t&&!a||!d)return null;try{return new Kl(d)._credential({idToken:t,accessToken:r,nonce:c,pendingToken:a})}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ho extends Bc{constructor(){super("facebook.com")}static credential(e){return Ui._fromParams({providerId:ho.PROVIDER_ID,signInMethod:ho.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ho.credentialFromTaggedObject(e)}static credentialFromError(e){return ho.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ho.credential(e.oauthAccessToken)}catch{return null}}}ho.FACEBOOK_SIGN_IN_METHOD="facebook.com";ho.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fi extends Bc{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Ui._fromParams({providerId:Fi.PROVIDER_ID,signInMethod:Fi.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Fi.credentialFromTaggedObject(e)}static credentialFromError(e){return Fi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r}=e;if(!t&&!r)return null;try{return Fi.credential(t,r)}catch{return null}}}Fi.GOOGLE_SIGN_IN_METHOD="google.com";Fi.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class po extends Bc{constructor(){super("github.com")}static credential(e){return Ui._fromParams({providerId:po.PROVIDER_ID,signInMethod:po.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return po.credentialFromTaggedObject(e)}static credentialFromError(e){return po.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return po.credential(e.oauthAccessToken)}catch{return null}}}po.GITHUB_SIGN_IN_METHOD="github.com";po.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fo extends Bc{constructor(){super("twitter.com")}static credential(e,t){return Ui._fromParams({providerId:fo.PROVIDER_ID,signInMethod:fo.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return fo.credentialFromTaggedObject(e)}static credentialFromError(e){return fo.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:r}=e;if(!t||!r)return null;try{return fo.credential(t,r)}catch{return null}}}fo.TWITTER_SIGN_IN_METHOD="twitter.com";fo.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $F(n,e){return Pd(n,"POST","/v1/accounts:signUp",Ro(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Da{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,o=!1){const a=await fi._fromIdTokenResponse(e,r,o),c=tS(r);return new Da({user:a,providerId:c,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);const o=tS(r);return new Da({user:e,providerId:o,_tokenResponse:r,operationType:t})}}function tS(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sf extends qi{constructor(e,t,r,o){var a;super(t.code,t.message),this.operationType=r,this.user=o,Object.setPrototypeOf(this,sf.prototype),this.customData={appName:e.name,tenantId:(a=e.tenantId)!==null&&a!==void 0?a:void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,o){return new sf(e,t,r,o)}}function nj(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(a=>{throw a.code==="auth/multi-factor-auth-required"?sf._fromErrorAndOperation(n,a,e,r):a})}async function GF(n,e,t=!1){const r=await yc(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return Da._forOperation(n,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function KF(n,e,t=!1){const{auth:r}=n;if(kr(r.app))return Promise.reject(xo(r));const o="reauthenticate";try{const a=await yc(n,nj(r,o,e,n),t);ht(a.idToken,r,"internal-error");const c=j0(a.idToken);ht(c,r,"internal-error");const{sub:d}=c;return ht(n.uid===d,r,"user-mismatch"),Da._forOperation(n,o,a)}catch(a){throw(a==null?void 0:a.code)==="auth/user-not-found"&&Zr(r,"user-mismatch"),a}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function rj(n,e,t=!1){if(kr(n.app))return Promise.reject(xo(n));const r="signIn",o=await nj(n,r,e),a=await Da._fromIdTokenResponse(n,r,o);return t||await n._updateCurrentUser(a.user),a}async function ij(n,e){return rj(Eo(n),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function oj(n){const e=Eo(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function sj(n,e,t){const r=Eo(n);await of(r,{requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"},"getOobCode",OF)}async function R0(n,e,t){if(kr(n.app))return Promise.reject(xo(n));const r=Eo(n),c=await of(r,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",$F).catch(h=>{throw h.code==="auth/password-does-not-meet-requirements"&&oj(n),h}),d=await Da._fromIdTokenResponse(r,"signIn",c);return await r._updateCurrentUser(d.user),d}function aj(n,e,t){return kr(n.app)?Promise.reject(xo(n)):ij(Dt(n),qa.credential(e,t)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&oj(n),r})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function QF(n,e){return Hi(n,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function af(n,{displayName:e,photoURL:t}){if(e===void 0&&t===void 0)return;const r=Dt(n),a={idToken:await r.getIdToken(),displayName:e,photoUrl:t,returnSecureToken:!0},c=await yc(r,QF(r.auth,a));r.displayName=c.displayName||null,r.photoURL=c.photoUrl||null;const d=r.providerData.find(({providerId:h})=>h==="password");d&&(d.displayName=r.displayName,d.photoURL=r.photoURL),await r._updateTokensIfNecessary(c)}function lj(n,e,t,r){return Dt(n).onIdTokenChanged(e,t,r)}function cj(n,e,t){return Dt(n).beforeAuthStateChanged(e,t)}function Ns(n,e,t,r){return Dt(n).onAuthStateChanged(e,t,r)}function Ir(n){return Dt(n).signOut()}const lf="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uj{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(lf,"1"),this.storage.removeItem(lf),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YF=1e3,XF=10;class dj extends uj{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=Q2(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const r=this.storage.getItem(t),o=this.localCache[t];r!==o&&e(t,o,r)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((c,d,h)=>{this.notifyListeners(c,h)});return}const r=e.key;t?this.detachListener():this.stopPolling();const o=()=>{const c=this.storage.getItem(r);!t&&this.localCache[r]===c||this.notifyListeners(r,c)},a=this.storage.getItem(r);vF()&&a!==e.newValue&&e.newValue!==e.oldValue?setTimeout(o,XF):o()}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const o of Array.from(r))o(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:r}),!0)})},YF)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}dj.type="LOCAL";const hj=dj;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pj extends uj{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}pj.type="SESSION";const E0=pj;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JF(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gf{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(o=>o.isListeningto(e));if(t)return t;const r=new Gf(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:r,eventType:o,data:a}=t.data,c=this.handlersMap[o];if(!(c!=null&&c.size))return;t.ports[0].postMessage({status:"ack",eventId:r,eventType:o});const d=Array.from(c).map(async m=>m(t.origin,a)),h=await JF(d);t.ports[0].postMessage({status:"done",eventId:r,eventType:o,response:h})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Gf.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function A0(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZF{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){const o=typeof MessageChannel<"u"?new MessageChannel:null;if(!o)throw new Error("connection_unavailable");let a,c;return new Promise((d,h)=>{const m=A0("",20);o.port1.start();const g=setTimeout(()=>{h(new Error("unsupported_event"))},r);c={messageChannel:o,onMessage(x){const S=x;if(S.data.eventId===m)switch(S.data.status){case"ack":clearTimeout(g),a=setTimeout(()=>{h(new Error("timeout"))},3e3);break;case"done":clearTimeout(a),d(S.data.response);break;default:clearTimeout(g),clearTimeout(a),h(new Error("invalid_response"));break}}},this.handlers.add(c),o.port1.addEventListener("message",c.onMessage),this.target.postMessage({eventType:e,eventId:m,data:t},[o.port2])}).finally(()=>{c&&this.removeMessageHandler(c)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wi(){return window}function e4(n){Wi().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fj(){return typeof Wi().WorkerGlobalScope<"u"&&typeof Wi().importScripts=="function"}async function t4(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function n4(){var n;return((n=navigator==null?void 0:navigator.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function r4(){return fj()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mj="firebaseLocalStorageDb",i4=1,cf="firebaseLocalStorage",gj="fbase_key";class Bd{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Kf(n,e){return n.transaction([cf],e?"readwrite":"readonly").objectStore(cf)}function o4(){const n=indexedDB.deleteDatabase(mj);return new Bd(n).toPromise()}function Gy(){const n=indexedDB.open(mj,i4);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const r=n.result;try{r.createObjectStore(cf,{keyPath:gj})}catch(o){t(o)}}),n.addEventListener("success",async()=>{const r=n.result;r.objectStoreNames.contains(cf)?e(r):(r.close(),await o4(),e(await Gy()))})})}async function nS(n,e,t){const r=Kf(n,!0).put({[gj]:e,value:t});return new Bd(r).toPromise()}async function s4(n,e){const t=Kf(n,!1).get(e),r=await new Bd(t).toPromise();return r===void 0?null:r.value}function rS(n,e){const t=Kf(n,!0).delete(e);return new Bd(t).toPromise()}const a4=800,l4=3;class yj{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Gy(),this.db)}async _withRetries(e){let t=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(t++>l4)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return fj()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Gf._getInstance(r4()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await t4(),!this.activeServiceWorker)return;this.sender=new ZF(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((t=r[0])===null||t===void 0)&&t.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||n4()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Gy();return await nS(e,lf,"1"),await rS(e,lf),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(r=>nS(r,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(r=>s4(r,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>rS(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(o=>{const a=Kf(o,!1).getAll();return new Bd(a).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],r=new Set;if(e.length!==0)for(const{fbase_key:o,value:a}of e)r.add(o),JSON.stringify(this.localCache[o])!==JSON.stringify(a)&&(this.notifyListeners(o,a),t.push(o));for(const o of Object.keys(this.localCache))this.localCache[o]&&!r.has(o)&&(this.notifyListeners(o,null),t.push(o));return t}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const o of Array.from(r))o(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),a4)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}yj.type="LOCAL";const xj=yj;new Ad(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bj(n,e){return e?yo(e):(ht(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P0 extends Hf{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Gl(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Gl(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Gl(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function c4(n){return rj(n.auth,new P0(n),n.bypassAuthState)}function u4(n){const{auth:e,user:t}=n;return ht(t,e,"internal-error"),KF(t,new P0(n),n.bypassAuthState)}async function d4(n){const{auth:e,user:t}=n;return ht(t,e,"internal-error"),GF(t,new P0(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vj{constructor(e,t,r,o,a=!1){this.auth=e,this.resolver=r,this.user=o,this.bypassAuthState=a,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:r,postBody:o,tenantId:a,error:c,type:d}=e;if(c){this.reject(c);return}const h={auth:this.auth,requestUri:t,sessionId:r,tenantId:a||void 0,postBody:o||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(d)(h))}catch(m){this.reject(m)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return c4;case"linkViaPopup":case"linkViaRedirect":return d4;case"reauthViaPopup":case"reauthViaRedirect":return u4;default:Zr(this.auth,"internal-error")}}resolve(e){ko(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){ko(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const h4=new Ad(2e3,1e4);async function Ky(n,e,t){if(kr(n.app))return Promise.reject(gi(n,"operation-not-supported-in-this-environment"));const r=Eo(n);nF(n,e,C0);const o=bj(r,t);return new ga(r,"signInViaPopup",e,o).executeNotNull()}class ga extends vj{constructor(e,t,r,o,a){super(e,t,o,a),this.provider=r,this.authWindow=null,this.pollId=null,ga.currentPopupAction&&ga.currentPopupAction.cancel(),ga.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return ht(e,this.auth,"internal-error"),e}async onExecution(){ko(this.filter.length===1,"Popup operations only handle one event");const e=A0();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(gi(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(gi(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,ga.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,r;if(!((r=(t=this.authWindow)===null||t===void 0?void 0:t.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(gi(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,h4.get())};e()}}ga.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const p4="pendingRedirect",Ip=new Map;class f4 extends vj{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=Ip.get(this.auth._key());if(!e){try{const r=await m4(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}Ip.set(this.auth._key(),e)}return this.bypassAuthState||Ip.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function m4(n,e){const t=x4(e),r=y4(n);if(!await r._isAvailable())return!1;const o=await r._get(t)==="true";return await r._remove(t),o}function g4(n,e){Ip.set(n._key(),e)}function y4(n){return yo(n._redirectPersistence)}function x4(n){return jp(p4,n.config.apiKey,n.name)}async function b4(n,e,t=!1){if(kr(n.app))return Promise.reject(xo(n));const r=Eo(n),o=bj(r,e),c=await new f4(r,o,t).execute();return c&&!t&&(delete c.user._redirectEventId,await r._persistUserIfCurrent(c.user),await r._setRedirectUser(null,e)),c}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const v4=10*60*1e3;class w4{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!S4(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var r;if(e.error&&!wj(e)){const o=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";t.onError(gi(this.auth,o))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=v4&&this.cachedEventUids.clear(),this.cachedEventUids.has(iS(e))}saveEventToCache(e){this.cachedEventUids.add(iS(e)),this.lastProcessedEventTime=Date.now()}}function iS(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function wj({type:n,error:e}){return n==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function S4(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return wj(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function k4(n,e={}){return Hi(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const T4=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,_4=/^https?/;async function j4(n){if(n.config.emulator)return;const{authorizedDomains:e}=await k4(n);for(const t of e)try{if(I4(t))return}catch{}Zr(n,"unauthorized-domain")}function I4(n){const e=qy(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){const c=new URL(n);return c.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&c.hostname===r}if(!_4.test(t))return!1;if(T4.test(n))return r===n;const o=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+o+"|"+o+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C4=new Ad(3e4,6e4);function oS(){const n=Wi().___jsl;if(n!=null&&n.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function R4(n){return new Promise((e,t)=>{var r,o,a;function c(){oS(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{oS(),t(gi(n,"network-request-failed"))},timeout:C4.get()})}if(!((o=(r=Wi().gapi)===null||r===void 0?void 0:r.iframes)===null||o===void 0)&&o.Iframe)e(gapi.iframes.getContext());else if(!((a=Wi().gapi)===null||a===void 0)&&a.load)c();else{const d=RF("iframefcb");return Wi()[d]=()=>{gapi.load?c():t(gi(n,"network-request-failed"))},X2(`${CF()}?onload=${d}`).catch(h=>t(h))}}).catch(e=>{throw Cp=null,e})}let Cp=null;function E4(n){return Cp=Cp||R4(n),Cp}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const A4=new Ad(5e3,15e3),P4="__/auth/iframe",B4="emulator/auth/iframe",F4={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},z4=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function D4(n){const e=n.config;ht(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?_0(e,B4):`https://${n.config.authDomain}/${P4}`,r={apiKey:e.apiKey,appName:n.name,v:Oa},o=z4.get(n.config.apiHost);o&&(r.eid=o);const a=n._getFrameworks();return a.length&&(r.fw=a.join(",")),`${t}?${hd(r).slice(1)}`}async function N4(n){const e=await E4(n),t=Wi().gapi;return ht(t,n,"internal-error"),e.open({where:document.body,url:D4(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:F4,dontclear:!0},r=>new Promise(async(o,a)=>{await r.restyle({setHideOnLeave:!1});const c=gi(n,"network-request-failed"),d=Wi().setTimeout(()=>{a(c)},A4.get());function h(){Wi().clearTimeout(d),o(r)}r.ping(h).then(h,()=>{a(c)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const M4={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},L4=500,O4=600,W4="_blank",V4="http://localhost";class sS{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function U4(n,e,t,r=L4,o=O4){const a=Math.max((window.screen.availHeight-o)/2,0).toString(),c=Math.max((window.screen.availWidth-r)/2,0).toString();let d="";const h=Object.assign(Object.assign({},M4),{width:r.toString(),height:o.toString(),top:a,left:c}),m=Pn().toLowerCase();t&&(d=q2(m)?W4:t),V2(m)&&(e=e||V4,h.scrollbars="yes");const g=Object.entries(h).reduce((S,[C,_])=>`${S}${C}=${_},`,"");if(bF(m)&&d!=="_self")return q4(e||"",d),new sS(null);const x=window.open(e||"",d,g);ht(x,n,"popup-blocked");try{x.focus()}catch{}return new sS(x)}function q4(n,e){const t=document.createElement("a");t.href=n,t.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const H4="__/auth/handler",$4="emulator/auth/handler",G4=encodeURIComponent("fac");async function aS(n,e,t,r,o,a){ht(n.config.authDomain,n,"auth-domain-config-required"),ht(n.config.apiKey,n,"invalid-api-key");const c={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:Oa,eventId:o};if(e instanceof C0){e.setDefaultLanguage(n.languageCode),c.providerId=e.providerId||"",sE(e.getCustomParameters())||(c.customParameters=JSON.stringify(e.getCustomParameters()));for(const[g,x]of Object.entries({}))c[g]=x}if(e instanceof Bc){const g=e.getScopes().filter(x=>x!=="");g.length>0&&(c.scopes=g.join(","))}n.tenantId&&(c.tid=n.tenantId);const d=c;for(const g of Object.keys(d))d[g]===void 0&&delete d[g];const h=await n._getAppCheckToken(),m=h?`#${G4}=${encodeURIComponent(h)}`:"";return`${K4(n)}?${hd(d).slice(1)}${m}`}function K4({config:n}){return n.emulator?_0(n,$4):`https://${n.authDomain}/${H4}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kg="webStorageSupport";class Q4{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=E0,this._completeRedirectFn=b4,this._overrideRedirectResult=g4}async _openPopup(e,t,r,o){var a;ko((a=this.eventManagers[e._key()])===null||a===void 0?void 0:a.manager,"_initialize() not called before _openPopup()");const c=await aS(e,t,r,qy(),o);return U4(e,c,A0())}async _openRedirect(e,t,r,o){await this._originValidation(e);const a=await aS(e,t,r,qy(),o);return e4(a),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:o,promise:a}=this.eventManagers[t];return o?Promise.resolve(o):(ko(a,"If manager is not set, promise should be"),a)}const r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}async initAndGetManager(e){const t=await N4(e),r=new w4(e);return t.register("authEvent",o=>(ht(o==null?void 0:o.authEvent,e,"invalid-auth-event"),{status:r.onEvent(o.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Kg,{type:Kg},o=>{var a;const c=(a=o==null?void 0:o[0])===null||a===void 0?void 0:a[Kg];c!==void 0&&t(!!c),Zr(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=j4(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return Q2()||U2()||I0()}}const Sj=Q4;var lS="@firebase/auth",cS="1.10.7";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y4{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){ht(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function X4(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function J4(n){_a(new xs("auth",(e,{options:t})=>{const r=e.getProvider("app").getImmediate(),o=e.getProvider("heartbeat"),a=e.getProvider("app-check-internal"),{apiKey:c,authDomain:d}=r.options;ht(c&&!c.includes(":"),"invalid-api-key",{appName:r.name});const h={apiKey:c,authDomain:d,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Y2(n)},m=new _F(r,o,a,h);return FF(m,t),m},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),_a(new xs("auth-internal",e=>{const t=Eo(e.getProvider("auth").getImmediate());return(r=>new Y4(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Mi(lS,cS,X4(n)),Mi(lS,cS,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Z4=5*60,ez=Ek("authIdTokenMaxAge")||Z4;let uS=null;const tz=n=>async e=>{const t=e&&await e.getIdTokenResult(),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>ez)return;const o=t==null?void 0:t.token;uS!==o&&(uS=o,await fetch(n,{method:o?"POST":"DELETE",headers:o?{Authorization:`Bearer ${o}`}:{}}))};function St(n=dx()){const e=vc(n,"auth");if(e.isInitialized())return e.getImmediate();const t=Z2(n,{popupRedirectResolver:Sj,persistence:[xj,hj,E0]}),r=Ek("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const a=new URL(r,location.origin);if(location.origin===a.origin){const c=tz(a.toString());cj(t,c,()=>c(t.currentUser)),lj(t,d=>c(d))}}const o=Ik("auth");return o&&ej(t,`http://${o}`),t}function nz(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}jF({loadJS(n){return new Promise((e,t)=>{const r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=o=>{const a=gi("internal-error");a.customData=o,t(a)},r.type="text/javascript",r.charset="UTF-8",nz().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});J4("Browser");const rz=Object.freeze(Object.defineProperty({__proto__:null,ActionCodeURL:$f,AuthCredential:Hf,EmailAuthCredential:xc,EmailAuthProvider:qa,FacebookAuthProvider:ho,GithubAuthProvider:po,GoogleAuthProvider:Fi,OAuthCredential:Ui,OAuthProvider:Kl,TwitterAuthProvider:fo,beforeAuthStateChanged:cj,browserLocalPersistence:hj,browserPopupRedirectResolver:Sj,browserSessionPersistence:E0,connectAuthEmulator:ej,createUserWithEmailAndPassword:R0,getAuth:St,getIdTokenResult:M2,inMemoryPersistence:$y,indexedDBLocalPersistence:xj,initializeAuth:Z2,onAuthStateChanged:Ns,onIdTokenChanged:lj,prodErrorMap:B2,reload:L2,sendPasswordResetEmail:sj,signInWithCredential:ij,signInWithEmailAndPassword:aj,signInWithPopup:Ky,signOut:Ir,updateProfile:af},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kj="firebasestorage.googleapis.com",Tj="storageBucket",iz=2*60*1e3,oz=10*60*1e3,sz=1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mn extends qi{constructor(e,t,r=0){super(Qg(e),`Firebase Storage: ${t} (${Qg(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,mn.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Qg(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var nn;(function(n){n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(nn||(nn={}));function Qg(n){return"storage/"+n}function B0(){const n="An unknown error occurred, please check the error payload for server response.";return new mn(nn.UNKNOWN,n)}function az(n){return new mn(nn.OBJECT_NOT_FOUND,"Object '"+n+"' does not exist.")}function lz(n){return new mn(nn.QUOTA_EXCEEDED,"Quota for bucket '"+n+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function cz(){const n="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new mn(nn.UNAUTHENTICATED,n)}function uz(){return new mn(nn.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function dz(n){return new mn(nn.UNAUTHORIZED,"User does not have permission to access '"+n+"'.")}function _j(){return new mn(nn.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function jj(){return new mn(nn.CANCELED,"User canceled the upload/download.")}function hz(n){return new mn(nn.INVALID_URL,"Invalid URL '"+n+"'.")}function pz(n){return new mn(nn.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function fz(){return new mn(nn.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+Tj+"' property when initializing the app?")}function Ij(){return new mn(nn.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function mz(){return new mn(nn.SERVER_FILE_WRONG_SIZE,"Server recorded incorrect upload file size, please retry the upload.")}function gz(){return new mn(nn.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function yz(n){return new mn(nn.UNSUPPORTED_ENVIRONMENT,`${n} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function Qy(n){return new mn(nn.INVALID_ARGUMENT,n)}function Cj(){return new mn(nn.APP_DELETED,"The Firebase app was deleted.")}function xz(n){return new mn(nn.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function $u(n,e){return new mn(nn.INVALID_FORMAT,"String does not match format '"+n+"': "+e)}function Tu(n){throw new mn(nn.INTERNAL_ERROR,"Internal error: "+n)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lr{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let r;try{r=Lr.makeFromUrl(e,t)}catch{return new Lr(e,"")}if(r.path==="")return r;throw pz(e)}static makeFromUrl(e,t){let r=null;const o="([A-Za-z0-9.\\-_]+)";function a(q){q.path.charAt(q.path.length-1)==="/"&&(q.path_=q.path_.slice(0,-1))}const c="(/(.*))?$",d=new RegExp("^gs://"+o+c,"i"),h={bucket:1,path:3};function m(q){q.path_=decodeURIComponent(q.path)}const g="v[A-Za-z0-9_]+",x=t.replace(/[.]/g,"\\."),S="(/([^?#]*).*)?$",C=new RegExp(`^https?://${x}/${g}/b/${o}/o${S}`,"i"),_={bucket:1,path:3},I=t===kj?"(?:storage.googleapis.com|storage.cloud.google.com)":t,T="([^?#]*)",F=new RegExp(`^https?://${I}/${o}/${T}`,"i"),B=[{regex:d,indices:h,postModify:a},{regex:C,indices:_,postModify:m},{regex:F,indices:{bucket:1,path:2},postModify:m}];for(let q=0;q<B.length;q++){const te=B[q],W=te.regex.exec(e);if(W){const L=W[te.indices.bucket];let R=W[te.indices.path];R||(R=""),r=new Lr(L,R),te.postModify(r);break}}if(r==null)throw hz(e);return r}}class bz{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vz(n,e,t){let r=1,o=null,a=null,c=!1,d=0;function h(){return d===2}let m=!1;function g(...T){m||(m=!0,e.apply(null,T))}function x(T){o=setTimeout(()=>{o=null,n(C,h())},T)}function S(){a&&clearTimeout(a)}function C(T,...F){if(m){S();return}if(T){S(),g.call(null,T,...F);return}if(h()||c){S(),g.call(null,T,...F);return}r<64&&(r*=2);let B;d===1?(d=2,B=0):B=(r+Math.random())*1e3,x(B)}let _=!1;function I(T){_||(_=!0,S(),!m&&(o!==null?(T||(d=2),clearTimeout(o),x(0)):T||(d=1)))}return x(0),a=setTimeout(()=>{c=!0,I(!0)},t),I}function wz(n){n(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sz(n){return n!==void 0}function kz(n){return typeof n=="function"}function Tz(n){return typeof n=="object"&&!Array.isArray(n)}function Qf(n){return typeof n=="string"||n instanceof String}function dS(n){return F0()&&n instanceof Blob}function F0(){return typeof Blob<"u"}function hS(n,e,t,r){if(r<e)throw Qy(`Invalid value for '${n}'. Expected ${e} or greater.`);if(r>t)throw Qy(`Invalid value for '${n}'. Expected ${t} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fd(n,e,t){let r=e;return t==null&&(r=`https://${e}`),`${t}://${r}/v0${n}`}function Rj(n){const e=encodeURIComponent;let t="?";for(const r in n)if(n.hasOwnProperty(r)){const o=e(r)+"="+e(n[r]);t=t+o+"&"}return t=t.slice(0,-1),t}var Sa;(function(n){n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT"})(Sa||(Sa={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ej(n,e){const t=n>=500&&n<600,o=[408,429].indexOf(n)!==-1,a=e.indexOf(n)!==-1;return t||o||a}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _z{constructor(e,t,r,o,a,c,d,h,m,g,x,S=!0,C=!1){this.url_=e,this.method_=t,this.headers_=r,this.body_=o,this.successCodes_=a,this.additionalRetryCodes_=c,this.callback_=d,this.errorCallback_=h,this.timeout_=m,this.progressCallback_=g,this.connectionFactory_=x,this.retry=S,this.isUsingEmulator=C,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((_,I)=>{this.resolve_=_,this.reject_=I,this.start_()})}start_(){const e=(r,o)=>{if(o){r(!1,new up(!1,null,!0));return}const a=this.connectionFactory_();this.pendingConnection_=a;const c=d=>{const h=d.loaded,m=d.lengthComputable?d.total:-1;this.progressCallback_!==null&&this.progressCallback_(h,m)};this.progressCallback_!==null&&a.addUploadProgressListener(c),a.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&a.removeUploadProgressListener(c),this.pendingConnection_=null;const d=a.getErrorCode()===Sa.NO_ERROR,h=a.getStatus();if(!d||Ej(h,this.additionalRetryCodes_)&&this.retry){const g=a.getErrorCode()===Sa.ABORT;r(!1,new up(!1,null,g));return}const m=this.successCodes_.indexOf(h)!==-1;r(!0,new up(m,a))})},t=(r,o)=>{const a=this.resolve_,c=this.reject_,d=o.connection;if(o.wasSuccessCode)try{const h=this.callback_(d,d.getResponse());Sz(h)?a(h):a()}catch(h){c(h)}else if(d!==null){const h=B0();h.serverResponse=d.getErrorText(),this.errorCallback_?c(this.errorCallback_(d,h)):c(h)}else if(o.canceled){const h=this.appDelete_?Cj():jj();c(h)}else{const h=_j();c(h)}};this.canceled_?t(!1,new up(!1,null,!0)):this.backoffId_=vz(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&wz(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class up{constructor(e,t,r){this.wasSuccessCode=e,this.connection=t,this.canceled=!!r}}function jz(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function Iz(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function Cz(n,e){e&&(n["X-Firebase-GMPID"]=e)}function Rz(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function Ez(n,e,t,r,o,a,c=!0,d=!1){const h=Rj(n.urlParams),m=n.url+h,g=Object.assign({},n.headers);return Cz(g,e),jz(g,t),Iz(g,a),Rz(g,r),new _z(m,n.method,g,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,o,c,d)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Az(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function Pz(...n){const e=Az();if(e!==void 0){const t=new e;for(let r=0;r<n.length;r++)t.append(n[r]);return t.getBlob()}else{if(F0())return new Blob(n);throw new mn(nn.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function Bz(n,e,t){return n.webkitSlice?n.webkitSlice(e,t):n.mozSlice?n.mozSlice(e,t):n.slice?n.slice(e,t):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fz(n){if(typeof atob>"u")throw yz("base-64");return atob(n)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ni={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class Yg{constructor(e,t){this.data=e,this.contentType=t||null}}function zz(n,e){switch(n){case Ni.RAW:return new Yg(Aj(e));case Ni.BASE64:case Ni.BASE64URL:return new Yg(Pj(n,e));case Ni.DATA_URL:return new Yg(Nz(e),Mz(e))}throw B0()}function Aj(n){const e=[];for(let t=0;t<n.length;t++){let r=n.charCodeAt(t);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|r&63);else if((r&64512)===55296)if(!(t<n.length-1&&(n.charCodeAt(t+1)&64512)===56320))e.push(239,191,189);else{const a=r,c=n.charCodeAt(++t);r=65536|(a&1023)<<10|c&1023,e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|r&63)}else(r&64512)===56320?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|r&63)}return new Uint8Array(e)}function Dz(n){let e;try{e=decodeURIComponent(n)}catch{throw $u(Ni.DATA_URL,"Malformed data URL.")}return Aj(e)}function Pj(n,e){switch(n){case Ni.BASE64:{const o=e.indexOf("-")!==-1,a=e.indexOf("_")!==-1;if(o||a)throw $u(n,"Invalid character '"+(o?"-":"_")+"' found: is it base64url encoded?");break}case Ni.BASE64URL:{const o=e.indexOf("+")!==-1,a=e.indexOf("/")!==-1;if(o||a)throw $u(n,"Invalid character '"+(o?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let t;try{t=Fz(e)}catch(o){throw o.message.includes("polyfill")?o:$u(n,"Invalid character found")}const r=new Uint8Array(t.length);for(let o=0;o<t.length;o++)r[o]=t.charCodeAt(o);return r}class Bj{constructor(e){this.base64=!1,this.contentType=null;const t=e.match(/^data:([^,]+)?,/);if(t===null)throw $u(Ni.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const r=t[1]||null;r!=null&&(this.base64=Lz(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}}function Nz(n){const e=new Bj(n);return e.base64?Pj(Ni.BASE64,e.rest):Dz(e.rest)}function Mz(n){return new Bj(n).contentType}function Lz(n,e){return n.length>=e.length?n.substring(n.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ls{constructor(e,t){let r=0,o="";dS(e)?(this.data_=e,r=e.size,o=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=o}size(){return this.size_}type(){return this.type_}slice(e,t){if(dS(this.data_)){const r=this.data_,o=Bz(r,e,t);return o===null?null:new ls(o)}else{const r=new Uint8Array(this.data_.buffer,e,t-e);return new ls(r,!0)}}static getBlob(...e){if(F0()){const t=e.map(r=>r instanceof ls?r.data_:r);return new ls(Pz.apply(null,t))}else{const t=e.map(c=>Qf(c)?zz(Ni.RAW,c).data:c.data_);let r=0;t.forEach(c=>{r+=c.byteLength});const o=new Uint8Array(r);let a=0;return t.forEach(c=>{for(let d=0;d<c.length;d++)o[a++]=c[d]}),new ls(o,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fj(n){let e;try{e=JSON.parse(n)}catch{return null}return Tz(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Oz(n){if(n.length===0)return null;const e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function Wz(n,e){const t=e.split("/").filter(r=>r.length>0).join("/");return n.length===0?t:n+"/"+t}function zj(n){const e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vz(n,e){return e}class dr{constructor(e,t,r,o){this.server=e,this.local=t||e,this.writable=!!r,this.xform=o||Vz}}let dp=null;function Uz(n){return!Qf(n)||n.length<2?n:zj(n)}function Dj(){if(dp)return dp;const n=[];n.push(new dr("bucket")),n.push(new dr("generation")),n.push(new dr("metageneration")),n.push(new dr("name","fullPath",!0));function e(a,c){return Uz(c)}const t=new dr("name");t.xform=e,n.push(t);function r(a,c){return c!==void 0?Number(c):c}const o=new dr("size");return o.xform=r,n.push(o),n.push(new dr("timeCreated")),n.push(new dr("updated")),n.push(new dr("md5Hash",null,!0)),n.push(new dr("cacheControl",null,!0)),n.push(new dr("contentDisposition",null,!0)),n.push(new dr("contentEncoding",null,!0)),n.push(new dr("contentLanguage",null,!0)),n.push(new dr("contentType",null,!0)),n.push(new dr("metadata","customMetadata",!0)),dp=n,dp}function qz(n,e){function t(){const r=n.bucket,o=n.fullPath,a=new Lr(r,o);return e._makeStorageReference(a)}Object.defineProperty(n,"ref",{get:t})}function Hz(n,e,t){const r={};r.type="file";const o=t.length;for(let a=0;a<o;a++){const c=t[a];r[c.local]=c.xform(r,e[c.server])}return qz(r,n),r}function Nj(n,e,t){const r=Fj(e);return r===null?null:Hz(n,r,t)}function $z(n,e,t,r){const o=Fj(e);if(o===null||!Qf(o.downloadTokens))return null;const a=o.downloadTokens;if(a.length===0)return null;const c=encodeURIComponent;return a.split(",").map(m=>{const g=n.bucket,x=n.fullPath,S="/b/"+c(g)+"/o/"+c(x),C=Fd(S,t,r),_=Rj({alt:"media",token:m});return C+_})[0]}function Mj(n,e){const t={},r=e.length;for(let o=0;o<r;o++){const a=e[o];a.writable&&(t[a.server]=n[a.local])}return JSON.stringify(t)}class Fc{constructor(e,t,r,o){this.url=e,this.method=t,this.handler=r,this.timeout=o,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bo(n){if(!n)throw B0()}function z0(n,e){function t(r,o){const a=Nj(n,o,e);return bo(a!==null),a}return t}function Gz(n,e){function t(r,o){const a=Nj(n,o,e);return bo(a!==null),$z(a,o,n.host,n._protocol)}return t}function zd(n){function e(t,r){let o;return t.getStatus()===401?t.getErrorText().includes("Firebase App Check token is invalid")?o=uz():o=cz():t.getStatus()===402?o=lz(n.bucket):t.getStatus()===403?o=dz(n.path):o=r,o.status=t.getStatus(),o.serverResponse=r.serverResponse,o}return e}function Lj(n){const e=zd(n);function t(r,o){let a=e(r,o);return r.getStatus()===404&&(a=az(n.path)),a.serverResponse=o.serverResponse,a}return t}function Kz(n,e,t){const r=e.fullServerUrl(),o=Fd(r,n.host,n._protocol),a="GET",c=n.maxOperationRetryTime,d=new Fc(o,a,z0(n,t),c);return d.errorHandler=Lj(e),d}function Qz(n,e,t){const r=e.fullServerUrl(),o=Fd(r,n.host,n._protocol),a="GET",c=n.maxOperationRetryTime,d=new Fc(o,a,Gz(n,t),c);return d.errorHandler=Lj(e),d}function Yz(n,e){return n&&n.contentType||e&&e.type()||"application/octet-stream"}function Oj(n,e,t){const r=Object.assign({},t);return r.fullPath=n.path,r.size=e.size(),r.contentType||(r.contentType=Yz(null,e)),r}function Xz(n,e,t,r,o){const a=e.bucketOnlyServerUrl(),c={"X-Goog-Upload-Protocol":"multipart"};function d(){let B="";for(let q=0;q<2;q++)B=B+Math.random().toString().slice(2);return B}const h=d();c["Content-Type"]="multipart/related; boundary="+h;const m=Oj(e,r,o),g=Mj(m,t),x="--"+h+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+g+`\r
--`+h+`\r
Content-Type: `+m.contentType+`\r
\r
`,S=`\r
--`+h+"--",C=ls.getBlob(x,r,S);if(C===null)throw Ij();const _={name:m.fullPath},I=Fd(a,n.host,n._protocol),T="POST",F=n.maxUploadRetryTime,P=new Fc(I,T,z0(n,t),F);return P.urlParams=_,P.headers=c,P.body=C.uploadData(),P.errorHandler=zd(e),P}class uf{constructor(e,t,r,o){this.current=e,this.total=t,this.finalized=!!r,this.metadata=o||null}}function D0(n,e){let t=null;try{t=n.getResponseHeader("X-Goog-Upload-Status")}catch{bo(!1)}return bo(!!t&&(e||["active"]).indexOf(t)!==-1),t}function Jz(n,e,t,r,o){const a=e.bucketOnlyServerUrl(),c=Oj(e,r,o),d={name:c.fullPath},h=Fd(a,n.host,n._protocol),m="POST",g={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${r.size()}`,"X-Goog-Upload-Header-Content-Type":c.contentType,"Content-Type":"application/json; charset=utf-8"},x=Mj(c,t),S=n.maxUploadRetryTime;function C(I){D0(I);let T;try{T=I.getResponseHeader("X-Goog-Upload-URL")}catch{bo(!1)}return bo(Qf(T)),T}const _=new Fc(h,m,C,S);return _.urlParams=d,_.headers=g,_.body=x,_.errorHandler=zd(e),_}function Zz(n,e,t,r){const o={"X-Goog-Upload-Command":"query"};function a(m){const g=D0(m,["active","final"]);let x=null;try{x=m.getResponseHeader("X-Goog-Upload-Size-Received")}catch{bo(!1)}x||bo(!1);const S=Number(x);return bo(!isNaN(S)),new uf(S,r.size(),g==="final")}const c="POST",d=n.maxUploadRetryTime,h=new Fc(t,c,a,d);return h.headers=o,h.errorHandler=zd(e),h}const pS=256*1024;function eD(n,e,t,r,o,a,c,d){const h=new uf(0,0);if(c?(h.current=c.current,h.total=c.total):(h.current=0,h.total=r.size()),r.size()!==h.total)throw mz();const m=h.total-h.current;let g=m;o>0&&(g=Math.min(g,o));const x=h.current,S=x+g;let C="";g===0?C="finalize":m===g?C="upload, finalize":C="upload";const _={"X-Goog-Upload-Command":C,"X-Goog-Upload-Offset":`${h.current}`},I=r.slice(x,S);if(I===null)throw Ij();function T(q,te){const W=D0(q,["active","final"]),L=h.current+g,R=r.size();let A;return W==="final"?A=z0(e,a)(q,te):A=null,new uf(L,R,W==="final",A)}const F="POST",P=e.maxUploadRetryTime,B=new Fc(t,F,T,P);return B.headers=_,B.body=I.uploadData(),B.progressCallback=d||null,B.errorHandler=zd(n),B}const Sr={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function Xg(n){switch(n){case"running":case"pausing":case"canceling":return Sr.RUNNING;case"paused":return Sr.PAUSED;case"success":return Sr.SUCCESS;case"canceled":return Sr.CANCELED;case"error":return Sr.ERROR;default:return Sr.ERROR}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tD{constructor(e,t,r){if(kz(e)||t!=null||r!=null)this.next=e,this.error=t??void 0,this.complete=r??void 0;else{const a=e;this.next=a.next,this.error=a.error,this.complete=a.complete}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bl(n){return(...e)=>{Promise.resolve().then(()=>n(...e))}}class nD{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Sa.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=Sa.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=Sa.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,t,r,o,a){if(this.sent_)throw Tu("cannot .send() more than once");if(To(e)&&r&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(t,e,!0),a!==void 0)for(const c in a)a.hasOwnProperty(c)&&this.xhr_.setRequestHeader(c,a[c].toString());return o!==void 0?this.xhr_.send(o):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw Tu("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw Tu("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw Tu("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw Tu("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class rD extends nD{initXhr(){this.xhr_.responseType="text"}}function Vl(){return new rD}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iD{isExponentialBackoffExpired(){return this.sleepTime>this.maxSleepTime}constructor(e,t,r=null){this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=e,this._blob=t,this._metadata=r,this._mappings=Dj(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=o=>{if(this._request=void 0,this._chunkMultiplier=1,o._codeEquals(nn.CANCELED))this._needToFetchStatus=!0,this.completeTransitions_();else{const a=this.isExponentialBackoffExpired();if(Ej(o.status,[]))if(a)o=_j();else{this.sleepTime=Math.max(this.sleepTime*2,sz),this._needToFetchStatus=!0,this.completeTransitions_();return}this._error=o,this._transition("error")}},this._metadataErrorHandler=o=>{this._request=void 0,o._codeEquals(nn.CANCELED)?this.completeTransitions_():(this._error=o,this._transition("error"))},this.sleepTime=0,this.maxSleepTime=this._ref.storage.maxUploadRetryTime,this._promise=new Promise((o,a)=>{this._resolve=o,this._reject=a,this._start()}),this._promise.then(null,()=>{})}_makeProgressCallback(){const e=this._transferred;return t=>this._updateProgress(e+t)}_shouldDoResumable(e){return e.size()>256*1024}_start(){this._state==="running"&&this._request===void 0&&(this._resumable?this._uploadUrl===void 0?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this.pendingTimeout=setTimeout(()=>{this.pendingTimeout=void 0,this._continueUpload()},this.sleepTime):this._oneShotUpload())}_resolveToken(e){Promise.all([this._ref.storage._getAuthToken(),this._ref.storage._getAppCheckToken()]).then(([t,r])=>{switch(this._state){case"running":e(t,r);break;case"canceling":this._transition("canceled");break;case"pausing":this._transition("paused");break}})}_createResumable(){this._resolveToken((e,t)=>{const r=Jz(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),o=this._ref.storage._makeRequest(r,Vl,e,t);this._request=o,o.getPromise().then(a=>{this._request=void 0,this._uploadUrl=a,this._needToFetchStatus=!1,this.completeTransitions_()},this._errorHandler)})}_fetchStatus(){const e=this._uploadUrl;this._resolveToken((t,r)=>{const o=Zz(this._ref.storage,this._ref._location,e,this._blob),a=this._ref.storage._makeRequest(o,Vl,t,r);this._request=a,a.getPromise().then(c=>{c=c,this._request=void 0,this._updateProgress(c.current),this._needToFetchStatus=!1,c.finalized&&(this._needToFetchMetadata=!0),this.completeTransitions_()},this._errorHandler)})}_continueUpload(){const e=pS*this._chunkMultiplier,t=new uf(this._transferred,this._blob.size()),r=this._uploadUrl;this._resolveToken((o,a)=>{let c;try{c=eD(this._ref._location,this._ref.storage,r,this._blob,e,this._mappings,t,this._makeProgressCallback())}catch(h){this._error=h,this._transition("error");return}const d=this._ref.storage._makeRequest(c,Vl,o,a,!1);this._request=d,d.getPromise().then(h=>{this._increaseMultiplier(),this._request=void 0,this._updateProgress(h.current),h.finalized?(this._metadata=h.metadata,this._transition("success")):this.completeTransitions_()},this._errorHandler)})}_increaseMultiplier(){pS*this._chunkMultiplier*2<32*1024*1024&&(this._chunkMultiplier*=2)}_fetchMetadata(){this._resolveToken((e,t)=>{const r=Kz(this._ref.storage,this._ref._location,this._mappings),o=this._ref.storage._makeRequest(r,Vl,e,t);this._request=o,o.getPromise().then(a=>{this._request=void 0,this._metadata=a,this._transition("success")},this._metadataErrorHandler)})}_oneShotUpload(){this._resolveToken((e,t)=>{const r=Xz(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),o=this._ref.storage._makeRequest(r,Vl,e,t);this._request=o,o.getPromise().then(a=>{this._request=void 0,this._metadata=a,this._updateProgress(this._blob.size()),this._transition("success")},this._errorHandler)})}_updateProgress(e){const t=this._transferred;this._transferred=e,this._transferred!==t&&this._notifyObservers()}_transition(e){if(this._state!==e)switch(e){case"canceling":case"pausing":this._state=e,this._request!==void 0?this._request.cancel():this.pendingTimeout&&(clearTimeout(this.pendingTimeout),this.pendingTimeout=void 0,this.completeTransitions_());break;case"running":const t=this._state==="paused";this._state=e,t&&(this._notifyObservers(),this._start());break;case"paused":this._state=e,this._notifyObservers();break;case"canceled":this._error=jj(),this._state=e,this._notifyObservers();break;case"error":this._state=e,this._notifyObservers();break;case"success":this._state=e,this._notifyObservers();break}}completeTransitions_(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start();break}}get snapshot(){const e=Xg(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:e,metadata:this._metadata,task:this,ref:this._ref}}on(e,t,r,o){const a=new tD(t||void 0,r||void 0,o||void 0);return this._addObserver(a),()=>{this._removeObserver(a)}}then(e,t){return this._promise.then(e,t)}catch(e){return this.then(null,e)}_addObserver(e){this._observers.push(e),this._notifyObserver(e)}_removeObserver(e){const t=this._observers.indexOf(e);t!==-1&&this._observers.splice(t,1)}_notifyObservers(){this._finishPromise(),this._observers.slice().forEach(t=>{this._notifyObserver(t)})}_finishPromise(){if(this._resolve!==void 0){let e=!0;switch(Xg(this._state)){case Sr.SUCCESS:Bl(this._resolve.bind(null,this.snapshot))();break;case Sr.CANCELED:case Sr.ERROR:const t=this._reject;Bl(t.bind(null,this._error))();break;default:e=!1;break}e&&(this._resolve=void 0,this._reject=void 0)}}_notifyObserver(e){switch(Xg(this._state)){case Sr.RUNNING:case Sr.PAUSED:e.next&&Bl(e.next.bind(e,this.snapshot))();break;case Sr.SUCCESS:e.complete&&Bl(e.complete.bind(e))();break;case Sr.CANCELED:case Sr.ERROR:e.error&&Bl(e.error.bind(e,this._error))();break;default:e.error&&Bl(e.error.bind(e,this._error))()}}resume(){const e=this._state==="paused"||this._state==="pausing";return e&&this._transition("running"),e}pause(){const e=this._state==="running";return e&&this._transition("pausing"),e}cancel(){const e=this._state==="running"||this._state==="pausing";return e&&this._transition("canceling"),e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Na{constructor(e,t){this._service=e,t instanceof Lr?this._location=t:this._location=Lr.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new Na(e,t)}get root(){const e=new Lr(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return zj(this._location.path)}get storage(){return this._service}get parent(){const e=Oz(this._location.path);if(e===null)return null;const t=new Lr(this._location.bucket,e);return new Na(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw xz(e)}}function oD(n,e,t){return n._throwIfRoot("uploadBytesResumable"),new iD(n,new ls(e),t)}function sD(n){n._throwIfRoot("getDownloadURL");const e=Qz(n.storage,n._location,Dj());return n.storage.makeRequestWithTokens(e,Vl).then(t=>{if(t===null)throw gz();return t})}function aD(n,e){const t=Wz(n._location.path,e),r=new Lr(n._location.bucket,t);return new Na(n.storage,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lD(n){return/^[A-Za-z]+:\/\//.test(n)}function cD(n,e){return new Na(n,e)}function Wj(n,e){if(n instanceof N0){const t=n;if(t._bucket==null)throw fz();const r=new Na(t,t._bucket);return e!=null?Wj(r,e):r}else return e!==void 0?aD(n,e):n}function uD(n,e){if(e&&lD(e)){if(n instanceof N0)return cD(n,e);throw Qy("To use ref(service, url), the first argument must be a Storage instance.")}else return Wj(n,e)}function fS(n,e){const t=e==null?void 0:e[Tj];return t==null?null:Lr.makeFromBucketSpec(t,n)}function dD(n,e,t,r={}){n.host=`${e}:${t}`;const o=To(e);o&&(xf(`https://${n.host}/b`),lx("Storage",!0)),n._isUsingEmulator=!0,n._protocol=o?"https":"http";const{mockUserToken:a}=r;a&&(n._overrideAuthToken=typeof a=="string"?a:Ak(a,n.app.options.projectId))}class N0{constructor(e,t,r,o,a,c=!1){this.app=e,this._authProvider=t,this._appCheckProvider=r,this._url=o,this._firebaseVersion=a,this._isUsingEmulator=c,this._bucket=null,this._host=kj,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=iz,this._maxUploadRetryTime=oz,this._requests=new Set,o!=null?this._bucket=Lr.makeFromBucketSpec(o,this._host):this._bucket=fS(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Lr.makeFromBucketSpec(this._url,e):this._bucket=fS(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){hS("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){hS("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(kr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Na(this,e)}_makeRequest(e,t,r,o,a=!0){if(this._deleted)return new bz(Cj());{const c=Ez(e,this._appId,r,o,t,this._firebaseVersion,a,this._isUsingEmulator);return this._requests.add(c),c.getPromise().then(()=>this._requests.delete(c),()=>this._requests.delete(c)),c}}async makeRequestWithTokens(e,t){const[r,o]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,r,o).getPromise()}}const mS="@firebase/storage",gS="0.13.13";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vj="storage";function hD(n,e,t){return n=Dt(n),oD(n,e,t)}function pD(n){return n=Dt(n),sD(n)}function fD(n,e){return n=Dt(n),uD(n,e)}function mD(n=dx(),e){n=Dt(n);const r=vc(n,Vj).getImmediate({identifier:e}),o=Ck("storage");return o&&gD(r,...o),r}function gD(n,e,t,r={}){dD(n,e,t,r)}function yD(n,{instanceIdentifier:e}){const t=n.getProvider("app").getImmediate(),r=n.getProvider("auth-internal"),o=n.getProvider("app-check-internal");return new N0(t,r,o,e,Oa)}function xD(){_a(new xs(Vj,yD,"PUBLIC").setMultipleInstances(!0)),Mi(mS,gS,""),Mi(mS,gS,"esm2017")}xD();const bD={apiKey:"AIzaSyDi9hdqloCIg_8sfjjyERqnfAr-pW3BeNY",authDomain:"restarter-app.firebaseapp.com",projectId:"restarter-app",storageBucket:"restarter-app.firebasestorage.app",messagingSenderId:"393816322828",appId:"1:393816322828:web:32a9ed91fe95ab9cdd8f29",measurementId:"G-CX4DYFJ5B4"},Ao=Mk(bD),Wt=Td(Ao),ya=St(Ao),vD=mD(Ao),Jg=[{code:"zh-TW",label:"繁中"},{code:"zh-CN",label:"简中"},{code:"en",label:"EN"},{code:"ja",label:"日本語"},{code:"ko",label:"한국어"},{code:"th",label:"ภาษาไทย"},{code:"vi",label:"Tiếng Việt"},{code:"ms",label:"Bahasa Melayu"},{code:"la",label:"Latīna"}],Uj=v.createContext(null),Mt=()=>{const n=v.useContext(Uj);if(!n)throw new Error("useLanguage must be used within a LanguageProvider");return n},wD=({children:n})=>{const[e,t]=v.useState(()=>{try{const a=localStorage.getItem("lang");if(a&&Jg.some(c=>c.code===a))return a}catch(a){console.warn("Failed to read language from localStorage:",a)}return"zh-TW"});v.useEffect(()=>{try{const a=localStorage.getItem("lang");if(a&&Jg.some(m=>m.code===a))return;const c={en:"en","en-US":"en","en-GB":"en","zh-TW":"zh-TW","zh-HK":"zh-TW","zh-Hant":"zh-TW","zh-CN":"zh-CN","zh-Hans":"zh-CN",ja:"ja",ko:"ko",vi:"vi",th:"th",ms:"ms",la:"la"},d=navigator.language||navigator.languages&&navigator.languages[0]||"";let h="en";c[d]?h=c[d]:c[d.split("-")[0]]&&(h=c[d.split("-")[0]]),h!==e&&(t(h),localStorage.setItem("lang",h))}catch(a){console.warn("Failed to detect browser language:",a)}},[]);const o={lang:e,setLang:a=>{try{t(a),localStorage.setItem("lang",a)}catch(c){console.warn("Failed to save language to localStorage:",c)}},LANGS:Jg};return i.jsx(Uj.Provider,{value:o,children:n})},Bn=({className:n="",style:e={}})=>{const{lang:t,setLang:r,LANGS:o}=Mt(),a={padding:"3px 6px",borderRadius:4,fontWeight:600,fontSize:11,border:"1px solid #6B5BFF",color:"#6B5BFF",background:"#fff",cursor:"pointer",transition:"background 0.18s, color 0.18s, border 0.18s",minWidth:50,...e};return i.jsx("select",{value:t,onChange:c=>r(c.target.value),className:n,style:a,children:o.map(c=>i.jsx("option",{value:c.code,children:c.label},c.code))})},SD=({isOpen:n,onClose:e,title:t,message:r,requiredPlan:o="basic"})=>{const a=_t(),c=window.innerWidth<=768;if(!n)return null;const d={basic:"基礎版 (NT$ 149/月)",advanced:"進階版 (NT$ 249/月)",professional:"專業版 (NT$ 349/月)",unlimited:"無限版 (NT$ 499/月)"};return i.jsx("div",{style:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",background:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e4},children:i.jsxs("div",{style:{background:"#fff",borderRadius:16,padding:c?20:32,maxWidth:400,width:"90%",maxHeight:"80vh",overflowY:"auto",textAlign:"center",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.2)"},children:[i.jsx("div",{style:{fontSize:c?36:48,marginBottom:c?12:16,color:"#6B5BFF"},children:"🚀"}),i.jsx("h2",{style:{fontSize:c?20:24,fontWeight:700,color:"#333",marginBottom:c?8:12},children:t}),i.jsx("p",{style:{fontSize:c?14:16,color:"#666",marginBottom:c?16:20,lineHeight:1.6},children:r}),i.jsxs("div",{style:{background:"linear-gradient(135deg, #f8f9ff 0%, #e8f4ff 100%)",borderRadius:12,padding:c?12:16,marginBottom:c?16:24,border:"1px solid #e0e8ff"},children:[i.jsx("div",{style:{fontSize:c?12:14,color:"#6B5BFF",fontWeight:600,marginBottom:c?6:8},children:"💡 升級小提醒"}),i.jsxs("div",{style:{fontSize:c?11:13,color:"#666",lineHeight:1.4},children:["• 升級後立即生效，無需等待",i.jsx("br",{}),"• 可隨時取消，權益保留至本期結束",i.jsx("br",{}),"• 支援多種付款方式，安全便捷"]})]}),o&&i.jsx("div",{style:{background:"#fff",borderRadius:10,padding:c?10:14,marginBottom:c?16:24,border:"2px solid #6B5BFF",boxShadow:"0 2px 8px #6B5BFF22"},children:i.jsxs("span",{style:{fontSize:c?12:14,color:"#6B5BFF",fontWeight:700},children:["✨ 建議方案：",d[o]," 或更高"]})}),i.jsxs("div",{style:{display:"flex",gap:12,justifyContent:"center"},children:[i.jsx("button",{onClick:()=>{e(),a("/plans")},style:{background:"linear-gradient(135deg, #6B5BFF 0%, #00CFFF 100%)",color:"#fff",border:"none",borderRadius:12,padding:"14px 28px",fontSize:16,fontWeight:700,cursor:"pointer",flex:1,boxShadow:"0 4px 12px #6B5BFF33",transition:"all 0.3s ease"},onMouseEnter:h=>{h.currentTarget.style.transform="translateY(-2px)",h.currentTarget.style.boxShadow="0 6px 16px #6B5BFF44"},onMouseLeave:h=>{h.currentTarget.style.transform="translateY(0)",h.currentTarget.style.boxShadow="0 4px 12px #6B5BFF33"},children:"🚀 立即升級"}),i.jsx("button",{onClick:e,style:{background:"#f8f9ff",color:"#6B5BFF",border:"2px solid #6B5BFF",borderRadius:12,padding:"14px 28px",fontSize:16,fontWeight:600,cursor:"pointer",flex:1,transition:"all 0.3s ease"},onMouseEnter:h=>{h.currentTarget.style.background="#6B5BFF",h.currentTarget.style.color="#fff"},onMouseLeave:h=>{h.currentTarget.style.background="#f8f9ff",h.currentTarget.style.color="#6B5BFF"},children:"💭 稍後再說"})]})]})})},Ms=({isOpen:n,onClose:e,currentPlan:t,remainingDays:r,usedTokens:o,totalTokens:a})=>{const c=_t();if(!n)return null;const d={basic:"基礎版",advanced:"進階版",professional:"專業版",unlimited:"無限版"},h={basic:"50K",advanced:"100K",professional:"200K",unlimited:"500K"},m={basic:"NT$ 149",advanced:"NT$ 249",professional:"NT$ 349",unlimited:"NT$ 499"},g=()=>{e(),c("/plans")};return i.jsx("div",{style:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",background:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e4},children:i.jsxs("div",{style:{background:"#fff",borderRadius:20,padding:32,maxWidth:480,width:"90%",textAlign:"center",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.2)"},children:[i.jsx("h2",{style:{fontSize:24,fontWeight:700,color:"#333",marginBottom:12},children:"Token 已用完，需要續購嗎？"}),i.jsxs("p",{style:{fontSize:16,color:"#666",marginBottom:20,lineHeight:1.6},children:["您的 ",d[t]," 方案 Token 已用完，但還有 ",r," 天到期。"]}),i.jsxs("div",{style:{background:"linear-gradient(135deg, #f8f9ff 0%, #e8f4ff 100%)",borderRadius:12,padding:16,marginBottom:24,border:"1px solid #e0e8ff"},children:[i.jsx("div",{style:{fontSize:14,color:"#6B5BFF",fontWeight:600,marginBottom:8},children:"📊 本月使用狀況"}),i.jsxs("div",{style:{fontSize:13,color:"#666",lineHeight:1.4},children:["• 已使用：",Math.round(o/1e3),"K / ",Math.round(a/1e3),"K tokens",i.jsx("br",{}),"• 剩餘天數：",r," 天",i.jsx("br",{}),"• 當前方案：",d[t]]})]}),i.jsxs("div",{style:{background:"#fff",borderRadius:12,padding:20,marginBottom:24,border:"2px solid #6B5BFF",boxShadow:"0 2px 8px #6B5BFF22"},children:[i.jsx("div",{style:{fontSize:16,color:"#6B5BFF",fontWeight:700,marginBottom:12},children:"💡 續購方案"}),i.jsxs("div",{style:{fontSize:14,color:"#666",lineHeight:1.5,marginBottom:16},children:[i.jsx("strong",{children:"立即續購："}),"重新獲得 ",h[t]," tokens，",i.jsx("br",{}),"並從今天開始重新計算 ",r," 天使用期"]}),i.jsx("div",{style:{fontSize:18,fontWeight:700,color:"#6B5BFF"},children:m[t]})]}),i.jsxs("div",{style:{background:"linear-gradient(135deg, #fff3cd 0%, #ffeaa7 100%)",borderRadius:12,padding:16,marginBottom:24,border:"1px solid #ffeaa7"},children:[i.jsx("div",{style:{fontSize:14,color:"#856404",fontWeight:600,marginBottom:8},children:"✨ 續購好處"}),i.jsxs("div",{style:{fontSize:13,color:"#856404",lineHeight:1.4},children:["• 立即恢復語音功能使用",i.jsx("br",{}),"• 時間從今天重新計算，更划算",i.jsx("br",{}),"• 文字功能不受影響，可繼續使用"]})]}),i.jsxs("div",{style:{display:"flex",gap:12,justifyContent:"center"},children:[i.jsx("button",{onClick:g,style:{background:"linear-gradient(135deg, #6B5BFF 0%, #00CFFF 100%)",color:"#fff",border:"none",borderRadius:12,padding:"14px 28px",fontSize:16,fontWeight:700,cursor:"pointer",flex:1,boxShadow:"0 4px 12px #6B5BFF33",transition:"all 0.3s ease"},onMouseEnter:x=>{x.currentTarget.style.transform="translateY(-2px)",x.currentTarget.style.boxShadow="0 6px 16px #6B5BFF44"},onMouseLeave:x=>{x.currentTarget.style.transform="translateY(0)",x.currentTarget.style.boxShadow="0 4px 12px #6B5BFF33"},children:"⚡ 立即續購"}),i.jsx("button",{onClick:e,style:{background:"#f8f9ff",color:"#6B5BFF",border:"2px solid #6B5BFF",borderRadius:12,padding:"14px 28px",fontSize:16,fontWeight:600,cursor:"pointer",flex:1,transition:"all 0.3s ease"},onMouseEnter:x=>{x.currentTarget.style.background="#6B5BFF",x.currentTarget.style.color="#fff"},onMouseLeave:x=>{x.currentTarget.style.background="#f8f9ff",x.currentTarget.style.color="#6B5BFF"},children:"💫 稍後再說"})]}),i.jsx("div",{style:{marginTop:16},children:i.jsx("button",{onClick:e,style:{background:"none",border:"none",color:"#888",fontSize:14,cursor:"pointer",textDecoration:"underline"},children:"稍後再說"})})]})})},yS=({className:n="",showDetails:e=!1})=>{const{lang:t}=Mt(),[r,o]=v.useState(null),[a,c]=v.useState(!0),[d,h]=v.useState(null);v.useEffect(()=>{g()},[t]);const m={temp:25,description:"clear sky",icon:"01d",city:"Taipei",weekday:"星期四"},g=async()=>{try{c(!0),h(null);const _="Taipei";console.log("Fetching weather for:",_);const T=await(await fetch(`https://restarter-backend-6e9s.onrender.com/api/weather/current?city=${_}`)).json();if(console.log("Weather API response:",T),T.weather){const F=x(T.weather,t);console.log("Localized weather:",F),o(F)}else h(T.error||"無法獲取天氣資訊")}catch(_){h("天氣服務暫時無法使用"),console.error("Weather fetch error:",_)}finally{c(!1)}},x=(_,I)=>{var W,L,R;const T={"zh-TW":{"clear sky":"晴天","few clouds":"少雲","scattered clouds":"多雲","broken clouds":"陰天","shower rain":"陣雨",rain:"下雨",thunderstorm:"雷雨",snow:"下雪",haze:"霾",smoke:"煙霧",dust:"沙塵",sand:"沙塵",ash:"火山灰",squall:"狂風",tornado:"龍捲風",sunny:"晴天","partly cloudy":"多雲時晴",cloudy:"陰天",overcast:"陰天",mist:"霧",fog:"霧","patchy rain possible":"可能有陣雨","patchy snow possible":"可能有雪","patchy sleet possible":"可能有雨夾雪","patchy freezing drizzle possible":"可能有凍雨","thundery outbreaks possible":"可能有雷雨","blowing snow":"吹雪",blizzard:"暴風雪","freezing fog":"凍霧","patchy light drizzle":"零星小雨","light drizzle":"小雨","freezing drizzle":"凍雨","heavy freezing drizzle":"強凍雨","patchy light rain":"零星小雨","light rain":"小雨","moderate rain at times":"間歇性中雨","moderate rain":"中雨","heavy rain at times":"間歇性大雨","heavy rain":"大雨","light freezing rain":"輕凍雨","moderate or heavy freezing rain":"中到強凍雨","light sleet":"輕雨夾雪","moderate or heavy sleet":"中到強雨夾雪","patchy light snow":"零星小雪","light snow":"小雪","patchy moderate snow":"零星中雪","moderate snow":"中雪","patchy heavy snow":"零星大雪","heavy snow":"大雪","ice pellets":"冰雹","light rain shower":"小雨陣","moderate or heavy rain shower":"中到強雨陣","torrential rain shower":"暴雨陣","light sleet showers":"小雨夾雪陣","moderate or heavy sleet showers":"中到強雨夾雪陣","light snow showers":"小雪陣","moderate or heavy snow showers":"中到強雪陣","light showers of ice pellets":"輕冰雹陣","moderate or heavy showers of ice pellets":"中到強冰雹陣","patchy light rain with thunder":"零星小雨伴雷","moderate or heavy rain with thunder":"中到強雨伴雷","patchy light snow with thunder":"零星小雪伴雷","moderate or heavy snow with thunder":"中到強雪伴雷",局部多云:"局部多云"},"zh-CN":{"clear sky":"晴天","few clouds":"少云","scattered clouds":"多云","broken clouds":"阴天","shower rain":"阵雨",rain:"下雨",thunderstorm:"雷雨",snow:"下雪",haze:"霾",smoke:"烟雾",dust:"沙尘",sand:"沙尘",ash:"火山灰",squall:"狂风",tornado:"龙卷风",sunny:"晴天","partly cloudy":"多云时晴",cloudy:"阴天",overcast:"阴天",mist:"雾",fog:"雾","patchy rain possible":"可能有阵雨","patchy snow possible":"可能有雪","patchy sleet possible":"可能有雨夹雪","patchy freezing drizzle possible":"可能有冻雨","thundery outbreaks possible":"可能有雷雨","blowing snow":"吹雪",blizzard:"暴风雪","freezing fog":"冻雾","patchy light drizzle":"零星小雨","light drizzle":"小雨","freezing drizzle":"冻雨","heavy freezing drizzle":"强冻雨","patchy light rain":"零星小雨","light rain":"小雨","moderate rain at times":"间歇性中雨","moderate rain":"中雨","heavy rain at times":"间歇性大雨","heavy rain":"大雨","light freezing rain":"轻冻雨","moderate or heavy freezing rain":"中到强冻雨","light sleet":"轻雨夹雪","moderate or heavy sleet":"中到强雨夹雪","patchy light snow":"零星小雪","light snow":"小雪","patchy moderate snow":"零星中雪","moderate snow":"中雪","patchy heavy snow":"零星大雪","heavy snow":"大雪","ice pellets":"冰雹","light rain shower":"小雨阵","moderate or heavy rain shower":"中到强雨阵","torrential rain shower":"暴雨阵","light sleet showers":"小雨夹雪阵","moderate or heavy sleet showers":"中到强雨夹雪阵","light snow showers":"小雪阵","moderate or heavy snow showers":"中到强雪阵","light showers of ice pellets":"轻冰雹阵","moderate or heavy showers of ice pellets":"中到强冰雹阵","patchy light rain with thunder":"零星小雨伴雷","moderate or heavy rain with thunder":"中到强雨伴雷","patchy light snow with thunder":"零星小雪伴雷","moderate or heavy snow with thunder":"中到强雪伴雷",局部多云:"Partly Cloudy"},en:{"clear sky":"Clear","few clouds":"Partly Cloudy","scattered clouds":"Cloudy","broken clouds":"Overcast","shower rain":"Showers",rain:"Rain",thunderstorm:"Thunderstorm",snow:"Snow",haze:"Haze",smoke:"Smoke",dust:"Dust",sand:"Sand",ash:"Ash",squall:"Squall",tornado:"Tornado",sunny:"Sunny","partly cloudy":"Partly Cloudy",cloudy:"Cloudy",overcast:"Overcast",mist:"Mist",fog:"Fog","patchy rain possible":"Patchy Rain","patchy snow possible":"Patchy Snow","patchy sleet possible":"Patchy Sleet","patchy freezing drizzle possible":"Patchy Freezing Drizzle","thundery outbreaks possible":"Thundery Outbreaks","blowing snow":"Blowing Snow",blizzard:"Blizzard","freezing fog":"Freezing Fog","patchy light drizzle":"Patchy Light Drizzle","light drizzle":"Light Drizzle","freezing drizzle":"Freezing Drizzle","heavy freezing drizzle":"Heavy Freezing Drizzle","patchy light rain":"Patchy Light Rain","light rain":"Light Rain","moderate rain at times":"Moderate Rain","moderate rain":"Moderate Rain","heavy rain at times":"Heavy Rain","heavy rain":"Heavy Rain","light freezing rain":"Light Freezing Rain","moderate or heavy freezing rain":"Moderate or Heavy Freezing Rain","light sleet":"Light Sleet","moderate or heavy sleet":"Moderate or Heavy Sleet","patchy light snow":"Patchy Light Snow","light snow":"Light Snow","patchy moderate snow":"Patchy Moderate Snow","moderate snow":"Moderate Snow","patchy heavy snow":"Patchy Heavy Snow","heavy snow":"Heavy Snow","ice pellets":"Ice Pellets","light rain shower":"Light Rain Shower","moderate or heavy rain shower":"Moderate or Heavy Rain Shower","torrential rain shower":"Torrential Rain Shower","light sleet showers":"Light Sleet Showers","moderate or heavy sleet showers":"Moderate or Heavy Sleet Showers","light snow showers":"Light Snow Showers","moderate or heavy snow showers":"Moderate or Heavy Snow Showers","light showers of ice pellets":"Light Ice Pellet Showers","moderate or heavy showers of ice pellets":"Moderate or Heavy Ice Pellet Showers","patchy light rain with thunder":"Patchy Light Rain with Thunder","moderate or heavy rain with thunder":"Moderate or Heavy Rain with Thunder","patchy light snow with thunder":"Patchy Light Snow with Thunder","moderate or heavy snow with thunder":"Moderate or Heavy Snow with Thunder",局部多云:"Partly Cloudy"},ja:{"clear sky":"晴天","few clouds":"晴れ時々曇り","scattered clouds":"曇り","broken clouds":"曇り","shower rain":"にわか雨",rain:"雨",thunderstorm:"雷雨",snow:"雪",haze:"もや",smoke:"煙",dust:"砂塵",sand:"砂塵",ash:"火山灰",squall:"突風",tornado:"竜巻",sunny:"晴天","partly cloudy":"晴れ時々曇り",cloudy:"曇り",overcast:"曇り",mist:"霧",fog:"霧","patchy rain possible":"にわか雨の可能性","patchy snow possible":"にわか雪の可能性","patchy sleet possible":"にわかみぞれの可能性","patchy freezing drizzle possible":"にわか凍る霧雨の可能性","thundery outbreaks possible":"雷雨の可能性","blowing snow":"吹雪",blizzard:"猛吹雪","freezing fog":"凍る霧","patchy light drizzle":"にわか小雨","light drizzle":"小雨","freezing drizzle":"凍る霧雨","heavy freezing drizzle":"強い凍る霧雨","patchy light rain":"にわか小雨","light rain":"小雨","moderate rain at times":"時々中雨","moderate rain":"中雨","heavy rain at times":"時々大雨","heavy rain":"大雨","light freezing rain":"軽い凍る雨","moderate or heavy freezing rain":"中程度または強い凍る雨","light sleet":"軽いみぞれ","moderate or heavy sleet":"中程度または強いみぞれ","patchy light snow":"にわか小雪","light snow":"小雪","patchy moderate snow":"にわか中雪","moderate snow":"中雪","patchy heavy snow":"にわか大雪","heavy snow":"大雪","ice pellets":"氷の粒","light rain shower":"小雨のシャワー","moderate or heavy rain shower":"中程度または強い雨のシャワー","torrential rain shower":"豪雨のシャワー","light sleet showers":"軽いみぞれのシャワー","moderate or heavy sleet showers":"中程度または強いみぞれのシャワー","light snow showers":"小雪のシャワー","moderate or heavy snow showers":"中程度または強い雪のシャワー","light showers of ice pellets":"軽い氷の粒のシャワー","moderate or heavy showers of ice pellets":"中程度または強い氷の粒のシャワー","patchy light rain with thunder":"にわか小雨と雷","moderate or heavy rain with thunder":"中程度または強い雨と雷","patchy light snow with thunder":"にわか小雪と雷","moderate or heavy snow with thunder":"中程度または強い雪と雷",局部多云:"晴れ時々曇り"},ko:{"clear sky":"맑음","few clouds":"구름 조금","scattered clouds":"구름 많음","broken clouds":"흐림","shower rain":"소나기",rain:"비",thunderstorm:"천둥번개",snow:"눈",haze:"연무",smoke:"연기",dust:"먼지",sand:"모래",ash:"화산재",squall:"돌풍",tornado:"토네이도",sunny:"맑음","partly cloudy":"구름 조금",cloudy:"흐림",overcast:"흐림",mist:"안개",fog:"안개","patchy rain possible":"소나기 가능","patchy snow possible":"눈 가능","patchy sleet possible":"진눈깨비 가능","patchy freezing drizzle possible":"얼음비 가능","thundery outbreaks possible":"천둥번개 가능","blowing snow":"눈보라",blizzard:"폭설","freezing fog":"얼음안개","patchy light drizzle":"가벼운 이슬비","light drizzle":"이슬비","freezing drizzle":"얼음비","heavy freezing drizzle":"강한 얼음비","patchy light rain":"가벼운 비","light rain":"가벼운 비","moderate rain at times":"중간 비","moderate rain":"중간 비","heavy rain at times":"강한 비","heavy rain":"강한 비","light freezing rain":"가벼운 얼음비","moderate or heavy freezing rain":"중간 또는 강한 얼음비","light sleet":"가벼운 진눈깨비","moderate or heavy sleet":"중간 또는 강한 진눈깨비","patchy light snow":"가벼운 눈","light snow":"가벼운 눈","patchy moderate snow":"중간 눈","moderate snow":"중간 눈","patchy heavy snow":"강한 눈","heavy snow":"강한 눈","ice pellets":"얼음알갱이","light rain shower":"가벼운 소나기","moderate or heavy rain shower":"중간 또는 강한 소나기","torrential rain shower":"폭우","light sleet showers":"가벼운 진눈깨비 소나기","moderate or heavy sleet showers":"중간 또는 강한 진눈깨비 소나기","light snow showers":"가벼운 눈 소나기","moderate or heavy snow showers":"중간 또는 강한 눈 소나기","light showers of ice pellets":"가벼운 얼음알갱이 소나기","moderate or heavy showers of ice pellets":"중간 또는 강한 얼음알갱이 소나기","patchy light rain with thunder":"가벼운 비와 천둥","moderate or heavy rain with thunder":"중간 또는 강한 비와 천둥","patchy light snow with thunder":"가벼운 눈과 천둥","moderate or heavy snow with thunder":"중간 또는 강한 눈과 천둥",局部多云:"구름 조금"},th:{"clear sky":"ท้องฟ้าแจ่มใส","few clouds":"มีเมฆบางส่วน","scattered clouds":"มีเมฆมาก","broken clouds":"เมฆมาก","shower rain":"ฝนตกเป็นช่วง",rain:"ฝนตก",thunderstorm:"พายุฝนฟ้าคะนอง",snow:"หิมะตก",haze:"หมอกควัน",smoke:"ควัน",dust:"ฝุ่น",sand:"ทราย",ash:"เถ้าถ่าน",squall:"ลมกระโชก",tornado:"พายุทอร์นาโด",sunny:"ท้องฟ้าแจ่มใส","partly cloudy":"มีเมฆบางส่วน",cloudy:"เมฆมาก",overcast:"เมฆมาก",mist:"หมอก",fog:"หมอก","patchy rain possible":"อาจมีฝนตกเป็นช่วง","patchy snow possible":"อาจมีหิมะตกเป็นช่วง","patchy sleet possible":"อาจมีหิมะปนฝนเป็นช่วง","patchy freezing drizzle possible":"อาจมีน้ำค้างแข็งเป็นช่วง","thundery outbreaks possible":"อาจมีพายุฝนฟ้าคะนอง","blowing snow":"หิมะปลิว",blizzard:"พายุหิมะ","freezing fog":"หมอกแข็ง","patchy light drizzle":"น้ำค้างเบาเป็นช่วง","light drizzle":"น้ำค้างเบา","freezing drizzle":"น้ำค้างแข็ง","heavy freezing drizzle":"น้ำค้างแข็งแรง","patchy light rain":"ฝนเบาเป็นช่วง","light rain":"ฝนเบา","moderate rain at times":"ฝนปานกลางเป็นครั้งคราว","moderate rain":"ฝนปานกลาง","heavy rain at times":"ฝนแรงเป็นครั้งคราว","heavy rain":"ฝนแรง","light freezing rain":"ฝนแข็งเบา","moderate or heavy freezing rain":"ฝนแข็งปานกลางหรือแรง","light sleet":"หิมะปนฝนเบา","moderate or heavy sleet":"หิมะปนฝนปานกลางหรือแรง","patchy light snow":"หิมะเบาเป็นช่วง","light snow":"หิมะเบา","patchy moderate snow":"หิมะปานกลางเป็นช่วง","moderate snow":"หิมะปานกลาง","patchy heavy snow":"หิมะแรงเป็นช่วง","heavy snow":"หิมะแรง","ice pellets":"ลูกเห็บ","light rain shower":"ฝนเบาสั้นๆ","moderate or heavy rain shower":"ฝนปานกลางหรือแรงสั้นๆ","torrential rain shower":"ฝนแรงสั้นๆ","light sleet showers":"หิมะปนฝนเบาสั้นๆ","moderate or heavy sleet showers":"หิมะปนฝนปานกลางหรือแรงสั้นๆ","light snow showers":"หิมะเบาสั้นๆ","moderate or heavy snow showers":"หิมะปานกลางหรือแรงสั้นๆ","light showers of ice pellets":"ลูกเห็บเบาสั้นๆ","moderate or heavy showers of ice pellets":"ลูกเห็บปานกลางหรือแรงสั้นๆ","patchy light rain with thunder":"ฝนเบาเป็นช่วงพร้อมฟ้าผ่า","moderate or heavy rain with thunder":"ฝนปานกลางหรือแรงพร้อมฟ้าผ่า","patchy light snow with thunder":"หิมะเบาเป็นช่วงพร้อมฟ้าผ่า","moderate or heavy snow with thunder":"หิมะปานกลางหรือแรงพร้อมฟ้าผ่า",局部多云:"มีเมฆบางส่วน"},vi:{"clear sky":"Trời quang","few clouds":"Ít mây","scattered clouds":"Nhiều mây","broken clouds":"U ám","shower rain":"Mưa rào",rain:"Mưa",thunderstorm:"Giông bão",snow:"Tuyết",haze:"Sương mù nhẹ",smoke:"Khói",dust:"Bụi",sand:"Cát",ash:"Tro núi lửa",squall:"Gió mạnh",tornado:"Lốc xoáy",sunny:"Trời nắng","partly cloudy":"Ít mây",cloudy:"Nhiều mây",overcast:"U ám",mist:"Sương mù",fog:"Sương mù","patchy rain possible":"Có thể mưa rào","patchy snow possible":"Có thể có tuyết","patchy sleet possible":"Có thể có mưa tuyết","patchy freezing drizzle possible":"Có thể có mưa đá","thundery outbreaks possible":"Có thể có giông bão","blowing snow":"Tuyết bay",blizzard:"Bão tuyết","freezing fog":"Sương mù đóng băng","patchy light drizzle":"Mưa phùn nhẹ","light drizzle":"Mưa phùn nhẹ","freezing drizzle":"Mưa đá","heavy freezing drizzle":"Mưa đá mạnh","patchy light rain":"Mưa nhẹ","light rain":"Mưa nhẹ","moderate rain at times":"Mưa vừa","moderate rain":"Mưa vừa","heavy rain at times":"Mưa to","heavy rain":"Mưa to","light freezing rain":"Mưa đá nhẹ","moderate or heavy freezing rain":"Mưa đá vừa hoặc mạnh","light sleet":"Mưa tuyết nhẹ","moderate or heavy sleet":"Mưa tuyết vừa hoặc mạnh","patchy light snow":"Tuyết nhẹ","light snow":"Tuyết nhẹ","patchy moderate snow":"Tuyết vừa","moderate snow":"Tuyết vừa","patchy heavy snow":"Tuyết to","heavy snow":"Tuyết to","ice pellets":"Mưa đá","light rain shower":"Mưa rào nhẹ","moderate or heavy rain shower":"Mưa rào vừa hoặc mạnh","torrential rain shower":"Mưa rào to","light sleet showers":"Mưa tuyết nhẹ","moderate or heavy sleet showers":"Mưa tuyết vừa hoặc mạnh","light snow showers":"Tuyết nhẹ","moderate or heavy snow showers":"Tuyết vừa hoặc mạnh","light showers of ice pellets":"Mưa đá nhẹ","moderate or heavy showers of ice pellets":"Mưa đá vừa hoặc mạnh","patchy light rain with thunder":"Mưa nhẹ có sấm","moderate or heavy rain with thunder":"Mưa vừa hoặc mạnh có sấm","patchy light snow with thunder":"Tuyết nhẹ có sấm","moderate or heavy snow with thunder":"Tuyết vừa hoặc mạnh có sấm",局部多云:"Ít mây"},ms:{"clear sky":"Cerah","few clouds":"Sedikit berawan","scattered clouds":"Berawan","broken clouds":"Mendung","shower rain":"Hujan renyai",rain:"Hujan",thunderstorm:"Ribut petir",snow:"Salji",haze:"Jerebu",smoke:"Asap",dust:"Debu",sand:"Pasir",ash:"Abu gunung berapi",squall:"Angin kencang",tornado:"Puting beliung",sunny:"Cerah","partly cloudy":"Sedikit berawan",cloudy:"Berawan",overcast:"Mendung",mist:"Kabut",fog:"Kabut","patchy rain possible":"Hujan renyai mungkin","patchy snow possible":"Salji mungkin","patchy sleet possible":"Hujan salji mungkin","patchy freezing drizzle possible":"Hujan beku mungkin","thundery outbreaks possible":"Ribut petir mungkin","blowing snow":"Salji berterbangan",blizzard:"Ribut salji","freezing fog":"Kabut beku","patchy light drizzle":"Hujan renyai ringan","light drizzle":"Hujan renyai ringan","freezing drizzle":"Hujan beku","heavy freezing drizzle":"Hujan beku lebat","patchy light rain":"Hujan ringan","light rain":"Hujan ringan","moderate rain at times":"Hujan sederhana","moderate rain":"Hujan sederhana","heavy rain at times":"Hujan lebat","heavy rain":"Hujan lebat","light freezing rain":"Hujan beku ringan","moderate or heavy freezing rain":"Hujan beku sederhana atau lebat","light sleet":"Hujan salji ringan","moderate or heavy sleet":"Hujan salji sederhana atau lebat","patchy light snow":"Salji ringan","light snow":"Salji ringan","patchy moderate snow":"Salji sederhana","moderate snow":"Salji sederhana","patchy heavy snow":"Salji lebat","heavy snow":"Salji lebat","ice pellets":"Hujan batu","light rain shower":"Hujan ringan","moderate or heavy rain shower":"Hujan sederhana atau lebat","torrential rain shower":"Hujan lebat","light sleet showers":"Hujan salji ringan","moderate or heavy sleet showers":"Hujan salji sederhana atau lebat","light snow showers":"Salji ringan","moderate or heavy snow showers":"Salji sederhana atau lebat","light showers of ice pellets":"Hujan batu ringan","moderate or heavy showers of ice pellets":"Hujan batu sederhana atau lebat","patchy light rain with thunder":"Hujan ringan dengan petir","moderate or heavy rain with thunder":"Hujan sederhana atau lebat dengan petir","patchy light snow with thunder":"Salji ringan dengan petir","moderate or heavy snow with thunder":"Salji sederhana atau lebat dengan petir",局部多云:"Sedikit berawan"},la:{"clear sky":"Serenum","few clouds":"Nubibus paucis","scattered clouds":"Nubibus dispersis","broken clouds":"Nubibus fractis","shower rain":"Imbre",rain:"Pluvia",thunderstorm:"Tempestas",snow:"Nix",haze:"Caligo",smoke:"Fumus",dust:"Pulvis",sand:"Arena",ash:"Cinis",squall:"Procella",tornado:"Turbo",sunny:"Serenum","partly cloudy":"Nubibus paucis",cloudy:"Nubibus",overcast:"Nubibus densis",mist:"Nebula",fog:"Nebula","patchy rain possible":"Imbre possibilis","patchy snow possible":"Nix possibilis","patchy sleet possible":"Nix pluvia possibilis","patchy freezing drizzle possible":"Gelida pluvia possibilis","thundery outbreaks possible":"Tempestas possibilis","blowing snow":"Nix ventosa",blizzard:"Procella nivis","freezing fog":"Gelida nebula","patchy light drizzle":"Levis pluvia","light drizzle":"Levis pluvia","freezing drizzle":"Gelida pluvia","heavy freezing drizzle":"Gravis gelida pluvia","patchy light rain":"Levis pluvia","light rain":"Levis pluvia","moderate rain at times":"Moderata pluvia","moderate rain":"Moderata pluvia","heavy rain at times":"Gravis pluvia","heavy rain":"Gravis pluvia","light freezing rain":"Levis gelida pluvia","moderate or heavy freezing rain":"Moderata vel gravis gelida pluvia","light sleet":"Levis nix pluvia","moderate or heavy sleet":"Moderata vel gravis nix pluvia","patchy light snow":"Levis nix","light snow":"Levis nix","patchy moderate snow":"Moderata nix","moderate snow":"Moderata nix","patchy heavy snow":"Gravis nix","heavy snow":"Gravis nix","ice pellets":"Glacies grana","light rain shower":"Levis pluvia","moderate or heavy rain shower":"Moderata vel gravis pluvia","torrential rain shower":"Torrens pluvia","light sleet showers":"Levis nix pluvia","moderate or heavy sleet showers":"Moderata vel gravis nix pluvia","light snow showers":"Levis nix","moderate or heavy snow showers":"Moderata vel gravis nix","light showers of ice pellets":"Levis glacies grana","moderate or heavy showers of ice pellets":"Moderata vel gravis glacies grana","patchy light rain with thunder":"Levis pluvia cum tonitru","moderate or heavy rain with thunder":"Moderata vel gravis pluvia cum tonitru","patchy light snow with thunder":"Levis nix cum tonitru","moderate or heavy snow with thunder":"Moderata vel gravis nix cum tonitru",局部多云:"Nubibus paucis"}},F={"zh-TW":{Taipei:"台北市",Taichung:"台中市",Tainan:"台南市",Kaohsiung:"高雄市","New Taipei":"新北市",Taoyuan:"桃園市",Hsinchu:"新竹市",Chiayi:"嘉義市",Keelung:"基隆市",Hualien:"花蓮縣",Taitung:"台東縣",Pingtung:"屏東縣",Yilan:"宜蘭縣",Nantou:"南投縣",Yunlin:"雲林縣",Changhua:"彰化縣",Miaoli:"苗栗縣"},"zh-CN":{Taipei:"台北市",Taichung:"台中市",Tainan:"台南市",Kaohsiung:"高雄市","New Taipei":"新北市",Taoyuan:"桃园市",Hsinchu:"新竹市",Chiayi:"嘉义市",Keelung:"基隆市",Hualien:"花莲县",Taitung:"台东县",Pingtung:"屏东县",Yilan:"宜兰县",Nantou:"南投县",Yunlin:"云林县",Changhua:"彰化县",Miaoli:"苗栗县"},en:{Taipei:"Taipei",Taichung:"Taichung",Tainan:"Tainan",Kaohsiung:"Kaohsiung","New Taipei":"New Taipei",Taoyuan:"Taoyuan",Hsinchu:"Hsinchu",Chiayi:"Chiayi",Keelung:"Keelung",Hualien:"Hualien",Taitung:"Taitung",Pingtung:"Pingtung",Yilan:"Yilan",Nantou:"Nantou",Yunlin:"Yunlin",Changhua:"Changhua",Miaoli:"Miaoli"},ja:{Taipei:"台北",Taichung:"台中",Tainan:"台南",Kaohsiung:"高雄","New Taipei":"新北",Taoyuan:"桃園",Hsinchu:"新竹",Chiayi:"嘉義",Keelung:"基隆",Hualien:"花蓮",Taitung:"台東",Pingtung:"屏東",Yilan:"宜蘭",Nantou:"南投",Yunlin:"雲林",Changhua:"彰化",Miaoli:"苗栗"},ko:{Taipei:"타이페이",Taichung:"타이중",Tainan:"타이난",Kaohsiung:"가오슝","New Taipei":"신베이",Taoyuan:"타오위안",Hsinchu:"신주",Chiayi:"자이",Keelung:"지룽",Hualien:"화롄",Taitung:"타이둥",Pingtung:"핑둥",Yilan:"이란",Nantou:"난터우",Yunlin:"윈린",Changhua:"창화",Miaoli:"먀오리"},th:{Taipei:"ไทเป",Taichung:"ไทจง",Tainan:"ไทหนาน",Kaohsiung:"เกาสง","New Taipei":"ซินเป่ย์",Taoyuan:"เถาหยวน",Hsinchu:"ซินจู๋",Chiayi:"เจียอี้",Keelung:"จีหลง",Hualien:"ฮวาเหลียน",Taitung:"ไถตง",Pingtung:"ผิงตง",Yilan:"อี๋หลาน",Nantou:"หนานโถว",Yunlin:"ยฺหวินหลิน",Changhua:"จางฮัว",Miaoli:"เหมียวลี่"},vi:{Taipei:"Đài Bắc",Taichung:"Đài Trung",Tainan:"Đài Nam",Kaohsiung:"Cao Hùng","New Taipei":"Tân Bắc",Taoyuan:"Đào Viên",Hsinchu:"Tân Trúc",Chiayi:"Gia Nghĩa",Keelung:"Cơ Long",Hualien:"Hoa Liên",Taitung:"Đài Đông",Pingtung:"Bình Đông",Yilan:"Nghi Lan",Nantou:"Nam Đầu",Yunlin:"Vân Lâm",Changhua:"Chương Hóa",Miaoli:"Miêu Lật"},ms:{Taipei:"Taipei",Taichung:"Taichung",Tainan:"Tainan",Kaohsiung:"Kaohsiung","New Taipei":"New Taipei",Taoyuan:"Taoyuan",Hsinchu:"Hsinchu",Chiayi:"Chiayi",Keelung:"Keelung",Hualien:"Hualien",Taitung:"Taitung",Pingtung:"Pingtung",Yilan:"Yilan",Nantou:"Nantou",Yunlin:"Yunlin",Changhua:"Changhua",Miaoli:"Miaoli"},la:{Taipei:"Taipeium",Taichung:"Taichungum",Tainan:"Tainanum",Kaohsiung:"Kaohsiungum","New Taipei":"Novum Taipeium",Taoyuan:"Taoyuanum",Hsinchu:"Hsinchuum",Chiayi:"Chiayium",Keelung:"Keelungum",Hualien:"Hualienum",Taitung:"Taitungum",Pingtung:"Pingtungum",Yilan:"Yilanum",Nantou:"Nantouum",Yunlin:"Yunlinum",Changhua:"Changhuaum",Miaoli:"Miaolium"}},P={"zh-TW":["星期日","星期一","星期二","星期三","星期四","星期五","星期六"],"zh-CN":["星期日","星期一","星期二","星期三","星期四","星期五","星期六"],en:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],ja:["日曜日","月曜日","火曜日","水曜日","木曜日","金曜日","土曜日"],ko:["일요일","월요일","화요일","수요일","목요일","금요일","토요일"],th:["วันอาทิตย์","วันจันทร์","วันอังคาร","วันพุธ","วันพฤหัสบดี","วันศุกร์","วันเสาร์"],vi:["Chủ nhật","Thứ hai","Thứ ba","Thứ tư","Thứ năm","Thứ sáu","Thứ bảy"],ms:["Ahad","Isnin","Selasa","Rabu","Khamis","Jumaat","Sabtu"],la:["Dies Solis","Dies Lunae","Dies Martis","Dies Mercurii","Dies Iovis","Dies Veneris","Dies Saturni"]},B=((W=T[I])==null?void 0:W[_.description.toLowerCase()])||_.description,q=((L=F[I])==null?void 0:L[_.city])||_.city,te=((R=P[I])==null?void 0:R[new Date().getDay()])||P.en[new Date().getDay()];return{..._,description:B,city:q,weekday:te}},C=x(r||m,t);return i.jsx("div",{className:`weather-widget ${n}`,style:{background:"#ffffff",borderRadius:"8px",padding:"8px 12px",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.1)",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',marginTop:"8px"},children:i.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:"8px"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"4px"},children:[i.jsx("span",{style:{fontSize:"16px"},children:"☀️"}),i.jsxs("div",{style:{fontSize:"14px",fontWeight:600,color:"#6B5BFF"},children:[C.temp,"°C"]}),i.jsx("div",{style:{fontSize:"10px",color:"#666"},children:C.description})]}),i.jsx("div",{style:{fontSize:"12px",color:"#666"},children:C.city}),i.jsx("div",{style:{fontSize:"12px",color:"#666"},children:C.weekday})]})})},kD={"zh-TW":{slogan:["找回信任的起點，重新出發不孤單！"],desc:"Restarter™ 重啟人生的平台，在這裡你絕不會被標籤，只被理解與支持。讓AI陪你對話、練習挑戰、交朋友，找到信任與改變的力量，你可以放心說出自己的故事與心情，這裡有理解與同行。",wall:"你可以放心說出自己的故事與心情，這裡有理解與同行。",friend:"交友區",voice:"即時語音輸入",ai:"AI 風格回覆",tts:"擬真語音輸出",chat:"來聊天吧！",emotion:"情緒圖像實驗室",welcomeRegister:"歡迎註冊"},"zh-CN":{slogan:["找回信任的起点，重新出发不孤单！"],desc:"Restarter™ 重启人生的平台，在这里你绝不会被标签，只被理解与支持。让AI陪你对话、练习挑战、交朋友，找到信任与改变的力量，你可以放心说出自己的故事与心情，这里有理解与同行。",wall:"你可以放心说出自己的故事与心情，这里有理解与同行。",friend:"交友区",voice:"即时语音输入",ai:"AI 风格回复",tts:"拟真语音输出",chat:"来聊天吧！",emotion:"情绪图像实验室",welcomeRegister:"欢迎注册"},en:{slogan:["Regain trust and start anew, you are never alone!"],desc:"Restarter™ is a platform for restarting your life. Here, you will never be labeled, only understood and supported. Let AI accompany you in conversations, practice challenges, make friends, and find the power of trust and change. You can safely share your stories and feelings—here, you are understood and never alone.",wall:"You can safely share your story and feelings here, where you will find understanding and companionship.",friend:"Friend Match",voice:"Voice Input",ai:"AI Style Reply",tts:"Realistic TTS",chat:"Let's Chat!",emotion:"Emotion Visual Lab",welcomeRegister:"Welcome Register"},ja:{slogan:["信頼を取り戻し、新たな一歩を踏み出そう！"],desc:"Restarter™は人生を再出発するためのプラットフォームです。ここでは決してラベルを貼られることはなく、理解とサポートだけがあります。AIと一緒に対話し、挑戦を練習し、友達を作り、信頼と変化の力を見つけましょう。自分のストーリーや気持ちを安心して話せる場所、それがここです。",wall:"ここでは安心して自分のストーリーや気持ちを話せます。理解と共感がここにあります。",friend:"友達マッチ",voice:"音声入力",ai:"AIスタイル返信",tts:"リアルTTS",chat:"話しましょう！",emotion:"感情ビジュアルラボ",welcomeRegister:"登録へようこそ"},ko:{slogan:["신뢰를 되찾고, 새롭게 시작하세요. 당신은 결코 혼자가 아닙니다!"],desc:"Restarter™는 인생을 재시작하는 플랫폼입니다. 이곳에서는 결코 낙인찍히지 않고, 오직 이해와 지지만이 있습니다. AI와 함께 대화하고, 도전을 연습하며, 친구를 사귀고, 신뢰와 변화의 힘을 찾아보세요. 자신의 이야기와 감정을 안심하고 말할 수 있는 곳, 바로 여기입니다.",wall:"여기서는 자신의 이야기와 감정을 안심하고 말할 수 있습니다. 이곳에는 이해와 동행이 있습니다.",friend:"친구 매칭",voice:"음성 입력",ai:"AI 스타일 답장",tts:"현실적인 TTS",chat:"채팅하자!",emotion:"감정 비주얼 랩",welcomeRegister:"가입 환영"},th:{slogan:["เริ่มต้นใหม่ด้วยความไว้วางใจ คุณไม่ได้อยู่คนเดียว!"],desc:"Restarter™ คือแพลตฟอร์มสำหรับเริ่มต้นชีวิตใหม่ ที่นี่คุณจะไม่ถูกตัดสิน มีแต่ความเข้าใจและการสนับสนุน ให้ AI อยู่เป็นเพื่อนคุย ฝึกฝนความท้าทาย หาเพื่อนใหม่ และค้นพบพลังแห่งความไว้วางใจและการเปลี่ยนแปลง คุณสามารถพูดเรื่องราวและความรู้สึกของตัวเองได้อย่างสบายใจ ที่นี่มีแต่ความเข้าใจและเพื่อนร่วมทาง",wall:"คุณสามารถพูดเรื่องราวและความรู้สึกของคุณได้อย่างสบายใจ ที่นี่มีความเข้าใจและเพื่อนร่วมทาง",friend:"จับคู่เพื่อน",voice:"ป้อนข้อมูลด้วยเสียง",ai:"ตอบกลับสไตล์ AI",tts:"TTS ที่สมจริง",chat:"มาคุยกันเถอะ!",emotion:"ห้องทดลองภาพอารมณ์",welcomeRegister:"ยินดีต้อนรับการลงทะเบียน"},vi:{slogan:["Tìm lại niềm tin, bắt đầu lại, bạn không bao giờ đơn độc!"],desc:"Restarter™ là nền tảng để làm lại cuộc đời. Ở đây bạn sẽ không bao giờ bị gán nhãn, chỉ có sự thấu hiểu và hỗ trợ. Hãy để AI đồng hành cùng bạn trò chuyện, luyện tập, kết bạn và tìm thấy sức mạnh của niềm tin và sự thay đổi. Bạn có thể yên tâm chia sẻ câu chuyện và cảm xúc của mình, ở đây luôn có sự thấu hiểu và đồng hành.",wall:"Bạn có thể yên tâm chia sẻ câu chuyện và cảm xúc của mình tại đây, nơi có sự thấu hiểu và đồng hành.",friend:"Ghép bạn bè",voice:"Nhập liệu bằng giọng nói",ai:"Trả lời theo phong cách AI",tts:"TTS thực tế",chat:"Hãy trò chuyện!",emotion:"Phòng thí nghiệm hình ảnh cảm xúc",welcomeRegister:"Chào mừng đăng ký"},ms:{slogan:["Temui semula kepercayaan, mulakan semula, anda tidak pernah keseorangan!"],desc:"Restarter™ ialah platform untuk memulakan semula kehidupan. Di sini anda tidak akan pernah dilabel, hanya difahami dan disokong. Biarkan AI menemani anda berbual, berlatih, berkawan dan temui kekuatan kepercayaan dan perubahan. Anda boleh berkongsi kisah dan perasaan anda dengan tenang, di sini ada pemahaman dan teman seperjalanan.",wall:"Anda boleh berkongsi kisah dan perasaan anda dengan tenang di sini, di mana ada pemahaman dan teman seperjalanan.",friend:"Padanan Rakan",voice:"Input Suara",ai:"Balasan Gaya AI",tts:"TTS Realistik",chat:"Jom Sembang!",emotion:"Makmal Visual Emosi",welcomeRegister:"Selamat Datang Daftar"},la:{slogan:["Fidem recupera et iterum incipe, numquam solus es!"],desc:"Restarter™ est suggestum ad vitam iterum incipiendam. Hic numquam notaberis, sed tantum intelligetur et sustineberis. Sinite AI tecum colloqui, exercere, amicos facere, vim fiduciae et mutationis invenire.",wall:"Hic tuto fabulas tuas et sensus tuos narrare potes: hic intellectus et comitatus invenies.",friend:"Par Amicus",voice:"Vox Input",ai:"AI Stylus Responsio",tts:"Verus TTS",chat:"Loquamur!",emotion:"Emotion Visual Lab",welcomeRegister:"Benevenite Registrare"}},xS={"zh-TW":"🧑‍🤝‍🧑","zh-CN":"🧑‍🤝‍🧑",en:"🧑‍🤝‍🧑",ja:"🧑‍🤝‍🧑",ko:"🧑‍🤝‍🧑",th:"🧑‍🤝‍🧑",vi:"🧑‍🤝‍🧑",ms:"🧑‍🤝‍🧑",la:"🧑‍🤝‍🧑"},bS={"zh-TW":"訂閱方案","zh-CN":"订阅方案",en:"Subscription Plans",ja:"サブスクリプションプラン",ko:"구독 플랜",th:"แผนการสมัครสมาชิก",vi:"Gói Đăng Ký",ms:"Pelan Langganan",la:"Plana Subscriptionis"};function TD(){const n=_t(),{lang:e,setLang:t}=Mt(),r=kD[e],o=v.useRef(null),a=v.useRef(null),[c,d]=v.useState(0),h=St(Ao),[m,g]=v.useState(h.currentUser),[x,S]=v.useState(!1),[C,_]=v.useState(!1),[I,T]=v.useState(!1),[F,P]=v.useState(!1),[B,q]=v.useState({title:"",message:"",requiredPlan:"basic"}),{isTestMode:te}=$i(),[W,L]=v.useState(!1),[R,A]=v.useState({currentPlan:"basic",remainingDays:0,usedTokens:0,totalTokens:0}),[N,O]=v.useState(()=>typeof window<"u"?window.innerWidth<=768:!1);v.useEffect(()=>{const Q=()=>O(window.innerWidth<=768);return Q(),window.addEventListener("resize",Q),()=>window.removeEventListener("resize",Q)},[]);const z=[{key:"echo-box",icon:"🎤",title:{"zh-TW":"心聲釋放","zh-CN":"心声释放",ja:"心の声を解放",en:"Voice Release",ko:"마음의 소리 해방",th:"ปลดปล่อยเสียงในใจ",vi:"Giải Phóng Tiếng Lòng",ms:"Pelepasan Suara Hati",la:"Vox Liberatio"},desc:{"zh-TW":"你可盡情說出心裡對某些人事物的不滿，釋放後或許有解方，天下沒有不能解決的難題","zh-CN":"你可尽情说出心里对某些人事物的不满，释放后或许有解方，天下没有不能解决的难题",ja:"心の中の特定の人や物事への不満を自由に言い、解放後には解決策があるかもしれない、解決できない問題はない",en:"You can freely speak out your dissatisfaction with certain people or things, after release there may be a solution, there is no problem that cannot be solved",ko:"마음속 특정 사람이나 사물에 대한 불만을 자유롭게 말하고, 해방 후에는 해결책이 있을지도 모르며, 해결할 수 없는 문제는 없다",th:"คุณสามารถพูดความไม่พอใจต่อคนหรือสิ่งต่างๆ ได้อย่างอิสระ หลังปลดปล่อยแล้วอาจมีวิธีแก้ไข ไม่มีปัญหาที่แก้ไขไม่ได้",vi:"Bạn có thể tự do nói ra sự bất mãn với những người hoặc sự việc cụ thể, sau khi giải phóng có thể có giải pháp, không có vấn đề nào không thể giải quyết",ms:"Anda boleh bebas mengucapkan ketidakpuasan terhadap orang atau perkara tertentu, selepas melepaskan mungkin ada penyelesaian, tiada masalah yang tidak dapat diselesaikan",la:"Libere dissatisfactionem cum hominibus vel rebus certis profer, post liberationem fortasse solutio est, nulla quaestio insolubilis est"},path:"/echo-box"},{key:"restart-wall",icon:"🧱",title:{"zh-TW":"情緒重啟牆","zh-CN":"情绪重启墙",ja:"感情リスタートウォール",en:"Emotional Restart Wall",ko:"감정 재시작 벽",th:"กำแพงรีสตาร์ทอารมณ์",vi:"Tường Khởi Động Lại Cảm Xúc",ms:"Dinding Restart Emosi",la:"Murus Restart Affectus"},desc:{"zh-TW":"舒暢分享心情，獲得支持與理解","zh-CN":"舒畅分享心情，获得支持与理解",ja:"気持ちを快く共有し、サポートと理解を得る",en:"Share feelings comfortably, get support and understanding",ko:"편안하게 감정을 공유하고 지원과 이해를 받으세요",th:"แบ่งปันความรู้สึกอย่างสบายใจ รับการสนับสนุนและความเข้าใจ",vi:"Chia sẻ cảm xúc thoải mái, nhận được hỗ trợ và thấu hiểu",ms:"Kongsi perasaan dengan selesa, dapatkan sokongan dan pemahaman",la:"Sensus libere partiri, auxilium et intelligentiam accipe"},path:"/wall"},{key:"my-story",icon:"📖",title:{"zh-TW":"我的里程碑","zh-CN":"我的里程碑",ja:"私のマイルストーン",en:"My Milestones",ko:"내 이정표",th:"เหตุการณ์สำคัญของฉัน",vi:"Cột Mốc Của Tôi",ms:"Pencapaian Saya",la:"Mea Milestones"},desc:{"zh-TW":"記錄個人成長里程碑，見證改變歷程","zh-CN":"记录个人成长里程碑，见证改变历程",ja:"個人の成長マイルストーンを記録し、変化の過程を目撃",en:"Record personal growth milestones, witness the journey of change",ko:"개인 성장의 이정표를 기록하고 변화의 여정을 목격하세요",th:"บันทึกเหตุการณ์สำคัญของการเติบโตส่วนบุคคล เป็นพยานในการเดินทางแห่งการเปลี่ยนแปลง",vi:"Ghi lại các cột mốc phát triển cá nhân, chứng kiến hành trình thay đổi",ms:"Rekod pencapaian pertumbuhan peribadi, saksikan perjalanan perubahan",la:"Milestones crescendi personalis inscribe, iter mutationis testare"},path:"/my-story"},{key:"journal",icon:"🌳",title:{"zh-TW":"心情解鎖盒","zh-CN":"心情解锁盒",ja:"気持ちアンロックボックス",en:"Mood Unlock Box",ko:"감정 언락 박스",th:"กล่องปลดล็อกอารมณ์",vi:"Hộp Mở Khóa Cảm Xúc",ms:"Kotak Buka Kunci Emosi",la:"Arca Unlock Affectus"},desc:{"zh-TW":"每天記錄心情，解鎖拼圖碎片，拼出完整的自己！","zh-CN":"每天记录心情，解锁拼图碎片，拼出完整的自己！",ja:"毎日気持ちを記録して、パズルのピースをアンロックし、完全な自分を完成させよう！",en:"Record your mood daily, unlock puzzle pieces, and piece together your complete self!",ko:"매일 기분을 기록하고 퍼즐 조각을 열어 완전한 자신을 완성하세요!",th:"บันทึกอารมณ์ทุกวัน ปลดล็อกชิ้นส่วนจิ๊กซอว์ และต่อภาพตัวเองที่สมบูรณ์!",vi:"Ghi lại tâm trạng mỗi ngày, mở khóa các mảnh ghép, và ghép thành hình ảnh hoàn chỉnh của chính mình!",ms:"Catat perasaan setiap hari, buka kepingan teka-teki, dan lengkapkan diri anda yang sempurna!",la:"Cotidie animum inscribe, fragmenta aenigmatis solve, et te ipsum perfectum compone!"},path:"/journal"},{key:"missions",icon:"🎯",title:{"zh-TW":"挑戰任務","zh-CN":"挑战任务",en:"Challenge Missions",ja:"ミッションに挑戦",ko:"임무 도전",th:"ท้าทายภารกิจ",vi:"Thử thách nhiệm vụ",ms:"Cabaran Misi",la:"Provocatio Missionum"},desc:{"zh-TW":"五站重啟路，讓你更堅強","zh-CN":"五站重启路，让你更坚强",en:"Five-Station Restart Journey, Make You Stronger",ja:"五つのステーション再起動の道、あなたをより強くする",ko:"다섯 단계 재시작 여정, 당신을 더 강하게 만들어요",th:"เส้นทางรีสตาร์ทห้าสถานี ทำให้คุณแข็งแกร่งขึ้น",vi:"Hành trình khởi động lại năm trạm, làm cho bạn mạnh mẽ hơn",ms:"Perjalanan Restart Lima Stesen, Membuat Anda Lebih Kuat",la:"Iter Restart Quinque Stationum, Te Fortiorem Facit"},path:"/restart-missions"},{key:"storywall",icon:"📖",title:{"zh-TW":"我是誰故事鏈","zh-CN":"我是誰故事鏈",ja:"ストーリーウォール",en:"Story Wall",ko:"스토리 월",th:"กำแพงเรื่องราว",vi:"Tường Truyện",ms:"Dinding Cerita",la:"Murus Fabularum"},desc:{"zh-TW":"分享故事，建立連結","zh-CN":"分享故事，建立连接",ja:"ストーリーを共有し、つながりを築く",en:"Share Stories, Build Connections",ko:"이야기를 공유하고 연결을 구축",th:"แบ่งปันเรื่องราว สร้างการเชื่อมต่อ",vi:"Chia sẻ câu chuyện, xây dựng kết nối",ms:"Kongsi cerita, bina hubungan",la:"Fabulas partiri, nexus construere"},path:"/storywall"},{key:"skillbox",icon:"🛠️",title:{"zh-TW":"社會模擬所","zh-CN":"技能方块",ja:"スキルボックス",en:"Skill Box",ko:"스킬 박스",th:"กล่องทักษะ",vi:"Hộp Kỹ Năng",ms:"Kotak Kemahiran",la:"Arca Peritiae"},desc:{"zh-TW":"練習社會互動，解鎖成就","zh-CN":"练习社会互动，解锁成就",en:"Practice social skills, unlock achievements",ja:"社会スキル練習で実績解除",ko:"사회적 기술 연습, 업적 잠금 해제",th:"ฝึกฝนทักษะทางสังคม, ปลดล็อกความสำเร็จ",vi:"Thực hành kỹ năng xã hội, mở khóa thành tích",ms:"Latih kemahiran sosial, buka pencapaian",la:"Practice social skills, unlock achievements"},path:"/skillbox"},{key:"emotionRelease",icon:"🎮",title:{"zh-TW":"情緒發洩區","zh-CN":"情绪发泄区",ja:"感情発散エリア",en:"Emotion Release Zone",ko:"감정 발산 구역",th:"พื้นที่ระบายอารมณ์",vi:"Khu Vực Giải Tỏa Cảm Xúc",ms:"Zon Pelepasan Emosi",la:"Zona Emotio Liberationis"},desc:{"zh-TW":"透過遊戲釋放壓力，找回平靜","zh-CN":"通过游戏释放压力，找回平静",en:"Release stress through games, find peace",ja:"ゲームでストレスを発散し、平静を取り戻す",ko:"게임으로 스트레스를 해소하고 평온을 찾으세요",th:"ปลดปล่อยความเครียดผ่านเกม หาความสงบ",vi:"Giải tỏa căng thẳng qua trò chơi, tìm lại bình yên",ms:"Lepaskan tekanan melalui permainan, temui ketenangan",la:"Libera tensionem per ludos, inveni pacem"},path:"/emotion-release"}];v.useLayoutEffect(()=>{if(o.current&&a.current){const Q=o.current.getBoundingClientRect().top,D=a.current.getBoundingClientRect().top,G=o.current.getBoundingClientRect().height,ie=a.current.getBoundingClientRect().height;d(Q+G-(D+ie))}},[e]),v.useEffect(()=>{const Q=Ns(h,D=>{g(D),S(!0)});return()=>Q()},[h]);const j=v.useRef(null);v.useEffect(()=>{if(!C)return;const Q=D=>{j.current&&!j.current.contains(D.target)&&_(!1)};return document.addEventListener("mousedown",Q),()=>document.removeEventListener("mousedown",Q)},[C]);const V=Q=>{n("/chat")},X={"zh-TW":"登出","zh-CN":"登出",en:"Logout",ja:"ログアウト",ko:"로그아웃",th:"ออกจากระบบ",vi:"Đăng xuất",ms:"Keluar",la:"Exire"},$={"zh-TW":"互相幫助&合作實驗室","zh-CN":"互相帮助&合作实验室",en:"Mutual Help & Collaboration Lab",ja:"相互支援＆協力ラボ",ko:"상호도움&협력실험실",th:"ห้องทดลองช่วยเหลือและร่วมมือ",vi:"Phòng thí nghiệm Hỗ trợ & Hợp tác",ms:"Makmal Bantuan & Kerjasama",la:"Laboratorium Auxilii Mutui et Cooperationis"},oe={"zh-TW":{title:"請先註冊/登入才能使用此功能",btn:"前往註冊/登入",close:"關閉"},"zh-CN":{title:"请先注册/登录才能使用此功能",btn:"前往注册/登录",close:"关闭"},en:{title:"Please register/login to use this feature",btn:"Go to Register/Login",close:"Close"},ja:{title:"ご利用には登録/ログインが必要です",btn:"登録/ログインへ",close:"閉じる"},ko:{title:"이 기능을 사용하려면 가입/로그인 해주세요",btn:"가입/로그인으로 이동",close:"닫기"},th:{title:"กรุณาสมัคร/เข้าสู่ระบบก่อนใช้ฟีเจอร์นี้",btn:"ไปที่สมัคร/เข้าสู่ระบบ",close:"ปิด"},vi:{title:"Vui lòng đăng ký/đăng nhập để sử dụng chức năng này",btn:"Đến đăng ký/đăng nhập",close:"Đóng"},ms:{title:"Sila daftar/log masuk untuk menggunakan ciri ini",btn:"Pergi ke Daftar/Log Masuk",close:"Tutup"},la:{title:"Quaeso registra/aperi ut hoc munus utaris",btn:"Ad registra/login",close:"Claude"}}[e],J=async(Q,D)=>{if(!m){T(!0);return}if(te){Q();return}if(D)try{const G=await fetch("/api/subscription/check-permission",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:m.uid,feature:D})});if(!G.ok)throw new Error("權限檢查失敗");const ie=await G.json();if(!ie.allowed){ie.canRenew?(A({currentPlan:ie.currentPlan,remainingDays:ie.remainingDays,usedTokens:ie.usedTokens,totalTokens:ie.totalTokens}),L(!0)):(q({title:"功能需要升級",message:ie.reason||"此功能需要升級訂閱才能使用",requiredPlan:ie.requiredPlan||"basic"}),P(!0));return}}catch(G){console.error("權限檢查錯誤:",G)}Q()};return x?i.jsxs("div",{style:{position:"relative",minHeight:"100vh"},children:[N?i.jsxs("div",{style:{position:"fixed",top:0,left:0,right:0,zIndex:100,background:"rgba(255,255,255,0.95)",padding:"8px 16px",display:"flex",justifyContent:"space-between",alignItems:"center",boxShadow:"0 2px 8px #0001"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[i.jsx("img",{src:"/ctx-logo.png",alt:"logo",style:{width:72,height:72,cursor:"pointer"},onClick:()=>n("/")}),i.jsx("span",{style:{fontSize:14,fontWeight:700,color:"#6B5BFF"},children:"Restarter™"})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[m?i.jsxs(i.Fragment,{children:[i.jsx("img",{src:m.photoURL||"/ctx-logo.png",alt:"avatar",style:{width:28,height:28,borderRadius:"50%",objectFit:"cover",border:"2px solid #6B5BFF"}}),i.jsx("span",{style:{color:"#6B5BFF",fontWeight:600,fontSize:12,maxWidth:60,overflow:"hidden",textOverflow:"ellipsis"},children:m.displayName||m.email||"用戶"}),i.jsx("button",{className:"topbar-btn",onClick:async()=>{await Ir(h)},style:{background:"#fff",color:"#ff6347",border:"1px solid #ff6347",borderRadius:6,fontWeight:600,fontSize:12,padding:"4px 8px"},children:X[e]})]}):i.jsx("button",{className:"topbar-btn",onClick:()=>n("/register"),style:{background:"#fff",color:"#1976d2",border:"1px solid #1976d2",borderRadius:6,fontWeight:600,fontSize:12,padding:"4px 8px"},children:e==="zh-TW"?"註冊":e==="zh-CN"?"注册":e==="en"?"Register":e==="ja"?"登録":e==="ko"?"가입":e==="th"?"สมัคร":e==="vi"?"Đăng ký":e==="ms"?"Daftar":"Registrare"}),i.jsx(Bn,{style:{width:"80px",fontSize:14,padding:"6px 10px"}})]})]}):i.jsxs("div",{style:{position:"fixed",top:24,right:36,zIndex:9999,display:"flex",flexDirection:"row",alignItems:"center",gap:18,pointerEvents:"auto",width:"100%",justifyContent:"flex-end"},children:[i.jsxs("div",{style:{display:"flex",flexDirection:"row",gap:18,marginRight:24},children:[i.jsx("button",{className:"topbar-btn",onClick:()=>n("/about"),style:{background:"#fff",color:"#6B5BFF",border:"2px solid #6B5BFF",borderRadius:8,fontWeight:700,fontSize:16,padding:"8px 14px",minWidth:120},"aria-label":e==="zh-TW"||e==="zh-CN"?"了解 Restarter 平台":e==="en"?"Learn about Restarter platform":e==="ja"?"Restarter プラットフォームについて":e==="ko"?"Restarter 플랫폼에 대해 알아보기":e==="th"?"เรียนรู้เกี่ยวกับแพลตฟอร์ม Restarter":e==="vi"?"Tìm hiểu về nền tảng Restarter":e==="ms"?"Ketahui tentang platform Restarter":"Cognosce de suggestum Restarter",role:"button",children:e==="zh-TW"?"🧬 Restarter™｜我們是誰":e==="zh-CN"?"🧬 Restarter™｜我们是谁":e==="en"?"🧬 Restarter™｜Who We Are":e==="ja"?"🧬 Restarter™｜私たちについて":e==="ko"?"🧬 Restarter™｜우리는 누구인가":e==="th"?"🧬 Restarter™｜เราเป็นใคร":e==="vi"?"🧬 Restarter™｜Chúng tôi là ai":e==="ms"?"🧬 Restarter™｜Siapa Kami":"🧬 Restarter™｜Quis sumus"}),i.jsx("button",{className:"topbar-btn",onClick:()=>n("/feedback"),style:{background:"#fff",color:"#6B5BFF",border:"2px solid #6B5BFF",borderRadius:8,fontWeight:700,fontSize:16,padding:"8px 14px",minWidth:140},"aria-label":e==="zh-TW"?"提供意見和建議":e==="zh-CN"?"提供意见和建议":e==="en"?"Provide feedback and suggestions":e==="ja"?"ご意見やご提案を提供":e==="ko"?"의견과 제안 제공":e==="th"?"ให้ข้อเสนอแนะและคำแนะนำ":e==="vi"?"Cung cấp phản hồi và đề xuất":e==="ms"?"Berikan maklum balas dan cadangan":"Praebe consilia et suggestiones",role:"button",children:e==="zh-TW"?"💬 意見箱｜我們想聽你說":e==="zh-CN"?"💬 意见箱｜我们想听你说":e==="en"?"💬 Feedback｜We Want to Hear You":e==="ja"?"💬 ご意見箱｜あなたの声を聞かせて":e==="ko"?"💬 피드백｜여러분의 의견을 듣고 싶어요":e==="th"?"💬 กล่องความคิดเห็น｜เราอยากฟังคุณ":e==="vi"?"💬 Hộp góp ý｜Chúng tôi muốn lắng nghe bạn":e==="ms"?"💬 Kotak Maklum Balas｜Kami ingin mendengar anda":"💬 Arca Consilii｜Te audire volumus"}),i.jsx("button",{className:"topbar-btn",onClick:()=>n("/token-test"),style:{background:"#fff",color:"#ff6b6b",border:"2px solid #ff6b6b",borderRadius:8,fontWeight:700,fontSize:16,padding:"8px 14px",minWidth:120},"aria-label":"Token 消耗測試",role:"button",children:"🧪 Token 測試"}),m?i.jsx(i.Fragment,{children:i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[i.jsx("img",{src:m.photoURL||"/ctx-logo.png",alt:"avatar",style:{width:36,height:36,borderRadius:"50%",objectFit:"cover",border:"2px solid #90caf9"}}),i.jsx("span",{style:{color:"#1976d2",fontWeight:700,fontSize:16},children:m.displayName||m.email||"用戶"}),i.jsx("button",{className:"topbar-btn",onClick:async()=>{await Ir(h)},style:{background:"#fff",color:"#ff6347",border:"2px solid #ffb4a2",borderRadius:8,fontWeight:700,fontSize:16,padding:"8px 14px",marginLeft:6},children:X[e]})]})}):i.jsx("button",{className:"topbar-btn",onClick:()=>n("/register"),style:{background:"#fff",color:"#1976d2",border:"2px solid #90caf9",borderRadius:8,fontWeight:700,fontSize:16,padding:"8px 10px",minWidth:90},children:e==="zh-TW"?"註冊/登入":e==="zh-CN"?"注册/登录":e==="en"?"Register / Login":e==="ja"?"登録/ログイン":e==="ko"?"가입/로그인":e==="th"?"สมัคร/เข้าสู่ระบบ":e==="vi"?"Đăng ký/Đăng nhập":e==="ms"?"Daftar / Log Masuk":"Registrare / Login"})]}),i.jsxs("div",{style:{position:"relative",display:"inline-block"},ref:j,children:[i.jsxs("button",{className:"topbar-btn",style:{background:"#6B5BFF",color:"#fff",border:"2px solid #6B5BFF",borderRadius:8,fontWeight:700,fontSize:16,padding:"8px 10px",minWidth:90,maxWidth:120,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},onClick:()=>_(Q=>!Q),children:[e==="zh-TW"?"繁中":e==="zh-CN"?"简中":e==="en"?"English":e==="ja"?"日本語":e==="ko"?"한국어":e==="th"?"ไทย":e==="vi"?"Tiếng Việt":e==="ms"?"Bahasa Melayu":"Latin",i.jsx("span",{style:{marginLeft:6},children:"▼"})]}),C&&i.jsx("div",{style:{position:"absolute",right:0,top:"110%",background:"#fff",border:"1.5px solid #6B5BFF",borderRadius:8,boxShadow:"0 4px 16px #0002",zIndex:9999,minWidth:120},children:["zh-TW","zh-CN","en","ja","ko","th","vi","ms","la"].map(Q=>i.jsx("div",{style:{padding:"10px 18px",cursor:"pointer",color:Q===e?"#6B5BFF":"#232946",fontWeight:Q===e?700:500,background:Q===e?"#f3f0ff":"#fff"},onClick:()=>{t(Q),_(!1)},children:Q==="zh-TW"?"繁中":Q==="zh-CN"?"简中":Q==="en"?"English":Q==="ja"?"日本語":Q==="ko"?"한국어":Q==="th"?"ไทย":Q==="vi"?"Tiếng Việt":"Latin"},Q))})]})]}),N?i.jsxs("div",{style:{width:"100vw",minHeight:"100vh",background:"url('/plains.png') center center/cover no-repeat",display:"flex",flexDirection:"column",alignItems:"center",paddingTop:120},children:[i.jsx("div",{style:{width:"100%",padding:"0 16px",marginBottom:16},children:i.jsx(yS,{})}),i.jsxs("div",{style:{width:"100%",padding:"20px 16px",textAlign:"center"},children:[i.jsx("div",{style:{marginBottom:16},children:i.jsx("span",{style:{fontWeight:900,color:"#232946",fontSize:16,lineHeight:1.2,letterSpacing:.3,textShadow:"1px 2px 8px #fff",whiteSpace:"nowrap"},children:e==="zh-TW"?"找回信任的起點，重新出發不孤單！":e==="zh-CN"?"找回信任的起点，重新出发不孤单！":e==="en"?"Regain trust and start anew, you are never alone!":e==="ja"?"信頼を取り戻し、新たな一歩を踏み出そう！":e==="ko"?"신뢰를 되찾고, 새롭게 시작하세요. 당신은 결코 혼자가 아닙니다!":e==="th"?"เริ่มต้นใหม่ด้วยความไว้วางใจ คุณไม่ได้อยู่คนเดียว!":e==="vi"?"Tìm lại niềm tin, bắt đầu lại, bạn không bao giờ đơn độc!":e==="ms"?"Temui semula kepercayaan, mulakan semula, anda tidak pernah keseorangan!":"Fidem recupera et iterum incipe, numquam solus es!"})}),i.jsxs("h1",{style:{fontSize:24,fontWeight:900,color:"#fff",marginBottom:12,textShadow:"0 2px 8px #232946"},children:[i.jsx("span",{style:{color:"#6B5BFF"},children:"Restarter™"})," Global Platform"]}),i.jsx("div",{style:{marginBottom:20},children:i.jsx("span",{style:{color:"#232946",fontWeight:500,fontSize:14,lineHeight:1.6},children:e==="zh-TW"?"Restarter™ 重啟人生的平台，在這裡你絕不會被標籤，只被理解與支持。讓AI陪你對話、練習挑戰、交朋友，找到信任與改變的力量，你可以放心說出自己的故事與心情，釋放不滿有解方，天下沒有解決不了的難題。":e==="zh-CN"?"Restarter™ 重启人生的平台，在这里你绝不会被标签，只被理解与支持。让AI陪你对话、练习挑战、交朋友，找到信任与改变的力量，你可以放心说出自己的故事与心情，释放不满有解方，天下没有解决不了的难题。":e==="en"?"Restarter™ is a platform for restarting your life. Here, you will never be labeled, only understood and supported.":e==="ja"?"Restarter™ は人生を再起動するためのプラットフォームです。ここでは決してレッテルを貼られることはなく、理解とサポートだけが得られます。":e==="ko"?"Restarter™는 인생을 재시작하는 플랫폼입니다. 이곳에서는 결코 낙인찍히지 않고, 오직 이해와 지지를 받습니다.":e==="th"?"Restarter™ คือแพลตฟอร์มสำหรับเริ่มต้นชีวิตใหม่ ที่นี่คุณจะไม่ถูกตัดสิน มีแต่ความเข้าใจและการสนับสนุน":"Restarter™ suggestum ad vitam iterum incipiendam est. Hic numquam notaberis, sed tantum intelligetur et sustineberis."})})]}),i.jsxs("div",{style:{width:"100%",padding:"0 16px",marginBottom:"16px",position:"relative"},children:[i.jsxs("button",{onClick:()=>J(()=>n("/social-integration")),style:{background:"linear-gradient(135deg, #6B5BFF 0%, #5A4FCF 100%)",border:"none",borderRadius:"16px",padding:"12px 24px",color:"white",cursor:"pointer",fontSize:"16px",fontWeight:"600",boxShadow:"0 4px 16px rgba(107, 91, 255, 0.3)",transition:"all 0.3s ease",display:"flex",alignItems:"center",gap:"8px",width:"100%",justifyContent:"center",position:"relative"},onMouseOver:Q=>{Q.currentTarget.style.transform="translateY(-2px)",Q.currentTarget.style.boxShadow="0 6px 20px rgba(107, 91, 255, 0.4)";const D=Q.currentTarget.nextElementSibling;D&&(D.style.opacity="1")},onMouseOut:Q=>{Q.currentTarget.style.transform="translateY(0)",Q.currentTarget.style.boxShadow="0 4px 16px rgba(107, 91, 255, 0.3)";const D=Q.currentTarget.nextElementSibling;D&&(D.style.opacity="0")},children:[i.jsx("span",{style:{fontSize:"18px"},children:"📊"}),e==="zh-TW"?"社會融入度評估":e==="zh-CN"?"社会融入度评估":e==="ja"?"社会統合度評価":e==="en"?"Social Integration Assessment":e==="ko"?"사회 통합도 평가":e==="th"?"การประเมินการผสมผสานทางสังคม":e==="vi"?"Đánh Giá Hòa Nhập Xã Hội":e==="ms"?"Penilaian Integrasi Sosial":"Aestimatio Integrationis Socialis"]}),i.jsx("div",{style:{position:"absolute",bottom:"100%",left:"50%",transform:"translateX(-50%)",background:"#232946",color:"white",padding:"6px 10px",borderRadius:"6px",fontSize:"10px",fontWeight:"500",textAlign:"center",whiteSpace:"nowrap",opacity:"0",transition:"opacity 0.3s ease",zIndex:1e3,pointerEvents:"none",maxWidth:"200px",marginBottom:"8px"},children:e==="zh-TW"?"評估個人社會融入度，獲得專業建議和改善方向":e==="zh-CN"?"评估个人社会融入度，获得专业建议和改善方向":e==="ja"?"個人の社会統合度を評価し、専門的なアドバイスと改善方向を獲得":e==="en"?"Assess personal social integration, get professional advice and improvement direction":e==="ko"?"개인 사회 통합도를 평가하고 전문적인 조언과 개선 방향을 얻으세요":e==="th"?"ประเมินการผสมผสานทางสังคมส่วนบุคคล รับคำแนะนำจากผู้เชี่ยวชาญและทิศทางการปรับปรุง":e==="vi"?"Đánh giá mức độ hòa nhập xã hội cá nhân, nhận lời khuyên chuyên môn và hướng cải thiện":e==="ms"?"Nilai integrasi sosial peribadi, dapatkan nasihat profesional dan arah penambahbaikan":"Aestima integrationem socialem personalem, consilium professionalem et directionem meliorationis accipe"})]}),i.jsxs("div",{style:{width:"100%",padding:"0 16px",display:"flex",flexDirection:"column",gap:12},children:[i.jsxs("div",{style:{display:"flex",flexDirection:"row",gap:8,flexWrap:"wrap"},children:[i.jsxs("button",{className:"feature-btn",style:{flex:1,minWidth:"calc(50% - 4px)",padding:"16px 8px",borderRadius:12,border:"2px solid #6B5BFF",background:"#fff",color:"#6B5BFF",fontWeight:700,fontSize:14,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:4},onClick:()=>J(()=>n("/friend")),children:[i.jsx("span",{style:{fontSize:20},children:xS[e]}),i.jsx("span",{style:{fontSize:12,textAlign:"center"},children:r.friend})]}),i.jsxs("button",{className:"feature-btn",style:{flex:1,minWidth:"calc(50% - 4px)",padding:"16px 8px",borderRadius:12,border:"2px solid #6B5BFF",background:"#fff",color:"#6B5BFF",fontWeight:700,fontSize:14,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:4},onClick:()=>J(()=>V(),"aiChat"),children:[i.jsx("span",{style:{fontSize:20},children:"💬"}),i.jsx("span",{style:{fontSize:12,textAlign:"center"},children:r.chat})]})]}),i.jsx("div",{style:{display:"flex",flexDirection:"row",gap:8,flexWrap:"wrap"},children:z.slice(0,2).map(Q=>i.jsxs("button",{className:"feature-btn",style:{flex:1,minWidth:"calc(50% - 4px)",padding:"16px 8px",borderRadius:12,border:"2px solid #6B5BFF",background:"#fff",color:"#6B5BFF",fontWeight:700,fontSize:14,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:4},onClick:()=>J(()=>n(Q.path)),children:[i.jsx("span",{style:{fontSize:20},children:Q.icon}),i.jsx("span",{style:{fontSize:12,textAlign:"center"},children:Q.title[e]})]},Q.key))}),i.jsx("div",{style:{display:"flex",flexDirection:"row",gap:8,flexWrap:"wrap"},children:z.slice(2,4).map(Q=>i.jsxs("button",{className:"feature-btn",style:{flex:1,minWidth:"calc(50% - 4px)",padding:"16px 8px",borderRadius:12,border:"2px solid #6B5BFF",background:"#fff",color:"#6B5BFF",fontWeight:700,fontSize:14,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:4},onClick:()=>J(()=>n(Q.path)),children:[i.jsx("span",{style:{fontSize:20},children:Q.icon}),i.jsx("span",{style:{fontSize:12,textAlign:"center"},children:Q.title[e]})]},Q.key))}),i.jsxs("div",{style:{display:"flex",flexDirection:"row",gap:8,flexWrap:"wrap"},children:[z.slice(4).map(Q=>i.jsxs("button",{className:"feature-btn",style:{flex:1,minWidth:"calc(50% - 4px)",padding:"16px 8px",borderRadius:12,border:"2px solid #6B5BFF",background:"#fff",color:"#6B5BFF",fontWeight:700,fontSize:14,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:4},onClick:()=>J(()=>n(Q.path)),children:[i.jsx("span",{style:{fontSize:20},children:Q.icon}),i.jsx("span",{style:{fontSize:12,textAlign:"center"},children:Q.title[e]})]},Q.key)),i.jsxs("button",{className:"feature-btn",style:{flex:1,minWidth:"calc(50% - 4px)",padding:"16px 8px",borderRadius:12,background:"linear-gradient(90deg, #ffe0b2 0%, #ffb74d 100%)",color:"#b85c00",border:"2px solid #ffb74d",fontWeight:900,fontSize:14,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:4},onClick:()=>J(()=>n("/HelpLab")),children:[i.jsx("span",{style:{fontSize:20},children:"🧪"}),i.jsx("span",{style:{fontSize:12,textAlign:"center"},children:$[e]})]})]})]}),i.jsx("div",{style:{width:"100%",padding:"20px 16px",display:"flex",flexDirection:"column",gap:12,boxSizing:"border-box"},children:i.jsx("a",{href:"/plans",style:{width:"100%",padding:"12px",borderRadius:10,background:"#6B5BFF",color:"#fff",fontWeight:700,fontSize:14,textDecoration:"none",border:"2px solid #6B5BFF",cursor:"pointer",textAlign:"center",display:"block",boxSizing:"border-box"},children:bS[e]})})]}):i.jsxs("div",{style:{width:"100vw",minHeight:"100vh",background:"url('/plains.png') center center/cover no-repeat",display:"flex",flexDirection:"row",alignItems:"flex-start",justifyContent:"center"},children:[i.jsxs("div",{className:"home-left-col left-relative",style:{flex:1,minWidth:320,maxWidth:600,display:"flex",flexDirection:"column",alignItems:"flex-start",justifyContent:"flex-start",padding:"48px 0 0 0",zIndex:2},children:[i.jsx("div",{className:"fixed-logo-box",style:{position:"fixed",top:16,left:42,display:"flex",flexDirection:"row",alignItems:"center",gap:12,zIndex:1e4,paddingTop:0,marginTop:0},children:i.jsx("img",{src:"/ctx-logo.png",className:"fixed-logo-img",style:{marginBottom:0,width:182,height:182,cursor:"pointer",marginTop:"-40px"},onClick:()=>n("/")})}),i.jsxs("div",{className:"column-content",style:{justifyContent:"center",alignItems:"center",height:"100%",paddingTop:120},children:[i.jsx("div",{style:{width:"100%",maxWidth:900,margin:"0 auto 12px auto",textAlign:"center",wordBreak:"break-word",whiteSpace:"normal"},children:i.jsx("span",{style:{fontWeight:900,color:"#232946",fontSize:20,lineHeight:1.2,letterSpacing:.5,textShadow:"2px 4px 12px #fff, 0 2px 8px #23294688",display:"inline-block",whiteSpace:"nowrap"},children:e==="zh-TW"?"找回信任的起點，重新出發不孤單！":e==="zh-CN"?"找回信任的起点，重新出发不孤单！":e==="en"?"Regain trust and start anew, you are never alone!":e==="ja"?"信頼を取り戻し、新たな一歩を踏み出そう！":e==="ko"?"신뢰를 되찾고, 새롭게 시작하세요. 당신은 결코 혼자가 아닙니다!":e==="th"?"เริ่มต้นใหม่ด้วยความไว้วางใจ คุณไม่ได้อยู่คนเดียว!":e==="vi"?"Tìm lại niềm tin, bắt đầu lại, bạn không bao giờ đơn độc!":e==="ms"?"Temui semula kepercayaan, mulakan semula, anda tidak pernah keseorangan!":"Fidem recupera et iterum incipe, numquam solus es!"})}),i.jsxs("h1",{className:"main-title",style:{position:"relative",left:"0px",fontSize:36,fontWeight:900,color:"#fff",marginBottom:18,textShadow:"0 2px 12px #232946, 0 4px 24px #0008"},children:[i.jsx("span",{style:{color:"#6B5BFF"},children:"Restarter™"})," Global Platform"]}),i.jsx("div",{style:{width:"100%",textAlign:"center",margin:"0 auto",marginBottom:24},children:i.jsx("span",{style:{color:"#232946",fontWeight:500,fontSize:16,lineHeight:1.7,letterSpacing:.5},children:e==="zh-TW"?"Restarter™ 重啟人生的平台，在這裡你絕不會被標籤，只被理解與支持。讓AI陪你對話、練習挑戰、交朋友，找到信任與改變的力量，你可以放心說出自己的故事與心情，釋放不滿有解方，天下沒有解決不了的難題。":e==="zh-CN"?"Restarter™ 重启人生的平台，在这里你绝不会被标签，只被理解与支持。让AI陪你对话、练习挑战、交朋友，找到信任与改变的力量，你可以放心说出自己的故事与心情，释放不满有解方，天下没有解决不了的难题。":e==="en"?"Restarter™ is a platform for restarting your life. Here, you will never be labeled, only understood and supported. Let AI accompany you in conversations, practice challenges, make friends, and find the power of trust and change. You can safely share your stories and feelings—here, you are understood and never alone.":e==="ja"?"Restarter™ は人生を再起動するためのプラットフォームです。ここでは決してレッテルを貼られることはなく、理解とサポートだけが得られます。AIと一緒に会話したり、チャレンジを練習したり、友達を作ったりして、信頼と変化の力を見つけましょう。自分のストーリーや気持ちを安心して話せる場所、それがここです。":e==="ko"?"Restarter™는 인생을 재시작하는 플랫폼입니다. 이곳에서는 결코 낙인찍히지 않고, 오직 이해와 지지를 받습니다. AI와 대화하고, 도전을 연습하고, 친구를 사귀며 신뢰와 변화의 힘을 찾아보세요. 자신의 이야기와 감정을 안심하고 말할 수 있는 곳, 바로 여기입니다.":e==="th"?"Restarter™ คือแพลตฟอร์มสำหรับเริ่มต้นชีวิตใหม่ ที่นี่คุณจะไม่ถูกตัดสิน มีแต่ความเข้าใจและการสนับสนุน ให้ AI อยู่เป็นเพื่อนคุย ฝึกฝนความท้าทาย หาเพื่อนใหม่ และค้นพบพลังแห่งความไว้วางใจและการเปลี่ยนแปลง คุณสามารถพูดเรื่องราวและความรู้สึกของตัวเองได้อย่างสบายใจ ที่นี่มีแต่ความเข้าใจและเพื่อนร่วมทาง":"Restarter™ suggestum ad vitam iterum incipiendam est. Hic numquam notaberis, sed tantum intelligetur et sustineberis. Sine AI tecum colloquere, provocationes exerce, amicos invenias, fidem et mutationis vim reperias. Historias et sensus tuos tuto narrare potes, hic est intelligentia et comitatus."})}),i.jsxs("div",{style:{display:"flex",justifyContent:"center",marginBottom:"24px",position:"relative"},children:[i.jsxs("button",{onClick:()=>J(()=>n("/social-integration")),style:{background:"linear-gradient(135deg, #6B5BFF 0%, #5A4FCF 100%)",border:"none",borderRadius:"16px",padding:"16px 32px",color:"white",cursor:"pointer",fontSize:"18px",fontWeight:"600",boxShadow:"0 4px 16px rgba(107, 91, 255, 0.3)",transition:"all 0.3s ease",display:"flex",alignItems:"center",gap:"12px",position:"relative"},onMouseOver:Q=>{Q.currentTarget.style.transform="translateY(-2px)",Q.currentTarget.style.boxShadow="0 6px 20px rgba(107, 91, 255, 0.4)";const D=Q.currentTarget.nextElementSibling;D&&(D.style.opacity="1")},onMouseOut:Q=>{Q.currentTarget.style.transform="translateY(0)",Q.currentTarget.style.boxShadow="0 4px 16px rgba(107, 91, 255, 0.3)";const D=Q.currentTarget.nextElementSibling;D&&(D.style.opacity="0")},children:[i.jsx("span",{style:{fontSize:"24px"},children:"📊"}),e==="zh-TW"?"社會融入度評估":e==="zh-CN"?"社会融入度评估":e==="ja"?"社会統合度評価":e==="en"?"Social Integration Assessment":e==="ko"?"사회 통합도 평가":e==="th"?"การประเมินการผสมผสานทางสังคม":e==="vi"?"Đánh Giá Hòa Nhập Xã Hội":e==="ms"?"Penilaian Integrasi Sosial":"Aestimatio Integrationis Socialis"]}),i.jsx("div",{style:{position:"absolute",top:"-50px",left:"50%",transform:"translateX(-50%)",background:"#232946",color:"white",padding:"8px 12px",borderRadius:"8px",fontSize:"12px",fontWeight:"500",textAlign:"center",whiteSpace:"nowrap",opacity:"0",transition:"opacity 0.3s ease",zIndex:1e3,pointerEvents:"none"},children:e==="zh-TW"?"評估個人社會融入度，獲得專業建議和改善方向":e==="zh-CN"?"评估个人社会融入度，获得专业建议和改善方向":e==="ja"?"個人の社会統合度を評価し、専門的なアドバイスと改善方向を獲得":e==="en"?"Assess personal social integration, get professional advice and improvement direction":e==="ko"?"개인 사회 통합도를 평가하고 전문적인 조언과 개선 방향을 얻으세요":e==="th"?"ประเมินการผสมผสานทางสังคมส่วนบุคคล รับคำแนะนำจากผู้เชี่ยวชาญและทิศทางการปรับปรุง":e==="vi"?"Đánh giá mức độ hòa nhập xã hội cá nhân, nhận lời khuyên chuyên môn và hướng cải thiện":e==="ms"?"Nilai integrasi sosial peribadi, dapatkan nasihat profesional dan arah penambahbaikan":"Aestima integrationem socialem personalem, consilium professionalem et directionem meliorationis accipe"})]}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:18,marginBottom:18,justifyContent:"center",width:"100%"},children:[i.jsxs("div",{style:{display:"flex",flexDirection:"row",gap:18,justifyContent:"center"},children:[i.jsxs("button",{className:"feature-btn",style:{fontSize:18,padding:"24px 24px",minWidth:160,minHeight:120,display:"flex",flexDirection:"column",alignItems:"center",gap:8,justifyContent:"center"},onClick:()=>J(()=>n("/friend"),"userInteraction"),"aria-label":e==="zh-TW"?"進入交友區，尋找新朋友，建立支持圈":e==="zh-CN"?"进入交友区，寻找新朋友，建立支持圈":e==="en"?"Enter friend matching area to find new friends and build support circle":e==="ja"?"友達マッチングエリアに入って新しい友達を見つけ、サポートサークルを築く":e==="ko"?"친구 매칭 영역으로 이동하여 새로운 친구를 찾고 지원 서클을 구축":e==="th"?"เข้าสู่พื้นที่จับคู่เพื่อนเพื่อหาเพื่อนใหม่และสร้างวงกลมสนับสนุน":e==="vi"?"Vào khu vực ghép bạn bè để tìm bạn mới và xây dựng vòng tròn hỗ trợ":e==="ms"?"Masuk ke kawasan padanan rakan untuk mencari rakan baru dan membina bulatan sokongan":"Intra in area par amicus ad inveniendos novos amicos et construendam circulum auxilii",role:"button",children:[i.jsx("span",{style:{fontSize:32},children:xS[e]}),i.jsx("span",{style:{fontWeight:700,textAlign:"center",lineHeight:1.2},children:r.friend})]}),z.slice(0,2).map(Q=>i.jsxs("button",{className:"feature-btn",style:{fontSize:18,padding:"24px 24px",minWidth:160,minHeight:120,display:"flex",flexDirection:"column",alignItems:"center",gap:8,justifyContent:"center"},onClick:()=>J(()=>n(Q.path)),"aria-label":Q.desc[e],role:"button",children:[i.jsx("span",{style:{fontSize:32,transform:Q.icon==="🎤"?"translateY(8px)":"none"},children:Q.icon}),i.jsx("span",{style:{fontWeight:700,textAlign:"center",lineHeight:1.2},children:Q.title[e]})]},Q.key))]}),i.jsx("div",{style:{display:"flex",flexDirection:"row",gap:18,justifyContent:"center"},children:z.slice(2,5).map(Q=>i.jsxs("button",{className:"feature-btn",style:{fontSize:18,padding:"24px 24px",minWidth:160,minHeight:120,display:"flex",flexDirection:"column",alignItems:"center",gap:8,justifyContent:"center"},onClick:()=>J(()=>n(Q.path)),"aria-label":Q.desc[e],role:"button",children:[i.jsx("span",{style:{fontSize:32},children:Q.icon}),i.jsx("span",{style:{fontWeight:700,textAlign:"center",lineHeight:1.2},children:Q.title[e]})]},Q.key))}),i.jsxs("div",{style:{display:"flex",flexDirection:"row",gap:18,justifyContent:"center",marginTop:10},children:[i.jsxs("button",{className:"feature-btn",style:{fontSize:18,padding:"24px 24px",minWidth:160,minHeight:120,display:"flex",flexDirection:"column",alignItems:"center",gap:8,justifyContent:"center"},onClick:()=>J(()=>n("/storywall")),"aria-label":e==="zh-TW"?"分享故事，建立連結":e==="zh-CN"?"分享故事，建立连接":e==="en"?"Share Stories, Build Connections":e==="ja"?"ストーリーを共有し、つながりを築く":e==="ko"?"이야기를 공유하고 연결을 구축":e==="th"?"แบ่งปันเรื่องราว สร้างการเชื่อมต่อ":e==="vi"?"Chia sẻ câu chuyện, xây dựng kết nối":e==="ms"?"Kongsi cerita, bina hubungan":"Fabulas partiri, nexus construere",role:"button",children:[i.jsx("span",{style:{fontSize:32},children:"📖"}),i.jsx("span",{style:{fontWeight:700,textAlign:"center",lineHeight:1.2},children:e==="zh-TW"||e==="zh-CN"?"我是誰故事鏈":e==="ja"?"ストーリーウォール":e==="en"?"Story Wall":e==="ko"?"스토리 월":e==="th"?"กำแพงเรื่องราว":e==="vi"?"Tường Truyện":e==="ms"?"Dinding Cerita":"Murus Fabularum"})]}),i.jsxs("button",{className:"feature-btn mutual-help-btn",style:{fontSize:18,padding:"24px 24px",minWidth:180,maxWidth:240,minHeight:120,display:"flex",flexDirection:"column",alignItems:"center",gap:8,justifyContent:"center",background:"linear-gradient(90deg, #ffe0b2 0%, #ffb74d 100%)",color:"#b85c00",border:"2px solid #ffb74d",fontWeight:900,boxShadow:"0 2px 12px #ffb74d55"},onClick:()=>J(()=>n("/HelpLab")),"aria-label":e==="zh-TW"?"提供與獲得幫助，一樣重要":e==="zh-CN"?"提供与获得帮助，一样重要":e==="en"?"Providing and receiving help are equally important":e==="ja"?"助けを提供することと受けることは同じように重要":e==="ko"?"도움을 제공하고 받는 것은 똑같이 중요합니다":e==="th"?"การให้และรับความช่วยเหลือมีความสำคัญเท่ากัน":e==="vi"?"Cung cấp và nhận sự giúp đỡ đều quan trọng như nhau":e==="ms"?"Memberi dan menerima bantuan sama penting":"Auxilium praebere et accipere aequo modo magni momenti sunt",role:"button",children:[i.jsx("span",{style:{fontSize:32},children:"🧪"}),i.jsx("span",{style:{fontWeight:900,color:"#1976d2",textAlign:"center",lineHeight:1.2},children:$[e]})]}),i.jsxs("button",{className:"feature-btn",style:{fontSize:18,padding:"24px 24px",minWidth:160,minHeight:120,display:"flex",flexDirection:"column",alignItems:"center",gap:8,justifyContent:"center"},onClick:()=>J(()=>n("/emotion-release")),"aria-label":e==="zh-TW"?"透過遊戲釋放壓力，找回平靜":e==="zh-CN"?"通过游戏释放压力，找回平静":e==="en"?"Release stress through games, find peace":e==="ja"?"ゲームでストレスを発散し、平静を取り戻す":e==="ko"?"게임으로 스트레스를 해소하고 평온을 찾으세요":e==="th"?"ปลดปล่อยความเครียดผ่านเกม หาความสงบ":e==="vi"?"Giải tỏa căng thẳng qua trò chơi, tìm lại bình yên":e==="ms"?"Lepaskan tekanan melalui permainan, temui ketenangan":"Libera tensionem per ludos, inveni pacem",role:"button",children:[i.jsx("span",{style:{fontSize:32},children:"🎮"}),i.jsx("span",{style:{fontWeight:700,textAlign:"center",lineHeight:1.2},children:e==="zh-TW"?"情緒發洩區":e==="zh-CN"?"情绪发泄区":e==="ja"?"感情発散エリア":e==="en"?"Emotion Release Zone":e==="ko"?"감정 발산 구역":e==="th"?"พื้นที่ระบายอารมณ์":e==="vi"?"Khu Vực Giải Tỏa Cảm Xúc":e==="ms"?"Zon Pelepasan Emosi":"Zona Emotio Liberationis"})]})]})]})]})]}),i.jsxs("div",{className:"home-right-col",style:{flex:1,minWidth:320,maxWidth:520,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"flex-start",paddingTop:120,zIndex:2},children:[i.jsx("div",{style:{display:"flex",gap:18,marginBottom:18,justifyContent:"center",width:"100%"},children:i.jsx("a",{href:"/plans",style:{background:"#6B5BFF",color:"#fff",fontWeight:700,fontSize:18,padding:"10px 28px",borderRadius:10,boxShadow:"0 2px 8px #6B5BFF33",textDecoration:"none",border:"2px solid #6B5BFF",cursor:"pointer"},children:bS[e]})}),i.jsx("div",{style:{marginBottom:18,width:"100%",maxWidth:300},children:i.jsx(yS,{})}),i.jsx("img",{src:"/hero-mic.jpg",className:"home-mic-img",style:{marginBottom:0,height:"calc(100vh - 180px)",maxHeight:520,minHeight:320,width:"100%",objectFit:"contain",background:"#232946"}}),i.jsxs("button",{ref:a,className:"feature-btn home-chat-btn",style:{height:120,marginTop:0,marginBottom:0,position:"relative",top:"-60px",gap:8,padding:"24px 24px",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},onClick:()=>J(()=>V(),"aiChat"),"aria-label":e==="zh-TW"?"開始與 AI 聊天對話":e==="zh-CN"?"开始与 AI 聊天对话":e==="en"?"Start chatting with AI":e==="ja"?"AIとのチャットを開始":e==="ko"?"AI와 채팅 시작":e==="th"?"เริ่มแชทกับ AI":e==="vi"?"Bắt đầu trò chuyệnกับ AI":e==="ms"?"Mula berbual dengan AI":"Incipe colloquium cum AI",role:"button",children:[i.jsx("span",{role:"img","aria-label":"chat",style:{fontSize:32},children:"💬"}),i.jsx("span",{className:"home-chat-btn-text",style:{fontWeight:700,textAlign:"center",lineHeight:1.2},children:r.chat})]})]})]}),N?i.jsxs("footer",{style:{textAlign:"center",fontSize:12,color:"#888",marginTop:20,padding:12,background:"rgba(255,255,255,0.95)",borderTop:"1px solid #eee",display:"flex",flexDirection:"column",gap:8},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:16,flexWrap:"wrap"},children:[i.jsx("a",{href:"/privacy-policy",style:{color:"#6B5BFF",textDecoration:"underline",fontSize:11},children:e==="zh-TW"?"隱私權政策":e==="zh-CN"?"隐私政策":e==="en"?"Privacy Policy":e==="ja"?"プライバシーポリシー":e==="ko"?"개인정보 처리방침":e==="th"?"นโยบายความเป็นส่วนตัว":e==="vi"?"Chính sách bảo mật":e==="ms"?"Dasar Privasi":"Consilium de Privata"}),i.jsx("a",{href:"/terms",style:{color:"#6B5BFF",textDecoration:"underline",fontSize:11},children:e==="zh-TW"?"條款/聲明":e==="zh-CN"?"条款/声明":e==="en"?"Terms/Statement":e==="ja"?"規約/声明":e==="ko"?"약관/성명":e==="th"?"ข้อกำหนด/แถลงการณ์":e==="vi"?"Điều khoản/Tuyên bố":e==="ms"?"Terma/Pernyataan":"Termini/Declaratio"}),i.jsx("a",{href:"/data-deletion",style:{color:"#6B5BFF",textDecoration:"underline",fontSize:11},children:e==="zh-TW"?"資料刪除說明":e==="zh-CN"?"数据删除说明":e==="en"?"Data Deletion":e==="ja"?"データ削除について":e==="ko"?"데이터 삭제 안내":e==="th"?"คำอธิบายการลบข้อมูล":e==="vi"?"Giải thích xóa dữ liệu":e==="ms"?"Penjelasan Penghapusan Data":"Explicatio Deletionis Datae"})]}),i.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:16,flexWrap:"wrap"},children:[i.jsx("a",{href:"/about",style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:600,fontSize:11},children:e==="zh-TW"?"🧬 我們是誰":e==="zh-CN"?"🧬 我们是谁":e==="en"?"🧬 Who We Are":e==="ja"?"🧬 私たちについて":e==="ko"?"🧬 우리는 누구인가":e==="th"?"🧬 เราเป็นใคร":e==="vi"?"🧬 Chúng tôi là ai":e==="ms"?"🧬 Siapa Kami":"🧬 Quis sumus"}),i.jsx("a",{href:"/feedback",style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:600,fontSize:11},children:e==="zh-TW"?"💬 意見箱":e==="zh-CN"?"💬 意见箱":e==="en"?"💬 Feedback":e==="ja"?"💬 ご意見箱":e==="ko"?"💬 피드백":e==="th"?"💬 กล่องความคิดเห็น":e==="vi"?"💬 Hộp góp ý":e==="ms"?"💬 Kotak Maklum Balas":"💬 Arca Consilii"})]})]}):i.jsx("footer",{style:{textAlign:"center",fontSize:14,color:"#888",marginTop:0,padding:16,background:"rgba(255,255,255,0.92)",borderTop:"1px solid #eee",display:"flex",justifyContent:"center",alignItems:"center",boxShadow:"0 -2px 8px #0001",position:"relative",top:"-20px"},children:i.jsxs("div",{style:{width:"100%",maxWidth:700,display:"flex",justifyContent:"center",alignItems:"center"},children:[i.jsx("a",{href:"/about",style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,minWidth:120,marginRight:32},children:e==="zh-TW"?"🧬 Restarter™｜我們是誰":e==="zh-CN"?"🧬 Restarter™｜我们是谁":e==="en"?"🧬 Restarter™｜Who We Are":e==="ja"?"🧬 Restarter™｜私たちについて":e==="ko"?"🧬 Restarter™｜우리는 누구인가":e==="th"?"🧬 Restarter™｜เราเป็นใคร":e==="vi"?"🧬 Restarter™｜Chúng tôi là ai":e==="ms"?"🧬 Restarter™｜Siapa Kami":"🧬 Restarter™｜Quis sumus"}),i.jsxs("div",{style:{display:"flex",gap:32,justifyContent:"center",alignItems:"center"},children:[i.jsx("a",{href:"/privacy-policy",style:{color:"#6B5BFF",textDecoration:"underline"},children:e==="zh-TW"?"隱私權政策":e==="zh-CN"?"隐私政策":e==="en"?"Privacy Policy":e==="ja"?"プライバシーポリシー":e==="ko"?"개인정보 처리방침":e==="th"?"นโยบายความเป็นส่วนตัว":e==="vi"?"Chính sách bảo mật":e==="ms"?"Dasar Privasi":"Consilium de Privata"}),i.jsx("a",{href:"/terms",style:{color:"#6B5BFF",textDecoration:"underline"},children:e==="zh-TW"?"條款/聲明":e==="zh-CN"?"条款/声明":e==="en"?"Terms/Statement":e==="ja"?"規約/声明":e==="ko"?"약관/성명":e==="th"?"ข้อกำหนด/แถลงการณ์":e==="vi"?"Điều khoản/Tuyên bố":e==="ms"?"Terma/Pernyataan":"Termini/Declaratio"}),i.jsx("a",{href:"/data-deletion",style:{color:"#6B5BFF",textDecoration:"underline"},children:e==="zh-TW"?"資料刪除說明":e==="zh-CN"?"数据删除说明":e==="en"?"Data Deletion":e==="ja"?"データ削除について":e==="ko"?"데이터 삭제 안내":e==="th"?"คำอธิบายการลบข้อมูล":e==="vi"?"Giải thích xóa dữ liệu":e==="ms"?"Penjelasan Penghapusan Data":"Explicatio Deletionis Datae"})]}),i.jsx("a",{href:"/feedback",style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,minWidth:140,textAlign:"right",marginLeft:32},children:e==="zh-TW"?"💬 意見箱｜我們想聽你說":e==="zh-CN"?"💬 意见箱｜我们想听你说":e==="en"?"💬 Feedback｜We Want to Hear You":e==="ja"?"💬 ご意見箱｜あなたの声を聞かせて":e==="ko"?"💬 피드백｜여러분의 의견을 듣고 싶어요":e==="th"?"💬 กล่องความคิดเห็น｜เราอยากฟังคุณ":e==="vi"?"💬 Hộp góp ý｜Chúng tôi muốn lắng nghe bạn":e==="ms"?"💬 Kotak Maklum Balas｜Kami ingin mendengar anda":"💬 Arca Consilii｜Te audire volumus"})]})}),I&&i.jsx("div",{style:{position:"fixed",left:0,top:0,width:"100vw",height:"100vh",background:"rgba(40,40,80,0.18)",zIndex:1e4,display:"flex",alignItems:"center",justifyContent:"center"},children:i.jsxs("div",{style:{background:"#fff",borderRadius:18,boxShadow:"0 4px 24px #6B5BFF33",padding:28,minWidth:280,maxWidth:340,width:"90vw",position:"relative",display:"flex",flexDirection:"column",gap:12},children:[i.jsx("button",{type:"button",onClick:()=>T(!1),style:{position:"absolute",top:10,right:12,background:"none",border:"none",fontSize:22,color:"#888",cursor:"pointer",fontWeight:700},children:"×"}),i.jsx("div",{style:{fontWeight:800,fontSize:18,color:"#6B5BFF",textAlign:"center",marginBottom:2},children:oe.title}),i.jsx("button",{onClick:()=>n("/register"),style:{background:"linear-gradient(90deg, #6e8efb, #a777e3)",color:"#fff",border:"none",borderRadius:14,padding:"12px 0",fontWeight:700,fontSize:17,cursor:"pointer",margin:"12px 0"},children:oe.btn}),i.jsx("button",{onClick:()=>T(!1),style:{background:"#eee",color:"#666",border:"none",borderRadius:14,padding:"10px 0",fontWeight:700,fontSize:16,cursor:"pointer"},children:oe.close})]})}),i.jsx(SD,{isOpen:F,onClose:()=>P(!1),title:B.title,message:B.message,requiredPlan:B.requiredPlan}),i.jsx(Ms,{isOpen:W,onClose:()=>L(!1),currentPlan:R.currentPlan,remainingDays:R.remainingDays,usedTokens:R.usedTokens,totalTokens:R.totalTokens}),i.jsx("style",{children:`
        .feature-btn, .home-chat-btn, .topbar-btn {
          transition: background 0.18s, color 0.18s, box-shadow 0.18s;
          cursor: pointer;
        }
        /* 移除懸停效果以避免畫面停滯和耗電 */
        .feature-btn, .home-chat-btn {
          background: #fff;
          border-radius: 12px;
          border: 2px solid #6B5BFF;
          color: #6B5BFF;
          font-weight: 700;
          font-size: 16px;
          padding: 8px 16px;
        }
        .home-chat-btn-text {
          font-size: 18px;
          margin-left: 2px;
        }
        .topbar-btn {
          background: #6c63ff;
          border-radius: 8px;
          border: none;
          color: #fff;
          font-weight: 700;
          font-size: 16px;
          padding: 8px 18px;
        }
        .fixed-logo-box {
          position: fixed;
          top: 16px;
          left: 42px;
          display: flex;
          align-items: center;
          gap: 12px;
          z-index: 10000;
        }
        .fixed-logo-img {
          width: 54px;
          height: 54px;
        }
        .fixed-logo-slogan {
          font-size: 20px;
          font-weight: 700;
          color: #fff;
          text-shadow: 0 2px 8px #232946, 0 4px 18px #0008;
        }
      `})]}):i.jsx("div",{style:{textAlign:"center",marginTop:"30vh",fontSize:24},children:"載入中..."})}function Ls(){const[n,e]=v.useState(null),[t,r]=v.useState(!1),o=St(),a=async()=>{const h=o.currentUser;if(!h)return null;try{r(!0);const m=await fetch(`/api/subscription/status/${h.uid}`);if(m.ok){const g=await m.json();return e(g),g}}catch(m){console.error("獲取訂閱狀態失敗:",m)}finally{r(!1)}return null},c=async h=>{const m=o.currentUser;let g=m==null?void 0:m.uid;if(!g){const x=localStorage.getItem("testUser");if(x)g=JSON.parse(x).uid;else return{allowed:!1,reason:"請先登入"}}try{const x=await fetch(`/api/subscription/details/${g}`);let S=null;x.ok&&(S=await x.json());const C=localStorage.getItem("testMode")==="true";if(C)return{allowed:!0,reason:void 0,featureName:{aiChat:"AI 聊天功能",voiceInput:"語音輸入功能",voiceOutput:"語音輸出功能",videoChat:"視訊通話功能",voiceRecording:"語音錄製功能"}[h]||h,isFreeUser:!0,isTestMode:!0,currentPlan:"test"};const _=await fetch("/api/subscription/check-permission",{method:"POST",headers:{"Content-Type":"application/json","x-test-mode":C?"true":"false"},body:JSON.stringify({userId:g,feature:h})});if(_.ok){const I=await _.json(),T={aiChat:"AI 聊天功能",voiceInput:"語音輸入功能",voiceOutput:"語音輸出功能",videoChat:"視訊通話功能",voiceRecording:"語音錄製功能"},F=S&&S.isActive&&S.startDate&&new Date(S.startDate).getTime()>Date.now()-24*60*60*1e3;return{...I,featureName:T[h]||h,isFreeUser:I.currentPlan==="free"||!I.currentPlan,isNewSubscription:F,subscriptionData:S}}else return{allowed:!1,reason:"權限檢查失敗",featureName:h,isFreeUser:!0}}catch(x){return console.error("權限檢查錯誤:",x),{allowed:!1,reason:"網路錯誤",featureName:h,isFreeUser:!0}}},d=async(h,m=0)=>{const g=o.currentUser;let x=g==null?void 0:g.uid;if(!x){const C=localStorage.getItem("testUser");if(C)x=JSON.parse(C).uid;else return}const S=localStorage.getItem("testMode")==="true";try{await fetch("/api/subscription/record-usage",{method:"POST",headers:{"Content-Type":"application/json","x-test-mode":S?"true":"false"},body:JSON.stringify({userId:x,feature:h,cost:m})})}catch(C){console.error("記錄使用量失敗:",C)}};return v.useEffect(()=>{o.currentUser&&a()},[o.currentUser]),{subscriptionStatus:n,loading:t,checkPermission:c,recordUsage:d,fetchSubscriptionStatus:a}}const _D=[{code:"zh-TW",label:"繁中"},{code:"zh-CN",label:"简中"},{code:"en",label:"EN"},{code:"ja",label:"日本語"},{code:"ko",label:"한국어"},{code:"vi",label:"Tiếng Việt"},{code:"th",label:"ไทย"},{code:"la",label:"Latina"},{code:"ms",label:"Bahasa Melayu"}],vS={"zh-TW":{back:"返回",logout:"登出",title:"🧱 情緒牆 Restart Wall",subtitle:"社交情感支援平台",subtitleDesc:"在這裡，每個人都能找到情感上的歸屬感和支援。分享你的心情，或為他人提供溫暖的支援留言，讓我們一起建立溫暖的社群。",inbox:"💌 我的留言箱",placeholder:"說出你的心聲...(200字內)",send:window.innerWidth<=768?"送出":"發送",sending:"發送中...",noMessages:"還沒有留言，快來發表你的心聲吧！",commentsTitle:"支援留言：",noComments:"還沒有人留言支援",modalTitle:"這是他的心情貼文：",modalAction:"給他支援留言：",nicknamePlaceholder:"你的暱稱",commentPlaceholder:"支援內容...",submitComment:"送出支援",supportMessage:"💝 給予支援",supportDesc:"看到別人的情感分享，給予溫暖的支援和鼓勵",recording:"錄音中",pressToStop:"按下停止",readyToRecord:"準備開始錄音",recordInstruction:"點擊「開始錄音」後，系統將開始錄製您的語音留言。",recordTimeLimit:"錄音時間限制為1分鐘",cancel:"取消",startRecording:"開始錄音",voice:"語音"},"zh-CN":{back:"返回",logout:"登出",title:"🧱 情绪墙 Restart Wall",subtitle:"社交情感支援平台",subtitleDesc:"在这里，每个人都能找到情感上的归属感和支援。分享你的心情，或为他人提供温暖的支援留言，让我们一起建立温暖的社群。",inbox:"💌 我的留言箱",placeholder:"说出你的心声...",send:"发送",sending:"发送中...",noMessages:"还没有留言，快来发表你的心声吧！",commentsTitle:"支援留言：",noComments:"还没有人留言支援",modalTitle:"这是他的心情贴文：",modalAction:"给他支援留言：",nicknamePlaceholder:"你的昵称",commentPlaceholder:"支援内容...",submitComment:"送出支援",supportMessage:"💝 给予支援",supportDesc:"看到别人的情感分享，给予温暖的支援和鼓励",recording:"录音中",pressToStop:"按下停止",readyToRecord:"准备开始录音",recordInstruction:"点击「开始录音」后，系统将开始录制您的语音留言。",recordTimeLimit:"录音时间限制为1分钟",cancel:"取消",startRecording:"开始录音",voice:"语音"},en:{back:"Back",logout:"Logout",title:"🧱 Emotion Wall Restart Wall",subtitle:"Social Emotional Support Platform",subtitleDesc:"Here, everyone can find emotional belonging and support. Share your feelings, or provide warm support messages to others. Let's build a caring community together.",inbox:"💌 My Inbox",placeholder:"Say what you feel...",send:"Send",sending:"Sending...",noMessages:"No messages yet. Come and share your feelings!",commentsTitle:"Support Messages:",noComments:"No support messages yet",modalTitle:"Here's their post:",modalAction:"Leave support message:",nicknamePlaceholder:"Your Nickname",commentPlaceholder:"Support content...",submitComment:"Send Support",supportMessage:"💝 Give Support",supportDesc:"See others' emotional sharing and give warm support and encouragement",recording:"Recording",pressToStop:"Press to Stop",readyToRecord:"Ready to Start Recording",recordInstruction:'After clicking "Start Recording", the system will begin recording your voice message.',recordTimeLimit:"Recording time limit is 1 minute",cancel:"Cancel",startRecording:"Start Recording",voice:"Voice"},ja:{back:"戻る",logout:"ログアウト",title:"🧱 感情の壁 Restart Wall",subtitle:"ソーシャル感情サポートプラットフォーム",subtitleDesc:"ここでは、誰もが感情的な帰属意識とサポートを見つけることができます。あなたの気持ちを共有したり、他の人に温かい支援メッセージを提供したりして、一緒に思いやりのあるコミュニティを築きましょう。",inbox:"💌 私の受信箱",placeholder:"あなたの気持ちを話して...",send:"送信",sending:"送信中...",noMessages:"まだメッセージはありません。あなたの気持ちを投稿しに来てください！",commentsTitle:"支援メッセージ：",noComments:"まだ支援メッセージはありません",modalTitle:"彼の投稿です：",modalAction:"彼に支援メッセージを送る：",nicknamePlaceholder:"あなたのニックネーム",commentPlaceholder:"支援内容...",submitComment:"支援を送信",supportMessage:"💝 支援を送る",supportDesc:"他の人の感情的な共有を見て、温かい支援と励ましを提供する",recording:"録音中",pressToStop:"押して停止",readyToRecord:"録音の準備",recordInstruction:"「録音開始」をクリックすると、システムが音声メッセージの録音を開始します。",recordTimeLimit:"録音時間は1分に制限されています",cancel:"キャンセル",startRecording:"録音開始",voice:"音声"},ko:{back:"돌아가기",logout:"로그아웃",title:"🧱 감정의 벽 Restart Wall",subtitle:"소셜 감정 지원 플랫폼",subtitleDesc:"여기서 모든 사람이 감정적 소속감과 지원을 찾을 수 있습니다. 당신의 감정을 공유하거나 다른 사람에게 따뜻한 지원 메시지를 제공하여 함께 돌봄의 커뮤니티를 만들어봅시다.",inbox:"💌 내 메시지함",placeholder:"당신의 마음을 말해보세요...",send:"전송",sending:"전송 중...",noMessages:"아직 메시지가 없습니다. 와서 당신의 마음을 표현하세요!",commentsTitle:"지원 메시지:",noComments:"아직 지원 메시지가 없습니다",modalTitle:"그의 게시물입니다:",modalAction:"그에게 지원 메시지 남기기:",nicknamePlaceholder:"닉네임",commentPlaceholder:"지원 내용...",submitComment:"지원 보내기",supportMessage:"💝 지원하기",supportDesc:"다른 사람의 감정적 공유를 보고 따뜻한 지원과 격려를 제공",recording:"녹음 중",pressToStop:"누르면 중지",readyToRecord:"녹음 준비",recordInstruction:"「녹음 시작」을 클릭하면 시스템이 음성 메시지 녹음을 시작합니다.",recordTimeLimit:"녹음 시간은 1분으로 제한됩니다",cancel:"취소",startRecording:"녹음 시작",voice:"음성"},vi:{back:"Quay lại",logout:"Đăng xuất",title:"🧱 Bức tường Cảm xúc Restart Wall",subtitle:"Nền tảng Hỗ trợ Cảm xúc Xã hội",subtitleDesc:"Ở đây, mọi người đều có thể tìm thấy sự thuộc về và hỗ trợ về mặt cảm xúc. Chia sẻ cảm xúc của bạn, hoặc cung cấp tin nhắn hỗ trợ ấm áp cho người khác. Hãy cùng nhau xây dựng một cộng đồng quan tâm.",inbox:"💌 Hộp thư của tôi",placeholder:"Nói ra cảm xúc của bạn...",send:"Gửi",sending:"Đang gửi...",noMessages:"Chưa có tin nhắn nào. Hãy đến và chia sẻ cảm xúc của bạn!",commentsTitle:"Tin nhắn hỗ trợ:",noComments:"Chưa có tin nhắn hỗ trợ nào",modalTitle:"Đây là bài đăng của họ:",modalAction:"Để lại tin nhắn hỗ trợ:",nicknamePlaceholder:"Biệt danh của bạn",commentPlaceholder:"Nội dung hỗ trợ...",submitComment:"Gửi hỗ trợ",supportMessage:"💝 Gửi hỗ trợ",supportDesc:"Xem chia sẻ cảm xúc của người khác và đưa ra hỗ trợ và khích lệ ấm áp",recording:"Đang ghi âm",pressToStop:"Nhấn để dừng",readyToRecord:"Sẵn sàng ghi âm",recordInstruction:'Sau khi nhấp vào "Bắt đầu ghi âm", hệ thống sẽ bắt đầu ghi âm tin nhắn giọng nói của bạn.',recordTimeLimit:"Thời gian ghi âm giới hạn 1 phút",cancel:"Hủy",startRecording:"Bắt đầu ghi âm",voice:"Giọng nói"},th:{back:"กลับ",logout:"ออกจากระบบ",title:"🧱 กำแพงอารมณ์ Restart Wall",subtitle:"แพลตฟอร์มสนับสนุนอารมณ์ทางสังคม",subtitleDesc:"ที่นี่ ทุกคนสามารถหาความเป็นเจ้าของและความสนับสนุนทางอารมณ์ได้ แบ่งปันความรู้สึกของคุณ หรือให้ข้อความสนับสนุนที่อบอุ่นแก่ผู้อื่น มาเริ่มสร้างชุมชนที่ห่วงใยกันเถอะ",inbox:"💌 กล่องข้อความของฉัน",placeholder:"บอกความรู้สึกของคุณ...",send:"ส่ง",sending:"กำลังส่ง...",noMessages:"ยังไม่มีข้อความ มาแบ่งปันความรู้สึกของคุณสิ!",commentsTitle:"ข้อความสนับสนุน:",noComments:"ยังไม่มีข้อความสนับสนุน",modalTitle:"นี่คือโพสต์ของพวกเขา:",modalAction:"แสดงข้อความสนับสนุน:",nicknamePlaceholder:"ชื่อเล่นของคุณ",commentPlaceholder:"เนื้อหาสนับสนุน...",submitComment:"ส่งการสนับสนุน",supportMessage:"💝 ให้การสนับสนุน",supportDesc:"ดูการแบ่งปันอารมณ์ของผู้อื่นและให้การสนับสนุนและกำลังใจที่อบอุ่น",recording:"กำลังบันทึก",pressToStop:"กดเพื่อหยุด",readyToRecord:"พร้อมบันทึกเสียง",recordInstruction:'หลังจากคลิก "เริ่มบันทึก" ระบบจะเริ่มบันทึกข้อความเสียงของคุณ',recordTimeLimit:"เวลาบันทึกเสียงจำกัด 1 นาที",cancel:"ยกเลิก",startRecording:"เริ่มบันทึก",voice:"เสียง"},la:{back:"Redire",logout:"Exire",title:"🧱 Murus Emotionum Restart Wall",subtitle:"Platea Socialis Sustentationis Emotionalis",subtitleDesc:"Hic, omnes possunt invenire pertinere emotionalem et sustentationem. Communica sensus tuos, vel praebe calidas sustentationis epistulas aliis. Simul aedificemus communitatem curantem.",inbox:"💌 Cista Mea",placeholder:"Dic quod sentis...",send:"Mittere",sending:"Mittens...",noMessages:"Nullae epistulae adhuc. Veni et communica sensus tuos!",commentsTitle:"Epistulae Sustentationis:",noComments:"Nullae epistulae sustentationis adhuc",modalTitle:"Ecce nuntius eorum:",modalAction:"Mitte epistulam sustentationis:",nicknamePlaceholder:"Tuum agnomen",commentPlaceholder:"Contentum sustentationis...",submitComment:"Mitte Sustentationem",supportMessage:"💝 Da Sustentationem",supportDesc:"Vide communicationem emotionalem aliorum et praebe calidam sustentationem et cohortationem",recording:"Recordans",pressToStop:"Preme ad Desinere",readyToRecord:"Paratus ad Recordandum",recordInstruction:'Postquam "Incipe Recordandum" cliccas, systema incipiet recordare nuntium vocis tuae.',recordTimeLimit:"Tempus recordandi limitatur ad 1 minuta",cancel:"Cancella",startRecording:"Incipe Recordandum",voice:"Vox"},ms:{back:"Kembali",logout:"Log Keluar",title:"🧱 Tembok Emosi Restart Wall",subtitle:"Platform Sokongan Emosi Sosial",subtitleDesc:"Di sini, semua orang dapat mencari rasa kepunyaan dan sokongan emosi. Kongsi perasaan anda, atau berikan mesej sokongan yang hangat kepada orang lain. Mari kita bina komuniti yang prihatin bersama.",inbox:"💌 Kotak Mesej Saya",placeholder:"Katakan perasaan anda...",send:"Hantar",sending:"Menghantar...",noMessages:"Belum ada mesej lagi. Datang dan kongsi perasaan anda!",commentsTitle:"Mesej Sokongan:",noComments:"Belum ada mesej sokongan",modalTitle:"Ini adalah siaran mereka:",modalAction:"Tinggalkan mesej sokongan:",nicknamePlaceholder:"Nama samaran anda",commentPlaceholder:"Kandungan sokongan...",submitComment:"Hantar Sokongan",supportMessage:"💝 Beri Sokongan",supportDesc:"Lihat perkongsian emosi orang lain dan berikan sokongan dan galakan yang hangat",recording:"Merakam",pressToStop:"Tekan untuk Berhenti",readyToRecord:"Sedia untuk Merakam",recordInstruction:'Selepas mengklik "Mula Merakam", sistem akan mula merakam mesej suara anda.',recordTimeLimit:"Masa rakaman terhad kepada 1 minit",cancel:"Batal",startRecording:"Mula Merakam",voice:"Suara"}};function jD(){const n=_t(),e=St(),t=Td(),[r,o]=v.useState([]),[a,c]=v.useState(""),[d,h]=v.useState(!1),[m,g]=v.useState(null),[x,S]=v.useState(""),[C,_]=v.useState(!1),[I,T]=v.useState(null),[F,P]=v.useState(!1),[B,q]=v.useState(!1),[te,W]=v.useState(0),[L,R]=v.useState(null),[A,N]=v.useState([]),[O,z]=v.useState(!1),[j,V]=v.useState(""),[X,$]=v.useState(0),[ne,oe]=v.useState(!1),J=v.useRef(null),Q=v.useRef([]),{lang:D,setLang:G}=Mt(),ie=vS[D]||vS["zh-TW"],{checkPermission:ee,recordUsage:Se}=Ls(),[we,Oe]=v.useState(!1),[Ne,Ye]=v.useState(null),{isTestMode:it}=$i(),me=async ue=>{var le,Re,rt;try{const xe=Vn(t,"profiles",ue),Ae=await Cs(xe);if(Ae.exists()){const Ge=Ae.data();return{name:Ge.nickname||Ge.name||"用戶",avatar:Ge.avatar||"/avatars/Derxl.png",country:Ge.country||"台灣",gender:Ge.gender||"未知",age:Ge.age||25,email:((le=e.currentUser)==null?void 0:le.email)||"unknown@example.com"}}else{const Ge=e.currentUser;return{name:(Ge==null?void 0:Ge.displayName)||((Re=Ge==null?void 0:Ge.email)==null?void 0:Re.split("@")[0])||"用戶",avatar:(Ge==null?void 0:Ge.photoURL)||"/avatars/Derxl.png",country:"台灣",gender:"未知",age:25,email:(Ge==null?void 0:Ge.email)||"unknown@example.com"}}}catch(xe){console.error("獲取用戶資料失敗:",xe);const Ae=e.currentUser;return{name:(Ae==null?void 0:Ae.displayName)||((rt=Ae==null?void 0:Ae.email)==null?void 0:rt.split("@")[0])||"用戶",avatar:(Ae==null?void 0:Ae.photoURL)||"/avatars/Derxl.png",country:"台灣",gender:"未知",age:25,email:(Ae==null?void 0:Ae.email)||"unknown@example.com"}}};v.useEffect(()=>{const ue=localStorage.getItem("messages");if(ue)try{const le=JSON.parse(ue),Re=St(),rt=Re.currentUser,xe=le.filter(ft=>!rt||ft.user.id!=="user123"&&ft.user.id!=="user456"&&ft.user.id!=="user789"),Ae=xe.sort((ft,ke)=>new Date(ke.createdAt).getTime()-new Date(ft.createdAt).getTime());o(Ae),console.log("已加載localStorage中的消息:",Ae.length,"條"),console.log("消息內容:",Ae),xe.length!==le.length&&(localStorage.setItem("messages",JSON.stringify(xe)),console.log("已清理假數據"));const Ge=Re.currentUser;Ge&&(async()=>{try{let ke=!1;const at=await me(Ge.uid),pe=xe.map(de=>{if(de.comments){const De=de.comments.map($e=>(($e.nickname==="lkjh123"||$e.commenterEmail==="as0@gmail.com"||!$e.commenterId||$e.commenterAge===0||$e.commenterAge===35||$e.commenterAge===39)&&($e.commenterId=Ge.uid,$e.nickname=at.name,$e.commenterEmail=at.email,$e.commenterAvatar=at.avatar,$e.commenterCountry=at.country,$e.commenterGender=at.gender,$e.commenterAge=at.age,$e.createdAt=$e.createdAt||new Date().toISOString(),ke=!0,console.log("強制修復支援留言:",$e)),$e));return{...de,comments:De}}return de});ke&&(o(pe),localStorage.setItem("messages",JSON.stringify(pe)),console.log("已修復舊的支援留言數據"))}catch(ke){console.error("修復支援留言數據失敗:",ke)}})()}catch(le){console.error("解析localStorage消息失敗:",le)}else console.log("localStorage中沒有保存的消息")},[]);const Ve=ue=>{const Re=St().currentUser;return Re&&ue.user.id===Re.uid},Xe=ue=>{const Re=St().currentUser;return Re&&ue.commenterId===Re.uid},Je=()=>{const le=St().currentUser;return le?r.filter(Re=>Re.user.id===le.uid):[]},He=()=>{const le=St().currentUser,Re=[];return le?(console.log("當前用戶UID:",le.uid),console.log("所有留言:",r),r.forEach(rt=>{var xe,Ae;console.log("檢查留言:",rt.id,"支援留言數量:",((xe=rt.comments)==null?void 0:xe.length)||0),(Ae=rt.comments)==null||Ae.forEach(Ge=>{var ft;if(!Ge.commenterId){const ke=le.displayName||((ft=le.email)==null?void 0:ft.split("@")[0])||"用戶",at=le.email;(Ge.nickname===ke||Ge.commenterEmail===at)&&(Ge.commenterId=le.uid,console.log("為舊支援留言添加commenterId:",Ge))}console.log("支援留言:",Ge.nickname,"commenterId:",Ge.commenterId,"當前用戶UID:",le.uid),Ge.commenterId===le.uid&&(console.log("找到我的支援留言:",Ge),Re.push({message:rt,comment:Ge}))})}),console.log("我的支援留言總數:",Re.length),Re):(console.log("沒有登入用戶"),Re)},fe=async()=>{if(B){J.current&&J.current.state==="recording"&&J.current.stop(),L&&(clearInterval(L),R(null)),q(!1),P(!1),W(0);return}if(localStorage.getItem("testMode")==="true"){oe(!0);return}const le=await ee("aiChat");if(!le.allowed){Ye(le),Oe(!0);return}oe(!0)},Te=async()=>{oe(!1);try{const ue=await navigator.mediaDevices.getUserMedia({audio:!0}),le=new MediaRecorder(ue,{mimeType:"audio/webm;codecs=opus"});N([]),Q.current=[],W(0),le.ondataavailable=rt=>{console.log("收到音頻數據，大小:",rt.data.size),rt.data.size>0&&(Q.current.push(rt.data),N(xe=>{const Ae=[...xe,rt.data];return console.log("更新音頻塊，當前數量:",Ae.length),Ae}))},le.onstop=()=>{const rt=[...Q.current];console.log("錄音停止，音頻塊數量:",rt.length);const xe=rt.length>0?new Blob(rt,{type:"audio/webm"}):new Blob([""],{type:"audio/webm"}),Ae=Math.max(1,Math.floor(rt.length*.1));console.log("創建音頻blob，大小:",xe.size,"估算錄音時長:",Ae);const Ge=URL.createObjectURL(xe);V(Ge),$(Ae),z(!0),ue.getTracks().forEach(ft=>ft.stop())},le.start(100),J.current=le,q(!0),P(!0);const Re=setInterval(()=>{W(rt=>{const xe=rt+1;return xe>=60&&(J.current&&J.current.state==="recording"&&J.current.stop(),Re&&(clearInterval(Re),R(null)),q(!1),P(!1),alert("錄音時間已達1分鐘限制，已自動停止錄音")),xe})},1e3);R(Re),console.log("開始錄音...")}catch(ue){console.error("錄音失敗:",ue),alert("無法訪問麥克風，請檢查權限設置")}},_e=()=>{oe(!1)},Fe=async()=>{if(j){const ue=`[語音留言 - ${Math.floor(X/60)}:${(X%60).toString().padStart(2,"0")}]`;console.log("發送語音留言:",{voiceText:ue}),h(!0);const le=e.currentUser;if(!le){alert("請先登入"),h(!1);return}const Re=await me(le.uid),rt={id:Date.now().toString(),text:ue,aiReply:"",toneId:"",createdAt:new Date().toISOString(),audioUrl:j,duration:X,user:{id:le.uid,name:Re.name,avatar:Re.avatar,country:Re.country,region:Re.country,email:Re.email},comments:[]};console.log("創建的語音留言對象:",rt);const xe=[rt,...r];o(xe),localStorage.setItem("messages",JSON.stringify(xe)),console.log("語音留言已保存到localStorage"),await Se("aiChat",1),V(""),$(0),z(!1),h(!1)}},Be=()=>{z(!1),V(""),$(0)},K=ue=>{if(ue.audioUrl){const le=new Audio(ue.audioUrl);le.onerror=Re=>{console.error("音頻加載失敗:",Re),re(ue.text)},le.play().then(()=>{console.log("正在播放原音...")}).catch(Re=>{console.error("播放失敗:",Re),re(ue.text)})}else re(ue.text)},re=ue=>{if("speechSynthesis"in window){const le=new SpeechSynthesisUtterance(ue);le.lang="zh-TW",le.rate=.9,le.pitch=1,window.speechSynthesis.cancel(),window.speechSynthesis.speak(le),console.log("正在播放留言內容（文字轉語音）...")}else alert("瀏覽器不支援語音播放功能")},H=async()=>{if(!a.trim()){console.log("沒有輸入內容，無法發送");return}console.log("發送消息:",{input:a}),h(!0);const ue=e.currentUser;if(!ue){alert("請先登入"),h(!1);return}const le=await me(ue.uid),Re={id:Date.now().toString(),text:a,aiReply:"",toneId:"",createdAt:new Date().toISOString(),user:{id:ue.uid,name:le.name,avatar:le.avatar,country:le.country,region:le.country,email:le.email},comments:[]};console.log("創建的消息對象:",Re);const rt=[Re,...r];o(rt),localStorage.setItem("messages",JSON.stringify(rt)),console.log("消息已保存到localStorage"),c(""),h(!1)},Ue=()=>{Oe(!1),Ye(null)};return i.jsxs("div",{className:"modern-bg",style:{background:(window.innerWidth<=768,"#8a8a8a"),backgroundImage:"url(/soil.png)",backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat",minHeight:"100vh",display:"flex",flexDirection:"column"},children:[i.jsxs("div",{style:{position:"absolute",top:0,left:0,width:"100%",zIndex:100,display:"flex",justifyContent:"space-between",alignItems:"center",padding:window.innerWidth<=768?"12px 16px 0 16px":"18px 32px 0 32px",boxSizing:"border-box",background:"transparent"},children:[i.jsx("button",{onClick:()=>n("/"),style:{background:"#fff",border:"2px solid #6B5BFF",borderRadius:8,color:"#6B5BFF",fontWeight:700,fontSize:window.innerWidth<=768?14:16,cursor:"pointer",padding:window.innerWidth<=768?"4px 12px":"6px 18px",transition:"background 0.2s, color 0.2s, box-shadow 0.2s"},children:ie.back}),i.jsxs("div",{style:{display:"flex",gap:window.innerWidth<=768?8:12,marginRight:window.innerWidth<=768?4:8},children:[i.jsx("button",{className:"topbar-btn",onClick:async()=>{await St().signOut(),localStorage.clear(),window.location.href="/"},onMouseOver:ue=>{ue.currentTarget.style.background="#6B5BFF",ue.currentTarget.style.color="#fff"},onMouseOut:ue=>{ue.currentTarget.style.background="",ue.currentTarget.style.color=""},style:{fontSize:window.innerWidth<=768?12:16,padding:window.innerWidth<=768?"4px 8px":"6px 12px"},children:ie.logout}),i.jsx("select",{className:"topbar-select",value:D,onChange:ue=>{const le=ue.target.value;G(le),localStorage.setItem("lang",le)},style:{padding:window.innerWidth<=768?"4px 6px":"6px 8px",borderRadius:8,fontWeight:600,cursor:"pointer",minWidth:window.innerWidth<=768?"40px":"50px",width:window.innerWidth<=768?"40px":"50px",fontSize:window.innerWidth<=768?12:14},onMouseOver:ue=>{ue.currentTarget.style.background="#6B5BFF",ue.currentTarget.style.color="#fff"},onMouseOut:ue=>{ue.currentTarget.style.background="",ue.currentTarget.style.color=""},children:_D.map(ue=>i.jsx("option",{value:ue.code,children:ue.label},ue.code))})]})]}),i.jsxs("div",{className:"modern-container",style:{maxWidth:window.innerWidth<=768?"100%":600,width:"100%",margin:"0 auto",flex:1,display:"flex",flexDirection:"column",justifyContent:"center",padding:window.innerWidth<=768?"140px 16px 20px 16px":"0",boxSizing:"border-box",minHeight:window.innerWidth<=768?"100vh":"auto",position:"relative",zIndex:1,overflow:"hidden",background:(window.innerWidth<=768,"#8a8a8a"),transform:"translate3d(0, 0, 0)",backfaceVisibility:"hidden",perspective:"1000px",willChange:"auto"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:(window.innerWidth<=768,12),flexDirection:(window.innerWidth<=768,"column"),gap:(window.innerWidth<=768,8),width:"100%",minHeight:(window.innerWidth<=768,"auto"),background:(window.innerWidth<=768,"#8a8a8a")},children:[i.jsx("h2",{className:"modern-title",style:{fontSize:(window.innerWidth<=768,"1.2rem"),margin:0,flex:1,textAlign:"center",color:"#6B5BFF",textShadow:"0 2px 12px #6B5BFF88, 0 4px 24px #0008",letterSpacing:1,display:"flex",alignItems:"center",gap:(window.innerWidth<=768,2),whiteSpace:"nowrap",flexWrap:"wrap",justifyContent:"center",background:(window.innerWidth<=768,"#8a8a8a")},children:ie.title}),i.jsx("button",{onClick:()=>{console.log("【我的留言】按鈕被點擊，當前狀態:",C),_(!C),console.log("設置新狀態:",!C)},style:{background:C?"linear-gradient(135deg, #23c6e6 60%, #6B5BFF 100%)":"linear-gradient(135deg, #6B5BFF 60%, #23c6e6 100%)",color:"#fff",border:"none",borderRadius:12,fontWeight:900,fontSize:(window.innerWidth<=768,10),padding:(window.innerWidth<=768,"8px 12px"),marginLeft:(window.innerWidth<=768,0),boxShadow:"0 2px 12px #6B5BFF33",letterSpacing:1,display:"flex",alignItems:"center",justifyContent:"center",gap:"2px",whiteSpace:"nowrap",width:(window.innerWidth<=768,"120px"),minHeight:"32px",cursor:"pointer",zIndex:9999,position:"relative",pointerEvents:"auto",userSelect:"none",WebkitUserSelect:"none",MozUserSelect:"none",msUserSelect:"none",touchAction:"manipulation"},children:C?D==="zh-TW"||D==="zh-CN"?"← 返回":D==="en"?"← Back":D==="ja"?"← 戻る":D==="ko"?"← 돌아가기":D==="vi"?"← Quay lại":D==="th"?"← กลับ":D==="la"?"← Atgriezties":D==="ms"?"← Kembali":"← 返回":D==="zh-TW"||D==="zh-CN"?"💌 我的留言":D==="en"?"💌 My Messages":D==="ja"?"💌 私のメッセージ":D==="ko"?"💌 내 메시지":D==="vi"?"💌 Tin nhắn của tôi":D==="th"?"💌 ข้อความของฉัน":D==="la"?"💌 Mani ziņojumi":D==="ms"?"💌 Mesej saya":"💌 我的留言"})]}),i.jsxs("div",{style:{background:"linear-gradient(135deg, rgba(107, 91, 255, 0.1) 0%, rgba(35, 198, 230, 0.1) 100%)",borderRadius:"20px",padding:window.innerWidth<=768?"16px":"24px",marginBottom:"18px",border:"2px solid rgba(107, 91, 255, 0.2)",boxShadow:"0 8px 32px rgba(107, 91, 255, 0.15)",backdropFilter:"blur(10px)",textAlign:"center",marginTop:window.innerWidth<=768?"20px":"0"},children:[i.jsx("h3",{style:{color:"#fff",fontSize:window.innerWidth<=768?"1.2rem":"1.5rem",fontWeight:"700",margin:"0 0 12px 0",textShadow:"0 2px 8px rgba(107, 91, 255, 0.3)"},children:ie.subtitle}),i.jsx("p",{style:{color:"#fff",fontSize:window.innerWidth<=768?"0.9rem":"1rem",lineHeight:"1.6",margin:"0",opacity:"0.9"},children:ie.subtitleDesc})]}),i.jsx("div",{className:"tone-list",style:{marginBottom:18}}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:12,marginBottom:18,padding:(window.innerWidth<=768,"0 8px"),width:"100%",maxWidth:"600px",margin:"0 auto"},children:[i.jsx("input",{className:"quote-card",style:{width:window.innerWidth<=768?"100%":"calc(100% - 32px)",fontSize:window.innerWidth<=768?16:18,padding:window.innerWidth<=768?"10px 14px":"12px 16px",border:"2px solid rgba(107, 91, 255, 0.5)",outline:"none",background:"#232946",color:"#fff",borderRadius:"12px",marginBottom:"8px",boxSizing:"border-box",margin:window.innerWidth<=768?void 0:"0 auto 8px auto"},maxLength:200,placeholder:ie.placeholder,value:a,onChange:ue=>c(ue.target.value),onKeyDown:ue=>ue.key==="Enter"&&H(),disabled:d}),i.jsxs("div",{style:{display:"flex",gap:8,justifyContent:"space-between",width:window.innerWidth<=768?"100%":"calc(100% - 32px)",padding:window.innerWidth<=768?"0 8px":"0 8px 0 16px",margin:window.innerWidth<=768?void 0:"0 auto"},children:[i.jsx("button",{className:"tone-card selected",style:{fontSize:window.innerWidth<=768?14:16,padding:window.innerWidth<=768?"8px 12px":"10px 16px",minWidth:window.innerWidth<=768?"60px":"70px",whiteSpace:"nowrap",flexShrink:0,borderRadius:"8px",background:"linear-gradient(135deg, #6B5BFF 0%, #23c6e6 100%)",color:"#fff",border:"none",cursor:"pointer"},onClick:()=>{console.log("發送按鈕被點擊"),console.log("當前狀態:",{input:a,loading:d}),H()},disabled:d,children:d?ie.sending:ie.send}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"},children:[i.jsxs("button",{onClick:fe,style:{background:F?"linear-gradient(135deg, #f44336 0%, #d32f2f 100%)":"linear-gradient(135deg, #2196F3 0%, #1976D2 100%)",border:"none",borderRadius:"12px",padding:window.innerWidth<=768?"10px 16px":"10px 10px",color:"white",cursor:"pointer",fontSize:"16px",fontWeight:"600",boxShadow:F?"0 4px 16px rgba(244, 67, 54, 0.3)":"0 4px 16px rgba(33, 150, 243, 0.3)",transition:"all 0.3s ease",display:"flex",alignItems:"center",gap:"8px",animation:F?"pulse 1.5s infinite":"none",minWidth:window.innerWidth<=768?"70px":"56px",whiteSpace:"nowrap",flexShrink:0,marginRight:window.innerWidth<=768?void 0:8},onMouseOver:ue=>{F||(ue.currentTarget.style.transform="translateY(-2px)",ue.currentTarget.style.boxShadow="0 6px 20px rgba(33, 150, 243, 0.4)")},onMouseOut:ue=>{F||(ue.currentTarget.style.transform="translateY(0)",ue.currentTarget.style.boxShadow="0 4px 16px rgba(33, 150, 243, 0.3)")},children:[i.jsx("span",{style:{fontSize:"18px"},children:"🎤"}),F?`${ie.recording} ${Math.floor(te/60)}:${(te%60).toString().padStart(2,"0")}`:ie.voice]}),F&&i.jsx("div",{style:{fontSize:"12px",color:"#f44336",marginTop:"4px",fontWeight:"500"},children:ie.pressToStop})]})]}),i.jsx("div",{className:"quote-list",children:C?i.jsxs("div",{children:[i.jsxs("h3",{style:{color:"#6B5BFF",fontSize:"1.5rem",marginBottom:"20px",textAlign:"center",fontWeight:"700"},children:["💌 ",D==="zh-TW"||D==="zh-CN"?"我的留言":D==="en"?"My Messages":D==="ja"?"私のメッセージ":D==="ko"?"내 메시지":D==="vi"?"Tin nhắn của tôi":D==="th"?"ข้อความของฉัน":D==="la"?"Mani ziņojumi":D==="ms"?"Mesej saya":"我的留言"]}),i.jsxs("div",{style:{marginBottom:"24px"},children:[i.jsx("h3",{style:{color:"#6B5BFF",fontSize:"1.2rem",marginBottom:"12px",textAlign:"center"},children:"📝 我發表的留言"}),Je().length===0?i.jsx("div",{style:{color:"#000",textAlign:"center",padding:"20px"},children:"您還沒有發表過留言"}):Je().map(ue=>i.jsxs("div",{className:"quote-card",style:{position:"relative",paddingLeft:64,marginBottom:"12px"},children:[i.jsx("img",{src:ue.user.avatar,alt:"avatar",style:{width:48,height:48,borderRadius:"50%",objectFit:"cover",position:"absolute",left:8,top:16,cursor:"pointer",border:"2px solid #6B5BFF"},onClick:()=>g(ue)}),i.jsx("div",{className:"quote-text",children:ue.text}),i.jsx("div",{style:{fontSize:12,color:"#fff",marginTop:6},children:new Date(ue.createdAt).toLocaleString()}),i.jsx("div",{style:{marginTop:12,display:"flex",justifyContent:"center"},children:i.jsx("button",{onClick:()=>g(ue),style:{background:"linear-gradient(135deg, #6B5BFF 60%, #23c6e6 100%)",color:"#fff",border:"none",borderRadius:"20px",padding:"8px 20px",fontSize:"14px",fontWeight:"600",cursor:"pointer",boxShadow:"0 2px 8px rgba(107, 91, 255, 0.3)"},children:ie.supportMessage})}),i.jsxs("div",{style:{marginTop:14,background:"#f7f7ff",borderRadius:10,padding:"10px 14px",boxShadow:"0 1px 6px #6B5BFF11"},children:[i.jsx("b",{style:{color:"#6B5BFF",fontSize:16},children:ie.commentsTitle}),(ue.comments||[]).length===0&&i.jsx("span",{style:{color:"#bbb",marginLeft:8},children:ie.noComments}),i.jsx("div",{style:{display:"flex",flexDirection:"column",gap:6,marginTop:6},children:(ue.comments||[]).sort((le,Re)=>{const rt=le.createdAt?new Date(le.createdAt).getTime():new Date(ue.createdAt).getTime();return(Re.createdAt?new Date(Re.createdAt).getTime():new Date(ue.createdAt).getTime())-rt}).map((le,Re)=>i.jsxs("div",{style:{background:"#fff",borderRadius:8,padding:"8px 12px",color:"#232946",fontSize:15,border:"1px solid #eee",boxShadow:"0 1px 4px #6B5BFF08",position:"relative",paddingLeft:"60px"},children:[i.jsx("img",{src:le.commenterAvatar||"https://via.placeholder.com/40x40/6B7280/FFFFFF?text=?",alt:"commenter avatar",style:{width:40,height:40,borderRadius:"50%",objectFit:"cover",position:"absolute",left:8,top:8,border:"2px solid #6B5BFF"}}),i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"4px"},children:[i.jsx("b",{style:{color:"#6B5BFF"},children:le.nickname}),(Ve(ue)||Xe(le))&&i.jsxs("div",{style:{fontSize:"12px",color:"#666"},children:[i.jsxs("div",{children:["📧 ",le.commenterEmail]}),i.jsxs("div",{children:["🌍 ",le.commenterCountry]}),i.jsxs("div",{children:["👤 ",le.commenterGender,"・",le.commenterAge,"歲"]})]}),!Ve(ue)&&!Xe(le)&&i.jsx("div",{style:{fontSize:"12px",color:"#666"},children:i.jsxs("div",{children:["🌍 ",le.commenterCountry]})})]}),i.jsx("div",{children:le.content}),i.jsx("div",{style:{fontSize:10,color:"#999",marginTop:4},children:le.createdAt?new Date(le.createdAt).toLocaleString():new Date(ue.createdAt).toLocaleString()}),Ve(ue)&&!Xe(le)&&i.jsx("button",{onClick:()=>alert(`聯繫 ${le.nickname}：
郵箱：${le.commenterEmail}
國家：${le.commenterCountry}
性別：${le.commenterGender}
年齡：${le.commenterAge}`),style:{position:"absolute",top:"8px",right:"8px",background:"linear-gradient(135deg, #6B5BFF 60%, #23c6e6 100%)",color:"#fff",border:"none",borderRadius:"12px",padding:"4px 8px",fontSize:"10px",cursor:"pointer",fontWeight:"600"},children:"📞 聯繫"})]},Re))})]})]},ue.id))]})]}):i.jsxs(i.Fragment,{children:[i.jsxs("h3",{style:{color:"#6B5BFF",fontSize:"1.5rem",marginBottom:"20px",textAlign:"center",fontWeight:"700"},children:["🌍 ",D==="zh-TW"||D==="zh-CN"?"全部留言":D==="en"?"All Messages":D==="ja"?"すべてのメッセージ":D==="ko"?"모든 메시지":D==="vi"?"Tất cả tin nhắn":D==="th"?"ข้อความทั้งหมด":D==="la"?"Visi ziņojumi":D==="ms"?"Semua mesej":"全部留言"]}),r.length===0&&i.jsx("div",{style:{color:"#000",textAlign:"center",marginTop:32},children:ie.noMessages}),i.jsxs("div",{style:{marginTop:"40px",marginBottom:"40px"},children:[i.jsx("h3",{style:{color:"#6B5BFF",fontSize:"1.2rem",marginBottom:"12px",textAlign:"center"},children:"💝 我給別人的支援留言"}),(()=>{const ue=He();return console.log("我的支援留言數量:",ue.length),console.log("我的支援留言:",ue),ue.length===0?i.jsx("div",{style:{color:"#000",textAlign:"center",padding:"20px"},children:"您還沒有給別人留過支援留言"}):ue.map(({message:le,comment:Re},rt)=>i.jsxs("div",{className:"quote-card",style:{position:"relative",paddingLeft:64,marginBottom:"12px"},children:[i.jsx("img",{src:le.user.avatar,alt:"avatar",style:{width:48,height:48,borderRadius:"50%",objectFit:"cover",position:"absolute",left:8,top:16,border:"2px solid #6B5BFF"}}),i.jsxs("div",{style:{fontSize:"12px",color:"#666",marginBottom:"4px"},children:["給 ",i.jsx("b",{style:{color:"#6B5BFF"},children:le.user.name})," 的支援留言："]}),i.jsx("div",{className:"quote-text",style:{background:"#f0f8ff",padding:"8px 12px",borderRadius:"8px",border:"1px solid #e6f3ff"},children:Re.content}),i.jsx("div",{style:{fontSize:12,color:"#614425",marginTop:6},children:Re.createdAt?new Date(Re.createdAt).toLocaleString():new Date(le.createdAt).toLocaleString()})]},rt))})()]}),r.map(ue=>i.jsxs("div",{className:"quote-card",style:{position:"relative",paddingLeft:64},children:[i.jsx("img",{src:ue.user.avatar,alt:"avatar",style:{width:48,height:48,borderRadius:"50%",objectFit:"cover",position:"absolute",left:8,top:16,cursor:"pointer",border:"2px solid #6B5BFF"},onClick:()=>g(ue)}),i.jsx("div",{className:"quote-text",children:ue.text}),ue.audioUrl&&i.jsxs("div",{style:{marginTop:"8px",display:"flex",alignItems:"center",gap:"8px"},children:[i.jsxs("button",{onClick:()=>K(ue),style:{background:"linear-gradient(135deg, #4CAF50 0%, #45a049 100%)",border:"none",borderRadius:"6px",padding:"4px 8px",color:"white",cursor:"pointer",fontSize:"12px",display:"flex",alignItems:"center",gap:"4px"},children:[i.jsx("span",{children:"▶️"}),"播放原音"]}),i.jsxs("span",{style:{fontSize:"12px",color:"#ccc"},children:["錄音時長: ",ue.duration?`${Math.floor(ue.duration/60)}:${(ue.duration%60).toString().padStart(2,"0")}`:"未知"]})]}),i.jsx("div",{style:{fontSize:12,color:"#fff",marginTop:6},children:new Date(ue.createdAt).toLocaleString()}),i.jsx("div",{style:{marginTop:12,display:"flex",justifyContent:"center"},children:i.jsx("button",{onClick:()=>g(ue),style:{background:"linear-gradient(135deg, #6B5BFF 60%, #23c6e6 100%)",color:"#fff",border:"none",borderRadius:"20px",padding:"8px 20px",fontSize:"14px",fontWeight:"600",cursor:"pointer",boxShadow:"0 2px 8px rgba(107, 91, 255, 0.3)"},children:ie.supportMessage})}),i.jsxs("div",{style:{marginTop:14,background:"#f7f7ff",borderRadius:10,padding:"10px 14px",boxShadow:"0 1px 6px #6B5BFF11"},children:[i.jsx("b",{style:{color:"#6B5BFF",fontSize:16},children:ie.commentsTitle}),(ue.comments||[]).length===0&&i.jsx("span",{style:{color:"#bbb",marginLeft:8},children:ie.noComments}),i.jsx("div",{style:{display:"flex",flexDirection:"column",gap:6,marginTop:6},children:(ue.comments||[]).sort((le,Re)=>{const rt=le.createdAt?new Date(le.createdAt).getTime():new Date(ue.createdAt).getTime();return(Re.createdAt?new Date(Re.createdAt).getTime():new Date(ue.createdAt).getTime())-rt}).map((le,Re)=>i.jsxs("div",{style:{background:"#fff",borderRadius:8,padding:"8px 12px",color:"#232946",fontSize:15,border:"1px solid #eee",boxShadow:"0 1px 4px #6B5BFF08",position:"relative",paddingLeft:"60px"},children:[i.jsx("img",{src:le.commenterAvatar||"https://via.placeholder.com/40x40/6B7280/FFFFFF?text=?",alt:"commenter avatar",style:{width:40,height:40,borderRadius:"50%",objectFit:"cover",position:"absolute",left:8,top:8,border:"2px solid #6B5BFF"}}),i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"4px"},children:[i.jsx("b",{style:{color:"#6B5BFF"},children:le.nickname}),(Ve(ue)||Xe(le))&&i.jsxs("div",{style:{fontSize:"12px",color:"#666"},children:[i.jsxs("div",{children:["📧 ",le.commenterEmail]}),i.jsxs("div",{children:["🌍 ",le.commenterCountry]}),i.jsxs("div",{children:["👤 ",le.commenterGender,"・",le.commenterAge,"歲"]})]}),!Ve(ue)&&!Xe(le)&&i.jsx("div",{style:{fontSize:"12px",color:"#666"},children:i.jsxs("div",{children:["🌍 ",le.commenterCountry]})})]}),i.jsx("div",{children:le.content}),i.jsx("div",{style:{fontSize:10,color:"#999",marginTop:4},children:le.createdAt?new Date(le.createdAt).toLocaleString():new Date(ue.createdAt).toLocaleString()}),Ve(ue)&&!Xe(le)&&i.jsx("button",{onClick:()=>alert(`聯繫 ${le.nickname}：
郵箱：${le.commenterEmail}
國家：${le.commenterCountry}
性別：${le.commenterGender}
年齡：${le.commenterAge}`),style:{position:"absolute",top:"8px",right:"8px",background:"linear-gradient(135deg, #6B5BFF 60%, #23c6e6 100%)",color:"#fff",border:"none",borderRadius:"12px",padding:"4px 8px",fontSize:"10px",cursor:"pointer",fontWeight:"600"},children:"📞 聯繫"})]},Re))})]})]},ue.id)),i.jsxs("div",{style:{marginTop:"32px",padding:"20px",background:"linear-gradient(135deg, rgba(107, 91, 255, 0.1) 0%, rgba(35, 198, 230, 0.1) 100%)",borderRadius:"16px",border:"2px solid rgba(107, 91, 255, 0.2)"},children:[i.jsx("h3",{style:{color:"#6B5BFF",fontSize:"1.2rem",marginBottom:"12px",textAlign:"center"},children:"📝 我發表的留言"}),(()=>{const ue=Je();return console.log("我發表的留言數量:",ue.length),console.log("我發表的留言:",ue),ue.length===0?i.jsx("div",{style:{color:"#000",textAlign:"center",padding:"20px"},children:"您還沒有發表過留言"}):ue.map((le,Re)=>i.jsxs("div",{className:"quote-card",style:{position:"relative",paddingLeft:64,marginBottom:"12px"},children:[i.jsx("img",{src:le.user.avatar,alt:"avatar",style:{width:48,height:48,borderRadius:"50%",objectFit:"cover",position:"absolute",left:8,top:16,border:"2px solid #6B5BFF"}}),i.jsx("div",{className:"quote-text",children:le.text}),i.jsx("div",{style:{fontSize:12,color:"#614425",marginTop:6},children:new Date(le.createdAt).toLocaleString()})]},Re))})()]})]})})]})]}),ne&&i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.5)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1e3},children:i.jsxs("div",{style:{background:"white",borderRadius:"16px",padding:"24px",maxWidth:"400px",width:"90%",textAlign:"center",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.3)"},children:[i.jsx("div",{style:{fontSize:"48px",marginBottom:"16px"},children:"🎤"}),i.jsx("h3",{style:{margin:"0 0 16px 0",color:"#333",fontSize:"20px"},children:ie.readyToRecord}),i.jsxs("p",{style:{margin:"0 0 20px 0",color:"#666",lineHeight:"1.5"},children:[ie.recordInstruction,i.jsx("br",{}),i.jsxs("strong",{style:{color:"#ff6b6b"},children:["⚠️ ",ie.recordTimeLimit]})]}),i.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"center"},children:[i.jsx("button",{onClick:_e,style:{background:"#f44336",border:"none",borderRadius:"8px",padding:"12px 24px",color:"white",cursor:"pointer",fontSize:"16px",fontWeight:"600",minWidth:"120px"},children:ie.cancel}),i.jsx("button",{onClick:Te,style:{background:"linear-gradient(135deg, #2196F3 0%, #1976D2 100%)",border:"none",borderRadius:"8px",padding:"12px 24px",color:"white",cursor:"pointer",fontSize:"16px",fontWeight:"600",minWidth:"120px"},children:ie.startRecording})]})]})}),O&&i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.5)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1e3},children:i.jsxs("div",{style:{background:"white",borderRadius:"16px",padding:"24px",maxWidth:"400px",width:"90%",textAlign:"center",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.3)"},children:[i.jsx("h3",{style:{margin:"0 0 16px 0",color:"#333"},children:"語音錄製完成"}),i.jsxs("p",{style:{margin:"0 0 20px 0",color:"#666"},children:["錄音時長: ",Math.floor(X/60),":",(X%60).toString().padStart(2,"0")]}),i.jsxs("button",{onClick:()=>{j&&new Audio(j).play()},style:{background:"linear-gradient(135deg, #4CAF50 0%, #45a049 100%)",border:"none",borderRadius:"8px",padding:"8px 16px",color:"white",cursor:"pointer",fontSize:"14px",marginBottom:"16px",display:"flex",alignItems:"center",gap:"6px",margin:"0 auto 16px auto"},children:[i.jsx("span",{children:"▶️"}),"播放錄音"]}),i.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"center"},children:[i.jsx("button",{onClick:Fe,style:{background:"linear-gradient(135deg, #2196F3 0%, #1976D2 100%)",border:"none",borderRadius:"8px",padding:"10px 20px",color:"white",cursor:"pointer",fontSize:"14px",fontWeight:"600"},children:"發送語音"}),i.jsx("button",{onClick:Be,style:{background:"#f44336",border:"none",borderRadius:"8px",padding:"10px 20px",color:"white",cursor:"pointer",fontSize:"14px",fontWeight:"600"},children:"取消"})]})]})}),we&&Ne&&i.jsx(Ms,{isOpen:we,onClose:Ue,currentPlan:Ne.currentPlan,remainingDays:Ne.remainingDays,usedTokens:Ne.usedTokens,totalTokens:Ne.totalTokens}),i.jsx("div",{style:{width:"100%",margin:"0 auto",marginTop:24,background:"rgba(255,255,255,0.95)",borderRadius:16,padding:"16px",boxShadow:"0 2px 12px #6B5BFF22"},children:i.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:20,flexWrap:"wrap"},children:[i.jsx("a",{href:"/privacy-policy",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12},children:D==="zh-TW"?"隱私權政策":D==="zh-CN"?"隐私政策":D==="en"?"Privacy Policy":D==="ja"?"プライバシーポリシー":D==="ko"?"개인정보 처리방침":D==="th"?"นโยบายความเป็นส่วนตัว":D==="vi"?"Chính sách bảo mật":D==="ms"?"Dasar Privasi":"Consilium de Privata"}),i.jsx("a",{href:"/terms",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12},children:D==="zh-TW"?"條款/聲明":D==="zh-CN"?"条款/声明":D==="en"?"Terms/Statement":D==="ja"?"規約/声明":D==="ko"?"약관/성명":D==="th"?"ข้อกำหนด/แถลงการณ์":D==="vi"?"Điều khoản/Tuyên bố":D==="ms"?"Terma/Pernyataan":"Termini/Declaratio"}),i.jsx("a",{href:"/data-deletion",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12},children:D==="zh-TW"?"資料刪除說明":D==="zh-CN"?"数据删除说明":D==="en"?"Data Deletion":D==="ja"?"データ削除について":D==="ko"?"데이터 삭제 안내":D==="th"?"คำอธิบายการลบข้อมูล":D==="vi"?"Giải thích xóa dữ liệu":D==="ms"?"Penjelasan Penghapusan Data":"Explicatio Deletionis Datae"}),i.jsx("a",{href:"/about",style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12},children:D==="zh-TW"?"🧬 Restarter™｜我們是誰":D==="zh-CN"?"🧬 Restarter™｜我们是谁":D==="en"?"🧬 Restarter™｜Who We Are":D==="ja"?"🧬 Restarter™｜私たちについて":D==="ko"?"🧬 Restarter™｜우리는 누구인가":D==="th"?"🧬 Restarter™｜เราเป็นใคร":D==="vi"?"🧬 Restarter™｜Chúng tôi là ai":D==="ms"?"🧬 Restarter™｜Siapa Kami":"🧬 Restarter™｜Quis sumus"}),i.jsx("a",{href:"/feedback",style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12},children:D==="zh-TW"?"💬 意見箱｜我們想聽你說":D==="zh-CN"?"💬 意见箱｜我们想听你说":D==="en"?"💬 Feedback Box｜We Want to Hear From You":D==="ja"?"💬 ご意見箱｜私たちはあなたの声を聞きたい":D==="ko"?"💬 피드백｜우리는 당신의 말을 듣고 싶습니다":D==="th"?"💬 กล่องความคิดเห็น｜เราอยากได้ยินจากคุณ":D==="vi"?"💬 Hộp góp ý｜Chúng tôi muốn nghe từ bạn":D==="ms"?"💬 Kotak Maklum Balas｜Kami Ingin Mendengar Dari Anda":"💬 Arca Consilii｜Volumus Audire a Te"})]})})]})}const wS={"zh-TW":{title:"心聲釋放 Voice Release",subtitle:"無需放在心裡...對哪些人事物不滿你可盡情說出，天下沒有不能解決的難題",holdToRecord:"按住錄音",webSimulation:"(網頁版使用模擬錄音)",recording:"錄音中...",stopRecording:"停止錄音",todayMood:"今天的心情",reflectionMoment:"反思時刻",addDiary:"添加心聲",editDiary:"編輯心聲",deleteDiary:"刪除心聲",save:"保存",cancel:"取消",backToHome:"← 返回首頁",logout:"登出",noDiaries:"還沒有心聲日記，開始錄音吧！",startSpeaking:"開始說話",submit:"送出",submitVoice:"送出心聲",recordingComplete:"錄音完成",submitToSave:"點擊送出保存心聲",emotion:{happy:"開心",sad:"難過",angry:"生氣",neutral:"平靜",excited:"興奮",calm:"放鬆"}},"zh-CN":{title:"心声释放 Voice Release",subtitle:"无需放在心里...对哪些人事物不满你可尽情说出，天下没有不能解决的难题",holdToRecord:"按住录音",webSimulation:"(网页版使用模拟录音)",recording:"录音中...",stopRecording:"停止录音",todayMood:"今天的心情",reflectionMoment:"反思时刻",addDiary:"添加心声",editDiary:"编辑心声",deleteDiary:"删除心声",save:"保存",cancel:"取消",backToHome:"← 返回首页",logout:"登出",noDiaries:"还没有心声日记，开始录音吧！",startSpeaking:"开始说话",submit:"送出",submitVoice:"送出心声",recordingComplete:"录音完成",submitToSave:"点击送出保存心声",emotion:{happy:"开心",sad:"难过",angry:"生气",neutral:"平静",excited:"兴奋",calm:"放松"}},ja:{title:"心の声を解放 Voice Release",subtitle:"心に留めておく必要はない...どの人や物事への不満も自由に言い、解決できない問題はない",holdToRecord:"録音を押し続ける",webSimulation:"(Web版は模擬録音を使用)",recording:"録音中...",stopRecording:"録音停止",todayMood:"今日の気分",reflectionMoment:"反省の瞬間",addDiary:"心の声を追加",editDiary:"心の声を編集",deleteDiary:"心の声を削除",save:"保存",cancel:"キャンセル",backToHome:"← ホームに戻る",logout:"ログアウト",noDiaries:"まだ心の声の日記がありません。録音を始めましょう！",startSpeaking:"話し始める",submit:"送信",submitVoice:"心の声を送信",recordingComplete:"録音完了",submitToSave:"送信して心の声を保存",emotion:{happy:"嬉しい",sad:"悲しい",angry:"怒り",neutral:"平静",excited:"興奮",calm:"リラックス"}},ko:{title:"마음의 소리 해방 Voice Release",subtitle:"마음속에 담아둘 필요 없이...어떤 사람이나 사물에 대한 불만을 자유롭게 말하고, 해결할 수 없는 문제는 없다",holdToRecord:"녹음하려면 길게 누르세요",webSimulation:"(웹 버전은 시뮬레이션 녹음 사용)",recording:"녹음 중...",stopRecording:"녹음 중지",todayMood:"오늘의 기분",reflectionMoment:"성찰의 순간",addDiary:"마음의 소리 추가",editDiary:"마음의 소리 편집",deleteDiary:"마음의 소리 삭제",save:"저장",cancel:"취소",backToHome:"← 홈으로 돌아가기",logout:"로그아웃",noDiaries:"아직 마음의 소리 일기가 없습니다. 녹음을 시작해보세요!",startSpeaking:"말하기 시작",submit:"제출",submitVoice:"마음의 소리 제출",recordingComplete:"녹음 완료",submitToSave:"제출하여 마음의 소리 저장",emotion:{happy:"행복",sad:"슬픔",angry:"분노",neutral:"평온",excited:"흥분",calm:"차분"}},th:{title:"ปลดปล่อยเสียงในใจ Voice Release",subtitle:"ไม่จำเป็นต้องเก็บไว้ในใจ...คุณสามารถพูดความไม่พอใจต่อคนหรือสิ่งต่างๆ ได้อย่างอิสระ ไม่มีปัญหาที่แก้ไขไม่ได้",holdToRecord:"กดค้างเพื่อบันทึก",webSimulation:"(เวอร์ชันเว็บใช้การบันทึกจำลอง)",recording:"กำลังบันทึก...",stopRecording:"หยุดบันทึก",todayMood:"อารมณ์วันนี้",reflectionMoment:"ช่วงเวลาสะท้อนคิด",addDiary:"เพิ่มเสียงในใจ",editDiary:"แก้ไขเสียงในใจ",deleteDiary:"ลบเสียงในใจ",save:"บันทึก",cancel:"ยกเลิก",backToHome:"← กลับหน้าหลัก",logout:"ออกจากระบบ",noDiaries:"ยังไม่มีไดอารี่เสียงในใจ เริ่มบันทึกกันเลย!",startSpeaking:"เริ่มพูด",submit:"ส่ง",submitVoice:"ส่งเสียงในใจ",recordingComplete:"บันทึกเสร็จสิ้น",submitToSave:"คลิกส่งเพื่อบันทึกเสียงในใจ",emotion:{happy:"มีความสุข",sad:"เศร้า",angry:"โกรธ",neutral:"สงบ",excited:"ตื่นเต้น",calm:"ผ่อนคลาย"}},vi:{title:"Giải Phóng Tiếng Lòng Voice Release",subtitle:"Không cần giữ trong lòng...bạn có thể tự do nói ra sự bất mãn với những người hoặc sự việc nào đó, không có vấn đề nào không thể giải quyết",holdToRecord:"Giữ để ghi âm",webSimulation:"(Phiên bản web sử dụng ghi âm mô phỏng)",recording:"Đang ghi âm...",stopRecording:"Dừng ghi âm",todayMood:"Tâm trạng hôm nay",reflectionMoment:"Khoảnh khắc suy ngẫm",addDiary:"Thêm tiếng lòng",editDiary:"Chỉnh sửa tiếng lòng",deleteDiary:"Xóa tiếng lòng",save:"Lưu",cancel:"Hủy",backToHome:"← Về trang chủ",logout:"Đăng xuất",noDiaries:"Chưa có nhật ký tiếng lòng, hãy bắt đầu ghi âm!",startSpeaking:"Bắt đầu nói",submit:"Gửi",submitVoice:"Gửi tiếng lòng",recordingComplete:"Ghi âm hoàn thành",submitToSave:"Nhấp để gửi và lưu tiếng lòng",emotion:{happy:"Vui vẻ",sad:"Buồn",angry:"Tức giận",neutral:"Bình tĩnh",excited:"Hưng phấn",calm:"Thư giãn"}},ms:{title:"Pelepasan Suara Hati Voice Release",subtitle:"Tidak perlu disimpan dalam hati...anda boleh bebas mengucapkan ketidakpuasan terhadap orang atau perkara tertentu, tiada masalah yang tidak dapat diselesaikan",holdToRecord:"Tahan untuk Rakam",webSimulation:"(Versi web menggunakan rakaman simulasi)",recording:"Merakam...",stopRecording:"Hentikan Rakaman",todayMood:"Mood Hari Ini",reflectionMoment:"Saat Refleksi",addDiary:"Tambah Suara Hati",editDiary:"Sunting Suara Hati",deleteDiary:"Padam Suara Hati",save:"Simpan",cancel:"Batal",backToHome:"← Kembali ke Rumah",logout:"Log Keluar",noDiaries:"Belum ada diari suara hati, mulakan rakaman!",startSpeaking:"Mula Bercakap",submit:"Hantar",submitVoice:"Hantar Suara Hati",recordingComplete:"Rakaman Selesai",submitToSave:"Klik untuk hantar dan simpan suara hati",emotion:{happy:"Gembira",sad:"Sedih",angry:"Marah",neutral:"Tenang",excited:"Teruja",calm:"Selesa"}},la:{title:"Vox Liberatio Voice Release",subtitle:"Non necesse est in corde servare...liberam dissatisfactionem cum hominibus vel rebus quibusdam profer, nulla quaestio insolubilis est",holdToRecord:"Tene ad Recordandum",webSimulation:"(Versio interretialis simulatione utitur)",recording:"Recordans...",stopRecording:"Recordationem Cessa",todayMood:"Affectus Hodiernus",reflectionMoment:"Momentum Cogitationis",addDiary:"Vox Adde",editDiary:"Vox Edita",deleteDiary:"Vox Dele",save:"Serva",cancel:"Cancella",backToHome:"← Ad Domum Reverte",logout:"Exi",noDiaries:"Nondum diaria vocis cordis, incipiamus recordare!",startSpeaking:"Incipe Loqui",submit:"Submitte",submitVoice:"Vox Submitte",recordingComplete:"Recordatio Perfecta",submitToSave:"Click ut submitte et serva vocem",emotion:{happy:"Laetus",sad:"Tristis",angry:"Iratus",neutral:"Tranquillus",excited:"Excitatus",calm:"Placidus"}},en:{title:"Voice Release",subtitle:"No need to keep it in your heart...you can freely speak out your dissatisfaction with which people or things, there is no problem that cannot be solved",holdToRecord:"Hold to Record",webSimulation:"(Web version uses simulated recording)",recording:"Recording...",stopRecording:"Stop Recording",todayMood:"Today's Mood",reflectionMoment:"Reflection Moment",addDiary:"Add Voice",editDiary:"Edit Voice",deleteDiary:"Delete Voice",save:"Save",cancel:"Cancel",backToHome:"← Back to Home",logout:"Logout",noDiaries:"No heart voice diaries yet, start recording!",startSpeaking:"Start Speaking",submit:"Submit",submitVoice:"Submit Voice",recordingComplete:"Recording Complete",submitToSave:"Click to submit and save voice",emotion:{happy:"Happy",sad:"Sad",angry:"Angry",neutral:"Neutral",excited:"Excited",calm:"Calm"}}};function ID(){const n=_t(),{lang:e,setLang:t}=Mt(),r=wS[e]||wS["zh-TW"],[o,a]=v.useState(!1),[c,d]=v.useState(null),[h,m]=v.useState([]),g=v.useRef([]),[x,S]=v.useState(()=>{const xe=localStorage.getItem("voiceDiaries");return xe?JSON.parse(xe):[{id:1,title:"今天的心情",content:"今天感覺很棒，完成了所有計劃的任務。",date:new Date().toISOString(),emotion:"happy",expanded:!1},{id:2,title:"反思時刻",content:"需要學會更好地管理時間，提高效率。",date:new Date(Date.now()-24*60*60*1e3).toISOString(),emotion:"neutral",expanded:!1}]}),[C,_]=v.useState(!1),[I,T]=v.useState(!1),[F,P]=v.useState(null),[B,q]=v.useState({title:"",content:"",emotion:"neutral"}),[te,W]=v.useState(0),[L,R]=v.useState(null),[A,N]=v.useState(null),[O,z]=v.useState(!1),[j,V]=v.useState(!1),{checkPermission:X,recordUsage:$}=Ls(),[ne,oe]=v.useState(!1),[J,Q]=v.useState(null),[D,G]=v.useState(null),[ie,ee]=v.useState(null),{isTestMode:Se}=$i(),[we,Oe]=v.useState(!1),[Ne,Ye]=v.useState(null),it=async()=>{if(o){c&&c.state==="recording"&&c.stop(),L&&(clearInterval(L),R(null)),a(!1),_(!1),W(0);return}const xe=await X("aiChat");if(!xe.allowed){if(Se){V(!0);return}xe.canRenew,Q(xe),oe(!0);return}V(!0)},me=async()=>{V(!1);try{const xe=await navigator.mediaDevices.getUserMedia({audio:!0}),Ae=new MediaRecorder(xe,{mimeType:"audio/webm;codecs=opus"});m([]),g.current=[],W(0),Ae.ondataavailable=ft=>{console.log("收到音頻數據，大小:",ft.data.size),ft.data.size>0&&(g.current.push(ft.data),m(ke=>{const at=[...ke,ft.data];return console.log("更新音頻塊，當前數量:",at.length),at}))},Ae.onstop=()=>{const ft=[...g.current];console.log("錄音停止，音頻塊數量:",ft.length);const ke=ft.length>0?new Blob(ft,{type:"audio/webm"}):new Blob([""],{type:"audio/webm"}),at=Math.max(1,Math.floor(ft.length*.1));console.log("創建音頻blob，大小:",ke.size,"估算錄音時長:",at),N({blob:ke,duration:at}),z(!0),m([]),g.current=[],console.log("設置送出對話框狀態"),xe.getTracks().forEach(pe=>pe.stop())},Ae.start(100),d(Ae),a(!0),_(!0);const Ge=setInterval(()=>{W(ft=>{const ke=ft+1;return ke>=60&&(c&&c.state==="recording"&&c.stop(),Ge&&(clearInterval(Ge),R(null)),a(!1),_(!1),alert("錄音時間已達1分鐘限制，已自動停止錄音")),ke})},1e3);R(Ge)}catch(xe){console.error("錄音錯誤:",xe),alert("無法啟動麥克風，請檢查權限設置")}},Ve=()=>{V(!1)},Xe=(xe,Ae)=>{const Ge=URL.createObjectURL(xe),ft=["今天心情很好，完成了所有工作。","遇到了一些挑戰，但都克服了。","學會了新的技能，感覺很有成就感。","和朋友聊天很開心，分享了很多想法。","反思今天的行為，發現還有改進空間。"],ke=ft[Math.floor(Math.random()*ft.length)],at=["happy","neutral","calm"][Math.floor(Math.random()*3)],de=[{id:Date.now(),title:"心聲日記",content:ke,date:new Date().toISOString(),emotion:at,expanded:!1,audioUrl:Ge,duration:Ae},...x];S(de),He(de),_(!1)},Je=()=>{A&&(Xe(A.blob,A.duration),N(null),z(!1),$("aiChat",1))},He=xe=>{localStorage.setItem("voiceDiaries",JSON.stringify(xe))},fe=()=>{N(null),z(!1)},Te=()=>{if(B.title.trim()&&B.content.trim()){const Ae=[{id:Date.now(),title:B.title,content:B.content,date:new Date().toISOString(),emotion:B.emotion,expanded:!1,duration:0},...x];S(Ae),He(Ae),q({title:"",content:"",emotion:"neutral"}),T(!1)}},_e=xe=>{P(xe),q({title:xe.title,content:xe.content,emotion:xe.emotion})},Fe=()=>{if(F&&B.title.trim()&&B.content.trim()){const xe=x.map(Ae=>Ae.id===F.id?{...Ae,title:B.title,content:B.content,emotion:B.emotion}:Ae);S(xe),He(xe),P(null),q({title:"",content:"",emotion:"neutral"})}},Be=xe=>{Ye(xe),Oe(!0)},K=()=>{if(Ne){const xe=x.filter(Ae=>Ae.id!==Ne);S(xe),He(xe),Oe(!1),Ye(null)}},re=()=>{Oe(!1),Ye(null)},H=xe=>{const Ae=x.map(Ge=>Ge.id===xe?{...Ge,expanded:!Ge.expanded}:{...Ge,expanded:!1});S(Ae),He(Ae)},Ue=xe=>{if(D===xe.id){ie&&(ie.pause(),ie.currentTime=0),window.speechSynthesis.speaking&&window.speechSynthesis.cancel(),G(null),ee(null);return}if(ie&&(ie.pause(),ie.currentTime=0),window.speechSynthesis.speaking&&window.speechSynthesis.cancel(),xe.audioUrl){const Ae=new Audio(xe.audioUrl);Ae.onended=()=>{G(null),ee(null)},Ae.onerror=Ge=>{console.error("音頻加載失敗:",Ge),G(null),ee(null),ue(xe.content)},Ae.play().then(()=>{console.log("正在播放原音..."),G(xe.id),ee(Ae)}).catch(Ge=>{console.error("播放失敗:",Ge),G(null),ee(null),ue(xe.content)})}else G(xe.id),ue(xe.content)},ue=xe=>{if("speechSynthesis"in window){if(window.speechSynthesis.speaking){window.speechSynthesis.cancel(),G(null),ee(null);return}const Ae=new SpeechSynthesisUtterance(xe);Ae.lang="zh-TW",Ae.rate=.9,Ae.pitch=1,Ae.onend=()=>{G(null),ee(null)},Ae.onerror=()=>{G(null),ee(null)},window.speechSynthesis.speak(Ae),console.log("正在播放心聲日記內容（文字轉語音）...")}else alert("瀏覽器不支援語音播放功能"),G(null),ee(null)},le=xe=>({happy:"#4CAF50",sad:"#2196F3",angry:"#F44336",neutral:"#9E9E9E",excited:"#FF9800",calm:"#8BC34A"})[xe]||"#9E9E9E",Re=xe=>new Date(xe).toLocaleString("zh-TW",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"});v.useEffect(()=>()=>{L&&clearInterval(L)},[L]);const rt=()=>{oe(!1),Q(null)};return i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{minHeight:"100vh",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",padding:"20px"},children:[i.jsx("style",{children:`
            @keyframes pulse {
              0% { transform: scale(1); }
              50% { transform: scale(1.05); }
              100% { transform: scale(1); }
            }
            @keyframes bounce {
              0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
              40% { transform: translateY(-3px); }
              60% { transform: translateY(-2px); }
            }
          `}),i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"30px"},children:[i.jsx("button",{onClick:()=>n("/home"),style:{background:"#fff",border:"1.5px solid #6B5BFF",borderRadius:"8px",padding:"6px 10px",color:"#6B5BFF",cursor:"pointer",fontSize:"16px",fontWeight:"600",transition:"background 0.18s, color 0.18s, border 0.18s"},children:"返回"}),i.jsx("h1",{style:{color:"white",fontSize:"24px",fontWeight:"bold",margin:0},children:r.title}),i.jsxs("div",{style:{display:"flex",gap:"10px"},children:[i.jsx(Bn,{}),i.jsx("button",{onClick:()=>n("/logout"),style:{background:"rgba(255,255,255,0.2)",border:"none",borderRadius:"8px",padding:"8px 16px",color:"white",cursor:"pointer",fontSize:"14px"},children:r.logout})]})]}),i.jsxs("div",{style:{maxWidth:"800px",margin:"0 auto"},children:[i.jsxs("div",{style:{background:"rgba(255,255,255,0.95)",borderRadius:"20px",padding:"40px",textAlign:"center",marginBottom:"30px",boxShadow:"0 8px 32px rgba(0,0,0,0.1)"},children:[i.jsxs("div",{style:{marginBottom:"20px"},children:[i.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",marginBottom:"15px"},children:i.jsx("button",{onClick:it,style:{width:"80px",height:"80px",borderRadius:"50%",background:o?"linear-gradient(45deg, #ff5722, #ff9800)":"linear-gradient(45deg, #ff9800, #ff5722)",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:o?"0 0 0 4px #ffe0b2, 0 0 20px rgba(255, 87, 34, 0.5)":"0 4px 16px rgba(255, 152, 0, 0.3)",cursor:"pointer",transition:"all 0.3s ease",border:"none",animation:o?"pulse 1.5s infinite":"none"},onMouseEnter:xe=>{o||(xe.currentTarget.style.transform="scale(1.1)")},onMouseLeave:xe=>{o||(xe.currentTarget.style.transform="scale(1)")},children:i.jsx("span",{style:{fontSize:"32px",color:"white",filter:o?"drop-shadow(0 0 6px #ff9800)":""},children:o?"⏹️":"🎤"})})}),i.jsx("div",{style:{color:o?"#ff5722":"#ff9800",fontSize:"16px",fontWeight:"700",marginBottom:"10px",textAlign:"center"},children:o?r.stopRecording:r.startSpeaking}),o&&i.jsxs("div",{style:{color:"#ff5722",fontSize:"14px",fontWeight:"600",textAlign:"center",marginBottom:"10px"},children:["錄音中... ",Math.floor(te/60),":",(te%60).toString().padStart(2,"0")]})]}),i.jsx("p",{style:{color:"#666",fontSize:"14px",marginBottom:"20px"},children:r.holdToRecord}),i.jsx("p",{style:{color:"#999",fontSize:"12px",fontStyle:"italic"},children:r.webSimulation}),i.jsxs("button",{onClick:()=>T(!0),style:{background:"linear-gradient(45deg, #667eea, #764ba2)",border:"none",borderRadius:"12px",padding:"12px 24px",color:"white",cursor:"pointer",fontSize:"16px",fontWeight:"600",marginTop:"20px"},children:["+ ",r.addDiary]})]}),i.jsxs("div",{style:{marginBottom:"30px"},children:[i.jsxs("h3",{style:{color:"white",fontSize:"20px",marginBottom:"20px",fontWeight:"600"},children:["心聲日記 (",x.length,")"]}),x.length===0?i.jsx("div",{style:{background:"rgba(255,255,255,0.95)",borderRadius:"16px",padding:"40px",textAlign:"center",color:"#666"},children:r.noDiaries}):i.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:x.map(xe=>i.jsx("div",{style:{background:"rgba(255,255,255,0.95)",borderRadius:"16px",padding:"20px",boxShadow:"0 4px 16px rgba(0,0,0,0.1)"},children:i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"12px"},children:[i.jsxs("div",{style:{flex:1},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",marginBottom:"8px"},children:[i.jsx("button",{onClick:()=>H(xe.id),style:{background:"none",border:"none",cursor:"pointer",fontSize:"16px",fontWeight:"600",color:"#333",textAlign:"left",flex:1},children:xe.title}),i.jsx("button",{onClick:()=>Ue(xe),style:{background:D===xe.id?"linear-gradient(45deg, #ff5722, #ff9800)":"linear-gradient(45deg, #4CAF50, #45a049)",border:"none",borderRadius:"50%",width:"36px",height:"36px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",transition:"transform 0.2s"},onMouseEnter:Ae=>{Ae.currentTarget.style.transform="scale(1.1)"},onMouseLeave:Ae=>{Ae.currentTarget.style.transform="scale(1)"},children:i.jsx("span",{style:{fontSize:"16px",color:"white"},children:D===xe.id?"⏹️":"▶️"})}),i.jsx("span",{style:{background:le(xe.emotion),color:"white",padding:"4px 8px",borderRadius:"12px",fontSize:"12px",fontWeight:"600"},children:r.emotion[xe.emotion]})]}),xe.expanded&&i.jsxs("div",{style:{marginTop:"12px",padding:"12px",background:"rgba(0,0,0,0.05)",borderRadius:"8px"},children:[i.jsx("p",{style:{color:"#666",fontSize:"14px",lineHeight:"1.5",marginBottom:"8px"},children:xe.content}),i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:"8px"},children:[i.jsx("p",{style:{color:"#999",fontSize:"12px"},children:Re(xe.date)}),xe.duration&&i.jsxs("span",{style:{color:"#667eea",fontSize:"12px",fontWeight:"500",background:"rgba(102, 126, 234, 0.1)",padding:"2px 6px",borderRadius:"4px"},children:["⏱️ ",Math.floor(xe.duration/60),":",(xe.duration%60).toString().padStart(2,"0")]})]})]})]}),i.jsxs("div",{style:{display:"flex",gap:"8px"},children:[i.jsxs("button",{onClick:()=>_e(xe),style:{background:"#4CAF50",border:"none",borderRadius:"6px",padding:"6px 12px",color:"white",cursor:"pointer",fontSize:"12px"},children:["✏️ ",r.editDiary]}),i.jsxs("button",{onClick:()=>Be(xe.id),style:{background:"#F44336",border:"none",borderRadius:"6px",padding:"6px 12px",color:"white",cursor:"pointer",fontSize:"12px"},children:["🗑️ ",r.deleteDiary]})]})]})},xe.id))})]})]}),I&&i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:i.jsxs("div",{style:{background:"white",borderRadius:"16px",padding:"30px",width:"90%",maxWidth:"500px"},children:[i.jsx("h3",{style:{marginBottom:"20px",color:"#333"},children:r.addDiary}),i.jsxs("div",{style:{marginBottom:"16px"},children:[i.jsx("label",{style:{display:"block",marginBottom:"8px",color:"#666"},children:"標題"}),i.jsx("input",{type:"text",value:B.title,onChange:xe=>q(Ae=>({...Ae,title:xe.target.value})),style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid #ddd",fontSize:"14px"},placeholder:"輸入日記標題"})]}),i.jsxs("div",{style:{marginBottom:"16px"},children:[i.jsx("label",{style:{display:"block",marginBottom:"8px",color:"#666"},children:"內容"}),i.jsx("textarea",{value:B.content,onChange:xe=>q(Ae=>({...Ae,content:xe.target.value})),style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid #ddd",fontSize:"14px",minHeight:"100px",resize:"vertical"},placeholder:"輸入日記內容"})]}),i.jsxs("div",{style:{marginBottom:"20px"},children:[i.jsx("label",{style:{display:"block",marginBottom:"8px",color:"#666"},children:"情緒"}),i.jsxs("select",{value:B.emotion,onChange:xe=>q(Ae=>({...Ae,emotion:xe.target.value})),style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid #ddd",fontSize:"14px"},children:[i.jsx("option",{value:"happy",children:r.emotion.happy}),i.jsx("option",{value:"sad",children:r.emotion.sad}),i.jsx("option",{value:"angry",children:r.emotion.angry}),i.jsx("option",{value:"neutral",children:r.emotion.neutral}),i.jsx("option",{value:"excited",children:r.emotion.excited}),i.jsx("option",{value:"calm",children:r.emotion.calm})]})]}),i.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"flex-end"},children:[i.jsx("button",{onClick:()=>T(!1),style:{background:"#f5f5f5",border:"none",borderRadius:"8px",padding:"12px 24px",color:"#666",cursor:"pointer",fontSize:"14px"},children:r.cancel}),i.jsx("button",{onClick:Te,style:{background:"linear-gradient(45deg, #667eea, #764ba2)",border:"none",borderRadius:"8px",padding:"12px 24px",color:"white",cursor:"pointer",fontSize:"14px",fontWeight:"600"},children:r.save})]})]})}),F&&i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:i.jsxs("div",{style:{background:"white",borderRadius:"16px",padding:"30px",width:"90%",maxWidth:"500px"},children:[i.jsx("h3",{style:{marginBottom:"20px",color:"#333"},children:r.editDiary}),i.jsxs("div",{style:{marginBottom:"16px"},children:[i.jsx("label",{style:{display:"block",marginBottom:"8px",color:"#666"},children:"標題"}),i.jsx("input",{type:"text",value:B.title,onChange:xe=>q(Ae=>({...Ae,title:xe.target.value})),style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid #ddd",fontSize:"14px"}})]}),i.jsxs("div",{style:{marginBottom:"16px"},children:[i.jsx("label",{style:{display:"block",marginBottom:"8px",color:"#666"},children:"內容"}),i.jsx("textarea",{value:B.content,onChange:xe=>q(Ae=>({...Ae,content:xe.target.value})),style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid #ddd",fontSize:"14px",minHeight:"100px",resize:"vertical"}})]}),i.jsxs("div",{style:{marginBottom:"20px"},children:[i.jsx("label",{style:{display:"block",marginBottom:"8px",color:"#666"},children:"情緒"}),i.jsxs("select",{value:B.emotion,onChange:xe=>q(Ae=>({...Ae,emotion:xe.target.value})),style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid #ddd",fontSize:"14px"},children:[i.jsx("option",{value:"happy",children:r.emotion.happy}),i.jsx("option",{value:"sad",children:r.emotion.sad}),i.jsx("option",{value:"angry",children:r.emotion.angry}),i.jsx("option",{value:"neutral",children:r.emotion.neutral}),i.jsx("option",{value:"excited",children:r.emotion.excited}),i.jsx("option",{value:"calm",children:r.emotion.calm})]})]}),i.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"flex-end"},children:[i.jsx("button",{onClick:()=>P(null),style:{background:"#f5f5f5",border:"none",borderRadius:"8px",padding:"12px 24px",color:"#666",cursor:"pointer",fontSize:"14px"},children:r.cancel}),i.jsx("button",{onClick:Fe,style:{background:"linear-gradient(45deg, #667eea, #764ba2)",border:"none",borderRadius:"8px",padding:"12px 24px",color:"white",cursor:"pointer",fontSize:"14px",fontWeight:"600"},children:r.save})]})]})}),j&&i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:i.jsxs("div",{style:{background:"white",borderRadius:"16px",padding:"30px",width:"90%",maxWidth:"500px",textAlign:"center"},children:[i.jsx("div",{style:{fontSize:"48px",marginBottom:"20px"},children:"🎤"}),i.jsx("h3",{style:{marginBottom:"16px",color:"#333",fontSize:"20px",fontWeight:"600"},children:"準備開始錄音"}),i.jsxs("p",{style:{marginBottom:"20px",color:"#666",fontSize:"16px",lineHeight:"1.5"},children:["點擊「開始錄音」後，系統將開始錄製您的語音日記。",i.jsx("br",{}),i.jsx("strong",{style:{color:"#ff6b6b"},children:"⚠️ 錄音時間限制為1分鐘"})]}),i.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"center"},children:[i.jsx("button",{onClick:Ve,style:{background:"#f5f5f5",border:"none",borderRadius:"8px",padding:"12px 24px",color:"#666",cursor:"pointer",fontSize:"14px",fontWeight:"500"},children:"取消"}),i.jsx("button",{onClick:me,style:{background:"linear-gradient(45deg, #667eea, #764ba2)",border:"none",borderRadius:"8px",padding:"12px 24px",color:"white",cursor:"pointer",fontSize:"14px",fontWeight:"600",boxShadow:"0 4px 12px rgba(102, 126, 234, 0.3)"},children:"開始錄音"})]})]})}),O&&A&&(console.log("渲染送出對話框，pendingAudio:",A),!0)&&i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:i.jsxs("div",{style:{background:"white",borderRadius:"16px",padding:"30px",width:"90%",maxWidth:"500px",textAlign:"center"},children:[i.jsx("div",{style:{fontSize:"48px",marginBottom:"20px",animation:"bounce 0.6s infinite"},children:"🎤"}),i.jsx("h3",{style:{marginBottom:"10px",color:"#333",fontSize:"20px",fontWeight:"600"},children:r.recordingComplete}),i.jsx("p",{style:{marginBottom:"20px",color:"#666",fontSize:"16px"},children:r.submitToSave}),i.jsx("div",{style:{marginBottom:"20px",padding:"15px",background:"#f8f9fa",borderRadius:"8px",border:"1px solid #e9ecef"},children:i.jsxs("div",{style:{color:"#495057",fontSize:"14px",fontWeight:"500"},children:["錄音時長: ",Math.floor(A.duration/60),":",(A.duration%60).toString().padStart(2,"0")]})}),i.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"center"},children:[i.jsx("button",{onClick:fe,style:{background:"#f5f5f5",border:"none",borderRadius:"8px",padding:"12px 24px",color:"#666",cursor:"pointer",fontSize:"14px",fontWeight:"500"},children:r.cancel}),i.jsx("button",{onClick:Je,style:{background:"linear-gradient(45deg, #667eea, #764ba2)",border:"none",borderRadius:"8px",padding:"12px 24px",color:"white",cursor:"pointer",fontSize:"14px",fontWeight:"600",boxShadow:"0 4px 12px rgba(102, 126, 234, 0.3)"},children:r.submit})]})]})}),we&&i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:i.jsxs("div",{style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",borderRadius:"20px",padding:"40px",width:"90%",maxWidth:"450px",textAlign:"center",boxShadow:"0 20px 40px rgba(0,0,0,0.3)",border:"2px solid rgba(255,255,255,0.2)"},children:[i.jsx("div",{style:{fontSize:"64px",marginBottom:"20px",animation:"pulse 2s infinite"},children:"💔"}),i.jsx("h3",{style:{marginBottom:"15px",color:"white",fontSize:"22px",fontWeight:"600",textShadow:"0 2px 4px rgba(0,0,0,0.3)"},children:"這個心聲對您來說很重要嗎？"}),i.jsx("p",{style:{marginBottom:"30px",color:"rgba(255,255,255,0.9)",fontSize:"16px",lineHeight:"1.5",textShadow:"0 1px 2px rgba(0,0,0,0.3)"},children:"刪除後將無法恢復，請確認是否真的要刪除？"}),i.jsxs("div",{style:{display:"flex",gap:"15px",justifyContent:"center"},children:[i.jsx("button",{onClick:re,style:{background:"rgba(255,255,255,0.2)",border:"2px solid rgba(255,255,255,0.3)",borderRadius:"12px",padding:"14px 28px",color:"white",cursor:"pointer",fontSize:"16px",fontWeight:"600",transition:"all 0.3s ease",backdropFilter:"blur(10px)"},onMouseEnter:xe=>{xe.currentTarget.style.background="rgba(255,255,255,0.3)",xe.currentTarget.style.transform="translateY(-2px)"},onMouseLeave:xe=>{xe.currentTarget.style.background="rgba(255,255,255,0.2)",xe.currentTarget.style.transform="translateY(0)"},children:"取消"}),i.jsx("button",{onClick:K,style:{background:"linear-gradient(45deg, #ff6b6b, #ee5a52)",border:"none",borderRadius:"12px",padding:"14px 28px",color:"white",cursor:"pointer",fontSize:"16px",fontWeight:"600",boxShadow:"0 8px 20px rgba(255,107,107,0.4)",transition:"all 0.3s ease"},onMouseEnter:xe=>{xe.currentTarget.style.transform="translateY(-2px)",xe.currentTarget.style.boxShadow="0 12px 25px rgba(255,107,107,0.5)"},onMouseLeave:xe=>{xe.currentTarget.style.transform="translateY(0)",xe.currentTarget.style.boxShadow="0 8px 20px rgba(255,107,107,0.4)"},children:"確定刪除"})]})]})})]}),ne&&J&&i.jsx(Ms,{isOpen:ne,onClose:rt,currentPlan:J.currentPlan,remainingDays:J.remainingDays,usedTokens:J.usedTokens,totalTokens:J.totalTokens}),i.jsx("div",{style:{width:"100%",margin:"0 auto",marginTop:24,background:"rgba(255,255,255,0.95)",borderRadius:16,padding:"16px",boxShadow:"0 2px 12px #6B5BFF22"},children:i.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:20,flexWrap:"wrap"},children:[i.jsx("a",{href:"/privacy-policy",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12},children:e==="zh-TW"?"隱私權政策":e==="zh-CN"?"隐私政策":e==="en"?"Privacy Policy":e==="ja"?"プライバシーポリシー":e==="ko"?"개인정보 처리방침":e==="th"?"นโยบายความเป็นส่วนตัว":e==="vi"?"Chính sách bảo mật":e==="ms"?"Dasar Privasi":"Consilium de Privata"}),i.jsx("a",{href:"/terms",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12},children:e==="zh-TW"?"條款/聲明":e==="zh-CN"?"条款/声明":e==="en"?"Terms/Statement":e==="ja"?"規約/声明":e==="ko"?"약관/성명":e==="th"?"ข้อกำหนด/แถลงการณ์":e==="vi"?"Điều khoản/Tuyên bố":e==="ms"?"Terma/Pernyataan":"Termini/Declaratio"}),i.jsx("a",{href:"/data-deletion",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12},children:e==="zh-TW"?"資料刪除說明":e==="zh-CN"?"数据删除说明":e==="en"?"Data Deletion":e==="ja"?"データ削除について":e==="ko"?"데이터 삭제 안내":e==="th"?"คำอธิบายการลบข้อมูล":e==="vi"?"Giải thích xóa dữ liệu":e==="ms"?"Penjelasan Penghapusan Data":"Explicatio Deletionis Datae"}),i.jsx("a",{href:"/about",style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12},children:e==="zh-TW"?"🧬 Restarter™｜我們是誰":e==="zh-CN"?"🧬 Restarter™｜我们是谁":e==="en"?"🧬 Restarter™｜Who We Are":e==="ja"?"🧬 Restarter™｜私たちについて":e==="ko"?"🧬 Restarter™｜우리는 누구인가":e==="th"?"🧬 Restarter™｜เราเป็นใคร":e==="vi"?"🧬 Restarter™｜Chúng tôi là ai":e==="ms"?"🧬 Restarter™｜Siapa Kami":"🧬 Restarter™｜Quis sumus"}),i.jsx("a",{href:"/feedback",style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12},children:e==="zh-TW"?"💬 意見箱｜我們想聽你說":e==="zh-CN"?"💬 意见箱｜我们想听你说":e==="en"?"💬 Feedback Box｜We Want to Hear From You":e==="ja"?"💬 ご意見箱｜私たちはあなたの声を聞きたい":e==="ko"?"💬 피드백｜우리는 당신의 말을 듣고 싶습니다":e==="th"?"💬 กล่องความคิดเห็น｜เราอยากได้ยินจากคุณ":e==="vi"?"💬 Hộp góp ý｜Chúng tôi muốn nghe từ bạn":e==="ms"?"💬 Kotak Maklum Balas｜Kami Ingin Mendengar Dari Anda":"💬 Arca Consilii｜Volumus Audire a Te"})]})})]})}const qj=({isOpen:n,onClose:e,featureName:t})=>{const r=_t(),o=window.innerWidth<=768;if(!n)return null;const a={basic:{price:"NT$ 149",tokens:"50K",features:["語音功能","AI 聊天","語音轉文字","文字轉語音","用戶互動: 100次/月"]}},c=()=>{e(),r("/plans")};return i.jsx("div",{style:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",background:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e4},children:i.jsxs("div",{style:{background:"#fff",borderRadius:20,padding:o?16:32,maxWidth:480,width:"90%",textAlign:"center",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.2)"},children:[!o&&i.jsx("div",{style:{fontSize:48,marginBottom:16,color:"#6B5BFF"},children:"🚀"}),i.jsxs("h2",{style:{fontSize:o?18:24,fontWeight:700,color:"#333",marginBottom:o?6:12},children:["升級方案，解鎖 ",t]}),i.jsxs("p",{style:{fontSize:o?12:16,color:"#666",marginBottom:o?12:20,lineHeight:1.4},children:["您目前使用的是免費方案，",t," 需要升級才能使用。"]}),i.jsxs("div",{style:{background:"linear-gradient(135deg, #f8f9ff 0%, #e8f4ff 100%)",borderRadius:12,padding:o?12:16,marginBottom:o?16:24,border:"1px solid #e0e8ff"},children:[i.jsx("div",{style:{fontSize:o?12:14,color:"#6B5BFF",fontWeight:600,marginBottom:o?6:8},children:"📊 方案對比"}),i.jsxs("div",{style:{fontSize:o?11:13,color:"#666",lineHeight:1.3},children:["• 免費方案：僅限文字功能",i.jsx("br",{}),"• 付費方案：解鎖語音、AI 聊天等進階功能",i.jsx("br",{}),"• 立即升級：享受完整功能體驗"]})]}),i.jsxs("div",{style:{background:"#fff",borderRadius:12,padding:o?14:20,marginBottom:o?16:24,border:"2px solid #6B5BFF",boxShadow:"0 2px 8px #6B5BFF22"},children:[i.jsx("div",{style:{fontSize:o?14:16,color:"#6B5BFF",fontWeight:700,marginBottom:o?8:12},children:"💡 推薦方案"}),i.jsxs("div",{style:{fontSize:o?12:14,color:"#666",lineHeight:1.4,marginBottom:o?12:16},children:[i.jsx("strong",{children:"基礎版："}),"最受歡迎的入門方案",i.jsx("br",{}),"包含 ",a.basic.tokens," tokens，",a.basic.features.join("、")]}),i.jsx("div",{style:{fontSize:o?16:18,fontWeight:700,color:"#6B5BFF"},children:a.basic.price})]}),i.jsxs("div",{style:{background:"linear-gradient(135deg, #fff3cd 0%, #ffeaa7 100%)",borderRadius:12,padding:o?12:16,marginBottom:o?16:24,border:"1px solid #ffeaa7"},children:[i.jsx("div",{style:{fontSize:o?12:14,color:"#856404",fontWeight:600,marginBottom:o?6:8},children:"✨ 升級好處"}),i.jsxs("div",{style:{fontSize:o?11:13,color:"#856404",lineHeight:1.3},children:["• 立即解鎖 ",t,i.jsx("br",{}),"• 享受完整的 AI 體驗",i.jsx("br",{}),"• 無限制使用語音功能",i.jsx("br",{}),"• 優先技術支援"]})]}),i.jsxs("div",{style:{display:"flex",gap:o?8:12,justifyContent:"center"},children:[i.jsx("button",{onClick:c,style:{background:"linear-gradient(135deg, #6B5BFF 0%, #00CFFF 100%)",color:"#fff",border:"none",borderRadius:12,padding:o?"12px 20px":"14px 28px",fontSize:o?14:16,fontWeight:700,cursor:"pointer",flex:1,boxShadow:"0 4px 12px #6B5BFF33",transition:"all 0.3s ease"},onMouseEnter:d=>{d.currentTarget.style.transform="translateY(-2px)",d.currentTarget.style.boxShadow="0 6px 16px #6B5BFF44"},onMouseLeave:d=>{d.currentTarget.style.transform="translateY(0)",d.currentTarget.style.boxShadow="0 4px 12px #6B5BFF33"},children:"🚀 立即升級"}),i.jsx("button",{onClick:e,style:{background:"#f8f9ff",color:"#6B5BFF",border:"2px solid #6B5BFF",borderRadius:12,padding:o?"12px 20px":"14px 28px",fontSize:o?14:16,fontWeight:600,cursor:"pointer",flex:1,transition:"all 0.3s ease"},onMouseEnter:d=>{d.currentTarget.style.background="#6B5BFF",d.currentTarget.style.color="#fff"},onMouseLeave:d=>{d.currentTarget.style.background="#f8f9ff",d.currentTarget.style.color="#6B5BFF"},children:"💫 稍後再說"})]}),i.jsx("div",{style:{marginTop:16},children:i.jsx("button",{onClick:e,style:{background:"none",border:"none",color:"#888",fontSize:14,cursor:"pointer",textDecoration:"underline"},children:"稍後再說"})})]})})},SS={"zh-TW":{title:"我的故事 My Story",subtitle:"記錄你的成長歷程，見證改變的每一步",backToHome:"← 返回首頁",logout:"登出",addMilestone:"添加里程碑",editMilestone:"編輯里程碑",deleteMilestone:"刪除里程碑",save:"保存",cancel:"取消",totalDays:"總天數",achievements:"成就",currentStreak:"連續",days:"天",myMilestones:"我的里程碑",noMilestones:"還沒有里程碑，開始記錄你的故事吧！",socialIntegration:"社會融入度評估",socialIntegrationTitle:"社會融入度評估",socialIntegrationDesc:"評估你在社會中的融入程度，包括人際關係、就業狀況、家庭關係等",socialIntegrationQuestions:{q1:"你覺得與他人的關係如何？",q2:"你對目前的工作/學習狀況滿意嗎？",q3:"你與家人的關係如何？",q4:"你對未來有信心嗎？",q5:"你覺得社會對你的接納程度如何？"},socialIntegrationOptions:{excellent:"非常好",good:"良好",fair:"一般",poor:"需要改善"},milestoneTypes:{start:"開始",achievement:"成就",growth:"成長",habit:"習慣",help:"幫助",goal:"目標",social:"社會融入"}},"zh-CN":{title:"我的故事 My Story",subtitle:"记录你的成长历程，见证改变的每一步",backToHome:"← 返回首页",logout:"登出",addMilestone:"添加里程碑",editMilestone:"编辑里程碑",deleteMilestone:"删除里程碑",save:"保存",cancel:"取消",totalDays:"总天数",achievements:"成就",currentStreak:"连续",days:"天",myMilestones:"我的里程碑",noMilestones:"还没有里程碑，开始记录你的故事吧！",socialIntegration:"社会融入度评估",socialIntegrationTitle:"社会融入度评估",socialIntegrationDesc:"评估你在社会中的融入程度，包括人际关系、就业状况、家庭关系等",socialIntegrationQuestions:{q1:"你觉得与他人的关系如何？",q2:"你对目前的工作/学习状况满意吗？",q3:"你与家人的关系如何？",q4:"你对未来有信心吗？",q5:"你觉得社会对你的接纳程度如何？"},socialIntegrationOptions:{excellent:"非常好",good:"良好",fair:"一般",poor:"需要改善"},milestoneTypes:{start:"开始",achievement:"成就",growth:"成长",habit:"习惯",help:"帮助",goal:"目标",social:"社会融入"}},en:{title:"My Story",subtitle:"Record your growth journey, witness every step of change",backToHome:"← Back to Home",logout:"Logout",addMilestone:"Add Milestone",editMilestone:"Edit Milestone",deleteMilestone:"Delete Milestone",save:"Save",cancel:"Cancel",totalDays:"Total Days",achievements:"Achievements",currentStreak:"Current Streak",days:"days",myMilestones:"My Milestones",noMilestones:"No milestones yet, start recording your story!",socialIntegration:"Social Integration Assessment",socialIntegrationTitle:"Social Integration Assessment",socialIntegrationDesc:"Assess your level of social integration, including relationships, employment status, family relationships, etc.",socialIntegrationQuestions:{q1:"How do you feel about your relationships with others?",q2:"Are you satisfied with your current work/study situation?",q3:"How are your relationships with family?",q4:"Do you have confidence in the future?",q5:"How do you feel about society's acceptance of you?"},socialIntegrationOptions:{excellent:"Excellent",good:"Good",fair:"Fair",poor:"Needs Improvement"},milestoneTypes:{start:"Start",achievement:"Achievement",growth:"Growth",habit:"Habit",help:"Help",goal:"Goal",social:"Social Integration"}},ja:{title:"マイストーリー",subtitle:"成長の旅を記録し、変化の一歩一歩を目撃する",backToHome:"← ホームに戻る",logout:"ログアウト",addMilestone:"マイルストーンを追加",editMilestone:"マイルストーンを編集",deleteMilestone:"マイルストーンを削除",save:"保存",cancel:"キャンセル",totalDays:"総日数",achievements:"達成",currentStreak:"連続",days:"日",myMilestones:"マイマイルストーン",noMilestones:"まだマイルストーンがありません。ストーリーを記録し始めましょう！",socialIntegration:"社会的統合度評価",socialIntegrationTitle:"社会的統合度評価",socialIntegrationDesc:"人間関係、就業状況、家族関係などを含む社会的統合度を評価する",socialIntegrationQuestions:{q1:"他者との関係をどう感じていますか？",q2:"現在の仕事/学習状況に満足していますか？",q3:"家族との関係はどうですか？",q4:"将来に自信がありますか？",q5:"社会からの受け入れられ方をどう感じていますか？"},socialIntegrationOptions:{excellent:"非常に良い",good:"良い",fair:"普通",poor:"改善が必要"},milestoneTypes:{start:"開始",achievement:"達成",growth:"成長",habit:"習慣",help:"支援",goal:"目標",social:"社会的統合"}},ko:{title:"내 이야기",subtitle:"성장 여정을 기록하고 변화의 모든 단계를 목격하세요",backToHome:"← 홈으로",logout:"로그아웃",addMilestone:"마일스톤 추가",editMilestone:"마일스톤 편집",deleteMilestone:"마일스톤 삭제",save:"저장",cancel:"취소",totalDays:"총 일수",achievements:"성취",currentStreak:"연속",days:"일",myMilestones:"내 마일스톤",noMilestones:"아직 마일스톤이 없습니다. 이야기를 기록하기 시작하세요!",socialIntegration:"사회 통합도 평가",socialIntegrationTitle:"사회 통합도 평가",socialIntegrationDesc:"인간관계, 고용상태, 가족관계 등을 포함한 사회 통합도를 평가하세요",socialIntegrationQuestions:{q1:"다른 사람과의 관계를 어떻게 느끼나요?",q2:"현재의 일/학습 상황에 만족하나요?",q3:"가족과의 관계는 어떠한가요?",q4:"미래에 대한 자신감이 있나요?",q5:"사회로부터의 수용도를 어떻게 느끼나요?"},socialIntegrationOptions:{excellent:"매우 좋음",good:"좋음",fair:"보통",poor:"개선 필요"},milestoneTypes:{start:"시작",achievement:"성취",growth:"성장",habit:"습관",help:"도움",goal:"목표",social:"사회 통합"}},th:{title:"เรื่องราวของฉัน",subtitle:"บันทึกการเดินทางแห่งการเติบโต เป็นพยานทุกก้าวของการเปลี่ยนแปลง",backToHome:"← กลับหน้าหลัก",logout:"ออกจากระบบ",addMilestone:"เพิ่มจุดหมาย",editMilestone:"แก้ไขจุดหมาย",deleteMilestone:"ลบจุดหมาย",save:"บันทึก",cancel:"ยกเลิก",totalDays:"จำนวนวันทั้งหมด",achievements:"ความสำเร็จ",currentStreak:"ต่อเนื่อง",days:"วัน",myMilestones:"จุดหมายของฉัน",noMilestones:"ยังไม่มีจุดหมาย เริ่มบันทึกเรื่องราวของคุณเลย!",socialIntegration:"การประเมินการรวมตัวทางสังคม",socialIntegrationTitle:"การประเมินการรวมตัวทางสังคม",socialIntegrationDesc:"ประเมินระดับการรวมตัวทางสังคมของคุณ รวมถึงความสัมพันธ์ สถานะการจ้างงาน ความสัมพันธ์ในครอบครัว",socialIntegrationQuestions:{q1:"คุณรู้สึกอย่างไรกับความสัมพันธ์กับผู้อื่น?",q2:"คุณพอใจกับสถานการณ์การทำงาน/การเรียนปัจจุบันหรือไม่?",q3:"ความสัมพันธ์กับครอบครัวเป็นอย่างไร?",q4:"คุณมีความมั่นใจในอนาคตหรือไม่?",q5:"คุณรู้สึกอย่างไรกับการยอมรับจากสังคม?"},socialIntegrationOptions:{excellent:"ดีมาก",good:"ดี",fair:"ปานกลาง",poor:"ต้องปรับปรุง"},milestoneTypes:{start:"เริ่มต้น",achievement:"ความสำเร็จ",growth:"การเติบโต",habit:"นิสัย",help:"ความช่วยเหลือ",goal:"เป้าหมาย",social:"การรวมตัวทางสังคม"}},vi:{title:"Câu chuyện của tôi",subtitle:"Ghi lại hành trình phát triển, chứng kiến từng bước thay đổi",backToHome:"← Về trang chủ",logout:"Đăng xuất",addMilestone:"Thêm cột mốc",editMilestone:"Chỉnh sửa cột mốc",deleteMilestone:"Xóa cột mốc",save:"Lưu",cancel:"Hủy",totalDays:"Tổng số ngày",achievements:"Thành tựu",currentStreak:"Liên tiếp",days:"ngày",myMilestones:"Cột mốc của tôi",noMilestones:"Chưa có cột mốc nào, hãy bắt đầu ghi lại câu chuyện của bạn!",socialIntegration:"Đánh giá hòa nhập xã hội",socialIntegrationTitle:"Đánh giá hòa nhập xã hội",socialIntegrationDesc:"Đánh giá mức độ hòa nhập xã hội của bạn, bao gồm các mối quan hệ, tình trạng việc làm, mối quan hệ gia đình",socialIntegrationQuestions:{q1:"Bạn cảm thấy thế nào về mối quan hệ với người khác?",q2:"Bạn có hài lòng với tình hình công việc/học tập hiện tại không?",q3:"Mối quan hệ với gia đình như thế nào?",q4:"Bạn có tự tin về tương lai không?",q5:"Bạn cảm thấy thế nào về sự chấp nhận từ xã hội?"},socialIntegrationOptions:{excellent:"Rất tốt",good:"Tốt",fair:"Bình thường",poor:"Cần cải thiện"},milestoneTypes:{start:"Bắt đầu",achievement:"Thành tựu",growth:"Phát triển",habit:"Thói quen",help:"Hỗ trợ",goal:"Mục tiêu",social:"Hòa nhập xã hội"}},ms:{title:"Cerita Saya",subtitle:"Rakam perjalanan pertumbuhan anda, saksikan setiap langkah perubahan",backToHome:"← Kembali ke Laman Utama",logout:"Log keluar",addMilestone:"Tambah Pencapaian",editMilestone:"Edit Pencapaian",deleteMilestone:"Padam Pencapaian",save:"Simpan",cancel:"Batal",totalDays:"Jumlah Hari",achievements:"Pencapaian",currentStreak:"Berturut-turut",days:"hari",myMilestones:"Pencapaian Saya",noMilestones:"Belum ada pencapaian, mulakan rakam cerita anda!",socialIntegration:"Penilaian Integrasi Sosial",socialIntegrationTitle:"Penilaian Integrasi Sosial",socialIntegrationDesc:"Nilai tahap integrasi sosial anda, termasuk hubungan, status pekerjaan, hubungan keluarga",socialIntegrationQuestions:{q1:"Bagaimana perasaan anda tentang hubungan dengan orang lain?",q2:"Adakah anda berpuas hati dengan situasi kerja/pembelajaran semasa?",q3:"Bagaimana hubungan anda dengan keluarga?",q4:"Adakah anda yakin dengan masa hadapan?",q5:"Bagaimana perasaan anda tentang penerimaan masyarakat?"},socialIntegrationOptions:{excellent:"Sangat Baik",good:"Baik",fair:"Sederhana",poor:"Perlu Penambahbaikan"},milestoneTypes:{start:"Mula",achievement:"Pencapaian",growth:"Pertumbuhan",habit:"Tabiat",help:"Bantuan",goal:"Matlamat",social:"Integrasi Sosial"}},la:{title:"Fabula Mea",subtitle:"Iter incrementi tuum inscribe, mutationis gradum quemque testare",backToHome:"← Redi ad domum",logout:"Exire",addMilestone:"Addere Lapidem Milliarium",editMilestone:"Lapidem Milliarium Edere",deleteMilestone:"Lapidem Milliarium Delere",save:"Servare",cancel:"Cancellare",totalDays:"Dies Totales",achievements:"Res Gestae",currentStreak:"Series",days:"dies",myMilestones:"Lapides Milliarii Mei",noMilestones:"Nondum lapides milliarii, incipe fabulam tuam inscribere!",socialIntegration:"Aestimatio Integrationis Socialis",socialIntegrationTitle:"Aestimatio Integrationis Socialis",socialIntegrationDesc:"Aestima gradum integrationis socialis tuae, includens relationes, statum operis, relationes familiae",socialIntegrationQuestions:{q1:"Quomodo sentis de relationibus cum aliis?",q2:"Esne contentus cum statu operis/studii praesenti?",q3:"Quomodo sunt relationes tuae cum familia?",q4:"Habesne fiduciam in futuro?",q5:"Quomodo sentis de acceptatione societatis?"},socialIntegrationOptions:{excellent:"Optime",good:"Bene",fair:"Mediocriter",poor:"Emendatione Opus"},milestoneTypes:{start:"Initiare",achievement:"Res Gesta",growth:"Incrementum",habit:"Consuetudo",help:"Auxilium",goal:"Propositum",social:"Integratio Socialis"}}};function CD(){const n=_t(),{lang:e,setLang:t}=Mt(),r=SS[e]||SS["zh-TW"],{isTestMode:o}=$i(),a=async()=>{try{const de=St().currentUser;if(de){const De=Td(),$e=Vn(De,"profiles",de.uid),lt=await Cs($e);if(lt.exists()){const pt=lt.data();pt.avatar&&G(pt.avatar)}}}catch(pe){console.error("獲取用戶頭像失敗:",pe)}},[c,d]=v.useState(()=>{const pe=localStorage.getItem("userMilestones");return pe?JSON.parse(pe):[{id:1,title:"開始新的旅程",description:"決定重新開始，為自己設定新的目標",date:new Date(Date.now()-30*24*60*60*1e3).toISOString(),type:"start",completed:!0},{id:2,title:"完成第一個小目標",description:"成功完成了一項小任務，感覺很棒",date:new Date(Date.now()-25*24*60*60*1e3).toISOString(),type:"achievement",completed:!0},{id:3,title:"學會控制情緒",description:"在困難時刻保持冷靜，學會了情緒管理",date:new Date(Date.now()-20*24*60*60*1e3).toISOString(),type:"growth",completed:!0},{id:4,title:"建立新的習慣",description:"每天堅持做一些小事情，建立正向習慣",date:new Date(Date.now()-15*24*60*60*1e3).toISOString(),type:"habit",completed:!0},{id:5,title:"幫助他人",description:"第一次主動幫助別人，感受到付出的快樂",date:new Date(Date.now()-10*24*60*60*1e3).toISOString(),type:"help",completed:!0},{id:6,title:"設定更大的目標",description:"為自己設定更具挑戰性的目標",date:new Date(Date.now()+5*24*60*60*1e3).toISOString(),type:"goal",completed:!1}]}),[h]=v.useState({name:"我的故事",startDate:new Date(Date.now()-30*24*60*60*1e3),totalDays:30,achievements:5,currentStreak:7}),[m,g]=v.useState(!1),[x,S]=v.useState(!1),[C,_]=v.useState(!1),[I,T]=v.useState(null),[F,P]=v.useState(null),[B,q]=v.useState({title:"",description:"",type:"achievement"}),[te,W]=v.useState(!1),[L,R]=v.useState(!1),[A,N]=v.useState(0),[O,z]=v.useState(null),[j,V]=v.useState(!1),[X,$]=v.useState(!1),[ne,oe]=v.useState(null),[J,Q]=v.useState(null),[D,G]=v.useState("/avatars/Derxl.png"),[ie,ee]=v.useState([]),Se=v.useRef([]),{checkPermission:we,recordUsage:Oe}=Ls(),[Ne,Ye]=v.useState(!1),[it,me]=v.useState(!1),[Ve,Xe]=v.useState(null);v.useEffect(()=>{a()},[]);const Je=pe=>{localStorage.setItem("userMilestones",JSON.stringify(pe))},He=()=>{if(B.title.trim()&&B.description.trim()){const de=[{id:Date.now(),title:B.title,description:B.description,date:new Date().toISOString(),type:B.type,completed:!1},...c];d(de),Je(de),q({title:"",description:"",type:"achievement"}),g(!1)}},fe=pe=>{P(pe),q({title:pe.title,description:pe.description,type:pe.type})},Te=()=>{if(F&&B.title.trim()&&B.description.trim()){const pe=c.map(de=>de.id===F.id?{...de,title:B.title,description:B.description,type:B.type}:de);d(pe),Je(pe),P(null),q({title:"",description:"",type:"achievement"})}},_e=pe=>{if(window.confirm("確定要刪除這個里程碑嗎？")){const de=c.filter(De=>De.id!==pe);d(de),Je(de)}},Fe=async()=>{if(L){ne&&ne.state==="recording"&&ne.stop(),J&&(clearInterval(J),Q(null)),R(!1),W(!1),N(0);return}const pe=await we("aiChat");if(!pe.allowed){if(o)return;pe.isFreeUser?me(!0):(pe.canRenew,Xe(pe),Ye(!0));return}$(!0)},Be=async()=>{$(!1);try{const pe=await navigator.mediaDevices.getUserMedia({audio:!0}),de=new MediaRecorder(pe,{mimeType:"audio/webm;codecs=opus"});ee([]),Se.current=[],N(0),de.ondataavailable=$e=>{console.log("收到音頻數據，大小:",$e.data.size),$e.data.size>0&&(Se.current.push($e.data),ee(lt=>{const pt=[...lt,$e.data];return console.log("更新音頻塊，當前數量:",pt.length),pt}))},de.onstop=()=>{const $e=[...Se.current];console.log("錄音停止，音頻塊數量:",$e.length);const lt=$e.length>0?new Blob($e,{type:"audio/webm"}):new Blob([""],{type:"audio/webm"}),pt=Math.max(1,Math.floor($e.length*.1));console.log("創建音頻blob，大小:",lt.size,"估算錄音時長:",pt),z({blob:lt,duration:pt}),V(!0),ee([]),Se.current=[],console.log("設置送出對話框狀態"),pe.getTracks().forEach(bt=>bt.stop())},de.start(100),oe(de),R(!0),W(!0);const De=setInterval(()=>{N($e=>{const lt=$e+1;return lt>=60&&(ne&&ne.state==="recording"&&ne.stop(),De&&(clearInterval(De),Q(null)),R(!1),W(!1),alert("錄音時間已達1分鐘限制，已自動停止錄音")),lt})},1e3);Q(De)}catch(pe){console.error("錄音錯誤:",pe),alert("無法啟動麥克風，請檢查權限設置")}},K=()=>{$(!1)},re=()=>{O&&(rt(O.blob,O.duration),z(null),V(!1),Oe("aiChat",1))},H=()=>{z(null),V(!1)},[Ue,ue]=v.useState({q1:"",q2:"",q3:"",q4:"",q5:""}),le=pe=>{const de={excellent:5,good:4,fair:3,poor:2},lt=[de[pe.q1]||3,de[pe.q2]||3,de[pe.q3]||3,de[pe.q4]||3,de[pe.q5]||3].reduce((pt,bt)=>pt+bt,0)/5;return lt>=4.5?{score:lt,result:"優秀",description:"你的社會融入度非常高，在人際關係、就業狀況、家庭關係等方面都表現出色。",recommendations:["繼續保持現有的良好狀態","可以考慮擔任志工幫助其他更生人","分享你的成功經驗給其他需要幫助的人","參與社區活動擴大影響力"],analysis:"基於你的評估結果，你在各個方面都表現優秀，顯示出良好的社會適應能力和積極的生活態度。建議繼續保持這種狀態，並可以考慮幫助其他需要支持的人。"}:lt>=3.5?{score:lt,result:"良好",description:"你的社會融入度良好，在大部分方面都有不錯的表現，還有提升空間。",recommendations:["參加更多社交活動擴大交友圈","尋求職業技能培訓提升就業競爭力","與家人多溝通改善家庭關係","制定具體的個人發展計劃"],analysis:"你的社會融入度處於良好水平，顯示出積極的改善趨勢。建議在現有基礎上進一步提升，特別是在就業技能和人際關係方面。"}:lt>=2.5?{score:lt,result:"一般",description:"你的社會融入度一般，在某些方面需要改善，建議尋求更多支持。",recommendations:["建議尋求專業輔導師協助","參加更生人互助團體","制定具體的改善計劃","逐步建立支持網絡"],analysis:"你的社會融入度處於一般水平，這表明在某些方面還需要改善。建議尋求專業支持，制定具體的改善計劃，並逐步建立支持網絡。"}:{score:lt,result:"需要改善",description:"你的社會融入度需要改善，建議尋求專業輔導和支持。",recommendations:["立即聯繫專業輔導師","參加更生人支持計劃","尋求心理諮商服務","建立穩定的生活規律"],analysis:"你的社會融入度需要改善，建議立即尋求專業輔導和支持。這不是失敗，而是需要更多幫助的表現。專業輔導師可以幫助你制定適合的改善計劃。"}},Re=()=>{if(!Object.values(Ue).every(pt=>pt!=="")){alert("請回答所有問題");return}const de=le(Ue),De={score:de.score,result:de.result,description:de.description,recommendations:de.recommendations,analysis:de.analysis,details:{relationships:Ue.q1,employment:Ue.q2,family:Ue.q3,confidence:Ue.q4,acceptance:Ue.q5}},lt=[{id:Date.now(),title:`${r.socialIntegrationTitle} - ${de.result}`,description:`${de.description} 評估分數: ${de.score.toFixed(1)}/5.0

分析：
${de.analysis}

建議：
${de.recommendations.map(pt=>`• ${pt}`).join(`
`)}`,date:new Date().toISOString(),type:"social",completed:!0},...c];d(lt),Je(lt),ue({q1:"",q2:"",q3:"",q4:"",q5:""}),S(!1),_(!0),T(De)},rt=(pe,de)=>{const De=URL.createObjectURL(pe),$e=["今天完成了一個重要目標，感覺很有成就感。","學會了新的技能，為自己的成長感到驕傲。","克服了困難，證明了自己的能力。","幫助了別人，感受到付出的快樂。","建立了新的習慣，為未來打下基礎。"],lt=$e[Math.floor(Math.random()*$e.length)],pt=["achievement","growth","habit","help","goal"][Math.floor(Math.random()*5)],gt=[{id:Date.now(),title:"語音里程碑",description:lt,date:new Date().toISOString(),type:pt,completed:!0,audioUrl:De,duration:de},...c];d(gt),Je(gt)},xe=pe=>({start:"#2196F3",achievement:"#4CAF50",growth:"#9C27B0",habit:"#FF9800",help:"#E91E63",goal:"#F44336",social:"#6B5BFF"})[pe]||"#9E9E9E",Ae=pe=>new Date(pe).toLocaleString("zh-TW",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}),Ge=pe=>{if(pe.audioUrl){const de=new Audio(pe.audioUrl);de.onerror=De=>{console.error("音頻加載失敗:",De),ft(pe.description)},de.play().then(()=>{console.log("正在播放原音...")}).catch(De=>{console.error("播放失敗:",De),ft(pe.description)})}else ft(pe.description)},ft=pe=>{if("speechSynthesis"in window){const de=new SpeechSynthesisUtterance(pe);de.lang="zh-TW",de.rate=.9,de.pitch=1,window.speechSynthesis.cancel(),window.speechSynthesis.speak(de),console.log("正在播放里程碑內容（文字轉語音）...")}else alert("瀏覽器不支援語音播放功能")},ke=c.filter(pe=>pe.completed).length,at=()=>{Ye(!1),Xe(null)};return i.jsxs("div",{style:{minHeight:"100vh",background:"linear-gradient(135deg, #4CAF50 0%, #8BC34A 100%)",padding:"20px"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"30px"},children:[i.jsx("button",{onClick:()=>n("/home"),style:{background:"#fff",border:"1.5px solid #6B5BFF",borderRadius:"8px",padding:"6px 10px",color:"#6B5BFF",cursor:"pointer",fontSize:"16px",fontWeight:"600",transition:"all 0.3s ease"},children:r.backToHome}),i.jsx("h1",{style:{color:"white",fontSize:"24px",fontWeight:"bold",margin:0,marginBottom:"8px"},children:r.myMilestones}),i.jsx("p",{style:{color:"rgba(255,255,255,0.8)",fontSize:"14px",fontWeight:400,margin:0,textAlign:"center",lineHeight:1.4},children:r.subtitle}),i.jsxs("div",{style:{display:"flex",gap:"10px"},children:[i.jsx("button",{onClick:()=>n("/logout"),style:{background:"#fff",border:"1.5px solid #6B5BFF",borderRadius:"8px",padding:"6px 10px",color:"#6B5BFF",cursor:"pointer",fontSize:"16px",fontWeight:"600",transition:"all 0.3s ease"},children:r.logout}),i.jsx(Bn,{})]})]}),i.jsxs("div",{style:{maxWidth:"800px",margin:"0 auto"},children:[i.jsxs("div",{style:{background:"rgba(255,255,255,0.95)",borderRadius:"20px",padding:"24px",marginBottom:"24px",boxShadow:"0 8px 32px rgba(0,0,0,0.1)"},children:[i.jsxs("div",{style:{textAlign:"center",marginBottom:"20px"},children:[i.jsxs("div",{style:{width:"70px",height:"70px",borderRadius:"50%",background:"white",display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto 12px",boxShadow:"0 4px 16px rgba(0,0,0,0.1)",overflow:"hidden"},children:[i.jsx("img",{src:D,alt:"用戶頭像",style:{width:"100%",height:"100%",objectFit:"cover",borderRadius:"50%"},onError:pe=>{const de=pe.currentTarget;de.style.display="none";const De=de.nextElementSibling;De&&(De.style.display="flex")}}),i.jsx("span",{style:{fontSize:"35px",color:"#4CAF50",display:"none",position:"absolute"},children:"👤"})]}),i.jsx("h2",{style:{color:"#333",fontSize:"22px",fontWeight:"bold",marginBottom:"6px"},children:e==="zh-TW"||e==="zh-CN"?"里程碑":e==="en"?"Milestone":e==="ja"?"マイルストーン":e==="ko"?"마일스톤":e==="th"?"จุดหมาย":e==="vi"?"Cột mốc":e==="ms"?"Pencapaian":"Lapis Milliarius"}),i.jsxs("p",{style:{color:"#666",fontSize:"13px",marginBottom:"20px"},children:["開始於 ",h.startDate.toLocaleDateString("zh-TW")]})]}),i.jsxs("div",{style:{display:"flex",justifyContent:"space-around"},children:[i.jsxs("div",{style:{textAlign:"center"},children:[i.jsx("div",{style:{fontSize:"22px",fontWeight:"bold",color:"#4CAF50",marginBottom:"3px"},children:h.totalDays}),i.jsx("div",{style:{fontSize:"11px",color:"#666"},children:r.totalDays})]}),i.jsxs("div",{style:{textAlign:"center"},children:[i.jsx("div",{style:{fontSize:"22px",fontWeight:"bold",color:"#FF9800",marginBottom:"3px"},children:ke}),i.jsx("div",{style:{fontSize:"11px",color:"#666"},children:r.achievements})]}),i.jsxs("div",{style:{textAlign:"center"},children:[i.jsx("div",{style:{fontSize:"22px",fontWeight:"bold",color:"#2196F3",marginBottom:"3px"},children:h.currentStreak}),i.jsxs("div",{style:{fontSize:"11px",color:"#666"},children:[r.currentStreak," ",r.days]})]})]})]}),i.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:"16px",marginBottom:"24px",flexWrap:"wrap"},children:[i.jsxs("button",{onClick:()=>g(!0),style:{background:"linear-gradient(135deg, #2196F3 0%, #1976D2 100%)",border:"none",borderRadius:"16px",padding:"12px 24px",color:"white",cursor:"pointer",fontSize:"16px",fontWeight:"600",boxShadow:"0 4px 16px rgba(33, 150, 243, 0.3)",transition:"all 0.3s ease",display:"flex",alignItems:"center",gap:"8px"},onMouseOver:pe=>{pe.currentTarget.style.transform="translateY(-2px)",pe.currentTarget.style.boxShadow="0 6px 20px rgba(33, 150, 243, 0.4)"},onMouseOut:pe=>{pe.currentTarget.style.transform="translateY(0)",pe.currentTarget.style.boxShadow="0 4px 16px rgba(33, 150, 243, 0.3)"},children:[i.jsx("span",{style:{fontSize:"18px"},children:"+"}),r.addMilestone]}),i.jsxs("button",{onClick:Fe,style:{background:te?"linear-gradient(135deg, #f44336 0%, #d32f2f 100%)":"linear-gradient(135deg, #2196F3 0%, #1976D2 100%)",border:"none",borderRadius:"16px",padding:"12px 24px",color:"white",cursor:"pointer",fontSize:"16px",fontWeight:"600",boxShadow:te?"0 4px 16px rgba(244, 67, 54, 0.3)":"0 4px 16px rgba(33, 150, 243, 0.3)",transition:"all 0.3s ease",display:"flex",alignItems:"center",gap:"8px",animation:te?"pulse 1.5s infinite":"none"},onMouseOver:pe=>{te||(pe.currentTarget.style.transform="translateY(-2px)",pe.currentTarget.style.boxShadow="0 6px 20px rgba(33, 150, 243, 0.4)")},onMouseOut:pe=>{te||(pe.currentTarget.style.transform="translateY(0)",pe.currentTarget.style.boxShadow="0 4px 16px rgba(33, 150, 243, 0.3)")},children:[i.jsx("span",{style:{fontSize:"18px"},children:"🎤"}),te?`${e==="zh-TW"?"錄音中":e==="zh-CN"?"录音中":e==="en"?"Recording":e==="ja"?"録音中":e==="ko"?"녹음 중":e==="th"?"กำลังบันทึก":e==="vi"?"Đang ghi âm":e==="ms"?"Sedang Merakam":"Recording"} ${Math.floor(A/60)}:${(A%60).toString().padStart(2,"0")}`:e==="zh-TW"?"語音輸入":e==="zh-CN"?"语音输入":e==="en"?"Voice Input":e==="ja"?"音声入力":e==="ko"?"음성 입력":e==="th"?"ป้อนเสียง":e==="vi"?"Nhập giọng nói":e==="ms"?"Input Suara":"Input Vox"]})]}),i.jsx("div",{style:{marginBottom:"30px"},children:c.length===0?i.jsx("div",{style:{background:"rgba(255,255,255,0.95)",borderRadius:"16px",padding:"40px",textAlign:"center",color:"#666"},children:r.noMilestones}):i.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:c.map((pe,de)=>i.jsx("div",{style:{background:"rgba(255,255,255,0.95)",borderRadius:"16px",padding:"20px",boxShadow:"0 4px 16px rgba(0,0,0,0.1)",position:"relative"},children:i.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:"16px"},children:[i.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",minWidth:"40px"},children:[i.jsx("div",{style:{width:"20px",height:"20px",borderRadius:"50%",background:pe.completed?xe(pe.type):"#ddd",display:"flex",alignItems:"center",justifyContent:"center",marginBottom:"8px"},children:pe.completed&&i.jsx("span",{style:{color:"white",fontSize:"12px"},children:"✓"})}),de<c.length-1&&i.jsx("div",{style:{width:"2px",height:"40px",background:"#ddd"}})]}),i.jsxs("div",{style:{flex:1},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"8px"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[i.jsx("span",{style:{background:xe(pe.type),color:"white",padding:"4px 8px",borderRadius:"12px",fontSize:"12px",fontWeight:"600"},children:r.milestoneTypes[pe.type]}),i.jsx("span",{style:{color:"#999",fontSize:"12px"},children:Ae(pe.date)})]}),i.jsxs("div",{style:{display:"flex",gap:"8px"},children:[pe.title!=="語音里程碑"&&i.jsx("button",{onClick:()=>fe(pe),style:{background:"#4CAF50",border:"none",borderRadius:"6px",padding:"4px 8px",color:"white",cursor:"pointer",fontSize:"12px"},children:"✏️"}),i.jsx("button",{onClick:()=>_e(pe.id),style:{background:"#F44336",border:"none",borderRadius:"6px",padding:"4px 8px",color:"white",cursor:"pointer",fontSize:"12px"},children:"🗑️"})]})]}),i.jsx("h4",{style:{margin:"0 0 8px 0",fontSize:"16px",fontWeight:"600",color:pe.completed?"#333":"#666"},children:pe.title}),i.jsx("p",{style:{color:"#666",fontSize:"14px",lineHeight:"1.5",margin:0,marginBottom:"8px"},children:pe.description}),pe.audioUrl&&i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",marginTop:"8px"},children:[i.jsxs("button",{onClick:()=>Ge(pe),style:{background:"linear-gradient(135deg, #4CAF50 0%, #8BC34A 100%)",border:"none",borderRadius:"8px",padding:"6px 12px",color:"white",cursor:"pointer",fontSize:"12px",fontWeight:"600",display:"flex",alignItems:"center",gap:"4px"},children:[i.jsx("span",{style:{fontSize:"14px"},children:"▶️"}),"播放原音"]}),pe.duration&&i.jsxs("span",{style:{color:"#666",fontSize:"12px",background:"#f5f5f5",padding:"4px 8px",borderRadius:"6px"},children:["錄音時長: ",Math.floor(pe.duration/60),":",(pe.duration%60).toString().padStart(2,"0")]})]})]})]})},pe.id))})})]}),m&&i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:i.jsxs("div",{style:{background:"white",borderRadius:"16px",padding:"30px",width:"90%",maxWidth:"500px"},children:[i.jsx("h3",{style:{marginBottom:"20px",color:"#333"},children:r.addMilestone}),i.jsxs("div",{style:{marginBottom:"16px"},children:[i.jsx("label",{style:{display:"block",marginBottom:"8px",color:"#666"},children:"標題"}),i.jsx("input",{type:"text",value:B.title,onChange:pe=>q(de=>({...de,title:pe.target.value})),style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid #ddd",fontSize:"14px"},placeholder:"輸入里程碑標題"})]}),i.jsxs("div",{style:{marginBottom:"16px"},children:[i.jsx("label",{style:{display:"block",marginBottom:"8px",color:"#666"},children:"描述"}),i.jsx("textarea",{value:B.description,onChange:pe=>q(de=>({...de,description:pe.target.value})),style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid #ddd",fontSize:"14px",minHeight:"100px",resize:"vertical"},placeholder:"輸入里程碑描述"})]}),i.jsxs("div",{style:{marginBottom:"20px"},children:[i.jsx("label",{style:{display:"block",marginBottom:"8px",color:"#666"},children:"類型"}),i.jsxs("select",{value:B.type,onChange:pe=>q(de=>({...de,type:pe.target.value})),style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid #ddd",fontSize:"14px"},children:[i.jsx("option",{value:"start",children:r.milestoneTypes.start}),i.jsx("option",{value:"achievement",children:r.milestoneTypes.achievement}),i.jsx("option",{value:"growth",children:r.milestoneTypes.growth}),i.jsx("option",{value:"habit",children:r.milestoneTypes.habit}),i.jsx("option",{value:"help",children:r.milestoneTypes.help}),i.jsx("option",{value:"goal",children:r.milestoneTypes.goal}),i.jsx("option",{value:"social",children:r.milestoneTypes.social})]})]}),i.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"flex-end"},children:[i.jsx("button",{onClick:()=>g(!1),style:{background:"#f5f5f5",border:"none",borderRadius:"8px",padding:"12px 24px",color:"#666",cursor:"pointer",fontSize:"14px"},children:r.cancel}),i.jsx("button",{onClick:He,style:{background:"linear-gradient(45deg, #4CAF50, #8BC34A)",border:"none",borderRadius:"8px",padding:"12px 24px",color:"white",cursor:"pointer",fontSize:"14px",fontWeight:"600"},children:r.save})]})]})}),j&&O&&i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:i.jsxs("div",{style:{background:"white",borderRadius:"16px",padding:"30px",width:"90%",maxWidth:"500px",textAlign:"center"},children:[i.jsx("h3",{style:{marginBottom:"20px",color:"#333"},children:"語音里程碑"}),i.jsxs("div",{style:{marginBottom:"20px"},children:[i.jsxs("p",{style:{color:"#666",marginBottom:"10px"},children:["錄音時長: ",Math.floor(O.duration/60),":",(O.duration%60).toString().padStart(2,"0")]}),i.jsx("audio",{controls:!0,style:{width:"100%",marginBottom:"20px"},src:URL.createObjectURL(O.blob)})]}),i.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"center"},children:[i.jsx("button",{onClick:H,style:{background:"#f5f5f5",border:"none",borderRadius:"8px",padding:"12px 24px",color:"#666",cursor:"pointer",fontSize:"14px",fontWeight:"600"},children:"取消"}),i.jsx("button",{onClick:re,style:{background:"linear-gradient(45deg, #4CAF50, #8BC34A)",border:"none",borderRadius:"8px",padding:"12px 24px",color:"white",cursor:"pointer",fontSize:"14px",fontWeight:"600"},children:"送出"})]})]})}),X&&i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:i.jsxs("div",{style:{background:"white",borderRadius:"16px",padding:"30px",width:"90%",maxWidth:"500px",textAlign:"center"},children:[i.jsx("div",{style:{fontSize:"48px",marginBottom:"20px"},children:"🎤"}),i.jsx("h3",{style:{marginBottom:"16px",color:"#333",fontSize:"20px",fontWeight:"600"},children:"準備開始錄音"}),i.jsxs("p",{style:{marginBottom:"20px",color:"#666",fontSize:"16px",lineHeight:"1.5"},children:["點擊「開始錄音」後，系統將開始錄製您的語音里程碑。",i.jsx("br",{}),i.jsx("strong",{style:{color:"#ff6b6b"},children:"⚠️ 錄音時間限制為1分鐘"})]}),i.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"center"},children:[i.jsx("button",{onClick:K,style:{background:"#f5f5f5",border:"none",borderRadius:"8px",padding:"12px 24px",color:"#666",cursor:"pointer",fontSize:"14px",fontWeight:"500"},children:"取消"}),i.jsx("button",{onClick:Be,style:{background:"linear-gradient(45deg, #4CAF50, #8BC34A)",border:"none",borderRadius:"8px",padding:"12px 24px",color:"white",cursor:"pointer",fontSize:"14px",fontWeight:"600",boxShadow:"0 4px 12px rgba(76, 175, 80, 0.3)"},children:"開始錄音"})]})]})}),F&&i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:i.jsxs("div",{style:{background:"white",borderRadius:"16px",padding:"30px",width:"90%",maxWidth:"500px"},children:[i.jsx("h3",{style:{marginBottom:"20px",color:"#333"},children:r.editMilestone}),i.jsxs("div",{style:{marginBottom:"16px"},children:[i.jsx("label",{style:{display:"block",marginBottom:"8px",color:"#666"},children:"標題"}),i.jsx("input",{type:"text",value:B.title,onChange:pe=>q(de=>({...de,title:pe.target.value})),style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid #ddd",fontSize:"14px"}})]}),i.jsxs("div",{style:{marginBottom:"16px"},children:[i.jsx("label",{style:{display:"block",marginBottom:"8px",color:"#666"},children:"描述"}),i.jsx("textarea",{value:B.description,onChange:pe=>q(de=>({...de,description:pe.target.value})),style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid #ddd",fontSize:"14px",minHeight:"100px",resize:"vertical"}})]}),i.jsxs("div",{style:{marginBottom:"20px"},children:[i.jsx("label",{style:{display:"block",marginBottom:"8px",color:"#666"},children:"類型"}),i.jsxs("select",{value:B.type,onChange:pe=>q(de=>({...de,type:pe.target.value})),style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid #ddd",fontSize:"14px"},children:[i.jsx("option",{value:"start",children:r.milestoneTypes.start}),i.jsx("option",{value:"achievement",children:r.milestoneTypes.achievement}),i.jsx("option",{value:"growth",children:r.milestoneTypes.growth}),i.jsx("option",{value:"habit",children:r.milestoneTypes.habit}),i.jsx("option",{value:"help",children:r.milestoneTypes.help}),i.jsx("option",{value:"goal",children:r.milestoneTypes.goal}),i.jsx("option",{value:"social",children:r.milestoneTypes.social})]})]}),i.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"flex-end"},children:[i.jsx("button",{onClick:()=>P(null),style:{background:"#f5f5f5",border:"none",borderRadius:"8px",padding:"12px 24px",color:"#666",cursor:"pointer",fontSize:"14px"},children:r.cancel}),i.jsx("button",{onClick:Te,style:{background:"linear-gradient(45deg, #4CAF50, #8BC34A)",border:"none",borderRadius:"8px",padding:"12px 24px",color:"white",cursor:"pointer",fontSize:"14px",fontWeight:"600"},children:r.save})]})]})}),Ne&&Ve&&i.jsx(Ms,{isOpen:Ne,onClose:at,currentPlan:Ve.currentPlan,remainingDays:Ve.remainingDays,usedTokens:Ve.usedTokens,totalTokens:Ve.totalTokens}),it&&i.jsx(qj,{isOpen:it,onClose:()=>me(!1),featureName:"語音錄製功能"}),x&&i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:i.jsxs("div",{style:{background:"white",borderRadius:"16px",padding:"30px",width:"90%",maxWidth:"600px",maxHeight:"80vh",overflowY:"auto"},children:[i.jsx("h3",{style:{marginBottom:"20px",color:"#333",textAlign:"center"},children:r.socialIntegrationTitle}),i.jsx("p",{style:{marginBottom:"24px",color:"#666",textAlign:"center",lineHeight:"1.5"},children:r.socialIntegrationDesc}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"20px"},children:[i.jsxs("div",{children:[i.jsx("label",{style:{display:"block",marginBottom:"8px",color:"#333",fontWeight:"600"},children:r.socialIntegrationQuestions.q1}),i.jsxs("select",{value:Ue.q1,onChange:pe=>ue(de=>({...de,q1:pe.target.value})),style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid #ddd",fontSize:"14px"},children:[i.jsx("option",{value:"",children:"請選擇..."}),i.jsx("option",{value:"excellent",children:r.socialIntegrationOptions.excellent}),i.jsx("option",{value:"good",children:r.socialIntegrationOptions.good}),i.jsx("option",{value:"fair",children:r.socialIntegrationOptions.fair}),i.jsx("option",{value:"poor",children:r.socialIntegrationOptions.poor})]})]}),i.jsxs("div",{children:[i.jsx("label",{style:{display:"block",marginBottom:"8px",color:"#333",fontWeight:"600"},children:r.socialIntegrationQuestions.q2}),i.jsxs("select",{value:Ue.q2,onChange:pe=>ue(de=>({...de,q2:pe.target.value})),style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid #ddd",fontSize:"14px"},children:[i.jsx("option",{value:"",children:"請選擇..."}),i.jsx("option",{value:"excellent",children:r.socialIntegrationOptions.excellent}),i.jsx("option",{value:"good",children:r.socialIntegrationOptions.good}),i.jsx("option",{value:"fair",children:r.socialIntegrationOptions.fair}),i.jsx("option",{value:"poor",children:r.socialIntegrationOptions.poor})]})]}),i.jsxs("div",{children:[i.jsx("label",{style:{display:"block",marginBottom:"8px",color:"#333",fontWeight:"600"},children:r.socialIntegrationQuestions.q3}),i.jsxs("select",{value:Ue.q3,onChange:pe=>ue(de=>({...de,q3:pe.target.value})),style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid #ddd",fontSize:"14px"},children:[i.jsx("option",{value:"",children:"請選擇..."}),i.jsx("option",{value:"excellent",children:r.socialIntegrationOptions.excellent}),i.jsx("option",{value:"good",children:r.socialIntegrationOptions.good}),i.jsx("option",{value:"fair",children:r.socialIntegrationOptions.fair}),i.jsx("option",{value:"poor",children:r.socialIntegrationOptions.poor})]})]}),i.jsxs("div",{children:[i.jsx("label",{style:{display:"block",marginBottom:"8px",color:"#333",fontWeight:"600"},children:r.socialIntegrationQuestions.q4}),i.jsxs("select",{value:Ue.q4,onChange:pe=>ue(de=>({...de,q4:pe.target.value})),style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid #ddd",fontSize:"14px"},children:[i.jsx("option",{value:"",children:"請選擇..."}),i.jsx("option",{value:"excellent",children:r.socialIntegrationOptions.excellent}),i.jsx("option",{value:"good",children:r.socialIntegrationOptions.good}),i.jsx("option",{value:"fair",children:r.socialIntegrationOptions.fair}),i.jsx("option",{value:"poor",children:r.socialIntegrationOptions.poor})]})]}),i.jsxs("div",{children:[i.jsx("label",{style:{display:"block",marginBottom:"8px",color:"#333",fontWeight:"600"},children:r.socialIntegrationQuestions.q5}),i.jsxs("select",{value:Ue.q5,onChange:pe=>ue(de=>({...de,q5:pe.target.value})),style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid #ddd",fontSize:"14px"},children:[i.jsx("option",{value:"",children:"請選擇..."}),i.jsx("option",{value:"excellent",children:r.socialIntegrationOptions.excellent}),i.jsx("option",{value:"good",children:r.socialIntegrationOptions.good}),i.jsx("option",{value:"fair",children:r.socialIntegrationOptions.fair}),i.jsx("option",{value:"poor",children:r.socialIntegrationOptions.poor})]})]})]}),i.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"center",marginTop:"24px"},children:[i.jsx("button",{onClick:()=>S(!1),style:{background:"#f5f5f5",border:"none",borderRadius:"8px",padding:"12px 24px",color:"#666",cursor:"pointer",fontSize:"14px"},children:r.cancel}),i.jsx("button",{onClick:Re,disabled:!Object.values(Ue).every(pe=>pe!==""),style:{background:Object.values(Ue).every(pe=>pe!=="")?"linear-gradient(45deg, #6B5BFF, #5A4FCF)":"#ccc",border:"none",borderRadius:"8px",padding:"12px 24px",color:"white",cursor:Object.values(Ue).every(pe=>pe!=="")?"pointer":"not-allowed",fontSize:"14px",fontWeight:"600"},children:"提交評估"})]})]})}),C&&I&&i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:i.jsxs("div",{style:{background:"white",borderRadius:"16px",padding:"30px",width:"90%",maxWidth:"600px",maxHeight:"80vh",overflowY:"auto"},children:[i.jsx("h3",{style:{marginBottom:"20px",color:"#333",textAlign:"center"},children:"📊 社會融入度評估報告"}),i.jsxs("div",{style:{background:"linear-gradient(135deg, #6B5BFF 0%, #5A4FCF 100%)",borderRadius:"12px",padding:"20px",color:"white",marginBottom:"20px",textAlign:"center"},children:[i.jsx("div",{style:{fontSize:"24px",fontWeight:"bold",marginBottom:"8px"},children:I.result}),i.jsxs("div",{style:{fontSize:"18px",marginBottom:"8px"},children:["總分：",I.score.toFixed(1),"/5.0"]}),i.jsx("div",{style:{fontSize:"14px",opacity:.9},children:I.description})]}),i.jsxs("div",{style:{marginBottom:"20px"},children:[i.jsx("h4",{style:{color:"#333",marginBottom:"12px",fontWeight:"600"},children:"📋 詳細分析"}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"8px",background:"#f8f9fa",borderRadius:"6px"},children:[i.jsx("span",{style:{color:"#666"},children:"人際關係"}),i.jsx("span",{style:{fontWeight:"600",color:"#6B5BFF"},children:I.details.relationships==="excellent"?"優秀":I.details.relationships==="good"?"良好":I.details.relationships==="fair"?"一般":"需要改善"})]}),i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"8px",background:"#f8f9fa",borderRadius:"6px"},children:[i.jsx("span",{style:{color:"#666"},children:"就業狀況"}),i.jsx("span",{style:{fontWeight:"600",color:"#6B5BFF"},children:I.details.employment==="excellent"?"優秀":I.details.employment==="good"?"良好":I.details.employment==="fair"?"一般":"需要改善"})]}),i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"8px",background:"#f8f9fa",borderRadius:"6px"},children:[i.jsx("span",{style:{color:"#666"},children:"家庭關係"}),i.jsx("span",{style:{fontWeight:"600",color:"#6B5BFF"},children:I.details.family==="excellent"?"優秀":I.details.family==="good"?"良好":I.details.family==="fair"?"一般":"需要改善"})]}),i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"8px",background:"#f8f9fa",borderRadius:"6px"},children:[i.jsx("span",{style:{color:"#666"},children:"未來信心"}),i.jsx("span",{style:{fontWeight:"600",color:"#6B5BFF"},children:I.details.confidence==="excellent"?"優秀":I.details.confidence==="good"?"良好":I.details.confidence==="fair"?"一般":"需要改善"})]}),i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"8px",background:"#f8f9fa",borderRadius:"6px"},children:[i.jsx("span",{style:{color:"#666"},children:"社會接納"}),i.jsx("span",{style:{fontWeight:"600",color:"#6B5BFF"},children:I.details.acceptance==="excellent"?"優秀":I.details.acceptance==="good"?"良好":I.details.acceptance==="fair"?"一般":"需要改善"})]})]})]}),i.jsxs("div",{style:{marginBottom:"20px"},children:[i.jsx("h4",{style:{color:"#333",marginBottom:"12px",fontWeight:"600"},children:"💡 改善建議"}),i.jsx("div",{style:{background:"#f8f9fa",borderRadius:"8px",padding:"16px"},children:I.recommendations.map((pe,de)=>i.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:"8px",marginBottom:"8px",fontSize:"14px",lineHeight:"1.4"},children:[i.jsx("span",{style:{color:"#6B5BFF",fontWeight:"bold"},children:"•"}),i.jsx("span",{style:{color:"#333"},children:pe})]},de))})]}),i.jsxs("div",{style:{background:"linear-gradient(135deg, #FF9800 0%, #F57C00 100%)",borderRadius:"8px",padding:"16px",marginBottom:"20px"},children:[i.jsx("h4",{style:{color:"white",marginBottom:"8px",fontWeight:"600"},children:"🎯 專業輔導建議"}),i.jsx("p",{style:{color:"white",fontSize:"14px",lineHeight:"1.4",margin:0},children:"基於您的評估結果，我們建議您考慮尋求專業輔導師的協助。專業輔導師可以為您提供個性化的改善計劃和持續的支持。"})]}),i.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"center"},children:[i.jsx("button",{onClick:()=>_(!1),style:{background:"#f5f5f5",border:"none",borderRadius:"8px",padding:"12px 24px",color:"#666",cursor:"pointer",fontSize:"14px"},children:"關閉報告"}),i.jsx("button",{onClick:()=>{_(!1),alert("功能開發中：聯繫專業輔導師")},style:{background:"linear-gradient(45deg, #6B5BFF, #5A4FCF)",border:"none",borderRadius:"8px",padding:"12px 24px",color:"white",cursor:"pointer",fontSize:"14px",fontWeight:"600"},children:"聯繫輔導師"})]})]})}),window.innerWidth<=768?i.jsxs("footer",{style:{textAlign:"center",fontSize:12,color:"#888",marginTop:20,padding:12,background:"rgba(255,255,255,0.95)",borderTop:"1px solid #eee",display:"flex",flexDirection:"column",gap:8},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:16,flexWrap:"wrap"},children:[i.jsx("a",{href:"/privacy-policy",style:{color:"#6B5BFF",textDecoration:"underline",fontSize:11},children:e==="zh-TW"?"隱私權政策":e==="zh-CN"?"隐私政策":e==="en"?"Privacy Policy":e==="ja"?"プライバシーポリシー":e==="ko"?"개인정보 처리방침":e==="th"?"นโยบายความเป็นส่วนตัว":e==="vi"?"Chính sách bảo mật":e==="ms"?"Dasar Privasi":"Consilium de Privata"}),i.jsx("a",{href:"/terms",style:{color:"#6B5BFF",textDecoration:"underline",fontSize:11},children:e==="zh-TW"?"條款/聲明":e==="zh-CN"?"条款/声明":e==="en"?"Terms/Statement":e==="ja"?"規約/声明":e==="ko"?"약관/성명":e==="th"?"ข้อกำหนด/แถลงการณ์":e==="vi"?"Điều khoản/Tuyên bố":e==="ms"?"Terma/Pernyataan":"Termini/Declaratio"}),i.jsx("a",{href:"/data-deletion",style:{color:"#6B5BFF",textDecoration:"underline",fontSize:11},children:e==="zh-TW"?"資料刪除說明":e==="zh-CN"?"数据删除说明":e==="en"?"Data Deletion":e==="ja"?"データ削除について":e==="ko"?"데이터 삭제 안내":e==="th"?"คำอธิบายการลบข้อมูล":e==="vi"?"Giải thích xóa dữ liệu":e==="ms"?"Penjelasan Penghapusan Data":"Explicatio Deletionis Datae"})]}),i.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:16,flexWrap:"wrap"},children:[i.jsx("a",{href:"/about",style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:600,fontSize:11},children:e==="zh-TW"?"🧬 我們是誰":e==="zh-CN"?"🧬 我们是谁":e==="en"?"🧬 Who We Are":e==="ja"?"🧬 私たちについて":e==="ko"?"🧬 우리는 누구인가":e==="th"?"🧬 เราเป็นใคร":e==="vi"?"🧬 Chúng tôi là ai":e==="ms"?"🧬 Siapa Kami":"🧬 Quis sumus"}),i.jsx("a",{href:"/feedback",style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:600,fontSize:11},children:e==="zh-TW"?"💬 意見箱":e==="zh-CN"?"💬 意见箱":e==="en"?"💬 Feedback":e==="ja"?"💬 ご意見箱":e==="ko"?"💬 피드백":e==="th"?"💬 กล่องความคิดเห็น":e==="vi"?"💬 Hộp góp ý":e==="ms"?"💬 Kotak Maklum Balas":"💬 Arca Consilii"})]})]}):i.jsx("div",{style:{width:"100%",margin:"0 auto",marginTop:24,background:"rgba(255,255,255,0.95)",borderRadius:16,padding:"16px",boxShadow:"0 2px 12px #6B5BFF22"},children:i.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:20,flexWrap:"wrap"},children:[i.jsx("a",{href:"/privacy-policy",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12},children:e==="zh-TW"?"隱私權政策":e==="zh-CN"?"隐私政策":e==="en"?"Privacy Policy":e==="ja"?"プライバシーポリシー":e==="ko"?"개인정보 처리방침":e==="th"?"นโยบายความเป็นส่วนตัว":e==="vi"?"Chính sách bảo mật":e==="ms"?"Dasar Privasi":"Consilium de Privata"}),i.jsx("a",{href:"/terms",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12},children:e==="zh-TW"?"條款/聲明":e==="zh-CN"?"条款/声明":e==="en"?"Terms/Statement":e==="ja"?"規約/声明":e==="ko"?"약관/성명":e==="th"?"ข้อกำหนด/แถลงการณ์":e==="vi"?"Điều khoản/Tuyên bố":e==="ms"?"Terma/Pernyataan":"Termini/Declaratio"}),i.jsx("a",{href:"/data-deletion",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12},children:e==="zh-TW"?"資料刪除說明":e==="zh-CN"?"数据删除说明":e==="en"?"Data Deletion":e==="ja"?"データ削除について":e==="ko"?"데이터 삭제 안내":e==="th"?"คำอธิบายการลบข้อมูล":e==="vi"?"Giải thích xóa dữ liệu":e==="ms"?"Penjelasan Penghapusan Data":"Explicatio Deletionis Datae"}),i.jsx("a",{href:"/about",style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12},children:e==="zh-TW"?"🧬 Restarter™｜我們是誰":e==="zh-CN"?"🧬 Restarter™｜我们是谁":e==="en"?"🧬 Restarter™｜Who We Are":e==="ja"?"🧬 Restarter™｜私たちについて":e==="ko"?"🧬 Restarter™｜우리는 누구인가":e==="th"?"🧬 Restarter™｜เราเป็นใคร":e==="vi"?"🧬 Restarter™｜Chúng tôi là ai":e==="ms"?"🧬 Restarter™｜Siapa Kami":"🧬 Restarter™｜Quis sumus"}),i.jsx("a",{href:"/feedback",style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12},children:e==="zh-TW"?"💬 意見箱｜我們想聽你說":e==="zh-CN"?"💬 意见箱｜我们想听你说":e==="en"?"💬 Feedback Box｜We Want to Hear From You":e==="ja"?"💬 ご意見箱｜私たちはあなたの声を聞きたい":e==="ko"?"💬 피드백｜우리는 당신의 말을 듣고 싶습니다":e==="th"?"💬 กล่องความคิดเห็น｜เราอยากได้ยินจากคุณ":e==="vi"?"💬 Hộp góp ý｜Chúng tôi muốn nghe từ bạn":e==="ms"?"💬 Kotak Maklum Balas｜Kami Ingin Mendengar Dari Anda":"💬 Arca Consilii｜Volumus Audire a Te"})]})})]})}const RD={male:"/avatars/male.png",female:"/avatars/female.png"};function ED({avatar:n,videoUrl:e,audioUrl:t,isSpeaking:r,onAvatarChange:o,size:a=160}){const c=v.useRef(null),[d,h]=v.useState(!1),m=()=>{c.current&&(c.current.currentTime=0,c.current.play(),h(!0))},g=()=>h(!1),x=()=>n==="male"||n==="female"?RD[n]:n;return i.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",marginBottom:24},children:[i.jsxs("div",{style:{position:"relative",width:a,height:a,marginBottom:8},children:[e?i.jsx("video",{src:e,width:a,height:a,autoPlay:!0,muted:!0,loop:!0,style:{borderRadius:"50%",objectFit:"cover"}}):i.jsx("img",{src:x(),width:a,height:a,style:{borderRadius:"50%",objectFit:"cover",filter:r?"brightness(1.1)":"none"},alt:"avatar"}),o&&(n==="male"||n==="female")&&i.jsx("button",{onClick:()=>o(n==="male"?"female":"male"),style:{position:"absolute",right:8,bottom:8,background:"#fff",borderRadius:"50%",border:"none",width:36,height:36,cursor:"pointer",fontSize:18},children:"切換"})]}),t&&i.jsx("audio",{ref:c,src:t,onEnded:g}),t&&i.jsx("button",{onClick:m,style:{padding:"6px 18px",borderRadius:8,background:"#6c63ff",color:"#fff",border:"none",fontWeight:700,fontSize:16,marginTop:8},disabled:d,children:d?"播放中...":"播放語音"})]})}function Hj(n,e){return function(){return n.apply(e,arguments)}}const{toString:AD}=Object.prototype,{getPrototypeOf:M0}=Object,{iterator:Yf,toStringTag:$j}=Symbol,Xf=(n=>e=>{const t=AD.call(e);return n[t]||(n[t]=t.slice(8,-1).toLowerCase())})(Object.create(null)),xi=n=>(n=n.toLowerCase(),e=>Xf(e)===n),Jf=n=>e=>typeof e===n,{isArray:zc}=Array,cd=Jf("undefined");function PD(n){return n!==null&&!cd(n)&&n.constructor!==null&&!cd(n.constructor)&&Cr(n.constructor.isBuffer)&&n.constructor.isBuffer(n)}const Gj=xi("ArrayBuffer");function BD(n){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(n):e=n&&n.buffer&&Gj(n.buffer),e}const FD=Jf("string"),Cr=Jf("function"),Kj=Jf("number"),Zf=n=>n!==null&&typeof n=="object",zD=n=>n===!0||n===!1,Rp=n=>{if(Xf(n)!=="object")return!1;const e=M0(n);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!($j in n)&&!(Yf in n)},DD=xi("Date"),ND=xi("File"),MD=xi("Blob"),LD=xi("FileList"),OD=n=>Zf(n)&&Cr(n.pipe),WD=n=>{let e;return n&&(typeof FormData=="function"&&n instanceof FormData||Cr(n.append)&&((e=Xf(n))==="formdata"||e==="object"&&Cr(n.toString)&&n.toString()==="[object FormData]"))},VD=xi("URLSearchParams"),[UD,qD,HD,$D]=["ReadableStream","Request","Response","Headers"].map(xi),GD=n=>n.trim?n.trim():n.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Dd(n,e,{allOwnKeys:t=!1}={}){if(n===null||typeof n>"u")return;let r,o;if(typeof n!="object"&&(n=[n]),zc(n))for(r=0,o=n.length;r<o;r++)e.call(null,n[r],r,n);else{const a=t?Object.getOwnPropertyNames(n):Object.keys(n),c=a.length;let d;for(r=0;r<c;r++)d=a[r],e.call(null,n[d],d,n)}}function Qj(n,e){e=e.toLowerCase();const t=Object.keys(n);let r=t.length,o;for(;r-- >0;)if(o=t[r],e===o.toLowerCase())return o;return null}const xa=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,Yj=n=>!cd(n)&&n!==xa;function Yy(){const{caseless:n}=Yj(this)&&this||{},e={},t=(r,o)=>{const a=n&&Qj(e,o)||o;Rp(e[a])&&Rp(r)?e[a]=Yy(e[a],r):Rp(r)?e[a]=Yy({},r):zc(r)?e[a]=r.slice():e[a]=r};for(let r=0,o=arguments.length;r<o;r++)arguments[r]&&Dd(arguments[r],t);return e}const KD=(n,e,t,{allOwnKeys:r}={})=>(Dd(e,(o,a)=>{t&&Cr(o)?n[a]=Hj(o,t):n[a]=o},{allOwnKeys:r}),n),QD=n=>(n.charCodeAt(0)===65279&&(n=n.slice(1)),n),YD=(n,e,t,r)=>{n.prototype=Object.create(e.prototype,r),n.prototype.constructor=n,Object.defineProperty(n,"super",{value:e.prototype}),t&&Object.assign(n.prototype,t)},XD=(n,e,t,r)=>{let o,a,c;const d={};if(e=e||{},n==null)return e;do{for(o=Object.getOwnPropertyNames(n),a=o.length;a-- >0;)c=o[a],(!r||r(c,n,e))&&!d[c]&&(e[c]=n[c],d[c]=!0);n=t!==!1&&M0(n)}while(n&&(!t||t(n,e))&&n!==Object.prototype);return e},JD=(n,e,t)=>{n=String(n),(t===void 0||t>n.length)&&(t=n.length),t-=e.length;const r=n.indexOf(e,t);return r!==-1&&r===t},ZD=n=>{if(!n)return null;if(zc(n))return n;let e=n.length;if(!Kj(e))return null;const t=new Array(e);for(;e-- >0;)t[e]=n[e];return t},e8=(n=>e=>n&&e instanceof n)(typeof Uint8Array<"u"&&M0(Uint8Array)),t8=(n,e)=>{const r=(n&&n[Yf]).call(n);let o;for(;(o=r.next())&&!o.done;){const a=o.value;e.call(n,a[0],a[1])}},n8=(n,e)=>{let t;const r=[];for(;(t=n.exec(e))!==null;)r.push(t);return r},r8=xi("HTMLFormElement"),i8=n=>n.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(t,r,o){return r.toUpperCase()+o}),kS=(({hasOwnProperty:n})=>(e,t)=>n.call(e,t))(Object.prototype),o8=xi("RegExp"),Xj=(n,e)=>{const t=Object.getOwnPropertyDescriptors(n),r={};Dd(t,(o,a)=>{let c;(c=e(o,a,n))!==!1&&(r[a]=c||o)}),Object.defineProperties(n,r)},s8=n=>{Xj(n,(e,t)=>{if(Cr(n)&&["arguments","caller","callee"].indexOf(t)!==-1)return!1;const r=n[t];if(Cr(r)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+t+"'")})}})},a8=(n,e)=>{const t={},r=o=>{o.forEach(a=>{t[a]=!0})};return zc(n)?r(n):r(String(n).split(e)),t},l8=()=>{},c8=(n,e)=>n!=null&&Number.isFinite(n=+n)?n:e;function u8(n){return!!(n&&Cr(n.append)&&n[$j]==="FormData"&&n[Yf])}const d8=n=>{const e=new Array(10),t=(r,o)=>{if(Zf(r)){if(e.indexOf(r)>=0)return;if(!("toJSON"in r)){e[o]=r;const a=zc(r)?[]:{};return Dd(r,(c,d)=>{const h=t(c,o+1);!cd(h)&&(a[d]=h)}),e[o]=void 0,a}}return r};return t(n,0)},h8=xi("AsyncFunction"),p8=n=>n&&(Zf(n)||Cr(n))&&Cr(n.then)&&Cr(n.catch),Jj=((n,e)=>n?setImmediate:e?((t,r)=>(xa.addEventListener("message",({source:o,data:a})=>{o===xa&&a===t&&r.length&&r.shift()()},!1),o=>{r.push(o),xa.postMessage(t,"*")}))(`axios@${Math.random()}`,[]):t=>setTimeout(t))(typeof setImmediate=="function",Cr(xa.postMessage)),f8=typeof queueMicrotask<"u"?queueMicrotask.bind(xa):typeof process<"u"&&process.nextTick||Jj,m8=n=>n!=null&&Cr(n[Yf]),ve={isArray:zc,isArrayBuffer:Gj,isBuffer:PD,isFormData:WD,isArrayBufferView:BD,isString:FD,isNumber:Kj,isBoolean:zD,isObject:Zf,isPlainObject:Rp,isReadableStream:UD,isRequest:qD,isResponse:HD,isHeaders:$D,isUndefined:cd,isDate:DD,isFile:ND,isBlob:MD,isRegExp:o8,isFunction:Cr,isStream:OD,isURLSearchParams:VD,isTypedArray:e8,isFileList:LD,forEach:Dd,merge:Yy,extend:KD,trim:GD,stripBOM:QD,inherits:YD,toFlatObject:XD,kindOf:Xf,kindOfTest:xi,endsWith:JD,toArray:ZD,forEachEntry:t8,matchAll:n8,isHTMLForm:r8,hasOwnProperty:kS,hasOwnProp:kS,reduceDescriptors:Xj,freezeMethods:s8,toObjectSet:a8,toCamelCase:i8,noop:l8,toFiniteNumber:c8,findKey:Qj,global:xa,isContextDefined:Yj,isSpecCompliantForm:u8,toJSONObject:d8,isAsyncFn:h8,isThenable:p8,setImmediate:Jj,asap:f8,isIterable:m8};function vt(n,e,t,r,o){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=n,this.name="AxiosError",e&&(this.code=e),t&&(this.config=t),r&&(this.request=r),o&&(this.response=o,this.status=o.status?o.status:null)}ve.inherits(vt,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:ve.toJSONObject(this.config),code:this.code,status:this.status}}});const Zj=vt.prototype,eI={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(n=>{eI[n]={value:n}});Object.defineProperties(vt,eI);Object.defineProperty(Zj,"isAxiosError",{value:!0});vt.from=(n,e,t,r,o,a)=>{const c=Object.create(Zj);return ve.toFlatObject(n,c,function(h){return h!==Error.prototype},d=>d!=="isAxiosError"),vt.call(c,n.message,e,t,r,o),c.cause=n,c.name=n.name,a&&Object.assign(c,a),c};const g8=null;function Xy(n){return ve.isPlainObject(n)||ve.isArray(n)}function tI(n){return ve.endsWith(n,"[]")?n.slice(0,-2):n}function TS(n,e,t){return n?n.concat(e).map(function(o,a){return o=tI(o),!t&&a?"["+o+"]":o}).join(t?".":""):e}function y8(n){return ve.isArray(n)&&!n.some(Xy)}const x8=ve.toFlatObject(ve,{},null,function(e){return/^is[A-Z]/.test(e)});function em(n,e,t){if(!ve.isObject(n))throw new TypeError("target must be an object");e=e||new FormData,t=ve.toFlatObject(t,{metaTokens:!0,dots:!1,indexes:!1},!1,function(I,T){return!ve.isUndefined(T[I])});const r=t.metaTokens,o=t.visitor||g,a=t.dots,c=t.indexes,h=(t.Blob||typeof Blob<"u"&&Blob)&&ve.isSpecCompliantForm(e);if(!ve.isFunction(o))throw new TypeError("visitor must be a function");function m(_){if(_===null)return"";if(ve.isDate(_))return _.toISOString();if(ve.isBoolean(_))return _.toString();if(!h&&ve.isBlob(_))throw new vt("Blob is not supported. Use a Buffer instead.");return ve.isArrayBuffer(_)||ve.isTypedArray(_)?h&&typeof Blob=="function"?new Blob([_]):Buffer.from(_):_}function g(_,I,T){let F=_;if(_&&!T&&typeof _=="object"){if(ve.endsWith(I,"{}"))I=r?I:I.slice(0,-2),_=JSON.stringify(_);else if(ve.isArray(_)&&y8(_)||(ve.isFileList(_)||ve.endsWith(I,"[]"))&&(F=ve.toArray(_)))return I=tI(I),F.forEach(function(B,q){!(ve.isUndefined(B)||B===null)&&e.append(c===!0?TS([I],q,a):c===null?I:I+"[]",m(B))}),!1}return Xy(_)?!0:(e.append(TS(T,I,a),m(_)),!1)}const x=[],S=Object.assign(x8,{defaultVisitor:g,convertValue:m,isVisitable:Xy});function C(_,I){if(!ve.isUndefined(_)){if(x.indexOf(_)!==-1)throw Error("Circular reference detected in "+I.join("."));x.push(_),ve.forEach(_,function(F,P){(!(ve.isUndefined(F)||F===null)&&o.call(e,F,ve.isString(P)?P.trim():P,I,S))===!0&&C(F,I?I.concat(P):[P])}),x.pop()}}if(!ve.isObject(n))throw new TypeError("data must be an object");return C(n),e}function _S(n){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(n).replace(/[!'()~]|%20|%00/g,function(r){return e[r]})}function L0(n,e){this._pairs=[],n&&em(n,this,e)}const nI=L0.prototype;nI.append=function(e,t){this._pairs.push([e,t])};nI.toString=function(e){const t=e?function(r){return e.call(this,r,_S)}:_S;return this._pairs.map(function(o){return t(o[0])+"="+t(o[1])},"").join("&")};function b8(n){return encodeURIComponent(n).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function rI(n,e,t){if(!e)return n;const r=t&&t.encode||b8;ve.isFunction(t)&&(t={serialize:t});const o=t&&t.serialize;let a;if(o?a=o(e,t):a=ve.isURLSearchParams(e)?e.toString():new L0(e,t).toString(r),a){const c=n.indexOf("#");c!==-1&&(n=n.slice(0,c)),n+=(n.indexOf("?")===-1?"?":"&")+a}return n}class jS{constructor(){this.handlers=[]}use(e,t,r){return this.handlers.push({fulfilled:e,rejected:t,synchronous:r?r.synchronous:!1,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){ve.forEach(this.handlers,function(r){r!==null&&e(r)})}}const iI={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},v8=typeof URLSearchParams<"u"?URLSearchParams:L0,w8=typeof FormData<"u"?FormData:null,S8=typeof Blob<"u"?Blob:null,k8={isBrowser:!0,classes:{URLSearchParams:v8,FormData:w8,Blob:S8},protocols:["http","https","file","blob","url","data"]},O0=typeof window<"u"&&typeof document<"u",Jy=typeof navigator=="object"&&navigator||void 0,T8=O0&&(!Jy||["ReactNative","NativeScript","NS"].indexOf(Jy.product)<0),_8=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",j8=O0&&window.location.href||"http://localhost",I8=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:O0,hasStandardBrowserEnv:T8,hasStandardBrowserWebWorkerEnv:_8,navigator:Jy,origin:j8},Symbol.toStringTag,{value:"Module"})),rr={...I8,...k8};function C8(n,e){return em(n,new rr.classes.URLSearchParams,Object.assign({visitor:function(t,r,o,a){return rr.isNode&&ve.isBuffer(t)?(this.append(r,t.toString("base64")),!1):a.defaultVisitor.apply(this,arguments)}},e))}function R8(n){return ve.matchAll(/\w+|\[(\w*)]/g,n).map(e=>e[0]==="[]"?"":e[1]||e[0])}function E8(n){const e={},t=Object.keys(n);let r;const o=t.length;let a;for(r=0;r<o;r++)a=t[r],e[a]=n[a];return e}function oI(n){function e(t,r,o,a){let c=t[a++];if(c==="__proto__")return!0;const d=Number.isFinite(+c),h=a>=t.length;return c=!c&&ve.isArray(o)?o.length:c,h?(ve.hasOwnProp(o,c)?o[c]=[o[c],r]:o[c]=r,!d):((!o[c]||!ve.isObject(o[c]))&&(o[c]=[]),e(t,r,o[c],a)&&ve.isArray(o[c])&&(o[c]=E8(o[c])),!d)}if(ve.isFormData(n)&&ve.isFunction(n.entries)){const t={};return ve.forEachEntry(n,(r,o)=>{e(R8(r),o,t,0)}),t}return null}function A8(n,e,t){if(ve.isString(n))try{return(e||JSON.parse)(n),ve.trim(n)}catch(r){if(r.name!=="SyntaxError")throw r}return(t||JSON.stringify)(n)}const Nd={transitional:iI,adapter:["xhr","http","fetch"],transformRequest:[function(e,t){const r=t.getContentType()||"",o=r.indexOf("application/json")>-1,a=ve.isObject(e);if(a&&ve.isHTMLForm(e)&&(e=new FormData(e)),ve.isFormData(e))return o?JSON.stringify(oI(e)):e;if(ve.isArrayBuffer(e)||ve.isBuffer(e)||ve.isStream(e)||ve.isFile(e)||ve.isBlob(e)||ve.isReadableStream(e))return e;if(ve.isArrayBufferView(e))return e.buffer;if(ve.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let d;if(a){if(r.indexOf("application/x-www-form-urlencoded")>-1)return C8(e,this.formSerializer).toString();if((d=ve.isFileList(e))||r.indexOf("multipart/form-data")>-1){const h=this.env&&this.env.FormData;return em(d?{"files[]":e}:e,h&&new h,this.formSerializer)}}return a||o?(t.setContentType("application/json",!1),A8(e)):e}],transformResponse:[function(e){const t=this.transitional||Nd.transitional,r=t&&t.forcedJSONParsing,o=this.responseType==="json";if(ve.isResponse(e)||ve.isReadableStream(e))return e;if(e&&ve.isString(e)&&(r&&!this.responseType||o)){const c=!(t&&t.silentJSONParsing)&&o;try{return JSON.parse(e)}catch(d){if(c)throw d.name==="SyntaxError"?vt.from(d,vt.ERR_BAD_RESPONSE,this,null,this.response):d}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:rr.classes.FormData,Blob:rr.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};ve.forEach(["delete","get","head","post","put","patch"],n=>{Nd.headers[n]={}});const P8=ve.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),B8=n=>{const e={};let t,r,o;return n&&n.split(`
`).forEach(function(c){o=c.indexOf(":"),t=c.substring(0,o).trim().toLowerCase(),r=c.substring(o+1).trim(),!(!t||e[t]&&P8[t])&&(t==="set-cookie"?e[t]?e[t].push(r):e[t]=[r]:e[t]=e[t]?e[t]+", "+r:r)}),e},IS=Symbol("internals");function _u(n){return n&&String(n).trim().toLowerCase()}function Ep(n){return n===!1||n==null?n:ve.isArray(n)?n.map(Ep):String(n)}function F8(n){const e=Object.create(null),t=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=t.exec(n);)e[r[1]]=r[2];return e}const z8=n=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(n.trim());function Zg(n,e,t,r,o){if(ve.isFunction(r))return r.call(this,e,t);if(o&&(e=t),!!ve.isString(e)){if(ve.isString(r))return e.indexOf(r)!==-1;if(ve.isRegExp(r))return r.test(e)}}function D8(n){return n.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,t,r)=>t.toUpperCase()+r)}function N8(n,e){const t=ve.toCamelCase(" "+e);["get","set","has"].forEach(r=>{Object.defineProperty(n,r+t,{value:function(o,a,c){return this[r].call(this,e,o,a,c)},configurable:!0})})}let Rr=class{constructor(e){e&&this.set(e)}set(e,t,r){const o=this;function a(d,h,m){const g=_u(h);if(!g)throw new Error("header name must be a non-empty string");const x=ve.findKey(o,g);(!x||o[x]===void 0||m===!0||m===void 0&&o[x]!==!1)&&(o[x||h]=Ep(d))}const c=(d,h)=>ve.forEach(d,(m,g)=>a(m,g,h));if(ve.isPlainObject(e)||e instanceof this.constructor)c(e,t);else if(ve.isString(e)&&(e=e.trim())&&!z8(e))c(B8(e),t);else if(ve.isObject(e)&&ve.isIterable(e)){let d={},h,m;for(const g of e){if(!ve.isArray(g))throw TypeError("Object iterator must return a key-value pair");d[m=g[0]]=(h=d[m])?ve.isArray(h)?[...h,g[1]]:[h,g[1]]:g[1]}c(d,t)}else e!=null&&a(t,e,r);return this}get(e,t){if(e=_u(e),e){const r=ve.findKey(this,e);if(r){const o=this[r];if(!t)return o;if(t===!0)return F8(o);if(ve.isFunction(t))return t.call(this,o,r);if(ve.isRegExp(t))return t.exec(o);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,t){if(e=_u(e),e){const r=ve.findKey(this,e);return!!(r&&this[r]!==void 0&&(!t||Zg(this,this[r],r,t)))}return!1}delete(e,t){const r=this;let o=!1;function a(c){if(c=_u(c),c){const d=ve.findKey(r,c);d&&(!t||Zg(r,r[d],d,t))&&(delete r[d],o=!0)}}return ve.isArray(e)?e.forEach(a):a(e),o}clear(e){const t=Object.keys(this);let r=t.length,o=!1;for(;r--;){const a=t[r];(!e||Zg(this,this[a],a,e,!0))&&(delete this[a],o=!0)}return o}normalize(e){const t=this,r={};return ve.forEach(this,(o,a)=>{const c=ve.findKey(r,a);if(c){t[c]=Ep(o),delete t[a];return}const d=e?D8(a):String(a).trim();d!==a&&delete t[a],t[d]=Ep(o),r[d]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const t=Object.create(null);return ve.forEach(this,(r,o)=>{r!=null&&r!==!1&&(t[o]=e&&ve.isArray(r)?r.join(", "):r)}),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,t])=>e+": "+t).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...t){const r=new this(e);return t.forEach(o=>r.set(o)),r}static accessor(e){const r=(this[IS]=this[IS]={accessors:{}}).accessors,o=this.prototype;function a(c){const d=_u(c);r[d]||(N8(o,c),r[d]=!0)}return ve.isArray(e)?e.forEach(a):a(e),this}};Rr.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);ve.reduceDescriptors(Rr.prototype,({value:n},e)=>{let t=e[0].toUpperCase()+e.slice(1);return{get:()=>n,set(r){this[t]=r}}});ve.freezeMethods(Rr);function ey(n,e){const t=this||Nd,r=e||t,o=Rr.from(r.headers);let a=r.data;return ve.forEach(n,function(d){a=d.call(t,a,o.normalize(),e?e.status:void 0)}),o.normalize(),a}function sI(n){return!!(n&&n.__CANCEL__)}function Dc(n,e,t){vt.call(this,n??"canceled",vt.ERR_CANCELED,e,t),this.name="CanceledError"}ve.inherits(Dc,vt,{__CANCEL__:!0});function aI(n,e,t){const r=t.config.validateStatus;!t.status||!r||r(t.status)?n(t):e(new vt("Request failed with status code "+t.status,[vt.ERR_BAD_REQUEST,vt.ERR_BAD_RESPONSE][Math.floor(t.status/100)-4],t.config,t.request,t))}function M8(n){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(n);return e&&e[1]||""}function L8(n,e){n=n||10;const t=new Array(n),r=new Array(n);let o=0,a=0,c;return e=e!==void 0?e:1e3,function(h){const m=Date.now(),g=r[a];c||(c=m),t[o]=h,r[o]=m;let x=a,S=0;for(;x!==o;)S+=t[x++],x=x%n;if(o=(o+1)%n,o===a&&(a=(a+1)%n),m-c<e)return;const C=g&&m-g;return C?Math.round(S*1e3/C):void 0}}function O8(n,e){let t=0,r=1e3/e,o,a;const c=(m,g=Date.now())=>{t=g,o=null,a&&(clearTimeout(a),a=null),n.apply(null,m)};return[(...m)=>{const g=Date.now(),x=g-t;x>=r?c(m,g):(o=m,a||(a=setTimeout(()=>{a=null,c(o)},r-x)))},()=>o&&c(o)]}const df=(n,e,t=3)=>{let r=0;const o=L8(50,250);return O8(a=>{const c=a.loaded,d=a.lengthComputable?a.total:void 0,h=c-r,m=o(h),g=c<=d;r=c;const x={loaded:c,total:d,progress:d?c/d:void 0,bytes:h,rate:m||void 0,estimated:m&&d&&g?(d-c)/m:void 0,event:a,lengthComputable:d!=null,[e?"download":"upload"]:!0};n(x)},t)},CS=(n,e)=>{const t=n!=null;return[r=>e[0]({lengthComputable:t,total:n,loaded:r}),e[1]]},RS=n=>(...e)=>ve.asap(()=>n(...e)),W8=rr.hasStandardBrowserEnv?((n,e)=>t=>(t=new URL(t,rr.origin),n.protocol===t.protocol&&n.host===t.host&&(e||n.port===t.port)))(new URL(rr.origin),rr.navigator&&/(msie|trident)/i.test(rr.navigator.userAgent)):()=>!0,V8=rr.hasStandardBrowserEnv?{write(n,e,t,r,o,a){const c=[n+"="+encodeURIComponent(e)];ve.isNumber(t)&&c.push("expires="+new Date(t).toGMTString()),ve.isString(r)&&c.push("path="+r),ve.isString(o)&&c.push("domain="+o),a===!0&&c.push("secure"),document.cookie=c.join("; ")},read(n){const e=document.cookie.match(new RegExp("(^|;\\s*)("+n+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove(n){this.write(n,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function U8(n){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(n)}function q8(n,e){return e?n.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):n}function lI(n,e,t){let r=!U8(e);return n&&(r||t==!1)?q8(n,e):e}const ES=n=>n instanceof Rr?{...n}:n;function Ma(n,e){e=e||{};const t={};function r(m,g,x,S){return ve.isPlainObject(m)&&ve.isPlainObject(g)?ve.merge.call({caseless:S},m,g):ve.isPlainObject(g)?ve.merge({},g):ve.isArray(g)?g.slice():g}function o(m,g,x,S){if(ve.isUndefined(g)){if(!ve.isUndefined(m))return r(void 0,m,x,S)}else return r(m,g,x,S)}function a(m,g){if(!ve.isUndefined(g))return r(void 0,g)}function c(m,g){if(ve.isUndefined(g)){if(!ve.isUndefined(m))return r(void 0,m)}else return r(void 0,g)}function d(m,g,x){if(x in e)return r(m,g);if(x in n)return r(void 0,m)}const h={url:a,method:a,data:a,baseURL:c,transformRequest:c,transformResponse:c,paramsSerializer:c,timeout:c,timeoutMessage:c,withCredentials:c,withXSRFToken:c,adapter:c,responseType:c,xsrfCookieName:c,xsrfHeaderName:c,onUploadProgress:c,onDownloadProgress:c,decompress:c,maxContentLength:c,maxBodyLength:c,beforeRedirect:c,transport:c,httpAgent:c,httpsAgent:c,cancelToken:c,socketPath:c,responseEncoding:c,validateStatus:d,headers:(m,g,x)=>o(ES(m),ES(g),x,!0)};return ve.forEach(Object.keys(Object.assign({},n,e)),function(g){const x=h[g]||o,S=x(n[g],e[g],g);ve.isUndefined(S)&&x!==d||(t[g]=S)}),t}const cI=n=>{const e=Ma({},n);let{data:t,withXSRFToken:r,xsrfHeaderName:o,xsrfCookieName:a,headers:c,auth:d}=e;e.headers=c=Rr.from(c),e.url=rI(lI(e.baseURL,e.url,e.allowAbsoluteUrls),n.params,n.paramsSerializer),d&&c.set("Authorization","Basic "+btoa((d.username||"")+":"+(d.password?unescape(encodeURIComponent(d.password)):"")));let h;if(ve.isFormData(t)){if(rr.hasStandardBrowserEnv||rr.hasStandardBrowserWebWorkerEnv)c.setContentType(void 0);else if((h=c.getContentType())!==!1){const[m,...g]=h?h.split(";").map(x=>x.trim()).filter(Boolean):[];c.setContentType([m||"multipart/form-data",...g].join("; "))}}if(rr.hasStandardBrowserEnv&&(r&&ve.isFunction(r)&&(r=r(e)),r||r!==!1&&W8(e.url))){const m=o&&a&&V8.read(a);m&&c.set(o,m)}return e},H8=typeof XMLHttpRequest<"u",$8=H8&&function(n){return new Promise(function(t,r){const o=cI(n);let a=o.data;const c=Rr.from(o.headers).normalize();let{responseType:d,onUploadProgress:h,onDownloadProgress:m}=o,g,x,S,C,_;function I(){C&&C(),_&&_(),o.cancelToken&&o.cancelToken.unsubscribe(g),o.signal&&o.signal.removeEventListener("abort",g)}let T=new XMLHttpRequest;T.open(o.method.toUpperCase(),o.url,!0),T.timeout=o.timeout;function F(){if(!T)return;const B=Rr.from("getAllResponseHeaders"in T&&T.getAllResponseHeaders()),te={data:!d||d==="text"||d==="json"?T.responseText:T.response,status:T.status,statusText:T.statusText,headers:B,config:n,request:T};aI(function(L){t(L),I()},function(L){r(L),I()},te),T=null}"onloadend"in T?T.onloadend=F:T.onreadystatechange=function(){!T||T.readyState!==4||T.status===0&&!(T.responseURL&&T.responseURL.indexOf("file:")===0)||setTimeout(F)},T.onabort=function(){T&&(r(new vt("Request aborted",vt.ECONNABORTED,n,T)),T=null)},T.onerror=function(){r(new vt("Network Error",vt.ERR_NETWORK,n,T)),T=null},T.ontimeout=function(){let q=o.timeout?"timeout of "+o.timeout+"ms exceeded":"timeout exceeded";const te=o.transitional||iI;o.timeoutErrorMessage&&(q=o.timeoutErrorMessage),r(new vt(q,te.clarifyTimeoutError?vt.ETIMEDOUT:vt.ECONNABORTED,n,T)),T=null},a===void 0&&c.setContentType(null),"setRequestHeader"in T&&ve.forEach(c.toJSON(),function(q,te){T.setRequestHeader(te,q)}),ve.isUndefined(o.withCredentials)||(T.withCredentials=!!o.withCredentials),d&&d!=="json"&&(T.responseType=o.responseType),m&&([S,_]=df(m,!0),T.addEventListener("progress",S)),h&&T.upload&&([x,C]=df(h),T.upload.addEventListener("progress",x),T.upload.addEventListener("loadend",C)),(o.cancelToken||o.signal)&&(g=B=>{T&&(r(!B||B.type?new Dc(null,n,T):B),T.abort(),T=null)},o.cancelToken&&o.cancelToken.subscribe(g),o.signal&&(o.signal.aborted?g():o.signal.addEventListener("abort",g)));const P=M8(o.url);if(P&&rr.protocols.indexOf(P)===-1){r(new vt("Unsupported protocol "+P+":",vt.ERR_BAD_REQUEST,n));return}T.send(a||null)})},G8=(n,e)=>{const{length:t}=n=n?n.filter(Boolean):[];if(e||t){let r=new AbortController,o;const a=function(m){if(!o){o=!0,d();const g=m instanceof Error?m:this.reason;r.abort(g instanceof vt?g:new Dc(g instanceof Error?g.message:g))}};let c=e&&setTimeout(()=>{c=null,a(new vt(`timeout ${e} of ms exceeded`,vt.ETIMEDOUT))},e);const d=()=>{n&&(c&&clearTimeout(c),c=null,n.forEach(m=>{m.unsubscribe?m.unsubscribe(a):m.removeEventListener("abort",a)}),n=null)};n.forEach(m=>m.addEventListener("abort",a));const{signal:h}=r;return h.unsubscribe=()=>ve.asap(d),h}},K8=function*(n,e){let t=n.byteLength;if(t<e){yield n;return}let r=0,o;for(;r<t;)o=r+e,yield n.slice(r,o),r=o},Q8=async function*(n,e){for await(const t of Y8(n))yield*K8(t,e)},Y8=async function*(n){if(n[Symbol.asyncIterator]){yield*n;return}const e=n.getReader();try{for(;;){const{done:t,value:r}=await e.read();if(t)break;yield r}}finally{await e.cancel()}},AS=(n,e,t,r)=>{const o=Q8(n,e);let a=0,c,d=h=>{c||(c=!0,r&&r(h))};return new ReadableStream({async pull(h){try{const{done:m,value:g}=await o.next();if(m){d(),h.close();return}let x=g.byteLength;if(t){let S=a+=x;t(S)}h.enqueue(new Uint8Array(g))}catch(m){throw d(m),m}},cancel(h){return d(h),o.return()}},{highWaterMark:2})},tm=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",uI=tm&&typeof ReadableStream=="function",X8=tm&&(typeof TextEncoder=="function"?(n=>e=>n.encode(e))(new TextEncoder):async n=>new Uint8Array(await new Response(n).arrayBuffer())),dI=(n,...e)=>{try{return!!n(...e)}catch{return!1}},J8=uI&&dI(()=>{let n=!1;const e=new Request(rr.origin,{body:new ReadableStream,method:"POST",get duplex(){return n=!0,"half"}}).headers.has("Content-Type");return n&&!e}),PS=64*1024,Zy=uI&&dI(()=>ve.isReadableStream(new Response("").body)),hf={stream:Zy&&(n=>n.body)};tm&&(n=>{["text","arrayBuffer","blob","formData","stream"].forEach(e=>{!hf[e]&&(hf[e]=ve.isFunction(n[e])?t=>t[e]():(t,r)=>{throw new vt(`Response type '${e}' is not supported`,vt.ERR_NOT_SUPPORT,r)})})})(new Response);const Z8=async n=>{if(n==null)return 0;if(ve.isBlob(n))return n.size;if(ve.isSpecCompliantForm(n))return(await new Request(rr.origin,{method:"POST",body:n}).arrayBuffer()).byteLength;if(ve.isArrayBufferView(n)||ve.isArrayBuffer(n))return n.byteLength;if(ve.isURLSearchParams(n)&&(n=n+""),ve.isString(n))return(await X8(n)).byteLength},eN=async(n,e)=>{const t=ve.toFiniteNumber(n.getContentLength());return t??Z8(e)},tN=tm&&(async n=>{let{url:e,method:t,data:r,signal:o,cancelToken:a,timeout:c,onDownloadProgress:d,onUploadProgress:h,responseType:m,headers:g,withCredentials:x="same-origin",fetchOptions:S}=cI(n);m=m?(m+"").toLowerCase():"text";let C=G8([o,a&&a.toAbortSignal()],c),_;const I=C&&C.unsubscribe&&(()=>{C.unsubscribe()});let T;try{if(h&&J8&&t!=="get"&&t!=="head"&&(T=await eN(g,r))!==0){let te=new Request(e,{method:"POST",body:r,duplex:"half"}),W;if(ve.isFormData(r)&&(W=te.headers.get("content-type"))&&g.setContentType(W),te.body){const[L,R]=CS(T,df(RS(h)));r=AS(te.body,PS,L,R)}}ve.isString(x)||(x=x?"include":"omit");const F="credentials"in Request.prototype;_=new Request(e,{...S,signal:C,method:t.toUpperCase(),headers:g.normalize().toJSON(),body:r,duplex:"half",credentials:F?x:void 0});let P=await fetch(_,S);const B=Zy&&(m==="stream"||m==="response");if(Zy&&(d||B&&I)){const te={};["status","statusText","headers"].forEach(A=>{te[A]=P[A]});const W=ve.toFiniteNumber(P.headers.get("content-length")),[L,R]=d&&CS(W,df(RS(d),!0))||[];P=new Response(AS(P.body,PS,L,()=>{R&&R(),I&&I()}),te)}m=m||"text";let q=await hf[ve.findKey(hf,m)||"text"](P,n);return!B&&I&&I(),await new Promise((te,W)=>{aI(te,W,{data:q,headers:Rr.from(P.headers),status:P.status,statusText:P.statusText,config:n,request:_})})}catch(F){throw I&&I(),F&&F.name==="TypeError"&&/Load failed|fetch/i.test(F.message)?Object.assign(new vt("Network Error",vt.ERR_NETWORK,n,_),{cause:F.cause||F}):vt.from(F,F&&F.code,n,_)}}),ex={http:g8,xhr:$8,fetch:tN};ve.forEach(ex,(n,e)=>{if(n){try{Object.defineProperty(n,"name",{value:e})}catch{}Object.defineProperty(n,"adapterName",{value:e})}});const BS=n=>`- ${n}`,nN=n=>ve.isFunction(n)||n===null||n===!1,hI={getAdapter:n=>{n=ve.isArray(n)?n:[n];const{length:e}=n;let t,r;const o={};for(let a=0;a<e;a++){t=n[a];let c;if(r=t,!nN(t)&&(r=ex[(c=String(t)).toLowerCase()],r===void 0))throw new vt(`Unknown adapter '${c}'`);if(r)break;o[c||"#"+a]=r}if(!r){const a=Object.entries(o).map(([d,h])=>`adapter ${d} `+(h===!1?"is not supported by the environment":"is not available in the build"));let c=e?a.length>1?`since :
`+a.map(BS).join(`
`):" "+BS(a[0]):"as no adapter specified";throw new vt("There is no suitable adapter to dispatch the request "+c,"ERR_NOT_SUPPORT")}return r},adapters:ex};function ty(n){if(n.cancelToken&&n.cancelToken.throwIfRequested(),n.signal&&n.signal.aborted)throw new Dc(null,n)}function FS(n){return ty(n),n.headers=Rr.from(n.headers),n.data=ey.call(n,n.transformRequest),["post","put","patch"].indexOf(n.method)!==-1&&n.headers.setContentType("application/x-www-form-urlencoded",!1),hI.getAdapter(n.adapter||Nd.adapter)(n).then(function(r){return ty(n),r.data=ey.call(n,n.transformResponse,r),r.headers=Rr.from(r.headers),r},function(r){return sI(r)||(ty(n),r&&r.response&&(r.response.data=ey.call(n,n.transformResponse,r.response),r.response.headers=Rr.from(r.response.headers))),Promise.reject(r)})}const pI="1.10.0",nm={};["object","boolean","number","function","string","symbol"].forEach((n,e)=>{nm[n]=function(r){return typeof r===n||"a"+(e<1?"n ":" ")+n}});const zS={};nm.transitional=function(e,t,r){function o(a,c){return"[Axios v"+pI+"] Transitional option '"+a+"'"+c+(r?". "+r:"")}return(a,c,d)=>{if(e===!1)throw new vt(o(c," has been removed"+(t?" in "+t:"")),vt.ERR_DEPRECATED);return t&&!zS[c]&&(zS[c]=!0,console.warn(o(c," has been deprecated since v"+t+" and will be removed in the near future"))),e?e(a,c,d):!0}};nm.spelling=function(e){return(t,r)=>(console.warn(`${r} is likely a misspelling of ${e}`),!0)};function rN(n,e,t){if(typeof n!="object")throw new vt("options must be an object",vt.ERR_BAD_OPTION_VALUE);const r=Object.keys(n);let o=r.length;for(;o-- >0;){const a=r[o],c=e[a];if(c){const d=n[a],h=d===void 0||c(d,a,n);if(h!==!0)throw new vt("option "+a+" must be "+h,vt.ERR_BAD_OPTION_VALUE);continue}if(t!==!0)throw new vt("Unknown option "+a,vt.ERR_BAD_OPTION)}}const Ap={assertOptions:rN,validators:nm},Ei=Ap.validators;let ka=class{constructor(e){this.defaults=e||{},this.interceptors={request:new jS,response:new jS}}async request(e,t){try{return await this._request(e,t)}catch(r){if(r instanceof Error){let o={};Error.captureStackTrace?Error.captureStackTrace(o):o=new Error;const a=o.stack?o.stack.replace(/^.+\n/,""):"";try{r.stack?a&&!String(r.stack).endsWith(a.replace(/^.+\n.+\n/,""))&&(r.stack+=`
`+a):r.stack=a}catch{}}throw r}}_request(e,t){typeof e=="string"?(t=t||{},t.url=e):t=e||{},t=Ma(this.defaults,t);const{transitional:r,paramsSerializer:o,headers:a}=t;r!==void 0&&Ap.assertOptions(r,{silentJSONParsing:Ei.transitional(Ei.boolean),forcedJSONParsing:Ei.transitional(Ei.boolean),clarifyTimeoutError:Ei.transitional(Ei.boolean)},!1),o!=null&&(ve.isFunction(o)?t.paramsSerializer={serialize:o}:Ap.assertOptions(o,{encode:Ei.function,serialize:Ei.function},!0)),t.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?t.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:t.allowAbsoluteUrls=!0),Ap.assertOptions(t,{baseUrl:Ei.spelling("baseURL"),withXsrfToken:Ei.spelling("withXSRFToken")},!0),t.method=(t.method||this.defaults.method||"get").toLowerCase();let c=a&&ve.merge(a.common,a[t.method]);a&&ve.forEach(["delete","get","head","post","put","patch","common"],_=>{delete a[_]}),t.headers=Rr.concat(c,a);const d=[];let h=!0;this.interceptors.request.forEach(function(I){typeof I.runWhen=="function"&&I.runWhen(t)===!1||(h=h&&I.synchronous,d.unshift(I.fulfilled,I.rejected))});const m=[];this.interceptors.response.forEach(function(I){m.push(I.fulfilled,I.rejected)});let g,x=0,S;if(!h){const _=[FS.bind(this),void 0];for(_.unshift.apply(_,d),_.push.apply(_,m),S=_.length,g=Promise.resolve(t);x<S;)g=g.then(_[x++],_[x++]);return g}S=d.length;let C=t;for(x=0;x<S;){const _=d[x++],I=d[x++];try{C=_(C)}catch(T){I.call(this,T);break}}try{g=FS.call(this,C)}catch(_){return Promise.reject(_)}for(x=0,S=m.length;x<S;)g=g.then(m[x++],m[x++]);return g}getUri(e){e=Ma(this.defaults,e);const t=lI(e.baseURL,e.url,e.allowAbsoluteUrls);return rI(t,e.params,e.paramsSerializer)}};ve.forEach(["delete","get","head","options"],function(e){ka.prototype[e]=function(t,r){return this.request(Ma(r||{},{method:e,url:t,data:(r||{}).data}))}});ve.forEach(["post","put","patch"],function(e){function t(r){return function(a,c,d){return this.request(Ma(d||{},{method:e,headers:r?{"Content-Type":"multipart/form-data"}:{},url:a,data:c}))}}ka.prototype[e]=t(),ka.prototype[e+"Form"]=t(!0)});let iN=class fI{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let t;this.promise=new Promise(function(a){t=a});const r=this;this.promise.then(o=>{if(!r._listeners)return;let a=r._listeners.length;for(;a-- >0;)r._listeners[a](o);r._listeners=null}),this.promise.then=o=>{let a;const c=new Promise(d=>{r.subscribe(d),a=d}).then(o);return c.cancel=function(){r.unsubscribe(a)},c},e(function(a,c,d){r.reason||(r.reason=new Dc(a,c,d),t(r.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const t=this._listeners.indexOf(e);t!==-1&&this._listeners.splice(t,1)}toAbortSignal(){const e=new AbortController,t=r=>{e.abort(r)};return this.subscribe(t),e.signal.unsubscribe=()=>this.unsubscribe(t),e.signal}static source(){let e;return{token:new fI(function(o){e=o}),cancel:e}}};function oN(n){return function(t){return n.apply(null,t)}}function sN(n){return ve.isObject(n)&&n.isAxiosError===!0}const tx={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(tx).forEach(([n,e])=>{tx[e]=n});function mI(n){const e=new ka(n),t=Hj(ka.prototype.request,e);return ve.extend(t,ka.prototype,e,{allOwnKeys:!0}),ve.extend(t,e,null,{allOwnKeys:!0}),t.create=function(o){return mI(Ma(n,o))},t}const wn=mI(Nd);wn.Axios=ka;wn.CanceledError=Dc;wn.CancelToken=iN;wn.isCancel=sI;wn.VERSION=pI;wn.toFormData=em;wn.AxiosError=vt;wn.Cancel=wn.CanceledError;wn.all=function(e){return Promise.all(e)};wn.spread=oN;wn.isAxiosError=sN;wn.mergeConfig=Ma;wn.AxiosHeaders=Rr;wn.formToJSON=n=>oI(ve.isHTMLForm(n)?new FormData(n):n);wn.getAdapter=hI.getAdapter;wn.HttpStatusCode=tx;wn.default=wn;const{Axios:cM,AxiosError:uM,CanceledError:dM,isCancel:hM,CancelToken:pM,VERSION:fM,all:mM,Cancel:gM,isAxiosError:yM,spread:xM,toFormData:bM,AxiosHeaders:vM,HttpStatusCode:wM,formToJSON:SM,getAdapter:kM,mergeConfig:TM}=wn;async function*ny(n,e,t,r){try{const a=St().currentUser;if(!a)throw new Error("用戶未登入");const c=await wn.post("/api/gpt",{messages:[{sender:"user",text:n}],system_prompt:t,userId:a.uid},{headers:{"x-test-mode":r?"true":"false"}}),d=c.data.reply;if(console.log("API Response:",c.data),d&&d.trim()){const h=d.split("");for(const m of h)yield m,await new Promise(g=>setTimeout(g,50))}else throw console.error("Empty reply from API"),new Error("AI回覆為空，請稍後再試。")}catch(o){throw console.error("Error calling GPT API:",o),o instanceof Error?new Error(`API錯誤：${o.message}`):new Error("抱歉，我現在無法回應，請稍後再試。")}}const gI=["Annie.png","berlex.png","Bray.png","Cayly.png","Derxl.png","El.png","Fenny.png","Gily.png","Henny.png","Jesy.png","Karl.png","michy.png","Mily.png","Neysher.png","sandy.png","Sherl.png","Shu.png","Shyly.png"],aN=gI.map(n=>`/avatars/${n}`);gI.map(n=>n.replace(/\.png$/i,""));const DS={"zh-TW":{friend:"朋友",avatarTitle:"選我做你的朋友",companionPhrase:["🕊️ 守在海這端，","我都聽著呢。"],changeAvatar:"更換我的頭像",aiReplyTemplate:n=>`AI陪聊：我明白你的意思，「${n}」，讓我再多聽你說說...`,aiSystemPrompt:"你是一個溫暖、善解人意的虛擬人，請用鼓勵、正向語氣回應。",speechErrorBrowser:"此瀏覽器不支援語音辨識，請改用 Chrome/Edge。",speechErrorFail:"語音辨識失敗，請再試一次。",speechErrorNoDetect:"沒有偵測到語音，請再試一次。",logout:"登出",inputPlaceholder:"或者，直接輸入文字... (Enter 送出)",welcome:n=>`嗨，${n}，我是你的 AI 朋友，你可以開始跟我說話囉！`,welcomePickAvatar:n=>`嗨，${n}，先幫我選個頭像後我們再輕鬆自在，天南地北痛快聊...`,welcomeChat:(n,e)=>`${n}說：嗨，${e}，今天想聊點什麼呢？`,whoAmI:"你想我是誰？",tapToTalk:"按一下開始語音聊天...",aiReplying:"AI 正在回覆中，輸入新訊息可立即打斷",recognizing:"正在辨識中..."},"zh-CN":{friend:"朋友",avatarTitle:"选我做你的朋友",companionPhrase:["🕊️ 守在海这端，","我都听着呢。"],changeAvatar:"更换我的头像",aiReplyTemplate:n=>`AI陪聊：我明白你的意思，"${n}"，让我再多听你聊聊...`,aiSystemPrompt:"你是一个温暖、善解人意的虚拟人，请用鼓励、正向语气回应。",speechErrorBrowser:"此浏览器不支持语音识别，请改用 Chrome/Edge。",speechErrorFail:"语音识别失败，请再试一次。",speechErrorNoDetect:"没有检测到语音，请再试一次。",logout:"登出",inputPlaceholder:"或者，直接输入文字... (Enter 发送)",welcome:n=>`嗨，${n}，我是你的 AI 朋友，你可以开始跟我说话啰！`,welcomePickAvatar:n=>`嗨，${n}，先帮我选个头像后我们再轻松自在，天南地北畅快聊...`,welcomeChat:(n,e)=>`${n}说：嗨，${e}，今天想聊点什么呢？`,whoAmI:"你想我是谁？",tapToTalk:"点一下开始语音聊天...",aiReplying:"AI 正在回复中，输入新消息可立即打断",recognizing:"正在识别中..."},en:{friend:"Friend",avatarTitle:"Pick Me as Your Friend",companionPhrase:["🕊️ I'm here by the sea,","I'm listening."],changeAvatar:"Change My Avatar",aiReplyTemplate:n=>`AI Chat: I understand what you mean, "${n}", let me hear more from you...`,aiSystemPrompt:"You are a warm, empathetic virtual person. Please respond in an encouraging and positive tone.",speechErrorBrowser:"This browser does not support speech recognition. Please use Chrome/Edge.",speechErrorFail:"Speech recognition failed, please try again.",speechErrorNoDetect:"No speech detected, please try again.",logout:"Logout",inputPlaceholder:"Or, type text directly... (Enter to send)",welcome:n=>`Hi, ${n}, I'm your AI friend. You can start talking to me now!`,welcomePickAvatar:n=>`Hi, ${n}, pick my avatar and let's chat freely!`,welcomeChat:(n,e)=>`${n}: Hi, ${e}, what do you want to talk about today?`,whoAmI:"Who do you want me to be?",tapToTalk:"Tap to start voice chat...",aiReplying:"AI is replying, type a new message to interrupt.",recognizing:"Recognizing..."},ja:{friend:"友達",avatarTitle:"友達に選んでね",companionPhrase:["🕊️ この海辺で待ってるよ、","ずっと聞いているから。"],changeAvatar:"アバターを変更",aiReplyTemplate:n=>`AIチャット：あなたの言うこと、「${n}」、わかります。もっと聞かせてください...`,aiSystemPrompt:"あなたは温かく、共感的なバーチャルパーソンです。励ましとポジティブなトーンで応答してください。",speechErrorBrowser:"このブラウザは音声認識に対応していません。Chrome/Edgeを使用してください。",speechErrorFail:"音声認識に失敗しました。もう一度お試しください。",speechErrorNoDetect:"音声が検出されませんでした。もう一度お試しください。",logout:"ログアウト",inputPlaceholder:"あるいは、直接テキストを入力... (Enterで送信)",welcome:n=>`こんにちは、${n}さん。あなたのAIの友達です。さあ、話しましょう！`,welcomePickAvatar:n=>`やあ、${n}、まずは私のアバターを選んでから、気軽に何でも話そう！`,welcomeChat:(n,e)=>`${n}：やあ、${e}、今日は何を話そうか？`,whoAmI:"私が誰であってほしいですか？",tapToTalk:"タップして音声チャット開始",aiReplying:"AIが返信中です。新しいメッセージを入力するとすぐに中断できます",recognizing:"認識中..."},ko:{friend:"친구",avatarTitle:"나를 친구로 선택해줘",companionPhrase:["🕊️ 바다 이편에서 지키고 있을게,","다 듣고 있어."],changeAvatar:"내 아바타 변경",aiReplyTemplate:n=>`AI 채팅: 무슨 말인지 알겠어, "${n}", 더 얘기해줘...`,aiSystemPrompt:"당신은 따뜻하고 공감 능력이 뛰어난 가상 인간입니다. 격려하고 긍정적인 톤으로 응답해주세요.",speechErrorBrowser:"이 브라우저는 음성 인식을 지원하지 않습니다. Chrome/Edge를 사용해주세요.",speechErrorFail:"음성 인식이 실패했습니다. 다시 시도해주세요.",speechErrorNoDetect:"음성이 감지되지 않았습니다. 다시 시도해주세요.",logout:"로그아웃",inputPlaceholder:"아니면, 직접 텍스트를 입력하세요... (Enter로 전송)",welcome:n=>`안녕, ${n}. 나는 너의 AI 친구야. 이제 나에게 말을 걸 수 있어!`,welcomePickAvatar:n=>`안녕, ${n}. 먼저 내 아바타를 고르고 자유롭게 얘기하자!`,welcomeChat:(n,e)=>`${n}: 안녕, ${e}, 오늘 무슨 얘기하고 싶어?`,whoAmI:"내가 누구였으면 좋겠어?",tapToTalk:"탭하여 음성 채팅 시작...",aiReplying:"AI가 답장 중입니다. 새 메시지를 입력하여 중단할 수 있습니다.",recognizing:"인식 중..."},vi:{friend:"Bạn bè",avatarTitle:"Chọn tôi làm bạn của bạn",companionPhrase:["🕊️ Em ở đây bên bờ biển,","Em đang lắng nghe đây."],changeAvatar:"Thay đổi Avatar của tôi",aiReplyTemplate:n=>`Trò chuyện AI: Tôi hiểu ý bạn, "${n}", hãy cho tôi nghe thêm...`,aiSystemPrompt:"Bạn là một người ảo ấm áp, đồng cảm. Vui lòng trả lời bằng giọng điệu khích lệ và tích cực.",speechErrorBrowser:"Trình duyệt này không hỗ trợ nhận dạng giọng nói. Vui lòng sử dụng Chrome/Edge.",speechErrorFail:"Nhận dạng giọng nói thất bại, vui lòng thử lại.",speechErrorNoDetect:"Không phát hiện thấy giọng nói, vui lòng thử lại.",logout:"Đăng xuất",inputPlaceholder:"Hoặc, nhập văn bản trực tiếp... (Enter để gửi)",welcome:n=>`Chào, ${n}. Tôi là người bạn AI của bạn. Bây giờ bạn có thể bắt đầu nói chuyện với tôi!`,welcomePickAvatar:n=>`Chào, ${n}, hãy chọn avatar của tôi và chúng ta hãy trò chuyện thoải mái!`,welcomeChat:(n,e)=>`${n}: Chào, ${e}, hôm nay bạn muốn nói về điều gì?`,whoAmI:"Bạn muốn tôi là ai?",tapToTalk:"Nhấn để bắt đầu trò chuyện thoại...",aiReplying:"AI đang trả lời, nhập tin nhắn mới để ngắt.",recognizing:"Đang nhận dạng..."},th:{friend:"เพื่อน",avatarTitle:"เลือกฉันเป็นเพื่อนของคุณ",companionPhrase:["🕊️ ฉันอยู่ที่นี่ริมทะเล,","ฉันกำลังฟังอยู่"],changeAvatar:"เปลี่ยนอวตารของฉัน",aiReplyTemplate:n=>`แชท AI: ฉันเข้าใจที่คุณหมายถึง, "${n}", เล่าให้ฉันฟังอีกสิ...`,aiSystemPrompt:"คุณเป็นบุคคลเสมือนที่อบอุ่นและเข้าอกเข้าใจ โปรดตอบกลับด้วยน้ำเสียงที่ให้กำลังใจและเป็นบวก",speechErrorBrowser:"เบราว์เซอร์นี้ไม่รองรับการจำแนกเสียงพูด กรุณาใช้ Chrome/Edge",speechErrorFail:"การจำแนกเสียงพูดล้มเหลว กรุณาลองอีกครั้ง",speechErrorNoDetect:"ไม่พบเสียงพูด กรุณาลองอีกครั้ง",logout:"ออกจากระบบ",inputPlaceholder:"หรือพิมพ์ข้อความโดยตรง... (Enter เพื่อส่ง)",welcome:n=>`สวัสดี, ${n}. ฉันคือเพื่อน AI ของคุณ คุณสามารถเริ่มคุยกับฉันได้เลย!`,welcomePickAvatar:n=>`สวัสดี, ${n}, เลือกอวตารของฉันแล้วมาคุยกันอย่างอิสระ!`,welcomeChat:(n,e)=>`${n}: สวัสดี, ${e}, วันนี้คุณอยากคุยเรื่องอะไร?`,whoAmI:"คุณอยากให้ฉันเป็นใคร?",tapToTalk:"แตะเพื่อเริ่มแชทด้วยเสียง...",aiReplying:"AI กำลังตอบกลับ, พิมพ์ข้อความใหม่เพื่อขัดจังหวะ",recognizing:"กำลังจดจำ..."},la:{friend:"Amicus",avatarTitle:"Elige Me ut Amicum Tuum",companionPhrase:["🕊️ Hic adsum ad mare,","Audio."],changeAvatar:"Muta Imaginem Meam",aiReplyTemplate:n=>`AI Curabitur: Intellego quid velis, "${n}", sine me plura a te audire...`,aiSystemPrompt:"Tu es persona virtualis calida et empathetica. Quaeso responde sono hortanti et positivo.",speechErrorBrowser:"Hic navigator recognitionem vocis non sustinet. Quaeso utere Chrome/Edge.",speechErrorFail:"Recognitio vocis defecit, quaeso iterum conare.",speechErrorNoDetect:"Nulla oratio detecta, quaeso iterum conare.",logout:"Exire",inputPlaceholder:"Aut, textum directe scribe... (Enter mittere)",welcome:n=>`Salve, ${n}. Amicus tuus AI sum. Iam potes mecum loqui!`,welcomePickAvatar:n=>`Salve, ${n}, elige imaginem meam et libere loquamur!`,welcomeChat:(n,e)=>`${n}: Salve, ${e}, de quo hodie loqui vis?`,whoAmI:"Quis vis me esse?",tapToTalk:"Tange ut colloquium vocale incipias...",aiReplying:"AI respondet, scribe novum nuntium ad interrumpendum.",recognizing:"Agnoscens..."},ms:{friend:"Kawan",avatarTitle:"Pilih Saya sebagai Kawan Anda",companionPhrase:["🕊️ Saya di sini di tepi laut,","Saya sedang mendengar."],changeAvatar:"Tukar Avatar Saya",aiReplyTemplate:n=>`Sembang AI: Saya faham maksud awak, "${n}", beritahu saya lagi...`,aiSystemPrompt:"Anda adalah orang maya yang mesra dan empati. Sila balas dengan nada yang menggalakkan dan positif.",speechErrorBrowser:"Pelayar ini tidak menyokong pengecaman pertuturan. Sila gunakan Chrome/Edge.",speechErrorFail:"Pengecaman pertuturan gagal, sila cuba lagi.",speechErrorNoDetect:"Tiada pertuturan dikesan, sila cuba lagi.",logout:"Log keluar",inputPlaceholder:"Atau, taip teks secara terus... (Enter untuk hantar)",welcome:n=>`Hai, ${n}. Saya kawan AI anda. Anda boleh mula bercakap dengan saya sekarang!`,welcomePickAvatar:n=>`Hai, ${n}, pilih avatar saya dan mari berbual dengan bebas!`,welcomeChat:(n,e)=>`${n}: Hai, ${e}, apa yang anda mahu bualkan hari ini?`,whoAmI:"Awak nak saya jadi siapa?",tapToTalk:"Ketik untuk memulakan sembang suara...",aiReplying:"AI sedang membalas, taip mesej baru untuk mengganggu.",recognizing:"Mengecam..."}},lN={"zh-TW":"返回","zh-CN":"返回",en:"Back",ja:"戻る",ko:"뒤로",th:"ย้อนกลับ",vi:"Quay lại",ms:"Kembali",la:"Redi"},cN={"zh-TW":"更換頭像","zh-CN":"更换头像",en:"Change Avatar",ja:"アバターを変更",ko:"아바타 변경",th:"เปลี่ยนภาพประจำตัว",vi:"Đổi avatar",ms:"Tukar Avatar",la:"Muta Imaginem"};function uN(){var Ge,ft,ke,at,pe;const n=_t(),[e,t]=v.useState([]),[r,o]=v.useState(""),[a,c]=v.useState(!1),d=v.useRef(null),h=v.useRef(null),m=v.useRef(null),[g,x]=v.useState(!1),[S,C]=v.useState(!1),[_,I]=v.useState(""),[T,F]=v.useState(!1),[P,B]=v.useState(""),[q,te]=v.useState(""),[W,L]=v.useState(!1),[R,A]=v.useState(!1),[N,O]=v.useState(""),[z,j]=v.useState(""),{lang:V,setLang:X}=Mt(),$=DS[V]||DS["zh-TW"],ne=v.useRef(null),{isTestMode:oe}=$i(),[J,Q]=v.useState(!1),D=v.useRef(null),[G,ie]=v.useState(!1),{checkPermission:ee,recordUsage:Se}=Ls(),[we,Oe]=v.useState(!1),[Ne,Ye]=v.useState(!1),[it,me]=v.useState(null),Ve=()=>{const de=St().currentUser;return de&&de.displayName||localStorage.getItem("nickname")||$.friend},[Xe,Je]=v.useState(Ve()),[He,fe]=v.useState(()=>localStorage.getItem("lastUid")),[Te,_e]=v.useState(()=>!localStorage.getItem("avatarWelcomed")),[Fe,Be]=v.useState(()=>!localStorage.getItem("aiAvatar")),[K,re]=v.useState(""),H=v.useRef(null);v.useEffect(()=>{localStorage.setItem("lang",V),Je(Ve());const de=window.SpeechRecognition||window.webkitSpeechRecognition;de?(ne.current=new de,ne.current.continuous=!0,ne.current.interimResults=!0,ne.current.lang=V,ne.current.onresult=De=>{let $e="",lt="";for(let pt=De.resultIndex;pt<De.results.length;++pt)De.results[pt].isFinal?lt+=De.results[pt][0].transcript:$e+=De.results[pt][0].transcript;if(o(z+lt+$e),lt){const pt=z+lt;j(bt=>bt+lt),(async()=>{const bt={id:`user-${Date.now()}`,text:pt,sender:"user"};t(Et=>[...Et,bt]),o(""),d.current&&clearTimeout(d.current);const gt=`ai-${Date.now()}`;t(Et=>[...Et,{id:gt,text:"",sender:"ai",status:"streaming"}]),c(!0);try{const Et=await ny(pt,V,$.aiSystemPrompt,oe);let Nt="";for await(const rn of Et)Nt+=rn,t(on=>on.map(Vr=>Vr.id===gt?{...Vr,text:Nt}:Vr));t(rn=>rn.map(on=>on.id===gt?{...on,status:"done"}:on))}catch(Et){console.error("Error in AI pipeline: ",Et);const Nt=Et instanceof Error?Et.message:"未知錯誤";t(rn=>rn.map(on=>on.id===gt?{...on,text:`API錯誤：${Nt}`,status:"done"}:on))}finally{c(!1)}})()}},ne.current.onerror=De=>{console.error("Speech recognition error",De.error);let $e="";switch(De.error){case"no-speech":$e=$.speechErrorNoDetect;break;case"audio-capture":case"network":$e=$.speechErrorFail;break;default:$e=""}O($e),A(!1),C(!1)},ne.current.onend=()=>{A(!1)}):O($.speechErrorBrowser)},[V,$.speechErrorBrowser,$.speechErrorFail,$.speechErrorNoDetect,S,z]),v.useEffect(()=>{ne.current&&(ne.current.onend=()=>{A(!1),J&&S&&!G&&(D.current=setTimeout(()=>{!S||G||(r.trim()&&(ue(r),o(""),j("")),setTimeout(()=>{S&&J&&!G&&(ne.current.start(),A(!0))},500))},100))})},[J,S,r,G]),v.useEffect(()=>{var $e,lt;const de=localStorage.getItem("aiAvatar");de?(I(de),F(!1)):F(!0);const De=($e=St().currentUser)==null?void 0:$e.uid;De!==He&&(localStorage.removeItem("aiAvatar"),localStorage.removeItem("avatarWelcomed"),I(""),fe(De||null),De&&localStorage.setItem("lastUid",De)),St().currentUser&&Je(((lt=St().currentUser)==null?void 0:lt.displayName)||$.friend)},[He,$.friend]),v.useEffect(()=>{m.current&&(m.current.scrollTop=m.current.scrollHeight)},[e]);const Ue=de=>{I(de),localStorage.setItem("aiAvatar",de),F(!1),Te&&(t([{id:"welcome-1",text:$.welcomeChat(le(de),Xe),sender:"ai"}]),localStorage.setItem("avatarWelcomed","true"),_e(!1))},ue=async(de=r)=>{if(!de.trim())return;const De=await ee("aiChat");if(!De.allowed){if(oe){const pt={id:`user-${Date.now()}`,text:de,sender:"user"};t(gt=>[...gt,pt]),o(""),j(""),d.current&&clearTimeout(d.current);const bt=`ai-${Date.now()}`;t(gt=>[...gt,{id:bt,text:"",sender:"ai",status:"streaming"}]),c(!0);try{const gt=await ny(de,V,$.aiSystemPrompt,oe);let Et="";for await(const Nt of gt)Et+=Nt,t(rn=>rn.map(on=>on.id===bt?{...on,text:Et}:on));t(Nt=>Nt.map(rn=>rn.id===bt?{...rn,status:"done"}:rn))}catch(gt){console.error("Error in AI pipeline: ",gt);const Et=gt instanceof Error?gt.message:"未知錯誤";t(Nt=>Nt.map(rn=>rn.id===bt?{...rn,text:`API錯誤：${Et}`,status:"done"}:rn))}finally{c(!1)}return}De.isFreeUser?Ye(!0):(De.canRenew,me(De),Oe(!0));return}const $e={id:`user-${Date.now()}`,text:de,sender:"user"};t(pt=>[...pt,$e]),o(""),j(""),d.current&&clearTimeout(d.current);const lt=`ai-${Date.now()}`;t(pt=>[...pt,{id:lt,text:"",sender:"ai",status:"streaming"}]),c(!0);try{const pt=await ny(de,V,$.aiSystemPrompt,oe);let bt="";for await(const gt of pt)bt+=gt,t(Et=>Et.map(Nt=>Nt.id===lt?{...Nt,text:bt}:Nt));t(gt=>gt.map(Et=>Et.id===lt?{...Et,status:"done"}:Et)),L(!0),await Se("aiChat",2)}catch(pt){console.error("Error in AI pipeline: ",pt),t(bt=>bt.map(gt=>gt.id===lt?{...gt,text:"Oops, something went wrong.",status:"done"}:gt))}finally{c(!1),L(!1)}},le=de=>{if(!de)return"";const De=de.split("/");return De[De.length-1].replace(/\.png$/i,"")},Re=async()=>{if(ne.current)if(S||J||R)ne.current.stop(),C(!1),A(!1),Q(!1),D.current&&clearTimeout(D.current),ie(!0);else{const de=await ee("aiChat");if(!de.allowed){if(oe){j(""),o(""),ne.current.start(),C(!0),A(!0),O(""),Q(!0),ie(!1);return}de.isFreeUser?Ye(!0):(de.canRenew,me(de),Oe(!0));return}j(""),o(""),ne.current.start(),C(!0),A(!0),O(""),Q(!0),ie(!1),await Se("aiChat",1)}},rt=de=>{var $e;const De=($e=de.target.files)==null?void 0:$e[0];if(De){if(!De.type.startsWith("image/")){alert("請選擇圖片文件");return}if(De.size>5*1024*1024){alert("圖片大小不能超過 5MB");return}const lt=new FileReader;lt.onload=pt=>{var gt;const bt=(gt=pt.target)==null?void 0:gt.result;re(bt),Ue(bt)},lt.readAsDataURL(De)}},xe=()=>{var de;(de=H.current)==null||de.click()};v.useEffect(()=>{!S&&!J&&ie(!1)},[S,J]);const Ae=()=>{Oe(!1),me(null)};return i.jsxs("div",{style:{display:"flex",flexDirection:"column",height:"100vh",backgroundColor:"#f0f2f5"},children:[i.jsxs("header",{style:{display:"flex",flexDirection:"column",backgroundColor:"#fff",borderBottom:"1px solid #ddd",position:"relative",padding:0},children:[i.jsxs("div",{style:{width:"100%",display:"flex",alignItems:"center",justifyContent:"center",padding:"10px 20px 0 20px",position:"relative"},children:[i.jsx("button",{onClick:()=>n(-1),style:{position:"absolute",left:20,background:"#6B5BFF",color:"#fff",border:"none",borderRadius:8,padding:"8px 18px",fontWeight:700,fontSize:16,cursor:"pointer"},children:lN[V]}),i.jsx("span",{className:"ai-name-desktop",style:{fontWeight:700,color:"#ff9800",fontSize:18,marginRight:12,minWidth:50,textAlign:"right",maxWidth:70,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:le(_)||$.whoAmI}),i.jsx("div",{style:{fontSize:20,fontWeight:700,textAlign:"center",flexShrink:0},children:"💬 聊天了吧"}),i.jsx("span",{style:{fontWeight:700,color:"#1976d2",fontSize:18,marginLeft:12,minWidth:50,textAlign:"left",maxWidth:70,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:((Ge=St().currentUser)==null?void 0:Ge.displayName)||((ft=St().currentUser)==null?void 0:ft.email)||"用戶"})]}),i.jsx("div",{style:{textAlign:"center",marginTop:4},children:i.jsx("div",{style:{fontSize:16,color:"#888"},children:"在這裡你可以盡情,暢快,放開地聊😊"})})]}),T&&i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.8)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:100},children:i.jsxs("div",{style:{background:"#fff",padding:24,borderRadius:12,textAlign:"center",position:"relative"},children:[i.jsx("button",{onClick:()=>F(!1),style:{position:"absolute",top:12,right:12,background:"none",border:"none",fontSize:24,color:"#888",cursor:"pointer",fontWeight:700},children:"×"}),i.jsx("h2",{children:$.avatarTitle}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(5, 1fr)",gap:16,margin:"24px 0"},children:[aN.slice(0,15).map(de=>i.jsx("img",{src:de,alt:le(de),onClick:()=>Ue(de),style:{width:80,height:80,borderRadius:"50%",cursor:"pointer",objectFit:"cover"}},de)),i.jsx("div",{style:{width:80,height:80,borderRadius:"50%",border:"2px dashed #6B5BFF",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",background:"#f8f8ff",color:"#6B5BFF",fontSize:12,fontWeight:600},onClick:xe,children:"上傳心儀頭像"})]}),i.jsx("input",{ref:H,type:"file",accept:"image/*",style:{display:"none"},onChange:rt})]})}),!_&&!T&&i.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",padding:24,textAlign:"center"},children:[i.jsx("p",{style:{fontSize:18,marginBottom:24},children:$.welcomePickAvatar(Xe)}),i.jsx("button",{onClick:()=>F(!0),style:{padding:"10px 20px",borderRadius:8,background:"#1877f2",color:"#fff",border:"none",fontWeight:700,fontSize:16},children:$.avatarTitle})]}),_&&i.jsx("main",{ref:m,style:{flex:1,overflowY:"auto",padding:"20px",maxHeight:"calc(100vh - 240px)",scrollBehavior:"smooth",boxSizing:"border-box"},children:i.jsxs("div",{style:{maxWidth:800,margin:"0 auto",minHeight:"100%"},children:[e.length===0&&i.jsx("div",{style:{textAlign:"center",color:"#888",marginTop:40},children:i.jsx("p",{style:{fontSize:18},children:$.welcomeChat(le(_),Xe)})}),e.map(de=>i.jsx("div",{style:{display:"flex",justifyContent:de.sender==="user"?"flex-end":"flex-start",margin:"10px 0",wordWrap:"break-word"},children:i.jsxs("div",{style:{backgroundColor:de.sender==="user"?"#0084ff":"#e4e6eb",color:de.sender==="user"?"#fff":"#000",padding:"12px 16px",borderRadius:18,maxWidth:"70%",wordBreak:"break-word",whiteSpace:"pre-wrap",lineHeight:"1.4"},children:[de.text,de.status==="streaming"&&"..."]})},de.id)),i.jsx("div",{style:{height:"20px"}})]})}),_&&i.jsxs("footer",{style:{padding:"10px 20px 10px 20px",backgroundColor:"#fff",borderTop:"1px solid #ddd",position:"relative",minHeight:"160px",boxSizing:"border-box"},children:[i.jsx("div",{style:{maxWidth:800,margin:"0 auto",display:"flex",alignItems:"flex-start",justifyContent:"center"},children:i.jsxs("div",{style:{flex:1,marginLeft:0,marginRight:0},children:[i.jsxs("div",{className:"mobile-avatars-row",style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:12,padding:"0 8px"},children:[i.jsxs("div",{className:"mobile-ai-avatar",style:{display:"flex",alignItems:"center",gap:8},children:[i.jsx("div",{style:{width:80,height:80,borderRadius:"50% / 45%",border:"4px solid #2196f3",display:"flex",alignItems:"center",justifyContent:"center",background:"#fff",overflow:"hidden"},children:i.jsx("div",{style:{width:72,height:72,minWidth:72,minHeight:72,borderRadius:"50%",overflow:"hidden",position:"relative"},children:i.jsx("div",{style:{width:"100%",height:"100%",position:"relative",overflow:"hidden"},children:i.jsx(ED,{avatar:_,videoUrl:P,audioUrl:q,isSpeaking:W,size:72})})})}),i.jsx("button",{onClick:()=>F(!0),style:{background:"#6B5BFF",color:"#fff",border:"none",borderRadius:6,padding:"4px 8px",fontWeight:600,fontSize:10,cursor:"pointer",boxShadow:"0 2px 4px rgba(107, 91, 255, 0.3)",whiteSpace:"nowrap"},children:cN[V]})]}),i.jsx("div",{style:{flex:1,textAlign:"center",padding:"0 12px"},children:i.jsxs("div",{style:{fontSize:14,color:"#666",lineHeight:"1.4"},children:[i.jsx("span",{style:{fontWeight:700,color:"#ff9800"},children:le(_)||"Fenny"}),i.jsx("br",{}),i.jsx("span",{style:{color:"#1976d2"},children:"讓我們來聊天..."}),i.jsx("br",{}),i.jsx("span",{style:{color:"#1976d2"},children:((ke=St().currentUser)==null?void 0:ke.displayName)||((at=St().currentUser)==null?void 0:at.email)||"用戶"}),i.jsx("br",{}),i.jsx("span",{style:{color:"#666"},children:"聊什麼都可以喔 😊"})]})}),i.jsx("div",{style:{width:80,height:80,borderRadius:"50% / 45%",border:"4px solid #2196f3",display:"flex",alignItems:"center",justifyContent:"center",background:"#fff",overflow:"visible"},children:i.jsx("img",{src:((pe=St().currentUser)==null?void 0:pe.photoURL)||"/ctx-logo.png",alt:"user",style:{width:72,height:72,minWidth:72,minHeight:72,borderRadius:"50%",objectFit:"cover",border:"none",verticalAlign:"bottom"}})})]}),i.jsx("div",{style:{display:"flex",alignItems:"flex-end",height:80},children:i.jsx("input",{ref:h,type:"text",value:r,onChange:de=>o(de.target.value),onKeyPress:de=>de.key==="Enter"&&ue(),placeholder:a?$.aiReplying:$.inputPlaceholder,style:{width:"100%",padding:12,borderRadius:18,border:"1px solid #ccc"},disabled:a||R})}),i.jsxs("div",{className:"chat-action-row-mobile",style:{width:"100%",display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center",marginTop:12,gap:16},children:[i.jsx("button",{onClick:()=>ue(),disabled:a||!r,style:{padding:"10px 28px",borderRadius:8,border:"none",background:"#1976d2",color:"#fff",fontWeight:700,fontSize:16,cursor:a||!r?"not-allowed":"pointer"},children:"送出"}),i.jsx("button",{onClick:Re,disabled:a,style:{padding:16,borderRadius:"50%",border:"none",background:S||J||R?"#ff4d4d":"#1877f2",color:"#fff",cursor:"pointer",fontSize:20},children:S||J||R?"停止":"🎤"})]}),i.jsxs("div",{className:"chat-action-row-desktop",style:{width:"100%",display:"none",flexDirection:"row",alignItems:"center",justifyContent:"center",marginTop:12,gap:16},children:[i.jsx("button",{onClick:()=>ue(),disabled:a||!r,style:{padding:"10px 28px",borderRadius:8,border:"none",background:"#1976d2",color:"#fff",fontWeight:700,fontSize:16,cursor:a||!r?"not-allowed":"pointer"},children:"送出"}),i.jsx("button",{onClick:Re,disabled:a,style:{padding:16,borderRadius:"50%",border:"none",background:S||J||R?"#ff4d4d":"#1877f2",color:"#fff",cursor:"pointer",fontSize:20},children:S||J||R?"停止":"🎤"})]}),i.jsxs("div",{style:{height:40,display:"flex",alignItems:"center",justifyContent:"center"},children:[N&&i.jsx("p",{style:{color:"red",margin:0},children:N}),!N&&!r&&!R&&!a&&!S&&!J&&i.jsx("p",{style:{color:"#888",margin:0,cursor:"pointer"},onClick:Re,children:$.tapToTalk}),!N&&R&&i.jsx("p",{style:{color:"#888",margin:0},children:$.recognizing}),!N&&(r||a||S||J)&&i.jsx("p",{style:{color:"transparent",margin:0},children:"佔位"})]})]})}),i.jsx("div",{style:{textAlign:"center",marginTop:10,fontSize:12,color:"#aaa"},children:i.jsxs("p",{children:[$.companionPhrase[0],$.companionPhrase[1]]})})]}),window.innerWidth<=768?i.jsxs("footer",{style:{textAlign:"center",fontSize:12,color:"#888",marginTop:20,padding:12,background:"rgba(255,255,255,0.95)",borderTop:"1px solid #eee",display:"flex",flexDirection:"column",gap:8},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:16,flexWrap:"wrap"},children:[i.jsx("a",{href:"/privacy-policy",style:{color:"#6B5BFF",textDecoration:"underline",fontSize:11},children:V==="zh-TW"?"隱私權政策":V==="zh-CN"?"隐私政策":V==="en"?"Privacy Policy":V==="ja"?"プライバシーポリシー":V==="ko"?"개인정보 처리방침":V==="th"?"นโยบายความเป็นส่วนตัว":V==="vi"?"Chính sách bảo mật":V==="ms"?"Dasar Privasi":"Consilium de Privata"}),i.jsx("a",{href:"/terms",style:{color:"#6B5BFF",textDecoration:"underline",fontSize:11},children:V==="zh-TW"?"條款/聲明":V==="zh-CN"?"条款/声明":V==="en"?"Terms/Statement":V==="ja"?"規約/声明":V==="ko"?"약관/성명":V==="th"?"ข้อกำหนด/แถลงการณ์":V==="vi"?"Điều khoản/Tuyên bố":V==="ms"?"Terma/Pernyataan":"Termini/Declaratio"}),i.jsx("a",{href:"/data-deletion",style:{color:"#6B5BFF",textDecoration:"underline",fontSize:11},children:V==="zh-TW"?"資料刪除說明":V==="zh-CN"?"数据删除说明":V==="en"?"Data Deletion":V==="ja"?"データ削除について":V==="ko"?"데이터 삭제 안내":V==="th"?"คำอธิบายการลบข้อมูล":V==="vi"?"Giải thích xóa dữ liệu":V==="ms"?"Penjelasan Penghapusan Data":"Explicatio Deletionis Datae"})]}),i.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:16,flexWrap:"wrap"},children:[i.jsx("a",{href:"/about",style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:600,fontSize:11},children:V==="zh-TW"?"🧬 我們是誰":V==="zh-CN"?"🧬 我们是谁":V==="en"?"🧬 Who We Are":V==="ja"?"🧬 私たちについて":V==="ko"?"🧬 우리는 누구인가":V==="th"?"🧬 เราเป็นใคร":V==="vi"?"🧬 Chúng tôi là ai":V==="ms"?"🧬 Siapa Kami":"🧬 Quis sumus"}),i.jsx("a",{href:"/feedback",style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:600,fontSize:11},children:V==="zh-TW"?"💬 意見箱":V==="zh-CN"?"💬 意见箱":V==="en"?"💬 Feedback":V==="ja"?"💬 ご意見箱":V==="ko"?"💬 피드백":V==="th"?"💬 กล่องความคิดเห็น":V==="vi"?"💬 Hộp góp ý":V==="ms"?"💬 Kotak Maklum Balas":"💬 Arca Consilii"})]})]}):i.jsx("div",{style:{width:"100%",margin:"0 auto",marginTop:24,background:"rgba(255,255,255,0.95)",borderRadius:16,padding:"16px",boxShadow:"0 2px 12px #6B5BFF22"},children:i.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:20,flexWrap:"wrap"},children:[i.jsx("a",{href:"/privacy-policy",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12},children:V==="zh-TW"?"隱私權政策":V==="zh-CN"?"隐私政策":V==="en"?"Privacy Policy":V==="ja"?"プライバシーポリシー":V==="ko"?"개인정보 처리방침":V==="th"?"นโยบายความเป็นส่วนตัว":V==="vi"?"Chính sách bảo mật":V==="ms"?"Dasar Privasi":"Consilium de Privata"}),i.jsx("a",{href:"/terms",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12},children:V==="zh-TW"?"條款/聲明":V==="zh-CN"?"条款/声明":V==="en"?"Terms/Statement":V==="ja"?"規約/声明":V==="ko"?"약관/성명":V==="th"?"ข้อกำหนด/แถลงการณ์":V==="vi"?"Điều khoản/Tuyên bố":V==="ms"?"Terma/Pernyataan":"Termini/Declaratio"}),i.jsx("a",{href:"/data-deletion",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12},children:V==="zh-TW"?"資料刪除說明":V==="zh-CN"?"数据删除说明":V==="en"?"Data Deletion":V==="ja"?"データ削除について":V==="ko"?"데이터 삭제 안내":V==="th"?"คำอธิบายการลบข้อมูล":V==="vi"?"Giải thích xóa dữ liệu":V==="ms"?"Penjelasan Penghapusan Data":"Explicatio Deletionis Datae"}),i.jsx("a",{href:"/about",style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12},children:V==="zh-TW"?"🧬 Restarter™｜我們是誰":V==="zh-CN"?"🧬 Restarter™｜我们是谁":V==="en"?"🧬 Restarter™｜Who We Are":V==="ja"?"🧬 Restarter™｜私たちについて":V==="ko"?"🧬 Restarter™｜우리는 누구인가":V==="th"?"🧬 Restarter™｜เราเป็นใคร":V==="vi"?"🧬 Restarter™｜Chúng tôi là ai":V==="ms"?"🧬 Restarter™｜Siapa Kami":"🧬 Restarter™｜Quis sumus"}),i.jsx("a",{href:"/feedback",style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12},children:V==="zh-TW"?"💬 意見箱｜我們想聽你說":V==="zh-CN"?"💬 意见箱｜我们想听你说":V==="en"?"💬 Feedback Box｜We Want to Hear From You":V==="ja"?"💬 ご意見箱｜私たちはあなたの声を聞きたい":V==="ko"?"💬 피드백｜우리는 당신의 말을 듣고 싶습니다":V==="th"?"💬 กล่องความคิดเห็น｜เราอยากได้ยินจากคุณ":V==="vi"?"💬 Hộp góp ý｜Chúng tôi muốn nghe từ bạn":V==="ms"?"💬 Kotak Maklum Balas｜Kami Ingin Mendengar Dari Anda":"💬 Arca Consilii｜Volumus Audire a Te"})]})}),we&&it&&i.jsx(Ms,{isOpen:we,onClose:Ae,currentPlan:it.currentPlan,remainingDays:it.remainingDays,usedTokens:it.usedTokens,totalTokens:it.totalTokens}),Ne&&i.jsx(qj,{isOpen:Ne,onClose:()=>Ye(!1),featureName:"AI 聊天"})]})}const dN="modulepreload",hN=function(n){return"/"+n},NS={},ud=function(e,t,r){let o=Promise.resolve();if(t&&t.length>0){let c=function(m){return Promise.all(m.map(g=>Promise.resolve(g).then(x=>({status:"fulfilled",value:x}),x=>({status:"rejected",reason:x}))))};document.getElementsByTagName("link");const d=document.querySelector("meta[property=csp-nonce]"),h=(d==null?void 0:d.nonce)||(d==null?void 0:d.getAttribute("nonce"));o=c(t.map(m=>{if(m=hN(m),m in NS)return;NS[m]=!0;const g=m.endsWith(".css"),x=g?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${m}"]${x}`))return;const S=document.createElement("link");if(S.rel=g?"stylesheet":dN,g||(S.as="script"),S.crossOrigin="",S.href=m,h&&S.setAttribute("nonce",h),document.head.appendChild(S),g)return new Promise((C,_)=>{S.addEventListener("load",C),S.addEventListener("error",()=>_(new Error(`Unable to preload CSS for ${m}`)))})}))}function a(c){const d=new Event("vite:preloadError",{cancelable:!0});if(d.payload=c,window.dispatchEvent(d),!d.defaultPrevented)throw c}return o.then(c=>{for(const d of c||[])d.status==="rejected"&&a(d.reason);return e().catch(a)})},Fu=St(Ao),pN={"zh-TW":{heroLeftTop:"救贖不是罪，",heroLeftMain:"只是走錯太久。",heroLeftSub:"",heroLeftYellow:"野花昂首盡綻放！",heroRightTop:"我要重新開始...",heroRightMain:"每一次的經歷，都是獨一無二的篇章",heroRightSub:"而不是成長的絆腳石。",heroRightYellow:"從灰燼中重生！",title:"Restarter™ 註冊",email:"電子郵件 *必填",password:"密碼 (至少8位，含英文及數字) *必填",nickname:"暱稱 (6-16字) *必填",age:"年齡*選填",selectAge:"請選擇年齡區間*必選",country:"國家(地區)*必選",city:"城市(可選)",interest:"興趣*選填",eventType:"經歷事件**選填",whatToImprove:"想改善什麼*選填",uploadAvatar:"上傳頭像",male:"男",female:"女",genderRequired:"(必選)",register:"🚀 註冊",registering:"註冊中...",errorAvatar:"請上傳頭像",errorGender:"請選擇性別",errorEmailFormat:"電子郵件格式無效",errorPasswordFormat:"密碼必須至少8個字符，且包含字母和數字",errorNicknameFormat:"暱稱必須是6-16個字符",errorAgeFormat:"年齡必須在18到99歲之間",errorCountry:"請選擇國家/地區",errorRegion:"請輸入城市",errorInterest:"請選擇興趣",errorEventType:"請選擇事件類型",errorImprovement:"請選擇想改善的項目",formTopSlogan:"你來了，就值得被歡迎！",login:"登入",terms:"條款/聲明",privacy:"隱私權政策",deletion:"資料刪除說明",googleLogin:"使用 Google 登入",appleLogin:"使用 Apple 登入"},"zh-CN":{heroLeftTop:"救赎不是罪，",heroLeftMain:"只是走错太久。",heroLeftSub:"",heroLeftYellow:"野花昂首尽绽放！",heroRightTop:"我要重新开始...",heroRightMain:"每一次的经历，都是独一无二的篇章",heroRightSub:"而不是成长的绊脚石。",heroRightYellow:"从灰烬中重生！",title:"Restarter™ 注册",email:"电子邮件 *必填",password:"密码 (至少8位，含英文及数字) *必填",nickname:"昵称 (6-16字) *必填",age:"年龄*选填",selectAge:"请选择年龄区间*必选",country:"国家(地区)*必选",city:"城市(可选)",interest:"兴趣*选填",eventType:"经历事件**选填",whatToImprove:"想改善什么*选填",uploadAvatar:"上传头像",male:"男",female:"女",genderRequired:"(必选)",register:"🚀 注册",registering:"注册中...",errorAvatar:"请上传头像",errorGender:"请选择性别",errorEmailFormat:"电子邮件格式无效",errorPasswordFormat:"密码必须至少8个字符，且包含字母和数字",errorNicknameFormat:"昵称必须是6-16个字符",errorAgeFormat:"年龄必须在18到99岁之间",errorCountry:"请选择国家/地区",errorRegion:"请输入城市",errorInterest:"请选择兴趣",errorEventType:"请选择事件类型",errorImprovement:"请选择想改善的项目",formTopSlogan:"你來了，就值得被歡迎！",login:"登录",terms:"条款/声明",privacy:"隐私政策",deletion:"数据删除说明",googleLogin:"使用 Google 登录",appleLogin:"使用 Apple 登录"},en:{heroLeftTop:"Redemption is not a crime,",heroLeftMain:"just went down the wrong path for too long.",heroLeftSub:"",heroLeftYellow:"Wildflowers bloom bravely!",heroRightTop:"I want a new start...",heroRightMain:"Every experience is a unique chapter,",heroRightSub:"not a barrier to growth.",heroRightYellow:"Rise from the ashes!",title:"Restarter™ Registration",email:"Email *required",password:"Password (min 8 chars, letter & number) *required",nickname:"Nickname (6-16 chars) *required",age:"Age*optional",selectAge:"Select age range",country:"Country (Region)*optional",city:"City (optional)",interest:"Interest*optional",eventType:"History Event**optional",whatToImprove:"What to improve*optional",uploadAvatar:"Upload Avatar",male:"Male",female:"Female",genderRequired:"(*required)",register:"🚀 Register",registering:"Registering...",errorAvatar:"Please upload an avatar.",errorGender:"Please select a gender.",errorEmailFormat:"Invalid email format.",errorPasswordFormat:"Password must be at least 8 characters long and contain both letters and numbers.",errorNicknameFormat:"Nickname must be 6-16 characters long.",errorAgeFormat:"Age must be between 18 and 99.",errorCountry:"Please select a country.",errorRegion:"Please enter a city.",errorInterest:"Please select an interest.",errorEventType:"Please select an event type.",errorImprovement:"Please select an item to improve.",formTopSlogan:"It's not wrong to rise up!",login:"Login",terms:"Terms/Statement",privacy:"Privacy Policy",deletion:"Data Deletion",googleLogin:"Sign in with Google",appleLogin:"Sign in with Apple"},ja:{heroLeftTop:"贖いは罪ではない、",heroLeftMain:"ただ道に迷った時間が長すぎただけだ。",heroLeftSub:"",heroLeftYellow:"野の花も堂々と咲く！",heroRightTop:"私は新しく始めたい...",heroRightMain:"一つ一つの経験が、ユニークな章であり、",heroRightSub:"成長の障害ではない。",heroRightYellow:"灰の中から蘇れ！",title:"Restarter™ 登録",email:"メールアドレス *必須",password:"パスワード (8文字以上、英数字を含む) *必須",nickname:"ニックネーム (6-16文字) *必須",age:"年齢*任意",selectAge:"年齢層を選択",country:"国/地域*任意",city:"都市(任意)",interest:"興味*任意",eventType:"経験した出来事**任意",whatToImprove:"改善したいこと*任意",uploadAvatar:"アバターをアップロード",male:"男性",female:"女性",genderRequired:"(*必須)",register:"🚀 登録",registering:"登録中...",errorAvatar:"アバターをアップロードしてください。",errorGender:"性別を選択してください。",errorEmailFormat:"無効なメール形式です。",errorPasswordFormat:"パスワードは8文字以上で、文字と数字の両方を含める必要があります。",errorNicknameFormat:"ニックネームは6～16文字である必要があります。",errorAgeFormat:"年齢は18歳から99歳の間でなければなりません。",errorCountry:"国を選択してください。",errorRegion:"都市を入力してください。",errorInterest:"興味を選択してください。",errorEventType:"イベントタイプを選択してください。",errorImprovement:"改善したい項目を選択してください。",formTopSlogan:"立ち上がることは間違いじゃない！",login:"ログイン",terms:"規約/声明",privacy:"プライバシーポリシー",deletion:"データ削除について",googleLogin:"Googleでログイン",appleLogin:"Appleでログイン"},ko:{heroLeftTop:"구원은 죄가 아니며,",heroLeftMain:"그저 너무 오랫동안 길을 잃었을 뿐이다.",heroLeftSub:"",heroLeftYellow:"들꽃은 용감하게 핀다!",heroRightTop:"새로운 시작을 원해...",heroRightMain:"모든 경험은 독특한 장이며,",heroRightSub:"성장의 장벽이 아니다.",heroRightYellow:"잿더미에서 일어나라!",title:"Restarter™ 회원가입",email:"이메일 *필수",password:"비밀번호 (최소 8자, 영문/숫자 포함) *필수",nickname:"닉네임 (6-16자) *필수",age:"나이*선택",selectAge:"연령대 선택",country:"국가/지역*선택",city:"도시(선택 사항)",interest:"관심사*선택",eventType:"경험한 사건**선택",whatToImprove:"개선하고 싶은 점*선택",uploadAvatar:"아바타 업로드",male:"남성",female:"여성",genderRequired:"(*필수)",register:"🚀 가입하기",registering:"가입 중...",errorAvatar:"아바타를 업로드해주세요.",errorGender:"성별을 선택해주세요.",errorEmailFormat:"유효하지 않은 이메일 형식입니다.",errorPasswordFormat:"비밀번호는 최소 8자 이상이며, 문자와 숫자를 모두 포함해야 합니다.",errorNicknameFormat:"닉네임은 6-16자여야 합니다.",errorAgeFormat:"나이는 18세에서 99세 사이여야 합니다.",errorCountry:"국가를 선택해주세요.",errorRegion:"도시를 입력해주세요.",errorInterest:"관심사를 선택해주세요.",errorEventType:"사건 유형을 선택해주세요.",errorImprovement:"개선할 항목을 선택해주세요.",formTopSlogan:"일어서는 것은 잘못이 아니야!",login:"로그인",terms:"약관/성명서",privacy:"개인정보처리방침",deletion:"데이터 삭제 안내",googleLogin:"Google로 로그인",appleLogin:"Apple로 로그인"},th:{heroLeftTop:"การไถ่บาปไม่ใช่ความผิด",heroLeftMain:"เพียงแค่หลงทางมานานเกินไป",heroLeftSub:"",heroLeftYellow:"ดอกไม้ป่าบานอย่างกล้าหาญ!",heroRightTop:"ฉันต้องการเริ่มต้นใหม่...",heroRightMain:"ทุกประสบการณ์คือบทที่พิเศษ",heroRightSub:"ไม่ใช่อุปสรรคต่อการเติบโต",heroRightYellow:"ลุกขึ้นจากเถ้าถ่าน!",title:"Restarter™ ลงทะเบียน",email:"อีเมล *จำเป็น",password:"รหัสผ่าน (ขั้นต่ำ 8 ตัวอักษร, ประกอบด้วยตัวอักษรและตัวเลข) *จำเป็น",nickname:"ชื่อเล่น (6-16 ตัวอักษร) *จำเป็น",age:"อายุ*ไม่บังคับ",selectAge:"เลือกช่วงอายุ",country:"ประเทศ/ภูมิภาค*ไม่บังคับ",city:"เมือง (ไม่บังคับ)",interest:"ความสนใจ*ไม่บังคับ",eventType:"เหตุการณ์ที่ผ่านมา**ไม่บังคับ",whatToImprove:"สิ่งที่ต้องการปรับปรุง*ไม่บังคับ",uploadAvatar:"อัปโหลดรูปภาพ",male:"ชาย",female:"หญิง",genderRequired:"(*จำเป็น)",register:"🚀 ลงทะเบียน",registering:"กำลังลงทะเบียน...",errorAvatar:"กรุณาอัปโหลดรูปโปรไฟล์",errorGender:"กรุณาเลือกเพศ",errorEmailFormat:"รูปแบบอีเมลไม่ถูกต้อง",errorPasswordFormat:"รหัสผ่านต้องมีความยาวอย่างน้อย 8 ตัวอักษรและมีทั้งตัวอักษรและตัวเลข",errorNicknameFormat:"ชื่อเล่นต้องมีความยาว 6-16 ตัวอักษร",errorAgeFormat:"อายุต้องอยู่ระหว่าง 18 ถึง 99 ปี",errorCountry:"กรุณาเลือกประเทศ",errorRegion:"กรุณากรอกเมือง",errorInterest:"กรุณาเลือกความสนใจ",errorEventType:"กรุณาเลือกประเภทเหตุการณ์",errorImprovement:"กรุณาเลือกรายการที่ต้องการปรับปรุง",formTopSlogan:"การลุกขึ้นสู้ไม่ใช่เรื่องผิด!",login:"เข้าสู่ระบบ",terms:"ข้อกำหนด/คำชี้แจง",privacy:"นโยบายความเป็นส่วนตัว",deletion:"นโยบายการลบข้อมูล",googleLogin:"เข้าสู่ระบบด้วย Google",appleLogin:"เข้าสู่ระบบด้วย Apple"},vi:{heroLeftTop:"Sự chuộc lỗi không phải là tội ác,",heroLeftMain:"chỉ là đi sai đường quá lâu.",heroLeftSub:"",heroLeftYellow:"Hoa dại nở rộ dũng cảm!",heroRightTop:"Tôi muốn một khởi đầu mới...",heroRightMain:"Mỗi trải nghiệm là một chương độc đáo,",heroRightSub:"Không phải là rào cản cho sự phát triển.",heroRightYellow:"Vươn lên từ đống tro tàn!",title:"Đăng ký Restarter™",email:"Email *bắt buộc",password:"Mật khẩu (tối thiểu 8 ký tự, gồm chữ và số) *bắt buộc",nickname:"Biệt danh (6-16 ký tự) *bắt buộc",age:"Tuổi*không bắt buộc",selectAge:"Chọn độ tuổi",country:"Quốc gia/Khu vực*không bắt buộc",city:"Thành phố (tùy chọn)",interest:"Sở thích*không bắt buộc",eventType:"Sự kiện đã trải qua**không bắt buộc",whatToImprove:"Điều muốn cải thiện*không bắt buộc",uploadAvatar:"Tải lên hình đại diện",male:"Nam",female:"Nữ",genderRequired:"(*bắt buộc)",register:"🚀 Đăng ký",registering:"Đang đăng ký...",errorAvatar:"Vui lòng tải lên ảnh đại diện.",errorGender:"Vui lòng chọn giới tính.",errorEmailFormat:"Định dạng email không hợp lệ.",errorPasswordFormat:"Mật khẩu phải dài ít nhất 8 ký tự và chứa cả chữ cái và số.",errorNicknameFormat:"Biệt danh phải dài từ 6-16 ký tự.",errorAgeFormat:"Tuổi phải từ 18 đến 99.",errorCountry:"Vui lòng chọn một quốc gia.",errorRegion:"Vui lòng nhập thành phố.",errorInterest:"Vui lòng chọn một sở thích.",errorEventType:"Vui lòng chọn một loại sự kiện.",errorImprovement:"Vui lòng chọn một mục để cải thiện.",formTopSlogan:"Vươn lên không phải là sai!",login:"Đăng nhập",terms:"Điều khoản/Tuyên bố",privacy:"Chính sách bảo mật",deletion:"Chính sách xóa dữ liệu",googleLogin:"Đăng nhập bằng Google",appleLogin:"Đăng nhập bằng Apple"},ms:{heroLeftTop:"Penebusan bukanlah jenayah,",heroLeftMain:"hanya tersalah jalan terlalu lama.",heroLeftSub:"",heroLeftYellow:"Bunga liar mekar dengan berani!",heroRightTop:"Saya mahu permulaan yang baru...",heroRightMain:"Setiap pengalaman adalah satu bab yang unik,",heroRightSub:"bukan penghalang kepada pertumbuhan.",heroRightYellow:"Bangkit dari abu!",title:"Pendaftaran Restarter™",email:"E-mel *diperlukan",password:"Kata laluan (min 8 aksara, huruf & nombor) *diperlukan",nickname:"Nama samaran (6-16 aksara) *diperlukan",age:"Umur*pilihan",selectAge:"Pilih julat umur",country:"Negara/Wilayah*pilihan",city:"Bandar (pilihan)",interest:"Minat*pilihan",eventType:"Peristiwa Bersejarah**pilihan",whatToImprove:"Apa yang ingin diperbaiki*pilihan",uploadAvatar:"Muat naik gambar profil",male:"Lelaki",female:"Perempuan",genderRequired:"(*diperlukan)",register:"🚀 Daftar",registering:"Mendaftar...",errorAvatar:"Sila muat naik avatar.",errorGender:"Sila pilih jantina.",errorEmailFormat:"Format e-mel tidak sah.",errorPasswordFormat:"Kata laluan mesti sekurang-kurangnya 8 aksara dan mengandungi kedua-dua huruf dan nombor.",errorNicknameFormat:"Nama samaran mestilah 6-16 aksara.",errorAgeFormat:"Umur mestilah antara 18 dan 99.",errorCountry:"Sila pilih negara.",errorRegion:"Sila masukkan bandar.",errorInterest:"Sila pilih minat.",errorEventType:"Sila pilih jenis acara.",errorImprovement:"Sila pilih item untuk diperbaiki.",formTopSlogan:"Bukan salah untuk bangkit!",login:"Log masuk",terms:"Terma/Penyata",privacy:"Dasar Privasi",deletion:"Dasar Pemadaman Data",googleLogin:"Log masuk dengan Google",appleLogin:"Log masuk dengan Apple"},la:{heroLeftTop:"Redemptio non est crimen,",heroLeftMain:"modo errasse diu.",heroLeftSub:"",heroLeftYellow:"Flores feri fortiter efflorescunt!",heroRightTop:"Novum initium volo...",heroRightMain:"Omnis experientia unicum capitulum est,",heroRightSub:"non impedimentum incrementi.",heroRightYellow:"Resurge ex cineribus!",title:"Restarter™ Inscriptio",email:"Email *requiritur",password:"Password (min 8 chars, letter & number) *requiritur",nickname:"Nickname (6-16 chars) *requiritur",age:"Aetas*optio",selectAge:"Selecta aetatis spatium",country:"Patria (Regio)*optio",city:"Urbs (optio)",interest:"Studium*optio",eventType:"Eventus Historiae**optio",whatToImprove:"Quid emendare vis*optio",uploadAvatar:"Upload Avatar",male:"Male",female:"Female",genderRequired:"(*required)",register:"🚀 Register",registering:"Registering...",errorAvatar:"Please upload an avatar.",errorGender:"Please select a gender.",errorEmailFormat:"Invalid email format.",errorPasswordFormat:"Password must be at least 8 characters long and contain both letters and numbers.",errorNicknameFormat:"Nickname must be 6-16 characters long.",errorAgeFormat:"Age must be between 18 and 99.",errorCountry:"Please select a country.",errorRegion:"Please enter a city.",errorInterest:"Please select an interest.",errorEventType:"Please select an event type.",errorImprovement:"Please select an item to improve.",formTopSlogan:"Surgere non est peccatum!",login:"Inire",terms:"Termini/Declaratio",privacy:"Consilium Privacy",deletion:"Norma Deletionis Datae",googleLogin:"Intra cum Google",appleLogin:"Intra cum Apple"}},MS={"zh-TW":"請先補齊個人資料","zh-CN":"请先补齐个人资料",en:"Please complete your profile first",ja:"まずプロフィールを完成させてください",ko:"먼저 프로필을 완성해 주세요",th:"กรุณากรอกข้อมูลส่วนตัวให้ครบก่อน",vi:"Vui lòng hoàn thiện hồ sơ cá nhân trước",ms:"Sila lengkapkan profil anda terlebih dahulu",la:"Quaeso prius profile tuum comple"},LS={"zh-TW":"每一位更生人，都是世界的一員！","zh-CN":"每一位更生人，都是世界的一员！",en:"Every Restarter is still one of us.",ja:"すべての更生者は世界の一員です！",ko:"모든 Restarter는 우리 중 한 명입니다!",th:"ทุกคนที่ถูกกำพฤติกรรมก็ยังเป็นหนึ่งของเรา!",vi:"Mỗi người được định hình đều là một thành viên của chúng tôi!",ms:"Setiap Restarter masih satu di antara kita!",la:"Omnis Restarter adhuc unus ex nobis est."},fN={"zh-TW":"Restarter™ 是更生者的 副駕 / 合作人。","zh-CN":"Restarter™ 是更生者的 副驾 / 合作人。",en:"Restarter™ is a co-pilot/partner for Restarters.",ja:"Restarter™ は更生者の副操縦士・パートナーです。",ko:"Restarter™는 재생자의 부승무 또는 파트너입니다.",th:"Restarter™ เป็นคู่ควบคุมหรือพาร์ทเนอร์สำหรับ Restarters.",vi:"Restarter™ là phi công phụ hoặc đối tác cho Restarters.",ms:"Restarter™ adalah kopilot/pasukan untuk Restarters.",la:"Restarter™ est co-pilotus/socius pro Restarters."},mN={"zh-TW":"Restarter™ 是更生者的情緒管家 / 生產助手","zh-CN":"Restarter™ 是更生者的情绪管家 / 生产助手",en:"Restarter™ is an emotional steward/productivity assistant for Restarters.",ja:"Restarter™ は更生者の感情マネージャー・生産アシスタントです。",ko:"Restarter™는 재생자의 감정 관리자 및 생산 보조자입니다.",th:"Restarter™ เป็นผู้ดูแลอารมณ์และผู้ช่วยในการผลิตสำหรับ Restarters.",vi:"Restarter™ là người quản lý cảm xúc và người trợ giúp sản xuất cho Restarters.",ms:"Restarter™ adalah pengurus emosi / pembantu produktiviti untuk Restarters.",la:"Restarter™ est motus oeconomus/producentis adiutor pro Restarters."},yI={"zh-TW":["經濟","運動","閱讀","電影","旅遊","交友","唱歌","電商","做生意","電腦","AI","寵物","學技能","一個人安靜","其他"],"zh-CN":["经济","运动","阅读","电影","旅游","交友","唱歌","电商","做生意","电脑","AI","宠物","学技能","一个人安静","其他"],en:["Economy","Sports","Reading","Movie","Travel","Friendship","Singing","E-commerce","Business","Computer","AI","Pets","Learning Skills","Quiet time alone","Other"],ja:["経済","スポーツ","読書","映画","旅行","友達","カラオケ","EC","ビジネス","パソコン","AI","ペット","スキル学習","一人で静かに過ごす","その他"],ko:["경제","스포츠","독서","영화","여행","친구 사귀기","노래 부르기","전자상거래","사업","컴퓨터","AI","애완동물","기술 배우기","혼자 조용히 있기","기타"],th:["เศรษฐกิจ","กีฬา","การอ่าน","ภาพยนตร์","การเดินทาง","มิตรภาพ","การร้องเพลง","อีคอมเมิร์ซ","ธุรกิจ","คอมพิวเตอร์","AI","สัตว์เลี้ยง","การเรียนรู้ทักษะ","เวลาเงียบๆคนเดียว","อื่นๆ"],vi:["Kinh tế","Thể thao","Đọc sách","Phim ảnh","Du lịch","Tình bạn","Ca hát","Thương mại điện tử","Kinh doanh","Máy tính","AI","Thú cưng","Học kỹ năng","Ở một mình yên tĩnh","Khác"],ms:["Ekonomi","Sukan","Membaca","Filem","Melancong","Persahabatan","Menyanyi","E-dagang","Perniagaan","Komputer","AI","Haiwan Peliharaan","Belajar Kemahiran","Masa sunyi bersendirian","Lain-lain"],la:["Oeconomia","Ludi","Lectio","Pellicula","Iter","Amicitia","Cantus","E-commercium","Negotium","Computatrum","AI","Animalia Domestica","Discere Artes","Tempus quietum solus","Aliud"]},xI={"zh-TW":["台灣","中國大陸","日本","韓國","馬來西亞","新加坡","印尼","越南","菲律賓","英國","法國","德國","美國","加拿大","非洲","歐洲","南美洲","中東","其他"],"zh-CN":["台湾","中国大陆","日本","韩国","马来西亚","新加坡","印尼","越南","菲律宾","英国","法国","德国","美国","加拿大","非洲","欧洲","南美洲","中东","其他"],en:["Taiwan","China","Japan","Korea","Malaysia","Singapore","Indonesia","Vietnam","Philippines","UK","France","Germany","USA","Canada","Africa","Europe","South America","Middle East","Other"],ja:["台湾","中国","日本","韓国","マレーシア","シンガポール","インドネシア","ベトナム","フィリピン","イギリス","フランス","ドイツ","アメリカ","カナダ","アフリカ","ヨーロッパ","南アメリカ","中東","その他"],ko:["대만","중국","일본","한국","말레이시아","싱가포르","인도네시아","베트남","필리핀","영국","프랑스","독일","미국","캐나다","아프리카","유럽","남아메리카","중동","기타"],th:["ไต้หวัน","จีน","ญี่ปุ่น","เกาหลี","มาเลเซีย","สิงคโปร์","อินโดนีเซีย","เวียดนาม","ฟิลิปปินส์","สหราชอาณาจักร","ฝรั่งเศส","เยอรมนี","สหรัฐอเมริกา","แคนาดา","แอฟริกา","ยุโรป","อเมริกาใต้","ตะวันออกกลาง","อื่นๆ"],vi:["Đài Loan","Trung Quốc","Nhật Bản","Hàn Quốc","Malaysia","Singapore","Indonesia","Việt Nam","Philippines","Anh","Pháp","Đức","Mỹ","Canada","Châu Phi","Châu Âu","Nam Mỹ","Trung Đông","Khác"],ms:["Taiwan","China","Jepun","Korea","Malaysia","Singapura","Indonesia","Vietnam","Filipina","UK","Perancis","Jerman","AS","Kanada","Afrika","Eropah","Amerika Selatan","Timur Tengah","Lain-lain"],la:["Taivania","Sina","Iaponia","Corea","Malaisia","Singapura","Indonesia","Vietnamia","Philippinae","UK","Gallia","Germania","USA","Canada","Africa","Europa","America Meridionalis","Oriens Medius","Aliud"]},bI={"zh-TW":["經濟事件","毒品濫用","暴力事件","家暴加害","家暴受害","幫派背景","詐欺相關","竊盜前科","性別/身體創傷","未成年犯罪","長期失業 / 社會邊緣","其他"],"zh-CN":["经济事件","毒品滥用","暴力事件","家暴加害","家暴受害","帮派背景","诈欺相关","窃盗前科","性别/身体创伤","未成年犯罪","长期失业 / 社会边缘","其他"],en:["Economic Incident","Drug Abuse","Violent Incident","Domestic Violence Perpetrator","Domestic Violence Victim","Gang Affiliation","Fraud-related","Theft Record","Gender/Physical Trauma","Juvenile Delinquency","Long-term Unemployed / Socially Marginalized","Other"],ja:["経済事件","薬物乱用","暴力事件","DV加害","DV被害","ギャング組織所属","詐欺関連","窃盗前科","ジェンダー・身体的トラウマ","未成年犯罪","長期失業・社会的疎外","その他"],ko:["경제 사건","약물 남용","폭력 사건","가정 폭력 가해자","가정 폭력 피해자","조직 폭력배 배경","사기 관련","절도 전과","성별/신체적 트라우마","미성년 범죄","장기 실업/사회적 소외","기타"],th:["เหตุการณ์ทางเศรษฐกิจ","การใช้ยาเสพติด","เหตุการณ์รุนแรง","ผู้กระทำความรุนแรงในครอบครัว","เหยื่อความรุนแรงในครอบครัว","ประวัติแก๊ง","เกี่ยวข้องกับการฉ้อโกง","ประวัติการลักขโมย","การบาดเจ็บทางเพศ/ร่างกาย","การกระทำผิดของเยาวชน","ว่างงานระยะยาว / ถูกกีดกันทางสังคม","อื่นๆ"],vi:["Sự cố kinh tế","Lạm dụng ma túy","Vụ việc bạo lực","Thủ phạm bạo lực gia đình","Nạn nhân bạo lực gia đình","Lý lịch băng đảng","Liên quan đến gian lận","Tiền án trộm cắp","Tổn thương giới tính/thể chất","Phạm pháp vị thành niên","Thất nghiệp dài hạn / Bên lề xã hội","Khác"],ms:["Insiden Ekonomi","Penyalahgunaan Dadah","Insiden Keganasan","Pelaku Keganasan Rumah Tangga","Mangsa Keganasan Rumah Tangga","Latar Belakang Geng","Berkaitan Penipuan","Rekod Curi","Trauma Jantina/Fizikal","Kenakalan Remaja","Pengangguran Jangka Panjang / Terpinggir Sosial","Lain-lain"],la:["Casus Oeconomicus","Abusus Medicamentorum","Casus violentus","Perpetrator Violentiae Domesticae","Victima Violentiae Domesticae","Consociatio Gregis","Ad Fraudem Pertinens","Furtum Record","Trauma Genus/Corporale","Delinquentia Iuvenilis","Longum Tempus Inops / Socialiter Marginatus","Aliud"]},gN={"zh-TW":["人際","鬥志","習慣","工作","情緒","自律","其他"],"zh-CN":["人际","斗志","习惯","工作","情绪","自律","其他"],en:["Interpersonal","Motivation","Habits","Work","Emotions","Self-discipline","Other"],ja:["人間関係","闘志","習慣","仕事","感情","自己規律","その他"],ko:["대인관계","투지","습관","업무","감정","자기관리","기타"],th:["ความสัมพันธ์ระหว่างบุคคล","แรงจูงใจ","นิสัย","การงาน","อารมณ์","การมีวินัยในตนเอง","อื่นๆ"],vi:["Quan hệ giữa các cá nhân","Ý chí chiến đấu","Thói quen","Công việc","Cảm xúc","Kỷ luật tự giác","Khác"],ms:["Antara peribadi","Semangat juang","Tabiat","Kerja","Emosi","Disiplin diri","Lain-lain"],la:["Interpersonalis","Animus","Consuetudines","Opus","Affectus","Disciplina sui","Aliud"]},vI=["18-24","25-29","30-34","35-39","40-44","45-49","50-54","55-59","60-64","65-69","70+"];function yN(n){return/^[^@\s]+@[^@\s]+\.[^@\s]+$/.test(n)}function xN(n){return/^(?=.*[A-Za-z])(?=.*\d)[A-Za-z\d]{8,}$/.test(n)}function bN(n){return!(!n||n.length<6||n.length>16)}function OS(n){if(!n)return null;const e=n.match(/^(Restarter™)(.*)$/);return e?i.jsxs("span",{children:[i.jsx("span",{style:{color:"#fff",fontWeight:700},children:"Restarter™"}),i.jsx("span",{style:{color:"#ffd700",fontWeight:700},children:e[2]})]}):n}function vN({t:n,setShowLogin:e,navigate:t,setShowReset:r}){const[o,a]=v.useState(""),[c,d]=v.useState(""),[h,m]=v.useState(""),g=async x=>{x.preventDefault(),m("");try{await(await aj(Fu,o,c)).user.reload(),e(!1),t("/")}catch(S){S.code==="auth/user-not-found"||S.code==="auth/wrong-password"||S.code==="auth/invalid-credential"?m("帳號或密碼錯誤，請重新確認"):S.code==="auth/user-disabled"?m("此帳號已被停用，請聯絡客服"):m(S.message||"登入失敗，請稍後再試")}};return i.jsx("div",{style:{position:"fixed",top:0,left:0,width:"100%",height:"100%",background:"rgba(0,0,0,0.6)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:200},children:i.jsxs("div",{style:{background:"white",padding:32,borderRadius:16,width:"90%",maxWidth:400,position:"relative",boxShadow:"0 8px 32px #0000004d"},children:[i.jsx("button",{onClick:()=>e(!1),style:{position:"absolute",top:8,right:12,background:"none",border:"none",fontSize:28,cursor:"pointer",color:"#888"},children:"×"}),i.jsx("h2",{style:{textAlign:"center",color:"#333",marginBottom:24},children:n.login}),h&&i.jsx("p",{style:{color:"red",textAlign:"center",marginBottom:"1rem"},children:h}),i.jsxs("form",{onSubmit:g,children:[i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:16},children:[i.jsx("input",{type:"email",autoComplete:"off",placeholder:n.email,value:o,onChange:x=>a(x.target.value),className:"reg-input",required:!0}),i.jsx("input",{type:"password",autoComplete:"off",placeholder:n.password,value:c,onChange:x=>d(x.target.value),className:"reg-input",required:!0})]}),i.jsx("button",{type:"submit",style:{width:"100%",marginTop:24,background:"linear-gradient(90deg, #6e8efb, #a777e3)",color:"white",border:"none",borderRadius:8,padding:"14px 0",fontSize:18,fontWeight:700,cursor:"pointer"},children:n.login}),i.jsx("div",{style:{textAlign:"right",marginTop:8},children:i.jsx("a",{href:"#",style:{color:"#6B5BFF",fontSize:14,textDecoration:"underline",cursor:"pointer"},onClick:x=>{x.preventDefault(),r(!0)},children:"忘記密碼？"})})]})]})})}const ju={border:"none",borderRadius:28,padding:0,fontSize:16,fontWeight:800,cursor:"pointer",boxShadow:"0 2px 12px #a777e355",display:"flex",alignItems:"center",justifyContent:"center",gap:8,width:"100%",height:"40px"},WS={width:18,height:18,marginRight:6,verticalAlign:"middle"};function wN(){const n=_t(),e=gf(),t=new URLSearchParams(e.search),{lang:r,setLang:o}=Mt();v.useEffect(()=>{localStorage.setItem("lang",r)},[r]),v.useEffect(()=>{ud(async()=>{const{getAuth:ke}=await Promise.resolve().then(()=>rz);return{getAuth:ke}},void 0).then(({getAuth:ke})=>{ke().currentUser&&n("/")})},[n]);const a=t.get("needProfile")==="1",c=pN[r],[d,h]=v.useState(""),[m,g]=v.useState(""),[x,S]=v.useState(""),[C,_]=v.useState(""),[I,T]=v.useState(""),[F,P]=v.useState(""),[B,q]=v.useState(""),[te,W]=v.useState(null),[L,R]=v.useState(""),[A,N]=v.useState(""),[O,z]=v.useState(!1),[j,V]=v.useState(""),[X,$]=v.useState(""),[ne,oe]=v.useState(""),[J,Q]=v.useState(!1),[D,G]=v.useState(0),[ie,ee]=v.useState("idle"),[Se,we]=v.useState(""),Oe=v.useRef(null),Ne=v.useRef(null);v.useEffect(()=>{if(!O)return;const ke=setInterval(()=>{G(at=>(at+1)%4)},400);return()=>clearInterval(ke)},[O]);const[Ye,it]=v.useState(!1),[me,Ve]=v.useState(!1),[Xe,Je]=v.useState(!1),[He,fe]=v.useState(!1),[Te,_e]=v.useState(""),[Fe,Be]=v.useState(!1),K=async()=>{if(!Te){N("請輸入驗證碼");return}try{const ke={nickname:x,password:m,gender:B,country:C,region:I,age:F,interest:j,eventType:X,improvement:ne},pe=await(await fetch("https://restarter-backend-6e9s.onrender.com/api/email-verification/verify-code",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:d,code:Te})})).json();pe.success?await H():N(pe.error||"驗證失敗")}catch(ke){N(ke.message||"驗證失敗，請稍後再試")}},re=async ke=>{ke.preventDefault(),N(""),it(!1);let at=setTimeout(()=>it(!0),1e4);if(!te){N(c.errorAvatar);return}if(!B){N(c.errorGender);return}if(!yN(d)){N(c.errorEmailFormat);return}if(!xN(m)){N(c.errorPasswordFormat);return}if(!bN(x)){N(c.errorNicknameFormat);return}if(!F){N(c.errorAgeFormat);return}if(!C){N(c.errorCountry);return}Je(!0);try{const pe={nickname:x,password:m,gender:B,country:C,region:I,age:F,interest:j,eventType:X,improvement:ne};console.log("正在發送 email 驗證碼到:",d);const de=await fetch("https://restarter-backend-6e9s.onrender.com/api/email-verification/send-code",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:d,registrationData:pe})});console.log("Email API 回應狀態:",de.status);const De=await de.json();if(console.log("Email API 回應資料:",De),De.success)Be(!0),fe(!0),Je(!1),clearTimeout(at),it(!1);else throw new Error(De.error||"生成驗證碼失敗")}catch(pe){N(pe.message||"註冊失敗，請稍後再試"),Je(!1),clearTimeout(at),it(!1)}},H=async()=>{var at,pe,de;z(!0);let ke=setTimeout(()=>it(!0),1e4);try{const De=await R0(Fu,d,m);await af(De.user,{displayName:x});let $e="";if(te){const lt=fD(vD,`avatars/${De.user.uid}/${te.name}`),pt=hD(lt,te);let bt=null;await Promise.race([new Promise((gt,Et)=>{pt.on("state_changed",null,Nt=>{bt=Nt,Et(Nt)},async()=>{$e=await pD(pt.snapshot.ref),gt()})}),new Promise((gt,Et)=>setTimeout(()=>{bt=new Error("頭像上傳逾時，請檢查網路或稍後再試"),Et(bt)},2e4))]).catch(gt=>{throw bt||gt}),await af(De.user,{photoURL:$e})}await Ed(Vn(Wt,"profiles",De.user.uid),{nickname:x,email:d,avatar:$e,gender:B,country:C,region:I,age:F,interest:j,eventType:X,improvement:ne,createdAt:new Date,updatedAt:new Date}),localStorage.removeItem("aiAvatar"),localStorage.removeItem("avatarWelcomed"),z(!1),clearTimeout(ke),it(!1),n("/")}catch(De){(at=De==null?void 0:De.message)!=null&&at.includes("Failed to fetch")||(pe=De==null?void 0:De.message)!=null&&pe.includes("NetworkError")||(de=De==null?void 0:De.message)!=null&&de.includes("ECONNREFUSED")?N("伺服器連線失敗，請稍後再試或聯絡管理員"):N((De==null?void 0:De.message)||"註冊失敗，請稍後再試"),z(!1),clearTimeout(ke),it(!1)}},Ue=async()=>{const ke=new Fi;try{z(!0),it(!1);let at=setTimeout(()=>it(!0),1e4);const pe=await Ky(Fu,ke);clearTimeout(at),it(!1),z(!1),n("/")}catch(at){z(!1),it(!1),alert("Google 登入失敗："+at.message)}},ue=async()=>{var at;const ke=new Kl("apple.com");try{console.log("開始 Apple 登入...");const de=(await Ky(Fu,ke)).user;console.log("Apple 登入成功，user.uid:",de.uid),await de.reload(),console.log("user reload 完成");const De=await Cs(Vn(Wt,"users",de.uid));console.log("Firestore 查詢結果:",{exists:De.exists(),data:De.data(),completed:(at=De.data())==null?void 0:at.completed}),!De.exists()||!De.data()||!De.data().completed?(console.log("導向 /CompleteProfile"),n("/CompleteProfile")):(console.log("導向首頁 /"),n("/"))}catch(pe){console.error("Apple 登入錯誤:",pe),alert("Apple 登入失敗："+pe.message)}};async function le(){var at,pe;const ke=(pe=(at=Oe.current)==null?void 0:at.value)==null?void 0:pe.trim();if(!ke){ee("invalid"),we("請輸入暱稱"),setTimeout(()=>{var de;(de=Oe.current)==null||de.focus()},100);return}ee("checking"),we("檢查中...");try{(await(await fetch(`https://restarter-backend-6e9s.onrender.com/api/check-username?name=${encodeURIComponent(ke)}`)).json()).exists?(ee("exists"),we("❌你輸入名稱已有人使用，請重新輸入"),setTimeout(()=>{var $e;($e=Oe.current)==null||$e.focus()},100)):(ee("ok"),we("你的名稱非常好👍"),setTimeout(()=>{var $e;($e=Ne.current)==null||$e.focus()},200))}catch{ee("ok"),we("無法即時檢查名稱是否重複，請直接送出註冊，若重複會有明確錯誤提示"),setTimeout(()=>{var de;(de=Oe.current)==null||de.focus()},100)}}e.pathname;const[Re,rt]=v.useState(!1),[xe,Ae]=v.useState(""),[Ge,ft]=v.useState("");return i.jsxs("div",{style:{minHeight:"100vh",background:"#fff",position:"relative"},children:[a&&i.jsx("div",{style:{position:"absolute",top:"40%",left:"50%",transform:"translate(-50%, -50%)",fontSize:22,color:"#374151",fontWeight:600,textAlign:"center"},children:MS[r]||MS["zh-TW"]}),i.jsx("div",{style:{position:"relative"},children:i.jsxs("div",{style:{minHeight:"100vh",background:"url('/city-blur.jpg') center/cover no-repeat",position:"relative",display:"flex",flexDirection:"column"},children:[window.innerWidth<=768?i.jsxs(i.Fragment,{children:[i.jsxs("button",{onClick:()=>window.history.back(),style:{position:"fixed",top:16,left:16,zIndex:1e3,background:"rgba(255,255,255,0.9)",border:"none",borderRadius:"20px",padding:"8px 16px",fontSize:"14px",fontWeight:"bold",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",color:"#667eea",transition:"all 0.3s ease",boxShadow:"0 2px 8px rgba(0,0,0,0.15)",height:"36px"},onMouseEnter:ke=>{ke.currentTarget.style.background="#667eea",ke.currentTarget.style.color="#fff",ke.currentTarget.style.transform="translateY(-1px)"},onMouseLeave:ke=>{ke.currentTarget.style.background="rgba(255,255,255,0.9)",ke.currentTarget.style.color="#667eea",ke.currentTarget.style.transform="translateY(0)"},children:["← ",r==="zh-TW"||r==="zh-CN"?"返回":r==="en"?"Back":r==="ja"?"戻る":r==="ko"?"돌아가기":r==="vi"?"Quay Lại":r==="th"?"กลับ":r==="la"?"Regredi":r==="ms"?"Kembali":"Back"]}),i.jsx("div",{style:{position:"fixed",top:16,right:16,zIndex:100},children:i.jsx(Bn,{})}),i.jsx("div",{style:{position:"fixed",top:60,left:"50%",transform:"translateX(-50%)",zIndex:100},children:i.jsx("span",{style:{fontWeight:900,fontSize:18,color:"#ffd700",letterSpacing:1,textShadow:"0 2px 8px #23294688",whiteSpace:"nowrap",textAlign:"left",lineHeight:"1.2",marginLeft:"8px"},children:LS[r]})})]}):i.jsxs(i.Fragment,{children:[i.jsxs("button",{onClick:()=>window.history.back(),style:{position:"fixed",top:24,left:24,zIndex:1e3,background:"rgba(255,255,255,0.9)",border:"none",borderRadius:"25px",padding:"8px 16px",fontSize:"14px",fontWeight:"bold",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",color:"#667eea",transition:"all 0.3s ease",boxShadow:"0 4px 12px rgba(0,0,0,0.15)"},onMouseEnter:ke=>{ke.currentTarget.style.background="#667eea",ke.currentTarget.style.color="#fff",ke.currentTarget.style.transform="translateY(-2px)"},onMouseLeave:ke=>{ke.currentTarget.style.background="rgba(255,255,255,0.9)",ke.currentTarget.style.color="#667eea",ke.currentTarget.style.transform="translateY(0)"},children:["← ",r==="zh-TW"||r==="zh-CN"?"返回":r==="en"?"Back":r==="ja"?"戻る":r==="ko"?"돌아가기":r==="vi"?"Quay Lại":r==="th"?"กลับ":r==="la"?"Regredi":r==="ms"?"Kembali":"Back"]}),i.jsx("div",{style:{position:"fixed",top:24,left:"50%",transform:"translateX(-50%)",zIndex:100},children:i.jsx("span",{style:{fontWeight:900,fontSize:24,color:"#ffd700",letterSpacing:2,textShadow:"0 2px 8px #23294688",whiteSpace:"nowrap",textAlign:"left",marginLeft:"12px"},children:LS[r]})}),i.jsx("div",{style:{position:"fixed",top:24,right:36,zIndex:100},children:i.jsx(Bn,{})})]}),i.jsxs("div",{style:{display:"flex",flex:1,minHeight:"100vh",alignItems:"stretch",justifyContent:"center",width:"100%",marginTop:60,flexDirection:window.innerWidth<=768?"column":"row"},children:[i.jsxs("div",{style:{flex:1,display:window.innerWidth<=768?"none":"flex",flexDirection:"column",alignItems:"center",background:"rgba(60,40,20,0.18)",padding:"0 12px",minHeight:"calc(100vh - 60px)",boxSizing:"border-box",justifyContent:"space-between"},children:[i.jsx("div",{style:{position:"relative",width:"100%",textAlign:"center",paddingTop:78},children:i.jsx("div",{style:{fontSize:18,fontWeight:700,textShadow:"0 2px 8px #23294688"},children:OS(fN[r])})}),i.jsx("img",{src:"/left-hero.png",alt:"left hero",style:{width:300,maxWidth:"98%",objectFit:"contain"}}),i.jsxs("div",{style:{paddingBottom:80,textAlign:"center"},children:[i.jsxs("div",{style:{color:"#fff",fontWeight:700,fontSize:22,margin:"12px 0 8px"},children:[c.heroLeftTop,i.jsx("br",{}),c.heroLeftMain,i.jsx("br",{}),c.heroLeftSub]}),i.jsx("div",{style:{color:"#ffd700",fontWeight:700,fontSize:18},children:c.heroLeftYellow})]})]}),J&&i.jsx(vN,{t:c,setShowLogin:Q,navigate:n,setShowReset:rt}),i.jsx("div",{style:{flex:window.innerWidth<=768?"1":"0 1 500px",display:"flex",justifyContent:"center",alignItems:"center",padding:window.innerWidth<=768?"10px":"20px 0",width:window.innerWidth<=768?"100%":"auto"},children:i.jsxs("form",{onSubmit:re,style:{background:"#ffffffcc",borderRadius:20,padding:window.innerWidth<=768?"20px 16px":"24px 32px",width:"100%",maxWidth:window.innerWidth<=768?"100%":500,boxShadow:"0 8px 32px #0000004d",position:"relative",boxSizing:"border-box",margin:window.innerWidth<=768?"0 10px":"0"},children:[i.jsx("img",{src:"/ctx-logo.png",alt:"Logo",style:{width:window.innerWidth<=768?60:100,height:window.innerWidth<=768?60:100,position:"absolute",top:5,left:5,zIndex:0,opacity:1}}),i.jsxs("div",{style:{position:"relative",zIndex:1},children:[i.jsx("div",{style:{width:"100%",textAlign:"center",fontWeight:900,fontSize:window.innerWidth<=768?20:26,color:"#ffd700",marginBottom:8,textShadow:"0 2px 4px #00000055"},children:c.formTopSlogan}),i.jsx("h2",{style:{textAlign:"center",color:"#333",marginBottom:16,fontSize:window.innerWidth<=768?24:28,fontWeight:800},children:c.title}),A&&i.jsx("p",{style:{color:"red",textAlign:"center",marginBottom:"1rem"},children:A}),He&&i.jsxs("div",{style:{background:"linear-gradient(135deg, #3b82f6, #1d4ed8)",color:"white",padding:"16px",borderRadius:"12px",marginBottom:"1rem",textAlign:"center",boxShadow:"0 4px 12px rgba(59, 130, 246, 0.3)"},children:[i.jsx("div",{style:{fontSize:"20px",marginBottom:"8px"},children:"📧"}),i.jsx("div",{style:{fontWeight:"bold",marginBottom:"8px"},children:"請輸入驗證碼"}),i.jsxs("div",{style:{fontSize:"14px",marginBottom:"12px"},children:["驗證碼已發送到 ",d]}),i.jsx("input",{type:"text",value:Te,onChange:ke=>_e(ke.target.value),placeholder:"請輸入 6 位數驗證碼",style:{width:"150px",padding:"8px 12px",borderRadius:"6px",border:"none",fontSize:"16px",textAlign:"center",marginRight:"8px"},maxLength:6}),i.jsx("button",{onClick:K,disabled:!Te||Te.length!==6,style:{background:Te&&Te.length===6?"#10b981":"#6b7280",color:"white",border:"none",padding:"8px 16px",borderRadius:"6px",fontSize:"14px",fontWeight:"bold",cursor:Te&&Te.length===6?"pointer":"not-allowed"},children:"驗證並註冊"})]}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:window.innerWidth<=768?"1fr":"1fr 1fr",gap:window.innerWidth<=768?"12px":"12px 16px",width:"100%",minWidth:0},children:[i.jsx("input",{type:"email",autoComplete:"off",placeholder:c.email,value:d,onChange:ke=>h(ke.target.value),style:{gridColumn:"1 / -1",width:"100%",minWidth:0,maxWidth:"100%",boxSizing:"border-box",overflow:"hidden"},className:"reg-input",required:!0}),i.jsx("input",{type:"password",autoComplete:"off",placeholder:c.password,value:m,onChange:ke=>g(ke.target.value),style:{gridColumn:"1 / -1",width:"100%",minWidth:0,maxWidth:"100%",boxSizing:"border-box",overflow:"hidden"},className:"reg-input",required:!0}),i.jsx("input",{type:"text",autoComplete:"off",placeholder:c.nickname,value:x,onChange:ke=>{S(ke.target.value),ee("idle"),we("")},onBlur:le,className:"reg-input",style:{width:"100%",minWidth:0,maxWidth:"100%",boxSizing:"border-box",overflow:"hidden",color:"#888"},required:!0,ref:Oe}),Se&&i.jsx("div",{style:{gridColumn:"1 / -1",color:ie==="ok"?"#1a7f1a":ie==="invalid"||ie==="exists"?"red":"#333",fontSize:14,marginTop:-8,marginBottom:4},children:Se}),i.jsxs("select",{value:F,onChange:ke=>P(ke.target.value),className:"reg-input",style:{width:"100%",minWidth:0,maxWidth:"100%",boxSizing:"border-box",overflow:"hidden",color:F?"#333":"#888"},required:!0,children:[i.jsx("option",{value:"",style:{color:"#888"},children:c.selectAge}),vI.map(ke=>i.jsx("option",{value:ke,children:ke},ke))]}),i.jsxs("select",{value:C,onChange:ke=>_(ke.target.value),className:"reg-input",style:{width:"100%",minWidth:0,maxWidth:"100%",boxSizing:"border-box",overflow:"hidden",color:C?"#333":"#888"},required:!0,children:[i.jsx("option",{value:"",style:{color:"#888"},children:c.country}),(xI[r]||[]).map(ke=>i.jsx("option",{value:ke,children:ke},ke))]}),i.jsx("input",{type:"text",placeholder:c.city,value:I,onChange:ke=>T(ke.target.value),className:"reg-input",style:{width:"100%",minWidth:0,maxWidth:"100%",boxSizing:"border-box",overflow:"hidden"}}),i.jsxs("select",{value:j,onChange:ke=>V(ke.target.value),className:"reg-input",style:{width:"100%",minWidth:0,maxWidth:"100%",boxSizing:"border-box",overflow:"hidden",color:j?"#333":"#888"},children:[i.jsx("option",{value:"",style:{color:"#888"},children:c.interest}),(yI[r]||[]).map(ke=>i.jsx("option",{value:ke,children:ke},ke))]}),i.jsxs("select",{value:X,onChange:ke=>$(ke.target.value),className:"reg-input",style:{width:"100%",minWidth:0,maxWidth:"100%",boxSizing:"border-box",overflow:"hidden",color:X?"#333":"#888"},children:[i.jsx("option",{value:"",style:{color:"#888"},children:c.eventType}),(bI[r]||[]).map(ke=>i.jsx("option",{value:ke,children:ke},ke))]}),i.jsxs("select",{value:ne,onChange:ke=>oe(ke.target.value),className:"reg-input",style:{gridColumn:"1 / -1",width:"100%",minWidth:0,maxWidth:"100%",boxSizing:"border-box",overflow:"hidden",color:ne?"#333":"#888"},children:[i.jsx("option",{value:"",style:{color:"#888"},children:c.whatToImprove}),(gN[r]||[]).map(ke=>i.jsx("option",{value:ke,children:ke},ke))]}),i.jsx("div",{style:{gridColumn:"1 / -1",display:"flex",flexDirection:"column",alignItems:"center",marginBottom:8},children:i.jsxs("label",{htmlFor:"avatar-upload",style:{cursor:"pointer",display:"flex",flexDirection:"column",alignItems:"center",gap:4},children:[i.jsx("div",{style:{width:64,height:64,borderRadius:"50%",overflow:"hidden",background:"#eee",border:"2px solid #b6b6f6",marginBottom:4},children:L?i.jsx("img",{src:L,alt:"avatar",style:{width:"100%",height:"100%",objectFit:"cover"}}):i.jsx("span",{style:{display:"flex",width:"100%",height:"100%",alignItems:"center",justifyContent:"center",color:"#bbb",fontSize:32},children:"+"})}),i.jsx("span",{style:{color:"#6B5BFF",fontWeight:700,fontSize:15},children:c.uploadAvatar}),i.jsx("input",{id:"avatar-upload",type:"file",accept:"image/*",style:{display:"none"},onChange:ke=>{if(ke.target.files&&ke.target.files[0]){W(ke.target.files[0]);const at=new FileReader;at.onload=pe=>{var de;return R((de=pe.target)==null?void 0:de.result)},at.readAsDataURL(ke.target.files[0])}}})]})}),i.jsxs("div",{style:{gridColumn:"1 / -1",display:"flex",alignItems:"center",gap:18,justifyContent:"center",marginBottom:8},children:[i.jsx("span",{style:{fontWeight:600,color:"#6B5BFF",fontSize:15},children:c.genderRequired}),i.jsxs("label",{style:{display:"flex",alignItems:"center",gap:4},children:[i.jsx("input",{type:"radio",name:"gender",value:"male",checked:B==="male",onChange:()=>q("male"),required:!0}),i.jsx("span",{children:c.male})]}),i.jsxs("label",{style:{display:"flex",alignItems:"center",gap:4},children:[i.jsx("input",{type:"radio",name:"gender",value:"female",checked:B==="female",onChange:()=>q("female"),required:!0}),i.jsx("span",{children:c.female})]})]})]}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:window.innerWidth<=768?"1fr":"1fr 1fr",gap:8,margin:"16px 0 8px 0"},children:[me?i.jsxs("div",{style:{gridColumn:"1 / -1",display:"flex",flexDirection:"column",gap:"12px",alignItems:"center"},children:[i.jsxs("div",{style:{textAlign:"center",marginBottom:"8px"},children:[i.jsx("p",{style:{color:"#6B5BFF",fontWeight:600,marginBottom:"4px"},children:"📧 確認郵件已發送到您的 email"}),i.jsx("p",{style:{color:"#666",fontSize:"14px"},children:"請檢查您的收件匣並點擊確認連結完成註冊"})]}),i.jsxs("div",{style:{background:"#f8f9ff",padding:"16px",borderRadius:"8px",border:"1px solid #e0e7ff",textAlign:"center"},children:[i.jsx("p",{style:{color:"#6B5BFF",fontWeight:600,marginBottom:"8px"},children:"📬 請查看您的 email"}),i.jsxs("p",{style:{color:"#666",fontSize:"14px",marginBottom:"12px"},children:["我們已發送確認郵件到：",i.jsx("strong",{children:d})]}),i.jsx("p",{style:{color:"#666",fontSize:"12px"},children:"點擊郵件中的「✅ 確認註冊」按鈕即可完成註冊"})]}),i.jsx("button",{type:"button",onClick:()=>{Ve(!1),N("")},style:{...ju,background:"#f5f5f5",color:"#666",border:"1px solid #ddd",width:"120px"},children:"🔄 重新發送"})]}):i.jsxs("button",{type:"submit",disabled:O||Xe,style:{...ju,background:"linear-gradient(90deg, #6e8efb, #a777e3)",color:"white",opacity:O||Xe?.6:1,cursor:O||Xe?"not-allowed":"pointer"},children:[O?i.jsxs("span",{style:{display:"flex",alignItems:"center",justifyContent:"center",fontWeight:700,fontSize:18},children:[c.registering,".".repeat(D+1)]}):Xe?i.jsx("span",{style:{display:"flex",alignItems:"center",justifyContent:"center",fontWeight:700,fontSize:18},children:"註冊中..."}):i.jsx("span",{style:{marginRight:10},children:"🚀"}),!O&&!Xe&&c.register]}),i.jsxs("button",{type:"button",onClick:()=>Q(!0),disabled:O,style:{...ju,background:"linear-gradient(90deg, #89f7fe, #66a6ff)",color:"white",opacity:O?.6:1,cursor:O?"not-allowed":"pointer"},children:[i.jsx("span",{style:{marginRight:10},children:"🔑"}),c.login]}),i.jsxs("button",{type:"button",onClick:Ue,disabled:O,style:{...ju,background:"#fff",color:"#333",opacity:O?.6:1,cursor:O?"not-allowed":"pointer"},children:[i.jsx("img",{src:"https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg",alt:"Google",style:WS}),c.googleLogin]}),i.jsxs("button",{type:"button",onClick:ue,disabled:O,style:{...ju,background:"#000",color:"#fff",opacity:O?.6:1,cursor:O?"not-allowed":"pointer"},children:[i.jsx("img",{src:"https://upload.wikimedia.org/wikipedia/commons/f/fa/Apple_logo_black.svg",alt:"Apple",style:{...WS,filter:"invert(1)"}}),c.appleLogin]})]}),i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:24,gap:8,flexDirection:"row",textAlign:"center",fontSize:12,flexWrap:"nowrap",overflow:"hidden"},children:[i.jsx("a",{href:"/privacy-policy",style:{color:"#6B5BFF",textDecoration:"underline",fontSize:12,flex:1,textAlign:"center",whiteSpace:"nowrap"},children:c.privacy||"隱私權政策"}),i.jsx("span",{style:{color:"#666",fontSize:12},children:"/"}),i.jsx("button",{type:"button",onClick:()=>n("/terms"),style:{background:"none",border:"none",color:"#666",textDecoration:"underline",cursor:"pointer",fontSize:12,flex:1,textAlign:"center",whiteSpace:"nowrap"},children:c.terms}),i.jsx("span",{style:{color:"#666",fontSize:12},children:"/"}),i.jsx("a",{href:"/data-deletion",style:{color:"#6B5BFF",textDecoration:"underline",fontSize:12,flex:1,textAlign:"center",whiteSpace:"nowrap"},children:c.deletion||"資料刪除說明"})]})]})]})}),i.jsxs("div",{style:{flex:1,display:window.innerWidth<=768?"none":"flex",flexDirection:"column",alignItems:"center",background:"rgba(60,40,20,0.18)",padding:"0 12px",minHeight:"calc(100vh - 60px)",boxSizing:"border-box",justifyContent:"space-between"},children:[i.jsx("div",{style:{position:"relative",width:"100%",textAlign:"center",paddingTop:78},children:i.jsx("div",{style:{fontSize:18,fontWeight:700,textShadow:"0 2px 8px #23294688"},children:OS(mN[r])})}),i.jsx("img",{src:"/right-hero.png",alt:"right hero",style:{width:280,maxWidth:"98%",objectFit:"contain"}}),i.jsxs("div",{style:{paddingBottom:80,textAlign:"center"},children:[i.jsx("div",{style:{color:"#fff",fontWeight:700,fontSize:22,margin:"12px 0 8px"},children:c.heroRightMain}),i.jsx("div",{style:{color:"#ffd700",fontWeight:700,fontSize:18},children:c.heroRightYellow})]})]})]}),i.jsx("div",{style:{position:"fixed",bottom:10,left:36,color:"#fff",textShadow:"0 1px 2px #000",fontSize:14,zIndex:10},children:"CTX Goodlife Copyright 2025"})]})}),Re&&i.jsx("div",{style:{position:"fixed",left:0,top:0,width:"100vw",height:"100vh",background:"rgba(40,40,80,0.18)",zIndex:1e4,display:"flex",alignItems:"center",justifyContent:"center"},children:i.jsxs("div",{style:{background:"#fff",borderRadius:18,boxShadow:"0 4px 24px #6B5BFF33",padding:28,minWidth:280,maxWidth:340,width:"90vw",position:"relative",display:"flex",flexDirection:"column",gap:12},children:[i.jsx("button",{type:"button",onClick:()=>rt(!1),style:{position:"absolute",top:10,right:12,background:"none",border:"none",fontSize:22,color:"#888",cursor:"pointer",fontWeight:700},children:"×"}),i.jsx("div",{style:{fontWeight:800,fontSize:18,color:"#6B5BFF",textAlign:"center",marginBottom:2},children:"重設密碼"}),i.jsx("input",{type:"email",value:xe,onChange:ke=>Ae(ke.target.value),placeholder:"請輸入註冊時的 email",style:{border:"1px solid #e0e7ff",borderRadius:8,padding:"6px 10px",fontSize:15}}),i.jsx("button",{onClick:async()=>{ft("");try{await sj(Fu,xe),ft("已寄出密碼重設信，請到信箱收信！")}catch{ft("發送失敗，請確認 email 是否正確")}},style:{background:"linear-gradient(90deg, #6e8efb, #a777e3)",color:"#fff",border:"none",borderRadius:14,padding:"6px 18px",fontWeight:700,fontSize:15,cursor:"pointer",alignSelf:"center"},children:"發送重設信"}),Ge&&i.jsx("div",{style:{color:"#6B5BFF",fontWeight:700,textAlign:"center",marginTop:8},children:Ge})]})}),Ye&&i.jsx("div",{style:{color:"#ff9800",textAlign:"center",marginTop:8,fontWeight:600},children:"網路較慢，請耐心等候..."})]})}const Iu={"zh-TW":{back:"← 返回上一頁",title:"我的連結",chat:"進入聊天",task:"共修任務",noLink:"目前沒有已建立的連結",goal:"目標："},"zh-CN":{back:"← 返回上一页",title:"我的连接",chat:"进入聊天",task:"共修任务",noLink:"目前没有已建立的连接",goal:"目标："},en:{back:"← Back",title:"My Links",chat:"Chat",task:"Co-Task",noLink:"No links established",goal:"Goal: "},ja:{back:"← 前のページへ",title:"私のリンク",chat:"チャットへ",task:"共修タスク",noLink:"まだリンクがありません",goal:"目標："},ko:{back:"← 이전 페이지",title:"내 링크",chat:"채팅하기",task:"공동 작업",noLink:"아직 연결된 링크가 없습니다",goal:"목표: "},th:{back:"← กลับ",title:"ลิงก์ของฉัน",chat:"แชท",task:"งานร่วมกัน",noLink:"ยังไม่มีลิงก์ที่สร้างขึ้น",goal:"เป้าหมาย: "},vi:{back:"← Quay lại",title:"Liên kết của tôi",chat:"Trò chuyện",task:"Nhiệm vụ chung",noLink:"Chưa có liên kết nào",goal:"Mục tiêu: "},ms:{back:"← Kembali",title:"Pautan Saya",chat:"Sembang",task:"Tugas Bersama",noLink:"Belum ada pautan yang dibuat",goal:"Matlamat: "},la:{back:"← Redire",title:"Nexus Mei",chat:"Colloquium",task:"Munus Commune",noLink:"Nullae nexus constitutae",goal:"Propositum: "}},SN={"zh-TW":{connected:"已配對",pending:"等待對方回覆",rejected:"已拒絕"},"zh-CN":{connected:"已配对",pending:"等待对方回复",rejected:"已拒绝"},en:{connected:"Connected",pending:"Pending",rejected:"Rejected"},ja:{connected:"マッチ済み",pending:"返事待ち",rejected:"拒否されました"},ko:{connected:"연결됨",pending:"대기 중",rejected:"거절됨"},th:{connected:"เชื่อมต่อแล้ว",pending:"รอการตอบกลับ",rejected:"ถูกปฏิเสธ"},vi:{connected:"Đã kết nối",pending:"Đang chờ",rejected:"Đã bị từ chối"},ms:{connected:"Telah dihubungkan",pending:"Menunggu",rejected:"Ditolak"},la:{connected:"Coniunctus",pending:"Exspectans",rejected:"Reiectus"}},hp={"zh-TW":"解除連結","zh-CN":"解除连接",en:"Remove",ja:"リンク解除",ko:"연결 해제",th:"ยกเลิกการเชื่อมต่อ",vi:"Hủy liên kết",ms:"Buang Pautan",la:"Remove"},pp={"zh-TW":"取消邀請","zh-CN":"取消邀请",en:"Cancel Invite",ja:"招待をキャンセル",ko:"초대 취소",th:"ยกเลิกคำเชิญ",vi:"Hủy lời mời",ms:"Batal Jemputan",la:"Invitationem Remove"};function nx(n){const e=_t(),{lang:t,setLang:r}=Mt(),[o,a]=v.useState([]),[c,d]=v.useState(null),[h,m]=v.useState(!0),[g,x]=v.useState(null),[S,C]=v.useState(null),_=t;v.useEffect(()=>{const P=Ns(ya,async B=>{B?(d(B),await I(B.uid)):e("/")});return()=>P()},[e]);const I=async P=>{try{m(!0);const B=Cn(Wt,"links"),q=hr(B,Rn("user1Id","==",P)),te=hr(B,Rn("user2Id","==",P)),[W,L]=await Promise.all([Mr(q),Mr(te)]),R=[];W.forEach(A=>{const N=A.data();R.push({id:A.id,...N})}),L.forEach(A=>{const N=A.data();R.push({id:A.id,user1Id:N.user2Id,user1Name:N.user2Name,user2Id:N.user1Id,user2Name:N.user1Name,role:N.role,goal:N.goal,status:N.status,createdAt:N.createdAt})}),a(R),m(!1)}catch(B){console.error("Error loading links:",B),m(!1)}},T=async P=>{try{await Zp(Vn(Wt,"links",P)),x(null),alert(hp[_]+" 成功！")}catch(B){console.error("Error removing link:",B),alert("操作失敗")}},F=async P=>{try{await Zp(Vn(Wt,"links",P)),C(null),alert(pp[_]+" 成功！")}catch(B){console.error("Error canceling link:",B),alert("操作失敗")}};return h?i.jsx("div",{style:n.embedded?{width:"100%",background:"none",minHeight:"unset",boxShadow:"none",padding:0}:{background:"url('/green_hut.png') center center / cover no-repeat",minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center"},children:i.jsx("div",{style:{color:"#fff",fontSize:18},children:"載入中..."})}):i.jsxs("div",{style:n.embedded?{width:"100%",background:"none",minHeight:"unset",boxShadow:"none",padding:0}:{background:"url('/green_hut.png') center center / cover no-repeat",minHeight:"100vh",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",paddingTop:40},children:[!n.embedded&&i.jsx("button",{onClick:()=>e("/friend"),style:{position:"absolute",top:24,left:24,zIndex:10,background:"#fff",border:"1.5px solid #6B5BFF",color:"#6B5BFF",borderRadius:8,padding:"6px 18px",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:"0 2px 8px #0001"},children:Iu[_].back}),!n.embedded&&i.jsx(Bn,{}),i.jsxs("div",{style:{maxWidth:500,margin:n.embedded?"0 auto":"40px auto",background:"#fff",borderRadius:16,boxShadow:n.embedded?"none":"0 2px 8px #0001",padding:32},children:[i.jsx("h2",{style:{fontWeight:700,fontSize:22,marginBottom:24},children:Iu[_].title}),o.length===0&&i.jsx("div",{style:{color:"#888"},children:Iu[_].noLink}),o.map(P=>i.jsxs("div",{style:{marginBottom:24,borderBottom:"1px solid #eee",paddingBottom:16,opacity:P.status==="rejected"?.5:1},children:[i.jsxs("div",{style:{fontWeight:600},children:[P.user2Name,"（",P.role,"）"]}),i.jsxs("div",{style:{color:"#666",margin:"8px 0"},children:[Iu[_].goal,P.goal]}),i.jsx("div",{style:{color:P.status==="connected"?"#23c6e6":P.status==="pending"?"#e6b800":"#e4572e",fontWeight:700,marginBottom:8},children:SN[_][P.status]}),i.jsxs("div",{style:{display:"flex",gap:12},children:[P.status==="connected"&&i.jsx("button",{onClick:()=>e("/chatroom"),style:{background:"#8ec6f7",color:"#fff",border:"none",borderRadius:6,padding:"6px 18px",fontWeight:700,cursor:"pointer"},children:Iu[_].chat}),P.status==="connected"&&i.jsx("button",{onClick:()=>x(P.id),style:{background:"#eee",color:"#888",border:"none",borderRadius:6,padding:"6px 18px",fontWeight:700,cursor:"pointer"},children:hp[_]}),P.status==="pending"&&i.jsx("button",{onClick:()=>C(P.id),style:{background:"#eee",color:"#888",border:"none",borderRadius:6,padding:"6px 18px",fontWeight:700,cursor:"pointer"},children:pp[_]})]})]},P.id))]}),g&&i.jsx("div",{style:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",background:"#0006",zIndex:9999,display:"flex",alignItems:"center",justifyContent:"center"},children:i.jsxs("div",{style:{background:"#fff",borderRadius:12,padding:32,boxShadow:"0 2px 16px #0002",minWidth:280},children:[i.jsx("div",{style:{fontWeight:700,fontSize:18,marginBottom:18},children:hp[_]}),i.jsxs("div",{style:{display:"flex",gap:16,justifyContent:"flex-end"},children:[i.jsx("button",{onClick:()=>x(null),style:{background:"#eee",color:"#888",border:"none",borderRadius:6,padding:"6px 18px",fontWeight:700,cursor:"pointer"},children:"取消"}),i.jsx("button",{onClick:()=>T(g),style:{background:"#e4572e",color:"#fff",border:"none",borderRadius:6,padding:"6px 18px",fontWeight:700,cursor:"pointer"},children:hp[_]})]})]})}),S&&i.jsx("div",{style:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",background:"#0006",zIndex:9999,display:"flex",alignItems:"center",justifyContent:"center"},children:i.jsxs("div",{style:{background:"#fff",borderRadius:12,padding:32,boxShadow:"0 2px 16px #0002",minWidth:280},children:[i.jsx("div",{style:{fontWeight:700,fontSize:18,marginBottom:18},children:pp[_]}),i.jsxs("div",{style:{display:"flex",gap:16,justifyContent:"flex-end"},children:[i.jsx("button",{onClick:()=>C(null),style:{background:"#eee",color:"#888",border:"none",borderRadius:6,padding:"6px 18px",fontWeight:700,cursor:"pointer"},children:"取消"}),i.jsx("button",{onClick:()=>F(S),style:{background:"#e4572e",color:"#fff",border:"none",borderRadius:6,padding:"6px 18px",fontWeight:700,cursor:"pointer"},children:pp[_]})]})]})})]})}const Ai={"zh-TW":{back:"← 返回上一頁",title:"邀請通知",accept:"接受",reject:"拒絕",noInvite:"目前沒有新的邀請",goal:"目標："},"zh-CN":{back:"← 返回上一页",title:"邀请通知",accept:"接受",reject:"拒绝",noInvite:"目前没有新的邀请",goal:"目标："},en:{back:"← Back",title:"Invitations",accept:"Accept",reject:"Reject",noInvite:"No new invitations",goal:"Goal: "},ja:{back:"← 前のページへ",title:"招待通知",accept:"承認",reject:"拒否",noInvite:"新しい招待はありません",goal:"目標："},ko:{back:"← 이전 페이지",title:"초대 알림",accept:"수락",reject:"거절",noInvite:"새 초대가 없습니다",goal:"목표: "},th:{back:"← กลับ",title:"การแจ้งเตือนคำเชิญ",accept:"ยอมรับ",reject:"ปฏิเสธ",noInvite:"ไม่มีคำเชิญใหม่",goal:"เป้าหมาย: "},vi:{back:"← Quay lại",title:"Thông báo mời",accept:"Chấp nhận",reject:"Từ chối",noInvite:"Không có lời mời mới",goal:"Mục tiêu: "},ms:{back:"← Kembali",title:"Notis Jemputan",accept:"Terima",reject:"Tolak",noInvite:"Tiada jemputan baru",goal:"Matlamat: "},la:{back:"← Redire",title:"Notitia Invitationis",accept:"Accipe",reject:"Reici",noInvite:"Nullae invitationes novae",goal:"Propositum: "}};function rx(n){const[e,t]=v.useState([]),{lang:r,setLang:o}=Mt(),[a,c]=v.useState(null),[d,h]=v.useState(!0),[m,g]=v.useState(null),x=_t();v.useEffect(()=>{let _;const I=Ns(ya,async T=>{T?(c(T),_=await S(T.uid)):x("/")});return()=>{I(),_&&_()}},[x]);const S=async _=>{try{h(!0);const I=Cn(Wt,"invites"),T=hr(I,Rn("toUserId","==",_),Rn("status","==","pending"));return x0(T,P=>{const B=[];P.forEach(q=>{B.push({id:q.id,...q.data()})}),t(B),h(!1)})}catch(I){console.error("Error loading invites:",I),h(!1);return}},C=async(_,I)=>{if(a)try{const T=Vn(Wt,"invites",_);if(I){await Jp(T,{status:"accepted"});const F=e.find(P=>P.id===_);F&&await ys(Cn(Wt,"links"),{user1Id:F.fromUserId,user1Name:F.fromUserName,user2Id:F.toUserId,user2Name:F.toUserName,role:F.role,goal:F.goal,status:"connected",createdAt:new Date}),g(Ai[r].accept+" 成功！"),setTimeout(()=>g(null),2e3)}else await Jp(T,{status:"rejected"}),g(Ai[r].reject+" 成功！"),setTimeout(()=>g(null),2e3)}catch(T){console.error("Error handling invite:",T),alert("操作失敗")}};return d?i.jsx("div",{style:n.embedded?{width:"100%",background:"none",minHeight:"unset",boxShadow:"none",padding:0}:{background:"url('/green_hut.png') center center / cover no-repeat",minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center"},children:i.jsx("div",{style:{color:"#fff",fontSize:18},children:"載入中..."})}):!d&&e.length===0?i.jsxs("div",{style:n.embedded?{width:"100%",background:"none",minHeight:"unset",boxShadow:"none",padding:0}:{background:"url('/green_hut.png') center center / cover no-repeat",minHeight:"100vh",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",paddingTop:40},children:[!n.embedded&&i.jsx("button",{onClick:()=>x("/friend"),style:{position:"absolute",top:24,left:24,zIndex:10,background:"#fff",border:"1.5px solid #6B5BFF",color:"#6B5BFF",borderRadius:8,padding:"6px 18px",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:"0 2px 8px #0001"},children:Ai[r].back}),i.jsx(Bn,{}),i.jsxs("div",{style:{maxWidth:500,margin:n.embedded?"0 auto":"40px auto",background:"#fff",borderRadius:16,boxShadow:n.embedded?"none":"0 2px 8px #0001",padding:32},children:[i.jsx("h2",{style:{fontWeight:700,fontSize:22,marginBottom:24},children:Ai[r].title}),i.jsx("div",{style:{color:"#888",textAlign:"center",fontSize:18},children:Ai[r].noInvite})]})]}):i.jsxs("div",{style:n.embedded?{width:"100%",background:"none",minHeight:"unset",boxShadow:"none",padding:0}:{background:"url('/green_hut.png') center center / cover no-repeat",minHeight:"100vh",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",paddingTop:40},children:[m&&i.jsx("div",{style:{position:"fixed",top:40,left:"50%",transform:"translateX(-50%)",background:"#fff",color:"#6B5BFF",fontWeight:700,fontSize:18,borderRadius:16,boxShadow:"0 4px 24px #6B5BFF22",padding:"18px 36px",zIndex:99999,textAlign:"center",letterSpacing:1},children:m}),!n.embedded&&i.jsx("button",{onClick:()=>x("/friend"),style:{position:"absolute",top:24,left:24,zIndex:10,background:"#fff",border:"1.5px solid #6B5BFF",color:"#6B5BFF",borderRadius:8,padding:"6px 18px",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:"0 2px 8px #0001"},children:Ai[r].back}),i.jsx(Bn,{}),i.jsxs("div",{style:{maxWidth:500,margin:n.embedded?"0 auto":"40px auto",background:"#fff",borderRadius:16,boxShadow:n.embedded?"none":"0 2px 8px #0001",padding:32},children:[i.jsx("h2",{style:{fontWeight:700,fontSize:22,marginBottom:24},children:Ai[r].title}),e.map(_=>i.jsxs("div",{style:{marginBottom:24,borderBottom:"1px solid #eee",paddingBottom:16},children:[i.jsxs("div",{style:{fontWeight:600},children:[_.fromUserName," 邀請你成為 ",_.role]}),i.jsxs("div",{style:{color:"#666",margin:"8px 0"},children:[Ai[r].goal,_.goal]}),i.jsx("button",{onClick:()=>C(_.id,!0),style:{marginRight:12,background:"#8ec6f7",color:"#fff",border:"none",borderRadius:6,padding:"6px 18px",fontWeight:700,cursor:"pointer"},children:Ai[r].accept}),i.jsx("button",{onClick:()=>C(_.id,!1),style:{background:"#eee",color:"#888",border:"none",borderRadius:6,padding:"6px 18px",fontWeight:700,cursor:"pointer"},children:Ai[r].reject})]},_.id))]})]})}const Ft={backToHome:{"zh-TW":"← 返回","zh-CN":"← 返回",ja:"← 戻る",en:"← Back",ko:"← 뒤로",th:"← กลับ",vi:"← Quay lại",ms:"← Kembali",la:"← Redire"},logout:{"zh-TW":"登出","zh-CN":"登出",ja:"ログアウト",en:"Logout",ko:"로그아웃",th:"ออกจากระบบ",vi:"Đăng xuất",ms:"Log keluar",la:"Exire"},pageTitle:{"zh-TW":"【破繭重生】夥伴計畫","zh-CN":"【破茧重生】伙伴计划",ja:"【再出発】パートナー計画",en:"Project Butterfly",ko:"【새출발】 파트너 계획",th:"【เกิดใหม่】แผนพันธมิตร",vi:"【Tái sinh】Kế hoạch đối tác",ms:"【Lahir Semula】Rancangan Rakan Kongsi",la:"【Renascitur】Propositum Socius"},editProfile:{"zh-TW":"編輯我的檔案","zh-CN":"编辑我的档案",ja:"プロフィール編集",en:"Edit My Profile",ko:"내 프로필 편집",th:"แก้ไขโปรไฟล์ของฉัน",vi:"Chỉnh sửa hồ sơ của tôi",ms:"Sunting Profil Saya",la:"Meum Profilum Muta"},partnerRoleTitle:{"zh-TW":"我想尋找的夥伴角色","zh-CN":"我想寻找的伙伴角色",ja:"探している仲間",en:"I'm looking for a",ko:"찾고 있는 파트너 역할",th:"บทบาทพันธมิตรที่ฉันมองหา",vi:"Vai trò đối tác tôi đang tìm",ms:"Peranan Rakan Kongsi Yang Saya Cari",la:"Partem Socii Quam Quæro"},peer:{"zh-TW":"同行者","zh-CN":"同行者",ja:"同じ道の仲間",en:"Peer",ko:"동행자",th:"เพื่อนร่วมทาง",vi:"Bạn đồng hành",ms:"Rakan Sebaya",la:"Par"},mentor:{"zh-TW":"生命導師","zh-CN":"生命导师",ja:"人生の師",en:"Mentor",ko:"인생 멘토",th:"ที่ปรึกษาชีวิต",vi:"Người hướng dẫn",ms:"Mentor Kehidupan",la:"Mentor"},skillPartner:{"zh-TW":"技能夥伴","zh-CN":"技能伙伴",ja:"スキル仲間",en:"Skill Partner",ko:"기술 파트너",th:"พันธมิตรด้านทักษะ",vi:"Đối tác kỹ năng",ms:"Rakan Kemahiran",la:"Socius Peritiae"},mainGoalTitle:{"zh-TW":"我的主要目標","zh-CN":"我的主要目标",ja:"私の主な目標",en:"My Main Goal",ko:"나의 주요 목표",th:"เป้าหมายหลักของฉัน",vi:"Mục tiêu chính của tôi",ms:"Matlamat Utama Saya",la:"Meum Propositum Principale"},allGoals:{"zh-TW":"所有目標","zh-CN":"所有目标",ja:"すべての目標",en:"All Goals",ko:"모든 목표",th:"เป้าหมายทั้งหมด",vi:"Tất cả mục tiêu",ms:"Semua Matlamat",la:"Omnia Proposita"},goalLabel:{"zh-TW":"目標","zh-CN":"目标",ja:"目標",en:"Goal",ko:"목표",th:"เป้าหมาย",vi:"Mục tiêu",ms:"Matlamat",la:"Propositum"},goalOptions:{jobSeeking:{"zh-TW":"尋找工作","zh-CN":"寻找工作",en:"Job Seeking",ja:"仕事探し",ko:"구직",th:"หางาน",vi:"Tìm việc",ms:"Mencari Kerja",la:"Quaerere Opus"},learnNewSkills:{"zh-TW":"學習新技能","zh-CN":"学习新技能",en:"Learn New Skills",ja:"新しいスキルを学ぶ",ko:"새로운 기술 배우기",th:"เรียนรู้ทักษะใหม่",vi:"Học kỹ năng mới",ms:"Belajar Kemahiran Baru",la:"Disce Novas Artes"},emotionalSupport:{"zh-TW":"情緒支持","zh-CN":"情绪支持",en:"Emotional Support",ja:"心のサポート",ko:"정서적 지원",th:"การสนับสนุนทางอารมณ์",vi:"Hỗ trợ tinh thần",ms:"Sokongan Emosi",la:"Auxilium Emotionale"},networking:{"zh-TW":"建立人脈","zh-CN":"建立人脉",en:"Networking",ja:"人脈作り",ko:"네트워킹",th:"สร้างเครือข่าย",vi:"Xây dựng mạng lưới",ms:"Rangkaian",la:"Nexus Creare"},startupPrep:{"zh-TW":"創業準備","zh-CN":"创业准备",en:"Startup Prep",ja:"起業準備",ko:"창업 준비",th:"เตรียมตัวเริ่มต้นธุรกิจ",vi:"Chuẩn bị khởi nghiệp",ms:"Persediaan Permulaan",la:"Praeparatio Negotii"}},pass:{"zh-TW":"跳過","zh-CN":"跳过",ja:"スキップ",en:"Pass",ko:"건너뛰기",th:"ข้าม",vi:"Bỏ qua",ms:"Langkau",la:"Transilire"},like:{"zh-TW":"建立連結","zh-CN":"建立连结",ja:"繋がる",en:"Connect",ko:"연결하기",th:"เชื่อมต่อ",vi:"Kết nối",ms:"Berhubung",la:"Coniungere"},noMoreUsers:{"zh-TW":"目前沒有更多夥伴了，請稍後再試。","zh-CN":"目前没有更多伙伴了，请稍后再试。",ja:"現在、他の仲間はいません。後でもう一度お試しください。",en:"No more partners for now. Please try again later.",ko:"지금은 더 이상 파트너가 없습니다. 나중에 다시 시도해주세요.",th:"ไม่มีพันธมิตรเพิ่มเติมในขณะนี้ กรุณาลองใหม่อีกครั้งในภายหลัง",vi:"Hiện tại không có đối tác nào khác. Vui lòng thử lại sau.",ms:"Tiada lagi rakan kongsi buat masa ini. Sila cuba lagi nanti.",la:"Nulli socii nunc. Quaeso, postea iterum conare."},profileModal:{nameLabel:{"zh-TW":"暱稱 / Name","zh-CN":"昵称 / Name",en:"Name",ja:"ニックネーム",ko:"닉네임",th:"ชื่อเล่น",vi:"Biệt danh",ms:"Nama Panggilan",la:"Nomen"},bioLabel:{"zh-TW":"簡介 / Bio","zh-CN":"简介 / Bio",en:"Bio",ja:"自己紹介",ko:"소개",th:"ประวัติ",vi:"Tiểu sử",ms:"Bio",la:"Descriptio"},goalLabel:{"zh-TW":"主要目標 / Main Goal","zh-CN":"主要目标 / Main Goal",en:"Main Goal",ja:"主な目標",ko:"주요 목표",th:"เป้าหมายหลัก",vi:"Mục tiêu chính",ms:"Matlamat Utama",la:"Propositum Principale"},skillsLabel:{"zh-TW":"技能 / Skills","zh-CN":"技能 / Skills",en:"Skills",ja:"スキル",ko:"기술",th:"ทักษะ",vi:"Kỹ năng",ms:"Kemahiran",la:"Artes"},selectDefault:{"zh-TW":"請選擇","zh-CN":"请选择",en:"Please select",ja:"選択してください",ko:"선택하세요",th:"กรุณาเลือก",vi:"Vui lòng chọn",ms:"Sila pilih",la:"Quaeso selige"},cancelButton:{"zh-TW":"取消","zh-CN":"取消",en:"Cancel",ja:"キャンセル",ko:"취소",th:"ยกเลิก",vi:"Hủy bỏ",ms:"Batal",la:"Abrogare"},saveButton:{"zh-TW":"儲存","zh-CN":"保存",en:"Save",ja:"保存",ko:"저장",th:"บันทึก",vi:"Lưu",ms:"Simpan",la:"Servare"},avatarLabel:{"zh-TW":"頭像 / Avatar","zh-CN":"头像 / Avatar",en:"Avatar",ja:"アバター",ko:"아바타",th:"รูปประจำตัว",vi:"Ảnh đại diện",ms:"Avatar",la:"Imago"},uploading:{"zh-TW":"上傳中...","zh-CN":"上传中...",en:"Uploading...",ja:"アップロード中...",ko:"업로드 중...",th:"กำลังอัปโหลด...",vi:"Đang tải lên...",ms:"Memuat naik...",la:"Imponens..."}},chatroom:{"zh-TW":"聊天室","zh-CN":"聊天室",en:"Chat Room",ja:"チャットルーム",ko:"채팅방",th:"ห้องแชท",vi:"Phòng chat",ms:"Bilik Sembang",la:"Cella Colloquii"},invites:{"zh-TW":"邀請通知","zh-CN":"邀请通知",en:"Invitations",ja:"招待通知",ko:"초대 알림",th:"การแจ้งเตือนคำเชิญ",vi:"Thông báo mời",ms:"Notis Jemputan",la:"Notitia Invitationis"},mylinks:{"zh-TW":"我的連結","zh-CN":"我的连接",en:"My Links",ja:"私のリンク",ko:"내 링크",th:"ลิงก์ของฉัน",vi:"Liên kết của tôi",ms:"Pautan Saya",la:"Nexus Mei"},returnFriendStories:{"zh-TW":"返回好友故事","zh-CN":"返回好友故事",en:"Return to Friend Stories",ja:"友達のストーリーに戻る",ko:"친구 이야기로 돌아가기",th:"กลับไปที่เรื่องราวของเพื่อน",vi:"Quay lại câu chuyện bạn bè",ms:"Kembali ke Cerita Rakan",la:"Redi ad Fabulas Amicorum"},hello:{"zh-TW":"你好，","zh-CN":"你好，",ja:"こんにちは、",en:"Hello,",ko:"안녕하세요,",th:"สวัสดี,",vi:"Xin chào,",ms:"Hai,",la:"Salve,"},partnerTitle:{"zh-TW":"尋求夥伴同行","zh-CN":"寻找伙伴同行",ja:"仲間を探す",en:"Find a Partner",ko:"동행자 찾기",th:"ค้นหาคู่หู",vi:"Tìm bạn đồng hành",ms:"Cari Rakan Kongsi",la:"Socius Quaerere"},partnerSubtitle:{"zh-TW":"請選擇你的夥伴目標","zh-CN":"请选择你的伙伴目标",ja:"パートナー目標を選択してください",en:"Please select your partner goal",ko:"파트너 목표를 선택하세요",th:"โปรดเลือกเป้าหมายของคู่หู",vi:"Vui lòng chọn mục tiêu đối tác",ms:"Sila pilih matlamat rakan kongsi anda",la:"Quaeso selige propositum socii tui"},noPartnerYet:{"zh-TW":"🦋你的夥伴很快就會出現喔，請耐心等待...","zh-CN":"🦋你的伙伴很快就會出现哦，请耐心等待...",ja:"🦋あなたのパートナーはすぐに現れます。お待ちください。",en:"🦋 Your partner will appear soon. Please be patient.",ko:"🦋 당신의 파트너가 곧 나타날 것입니다. 조금만 기다려주세요.",th:"🦋พันธมิตรของคุณจะปรากฏในขณะนี้ โปรดอดทนต่อไป",vi:"🦋 Bạn đồng hành của bạn sẽ xuất hiện sớm. Vui lòng đợi để chờ đợi...",ms:"🦋 Rakan kongsi anda akan muncul segera. Sila tunggu dengan sabar...",la:"🦋 Socius tuus apparebit. Quaeso, patientia attendas..."}};function kN(){const n=_t(),[e,t]=v.useState(null),{lang:r,setLang:o}=Mt(),[a,c]=v.useState([]),[d,h]=v.useState([]),[m,g]=v.useState(0),[x,S]=v.useState("peer"),[C,_]=v.useState(""),[I,T]=v.useState(!1),[F,P]=v.useState({name:"",bio:"",goal:"",skills:"",avatar:"",customSkill:"",country:"",gender:""}),[B,q]=v.useState({name:"",bio:"",goal:"",skills:"",avatar:"",customSkill:"",country:"",gender:""}),[te,W]=v.useState(""),[L,R]=v.useState(null),[A,N]=v.useState(null),[O,z]=v.useState(!0),[j,V]=v.useState("main"),[X,$]=v.useState("none"),[ne,oe]=v.useState(null);v.useRef(m),v.useEffect(()=>{const G=Ns(ya,async ie=>{if(ie){t(ie);const ee=Vn(Wt,"profiles",ie.uid),Se=await Cs(ee);if(Se.exists()){const we=Se.data();P({name:we.nickname||we.name||"新用戶",bio:we.bio,goal:we.goal,skills:we.skills,avatar:we.avatar,customSkill:we.customSkill||"",country:we.country||"",gender:we.gender||""})}else{const we={name:ie.displayName||"新用戶",bio:"",goal:"",skills:"",avatar:ie.photoURL||"/avatars/Derxl.png",customSkill:"",country:"",gender:""};P(we),await Ed(ee,we)}await J(ie.uid)}else n("/")});return()=>G()},[ya,Wt,n]);const J=async G=>{try{z(!0);const ie=Cn(Wt,"profiles"),ee=hr(ie,Rn("__name__","!=",G)),Se=await Mr(ee),we=[];Se.forEach(Oe=>{const Ne=Oe.data();we.push({id:Oe.id,name:Ne.name||"Unknown",goal:Ne.goal||"learnNewSkills",role:Ne.role||"peer",bio:Ne.bio||{"zh-TW":"No bio available","zh-CN":"暂无简介",en:"No bio available",ja:"自己紹介なし",ko:"소개 없음",th:"ไม่มีประวัติ",vi:"Không có tiểu sử",ms:"Tiada bio",la:"Nulla descriptio"},avatar:Ne.avatar||"/avatars/Derxl.png",skills:Ne.skills||"",createdAt:Ne.createdAt,country:Ne.country||"",gender:Ne.gender||""})}),c(we),h(we)}catch(ie){console.error("Error loading users:",ie)}finally{z(!1)}},Q=async(G,ie)=>{if(e)try{const ee={fromUserId:e.uid,fromUserName:F.name,fromUserAvatar:F.avatar,fromUserCountry:F.country||"",fromUserGender:F.gender||"",fromUserEmail:e.email||"",fromUserNickname:F.name||"",toUserId:G,toUserName:ie.name,role:ie.role,goal:ie.goal,status:"pending",createdAt:v0()};await ys(Cn(Wt,"invites"),ee),oe(Ft.like[r]+" 成功！"),setTimeout(()=>oe(null),2e3)}catch(ee){console.error("Error sending invite:",ee),alert("發送邀請失敗")}};v.useMemo(()=>Array(d.length).fill(0).map(G=>En.createRef()),[d.length]),v.useEffect(()=>{if(a.length>0){const G=a.filter(ie=>{const ee=ie.role===x,Se=C?ie.goal===C:!0;return ee&&Se});h(G),g(G.length-1)}},[x,C,a]),v.useEffect(()=>{I&&(q(F),W(F.avatar),N(null),R(null))},[I,F]),d[m];const D=["jobSeeking","learnNewSkills","emotionalSupport","networking","startupPrep"];return v.useEffect(()=>{if(!localStorage.getItem("lang")){const G=navigator.language;let ie="zh-TW";G.startsWith("zh-CN")?ie="zh-CN":G.startsWith("zh-TW")?ie="zh-TW":G.startsWith("ja")?ie="ja":G.startsWith("ko")?ie="ko":G.startsWith("th")?ie="th":G.startsWith("vi")?ie="vi":G.startsWith("ms")?ie="ms":G.startsWith("la")?ie="la":G.startsWith("en")&&(ie="en"),o(ie),localStorage.setItem("lang",ie)}},[o]),v.useEffect(()=>{if(X==="in"){const G=document.getElementById("user-card");G&&G.animate([{transform:"translateX(-120%) scale(0.4)",opacity:0},{transform:"translateX(0) scale(1)",opacity:1}],{duration:400}),setTimeout(()=>$("none"),400)}},[X]),i.jsxs("div",{style:{width:"100vw",height:"100vh",overflow:"hidden",position:"relative"},children:[window.innerWidth<=768?i.jsxs("div",{style:{width:"100%",height:"100vh",display:"flex",flexDirection:"column",background:"url('/green_hut.png') center center / cover no-repeat fixed"},children:[i.jsxs("div",{style:{position:"fixed",top:0,left:0,right:0,zIndex:100,background:"rgba(255,255,255,0.95)",padding:"8px 16px",display:"flex",justifyContent:"space-between",alignItems:"center",boxShadow:"0 2px 8px #0001"},children:[i.jsx("button",{className:"topbar-btn",onClick:()=>n("/"),style:{fontWeight:700,fontSize:14,padding:"6px 12px",borderRadius:8,border:"1.5px solid #6B5BFF",background:"#fff",color:"#6B5BFF",cursor:"pointer"},children:Ft.backToHome[r]}),i.jsxs("h2",{style:{fontSize:"1.2rem",fontWeight:900,color:"#6B5BFF",margin:0,textAlign:"center"},children:["🦋 ",Ft.pageTitle[r]]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[i.jsx("button",{className:"topbar-btn",onClick:async()=>{await Ir(ya),localStorage.clear(),window.location.href="/"},style:{fontWeight:700,fontSize:14,padding:"6px 12px",borderRadius:8,border:"1.5px solid #6B5BFF",background:"#fff",color:"#6B5BFF",cursor:"pointer"},children:Ft.logout[r]}),i.jsx(Bn,{style:{width:"80px",fontSize:14,padding:"6px 10px"}})]})]}),i.jsxs("div",{style:{marginTop:60,padding:"16px",flex:1,overflowY:"auto"},children:[i.jsxs("div",{style:{background:"rgba(255,255,255,0.95)",borderRadius:16,padding:"16px",marginBottom:16,boxShadow:"0 2px 12px #6B5BFF22"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,marginBottom:12},children:[i.jsx("div",{style:{fontSize:24},children:"🦋"}),i.jsx("div",{style:{fontWeight:700,fontSize:14,color:"#6B5BFF"},children:Ft.hello?Ft.hello[r]:"你好，"}),i.jsx("img",{src:F.avatar,alt:"avatar",style:{width:36,height:36,borderRadius:"50%",objectFit:"cover",border:"2px solid #6B5BFF"}}),i.jsx("div",{style:{fontWeight:700,fontSize:14,color:"#333"},children:F.name})]}),i.jsxs("div",{style:{background:"rgba(128,128,128,0.1)",borderRadius:12,padding:"16px",marginBottom:16,boxShadow:"0 4px 12px rgba(0,0,0,0.15)"},children:[i.jsx("div",{style:{fontWeight:700,fontSize:16,color:"#6B5BFF",textAlign:"center",marginBottom:8},children:Ft.partnerTitle?Ft.partnerTitle[r]:"尋求夥伴同行"}),i.jsx("div",{style:{fontSize:12,color:"#888",textAlign:"center",marginBottom:12},children:Ft.partnerSubtitle?Ft.partnerSubtitle[r]:"請選擇你的夥伴目標"}),i.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:8},children:D.map(G=>i.jsx("button",{onClick:()=>{_(G),V("main")},style:{flex:"1 1 calc(50% - 4px)",padding:"8px 4px",borderRadius:8,border:C===G?"2px solid #23c6e6":"1px solid #eee",background:C===G?"#e6f7ff":"#fff",color:C===G?"#23c6e6":"#333",fontWeight:600,fontSize:12,cursor:"pointer",boxShadow:C===G?"0 2px 8px #23c6e622":"0 1px 4px #0001"},children:Ft.goalOptions[G][r]},G))})]}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:8},children:[i.jsx("button",{onClick:()=>n("/chatroom"),style:{padding:"8px",borderRadius:8,border:j==="chat"?"2px solid #8ec6f7":"1px solid #eee",background:j==="chat"?"#e6f7ff":"#fff",color:j==="chat"?"#23c6e6":"#333",fontWeight:600,fontSize:14,cursor:"pointer"},children:Ft.chatroom[r]}),i.jsx("button",{onClick:()=>V("invites"),style:{padding:"8px",borderRadius:8,border:j==="invites"?"2px solid #6B5BFF":"1px solid #eee",background:j==="invites"?"#f5f4ff":"#fff",color:j==="invites"?"#6B5BFF":"#333",fontWeight:600,fontSize:14,cursor:"pointer"},children:Ft.invites[r]}),i.jsx("button",{onClick:()=>V("links"),style:{padding:"8px",borderRadius:8,border:j==="links"?"2px solid #6B5BFF":"1px solid #eee",background:j==="links"?"#f5f4ff":"#fff",color:j==="links"?"#6B5BFF":"#333",fontWeight:600,fontSize:14,cursor:"pointer"},children:Ft.mylinks[r]}),i.jsxs("a",{href:"/storywall",style:{padding:"8px",borderRadius:8,border:"1px solid #23c6e6",background:"#fff",color:"#23c6e6",fontWeight:600,fontSize:14,cursor:"pointer",textAlign:"center",textDecoration:"none",display:"block"},children:[Ft.returnFriendStories[r]," 🦋"]})]})]}),i.jsxs("div",{style:{background:"rgba(255,255,255,0.95)",borderRadius:16,padding:"16px",minHeight:400},children:[j==="main"&&i.jsx(i.Fragment,{children:(()=>{var ee,Se;const G=d.filter(we=>!C||we.goal===C);if(G.length===0)return i.jsx("div",{style:{textAlign:"center",color:"#e74c3c",fontSize:16,marginTop:40,fontWeight:700},children:((ee=Ft.noPartnerYet)==null?void 0:ee[r])||"🦋你的夥伴很快就會出現喔，請耐心等待..."});const ie=G[m>=0&&m<G.length?m:0];return ie?i.jsxs("div",{id:"user-card",style:{textAlign:"center",transition:"box-shadow 0.2s, transform 0.4s",transform:X==="in"?"translateX(-120%) scale(0.4)":X==="out"?"translateX(120%) scale(0.4)":"translateX(0) scale(1)",opacity:1},onAnimationEnd:()=>{X==="in"&&$("none")},children:[i.jsx("img",{src:ie.avatar,alt:"avatar",style:{width:80,height:80,borderRadius:"50%",objectFit:"cover",border:"3px solid #6B5BFF",marginBottom:12}}),i.jsx("div",{style:{fontWeight:800,fontSize:18,color:"#6B5BFF",marginBottom:8},children:ie.name}),i.jsxs("div",{style:{color:"#888",fontSize:14,marginBottom:4},children:["國家/地區：",ie.country||"未填寫"]}),i.jsxs("div",{style:{color:"#888",fontSize:14,marginBottom:4},children:["性別：",ie.gender||"未填寫"]}),i.jsxs("div",{style:{color:"#888",fontSize:14,marginBottom:4},children:["目標：",((Se=Ft.goalOptions[ie.goal])==null?void 0:Se[r])||ie.goal]}),i.jsxs("div",{style:{color:"#888",fontSize:14,marginBottom:16},children:["技能：",ie.skills||"未填寫"]}),i.jsxs("div",{style:{display:"flex",gap:12,justifyContent:"center"},children:[i.jsx("button",{onClick:()=>{const we=document.getElementById("user-card");we&&($("out"),we.animate([{transform:"translateX(0) scale(1)",opacity:1},{transform:"translateX(120%) scale(0.4)",opacity:0}],{duration:400})),setTimeout(()=>{g(Oe=>($("in"),(Oe-1+G.length)%G.length))},400)},style:{padding:"8px 20px",borderRadius:8,border:"1.5px solid #bbb",background:"#fff",color:"#888",fontWeight:600,fontSize:14,cursor:"pointer"},children:"跳過"}),i.jsx("button",{onClick:()=>Q(ie.id,ie),style:{padding:"8px 20px",borderRadius:8,border:"1.5px solid #6B5BFF",background:"#6B5BFF",color:"#fff",fontWeight:600,fontSize:14,cursor:"pointer"},children:"建立連結"})]})]}):null})()}),j==="chat"&&i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:20,justifyContent:"center",alignItems:"center",minHeight:"50vh",padding:"20px 0"},children:[i.jsxs("div",{style:{background:"rgba(128,128,128,0.15)",borderRadius:16,padding:"24px",boxShadow:"0 6px 16px rgba(0,0,0,0.2)",width:"95%",maxWidth:320,border:"1px solid rgba(128,128,128,0.2)"},children:[i.jsx("div",{style:{fontWeight:800,fontSize:20,color:"#6B5BFF",marginBottom:16,textAlign:"center"},children:"好友列表"}),i.jsx("div",{style:{textAlign:"center",color:"#666",fontSize:15,lineHeight:1.4},children:"請先加好友,才能開始聊天"})]}),i.jsxs("div",{style:{background:"rgba(128,128,128,0.15)",borderRadius:16,padding:"24px",boxShadow:"0 6px 16px rgba(0,0,0,0.2)",width:"95%",maxWidth:320,border:"1px solid rgba(128,128,128,0.2)"},children:[i.jsx("div",{style:{fontWeight:800,fontSize:20,color:"#6B5BFF",marginBottom:16,textAlign:"center"},children:"聊天訊息框"}),i.jsx("div",{style:{textAlign:"center",color:"#666",fontSize:15,lineHeight:1.4},children:"還沒有朋友,去交友區加好友吧!"})]})]}),j==="links"&&i.jsx(nx,{embedded:!0}),j==="invites"&&i.jsx(rx,{embedded:!0})]}),i.jsx("div",{style:{width:"100%",margin:"0 auto",marginTop:24},children:i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:8},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:20,flexWrap:"wrap"},children:[i.jsx("a",{href:"/privacy-policy",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12},children:"隱私權政策"}),i.jsx("a",{href:"/terms",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12},children:"條款/聲明"}),i.jsx("a",{href:"/data-deletion",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12},children:"資料刪除說明"})]}),i.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:20,flexWrap:"wrap"},children:[i.jsx("a",{href:"/about",style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12},children:"🧬 Restarter™｜我們是誰"}),i.jsx("a",{href:"/feedback",style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12},children:"💬 意見箱｜我們想聽你說"})]})]})})]})]}):i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{position:"fixed",top:0,left:0,right:0,zIndex:100,background:"rgba(255,255,255,0.95)",padding:"12px 24px",display:"flex",justifyContent:"space-between",alignItems:"center",boxShadow:"0 2px 8px #0001"},children:[i.jsx("button",{className:"topbar-btn",onClick:()=>n("/"),style:{fontWeight:700,fontSize:16,padding:"8px 16px",borderRadius:8,border:"1.5px solid #6B5BFF",background:"#fff",color:"#6B5BFF",cursor:"pointer"},children:Ft.backToHome[r]}),i.jsxs("h1",{style:{fontSize:"1.8rem",fontWeight:900,color:"#6B5BFF",margin:0,textAlign:"center"},children:["🦋 ",Ft.pageTitle[r]]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[i.jsx("button",{className:"topbar-btn",onClick:async()=>{await Ir(ya),localStorage.clear(),window.location.href="/"},style:{fontWeight:700,fontSize:16,padding:"8px 16px",borderRadius:8,border:"1.5px solid #6B5BFF",background:"#fff",color:"#6B5BFF",cursor:"pointer"},children:Ft.logout[r]}),i.jsx(Bn,{style:{width:"100px",fontSize:16,padding:"8px 12px"}})]})]}),i.jsx("div",{style:{position:"fixed",left:0,top:60,width:340,height:"calc(100vh - 60px)",background:"rgba(255,255,255,0.95)",borderRight:"1px solid #eee",overflowY:"auto",zIndex:2,padding:"24px 16px"},children:i.jsxs("div",{style:{background:"rgba(255,255,255,0.95)",borderRadius:16,padding:"20px",marginBottom:24,boxShadow:"0 2px 12px #6B5BFF22"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:16,marginBottom:16},children:[i.jsx("div",{style:{fontSize:32},children:"🦋"}),i.jsx("div",{style:{fontWeight:700,fontSize:16,color:"#6B5BFF"},children:Ft.hello?Ft.hello[r]:"你好，"}),i.jsx("img",{src:F.avatar,alt:"avatar",style:{width:48,height:48,borderRadius:"50%",objectFit:"cover",border:"3px solid #6B5BFF"}}),i.jsx("div",{style:{fontWeight:700,fontSize:16,color:"#333"},children:F.name})]}),i.jsxs("div",{style:{background:"rgba(128,128,128,0.1)",borderRadius:12,padding:"20px",marginBottom:24,boxShadow:"0 4px 12px rgba(0,0,0,0.15)"},children:[i.jsx("div",{style:{fontWeight:700,fontSize:18,color:"#6B5BFF",textAlign:"center",marginBottom:12},children:Ft.partnerTitle?Ft.partnerTitle[r]:"尋求夥伴同行"}),i.jsx("div",{style:{fontSize:14,color:"#888",textAlign:"center",marginBottom:20},children:Ft.partnerSubtitle?Ft.partnerSubtitle[r]:"請選擇你的夥伴目標"}),i.jsx("div",{style:{display:"flex",flexDirection:"column",gap:12},children:D.map(G=>i.jsx("button",{onClick:()=>{_(G),V("main")},style:{width:"100%",padding:"12px 16px",borderRadius:10,border:C===G?"2px solid #23c6e6":"1.5px solid #eee",background:C===G?"#e6f7ff":"#fff",color:C===G?"#23c6e6":"#333",fontWeight:700,fontSize:15,cursor:"pointer",boxShadow:C===G?"0 2px 8px #23c6e622":"0 2px 8px #0001",transition:"all 0.2s",outline:"none",borderLeft:C===G?"6px solid #23c6e6":"6px solid transparent",marginBottom:0},children:Ft.goalOptions[G][r]},G))})]}),i.jsx("button",{onClick:()=>n("/chatroom"),style:{width:"100%",marginBottom:12,padding:"12px 0",borderRadius:10,border:j==="chat"?"2px solid #8ec6f7":"1.5px solid #eee",background:j==="chat"?"#e6f7ff":"#fff",color:j==="chat"?"#23c6e6":"#333",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:j==="chat"?"0 2px 8px #23c6e622":"0 2px 8px #0001",transition:"all 0.2s"},children:Ft.chatroom[r]}),i.jsx("button",{onClick:()=>V("invites"),style:{width:"100%",marginBottom:12,padding:"12px 0",borderRadius:10,border:j==="invites"?"2px solid #6B5BFF":"1.5px solid #eee",background:j==="invites"?"#f5f4ff":"#fff",color:j==="invites"?"#6B5BFF":"#333",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:j==="invites"?"0 2px 8px #6B5BFF22":"0 2px 8px #0001",transition:"all 0.2s"},children:Ft.invites[r]}),i.jsx("button",{onClick:()=>V("links"),style:{width:"100%",marginBottom:12,padding:"12px 0",borderRadius:10,border:j==="links"?"2px solid #6B5BFF":"1.5px solid #eee",background:j==="links"?"#f5f4ff":"#fff",color:j==="links"?"#6B5BFF":"#333",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:j==="links"?"0 2px 8px #6B5BFF22":"0 2px 8px #0001",transition:"all 0.2s"},children:Ft.mylinks[r]}),i.jsxs("a",{href:"/storywall",style:{width:"100%",marginBottom:12,padding:"12px 0",borderRadius:10,border:"1.5px solid #23c6e6",background:"#fff",color:"#23c6e6",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:"0 2px 8px #23c6e622",textAlign:"center",textDecoration:"none",display:"block",transition:"all 0.2s"},children:[Ft.returnFriendStories[r]," 🦋"]})]})}),i.jsx("div",{style:{position:"fixed",left:340,top:60,width:"calc(100vw - 340px)",height:"calc(100vh - 60px)",overflowY:"auto",display:"flex",flexDirection:"column",alignItems:"center",background:"url('/green_hut.png') center center / cover no-repeat fixed",zIndex:1,pointerEvents:"auto",paddingLeft:0},children:i.jsxs("div",{style:{width:"100%",maxWidth:900,marginTop:60},children:[j==="main"&&i.jsx(i.Fragment,{children:(()=>{var ee,Se;const G=d.filter(we=>!C||we.goal===C);if(G.length===0)return i.jsx("div",{style:{textAlign:"center",color:"#e74c3c",fontSize:18,marginTop:40,fontWeight:700},children:((ee=Ft.noPartnerYet)==null?void 0:ee[r])||"🦋你的夥伴很快就會出現喔，請耐心等待..."});const ie=G[m>=0&&m<G.length?m:0];return ie?i.jsxs("div",{id:"user-card",style:{width:340,margin:"0 auto",background:"#fff",borderRadius:18,boxShadow:"0 2px 16px #6B5BFF22",padding:32,display:"flex",flexDirection:"column",alignItems:"center",position:"relative",minHeight:380,transition:"box-shadow 0.2s, transform 0.4s",transform:X==="in"?"translateX(-120%) scale(0.4)":X==="out"?"translateX(120%) scale(0.4)":"translateX(0) scale(1)",opacity:1},onAnimationEnd:()=>{X==="in"&&$("none")},children:[i.jsx("img",{src:ie.avatar,alt:"avatar",style:{width:88,height:88,borderRadius:"50%",objectFit:"cover",border:"3px solid #6B5BFF",marginBottom:16}}),i.jsx("div",{style:{fontWeight:800,fontSize:22,color:"#6B5BFF",marginBottom:8},children:ie.name}),i.jsxs("div",{style:{color:"#888",fontSize:15,marginBottom:4},children:["國家/地區：",ie.country||"未填寫"]}),i.jsxs("div",{style:{color:"#888",fontSize:15,marginBottom:4},children:["性別：",ie.gender||"未填寫"]}),i.jsxs("div",{style:{color:"#888",fontSize:15,marginBottom:4},children:["目標：",((Se=Ft.goalOptions[ie.goal])==null?void 0:Se[r])||ie.goal]}),i.jsxs("div",{style:{color:"#888",fontSize:15,marginBottom:12},children:["技能：",ie.skills||"未填寫"]}),i.jsxs("div",{style:{display:"flex",gap:16,marginTop:24},children:[i.jsx("button",{onClick:()=>{const we=document.getElementById("user-card");we&&($("out"),we.animate([{transform:"translateX(0) scale(1)",opacity:1},{transform:"translateX(120%) scale(0.4)",opacity:0}],{duration:400})),setTimeout(()=>{g(Oe=>($("in"),(Oe-1+G.length)%G.length))},400)},style:{padding:"10px 28px",borderRadius:8,border:"1.5px solid #bbb",background:"#fff",color:"#888",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:"0 2px 8px #0001",transition:"all 0.2s"},children:"跳過"}),i.jsx("button",{onClick:()=>Q(ie.id,ie),style:{padding:"10px 28px",borderRadius:8,border:"1.5px solid #6B5BFF",background:"#6B5BFF",color:"#fff",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:"0 2px 8px #6B5BFF22",transition:"all 0.2s"},children:"建立連結"})]})]}):null})()}),j==="chat"&&i.jsx("div",{children:"聊天室功能開發中"}),j==="links"&&i.jsx(nx,{embedded:!0}),j==="invites"&&i.jsx(rx,{embedded:!0})]})}),i.jsx("div",{style:{position:"absolute",bottom:0,left:340,right:0,zIndex:100},children:i.jsx("div",{style:{width:"100%",margin:"0 auto",marginTop:24,background:"rgba(255,255,255,0.95)",borderRadius:16,padding:"16px",boxShadow:"0 2px 12px #6B5BFF22"},children:i.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:20,flexWrap:"wrap"},children:[i.jsx("a",{href:"/privacy-policy",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12},children:r==="zh-TW"?"隱私權政策":r==="zh-CN"?"隐私政策":r==="en"?"Privacy Policy":r==="ja"?"プライバシーポリシー":r==="ko"?"개인정보 처리방침":r==="th"?"นโยบายความเป็นส่วนตัว":r==="vi"?"Chính sách bảo mật":r==="ms"?"Dasar Privasi":"Consilium de Privata"}),i.jsx("a",{href:"/terms",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12},children:r==="zh-TW"?"條款/聲明":r==="zh-CN"?"条款/声明":r==="en"?"Terms/Statement":r==="ja"?"規約/声明":r==="ko"?"약관/성명":r==="th"?"ข้อกำหนด/แถลงการณ์":r==="vi"?"Điều khoản/Tuyên bố":r==="ms"?"Terma/Pernyataan":"Termini/Declaratio"}),i.jsx("a",{href:"/data-deletion",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12},children:r==="zh-TW"?"資料刪除說明":r==="zh-CN"?"数据删除说明":r==="en"?"Data Deletion":r==="ja"?"データ削除について":r==="ko"?"데이터 삭제 안내":r==="th"?"คำอธิบายการลบข้อมูล":r==="vi"?"Giải thích xóa dữ liệu":r==="ms"?"Penjelasan Penghapusan Data":"Explicatio Deletionis Datae"}),i.jsx("a",{href:"/about",style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12},children:r==="zh-TW"?"🧬 Restarter™｜我們是誰":r==="zh-CN"?"🧬 Restarter™｜我们是谁":r==="en"?"🧬 Restarter™｜Who We Are":r==="ja"?"🧬 Restarter™｜私たちについて":r==="ko"?"🧬 Restarter™｜우리는 누구인가":r==="th"?"🧬 Restarter™｜เราเป็นใคร":r==="vi"?"🧬 Restarter™｜Chúng tôi là ai":r==="ms"?"🧬 Restarter™｜Siapa Kami":"🧬 Restarter™｜Quis sumus"}),i.jsx("a",{href:"/feedback",style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12},children:r==="zh-TW"?"💬 意見箱｜我們想聽你說":r==="zh-CN"?"💬 意见箱｜我们想听你说":r==="en"?"💬 Feedback Box｜We Want to Hear From You":r==="ja"?"💬 ご意見箱｜私たちはあなたの声を聞きたい":r==="ko"?"💬 피드백｜우리는 당신의 말을 듣고 싶습니다":r==="th"?"💬 กล่องความคิดเห็น｜เราอยากได้ยินจากคุณ":r==="vi"?"💬 Hộp góp ý｜Chúng tôi muốn nghe từ bạn":r==="ms"?"💬 Kotak Maklum Balas｜Kami Ingin Mendengar Dari Anda":"💬 Arca Consilii｜Volumus Audire a Te"})]})})})]}),ne&&i.jsx("div",{style:{position:"fixed",top:32,left:"50%",transform:"translateX(-50%)",background:"#1976d2",color:"#fff",padding:"14px 32px",borderRadius:16,fontSize:18,fontWeight:700,zIndex:9999,boxShadow:"0 2px 16px #1976d288",letterSpacing:1,textAlign:"center",opacity:.97},children:ne})]})}function TN(){try{return JSON.parse(localStorage.getItem("messages")||"[]")}catch{return[]}}function _N(){const n=localStorage.getItem("userId")||"",e=TN(),t=localStorage.getItem("lang")||"zh-TW",r={"zh-TW":{title:"我的留言箱",noMessages:"目前沒有收到任何留言",messageFrom:"留言：",aboutPost:"針對你的貼文：「"},"zh-CN":{title:"我的留言箱",noMessages:"目前没有收到任何留言",messageFrom:"留言：",aboutPost:"针对你的贴文：「"},en:{title:"My Inbox",noMessages:"No messages received yet",messageFrom:"message:",aboutPost:'About your post: "'},ja:{title:"メッセージボックス",noMessages:"まだメッセージがありません",messageFrom:"メッセージ：",aboutPost:"あなたの投稿について：「"},ko:{title:"내 메시지함",noMessages:"아직 받은 메시지가 없습니다",messageFrom:"메시지:",aboutPost:'당신의 게시물에 대해: "'},vi:{title:"Hộp thư của tôi",noMessages:"Chưa có tin nhắn nào",messageFrom:"tin nhắn:",aboutPost:'Về bài đăng của bạn: "'},th:{title:"กล่องข้อความของฉัน",noMessages:"ยังไม่มีข้อความ",messageFrom:"ข้อความ:",aboutPost:'เกี่ยวกับโพสต์ของคุณ: "'},la:{title:"Mea Inbox",noMessages:"Nondum epistulae receptae",messageFrom:"epistula:",aboutPost:'De tuo post: "'},ms:{title:"Peti Surat Saya",noMessages:"Belum ada mesej diterima",messageFrom:"mesej:",aboutPost:'Mengenai siaran anda: "'}},o=r[t]||r.en,a=e.flatMap(c=>(c.comments||[]).filter(d=>d.toUserId===n).map(d=>({...d,post:c.text,from:c.user.name})));return i.jsx("div",{className:"modern-bg",style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center"},children:i.jsxs("div",{className:"modern-container",style:{maxWidth:600,width:"100%",margin:"0 auto",padding:32},children:[i.jsx("h2",{style:{textAlign:"center",color:"#6B5BFF",fontWeight:900,marginBottom:24},children:o.title}),a.length===0&&i.jsx("div",{style:{color:"#bbb",textAlign:"center"},children:o.noMessages}),a.map((c,d)=>i.jsxs("div",{style:{background:"#f7f7ff",borderRadius:12,padding:16,boxShadow:"0 2px 8px #6B5BFF11",marginBottom:16},children:[i.jsxs("div",{style:{color:"#6B5BFF",fontWeight:700},children:[c.from," ",o.messageFrom]}),i.jsx("div",{style:{color:"#232946",margin:"8px 0"},children:c.content}),i.jsxs("div",{style:{color:"#6B4F27",fontSize:14},children:[o.aboutPost,c.post,"」"]})]},d))]})})}const VS={"zh-TW":{title:"AI 風格回覆",comingSoon:"體驗即將開放，敬請期待！",playing:"播放中...",playAudio:"播放語音"},"zh-CN":{title:"AI 风格回复",comingSoon:"体验即将开放，敬请期待！",playing:"播放中...",playAudio:"播放语音"},en:{title:"AI-Styled Reply",comingSoon:"Experience coming soon, stay tuned!",playing:"Playing...",playAudio:"Play Audio"},ja:{title:"AI風返信",comingSoon:"体験は近日公開予定です、お楽しみに！",playing:"再生中...",playAudio:"音声を再生"},ko:{title:"AI 스타일 응답",comingSoon:"체험이 곧 시작될 예정이니 기대해주세요!",playing:"재생 중...",playAudio:"오디오 재생"},vi:{title:"Trả lời theo phong cách AI",comingSoon:"Trải nghiệm sắp ra mắt, hãy theo dõi!",playing:"Đang phát...",playAudio:"Phát âm thanh"},th:{title:"การตอบกลับสไตล์ AI",comingSoon:"ประสบการณ์กำลังจะมาเร็วๆ นี้ โปรดติดตาม!",playing:"กำลังเล่น...",playAudio:"เล่นเสียง"},la:{title:"Responsum Stilo AI",comingSoon:"Experientia mox praesto erit, mane exspectans!",playing:"Ludens...",playAudio:"Sonum redde"},ms:{title:"Balasan Gaya AI",comingSoon:"Pengalaman akan datang, nantikan!",playing:"Sedang dimainkan...",playAudio:"Mainkan Audio"}};function jN(){const[n,e]=En.useState(!1),[t,r]=En.useState(()=>localStorage.getItem("lang")||"zh-TW"),o=VS[t]||VS["zh-TW"];En.useEffect(()=>{localStorage.setItem("lang",t)},[t]);const a=()=>{e(!0),setTimeout(()=>e(!1),3e3)};return i.jsxs("div",{className:"modern-bg",style:{minHeight:"100vh",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",position:"relative"},children:[i.jsx(Bn,{}),i.jsxs("div",{className:"modern-container",style:{maxWidth:480,width:"100%",margin:"0 auto",textAlign:"center",padding:48,borderRadius:18,background:"rgba(60,40,20,0.18)",boxShadow:"0 4px 24px #0002"},children:[i.jsx("h2",{style:{color:"#6B5BFF",fontWeight:900,fontSize:28,marginBottom:24},children:o.title}),i.jsx("div",{style:{color:"#6B4F27",fontSize:22,fontWeight:700},children:o.comingSoon}),i.jsx("button",{onClick:a,style:{padding:"6px 18px",borderRadius:8,background:"#6c63ff",color:"#fff",border:"none",fontWeight:700,fontSize:16,marginTop:8},disabled:n,children:n?o.playing:o.playAudio})]})]})}const IN=[{code:"zh-TW",label:"繁中"},{code:"zh-CN",label:"简中"},{code:"en",label:"EN"},{code:"ja",label:"日本語"},{code:"ko",label:"한국어"},{code:"vi",label:"Tiếng Việt"},{code:"th",label:"ไทย"},{code:"la",label:"Latina"},{code:"ms",label:"Bahasa Melayu"}],US={"zh-TW":{title:"擬真語音輸出",comingSoon:"體驗即將開放，敬請期待！",playing:"播放中...",playAudio:"播放語音"},"zh-CN":{title:"拟真语音输出",comingSoon:"体验即将开放，敬请期待！",playing:"播放中...",playAudio:"播放语音"},en:{title:"Realistic TTS",comingSoon:"Experience coming soon, stay tuned!",playing:"Playing...",playAudio:"Play Audio"},ja:{title:"リアルな音声出力",comingSoon:"体験は近日公開予定です、お楽しみに！",playing:"再生中...",playAudio:"音声を再生"},ko:{title:"사실적인 음성 출력",comingSoon:"체험이 곧 시작될 예정이니 기대해주세요!",playing:"재생 중...",playAudio:"오디오 재생"},vi:{title:"Đầu ra giọng nói thực tế",comingSoon:"Trải nghiệm sắp ra mắt, hãy theo dõi!",playing:"Đang phát...",playAudio:"Phát âm thanh"},th:{title:"การส่งออกเสียงที่สมจริง",comingSoon:"ประสบการณ์กำลังจะมาเร็วๆ นี้ โปรดติดตาม!",playing:"กำลังเล่น...",playAudio:"เล่นเสียง"},la:{title:"Sermo Verus Output",comingSoon:"Experientia mox praesto erit, mane exspectans!",playing:"Ludens...",playAudio:"Sonum redde"},ms:{title:"Output Suara Realistik",comingSoon:"Pengalaman akan datang, nantikan!",playing:"Sedang dimainkan...",playAudio:"Mainkan Audio"}};function qS(){const[n,e]=En.useState(!1),[t,r]=En.useState("zh-TW"),o=US[t]||US["zh-TW"];En.useEffect(()=>{const c=localStorage.getItem("lang");c&&IN.find(d=>d.code===c)&&r(c)},[]),En.useEffect(()=>{localStorage.setItem("lang",t)},[t]);const a=()=>{e(!0),setTimeout(()=>e(!1),2e3)};return i.jsxs("div",{className:"modern-bg",style:{minHeight:"100vh",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",position:"relative"},children:[i.jsx("div",{style:{position:"absolute",top:24,right:36,zIndex:100},children:i.jsx(Bn,{})}),i.jsxs("div",{className:"modern-container",style:{maxWidth:480,width:"100%",margin:"0 auto",textAlign:"center",padding:48,borderRadius:18,background:"rgba(60,40,20,0.18)",boxShadow:"0 4px 24px #0002"},children:[i.jsx("h2",{style:{color:"#6B5BFF",fontWeight:900,fontSize:28,marginBottom:24},children:o.title}),i.jsx("div",{style:{color:"#6B4F27",fontSize:22,fontWeight:700},children:o.comingSoon}),i.jsx("button",{onClick:a,style:{padding:"6px 18px",borderRadius:8,background:"#6c63ff",color:"#fff",border:"none",fontWeight:700,fontSize:16,marginTop:8},disabled:n,children:n?o.playing:o.playAudio})]})]})}const HS={"zh-TW":{back:"返回",logout:"登出",title:"重啟之路",subtitle:"一步步走出迷霧，看見全新的自己",steps:[{title:"第一站：迷霧山谷",desc:"寫下最近一件讓你感到強烈情緒的事。不必評判自己，單純描述事情的經過、你的感受，以及這個感受帶來的影響。",placeholder:"在這裡寫下你的故事...(300字內)"},{title:"第二站：希望之丘",desc:"回顧你剛剛寫下的事件，請思考：在那個情境下，你有沒有做過什麼小小的努力或嘗試？即使很微小，也請寫下來。",placeholder:"寫下你做過的努力或嘗試...(300字內)"},{title:"第三站：勇氣森林",desc:"根據你剛剛發現的努力或資源，請設定一個你願意嘗試的小行動，並寫下你預期會遇到的困難，以及你打算怎麼面對。",placeholder:"寫下你的小行動與預期困難...(300字內)"},{title:"第四站：智慧溪流",desc:"回顧你剛剛的行動經驗，請反思：這個過程中，你學到了什麼？有沒有什麼新的發現或領悟？",placeholder:"寫下你的學習與領悟...(300字內)"},{title:"第五站：重啟之巔",desc:"綜合前面所有關卡的經歷，請寫下你給未來自己的祝福或期許，並思考：如果未來再遇到困難，你會怎麼鼓勵自己？",placeholder:"寫下給自己的祝福或期許...(300字內)"}],submit:"提交，尋求指引",loading:"請稍候...",next:"前往下一站",finish:"恭喜你完成重啟之路！",finishSub:"未來也請繼續善待自己！",error:"發生錯誤，請稍後再試。",retry:"再來一次"},"zh-CN":{back:"返回首页",logout:"登出",title:"日常任务挑战",subtitle:"一步步走出迷雾，看见全新的自己",steps:[{title:"第一站：迷雾山谷",desc:"写下最近一件让你感到强烈情绪的事。不必评判自己，单纯描述事情的经过、你的感受，以及这个感受带来的影响。",placeholder:"在这里写下你的故事...(300字内)"},{title:"第二站：希望之丘",desc:"回顾你刚刚写下的事件，请思考：在那个情境下，你有没有做过什么小小的努力或尝试？即使很微小，也请写下来。",placeholder:"写下你做过的努力或尝试...(300字内)"},{title:"第三站：勇气森林",desc:"根据你刚刚发现的努力或资源，请设定一个你愿意尝试的小行动，并写下你预期会遇到的困难，以及你打算怎么面对。",placeholder:"写下你的小行动与预期困难...(300字内)"},{title:"第四站：智慧溪流",desc:"回顾你刚刚的行动经验，请反思：这个过程中，你学到了什么？有没有什么新的发现或领悟？",placeholder:"写下你的学习与领悟...(300字内)"},{title:"第五站：重启之巅",desc:"综合前面所有关卡的经历，请写下你给未来自己的祝福或期许，并思考：如果未来再遇到困难，你会怎么鼓励自己？",placeholder:"写下给自己的祝福或期许...(300字内)"}],submit:"提交，寻求指引",loading:"请稍候...",next:"前往下一站",finish:"恭喜你完成重启之路！",finishSub:"未来也请继续善待自己！",error:"发生错误，请稍后再试。",retry:"再来一次"},en:{back:"Back to Home",logout:"Logout",title:"Restart Journey",subtitle:"Step by step out of the mist, see a new self",steps:[{title:"Step 1: Misty Valley",desc:"Write about a recent event that made you feel strong emotions. No need to judge yourself, just describe what happened, how you felt, and how it affected you.",placeholder:"Write your story here...(300 words max)"},{title:"Step 2: Hill of Hope",desc:"Review the event you just wrote. Did you make any small effort or try anything in that situation? Even if it was minor, write it down.",placeholder:"Write your effort or attempt...(300 words max)"},{title:"Step 3: Forest of Courage",desc:"Based on your discovered effort or resources, set a small action you are willing to try, and write down the difficulties you expect and how you plan to face them.",placeholder:"Write your action and expected difficulties...(300 words max)"},{title:"Step 4: Stream of Wisdom",desc:"Reflect on your action experience. What did you learn? Any new discoveries or insights?",placeholder:"Write your learning and insights...(300 words max)"},{title:"Step 5: Summit of Restart",desc:"Summarize all your experiences and write a blessing or expectation for your future self. If you face difficulties again, how will you encourage yourself?",placeholder:"Write your blessing or expectation...(300 words max)"}],submit:"Submit for Guidance",loading:"Please wait...",next:"Next Step",finish:"Congratulations on completing your restart journey!",finishSub:"Please continue to be kind to yourself in the future!",error:"An error occurred, please try again later.",retry:"Try Again"},ja:{back:"ホームに戻る",logout:"ログアウト",title:"日課ミッション挑戦",subtitle:"一歩ずつ霧を抜けて、新しい自分に出会おう",steps:[{title:"第1ステップ：霧の谷",desc:"最近あなたが強い感情を抱いた出来事について書いてください。自分を評価せず、出来事の経過や感情、その影響を素直に書きましょう。",placeholder:"ここにあなたのストーリーを書いてください...(300字以内)"},{title:"第2ステップ：希望の丘",desc:"先ほど書いた出来事を振り返り、その状況であなたが行った小さな努力や試みがあれば書いてください。些細なことでも構いません。",placeholder:"あなたの努力や試みを書いてください...(300字以内)"},{title:"第3ステップ：勇気の森",desc:"発見した努力やリソースをもとに、挑戦したい小さな行動と、予想される困難、それにどう向き合うかを書いてください。",placeholder:"行動と予想される困難を書いてください...(300字以内)"},{title:"第4ステップ：知恵の流れ",desc:"行動の経験を振り返り、学んだことや新たな気づきがあれば書いてください。",placeholder:"学びや気づきを書いてください...(300字以内)"},{title:"第5ステップ：再出発の頂",desc:"これまでの経験をまとめ、未来の自分へのメッセージや期待を書いてください。困難に直面したとき、どう自分を励ますかも考えてみましょう。",placeholder:"未来の自分へのメッセージや期待を書いてください...(300字以内)"}],submit:"提出して指導を求める",loading:"お待ちください...",next:"次のステップへ",finish:"再出発の道を完了しました！",finishSub:"これからも自分を大切にしてください！",error:"エラーが発生しました。しばらくしてから再度お試しください。",retry:"もう一度"},ko:{back:"홈으로",logout:"로그아웃",title:"일일 미션 도전",subtitle:"한 걸음씩 안개를 걷고, 새로운 나를 만나보세요",steps:[{title:"1단계: 안개의 계곡",desc:"최근에 강한 감정을 느꼈던 일을 적어보세요. 자신을 평가하지 말고, 그 일의 과정과 감정, 그리고 그 감정이 가져온 영향을 솔직하게 적어보세요.",placeholder:"여기에 당신의 이야기를 적어주세요...(300자 이내)"},{title:"2단계: 희망의 언덕",desc:"방금 적은 일을 돌아보며, 그 상황에서 했던 작은 노력이나 시도가 있다면 적어보세요. 아주 사소한 것도 괜찮아요.",placeholder:"노력이나 시도를 적어주세요...(300자 이내)"},{title:"3단계: 용기의 숲",desc:"발견한 노력이나 자원을 바탕으로, 시도해보고 싶은 작은 행동과 예상되는 어려움, 그리고 어떻게 대처할지 적어보세요.",placeholder:"행동과 예상되는 어려움을 적어주세요...(300자 이내)"},{title:"4단계: 지혜의 시냇물",desc:"행동 경험을 돌아보며, 배운 점이나 새로운 깨달음이 있다면 적어보세요.",placeholder:"배운 점이나 깨달음을 적어주세요...(300자 이내)"},{title:"5단계: 재시작의 정상",desc:"지금까지의 경험을 종합해 미래의 나에게 전하고 싶은 메시지나 기대를 적어보세요. 앞으로 어려움이 닥칠 때 어떻게 자신을 격려할지도 생각해보세요.",placeholder:"미래의 나에게 전하고 싶은 메시지나 기대를 적어주세요...(300자 이내)"}],submit:"제출하고 안내받기",loading:"잠시만 기다려주세요...",next:"다음 단계로",finish:"재시작의 여정을 완료했습니다!",finishSub:"앞으로도 자신을 소중히 하세요!",error:"오류가 발생했습니다. 잠시 후 다시 시도해주세요.",retry:"다시 시도"},th:{back:"กลับหน้าหลัก",logout:"ออกจากระบบ",title:"ภารกิจประจำวัน",subtitle:"ก้าวออกจากหมอกทีละก้าว พบกับตัวเองในมุมใหม่",steps:[{title:"ขั้นที่ 1: หุบเขาหมอก",desc:"เขียนเกี่ยวกับเหตุการณ์ล่าสุดที่ทำให้คุณรู้สึกอารมณ์รุนแรง ไม่ต้องตัดสินตัวเอง เพียงบรรยายเหตุการณ์ ความรู้สึก และผลกระทบที่เกิดขึ้น",placeholder:"เขียนเรื่องราวของคุณที่นี่...(300 คำ)"},{title:"ขั้นที่ 2: เนินแห่งความหวัง",desc:"ทบทวนเหตุการณ์ที่เพิ่งเขียนไป มีความพยายามหรือการลองทำอะไรเล็กๆ ในสถานการณ์นั้นหรือไม่ แม้จะเล็กน้อยก็เขียนได้",placeholder:"เขียนความพยายามหรือสิ่งที่ลองทำ...(300 คำ)"},{title:"ขั้นที่ 3: ป่าแห่งความกล้าหาญ",desc:"จากความพยายามหรือทรัพยากรที่ค้นพบ กำหนดการกระทำเล็กๆ ที่อยากลอง พร้อมทั้งอุปสรรคที่คาดว่าจะเจอและวิธีรับมือ",placeholder:"เขียนการกระทำและอุปสรรคที่คาดไว้...(300 คำ)"},{title:"ขั้นที่ 4: ลำธารแห่งปัญญา",desc:"ทบทวนประสบการณ์การกระทำของคุณ มีอะไรที่ได้เรียนรู้หรือค้นพบใหม่ๆ หรือไม่",placeholder:"เขียนสิ่งที่ได้เรียนรู้หรือค้นพบ...(300 คำ)"},{title:"ขั้นที่ 5: ยอดเขาแห่งการเริ่มต้นใหม่",desc:"สรุปประสบการณ์ทั้งหมด เขียนคำอวยพรหรือความคาดหวังถึงตัวเองในอนาคต หากเจออุปสรรคอีกจะให้กำลังใจตัวเองอย่างไร",placeholder:"เขียนคำอวยพรหรือความคาดหวัง...(300 คำ)"}],submit:"ส่งและขอคำแนะนำ",loading:"กรุณารอสักครู่...",next:"ไปยังขั้นถัดไป",finish:"คุณสำเร็จภารกิจเริ่มต้นใหม่แล้ว!",finishSub:"ขอให้ดูแลตัวเองต่อไป!",error:"เกิดข้อผิดพลาด กรุณาลองใหม่อีกครั้งภายหลัง",retry:"ลองอีกครั้ง"},vi:{back:"Về trang chủ",logout:"Đăng xuất",title:"Thử thách nhiệm vụ hàng ngày",subtitle:"Từng bước vượt qua sương mù, khám phá bản thân mới",steps:[{title:"Bước 1: Thung lũng sương mù",desc:"Viết về một sự kiện gần đây khiến bạn cảm xúc mạnh. Không cần phán xét bản thân, chỉ cần mô tả diễn biến, cảm xúc và ảnh hưởng của nó.",placeholder:"Viết câu chuyện của bạn tại đây...(300 từ)"},{title:"Bước 2: Đồi hy vọng",desc:"Xem lại sự kiện vừa viết, bạn có nỗ lực hoặc thử điều gì nhỏ không? Dù nhỏ cũng hãy ghi lại.",placeholder:"Viết nỗ lực hoặc điều bạn đã thử...(300 từ)"},{title:"Bước 3: Rừng dũng cảm",desc:"Dựa trên nỗ lực hoặc nguồn lực vừa phát hiện, hãy đặt ra một hành động nhỏ muốn thử, dự đoán khó khăn và cách đối mặt.",placeholder:"Viết hành động và khó khăn dự đoán...(300 từ)"},{title:"Bước 4: Suối trí tuệ",desc:"Xem lại trải nghiệm hành động, bạn học được gì? Có phát hiện hay nhận thức mới không?",placeholder:"Viết điều bạn học được hoặc nhận ra...(300 từ)"},{title:"Bước 5: Đỉnh tái khởi động",desc:"Tổng hợp mọi trải nghiệm, viết lời chúc hoặc kỳ vọng cho bản thân tương lai. Nếu gặp khó khăn, bạn sẽ động viên mình thế nào?",placeholder:"Viết lời chúc hoặc kỳ vọng...(300 từ)"}],submit:"Gửi và nhận hướng dẫn",loading:"Vui lòng chờ...",next:"Bước tiếp theo",finish:"Chúc mừng bạn đã hoàn thành hành trình tái khởi động!",finishSub:"Hãy tiếp tục yêu thương bản thân nhé!",error:"Đã xảy ra lỗi, vui lòng thử lại sau.",retry:"Thử lại"},la:{back:"Redi ad domum",logout:"Exire",title:"Provocatio Cotidiana",subtitle:"Gradatim e nebula progredere, novum te aspice",steps:[{title:"Gradus I: Vallis Nebulosa",desc:"Scribe de re nuper te vehementer commotum. Te ipsum iudicare noli, sed simpliciter rem, sensus tuos, et effectus describas.",placeholder:"Hic fabulam tuam scribe...(300 verba)"},{title:"Gradus II: Collis Spei",desc:"Recense rem modo scriptam. In illa condicione quid parvum conatus es? Etiam minima, scribe.",placeholder:"Conatum tuum scribe...(300 verba)"},{title:"Gradus III: Silva Virtutis",desc:"Ex conatu aut opibus inventis, parvam actionem temptare velis, difficultates praevides et quomodo eas superaturus sis scribe.",placeholder:"Actionem et difficultates scribe...(300 verba)"},{title:"Gradus IV: Rivus Sapientiae",desc:"Recense experientiam actionis. Quid didicisti? Quid novi invenisti?",placeholder:"Quae didicisti scribe...(300 verba)"},{title:"Gradus V: Culmen Renovationis",desc:"Omnia experientia colligens, votum aut spem tibi futuro scribe. Si iterum difficultates occurrant, quomodo te hortaberis?",placeholder:"Votum aut spem scribe...(300 verba)"}],submit:"Mitte et consilium pete",loading:"Exspecta quaeso...",next:"Ad gradum proximum",finish:"Iter renovationis confecisti!",finishSub:"Te ipsum semper cura!",error:"Error factus est, quaeso postea repete.",retry:"Iterum conare"},ms:{back:"Kembali ke Laman Utama",logout:"Log keluar",title:"Cabaran Misi Harian",subtitle:"Melangkah keluar dari kabus, temui diri baharu",steps:[{title:"Langkah 1: Lembah Berkabus",desc:"Tulis tentang peristiwa baru-baru ini yang membuatkan anda beremosi kuat. Tidak perlu menilai diri, hanya gambarkan peristiwa, perasaan dan kesannya.",placeholder:"Tulis kisah anda di sini...(300 patah perkataan)"},{title:"Langkah 2: Bukit Harapan",desc:"Imbas kembali peristiwa tadi, adakah anda berusaha atau mencuba sesuatu walaupun kecil? Catatkan walaupun kecil.",placeholder:"Tulis usaha atau percubaan anda...(300 patah perkataan)"},{title:"Langkah 3: Hutan Keberanian",desc:"Berdasarkan usaha atau sumber yang ditemui, tetapkan tindakan kecil yang ingin dicuba, jangka cabaran dan cara menghadapinya.",placeholder:"Tulis tindakan dan cabaran dijangka...(300 patah perkataan)"},{title:"Langkah 4: Sungai Kebijaksanaan",desc:"Imbas kembali pengalaman tindakan anda, apa yang anda pelajari? Ada penemuan atau kesedaran baharu?",placeholder:"Tulis apa yang anda pelajari...(300 patah perkataan)"},{title:"Langkah 5: Puncak Permulaan Semula",desc:"Gabungkan semua pengalaman, tulis harapan atau ucapan untuk diri masa depan. Jika hadapi cabaran lagi, bagaimana anda akan beri semangat pada diri?",placeholder:"Tulis harapan atau ucapan...(300 patah perkataan)"}],submit:"Hantar & mohon panduan",loading:"Sila tunggu...",next:"Langkah seterusnya",finish:"Tahniah, anda telah tamat perjalanan permulaan semula!",finishSub:"Teruskan sayangi diri anda!",error:"Ralat berlaku, sila cuba lagi kemudian.",retry:"Cuba lagi"}};function $S(){var W,L,R,A;const n=_t(),e=St(),{lang:t}=Mt(),r=HS["zh-TW"],o=HS[t]||r,a={...r,...o,steps:o.steps||r.steps,submit:o.submit||r.submit,loading:o.loading||r.loading,next:o.next||r.next,finish:o.finish||r.finish,finishSub:o.finishSub||r.finishSub,error:o.error||r.error,retry:o.retry||r.retry},[c,d]=v.useState(0),[h,m]=v.useState(""),[g,x]=v.useState([]),[S,C]=v.useState(""),[_,I]=v.useState(!1),[T,F]=v.useState(!1),P=(W=a.steps)==null?void 0:W[c];v.useEffect(()=>{var N;if(S&&c===(((N=a.steps)==null?void 0:N.length)||0)-1){F(!0);const O=setTimeout(()=>F(!1),3e3);return()=>clearTimeout(O)}},[S,c]);const B=async N=>{N.preventDefault(),I(!0),C("");try{console.log("Sending request to /api/mission-ai with:",{step:c,input:h,history:g});const O=await fetch("/api/mission-ai",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({step:c,input:h,history:g})});if(console.log("Response status:",O.status),!O.ok)throw new Error(`HTTP error! status: ${O.status}`);const z=await O.json();console.log("Response data:",z),C(z.reply||"AI教練祝福你！"),x(j=>[...j,h])}catch(O){console.error("Error in handleSubmit:",O),C("發生錯誤，請稍後再試。錯誤詳情："+(O instanceof Error?O.message:"未知錯誤"))}finally{I(!1)}},q=()=>{m(""),C(""),d(c+1)},te=()=>i.jsxs("div",{style:{position:"fixed",left:0,top:0,width:"100vw",height:"100vh",pointerEvents:"none",zIndex:9999,display:"flex",justifyContent:"center",alignItems:"center"},children:[i.jsx("iframe",{src:"https://embed.lottiefiles.com/animation/85716",style:{width:400,height:400,border:"none",background:"transparent"},title:"fireworks1"}),i.jsx("iframe",{src:"https://embed.lottiefiles.com/animation/85716",style:{width:400,height:400,border:"none",background:"transparent",position:"absolute",left:"20vw",top:"10vh"},title:"fireworks2"}),i.jsx("iframe",{src:"https://embed.lottiefiles.com/animation/85716",style:{width:400,height:400,border:"none",background:"transparent",position:"absolute",right:"20vw",top:"20vh"},title:"fireworks3"})]});return i.jsxs("div",{style:{minHeight:"100vh",width:"100vw",position:"relative",overflowX:"hidden",background:"url('/mountain.png') center center / cover no-repeat fixed, linear-gradient(to bottom, #eaf6ff 0%, #f7fafc 100%)"},children:[i.jsx("button",{onClick:()=>n("/"),style:{position:"absolute",top:"20px",left:"20px",zIndex:1e3,fontWeight:700,fontSize:16,padding:"8px 16px",borderRadius:8,border:"1.5px solid #6B5BFF",background:"#fff",color:"#6B5BFF",cursor:"pointer",minWidth:80,boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:a.back}),i.jsxs("div",{style:{position:"absolute",top:"20px",right:"20px",zIndex:1e3,display:"flex",alignItems:"center",gap:12},children:[i.jsx("button",{onClick:async()=>{await Ir(e),localStorage.clear(),window.location.href="/"},style:{fontWeight:700,fontSize:16,padding:"8px 16px",borderRadius:8,border:"1.5px solid #6B5BFF",background:"#fff",color:"#6B5BFF",cursor:"pointer",minWidth:80,boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:a.logout}),i.jsx("div",{style:{width:80},children:i.jsx(Bn,{style:{width:"100%"}})})]}),i.jsx("div",{style:{width:"100%",maxWidth:700,margin:"20px auto 20px auto",padding:"16px 24px",background:"rgba(255,255,255,0.95)",borderRadius:16,boxShadow:"0 4px 20px rgba(0,0,0,0.1)",display:"flex",alignItems:"center",justifyContent:"center",position:"relative"},children:i.jsxs("h1",{style:{fontWeight:900,fontSize:18,color:"#6B5BFF",margin:0,lineHeight:1,textShadow:"0 2px 8px #6B5BFF88",textAlign:"center"},children:[i.jsx("span",{role:"img","aria-label":"mission",children:"🎯"})," 挑戰任務"]})}),i.jsxs("div",{style:{maxWidth:600,margin:"0 auto",padding:"2rem 0 2rem 0",background:"rgba(255,255,255,0.92)",borderRadius:24,boxShadow:"0 8px 32px rgba(0,0,0,0.08)"},children:[i.jsx("h1",{style:{textAlign:"center",fontWeight:700,fontSize:"2rem",marginBottom:8},children:a.title}),i.jsx("div",{style:{textAlign:"center",color:"#666",marginBottom:32},children:a.subtitle}),i.jsxs("div",{style:{background:"#fff",borderRadius:16,padding:32,boxShadow:"0 2px 8px #0001",marginBottom:24},children:[i.jsx("div",{style:{fontWeight:700,fontSize:"1.3rem",color:"#2a5d8f",marginBottom:8},children:(P==null?void 0:P.title)||""}),i.jsx("div",{style:{color:"#333",marginBottom:24},children:(P==null?void 0:P.desc)||""}),i.jsxs("form",{onSubmit:B,children:[i.jsx("textarea",{value:h,onChange:N=>m(N.target.value),placeholder:(P==null?void 0:P.placeholder)||"",style:{width:"100%",minHeight:100,borderRadius:8,border:"1px solid #ccc",padding:12,marginBottom:16},required:!0}),i.jsx("button",{type:"submit",disabled:_||!h,style:{width:"100%",background:"#6B5BFF",color:"#fff",fontWeight:700,fontSize:18,border:"none",borderRadius:8,padding:"12px 0",cursor:_?"not-allowed":"pointer",opacity:_?.99:1,filter:"none",textShadow:"none",transition:"background 0.18s"},children:_?a.loading:a.submit})]}),S&&i.jsx("div",{style:{marginTop:24,background:"#f5f5f5",borderRadius:8,padding:16,color:"#2a5d8f"},children:S}),S&&c<(((L=a.steps)==null?void 0:L.length)||0)-1&&i.jsx("button",{onClick:q,style:{marginTop:16,width:"100%",background:"#6B5BFF",color:"#fff",fontWeight:700,fontSize:16,border:"none",borderRadius:8,padding:"10px 0",cursor:"pointer",transition:"background 0.18s"},children:a.next}),S&&c===(((R=a.steps)==null?void 0:R.length)||0)-1&&i.jsxs("div",{style:{marginTop:24,textAlign:"center",color:"#e6b800",fontWeight:700,fontSize:20},children:[a.finish,i.jsx("br",{}),i.jsx("span",{style:{fontSize:16,color:"#888"},children:a.finishSub}),T&&i.jsx(te,{}),i.jsx("div",{style:{marginTop:24},children:i.jsx("button",{onClick:()=>{d(0),m(""),x([]),C("")},style:{background:"#6B5BFF",color:"#fff",fontWeight:700,fontSize:16,border:"none",borderRadius:8,padding:"10px 32px",cursor:"pointer",marginTop:8,boxShadow:"0 2px 8px #0001",transition:"background 0.18s"},children:a.retry})})]})]}),i.jsx("div",{style:{textAlign:"center",color:"#aaa",fontSize:14},children:(a.steps||[]).map((N,O)=>i.jsx("span",{style:{display:"inline-block",width:18,height:18,borderRadius:"50%",background:O<=c?"#8ec6f7":"#e0e0e0",margin:"0 4px",border:O===c?"2px solid #2a5d8f":"none",transition:"all 0.2s"}},O))})]}),i.jsx("div",{style:{width:"100%",margin:"0 auto",marginTop:24,background:"rgba(255,255,255,0.95)",borderRadius:16,padding:"16px",boxShadow:"0 2px 12px #6B5BFF22"},children:i.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:20,flexWrap:"wrap"},children:[i.jsx("a",{href:"/privacy-policy",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12},children:t==="zh-TW"?"隱私權政策":t==="zh-CN"?"隐私政策":t==="en"?"Privacy Policy":t==="ja"?"プライバシーポリシー":t==="ko"?"개인정보 처리방침":t==="th"?"นโยบายความเป็นส่วนตัว":t==="vi"?"Chính sách bảo mật":t==="ms"?"Dasar Privasi":"Consilium de Privata"}),i.jsx("a",{href:"/terms",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12},children:t==="zh-TW"?"條款/聲明":t==="zh-CN"?"条款/声明":t==="en"?"Terms/Statement":t==="ja"?"規約/声明":t==="ko"?"약관/성명":t==="th"?"ข้อกำหนด/แถลงการณ์":t==="vi"?"Điều khoản/Tuyên bố":t==="ms"?"Terma/Pernyataan":"Termini/Declaratio"}),i.jsx("a",{href:"/data-deletion",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12},children:t==="zh-TW"?"資料刪除說明":t==="zh-CN"?"数据删除说明":t==="en"?"Data Deletion":t==="ja"?"データ削除について":t==="ko"?"데이터 삭제 안내":t==="th"?"คำอธิบายการลบข้อมูล":t==="vi"?"Giải thích xóa dữ liệu":t==="ms"?"Penjelasan Penghapusan Data":"Explicatio Deletionis Datae"}),i.jsx("a",{href:"/about",style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12},children:t==="zh-TW"?"🧬 Restarter™｜我們是誰":t==="zh-CN"?"🧬 Restarter™｜我们是谁":t==="en"?"🧬 Restarter™｜Who We Are":t==="ja"?"🧬 Restarter™｜私たちについて":t==="ko"?"🧬 Restarter™｜우리는 누구인가":t==="th"?"🧬 Restarter™｜เราเป็นใคร":t==="vi"?"🧬 Restarter™｜Chúng tôi là ai":t==="ms"?"🧬 Restarter™｜Siapa Kami":"🧬 Restarter™｜Quis sumus"}),i.jsx("a",{href:"/feedback",style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12},children:t==="zh-TW"?"💬 意見箱｜我們想聽你說":t==="zh-CN"?"💬 意见箱｜我们想听你说":t==="en"?"💬 Feedback Box｜We Want to Hear From You":t==="ja"?"💬 ご意見箱｜私たちはあなたの声を聞きたい":t==="ko"?"💬 피드백｜우리는 당신의 말을 듣고 싶습니다":t==="th"?"💬 กล่องความคิดเห็น｜เราอยากได้ยินจากคุณ":t==="vi"?"💬 Hộp góp ý｜Chúng tôi muốn nghe từ bạn":t==="ms"?"💬 Kotak Maklum Balas｜Kami Ingin Mendengar Dari Anda":"💬 Arca Consilii｜Volumus Audire a Te"})]})}),S&&c===(((A=a.steps)==null?void 0:A.length)||0)-1&&T&&i.jsx(te,{})]})}const CN={encouragement:"/videos/encouragement.mp4",reproach:"/videos/reproach.mp4",motivation:"/videos/motivation.mp4",disappointment:"/videos/disappointment.mp4",joy:"/videos/joy.mp4",lost:"/videos/lost.mp4",breakthrough:"/videos/breakthrough.mp4",clarity:"/videos/clarity.mp4",reluctance:"/videos/reluctance.mp4",confusion:"/videos/confusion.mp4",affection:"/videos/affection.mp4",regret:"/videos/regret.mp4",admiration:"/videos/admiration.mp4",teasing:"/videos/teasing.mp4"};function RN({reactionType:n,onEnd:e,style:t,className:r="",autoPlay:o=!0,...a}){const c=v.useRef(null);return v.useEffect(()=>{o&&c.current&&(c.current.currentTime=0,c.current.play())},[n,o]),i.jsx("div",{className:`video-reaction-player ${r}`,style:{position:"fixed",left:0,top:0,width:"100vw",height:"100vh",zIndex:3e3,background:"rgba(0,0,0,0.32)",display:"flex",alignItems:"center",justifyContent:"center",...t},...a,children:i.jsx("video",{ref:c,src:CN[n],style:{maxWidth:"90vw",maxHeight:"80vh",borderRadius:18,boxShadow:"0 8px 32px #0008",background:"#000"},autoPlay:o,onEnded:e,controls:!1,playsInline:!0})})}const wI=v.createContext({setVideoReaction:()=>{}});function EN(){return v.useContext(wI)}function AN({children:n}){const[e,t]=v.useState(null);return i.jsxs(wI.Provider,{value:{setVideoReaction:t},children:[n,e&&i.jsx(RN,{reactionType:e,onEnd:()=>t(null)})]})}const $t={backToHome:{"zh-TW":"← 返回首頁","zh-CN":"← 返回首页",ja:"← ホームへ戻る",en:"← Home",ko:"← 홈으로 돌아가기",th:"← กลับหน้าหลัก",vi:"← Về trang chủ",ms:"← Kembali ke Laman Utama",la:"← Ad domum redire"},back:{"zh-TW":"↩ 返回上一頁","zh-CN":"↩ 返回上一页",ja:"↩ 前のページへ",en:"↩ Back",ko:"↩ 이전 페이지로",th:"↩ กลับไป",vi:"↩ Quay lại",ms:"↩ Kembali",la:"↩ Redire"},logout:{"zh-TW":"登出","zh-CN":"登出",ja:"ログアウト",en:"Logout",ko:"로그아웃",th:"ออกจากระบบ",vi:"Đăng xuất",ms:"Log keluar",la:"Exire"},pageTitle:{"zh-TW":"配對對聊 PairTalk","zh-CN":"配对对聊 PairTalk",ja:"ペアトーク PairTalk",en:"PairTalk",ko:"페어톡",th:"คู่คุย",vi:"Trò chuyện đôi",ms:"PairTalk",la:"PairTalk"},subtitle:{"zh-TW":"劫後餘生的交友最珍貴，沒人怕跨出第一步！","zh-CN":"劫后余生的交友最珍贵，没人怕跨出第一步！",en:"Friendship after hardship is the most precious, no one is afraid to take the first step!",ja:"困難を乗り越えた後の友情こそが最も貴重、一歩踏み出すのは誰も怖くない！",ko:"역경 후의 우정이 가장 소중하며, 첫 걸음을 내딛는 것을 두려워하는 사람은 아무도 없습니다!",th:"มิตรภาพหลังความยากลำบากนั้นมีค่าที่สุด ไม่มีใครกลัวที่จะก้าวแรก!",vi:"Tình bạn sau gian khó là quý giá nhất, không ai ngại bước bước đầu tiên!",ms:"Persahabatan selepas kesusahan adalah yang paling berharga, tiada siapa yang takut untuk mengambil langkah pertama!",la:"Amicitia post aerumnas pretiosissima est, nemo primum gradum timere metuit!"},matchStatus:{"zh-TW":"配對狀態","zh-CN":"配对状态",ja:"マッチ状況",en:"Match Status",ko:"매칭 상태",th:"สถานะการจับคู่",vi:"Tình trạng ghép đôi",ms:"Status Padanan",la:"Status Par"},empty:{"zh-TW":"目前沒有配對，等待系統為你尋找夥伴...","zh-CN":"目前没有配对，等待系统为你寻找伙伴...",en:"No matches yet. Waiting for a companion...",ja:"まだマッチがありません。相手を探しています...",ko:"아직 매칭이 없습니다. 상대를 기다리는 중...",th:"ยังไม่มีคู่ รอระบบหาคู่ให้อยู่...",vi:"Chưa có ai được ghép đôi. Đang chờ hệ thống tìm bạn đồng hành...",ms:"Tiada padanan lagi. Menunggu teman...",la:"Nulli pares adhuc. Socium exspectans..."},todayMatch:{"zh-TW":"今日配對：","zh-CN":"今日配对：",ja:"今日のマッチ：",en:"Today's Match:",ko:"오늘의 매칭:",th:"คู่ของวันนี้:",vi:"Ghép đôi hôm nay:",ms:"Padanan Hari Ini:",la:"Par Hodiernus:"},timeLeft:{"zh-TW":"剩餘時間：","zh-CN":"剩余时间：",ja:"残り時間：",en:"Time Left:",ko:"남은 시간:",th:"เวลาที่เหลือ:",vi:"Thời gian còn lại:",ms:"Masa Tinggal:",la:"Tempus Reliquum:"},archive:{"zh-TW":"封存對話","zh-CN":"封存对话",ja:"アーカイブ",en:"Archive",ko:"보관",th:"เก็บถาวร",vi:"Lưu trữ",ms:"Arkib",la:"Archivum"},rematch:{"zh-TW":"重配","zh-CN":"重配",ja:"再マッチ",en:"Rematch",ko:"재매칭",th:"จับคู่ใหม่",vi:"Ghép lại",ms:"Padan semula",la:"Repar"},history:{"zh-TW":"歷史配對","zh-CN":"历史配对",ja:"履歴",en:"History",ko:"기록",th:"ประวัติ",vi:"Lịch sử",ms:"Sejarah",la:"Historia"},viewDetails:{"zh-TW":"查看完整資料","zh-CN":"查看完整资料",ja:"詳細を見る",en:"View Details",ko:"상세 정보 보기",th:"ดูรายละเอียด",vi:"Xem chi tiết",ms:"Lihat Butiran",la:"Singula Videre"},hideDetails:{"zh-TW":"收合資料","zh-CN":"收起资料",ja:"閉じる",en:"Hide",ko:"숨기기",th:"ซ่อน",vi:"Ẩn",ms:"Sembunyi",la:"Celare"},nickname:{"zh-TW":"暱稱","zh-CN":"昵称",ja:"ニックネーム",en:"Nickname",ko:"닉네임",th:"ชื่อเล่น",vi:"Biệt danh",ms:"Nama Samaran",la:"Agnomen"},country:{"zh-TW":"國家","zh-CN":"国家",ja:"国",en:"Country",ko:"국가",th:"ประเทศ",vi:"Quốc gia",ms:"Negara",la:"Natio"},age:{"zh-TW":"年齡","zh-CN":"年龄",ja:"年齢",en:"Age",ko:"나이",th:"อายุ",vi:"Tuổi",ms:"Umur",la:"Aetas"},gender:{"zh-TW":"性別","zh-CN":"性别",ja:"性別",en:"Gender",ko:"성별",th:"เพศ",vi:"Giới tính",ms:"Jantina",la:"Genus"},interest:{"zh-TW":"興趣","zh-CN":"兴趣",ja:"趣味",en:"Interest",ko:"관심사",th:"ความสนใจ",vi:"Sở thích",ms:"Minat",la:"Studium"},eventType:{"zh-TW":"事件類型","zh-CN":"事件类型",ja:"イベントタイプ",en:"Event Type",ko:"이벤트 유형",th:"ประเภทเหตุการณ์",vi:"Loại sự kiện",ms:"Jenis Acara",la:"Genus Eventus"},bio:{"zh-TW":"簡介","zh-CN":"简介",ja:"自己紹介",en:"Bio",ko:"소개",th:"ประวัติ",vi:"Tiểu sử",ms:"Bio",la:"Bio"},sendGift:{"zh-TW":"送出禮物","zh-CN":"送出礼物",ja:"ギフトを送る",en:"Send Gift",ko:"선물 보내기",th:"ส่งของขวัญ",vi:"Gửi quà",ms:"Hantar Hadiah",la:"Donum Mittere"},sendEmail:{"zh-TW":"發送Email","zh-CN":"发送Email",ja:"メール送信",en:"Send Email",ko:"이메일 보내기",th:"ส่งอีเมล",vi:"Gửi Email",ms:"Hantar E-mel",la:"Epistulam Mittere"},next:{"zh-TW":"下一頁","zh-CN":"下一页",ja:"次へ",en:"Next",ko:"다음",th:"ถัดไป",vi:"Tiếp",ms:"Seterusnya",la:"Proximus"},lastPage:{"zh-TW":"最後一頁","zh-CN":"最后一页",ja:"最後のページ",en:"Last page",ko:"마지막 페이지",th:"หน้าสุดท้าย",vi:"Trang cuối",ms:"Halaman terakhir",la:"Pagina Ultima"}},PN=[{id:1,partner:"小明",status:"active",aiGuide:"你可以問對方：今天過得如何？"},{id:2,partner:"Sandy",status:"archived",aiGuide:"你可以問對方：最近有什麼開心的事？"}],ry=[{id:1,nickname:"Alice",country:"台灣",age:28,gender:"female",email:"alice@example.com",bio:"喜歡閱讀與旅行",interest:"閱讀",eventType:"經濟",avatar:"/avatars/female1.jpg"},{id:2,nickname:"Bob",country:"日本",age:32,gender:"male",email:"bob@example.com",bio:"音樂愛好者",interest:"音樂",eventType:"科技",avatar:"/avatars/male1.jpg"}],GS={"zh-TW":{male:"男性",female:"女性",other:"其他"},"zh-CN":{male:"男性",female:"女性",other:"其他"},en:{male:"Male",female:"Female",other:"Other"},ja:{male:"男性",female:"女性",other:"その他"},ko:{male:"남성",female:"여성",other:"기타"},th:{male:"ชาย",female:"หญิง",other:"อื่นๆ"},vi:{male:"Nam",female:"Nữ",other:"Khác"},ms:{male:"Lelaki",female:"Perempuan",other:"Lain-lain"},la:{male:"Mas",female:"Femina",other:"Aliud"}},KS=[{value:"🌹",label:"🌹"},{value:"💍",label:"💍"},{value:"🍰",label:"🍰"},{value:"🎩",label:"🎩"},{value:"🌺",label:"🌺"},{value:"👗",label:"👗"},{value:"✒️",label:"✒️"},{value:"🏎️",label:"🏎️"}],BN={"zh-TW":"歲","zh-CN":"岁",en:"yrs",ja:"歳",ko:"세",th:"ปี",vi:"tuổi",ms:"tahun",la:"anni"};function FN(){var A,N,O,z;const n=_t(),e=St(),t=((A=e.currentUser)==null?void 0:A.email)||"",r=Mt(),[o,a]=v.useState(JSON.parse(localStorage.getItem("pairs")||"[]")||PN),[c,d]=v.useState(300),[h,m]=v.useState(((N=o.find(j=>j.status==="active"))==null?void 0:N.id)||null),[g,x]=v.useState("AI：記得保持友善，互相傾聽！"),[S,C]=v.useState(0),_=ry[S],[I,T]=v.useState(!1),[F,P]=v.useState(KS[0].value),{setVideoReaction:B}=EN();En.useEffect(()=>{if(h){const j=setInterval(()=>d(V=>V>0?V-1:0),1e3);return()=>clearInterval(j)}},[h]);const q=j=>{a(o.map(V=>V.id===j?{...V,status:"archived"}:V)),localStorage.setItem("pairs",JSON.stringify(o.map(V=>V.id===j?{...V,status:"archived"}:V))),B("disappointment")},te=()=>{B("breakthrough")},W=()=>{alert(`${F} 已送出給 ${_.nickname}！`)},L=()=>{window.location.href=`mailto:${_.email}?subject=PairTalk&body=Hi${t?`&from=${t}`:""}`},R=()=>{if(ry.length<=1||S===ry.length-1){alert($t.lastPage[r]);return}T(!1),C(j=>j+1)};return i.jsxs("div",{className:"modern-bg",style:{background:"url('/valley.png') center center / cover no-repeat",minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center"},children:[i.jsxs("div",{style:{position:"absolute",top:0,left:0,zIndex:100,display:"flex",alignItems:"center",padding:"18px 32px 0 32px",background:"transparent"},children:[i.jsx("button",{className:"topbar-btn",onClick:()=>n("/"),style:{fontWeight:700,fontSize:18,padding:"6px 16px",borderRadius:8,border:"1.5px solid #6B5BFF",background:"#fff",color:"#6B5BFF",cursor:"pointer",transition:"background 0.18s, color 0.18s, border 0.18s",marginRight:8},onMouseOver:j=>{j.currentTarget.style.background="#6B5BFF",j.currentTarget.style.color="#fff"},onMouseOut:j=>{j.currentTarget.style.background="#fff",j.currentTarget.style.color="#6B5BFF"},children:$t.backToHome[r]}),window.location.pathname!=="/pairtalk"&&i.jsx("button",{className:"topbar-btn",onClick:()=>n(-1),style:{fontWeight:700,fontSize:18,padding:"6px 16px",borderRadius:8,border:"1.5px solid #6B5BFF",background:"#fff",color:"#6B5BFF",cursor:"pointer",transition:"background 0.18s, color 0.18s, border 0.18s",marginLeft:8},onMouseOver:j=>{j.currentTarget.style.background="#6B5BFF",j.currentTarget.style.color="#fff"},onMouseOut:j=>{j.currentTarget.style.background="#fff",j.currentTarget.style.color="#6B5BFF"},children:$t.back[r]})]}),i.jsxs("div",{style:{position:"absolute",top:0,right:0,zIndex:100,display:"flex",alignItems:"center",padding:"18px 32px 0 32px",background:"transparent",gap:12},children:[i.jsx("button",{className:"topbar-btn",onClick:async()=>{await Ir(e),localStorage.clear(),window.location.href="/"},style:{fontWeight:700,fontSize:18,padding:"6px 16px",borderRadius:8,border:"1.5px solid #6B5BFF",background:"#fff",color:"#6B5BFF",cursor:"pointer",transition:"background 0.18s, color 0.18s, border 0.18s"},onMouseOver:j=>{j.currentTarget.style.background="#6B5BFF",j.currentTarget.style.color="#fff"},onMouseOut:j=>{j.currentTarget.style.background="#fff",j.currentTarget.style.color="#6B5BFF"},children:$t.logout[r]}),i.jsx(Bn,{})]}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[i.jsxs("h2",{style:{fontSize:"2.2rem",fontWeight:900,color:"#6B5BFF",textShadow:"0 2px 12px #6B5BFF88, 0 4px 24px #0008",letterSpacing:1,background:"#fff",borderRadius:12,boxShadow:"0 2px 12px #6B5BFF22",padding:"12px 32px",margin:0,marginBottom:24,display:"flex",alignItems:"center",gap:12},children:["🤝 ",$t.pageTitle[r]]}),i.jsxs("div",{style:{maxWidth:540,width:"100%",background:"#fff",borderRadius:16,padding:32,boxShadow:"0 4px 24px #0002",display:"flex",flexDirection:"column",alignItems:"center"},children:[i.jsx("div",{style:{fontSize:22,color:"#6B5BFF",fontWeight:900,marginBottom:24,textAlign:"center",textShadow:"0 2px 12px #6B5BFF88, 0 4px 24px #0008"},children:$t.subtitle[r]}),i.jsx("h2",{style:{fontSize:28,fontWeight:900,marginBottom:18},children:$t.pageTitle[r]}),i.jsxs("div",{style:{marginTop:18},children:[i.jsx("b",{children:$t.matchStatus[r]}),i.jsx("div",{style:{marginTop:8},children:$t.empty[r]})]}),h?i.jsxs("div",{style:{marginBottom:16},children:[i.jsx("b",{children:$t.todayMatch[r]})," ",(O=o.find(j=>j.id===h))==null?void 0:O.partner,i.jsxs("div",{style:{marginTop:8,color:"#6B5BFF"},children:[$t.timeLeft[r],Math.floor(c/60),":",(c%60).toString().padStart(2,"0")]}),i.jsx("div",{style:{marginTop:8,color:"#23c6e6"},children:(z=o.find(j=>j.id===h))==null?void 0:z.aiGuide}),i.jsx("div",{style:{marginTop:8,color:"#614425"},children:g}),i.jsx("button",{onClick:()=>q(h),style:{marginTop:10,borderRadius:8,background:"#eee",color:"#6B5BFF",border:"none",fontWeight:700,padding:"6px 18px"},children:$t.archive[r]}),i.jsx("button",{onClick:te,style:{marginTop:10,marginLeft:10,borderRadius:8,background:"#6B5BFF",color:"#fff",border:"none",fontWeight:700,padding:"6px 18px"},children:$t.rematch[r]})]}):i.jsx("div",{style:{color:"#614425",fontSize:18,textAlign:"center",marginTop:40},children:$t.empty[r]}),i.jsxs("div",{style:{marginTop:18},children:[i.jsx("b",{children:$t.history[r]}),i.jsx("ul",{style:{marginTop:8,paddingLeft:0,listStyle:"none"},children:o.filter(j=>j.status==="archived").map((j,V)=>i.jsxs("li",{style:{background:"#f7f7ff",borderRadius:8,padding:10,marginBottom:8},children:[i.jsx("div",{style:{fontWeight:700},children:j.partner}),i.jsx("div",{style:{color:"#614425",marginTop:4},children:j.aiGuide})]},V))})]}),i.jsxs("div",{style:{width:"100%",maxWidth:420,margin:"0 auto",background:"#f7f7ff",borderRadius:16,padding:24,boxShadow:"0 2px 12px #6B5BFF11",marginBottom:24,textAlign:"center",position:"relative"},children:[i.jsx("img",{src:_.avatar,alt:"avatar",style:{width:72,height:72,borderRadius:"50%",objectFit:"cover",border:"2px solid #6B5BFF",background:"#eee",marginBottom:12}}),i.jsx("div",{style:{fontWeight:700,fontSize:20,color:"#6B5BFF",marginBottom:6},children:_.nickname}),i.jsxs("div",{style:{color:"#614425",fontSize:16,marginBottom:6},children:[_.country," / ",_.age,BN[r]," / ",GS[r][_.gender]]}),i.jsx("button",{onClick:()=>T(j=>!j),style:{margin:"8px 0",padding:"6px 18px",borderRadius:8,fontWeight:700,background:"#fff",color:"#6B5BFF",border:"2px solid #6B5BFF",cursor:"pointer",fontSize:15,transition:"background 0.18s, color 0.18s, box-shadow 0.18s"},onMouseOver:j=>{j.currentTarget.style.background="#6B5BFF",j.currentTarget.style.color="#fff",j.currentTarget.style.boxShadow="0 6px 32px #6B5BFF99"},onMouseOut:j=>{j.currentTarget.style.background="#fff",j.currentTarget.style.color="#6B5BFF",j.currentTarget.style.boxShadow="none"},children:I?$t.hideDetails[r]:$t.viewDetails[r]}),I&&i.jsxs("div",{style:{marginTop:8,color:"#232946",fontSize:15,background:"#fff",borderRadius:8,padding:12,boxShadow:"0 2px 8px #6B5BFF11",display:"flex",flexDirection:"column",alignItems:"center",gap:8},children:[i.jsx("img",{src:_.avatar,alt:"avatar",style:{width:72,height:72,borderRadius:"50%",objectFit:"cover",border:"2px solid #6B5BFF",background:"#eee",marginBottom:6}}),i.jsxs("div",{children:[i.jsxs("b",{children:[$t.nickname[r],"："]}),_.nickname]}),i.jsxs("div",{children:[i.jsxs("b",{children:[$t.country[r],"："]}),_.country]}),i.jsxs("div",{children:[i.jsxs("b",{children:[$t.age[r],"："]}),_.age]}),i.jsxs("div",{children:[i.jsxs("b",{children:[$t.gender[r],"："]}),GS[r][_.gender]]}),i.jsxs("div",{children:[i.jsx("b",{children:"Email："}),_.email]}),i.jsxs("div",{children:[i.jsxs("b",{children:[$t.interest[r],"："]}),_.interest]}),i.jsxs("div",{children:[i.jsxs("b",{children:[$t.eventType[r],"："]}),_.eventType]}),i.jsxs("div",{children:[i.jsxs("b",{children:[$t.bio[r],"："]}),_.bio]})]}),i.jsxs("div",{style:{marginTop:14,display:"flex",flexDirection:"row",gap:10,justifyContent:"center",alignItems:"center"},children:[i.jsx("select",{value:F,onChange:j=>P(j.target.value),style:{padding:"6px 12px",borderRadius:8,border:"1.5px solid #6B5BFF",fontSize:18},children:KS.map(j=>i.jsx("option",{value:j.value,children:j.label},j.value))}),i.jsx("button",{onClick:W,style:{padding:"6px 18px",borderRadius:8,fontWeight:700,background:"linear-gradient(135deg, #6B5BFF 60%, #23c6e6 100%)",color:"#fff",border:"none",fontSize:16,transition:"background 0.18s, box-shadow 0.18s"},onMouseOver:j=>{j.currentTarget.style.background="linear-gradient(135deg, #3a2fff 60%, #0e7fd6 100%)",j.currentTarget.style.boxShadow="0 6px 32px #6B5BFF99"},onMouseOut:j=>{j.currentTarget.style.background="linear-gradient(135deg, #6B5BFF 60%, #23c6e6 100%)",j.currentTarget.style.boxShadow="none"},children:$t.sendGift[r]}),i.jsx("button",{onClick:L,style:{padding:"6px 18px",borderRadius:8,fontWeight:700,background:"#fff",color:"#6B5BFF",border:"2px solid #6B5BFF",fontSize:16,transition:"background 0.18s, color 0.18s, box-shadow 0.18s"},onMouseOver:j=>{j.currentTarget.style.background="#6B5BFF",j.currentTarget.style.color="#fff",j.currentTarget.style.boxShadow="0 6px 32px #6B5BFF99"},onMouseOut:j=>{j.currentTarget.style.background="#fff",j.currentTarget.style.color="#6B5BFF",j.currentTarget.style.boxShadow="none"},children:$t.sendEmail[r]})]}),i.jsx("button",{onClick:R,style:{position:"absolute",right:18,bottom:0,transform:"translateY(60px)",padding:"8px 24px",borderRadius:8,fontWeight:700,background:"linear-gradient(135deg, #6B5BFF 60%, #23c6e6 100%)",color:"#fff",border:"none",fontSize:16,boxShadow:"0 2px 8px #6B5BFF33",transition:"background 0.18s, box-shadow 0.18s, transform 0.18s",cursor:"pointer"},onMouseOver:j=>{j.currentTarget.style.background="linear-gradient(135deg, #3a2fff 60%, #0e7fd6 100%)",j.currentTarget.style.boxShadow="0 6px 32px #6B5BFF99",j.currentTarget.style.transform="translateY(55px) scale(1.04)"},onMouseOut:j=>{j.currentTarget.style.background="linear-gradient(135deg, #6B5BFF 60%, #23c6e6 100%)",j.currentTarget.style.boxShadow="0 2px 8px #6B5BFF33",j.currentTarget.style.transform="translateY(60px)"},children:$t.next[r]})]})]})]}),i.jsx("div",{style:{width:"100%",margin:"0 auto",marginTop:24,background:"rgba(255,255,255,0.95)",borderRadius:16,padding:"16px",boxShadow:"0 2px 12px #6B5BFF22"},children:i.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:20,flexWrap:"wrap"},children:[i.jsx("a",{href:"/privacy-policy",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12},children:"隱私權政策"}),i.jsx("a",{href:"/terms",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12},children:"條款/聲明"}),i.jsx("a",{href:"/data-deletion",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12},children:"資料刪除說明"}),i.jsx("a",{href:"/about",style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12},children:"🧬 Restarter™｜我們是誰"}),i.jsx("a",{href:"/feedback",style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12},children:"💬 意見箱｜我們想聽你說"})]})})]})}const lo={backToHome:{"zh-TW":"← 返回","zh-CN":"← 返回",ja:"← 戻る",en:"← Back",ko:"← 뒤로",th:"← กลับ",vi:"← Quay lại",ms:"← Kembali",la:"← Redire"},logout:{"zh-TW":"登出","zh-CN":"登出",ja:"ログアウト",en:"Logout",ko:"로그아웃",th:"ออกจากระบบ",vi:"Đăng xuất",ms:"Log keluar",la:"Exire"},pageTitle:{"zh-TW":"情境模擬室 SkillBox","zh-CN":"情境模拟室 SkillBox",en:"SkillBox Scenario Room",ja:"シナリオ練習室 SkillBox",ko:"상황 시뮬레이션실 SkillBox",th:"ห้องจำลองสถานการณ์ SkillBox",vi:"Phòng mô phỏng tình huống SkillBox",ms:"Bilik Senario SkillBox",la:"Camera Scaenarii SkillBox"},subtitle:{"zh-TW":"在這裡磨練你的對話技巧，應對各種挑戰。","zh-CN":"在这里磨练你的对话技巧，应对各种挑战。",en:"Hone your conversation skills here for any challenge.",ja:"ここで会話スキルを磨き、様々な挑戦に備えましょう。",ko:"여기서 대화 기술을 연마하여 모든 도전에 대비하세요.",th:"ฝึกฝนทักษะการสนทนาของคุณที่นี่เพื่อรับมือกับทุกความท้าทาย",vi:"Rèn luyện kỹ năng trò chuyện của bạn ở đây cho mọi thử thách.",ms:"Asah kemahiran perbualan anda di sini untuk sebarang cabaran.",la:"Hic peritiam colloquii tui exacue ad quamvis provocationem."},selectScenario:{"zh-TW":"選擇一個情境開始練習","zh-CN":"选择一个情境开始练习",en:"Select a scenario to start practicing",ja:"練習を始めるシナリオを選択してください",ko:"연습을 시작할 시나리오를 선택하세요",th:"เลือกสถานการณ์เพื่อเริ่มฝึก",vi:"Chọn một kịch bản để bắt đầu luyện tập",ms:"Pilih senario untuk mula berlatih",la:"Scaenarium elige ut exercere incipias"},startPractice:{"zh-TW":"進入模擬","zh-CN":"进入模拟",en:"Enter Simulation",ja:"シミュレーションに入る",ko:"시뮬레이션 시작",th:"เข้าสู่การจำลอง",vi:"Vào mô phỏng",ms:"Masuk Simulasi",la:"Intra Simulationem"},scenarioDifficulty:{"zh-TW":"難度","zh-CN":"难度",en:"Difficulty",ja:"難易度",ko:"난이도",th:"ความยาก",vi:"Độ khó",ms:"Kesukaran",la:"Difficultas"},cancelButton:{"zh-TW":"取消","zh-CN":"取消",en:"Cancel",ja:"キャンセル",ko:"취소",th:"ยกเลิก",vi:"Hủy",ms:"Batal",la:"Abstinere"}};function zN(){const n=_t(),e=St(),{lang:t}=Mt(),r=t||localStorage.getItem("lang")||"zh-TW",[o,a]=v.useState(null),[c,d]=v.useState([]),[h,m]=v.useState(!0),[g,x]=v.useState(!1),[S,C]=v.useState(null);v.useEffect(()=>{(async()=>{m(!0);try{const P=await fetch(`/locales/${r}/scenarios.json`);if(!P.ok)throw new Error("Failed to fetch scenarios");const B=await P.json();d(B)}catch(P){console.error("Error fetching scenarios:",P),d([])}finally{m(!1)}})()},[r]);const _=F=>{C(F),a(F.id),x(!0)},I=()=>{o?n(`/skillbox/${o}`):alert(lo.selectScenario[r])},T=()=>{x(!1),C(null),a(null)};return h?i.jsx("div",{children:"Loading scenarios..."}):i.jsxs("div",{className:"modern-bg",style:{background:"url('/plains.png') center center / cover no-repeat fixed",minHeight:"100vh",width:"100vw",overflow:"hidden",position:"relative"},children:[i.jsxs("div",{style:{width:"100%",maxWidth:700,margin:"20px auto 20px auto",padding:"16px 24px",background:"rgba(255,255,255,0.95)",borderRadius:16,boxShadow:"0 4px 20px rgba(0,0,0,0.1)",display:"flex",alignItems:"center",justifyContent:"space-between",position:"relative"},children:[i.jsx("button",{onClick:()=>n("/"),style:{fontWeight:700,fontSize:16,padding:"8px 16px",borderRadius:8,border:"1.5px solid #6B5BFF",background:"#fff",color:"#6B5BFF",cursor:"pointer",minWidth:80},children:lo.backToHome[r]}),i.jsxs("h1",{style:{fontWeight:900,fontSize:18,color:"#6B5BFF",margin:0,lineHeight:1,textShadow:"0 2px 8px #6B5BFF88",textAlign:"center",flex:1},children:[i.jsx("span",{role:"img","aria-label":"skillbox",children:"🛠️"})," ",lo.pageTitle[r]]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[i.jsx("button",{onClick:async()=>{await Ir(e),localStorage.clear(),window.location.href="/"},style:{fontWeight:700,fontSize:16,padding:"8px 16px",borderRadius:8,border:"1.5px solid #6B5BFF",background:"#fff",color:"#6B5BFF",cursor:"pointer",minWidth:80},children:lo.logout[r]}),i.jsx("div",{style:{width:80},children:i.jsx(Bn,{style:{width:"100%"}})})]})]}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",width:"100%",padding:"24px",marginTop:20,minHeight:"calc(100vh - 120px)",overflowY:"auto"},children:[i.jsx("div",{style:{fontSize:18,color:"#4A4A4A",fontWeight:500,marginBottom:24,textAlign:"center",background:"rgba(255,255,255,0.7)",padding:"8px 16px",borderRadius:8},children:lo.subtitle[r]}),i.jsxs("div",{style:{maxWidth:800,width:"100%",background:"#fff",borderRadius:16,padding:"24px 32px",boxShadow:"0 4px 24px #0002",display:"flex",flexDirection:"column",alignItems:"center"},children:[i.jsx("h3",{style:{fontSize:24,fontWeight:700,color:"#6B5BFF",marginBottom:24},children:lo.selectScenario[r]}),i.jsx("div",{style:{width:"100%",display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"24px"},children:c.map(F=>i.jsxs("div",{onClick:()=>_(F),style:{background:o===F.id?"linear-gradient(135deg, #6B5BFF 0%, #4D8FFF 100%)":"#f7f7ff",color:o===F.id?"#fff":"#4A4A4A",borderRadius:12,padding:20,boxShadow:o===F.id?"0 8px 24px #6B5BFF66":"0 4px 12px #0000001a",cursor:"pointer",transition:"all 0.3s ease",border:o===F.id?"2px solid #fff":"2px solid transparent",transform:o===F.id?"translateY(-5px)":"none",display:"flex",flexDirection:"column",alignItems:"center",textAlign:"center"},children:[i.jsx("div",{style:{fontSize:48,marginBottom:12},children:F.emoji}),i.jsx("h4",{style:{fontSize:18,fontWeight:700,margin:"0 0 8px 0"},children:F.title}),i.jsx("p",{style:{fontSize:14,margin:"0 0 12px 0",opacity:.8,minHeight:"40px"},children:F.description}),i.jsxs("div",{style:{fontWeight:600,fontSize:14,padding:"4px 12px",borderRadius:16,background:o===F.id?"rgba(255,255,255,0.2)":"rgba(107, 91, 255, 0.1)",color:o===F.id?"#fff":"#6B5BFF"},children:[lo.scenarioDifficulty[r],": ",F.difficulty]})]},F.id))})]})]}),g&&S&&i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},onClick:T,children:i.jsxs("div",{style:{background:"#fff",borderRadius:16,padding:"32px",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.3)",maxWidth:400,width:"90%",textAlign:"center",position:"relative"},onClick:F=>F.stopPropagation(),children:[i.jsx("button",{onClick:T,style:{position:"absolute",top:12,right:12,background:"none",border:"none",fontSize:24,cursor:"pointer",color:"#999",width:32,height:32,display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"50%",transition:"background-color 0.2s"},onMouseOver:F=>F.currentTarget.style.backgroundColor="#f0f0f0",onMouseOut:F=>F.currentTarget.style.backgroundColor="transparent",children:"×"}),i.jsx("div",{style:{fontSize:48,marginBottom:16},children:S.emoji}),i.jsx("h3",{style:{fontSize:20,fontWeight:700,color:"#6B5BFF",margin:"0 0 8px 0"},children:S.title}),i.jsx("p",{style:{fontSize:14,color:"#666",margin:"0 0 16px 0",lineHeight:1.5},children:S.description}),i.jsxs("div",{style:{display:"flex",gap:12,justifyContent:"center"},children:[i.jsx("button",{onClick:T,style:{padding:"10px 20px",borderRadius:8,border:"1px solid #ddd",background:"#f8f9fa",color:"#666",cursor:"pointer",fontSize:14,fontWeight:600,transition:"all 0.2s"},onMouseOver:F=>F.currentTarget.style.background="#e9ecef",onMouseOut:F=>F.currentTarget.style.background="#f8f9fa",children:lo.cancelButton[r]||"取消"}),i.jsx("button",{onClick:I,style:{padding:"10px 24px",borderRadius:8,border:"none",background:"linear-gradient(135deg, #6B5BFF 0%, #4D8FFF 100%)",color:"#fff",cursor:"pointer",fontSize:14,fontWeight:700,transition:"all 0.2s",boxShadow:"0 4px 12px rgba(107, 91, 255, 0.3)"},onMouseOver:F=>F.currentTarget.style.transform="translateY(-1px)",onMouseOut:F=>F.currentTarget.style.transform="translateY(0)",children:lo.startPractice[r]})]})]})}),i.jsx("div",{style:{width:"100%",margin:"0 auto",marginTop:24,background:"rgba(255,255,255,0.95)",borderRadius:16,padding:"16px",boxShadow:"0 2px 12px #6B5BFF22"},children:i.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:20,flexWrap:"wrap"},children:[i.jsx("a",{href:"/privacy-policy",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12},children:"隱私權政策"}),i.jsx("a",{href:"/terms",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12},children:"條款/聲明"}),i.jsx("a",{href:"/data-deletion",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12},children:"資料刪除說明"}),i.jsx("a",{href:"/about",style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12},children:"🧬 Restarter™｜我們是誰"}),i.jsx("a",{href:"/feedback",style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12},children:"💬 意見箱｜我們想聽你說"})]})})]})}const DN={"zh-TW":i.jsxs("div",{children:[i.jsx("h1",{children:"Restarter™ 使用條款與更生者聲明"}),i.jsx("h2",{children:"一、平台理念聲明"}),i.jsx("p",{children:"Restarter™ 是幫助更生人社會、心理、生活自信恢復的 AI 平台。我們透過情感引導、角色扮演、任務挑戰，協助用戶釋放負面情緒、重建目標與自信，更引導使用者逐步建立內在動力與行動信心。"}),i.jsx("p",{children:"我們相信每一位更生人都值得被尊重與重新認識。即使你曾經犯錯，在這裡不再被貼標籤。"}),i.jsx("h2",{children:"二、用戶身份與行為規範"}),i.jsx("p",{children:"本平台歡迎曾經服刑、戒癮、感化、接受司法保護、霸凌或因社會排斥而渴望重新開始的個人註冊使用。"}),i.jsx("p",{children:"為確保社群安全與信任，嚴禁下列行為："}),i.jsxs("ul",{children:[i.jsx("li",{children:"冒用他人身份或誤導他人註冊資料"}),i.jsx("li",{children:"散佈仇恨、歧視、暴力、色情、違法內容"}),i.jsx("li",{children:"上傳侵犯他人肖像權或機敏資料的圖片"})]}),i.jsx("p",{children:"違反上述條款者，平台有權立即中止其帳號與使用權限。"}),i.jsx("h2",{children:"三、AI 使用與責任聲明"}),i.jsx("p",{children:"平台所提供的 AI 對話、建議與角色模擬，僅供陪伴、練習與個人成長參考，不構成法律、醫療或心理專業意見。"}),i.jsxs("ul",{children:[i.jsx("li",{children:"平台不對使用者依據 AI 輸出所做的決策承擔法律責任"}),i.jsx("li",{children:"平台不保證 AI 對話完全正確或與真實情境一致"}),i.jsx("li",{children:"請勿將 AI 對話內容散佈作為公共引用資訊"})]}),i.jsx("p",{children:"我們已設置基本風險過濾與話術限制，但 AI 存在輸出偏差或感受誤解的可能。"}),i.jsx("p",{children:"若遇到不適當內容，請透過回報機制通知我們，我們將持續優化模型。"}),i.jsx("h3",{children:"三之一、AI 對話內容使用規範"}),i.jsxs("ul",{children:[i.jsx("li",{children:"不得詢問或輸入他人私密資訊（如住址、犯罪紀錄）"}),i.jsx("li",{children:"不得操作 AI 模擬暴力、自殘或誘導非法行為"}),i.jsx("li",{children:"不得以 Restarter™ 名義散佈虛假或詐騙訊息"}),i.jsx("li",{children:"所有對話資料僅用於匿名模型優化，不作個人追蹤"}),i.jsx("li",{children:"如有必要，平台保留法律配合義務"}),i.jsx("li",{children:"未滿十八歲使用者，需經家長同意方可使用本平台"}),i.jsx("li",{children:"本平台禁止自動爬蟲或未授權系統串接"}),i.jsx("li",{children:"使用者需自負資料輸入內容之法律風險"})]}),i.jsx("h2",{children:"四、資料處理與隱私權聲明"}),i.jsx("p",{children:"平台僅會蒐集註冊所需最基本資料，如暱稱、電子信箱與使用語言偏好。"}),i.jsx("p",{children:"所有資料經加密儲存，不會轉售第三方或做商業行銷使用。"}),i.jsx("p",{children:"使用者可隨時申請帳號刪除，並請求系統清除其所有紀錄。"}),i.jsx("h2",{children:"五、帳號停用與終止權利"}),i.jsx("p",{children:"平台保留中止任何違反本條款使用者帳號的權利，且無須事前通知。"}),i.jsx("p",{children:"如帳號長期未使用，平台將主動發出提醒並保留停用處理權限。"}),i.jsx("p",{children:"用戶可自行隨時停用帳號並刪除所有資料紀錄。"}),i.jsx("h2",{children:"六、本條款之調整與最終解釋權"}),i.jsx("p",{children:"平台有權依據法律、政策與服務優化隨時修改本條款內容。"}),i.jsx("p",{children:"重大異動將透過站內公告與電子郵件通知用戶。"}),i.jsx("p",{children:"本條款之最終解釋權歸 Restarter™ 平台所有。"})]}),"zh-CN":i.jsxs("div",{children:[i.jsx("h1",{children:"Restarter™ 使用条款与更生者声明"}),i.jsx("h2",{children:"一、平台理念声明"}),i.jsx("p",{children:"Restarter™ 是帮助更生人社会、心理、生活自信恢复的 AI 平台。我们通过情感引导、角色扮演、任务挑战，协助用户释放负面情绪、重建目标与自信，并引导用户逐步建立内在动力与行动信心。"}),i.jsx("p",{children:"我们相信每一位更生人都值得被尊重与重新认识。即使你曾经犯错，在这里不再被贴标签。"}),i.jsx("h2",{children:"二、用户身份与行为规范"}),i.jsx("p",{children:"本平台欢迎曾经服刑、戒瘾、感化、接受司法保护、霸凌或因社会排斥而渴望重新开始的个人注册使用。"}),i.jsx("p",{children:"为确保社群安全与信任，严禁下列行为："}),i.jsxs("ul",{children:[i.jsx("li",{children:"冒用他人身份或误导他人注册资料"}),i.jsx("li",{children:"散布仇恨、歧视、暴力、色情、违法内容"}),i.jsx("li",{children:"上传侵犯他人肖像权或敏感资料的图片"})]}),i.jsx("p",{children:"违反上述条款者，平台有权立即中止其账号与使用权限。"}),i.jsx("h2",{children:"三、AI 使用与责任声明"}),i.jsx("p",{children:"平台所提供的 AI 对话、建议与角色模拟，仅供陪伴、练习与个人成长参考，不构成法律、医疗或心理专业意见。"}),i.jsxs("ul",{children:[i.jsx("li",{children:"平台不对用户依据 AI 输出所做的决策承担法律责任"}),i.jsx("li",{children:"平台不保证 AI 对话完全正确或与真实情境一致"}),i.jsx("li",{children:"请勿将 AI 对话内容散布作为公共引用信息"})]}),i.jsx("p",{children:"我们已设置基本风险过滤与话术限制，但 AI 存在输出偏差或感受误解的可能。"}),i.jsx("p",{children:"若遇到不适当内容，请通过举报机制通知我们，我们将持续优化模型。"}),i.jsx("h3",{children:"三之一、AI 对话内容使用规范"}),i.jsxs("ul",{children:[i.jsx("li",{children:"不得询问或输入他人私密信息（如住址、犯罪记录）"}),i.jsx("li",{children:"不得操作 AI 模拟暴力、自残或诱导非法行为"}),i.jsx("li",{children:"不得以 Restarter™ 名义散布虚假或诈骗信息"}),i.jsx("li",{children:"全对话资料仅用于匿名模型优化，不作个人追踪"}),i.jsx("li",{children:"如有必要，平台保留法律配合义务"}),i.jsx("li",{children:"未满十八岁用户，需经家长同意方可使用本平台"}),i.jsx("li",{children:"本平台禁止自动爬虫或未授权系统串接"}),i.jsx("li",{children:"用户需自负资料输入内容之法律风险"})]}),i.jsx("h2",{children:"四、资料处理与隐私权声明"}),i.jsx("p",{children:"平台仅会收集注册所需最基本资料，如昵称、电子邮箱与使用语言偏好。"}),i.jsx("p",{children:"所有资料经加密存储，不会转售第三方或做商业营销使用。"}),i.jsx("p",{children:"用户可随时申请账号删除，并请求系统清除其所有记录。"}),i.jsx("h2",{children:"五、账号停用与终止权利"}),i.jsx("p",{children:"平台保留中止任何违反本条款用户账号的权利，且无需事前通知。"}),i.jsx("p",{children:"如账号长期未使用，平台将主动发出提醒并保留停用处理权限。"}),i.jsx("p",{children:"用户可自行随时停用账号并删除所有资料记录。"}),i.jsx("h2",{children:"六、本条款之调整与最终解释权"}),i.jsx("p",{children:"平台有权依据法律、政策与服务优化随时修改本条款内容。"}),i.jsx("p",{children:"重大变动将通过站内公告与电子邮件通知用户。"}),i.jsx("p",{children:"本条款之最终解释权归 Restarter™ 平台所有。"})]}),en:i.jsxs("div",{children:[i.jsx("h1",{children:"Restarter™ Terms of Use and Ex-Offender Declaration"}),i.jsx("h2",{children:"1. Platform Philosophy Statement"}),i.jsx("p",{children:"Restarter™ is an AI platform dedicated to helping ex-offenders rebuild social, psychological, and life confidence. Through emotional guidance, role-playing, and task challenges, we help users release negative emotions, rebuild goals and confidence, and guide them to gradually build inner motivation and action confidence."}),i.jsx("p",{children:"We believe that every ex-offender deserves respect and a new recognition. Even if you have made mistakes, you will not be labeled here."}),i.jsx("h2",{children:"2. User Identity and Code of Conduct"}),i.jsx("p",{children:"This platform welcomes individuals who have served sentences, undergone rehabilitation, received judicial protection, experienced bullying, or wish to start over due to social exclusion."}),i.jsx("p",{children:"To ensure community safety and trust, the following behaviors are strictly prohibited:"}),i.jsxs("ul",{children:[i.jsx("li",{children:"Impersonating others or providing misleading registration information"}),i.jsx("li",{children:"Spreading hate, discrimination, violence, pornography, or illegal content"}),i.jsx("li",{children:"Uploading images that infringe on others' portrait rights or sensitive data"})]}),i.jsx("p",{children:"Those who violate the above terms may have their accounts and access immediately terminated by the platform."}),i.jsx("h2",{children:"3. AI Usage and Responsibility Statement"}),i.jsx("p",{children:"The AI dialogues, suggestions, and role simulations provided by the platform are for companionship, practice, and personal growth reference only, and do not constitute legal, medical, or psychological professional advice."}),i.jsxs("ul",{children:[i.jsx("li",{children:"The platform is not legally responsible for decisions made by users based on AI output"}),i.jsx("li",{children:"The platform does not guarantee that AI dialogues are completely accurate or consistent with real situations"}),i.jsx("li",{children:"Do not distribute AI dialogue content as public reference information"})]}),i.jsx("p",{children:"We have set up basic risk filtering and dialogue restrictions, but AI may still produce biased or misunderstood outputs."}),i.jsx("p",{children:"If you encounter inappropriate content, please notify us through the reporting mechanism, and we will continue to optimize the model."}),i.jsx("h3",{children:"3.1 AI Dialogue Content Usage Guidelines"}),i.jsxs("ul",{children:[i.jsx("li",{children:"Do not ask for or input others' private information (such as address or criminal record)"}),i.jsx("li",{children:"Do not use AI to simulate violence, self-harm, or induce illegal behavior"}),i.jsx("li",{children:"Do not distribute false or fraudulent information in the name of Restarter™"}),i.jsx("li",{children:"All dialogue data is used only for anonymous model optimization, not for personal tracking"}),i.jsx("li",{children:"The platform reserves the right to cooperate with legal authorities if necessary"}),i.jsx("li",{children:"Users under 18 must have parental consent to use this platform"}),i.jsx("li",{children:"The platform prohibits automated crawling or unauthorized system integration"}),i.jsx("li",{children:"Users are responsible for the legal risks of the content they input"})]}),i.jsx("h2",{children:"4. Data Processing and Privacy Statement"}),i.jsx("p",{children:"The platform only collects the most basic registration information, such as nickname, email, and language preference."}),i.jsx("p",{children:"All data is stored encrypted and will not be sold to third parties or used for commercial marketing."}),i.jsx("p",{children:"Users can request account deletion at any time and ask the system to clear all their records."}),i.jsx("h2",{children:"5. Account Suspension and Termination Rights"}),i.jsx("p",{children:"The platform reserves the right to terminate any user's account that violates these terms at any time without prior notice."}),i.jsx("p",{children:"If an account is inactive for a long period, the platform will proactively send reminders and reserves the right to suspend the account."}),i.jsx("p",{children:"Users can deactivate their accounts and delete all data records at any time."}),i.jsx("h2",{children:"6. Amendments and Final Interpretation"}),i.jsx("p",{children:"The platform reserves the right to modify these terms at any time in accordance with laws, policies, and service optimization."}),i.jsx("p",{children:"Major changes will be announced on the platform and via email notifications to users."}),i.jsx("p",{children:"The final interpretation of these terms belongs to the Restarter™ platform."})]}),ja:i.jsxs("div",{children:[i.jsx("h1",{children:"Restarter™ 利用規約および更生者宣言"}),i.jsx("h2",{children:"1. プラットフォーム理念声明"}),i.jsx("p",{children:"Restarter™ は更生者の社会的・心理的・生活的自信の回復を支援するAIプラットフォームです。感情ガイダンス、ロールプレイ、タスクチャレンジを通じて、ユーザーがネガティブな感情を解放し、目標と自信を再構築し、内面の動機と行動への自信を段階的に築くことをサポートします。"}),i.jsx("p",{children:"私たちは、すべての更生者が尊重され、新たに認識される価値があると信じています。過去に過ちを犯したとしても、ここではラベルを貼られません。"}),i.jsx("h2",{children:"2. ユーザーの身分と行動規範"}),i.jsx("p",{children:"本プラットフォームは、服役経験者、依存症克服者、感化・司法保護を受けた方、いじめや社会的排除を経験し再出発を望む方の登録を歓迎します。"}),i.jsx("p",{children:"コミュニティの安全と信頼を守るため、以下の行為を厳禁とします："}),i.jsxs("ul",{children:[i.jsx("li",{children:"他人の身分を詐称または誤った登録情報の提供"}),i.jsx("li",{children:"憎悪・差別・暴力・ポルノ・違法コンテンツの拡散"}),i.jsx("li",{children:"他人の肖像権や機密情報を侵害する画像のアップロード"})]}),i.jsx("p",{children:"上記規約に違反した場合、プラットフォームは直ちにアカウントと利用権限を停止する権利を有します。"}),i.jsx("h2",{children:"3. AI利用と責任声明"}),i.jsx("p",{children:"本プラットフォームが提供するAI対話・提案・ロールプレイは、伴走・練習・自己成長の参考用であり、法的・医療的・心理的な専門アドバイスではありません。"}),i.jsxs("ul",{children:[i.jsx("li",{children:"AI出力に基づく意思決定に対し、プラットフォームは法的責任を負いません"}),i.jsx("li",{children:"AI対話が常に正確または現実と一致することを保証しません"}),i.jsx("li",{children:"AI対話内容を公共の引用情報として拡散しないでください"})]}),i.jsx("p",{children:"基本的なリスクフィルタと発話制限を設けていますが、AIには出力の偏りや誤解が生じる可能性があります。"}),i.jsx("p",{children:"不適切な内容に遭遇した場合は、報告機能からご連絡ください。モデルの最適化に努めます。"}),i.jsx("h3",{children:"3.1 AI対話内容の利用規範"}),i.jsxs("ul",{children:[i.jsx("li",{children:"他人の個人情報（住所・犯罪歴等）を尋ねたり入力しない"}),i.jsx("li",{children:"AIで暴力・自傷・違法行為を模擬しない"}),i.jsx("li",{children:"Restarter™名義で虚偽・詐欺情報を拡散しない"}),i.jsx("li",{children:"全対話データは匿名モデル最適化のみに利用し、個人追跡はしません"}),i.jsx("li",{children:"必要に応じて法的協力義務を負います"}),i.jsx("li",{children:"未満18歳の方は保護者の同意が必要です"}),i.jsx("li",{children:"自動クローラーや未承認システム連携は禁止します"}),i.jsx("li",{children:"入力内容の法的リスクは利用者自身が負います"})]}),i.jsx("h2",{children:"4. データ処理とプライバシー声明"}),i.jsx("p",{children:"登録時に必要最低限の情報（ニックネーム・メール・言語設定）のみ収集します。"}),i.jsx("p",{children:"全データは暗号化保存され、第三者への販売や商用利用はしません。"}),i.jsx("p",{children:"アカウント削除申請と全記録の消去依頼がいつでも可能です。"}),i.jsx("h2",{children:"5. アカウント停止と終了権利"}),i.jsx("p",{children:"本規約違反者のアカウントは、事前通知なく停止できる権利を有します。"}),i.jsx("p",{children:"長期間未使用の場合、リマインダー送信や停止処理権限を保持します。"}),i.jsx("p",{children:"利用者はいつでもアカウント停止・全データ削除が可能です。"}),i.jsx("h2",{children:"6. アカウント停止と終了権利"}),i.jsx("p",{children:"本規約違反者のアカウントは、事前通知なく停止できる権利を有します。"}),i.jsx("p",{children:"長期間未使用の場合、リマインダー送信や停止処理権限を保持します。"}),i.jsx("p",{children:"利用者はいつでもアカウント停止・全データ削除が可能です。"}),i.jsx("h2",{children:"6. 本規約の改定と最終解釈権"}),i.jsx("p",{children:"法令・政策・サービス最適化に応じて本規約を随時改定します。"}),i.jsx("p",{children:"重大な変更はサイト告知やメールで通知します。"}),i.jsx("p",{children:"最終解釈権はRestarter™プラットフォームに帰属します。"})]}),ko:i.jsxs("div",{children:[i.jsx("h1",{children:"Restarter™ 이용약관 및 갱생자 선언"}),i.jsx("h2",{children:"1. 플랫폼 이념 선언"}),i.jsx("p",{children:"Restarter™는 갱생인의 사회적, 심리적, 생활적 자신감 회복을 돕는 AI 플랫폼입니다. 감정 안내, 역할극, 과제 도전을 통해 사용자가 부정적 감정을 해소하고 목표와 자신감을 재구축하며, 내면 동기와 행동 자신감을 단계적으로 쌓을 수 있도록 지원합니다."}),i.jsx("p",{children:"우리는 모든 갱생인이 존중받고 새롭게 인식받을 가치가 있다고 믿습니다. 과거에 실수했더라도 여기서는 낙인찍지 않습니다."}),i.jsx("h2",{children:"2. 사용자 신분 및 행동 규범"}),i.jsx("p",{children:"본 플랫폼은 형을 마친 자, 중독을 극복한 자, 감화를 받은 자, 사법 보호를 받은 자, 따돌림이나 사회적 배제를 경험하고 재출발을 원하는 자의 가입을 환영합니다."}),i.jsx("p",{children:"커뮤니티의 안전과 신뢰를 위해 다음 행위를 엄격히 금지합니다:"}),i.jsxs("ul",{children:[i.jsx("li",{children:"타인 신분 도용 또는 허위 등록 정보 제공"}),i.jsx("li",{children:"증오, 차별, 폭력, 음란, 불법 콘텐츠 유포"}),i.jsx("li",{children:"타인의 초상권 또는 민감 정보 침해 이미지 업로드"})]}),i.jsx("p",{children:"위 조항 위반 시 플랫폼은 즉시 계정 및 이용 권한을 중지할 수 있습니다."}),i.jsx("h2",{children:"3. AI 이용 및 책임 선언"}),i.jsx("p",{children:"플랫폼이 제공하는 AI 대화, 제안, 역할 시뮬레이션은 동반, 연습, 자기 성장 참고용이며, 법률·의료·심리 전문가의 조언이 아닙니다."}),i.jsxs("ul",{children:[i.jsx("li",{children:"플랫폼은 AI에 따른 결정에 대해 법적 책임을 지지 않습니다"}),i.jsx("li",{children:"플랫폼은 AI 대화가 항상 정확하거나 실제와 일치함을 보장하지 않습니다"}),i.jsx("li",{children:"AI 대화 내용을 공공 인용 정보로 유포하지 마십시오"})]}),i.jsx("p",{children:"기본 위험 필터와 발화 제한을 두었으나, AI는 편향되거나 오해를 불러일으킬 수 있습니다."}),i.jsx("p",{children:"부적절한 내용 발견 시 신고 기능을 통해 알려주시면 지속적으로 모델을 개선하겠습니다."}),i.jsx("h3",{children:"3.1 AI 대화 내용 이용 규범"}),i.jsxs("ul",{children:[i.jsx("li",{children:"타인 개인정보(주소, 범죄기록 등) 문의·입력 금지"}),i.jsx("li",{children:"AI로 폭력·자해·불법행위 모의 금지"}),i.jsx("li",{children:"Restarter™ 명의로 허위·사기 정보 유포 금지"}),i.jsx("li",{children:"모든 대화 데이터는 익명 모델 최적화에만 사용, 개인 추적 불가"}),i.jsx("li",{children:"필요시 법적 협조 의무 보유"}),i.jsx("li",{children:"18세 미만은 부모 동의 필요"}),i.jsx("li",{children:"자동 크롤러·미승인 시스템 연동 금지"}),i.jsx("li",{children:"입력 내용의 법적 책임은 사용자 본인에게 있음"})]}),i.jsx("h2",{children:"4. 데이터 처리 및 개인정보 보호"}),i.jsx("p",{children:"가입 시 닉네임, 이메일, 언어 설정 등 최소 정보만 수집합니다."}),i.jsx("p",{children:"모든 데이터는 암호화 저장되며, 제3자 판매·상업적 이용은 없습니다."}),i.jsx("p",{children:"언제든 계정 삭제 및 기록 삭제 요청 가능"}),i.jsx("h2",{children:"5. 계정 정지 및 종료 권리"}),i.jsx("p",{children:"플랫폼은 본 약관 위반 계정을 사전 통보 없이 정지할 수 있습니다."}),i.jsx("p",{children:"장기간 미사용 시 알림 발송 및 정지 처리 권한 보유"}),i.jsx("p",{children:"사용자는 언제든 계정 정지 및 데이터 삭제 가능"}),i.jsx("h2",{children:"6. 약관 개정 및 최종 해석권"}),i.jsx("p",{children:"법령·정책·서비스 최적화에 따라 약관을 수시로 개정할 수 있습니다."}),i.jsx("p",{children:"중대한 변경은 사이트 공지 및 이메일로 안내"}),i.jsx("p",{children:"최종 해석권은 Restarter™ 플랫폼에 있음"})]}),th:i.jsxs("div",{children:[i.jsx("h1",{children:"Restarter™ ข้อกำหนดการใช้งานและประกาศสำหรับผู้กลับตัว"}),i.jsx("h2",{children:"1. ปรัชญาแพลตฟอร์ม"}),i.jsx("p",{children:"Restarter™ เป็นแพลตฟอร์ม AI ที่ช่วยฟื้นฟูความมั่นใจทางสังคม จิตใจ และชีวิตของผู้กลับตัว ผ่านการชี้นำทางอารมณ์ บทบาทสมมติ และภารกิจท้าทาย เพื่อช่วยให้ผู้ใช้ปลดปล่อยอารมณ์ลบ สร้างเป้าหมายและความมั่นใจ และสร้างแรงบันดาลใจภายในและความมั่นใจในการลงมือทำ"}),i.jsx("p",{children:"เราเชื่อว่าทุกคนที่กลับตัวสมควรได้รับความเคารพและการยอมรับใหม่ แม้คุณจะเคยทำผิด ที่นี่จะไม่มีใครติดป้ายคุณอีก"}),i.jsx("h2",{children:"2. ตัวตนและข้อปฏิบัติของผู้ใช้"}),i.jsx("p",{children:"แพลตฟอร์มนี้ยินดีต้อนรับผู้ที่เคยต้องโทษ เลิกยา ฟื้นฟู ได้รับการคุ้มครองทางกฎหมาย ถูกกลั่นแกล้ง หรือถูกกีดกันทางสังคมและต้องการเริ่มต้นใหม่"}),i.jsx("p",{children:"เพื่อความปลอดภัยและความไว้วางใจในชุมชน ห้ามกระทำดังต่อไปนี้อย่างเด็ดขาด:"}),i.jsxs("ul",{children:[i.jsx("li",{children:"แอบอ้างตัวตนหรือให้ข้อมูลสมัครสมาชิกที่ทำให้เข้าใจผิด"}),i.jsx("li",{children:"เผยแพร่ความเกลียดชัง การเลือกปฏิบัติ ความรุนแรง สื่อลามก หรือเนื้อหาผิดกฎหมาย"}),i.jsx("li",{children:"อัปโหลดภาพที่ละเมิดสิทธิ์ในภาพบุคคลหรือข้อมูลสำคัญของผู้อื่น"})]}),i.jsx("p",{children:"หากฝ่าฝืนข้อกำหนดข้างต้น แพลตฟอร์มมีสิทธิ์ระงับบัญชีและสิทธิ์การใช้งานทันที"}),i.jsx("h2",{children:"3. การใช้ AI และคำประกาศความรับผิดชอบ"}),i.jsx("p",{children:"AI ที่แพลตฟอร์มให้บริการใช้สำหรับการพูดคุย แนะนำ และจำลองสถานการณ์เพื่อการฝึกฝนและพัฒนาตนเองเท่านั้น ไม่ถือเป็นคำแนะนำทางกฎหมาย การแพทย์ หรือจิตวิทยา"}),i.jsxs("ul",{children:[i.jsx("li",{children:"แพลตฟอร์มไม่รับผิดชอบทางกฎหมายต่อการตัดสินใจที่เกิดจาก AI"}),i.jsx("li",{children:"แพลตฟอร์มไม่รับประกันว่า AI จะถูกต้องสมบูรณ์หรือสอดคล้องกับสถานการณ์จริงเสมอไป"}),i.jsx("li",{children:"ห้ามนำเนื้อหาการสนทนา AI ไปเผยแพร่เป็นข้อมูลอ้างอิงสาธารณะ"})]}),i.jsx("p",{children:"แม้จะมีการกรองความเสี่ยงและจำกัดเนื้อหาแล้ว AI อาจยังมีความคลาดเคลื่อนหรือเข้าใจผิดได้"}),i.jsx("p",{children:"หากพบเนื้อหาไม่เหมาะสม กรุณาแจ้งผ่านระบบรายงาน เราจะปรับปรุงโมเดลอย่างต่อเนื่อง"}),i.jsx("h3",{children:"3.1 ข้อกำหนดการใช้เนื้อหาการสนทนา AI"}),i.jsxs("ul",{children:[i.jsx("li",{children:"ห้ามสอบถามหรือกรอกข้อมูลส่วนตัวของผู้อื่น (เช่น ที่อยู่ ประวัติอาชญากรรม)"}),i.jsx("li",{children:"ห้ามใช้ AI จำลองความรุนแรง ทำร้ายตนเอง หรือชักจูงให้กระทำผิดกฎหมาย"}),i.jsx("li",{children:"ห้ามใช้ชื่อ Restarter™ เผยแพร่ข้อมูลเท็จหรือหลอกลวง"}),i.jsx("li",{children:"ข้อมูลการสนทนาทั้งหมดใช้เพื่อปรับปรุงโมเดลแบบไม่ระบุตัวตนเท่านั้น ไม่ติดตามตัวบุคคล"}),i.jsx("li",{children:"หากจำเป็น แพลตฟอร์มขอสงวนสิทธิ์ให้ความร่วมมือทางกฎหมาย"}),i.jsx("li",{children:"ผู้ใช้ที่อายุต่ำกว่า 18 ปี ต้องได้รับความยินยอมจากผู้ปกครอง"}),i.jsx("li",{children:"ห้ามใช้บอทหรือเชื่อมต่อระบบโดยไม่ได้รับอนุญาต"}),i.jsx("li",{children:"ผู้ใช้ต้องรับผิดชอบความเสี่ยงทางกฎหมายของข้อมูลที่กรอกเอง"})]}),i.jsx("h2",{children:"4. การจัดการข้อมูลและนโยบายความเป็นส่วนตัว"}),i.jsx("p",{children:"แพลตฟอร์มจะเก็บเฉพาะข้อมูลที่จำเป็นสำหรับการสมัคร เช่น ชื่อเล่น อีเมล และภาษาที่ใช้"}),i.jsx("p",{children:"ข้อมูลทั้งหมดจะถูกเข้ารหัสและไม่ขายให้บุคคลที่สามหรือใช้เพื่อการตลาด"}),i.jsx("p",{children:"ผู้ใช้สามารถขอลบบัญชีและข้อมูลทั้งหมดได้ตลอดเวลา"}),i.jsx("h2",{children:"5. สิทธิ์ในการระงับและยกเลิกบัญชี"}),i.jsx("p",{children:"แพลตฟอร์มขอสงวนสิทธิ์ในการระงับบัญชีผู้ใช้ที่ละเมิดข้อกำหนดโดยไม่ต้องแจ้งล่วงหน้า"}),i.jsx("p",{children:"หากบัญชีไม่ได้ใช้งานเป็นเวลานาน แพลตฟอร์มจะส่งการแจ้งเตือนและขอสงวนสิทธิ์ในการระงับบัญชี"}),i.jsx("p",{children:"ผู้ใช้สามารถระงับบัญชีและลบข้อมูลได้ตลอดเวลา"}),i.jsx("h2",{children:"6. การปรับปรุงและการตีความข้อกำหนด"}),i.jsx("p",{children:"แพลตฟอร์มมีสิทธิ์ปรับปรุงข้อกำหนดนี้ได้ตลอดเวลาเพื่อให้สอดคล้องกับกฎหมาย นโยบาย และการให้บริการ"}),i.jsx("p",{children:"การเปลี่ยนแปลงสำคัญจะแจ้งให้ผู้ใช้ทราบผ่านประกาศในระบบและอีเมล"}),i.jsx("p",{children:"สิทธิ์ในการตีความข้อกำหนดนี้เป็นของแพลตฟอร์ม Restarter™"})]}),vi:i.jsxs("div",{children:[i.jsx("h1",{children:"Restarter™ Điều khoản sử dụng và Tuyên bố hoàn lương"}),i.jsx("h2",{children:"1. Tuyên bố triết lý nền tảng"}),i.jsx("p",{children:"Restarter™ là nền tảng AI giúp người hoàn lương xây dựng lại sự tự tin xã hội, tâm lý và cuộc sống. Thông qua hướng dẫn cảm xúc, nhập vai và thử thách nhiệm vụ, chúng tôi giúp người dùng giải tỏa cảm xúc tiêu cực, xây dựng lại mục tiêu và sự tự tin, đồng thời hướng dẫn người dùng từng bước xây dựng động lực nội tại và sự tự tin hành động."}),i.jsx("p",{children:"Chúng tôi tin rằng mọi người hoàn lương đều xứng đáng được tôn trọng và công nhận lại. Dù bạn từng mắc sai lầm, ở đây bạn sẽ không bị dán nhãn."}),i.jsx("h2",{children:"2. Danh tính và quy tắc hành vi của người dùng"}),i.jsx("p",{children:"Nền tảng này chào đón những người từng bị kết án, men thuốc, correctionem acceperunt, tutela iudiciali fruuntur, vexationem passi sunt, aut ob exclusionem socialem iterum incipere cupiunt."}),i.jsx("p",{children:"Bagi memastikan keselamatan dan kepercayaan komuniti, haec acta stricte vetantur:"}),i.jsxs("ul",{children:[i.jsx("li",{children:"Personae alienae simulationem aut falsam informationem praebere"}),i.jsx("li",{children:"Odium, discriminationem, violentiam, pornographiam, contenta illicita disseminare"}),i.jsx("li",{children:"Imagines iura aliorum vel data sensitiva violantes onerare"})]}),i.jsx("p",{children:"Qui haec violaverint, suggestum statim rationem et usum intercludere potest."}),i.jsx("h2",{children:"3. Usus AI et Declaratio Responsabilitatis"}),i.jsx("p",{children:"Colloquia, consilia, simulationesque AI a suggesto praebita tantum ad comitatum, exercitationem, progressionemque personalem spectant, non ad consilium legale, medicum, psychologicumque."}),i.jsxs("ul",{children:[i.jsx("li",{children:"Suggestum non tenetur de decisionibus ex AI ortis"}),i.jsx("li",{children:"Non praestat colloquia AI semper recta aut实实在在congruentia esse"}),i.jsx("li",{children:"Ne dissemines colloquia AI ut informationem publicam"})]}),i.jsx("p",{children:"Filtra periculorum et restrictiones sermonum posuimus, sed AI adhuc praeiudicium aut errorem gignere potest."}),i.jsx("p",{children:"Si quid incommodum inveneris, per mechanismum referendi nos certiorem facias; modelum continue emendabimus."}),i.jsx("h3",{children:"3.1 Praecepta Usus Colloquiorum AI"}),i.jsxs("ul",{children:[i.jsx("li",{children:"Ne quaeras aut inseras informationes privatas aliorum (ut domicilium, delicta)"}),i.jsx("li",{children:"Ne AI adhibeas ad violentiam, sui laesionem, aut actus illicitos simulandos"}),i.jsx("li",{children:"Ne dissemines falsa aut fraudulenta sub nomine Restarter™"}),i.jsx("li",{children:"Omnia colloquia ad optimizationem anonymam tantum, non ad tracking personalem"}),i.jsx("li",{children:"Suggestum, si opus sit, cum auctoritatibus legalibus cooperabitur"}),i.jsx("li",{children:"Usoribus minoribus XVIII annis consensus parentum requiritur"}),i.jsx("li",{children:"Automata aut systemata non auctorata vetantur"}),i.jsx("li",{children:"Usor ipse de periculis legalibus contentorum suorum respondet"})]}),i.jsx("h2",{children:"4. Processus Datae et Declaratio Privacy"}),i.jsx("p",{children:"Suggestum tantum colligit notitias adnotationis fundamentales, ut cognomen, email, linguam praeoptatam."}),i.jsx("p",{children:"Omnia data cryptate servantur nec tertiis partibus venduntur nec ad mercaturam adhibentur."}),i.jsx("p",{children:"Usor rationem suam et omnia data delere potest quovis tempore"}),i.jsx("h2",{children:"5. Ius Suspensionis et Terminationis Rationis"}),i.jsx("p",{children:"Suggestum ius habet rationem usoris qui haec violat statim sine praevia notitia suspendere"}),i.jsx("p",{children:"Si ratio diu non utatur, suggestum admonitionem mittet et ius suspensionis retinebit"}),i.jsx("p",{children:"Usor rationem suam et omnia data delere potest quovis tempore"}),i.jsx("h2",{children:"6. Emendationes et Interpretatio Finalis"}),i.jsx("p",{children:"Suggestum ius habet haec emendandi pro legibus, consiliis, et optimizatione servitii"}),i.jsx("p",{children:"Mutationes maximi momenti per systema et email nuntiabuntur"}),i.jsx("p",{children:"Ius interpretationis finalis harum condicionum Restarter™ suggestui reservatur"})]}),ms:i.jsxs("div",{children:[i.jsx("h1",{children:"Restarter™ Terma Penggunaan dan Pengisytiharan Bekas Banduan"}),i.jsx("h2",{children:"1. Kenyataan Falsafah Platform"}),i.jsx("p",{children:"Restarter™ ialah platform AI yang membantu bekas banduan membina semula keyakinan sosial, psikologi dan kehidupan. Melalui bimbingan emosi, lakonan peranan dan cabaran tugasan, kami membantu pengguna melepaskan emosi negatif, membina semula matlamat dan keyakinan, serta membimbing mereka membina motivasi dalaman dan keyakinan bertindak secara berperingkat."}),i.jsx("p",{children:"Kami percaya setiap bekas banduan layak dihormati dan diiktiraf semula. Etiamsi peccaveris, hic non amplius notaberis."}),i.jsx("h2",{children:"2. Identiti dan Tatakelakuan Pengguna"}),i.jsx("p",{children:"Platform ini mengalu-alukan individu yang pernah dipenjarakan, abusus vicerunt, correctionem acceperunt, tutela iudiciali fruuntur, vexationem passi sunt, aut ob exclusionem socialem iterum incipere cupiunt."}),i.jsx("p",{children:"Bagi memastikan keselamatan dan kepercayaan komuniti, haec acta stricte vetantur:"}),i.jsxs("ul",{children:[i.jsx("li",{children:"Personae alienae simulationem aut falsam informationem praebere"}),i.jsx("li",{children:"Odium, discriminationem, violentiam, pornographiam, contenta illicita disseminare"}),i.jsx("li",{children:"Imagines iura aliorum vel data sensitiva violantes onerare"})]}),i.jsx("p",{children:"Qui haec violaverint, suggestum statim rationem et usum intercludere potest."}),i.jsx("h2",{children:"3. Usus AI et Declaratio Responsabilitatis"}),i.jsx("p",{children:"Colloquia, consilia, simulationesque AI a suggesto praebita tantum ad comitatum, exercitationem, progressionemque personalem spectant, non ad consilium legale, medicum, psychologicumque."}),i.jsxs("ul",{children:[i.jsx("li",{children:"Suggestum non tenetur de decisionibus ex AI ortis"}),i.jsx("li",{children:"Non praestat colloquia AI semper recta aut实实在在congruentia esse"}),i.jsx("li",{children:"Ne dissemines colloquia AI ut informationem publicam"})]}),i.jsx("p",{children:"Filtra periculorum et restrictiones sermonum posuimus, sed AI adhuc praeiudicium aut errorem gignere potest."}),i.jsx("p",{children:"Si quid incommodum inveneris, per mechanismum referendi nos certiorem facias; modelum continue emendabimus."}),i.jsx("h3",{children:"3.1 Praecepta Usus Colloquiorum AI"}),i.jsxs("ul",{children:[i.jsx("li",{children:"Ne quaeras aut inseras informationes privatas aliorum (ut domicilium, delicta)"}),i.jsx("li",{children:"Ne AI adhibeas ad violentiam, sui laesionem, aut actus illicitos simulandos"}),i.jsx("li",{children:"Ne dissemines falsa aut fraudulenta sub nomine Restarter™"}),i.jsx("li",{children:"Omnia colloquia ad optimizationem anonymam tantum, non ad tracking personalem"}),i.jsx("li",{children:"Suggestum, si opus sit, cum auctoritatibus legalibus cooperabitur"}),i.jsx("li",{children:"Usoribus minoribus XVIII annis consensus parentum requiritur"}),i.jsx("li",{children:"Automata aut systemata non auctorata vetantur"}),i.jsx("li",{children:"Usor ipse de periculis legalibus contentorum suorum respondet"})]}),i.jsx("h2",{children:"4. Processus Datae et Declaratio Privacy"}),i.jsx("p",{children:"Suggestum tantum colligit notitias adnotationis fundamentales, ut cognomen, email, linguam praeoptatam."}),i.jsx("p",{children:"Omnia data cryptate servantur nec tertiis partibus venduntur nec ad mercaturam adhibentur."}),i.jsx("p",{children:"Usor rationem suam et omnia data delere potest quovis tempore"}),i.jsx("h2",{children:"5. Ius Suspensionis et Terminationis Rationis"}),i.jsx("p",{children:"Suggestum ius habet rationem usoris qui haec violat statim sine praevia notitia suspendere"}),i.jsx("p",{children:"Si ratio diu non utatur, suggestum admonitionem mittet et ius suspensionis retinebit"}),i.jsx("p",{children:"Usor rationem suam et omnia data delere potest quovis tempore"}),i.jsx("h2",{children:"6. Emendationes et Interpretatio Finalis"}),i.jsx("p",{children:"Suggestum ius habet haec emendandi pro legibus, consiliis, et optimizatione servitii"}),i.jsx("p",{children:"Mutationes maximi momenti per systema et email nuntiabuntur"}),i.jsx("p",{children:"Ius interpretationis finalis harum condicionum Restarter™ suggestui reservatur"})]}),la:i.jsxs("div",{children:[i.jsx("h1",{children:"Restarter™ Condiciones Usus et Declaratio Redemptorum"}),i.jsx("h2",{children:"1. Propositum et Philosophia"}),i.jsx("p",{children:"Restarter™ est suggestum AI adiuuans redemptos fiduciam socialem, animi, vitae restituere. Per ductum animi, partes simulandas, provocationesque, utentes adiuvat ad vitia superanda, metas restituendas, fiduciamque recuperandam, simulque gradatim motivum internum et fiduciam agendi aedificare."}),i.jsx("p",{children:"Censemus omnes redemptos dignos esse honore et recognitione nova. Etiamsi peccaveris, hic non amplius notaberis."}),i.jsx("h2",{children:"2. Identitas et Regulae Usoris"}),i.jsx("p",{children:"Haec suggestum recipit eos qui poenam egerunt, abusus vicerunt, correctionem acceperunt, tutela iudiciali fruuntur, vexationem passi sunt, aut ob exclusionem socialem iterum incipere cupiunt."}),i.jsx("p",{children:"Ad salutem et fidem communitatis tuendam, haec acta stricte vetantur:"}),i.jsxs("ul",{children:[i.jsx("li",{children:"Personae alienae simulationem aut falsam informationem praebere"}),i.jsx("li",{children:"Odium, discriminationem, violentiam, pornographiam, contenta illicita disseminare"}),i.jsx("li",{children:"Imagines iura aliorum vel data sensitiva violantes onerare"})]}),i.jsx("p",{children:"Qui haec violaverint, suggestum statim rationem et usum intercludere potest."}),i.jsx("h2",{children:"3. Usus AI et Declaratio Responsabilitatis"}),i.jsx("p",{children:"Colloquia, consilia, simulationesque AI a suggesto praebita tantum ad comitatum, exercitationem, progressionemque personalem spectant, non ad consilium legale, medicum, psychologicumque."}),i.jsxs("ul",{children:[i.jsx("li",{children:"Suggestum non tenetur de decisionibus ex AI ortis"}),i.jsx("li",{children:"Non praestat colloquia AI semper recta aut实实在在congruentia esse"}),i.jsx("li",{children:"Ne dissemines colloquia AI ut informationem publicam"})]}),i.jsx("p",{children:"Filtra periculorum et restrictiones sermonum posuimus, sed AI adhuc praeiudicium aut errorem gignere potest."}),i.jsx("p",{children:"Si quid incommodum inveneris, per mechanismum referendi nos certiorem facias; modelum continue emendabimus."}),i.jsx("h3",{children:"3.1 Praecepta Usus Colloquiorum AI"}),i.jsxs("ul",{children:[i.jsx("li",{children:"Ne quaeras aut inseras informationes privatas aliorum (ut domicilium, delicta)"}),i.jsx("li",{children:"Ne AI adhibeas ad violentiam, sui laesionem, aut actus illicitos simulandos"}),i.jsx("li",{children:"Ne dissemines falsa aut fraudulenta sub nomine Restarter™"}),i.jsx("li",{children:"Omnia colloquia ad optimizationem anonymam tantum, non ad tracking personalem"}),i.jsx("li",{children:"Suggestum, si opus sit, cum auctoritatibus legalibus cooperabitur"}),i.jsx("li",{children:"Usoribus minoribus XVIII annis consensus parentum requiritur"}),i.jsx("li",{children:"Automata aut systemata non auctorata vetantur"}),i.jsx("li",{children:"Usor ipse de periculis legalibus contentorum suorum respondet"})]}),i.jsx("h2",{children:"4. Processus Datae et Declaratio Privacy"}),i.jsx("p",{children:"Suggestum tantum colligit notitias adnotationis fundamentales, ut cognomen, email, linguam praeoptatam."}),i.jsx("p",{children:"Omnia data cryptate servantur nec tertiis partibus venduntur nec ad mercaturam adhibentur."}),i.jsx("p",{children:"Usor rationem suam et omnia data delere potest quovis tempore"}),i.jsx("h2",{children:"5. Ius Suspensionis et Terminationis Rationis"}),i.jsx("p",{children:"Suggestum ius habet rationem usoris qui haec violat statim sine praevia notitia suspendere"}),i.jsx("p",{children:"Si ratio diu non utatur, suggestum admonitionem mittet et ius suspensionis retinebit"}),i.jsx("p",{children:"Usor rationem suam et omnia data delere potest quovis tempore"}),i.jsx("h2",{children:"6. Emendationes et Interpretatio Finalis"}),i.jsx("p",{children:"Suggestum ius habet haec emendandi pro legibus, consiliis, et optimizatione servitii"}),i.jsx("p",{children:"Mutationes maximi momenti per systema et email nuntiabuntur"}),i.jsx("p",{children:"Ius interpretationis finalis harum condicionum Restarter™ suggestui reservatur"})]})},NN={"zh-TW":"返回","zh-CN":"返回",en:"Back",ja:"戻る",ko:"뒤로",th:"กลับ",vi:"Quay lại",ms:"Kembali",la:"Revertere"};function MN(){const[n,e]=v.useState(localStorage.getItem("lang")||"zh-TW"),t=_t();return v.useEffect(()=>{const r=()=>e(localStorage.getItem("lang")||"zh-TW");return window.addEventListener("storage",r),()=>window.removeEventListener("storage",r)},[]),v.useEffect(()=>{const r=setInterval(()=>{const o=localStorage.getItem("lang")||"zh-TW";o!==n&&e(o)},300);return()=>clearInterval(r)},[n]),i.jsxs("div",{style:{minHeight:"100vh",background:"#111827",color:"white",padding:"2rem",display:"flex",flexDirection:"column"},children:[i.jsxs("button",{onClick:()=>t("/register",{replace:!0}),style:{position:"absolute",top:32,left:36,zIndex:10,backgroundColor:"#374151",color:"white",fontWeight:"bold",padding:"0.5rem 1rem",borderRadius:"0.375rem",border:"none",cursor:"pointer",fontSize:16},children:["← ",NN[n]||"返回"]}),i.jsx("div",{style:{flex:"1 0 auto"},children:i.jsxs("div",{style:{maxWidth:800,margin:"0 auto",background:"#fff",color:"#111",borderRadius:16,padding:32,position:"relative"},children:[DN[n],i.jsx("div",{style:{textAlign:"center",marginTop:48,color:"#888",fontSize:16},children:"CTX Goodlife Copyright 2025"})]})}),i.jsx("div",{style:{width:"100%",margin:"0 auto",marginTop:24,background:"rgba(255,255,255,0.95)",borderRadius:16,padding:"16px",boxShadow:"0 2px 12px #6B5BFF22"},children:i.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:20,flexWrap:"wrap"},children:[i.jsx("a",{href:"/privacy-policy",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12},children:"隱私權政策"}),i.jsx("a",{href:"/terms",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12},children:"條款/聲明"}),i.jsx("a",{href:"/data-deletion",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12},children:"資料刪除說明"}),i.jsx("a",{href:"/about",style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12},children:"🧬 Restarter™｜我們是誰"}),i.jsx("a",{href:"/feedback",style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12},children:"💬 意見箱｜我們想聽你說"})]})})]})}const SI=v.createContext(void 0),LN=({children:n})=>{const[e,t]=v.useState(!1);return i.jsx(SI.Provider,{value:{isMicOn:e,setMicOn:t},children:n})},kI=()=>{const n=v.useContext(SI);if(n===void 0)throw new Error("useMicStatus must be used within a MicStatusProvider");return n};function ON({onSpeechStart:n,onSpeechEnd:e,silenceThreshold:t=1e3,fftSize:r=256,minDecibels:o=-70}){const{setMicOn:a}=kI(),[c,d]=v.useState(!1),[h,m]=v.useState(!1),g=v.useRef(null),x=v.useRef(null),S=v.useRef(null),C=v.useRef(null),_=v.useRef([]),I=v.useCallback(()=>{g.current&&g.current.state==="recording"&&g.current.stop(),x.current&&x.current.state!=="closed"&&x.current.close(),C.current&&clearTimeout(C.current),S.current=null,m(!1),d(!1),a(!1)},[a]),T=v.useCallback(()=>{if(!S.current)return;const P=new Uint8Array(S.current.frequencyBinCount);S.current.getByteFrequencyData(P);const te=P.reduce((W,L)=>W+L,0)/P.length>5;te&&!c?(d(!0),C.current&&clearTimeout(C.current)):!te&&c&&(C.current||(C.current=setTimeout(()=>{d(!1),I()},t))),h&&requestAnimationFrame(T)},[c,h,t,I]),F=v.useCallback(async()=>{if(!h)try{const P=await navigator.mediaDevices.getUserMedia({audio:!0});x.current=new AudioContext,S.current=x.current.createAnalyser(),S.current.fftSize=r,S.current.minDecibels=o,x.current.createMediaStreamSource(P).connect(S.current),g.current=new MediaRecorder(P),_.current=[],g.current.ondataavailable=q=>{_.current.push(q.data)},g.current.onstart=()=>{a(!0),n==null||n(),requestAnimationFrame(T)},g.current.onstop=()=>{a(!1);const q=new Blob(_.current,{type:"audio/webm"});q.size>0&&(e==null||e(q)),P.getTracks().forEach(te=>te.stop())},g.current.start(),m(!0)}catch(P){console.error("Error starting VAD:",P),a(!1)}},[h,n,e,T,r,o,a]);return{isSpeaking:c,isListening:h,startListening:F,stopListening:I}}const QS={"zh-TW":{start:"開始說話",stop:"停止",noPermission:"需要訂閱才能使用語音功能"},"zh-CN":{start:"开始说话",stop:"停止",noPermission:"需要订阅才能使用语音功能"},en:{start:"Start talking",stop:"Stop",noPermission:"Subscription required for voice features"},ja:{start:"話し始める",stop:"停止",noPermission:"音声機能にはサブスクリプションが必要です"},ko:{start:"말하기 시작",stop:"정지",noPermission:"음성 기능을 사용하려면 구독이 필요합니다"},th:{start:"เริ่มพูด",stop:"หยุด",noPermission:"ต้องสมัครสมาชิกเพื่อใช้ฟีเจอร์เสียง"},vi:{start:"Bắt đầu nói",stop:"Dừng lại",noPermission:"Cần đăng ký để sử dụng tính năng giọng nói"},ms:{start:"Mula bercakap",stop:"Berhenti",noPermission:"Langganan diperlukan untuk ciri suara"},la:{start:"Incipe loqui",stop:"Desine",noPermission:"Subscriptio requiritur pro vocis functionibus"}};function WN({onAudio:n,lang:e}){const{isListening:t,startListening:r,stopListening:o}=ON({onSpeechEnd:F=>{n(F)}}),{lang:a}=Mt?Mt():{lang:void 0},c=e||a||localStorage.getItem("lang")||"zh-TW",d=QS[c]||QS["zh-TW"],{checkPermission:h,recordUsage:m}=Ls(),[g,x]=v.useState(!1),[S,C]=v.useState(null),{isTestMode:_}=$i(),I=async()=>{if(t){o();return}const F=await h("aiChat");if(!F.allowed){if(_)return;F.canRenew,C(F),x(!0);return}r(),await m("aiChat",1)},T=()=>{x(!1),C(null)};return i.jsxs(i.Fragment,{children:[i.jsxs("div",{children:[i.jsx("button",{onClick:I,style:{width:56,height:56,borderRadius:"50%",background:"#ff9800",border:"none",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:t?"0 0 0 4px #ffe0b2":"0 2px 8px #0002",cursor:"pointer",outline:"none",position:"relative",zIndex:20},"aria-label":t?d.stop:d.start,children:i.jsx("span",{style:{fontSize:36,color:"#fff",filter:t?"drop-shadow(0 0 6px #ff9800)":""},children:"🎤"})}),i.jsx("div",{style:{textAlign:"center",fontSize:14,color:"#ff9800",marginTop:4,fontWeight:700},children:t?d.stop:d.start})]}),g&&S&&i.jsx(Ms,{isOpen:g,onClose:T,currentPlan:S.currentPlan,remainingDays:S.remainingDays,usedTokens:S.usedTokens,totalTokens:S.totalTokens})]})}const iy={backToScenarios:{"zh-TW":"← 返回情境列表","zh-CN":"← 返回情境列表",ja:"← シナリオ一覧へ戻る",en:"← Back to Scenarios",ko:"← 시나리오 목록으로",th:"← กลับไปที่รายการสถานการณ์",vi:"← Quay lại danh sách kịch bản",ms:"← Kembali ke Senarai Senario",la:"← Ad indicem scaenariorum redire"},yourTurn:{"zh-TW":"換你說了","zh-CN":"换你说了",ja:"あなたの番です",en:"Your turn",ko:"당신 차례입니다",th:"ตาคุณแล้ว",vi:"Đến lượt bạn",ms:"Giliran anda",la:"Tua vice est"},send:{"zh-TW":"傳送","zh-CN":"发送",ja:"送信",en:"Send",ko:"보내기",th:"ส่ง",vi:"Gửi",ms:"Hantar",la:"Mitte"}},YS={category:{"zh-TW":"分類","zh-CN":"分类",en:"Category",ja:"カテゴリ",ko:"분류",th:"หมวดหมู่",vi:"Phân loại",ms:"Kategori",la:"Categoria"},difficulty:{"zh-TW":"難度","zh-CN":"难度",en:"Difficulty",ja:"難易度",ko:"난이도",th:"ความยาก",vi:"Độ khó",ms:"Kesukaran",la:"Difficultas"}},VN={hard:{"zh-TW":"困難","zh-CN":"困难",en:"Hard",ja:"難しい",ko:"어려움",th:"ยาก",vi:"Khó",ms:"Sukar",la:"Difficile"},medium:{"zh-TW":"中等","zh-CN":"中等",en:"Medium",ja:"普通",ko:"보통",th:"ปานกลาง",vi:"Trung bình",ms:"Sederhana",la:"Mediocris"},easy:{"zh-TW":"簡單","zh-CN":"简单",en:"Easy",ja:"簡単",ko:"쉬움",th:"ง่าย",vi:"Dễ",ms:"Mudah",la:"Facilis"}};function UN(n,e,t){const r=n.find(o=>o.id===e);return r?r.translations&&r.translations[t]?{...r,...r.translations[t]}:r:null}function XS(){var j,V;const n=_t(),{scenarioId:e}=vR(),t=e||"",r=St(),o=localStorage.getItem("lang")||"zh-TW",[a,c]=v.useState(null),[d,h]=v.useState([]),[m,g]=v.useState(""),[x,S]=v.useState(!0),C=v.useRef(null),[_,I]=v.useState(""),T=X=>{I(X),setTimeout(()=>I(""),1800)},{checkPermission:F}=Ls(),[P,B]=v.useState(!1),[q,te]=v.useState(null),{isTestMode:W}=$i();function L(X){return!(!X||X.trim().length<12)}v.useEffect(()=>{e&&(async()=>{S(!0),console.log("[useEffect] fetchScenarioDetails start, isLoading:",!0);try{const $=await fetch(`/locales/${o}/scenarios.json`);if(!$.ok)throw new Error("Failed to fetch scenarios");const ne=await $.json(),oe=UN(ne,t,o);oe?(c(oe),h([{sender:"ai",text:oe.starting_line||oe.system_prompt||""}]),console.log("[useEffect] scenario loaded:",oe)):(c(null),console.log("[useEffect] scenario not found"))}catch($){console.error("[useEffect] Error fetching scenario details:",$),c(null)}finally{S(!1),console.log("[useEffect] fetchScenarioDetails end, isLoading:",!1)}})()},[e,o]);const R=async(X,$,ne={})=>{console.log("[callApi] url:",X,"body:",$);const oe=await fetch(X,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify($),...ne});if(!oe.ok)throw new Error("API call failed");return oe},A=async X=>{S(!0),console.log("[handleAudio] isLoading:",!0);try{const $=r.currentUser;if(!$){T("請先登入");return}const ne=await F("aiChat");if(!ne.allowed){if(W)return;ne.canRenew,te(ne),B(!0);return}const oe=new FormData;oe.append("audio",X,"audio.webm"),oe.append("userId",$.uid);const J=await fetch("/api/whisper",{method:"POST",body:oe});if(!J.ok){const G=await J.text();throw new Error(`Whisper API failed: ${G}`)}const Q=await J.json(),D=Q.transcript||Q.text||"";D&&(g(D),setTimeout(()=>{N()},300))}catch($){console.error("Error with audio processing:",$)}finally{S(!1),console.log("[handleAudio] end, isLoading:",!1)}},N=async()=>{if(!m.trim()){T("請先輸入內容再送出");return}if(!L(m)){T("請輸入至少12個字訓練表達能力");return}if(!r.currentUser){T("請先登入");return}const $=await F("aiChat");if(!$.allowed){if(W)return;$.canRenew?(te($),B(!0)):T("需要訂閱才能使用 AI 聊天功能");return}const ne=m;h(oe=>{const J=[...oe,{sender:"user",text:ne}];return O(J),J}),g("")},O=async X=>{S(!0),console.log("[getAIResponse] called, currentMessages:",X);try{const $=X.filter(ee=>ee&&ee.text&&ee.text.trim()).map(ee=>({sender:ee.sender,text:ee.text.trim()})),ne=a?{system_prompt:a.system_prompt||"",title:a.title||"",description:a.description||""}:{},oe=r.currentUser,Q=await(await R("/api/gpt",{messages:$,...ne,userId:oe==null?void 0:oe.uid})).json(),D=Q.reply||Q.message||"AI 無回應";h(ee=>[...ee,{sender:"ai",text:D}]),console.log("[getAIResponse] AI message:",D);const ie=await(await R("/api/tts",{text:D},{responseType:"blob"})).blob();C.current&&(C.current.src=URL.createObjectURL(ie),C.current.play())}catch($){console.error("[getAIResponse] Error getting AI response:",$),h(ne=>[...ne,{sender:"ai",text:"抱歉，我現在遇到一些問題，請稍後再試。"}])}finally{S(!1),console.log("[getAIResponse] end, isLoading:",!1)}};if(!a)return i.jsxs("div",{style:{textAlign:"center",marginTop:80},children:[i.jsx("div",{style:{fontSize:22,marginBottom:16},children:"⚠️ Scenario not found."}),i.jsx("button",{onClick:()=>n("/skillbox"),style:{padding:"10px 28px",borderRadius:8,background:"#6B5BFF",color:"#fff",fontWeight:700,fontSize:16,border:"none",cursor:"pointer"},children:"Go back"})]});const z=()=>{B(!1),te(null)};return i.jsxs("div",{className:"modern-bg",style:{background:"url('/senario.png') center center / cover no-repeat fixed",minHeight:"100vh",width:"100vw",overflow:"hidden",position:"relative"},children:[i.jsx("audio",{ref:C,hidden:!0}),i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,zIndex:200,display:"flex",justifyContent:"flex-start",alignItems:"center",padding:"18px 32px 0 32px",background:"transparent",width:"100vw",pointerEvents:"auto"},children:i.jsx("button",{className:"topbar-btn",onClick:()=>n("/skillbox"),style:{fontWeight:700,fontSize:18,padding:"6px 16px",borderRadius:8,border:"1.5px solid #6B5BFF",background:"#fff",color:"#6B5BFF",cursor:"pointer"},children:iy.backToScenarios[o]})}),i.jsxs("div",{style:{width:"100%",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",marginTop:80,overflowY:"auto",maxHeight:"calc(100vh - 80px)",padding:"24px"},children:[i.jsxs("div",{style:{width:"100%",maxWidth:700,background:"rgba(255,255,255,0.97)",borderRadius:16,padding:"32px 32px 18px 32px",boxShadow:"0 4px 24px #0002",display:"flex",flexDirection:"column",alignItems:"center",marginBottom:0,position:"relative"},children:[i.jsx("div",{style:{fontSize:54,marginBottom:8},children:a.emoji}),i.jsx("h2",{style:{color:"#6B5BFF",fontWeight:900,fontSize:28,marginBottom:24,textAlign:"center"},children:a.title}),i.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:12,marginBottom:8},children:[i.jsxs("span",{style:{fontWeight:600,fontSize:14,padding:"4px 12px",borderRadius:16,background:"#6B5BFF22",color:"#6B5BFF"},children:[YS.category[o],": ",a.category]}),i.jsxs("span",{style:{fontWeight:600,fontSize:14,padding:"4px 12px",borderRadius:16,background:"#23c6e622",color:"#23c6e6"},children:[YS.difficulty[o],": ",((j=VN[a.difficulty])==null?void 0:j[o])||a.difficulty]})]}),i.jsx("p",{style:{fontSize:16,color:"#4A4A4A",textAlign:"center",margin:"0 0 8px 0",lineHeight:1.6},children:a.description}),i.jsx("div",{style:{display:"flex",flexWrap:"wrap",justifyContent:"center",gap:8,marginBottom:16},children:(V=a.tags)==null?void 0:V.map(X=>i.jsx("span",{style:{fontSize:13,background:"#f7f7ff",color:"#6B5BFF",borderRadius:12,padding:"2px 10px"},children:X},X))})]}),i.jsxs("div",{style:{width:"100%",maxWidth:700,background:"rgba(255,255,255,0.93)",borderRadius:16,padding:"18px 32px 24px 32px",boxShadow:"0 4px 24px #0002",display:"flex",flexDirection:"column",marginTop:0},children:[i.jsx("div",{style:{minHeight:"32vh",maxHeight:"44vh",overflowY:"auto",background:"#f6f7fa",borderRadius:12,padding:16,marginBottom:24,display:"flex",flexDirection:"column",gap:"12px",boxShadow:"0 2px 8px #6B5BFF11"},children:d.map((X,$)=>i.jsx("div",{style:{alignSelf:X.sender==="user"?"flex-end":"flex-start",maxWidth:"75%"},children:i.jsx("div",{style:{background:X.sender==="user"?"linear-gradient(135deg, #6B5BFF 60%, #23c6e6 100%)":"#fff",color:X.sender==="user"?"#fff":"#4A4A4A",padding:"10px 16px",borderRadius:"18px",boxShadow:"0 2px 4px rgba(0,0,0,0.08)"},children:X.text})},$))}),i.jsxs("div",{style:{display:"flex",gap:"12px",alignItems:"center",position:"relative"},children:[i.jsx("div",{style:{marginRight:0},children:i.jsx(WN,{onAudio:A,lang:o})}),i.jsx("input",{type:"text",value:m,onChange:X=>g(X.target.value),placeholder:x?"AI正在思考...":iy.yourTurn[o],disabled:x,style:{flex:1,padding:"12px 16px",borderRadius:12,border:"2px solid #ddd",fontSize:16,outline:"none",background:x?"#f0f0f0":"#fff"},onKeyDown:X=>X.key==="Enter"&&N()}),i.jsx("button",{onClick:N,disabled:x,style:{padding:"12px 24px",borderRadius:12,background:x?"#ccc":"#6B5BFF",color:"#fff",border:"none",fontWeight:700,fontSize:16,cursor:x?"not-allowed":"pointer"},children:x?"...":iy.send[o]}),x&&i.jsx("div",{style:{position:"absolute",right:-36,top:"50%",transform:"translateY(-50%)"},children:i.jsx("span",{className:"loader",style:{display:"inline-block",width:24,height:24,border:"3px solid #6B5BFF",borderTop:"3px solid #fff",borderRadius:"50%",animation:"spin 1s linear infinite"}})})]}),m&&!L(m)&&i.jsx("div",{style:{color:"#ff9800",fontSize:15,marginTop:6,fontWeight:600},children:"請輸入至少12個字訓練表達能力"})]})]}),_&&i.jsx("div",{style:{position:"fixed",top:32,left:"50%",transform:"translateX(-50%)",background:"#ff9800",color:"#fff",padding:"12px 32px",borderRadius:16,fontWeight:700,fontSize:18,zIndex:9999,boxShadow:"0 2px 12px #0002"},children:_}),i.jsx("style",{children:"@keyframes spin { 0% { transform: rotate(0deg);} 100% { transform: rotate(360deg);} }"}),P&&q&&i.jsx(Ms,{isOpen:P,onClose:z,currentPlan:q.currentPlan,remainingDays:q.remainingDays,usedTokens:q.usedTokens,totalTokens:q.totalTokens})]})}const qN=(n,e,t,r)=>{var a,c,d,h;const o=[t,{code:e,...r||{}}];if((c=(a=n==null?void 0:n.services)==null?void 0:a.logger)!=null&&c.forward)return n.services.logger.forward(o,"warn","react-i18next::",!0);Ta(o[0])&&(o[0]=`react-i18next:: ${o[0]}`),(h=(d=n==null?void 0:n.services)==null?void 0:d.logger)!=null&&h.warn?n.services.logger.warn(...o):console!=null&&console.warn&&console.warn(...o)},JS={},ix=(n,e,t,r)=>{Ta(t)&&JS[t]||(Ta(t)&&(JS[t]=new Date),qN(n,e,t,r))},TI=(n,e)=>()=>{if(n.isInitialized)e();else{const t=()=>{setTimeout(()=>{n.off("initialized",t)},0),e()};n.on("initialized",t)}},ox=(n,e,t)=>{n.loadNamespaces(e,TI(n,t))},ZS=(n,e,t,r)=>{if(Ta(t)&&(t=[t]),n.options.preload&&n.options.preload.indexOf(e)>-1)return ox(n,t,r);t.forEach(o=>{n.options.ns.indexOf(o)<0&&n.options.ns.push(o)}),n.loadLanguages(e,TI(n,r))},HN=(n,e,t={})=>!e.languages||!e.languages.length?(ix(e,"NO_LANGUAGES","i18n.languages were undefined or empty",{languages:e.languages}),!0):e.hasLoadedNamespace(n,{lng:t.lng,precheck:(r,o)=>{var a;if(((a=t.bindI18n)==null?void 0:a.indexOf("languageChanging"))>-1&&r.services.backendConnector.backend&&r.isLanguageChangingTo&&!o(r.isLanguageChangingTo,n))return!1}}),Ta=n=>typeof n=="string",$N=n=>typeof n=="object"&&n!==null,GN=/&(?:amp|#38|lt|#60|gt|#62|apos|#39|quot|#34|nbsp|#160|copy|#169|reg|#174|hellip|#8230|#x2F|#47);/g,KN={"&amp;":"&","&#38;":"&","&lt;":"<","&#60;":"<","&gt;":">","&#62;":">","&apos;":"'","&#39;":"'","&quot;":'"',"&#34;":'"',"&nbsp;":" ","&#160;":" ","&copy;":"©","&#169;":"©","&reg;":"®","&#174;":"®","&hellip;":"…","&#8230;":"…","&#x2F;":"/","&#47;":"/"},QN=n=>KN[n],YN=n=>n.replace(GN,QN);let XN={bindI18n:"languageChanged",bindI18nStore:"",transEmptyNodeValue:"",transSupportBasicHtmlNodes:!0,transWrapTextNodes:"",transKeepBasicHtmlNodesFor:["br","strong","i","p"],useSuspense:!0,unescape:YN};const JN=()=>XN;let ZN;const e3=()=>ZN,t3=v.createContext();class n3{constructor(){this.usedNamespaces={}}addUsedNamespaces(e){e.forEach(t=>{this.usedNamespaces[t]||(this.usedNamespaces[t]=!0)})}getUsedNamespaces(){return Object.keys(this.usedNamespaces)}}const r3=(n,e)=>{const t=v.useRef();return v.useEffect(()=>{t.current=n},[n,e]),t.current},_I=(n,e,t,r)=>n.getFixedT(e,t,r),i3=(n,e,t,r)=>v.useCallback(_I(n,e,t,r),[n,e,t,r]),o3=(n,e={})=>{var q,te,W,L;const{i18n:t}=e,{i18n:r,defaultNS:o}=v.useContext(t3)||{},a=t||r||e3();if(a&&!a.reportNamespaces&&(a.reportNamespaces=new n3),!a){ix(a,"NO_I18NEXT_INSTANCE","useTranslation: You will need to pass in an i18next instance by using initReactI18next");const R=(N,O)=>Ta(O)?O:$N(O)&&Ta(O.defaultValue)?O.defaultValue:Array.isArray(N)?N[N.length-1]:N,A=[R,{},!1];return A.t=R,A.i18n={},A.ready=!1,A}(q=a.options.react)!=null&&q.wait&&ix(a,"DEPRECATED_OPTION","useTranslation: It seems you are still using the old wait option, you may migrate to the new useSuspense behaviour.");const c={...JN(),...a.options.react,...e},{useSuspense:d,keyPrefix:h}=c;let m=o||((te=a.options)==null?void 0:te.defaultNS);m=Ta(m)?[m]:m||["translation"],(L=(W=a.reportNamespaces).addUsedNamespaces)==null||L.call(W,m);const g=(a.isInitialized||a.initializedStoreOnce)&&m.every(R=>HN(R,a,c)),x=i3(a,e.lng||null,c.nsMode==="fallback"?m:m[0],h),S=()=>x,C=()=>_I(a,e.lng||null,c.nsMode==="fallback"?m:m[0],h),[_,I]=v.useState(S);let T=m.join();e.lng&&(T=`${e.lng}${T}`);const F=r3(T),P=v.useRef(!0);v.useEffect(()=>{const{bindI18n:R,bindI18nStore:A}=c;P.current=!0,!g&&!d&&(e.lng?ZS(a,e.lng,m,()=>{P.current&&I(C)}):ox(a,m,()=>{P.current&&I(C)})),g&&F&&F!==T&&P.current&&I(C);const N=()=>{P.current&&I(C)};return R&&(a==null||a.on(R,N)),A&&(a==null||a.store.on(A,N)),()=>{P.current=!1,a&&(R==null||R.split(" ").forEach(O=>a.off(O,N))),A&&a&&A.split(" ").forEach(O=>a.store.off(O,N))}},[a,T]),v.useEffect(()=>{P.current&&g&&I(S)},[a,h,g]);const B=[_,a,g];if(B.t=_,B.i18n=a,B.ready=g,g||!g&&!d)return B;throw new Promise(R=>{e.lng?ZS(a,e.lng,m,()=>R()):ox(a,m,()=>R())})},s3={"zh-TW":{male:"男",female:"女",other:"其他"},"zh-CN":{male:"男",female:"女",other:"其他"},en:{male:"Male",female:"Female",other:"Other"},ja:{male:"男性",female:"女性",other:"その他"},ko:{male:"남성",female:"여성",other:"기타"},th:{male:"ชาย",female:"หญิง",other:"อื่นๆ"},vi:{male:"Nam",female:"Nữ",other:"Khác"},ms:{male:"Lelaki",female:"Perempuan",other:"Lain-lain"},la:{male:"Mas",female:"Femina",other:"Aliud"}},a3={"zh-TW":"歲","zh-CN":"岁",en:"y/o",ja:"歳",ko:"세",th:"ปี",vi:"tuổi",ms:"tahun",la:"annos"},co={"zh-TW":{nickname:"暱稱",gender:"性別",age:"年齡",country:"國家/地區",interest:"興趣",eventType:"事件類型",improvement:"想改善",email:"Email",bio:"簡介"},"zh-CN":{nickname:"昵称",gender:"性别",age:"年龄",country:"国家/地区",interest:"兴趣",eventType:"事件类型",improvement:"想改善",email:"邮箱",bio:"简介"},en:{nickname:"Nickname",gender:"Gender",age:"Age",country:"Country/Region",interest:"Interest",eventType:"Event Type",improvement:"To Improve",email:"Email",bio:"Bio"},ja:{nickname:"ニックネーム",gender:"性別",age:"年齢",country:"国/地域",interest:"興味",eventType:"イベントタイプ",improvement:"改善したいこと",email:"メール",bio:"自己紹介"},ko:{nickname:"닉네임",gender:"성별",age:"나이",country:"국가/지역",interest:"관심사",eventType:"이벤트 유형",improvement:"개선하고 싶은 점",email:"이메일",bio:"소개"},th:{nickname:"ชื่อเล่น",gender:"เพศ",age:"อายุ",country:"ประเทศ/ภูมิภาค",interest:"ความสนใจ",eventType:"ประเภทเหตุการณ์",improvement:"สิ่งที่อยากปรับปรุง",email:"อีเมล",bio:"แนะนำตัว"},vi:{nickname:"Biệt danh",gender:"Giới tính",age:"Tuổi",country:"Quốc gia/Khu vực",interest:"Sở thích",eventType:"Loại sự kiện",improvement:"Điều muốn cải thiện",email:"Email",bio:"Giới thiệu"},ms:{nickname:"Nama panggilan",gender:"Jantina",age:"Umur",country:"Negara/Wilayah",interest:"Minat",eventType:"Jenis Acara",improvement:"Perkara untuk Diperbaiki",email:"Email",bio:"Pengenalan"},la:{nickname:"Cognomen",gender:"Sexus",age:"Aetas",country:"Patria/Regio",interest:"Studium",eventType:"Genus Eventus",improvement:"Emendare",email:"Email",bio:"Introductio"}},ek=({profile:n,variant:e="compact",showAvatar:t=!0,className:r="",style:o={}})=>{var m;const{lang:a}=Mt(),c=n.avatar||n.avatarUrl||"/avatars/Derxl.png",d=n.gender?((m=s3[a])==null?void 0:m[n.gender])||n.gender:"",h=a3[a];return e==="compact"?i.jsxs("div",{className:`user-profile-compact ${r}`,style:{display:"flex",alignItems:"center",gap:12,marginBottom:2,...o},children:[t&&i.jsx("img",{src:c,alt:"avatar",style:{width:36,height:36,borderRadius:"50%",objectFit:"cover",border:"2px solid #ececff"}}),i.jsx("span",{style:{fontWeight:600},children:n.nickname||"-"}),i.jsxs("span",{children:[n.age||"-",h]}),i.jsx("span",{children:d}),i.jsxs("span",{children:[n.country||"-",n.region?`/${n.region}`:""]})]}):i.jsxs("div",{className:`user-profile-detailed ${r}`,style:{marginTop:10,fontSize:14,color:"#6B5BFF",fontWeight:500,background:"#f7f8fc",borderRadius:8,padding:"8px 12px",...o},children:[t&&i.jsx("div",{style:{textAlign:"center",marginBottom:8},children:i.jsx("img",{src:c,alt:"avatar",style:{width:48,height:48,borderRadius:"50%",objectFit:"cover",border:"2px solid #6B5BFF"}})}),i.jsxs("div",{children:[co[a].nickname,"：",n.nickname||"-"]}),i.jsxs("div",{children:[co[a].gender,"：",d]}),i.jsxs("div",{children:[co[a].age,"：",n.age||"-",h]}),i.jsxs("div",{children:[co[a].country,"：",n.country||"-"," ",n.region||""]}),i.jsxs("div",{children:[co[a].interest,"：",n.interest||"-"]}),i.jsxs("div",{children:[co[a].eventType,"：",n.eventType||"-"]}),n.improvement&&i.jsxs("div",{children:[co[a].improvement,"：",n.improvement]}),n.email&&i.jsxs("div",{children:[co[a].email,"：",n.email]}),n.bio&&i.jsxs("div",{children:[co[a].bio,"：",n.bio]})]})},qe={pageTitle:{"zh-TW":"故事鏈ReStoryChain™","zh-CN":"故事链ReStoryChain™",en:"ReStoryChain™",ja:"ストーリーチェーンReStoryChain™",ko:"스토리체인ReStoryChain™",th:"ReStoryChain™",vi:"ReStoryChain™",ms:"ReStoryChain™",la:"ReStoryChain™"},encouragement:{"zh-TW":"AI鼓勵語","zh-CN":"AI鼓励语",en:"AI Encouragement",ja:"AI励まし",ko:"AI 격려",th:"AI ให้กำลังใจ",vi:"AI động viên",ms:"AI Galakan",la:"AI Hortatio"},back:{"zh-TW":"返回","zh-CN":"返回",en:"Back",ja:"戻る",ko:"돌아가기",th:"กลับ",vi:"Quay lại",ms:"Kembali",la:"Redire"},logout:{"zh-TW":"登出","zh-CN":"登出",en:"Logout",ja:"ログアウト",ko:"로그아웃",th:"ออกจากระบบ",vi:"Đăng xuất",ms:"Log keluar",la:"Exire"},titlePlaceholder:{"zh-TW":"請輸入標題(限30字)","zh-CN":"请输入标题(限30字)",en:"Enter title (max 30 chars)",ja:"タイトルを入力（30文字以内）",ko:"제목을 입력하세요(30자 이내)",th:"กรอกชื่อเรื่อง (สูงสุด 30 ตัวอักษร)",vi:"Nhập tiêu đề (tối đa 30 ký tự)",ms:"Masukkan tajuk (maks 30 aksara)",la:"Titulum insere (max 30 litterae)"},contentPlaceholder:{"zh-TW":"請輸入內容(限500字)","zh-CN":"请输入内容(限500字)",en:"Enter content (max 500 chars)",ja:"内容を入力（500文字以内）",ko:"내용을 입력하세요(500자 이내)",th:"กรอกเนื้อหา (สูงสุด 500 ตัวอักษร)",vi:"Nhập nội dung (tối đa 500 ký tự)",ms:"Masukkan kandungan (maks 500 aksara)",la:"Contentum insere (max 500 litterae)"},formTitle:{"zh-TW":"分享你的故事","zh-CN":"分享你的故事",en:"Share Your Story",ja:"ストーリーを共有",ko:"이야기 공유",th:"แบ่งปันเรื่องราวของคุณ",vi:"Chia sẻ câu chuyện của bạn",ms:"Kongsi Cerita Anda",la:"Communica Fabulas Tuas"},formSubmit:{"zh-TW":"送出","zh-CN":"提交",en:"Post",ja:"投稿",ko:"게시",th:"โพสต์",vi:"Đăng",ms:"Hantar",la:"Submittere"},encouragementDefault:{"zh-TW":"繼續前進！你的故事很重要。","zh-CN":"继续前进！你的故事很重要。",en:"Keep going! Your story matters.",ja:"前に進もう！あなたのストーリーは大切です。",ko:"계속 나아가세요! 당신의 이야기는 소중합니다.",th:"เดินหน้าต่อไป! เรื่องราวของคุณสำคัญ",vi:"Tiếp tục nhé! Câu chuyện của bạn rất ý nghĩa.",ms:"Teruskan! Cerita anda penting.",la:"Perge! Fabula tua magni momenti est."},storyQuoteLine1:{"zh-TW":"有些故事不為了解釋，只是為了放下！","zh-CN":"有些故事不是为了说明，只是为了放下！",en:"Some stories are not for explanation, but for letting go!",ja:"いくつかの物語は説明のためではなく、手放すためのものです！",ko:"어떤 이야기는 설명을 위한 것이 아니라 내려놓기 위한 것입니다!",th:"เรื่องราวบางเรื่องไม่ได้มีไว้เพื่ออธิบาย แต่มีไว้เพื่อปล่อยวาง!",vi:"Có những câu chuyện không phải để giải thích, mà là để buông bỏ!",ms:"Sesetengah cerita bukan untuk dijelaskan, tetapi untuk dilepaskan!",la:"Nonnullae fabulae non ad explicandum, sed ad dimittendum sunt!"},storyQuoteLine2:{"zh-TW":"寫下來，也是一種放過自己... 寫下來，也是一種勇敢。","zh-CN":"写下来，也是放过自己... 写下来，也是勇敢。",en:"Writing it down is also a way to release yourself... Writing it down is also a kind of courage.",ja:"書き出すことは自分を解放する方法でもあり... 書き出すことは勇気でもあります。",ko:"써내려가는 것은 자신을 놓아주는 방법이기도 하고... 써내려가는 것은 용기이기도 합니다.",th:"การเขียนออกมาก็เป็นการปลดปล่อยตัวเอง... การเขียนออกมาก็เป็นความกล้าหาญอย่างหนึ่ง",vi:"Viết ra cũng là một cách tha thứ cho bản thân... Viết ra cũng là một sự dũng cảm.",ms:"Menulisnya adalah satu cara melepaskan diri... Menulisnya adalah satu keberanian.",la:"Scribere est te ipsum dimittere... Scribere est etiam audacia."},storyQuoteLine3:{"zh-TW":"有人願意說出口，就有人不再那麼孤單，分享就是力量。","zh-CN":"有人愿意说出口，就有人不再那么孤单，分享就是力量。",en:"When someone is willing to speak out, someone else is no longer alone. Sharing is power.",ja:"誰かが声に出してくれることで、誰かがもう孤独ではなくなります。シェアすることは力です。",ko:"누군가 말할 용기를 내면, 누군가는 더 이상 외롭지 않습니다. 나눔은 힘입니다.",th:"เมื่อมีใครสักคนกล้าที่จะพูดออกมา ก็จะมีใครสักคนที่ไม่ต้องโดดเดี่ยวอีกต่อไป การแบ่งปันคือพลัง",vi:"Khi ai đó dám nói ra, sẽ có người không còn cô đơn nữa. Chia sẻ là sức mạnh.",ms:"Apabila seseorang sanggup meluahkan, seseorang yang lain tidak lagi keseorangan. Berkongsi adalah kekuatan.",la:"Cum aliquis loqui velit, aliquis non iam solus est. Communicatio est potestas."},blockchainNote:{"zh-TW":"💡 區塊鏈功能正在開發中，目前僅為標記功能，實際封存功能將在未來版本中推出","zh-CN":"💡 区块链功能正在开发中，目前仅为标记功能，实际封存功能将在未来版本中推出",en:"💡 Blockchain feature is under development. Currently only a marker function, actual preservation will be available in future versions",ja:"💡 ブロックチェーン機能は開発中です。現在はマーカー機能のみで、実際の保存機能は将来のバージョンで提供予定です",ko:"💡 블록체인 기능이 개발 중입니다. 현재는 마커 기능만 있으며, 실제 보존 기능은 향후 버전에서 제공될 예정입니다",th:"💡 ฟีเจอร์บล็อกเชนกำลังอยู่ในขั้นตอนการพัฒนา ปัจจุบันเป็นเพียงฟังก์ชันเครื่องหมาย การเก็บรักษาจริงจะพร้อมใช้งานในเวอร์ชันอนาคต",vi:"💡 Tính năng blockchain đang được phát triển. Hiện tại chỉ là chức năng đánh dấu, tính năng lưu trữ thực tế sẽ có trong phiên bản tương lai",ms:"💡 Ciri blockchain sedang dalam pembangunan. Kini hanya fungsi penanda, fungsi pemeliharaan sebenar akan tersedia dalam versi masa hadapan",la:"💡 Blockchain functio in progressu est. Nunc tantum signum functionis, vera conservatio in futuris versionibus praesto erit"},storyPrompt:{"zh-TW":"如果只能留下一個故事，你想從哪裡開始呢？","zh-CN":"如果只能留下一个故事，你想从哪里开始呢？",en:"If you could only leave one story, where would you start?",ja:"もし一つの物語しか残せないとしたら、どこから始めますか？",ko:"만약 하나의 이야기만 남길 수 있다면, 어디서부터 시작하시겠습니까?",th:"หากคุณสามารถทิ้งเรื่องราวไว้เพียงเรื่องเดียว คุณจะเริ่มต้นจากที่ไหน?",vi:"Nếu bạn chỉ có thể để lại một câu chuyện, bạn sẽ bắt đầu từ đâu?",ms:"Jika anda hanya boleh tinggalkan satu cerita, di mana anda akan mula?",la:"Si unam tantum fabulam relinquere posses, unde inciperes?"},partnersStories:{"zh-TW":"夥伴們的分享","zh-CN":"伙伴们的分享",en:"Partners' Stories",ja:"仲間たちのシェア",ko:"파트너들의 이야기",th:"เรื่องราวของเพื่อนๆ",vi:"Chia sẻ của các bạn",ms:"Kisah Rakan-rakan",la:"Communicatio Sociorum"},myStories:{"zh-TW":"我的故事","zh-CN":"我的故事",en:"My Stories",ja:"私のストーリー",ko:"나의 이야기",th:"เรื่องราวของฉัน",vi:"Câu chuyện của tôi",ms:"Cerita Saya",la:"Fabulae Meae"},friendStories:{"zh-TW":"好友故事","zh-CN":"好友故事",en:"Friend Stories",ja:"友達のストーリー",ko:"친구 이야기",th:"เรื่องราวของเพื่อน",vi:"Câu chuyện bạn bè",ms:"Cerita Rakan",la:"Fabulae Amicorum"},noFriends:{"zh-TW":"你還沒有好友連結，快去","zh-CN":"你还没有好友连结，快去",en:"You have no friend connections yet, go to",ja:"まだ友達のつながりがありません。",ko:"아직 친구 연결이 없습니다. 빨리",th:"คุณยังไม่มีการเชื่อมต่อเพื่อน",vi:"Bạn chưa có kết nối bạn bè nào, hãy đến",ms:"Anda masih tiada sambungan rakan, pergi ke",la:"Nondum amicos conexos habes, ad"},goToPairTalk:{"zh-TW":"交友區建立連結吧！","zh-CN":"交友区建立连结吧！",en:"Go to Friend Zone to connect!",ja:"フレンドゾーンでつながろう！",ko:"프렌드존에서 연결하세요!",th:"ไปที่ Friend Zone เพื่อเชื่อมต่อ!",vi:"đến Friend Zone để kết nối!",ms:"ke Friend Zone untuk sambung!",la:"ad Friend Zone coniunge!"},visibilityPrivate:{"zh-TW":"私密","zh-CN":"私密",en:"Private",ja:"非公開",ko:"비공개",th:"ส่วนตัว",vi:"Riêng tư",ms:"Peribadi",la:"Privatus"},visibilityFriends:{"zh-TW":"限好友","zh-CN":"限好友",en:"Friends Only",ja:"友達のみ",ko:"친구만",th:"เฉพาะเพื่อน",vi:"Chỉ bạn bè",ms:"Hanya Rakan",la:"Amicis Tantum"},visibilityPublic:{"zh-TW":"開放分享","zh-CN":"开放分享",en:"Public",ja:"公開",ko:"공개",th:"สาธารณะ",vi:"Công khai",ms:"Umum",la:"Publicus"},profileLabels:{"zh-TW":`暱稱：{nickname}
性別：{gender}
年齡：{age}
國家/地區：{country}
興趣：{interest}
事件類型：{eventType}`,"zh-CN":`昵称：{nickname}
性别：{gender}
年龄：{age}
国家/地区：{country}
兴趣：{interest}
事件类型：{eventType}`,en:`Nickname: {nickname}
Gender: {gender}
Age: {age}
Country/Region: {country}
Interest: {interest}
Event Type: {eventType}`,ja:`ニックネーム：{nickname}
性別：{gender}
年齢：{age}
国/地域：{country}
興味：{interest}
イベントタイプ：{eventType}`,ko:`닉네임: {nickname}
성별: {gender}
나이: {age}
국가/지역: {country}
관심사: {interest}
이벤트 유형: {eventType}`,th:`ชื่อเล่น: {nickname}
เพศ: {gender}
อายุ: {age}
ประเทศ/ภูมิภาค: {country}
ความสนใจ: {interest}
ประเภทเหตุการณ์: {eventType}`,vi:`Biệt danh: {nickname}
Giới tính: {gender}
Tuổi: {age}
Quốc gia/Khu vực: {country}
Sở thích: {interest}
Loại sự kiện: {eventType}`,ms:`Nama panggilan: {nickname}
Jantina: {gender}
Umur: {age}
Negara/Wilayah: {country}
Minat: {interest}
Jenis Acara: {eventType}`,la:`Cognomen: {nickname}
Sexus: {gender}
Aetas: {age}
Patria/Regio: {country}
Studium: {interest}
Genus Eventus: {eventType}`}},oy=["bg-gradient-to-br from-[#7f8fff] to-[#b6b6f6]","bg-gradient-to-br from-[#ffb6b6] to-[#ffd6e0]","bg-gradient-to-br from-[#6be6ff] to-[#b6f6ff]","bg-gradient-to-br from-[#ffe66b] to-[#ffb86b]"];function tk(n){if(!n||typeof n!="string")return oy[0];let e=0;for(let t=0;t<n.length;t++)e+=n.charCodeAt(t);return oy[e%oy.length]}const Lt={"zh-TW":{work_restart:"工作重啟",family_trust:"家庭信任",social_treatment:"社會對待",inner_choice:"內心選擇",misunderstood_and_recovered:"誤解與復原",restart_path:"重啟之路"},"zh-CN":{work_restart:"工作重启",family_trust:"家庭信任",social_treatment:"社会对待",inner_choice:"内心选择",misunderstood_and_recovered:"误解与复原",restart_path:"重启之路"},en:{work_restart:"Work Restart",family_trust:"Family Trust",social_treatment:"Social Treatment",inner_choice:"Inner Choice",misunderstood_and_recovered:"Misunderstood & Recovered",restart_path:"Restart Path"},ja:{work_restart:"仕事の再出発",family_trust:"家族の信頼",social_treatment:"社会の扱い",inner_choice:"内なる選択",misunderstood_and_recovered:"誤解と回復",restart_path:"再出発の道"},ko:{work_restart:"일 재시작",family_trust:"가족의 신뢰",social_treatment:"사회적 대우",inner_choice:"내면의 선택",misunderstood_and_recovered:"오해와 회복",restart_path:"재시작의 길"},th:{work_restart:"เริ่มงานใหม่",family_trust:"ความไว้วางใจในครอบครัว",social_treatment:"การปฏิบัติของสังคม",inner_choice:"ทางเลือกภายในใจ",misunderstood_and_recovered:"ความเข้าใจผิดและการฟื้นฟู",restart_path:"เส้นทางเริ่มต้นใหม่"},vi:{work_restart:"Khởi động lại công việc",family_trust:"Niềm tin gia đình",social_treatment:"Cách đối xử của xã hội",inner_choice:"Lựa chọn nội tâm",misunderstood_and_recovered:"Hiểu lầm và phục hồi",restart_path:"Con đường làm lại"},ms:{work_restart:"Mula Kerja Semula",family_trust:"Kepercayaan Keluarga",social_treatment:"Layanan Sosial",inner_choice:"Pilihan Dalaman",misunderstood_and_recovered:"Salah Faham & Pemulihan",restart_path:"Jalan Permulaan Semula"},la:{work_restart:"Opus Renovatum",family_trust:"Fides Familiaris",social_treatment:"Tractatio Socialis",inner_choice:"Electio Interior",misunderstood_and_recovered:"Error et Recuperatio",restart_path:"Iter Renovationis"}},nk={"zh-TW":"✔ 我願意將這段見證封存於區塊鏈（開發中）","zh-CN":"✔ 我愿意将这段见证封存于区块链（开发中）",en:"✔ I agree to preserve this testimony on the blockchain (In Development)",ja:"✔ この証言をブロックチェーンに保存することに同意します（開発中）",ko:"✔ 이 증언을 블록체인에 보존하는 것에 동의합니다（개발 중）",th:"✔ ฉันยินยอมให้บันทึกเรื่องราวนี้บนบล็อกเชน（กำลังพัฒนา）",vi:"✔ Tôi đồng ý lưu giữ câu chuyện này trên blockchain (Đang phát triển)",ms:"✔ Saya bersetuju untuk menyimpan kisah ini di blockchain (Dalam Pembangunan)",la:"✔ Assentior hanc testificationem in blockchain servari (In Progressu)"},sy={"zh-TW":{private:"只有我",friends:"好友可見",public:"所有人",label:"誰可以看到這段故事？"},"zh-CN":{private:"只有我",friends:"好友可见",public:"所有人",label:"谁可以看到这段故事？"},en:{private:"Only me",friends:"Friends only",public:"Everyone",label:"Who can see this story?"},ja:{private:"自分だけ",friends:"友達のみ",public:"全員",label:"誰がこのストーリーを見られますか？"},ko:{private:"나만 보기",friends:"친구만 보기",public:"모두 보기",label:"이 이야기를 누가 볼 수 있나요?"},th:{private:"เฉพาะฉัน",friends:"เพื่อนเท่านั้น",public:"ทุกคน",label:"ใครสามารถเห็นเรื่องราวนี้ได้บ้าง?"},vi:{private:"Chỉ mình tôi",friends:"Chỉ bạn bè",public:"Mọi người",label:"Ai có thể xem câu chuyện này?"},ms:{private:"Hanya saya",friends:"Hanya rakan",public:"Semua orang",label:"Siapa boleh melihat cerita ini?"},la:{private:"Solus ego",friends:"Amici tantum",public:"Omnes",label:"Quis hanc historiam videre potest?"}},l3={"zh-TW":{launch:"寫下來，也是⼀種勇敢。",ask:"如果只能留下一個故事，你會從哪裡說起？",thanks:"🎉 感謝你分享，這是你的故事",success:"你寫得很好，這段經歷值得被看見。",randomEncourage:["你的過去不定義你，選擇講述它，才是你的力量。","每個故事都值得被聽見。","你願意分享真心，我們願意陪你走一段。","你的經歷很珍貴，謝謝你願意說出來。"],chain:"我要將這段故事封存於區塊鏈",anonymous:"我要匿名分享",countryName:{中國大陸:"中國大陸",台灣:"台灣",日本:"日本",韓國:"韓國",美國:"美國",其他:"其他"},eventTypeName:{家暴加害:"家暴加害",家暴受害:"家暴受害",其他:"其他"}},"zh-CN":{launch:"写下来，也是一种勇敢。",ask:"这次你想聊的是什么？",thanks:"🎉 感谢你的分享，这是你的故事",success:"你写得很好，这段经历值得被看见。",randomEncourage:["你的过去不定义你，选择讲述它，才是你的力量。","每个故事都值得被听见。","你愿意分享真心，我们愿意陪你走一段。","你的经历很珍贵，谢谢你愿意说出来。"],chain:"我要将这段故事封存于区块链",anonymous:"我要匿名分享",countryName:{中國大陸:"中国大陆",台灣:"台湾",日本:"日本",韓國:"韩国",美國:"美国",其他:"其他"},eventTypeName:{家暴加害:"家暴加害",家暴受害:"家暴受害",其他:"其他"}},en:{launch:"Writing it down is also an act of courage.",ask:"What do you want to talk about this time?",thanks:"🎉 Thank you for sharing, this is your story",success:"You wrote beautifully. This experience deserves to be seen.",randomEncourage:["Your past does not define you. Choosing to tell it is your power.","Every story deserves to be heard.","You share your heart, we walk with you.","Your experience is precious, thank you for sharing."],chain:"I want to preserve this story on the blockchain",anonymous:"I want to share anonymously",countryName:{中國大陸:"China",台灣:"Taiwan",日本:"Japan",韓國:"Korea",美國:"USA",其他:"Other"},eventTypeName:{家暴加害:"Domestic Violence Perpetrator",家暴受害:"Domestic Violence Victim",其他:"Other"}},ja:{launch:"",ask:"",thanks:"",success:"",randomEncourage:[""],chain:"",anonymous:""},ko:{launch:"",ask:"",thanks:"",success:"",randomEncourage:[""],chain:"",anonymous:""},th:{launch:"",ask:"",thanks:"",success:"",randomEncourage:[""],chain:"",anonymous:""},vi:{launch:"",ask:"",thanks:"",success:"",randomEncourage:[""],chain:"",anonymous:""},ms:{launch:"",ask:"",thanks:"",success:"",randomEncourage:[""],chain:"",anonymous:""},la:{launch:"",ask:"",thanks:"",success:"",randomEncourage:[""],chain:"",anonymous:""}};async function ay(n,e,t){var o;const r={[e]:n};for(const a of t)if(a!==e)try{const d=await(await fetch("/api/translate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:n,from:e,to:a})})).json();r[a]=d.translated||""}catch{try{const d=await(await fetch(`https://translate.googleapis.com/translate_a/single?client=gtx&sl=${e}&tl=${a}&dt=t&q=${encodeURIComponent(n)}`)).json();r[a]=((o=d[0])==null?void 0:o.map(h=>h[0]).join(""))||""}catch{r[a]=""}}return r}function Fl(n,e){return n.titleLangs&&n.titleLangs[e]||n.title}function zl(n,e){return n.contentLangs&&n.contentLangs[e]||n.content}const Dl={"zh-TW":{中國大陸:"中國大陸",台灣:"台灣",日本:"日本",韓國:"韓國",美國:"美國",其他:"其他"},"zh-CN":{中國大陸:"中国大陆",台灣:"台湾",日本:"日本",韓國:"韩国",美國:"美国",其他:"其他"},en:{中國大陸:"China",台灣:"Taiwan",日本:"Japan",韓國:"Korea",美國:"USA",其他:"Other"},ja:{中國大陸:"中国大陸",台灣:"台湾",日本:"日本",韓國:"韓国",美國:"アメリカ",其他:"その他"},ko:{中國大陸:"중국",台灣:"대만",日本:"일본",韓國:"한국",美國:"미국",其他:"기타"},th:{中國大陸:"จีน",台灣:"ไต้หวัน",日本:"ญี่ปุ่น",韓國:"เกาหลี",美國:"สหรัฐอเมริกา",其他:"อื่นๆ"},vi:{中國大陸:"Trung Quốc",台灣:"Đài Loan",日本:"Nhật Bản",韓國:"Hàn Quốc",美國:"Mỹ",其他:"Khác"},ms:{中國大陸:"China",台灣:"Taiwan",日本:"Jepun",韓國:"Korea",美國:"Amerika",其他:"Lain-lain"},la:{中國大陸:"Sina",台灣:"Taiwan",日本:"Iaponia",韓國:"Corea",美國:"CFA",其他:"Aliud"}},Nl={"zh-TW":{家暴加害:"家暴加害",家暴受害:"家暴受害",其他:"其他"},"zh-CN":{家暴加害:"家暴加害",家暴受害:"家暴受害",其他:"其他"},en:{家暴加害:"Domestic Violence Perpetrator",家暴受害:"Domestic Violence Victim",其他:"Other"},ja:{家暴加害:"家庭内暴力加害者",家暴受害:"家庭内暴力被害者",其他:"その他"},ko:{家暴加害:"가정폭력 가해자",家暴受害:"가정폭력 피해자",其他:"기타"},th:{家暴加害:"ผู้กระทำความรุนแรงในครอบครัว",家暴受害:"เหยื่อความรุนแรงในครอบครัว",其他:"อื่นๆ"},vi:{家暴加害:"Người gây bạo lực gia đình",家暴受害:"Nạn nhân bạo lực gia đình",其他:"Khác"},ms:{家暴加害:"Pelaku Keganasan Rumah Tangga",家暴受害:"Mangsa Keganasan Rumah Tangga",其他:"Lain-lain"},la:{家暴加害:"Violentus Domesticus",家暴受害:"Victima Violentiae Domesticae",其他:"Aliud"}},c3=()=>{const n=Td(Ao),e=St(),t=_t(),{t:r,i18n:o}=o3(),[a,c]=v.useState("zh-TW");v.useEffect(()=>{const re=localStorage.getItem("lang");re&&["zh-TW","zh-CN","en","ja","ko","th","vi","ms","la"].includes(re)&&c(re)},[]);const[d,h]=v.useState(null),[m,g]=v.useState([]),[x,S]=v.useState(""),[C,_]=v.useState(""),[I,T]=v.useState(""),[F,P]=v.useState(null),[B,q]=v.useState(!1),[te,W]=v.useState(""),[L,R]=v.useState(!1),[A,N]=v.useState("public"),[O,z]=v.useState({tags:{}}),[j,V]=v.useState(null),[X,$]=v.useState(!1),[ne,oe]=v.useState(!1),[J,Q]=v.useState(""),[D,G]=v.useState(null),[ie,ee]=v.useState(""),[Se,we]=v.useState(!1),[Oe,Ne]=v.useState({}),[Ye,it]=v.useState({}),[me,Ve]=v.useState({}),[Xe,Je]=v.useState(!1),[He,fe]=v.useState([]);v.useEffect(()=>{const re=Ns(e,H=>h(H));return()=>re()},[e]),v.useEffect(()=>{(async()=>{const H=hr(Cn(n,"stories"),Xp("createdAt","desc")),Ue=await Mr(H);g(Ue.docs.map(ue=>({id:ue.id,...ue.data()})))})()},[n]),v.useEffect(()=>{fetch(`/locales/${a}/tags.json`).then(re=>re.json()).then(re=>z(re)).catch(()=>z({tags:{}}))},[a]),v.useEffect(()=>{let re;if(ne){let H=0;re=setInterval(()=>{H=(H+1)%6,Q(".".repeat(H))},400)}else Q("");return()=>clearInterval(re)},[ne]),v.useEffect(()=>{async function re(){const H=await ud(()=>Promise.resolve().then(()=>ef),void 0).then(ue=>ue.getDocs(ue.collection(n,"profiles"))),Ue={};H.forEach(ue=>{const le=ue.data();le.nickname&&(Ue[le.nickname]=le),le.name&&(Ue[le.name]=le)}),it(Ue)}re()},[]),v.useEffect(()=>{async function re(){const H=await ud(()=>Promise.resolve().then(()=>ef),void 0).then(ue=>ue.getDocs(ue.collection(n,"profiles"))),Ue={};H.forEach(ue=>{const le=ue.data();le.email&&(Ue[le.email]=le)}),Ve(Ue)}re()},[]),v.useEffect(()=>{d&&(async()=>{const H=Cn(n,"links"),Ue=hr(H,Rn("user1Id","==",d.uid),Rn("status","==","connected")),ue=hr(H,Rn("user2Id","==",d.uid),Rn("status","==","connected")),[le,Re]=await Promise.all([Mr(Ue),Mr(ue)]),rt=new Set;le.forEach(xe=>rt.add(xe.data().user2Id)),Re.forEach(xe=>rt.add(xe.data().user1Id)),fe(Array.from(rt))})()},[d]);const Te=async()=>{if(!x.trim()||!C.trim())return;oe(!0),$(!1);let re=0;const H=setInterval(()=>{re=(re+1)%6,Q(".".repeat(re))},400);try{q(!0);const[Ue,ue,le]=await Promise.all([fetch("/api/gpt/encourage",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({story:C})}).then(at=>at.json()).catch(()=>({encouragement:""})),ay(x,a,["zh-TW","zh-CN","en"]),ay(C,a,["zh-TW","zh-CN","en"])]),Re=Ue.encouragement||"",rt=Re?await ay(Re,a,["zh-TW","zh-CN","en"]):{},xe=l3[K].randomEncourage,Ae=xe[Math.floor(Math.random()*xe.length)];ee(Ae),await ys(Cn(n,"stories"),{title:x,content:C,author:(d==null?void 0:d.displayName)||"匿名",authorEmail:(d==null?void 0:d.email)||"",createdAt:new Date,comments:[],likes:0,encouragement:Re,encouragementLangs:rt,tag:te,visibility:A,onChain:L,titleLangs:ue,contentLangs:le}),S(""),_(""),q(!1);const Ge=hr(Cn(n,"stories"),Xp("createdAt","desc")),ke=(await Mr(Ge)).docs.map(at=>({id:at.id,...at.data()}));g(ke),V(ke[0]||null)}catch(Ue){console.error("Error adding story:",Ue),S(""),_(""),q(!1)}finally{clearInterval(H),oe(!1)}};function _e(re){return re.encouragementLangs&&re.encouragementLangs[K]?re.encouragementLangs[K]:re.encouragement||qe.encouragementDefault[K]}["intro.sunday","intro.monday","intro.tuesday","intro.wednesday","intro.thursday","intro.friday","intro.saturday"][new Date().getDay()];const Fe=async re=>{await Zp(Vn(n,"stories",re)),g(m.filter(H=>H.id!==re)),j&&j.id===re&&V(null)},Be=re=>{N(re),re!=="public"&&R(!1)},K=a||"zh-TW";return i.jsx("div",{children:window.innerWidth<=768?i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{position:"absolute",top:0,left:0,right:0,zIndex:100,background:"rgba(255,255,255,0.95)",borderRadius:"0 0 16px 16px",padding:"18px 16px",boxShadow:"0 2px 12px #6B5BFF22",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[i.jsx("button",{onClick:()=>t("/"),style:{fontWeight:700,fontSize:18,padding:"6px 16px",borderRadius:8,border:"1.5px solid #6B5BFF",background:"#fff",color:"#6B5BFF",cursor:"pointer"},children:qe.back[K]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[i.jsx("span",{style:{fontSize:"1.5rem",fontWeight:900,color:"#6B5BFF"},children:"📖"}),i.jsx("span",{style:{fontSize:"1.2rem",fontWeight:900,color:"#6B5BFF"},children:qe.pageTitle[K]})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[i.jsx("button",{onClick:async()=>{await Ir(e),localStorage.clear(),t("/")},style:{fontWeight:700,fontSize:16,padding:"6px 12px",borderRadius:8,border:"1.5px solid #6B5BFF",background:"#fff",color:"#6B5BFF",cursor:"pointer"},children:qe.logout[K]}),i.jsx(Bn,{})]})]}),i.jsxs("div",{style:{marginTop:80,marginBottom:16,background:"rgba(255,255,255,0.95)",borderRadius:16,padding:"16px",boxShadow:"0 2px 12px #6B5BFF22",textAlign:"center"},children:[i.jsx("div",{style:{fontSize:14,color:"#000",fontWeight:600,marginBottom:8},children:qe.storyQuoteLine1[K]}),i.jsx("div",{style:{fontSize:14,color:"#000",fontWeight:600,marginBottom:8},children:qe.storyQuoteLine2[K]}),i.jsx("div",{style:{fontSize:12,color:"#888",fontWeight:500},children:qe.storyQuoteLine3[K]})]}),i.jsxs("div",{style:{background:"rgba(255,255,255,0.95)",borderRadius:16,padding:"16px",marginBottom:16,boxShadow:"0 2px 12px #6B5BFF22"},children:[i.jsx("div",{style:{padding:"12px 20px",background:"linear-gradient(135deg, #6B5BFF 60%, #23c6e6 100%)",color:"#fff",border:"none",borderRadius:10,fontWeight:900,fontSize:17,letterSpacing:1,textAlign:"center",marginBottom:16},children:qe.formTitle[K]}),i.jsx("div",{style:{fontSize:16,color:"#6B5BFF",fontWeight:600,marginBottom:16,textAlign:"center"},children:qe.storyPrompt[K]}),i.jsx("input",{value:x,onChange:re=>S(re.target.value),placeholder:qe.titlePlaceholder[K],style:{width:"100%",boxSizing:"border-box",padding:12,borderRadius:16,border:"1px solid #ddd",fontSize:16,marginBottom:8,color:"#232946"}}),i.jsx("textarea",{value:C,onChange:re=>_(re.target.value),rows:3,placeholder:qe.contentPlaceholder[K],style:{width:"100%",height:120,boxSizing:"border-box",padding:12,borderRadius:16,border:"1px solid #ddd",fontSize:16,marginBottom:8,color:"#232946",resize:"none"}}),i.jsxs("div",{style:{display:"flex",gap:16,alignItems:"center",marginBottom:8,fontSize:15},children:[i.jsxs("label",{style:{display:"flex",alignItems:"center",gap:2},children:[i.jsx("input",{type:"radio",name:"visibility",value:"private",checked:A==="private",onChange:()=>Be("private")})," ",qe.visibilityPrivate[K]]}),i.jsxs("label",{style:{display:"flex",alignItems:"center",gap:2},children:[i.jsx("input",{type:"radio",name:"visibility",value:"friends",checked:A==="friends",onChange:()=>Be("friends")})," ",qe.visibilityFriends[K]]}),i.jsxs("label",{style:{display:"flex",alignItems:"center",gap:2},children:[i.jsx("input",{type:"radio",name:"visibility",value:"public",checked:A==="public",onChange:()=>Be("public")})," ",qe.visibilityPublic[K]]})]}),A==="public"&&i.jsxs("div",{style:{marginBottom:8},children:[i.jsxs("label",{style:{display:"flex",alignItems:"center",fontSize:15},children:[i.jsx("input",{type:"checkbox",checked:L,onChange:re=>R(re.target.checked),style:{marginRight:4}})," ",nk[K]]}),i.jsx("div",{style:{fontSize:12,color:"#888",marginTop:4,fontStyle:"italic"},children:qe.blockchainNote[K]})]}),i.jsx("button",{onClick:Te,disabled:B,style:{padding:"12px 20px",background:"linear-gradient(135deg, #6B5BFF 60%, #23c6e6 100%)",color:"#fff",border:"none",borderRadius:10,fontWeight:900,fontSize:17,letterSpacing:1,cursor:B?"not-allowed":"pointer",opacity:B?.6:1},children:qe.formSubmit[K]})]}),i.jsxs("div",{style:{background:"rgba(255,255,255,0.95)",borderRadius:16,padding:"16px",marginBottom:16,boxShadow:"0 2px 12px #6B5BFF22"},children:[i.jsxs("div",{style:{display:"flex",gap:4,marginBottom:16,flexWrap:"nowrap",justifyContent:"space-between"},children:[i.jsxs("button",{onClick:()=>{$(!0),Je(!1),we(!1),G(null)},style:{padding:"6px 8px",borderRadius:18,border:"none",background:X?"linear-gradient(90deg,#ffb86b 60%,#6B5BFF 100%)":"#eee",color:X?"#fff":"#6B5BFF",fontWeight:700,fontSize:12,cursor:"pointer",flex:1,marginRight:4},children:["#💬",qe.partnersStories[K]]}),i.jsxs("button",{onClick:()=>{Je(!0),$(!1),we(!1),G(null)},style:{padding:"6px 8px",borderRadius:18,border:"none",background:Xe?"linear-gradient(90deg,#23c6e6 60%,#6B5BFF 100%)":"#eee",color:Xe?"#fff":"#6B5BFF",fontWeight:700,fontSize:12,cursor:"pointer",flex:1,marginRight:4},children:["#🤝",qe.friendStories[K]]}),i.jsxs("button",{onClick:()=>{we(!0),$(!1),Je(!1),G(null)},style:{padding:"6px 8px",borderRadius:18,border:"none",background:Se?"linear-gradient(90deg,#6B5BFF 60%,#23c6e6 100%)":"#eee",color:Se?"#fff":"#6B5BFF",fontWeight:700,fontSize:12,cursor:"pointer",flex:1},children:["#📝",qe.myStories[K]]})]}),i.jsx("div",{style:{maxHeight:400,overflowY:"auto",width:"100%",paddingRight:6},children:Xe?He.length===0?i.jsxs("div",{style:{color:"#888",fontWeight:600,fontSize:16,padding:"32px 0",textAlign:"center"},children:[qe.noFriends[K],i.jsx("span",{onClick:()=>t("/friend"),style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,cursor:"pointer"},children:qe.goToPairTalk[K]})]}):m.filter(re=>re.visibility==="friends"&&He.includes(re.authorEmail)).map(re=>{const H=me[re.authorEmail]||{};return i.jsxs("div",{style:{background:"#fff",borderRadius:14,boxShadow:"0 2px 8px #b6b6f622",padding:14,marginBottom:14,cursor:"pointer"},children:[i.jsx("div",{style:{fontWeight:700,color:"#6B5BFF",fontSize:16,marginBottom:4},onClick:Ue=>{Ue.stopPropagation(),G(D===re.id?null:re.id)},children:Fl(re,K)}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:4,fontSize:"12px",flexWrap:"nowrap",whiteSpace:"nowrap"},children:[i.jsx("img",{src:H.avatar||H.avatarUrl||"/avatars/Derxl.png",alt:"avatar",style:{width:24,height:24,borderRadius:"50%",objectFit:"cover",border:"2px solid #ececff"}}),i.jsx("span",{style:{fontWeight:600},children:H&&H.nickname?H.nickname:"-"}),i.jsxs("span",{children:["，",H&&H.age?H.age:"-"]}),i.jsxs("span",{children:["，",H&&H.gender?H.gender:"-"]})]}),D===re.id&&i.jsxs("div",{style:{marginTop:8},children:[i.jsx("div",{style:{color:"#232946",fontSize:14,marginBottom:4,whiteSpace:"pre-line"},children:zl(re,K)}),i.jsxs("div",{style:{background:"linear-gradient(90deg, #f7f8fc 60%, #e3e6f3 100%)",borderRadius:12,padding:"6px 10px",margin:"6px 0",display:"flex",alignItems:"center",gap:6,boxShadow:"0 2px 8px #b6b6f622",fontSize:12},children:[i.jsxs("span",{style:{color:"#7f8fff",fontWeight:700},children:["🤖 ",qe.encouragement[K],"："]}),i.jsx("span",{style:{color:"#4b4b6b",fontWeight:500},children:_e(re)})]}),re.tag&&i.jsx("div",{style:{fontSize:12,color:"#6B5BFF",fontWeight:700,marginBottom:4},children:Lt[K][re.tag]}),re.onChain&&i.jsx("span",{style:{fontSize:12,color:"#23c6e6",fontWeight:700,marginLeft:8},children:"🔗 已封存"}),i.jsx("div",{style:{marginTop:8,fontSize:12,color:"#6B5BFF",fontWeight:500,background:"#f7f8fc",borderRadius:8,padding:"6px 10px"},children:i.jsxs("div",{children:[`${qe.profileLabels[K].split(`
`)[0].split("：")[0]}：${H&&H.nickname?H.nickname:"-"}，`,`${qe.profileLabels[K].split(`
`)[1].split("：")[0]}：${H&&H.gender?H.gender:"-"}，`,`${qe.profileLabels[K].split(`
`)[2].split("：")[0]}：${H&&H.age?H.age:"-"}，`,`${qe.profileLabels[K].split(`
`)[3].split("：")[0]}：${H&&typeof H.country=="string"&&H.country?Dl[K][H.country]||H.country:"-"}，`,`${qe.profileLabels[K].split(`
`)[4].split("：")[0]}：${H&&typeof H.interest=="string"&&H.interest?Lt&&Lt[K]&&Lt[K][H.interest]?Lt[K][H.interest]:H.interest:"-"}，`,`${qe.profileLabels[K].split(`
`)[5].split("：")[0]}：${H&&typeof H.eventType=="string"&&H.eventType?Nl[K][H.eventType]||H.eventType:"-"}`]})})]})]},re.id)}):Se?m.filter(re=>re.author===(d==null?void 0:d.displayName)).map(re=>{var Ue;const H=me[re.authorEmail]||{};return i.jsxs("div",{style:{background:"#fff",borderRadius:14,boxShadow:"0 2px 8px #b6b6f622",padding:14,marginBottom:14,position:"relative"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10},children:[i.jsx("div",{className:`w-6 h-6 rounded-full flex items-center justify-center text-white font-extrabold text-sm border-2 border-[#ececff] shadow ${tk(re.author)}`,children:((Ue=re.author)==null?void 0:Ue[0])||"A"}),i.jsx("div",{style:{fontWeight:700,color:"#6B5BFF",fontSize:14,cursor:"pointer"},onClick:ue=>{ue.stopPropagation(),G(D===re.id?null:re.id)},children:Fl(re,K)}),i.jsx("button",{onClick:()=>Fe(re.id),style:{marginLeft:"auto",background:"#ff6b6b",color:"#fff",border:"none",borderRadius:6,padding:"2px 8px",fontWeight:700,cursor:"pointer",fontSize:12},children:"刪除"})]}),D===re.id&&i.jsxs("div",{style:{marginTop:8},children:[i.jsx("div",{style:{color:"#232946",fontSize:14,marginBottom:4},children:zl(re,K)}),i.jsxs("div",{style:{background:"linear-gradient(90deg, #f7f8fc 60%, #e3e6f3 100%)",borderRadius:12,padding:"6px 10px",margin:"6px 0",display:"flex",alignItems:"center",gap:6,boxShadow:"0 2px 8px #b6b6f622",fontSize:12},children:[i.jsxs("span",{style:{color:"#7f8fff",fontWeight:700},children:["🤖 ",qe.encouragement[K],"："]}),i.jsx("span",{style:{color:"#4b4b6b",fontWeight:500},children:_e(re)})]}),re.tag&&i.jsx("div",{style:{fontSize:12,color:"#6B5BFF",fontWeight:700,marginBottom:4},children:Lt[K][re.tag]}),re.onChain&&i.jsx("span",{style:{fontSize:12,color:"#23c6e6",fontWeight:700,marginLeft:8},children:"🔗 已封存"}),i.jsx("div",{style:{marginTop:8,fontSize:12,color:"#6B5BFF",fontWeight:500,background:"#f7f8fc",borderRadius:8,padding:"6px 10px"},children:i.jsxs("div",{children:[`${qe.profileLabels[K].split(`
`)[0].split("：")[0]}：${H&&H.nickname?H.nickname:"-"}，`,`${qe.profileLabels[K].split(`
`)[1].split("：")[0]}：${H&&H.gender?H.gender:"-"}，`,`${qe.profileLabels[K].split(`
`)[2].split("：")[0]}：${H&&H.age?H.age:"-"}，`,`${qe.profileLabels[K].split(`
`)[3].split("：")[0]}：${H&&typeof H.country=="string"&&H.country?Dl[K][H.country]||H.country:"-"}，`,`${qe.profileLabels[K].split(`
`)[4].split("：")[0]}：${H&&typeof H.interest=="string"&&H.interest?Lt&&Lt[K]&&Lt[K][H.interest]?Lt[K][H.interest]:H.interest:"-"}，`,`${qe.profileLabels[K].split(`
`)[5].split("：")[0]}：${H&&typeof H.eventType=="string"&&H.eventType?Nl[K][H.eventType]||H.eventType:"-"}`]})})]})]},re.id)}):m.filter(re=>re.visibility==="public").map(re=>{const H=me[re.authorEmail]||{};return i.jsxs("div",{style:{background:"#fff",borderRadius:14,boxShadow:"0 2px 8px #b6b6f622",padding:14,marginBottom:14,cursor:"pointer"},children:[i.jsx("div",{style:{fontWeight:700,color:"#6B5BFF",fontSize:16,marginBottom:4},onClick:Ue=>{Ue.stopPropagation(),G(D===re.id?null:re.id)},children:Fl(re,K)}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:4,fontSize:"12px",flexWrap:"nowrap",whiteSpace:"nowrap"},children:[i.jsx("img",{src:H.avatar||H.avatarUrl||"/avatars/Derxl.png",alt:"avatar",style:{width:24,height:24,borderRadius:"50%",objectFit:"cover",border:"2px solid #ececff"}}),i.jsx("span",{style:{fontWeight:600},children:H&&H.nickname?H.nickname:"-"}),i.jsxs("span",{children:["，",H&&H.age?H.age:"-"]}),i.jsxs("span",{children:["，",H&&H.gender?H.gender:"-"]})]}),D===re.id&&i.jsxs("div",{style:{marginTop:8},children:[i.jsx("div",{style:{color:"#232946",fontSize:14,marginBottom:4,whiteSpace:"pre-line"},children:zl(re,K)}),i.jsxs("div",{style:{background:"linear-gradient(90deg, #f7f8fc 60%, #e3e6f3 100%)",borderRadius:12,padding:"6px 10px",margin:"6px 0",display:"flex",alignItems:"center",gap:6,boxShadow:"0 2px 8px #b6b6f622",fontSize:12},children:[i.jsxs("span",{style:{color:"#7f8fff",fontWeight:700},children:["🤖 ",qe.encouragement[K],"："]}),i.jsx("span",{style:{color:"#4b4b6b",fontWeight:500},children:_e(re)})]}),re.tag&&i.jsx("div",{style:{fontSize:12,color:"#6B5BFF",fontWeight:700,marginBottom:4},children:Lt[K][re.tag]}),re.onChain&&i.jsx("span",{style:{fontSize:12,color:"#23c6e6",fontWeight:700,marginLeft:8},children:"🔗 已封存"}),i.jsx("div",{style:{marginTop:8,fontSize:12,color:"#6B5BFF",fontWeight:500,background:"#f7f8fc",borderRadius:8,padding:"6px 10px"},children:i.jsxs("div",{children:[`${qe.profileLabels[K].split(`
`)[0].split("：")[0]}：${H&&H.nickname?H.nickname:"-"}，`,`${qe.profileLabels[K].split(`
`)[1].split("：")[0]}：${H&&H.gender?H.gender:"-"}，`,`${qe.profileLabels[K].split(`
`)[2].split("：")[0]}：${H&&H.age?H.age:"-"}，`,`${qe.profileLabels[K].split(`
`)[3].split("：")[0]}：${H&&typeof H.country=="string"&&H.country?Dl[K][H.country]||H.country:"-"}，`,`${qe.profileLabels[K].split(`
`)[4].split("：")[0]}：${H&&typeof H.interest=="string"&&H.interest?Lt&&Lt[K]&&Lt[K][H.interest]?Lt[K][H.interest]:H.interest:"-"}，`,`${qe.profileLabels[K].split(`
`)[5].split("：")[0]}：${H&&typeof H.eventType=="string"&&H.eventType?Nl[K][H.eventType]||H.eventType:"-"}`]})})]})]},re.id)})})]}),i.jsx("div",{style:{width:"100%",margin:"0 auto",marginTop:24,background:"rgba(255,255,255,0.95)",borderRadius:16,padding:"16px",boxShadow:"0 2px 12px #6B5BFF22"},children:i.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:20,flexWrap:"wrap"},children:[i.jsx("a",{href:"/privacy-policy",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12},children:"隱私權政策"}),i.jsx("a",{href:"/terms",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12},children:"條款/聲明"}),i.jsx("a",{href:"/data-deletion",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12},children:"資料刪除說明"}),i.jsx("a",{href:"/about",style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12},children:"🧬 Restarter™｜我們是誰"}),i.jsx("a",{href:"/feedback",style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12},children:"💬 意見箱｜我們想聽你說"})]})})]}):i.jsxs(i.Fragment,{children:[i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundImage:"url(/skytree.png)",backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat",zIndex:-1}}),i.jsxs("div",{style:{position:"absolute",top:0,left:0,right:0,zIndex:100,display:"flex",justifyContent:"space-between",alignItems:"center",padding:"18px 32px"},children:[i.jsx("button",{onClick:()=>t("/"),style:{fontWeight:700,fontSize:18,padding:"6px 16px",borderRadius:8,border:"1.5px solid #6B5BFF",background:"#fff",color:"#6B5BFF",cursor:"pointer"},children:qe.back[K]}),i.jsx("div",{style:{display:"flex",alignItems:"center",gap:16},children:i.jsxs("span",{style:{fontSize:"2rem",fontWeight:900,color:"#6B5BFF"},children:["📖 ",qe.pageTitle[K]]})}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[i.jsx("button",{onClick:async()=>{await Ir(e),localStorage.clear(),t("/")},style:{fontWeight:700,fontSize:18,padding:"6px 16px",borderRadius:8,border:"1.5px solid #6B5BFF",background:"#fff",color:"#6B5BFF",cursor:"pointer"},children:qe.logout[K]}),i.jsx(Bn,{})]})]}),i.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"100vh",padding:"80px 20px 20px 20px"},children:i.jsxs("div",{className:"modern-container",style:{width:"90%",maxWidth:1e3,display:"flex",flexDirection:"column",gap:32,background:"rgba(255, 255, 255, 0.9)",backdropFilter:"blur(10px)",borderRadius:20,padding:32,boxShadow:"0 8px 32px 0 rgba(31, 38, 135, 0.37)"},children:[i.jsxs("div",{style:{textAlign:"center",marginBottom:24},children:[i.jsx("p",{style:{fontSize:"1rem",color:"#000",fontWeight:600,margin:"0 0 8px 0",lineHeight:1.5},children:qe.storyQuoteLine1[K]}),i.jsx("p",{style:{fontSize:"1rem",color:"#000",fontWeight:600,margin:"0 0 8px 0",lineHeight:1.5},children:qe.storyQuoteLine2[K]}),i.jsx("p",{style:{fontSize:"0.9rem",color:"#888",fontWeight:500,margin:0,lineHeight:1.4},children:qe.storyQuoteLine3[K]})]}),i.jsxs("div",{style:{display:"flex",gap:32},children:[i.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",gap:24},children:[i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:16,marginBottom:16},children:[i.jsx("div",{style:{display:"flex",alignItems:"center",gap:16},children:i.jsx("div",{style:{padding:"12px 20px",background:"linear-gradient(135deg, #6B5BFF 60%, #23c6e6 100%)",color:"#fff",border:"none",borderRadius:10,fontWeight:900,fontSize:17,letterSpacing:1,textAlign:"center"},children:qe.formTitle[K]})}),i.jsx("div",{style:{fontSize:16,color:"#6B5BFF",fontWeight:600,textAlign:"center"},children:qe.storyPrompt[K]})]}),i.jsx("input",{value:x,onChange:re=>S(re.target.value),placeholder:qe.titlePlaceholder[K],style:{width:"100%",boxSizing:"border-box",padding:12,borderRadius:16,border:"1px solid #ddd",fontSize:16,marginBottom:8,color:"#232946"}}),i.jsx("textarea",{value:C,onChange:re=>_(re.target.value),rows:3,placeholder:qe.contentPlaceholder[K],style:{width:"100%",height:120,boxSizing:"border-box",padding:12,borderRadius:16,border:"1px solid #ddd",fontSize:16,marginBottom:8,color:"#232946",resize:"none"}}),i.jsxs("div",{style:{display:"flex",gap:16,alignItems:"center",marginBottom:8,fontSize:15},children:[i.jsxs("label",{style:{display:"flex",alignItems:"center",gap:2},children:[i.jsx("input",{type:"radio",name:"visibility",value:"private",checked:A==="private",onChange:()=>Be("private")})," ",qe.visibilityPrivate[K]]}),i.jsxs("label",{style:{display:"flex",alignItems:"center",gap:2},children:[i.jsx("input",{type:"radio",name:"visibility",value:"friends",checked:A==="friends",onChange:()=>Be("friends")})," ",qe.visibilityFriends[K]]}),i.jsxs("label",{style:{display:"flex",alignItems:"center",gap:2},children:[i.jsx("input",{type:"radio",name:"visibility",value:"public",checked:A==="public",onChange:()=>Be("public")})," ",qe.visibilityPublic[K]]})]}),A==="public"&&i.jsxs("div",{style:{marginBottom:8},children:[i.jsxs("label",{style:{display:"flex",alignItems:"center",fontSize:15},children:[i.jsx("input",{type:"checkbox",checked:L,onChange:re=>R(re.target.checked),style:{marginRight:4}})," ",nk[K]]}),i.jsx("div",{style:{fontSize:12,color:"#888",marginTop:4,fontStyle:"italic"},children:qe.blockchainNote[K]})]}),i.jsx("button",{onClick:Te,disabled:B,style:{padding:"12px 20px",background:"linear-gradient(135deg, #6B5BFF 60%, #23c6e6 100%)",color:"#fff",border:"none",borderRadius:10,fontWeight:900,fontSize:17,letterSpacing:1,cursor:B?"not-allowed":"pointer",opacity:B?.6:1},children:qe.formSubmit[K]})]}),i.jsxs("div",{style:{flex:2,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[i.jsxs("div",{style:{display:"flex",gap:10,marginBottom:18},children:[i.jsxs("button",{onClick:()=>{$(!0),Je(!1),we(!1),G(null)},style:{padding:"8px 18px",borderRadius:18,border:"none",background:X?"linear-gradient(90deg,#ffb86b 60%,#6B5BFF 100%)":"#eee",color:X?"#fff":"#6B5BFF",fontWeight:700,fontSize:16,cursor:"pointer"},children:["#💬",qe.partnersStories[K]]}),i.jsxs("button",{onClick:()=>{Je(!0),$(!1),we(!1),G(null)},style:{padding:"8px 18px",borderRadius:18,border:"none",background:Xe?"linear-gradient(90deg,#23c6e6 60%,#6B5BFF 100%)":"#eee",color:Xe?"#fff":"#6B5BFF",fontWeight:700,fontSize:16,cursor:"pointer"},children:["#🤝",qe.friendStories[K]]}),i.jsxs("button",{onClick:()=>{we(!0),$(!1),Je(!1),G(null)},style:{padding:"8px 18px",borderRadius:18,border:"none",background:Se?"linear-gradient(90deg,#6B5BFF 60%,#23c6e6 100%)":"#eee",color:Se?"#fff":"#6B5BFF",fontWeight:700,fontSize:16,cursor:"pointer"},children:["#📝",qe.myStories[K]]})]}),ne?i.jsxs("div",{style:{padding:"48px 0",textAlign:"center",color:"#6B5BFF",fontWeight:700,fontSize:22},children:["🤖 AI正在幫你包裝故事，請稍候",J,i.jsx("div",{style:{fontSize:15,color:"#888",marginTop:12},children:"（有時AI會偷偷加點幽默，請耐心等候...）"})]}):Xe?i.jsxs("div",{style:{width:"100%",background:"#fff",borderRadius:18,boxShadow:"0 2px 12px #6B5BFF22",padding:"18px 12px",marginBottom:18},children:[i.jsxs("div",{style:{fontWeight:700,fontSize:18,marginBottom:10,background:"linear-gradient(90deg,#23c6e6 60%,#6B5BFF 100%)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text"},children:["#🤝",qe.friendStories[K]]}),i.jsx("button",{onClick:()=>{Je(!1),$(!0),we(!1),G(null)},style:{margin:"0 0 18px 0",padding:"8px 18px",borderRadius:18,border:"none",background:"#eee",color:"#6B5BFF",fontWeight:700,fontSize:16,cursor:"pointer"},children:"返回夥伴們的故事"}),i.jsx("div",{style:{maxHeight:420,overflowY:"auto",width:"100%",paddingRight:6},children:He.length===0?i.jsxs("div",{style:{color:"#888",fontWeight:600,fontSize:16,padding:"32px 0",textAlign:"center"},children:[qe.noFriends[K],i.jsx("span",{onClick:()=>t("/friend"),style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,cursor:"pointer"},children:qe.goToPairTalk[K]})]}):m.filter(re=>re.visibility==="friends"&&He.includes(re.authorEmail)).map(re=>{const H=me[re.authorEmail]||{};return i.jsxs("div",{style:{background:"#fff",borderRadius:14,boxShadow:"0 2px 8px #b6b6f622",padding:14,marginBottom:14,cursor:"pointer"},children:[i.jsx("div",{style:{fontWeight:700,color:"#6B5BFF",fontSize:18,cursor:"pointer",marginBottom:4},onClick:Ue=>{Ue.stopPropagation(),G(D===re.id?null:re.id)},children:Fl(re,K)}),i.jsx(ek,{profile:H,variant:"compact"}),D===re.id&&i.jsxs("div",{style:{marginTop:10},children:[i.jsx("div",{style:{color:"#232946",fontSize:15,marginBottom:4,whiteSpace:"pre-line"},children:zl(re,K)}),i.jsxs("div",{style:{background:"linear-gradient(90deg, #f7f8fc 60%, #e3e6f3 100%)",borderRadius:12,padding:"8px 12px",margin:"8px 0",display:"flex",alignItems:"center",gap:8,boxShadow:"0 2px 8px #b6b6f622",fontSize:14},children:[i.jsxs("span",{style:{color:"#7f8fff",fontWeight:700},children:["🤖 ",qe.encouragement[K],"："]}),i.jsx("span",{style:{color:"#4b4b6b",fontWeight:500},children:_e(re)})]}),re.tag&&i.jsx("div",{style:{fontSize:14,color:"#6B5BFF",fontWeight:700,marginBottom:4},children:Lt[K][re.tag]}),re.onChain&&i.jsx("span",{style:{fontSize:14,color:"#23c6e6",fontWeight:700,marginLeft:8},children:"🔗 已封存"}),re.visibility&&["private","friends","public"].includes(re.visibility)&&i.jsx("span",{style:{fontSize:13,color:"#888",marginLeft:8},children:sy[K][re.visibility]}),i.jsx(ek,{profile:H,variant:"detailed"})]})]},re.id)})})]}):Se?i.jsxs("div",{style:{width:"100%",background:"#fff",borderRadius:18,boxShadow:"0 2px 12px #6B5BFF22",padding:"18px 12px",marginBottom:18},children:[i.jsxs("div",{style:{fontWeight:700,fontSize:18,marginBottom:10,background:"linear-gradient(90deg,#6B5BFF 0%,#23c6e6 100%)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text"},children:["#📝",qe.myStories[K]]}),i.jsx("button",{onClick:()=>{we(!1),$(!0),Je(!1),G(null)},style:{margin:"0 0 18px 0",padding:"8px 18px",borderRadius:18,border:"none",background:"#eee",color:"#6B5BFF",fontWeight:700,fontSize:16,cursor:"pointer"},children:"返回夥伴們的故事"}),i.jsx("div",{style:{maxHeight:420,overflowY:"auto",width:"100%",paddingRight:6},children:m.filter(re=>re.author===(d==null?void 0:d.displayName)).map(re=>{var Ue;const H=me[re.authorEmail]||{};return i.jsxs("div",{style:{background:"#fff",borderRadius:14,boxShadow:"0 2px 8px #b6b6f622",padding:14,marginBottom:14,position:"relative"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10},children:[i.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-white font-extrabold text-lg border-2 border-[#ececff] shadow ${tk(re.author)}`,children:((Ue=re.author)==null?void 0:Ue[0])||"A"}),i.jsx("div",{style:{fontWeight:700,color:"#6B5BFF",fontSize:16,cursor:"pointer"},onClick:ue=>{ue.stopPropagation(),G(D===re.id?null:re.id)},children:Fl(re,K)}),i.jsx("button",{onClick:()=>Fe(re.id),style:{marginLeft:"auto",background:"#ff6b6b",color:"#fff",border:"none",borderRadius:8,padding:"4px 12px",fontWeight:700,cursor:"pointer"},children:"刪除"})]}),D===re.id&&i.jsxs("div",{style:{marginTop:10},children:[i.jsx("div",{style:{color:"#232946",fontSize:15,marginBottom:4},children:zl(re,K)}),i.jsxs("div",{style:{background:"linear-gradient(90deg, #f7f8fc 60%, #e3e6f3 100%)",borderRadius:12,padding:"8px 12px",margin:"8px 0",display:"flex",alignItems:"center",gap:8,boxShadow:"0 2px 8px #b6b6f622",fontSize:14},children:[i.jsxs("span",{style:{color:"#7f8fff",fontWeight:700},children:["🤖 ",qe.encouragement[K],"："]}),i.jsx("span",{style:{color:"#4b4b6b",fontWeight:500},children:_e(re)})]}),re.tag&&i.jsx("div",{style:{fontSize:14,color:"#6B5BFF",fontWeight:700,marginBottom:4},children:Lt[K][re.tag]}),re.onChain&&i.jsx("span",{style:{fontSize:14,color:"#23c6e6",fontWeight:700,marginLeft:8},children:"🔗 已封存"}),re.visibility&&["private","friends","public"].includes(re.visibility)&&i.jsx("span",{style:{fontSize:13,color:"#888",marginLeft:8},children:sy[K][re.visibility]}),i.jsx("div",{style:{marginTop:10,fontSize:14,color:"#6B5BFF",fontWeight:500,background:"#f7f8fc",borderRadius:8,padding:"8px 12px"},children:i.jsxs("div",{children:[`${qe.profileLabels[K].split(`
`)[0].split("：")[0]}：${H&&H.nickname?H.nickname:"-"}，`,`${qe.profileLabels[K].split(`
`)[1].split("：")[0]}：${H&&H.gender?H.gender:"-"}，`,`${qe.profileLabels[K].split(`
`)[2].split("：")[0]}：${H&&H.age?H.age:"-"}，`,`${qe.profileLabels[K].split(`
`)[3].split("：")[0]}：${H&&typeof H.country=="string"&&H.country?Dl[K][H.country]||H.country:"-"}，`,`${qe.profileLabels[K].split(`
`)[4].split("：")[0]}：${H&&typeof H.interest=="string"&&H.interest?Lt&&Lt[K]&&Lt[K][H.interest]?Lt[K][H.interest]:H.interest:"-"}，`,`${qe.profileLabels[K].split(`
`)[5].split("：")[0]}：${H&&typeof H.eventType=="string"&&H.eventType?Nl[K][H.eventType]||H.eventType:"-"}`]})})]})]},re.id)})})]}):i.jsxs("div",{style:{width:"100%",background:"#fff",borderRadius:18,boxShadow:"0 2px 12px #6B5BFF22",padding:"18px 12px",marginBottom:18},children:[i.jsxs("div",{style:{fontWeight:700,fontSize:18,marginBottom:10,background:"linear-gradient(90deg,#ffb86b 60%,#6B5BFF 100%)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text"},children:["#💬",qe.partnersStories[K]]}),i.jsx("button",{onClick:()=>{we(!0),$(!1),Je(!1),G(null)},style:{margin:"0 0 18px 0",padding:"8px 18px",borderRadius:18,border:"none",background:"#eee",color:"#6B5BFF",fontWeight:700,fontSize:16,cursor:"pointer"},children:"返回我的故事"}),i.jsx("div",{style:{maxHeight:420,overflowY:"auto",width:"100%",paddingRight:6},children:m.filter(re=>re.visibility==="public").map(re=>{const H=me[re.authorEmail]||{};return i.jsxs("div",{style:{background:"#fff",borderRadius:14,boxShadow:"0 2px 8px #b6b6f622",padding:14,marginBottom:14,cursor:"pointer"},children:[i.jsx("div",{style:{fontWeight:700,color:"#6B5BFF",fontSize:18,cursor:"pointer",marginBottom:4},onClick:Ue=>{Ue.stopPropagation(),G(D===re.id?null:re.id)},children:Fl(re,K)}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,marginBottom:2,fontSize:"14px",flexWrap:"nowrap",whiteSpace:"nowrap"},children:[i.jsx("img",{src:H.avatar||H.avatarUrl||"/avatars/Derxl.png",alt:"avatar",style:{width:36,height:36,borderRadius:"50%",objectFit:"cover",border:"2px solid #ececff"}}),i.jsx("span",{style:{fontWeight:600},children:H&&H.nickname?H.nickname:"-"}),i.jsxs("span",{children:["，",H&&H.age?H.age:"-"]}),i.jsxs("span",{children:["，",H&&H.gender?H.gender:"-"]}),i.jsxs("span",{children:["，",H&&typeof H.country=="string"&&H.country?Dl[K][H.country]||H.country:"-"]}),i.jsxs("span",{children:["，",H&&typeof H.interest=="string"&&H.interest?Lt&&Lt[K]&&Lt[K][H.interest]?Lt[K][H.interest]:H.interest:"-"]}),i.jsxs("span",{children:["，",H&&typeof H.eventType=="string"&&H.eventType?Nl[K][H.eventType]||H.eventType:"-"]})]}),D===re.id&&i.jsxs("div",{style:{marginTop:10},children:[i.jsx("div",{style:{color:"#232946",fontSize:15,marginBottom:4,whiteSpace:"pre-line"},children:zl(re,K)}),i.jsxs("div",{style:{background:"linear-gradient(90deg, #f7f8fc 60%, #e3e6f3 100%)",borderRadius:12,padding:"8px 12px",margin:"8px 0",display:"flex",alignItems:"center",gap:8,boxShadow:"0 2px 8px #b6b6f622",fontSize:14},children:[i.jsxs("span",{style:{color:"#7f8fff",fontWeight:700},children:["🤖 ",qe.encouragement[K],"："]}),i.jsx("span",{style:{color:"#4b4b6b",fontWeight:500},children:_e(re)})]}),re.tag&&i.jsx("div",{style:{fontSize:14,color:"#6B5BFF",fontWeight:700,marginBottom:4},children:Lt[K][re.tag]}),re.onChain&&i.jsx("span",{style:{fontSize:14,color:"#23c6e6",fontWeight:700,marginLeft:8},children:"🔗 已封存"}),re.visibility&&["private","friends","public"].includes(re.visibility)&&i.jsx("span",{style:{fontSize:13,color:"#888",marginLeft:8},children:sy[K][re.visibility]}),i.jsx("div",{style:{marginTop:10,fontSize:14,color:"#6B5BFF",fontWeight:500,background:"#f7f8fc",borderRadius:8,padding:"8px 12px"},children:i.jsxs("div",{children:[`${qe.profileLabels[K].split(`
`)[0].split("：")[0]}：${H&&H.nickname?H.nickname:"-"}，`,`${qe.profileLabels[K].split(`
`)[1].split("：")[0]}：${H&&H.gender?H.gender:"-"}，`,`${qe.profileLabels[K].split(`
`)[2].split("：")[0]}：${H&&H.age?H.age:"-"}，`,`${qe.profileLabels[K].split(`
`)[3].split("：")[0]}：${H&&typeof H.country=="string"&&H.country?Dl[K][H.country]||H.country:"-"}，`,`${qe.profileLabels[K].split(`
`)[4].split("：")[0]}：${H&&typeof H.interest=="string"&&H.interest?Lt&&Lt[K]&&Lt[K][H.interest]?Lt[K][H.interest]:H.interest:"-"}，`,`${qe.profileLabels[K].split(`
`)[5].split("：")[0]}：${H&&typeof H.eventType=="string"&&H.eventType?Nl[K][H.eventType]||H.eventType:"-"}`]})})]})]},re.id)})})]})]})]})]})}),i.jsx("div",{style:{width:"100%",margin:"0 auto",marginTop:24,background:"rgba(255,255,255,0.95)",borderRadius:16,padding:"16px",boxShadow:"0 2px 12px #6B5BFF22"},children:i.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:20,flexWrap:"wrap"},children:[i.jsx("a",{href:"/privacy-policy",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12},children:K==="zh-TW"?"隱私權政策":K==="zh-CN"?"隐私政策":K==="en"?"Privacy Policy":K==="ja"?"プライバシーポリシー":K==="ko"?"개인정보 처리방침":K==="th"?"นโยบายความเป็นส่วนตัว":K==="vi"?"Chính sách bảo mật":K==="ms"?"Dasar Privasi":"Consilium de Privata"}),i.jsx("a",{href:"/terms",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12},children:K==="zh-TW"?"條款/聲明":K==="zh-CN"?"条款/声明":K==="en"?"Terms/Statement":K==="ja"?"規約/声明":K==="ko"?"약관/성명":K==="th"?"ข้อกำหนด/แถลงการณ์":K==="vi"?"Điều khoản/Tuyên bố":K==="ms"?"Terma/Pernyataan":"Termini/Declaratio"}),i.jsx("a",{href:"/data-deletion",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12},children:K==="zh-TW"?"資料刪除說明":K==="zh-CN"?"数据删除说明":K==="en"?"Data Deletion":K==="ja"?"データ削除について":K==="ko"?"데이터 삭제 안내":K==="th"?"คำอธิบายการลบข้อมูล":K==="vi"?"Giải thích xóa dữ liệu":K==="ms"?"Penjelasan Penghapusan Data":"Explicatio Deletionis Datae"}),i.jsx("a",{href:"/about",style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12},children:K==="zh-TW"?"🧬 Restarter™｜我們是誰":K==="zh-CN"?"🧬 Restarter™｜我们是谁":K==="en"?"🧬 Restarter™｜Who We Are":K==="ja"?"🧬 Restarter™｜私たちについて":K==="ko"?"🧬 Restarter™｜우리는 누구인가":K==="th"?"🧬 Restarter™｜เราเป็นใคร":K==="vi"?"🧬 Restarter™｜Chúng tôi là ai":K==="ms"?"🧬 Restarter™｜Siapa Kami":"🧬 Restarter™｜Quis sumus"}),i.jsx("a",{href:"/feedback",style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12},children:K==="zh-TW"?"💬 意見箱｜我們想聽你說":K==="zh-CN"?"💬 意见箱｜我们想听你说":K==="en"?"💬 Feedback Box｜We Want to Hear From You":K==="ja"?"💬 ご意見箱｜私たちはあなたの声を聞きたい":K==="ko"?"💬 피드백｜우리는 당신의 말을 듣고 싶습니다":K==="th"?"💬 กล่องความคิดเห็น｜เราอยากได้ยินจากคุณ":K==="vi"?"💬 Hộp góp ý｜Chúng tôi muốn nghe từ bạn":K==="ms"?"💬 Kotak Maklum Balas｜Kami Ingin Mendengar Dari Anda":"💬 Arca Consilii｜Volumus Audire a Te"})]})})]})})},jI=[{id:1,name_zh:"書吏",name_en:"Scribe",icon:"📜",upgrade_cost:10},{id:2,name_zh:"縣丞",name_en:"County Clerk",icon:"🪪",upgrade_cost:10},{id:3,name_zh:"通判",name_en:"Overseer",icon:"🧾",upgrade_cost:10},{id:4,name_zh:"巡撫",name_en:"Inspector",icon:"🛡️",upgrade_cost:10},{id:5,name_zh:"尚書",name_en:"Minister",icon:"🏛️",upgrade_cost:10},{id:6,name_zh:"太保",name_en:"Imperial Counselor",icon:"📯",upgrade_cost:10},{id:7,name_zh:"宰相",name_en:"Chancellor",icon:"🏯",upgrade_cost:10},{id:8,name_zh:"皇帝",name_en:"Emperor",icon:"🏰🫅",upgrade_cost:0}];function II(n){return jI.find(e=>e.id===n)}function u3(n){return jI.find(e=>e.id===n+1)}function d3(n,e){const t=II(e);return!!t&&t.upgrade_cost>0&&n>=t.upgrade_cost}const h3=v.createContext(void 0);function p3({children:n}){const[e,t]=v.useState(parseInt(localStorage.getItem("badges")||"0",10)),[r,o]=v.useState(parseInt(localStorage.getItem("rankId")||"1",10)),[a,c]=v.useState(!1);function d(){let g=e+1,x=r,S=!1;return d3(g,r)&&(x=r+1,g=0,S=!0,c(!0),setTimeout(()=>c(!1),3e3)),t(g),o(x),localStorage.setItem("badges",String(g)),localStorage.setItem("rankId",String(x)),S}const h=II(r),m=u3(r);return i.jsx(h3.Provider,{value:{badges:e,rankId:r,rank:h,nextRank:m,promotion:a,addBadge:d,setBadges:t,setRankId:o},children:n})}const f3=v.createContext(null);function m3({children:n}){const e=v.useRef(null);return v.useEffect(()=>(e.current=new WebSocket("wss://restarter-backend-6e9s.onrender.com"),()=>{var t;return(t=e.current)==null?void 0:t.close()}),[]),i.jsx(f3.Provider,{value:e.current,children:n})}const Ln={backToHome:{"zh-TW":"← 返回","zh-CN":"← 返回",ja:"← 戻る",en:"← Back",ko:"← 뒤로",th:"← กลับ",vi:"← Quay lại",ms:"← Kembali",la:"← Redire"},logout:{"zh-TW":"登出","zh-CN":"登出",ja:"ログアウト",en:"Logout",ko:"로그아웃",th:"ออกจากระบบ",vi:"Đăng xuất",ms:"Log keluar",la:"Exire"},pageTitle:{"zh-TW":"心情解鎖盒","zh-CN":"心情解锁盒",ja:"気持ちアンロックボックス",en:"Mood Unlock Box",ko:"감정 언락 박스",th:"กล่องปลดล็อกอารมณ์",vi:"Hộp Mở Khóa Cảm Xúc",ms:"Kotak Buka Kunci Emosi",la:"Arca Unlock Affectus"},subtitle:{"zh-TW":"每天自我反思，抒發心情，追蹤情緒，照顧自己","zh-CN":"每天自我反思，抒發心情，追蹤情緒，照顧自己",ja:"毎日自分を見つめ、気持ちを表現し、感情を追いかけ、自分を大切に",en:"Daily self-reflection, express your feelings, track emotions, take care of yourself",ko:"매일 자기 성찰, 감정 표현, 감정 추적, 자신을 돌보기",th:"สะท้อนตนเองทุกวัน ระบายความรู้สึก ติดตามอารมณ์ ดูแลตัวเอง",vi:"Tự phản ánh mỗi ngày, bày tỏ cảm xúc, theo dõi cảm xúc, chăm sóc bản thân",ms:"Refleksi diri setiap hari, luahkan perasaan, jejak emosi, jaga diri",la:"Cotidie te ipsum considera, affectus exprime, motus tuos persequere, te ipsum cura"},inputPlaceholder:{"zh-TW":"請寫下你的心情...(30字內)","zh-CN":"请写下你的心情...(30字内)",en:"Write your mood... (max 30 chars)",ja:"あなたの気持ちを書いてください...(30文字以内)",ko:"당신의 기분을 적어주세요...(30자 이내)",th:"เขียนความรู้สึกของคุณ...(ไม่เกิน 30 ตัวอักษร)",vi:"Hãy viết tâm trạng của bạn...(tối đa 30 ký tự)",ms:"Tulis perasaan anda...(maksimum 30 aksara)",la:"Animum tuum scribe...(max 30 litterae)"},plantButton:{"zh-TW":"記錄此刻心情","zh-CN":"记录此刻心情",ja:"今の気持ちを記録する",en:"Record Today's Mood",ko:"오늘의 기분 기록",th:"บันทึกอารมณ์วันนี้",vi:"Ghi lại tâm trạng hôm nay",ms:"Catat Perasaan Hari Ini",la:"Inscribere hodiernum animum"},completeTitle:{"zh-TW":"🎉 恭喜你完成拼圖！🎉","zh-CN":"🎉 恭喜你完成拼图！🎉",en:"🎉 Puzzle Completed! 🎉",ja:"🎉 パズル完成！🎉",ko:"🎉 퍼즐 완성! 🎉",th:"🎉 ต่อจิ๊กซอว์สำเร็จ! 🎉",vi:"🎉 Hoàn thành ghép hình! 🎉",ms:"🎉 Teka-teki Selesai! 🎉",la:"🎉 Puzzle Perfectum! 🎉"},completeDesc:{"zh-TW":"你已經解鎖全部心情拼圖，準備好迎接下一個挑戰了嗎？","zh-CN":"你已经解锁全部心情拼图，准备好迎接下一个挑战了吗？",en:"You have unlocked all mood puzzle pieces. Ready for the next challenge?",ja:"すべての気持ちパズルを解放しました。次のチャレンジの準備はできましたか？",ko:"모든 감정 퍼즐을 해제했습니다. 다음 도전을 준비하세요!",th:"คุณได้ปลดล็อกจิ๊กซอว์อารมณ์ทั้งหมดแล้ว พร้อมสำหรับความท้าทายถัดไปหรือยัง?",vi:"Bạn đã mở khóa tất cả các mảnh ghép cảm xúc. Sẵn sàng cho thử thách tiếp theo chưa?",ms:"Anda telah membuka semua kepingan teka-teki emosi. Sedia untuk cabaran seterusnya?",la:"Omnes partes animi puzzle aperuisti. Paratus es ad provocationem sequentem?"},nextChallenge:{"zh-TW":"前往{size}x{size}新挑戰","zh-CN":"前往{size}x{size}新挑战",en:"Next {size}x{size} Challenge",ja:"{size}x{size}新しいチャレンジへ",ko:"{size}x{size} 새 도전으로",th:"ไปยังความท้าทาย {size}x{size} ถัดไป",vi:"Thử thách {size}x{size} tiếp theo",ms:"Cabaran {size}x{size} Seterusnya",la:"Ad novam provocationem {size}x{size}"},encouragement:{"zh-TW":"有時候，記錄心情，就是給自己一份溫柔的陪伴。","zh-CN":"有时候，记录心情，就是给自己一份温柔的陪伴。",en:"Sometimes, recording your feelings is a gentle way to accompany yourself.",ja:"ときどき、気持ちを記録することは自分へのやさしい寄り添いです。",ko:"가끔은 마음을 기록하는 것이 자신에게 주는 따뜻한 동행입니다.",th:"บางครั้งการบันทึกความรู้สึก คือการมอบความอ่อนโยนให้ตัวเอง",vi:"Đôi khi, ghi lại cảm xúc là cách dịu dàng để đồng hành cùng chính mình.",ms:"Kadang-kadang, mencatat perasaan adalah teman yang lembut untuk diri sendiri.",la:"Aliquando, animum inscribere est tibi ipsum leniter comitari."},toastInput:{"zh-TW":"請先輸入你的心情！","zh-CN":"请先输入你的心情！",en:"Please enter your mood first!",ja:"まず気持ちを入力してください！",ko:"먼저 기분을 입력해주세요!",th:"กรุณากรอกความรู้สึกของคุณก่อน!",vi:"Vui lòng nhập tâm trạng của bạn trước!",ms:"Sila masukkan perasaan anda dahulu!",la:"Primum animum tuum inscribe!"},invalidMood:{"zh-TW":"請輸入有意義的心情內容（不能全是數字、符號或重複字元）","zh-CN":"请输入有意义的心情内容（不能全是数字、符号或重复字符）",en:"Please enter a meaningful mood (not just numbers, symbols, or repeated characters)",ja:"意味のある気持ちを入力してください（数字や記号、同じ文字だけは不可）",ko:"의미 있는 기분을 입력해주세요(숫자, 기호, 반복문자만은 불가)",th:"กรุณากรอกความรู้สึกที่มีความหมาย (ห้ามเป็นตัวเลข สัญลักษณ์ หรืออักษรซ้ำ)",vi:"Vui lòng nhập tâm trạng có ý nghĩa (không chỉ là số, ký hiệu hoặc ký tự lặp lại)",ms:"Sila masukkan perasaan yang bermakna (bukan hanya nombor, simbol atau aksara berulang)",la:"Sententiam significantem inscribe (non solum numeri, signa aut litterae repetitae)"},completeNext:{"zh-TW":"已完成本關，請點擊前往新挑戰","zh-CN":"已完成本关，请点击前往新挑战",en:"Puzzle completed! Please proceed to the next challenge.",ja:"このステージはクリアしました。次のチャレンジへ進んでください。",ko:"이 단계는 완료되었습니다. 다음 도전으로 이동하세요.",th:"คุณผ่านด่านนี้แล้ว กรุณาไปยังความท้าทายถัดไป",vi:"Bạn đã hoàn thành màn này, hãy chuyển sang thử thách tiếp theo.",ms:"Tahap ini telah selesai. Sila ke cabaran seterusnya.",la:"Hoc gradum perfecisti. Ad provocationem sequentem procede."},finalCompleteTitle:{"zh-TW":"🎉🎉 你已經完成所有心情拼圖！ 🎉🎉","zh-CN":"🎉🎉 你已经完成所有心情拼图！ 🎉🎉",en:"🎉🎉 You have completed all mood puzzles! 🎉🎉",ja:"🎉🎉 すべての気持ちパズルを完成しました！ 🎉🎉",ko:"🎉🎉 모든 감정 퍼즐을 완성했습니다! 🎉🎉",th:"🎉🎉 คุณได้ต่อจิ๊กซอว์อารมณ์ครบทุกชิ้นแล้ว! 🎉🎉",vi:"🎉🎉 Bạn đã hoàn thành tất cả các mảnh ghép cảm xúc! 🎉🎉",ms:"🎉🎉 Anda telah melengkapkan semua teka-teki emosi! 🎉🎉",la:"🎉🎉 Omnes partes animi puzzle perfecisti! 🎉🎉"},finalCompleteDesc:{"zh-TW":"你已經解鎖所有拼圖碎片，這是屬於你的堅持與成就！請繼續相信自己，未來每一天都值得被記錄與慶祝！","zh-CN":"你已经解锁所有拼图碎片，这是属于你的坚持与成就！请继续相信自己，未来每一天都值得被记录与庆祝！",en:"You have unlocked every puzzle piece. This is your perseverance and achievement! Keep believing in yourself—every day ahead is worth celebrating!",ja:"すべてのピースをアンロックしました。これはあなたの努力と成果です！これからも自分を信じて、毎日を大切にしてください！",ko:"모든 퍼즐 조각을 해제했습니다. 이것은 당신의 끈기와 성취입니다! 앞으로도 자신을 믿고, 매일을 소중히 하세요!",th:"คุณได้ปลดล็อกจิ๊กซอว์ทุกชิ้นแล้ว นี่คือความพยายามและความสำเร็จของคุณ! จงเชื่อมั่นในตัวเองและเฉลิมฉลองทุกวัน!",vi:"Bạn đã mở khóa mọi mảnh ghép. Đây là sự kiên trì và thành tựu của bạn! Hãy tiếp tục tin vào bản thân và ăn mừng mỗi ngày!",ms:"Anda telah membuka semua kepingan teka-teki. Ini adalah ketabahan dan pencapaian anda! Teruskan percaya pada diri sendiri dan raikan setiap hari!",la:"Omnia fragmenta aenigmatis aperuisti. Haec est constantia et perfectio tua! Crede tibi et diem quemque celebra!"}};function g3(){var ie;const n=_t(),e=St(),{lang:t,setLang:r}=Mt(),[o,a]=v.useState(""),[c,d]=v.useState(!1),[h,m]=v.useState([]),g=((ie=e.currentUser)==null?void 0:ie.uid)||"",[x,S]=v.useState(!1),[C,_]=v.useState(""),I=new Date().toISOString().slice(0,10);v.useEffect(()=>{g&&fetch(`/api/mood?userId=${g}`).then(ee=>ee.json()).then(ee=>m(ee))},[g]);const[T,F]=En.useState(()=>{const ee=localStorage.getItem("puzzleStage");return ee?JSON.parse(ee):{size:3,unlocked:0,completed:!1,lastDate:""}});En.useEffect(()=>{localStorage.setItem("puzzleStage",JSON.stringify(T))},[T]);const P=T.size||3,B=P+1,te=`/puzzle${P-2}.png`,W=P,L=W*W;function R(ee){return Array.from({length:L},(Se,we)=>we<ee)}function A(){const ee={size:B,unlocked:0,completed:!1,lastDate:new Date().toISOString().slice(0,10)};F(ee),m([]),$(null)}const N=async()=>{if(!g){_("請先登入才能解鎖拼圖"),S(!0),setTimeout(()=>S(!1),2e3);return}let ee=!1;if(Array.isArray(h)){for(const Ne of h)if(Ne&&Array.isArray(Ne.petals)&&Ne.petals.some(Ye=>typeof Ye.date=="string"&&Ye.date.slice(0,10)===I)){ee=!0;break}}if(ee){_("一天解鎖一片拼圖夠啦，明天再來😊"),S(!0),setTimeout(()=>S(!1),2e3);return}if(ne){_(Ln.completeNext[t]),S(!0),setTimeout(()=>S(!1),2e3);return}if(!o){_(Ln.toastInput[t]),S(!0),setTimeout(()=>S(!1),2e3);return}const Se=o.replace(/\s/g,"");if(/^\d+$/.test(Se)){_(Ln.invalidMood[t]),S(!0),setTimeout(()=>S(!1),2e3);return}if(/^[\p{P}\p{S}]+$/u.test(Se)){_(Ln.invalidMood[t]),S(!0),setTimeout(()=>S(!1),2e3);return}if(Se.length>=4&&/^(.)\1+$/.test(Se)){_(Ln.invalidMood[t]),S(!0),setTimeout(()=>S(!1),2e3);return}if(Se.length<4){_(Ln.invalidMood[t]),S(!0),setTimeout(()=>S(!1),2e3);return}d(!0),await fetch("/api/mood",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:g,mood:o,date:new Date().toISOString().slice(0,10)+"-"+Math.random()})}),a(""),fetch(`/api/mood?userId=${g}`).then(Ne=>Ne.json()).then(Ne=>m(Ne)),d(!1),F(Ne=>({...Ne,unlocked:Ne.unlocked+1,lastDate:new Date().toISOString().slice(0,10)}));const we=new Date,Oe=we.getDay();$({date:we.toISOString().slice(0,10),mood:D[Oe],isTodayNewPiece:!0})},O=T.unlocked,z=R(O),[j,V]=En.useState(!1),[X,$]=En.useState(null),ne=O>=L;function oe(){const ee={size:3,unlocked:0,completed:!1,lastDate:""};localStorage.setItem("puzzleStage",JSON.stringify(ee)),window.location.reload()}const J={};Array.isArray(h)&&h.forEach(ee=>{ee&&Array.isArray(ee.petals)&&ee.petals.forEach(Se=>{if(Se&&typeof Se.mood=="string"&&typeof Se.date=="string"){const we=Se.date.slice(0,10);J[we]={mood:Se.mood,date:we}}})});const Q=Object.values(J).sort((ee,Se)=>ee.date.localeCompare(Se.date));console.log("DEBUG allPetals:",Q);const D=["明天記得再來喔 🌈","每天一點點，心情拼圖就會完成！🧩","你的心情很重要，明天也來記錄吧！📝","給自己一個鼓勵，明天見！💪","一天一片，慢慢拼出美好心情！🌟","明天再來解鎖新拼圖吧！🔓","保持好心情，明天繼續加油！😊"],G={"zh-TW":"用心情解鎖拼圖","zh-CN":"用心情解锁拼图",en:"Unlock puzzles with your mood",ja:"気持ちでパズルを解こう",ko:"마음으로 퍼즐을 해제하세요",th:"ปลดล็อกจิ๊กซอว์ด้วยอารมณ์",vi:"Mở khóa ghép hình bằng cảm xúc",ms:"Buka teka-teki dengan perasaan",la:"Affectibus tuis aenigmata solve"};return i.jsxs("div",{style:{width:"100vw",position:"relative",overflowX:"hidden",background:"url('/snowmountain.png') center center / cover no-repeat fixed, linear-gradient(to bottom, #eaf6ff 0%, #f7fafc 100%)",minHeight:"0"},children:[x&&i.jsx("div",{style:{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",background:"rgba(255,255,255,0.98)",color:"#6B5BFF",fontWeight:700,fontSize:20,padding:"28px 48px",borderRadius:18,boxShadow:"0 4px 32px #6B5BFF33",zIndex:3e3,textAlign:"center",letterSpacing:1.5,transition:"opacity 0.3s"},children:C}),i.jsxs("div",{style:{width:"100%",maxWidth:700,margin:"20px auto 20px auto",padding:"16px 24px",background:"rgba(255,255,255,0.95)",borderRadius:16,boxShadow:"0 4px 20px rgba(0,0,0,0.1)",display:"flex",alignItems:"center",justifyContent:"space-between",position:"relative"},children:[i.jsx("button",{className:"topbar-btn",onClick:()=>n("/"),style:{fontWeight:700,fontSize:16,padding:"8px 16px",borderRadius:8,border:"1.5px solid #6B5BFF",background:"#fff",color:"#6B5BFF",cursor:"pointer",minWidth:80},children:Ln.backToHome[t]}),i.jsxs("h1",{style:{fontWeight:900,fontSize:18,color:"#6B5BFF",margin:0,lineHeight:1,textShadow:"0 2px 8px #6B5BFF88",textAlign:"center",flex:1},children:[i.jsx("span",{role:"img","aria-label":"mood",children:"🌱"})," ",Ln.pageTitle[t]]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[i.jsx("button",{className:"topbar-btn",onClick:async()=>{await Ir(e),localStorage.clear(),window.location.href="/"},style:{fontWeight:700,fontSize:16,padding:"8px 16px",borderRadius:8,border:"1.5px solid #6B5BFF",background:"#fff",color:"#6B5BFF",cursor:"pointer",minWidth:80},children:Ln.logout[t]}),i.jsx("div",{style:{width:80},children:i.jsx(Bn,{style:{width:"100%"}})})]})]}),i.jsxs("div",{style:{maxWidth:700,margin:"0 auto 0 auto",padding:"1.2rem 2vw 0 2vw",background:"rgba(255,255,255,0.92)",borderRadius:24,boxShadow:"0 8px 32px rgba(0,0,0,0.08)",position:"relative"},children:[i.jsx("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center",gap:12,flexWrap:"nowrap",marginBottom:8},children:i.jsx("span",{style:{fontSize:15,color:"#888",fontWeight:700,letterSpacing:1,textShadow:"0 2px 12px #6B5BFF55",whiteSpace:"nowrap"},children:G[t]||G.en})}),i.jsx("div",{style:{color:"#888",fontSize:18,marginBottom:0,textAlign:"center",fontWeight:700,letterSpacing:1,textShadow:"0 2px 12px #6B5BFF55"},children:Ln.subtitle[t]}),i.jsxs("div",{style:{width:"100%",textAlign:"center",color:"#232323",fontSize:17,fontWeight:500,margin:"0 0 10px 0",letterSpacing:.5,lineHeight:1.5,textShadow:"0 2px 8px #bbb8"},children:[Ln.encouragement[t],i.jsx("span",{role:"img","aria-label":"rainbow",children:"🌈"})]}),i.jsxs("div",{style:{display:"flex",flexDirection:"row",alignItems:"flex-end",gap:12,width:"100%",justifyContent:"center",marginBottom:8},children:[i.jsx("textarea",{value:o,onChange:ee=>a(ee.target.value),placeholder:Ln.inputPlaceholder[t],maxLength:30,rows:3,style:{width:260,minWidth:180,maxWidth:320,padding:12,borderRadius:8,border:"1.5px solid #ddd",fontSize:16,resize:"vertical",marginRight:0}}),i.jsx("button",{onClick:N,disabled:c,style:{width:140,minWidth:100,padding:"14px 0",background:c?"#ccc":"linear-gradient(135deg, #6B5BFF 60%, #23c6e6 100%)",color:"#fff",border:"none",borderRadius:10,fontWeight:900,fontSize:16,letterSpacing:1,cursor:c?"not-allowed":"pointer",transition:"all 0.2s ease",marginLeft:0,marginBottom:0},children:c?"...":Ln.plantButton[t]})]}),i.jsx("div",{style:{borderTop:"1px solid #eee",margin:"16px 0"}}),i.jsx("div",{children:i.jsxs("div",{style:{minHeight:0,background:"#f0f8ff",borderRadius:12,display:"block",color:"#aaa",position:"relative",width:"100%",maxWidth:540,overflow:"hidden",margin:"0 auto",padding:"0 0 24px 0"},children:[i.jsx("div",{style:{display:"grid",gridTemplateColumns:`repeat(${W}, 1fr)`,gridTemplateRows:`repeat(${W}, 1fr)`,width:"100%",maxWidth:"100%",margin:"0 auto",aspectRatio:"1 / 1",position:"relative",zIndex:1,gap:0,background:"#fff",boxShadow:"0 2px 24px #6B5BFF22",boxSizing:"border-box"},children:z.map((ee,Se)=>{const we=Q[Se]||null,Oe=(we==null?void 0:we.mood)||"",Ne=(we==null?void 0:we.date)||"",Ye=Math.floor(Se/W),it=Se%W,me=!!we;return i.jsxs("div",{style:{width:"100%",height:"100%",aspectRatio:"1/1",overflow:"hidden",position:"relative",border:"none",boxSizing:"border-box",cursor:me?"pointer":"default",display:"flex",alignItems:"center",justifyContent:"center"},onClick:()=>{me&&$({date:Ne,mood:Oe})},children:[i.jsx("img",{src:te,alt:"puzzle",style:{width:`calc(100% * ${W})`,height:`calc(100% * ${W})`,objectFit:"cover",position:"absolute",left:`-${it*100}%`,top:`-${Ye*100}%`,filter:ee?"none":"blur(8px) grayscale(1) brightness(1.2)",opacity:ee?1:.5,transition:"filter 0.3s, opacity 0.3s"}}),!ee&&i.jsx("div",{style:{position:"absolute",inset:0,background:"rgba(255,255,255,0.7)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:32},children:"?"}),!we&&ee&&i.jsx("div",{style:{position:"absolute",inset:0,display:"flex",alignItems:"center",justifyContent:"center",fontSize:18,color:"#bbb"},children:"尚未記錄"})]},Se)})}),X&&!ne&&i.jsx("div",{style:{position:"fixed",left:0,top:0,width:"100vw",height:"100vh",zIndex:2e3,display:"flex",alignItems:"center",justifyContent:"center"},onClick:()=>$(null),children:i.jsxs("div",{style:{background:"#fff",borderRadius:16,padding:"32px 40px",boxShadow:"0 4px 32px #0008",minWidth:260,maxWidth:320,textAlign:"center",fontSize:18,fontWeight:700},children:[i.jsx("div",{style:{fontSize:16,color:"#6B5BFF",marginBottom:8},children:X.date}),i.jsx("div",{style:{fontSize:22,color:"#232946",marginBottom:8},children:X.mood}),X.isTodayNewPiece&&i.jsx("div",{style:{fontSize:15,color:"#888",marginTop:8},children:"(一天只能解鎖一片，明天再來！)"}),i.jsx("div",{style:{fontSize:14,color:"#888"},children:"（點擊空白處關閉）"})]})}),ne&&i.jsx(i.Fragment,{children:i.jsx("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",zIndex:2,pointerEvents:"auto",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",textAlign:"center",background:"rgba(255,255,255,0.0)"},children:T.size===22?i.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",width:"100%",maxWidth:"90vw",margin:"0 auto"},children:[i.jsx("div",{style:{fontSize:32,fontWeight:900,color:"#ff9800",textShadow:"0 2px 12px #fff,0 4px 24px #ff980088",letterSpacing:2,marginBottom:12,lineHeight:1.2,wordBreak:"break-word",maxWidth:"100%"},children:Ln.finalCompleteTitle[t]}),i.jsx("div",{style:{fontSize:18,fontWeight:600,color:"#6B5BFF",textShadow:"0 2px 12px #6B5BFF88",letterSpacing:1,lineHeight:1.5,wordBreak:"break-word",maxWidth:"100%",marginBottom:24},children:Ln.finalCompleteDesc[t]}),i.jsx("button",{onClick:oe,style:{padding:"14px 40px",background:"linear-gradient(135deg,#6B5BFF 60%,#23c6e6 100%)",color:"#fff",border:"none",borderRadius:16,fontWeight:900,fontSize:22,boxShadow:"0 2px 12px #6B5BFF44",cursor:"pointer",letterSpacing:2,transition:"transform 0.2s",outline:"none",display:"block"},children:"再來一次"})]}):i.jsxs(i.Fragment,{children:[i.jsx("div",{style:{position:"relative",fontSize:24,fontWeight:900,color:"#ff9800",textShadow:"0 2px 12px #fff,0 4px 24px #ff980088",transform:"scale(0.7)",opacity:1,animation:"flyIn1 0.5s 0.1s cubic-bezier(.68,-0.55,.27,1.55) forwards"},children:Ln.completeTitle[t]}),i.jsx("div",{style:{position:"relative",fontSize:20,fontWeight:700,color:"#6B5BFF",marginTop:18,opacity:0,animation:"flyIn2 0.5s 0.6s cubic-bezier(.68,-0.55,.27,1.55) forwards"},children:Ln.completeDesc[t]}),i.jsx("div",{style:{position:"relative",marginTop:32,opacity:0,animation:"flyIn3 0.5s 1.1s cubic-bezier(.68,-0.55,.27,1.55) forwards"},children:i.jsx("button",{type:"button",onClick:A,style:{padding:"18px 48px",background:"linear-gradient(135deg,#6B5BFF 60%,#23c6e6 100%)",color:"#fff",borderRadius:16,fontWeight:900,fontSize:24,boxShadow:"0 2px 12px #6B5BFF44",border:"none",cursor:"pointer",letterSpacing:2,transition:"transform 0.2s",outline:"none",display:"block"},children:Ln.nextChallenge[t].replace(/\{size\}/g,String(B))})}),i.jsx("style",{children:`
@keyframes flyIn1 { from { opacity:0; transform:translateY(40px) scale(0.7);} to { opacity:1; transform:translateY(0) scale(1);} }
@keyframes flyIn2 { from { opacity:0; transform:translateY(40px) scale(0.7);} to { opacity:1; transform:translateY(0) scale(1);} }
@keyframes flyIn3 { from { opacity:0; transform:translateY(40px) scale(0.7);} to { opacity:1; transform:translateY(0) scale(1);} }
`})]})})})]})})]}),i.jsx("div",{style:{width:"100%",margin:"0 auto",marginTop:24,background:"rgba(255,255,255,0.95)",borderRadius:16,padding:"16px",boxShadow:"0 2px 12px #6B5BFF22"},children:i.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:20,flexWrap:"wrap"},children:[i.jsx("a",{href:"/privacy-policy",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12},children:t==="zh-TW"?"隱私權政策":t==="zh-CN"?"隐私政策":t==="en"?"Privacy Policy":t==="ja"?"プライバシーポリシー":t==="ko"?"개인정보 처리방침":t==="th"?"นโยบายความเป็นส่วนตัว":t==="vi"?"Chính sách bảo mật":t==="ms"?"Dasar Privasi":"Consilium de Privata"}),i.jsx("a",{href:"/terms",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12},children:t==="zh-TW"?"條款/聲明":t==="zh-CN"?"条款/声明":t==="en"?"Terms/Statement":t==="ja"?"規約/声明":t==="ko"?"약관/성명":t==="th"?"ข้อกำหนด/แถลงการณ์":t==="vi"?"Điều khoản/Tuyên bố":t==="ms"?"Terma/Pernyataan":"Termini/Declaratio"}),i.jsx("a",{href:"/data-deletion",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12},children:t==="zh-TW"?"資料刪除說明":t==="zh-CN"?"数据删除说明":t==="en"?"Data Deletion":t==="ja"?"データ削除について":t==="ko"?"데이터 삭제 안내":t==="th"?"คำอธิบายการลบข้อมูล":t==="vi"?"Giải thích xóa dữ liệu":t==="ms"?"Penjelasan Penghapusan Data":"Explicatio Deletionis Datae"}),i.jsx("a",{href:"/about",style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12},children:t==="zh-TW"?"🧬 Restarter™｜我們是誰":t==="zh-CN"?"🧬 Restarter™｜我们是谁":t==="en"?"🧬 Restarter™｜Who We Are":t==="ja"?"🧬 Restarter™｜私たちについて":t==="ko"?"🧬 Restarter™｜우리는 누구인가":t==="th"?"🧬 Restarter™｜เราเป็นใคร":t==="vi"?"🧬 Restarter™｜Chúng tôi là ai":t==="ms"?"🧬 Restarter™｜Siapa Kami":"🧬 Restarter™｜Quis sumus"}),i.jsx("a",{href:"/feedback",style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12},children:t==="zh-TW"?"💬 意見箱｜我們想聽你說":t==="zh-CN"?"💬 意见箱｜我们想听你说":t==="en"?"💬 Feedback Box｜We Want to Hear From You":t==="ja"?"💬 ご意見箱｜私たちはあなたの声を聞きたい":t==="ko"?"💬 피드백｜우리는 당신의 말을 듣고 싶습니다":t==="th"?"💬 กล่องความคิดเห็น｜เราอยากได้ยินจากคุณ":t==="vi"?"💬 Hộp góp ý｜Chúng tôi muốn nghe từ bạn":t==="ms"?"💬 Kotak Maklum Balas｜Kami Ingin Mendengar Dari Anda":"💬 Arca Consilii｜Volumus Audire a Te"})]})})]})}const y3="wss://restarter-backend-6e9s.onrender.com",x3=({roomId:n})=>{const e=v.useRef(null),t=v.useRef(null),[r,o]=v.useState(!1),[a,c]=v.useState(null),[d,h]=v.useState(null),[m,g]=v.useState(n||""),[x,S]=v.useState(n||""),[C,_]=v.useState(""),{checkPermission:I,recordUsage:T}=Ls(),[F,P]=v.useState(!1),[B,q]=v.useState(null),{isTestMode:te}=$i();v.useEffect(()=>{n&&!r&&(S(n),L(n))},[n]);const W=async()=>{const X=await I("aiChat");return X.allowed?!0:te?void 0:(X.canRenew,q(X),P(!0),!1)},L=async X=>{if(!await W())return;g(X),R();const ne=A(),oe=await navigator.mediaDevices.getUserMedia({video:!0,audio:!0});oe.getTracks().forEach(J=>ne.addTrack(J,oe)),e.current&&(e.current.srcObject=oe),ne.onnegotiationneeded=async()=>{const J=await ne.createOffer();await ne.setLocalDescription(J),a==null||a.send(JSON.stringify({type:"offer",offer:J,room:X}))},o(!0),await T("aiChat",1)},R=()=>{if(a)return;const X=new WebSocket(y3);X.onopen=()=>console.log("WebSocket connected"),X.onmessage=async $=>{const ne=JSON.parse($.data);ne.type==="offer"?await O(ne.offer):ne.type==="answer"?await z(ne.answer):ne.type==="candidate"&&await j(ne.candidate)},X.onerror=$=>_("WebSocket 連線失敗"),c(X)},A=()=>{const X=new RTCPeerConnection({iceServers:[{urls:"stun:stun.l.google.com:19302"}]});return X.onicecandidate=$=>{$.candidate&&a&&m&&a.send(JSON.stringify({type:"candidate",candidate:$.candidate,room:m}))},X.ontrack=$=>{t.current&&(t.current.srcObject=$.streams[0])},h(X),X},N=async()=>{if(!x)return _("請輸入房間代碼");if(!await W())return;g(x),R();const $=A(),ne=await navigator.mediaDevices.getUserMedia({video:!0,audio:!0});ne.getTracks().forEach(oe=>$.addTrack(oe,ne)),e.current&&(e.current.srcObject=ne),$.onnegotiationneeded=async()=>{const oe=await $.createOffer();await $.setLocalDescription(oe),a==null||a.send(JSON.stringify({type:"offer",offer:oe,room:x}))},o(!0),await T("aiChat",1)},O=async X=>{const $=d||A();await $.setRemoteDescription(new RTCSessionDescription(X));const ne=await navigator.mediaDevices.getUserMedia({video:!0,audio:!0});ne.getTracks().forEach(J=>$.addTrack(J,ne)),e.current&&(e.current.srcObject=ne);const oe=await $.createAnswer();await $.setLocalDescription(oe),a==null||a.send(JSON.stringify({type:"answer",answer:oe,room:m})),o(!0)},z=async X=>{d&&await d.setRemoteDescription(new RTCSessionDescription(X))},j=async X=>{d&&await d.addIceCandidate(new RTCIceCandidate(X))},V=()=>{P(!1),q(null)};return i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{minHeight:480,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",background:"#f7f7fa"},children:[i.jsx("h2",{style:{color:"#6B5BFF",fontWeight:900,fontSize:24,marginBottom:18},children:"免費一對一視訊聊天"}),!r&&!n&&i.jsxs("div",{style:{marginBottom:24},children:[i.jsx("input",{value:x,onChange:X=>S(X.target.value),placeholder:"請輸入房間代碼",style:{padding:8,borderRadius:8,border:"1.5px solid #6B5BFF",marginRight:8}}),i.jsx("button",{onClick:N,style:{background:"#6B5BFF",color:"#fff",border:"none",borderRadius:8,padding:"8px 18px",fontWeight:700,fontSize:16,cursor:"pointer"},children:"加入房間"})]}),C&&i.jsx("div",{style:{color:"red",marginBottom:12},children:C}),i.jsxs("div",{style:{display:"flex",gap:24},children:[i.jsxs("div",{children:[i.jsx("div",{style:{fontWeight:700,marginBottom:8},children:"本地視訊"}),i.jsx("video",{ref:e,autoPlay:!0,playsInline:!0,muted:!0,style:{width:240,height:180,background:"#000",borderRadius:12}})]}),i.jsxs("div",{children:[i.jsx("div",{style:{fontWeight:700,marginBottom:8},children:"對方視訊"}),i.jsx("video",{ref:t,autoPlay:!0,playsInline:!0,style:{width:240,height:180,background:"#000",borderRadius:12}})]})]})]}),F&&B&&i.jsx(Ms,{isOpen:F,onClose:V,currentPlan:B.currentPlan,remainingDays:B.remainingDays,usedTokens:B.usedTokens,totalTokens:B.totalTokens})]})},fp={"zh-TW":{back:"← 返回上一頁",title:"聊天室",send:"送出",placeholder:"輸入訊息..."},"zh-CN":{back:"← 返回上一页",title:"聊天室",send:"发送",placeholder:"输入信息..."},en:{back:"← Back",title:"Chat Room",send:"Send",placeholder:"Type a message..."},ja:{back:"← 前のページへ",title:"チャットルーム",send:"送信",placeholder:"メッセージを入力..."},ko:{back:"← 이전 페이지",title:"채팅방",send:"보내기",placeholder:"메시지 입력..."},th:{back:"← กลับ",title:"ห้องแชท",send:"ส่ง",placeholder:"พิมพ์ข้อความ..."},vi:{back:"← Quay lại",title:"Phòng chat",send:"Gửi",placeholder:"Nhập tin nhắn..."},ms:{back:"← Kembali",title:"Bilik Sembang",send:"Hantar",placeholder:"Taip mesej..."},la:{back:"← Redire",title:"Cella Colloquii",send:"Mitte",placeholder:"Nuntium insere..."}};function b3({open:n,onClose:e,roomId:t}){return n?i.jsx("div",{style:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",background:"#0007",zIndex:9999,display:"flex",alignItems:"center",justifyContent:"center"},children:i.jsxs("div",{style:{background:"#fff",borderRadius:16,padding:24,boxShadow:"0 2px 16px #0003",minWidth:540,minHeight:420,position:"relative"},children:[i.jsx("button",{onClick:e,style:{position:"absolute",top:12,right:12,background:"#eee",border:"none",borderRadius:8,padding:"6px 14px",fontWeight:700,cursor:"pointer"},children:"關閉"}),i.jsx(x3,{roomId:t})]})}):null}function v3(){const[n,e]=v.useState([]),[t,r]=v.useState(null),[o,a]=v.useState([]),[c,d]=v.useState(""),{lang:h,setLang:m}=Mt(),[g,x]=v.useState(null),[S,C]=v.useState(!0),_=v.useRef(null),I=_t(),[T,F]=v.useState(!1),{isTestMode:P}=$i();v.useEffect(()=>{const W=Ns(ya,async L=>{L?(x(L),await B(L.uid)):I("/")});return()=>W()},[I]);const B=async W=>{C(!0);const L=Cn(Wt,"links"),R=hr(L,Rn("user1Id","==",W),Rn("status","==","connected")),A=hr(L,Rn("user2Id","==",W),Rn("status","==","connected")),[N,O]=await Promise.all([Mr(R),Mr(A)]),z=new Set;N.forEach(V=>z.add(V.data().user2Id)),O.forEach(V=>z.add(V.data().user1Id));const j=[];for(const V of z){const X=Vn(Wt,"profiles",V),$=await Cs(X);if($.exists()){const ne=$.data();j.push({id:V,name:ne.name||"好友",avatar:ne.avatar||"/avatars/Derxl.png",online:!!ne.online})}}if(P&&j.push({id:"test-friend-1",name:"測試好友 1",avatar:"/avatars/Annie.png",online:!0},{id:"test-friend-2",name:"測試好友 2",avatar:"/avatars/Bray.png",online:!1},{id:"test-friend-3",name:"測試好友 3",avatar:"/avatars/berlex.png",online:!0}),e(j),C(!1),P&&j.length>0){const V=j.find(X=>X.id.startsWith("test-friend-"));V&&r(V)}};v.useEffect(()=>{if(g&&t){if(C(!0),P&&t.id.startsWith("test-friend-")){const A=[{id:"test-msg-1",fromUserId:t.id,fromUserName:t.name,toUserId:g.uid,toUserName:g.displayName||"我",text:"你好！很高興認識你 😊",participants:[g.uid,t.id],createdAt:new Date(Date.now()-3e5)},{id:"test-msg-2",fromUserId:g.uid,fromUserName:g.displayName||"我",toUserId:t.id,toUserName:t.name,text:"你好！我也很高興認識你 👋",participants:[g.uid,t.id],createdAt:new Date(Date.now()-24e4)},{id:"test-msg-3",fromUserId:t.id,fromUserName:t.name,toUserId:g.uid,toUserName:g.displayName||"我",text:"今天天氣真不錯，你有什麼計劃嗎？",participants:[g.uid,t.id],createdAt:new Date(Date.now()-18e4)},{id:"test-msg-4",fromUserId:g.uid,fromUserName:g.displayName||"我",toUserId:t.id,toUserName:t.name,text:"我想去公園散步，你要一起嗎？",participants:[g.uid,t.id],createdAt:new Date(Date.now()-12e4)},{id:"test-msg-5",fromUserId:t.id,fromUserName:t.name,toUserId:g.uid,toUserName:g.displayName||"我",text:"好啊！聽起來很有趣 🌳",participants:[g.uid,t.id],createdAt:new Date(Date.now()-6e4)}];a(A),C(!1);return}const W=Cn(Wt,"messages"),L=hr(W,Rn("participants","array-contains",g.uid),Xp("createdAt","asc")),R=x0(L,A=>{const N=[];A.forEach(O=>{const z=O.data();z.participants.includes(t.id)&&N.push({...z,id:O.id})}),a(N),C(!1)});return()=>R()}},[g,t,P]),v.useEffect(()=>{var W;(W=_.current)==null||W.scrollIntoView({behavior:"smooth"})},[o]);const q=async()=>{if(!(!c.trim()||!g||!t)){if(P&&t.id.startsWith("test-friend-")){const W={id:`test-msg-${Date.now()}`,fromUserId:g.uid,fromUserName:g.displayName||"我",toUserId:t.id,toUserName:t.name,text:c,participants:[g.uid,t.id],createdAt:new Date};a(L=>[...L,W]),d("");return}try{const W={fromUserId:g.uid,fromUserName:g.displayName||"我",toUserId:t.id,toUserName:t.name,text:c,participants:[g.uid,t.id],createdAt:v0()};await ys(Cn(Wt,"messages"),W),d("")}catch{alert("發送訊息失敗")}}},te=W=>{W.key==="Enter"&&!W.shiftKey&&(W.preventDefault(),q())};return S?i.jsx("div",{style:{background:"url('/green_hut.png') center center / cover no-repeat",minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center"},children:i.jsx("div",{style:{color:"#fff",fontSize:18},children:"載入中..."})}):i.jsxs("div",{style:{background:"url('/green_hut.png') center center / cover no-repeat",minHeight:"100vh",display:(window.innerWidth<=768,"flex"),flexDirection:window.innerWidth<=768?"column":"row",alignItems:window.innerWidth<=768?"center":"flex-start",justifyContent:"center",paddingTop:window.innerWidth<=768?20:40,position:"relative"},children:[i.jsx("button",{onClick:()=>I("/friend"),style:{position:"fixed",top:24,left:24,zIndex:10001,background:"#fff",border:"1.5px solid #6B5BFF",color:"#6B5BFF",borderRadius:8,padding:"6px 18px",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:"0 2px 8px #0001"},children:"返回上一頁"}),window.innerWidth<=768?i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:20,justifyContent:"center",alignItems:"center",width:"100%",maxWidth:400,padding:"20px"},children:[P&&i.jsxs("div",{style:{background:"rgba(255,255,255,0.9)",padding:"8px 12px",borderRadius:8,fontSize:12,color:"#666",marginBottom:10},children:["測試模式：好友數量 ",n.length,"，選中好友 ",(t==null?void 0:t.name)||"無"]}),i.jsxs("div",{style:{background:"rgba(255,255,255,0.95)",borderRadius:16,padding:"24px",boxShadow:"0 8px 24px rgba(0,0,0,0.3)",width:"95%",maxWidth:320,border:"2px solid rgba(107,91,255,0.3)"},children:[i.jsx("div",{style:{fontWeight:800,fontSize:22,color:"#6B5BFF",marginBottom:16,textAlign:"center",textShadow:"0 1px 2px rgba(0,0,0,0.1)"},children:"好友列表"}),i.jsx("div",{style:{textAlign:"center",color:"#333",fontSize:16,lineHeight:1.5,fontWeight:500,marginBottom:16},children:n.length===0?P?"測試模式已啟用，但沒有測試好友":"請先加好友,才能開始聊天":"選擇好友開始聊天"}),n.length>0&&i.jsx("div",{style:{maxHeight:200,overflowY:"auto"},children:n.map(W=>i.jsxs("div",{onClick:()=>r(W),style:{display:"flex",alignItems:"center",gap:12,marginBottom:12,cursor:"pointer",padding:"8px",borderRadius:8,background:(t==null?void 0:t.id)===W.id?"rgba(107,91,255,0.1)":"transparent",border:(t==null?void 0:t.id)===W.id?"1px solid #6B5BFF":"1px solid transparent"},children:[i.jsx("img",{src:W.avatar,alt:W.name,style:{width:36,height:36,borderRadius:"50%",filter:W.online?"none":"grayscale(1)",border:(t==null?void 0:t.id)===W.id?"2px solid #6B5BFF":"2px solid #eee"}}),i.jsxs("div",{style:{flex:1},children:[i.jsxs("div",{style:{fontWeight:600,color:W.online?"#222":"#aaa",fontSize:14},children:[W.name,P&&W.id.startsWith("test-friend-")&&i.jsx("span",{style:{fontSize:"10px",background:"#ff6b6b",color:"white",padding:"2px 6px",borderRadius:"4px",marginLeft:"6px",fontWeight:"normal"},children:"測試"})]}),i.jsx("div",{style:{fontSize:11,color:W.online?"#23c6e6":"#aaa"},children:W.online?"在線":"離線"})]})]},W.id))})]}),i.jsxs("div",{style:{background:"rgba(255,255,255,0.95)",borderRadius:16,padding:"24px",boxShadow:"0 8px 24px rgba(0,0,0,0.3)",width:"95%",maxWidth:320,border:"2px solid rgba(107,91,255,0.3)"},children:[i.jsx("div",{style:{fontWeight:800,fontSize:22,color:"#6B5BFF",marginBottom:16,textAlign:"center",textShadow:"0 1px 2px rgba(0,0,0,0.1)"},children:"聊天訊息框"}),i.jsx("div",{style:{textAlign:"center",color:"#333",fontSize:16,lineHeight:1.5,fontWeight:500,marginBottom:16},children:n.length===0?P?"測試模式已啟用，請選擇測試好友開始聊天！":"還沒有朋友,去交友區加好友吧!":t?`與 ${t.name} 聊天`:"請選擇好友開始聊天"}),t&&i.jsx("div",{style:{maxHeight:150,overflowY:"auto",background:"#f7f7f7",borderRadius:8,padding:12,marginBottom:16},children:o.length===0?i.jsx("div",{style:{textAlign:"center",color:"#888",fontSize:14},children:P&&t.id.startsWith("test-friend-")?"開始測試聊天吧！":"開始聊天吧！"}):o.map((W,L)=>i.jsxs("div",{style:{textAlign:W.fromUserId===(g==null?void 0:g.uid)?"right":"left",marginBottom:8},children:[i.jsxs("span",{style:{fontWeight:600,color:W.fromUserId===(g==null?void 0:g.uid)?"#2a5d8f":"#888",fontSize:12},children:[W.fromUserName,"："]}),i.jsx("span",{style:{marginLeft:4,fontSize:12},children:W.text})]},W.id||L))}),i.jsxs("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",gap:8,minHeight:48},children:[i.jsx("input",{value:c,onChange:W=>d(W.target.value),onKeyPress:te,style:{flex:1,borderRadius:6,border:"1px solid #ccc",padding:8,fontSize:14},placeholder:P&&(t!=null&&t.id.startsWith("test-friend-"))?"輸入測試訊息...":fp[h].placeholder,disabled:n.length===0||!t}),i.jsx("button",{onClick:t?q:void 0,disabled:n.length===0||!t,style:{background:"#8ec6f7",color:"#fff",border:"none",borderRadius:6,padding:"8px 12px",fontWeight:700,fontSize:14,cursor:n.length===0||!t?"not-allowed":"pointer",opacity:n.length===0||!t?.5:1},children:P&&(t!=null&&t.id.startsWith("test-friend-"))?"測試發送":fp[h].send}),i.jsx("button",{onClick:t?()=>F(!0):void 0,disabled:n.length===0||!t,style:{background:"#6B5BFF",color:"#fff",border:"none",borderRadius:6,padding:"8px 12px",fontWeight:700,fontSize:14,cursor:n.length===0||!t?"not-allowed":"pointer",opacity:n.length===0||!t?.5:1},children:P&&(t!=null&&t.id.startsWith("test-friend-"))?"測試視訊":"視訊聊天"})]})]})]}):i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{width:220,background:"#fff",borderRadius:16,boxShadow:"0 2px 8px #0001",padding:16,marginRight:32,minHeight:600},children:[i.jsx("div",{style:{fontWeight:700,fontSize:20,marginBottom:16},children:"好友列表"}),n.length===0?i.jsx("div",{style:{color:"#888",textAlign:"center",marginTop:80,fontSize:16,fontWeight:600},children:P?i.jsxs(i.Fragment,{children:["測試模式已啟用，但沒有測試好友",i.jsx("br",{}),i.jsx("span",{style:{fontSize:32},children:"🧪"})]}):i.jsxs(i.Fragment,{children:["你暫時沒有連結朋友，再繼續加油 💪",i.jsx("br",{}),i.jsx("span",{style:{fontSize:32},children:"🦋"})]})}):n.map(W=>i.jsxs("div",{onClick:()=>r(W),style:{display:"flex",alignItems:"center",gap:12,marginBottom:16,cursor:"pointer",opacity:(t==null?void 0:t.id)===W.id?1:.7},children:[i.jsx("img",{src:W.avatar,alt:W.name,style:{width:44,height:44,borderRadius:"50%",filter:W.online?"none":"grayscale(1)",border:(t==null?void 0:t.id)===W.id?"2px solid #6B5BFF":"2px solid #eee"}}),i.jsxs("div",{children:[i.jsxs("div",{style:{fontWeight:600,color:W.online?"#222":"#aaa"},children:[W.name,P&&W.id.startsWith("test-friend-")&&i.jsx("span",{style:{fontSize:"10px",background:"#ff6b6b",color:"white",padding:"2px 6px",borderRadius:"4px",marginLeft:"6px",fontWeight:"normal"},children:"測試"})]}),i.jsx("div",{style:{fontSize:12,color:W.online?"#23c6e6":"#aaa"},children:W.online?"在線":"離線"})]})]},W.id))]}),i.jsxs("div",{style:{flex:1,maxWidth:500,background:"#fff",borderRadius:16,boxShadow:"0 2px 8px #0001",padding:32,minHeight:600,display:"flex",flexDirection:"column",position:"relative"},children:[i.jsx("div",{style:{fontWeight:700,fontSize:22,marginBottom:16,marginTop:8},children:t?P&&t.id.startsWith("test-friend-")?`與 ${t.name} 聊天 (測試模式)`:`與 ${t.name} 聊天`:n.length===0?P?"測試模式已啟用，請選擇測試好友開始聊天":"請先加好友，才能開始聊天":"請選擇好友開始聊天"}),i.jsxs("div",{style:{flex:1,overflowY:"auto",marginBottom:16,background:"#f7f7f7",borderRadius:8,padding:16,minHeight:240,maxHeight:340},children:[(!t||o.length===0)&&i.jsx("div",{style:{textAlign:"center",color:"#888",marginTop:20},children:t?P&&t.id.startsWith("test-friend-")?"開始測試聊天吧！":"開始聊天吧！":n.length===0?P?"測試模式已啟用，請選擇測試好友開始聊天！":"還沒有朋友，去交友區加好友吧！":"請先選擇好友"}),t&&o.map((W,L)=>i.jsxs("div",{style:{textAlign:W.fromUserId===(g==null?void 0:g.uid)?"right":"left",marginBottom:10},children:[i.jsxs("span",{style:{fontWeight:600,color:W.fromUserId===(g==null?void 0:g.uid)?"#2a5d8f":"#888"},children:[W.fromUserName,"："]}),i.jsx("span",{style:{marginLeft:8},children:W.text})]},W.id||L)),i.jsx("div",{ref:_})]}),i.jsxs("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",gap:8,minHeight:48,marginTop:8},children:[i.jsx("input",{value:c,onChange:W=>d(W.target.value),onKeyPress:te,style:{flex:1,borderRadius:6,border:"1px solid #ccc",padding:10,fontSize:16},placeholder:P&&(t!=null&&t.id.startsWith("test-friend-"))?"輸入測試訊息...":fp[h].placeholder,disabled:n.length===0||!t}),i.jsx("button",{onClick:t?q:void 0,disabled:n.length===0||!t,style:{background:"#8ec6f7",color:"#fff",border:"none",borderRadius:6,padding:"10px 20px",fontWeight:700,fontSize:16,cursor:n.length===0||!t?"not-allowed":"pointer",opacity:n.length===0||!t?.5:1},children:P&&(t!=null&&t.id.startsWith("test-friend-"))?"測試發送":fp[h].send}),i.jsx("button",{onClick:t?()=>F(!0):void 0,disabled:n.length===0||!t,style:{background:"#6B5BFF",color:"#fff",border:"none",borderRadius:6,padding:"10px 20px",fontWeight:700,fontSize:16,cursor:n.length===0||!t?"not-allowed":"pointer",opacity:n.length===0||!t?.5:1},children:P&&(t!=null&&t.id.startsWith("test-friend-"))?"測試視訊":"視訊聊天"})]}),i.jsx(b3,{open:T,onClose:()=>F(!1),roomId:g&&t?`${g.uid}_${t.id}`:""})]})]})]})}const uo={"zh-TW":"每個人都值得一個能「重啟」的起點。","zh-CN":"每个人都值得一个能“重启”的起点。",en:"Everyone deserves a new beginning.",ja:"誰もが「再出発」できるスタート地点を持つべきです。",ko:'모든 사람은 "다시 시작"할 수 있는 출발점이 필요합니다.',th:"ทุกคนสมควรได้รับจุดเริ่มต้นใหม่",vi:"Mỗi người đều xứng đáng có một khởi đầu mới.",ms:"Setiap orang layak mendapat permulaan semula.",la:"Omnis novum initium meretur."},w3={"zh-TW":{title:"我們是誰",subtitle:"🧬 Restarter™｜我們是誰（關於我們）",story:`${uo["zh-TW"]}
你可能來自一場重創，或正走在一條孤獨的路上。
在這個被標籤和數據主導的世界裡，我們知道——有些情緒，不是一句「加油」能解決的。

Restarter™ 是專為「曾經失去節奏的人」打造的 AI 陪伴平台。
我們不但教你怎麼變強、不單告訴你要正能量，
我們更提供一個空間,讓你可以呼吸、可以交流、可以說實話、可以重新選擇。

這裡沒有社會的審判，只有一群「曾經也痛過的人」在用技術把陪伴具體化。
透過 AI，我們讓每一次對話、每一段情緒，都有人接得住。`,quote:"「我們不是修復你，我們是來陪你重啟。」",restart:"Restarter™，是你重新定義自己的起點。",founder:"創辦者的話",founderStory:`我曾經失去自由十年。<br/>
那不是旅居、不是修行，而是被法律與命運關進去的十年。<br/>
在一間不大的房間裡，和一群同樣頂著光頭、穿著另類制服的人擠在一起，日子一開始像是一場長夢，到了後來，連夢都不做了。我以為這一生就這樣被定義了。<br/><br/>
出去那天，天空灰得刺眼。我笑著走出來，但心裡卻是空的。<br/>
社會沒有在等你，家人不知如何面對你，朋友的問候也帶著距離。<br/>
起初的很多時候，我甚至不敢正眼看便利商店的收銀員，因為<span style='color:#e4572e;font-weight:700;'>我忘了怎麼當一個「普通人」</span>。<br/><br/>
我一直想問：<br/>
<span style='color:#614425;font-weight:900;'>我還有沒有機會，重新開始？</span><br/><br/>
後來我才明白——<br/>
<span style='color:#e4572e;font-weight:900;'>不是世界不給機會，是我們被迫忘了怎麼伸手抓。</span><br/><br/>
這就是 <span style='color:#6B5BFF;font-weight:900;'>Restarter™</span> 存在的原因。<br/>
不是來修復你，不是總告訴你「要振作」，<br/>
而是給你一個空間，一個能慢慢重新建立自己的容器。<br/>
讓你在失落裡還能大聲說話，在混亂中依然有人接得住。<br/><br/>
<span style='color:#6B5BFF;font-weight:900;'>Restarter™</span>，不只是技術產品，<br/>
是我從自己生命最底部捧出來的一個火種，<br/>
我希望它能為你，也為更多人，點起一盞燈。<br/><br/>
<span style='color:#614425;font-weight:900;'>不論你是誰，經歷什麼，來自世界哪個角落，<br/>在這裡你可以大膽放下那些標籤、包裝、包袱。</span><br/>
因為我們相信——<br/>
<span style='color:#e4572e;font-weight:900;'>「破碎過的人，不僅能堅強，也能很溫柔。」</span><br/><br/>
<span style='color:#6B5BFF;font-weight:900;'>我們不是修復你，我們是來陪你重啟。</span><br/>
<div style='text-align:right;margin-top:24px;font-size:18px;color:#232946;font-weight:700;'>發起人：Ben<br/>May,21,2025</div>`},"zh-CN":{title:"我们是谁",subtitle:"🧬 Restarter™｜我们是谁（关于我们）",story:`${uo["zh-CN"]}
你可能来自一场重创，或正走在一条孤独的路上。
在这个被标签和数据主导的世界里，我们知道——有些情绪，不是一句「加油」能解决的。

Restarter™ 是专为「曾经失去节奏的人」打造的 AI 陪伴平台。
我们不教你怎么变强、不告诉你要正能量，
我们只提供一个空间，让你可以呼吸、可以说实话、可以重新选择。

这里没有社会的审判，只有一群「曾经也痛过的人」在用技术把陪伴实体化。
通过 AI，我们让每一次对话、每一段情绪，都有人接得住。`,quote:"「我们不是修复你，我们陪你重启。」",restart:"Restarter™，是你重新定义自己的起点。",founder:"创办者的话",founderStory:`我曾经失去自由十年。<br/>
那不是旅行、不是修行，而是被法律和命运关进去了十年。<br/>
在一间不大的房间里，和一群同样光头、穿着统一服装的人挤在一起，日子一开始像是一场长梦，后来连梦都不做了。我以为这一生就这样被定义了。<br/><br/>
出去那天，天空灰得刺眼。我笑着走出来，但心里却是空的。<br/>
社会没有在等你，家人不知如何面对你，朋友的问候也带着距离。<br/>
很多时候，我甚至不敢正眼看便利店的收银员，因为<span style='color:#e4572e;font-weight:700;'>我忘了怎么当一个"普通人"</span>。<br/><br/>
我一直想问：<br/>
<span style='color:#614425;font-weight:900;'>我还有没有机会，重新开始？</span><br/><br/>
后来我才明白——<br/>
<span style='color:#e4572e;font-weight:900;'>不是世界不给机会，是我们被迫忘了怎么伸手抓。</span><br/><br/>
这就是 <span style='color:#6B5BFF;font-weight:900;'>Restarter™</span> 存在的原因。<br/>
不是来修复你，不是总告诉你"要振作"，<br/>
而是给你一个空间，一个能慢慢重新建立自己的容器。<br/>
让你在失落里还能大声说话，在混乱中有人接得住。<br/><br/>
<span style='color:#6B5BFF;font-weight:900;'>Restarter™</span>，不只是技术产品，<br/>
是我从自己生命最底部捧出来的一束火种，<br/>
我希望它能为你，也为更多人，点亮一盏灯。<br/><br/>
<span style='color:#614425;font-weight:900;'>无论你是谁，经历什么，来自世界哪个角落，<br/>在这里你可以大胆放下那些伪装。</span><br/>
因为我们相信——<br/>
<span style='color:#e4572e;font-weight:900;'>"破碎过的人，不仅能坚强，也能很温柔。"</span><br/><br/>
<span style='color:#6B5BFF;font-weight:900;'>我们不是修复你，我们是来陪你重启。</span><br/>
<div style='text-align:right;margin-top:24px;font-size:18px;color:#232946;font-weight:700;'>发起人：Ben<br/>2025年5月21日</div>`},en:{title:"About Us",subtitle:"🧬 Restarter™｜Who We Are",story:`${uo.en}
You may have come from a major setback, or are walking a lonely road.
In a world dominated by labels and data, we know—some feelings can't be fixed by a simple "cheer up".

Restarter™ is an AI companion platform built for those who have lost their rhythm.
We don't teach you how to be strong, nor tell you to be positive.
We simply offer a space where you can breathe, speak your truth, and choose again.

There is no judgment here—only people who have also suffered, using technology to make companionship real.
Through AI, every conversation and every emotion is caught and cared for.`,quote:"“We are not here to fix you, we are here to restart with you.”",restart:"Restarter™ is your new beginning to redefine yourself.",founder:"Founder's Message",founderStory:`I lost my freedom for ten years.<br/>
It wasn't travel or spiritual retreat, but ten years locked away by law and fate.<br/>
In a small room, crowded with others in the same uniform, the days first felt like a long dream, then even dreams faded. I thought my life was defined forever.<br/><br/>
The day I got out, the sky was a blinding gray. I walked out smiling, but my heart was empty.<br/>
Society wasn't waiting for me, my family didn't know how to face me, and friends' greetings felt distant.<br/>
Many times, I couldn't even look a cashier in the eye, because <span style='color:#e4572e;font-weight:700;'>I'd forgotten how to be "normal"</span>.<br/><br/>
I kept asking myself:<br/>
<span style='color:#614425;font-weight:900;'>Do I still have a chance to start over?</span><br/><br/>
Later, I realized—<br/>
<span style='color:#e4572e;font-weight:900;'>It's not that the world doesn't give chances, but that we've forgotten how to reach for them.</span><br/><br/>
That's why <span style='color:#6B5BFF;font-weight:900;'>Restarter™</span> exists.<br/>
Not to fix you, not to always tell you to "cheer up,"<br/>
but to give you a space—a container to slowly rebuild yourself.<br/>
A place where you can speak up in your loss, and someone will catch you in your chaos.<br/><br/>
<span style='color:#6B5BFF;font-weight:900;'>Restarter™</span> is not just a tech product;<br/>
it's a spark I brought up from the bottom of my life.<br/>
I hope it lights a lamp for you, and for many others.<br/><br/>
<span style='color:#614425;font-weight:900;'>Whoever you are, whatever you've been through, wherever you're from—<br/>here, you can let go of all the masks.</span><br/>
Because we believe—<br/>
<span style='color:#e4572e;font-weight:900;'>"Those who have been broken can be strong, and gentle too."</span><br/><br/>
<span style='color:#6B5BFF;font-weight:900;'>We are not here to fix you, we are here to restart with you.</span><br/>
<div style='text-align:right;margin-top:24px;font-size:18px;color:#232946;font-weight:700;'>Founder: Ben<br/>May 21, 2025</div>`},ja:{title:"私たちについて",subtitle:"🧬 Restarter™｜私たちについて",story:`${uo.ja}
あなたは大きな挫折から来たかもしれないし、孤独な道を歩んでいるかもしれません。
ラベルやデータが支配するこの世界で、私たちは知っています——「頑張って」だけでは解決できない感情があることを。

Restarter™は「リズムを失った人」のためのAI伴走プラットフォームです。
強くなる方法を教えたり、ポジティブになれと言ったりはしません。
ただ、呼吸できて、本音を言えて、もう一度選び直せる空間を提供します。

ここには社会の裁きはなく、「かつて痛みを知った人たち」が技術で寄り添っています。
AIを通じて、すべての対話と感情が、誰かに受け止められます。`,quote:"「私たちはあなたを修復するのではなく、一緒に再出発します。」",restart:"Restarter™は、あなたが自分を再定義する新たなスタート地点です。",founder:"創業者の言葉",founderStory:`私は10年間、自由を失いました。<br/>
それは旅でも修行でもなく、法律と運命によって閉じ込められた10年でした。<br/>
小さな部屋で、同じ服を着た仲間たちと押し込められ、最初は長い夢のようで、やがて夢さえ見なくなりました。人生はもう決まったものだと思っていました。<br/><br/>
出所の日、空は眩しいほど灰色でした。我笑顔で外に出たけれど、心は空っぽ。<br/>
社會は待っていない、家族もどう接していいかわからない、友人の声もどこか遠い。<br/>
何度も、コンビニの店員の目を見られなかった。<span style='color:#e4572e;font-weight:700;'>「普通の人」になる方法を忘れてしまった</span>から。<br/><br/>
ずっと自問していました：<br/>
<span style='color:#614425;font-weight:900;'>もう一度やり直すチャンスはあるのか？</span><br/><br/>
やがて気づきました——<br/>
<span style='color:#e4572e;font-weight:900;'>世界がチャンスをくれないのではなく、手を伸ばす方法を忘れてしまったのだと。</span><br/><br/>
これが <span style='color:#6B5BFF;font-weight:900;'>Restarter™</span> の存在理由です。<br/>
あなたを修復するためでも、無理に「元気を出して」と言うためでもなく、<br/>
ゆっくり自分を取り戻せる場所を作りたかった。<br/>
失意の中でも声を上げられ、混乱の中でも誰かが受け止めてくれる場所を。<br/><br/>
<span style='color:#6B5BFF;font-weight:900;'>Restarter™</span> は単なる技術製品ではありません。<br/>
人生のどん底からすくい上げた火種です。<br/>
あなたや多くの人のために、灯りをともしたい。<br/><br/>
<span style='color:#614425;font-weight:900;'>あなたが誰であれ、どんな経験をしてきたとしても、<br/>ここではすべての仮面を外していい。</span><br/>
私たちは信じています——<br/>
<span style='color:#e4572e;font-weight:900;'>「壊れた人は、強くもなれるし、優しくもなれる。」</span><br/><br/>
<span style='color:#6B5BFF;font-weight:900;'>私たちはあなたを修復するのではなく、一緒に再出発します。</span><br/>
<div style='text-align:right;margin-top:24px;font-size:18px;color:#232946;font-weight:700;'>発起人：Ben<br/>2025年5月21日</div>`},ko:{title:"우리는 누구인가",subtitle:"🧬 Restarter™｜우리는 누구인가",story:`${uo.ko}
당신은 큰 시련을 겪었거나, 외로운 길을 걷고 있을지도 모릅니다.
라벨과 데이터가 지배하는 세상에서, 우리는 압니다—어떤 감정은 "힘내"라는 말로 해결되지 않는다는 것을.

Restarter™는 "한때 리듬을 잃었던 사람"을 위한 AI 동반자 플랫폼입니다.
우리는 당신에게 강해지는 법을 가르치지 않고, 긍정적이 되라고 말하지 않습니다.
우리는 단지 숨 쉴 수 있고, 진실을 말할 수 있고, 다시 선택할 수 있는 공간을 제공합니다.

여기에는 사회의 심판이 없고, "한때 아팠던 사람들"이 기술로 동행합니다.
AI를 통해 모든 대화와 감정이 누군가에게 받아들여집니다。`,quote:'"우리는 당신을 고치는 것이 아니라, 함께 다시 시작합니다."',restart:"Restarter™는 당신이 자신을 새롭게 정의하는 출발점입니다。",founder:"창업자의 말",founderStory:`저는 10년 동안 자유를 잃었습니다.<br/>
그것은 여행도, 수련도 아니었고, 법과 운명에 의해 갇혀 있던 10년이었습니다.<br/>
작은 방에서 같은 옷을 입은 사람들과 함께 지내며, 처음에는 긴 꿈을 꾸는 것 같았지만, 나중에는 꿈조차 꾸지 않게 되었습니다. 저는 제 인생이 그렇게 정의될 거라 생각했습니다.<br/><br/>
밖으로 나왔던 날, 하늘은 눈부시게 회색이었습니다. 저는 웃으며 나왔지만, 마음은 텅 비어 있었습니다.<br/>
사회는 저를 기다려주지 않았고, 가족도 저를 어떻게 대해야 할지 몰랐으며, 친구들의 인사도 어딘가 멀게 느껴졌습니다.<br/>
처음에는 편의점 계산원의 눈을 제대로 쳐다보지도 못했습니다. <span style='color:#e4572e;font-weight:700;'>"평범한 사람"이 되는 법을 잊어버렸기 때문입니다</span>.<br/><br/>
저는 계속해서 스스로에게 물었습니다:<br/>
<span style='color:#614425;font-weight:900;'>나는 다시 시작할 기회가 있을까?</span><br/><br/>
나중에야 깨달았습니다——<br/>
<span style='color:#e4572e;font-weight:900;'>세상이 기회를 주지 않는 것이 아니라, 우리가 손을 내미는 법을 잊어버린 것입니다.</span><br/><br/>
이것이 <span style='color:#6B5BFF;font-weight:900;'>Restarter™</span>가 존재하는 이유입니다.<br/>
당신을 고치기 위해서도, 항상 "힘내라"고 말하기 위해서도 아닙니다.<br/>
당신이 천천히 자신을 다시 세울 수 있는 공간, 그릇을 주고 싶었습니다.<br/>
상실 속에서도 목소리를 낼 수 있고, 혼란 속에서도 누군가가 당신을 받아줄 수 있는 곳.<br/><br/>
<span style='color:#6B5BFF;font-weight:900;'>Restarter™</span>는 단순한 기술 제품이 아닙니다.<br/>
제 인생의 가장 밑바닥에서 끌어올린 불씨입니다.<br/>
이 불씨가 당신과 더 많은 사람들에게 등불이 되길 바랍니다.<br/><br/>
<span style='color:#614425;font-weight:900;'>당신이 누구든, 어떤 경험을 했든, 어디에서 왔든,<br/>여기서는 모든 가면을 내려놓을 수 있습니다.</span><br/>
우리는 믿습니다——<br/>
<span style='color:#e4572e;font-weight:900;'>"부서진 사람도 강해질 수 있고, 아주 다정해질 수도 있습니다."</span><br/><br/>
<span style='color:#6B5BFF;font-weight:900;'>우리는 당신을 고치는 것이 아니라, 함께 다시 시작합니다.</span><br/>
<div style='text-align:right;margin-top:24px;font-size:18px;color:#232946;font-weight:700;'>발기인: Ben<br/>2025년 5월 21일</div>`},th:{title:"เราเป็นใคร",subtitle:"🧬 Restarter™｜เราเป็นใคร",story:`${uo.th}
คุณอาจมาจากความสูญเสียครั้งใหญ่ หรือกำลังเดินอยู่บนเส้นทางที่โดดเดี่ยว
ในโลกที่เต็มไปด้วยป้ายและข้อมูล เรารู้ว่าบางความรู้สึกไม่ได้แค่พูดว่า "สู้ๆ" แล้วจะดีขึ้น

Restarter™ คือแพลตฟอร์ม AI สำหรับผู้ที่เคยหลงจังหวะชีวิต
เราไม่สอนให้คุณเข้มแข็ง ไม่บอกให้คุณคิดบวก
เราแค่ให้พื้นที่ที่คุณจะได้หายใจ พูดความจริง และเลือกใหม่อีกครั้ง

ที่นี่ไม่มีการตัดสินจากสังคม มีแต่คนที่เคยเจ็บปวดมาก่อน ใช้เทคโนโลยีสร้างการอยู่ร่วมกัน
ผ่าน AI ทุกบทสนทนา ทุกอารมณ์ จะมีคนรับฟังเสมอ`,quote:"“เราไม่ได้ซ่อมคุณ เราอยู่กับคุณเพื่อเริ่มต้นใหม่”",restart:"Restarter™ คือจุดเริ่มต้นใหม่ในการนิยามตัวเองของคุณ",founder:"คำจากผู้ก่อตั้ง",founderStory:`ฉันเคยสูญเสียอิสรภาพสิบปี<br/>
ไม่ใช่การเดินทางหรือการบำเพ็ญตน แต่เป็นสิบปีที่ถูกกฎหมายและโชคชะตากักขังไว้<br/>
ในห้องเล็ก ๆ กับผู้คนที่สวมชุดเหมือนกัน วันเวลาช่วงแรกเหมือนฝันยาว ๆ สุดท้ายแม้แต่ฝันก็ไม่มี ฉันคิดว่าชีวิตคงถูกกำหนดไว้แล้ว<br/><br/>
วันที่ออกมา ท้องฟ้าสีเทาจนแสบตา ฉันยิ้มออกมาแต่ในใจว่างเปล่า<br/>
สังคมไม่ได้รอคุณ ครอบครัวไม่รู้จะรับมืออย่างไร เพื่อน ๆ ก็ทักทายด้วยความห่างเหิน<br/>
หลายครั้งฉันไม่กล้ามองตาแคชเชียร์ เพราะ<span style='color:#e4572e;font-weight:700;'>ฉันลืมไปแล้วว่าต้องเป็น "คนธรรมดา" อย่างไร</span><br/><br/>
ฉันถามตัวเองเสมอว่า:<br/>
<span style='color:#614425;font-weight:900;'>ฉันยังมีโอกาสเริ่มต้นใหม่อีกไหม?</span><br/><br/>
ต่อมาฉันจึงเข้าใจ——<br/>
<span style='color:#e4572e;font-weight:900;'>ไม่ใช่โลกที่ไม่ให้โอกาส แต่เราเองที่ลืมวิธีเอื้อมมือคว้า</span><br/><br/>
นี่คือเหตุผลที่ <span style='color:#6B5BFF;font-weight:900;'>Restarter™</span> มีอยู่<br/>
ไม่ใช่เพื่อซ่อมคุณ ไม่ใช่เพื่อบอกให้ "สู้ ๆ"<br/>
แต่เพื่อให้คุณมีพื้นที่ค่อย ๆ สร้างตัวเองขึ้นใหม่<br/>
ให้คุณได้เปล่งเสียงในความสูญเสีย และมีใครสักคนรับฟังในความสับสน<br/><br/>
<span style='color:#6B5BFF;font-weight:900;'>Restarter™</span> ไม่ใช่แค่เทคโนโลยี<br/>
แต่เป็นประกายไฟที่ฉันหยิบขึ้นมาจากก้นบึ้งของชีวิต<br/>
หวังว่าจะเป็นแสงสว่างให้คุณและอีกหลาย ๆ คน<br/><br/>
<span style='color:#614425;font-weight:900;'>ไม่ว่าคุณจะเป็นใคร ผ่านอะไรมาก็ตาม มาจากที่ไหน—<br/>ที่นี่คุณสามารถถอดหน้ากากเหล่านั้นได้อย่างกล้าหาญ</span><br/>
เพราะเราเชื่อว่า——<br/>
<span style='color:#e4572e;font-weight:900;'>"คนที่เคยแตกสลาย ไม่เพียงแต่จะแข็งแกร่ง แต่ยังอ่อนโยนได้ด้วย"</span><br/><br/>
<span style='color:#6B5BFF;font-weight:900;'>เราไม่ได้ซ่อมคุณ เราอยู่กับคุณเพื่อเริ่มต้นใหม่</span><br/>
<div style='text-align:right;margin-top:24px;font-size:18px;color:#232946;font-weight:700;'>ผู้ก่อตั้ง: Ben<br/>21 พฤษภาคม 2025</div>`},vi:{title:"Chúng tôi là ai",subtitle:"🧬 Restarter™｜Chúng tôi là ai",story:`${uo.vi}
Bạn có thể đến từ một cú sốc lớn, hoặc đang đi trên con đường cô đơn
Trong thế giới bị chi phối bởi nhãn mác và dữ liệu, chúng tôi biết—có những cảm xúc không thể giải quyết chỉ bằng một câu "Cố lên"

Restarter™ là nền tảng AI đồng hành dành cho những người từng mất nhịp sống
Chúng tôi không dạy bạn cách mạnh mẽ, không bảo bạn phải tích cực
Chúng tôi chỉ mang đến một không gian để bạn được thở, được nói thật, được chọn lại

Ở đây không có phán xét xã hội, chỉ có những người từng đau đớn dùng công nghệ để đồng hành
Thông qua AI, mọi cuộc trò chuyện, mọi cảm xúc đều có người lắng nghe`,quote:"“Chúng tôi không sửa chữa bạn, chúng tôi đồng hành cùng bạn để bắt đầu lại”",restart:"Restarter™ là điểm khởi đầu mới để bạn định nghĩa lại chính mình",founder:"Lời người sáng lập",founderStory:`Tôi đã từng mất tự do mười năm<br/>
Không phải là đi du lịch hay tu hành, mà là mười năm bị pháp luật và số phận giam giữ<br/>
Trong một căn phòng nhỏ với những người cùng mặc đồng phục, ban đầu những ngày tháng như một giấc mơ dài, sau đó ngay cả mơ cũng không còn. Tôi nghĩ đời mình đã bị định nghĩa như thế.<br/><br/>
Ngày ra ngoài, bầu trời xám xịt chói mắt. Tôi mỉm cười bước ra, nhưng trong lòng trống rỗng.<br/>
Mặt trận không chờ bạn, gia đình không biết đối diện ra sao, bạn bè hỏi thăm cũng đầy khoảng cách.<br/>
Nhiều lần tôi không dám nhìn thẳng vào mắt thu ngân, vì <span style='color:#e4572e;font-weight:700;'>tôi đã quên cách làm "người bình thường"</span>.<br/><br/>
Tôi luôn tự hỏi:<br/>
<span style='color:#614425;font-weight:900;'>Liệu tôi còn cơ hội để bắt đầu lại không?</span><br/><br/>
Sau này tôi mới hiểu——<br/>
<span style='color:#e4572e;font-weight:900;'>Không phải thế giới không cho cơ hội, mà là chúng ta quên cách với lấy nó.</span><br/><br/>
Đó là lý do <span style='color:#6B5BFF;font-weight:900;'>Restarter™</span> tồn tại<br/>
Không phải để sửa chữa bạn, không phải để luôn nói "cố lên"<br/>
mà là để cho bạn một không gian, một nơi để từ từ xây dựng lại chính mình<br/>
Để bạn có thể cất tiếng nói trong nỗi mất mát, và có người lắng nghe giữa hỗn loạn<br/><br/>
<span style='color:#6B5BFF;font-weight:900;'>Restarter™</span> không chỉ là sản phẩm công nghệ<br/>
mà là tia lửa tôi mang lên từ tận đáy cuộc đời mình<br/>
Tôi hy vọng nó sẽ thắp sáng cho bạn, và cho nhiều người khác<br/><br/>
<span style='color:#614425;font-weight:900;'>Dù bạn là ai, đã trải qua điều gì, đến từ đâu—<br/>ở đây bạn có thể mạnh dạn bỏ đi mọi lớp vỏ bọc</span><br/>
Bởi vì chúng tôi tin rằng——<br/>
<span style='color:#e4572e;font-weight:900;'>"Những người từng vỡ vụn không chỉ mạnh mẽ mà còn rất dịu dàng."</span><br/><br/>
<span style='color:#6B5BFF;font-weight:900;'>Chúng tôi không sửa chữa bạn, chúng tôi đồng hành cùng bạn để bắt đầu lại</span><br/>
<div style='text-align:right;margin-top:24px;font-size:18px;color:#232946;font-weight:700;'>Người sáng lập: Ben<br/>21/05/2025</div>`},ms:{title:"Siapa Kami",subtitle:"🧬 Restarter™｜Siapa Kami",story:`${uo.ms}
Anda mungkin datang dari kejatuhan besar, atau sedang berjalan di jalan yang sunyi
Dalam dunia yang dikuasai label dan data, kami tahu—ada perasaan yang tidak dapat diselesaikan hanya dengan "semangat"

Restarter™ ialah platform AI teman untuk mereka yang pernah kehilangan rentak hidup
Kami tidak mengajar anda menjadi kuat, tidak menyuruh anda sentiasa positif
Kami hanya menyediakan ruang untuk anda bernafas, berkata benar, dan memilih semula

Di sini tiada penghakiman masyarakat, hanya mereka yang pernah sakit menggunakan teknologi untuk menemani
Melalui AI, setiap perbualan, setiap emosi, sentiasa ada yang mendengar`,quote:"“Kami bukan untuk membaiki anda, kami bersama anda untuk bermula semula”",restart:"Restarter™ ialah permulaan baru untuk anda mentakrifkan diri sendiri",founder:"Kata Pengasas",founderStory:`Saya pernah kehilangan kebebasan selama sepuluh tahun<br/>
Bukan melancong atau bertapa, tetapi sepuluh tahun dikurung oleh undang-undang dan takdir<br/>
Dalam bilik kecil bersama mereka yang berpakaian seragam sama, initio dies ut somnium longum, postea ne somnia quidem. Putavi vitam meam ita definitam esse.<br/><br/>
Die exeundi, caelum erat oculis acerrime cinereum. Ridebam egrediens, sed cor vacuum erat.<br/>
Societas non exspectabat, familia nesciebat quomodo me exciperet, amici quoque salutationes longinquae erant.<br/>
Saepe ne oculos quidem ad tabernarii aspicere audebam, quia <span style='color:#e4572e;font-weight:700;'>oblitus sum quomodo "homo communis" essem</span>.<br/><br/>
Me semper interrogabam:<br/>
<span style='color:#614425;font-weight:900;'>Adakah saya masih berpeluang untuk bermula semula?</span><br/><br/>
Akhirnya saya faham——<br/>
<span style='color:#e4572e;font-weight:900;'>Bukan dunia tidak memberi peluang, tetapi kita yang lupa cara untuk menggapainya.</span><br/><br/>
Itulah sebabnya <span style='color:#6B5BFF;font-weight:900;'>Restarter™</span> wujud<br/>
Bukan untuk membaiki anda, bukan untuk sentiasa berkata "semangat"<br/>
tetapi untuk memberi anda ruang, satu wadah untuk perlahan-lahan membina semula diri<br/>
Agar anda boleh bersuara dalam kehilangan, dan ada yang menyambut anda dalam kekacauan<br/><br/>
<span style='color:#6B5BFF;font-weight:900;'>Restarter™</span> bukan sekadar produk teknologi<br/>
tetapi percikan api yang saya bawa dari dasar hidup saya<br/>
Saya harap ia dapat menerangi anda, dan ramai lagi<br/><br/>
<span style='color:#614425;font-weight:900;'>Siapa pun anda, apa pun yang anda lalui, dari mana pun anda datang—<br/>di sini anda boleh berani melepaskan semua topeng itu</span><br/>
Kerana kami percaya——<br/>
<span style='color:#e4572e;font-weight:900;'>"Orang yang pernah hancur bukan sahaja boleh menjadi kuat, tetapi juga sangat lembut."</span><br/><br/>
<span style='color:#6B5BFF;font-weight:900;'>Kami bukan untuk membaiki anda, kami bersama anda untuk bermula semula</span><br/>
<div style='text-align:right;margin-top:24px;font-size:18px;color:#232946;font-weight:700;'>Pengasas: Ben<br/>21 Mei 2025</div>`},la:{title:"Quis sumus",subtitle:"🧬 Restarter™｜Quis sumus",story:`${uo.la}
Forsitan ex gravi casu veneris, aut solus iter facias
In mundo titulis et notitiis imperato, scimus—sunt animi motus quos "bene age" solvere non potest

Restarter™ est suggestum AI comitans iis qui cursum vitae amiserunt
Non docemus quomodo fortis fias, nec dicimus te semper positivum esse
Praebemus tantum spatium ut respirare possis, vera loqui, iterum eligere

Hic iudicium societatis non est, sed ii qui olim doluerunt technologia utuntur ad comitatum
Per AI, omnis sermo, omnis affectus, ab aliquo auditur`,quote:"“Non te reficimus, sed tecum iterum incipimus”",restart:"Restarter™ initium novum est ad te ipsum denuo definiendum",founder:"Verba Conditoris",founderStory:`Decem annos libertatem amisi<br/>
Non iter aut meditatio erat, sed decem anni lege et fato inclusi<br/>
In cella parva cum aliis eiusdem vestis, initio dies ut somnium longum, postea ne somnia quidem. Putavi vitam meam ita definitam esse.<br/><br/>
Die exeundi, caelum erat oculis acerrime cinereum. Ridebam egrediens, sed cor vacuum erat.<br/>
Societas non exspectabat, familia nesciebat quomodo me exciperet, amici quoque salutationes longinquae erant.<br/>
Saepe ne oculos quidem ad tabernarii aspicere audebam, quia <span style='color:#e4572e;font-weight:700;'>oblitus sum quomodo "homo communis" essem</span>.<br/><br/>
Me semper interrogabam:<br/>
<span style='color:#614425;font-weight:900;'>Num adhuc mihi occasio est iterum incipere?</span><br/><br/>
Postea intellexi——<br/>
<span style='color:#e4572e;font-weight:900;'>Non est quod mundus occasiones non praebeat, sed quod obliti sumus quomodo eas arripere.</span><br/><br/>
Hoc est cur <span style='color:#6B5BFF;font-weight:900;'>Restarter™</span> existat<br/>
Non ut te reficiamus, non ut semper dicamus "bene age"<br/>
sed ut tibi spatium demus, vas in quo te paulatim reficere possis<br/>
Ut in amissione tua loqui possis, et aliquis in confusione te excipiat<br/><br/>
<span style='color:#6B5BFF;font-weight:900;'>Restarter™</span> non solum productum technologicum est<br/>
sed scintilla quam ex imis vitae meae attuli<br/>
Spero eam tibi et multis aliis lucem afferre<br/><br/>
<span style='color:#614425;font-weight:900;'>Quisquis es, quidquid expertus es, undeque venis—<br/>hic audacter omnes personas deponere potes</span><br/>
Quia credimus——<br/>
<span style='color:#e4572e;font-weight:900;'>"Qui fracti sunt, non solum fortes esse possunt, sed etiam valde mites."</span><br/><br/>
<span style='color:#6B5BFF;font-weight:900;'>Non te reficimus, sed tecum iterum incipimus</span><br/>
<div style='text-align:right;margin-top:24px;font-size:18px;color:#232946;font-weight:700;'>Conditor: Ben<br/>21 Maii 2025</div>`}},rk={"zh-TW":"← 返回首頁","zh-CN":"← 返回首页",en:"← Back to Home",ja:"← ホームへ戻る",ko:"← 홈으로 돌아가기",th:"← กลับหน้าหลัก",vi:"← Quay lại trang chủ",ms:"← Kembali ke Laman Utama",la:"← Redi ad domum"};function S3(){const[n,e]=v.useState(localStorage.getItem("lang")||"zh-TW");v.useEffect(()=>{const o=()=>e(localStorage.getItem("lang")||"zh-TW");return window.addEventListener("storage",o),()=>window.removeEventListener("storage",o)},[]),v.useEffect(()=>{const o=setInterval(()=>{const a=localStorage.getItem("lang")||"zh-TW";a!==n&&e(a)},300);return()=>clearInterval(o)},[n]);const t=w3[n],r=_t();return i.jsxs("div",{style:{minHeight:"100vh",background:"linear-gradient(135deg, #b7cfff 0%, #e0e7ff 100%)",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"flex-start",padding:"48px 0 0 0"},children:[i.jsx("button",{onClick:()=>r("/"),style:{position:"absolute",top:24,left:24,zIndex:10,background:"#fff",border:"2.5px solid #6B5BFF",color:"#6B5BFF",borderRadius:12,padding:"10px 28px",fontWeight:900,fontSize:20,cursor:"pointer",boxShadow:"0 2px 8px #0001",letterSpacing:1},children:rk[n]||rk["zh-TW"]}),i.jsxs("div",{style:{maxWidth:680,background:"#fff",borderRadius:18,boxShadow:"0 2px 16px #6B5BFF22",padding:40,marginTop:48},children:[i.jsx("h1",{style:{fontSize:36,fontWeight:900,color:"#6B5BFF",marginBottom:12},children:t.subtitle}),i.jsx("div",{style:{fontSize:20,color:"#232946",fontWeight:700,marginBottom:24,whiteSpace:"pre-line"},children:t.story}),i.jsx("div",{style:{fontSize:22,color:"#614425",fontWeight:900,margin:"24px 0 8px 0",textAlign:"center"},children:t.quote}),i.jsx("div",{style:{fontSize:18,color:"#232946",fontWeight:700,marginBottom:32,textAlign:"center"},children:t.restart}),i.jsx("h2",{style:{fontSize:22,color:"#6B5BFF",fontWeight:900,marginBottom:8},children:t.founder}),i.jsx("div",{style:{fontSize:18,color:"#232946",fontWeight:500,whiteSpace:"pre-line"},dangerouslySetInnerHTML:{__html:t.founderStory}})]}),i.jsx("div",{style:{width:"100%",margin:"0 auto",marginTop:24,background:"rgba(255,255,255,0.95)",borderRadius:16,padding:"16px",boxShadow:"0 2px 12px #6B5BFF22"},children:i.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:20,flexWrap:"wrap"},children:[i.jsx("a",{href:"/privacy-policy",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12},children:n==="zh-TW"?"隱私權政策":n==="zh-CN"?"隐私政策":n==="en"?"Privacy Policy":n==="ja"?"プライバシーポリシー":n==="ko"?"개인정보 처리방침":n==="th"?"นโยบายความเป็นส่วนตัว":n==="vi"?"Chính sách bảo mật":n==="ms"?"Dasar Privasi":"Consilium de Privata"}),i.jsx("a",{href:"/terms",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12},children:n==="zh-TW"?"條款/聲明":n==="zh-CN"?"条款/声明":n==="en"?"Terms/Statement":n==="ja"?"規約/声明":n==="ko"?"약관/성명":n==="th"?"ข้อกำหนด/แถลงการณ์":n==="vi"?"Điều khoản/Tuyên bố":n==="ms"?"Terma/Pernyataan":"Termini/Declaratio"}),i.jsx("a",{href:"/data-deletion",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12},children:n==="zh-TW"?"資料刪除說明":n==="zh-CN"?"数据删除说明":n==="en"?"Data Deletion":n==="ja"?"データ削除について":n==="ko"?"데이터 삭제 안내":n==="th"?"คำอธิบายการลบข้อมูล":n==="vi"?"Giải thích xóa dữ liệu":n==="ms"?"Penjelasan Penghapusan Data":"Explicatio Deletionis Datae"}),i.jsx("a",{href:"/about",style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12},children:n==="zh-TW"?"🧬 Restarter™｜我們是誰":n==="zh-CN"?"🧬 Restarter™｜我们是谁":n==="en"?"🧬 Restarter™｜Who We Are":n==="ja"?"🧬 Restarter™｜私たちについて":n==="ko"?"🧬 Restarter™｜우리는 누구인가":n==="th"?"🧬 Restarter™｜เราเป็นใคร":n==="vi"?"🧬 Restarter™｜Chúng tôi là ai":n==="ms"?"🧬 Restarter™｜Siapa Kami":"🧬 Restarter™｜Quis sumus"}),i.jsx("a",{href:"/feedback",style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12},children:n==="zh-TW"?"💬 意見箱｜我們想聽你說":n==="zh-CN"?"💬 意见箱｜我们想听你说":n==="en"?"💬 Feedback Box｜We Want to Hear From You":n==="ja"?"💬 ご意見箱｜私たちはあなたの声を聞きたい":n==="ko"?"💬 피드백｜우리는 당신의 말을 듣고 싶습니다":n==="th"?"💬 กล่องความคิดเห็น｜เราอยากได้ยินจากคุณ":n==="vi"?"💬 Hộp góp ý｜Chúng tôi muốn nghe từ bạn":n==="ms"?"💬 Kotak Maklum Balas｜Kami Ingin Mendengar Dari Anda":"💬 Arca Consilii｜Volumus Audire a Te"})]})})]})}const ik={"zh-TW":["💡 你希望多一個什麼功能？","💬 有沒有讓你感動，或失望的使用時刻？","🔧 你覺得哪裡還不夠順、不夠暖、不夠真？","今天我想說...","如果我能改一件事，我會..."],"zh-CN":["💡 你希望多一个什么功能？","💬 有没有让你感动，或失望的使用时刻？","🔧 你觉得哪里还不够顺、不够暖、不够真？","今天我想说...","如果我能改一件事，我会..."],en:["💡 What feature do you wish for?","💬 Any moment that moved or disappointed you?","🔧 Where could we be smoother, warmer, or more real?","Today I want to say...","If I could change one thing, I would..."],ja:["💡 どんな機能が欲しいですか？","💬 感動した、またはがっかりした瞬間はありますか？","🔧 どこがもっとスムーズで、温かく、リアルになれると思いますか？","今日はこう言いたい...","もし一つ変えられるなら、私は..."],ko:["💡 어떤 기능이 더 있었으면 하나요?","💬 감동하거나 실망했던 순간이 있나요?","🔧 어디가 더 부드럽고, 따뜻하고, 진실해질 수 있을까요?","오늘 나는 이렇게 말하고 싶어요...","만약 한 가지를 바꿀 수 있다면, 나는..."],th:["💡 คุณอยากได้ฟีเจอร์อะไรเพิ่ม?","💬 มีช่วงเวลาไหนที่คุณประทับใจหรือผิดหวังไหม?","🔧 ตรงไหนที่คุณคิดว่ายังไม่ลื่นไหล ไม่อบอุ่น หรือไม่จริงใจ?","วันนี้ฉันอยากพูดว่า...","ถ้าฉันเปลี่ยนอะไรได้สักอย่าง ฉันจะ..."],vi:["💡 Bạn muốn có thêm tính năng gì?","💬 Có khoảnh khắc nào khiến bạn cảm động hoặc thất vọng không?","🔧 Bạn nghĩ chỗ nào chưa đủ mượt, chưa đủ ấm, chưa đủ thật?","Hôm nay tôi muốn nói...","Nếu tôi có thể thay đổi một điều, tôi sẽ..."],ms:["💡 Apa ciri yang anda inginkan?","💬 Ada detik yang menyentuh atau mengecewakan anda?","🔧 Di mana yang anda rasa belum cukup lancar, hangat, atau benar?","Hari ini saya ingin berkata...","Jika saya boleh ubah satu perkara, saya akan..."],la:["💡 Quam rem novam optas?","💬 Estne momentum quod te movit aut destituit?","🔧 Ubi putas nondum satis lenem, calidum, verum esse?","Hodie dicere volo...","Si unum mutare possem, id facerem..."]},k3={"zh-TW":{title:"💬 意見箱｜我們想聽你說",submit:"送出",success:"我們聽見你了，感謝你願意說出來。",subtitle:"你的建議，可能會成為下一版的靈魂！"},"zh-CN":{title:"💬 意见箱｜我们想听你说",submit:"提交",success:"我们听见你了，感谢你愿意说出来。",subtitle:"你的建议，可能会成为下一个版本的灵魂！"},en:{title:"💬 Feedback｜We Want to Hear You",submit:"Send",success:"We hear you. Thank you for sharing your thoughts.",subtitle:"Your suggestion could be the soul of our next update!"},ja:{title:"💬 ご意見箱｜あなたの声を聞かせて",submit:"送信",success:"あなたの声が届きました。伝えてくれてありがとう。",subtitle:"あなたの提案が次のアップデートの魂になるかも！"},ko:{title:"💬 의견함｜당신의 이야기를 듣고 싶어요",submit:"보내기",success:"당신의 목소리를 들었습니다. 말해줘서 고마워요.",subtitle:"당신의 제안이 다음 업데이트의 영혼이 될 수 있어요!"},th:{title:"💬 กล่องความคิดเห็น｜เราอยากฟังคุณ",submit:"ส่ง",success:"เราได้รับข้อความของคุณแล้ว ขอบคุณที่แบ่งปันความคิดของคุณ",subtitle:"ข้อเสนอของคุณอาจเป็นหัวใจของอัปเดตถัดไป!"},vi:{title:"💬 Hộp góp ý｜Chúng tôi muốn lắng nghe bạn",submit:"Gửi",success:"Chúng tôi đã nghe bạn. Cảm ơn bạn đã chia sẻ.",subtitle:"Góp ý của bạn có thể là linh hồn của bản cập nhật tiếp theo!"},ms:{title:"💬 Kotak Maklum Balas｜Kami ingin mendengar anda",submit:"Hantar",success:"Kami telah mendengar anda. Terima kasih kerana berkongsi.",subtitle:"Cadangan anda mungkin menjadi jiwa kemas kini kami yang seterusnya!"},la:{title:"💬 Arca Consilii｜Te audire volumus",submit:"Mitte",success:"Te audivimus. Gratias quod communicasti.",subtitle:"Consilium tuum animam versionis proximæ efficere potest!"}};function T3(){const[n,e]=v.useState(localStorage.getItem("lang")||"zh-TW"),[t,r]=v.useState(""),[o,a]=v.useState(!1),[c,d]=v.useState(0),[h,m]=v.useState(!1),[g,x]=v.useState(""),S=_t(),C=St();v.useEffect(()=>{const T=()=>e(localStorage.getItem("lang")||"zh-TW");return window.addEventListener("storage",T),()=>window.removeEventListener("storage",T)},[]),v.useEffect(()=>{const T=setInterval(()=>{const F=localStorage.getItem("lang")||"zh-TW";F!==n&&e(F)},300);return()=>clearInterval(T)},[n]),En.useEffect(()=>{const T=setInterval(()=>d(F=>(F+1)%ik[n].length),3500);return()=>clearInterval(T)},[n]);const _=k3[n],I=async()=>{if(t.trim()){m(!0),x("");try{const T=C.currentUser,F=await fetch("/api/feedback",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:t.trim(),userEmail:(T==null?void 0:T.email)||"",userNickname:(T==null?void 0:T.displayName)||"匿名",userLang:n})}),P=await F.json();F.ok?(a(!0),r("")):x(P.error||"提交失敗，請稍後再試")}catch{x("網路錯誤，請稍後再試")}finally{m(!1)}}};return i.jsxs("div",{style:{minHeight:"100vh",background:"linear-gradient(135deg, #e0e7ff 0%, #b7cfff 100%)",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"flex-start",padding:"48px 0 0 0"},children:[i.jsx("button",{onClick:()=>S("/"),style:{position:"absolute",top:24,left:24,zIndex:10,background:"#fff",border:"1.5px solid #6B5BFF",color:"#6B5BFF",borderRadius:8,padding:"6px 18px",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:"0 2px 8px #0001"},children:n==="zh-TW"?"← 返回首頁":n==="zh-CN"?"← 返回首页":n==="en"?"← Back to Home":n==="ja"?"← ホームへ戻る":n==="ko"?"← 홈으로 돌아가기":n==="th"?"← กลับหน้าหลัก":n==="vi"?"← Quay lại trang chủ":n==="ms"?"← Kembali ke Laman Utama":"← Redi ad domum"}),i.jsxs("div",{style:{maxWidth:520,background:"#fff",borderRadius:18,boxShadow:"0 2px 16px #6B5BFF22",padding:40,marginTop:64,display:"flex",flexDirection:"column",alignItems:"center"},children:[i.jsx("h1",{style:{fontSize:32,fontWeight:900,color:"#6B5BFF",marginBottom:8},children:_.title}),i.jsx("div",{style:{fontSize:18,color:"#614425",fontWeight:700,marginBottom:18,textAlign:"center"},children:_.subtitle}),o?i.jsx("div",{style:{fontSize:22,color:"#614425",fontWeight:900,marginTop:32,textAlign:"center",minHeight:80},children:_.success}):i.jsxs(i.Fragment,{children:[i.jsx("textarea",{value:t,onChange:T=>r(T.target.value),placeholder:ik[n][c],style:{width:"100%",minHeight:160,fontSize:20,border:"none",outline:"none",resize:"vertical",background:"#f7f8fa",borderRadius:12,padding:18,marginBottom:18,boxShadow:"0 2px 8px #6B5BFF11"}}),g&&i.jsx("div",{style:{color:"#ff4d4f",fontSize:14,marginBottom:12,textAlign:"center"},children:g}),i.jsx("button",{onClick:I,style:{background:h?"#ccc":"#6B5BFF",color:"#fff",border:"none",borderRadius:8,padding:"12px 32px",fontWeight:900,fontSize:20,cursor:h?"not-allowed":"pointer",boxShadow:"0 2px 8px #6B5BFF33",marginTop:8},disabled:!t.trim()||h,children:h?"送出中...":_.submit})]})]}),i.jsx("div",{style:{width:"100%",margin:"0 auto",marginTop:24,background:"rgba(255,255,255,0.95)",borderRadius:16,padding:"16px",boxShadow:"0 2px 12px #6B5BFF22"},children:i.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:20,flexWrap:"wrap"},children:[i.jsx("a",{href:"/privacy-policy",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12},children:"隱私權政策"}),i.jsx("a",{href:"/terms",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12},children:"條款/聲明"}),i.jsx("a",{href:"/data-deletion",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12},children:"資料刪除說明"}),i.jsx("a",{href:"/about",style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12},children:"🧬 Restarter™｜我們是誰"}),i.jsx("a",{href:"/feedback",style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12},children:"💬 意見箱｜我們想聽你說"})]})})]})}function _3(){const[n,e]=v.useState([]),[t,r]=v.useState(!0),[o,a]=v.useState(""),[c,d]=v.useState(!1),[h,m]=v.useState(null),[g,x]=v.useState(""),[S,C]=v.useState("new"),_=_t(),I=async()=>{if(o)try{const B=await fetch(`/api/feedback?adminKey=${o}`);if(B.ok){const q=await B.json();e(q.feedbacks),d(!0)}else alert("管理員金鑰錯誤")}catch{alert("取得意見列表失敗")}finally{r(!1)}},T=async B=>{try{(await fetch(`/api/feedback/${B}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({adminKey:o,status:S,adminNotes:g})})).ok?(e(n.map(te=>te.id===B?{...te,status:S,adminNotes:g,updatedAt:Date.now()}:te)),m(null),x(""),alert("意見狀態已更新")):alert("更新失敗")}catch{alert("更新意見狀態失敗")}},F=B=>{switch(B){case"new":return"#ff4d4f";case"reviewed":return"#faad14";case"resolved":return"#52c41a";default:return"#666"}},P=B=>{switch(B){case"new":return"新意見";case"reviewed":return"已檢視";case"resolved":return"已處理";default:return"未知"}};return c?i.jsxs("div",{style:{minHeight:"100vh",background:"linear-gradient(135deg, #e0e7ff 0%, #b7cfff 100%)",padding:"20px"},children:[i.jsxs("div",{style:{maxWidth:1200,margin:"0 auto",background:"#fff",borderRadius:18,padding:30,boxShadow:"0 2px 16px #6B5BFF22"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:30},children:[i.jsx("h1",{style:{fontSize:28,fontWeight:900,color:"#6B5BFF"},children:"📝 意見箱管理"}),i.jsx("button",{onClick:()=>_("/"),style:{background:"transparent",color:"#6B5BFF",border:"2px solid #6B5BFF",borderRadius:8,padding:"8px 16px",fontSize:14,fontWeight:700,cursor:"pointer"},children:"返回首頁"})]}),t?i.jsx("div",{style:{textAlign:"center",padding:"40px"},children:"載入中..."}):i.jsxs("div",{style:{display:"grid",gap:"20px"},children:[n.map(B=>i.jsxs("div",{style:{border:"2px solid #e0e7ff",borderRadius:12,padding:"20px",background:B.status==="new"?"#fff7e6":"#fff"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"15px"},children:[i.jsxs("div",{children:[i.jsxs("div",{style:{fontWeight:700,fontSize:16,marginBottom:"8px"},children:[B.userNickname," (",B.userLang,")"]}),i.jsx("div",{style:{color:"#666",fontSize:14},children:new Date(B.timestamp).toLocaleString("zh-TW")})]}),i.jsx("div",{style:{background:F(B.status),color:"#fff",padding:"4px 12px",borderRadius:"12px",fontSize:"12px",fontWeight:700},children:P(B.status)})]}),i.jsx("div",{style:{background:"#f7f8fa",padding:"15px",borderRadius:"8px",marginBottom:"15px",whiteSpace:"pre-wrap",lineHeight:"1.6"},children:B.content}),B.adminNotes&&i.jsxs("div",{style:{background:"#e8f5e8",padding:"12px",borderRadius:"8px",marginBottom:"15px",fontSize:"14px"},children:[i.jsx("strong",{children:"管理員備註："})," ",B.adminNotes]}),i.jsx("button",{onClick:()=>m(B),style:{background:"#6B5BFF",color:"#fff",border:"none",borderRadius:"6px",padding:"8px 16px",fontSize:"14px",fontWeight:700,cursor:"pointer"},children:"更新狀態"})]},B.id)),n.length===0&&i.jsx("div",{style:{textAlign:"center",padding:"40px",color:"#666"},children:"目前沒有意見回饋"})]})]}),h&&i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:i.jsxs("div",{style:{background:"#fff",borderRadius:"12px",padding:"30px",maxWidth:"500px",width:"90%",maxHeight:"80vh",overflow:"auto"},children:[i.jsx("h3",{style:{marginBottom:"20px",color:"#6B5BFF"},children:"更新意見狀態"}),i.jsxs("div",{style:{marginBottom:"15px"},children:[i.jsx("label",{style:{display:"block",marginBottom:"5px",fontWeight:700},children:"狀態："}),i.jsxs("select",{value:S,onChange:B=>C(B.target.value),style:{width:"100%",padding:"8px 12px",border:"2px solid #e0e7ff",borderRadius:"6px",fontSize:"14px"},children:[i.jsx("option",{value:"new",children:"新意見"}),i.jsx("option",{value:"reviewed",children:"已檢視"}),i.jsx("option",{value:"resolved",children:"已處理"})]})]}),i.jsxs("div",{style:{marginBottom:"20px"},children:[i.jsx("label",{style:{display:"block",marginBottom:"5px",fontWeight:700},children:"管理員備註："}),i.jsx("textarea",{value:g,onChange:B=>x(B.target.value),placeholder:"輸入備註...",style:{width:"100%",minHeight:"100px",padding:"12px",border:"2px solid #e0e7ff",borderRadius:"6px",fontSize:"14px",resize:"vertical"}})]}),i.jsxs("div",{style:{display:"flex",gap:"10px",justifyContent:"flex-end"},children:[i.jsx("button",{onClick:()=>m(null),style:{background:"transparent",color:"#666",border:"2px solid #ddd",borderRadius:"6px",padding:"8px 16px",fontSize:"14px",fontWeight:700,cursor:"pointer"},children:"取消"}),i.jsx("button",{onClick:()=>T(h.id),style:{background:"#6B5BFF",color:"#fff",border:"none",borderRadius:"6px",padding:"8px 16px",fontSize:"14px",fontWeight:700,cursor:"pointer"},children:"更新"})]})]})})]}):i.jsx("div",{style:{minHeight:"100vh",background:"linear-gradient(135deg, #e0e7ff 0%, #b7cfff 100%)",display:"flex",alignItems:"center",justifyContent:"center",padding:"20px"},children:i.jsxs("div",{style:{background:"#fff",borderRadius:18,padding:40,boxShadow:"0 2px 16px #6B5BFF22",maxWidth:400,width:"100%"},children:[i.jsx("h1",{style:{fontSize:24,fontWeight:900,color:"#6B5BFF",marginBottom:20,textAlign:"center"},children:"🔐 管理員登入"}),i.jsx("input",{type:"password",placeholder:"請輸入管理員金鑰",value:o,onChange:B=>a(B.target.value),style:{width:"100%",padding:"12px 16px",border:"2px solid #e0e7ff",borderRadius:8,fontSize:16,marginBottom:20},onKeyPress:B=>B.key==="Enter"&&I()}),i.jsx("button",{onClick:I,style:{width:"100%",background:"#6B5BFF",color:"#fff",border:"none",borderRadius:8,padding:"12px",fontSize:16,fontWeight:700,cursor:"pointer"},children:"登入"}),i.jsx("button",{onClick:()=>_("/"),style:{width:"100%",background:"transparent",color:"#6B5BFF",border:"2px solid #6B5BFF",borderRadius:8,padding:"12px",fontSize:16,fontWeight:700,cursor:"pointer",marginTop:12},children:"返回首頁"})]})})}const j3={"zh-TW":"返回","zh-CN":"返回",en:"Back",ja:"戻る",ko:"뒤로",th:"กลับ",vi:"Quay lại",ms:"Kembali",la:"Revertere"};function I3(){const n=_t(),e=St(),t=e.currentUser,r=localStorage.getItem("lang")||"zh-TW";v.useEffect(()=>{t||n("/register",{replace:!0})},[t,n]);const[o,a]=v.useState((t==null?void 0:t.displayName)||""),[c]=v.useState((t==null?void 0:t.email)||""),[d,h]=v.useState((t==null?void 0:t.photoURL)||""),[m,g]=v.useState(""),[x,S]=v.useState(""),[C,_]=v.useState(""),[I,T]=v.useState(""),[F,P]=v.useState(""),[B,q]=v.useState(""),[te,W]=v.useState(""),[L,R]=v.useState(""),[A,N]=v.useState(!1);v.useEffect(()=>{let z=!1;const j=async()=>{z||(z=!0,await Ir(e),n("/register?needProfile=1",{replace:!0}))},V=$=>{$.preventDefault(),$.returnValue="",j()},X=$=>{var ne;(ne=$==null?void 0:$.preventDefault)==null||ne.call($),j(),window.history.pushState(null,"","/CompleteProfile")};return window.addEventListener("beforeunload",V),window.addEventListener("popstate",X),window.history.pushState(null,"","/CompleteProfile"),()=>{window.removeEventListener("beforeunload",V),window.removeEventListener("popstate",X)}},[e,n]);const O=async z=>{if(z.preventDefault(),R(""),!o||!m||!x||!I||!F||!B||!te){R("請填寫所有欄位");return}N(!0);try{await Ed(Vn(Wt,"users",t.uid),{nickname:o,email:c,avatarUrl:d,gender:m,country:x,region:C,age:I,interest:F,eventType:B,improvement:te,completed:!0,updatedAt:new Date}),N(!1),n("/",{replace:!0})}catch(j){R(j.message),N(!1)}};return v.useEffect(()=>{(async()=>{if(t!=null&&t.uid){const j=await ud(()=>Promise.resolve().then(()=>ef),void 0).then(V=>V.getDoc(V.doc(Wt,"users",t.uid)));j.exists()&&j.data().completed&&(await Ir(e),n("/register",{replace:!0}))}})()},[t,e,n]),i.jsxs("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",background:"#f7f7fa",position:"relative"},children:[i.jsxs("button",{onClick:()=>n("/register",{replace:!0}),style:{position:"absolute",top:32,left:36,zIndex:10,backgroundColor:"#374151",color:"white",fontWeight:"bold",padding:"0.5rem 1rem",borderRadius:"0.375rem",border:"none",cursor:"pointer",fontSize:16},children:["← ",j3[r]||"返回"]}),i.jsxs("form",{onSubmit:O,style:{background:"#fff",borderRadius:16,padding:32,boxShadow:"0 4px 24px #0001",width:360,position:"relative"},children:[i.jsx("button",{type:"button",onClick:async()=>{await Ir(e),n("/register?needProfile=1",{replace:!0})},style:{position:"absolute",top:16,right:16,background:"none",border:"none",fontSize:22,color:"#888",cursor:"pointer"},children:"×"}),i.jsx("h2",{style:{textAlign:"center",marginBottom:16},children:"補充個人資料"}),L&&i.jsx("div",{style:{color:"red",marginBottom:12},children:L}),i.jsxs("div",{style:{marginBottom:12},children:[i.jsx("label",{children:"暱稱："}),i.jsx("input",{value:o,onChange:z=>a(z.target.value),required:!0,style:{width:"100%"}})]}),i.jsxs("div",{style:{marginBottom:12},children:[i.jsx("label",{children:"電子郵件："}),i.jsx("input",{value:c,disabled:!0,style:{width:"100%",background:"#eee"}})]}),i.jsxs("div",{style:{marginBottom:12},children:[i.jsx("label",{children:"頭像網址："}),i.jsx("input",{value:d,onChange:z=>h(z.target.value),style:{width:"100%"}})]}),i.jsxs("div",{style:{marginBottom:12},children:[i.jsx("label",{children:"性別："}),i.jsxs("select",{value:m,onChange:z=>g(z.target.value),required:!0,style:{width:"100%"},children:[i.jsx("option",{value:"",children:"請選擇"}),i.jsx("option",{value:"male",children:"男"}),i.jsx("option",{value:"female",children:"女"})]})]}),i.jsxs("div",{style:{marginBottom:12},children:[i.jsx("label",{children:"國家/地區："}),i.jsxs("select",{value:x,onChange:z=>S(z.target.value),required:!0,style:{width:"100%"},children:[i.jsx("option",{value:"",children:"請選擇"}),(xI["zh-TW"]||[]).map(z=>i.jsx("option",{value:z,children:z},z))]})]}),i.jsxs("div",{style:{marginBottom:12},children:[i.jsx("label",{children:"城市："}),i.jsx("input",{value:C,onChange:z=>_(z.target.value),style:{width:"100%"}})]}),i.jsxs("div",{style:{marginBottom:12},children:[i.jsx("label",{children:"年齡："}),i.jsxs("select",{value:I,onChange:z=>T(z.target.value),required:!0,style:{width:"100%"},children:[i.jsx("option",{value:"",children:"請選擇"}),vI.map(z=>i.jsx("option",{value:z,children:z},z))]})]}),i.jsxs("div",{style:{marginBottom:12},children:[i.jsx("label",{children:"興趣："}),i.jsxs("select",{value:F,onChange:z=>P(z.target.value),required:!0,style:{width:"100%"},children:[i.jsx("option",{value:"",children:"請選擇"}),(yI["zh-TW"]||[]).map(z=>i.jsx("option",{value:z,children:z},z))]})]}),i.jsxs("div",{style:{marginBottom:12},children:[i.jsx("label",{children:"事件類別："}),i.jsxs("select",{value:B,onChange:z=>q(z.target.value),required:!0,style:{width:"100%"},children:[i.jsx("option",{value:"",children:"請選擇"}),(bI["zh-TW"]||[]).map(z=>i.jsx("option",{value:z,children:z},z))]})]}),i.jsxs("div",{style:{marginBottom:12},children:[i.jsx("label",{children:"想改善什麼："}),i.jsx("input",{value:te,onChange:z=>W(z.target.value),required:!0,style:{width:"100%"}})]}),i.jsx("button",{type:"submit",disabled:A,style:{width:"100%",padding:10,fontWeight:700,fontSize:18,background:"#4caf50",color:"#fff",border:"none",borderRadius:8},children:A?"儲存中...":"完成"})]})]})}const C3={"zh-TW":"返回","zh-CN":"返回",en:"Back",ja:"戻る",ko:"뒤로",th:"กลับ",vi:"Quay lại",ms:"Kembali",la:"Revertere"},ok={"zh-TW":i.jsxs("div",{children:[i.jsx("h1",{children:"Restarter™ App 隱私權政策"}),i.jsx("p",{children:"本應用程式由 Restarter™ 團隊開發，致力於保護您的個人資料與隱私權。本政策說明我們如何收集、使用、儲存、保護及分享您的個人資料，並說明您對於個人資料的權利。"}),i.jsx("h2",{children:"一、我們收集的資料"}),i.jsxs("ul",{children:[i.jsx("li",{children:"電子郵件地址（Email）"}),i.jsx("li",{children:"使用者名稱/暱稱"}),i.jsx("li",{children:"頭像（如有上傳）"}),i.jsx("li",{children:"性別、年齡、國家/地區、城市（如用戶自願填寫）"}),i.jsx("li",{children:"興趣、經歷事件、個人描述等自願填寫的資料"}),i.jsx("li",{children:"登入紀錄、操作紀錄（僅用於安全與服務優化）"})]}),i.jsx("h2",{children:"二、資料用途"}),i.jsxs("ul",{children:[i.jsx("li",{children:"用於身份驗證、帳號管理與個人化服務"}),i.jsx("li",{children:"用於社群互動、配對、任務、花園等功能"}),i.jsx("li",{children:"用於服務安全、錯誤偵測與防止濫用"}),i.jsx("li",{children:"用於統計分析與產品優化（僅以匿名方式）"}),i.jsx("li",{children:"不會將您的個人資料出售、出租或未經授權分享給第三方"})]}),i.jsx("h2",{children:"三、第三方服務"}),i.jsxs("p",{children:["本應用程式使用 Google Firebase 作為後端服務平台，Firebase 可能會根據其 ",i.jsx("a",{href:"https://firebase.google.com/support/privacy",target:"_blank",rel:"noopener noreferrer",children:"隱私政策"})," 處理技術資料（如裝置資訊、IP、操作紀錄等）。"]}),i.jsx("p",{children:"如您使用 Google、Apple、Facebook 等第三方帳號登入，僅會取得必要的公開資訊（如 email、暱稱、頭像），不會取得您的密碼。"}),i.jsx("h2",{children:"四、Cookie 與追蹤技術"}),i.jsx("p",{children:"本應用程式可能使用 Cookie 或類似技術以提升用戶體驗與安全性。您可於瀏覽器設定中管理 Cookie 偏好。"}),i.jsx("h2",{children:"五、資料儲存與保護"}),i.jsxs("ul",{children:[i.jsx("li",{children:"所有個人資料均儲存於 Google Firebase 雲端，並採用業界標準的加密與安全措施。"}),i.jsx("li",{children:"僅授權人員可存取您的個人資料，且僅限於服務維護與法規要求。"})]}),i.jsx("h2",{children:"六、您的權利"}),i.jsxs("ul",{children:[i.jsx("li",{children:"您有權查詢、更正、下載或刪除您的個人資料。"}),i.jsx("li",{children:"您可隨時於 App 內或來信要求刪除帳號與所有資料，我們將於 3-5 個工作天內完成。"}),i.jsxs("li",{children:["聯絡信箱：",i.jsx("a",{href:"mailto:rbben521@gmail.com",children:"rbben521@gmail.com"})]})]}),i.jsx("h2",{children:"七、政策變更"}),i.jsx("p",{children:"如本政策有重大變更，將於 App 內公告並更新本頁內容。"})]}),"zh-CN":i.jsxs("div",{children:[i.jsx("h1",{children:"Restarter™ App 隐私政策"}),i.jsx("p",{children:"本应用程序由 Restarter™ 团队开发，致力于保护您的个人资料与隐私权。本政策说明我们如何收集、使用、存储、保护及分享您的个人资料，并说明您对于个人资料的权利。"}),i.jsx("h2",{children:"一、我们收集的资料"}),i.jsxs("ul",{children:[i.jsx("li",{children:"电子邮件地址（Email）"}),i.jsx("li",{children:"用户名/昵称"}),i.jsx("li",{children:"头像（如有上传）"}),i.jsx("li",{children:"性别、年龄、国家/地区、城市（如用户自愿填写）"}),i.jsx("li",{children:"兴趣、经历事件、个人描述等自愿填写的资料"}),i.jsx("li",{children:"登录记录、操作记录（仅用于安全与服务优化）"})]}),i.jsx("h2",{children:"二、资料用途"}),i.jsxs("ul",{children:[i.jsx("li",{children:"用于身份验证、账号管理与个性化服务"}),i.jsx("li",{children:"用于社群互动、配对、任务、花园等功能"}),i.jsx("li",{children:"用于服务安全、错误检测与防止滥用"}),i.jsx("li",{children:"用于统计分析与产品优化（仅以匿名方式）"}),i.jsx("li",{children:"不会将您的个人资料出售、出租或未经授权分享给第三方"})]}),i.jsx("h2",{children:"三、第三方服务"}),i.jsxs("p",{children:["本应用程序使用 Google Firebase 作为后端服务平台，Firebase 可能会根据其 ",i.jsx("a",{href:"https://firebase.google.com/support/privacy",target:"_blank",rel:"noopener noreferrer",children:"隐私政策"})," 处理技术资料（如设备信息、IP、操作记录等）。"]}),i.jsx("p",{children:"如您使用 Google、Apple、Facebook 等第三方账号登录，仅会取得必要的公开信息（如 email、昵称、头像），不会取得您的密码。"}),i.jsx("h2",{children:"四、Cookie 与追踪技术"}),i.jsx("p",{children:"本应用程序可能使用 Cookie 或类似技术以提升用户体验与安全性。您可于浏览器设置中管理 Cookie 偏好。"}),i.jsx("h2",{children:"五、资料存储与保护"}),i.jsxs("ul",{children:[i.jsx("li",{children:"所有个人资料均存储于 Google Firebase 云端，并采用业界标准的加密与安全措施。"}),i.jsx("li",{children:"仅授权人员可存取您的个人资料，且仅限于服务维护与法规要求。"})]}),i.jsx("h2",{children:"六、您的权利"}),i.jsxs("ul",{children:[i.jsx("li",{children:"您有权查询、更正、下载或删除您的个人资料。"}),i.jsx("li",{children:"您可随时于 App 内或来信要求删除账号与所有资料，我们将于 3-5 个工作天内完成。"}),i.jsxs("li",{children:["联系邮箱：",i.jsx("a",{href:"mailto:rbben521@gmail.com",children:"rbben521@gmail.com"})]})]}),i.jsx("h2",{children:"七、政策变更"}),i.jsx("p",{children:"如本政策有重大变更，将于 App 内公告并更新本页内容。"})]}),en:i.jsxs("div",{children:[i.jsx("h1",{children:"Privacy Policy for Restarter™ App"}),i.jsx("p",{children:"Restarter™ is committed to protecting your privacy. This policy explains how we collect, use, store, and protect your personal information, and your rights regarding your data."}),i.jsx("h2",{children:"1. Information We Collect"}),i.jsxs("ul",{children:[i.jsx("li",{children:"Email address"}),i.jsx("li",{children:"Username/Nickname"}),i.jsx("li",{children:"Avatar (if uploaded)"}),i.jsx("li",{children:"Gender, age, country/region, city (if provided)"}),i.jsx("li",{children:"Interests, life events, personal description (if provided)"}),i.jsx("li",{children:"Login and activity logs (for security and service improvement)"})]}),i.jsx("h2",{children:"2. Purpose of Collection"}),i.jsxs("ul",{children:[i.jsx("li",{children:"Authentication, account management, and personalized services"}),i.jsx("li",{children:"Community interaction, matching, missions, garden features"}),i.jsx("li",{children:"Service security, error detection, and abuse prevention"}),i.jsx("li",{children:"Statistical analysis and product improvement (anonymized)"}),i.jsx("li",{children:"We do not sell, rent, or share your personal data with third parties without your consent"})]}),i.jsx("h2",{children:"3. Third-Party Services"}),i.jsxs("p",{children:["This app uses Google Firebase as its backend. Firebase may process technical data according to its ",i.jsx("a",{href:"https://firebase.google.com/support/privacy",target:"_blank",rel:"noopener noreferrer",children:"Privacy Policy"})," (e.g., device info, IP, activity logs)."]}),i.jsx("p",{children:"If you log in via Google, Apple, or Facebook, we only access your public info (email, nickname, avatar), never your password."}),i.jsx("h2",{children:"4. Cookies and Tracking"}),i.jsx("p",{children:"We may use cookies or similar technologies to enhance your experience and security. You can manage cookie preferences in your browser settings."}),i.jsx("h2",{children:"5. Data Storage and Protection"}),i.jsxs("ul",{children:[i.jsx("li",{children:"All personal data is stored on Google Firebase cloud with industry-standard encryption and security."}),i.jsx("li",{children:"Only authorized personnel can access your data, solely for service maintenance or legal compliance."})]}),i.jsx("h2",{children:"6. Your Rights"}),i.jsxs("ul",{children:[i.jsx("li",{children:"You have the right to access, correct, download, or delete your personal data."}),i.jsx("li",{children:"You may request account/data deletion at any time via the app or by email. We will process your request within 3-5 business days."}),i.jsxs("li",{children:["Contact: ",i.jsx("a",{href:"mailto:rbben521@gmail.com",children:"rbben521@gmail.com"})]})]}),i.jsx("h2",{children:"7. Policy Updates"}),i.jsx("p",{children:"We will notify users of major changes to this policy via in-app announcements and update this page accordingly."})]}),ja:i.jsxs("div",{children:[i.jsx("h1",{children:"Restarter™ アプリ プライバシーポリシー"}),i.jsx("p",{children:"本アプリはRestarter™チームによって開発され、ユーザーの個人情報とプライバシーの保護に努めています。本ポリシーは、どのように個人情報を収集・利用・保存・保護・共有するか、またユーザーの権利について説明します。"}),i.jsx("h2",{children:"1. 収集する情報"}),i.jsxs("ul",{children:[i.jsx("li",{children:"メールアドレス"}),i.jsx("li",{children:"ユーザー名/ニックネーム"}),i.jsx("li",{children:"アバター（アップロードした場合）"}),i.jsx("li",{children:"性別、年齢、国/地域、都市（任意）"}),i.jsx("li",{children:"興味、経験イベント、自己紹介（任意）"}),i.jsx("li",{children:"ログイン・操作履歴（セキュリティ・サービス向上のため）"})]}),i.jsx("h2",{children:"2. 利用目的"}),i.jsxs("ul",{children:[i.jsx("li",{children:"認証、アカウント管理、パーソナライズサービス"}),i.jsx("li",{children:"コミュニティ交流、マッチング、ミッション、ガーデン機能"}),i.jsx("li",{children:"サービスの安全性、エラー検出、不正防止"}),i.jsx("li",{children:"統計分析・製品改善（匿名化）"}),i.jsx("li",{children:"同意なく第三者に個人情報を販売・共有しません"})]}),i.jsx("h2",{children:"3. サードパーティサービス"}),i.jsxs("p",{children:["本アプリはGoogle Firebaseをバックエンドとして使用しています。Firebaseは ",i.jsx("a",{href:"https://firebase.google.com/support/privacy",target:"_blank",rel:"noopener noreferrer",children:"プライバシーポリシー"})," に従い技術情報（デバイス情報、IP、操作履歴など）を処理する場合があります。"]}),i.jsx("p",{children:"Google、Apple、Facebook等でログインした場合、公開情報（メール、ニックネーム、アバター）のみ取得し、パスワードは取得しません。"}),i.jsx("h2",{children:"4. Cookieとトラッキング技術"}),i.jsx("p",{children:"本アプリはユーザー体験と安全性向上のため コッキー または類似技術を使用する場合があります。ブラウザ設定でCookieの管理が可能です。"}),i.jsx("h2",{children:"5. データ保存と保護"}),i.jsxs("ul",{children:[i.jsx("li",{children:"全ての個人情報はGoogle Firebaseクラウドに保存され、業界標準の暗号化とセキュリティで保護されます。"}),i.jsx("li",{children:"認可された担当者のみがサービス保守や法令遵守のためにアクセス可能です。"})]}),i.jsx("h2",{children:"6. ユーザーの権利"}),i.jsxs("ul",{children:[i.jsx("li",{children:"個人情報の照会、訂正、ダウンロード、削除が可能です。"}),i.jsx("li",{children:"アプリ内またはメールでいつでも削除依頼ができ、3～5営業日以内に対応します。"}),i.jsxs("li",{children:["連絡先：",i.jsx("a",{href:"mailto:rbben521@gmail.com",children:"rbben521@gmail.com"})]})]}),i.jsx("h2",{children:"7. ポリシーの変更"}),i.jsx("p",{children:"本ポリシーに重大な変更がある場合、アプリ内で告知し本ページを更新します。"})]}),ko:i.jsxs("div",{children:[i.jsx("h1",{children:"Restarter™ 앱 개인정보처리방침"}),i.jsx("p",{children:"본 앱은 Restarter™ 팀이 개발하였으며, 사용자의 개인정보와 프라이버시 보호에 최선을 다합니다. 본 정책은 개인정보의 수집, 이용, 저장, 보호, 공유 방법과 사용자의 권리에 대해 설명합니다."}),i.jsx("h2",{children:"1. 수집하는 정보"}),i.jsxs("ul",{children:[i.jsx("li",{children:"이메일 주소"}),i.jsx("li",{children:"사용자명/닉네임"}),i.jsx("li",{children:"아바타(업로드한 경우)"}),i.jsx("li",{children:"성별, 나이, 국가/지역, 도시(선택사항)"}),i.jsx("li",{children:"관심사, 경험 이벤트, 자기소개(선택사항)"}),i.jsx("li",{children:"로그인 및 활동 기록(보안 및 서비스 개선 목적)"})]}),i.jsx("h2",{children:"2. 수집 목적"}),i.jsxs("ul",{children:[i.jsx("li",{children:"인증, 계정 관리, 개인화 서비스"}),i.jsx("li",{children:"커뮤니티 상호작용, 매칭, 미션, 가든 기능"}),i.jsx("li",{children:"서비스 보안, 오류 탐지, 오용 방지"}),i.jsx("li",{children:"통계 분석 및 제품 개선(익명화)"}),i.jsx("li",{children:"동의 없이 제3자에게 개인정보를 판매, 임대, 공유하지 않습니다"})]}),i.jsx("h2",{children:"3. 제3자 서비스"}),i.jsxs("p",{children:["본 앱은 Google Firebase를 백엔드로 사용합니다. Firebase는 ",i.jsx("a",{href:"https://firebase.google.com/support/privacy",target:"_blank",rel:"noopener noreferrer",children:"개인정보처리방침"}),"에 따라 기술 정보를 처리할 수 있습니다(예: 기기 정보, IP, 활동 기록 등)."]}),i.jsx("p",{children:"Google, Apple, Facebook 등으로 로그인 시 공개 정보(이메일, 닉네임, 아바타)만 수집하며, 비밀번호는 수집하지 않습니다."}),i.jsx("h2",{children:"4. 쿠키 및 추적 기술"}),i.jsx("p",{children:"본 앱은 사용자 경험 및 보안 향상을 위해 쿠키 또는 유사 기술을 사용할 수 있습니다. 브라우저 설정에서 쿠키 환경설정이 가능합니다."}),i.jsx("h2",{children:"5. 데이터 저장 및 보호"}),i.jsxs("ul",{children:[i.jsx("li",{children:"모든 개인정보는 Google Firebase 클라우드에 저장되며, 업계 표준 암호화 및 보안이 적용됩니다."}),i.jsx("li",{children:"서비스 유지보수 및 법적 요구에 한해 인가된 인원만 접근할 수 있습니다."})]}),i.jsx("h2",{children:"6. 사용자의 권리"}),i.jsxs("ul",{children:[i.jsx("li",{children:"개인정보의 조회, 수정, 다운로드, 삭제가 가능합니다."}),i.jsx("li",{children:"앱 내 또는 이메일로 언제든 삭제 요청이 가능하며, 3~5영업일 이내에 처리됩니다."}),i.jsxs("li",{children:["연락처: ",i.jsx("a",{href:"mailto:rbben521@gmail.com",children:"rbben521@gmail.com"})]})]}),i.jsx("h2",{children:"7. 정책 변경"}),i.jsx("p",{children:"정책에 중대한 변경이 있을 경우 앱 내 공지 및 본 페이지를 업데이트합니다."})]}),th:i.jsxs("div",{children:[i.jsx("h1",{children:"นโยบายความเป็นส่วนตัวของแอป Restarter™"}),i.jsx("p",{children:"แอปนี้พัฒนาโดยทีมงาน Restarter™ มุ่งมั่นในการปกป้องข้อมูลส่วนบุคคลและความเป็นส่วนตัวของคุณ นโยบายนี้อธิบายวิธีการเก็บรวบรวม ใช้ จัดเก็บ ปกป้อง และแบ่งปันข้อมูลส่วนบุคคลของคุณ รวมถึงสิทธิ์ของคุณ"}),i.jsx("h2",{children:"1. ข้อมูลที่เราเก็บรวบรวม"}),i.jsxs("ul",{children:[i.jsx("li",{children:"ที่อยู่อีเมล"}),i.jsx("li",{children:"ชื่อผู้ใช้/ชื่อเล่น"}),i.jsx("li",{children:"อวาตาร์ (ถ้าอัปโหลด)"}),i.jsx("li",{children:"เพศ อายุ ประเทศ/ภูมิภาค เมือง (ถ้าระบุ)"}),i.jsx("li",{children:"ความสนใจ เหตุการณ์ในชีวิต คำอธิบายส่วนตัว (ถ้าระบุ)"}),i.jsx("li",{children:"บันทึกการเข้าสู่ระบบและกิจกรรม (เพื่อความปลอดภัยและปรับปรุงบริการ)"})]}),i.jsx("h2",{children:"2. วัตถุประสงค์ของการเก็บข้อมูล"}),i.jsxs("ul",{children:[i.jsx("li",{children:"การยืนยันตัวตน การจัดการบัญชี และบริการส่วนบุคคล"}),i.jsx("li",{children:"การมีปฏิสัมพันธ์ในชุมชน การจับคู่ ภารกิจ ฟีเจอร์สวน"}),i.jsx("li",{children:"ความปลอดภัยของบริการ การตรวจจับข้อผิดพลาด และป้องกันการละเมิด"}),i.jsx("li",{children:"การวิเคราะห์สถิติและปรับปรุงผลิตภัณฑ์ (แบบไม่ระบุตัวตน)"}),i.jsx("li",{children:"จะไม่ขาย ให้เช่า หรือแบ่งปันข้อมูลส่วนบุคคลของคุณกับบุคคลที่สามโดยไม่ได้รับความยินยอม"})]}),i.jsx("h2",{children:"3. บริการของบุคคลที่สาม"}),i.jsxs("p",{children:["แอปนี้ใช้ Google Firebase เป็นแบ็กเอนด์ Firebase อาจประมวลผลข้อมูลทางเทคนิคตาม ",i.jsx("a",{href:"https://firebase.google.com/support/privacy",target:"_blank",rel:"noopener noreferrer",children:"นโยบายความเป็นส่วนตัว"})," (เช่น ข้อมูลอุปกรณ์ IP บันทึกกิจกรรม)"]}),i.jsx("p",{children:"หากคุณเข้าสู่ระบบผ่าน Google, Apple หรือ Facebook เราจะเข้าถึงเฉพาะข้อมูลสาธารณะ (อีเมล ชื่อเล่น อวาตาร์) ไม่เคยเข้าถึงรหัสผ่านของคุณ"}),i.jsx("h2",{children:"4. คุกกี้และการติดตาม"}),i.jsx("p",{children:"เราอาจใช้คุกกี้หรือเทคโนโลยีที่คล้ายกันเพื่อปรับปรุงประสบการณ์และความปลอดภัยของคุณ คุณสามารถจัดการคุกกี้ได้ในเบราว์เซอร์ของคุณ"}),i.jsx("h2",{children:"5. การจัดเก็บและปกป้องข้อมูล"}),i.jsxs("ul",{children:[i.jsx("li",{children:"ข้อมูลส่วนบุคคลทั้งหมดจะถูกจัดเก็บบนคลาวด์ Google Firebase ด้วยการเข้ารหัสและความปลอดภัยตามมาตรฐานอุตสาหกรรม"}),i.jsx("li",{children:"มีเพียงบุคลากรที่ได้รับอนุญาตเท่านั้นที่สามารถเข้าถึงข้อมูลของคุณเพื่อการบำรุงรักษาบริการหรือปฏิบัติตามกฎหมาย"})]}),i.jsx("h2",{children:"6. สิทธิ์ของคุณ"}),i.jsxs("ul",{children:[i.jsx("li",{children:"คุณมีสิทธิ์เข้าถึง แก้ไข ดาวน์โหลด หรือขอลบข้อมูลส่วนบุคคลของคุณ"}),i.jsx("li",{children:"คุณสามารถขอลบบัญชี/ข้อมูลได้ตลอดเวลาผ่านแอปหรืออีเมล เราจะดำเนินการภายใน 3-5 วันทำการ"}),i.jsxs("li",{children:["ติดต่อ: ",i.jsx("a",{href:"mailto:rbben521@gmail.com",children:"rbben521@gmail.com"})]})]}),i.jsx("h2",{children:"7. การอัปเดตนโยบาย"}),i.jsx("p",{children:"เราจะแจ้งให้ผู้ใช้ทราบถึงการเปลี่ยนแปลงที่สำคัญของนโยบายนี้ผ่านการประกาศในแอปและอัปเดตหน้านี้ตามความเหมาะสม"})]}),vi:i.jsxs("div",{children:[i.jsx("h1",{children:"Chính sách bảo mật cho ứng dụng Restarter™"}),i.jsx("p",{children:"Restarter™ cam kết bảo vệ quyền riêng tư của bạn. Chính sách này giải thích cách chúng tôi thu thập, sử dụng, lưu trữ và bảo vệ thông tin cá nhân của bạn, cũng như quyền của bạn đối với dữ liệu đó."}),i.jsx("h2",{children:"1. Thông tin chúng tôi thu thập"}),i.jsxs("ul",{children:[i.jsx("li",{children:"Địa chỉ email"}),i.jsx("li",{children:"Tên người dùng/Biệt danh"}),i.jsx("li",{children:"Ảnh đại diện (nếu tải lên)"}),i.jsx("li",{children:"Giới tính, tuổi, quốc gia/khu vực, thành phố (nếu cung cấp)"}),i.jsx("li",{children:"Sở thích, sự kiện cuộc sống, mô tả cá nhân (nếu cung cấp)"}),i.jsx("li",{children:"Nhật ký đăng nhập và hoạt động (để bảo mật và cải thiện dịch vụ)"})]}),i.jsx("h2",{children:"2. Mục đích thu thập"}),i.jsxs("ul",{children:[i.jsx("li",{children:"Xác thực, quản lý tài khoản và dịch vụ cá nhân hóa"}),i.jsx("li",{children:"Tương tác cộng đồng, ghép đôi, nhiệm vụ, tính năng vườn"}),i.jsx("li",{children:"Bảo mật dịch vụ, phát hiện lỗi và ngăn chặn lạm dụng"}),i.jsx("li",{children:"Phân tích thống kê và cải tiến sản phẩm (ẩn danh)"}),i.jsx("li",{children:"Chúng tôi không bán, cho thuê hoặc chia sẻ dữ liệu cá nhân của bạn với bên thứ ba nếu không có sự đồng ý của bạn"})]}),i.jsx("h2",{children:"3. Dịch vụ của bên thứ ba"}),i.jsxs("p",{children:["Ứng dụng này sử dụng Google Firebase làm backend. Firebase có thể xử lý dữ liệu kỹ thuật theo ",i.jsx("a",{href:"https://firebase.google.com/support/privacy",target:"_blank",rel:"noopener noreferrer",children:"Chính sách bảo mật"})," (ví dụ: thông tin thiết bị, IP, nhật ký hoạt động)."]}),i.jsx("p",{children:"Nếu bạn đăng nhập qua Google, Apple hoặc Facebook, chúng tôi chỉ truy cập thông tin công khai của bạn (email, biệt danh, ảnh đại diện), không bao giờ truy cập mật khẩu của bạn."}),i.jsx("h2",{children:"4. Cookie và theo dõi"}),i.jsx("p",{children:"Chúng tôi có thể sử dụng cookie hoặc các công nghệ tương tự để nâng cao trải nghiệm và bảo mật của bạn. Bạn có thể quản lý cookie trong cài đặt trình duyệt của mình."}),i.jsx("h2",{children:"5. Lưu trữ và bảo vệ dữ liệu"}),i.jsxs("ul",{children:[i.jsx("li",{children:"Tất cả dữ liệu cá nhân được lưu trữ trên đám mây Google Firebase với mã hóa và bảo mật tiêu chuẩn ngành."}),i.jsx("li",{children:"Chỉ những nhân viên được ủy quyền mới có thể truy cập dữ liệu của bạn, chỉ để bảo trì dịch vụ hoặc tuân thủ pháp luật."})]}),i.jsx("h2",{children:"6. Quyền của bạn"}),i.jsxs("ul",{children:[i.jsx("li",{children:"Bạn có quyền truy cập, chỉnh sửa, tải xuống hoặc xóa dữ liệu cá nhân của mình."}),i.jsx("li",{children:"Bạn có thể yêu cầu xóa tài khoản/dữ liệu bất cứ lúc nào qua ứng dụng hoặc email. Chúng tôi sẽ xử lý yêu cầu của bạn trong vòng 3-5 ngày làm việc."}),i.jsxs("li",{children:["Liên hệ: ",i.jsx("a",{href:"mailto:rbben521@gmail.com",children:"rbben521@gmail.com"})]})]}),i.jsx("h2",{children:"7. Cập nhật chính sách"}),i.jsx("p",{children:"Chúng tôi sẽ thông báo cho người dùng về những thay đổi lớn đối với chính sách này qua thông báo trong ứng dụng và cập nhật trang này cho phù hợp."})]}),ms:i.jsxs("div",{children:[i.jsx("h1",{children:"Dasar Privasi untuk Aplikasi Restarter™"}),i.jsx("p",{children:"Restarter™ komited untuk melindungi privasi anda. Polisi ini menerangkan bagaimana kami mengumpul, menggunakan, menyimpan dan melindungi maklumat peribadi anda, serta hak anda terhadap data tersebut."}),i.jsx("h2",{children:"1. Maklumat yang Kami Kumpul"}),i.jsxs("ul",{children:[i.jsx("li",{children:"Alamat emel"}),i.jsx("li",{children:"Nama pengguna/Nama samaran"}),i.jsx("li",{children:"Avatar (jika dimuat naik)"}),i.jsx("li",{children:"Jantina, umur, negara/wilayah, bandar (jika diberikan)"}),i.jsx("li",{children:"Minat, peristiwa hidup, keterangan peribadi (jika diberikan)"}),i.jsx("li",{children:"Log masuk dan aktiviti (untuk keselamatan dan penambahbaikan perkhidmatan)"})]}),i.jsx("h2",{children:"2. Tujuan Pengumpulan"}),i.jsxs("ul",{children:[i.jsx("li",{children:"Pengesahan, pengurusan akaun dan perkhidmatan peribadi"}),i.jsx("li",{children:"Interaksi komuniti, padanan, misi, ciri taman"}),i.jsx("li",{children:"Keselamatan perkhidmatan, pengesanan ralat dan pencegahan penyalahgunaan"}),i.jsx("li",{children:"Analisis statistik dan penambahbaikan produk (tanpa nama)"}),i.jsx("li",{children:"Kami tidak akan menjual, menyewa atau berkongsi data peribadi anda dengan pihak ketiga tanpa kebenaran anda"})]}),i.jsx("h2",{children:"3. Perkhidmatan Pihak Ketiga"}),i.jsxs("p",{children:["Aplikasi ini menggunakan Google Firebase sebagai backend. Firebase mungkin memproses data teknikal mengikut ",i.jsx("a",{href:"https://firebase.google.com/support/privacy",target:"_blank",rel:"noopener noreferrer",children:"Dasar Privasi"})," (cth: maklumat peranti, IP, log aktiviti)."]}),i.jsx("p",{children:"Jika anda log masuk melalui Google, Apple atau Facebook, kami hanya mengakses maklumat awam anda (emel, nama samaran, avatar), tidak pernah kata laluan anda."}),i.jsx("h2",{children:"4. Kuki dan Penjejakan"}),i.jsx("p",{children:"Kami mungkin menggunakan kuki atau teknologi serupa untuk meningkatkan pengalaman dan keselamatan anda. Anda boleh mengurus pilihan kuki dalam tetapan pelayar anda."}),i.jsx("h2",{children:"5. Penyimpanan dan Perlindungan Data"}),i.jsxs("ul",{children:[i.jsx("li",{children:"Semua data peribadi disimpan di awan Google Firebase dengan penyulitan dan keselamatan piawaian industri."}),i.jsx("li",{children:"Soli homines auctoritate praediti possunt tuas notitias accedere, tantum ad servitium vel leges tuendas."})]}),i.jsx("h2",{children:"6. Hak Anda"}),i.jsxs("ul",{children:[i.jsx("li",{children:"Anda berhak untuk mengakses, membetulkan, memuat turun atau memadam data peribadi anda."}),i.jsx("li",{children:"Anda boleh meminta pemadaman akaun/data pada bila-bila masa melalui aplikasi atau e-mel. Kami akan memproses permintaan anda dalam masa 3-5 hari bekerja."}),i.jsxs("li",{children:["Hubungi: ",i.jsx("a",{href:"mailto:rbben521@gmail.com",children:"rbben521@gmail.com"})]})]}),i.jsx("h2",{children:"7. Kemas Kini Polisi"}),i.jsx("p",{children:"Kami akan memaklumkan pengguna tentang perubahan besar pada polisi ini melalui pengumuman dalam aplikasi dan mengemas kini halaman ini dengan sewajarnya."})]}),la:i.jsxs("div",{children:[i.jsx("h1",{children:"Consilium Privacy pro Restarter™ App"}),i.jsx("p",{children:"Restarter™ ad tuendam tuam privacy studet. Haec consilia explicat quomodo notitias personales colligamus, utamur, condamus, tueamur, et iura tua de notitiis exponat."}),i.jsx("h2",{children:"1. Quae colligimus"}),i.jsxs("ul",{children:[i.jsx("li",{children:"Inscriptionem electronicam"}),i.jsx("li",{children:"Nomen usoris/Sobriquet"}),i.jsx("li",{children:"Avatar (si sublatus)"}),i.jsx("li",{children:"Sexus, aetas, regio/natio, urbs (si praebetur)"}),i.jsx("li",{children:"Studia, eventus vitae, descriptio personalis (si praebetur)"}),i.jsx("li",{children:"Acta login et actio (ad securitatem et emendationem servitii)"})]}),i.jsx("h2",{children:"2. Propositum collectionis"}),i.jsxs("ul",{children:[i.jsx("li",{children:"Authenticatio, administratio rationis, officia personalia"}),i.jsx("li",{children:"Communitas, paria, missiones, hortus"}),i.jsx("li",{children:"Securitas servitii, errorum detectio, abusus praeventio"}),i.jsx("li",{children:"Analysis statistica et emendatio producti (anonymizata)"}),i.jsx("li",{children:"Notitias tuas non vendimus, locamus, nec sine consensu communicamus"})]}),i.jsx("h2",{children:"3. Officia tertiarum partium"}),i.jsxs("p",{children:["Haec app utitur Google Firebase ut backend. Firebase potest notitias technicas tractare secundum ",i.jsx("a",{href:"https://firebase.google.com/support/privacy",target:"_blank",rel:"noopener noreferrer",children:"Consilium Privacy"})," (ex. info de machina, IP, acta actionum)."]}),i.jsx("p",{children:"Si per Google, Apple, Facebook ingredieris, solum publicas notitias tuas accedimus (email, sobriquet, avatar), numquam tesseram tuam."}),i.jsx("h2",{children:"4. Cookies et vestigatio"}),i.jsx("p",{children:"Possumus uti cookies aut similibus technologiis ad experientiam et securitatem tuam augendam. Praeferentias cookies in navigatoris tuis regere potes."}),i.jsx("h2",{children:"5. Reconditio et tutela notitiarum"}),i.jsxs("ul",{children:[i.jsx("li",{children:"Omnes notitiae personales in Google Firebase nube servantur, cum encryptione et securitate industriae."}),i.jsx("li",{children:"Soli homines auctoritate praediti possunt tuas notitias accedere, tantum ad servitium vel leges tuendas."})]}),i.jsx("h2",{children:"6. Iura tua"}),i.jsxs("ul",{children:[i.jsx("li",{children:"Ius habes accedere, corrigere, extrahere, aut delere notitias tuas personales."}),i.jsx("li",{children:"Potes petere deletionem rationis/datae quovis tempore per app vel email. Processum intra 3-5 dies negotiales perficimus."}),i.jsxs("li",{children:["Contactus: ",i.jsx("a",{href:"mailto:rbben521@gmail.com",children:"rbben521@gmail.com"})]})]}),i.jsx("h2",{children:"7. Renovatio consilii"}),i.jsx("p",{children:"De mutationibus maioribus huius consilii usores per nuntios in app certiorem faciemus et hanc paginam proinde renovabimus."})]})};function R3(){const n=localStorage.getItem("lang")||"zh-TW",e=_t();return i.jsxs("div",{style:{minHeight:"100vh",background:"#111827",color:"white",padding:"2rem",display:"flex",flexDirection:"column"},children:[i.jsxs("button",{onClick:()=>e("/register",{replace:!0}),style:{position:"absolute",top:32,left:36,zIndex:10,backgroundColor:"#374151",color:"white",fontWeight:"bold",padding:"0.5rem 1rem",borderRadius:"0.375rem",border:"none",cursor:"pointer",fontSize:16},children:["← ",C3[n]||"返回"]}),i.jsx("div",{style:{flex:"1 0 auto"},children:i.jsxs("div",{style:{maxWidth:800,margin:"0 auto",background:"#fff",color:"#111",borderRadius:16,padding:32,position:"relative"},children:[ok[n]||ok["zh-TW"],i.jsx("div",{style:{textAlign:"center",marginTop:48,color:"#888",fontSize:16},children:"CTX Goodlife Copyright 2025"})]})}),i.jsx("div",{style:{width:"100%",margin:"0 auto",marginTop:24,background:"rgba(255,255,255,0.95)",borderRadius:16,padding:"16px",boxShadow:"0 2px 12px #6B5BFF22"},children:i.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:20,flexWrap:"wrap"},children:[i.jsx("a",{href:"/privacy-policy",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12},children:"隱私權政策"}),i.jsx("a",{href:"/terms",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12},children:"條款/聲明"}),i.jsx("a",{href:"/data-deletion",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12},children:"資料刪除說明"}),i.jsx("a",{href:"/about",style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12},children:"🧬 Restarter™｜我們是誰"}),i.jsx("a",{href:"/feedback",style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12},children:"💬 意見箱｜我們想聽你說"})]})})]})}const sk={"zh-TW":i.jsxs("div",{children:[i.jsx("h1",{children:"資料刪除說明"}),i.jsx("p",{children:"若您希望刪除在 Restarter App 中儲存的個人資料，請來信至："}),i.jsx("p",{children:i.jsx("strong",{children:"rbben521@gmail.com"})}),i.jsx("p",{children:"我們會在 3-5 個工作天內完成資料刪除作業。"})]}),"zh-CN":i.jsxs("div",{children:[i.jsx("h1",{children:"资料删除说明"}),i.jsx("p",{children:"如需删除在 Restarter App 中存储的个人资料，请发送邮件至："}),i.jsx("p",{children:i.jsx("strong",{children:"rbben521@gmail.com"})}),i.jsx("p",{children:"我们将在 3-5 个工作日内完成资料删除。"})]}),en:i.jsxs("div",{children:[i.jsx("h1",{children:"Data Deletion Policy"}),i.jsx("p",{children:"If you wish to delete your personal data stored in the Restarter App, please contact:"}),i.jsx("p",{children:i.jsx("strong",{children:"rbben521@gmail.com"})}),i.jsx("p",{children:"We will complete the deletion process within 3-5 business days."})]}),ja:i.jsxs("div",{children:[i.jsx("h1",{children:"データ削除のご案内"}),i.jsx("p",{children:"Restarterアプリに保存されている個人データの削除をご希望の場合は、以下までご連絡ください："}),i.jsx("p",{children:i.jsx("strong",{children:"rbben521@gmail.com"})}),i.jsx("p",{children:"3～5営業日以内に削除手続きを完了します。"})]}),ko:i.jsxs("div",{children:[i.jsx("h1",{children:"데이터 삭제 안내"}),i.jsx("p",{children:"Restarter 앱에 저장된 개인 데이터를 삭제하려면 다음으로 문의해 주세요:"}),i.jsx("p",{children:i.jsx("strong",{children:"rbben521@gmail.com"})}),i.jsx("p",{children:"3~5 영업일 이내에 삭제를 완료해 드립니다."})]}),th:i.jsxs("div",{children:[i.jsx("h1",{children:"นโยบายการลบข้อมูล"}),i.jsx("p",{children:"หากคุณต้องการลบข้อมูลส่วนบุคคลที่จัดเก็บในแอป Restarter กรุณาติดต่อ:"}),i.jsx("p",{children:i.jsx("strong",{children:"rbben521@gmail.com"})}),i.jsx("p",{children:"เราจะดำเนินการลบข้อมูลภายใน 3-5 วันทำการ"})]}),vi:i.jsxs("div",{children:[i.jsx("h1",{children:"Chính sách xóa dữ liệu"}),i.jsx("p",{children:"Nếu bạn muốn xóa dữ liệu cá nhân được lưu trữ trong ứng dụng Restarter, vui lòng liên hệ:"}),i.jsx("p",{children:i.jsx("strong",{children:"rbben521@gmail.com"})}),i.jsx("p",{children:"Chúng tôi sẽ hoàn tất việc xóa dữ liệu trong vòng 3-5 ngày làm việc."})]}),ms:i.jsxs("div",{children:[i.jsx("h1",{children:"Dasar Pemadaman Data"}),i.jsx("p",{children:"Jika anda ingin memadam data peribadi yang disimpan dalam Aplikasi Restarter, sila hubungi:"}),i.jsx("p",{children:i.jsx("strong",{children:"rbben521@gmail.com"})}),i.jsx("p",{children:"Kami akan menyelesaikan proses pemadaman dalam masa 3-5 hari bekerja."})]}),la:i.jsxs("div",{children:[i.jsx("h1",{children:"Norma Deletionis Datae"}),i.jsx("p",{children:"Si vis delere data personalia in Restarter App reposita, quaeso contactum:"}),i.jsx("p",{children:i.jsx("strong",{children:"rbben521@gmail.com"})}),i.jsx("p",{children:"Processum deletionis intra 3-5 dies negotiales perficimus."})]})},E3={"zh-TW":"返回","zh-CN":"返回",en:"Back",ja:"戻る",ko:"뒤로",th:"กลับ",vi:"Quay lại",ms:"Kembali",la:"Revertere"};function A3(){const n=localStorage.getItem("lang")||"zh-TW",e=_t();return i.jsxs("div",{style:{minHeight:"100vh",background:"#111827",color:"white",padding:"2rem",display:"flex",flexDirection:"column"},children:[i.jsxs("button",{onClick:()=>e("/register",{replace:!0}),style:{position:"absolute",top:32,left:36,zIndex:10,backgroundColor:"#374151",color:"white",fontWeight:"bold",padding:"0.5rem 1rem",borderRadius:"0.375rem",border:"none",cursor:"pointer",fontSize:16},children:["← ",E3[n]||"返回"]}),i.jsx("div",{style:{flex:"1 0 auto"},children:i.jsxs("div",{style:{maxWidth:800,margin:"0 auto",background:"#fff",color:"#111",borderRadius:16,padding:32,position:"relative"},children:[sk[n]||sk["zh-TW"],i.jsx("div",{style:{textAlign:"center",marginTop:48,color:"#888",fontSize:16},children:"CTX Goodlife Copyright 2025"})]})}),i.jsx("div",{style:{width:"100%",margin:"0 auto",marginTop:24,background:"rgba(255,255,255,0.95)",borderRadius:16,padding:"16px",boxShadow:"0 2px 12px #6B5BFF22"},children:i.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:20,flexWrap:"wrap"},children:[i.jsx("a",{href:"/privacy-policy",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12},children:"隱私權政策"}),i.jsx("a",{href:"/terms",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12},children:"條款/聲明"}),i.jsx("a",{href:"/data-deletion",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12},children:"資料刪除說明"}),i.jsx("a",{href:"/about",style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12},children:"🧬 Restarter™｜我們是誰"}),i.jsx("a",{href:"/feedback",style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12},children:"💬 意見箱｜我們想聽你說"})]})})]})}const Yt={"zh-TW":{title:"互相幫助&合作實驗室",provide:"提供幫助",supply:"供應圈",need:"需要幫助",room:"互助房",intro:"在重啟的路上，我們都需要彼此的支持。請選擇你想要參與的方式：",introNeed:"如果你正在經歷困難，請告訴我們，社群夥伴會主動協助你。",needBtn:"我需要幫助",rule:"※ 所有資訊僅供社群內部交流使用，請尊重彼此隱私",msgTo:"留言給：",msgPlaceholder:"請輸入留言...",msgSent:"留言發送成功！",backToHome:"返回首頁",sections:{provide:{title:"我可提供幫助 & 合作室",desc:"分享你的專長、資源或想合作的領域，讓更多人找到你。",btn:"我要提供"},need:{title:"我需要幫助 or 合作屋",desc:"說出你目前遇到的困難或想找合作夥伴，讓社群支援你。",btn:"我需要幫助"},supply:{title:"幫助 & 合作供應圈",desc:"瀏覽大家能提供的幫助與合作資源，主動聯繫彼此。",btn:"探索供應圈"},room:{title:"進入互助房",desc:"即時交流，互助成長",btn:"進入互助房"}},modals:{provide:{title:"我可以提供幫助 & 合作",subtitle:"在重啟路上，我的經歷和優勢也許可以幫上忙！",experience:"我的經歷（可複選）：",current:"我的現狀(可複選)：",target:"我想優先幫助的對象（可複選）：",helpType:"我可以提供幫助形式：",statement:"我的特別聲明（50字內）：",frequency:"我可幫助的頻率：",cancel:"取消",submit:"送出",other:"其他...",enterPlaceholder:"請輸入...",messageTo:"留言給：",messagePlaceholder:"請輸入留言...",sendMessage:"送出留言",messageSent:"需求已成功送出！"},need:{title:"我需要幫助",subtitle:"請描述你遇到的困難或需要協助的地方，讓社群夥伴能更好幫助你！",experience:"我的經歷（可複選）：",current:"我的現狀(可複選)：",target:"我想優先幫助的對象（可複選）：",helpType:"我可以提供幫助形式：",statement:"我的特別聲明（50字內）：",frequency:"我可幫助的頻率：",cancel:"取消",submit:"送出",other:"其他...",enterPlaceholder:"請輸入...",messageTo:"留言給：",messagePlaceholder:"請輸入留言...",sendMessage:"送出留言",messageSent:"需求已成功送出！"}},options:{experience:["成功創業","家庭重建","就業輔導","法律協助","戒癮經驗","志工","社區服務","其他"],advantage:["經濟困難","無固定工作","缺乏家庭支持","健康問題","法律糾紛","心理壓力","缺乏居住地","人際關係困難","正在創業中","其他"],target:["找工作/就業協助","經濟急難救助","心理諮詢/陪伴","法律協助","醫療協助","住宿協助","家庭修復","戒癮支持","人際關係協助","生活重建","商業輔導","其他"],helpType:["線上","線下"],frequency:["每天","每週","每月","依需要者而定","其他"]},messages:{messageSent:"留言發送成功！",messageFailed:"留言發送失敗，請稍後再試",noMessages:"暫無留言",markRead:"標記已讀",delete:"刪除",confirmDelete:"你確定要刪除這條留言嗎？（一旦刪除將無法復原）",inboxTitle:"站內訊息",messageFrom:"給你的留言：",contactUser:"聯絡對方"},date:"日期",avatar:"頭像",name:"名稱",gender:"性別",age:"年齡",country:"國家"},"zh-CN":{sections:{provide:{title:"我可提供帮助 & 合作室",desc:"分享你的专长、资源或想合作的领域，让更多人找到你。",btn:"我要提供"},need:{title:"我需要帮助 or 合作屋",desc:"说出你目前遇到的困难或想找合作伙伴，让社群支援你。",btn:"我需要帮助"},supply:{title:"帮助 & 合作供应圈",desc:"浏览大家能提供的帮助与合作资源，主动联系彼此。",btn:"探索供应圈"},room:{title:"进入互助房",desc:"即时交流，互助成长",btn:"进入互助房"}},modals:{provide:{title:"我可以提供帮助 & 合作",subtitle:"在重启路上，我的经历和优势也许可以帮上忙！",experience:"我的经历（可复选）：",current:"我的现状(可复选)：",target:"我想优先帮助的对象（可复选）：",helpType:"我可以提供帮助形式：",statement:"我的特别声明（50字内）：",frequency:"我可帮助的频率：",cancel:"取消",submit:"送出",other:"其他...",enterPlaceholder:"请输入...",messageTo:"留言给：",messagePlaceholder:"请输入留言...",sendMessage:"送出留言",messageSent:"需求已成功送出！"},need:{title:"我需要帮助",subtitle:"请描述你遇到的困难或需要协助的地方，让社群伙伴能更好帮助你！",experience:"我的经历（可复选）：",current:"我的现状(可复选)：",target:"我遇到的困难/需求（可复选）：",helpType:"希望获得协助形式：",statement:"补充说明（50字内）：",frequency:"希望获得协助频率：",cancel:"取消",submit:"送出",other:"其他...",enterPlaceholder:"请输入...",messageTo:"留言给：",messagePlaceholder:"请输入留言...",sendMessage:"送出留言",messageSent:"需求已成功送出！"}},options:{experience:["成功创业","家庭重建","就业辅导","法律协助","戒瘾经验","志工","社区服务","其他"],advantage:["经济困难","无固定工作","缺乏家庭支持","健康问题","法律纠纷","心理压力","缺乏居住地","人际关系困难","正在创业中","其他"],target:["找工作/就业协助","经济急难救助","心理咨询/陪伴","法律协助","医疗协助","住宿协助","家庭修复","戒瘾支持","人际关系协助","生活重建","商业辅导","其他"],helpType:["线上","线下"],frequency:["每天","每周","每月","依需要者而定","其他"]},messages:{messageSent:"留言发送成功！",messageFailed:"留言发送失败，请稍后再试",noMessages:"暂无留言",markRead:"标记已读",delete:"删除",confirmDelete:"你确定要删除这条留言吗？（一旦删除将无法复原）",inboxTitle:"站内消息",messageFrom:"给你的留言：",contactUser:"联络对方"},date:"日期",avatar:"头像",name:"名称",gender:"性别",age:"年龄",country:"国家"},en:{sections:{provide:{title:"I can provide help & cooperation room",desc:"Share your expertise, resources or areas you want to collaborate on, so more people can find you.",btn:"I want to provide"},need:{title:"I need help or cooperation house",desc:"Tell us about the difficulties you're currently facing or partners you want to find, so the community can support you.",btn:"I need help"},supply:{title:"Help & cooperation supply circle",desc:"Browse the help and cooperation resources everyone can provide, actively contact each other.",btn:"Explore supply circle"},room:{title:"Enter mutual aid room",desc:"Real-time communication, mutual growth",btn:"Enter mutual aid room"}},modals:{provide:{title:"I can provide help & cooperation",subtitle:"On the restart journey, my experience and advantages might be helpful!",experience:"My experience (multiple choice):",current:"My current situation (multiple choice):",target:"People I want to help first (multiple choice):",helpType:"I can provide help in the form of:",statement:"My special statement (within 50 characters):",frequency:"My help frequency:",cancel:"Cancel",submit:"Submit",other:"Other...",enterPlaceholder:"Please enter...",messageTo:"Message to:",messagePlaceholder:"Please enter message...",sendMessage:"Send message",messageSent:"Request sent successfully!",backToHome:"Back to Home"},need:{title:"I need help",subtitle:"Please describe the difficulties you're facing or areas where you need assistance, so community partners can better help you!",experience:"My experience (multiple choice):",current:"My current situation (multiple choice):",target:"People I want to help first (multiple choice):",helpType:"I can provide help in the form of:",statement:"My special statement (within 50 characters):",frequency:"My help frequency:",cancel:"Cancel",submit:"Submit",other:"Other...",enterPlaceholder:"Please enter...",messageTo:"Message to:",messagePlaceholder:"Please enter message...",sendMessage:"Send message",messageSent:"Request sent successfully!",backToHome:"Back to Home"}},options:{experience:["Successful entrepreneurship","Family reconstruction","Employment guidance","Legal assistance","Addiction recovery experience","Volunteer","Community service","Other"],advantage:["Financial difficulties","No fixed job","Lack of family support","Health problems","Legal disputes","Psychological pressure","Lack of housing","Interpersonal difficulties","Currently starting a business","Other"],target:["Job search/employment assistance","Emergency financial assistance","Psychological counseling/companionship","Legal assistance","Medical assistance","Housing assistance","Family repair","Addiction support","Interpersonal assistance","Life reconstruction","Business guidance","Other"],helpType:["Online","Offline"],frequency:["Daily","Weekly","Monthly","As needed","Other"]},messages:{messageSent:"Message sent successfully!",messageFailed:"Message sending failed, please try again later",noMessages:"No messages yet",markRead:"Mark as read",delete:"Delete",confirmDelete:"Are you sure you want to delete this message? (Once deleted, it cannot be restored)",inboxTitle:"Inbox Messages",messageFrom:" sent you a message:",contactUser:"Contact User"},date:"Date",avatar:"Avatar",name:"Name",gender:"Gender",age:"Age",country:"Country"},ja:{sections:{provide:{title:"私は助けと協力の部屋を提供できます",desc:"あなたの専門知識、リソース、または協力したい分野を共有して、より多くの人にあなたを見つけてもらいましょう。",btn:"提供したい"},need:{title:"私は助けまたは協力の家が必要です",desc:"現在直面している困難や見つけたいパートナーについて教えてください。コミュニティがあなたをサポートできるようにします。",btn:"助けが必要です"},supply:{title:"助けと協力の供給サークル",desc:"みんなが提供できる助けと協力のリソースを閲覧し、積極的にお互いに連絡を取り合いましょう。",btn:"供給サークルを探索"},room:{title:"相互扶助の部屋に入る",desc:"リアルタイムコミュニケーション、相互成長",btn:"相互扶助の部屋に入る"}},modals:{provide:{title:"私は助けと協力を提供できます",subtitle:"再出発の道のりで、私の経験と強みがお役に立てるかもしれません！",experience:"私の経験（複数選択可）：",current:"私の現状（複数選択可）：",target:"私が優先的に助けたい人（複数選択可）：",helpType:"私が提供できる助けの形式：",statement:"私の特別な声明（50文字以内）：",frequency:"私が助けられる頻度：",cancel:"キャンセル",submit:"送信",other:"その他...",enterPlaceholder:"入力してください...",messageTo:"メッセージを送る：",messagePlaceholder:"メッセージを入力してください...",sendMessage:"メッセージを送信",messageSent:"リクエストが正常に送信されました！",backToHome:"ホームへ戻る"},need:{title:"助けが必要です",subtitle:"直面している困難や支援が必要な領域を説明してください。コミュニティのパートナーがより良くあなたを助けられるようにします！",experience:"私の経験（複数選択可）：",current:"私の現状（複数選択可）：",target:"私が優先的に助けたい人（複数選択可）：",helpType:"私が提供できる助けの形式：",statement:"私の特別な声明（50文字以内）：",frequency:"私が助けられる頻度：",cancel:"キャンセル",submit:"送信",other:"その他...",enterPlaceholder:"入力してください...",messageTo:"メッセージを送る：",messagePlaceholder:"メッセージを入力してください...",sendMessage:"メッセージを送信",messageSent:"リクエストが正常に送信されました！",backToHome:"ホームへ戻る"}},options:{experience:["成功した起業","家族の再構築","就職支援","法的支援","依存症回復経験","ボランティア","コミュニティサービス","その他"],advantage:["経済的困難","固定職なし","家族のサポート不足","健康問題","法的紛争","心理的プレッシャー","住居不足","人間関係の困難","現在起業中","その他"],target:["仕事探し/就職支援","緊急経済支援","心理カウンセリング/同伴","法的支援","医療支援","住居支援","家族修復","依存症支援","人間関係支援","生活再建","ビジネス指導","その他"],helpType:["オンライン","オフライン"],frequency:["毎日","毎週","毎月","必要に応じて","その他"]},messages:{messageSent:"メッセージが正常に送信されました！",messageFailed:"メッセージの送信に失敗しました。後でもう一度お試しください",noMessages:"まだメッセージがありません",markRead:"既読にする",delete:"削除",confirmDelete:"このメッセージを削除してもよろしいですか？（削除すると復元できません）",inboxTitle:"受信メッセージ",messageFrom:"からメッセージ：",contactUser:"ユーザーに連絡",backToHome:"ホームへ戻る"},date:"日付",avatar:"アイコン",name:"名前",gender:"性別",age:"年齢",country:"国"},ko:{sections:{provide:{title:"나는 도움과 협력 방을 제공할 수 있습니다",desc:"당신의 전문 지식, 자원 또는 협력하고 싶은 분야를 공유하여 더 많은 사람들이 당신을 찾을 수 있도록 하세요.",btn:"제공하고 싶습니다"},need:{title:"나는 도움이나 협력 집이 필요합니다",desc:"현재 직면한 어려움이나 찾고 싶은 파트너에 대해 말씀해 주세요. 커뮤니티가 당신을 지원할 수 있도록 합니다.",btn:"도움이 필요합니다"},supply:{title:"도움과 협력 공급 서클",desc:"모든 사람이 제공할 수 있는 도움과 협력 자원을 둘러보고, 적극적으로 서로 연락하세요.",btn:"공급 서클 탐색"},room:{title:"상호 원조 방에 들어가기",desc:"실시간 소통, 상호 성장",btn:"상호 원조 방에 들어가기"}},modals:{provide:{title:"나는 도움과 협력을 제공할 수 있습니다",subtitle:"재시작 여정에서 제 경험과 장점이 도움이 될 수 있습니다!",experience:"제 경험 (복수 선택 가능):",current:"제 현재 상황 (복수 선택 가능):",target:"제가 우선적으로 도우고 싶은 사람 (복수 선택 가능):",helpType:"제가 제공할 수 있는 도움의 형태:",statement:"제 특별한 선언 (50자 이내):",frequency:"제가 도울 수 있는 빈도:",cancel:"취소",submit:"제출",other:"기타...",enterPlaceholder:"입력하세요...",messageTo:"메시지 보내기:",messagePlaceholder:"메시지를 입력하세요...",sendMessage:"메시지 보내기",messageSent:"요청이 성공적으로 전송되었습니다!",backToHome:"홈으로 돌아가기"},need:{title:"도움이 필요합니다",subtitle:"당신이 직면한 어려움이나 도움이 필요한 분야를 설명해 주세요. 커뮤니티 파트너가 더 잘 당신을 도울 수 있도록 합니다!",experience:"제 경험 (복수 선택 가능):",current:"제 현재 상황 (복수 선택 가능):",target:"제가 우선적으로 도우고 싶은 사람 (복수 선택 가능):",helpType:"제가 제공할 수 있는 도움의 형태:",statement:"제 특별한 선언 (50자 이내):",frequency:"제가 도울 수 있는 빈도:",cancel:"취소",submit:"제출",other:"기타...",enterPlaceholder:"입력하세요...",messageTo:"메시지 보내기:",messagePlaceholder:"메시지를 입력하세요...",sendMessage:"메시지 보내기",messageSent:"요청이 성공적으로 전송되었습니다!",backToHome:"홈으로 돌아가기"}},options:{experience:["성공한 창업","가족 재건","취업 지도","법적 지원","중독 회복 경험","자원봉사","커뮤니티 서비스","기타"],advantage:["경제적 어려움","고정 직업 없음","가족 지원 부족","건강 문제","법적 분쟁","심리적 압박","주거지 부족","인간관계 어려움","현재 창업 중","기타"],target:["일자리 찾기/취업 지원","긴급 경제 지원","심리 상담/동반","법적 지원","의료 지원","주거 지원","가족 회복","중독 지원","인간관계 지원","생활 재건","비즈니스 지도","기타"],helpType:["온라인","오프라인"],frequency:["매일","매주","매월","필요에 따라","기타"]},messages:{messageSent:"메시지가 성공적으로 전송되었습니다!",messageFailed:"메시지 전송에 실패했습니다. 나중에 다시 시도해 주세요",noMessages:"아직 메시지가 없습니다",markRead:"읽음 표시",delete:"삭제",confirmDelete:"이 메시지를 삭제하시겠습니까? (삭제하면 복원할 수 없습니다)",inboxTitle:"받은 메시지",messageFrom:"님이 보낸 메시지:",contactUser:"사용자에게 연락",backToHome:"홈으로 돌아가기"},date:"날짜",avatar:"아바타",name:"이름",gender:"성별",age:"나이",country:"국가"},vi:{sections:{provide:{title:"Tôi có thể cung cấp phòng trợ giúp & hợp tác",desc:"Chia sẻ chuyên môn, tài nguyên hoặc lĩnh vực bạn muốn hợp tác, để nhiều người có thể tìm thấy bạn.",btn:"Tôi muốn cung cấp"},need:{title:"Tôi cần trợ giúp hoặc nhà hợp tác",desc:"Hãy nói về những khó khăn bạn đang gặp phải hoặc đối tác bạn muốn tìm, để cộng đồng có thể hỗ trợ bạn.",btn:"Tôi cần trợ giúp"},supply:{title:"Vòng tròn cung cấp trợ giúp & hợp tác",desc:"Duyệt qua các tài nguyên trợ giúp và hợp tác mà mọi người có thể cung cấp, chủ động liên lạc với nhau.",btn:"Khám phá vòng tròn cung cấp"},room:{title:"Vào phòng hỗ trợ lẫn nhau",desc:"Giao tiếp thời gian thực, cùng nhau phát triển",btn:"Vào phòng hỗ trợ lẫn nhau"}},modals:{provide:{title:"Tôi có thể cung cấp trợ giúp & hợp tác",subtitle:"Trên hành trình khởi động lại, kinh nghiệm và lợi thế của tôi có thể hữu ích!",experience:"Kinh nghiệm của tôi (chọn nhiều):",current:"Tình trạng hiện tại của tôi (chọn nhiều):",target:"Những người tôi muốn ưu tiên giúp đỡ (chọn nhiều):",helpType:"Tôi có thể cung cấp trợ giúp dưới hình thức:",statement:"Tuyên bố đặc biệt của tôi (trong vòng 50 ký tự):",frequency:"Tần suất tôi có thể giúp:",cancel:"Hủy",submit:"Gửi",other:"Khác...",enterPlaceholder:"Vui lòng nhập...",messageTo:"Nhắn tin cho:",messagePlaceholder:"Vui lòng nhập tin nhắn...",sendMessage:"Gửi tin nhắn",messageSent:"Yêu cầu đã được gửi thành công!",backToHome:"Về trang chủ"},need:{title:"Tôi cần trợ giúp",subtitle:"Vui lòng mô tả những khó khăn bạn đang gặp phải hoặc những lĩnh vực cần hỗ trợ, để các đối tác cộng đồng có thể giúp bạn tốt hơn!",experience:"Kinh nghiệm của tôi (chọn nhiều):",current:"Tình trạng hiện tại của tôi (chọn nhiều):",target:"Những người tôi muốn ưu tiên giúp đỡ (chọn nhiều):",helpType:"Tôi có thể cung cấp trợ giúp dưới hình thức:",statement:"Tuyên bố đặc biệt của tôi (trong vòng 50 ký tự):",frequency:"Tần suất tôi có thể giúp:",cancel:"Hủy",submit:"Gửi",other:"Khác...",enterPlaceholder:"Vui lòng nhập...",messageTo:"Nhắn tin cho:",messagePlaceholder:"Vui lòng nhập tin nhắn...",sendMessage:"Gửi tin nhắn",messageSent:"Yêu cầu đã được gửi thành công!",backToHome:"Về trang chủ"}},options:{experience:["Khởi nghiệp thành công","Tái thiết gia đình","Hướng dẫn việc làm","Hỗ trợ pháp lý","Kinh nghiệm cai nghiện","Tình nguyện viên","Dịch vụ cộng đồng","Khác"],advantage:["Khó khăn tài chính","Không có việc làm cố định","Thiếu hỗ trợ gia đình","Vấn đề sức khỏe","Tranh chấp pháp lý","Áp lực tâm lý","Thiếu nơi ở","Khó khăn trong mối quan hệ","Đang khởi nghiệp","Khác"],target:["Tìm việc/hỗ trợ việc làm","Hỗ trợ tài chính khẩn cấp","Tư vấn tâm lý/đồng hành","Hỗ trợ pháp lý","Hỗ trợ y tế","Hỗ trợ nhà ở","Sửa chữa gia đình","Hỗ trợ cai nghiện","Hỗ trợ mối quan hệ","Tái thiết cuộc sống","Hướng dẫn kinh doanh","Khác"],helpType:["Trực tuyến","Ngoại tuyến"],frequency:["Hàng ngày","Hàng tuần","Hàng tháng","Theo nhu cầu","Khác"]},messages:{messageSent:"Tin nhắn đã được gửi thành công!",messageFailed:"Gửi tin nhắn thất bại, vui lòng thử lại sau",noMessages:"Chưa có tin nhắn",markRead:"Đánh dấu đã đọc",delete:"Xóa",confirmDelete:"Bạn có chắc chắn muốn xóa tin nhắn này không? (Một khi xóa sẽ không thể khôi phục)",inboxTitle:"Tin nhắn đến",messageFrom:" đã gửi tin nhắn cho bạn:",contactUser:"Liên hệ người dùng",backToHome:"Về trang chủ"},date:"Ngày",avatar:"Ảnh đại diện",name:"Tên",gender:"Giới tính",age:"Tuổi",country:"Quốc gia"},th:{sections:{provide:{title:"ฉันสามารถให้ความช่วยเหลือและห้องความร่วมมือ",desc:"แบ่งปันความเชี่ยวชาญ ทรัพยากร หรือพื้นที่ที่คุณต้องการร่วมมือ เพื่อให้คนอื่นๆ หาคุณเจอ",btn:"ฉันต้องการให้"},need:{title:"ฉันต้องการความช่วยเหลือหรือบ้านความร่วมมือ",desc:"บอกเราเกี่ยวกับความยากลำบากที่คุณกำลังเผชิญหรือคู่ค้าที่คุณต้องการหา เพื่อให้ชุมชนสามารถสนับสนุนคุณได้",btn:"ฉันต้องการความช่วยเหลือ"},supply:{title:"วงกลมอุปทานความช่วยเหลือและความร่วมมือ",desc:"เรียกดูทรัพยากรความช่วยเหลือและความร่วมมือที่ทุกคนสามารถให้ได้ ติดต่อกันอย่างกระตือรือร้น",btn:"สำรวจวงกลมอุปทาน"},room:{title:"เข้าห้องช่วยเหลือซึ่งกันและกัน",desc:"การสื่อสารแบบเรียลไทม์ การเติบโตร่วมกัน",btn:"เข้าห้องช่วยเหลือซึ่งกันและกัน"}},modals:{provide:{title:"ฉันสามารถให้ความช่วยเหลือและความร่วมมือ",subtitle:"ในการเดินทางเริ่มต้นใหม่ ประสบการณ์และข้อได้เปรียบของฉันอาจเป็นประโยชน์!",experience:"ประสบการณ์ของฉัน (เลือกได้หลายข้อ):",current:"สถานการณ์ปัจจุบันของฉัน (เลือกได้หลายข้อ):",target:"คนที่ฉันต้องการช่วยเป็นอันดับแรก (เลือกได้หลายข้อ):",helpType:"ฉันสามารถให้ความช่วยเหลือในรูปแบบ:",statement:"คำแถลงพิเศษของฉัน (ไม่เกิน 50 ตัวอักษร):",frequency:"ความถี่ที่ฉันสามารถช่วยได้:",cancel:"ยกเลิก",submit:"ส่ง",other:"อื่นๆ...",enterPlaceholder:"กรุณาป้อน...",messageTo:"ส่งข้อความถึง:",messagePlaceholder:"กรุณาป้อนข้อความ...",sendMessage:"ส่งข้อความ",messageSent:"ส่งคำขอสำเร็จแล้ว!",backToHome:"กลับหน้าหลัก"},need:{title:"ฉันต้องการความช่วยเหลือ",subtitle:"กรุณาอธิบายความยากลำบากที่คุณกำลังเผชิญหรือพื้นที่ที่ต้องการความช่วยเหลือ เพื่อให้คู่ค้าชุมชนสามารถช่วยคุณได้ดีขึ้น!",experience:"ประสบการณ์ของฉัน (เลือกได้หลายข้อ):",current:"สถานการณ์ปัจจุบันของฉัน (เลือกได้หลายข้อ):",target:"คนที่ฉันต้องการช่วยเป็นอันดับแรก (เลือกได้หลายข้อ):",helpType:"ฉันสามารถให้ความช่วยเหลือในรูปแบบ:",statement:"คำแถลงพิเศษของฉัน (ไม่เกิน 50 ตัวอักษร):",frequency:"ความถี่ที่ฉันสามารถช่วยได้:",cancel:"ยกเลิก",submit:"ส่ง",other:"อื่นๆ...",enterPlaceholder:"กรุณาป้อน...",messageTo:"ส่งข้อความถึง:",messagePlaceholder:"กรุณาป้อนข้อความ...",sendMessage:"ส่งข้อความ",messageSent:"ส่งคำขอสำเร็จแล้ว!",backToHome:"กลับหน้าหลัก"}},options:{experience:["การเริ่มต้นธุรกิจที่ประสบความสำเร็จ","การสร้างครอบครัวใหม่","การแนะแนวการจ้างงาน","การช่วยเหลือทางกฎหมาย","ประสบการณ์การเลิกเสพติด","อาสาสมัคร","บริการชุมชน","อื่นๆ"],advantage:["ความยากลำบากทางการเงิน","ไม่มีงานประจำ","ขาดการสนับสนุนจากครอบครัว","ปัญหาสุขภาพ","ข้อพิพาททางกฎหมาย","ความกดดันทางจิตใจ","ขาดที่อยู่อาศัย","ความยากลำบากในความสัมพันธ์","กำลังเริ่มต้นธุรกิจ","อื่นๆ"],target:["การหางาน/ความช่วยเหลือการจ้างงาน","ความช่วยเหลือทางการเงินฉุกเฉิน","การให้คำปรึกษาทางจิตวิทยา/การเป็นเพื่อน","การช่วยเหลือทางกฎหมาย","ความช่วยเหลือทางการแพทย์","ความช่วยเหลือที่อยู่อาศัย","การซ่อมแซมครอบครัว","การสนับสนุนการเลิกเสพติด","ความช่วยเหลือความสัมพันธ์","การสร้างชีวิตใหม่","การแนะแนวธุรกิจ","อื่นๆ"],helpType:["ออนไลน์","ออฟไลน์"],frequency:["ทุกวัน","ทุกสัปดาห์","ทุกเดือน","ตามความต้องการ","อื่นๆ"]},messages:{messageSent:"ส่งข้อความสำเร็จแล้ว!",messageFailed:"การส่งข้อความล้มเหลว กรุณาลองใหม่อีกครั้ง",noMessages:"ยังไม่มีข้อความ",markRead:"ทำเครื่องหมายว่าอ่านแล้ว",delete:"ลบ",confirmDelete:"คุณแน่ใจหรือไม่ที่จะลบข้อความนี้? (เมื่อลบแล้วจะไม่สามารถกู้คืนได้)",inboxTitle:"受信メッセージ",messageFrom:"からメッセージ：",contactUser:"ユーザーに連絡",backToHome:"ホームへ戻る"},date:"วันที่",avatar:"รูปภาพ",name:"ชื่อ",gender:"เพศ",age:"อายุ",country:"ประเทศ"},ms:{sections:{provide:{title:"Saya boleh menyediakan bilik bantuan & kerjasama",desc:"Kongsi kepakaran, sumber atau bidang yang anda ingin bekerjasama, supaya lebih ramai orang dapat mencari anda.",btn:"Saya ingin menyediakan"},need:{title:"Saya memerlukan bantuan atau rumah kerjasama",desc:"Beritahu kami tentang kesukaran yang anda hadapi atau rakan kongsi yang anda ingin cari, supaya komuniti dapat menyokong anda.",btn:"Saya memerlukan bantuan"},supply:{title:"Bulatan bekalan bantuan & kerjasama",desc:"Semak imbas sumber bantuan dan kerjasama yang semua orang boleh sediakan, hubungi antara satu sama lain secara aktif.",btn:"Jelajah bulatan bekalan"},room:{title:"Masuk bilik bantuan bersama",desc:"Komunikasi masa nyata, pertumbuhan bersama",btn:"Masuk bilik bantuan bersama"}},modals:{provide:{title:"Saya boleh menyediakan bantuan & kerjasama",subtitle:"Dalam perjalanan memulakan semula, pengalaman dan kelebihan saya mungkin boleh membantu!",experience:"Pengalaman saya (pilihan berganda):",current:"Keadaan semasa saya (pilihan berganda):",target:"Orang yang saya ingin bantu terlebih dahulu (pilihan berganda):",helpType:"Saya boleh menyediakan bantuan dalam bentuk:",statement:"Pernyataan khas saya (dalam 50 aksara):",frequency:"Kekerapan saya boleh membantu:",cancel:"Batal",submit:"Hantar",other:"Lain-lain...",enterPlaceholder:"Sila masukkan...",messageTo:"Mesej kepada:",messagePlaceholder:"Sila masukkan mesej...",sendMessage:"Hantar mesej",messageSent:"Permintaan berjaya dihantar!",backToHome:"Kembali ke Laman Utama"},need:{title:"Saya memerlukan bantuan",subtitle:"Sila terangkan kesukaran yang anda hadapi atau bidang yang memerlukan bantuan, supaya rakan kongsi komuniti dapat membantu anda dengan lebih baik!",experience:"Pengalaman saya (pilihan berganda):",current:"Keadaan semasa saya (pilihan berganda):",target:"Orang yang saya ingin bantu terlebih dahulu (pilihan berganda):",helpType:"Saya boleh menyediakan bantuan dalam bentuk:",statement:"Pernyataan khas saya (dalam 50 aksara):",frequency:"Kekerapan saya boleh membantu:",cancel:"Batal",submit:"Hantar",other:"Lain-lain...",enterPlaceholder:"Sila masukkan...",messageTo:"Mesej kepada:",messagePlaceholder:"Sila masukkan mesej...",sendMessage:"Hantar mesej",messageSent:"Permintaan berjaya dihantar!",backToHome:"Kembali ke Laman Utama"}},options:{experience:["Keusahawanan berjaya","Pembinaan semula keluarga","Bimbingan pekerjaan","Bantuan undang-undang","Pengalaman pemulihan ketagihan","Sukarelawan","Perkhidmatan komuniti","Lain-lain"],advantage:["Kesukaran kewangan","Tiada pekerjaan tetap","Kekurangan sokongan keluarga","Masalah kesihatan","Pertikaian undang-undang","Tekanan psikologi","Kekurangan tempat tinggal","Kesukaran hubungan interpersonal","Sedang memulakan perniagaan","Lain-lain"],target:["Mencari kerja/bantuan pekerjaan","Bantuan kewangan kecemasan","Kaunseling psikologi/teman","Bantuan undang-undang","Bantuan perubatan","Bantuan tempat tinggal","Pembaikan keluarga","Sokongan ketagihan","Bantuan hubungan interpersonal","Pembinaan semula kehidupan","Bimbingan perniagaan","Lain-lain"],helpType:["Dalam talian","Luar talian"],frequency:["Setiap hari","Setiap minggu","Setiap bulan","Mengikut keperluan","Lain-lain"]},messages:{messageSent:"Mesej berjaya dihantar!",messageFailed:"Penghantaran mesej gagal, sila cuba lagi kemudian",noMessages:"Tiada mesej lagi",markRead:"Tandakan sebagai dibaca",delete:"Padam",confirmDelete:"Adakah anda pasti mahu memadamkan mesej ini? (Sebaik sahaja dipadamkan, ia tidak dapat dipulihkan)",inboxTitle:"受信メッセージ",messageFrom:"からメッセージ：",contactUser:"ユーザーに連絡",backToHome:"ホームへ戻る"},date:"Tarikh",avatar:"Avatar",name:"Nama",gender:"Jantina",age:"Umur",country:"Negara"},la:{sections:{provide:{title:"Possum praebere auxilium & cooperationis cubiculum",desc:"Partiri peritiam, opes vel regiones quas cooperari vis, ut plures te invenire possint.",btn:"Volo praebere"},need:{title:"Egeo auxilii vel cooperationis domus",desc:"Dic nobis de difficultatibus quas nunc patieris vel sociis quos quaeris, ut communitas te sustentare possit.",btn:"Egeo auxilii"},supply:{title:"Auxilii & cooperationis copiae circulus",desc:"Perlustra auxilii et cooperationis opes quas omnes praebere possunt, active inter se communicare.",btn:"Explora copiae circulum"},room:{title:"Intra mutuum auxilium cubiculum",desc:"Temporis realis communicatio, mutuus incrementum",btn:"Intra mutuum auxilium cubiculum"}},modals:{provide:{title:"Possum praebere auxilium & cooperationem",subtitle:"In itinere redintegrationis, mea experientia et commoda forsitan prodesse possunt!",experience:"Mea experientia (multiplex electio):",current:"Mea praesens condicio (multiplex electio):",target:"Homines quos primum adiuvare volo (multiplex electio):",helpType:"Possum praebere auxilium in forma:",statement:"Mea specialis declaratio (intra 50 characteres):",frequency:"Mea auxilii frequentia:",cancel:"Cancella",submit:"Submitte",other:"Alia...",enterPlaceholder:"Quaeso intra...",messageTo:"Nuntius ad:",messagePlaceholder:"Quaeso intra nuntium...",sendMessage:"Mitte nuntium",messageSent:"Petitio feliciter missa est!",backToHome:"Ad domum redire"},need:{title:"Egeo auxilii",subtitle:"Quaeso describe difficultates quas patieris vel regiones quae auxilio indigent, ut socii communitatis te melius adiuvare possint!",experience:"Mea experientia (multiplex electio):",current:"Mea praesens condicio (multiplex electio):",target:"Homines quos primum adiuvare volo (multiplex electio):",helpType:"Possum praebere auxilium in forma:",statement:"Mea specialis declaratio (intra 50 characteres):",frequency:"Mea auxilii frequentia:",cancel:"Cancella",submit:"Submitte",other:"Alia...",enterPlaceholder:"Quaeso intra...",messageTo:"Nuntius ad:",messagePlaceholder:"Quaeso intra nuntium...",sendMessage:"Mitte nuntium",messageSent:"Petitio feliciter missa est!",backToHome:"Ad domum redire"}},options:{experience:["Felix initium negotii","Familiae reconstructio","Orientatio laboris","Auxilium legale","Experientia liberationis ab addictione","Voluntarius","Servitium communitatis","Alia"],advantage:["Difficultates oeconomicae","Nullus labor fixus","Defectus sustentationis familiae","Problema sanitatis","Controversia legalis","Pressura psychologica","Defectus habitationis","Difficultates relationum","Nunc initium negotii faciens","Alia"],target:["Quaerere laborem/auxilium laboris","Auxilium oeconomicum urgentis","Consilium psychologicum/societas","Auxilium legale","Auxilium medicum","Auxilium habitationis","Reparatio familiae","Sustentatio liberationis","Auxilium relationum","Reconstructio vitae","Orientatio negotii","Alia"],helpType:["Online","Offline"],frequency:["Quotidie","Quot hebdomadis","Quot mensibus","Secundum necessitatem","Alia"]},messages:{messageSent:"Nuntius feliciter missus est!",messageFailed:"Missio nuntii defecit, quaeso postea denuo tenta",noMessages:"Nondum nuntii",markRead:"Nota ut lectum",delete:"Dele",confirmDelete:"Esne certus hunc nuntium delere velle? (Semel deletus, restitui non potest)",inboxTitle:"Inbox Messages",messageFrom:" sent you a message:",contactUser:"Contact User",backToHome:"Back to Home"},date:"Dies",avatar:"Imago",name:"Nomen",gender:"Genus",age:"Aetas",country:"Patria"}},P3=n=>{const e=Yt[n]||Yt["zh-TW"];return[{emoji:"🤝",title:e.sections.provide.title,desc:e.sections.provide.desc,btn:e.sections.provide.btn,color:"#e0f7fa"},{emoji:"🆘",title:e.sections.need.title,desc:e.sections.need.desc,btn:e.sections.need.btn,color:"#fff3e0"},{emoji:"🌐",title:e.sections.supply.title,desc:e.sections.supply.desc,btn:e.sections.supply.btn,color:"#e8f5e9"},{emoji:"🏠",title:e.sections.room.title,desc:e.sections.room.desc,btn:e.sections.room.btn,color:"#f3e5f5"}]},CI=n=>{const e={"zh-TW":{experience:["成功創業","家庭重建","就業輔導","法律協助","戒癮經驗","志工","社區服務","其他"],advantage:["經濟困難","無固定工作","缺乏家庭支持","健康問題","法律糾紛","心理壓力","缺乏居住地","人際關係困難","正在創業中","其他"],target:["找工作/就業協助","經濟急難救助","心理諮詢/陪伴","法律協助","醫療協助","住宿協助","家庭修復","戒癮支持","人際關係協助","生活重建","商業輔導","其他"],helpType:["線上","線下"],frequency:["每天","每週","每月","依需要者而定","其他"]},"zh-CN":{experience:["成功创业","家庭重建","就业辅导","法律协助","戒瘾经验","志工","社区服务","其他"],advantage:["经济困难","无固定工作","缺乏家庭支持","健康问题","法律纠纷","心理压力","缺乏居住地","人际关系困难","正在创业中","其他"],target:["找工作/就业协助","经济急难救助","心理咨询/陪伴","法律协助","医疗协助","住宿协助","家庭修复","戒瘾支持","人际关系协助","生活重建","商业辅导","其他"],helpType:["线上","线下"],frequency:["每天","每周","每月","依需要者而定","其他"]},en:{experience:["Successful entrepreneurship","Family reconstruction","Employment guidance","Legal assistance","Addiction recovery experience","Volunteer","Community service","Other"],advantage:["Financial difficulties","No fixed job","Lack of family support","Health problems","Legal disputes","Psychological pressure","Lack of housing","Interpersonal difficulties","Currently starting a business","Other"],target:["Job search/employment assistance","Emergency financial assistance","Psychological counseling/companionship","Legal assistance","Medical assistance","Housing assistance","Family repair","Addiction support","Interpersonal assistance","Life reconstruction","Business guidance","Other"],helpType:["Online","Offline"],frequency:["Daily","Weekly","Monthly","As needed","Other"]},ja:{experience:["成功した起業","家族の再構築","就職支援","法的支援","依存症回復経験","ボランティア","コミュニティサービス","その他"],advantage:["経済的困難","固定職なし","家族のサポート不足","健康問題","法的紛争","心理的プレッシャー","住居不足","人間関係の困難","現在起業中","その他"],target:["仕事探し/就職支援","緊急経済支援","心理カウンセリング/同伴","法的支援","医療支援","住居支援","家族修復","依存症支援","人間関係支援","生活再建","ビジネス指導","その他"],helpType:["オンライン","オフライン"],frequency:["毎日","毎週","毎月","必要に応じて","その他"]},ko:{experience:["성공한 창업","가족 재건","취업 지도","법적 지원","중독 회복 경험","자원봉사","커뮤니티 서비스","기타"],advantage:["경제적 어려움","고정 직업 없음","가족 지원 부족","건강 문제","법적 분쟁","심리적 압박","주거지 부족","인간관계 어려움","현재 창업 중","기타"],target:["일자리 찾기/취업 지원","긴급 경제 지원","심리 상담/동반","법적 지원","의료 지원","주거 지원","가족 회복","중독 지원","인간관계 지원","생활 재건","비즈니스 지도","기타"],helpType:["온라인","오프라인"],frequency:["매일","매주","매월","필요에 따라","기타"]},vi:{experience:["Khởi nghiệp thành công","Tái thiết gia đình","Hướng dẫn việc làm","Hỗ trợ pháp lý","Kinh nghiệm cai nghiện","Tình nguyện viên","Dịch vụ cộng đồng","Khác"],advantage:["Khó khăn tài chính","Không có việc làm cố định","Thiếu hỗ trợ gia đình","Vấn đề sức khỏe","Tranh chấp pháp lý","Áp lực tâm lý","Thiếu nơi ở","Khó khăn trong mối quan hệ","Đang khởi nghiệp","Khác"],target:["Tìm việc/hỗ trợ việc làm","Hỗ trợ tài chính khẩn cấp","Tư vấn tâm lý/đồng hành","Hỗ trợ pháp lý","Hỗ trợ y tế","Hỗ trợ nhà ở","Sửa chữa gia đình","Hỗ trợ cai nghiện","Hỗ trợ mối quan hệ","Tái thiết cuộc sống","Hướng dẫn kinh doanh","Khác"],helpType:["Trực tuyến","Ngoại tuyến"],frequency:["Hàng ngày","Hàng tuần","Hàng tháng","Theo nhu cầu","Khác"]},th:{experience:["การเริ่มต้นธุรกิจที่ประสบความสำเร็จ","การสร้างครอบครัวใหม่","การแนะแนวการจ้างงาน","การช่วยเหลือทางกฎหมาย","ประสบการณ์การเลิกเสพติด","อาสาสมัคร","บริการชุมชน","อื่นๆ"],advantage:["ความยากลำบากทางการเงิน","ไม่มีงานประจำ","ขาดการสนับสนุนจากครอบครัว","ปัญหาสุขภาพ","ข้อพิพาททางกฎหมาย","ความกดดันทางจิตใจ","ขาดที่อยู่อาศัย","ความยากลำบากในความสัมพันธ์","กำลังเริ่มต้นธุรกิจ","อื่นๆ"],target:["การหางาน/ความช่วยเหลือการจ้างงาน","ความช่วยเหลือทางการเงินฉุกเฉิน","การให้คำปรึกษาทางจิตวิทยา/การเป็นเพื่อน","การช่วยเหลือทางกฎหมาย","ความช่วยเหลือทางการแพทย์","ความช่วยเหลือที่อยู่อาศัย","การซ่อมแซมครอบครัว","การสนับสนุนการเลิกเสพติด","ความช่วยเหลือความสัมพันธ์","การสร้างชีวิตใหม่","การแนะแนวธุรกิจ","อื่นๆ"],helpType:["ออนไลน์","ออฟไลน์"],frequency:["ทุกวัน","ทุกสัปดาห์","ทุกเดือน","ตามความต้องการ","อื่นๆ"]},ms:{experience:["Keusahawanan berjaya","Pembinaan semula keluarga","Bimbingan pekerjaan","Bantuan undang-undang","Pengalaman pemulihan ketagihan","Sukarelawan","Perkhidmatan komuniti","Lain-lain"],advantage:["Kesukaran kewangan","Tiada pekerjaan tetap","Kekurangan sokongan keluarga","Masalah kesihatan","Pertikaian undang-undang","Tekanan psikologi","Kekurangan tempat tinggal","Kesukaran hubungan interpersonal","Sedang memulakan perniagaan","Lain-lain"],target:["Mencari kerja/bantuan pekerjaan","Bantuan kewangan kecemasan","Kaunseling psikologi/teman","Bantuan undang-undang","Bantuan perubatan","Bantuan tempat tinggal","Pembaikan keluarga","Sokongan ketagihan","Bantuan hubungan interpersonal","Pembinaan semula kehidupan","Bimbingan perniagaan","Lain-lain"],helpType:["Dalam talian","Luar talian"],frequency:["Setiap hari","Setiap minggu","Setiap bulan","Mengikut keperluan","Lain-lain"]},la:{experience:["Felix initium negotii","Familiae reconstructio","Orientatio laboris","Auxilium legale","Experientia liberationis ab addictione","Voluntarius","Servitium communitatis","Alia"],advantage:["Difficultates oeconomicae","Nullus labor fixus","Defectus sustentationis familiae","Problema sanitatis","Controversia legalis","Pressura psychologica","Defectus habitationis","Difficultates relationum","Nunc initium negotii faciens","Alia"],target:["Quaerere laborem/auxilium laboris","Auxilium oeconomicum urgentis","Consilium psychologicum/societas","Auxilium legale","Auxilium medicum","Auxilium habitationis","Reparatio familiae","Sustentatio liberationis","Auxilium relationum","Reconstructio vitae","Orientatio negotii","Alia"],helpType:["Online","Offline"],frequency:["Quotidie","Quot hebdomadis","Quot mensibus","Secundum necessitatem","Alia"]}};return e[n]||e["zh-TW"]};function B3({open:n,onClose:e,userInfo:t,onSubmit:r}){var oe,J,Q,D,G,ie,ee,Se,we,Oe,Ne,Ye,it,me,Ve,Xe,Je,He,fe,Te,_e,Fe,Be,K,re,H,Ue,ue,le,Re,rt,xe,Ae,Ge,ft,ke,at,pe,de,De,$e,lt,pt,bt,gt,Et,Nt,rn,on,Vr,Ur,Po,sn,Gi,pr,bi,vi;const{lang:o}=Mt(),a=CI(o),[c,d]=v.useState([]),[h,m]=v.useState(""),[g,x]=v.useState([]),[S,C]=v.useState(""),[_,I]=v.useState([]),[T,F]=v.useState(""),[P,B]=v.useState(a.helpType[0]),[q,te]=v.useState(""),[W,L]=v.useState(a.frequency[0]),[R,A]=v.useState(""),[N,O]=v.useState(!1),[z,j]=v.useState(!1),[V,X]=v.useState("");if(!n)return null;const $=(mt,sr,Ki)=>{sr(mt.includes(Ki)?mt.filter(Nc=>Nc!==Ki):[...mt,Ki])},ne=async mt=>{mt.preventDefault();try{console.log("ProvideModal 開始提交數據"),await r({exp:c,expOther:h,adv:g,advOther:S,target:_,targetOther:T,helpType:P,statement:q,freq:W,freqOther:R}),console.log("ProvideModal 數據提交成功")}catch(sr){console.error("ProvideModal 數據提交失敗:",sr)}};return i.jsx("div",{style:{position:"fixed",zIndex:9999,left:0,top:0,width:"100vw",height:"100vh",background:"rgba(40,40,80,0.18)",display:"flex",alignItems:"center",justifyContent:"center",padding:"16px"},children:i.jsxs("form",{onSubmit:ne,style:{background:"#fff",borderRadius:24,boxShadow:"0 8px 40px #6B5BFF33",padding:24,minWidth:360,width:"100%",maxWidth:"500px",position:"relative",display:"flex",flexDirection:"column",gap:18,maxHeight:"calc(100vh - 32px)"},children:[i.jsx("button",{type:"button",onClick:e,style:{position:"absolute",top:18,right:18,background:"none",border:"none",fontSize:26,color:"#888",cursor:"pointer",fontWeight:700,zIndex:1},children:"×"}),i.jsxs("div",{style:{overflow:"auto",flex:1,paddingRight:"8px",paddingBottom:"8px",maxHeight:"calc(100vh - 120px)"},children:[i.jsx("div",{style:{fontWeight:900,fontSize:22,color:"#6B5BFF",textAlign:"center",marginBottom:2},children:((Q=(J=(oe=Yt[o])==null?void 0:oe.modals)==null?void 0:J.provide)==null?void 0:Q.title)||"我可以提供幫助 & 合作"}),i.jsx("div",{style:{color:"#888",fontSize:15,textAlign:"center",marginBottom:8},children:((ie=(G=(D=Yt[o])==null?void 0:D.modals)==null?void 0:G.provide)==null?void 0:ie.subtitle)||"在重啟路上，我的經歷和優勢也許可以幫上忙！"}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:14,marginBottom:6},children:[i.jsx("img",{src:t.avatarUrl,alt:"avatar",style:{width:54,height:54,borderRadius:"50%",border:"2px solid #e0e7ff",objectFit:"cover"}}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:2},children:[i.jsx("span",{style:{color:"#1976d2",fontWeight:700,cursor:"pointer",textDecoration:"underline"},onClick:()=>O(!0),children:t.nickname}),i.jsx("span",{style:{color:"#1976d2",fontWeight:500,cursor:"pointer",textDecoration:"underline"},onClick:()=>window.open(`mailto:${t.email}`),children:t.email}),i.jsxs("span",{style:{color:"#555",fontSize:14},children:[t.country,"｜",t.gender,"｜",t.age]})]})]}),i.jsx("div",{style:{fontWeight:700,marginTop:8,fontSize:15},children:((we=(Se=(ee=Yt[o])==null?void 0:ee.modals)==null?void 0:Se.provide)==null?void 0:we.experience)||"我的經歷（可複選）："}),i.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:8,fontSize:14},children:[a.experience.map(mt=>i.jsxs("label",{style:{display:"flex",alignItems:"center",gap:4,fontWeight:500},children:[i.jsx("input",{type:"checkbox",checked:c.includes(mt),onChange:()=>$(c,d,mt)}),mt]},mt)),i.jsx("input",{placeholder:((Ye=(Ne=(Oe=Yt[o])==null?void 0:Oe.modals)==null?void 0:Ne.provide)==null?void 0:Ye.other)||"其他...",value:h,onChange:mt=>m(mt.target.value),style:{border:"1px solid #e0e7ff",borderRadius:8,padding:"2px 8px",minWidth:60,fontSize:14}})]}),i.jsx("div",{style:{fontWeight:700,marginTop:8,fontSize:15},children:((Ve=(me=(it=Yt[o])==null?void 0:it.modals)==null?void 0:me.provide)==null?void 0:Ve.current)||"我的現狀(可複選)："}),i.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:8,fontSize:14},children:[a.advantage.map(mt=>i.jsxs("label",{style:{display:"flex",alignItems:"center",gap:4,fontWeight:500},children:[i.jsx("input",{type:"checkbox",checked:g.includes(mt),onChange:()=>$(g,x,mt)}),mt]},mt)),i.jsx("input",{placeholder:((He=(Je=(Xe=Yt[o])==null?void 0:Xe.modals)==null?void 0:Je.provide)==null?void 0:He.other)||"其他...",value:S,onChange:mt=>C(mt.target.value),style:{border:"1px solid #e0e7ff",borderRadius:8,padding:"2px 8px",minWidth:60,fontSize:14}})]}),i.jsx("div",{style:{fontWeight:700,marginTop:8,fontSize:15},children:((_e=(Te=(fe=Yt[o])==null?void 0:fe.modals)==null?void 0:Te.provide)==null?void 0:_e.target)||"我想優先幫助的對象（可複選）："}),i.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:8,fontSize:14},children:[a.target.map(mt=>i.jsxs("label",{style:{display:"flex",alignItems:"center",gap:4,fontWeight:500},children:[i.jsx("input",{type:"checkbox",checked:_.includes(mt),onChange:()=>$(_,I,mt)}),mt]},mt)),i.jsx("input",{placeholder:((K=(Be=(Fe=Yt[o])==null?void 0:Fe.modals)==null?void 0:Be.provide)==null?void 0:K.other)||"其他...",value:T,onChange:mt=>F(mt.target.value),style:{border:"1px solid #e0e7ff",borderRadius:8,padding:"2px 8px",minWidth:60,fontSize:14}})]}),i.jsx("div",{style:{fontWeight:700,marginTop:8,fontSize:15},children:((Ue=(H=(re=Yt[o])==null?void 0:re.modals)==null?void 0:H.provide)==null?void 0:Ue.helpType)||"我可以提供幫助形式："}),i.jsx("div",{style:{display:"flex",gap:16,fontSize:14},children:a.helpType.map(mt=>i.jsxs("label",{style:{display:"flex",alignItems:"center",gap:4,fontWeight:500},children:[i.jsx("input",{type:"radio",name:"helptype",checked:P===mt,onChange:()=>B(mt)}),mt]},mt))}),i.jsx("div",{style:{fontWeight:700,marginTop:8,fontSize:15},children:((Re=(le=(ue=Yt[o])==null?void 0:ue.modals)==null?void 0:le.provide)==null?void 0:Re.statement)||"我的特別聲明（50字內）："}),i.jsx("input",{maxLength:50,value:q,onChange:mt=>te(mt.target.value),placeholder:((Ae=(xe=(rt=Yt[o])==null?void 0:rt.modals)==null?void 0:xe.provide)==null?void 0:Ae.enterPlaceholder)||"請輸入...",style:{border:"1px solid #e0e7ff",borderRadius:8,padding:"4px 10px",fontSize:14}}),i.jsxs("div",{style:{color:"#888",fontSize:13,textAlign:"right",marginTop:-8},children:[q.length,"/50"]}),i.jsx("div",{style:{fontWeight:700,marginTop:8,fontSize:15},children:((ke=(ft=(Ge=Yt[o])==null?void 0:Ge.modals)==null?void 0:ft.provide)==null?void 0:ke.frequency)||"我可幫助的頻率："}),i.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:16,fontSize:14},children:[a.frequency.map(mt=>i.jsxs("label",{style:{display:"flex",alignItems:"center",gap:4,fontWeight:500,marginRight:12},children:[i.jsx("input",{type:"radio",name:"freq",checked:W===mt,onChange:()=>L(mt)}),mt]},mt)),i.jsx("input",{placeholder:((de=(pe=(at=Yt[o])==null?void 0:at.modals)==null?void 0:pe.provide)==null?void 0:de.other)||"其他...",value:R,onChange:mt=>A(mt.target.value),style:{border:"1px solid #e0e7ff",borderRadius:8,padding:"2px 8px",minWidth:60,fontSize:14}})]}),i.jsxs("div",{style:{display:"flex",gap:18,marginTop:18,justifyContent:"center",padding:"8px 0",minHeight:"44px",background:"#fff",zIndex:10,borderTop:"1px solid #f0f0f0"},children:[i.jsx("button",{type:"button",onClick:e,style:{background:"#eee",color:"#555",border:"none",borderRadius:18,padding:"8px 28px",fontWeight:700,fontSize:16,cursor:"pointer",minHeight:"44px",touchAction:"manipulation",flex:1,maxWidth:"120px"},children:((lt=($e=(De=Yt[o])==null?void 0:De.modals)==null?void 0:$e.provide)==null?void 0:lt.cancel)||"取消"}),i.jsx("button",{type:"submit",style:{background:"linear-gradient(90deg, #6e8efb, #a777e3)",color:"#fff",border:"none",borderRadius:18,padding:"8px 28px",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:"0 2px 8px #a777e355",minHeight:"44px",touchAction:"manipulation",flex:1,maxWidth:"120px"},children:((gt=(bt=(pt=Yt[o])==null?void 0:pt.modals)==null?void 0:bt.provide)==null?void 0:gt.submit)||"送出"})]})]}),N&&i.jsx("div",{style:{position:"fixed",left:0,top:0,width:"100vw",height:"100vh",background:"rgba(40,40,80,0.18)",zIndex:1e4,display:"flex",alignItems:"center",justifyContent:"center"},children:i.jsxs("div",{style:{background:"#fff",borderRadius:18,boxShadow:"0 4px 24px #6B5BFF33",padding:28,minWidth:280,maxWidth:340,width:"90vw",position:"relative",display:"flex",flexDirection:"column",gap:12},children:[i.jsx("button",{type:"button",onClick:()=>O(!1),style:{position:"absolute",top:10,right:12,background:"none",border:"none",fontSize:22,color:"#888",cursor:"pointer",fontWeight:700},children:"×"}),i.jsxs("div",{style:{fontWeight:800,fontSize:18,color:"#6B5BFF",textAlign:"center",marginBottom:2},children:[((rn=(Nt=(Et=Yt[o])==null?void 0:Et.modals)==null?void 0:Nt.provide)==null?void 0:rn.messageTo)||"留言給：",t.nickname]}),i.jsx("textarea",{value:V,onChange:mt=>X(mt.target.value),rows:3,maxLength:100,placeholder:((Ur=(Vr=(on=Yt[o])==null?void 0:on.modals)==null?void 0:Vr.provide)==null?void 0:Ur.messagePlaceholder)||"請輸入留言...",style:{border:"1px solid #e0e7ff",borderRadius:8,padding:"6px 10px",fontSize:15,resize:"none"}}),i.jsx("button",{onClick:async()=>{O(!1);try{await fetch("/api/send-message",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:V,toUid:t.uid,toEmail:t.email,toNickname:t.nickname,fromUid:window.currentUserUid||"",fromEmail:window.currentUserEmail||"",fromNickname:window.currentUserNickname||""})}),j(!0),setTimeout(()=>j(!1),1500)}catch{alert("留言發送失敗，請稍後再試")}},style:{background:"linear-gradient(90deg, #6e8efb, #a777e3)",color:"#fff",border:"none",borderRadius:14,padding:"6px 18px",fontWeight:700,fontSize:15,cursor:"pointer",alignSelf:"center"},children:((Gi=(sn=(Po=Yt[o])==null?void 0:Po.modals)==null?void 0:sn.provide)==null?void 0:Gi.sendMessage)||"送出留言"})]})}),z&&i.jsx("div",{style:{position:"fixed",left:0,top:0,width:"100vw",height:"100vh",background:"rgba(40,40,80,0.08)",zIndex:10001,display:"flex",alignItems:"center",justifyContent:"center"},children:i.jsx("div",{style:{background:"#fff",borderRadius:14,boxShadow:"0 2px 12px #ffb74d55",padding:"18px 32px",fontWeight:700,color:"#ff4d4f",fontSize:18},children:((vi=(bi=(pr=Yt[o])==null?void 0:pr.modals)==null?void 0:bi.provide)==null?void 0:vi.messageSent)||"需求已成功送出！"})})]})})}function F3({open:n,onClose:e,userInfo:t,onSubmit:r,showMsgSent:o}){const{lang:a}=Mt(),c=CI(a),[d,h]=v.useState([]),[m,g]=v.useState(""),[x,S]=v.useState([]),[C,_]=v.useState(""),[I,T]=v.useState([]),[F,P]=v.useState(""),[B,q]=v.useState(c.helpType[0]),[te,W]=v.useState(""),[L,R]=v.useState(c.frequency[0]),[A,N]=v.useState(""),[O,z]=v.useState(!1),[j,V]=v.useState(""),[X,$]=v.useState(!1);if(!n)return null;const ne=(J,Q,D)=>{Q(J.includes(D)?J.filter(G=>G!==D):[...J,D])},oe=async J=>{J.preventDefault();try{console.log("NeedHelpModal 開始提交數據"),await r({exp:d,expOther:m,adv:x,advOther:C,target:I,targetOther:F,helpType:B,statement:te,freq:L,freqOther:A}),console.log("NeedHelpModal 數據提交成功")}catch(Q){console.error("NeedHelpModal 數據提交失敗:",Q)}};return i.jsx("div",{style:{position:"fixed",zIndex:9999,left:0,top:0,width:"100vw",height:"100vh",background:"rgba(40,40,80,0.18)",display:"flex",alignItems:"center",justifyContent:"center",padding:"16px"},children:i.jsxs("form",{onSubmit:oe,style:{background:"#fff",borderRadius:24,boxShadow:"0 8px 40px #6B5BFF33",padding:24,minWidth:360,width:"100%",maxWidth:"500px",position:"relative",display:"flex",flexDirection:"column",gap:18,maxHeight:"calc(100vh - 32px)"},children:[i.jsx("button",{type:"button",onClick:e,style:{position:"absolute",top:18,right:18,background:"none",border:"none",fontSize:26,color:"#888",cursor:"pointer",fontWeight:700,zIndex:1},children:"×"}),i.jsxs("div",{style:{overflow:"auto",flex:1,paddingRight:"8px",paddingBottom:"8px",maxHeight:"calc(100vh - 120px)"},children:[i.jsx("div",{style:{fontWeight:900,fontSize:22,color:"#ff4d4f",textAlign:"center",marginBottom:2},children:"我需要幫助"}),i.jsx("div",{style:{color:"#888",fontSize:15,textAlign:"center",marginBottom:8},children:"請描述你遇到的困難或需要協助的地方，讓社群夥伴能更好幫助你！"}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:14,marginBottom:6},children:[i.jsx("img",{src:t.avatarUrl,alt:"avatar",style:{width:54,height:54,borderRadius:"50%",border:"2px solid #e0e7ff",objectFit:"cover"}}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:2},children:[i.jsx("span",{style:{color:"#1976d2",fontWeight:700,cursor:"pointer",textDecoration:"underline"},onClick:()=>z(!0),children:t.nickname}),i.jsx("span",{style:{color:"#1976d2",fontWeight:500,cursor:"pointer",textDecoration:"underline"},onClick:()=>window.open(`mailto:${t.email}`),children:t.email}),i.jsxs("span",{style:{color:"#555",fontSize:14},children:[t.country,"｜",t.gender,"｜",t.age]})]})]}),i.jsx("div",{style:{fontWeight:700,marginTop:8,fontSize:15},children:"我的經歷（可複選）："}),i.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:8,fontSize:14},children:[c.experience.map(J=>i.jsxs("label",{style:{display:"flex",alignItems:"center",gap:4,fontWeight:500},children:[i.jsx("input",{type:"checkbox",checked:d.includes(J),onChange:()=>ne(d,h,J)}),J]},J)),i.jsx("input",{placeholder:"其他...",value:m,onChange:J=>g(J.target.value),style:{border:"1px solid #e0e7ff",borderRadius:8,padding:"2px 8px",minWidth:60,fontSize:14}})]}),i.jsx("div",{style:{fontWeight:700,marginTop:8,fontSize:15},children:"我的現狀(可複選)："}),i.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:8,fontSize:14},children:[c.advantage.map(J=>i.jsxs("label",{style:{display:"flex",alignItems:"center",gap:4,fontWeight:500},children:[i.jsx("input",{type:"checkbox",checked:x.includes(J),onChange:()=>ne(x,S,J)}),J]},J)),i.jsx("input",{placeholder:"其他...",value:C,onChange:J=>_(J.target.value),style:{border:"1px solid #e0e7ff",borderRadius:8,padding:"2px 8px",minWidth:60,fontSize:14}})]}),i.jsx("div",{style:{fontWeight:700,marginTop:8,fontSize:15},children:"我遇到的困難/需求（可複選）："}),i.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:8,fontSize:14},children:[c.target.map(J=>i.jsxs("label",{style:{display:"flex",alignItems:"center",gap:4,fontWeight:500},children:[i.jsx("input",{type:"checkbox",checked:I.includes(J),onChange:()=>ne(I,T,J)}),J]},J)),i.jsx("input",{placeholder:"其他...",value:F,onChange:J=>P(J.target.value),style:{border:"1px solid #e0e7ff",borderRadius:8,padding:"2px 8px",minWidth:60,fontSize:14}})]}),i.jsx("div",{style:{fontWeight:700,marginTop:8,fontSize:15},children:"希望獲得協助形式："}),i.jsx("div",{style:{display:"flex",gap:16,fontSize:14},children:c.helpType.map(J=>i.jsxs("label",{style:{display:"flex",alignItems:"center",gap:4,fontWeight:500},children:[i.jsx("input",{type:"radio",name:"helptype",checked:B===J,onChange:()=>q(J)}),J]},J))}),i.jsx("div",{style:{fontWeight:700,marginTop:8,fontSize:15},children:"補充說明（50字內）："}),i.jsx("input",{maxLength:50,value:te,onChange:J=>W(J.target.value),placeholder:"請輸入...",style:{border:"1px solid #e0e7ff",borderRadius:8,padding:"4px 10px",fontSize:14}}),i.jsxs("div",{style:{color:"#888",fontSize:13,textAlign:"right",marginTop:-8},children:[te.length,"/50"]}),i.jsx("div",{style:{fontWeight:700,marginTop:8,fontSize:15},children:"希望獲得協助頻率："}),i.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:16,fontSize:14},children:[c.frequency.map(J=>i.jsxs("label",{style:{display:"flex",alignItems:"center",gap:4,fontWeight:500,marginRight:12},children:[i.jsx("input",{type:"radio",name:"freq",checked:L===J,onChange:()=>R(J)}),J]},J)),i.jsx("input",{placeholder:"其他...",value:A,onChange:J=>N(J.target.value),style:{border:"1px solid #e0e7ff",borderRadius:8,padding:"2px 8px",minWidth:60,fontSize:14}})]}),i.jsxs("div",{style:{display:"flex",gap:18,marginTop:18,justifyContent:"center",padding:"8px 0",minHeight:"44px",background:"#fff",zIndex:10,borderTop:"1px solid #f0f0f0"},children:[i.jsx("button",{type:"button",onClick:e,style:{background:"#eee",color:"#555",border:"none",borderRadius:18,padding:"8px 28px",fontWeight:700,fontSize:16,cursor:"pointer",minHeight:"44px",touchAction:"manipulation",flex:1,maxWidth:"120px"},children:"取消"}),i.jsx("button",{type:"submit",style:{background:"linear-gradient(90deg, #6e8efb, #a777e3)",color:"#fff",border:"none",borderRadius:18,padding:"8px 28px",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:"0 2px 8px #a777e355",minHeight:"44px",touchAction:"manipulation",flex:1,maxWidth:"120px"},children:"送出"})]})]}),O&&i.jsx("div",{style:{position:"fixed",left:0,top:0,width:"100vw",height:"100vh",background:"rgba(40,40,80,0.18)",zIndex:1e4,display:"flex",alignItems:"center",justifyContent:"center"},children:i.jsxs("div",{style:{background:"#fff",borderRadius:18,boxShadow:"0 4px 24px #6B5BFF33",padding:28,minWidth:280,maxWidth:340,width:"90vw",position:"relative",display:"flex",flexDirection:"column",gap:12},children:[i.jsx("button",{type:"button",onClick:()=>z(!1),style:{position:"absolute",top:10,right:12,background:"none",border:"none",fontSize:22,color:"#888",cursor:"pointer",fontWeight:700},children:"×"}),i.jsxs("div",{style:{fontWeight:800,fontSize:18,color:"#6B5BFF",textAlign:"center",marginBottom:2},children:["留言給：",t.nickname]}),i.jsx("textarea",{value:j,onChange:J=>V(J.target.value),rows:3,maxLength:100,placeholder:"請輸入留言...",style:{border:"1px solid #e0e7ff",borderRadius:8,padding:"6px 10px",fontSize:15,resize:"none"}}),i.jsx("button",{onClick:async()=>{z(!1);try{await fetch("/api/send-message",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:j,toUid:t.uid,toEmail:t.email,toNickname:t.nickname,fromUid:window.currentUserUid||"",fromEmail:window.currentUserEmail||"",fromNickname:window.currentUserNickname||""})}),$(!0),setTimeout(()=>$(!1),1500)}catch{alert("留言發送失敗，請稍後再試")}},style:{background:"linear-gradient(90deg, #6e8efb, #a777e3)",color:"#fff",border:"none",borderRadius:14,padding:"6px 18px",fontWeight:700,fontSize:15,cursor:"pointer",alignSelf:"center"},children:"送出留言"})]})}),X&&i.jsx("div",{style:{position:"fixed",left:0,top:0,width:"100vw",height:"100vh",background:"rgba(40,40,80,0.08)",zIndex:10001,display:"flex",alignItems:"center",justifyContent:"center"},children:i.jsx("div",{style:{background:"#fff",borderRadius:14,boxShadow:"0 2px 12px #ffb74d55",padding:"18px 32px",fontWeight:700,color:"#ff4d4f",fontSize:18},children:"需求已成功送出！"})})]})})}function z3(){var Ve,Xe,Je,He;const{lang:n}=Mt(),e=P3(n),t=fe=>{var _e;const Te={"zh-TW":{title:"互相幫助&合作實驗室",provide:"提供幫助",supply:"供應圈",need:"需要幫助",room:"互助房",intro:"在重啟的路上，我們都需要彼此的支持。請選擇你想要參與的方式：",introNeed:"如果你正在經歷困難，請告訴我們，社群夥伴會主動協助你。",needBtn:"我需要幫助",rule:"※ 所有資訊僅供社群內部交流使用，請尊重彼此隱私",msgTo:"留言給：",msgPlaceholder:"請輸入留言...",msgSent:"留言發送成功！",backToHome:"返回首頁",back:"返回",date:"日期",avatar:"頭像",name:"名稱",gender:"性別",age:"年齡",country:"國家"},"zh-CN":{title:"互相帮助&合作实验室",provide:"提供帮助",supply:"供应圈",need:"需要帮助",room:"互助房",intro:"在重启的路上，我们都需要彼此的支持。请选择你想要参与的方式：",introNeed:"如果你正在经历困难，请告诉我们，社群伙伴会主动协助你。",needBtn:"我需要帮助",rule:"※ 所有信息仅供社群内部交流使用，请尊重彼此隐私",msgTo:"留言给：",msgPlaceholder:"请输入留言...",msgSent:"留言发送成功！",backToHome:"返回首页",back:"返回",date:"日期",avatar:"头像",name:"名称",gender:"性别",age:"年龄",country:"国家"},en:{title:"Mutual Help & Cooperation Laboratory",provide:"Provide Help",supply:"Supply Circle",need:"Need Help",room:"Mutual Aid Room",intro:"On the restart journey, we all need each other's support. Please choose how you want to participate:",introNeed:"If you are experiencing difficulties, please tell us, and community partners will actively assist you.",needBtn:"I Need Help",rule:"※ All information is for internal community communication only, please respect each other's privacy",msgTo:"Message to:",msgPlaceholder:"Please enter message...",msgSent:"Message sent successfully!",backToHome:"Back to Home",back:"Back",date:"Date",avatar:"Avatar",name:"Name",gender:"Gender",age:"Age",country:"Country"},ja:{title:"相互支援&協力実験室",provide:"支援を提供",supply:"供給サークル",need:"支援が必要",room:"相互扶助の部屋",intro:"再出発の道のりで、私たちは皆お互いのサポートが必要です。参加したい方法を選択してください：",introNeed:"困難を経験している場合は、お知らせください。コミュニティのパートナーが積極的にサポートします。",needBtn:"支援が必要です",rule:"※ すべての情報はコミュニティ内の交流のみに使用され、お互いのプライバシーを尊重してください",msgTo:"メッセージを送る：",msgPlaceholder:"メッセージを入力してください...",msgSent:"メッセージが正常に送信されました！",backToHome:"ホームへ戻る",back:"戻る",date:"日付",avatar:"アバター",name:"名前",gender:"性別",age:"年齢",country:"国"},ko:{title:"상호 도움&협력 실험실",provide:"도움 제공",supply:"공급 서클",need:"도움 필요",room:"상호 원조 방",intro:"재시작 여정에서 우리 모두는 서로의 지원이 필요합니다. 참여하고 싶은 방법을 선택하세요:",introNeed:"어려움을 겪고 있다면 알려주세요. 커뮤니티 파트너가 적극적으로 도와드릴 것입니다.",needBtn:"도움이 필요합니다",rule:"※ 모든 정보는 커뮤니티 내부 교류용으로만 사용되며, 서로의 개인정보를 존중해 주세요",msgTo:"메시지 보내기:",msgPlaceholder:"메시지를 입력하세요...",msgSent:"메시지가 성공적으로 전송되었습니다!",backToHome:"홈으로 돌아가기",back:"돌아가기",date:"날짜",avatar:"아바타",name:"이름",gender:"성별",age:"나이",country:"국가"},vi:{title:"Phòng thí nghiệm trợ giúp",provide:"Cung cấp trợ giúp",supply:"Vòng tròn cung cấp",need:"Cần trợ giúp",room:"Phòng hỗ trợ lẫn nhau",intro:"Trên hành trình khởi động lại, tất cả chúng ta đều cần sự hỗ trợ của nhau. Vui lòng chọn cách bạn muốn tham gia:",introNeed:"Nếu bạn đang gặp khó khăn, hãy cho chúng tôi biết, các đối tác cộng đồng sẽ tích cực hỗ trợ bạn.",needBtn:"Tôi cần trợ giúp",rule:"※ Tất cả thông tin chỉ dành cho giao tiếp nội bộ cộng đồng, vui lòng tôn trọng quyền riêng tư của nhau",msgTo:"Nhắn tin cho:",msgPlaceholder:"Vui lòng nhập tin nhắn...",msgSent:"Tin nhắn đã được gửi thành công!",backToHome:"Về trang chủ",back:"Quay lại",date:"Ngày",avatar:"Ảnh đại diện",name:"Tên",gender:"Giới tính",age:"Tuổi",country:"Quốc gia"},th:{title:"ห้องทดลองช่วยเหลือ",provide:"ให้ความช่วยเหลือ",supply:"วงกลมอุปทาน",need:"ต้องการความช่วยเหลือ",room:"ห้องช่วยเหลือซึ่งกันและกัน",intro:"ในการเดินทางเริ่มต้นใหม่ เราทุกคนต้องการการสนับสนุนจากกันและกัน กรุณาเลือกวิธีที่คุณต้องการมีส่วนร่วม:",introNeed:"หากคุณกำลังประสบความยากลำบาก กรุณาบอกเรา คู่ค้าชุมชนจะช่วยเหลือคุณอย่างกระตือรือร้น",needBtn:"ฉันต้องการความช่วยเหลือ",rule:"※ ข้อมูลทั้งหมดใช้สำหรับการสื่อสารภายในชุมชนเท่านั้น กรุณาเคารพความเป็นส่วนตัวของกันและกัน",msgTo:"ส่งข้อความถึง:",msgPlaceholder:"กรุณาป้อนข้อความ...",msgSent:"ส่งข้อความสำเร็จแล้ว!",backToHome:"กลับหน้าหลัก",back:"กลับ",date:"วันที่",avatar:"รูปโปรไฟล์",name:"ชื่อ",gender:"เพศ",age:"อายุ",country:"ประเทศ"},ms:{title:"Makmal Bantuan & Kerjasama Bersama",provide:"Sediakan Bantuan",supply:"Bulatan Bekalan",need:"Memerlukan Bantuan",room:"Bilik Bantuan Bersama",intro:"Dalam perjalanan memulakan semula, kita semua memerlukan sokongan antara satu sama lain. Sila pilih cara anda ingin mengambil bahagian:",introNeed:"Jika anda menghadapi kesukaran, sila beritahu kami, rakan kongsi komuniti akan membantu anda secara aktif.",needBtn:"Saya Memerlukan Bantuan",rule:"※ Semua maklumat adalah untuk komunikasi dalaman komuniti sahaja, sila hormati privasi antara satu sama lain",msgTo:"Mesej kepada:",msgPlaceholder:"Sila masukkan mesej...",msgSent:"Mesej berjaya dihantar!",backToHome:"Kembali ke Laman Utama",back:"Kembali",date:"Tarikh",avatar:"Avatar",name:"Nama",gender:"Jantina",age:"Umur",country:"Negara"},la:{title:"Laboratorium Auxilii",provide:"Praebere Auxilium",supply:"Copiae Circulus",need:"Egere Auxilii",room:"Mutuum Auxilium Cubiculum",intro:"In itinere redintegrationis, omnes indigemus sustentatione mutua. Quaeso elige quomodo participare vis:",introNeed:"Si difficultates patieris, quaeso nobis dic, socii communitatis te active adiuvabunt.",needBtn:"Egeo Auxilii",rule:"※ Omnia notitia ad communicationem internam communitatis tantum sunt, quaeso honora privaciam inter se",msgTo:"Nuntius ad:",msgPlaceholder:"Quaeso intra nuntium...",msgSent:"Nuntius feliciter missus est!",backToHome:"Ad domum redire",back:"Redire",date:"Dies",avatar:"Imago",name:"Nomen",gender:"Sexus",age:"Aetas",country:"Patria"}};return((_e=Te[n])==null?void 0:_e[fe])||Te["zh-TW"][fe]||fe},[r,o]=v.useState(!1),[a,c]=v.useState({avatarUrl:"/ctx-logo.png",nickname:"",email:"",country:"",gender:"",age:""}),[d,h]=v.useState("provide"),[m,g]=v.useState([]),[x,S]=v.useState(null),_=St(Ao).currentUser,[I,T]=v.useState(""),[F,P]=v.useState(!1),[B,q]=v.useState(null),[te,W]=v.useState(""),[L,R]=v.useState(!1),[A,N]=v.useState(!1),[O,z]=v.useState([]),[j,V]=v.useState(""),[X,$]=v.useState(!1),[ne,oe]=v.useState(!1),[J,Q]=v.useState([]),[D,G]=v.useState(!1),[ie,ee]=v.useState({});v.useEffect(()=>{if(!_)return;(async()=>{try{const Te=await Cs(Vn(Wt,"profiles",_.uid)),_e=Te.exists()?Te.data():{};let Fe=!1;const Be={};if(_e.country||(Be.country="台灣",Fe=!0),_e.gender||(Be.gender="男",Fe=!0),_e.age||(Be.age="30",Fe=!0),Fe){const{setDoc:K}=await ud(async()=>{const{setDoc:Ue}=await Promise.resolve().then(()=>ef);return{setDoc:Ue}},void 0);await K(Vn(Wt,"profiles",_.uid),{..._e,...Be},{merge:!0});const re=await Cs(Vn(Wt,"profiles",_.uid)),H=re.exists()?re.data():{};c({avatarUrl:H.avatar||_.photoURL||"/ctx-logo.png",nickname:H.nickname||_.displayName||"Restarter",email:H.email||_.email||"",country:H.country||"",gender:H.gender||"",age:H.age||""});return}c({avatarUrl:_e.avatar||_.photoURL||"/ctx-logo.png",nickname:_e.nickname||_.displayName||"Restarter",email:_e.email||_.email||"",country:_e.country||"",gender:_e.gender||"",age:_e.age||""})}catch{c({avatarUrl:_.photoURL||"/ctx-logo.png",nickname:_.displayName||"Restarter",email:_.email||"",country:"",gender:"",age:""})}})()},[_]);async function Se(fe){try{if(console.log("開始保存提供幫助數據:",fe),console.log("用戶信息:",a),console.log("當前用戶:",_),!_){console.error("用戶未登入"),T("❌ 請先登入後再送出"),setTimeout(()=>T(""),3e3);return}const Te=await ys(Cn(Wt,"helpSupplies"),{...fe,type:"provide",avatarUrl:a.avatarUrl,nickname:a.nickname,email:a.email,country:a.country,gender:a.gender,age:a.age,createdAt:Gt.now(),uid:(_==null?void 0:_.uid)||""});console.log("數據保存成功，文檔ID:",Te.id),o(!1),T("🎉 已成功送出，感謝你的溫暖分享！"),setTimeout(()=>T(""),3e3),we()}catch(Te){console.error("保存提供幫助數據失敗:",Te),T("❌ 保存失敗，請稍後再試"),setTimeout(()=>T(""),3e3)}}async function we(){try{console.log("開始獲取供應圈列表");const fe=hr(Cn(Wt,"helpSupplies"),Rn("type","==","provide")),Fe=(await Mr(fe)).docs.map(Be=>({id:Be.id,...Be.data()})).sort((Be,K)=>{var Ue,ue,le,Re;const re=((ue=(Ue=Be.createdAt)==null?void 0:Ue.toDate)==null?void 0:ue.call(Ue))||new Date(Be.createdAt);return(((Re=(le=K.createdAt)==null?void 0:le.toDate)==null?void 0:Re.call(le))||new Date(K.createdAt))-re});console.log("獲取到的供應圈數據:",Fe),g(Fe)}catch(fe){console.error("獲取供應圈列表失敗:",fe),T("❌ 獲取數據失敗，請稍後再試"),setTimeout(()=>T(""),3e3)}}v.useEffect(()=>{d==="supply"&&we()},[d]);async function Oe(fe,Te){if(console.log("留言送出偵錯：",{user:_,fromUid:_==null?void 0:_.uid,toUid:fe==null?void 0:fe.uid,fromEmail:_==null?void 0:_.email,toEmail:fe==null?void 0:fe.email,content:Te}),!_){V("偵錯：user 為 null，請確認已登入");return}if(!_.uid){V("偵錯：user.uid 為空");return}if(!(fe!=null&&fe.uid)){V("偵錯：toUser.uid 為空");return}if(!Te.trim()){V("請輸入留言內容");return}$(!0),V("");try{await ys(Cn(Wt,"messages"),{toUid:fe.uid,toEmail:fe.email,toNickname:fe.nickname,fromUid:_.uid,fromEmail:_.email,fromNickname:a.nickname,content:Te,timestamp:Gt.now(),read:!1}),R(!0),setTimeout(()=>{P(!1),R(!1),W("")},1500)}catch(_e){V("留言發送失敗，請稍後再試 (偵錯: "+((_e==null?void 0:_e.message)||_e)+")")}finally{$(!1)}}async function Ne(){if(!_)return;const fe=hr(Cn(Wt,"messages"),Rn("toUid","==",_.uid),Rn("read","==",!1)),Te=await Mr(fe);z(Te.docs.map(_e=>({id:_e.id,..._e.data()})))}v.useEffect(()=>{Ne()},[_,A]);async function Ye(fe){await Jp(Vn(Wt,"messages",fe),{read:!0}),Ne()}async function it(fe){try{if(console.log("開始保存需要幫助數據:",fe),console.log("用戶信息:",a),console.log("當前用戶:",_),!_){console.error("用戶未登入"),T("❌ 請先登入後再送出"),setTimeout(()=>T(""),3e3);return}const Te=await ys(Cn(Wt,"helpSupplies"),{...fe,type:"need",avatarUrl:a.avatarUrl,nickname:a.nickname,email:a.email,country:a.country,gender:a.gender,age:a.age,createdAt:Gt.now(),uid:(_==null?void 0:_.uid)||""});console.log("數據保存成功，文檔ID:",Te.id),G(!0),setTimeout(()=>{G(!1),oe(!1)},1800),T("🎉 你的需求已送出，社群夥伴會看到！"),setTimeout(()=>T(""),3e3),me()}catch(Te){console.error("保存需要幫助數據失敗:",Te),T("❌ 保存失敗，請稍後再試"),setTimeout(()=>T(""),3e3)}}async function me(){try{console.log("開始獲取需要幫助列表");const fe=hr(Cn(Wt,"helpSupplies"),Rn("type","==","need")),Fe=(await Mr(fe)).docs.map(Be=>({id:Be.id,...Be.data()})).sort((Be,K)=>{var Ue,ue,le,Re;const re=((ue=(Ue=Be.createdAt)==null?void 0:Ue.toDate)==null?void 0:ue.call(Ue))||new Date(Be.createdAt);return(((Re=(le=K.createdAt)==null?void 0:le.toDate)==null?void 0:Re.call(le))||new Date(K.createdAt))-re});console.log("獲取到的需要幫助數據:",Fe),Q(Fe)}catch(fe){console.error("獲取需要幫助列表失敗:",fe),T("❌ 獲取數據失敗，請稍後再試"),setTimeout(()=>T(""),3e3)}}return v.useEffect(()=>{d==="room"&&me()},[d]),i.jsxs("div",{style:{minHeight:"100vh",background:"linear-gradient(135deg, #f8fafc 0%, #e0e7ff 100%)",padding:"0 0 48px 0",position:"relative"},children:[A&&i.jsxs(i.Fragment,{children:[i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.3)",zIndex:1e4},onClick:()=>N(!1)}),i.jsxs("div",{style:{position:"fixed",top:70,right:36,background:"#fff",borderRadius:18,boxShadow:"0 4px 24px #6B5BFF33",padding:24,minWidth:320,zIndex:10001},children:[i.jsx("div",{style:{fontWeight:900,fontSize:20,color:"#6B5BFF",marginBottom:12},children:((Xe=(Ve=Yt[n])==null?void 0:Ve.messages)==null?void 0:Xe.inboxTitle)||"站內訊息"}),O.length===0&&i.jsx("div",{style:{color:"#888",fontSize:15},children:((He=(Je=Yt[n])==null?void 0:Je.messages)==null?void 0:He.noMessages)||"目前沒有新訊息"}),O.map(fe=>{var Te,_e,Fe,Be,K,re,H,Ue,ue,le;return i.jsxs("div",{style:{background:"#f7f7ff",borderRadius:12,padding:12,marginBottom:12,boxShadow:"0 2px 8px #6B5BFF11",cursor:"pointer"},onClick:()=>{ee(Re=>({...Re,[fe.id]:!Re[fe.id]}))},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[i.jsxs("div",{style:{fontWeight:700,color:"#1976d2"},children:[fe.fromNickname," ",((_e=(Te=Yt[n])==null?void 0:Te.messages)==null?void 0:_e.messageFrom)||"給你的留言："]}),i.jsx("span",{style:{fontSize:12,color:"#888"},children:ie[fe.id]?"收起":"展開"})]}),ie[fe.id]&&i.jsxs("div",{style:{background:"rgba(255,255,255,0.8)",borderRadius:8,padding:12,marginBottom:8,border:"1px solid #e0e7ff"},children:[i.jsx("div",{style:{color:"#232946",marginBottom:8,lineHeight:"1.5"},children:fe.content}),i.jsx("div",{style:{color:"#888",fontSize:13,marginBottom:8},children:(re=(Be=(Fe=fe.timestamp)==null?void 0:Fe.toDate)==null?void 0:(K=Be.call(Fe)).toLocaleString)==null?void 0:re.call(K)}),i.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:[i.jsx("a",{href:`mailto:${fe.fromEmail}`,style:{color:"#6B5BFF",fontWeight:700,textDecoration:"underline",fontSize:13},children:((Ue=(H=Yt[n])==null?void 0:H.messages)==null?void 0:Ue.contactUser)||"聯絡對方"}),i.jsx("button",{onClick:Re=>{Re.stopPropagation(),Ye(fe.id)},style:{background:"#eee",color:"#6B5BFF",border:"none",borderRadius:6,padding:"4px 12px",fontWeight:700,fontSize:13,cursor:"pointer"},children:((le=(ue=Yt[n])==null?void 0:ue.messages)==null?void 0:le.markRead)||"標記已讀"})]})]}),!ie[fe.id]&&i.jsx("div",{style:{color:"#666",fontSize:14,fontStyle:"italic"},children:fe.content.length>30?`${fe.content.substring(0,30)}...`:fe.content})]},fe.id)})]})]}),I&&i.jsx("div",{style:{position:"fixed",top:40,left:"50%",transform:"translateX(-50%)",background:"#fff",color:"#6B5BFF",fontWeight:700,fontSize:18,borderRadius:16,boxShadow:"0 4px 24px #6B5BFF22",padding:"18px 36px",zIndex:99999,textAlign:"center",letterSpacing:1},children:I}),i.jsx("button",{onClick:()=>window.location.href="/",style:{position:"absolute",top:"20px",left:"20px",zIndex:1e3,fontWeight:700,fontSize:16,padding:"8px 16px",borderRadius:8,border:"1.5px solid #6B5BFF",background:"#fff",color:"#6B5BFF",cursor:"pointer",minWidth:80,boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:t("back")}),i.jsx("div",{style:{width:"100%",maxWidth:700,margin:"20px auto 20px auto",padding:"16px 24px",background:"rgba(255,255,255,0.95)",borderRadius:16,boxShadow:"0 4px 20px rgba(0,0,0,0.1)",display:"flex",alignItems:"center",justifyContent:"center",position:"relative"},children:i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,justifyContent:"center"},children:[i.jsxs("h1",{style:{fontWeight:900,fontSize:18,color:"#6B5BFF",margin:0,lineHeight:1,textShadow:"0 2px 8px #6B5BFF88",textAlign:"center"},children:[i.jsx("span",{role:"img","aria-label":"helplab",children:"🧪"})," ",t("title")]}),i.jsxs("button",{onClick:()=>N(fe=>!fe),style:{background:"none",border:"none",cursor:"pointer",position:"relative",padding:"8px",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",marginLeft:8},children:[i.jsx("span",{style:{fontSize:24,color:"#6B5BFF"},children:"🔔"}),O.length>0&&i.jsx("span",{style:{position:"absolute",top:0,right:0,minWidth:18,height:18,background:"#ff4d4f",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",border:"2px solid #fff",color:"#fff",fontWeight:900,fontSize:13,padding:"0 5px",boxShadow:"0 2px 8px #ff4d4f88",zIndex:1},children:O.length})]})]})}),i.jsxs("div",{style:{maxWidth:600,margin:"0 auto",padding:"20px 16px 0 16px",background:"#fff",borderRadius:32,boxShadow:"0 8px 40px #b6b6f633, 0 1.5px 8px #6B5BFF22",border:"1.5px solid #e0e7ff"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:24,marginBottom:24},children:[i.jsx("button",{onClick:()=>h("provide"),style:{fontWeight:900,fontSize:18,color:d==="provide"?"#6B5BFF":"#888",background:"#fff",border:d==="provide"?"3px solid #6B5BFF":"2px solid #e0e7ff",borderRadius:16,boxShadow:"0 2px 8px #b6b6f633",padding:"8px 24px",cursor:"pointer",marginBottom:2},children:t("provide")}),i.jsx("button",{onClick:()=>h("supply"),style:{fontWeight:900,fontSize:18,color:d==="supply"?"#6B5BFF":"#888",background:"#fff",border:d==="supply"?"3px solid #6B5BFF":"2px solid #e0e7ff",borderRadius:16,boxShadow:"0 2px 8px #b6b6f633",padding:"8px 24px",cursor:"pointer",marginBottom:2},children:t("supply")}),i.jsx("button",{onClick:()=>h("need"),style:{fontWeight:900,fontSize:18,color:d==="need"?"#ff4d4f":"#888",background:"#fff",border:d==="need"?"3px solid #ff4d4f":"2px solid #e0e7ff",borderRadius:16,boxShadow:"0 2px 8px #ffb74d55",padding:"8px 24px",cursor:"pointer",marginBottom:2},children:t("need")}),i.jsx("button",{onClick:()=>h("room"),style:{fontWeight:900,fontSize:18,color:d==="room"?"#ff4d4f":"#888",background:"#fff",border:d==="room"?"3px solid #ff4d4f":"2px solid #e0e7ff",borderRadius:16,boxShadow:"0 2px 8px #ffb74d55",padding:"8px 24px",cursor:"pointer",marginBottom:2},children:t("room")})]}),d==="provide"&&i.jsxs(i.Fragment,{children:[i.jsx("p",{style:{textAlign:"center",color:"#555",fontSize:18,marginBottom:36},children:t("intro")}),i.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:32,justifyContent:"center"},children:e.map((fe,Te)=>i.jsxs("div",{style:{background:fe.color,borderRadius:20,boxShadow:"0 4px 24px #0001",padding:"32px 28px",minWidth:260,maxWidth:320,flex:"1 1 260px",display:"flex",flexDirection:"column",alignItems:"center",marginBottom:12},children:[i.jsx("div",{style:{fontSize:48,marginBottom:12},children:fe.emoji}),i.jsx("div",{style:{fontWeight:800,fontSize:22,marginBottom:8,color:"#333",letterSpacing:1},children:fe.title}),i.jsx("div",{style:{color:"#666",fontSize:15,marginBottom:18,textAlign:"center",minHeight:44},children:fe.desc}),Te===0?i.jsx("button",{onClick:()=>{h("provide"),o(!0)},style:{background:"linear-gradient(90deg, #6e8efb, #a777e3)",color:"#fff",border:"none",borderRadius:24,padding:"10px 28px",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:"0 2px 8px #a777e355",marginTop:"auto",transition:"background 0.2s"},children:fe.btn}):Te===1?i.jsx("button",{onClick:()=>{h("need"),oe(!0)},style:{background:"linear-gradient(90deg, #ff4d4f, #ffb74d)",color:"#fff",border:"none",borderRadius:24,padding:"10px 28px",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:"0 2px 8px #ffb74d55",marginTop:"auto",transition:"background 0.2s"},children:fe.btn}):Te===2?i.jsx("button",{onClick:()=>h("supply"),style:{background:"linear-gradient(90deg, #6e8efb, #a777e3)",color:"#fff",border:"none",borderRadius:24,padding:"10px 28px",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:"0 2px 8px #a777e355",marginTop:"auto",transition:"background 0.2s"},children:fe.btn}):i.jsx("button",{onClick:()=>h("room"),style:{background:"linear-gradient(90deg, #ff4d4f, #ffb74d)",color:"#fff",border:"none",borderRadius:24,padding:"10px 28px",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:"0 2px 8px #ffb74d55",marginTop:"auto",transition:"background 0.2s"},children:fe.btn})]},Te))}),i.jsx("div",{style:{textAlign:"center",color:"#888",fontSize:15,marginTop:40},children:t("rule")}),i.jsx(B3,{open:r,onClose:()=>o(!1),userInfo:a,onSubmit:Se})]}),d==="supply"&&i.jsx("div",{style:{marginTop:24},children:i.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:15,tableLayout:"fixed"},children:[i.jsxs("colgroup",{children:[i.jsx("col",{style:{width:"28%"}}),i.jsx("col",{style:{width:"14%"}}),i.jsx("col",{style:{width:"22%"}}),i.jsx("col",{style:{width:"12%"}}),i.jsx("col",{style:{width:"12%"}}),i.jsx("col",{style:{width:"12%"}})]}),i.jsx("thead",{children:i.jsxs("tr",{style:{background:"#f3f3ff",color:"#6B5BFF"},children:[i.jsx("th",{style:{padding:"8px 4px",textAlign:"left"},children:t("date")}),i.jsx("th",{style:{textAlign:"center"},children:t("avatar")}),i.jsx("th",{style:{textAlign:"left"},children:t("name")}),i.jsx("th",{style:{textAlign:"center"},children:t("gender")}),i.jsx("th",{style:{textAlign:"center"},children:t("age")}),i.jsx("th",{style:{textAlign:"center"},children:t("country")})]})}),i.jsx("tbody",{children:m.map((fe,Te)=>{var _e,Fe,Be,K;return i.jsxs(En.Fragment,{children:[i.jsxs("tr",{style:{cursor:"pointer",borderBottom:"1px solid #eee"},onClick:()=>S(x===Te?null:Te),children:[i.jsx("td",{children:((K=(Be=(Fe=(_e=fe.createdAt)==null?void 0:_e.toDate)==null?void 0:Fe.call(_e))==null?void 0:Be.toLocaleString)==null?void 0:K.call(Be))||""}),i.jsx("td",{children:i.jsx("img",{src:fe.avatarUrl||"/ctx-logo.png",alt:"avatar",style:{width:36,height:36,borderRadius:"50%"}})}),i.jsx("td",{style:{color:"#1976d2",fontWeight:700,textDecoration:"underline",cursor:"pointer"},onClick:()=>{q(fe),P(!0)},children:fe.nickname}),i.jsx("td",{children:fe.gender}),i.jsx("td",{children:fe.age}),i.jsx("td",{children:fe.country})]}),x===Te&&i.jsx("tr",{children:i.jsxs("td",{colSpan:6,style:{background:"#f8f8ff",padding:18},children:[i.jsx("div",{style:{fontWeight:700,color:"#6B5BFF",marginBottom:8},children:"【你的困難也是我們的困難，讓我們一起面對並解決】"}),i.jsxs("div",{style:{marginBottom:8},children:[i.jsx("b",{children:"經歷："}),(fe.exp||[]).join("、"),fe.expOther?`、${fe.expOther}`:""]}),i.jsxs("div",{style:{marginBottom:8},children:[i.jsx("b",{children:"優勢："}),(fe.adv||[]).join("、"),fe.advOther?`、${fe.advOther}`:""]}),i.jsxs("div",{style:{marginBottom:8},children:[i.jsx("b",{children:"優先幫助對象："}),(fe.target||[]).join("、"),fe.targetOther?`、${fe.targetOther}`:""]}),i.jsxs("div",{style:{marginBottom:8},children:[i.jsx("b",{children:"幫助形式："}),fe.helpType]}),i.jsxs("div",{style:{marginBottom:8},children:[i.jsx("b",{children:"特別聲明："}),fe.statement]}),i.jsxs("div",{style:{marginBottom:8},children:[i.jsx("b",{children:"幫助頻率："}),fe.freq,fe.freqOther?`、${fe.freqOther}`:""]}),i.jsx("div",{style:{marginTop:12},children:i.jsx("a",{href:`mailto:${fe.email}`,style:{color:"#6B5BFF",textDecoration:"underline",marginLeft:12},children:fe.email})})]})})]},fe.id)})})]})}),d==="need"&&i.jsxs(i.Fragment,{children:[i.jsx("p",{style:{textAlign:"center",color:"#555",fontSize:18,marginBottom:36},children:t("introNeed")}),i.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:32,justifyContent:"center"},children:i.jsx("button",{onClick:()=>oe(!0),style:{background:"linear-gradient(90deg, #ff4d4f, #ffb74d)",color:"#fff",border:"none",borderRadius:24,padding:"10px 28px",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:"0 2px 8px #ffb74d55",marginTop:"auto",transition:"background 0.2s"},children:t("needBtn")})}),i.jsx(F3,{open:ne,onClose:()=>oe(!1),userInfo:a,onSubmit:it,showMsgSent:D})]}),d==="room"&&i.jsx("div",{style:{marginTop:24},children:i.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:15},children:[i.jsx("thead",{children:i.jsxs("tr",{style:{background:"#fff3e0",color:"#ff4d4f"},children:[i.jsx("th",{style:{padding:"8px 4px",textAlign:"left"},children:t("date")}),i.jsx("th",{style:{textAlign:"center"},children:t("avatar")}),i.jsx("th",{style:{textAlign:"left"},children:t("name")}),i.jsx("th",{style:{textAlign:"center"},children:t("gender")}),i.jsx("th",{style:{textAlign:"center"},children:t("age")}),i.jsx("th",{style:{textAlign:"center"},children:t("country")})]})}),i.jsx("tbody",{children:J.map((fe,Te)=>{var _e,Fe,Be,K;return i.jsxs(En.Fragment,{children:[i.jsxs("tr",{style:{cursor:"pointer",borderBottom:"1px solid #eee"},onClick:()=>S(x===Te?null:Te),children:[i.jsx("td",{children:((K=(Be=(Fe=(_e=fe.createdAt)==null?void 0:_e.toDate)==null?void 0:Fe.call(_e))==null?void 0:Be.toLocaleString)==null?void 0:K.call(Be))||""}),i.jsx("td",{children:i.jsx("img",{src:fe.avatarUrl||"/ctx-logo.png",alt:"avatar",style:{width:36,height:36,borderRadius:"50%"}})}),i.jsx("td",{style:{color:"#ff4d4f",fontWeight:700,textDecoration:"underline",cursor:"pointer"},onClick:()=>{q(fe),P(!0)},children:fe.nickname}),i.jsx("td",{children:fe.gender}),i.jsx("td",{children:fe.age}),i.jsx("td",{children:fe.country})]}),x===Te&&i.jsx("tr",{children:i.jsxs("td",{colSpan:6,style:{background:"#fff8f0",padding:18},children:[i.jsx("div",{style:{fontWeight:700,color:"#ff4d4f",marginBottom:8},children:"【你的困難我們一起面對，社群夥伴會主動協助你】"}),i.jsxs("div",{style:{marginBottom:8},children:[i.jsx("b",{children:"經歷："}),(fe.exp||[]).join("、"),fe.expOther?`、${fe.expOther}`:""]}),i.jsxs("div",{style:{marginBottom:8},children:[i.jsx("b",{children:"優勢："}),(fe.adv||[]).join("、"),fe.advOther?`、${fe.advOther}`:""]}),i.jsxs("div",{style:{marginBottom:8},children:[i.jsx("b",{children:"困難/需求："}),(fe.target||[]).join("、"),fe.targetOther?`、${fe.targetOther}`:""]}),i.jsxs("div",{style:{marginBottom:8},children:[i.jsx("b",{children:"協助形式："}),fe.helpType]}),i.jsxs("div",{style:{marginBottom:8},children:[i.jsx("b",{children:"補充說明："}),fe.statement]}),i.jsxs("div",{style:{marginBottom:8},children:[i.jsx("b",{children:"協助頻率："}),fe.freq,fe.freqOther?`、${fe.freqOther}`:""]}),i.jsx("div",{style:{marginTop:12},children:i.jsx("a",{href:`mailto:${fe.email}`,style:{color:"#ff4d4f",textDecoration:"underline",marginLeft:12},children:fe.email})})]})})]},fe.id)})})]})})]}),F&&B&&i.jsx("div",{style:{position:"fixed",left:0,top:0,width:"100vw",height:"100vh",background:"rgba(40,40,80,0.18)",zIndex:1e4,display:"flex",alignItems:"center",justifyContent:"center"},children:i.jsxs("div",{style:{background:"#fff",borderRadius:18,boxShadow:"0 4px 24px #6B5BFF33",padding:28,minWidth:280,maxWidth:340,width:"90vw",position:"relative",display:"flex",flexDirection:"column",gap:12},children:[i.jsx("button",{type:"button",onClick:()=>P(!1),style:{position:"absolute",top:10,right:12,background:"none",border:"none",fontSize:22,color:"#888",cursor:"pointer",fontWeight:700},children:"×"}),i.jsxs("div",{style:{fontWeight:800,fontSize:18,color:"#6B5BFF",textAlign:"center",marginBottom:2},children:[t("msgTo"),B.nickname]}),i.jsx("textarea",{value:te,onChange:fe=>W(fe.target.value),rows:3,maxLength:100,placeholder:t("msgPlaceholder"),style:{border:"1px solid #e0e7ff",borderRadius:8,padding:"6px 10px",fontSize:15,resize:"none"}}),j&&i.jsx("div",{style:{color:"#ff4d4f",fontWeight:700,textAlign:"center",marginTop:4},children:j}),i.jsx("button",{onClick:()=>Oe(B,te),disabled:!te.trim()||X,style:{background:"linear-gradient(90deg, #6e8efb, #a777e3)",color:"#fff",border:"none",borderRadius:14,padding:"6px 18px",fontWeight:700,fontSize:15,cursor:!te.trim()||X?"not-allowed":"pointer",alignSelf:"center",opacity:!te.trim()||X?.6:1},children:X?"送出中...":"送出留言"}),L&&i.jsx("div",{style:{color:"#6B5BFF",fontWeight:700,textAlign:"center",marginTop:8},children:t("msgSent")})]})}),i.jsx("div",{style:{width:"100%",margin:"0 auto",marginTop:24,background:"rgba(255,255,255,0.95)",borderRadius:16,padding:"16px",boxShadow:"0 2px 12px #6B5BFF22"},children:i.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:20,flexWrap:"wrap"},children:[i.jsx("a",{href:"/privacy-policy",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12},children:n==="zh-TW"?"隱私權政策":n==="zh-CN"?"隐私政策":n==="en"?"Privacy Policy":n==="ja"?"プライバシーポリシー":n==="ko"?"개인정보 처리방침":n==="th"?"นโยบายความเป็นส่วนตัว":n==="vi"?"Chính sách bảo mật":n==="ms"?"Dasar Privasi":"Consilium de Privata"}),i.jsx("a",{href:"/terms",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12},children:n==="zh-TW"?"條款/聲明":n==="zh-CN"?"条款/声明":n==="en"?"Terms/Statement":n==="ja"?"規約/声明":n==="ko"?"약관/성명":n==="th"?"ข้อกำหนด/แถลงการณ์":n==="vi"?"Điều khoản/Tuyên bố":n==="ms"?"Terma/Pernyataan":"Termini/Declaratio"}),i.jsx("a",{href:"/data-deletion",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12},children:n==="zh-TW"?"資料刪除說明":n==="zh-CN"?"数据删除说明":n==="en"?"Data Deletion":n==="ja"?"データ削除について":n==="ko"?"데이터 삭제 안내":n==="th"?"คำอธิบายการลบข้อมูล":n==="vi"?"Giải thích xóa dữ liệu":n==="ms"?"Penjelasan Penghapusan Data":"Explicatio Deletionis Datae"}),i.jsx("a",{href:"/about",style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12},children:n==="zh-TW"?"🧬 Restarter™｜我們是誰":n==="zh-CN"?"🧬 Restarter™｜我们是谁":n==="en"?"🧬 Restarter™｜Who We Are":n==="ja"?"🧬 Restarter™｜私たちについて":n==="ko"?"🧬 Restarter™｜우리는 누구인가":n==="th"?"🧬 Restarter™｜เราเป็นใคร":n==="vi"?"🧬 Restarter™｜Chúng tôi là ai":n==="ms"?"🧬 Restarter™｜Siapa Kami":"🧬 Restarter™｜Quis sumus"}),i.jsx("a",{href:"/feedback",style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12},children:n==="zh-TW"?"💬 意見箱｜我們想聽你說":n==="zh-CN"?"💬 意见箱｜我们想听你说":n==="en"?"💬 Feedback Box｜We Want to Hear From You":n==="ja"?"💬 ご意見箱｜私たちはあなたの声を聞きたい":n==="ko"?"💬 피드백｜우리는 당신의 말을 듣고 싶습니다":n==="th"?"💬 กล่องความคิดเห็น｜เราอยากได้ยินจากคุณ":n==="vi"?"💬 Hộp góp ý｜Chúng tôi muốn nghe từ bạn":n==="ms"?"💬 Kotak Maklum Balas｜Kami Ingin Mendengar Dari Anda":"💬 Arca Consilii｜Volumus Audire a Te"})]})})]})}const Md=(n,e)=>{try{localStorage.setItem(`emotionRelease_${n}`,JSON.stringify(e))}catch{console.log("無法保存遊戲進度到本地存儲")}},Ld=n=>{try{const e=localStorage.getItem(`emotionRelease_${n}`);return e?JSON.parse(e):null}catch{return console.log("無法從本地存儲載入遊戲進度"),null}};function D3(){const{lang:n}=Mt(),[e,t]=v.useState(null),[r,o]=v.useState(!1);v.useEffect(()=>{const h=new Image;h.onload=()=>o(!0),h.onerror=()=>o(!0);const m=setTimeout(()=>{o(!0)},3e3);return h.src="/stress.png",()=>clearTimeout(m)},[]);const a=h=>{var g;const m={"zh-TW":{title:"情緒發洩區",subtitle:"選擇適合的遊戲來釋放你的情緒",farm:"生活農場",farmDesc:"點擊種植，感受成長的喜悅",whackAMole:"打地鼠",whackAMoleDesc:"快速點擊，釋放壓力",fruitPicking:"採水果",fruitPickingDesc:"點擊收集，享受豐收",targetShooting:"情緒泡泡爆破",targetShootingDesc:"戳破情緒泡泡，釋放內心壓力",racing:"極速賽車",racingDesc:"駕駛賽車，體驗速度與激情",rhythm:"音樂節奏",rhythmDesc:"跟隨節奏，釋放音樂能量",rules:"遊戲規則",back:"返回",start:"開始遊戲",close:"關閉"},"zh-CN":{title:"情绪发泄区",subtitle:"选择适合的游戏来释放你的情绪",farm:"生活农场",farmDesc:"点击种植，感受成长的喜悦",whackAMole:"打地鼠",whackAMoleDesc:"快速点击，释放压力",fruitPicking:"采水果",fruitPickingDesc:"点击收集，享受丰收",targetShooting:"飞靶射击",targetShootingDesc:"瞄准射击，提升专注力",racing:"极速赛车",racingDesc:"驾驶赛车，体验速度与激情",rhythm:"音乐节奏",rhythmDesc:"跟随节奏，释放音乐能量",rules:"游戏规则",back:"返回",start:"开始游戏",close:"关闭"},en:{title:"Emotion Release Zone",subtitle:"Choose a game to release your emotions",farm:"Life Farm",farmDesc:"Click to plant, feel the joy of growth",whackAMole:"Whack-a-Mole",whackAMoleDesc:"Quick clicks to release stress",fruitPicking:"Fruit Picking",fruitPickingDesc:"Click to collect, enjoy the harvest",targetShooting:"Target Shooting",targetShootingDesc:"Aim and shoot, improve focus",racing:"Speed Racing",racingDesc:"Drive racing cars, experience speed and excitement",rhythm:"Music Rhythm",rhythmDesc:"Follow the rhythm, release musical energy",rules:"Game Rules",back:"Back",start:"Start Game",close:"Close"},ja:{title:"感情発散エリア",subtitle:"感情を解放するゲームを選択してください",farm:"ライフファーム",farmDesc:"クリックして植える、成長の喜びを感じる",whackAMole:"モグラたたき",whackAMoleDesc:"素早くクリックしてストレスを解放",fruitPicking:"フルーツ収穫",fruitPickingDesc:"クリックして収穫、収穫を楽しむ",targetShooting:"ターゲット射撃",targetShootingDesc:"狙って撃つ、集中力を向上",racing:"スピードレーシング",racingDesc:"レーシングカーを運転、スピードと興奮を体験",rhythm:"音楽リズム",rhythmDesc:"リズムに合わせて、音楽エネルギーを解放",rules:"ゲームルール",back:"戻る",start:"ゲーム開始",close:"閉じる"},ko:{title:"감정 발산 구역",subtitle:"감정을 해방할 게임을 선택하세요",farm:"라이프 팜",farmDesc:"클릭하여 심고, 성장의 기쁨을 느끼세요",whackAMole:"두더지 잡기",whackAMoleDesc:"빠르게 클릭하여 스트레스를 해방하세요",fruitPicking:"과일 수확",fruitPickingDesc:"클릭하여 수확하고, 수확의 기쁨을 누리세요",targetShooting:"타겟 사격",targetShootingDesc:"조준하고 쏘기, 집중력 향상",racing:"스피드 레이싱",racingDesc:"레이싱카 운전, 속도와 흥분을 경험",rhythm:"음악 리듬",rhythmDesc:"리듬에 맞춰 음악 에너지를 해방",rules:"게임 규칙",back:"돌아가기",start:"게임 시작",close:"닫기"},vi:{title:"Khu Vực Giải Tỏa Cảm Xúc",subtitle:"Chọn trò chơi để giải tỏa cảm xúc của bạn",farm:"Nông Trại Cuộc Sống",farmDesc:"Nhấp để trồng, cảm nhận niềm vui của sự phát triển",whackAMole:"Đập Chuột",whackAMoleDesc:"Nhấp nhanh để giải tỏa căng thẳng",fruitPicking:"Hái Trái Cây",fruitPickingDesc:"Nhấp để thu hoạch, tận hưởng mùa màng",targetShooting:"Bắn Bia",targetShootingDesc:"Nhắm và bắn, cải thiện sự tập trung",racing:"Đua Xe Tốc Độ",racingDesc:"Lái xe đua, trải nghiệm tốc độ và sự phấn khích",rhythm:"Nhịp Điệu Âm Nhạc",rhythmDesc:"Theo nhịp điệu, giải phóng năng lượng âm nhạc",rules:"Luật Chơi",back:"Quay Lại",start:"Bắt Đầu Trò Chơi",close:"Đóng"},th:{title:"พื้นที่ระบายอารมณ์",subtitle:"เลือกเกมเพื่อระบายอารมณ์ของคุณ",farm:"ฟาร์มชีวิต",farmDesc:"คลิกเพื่อปลูก รู้สึกถึงความสุขของการเติบโต",whackAMole:"ตีตุ่น",whackAMoleDesc:"คลิกเร็วเพื่อระบายความเครียด",fruitPicking:"เก็บผลไม้",fruitPickingDesc:"คลิกเพื่อเก็บเกี่ยว สนุกกับการเก็บเกี่ยว",targetShooting:"ยิงเป้า",targetShootingDesc:"เล็งและยิง ปรับปรุงสมาธิ",racing:"แข่งรถความเร็ว",racingDesc:"ขับรถแข่ง ประสบการณ์ความเร็วและความตื่นเต้น",rhythm:"จังหวะดนตรี",rhythmDesc:"ตามจังหวะ ปลดปล่อยพลังงานดนตรี",rules:"กฎเกม",back:"กลับ",start:"เริ่มเกม",close:"ปิด"},la:{title:"Zona Emotio Liberationis",subtitle:"Elige ludum ad liberationem emotionum tuarum",farm:"Villa Vitae",farmDesc:"Clicca ad plantandum, senti gaudium incrementi",whackAMole:"Talpa Percutere",whackAMoleDesc:"Clicca celeriter ad liberationem tensionis",fruitPicking:"Fructus Colligere",fruitPickingDesc:"Clicca ad colligendum, fruere messe",targetShooting:"Scopum Iaculare",targetShootingDesc:"Intende et iacula, meliora attentionem",racing:"Cursus Velocitatis",racingDesc:"Guberna currus cursus, experire velocitatem et excitationem",rhythm:"Rhythmus Musicae",rhythmDesc:"Sequere rhythmum, libera energiam musicam",rules:"Regulae Ludi",back:"Regredi",start:"Ludum Incipere",close:"Claudere"},ms:{title:"Zon Pelepasan Emosi",subtitle:"Pilih permainan untuk melepaskan emosi anda",farm:"Ladang Kehidupan",farmDesc:"Klik untuk menanam, rasakan kegembiraan pertumbuhan",whackAMole:"Pukul Tikus",whackAMoleDesc:"Klik pantas untuk melepaskan tekanan",fruitPicking:"Kutip Buah",fruitPickingDesc:"Klik untuk mengutip, nikmati hasil tuaian",targetShooting:"Tembak Sasaran",targetShootingDesc:"Arah dan tembak, tingkatkan fokus",racing:"Lumba Kereta Laju",racingDesc:"Pandu kereta lumba, alami kelajuan dan keseronokan",rhythm:"Irama Muzik",rhythmDesc:"Ikut irama, lepaskan tenaga muzik",rules:"Peraturan Permainan",back:"Kembali",start:"Mulakan Permainan",close:"Tutup"}};return((g=m[n])==null?void 0:g[h])||m["zh-TW"][h]||h},c=[{id:"farm",title:a("farm"),description:a("farmDesc"),icon:"🌱",color:"#4CAF50"},{id:"whackAMole",title:a("whackAMole"),description:a("whackAMoleDesc"),icon:"🔨",color:"#FF5722"},{id:"fruitPicking",title:a("fruitPicking"),description:a("fruitPickingDesc"),icon:"🍎",color:"#FF9800"},{id:"targetShooting",title:a("targetShooting"),description:a("targetShootingDesc"),icon:"🫧",color:"#9C27B0"},{id:"racing",title:a("racing"),description:a("racingDesc"),icon:"🏎️",color:"#E91E63"},{id:"rhythm",title:a("rhythm"),description:a("rhythmDesc"),icon:"🎵",color:"#00BCD4"}],d=()=>{switch(e){case"farm":return i.jsx(N3,{onClose:()=>t(null)});case"whackAMole":return i.jsx(M3,{onClose:()=>t(null)});case"fruitPicking":return i.jsx(L3,{onClose:()=>t(null)});case"targetShooting":return i.jsx(O3,{onClose:()=>t(null)});case"racing":return i.jsx(W3,{onClose:()=>t(null)});case"rhythm":return i.jsx(V3,{onClose:()=>t(null)});default:return null}};return i.jsxs("div",{style:{minHeight:"100vh",background:r?"linear-gradient(135deg, rgba(102, 126, 234, 0.8) 0%, rgba(118, 75, 162, 0.8) 100%), url('/stress.png')":"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat",padding:"clamp(10px, 2vw, 20px)",fontFamily:"Arial, sans-serif",boxSizing:"border-box",position:"relative"},children:[!r&&i.jsxs("div",{style:{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",background:"rgba(255,255,255,0.9)",padding:"20px",borderRadius:"10px",zIndex:2e3,textAlign:"center"},children:[i.jsx("div",{style:{fontSize:"18px",marginBottom:"10px"},children:"載入中..."}),i.jsx("div",{style:{width:"40px",height:"40px",border:"4px solid #f3f3f3",borderTop:"4px solid #667eea",borderRadius:"50%",margin:"0 auto",animation:"spin 1s linear infinite"}}),i.jsx("style",{children:`
            @keyframes spin {
              0% { transform: rotate(0deg); }
              100% { transform: rotate(360deg); }
            }
          `})]}),!e&&i.jsxs("button",{onClick:()=>window.history.back(),style:{position:"absolute",top:"clamp(20px, 4vw, 40px)",left:"clamp(20px, 4vw, 40px)",zIndex:1e3,background:"rgba(255,255,255,0.9)",border:"none",borderRadius:"25px",padding:"clamp(8px, 2vw, 12px) clamp(16px, 3vw, 24px)",fontSize:"clamp(14px, 2.5vw, 18px)",fontWeight:"bold",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",color:"#667eea",transition:"all 0.3s ease",boxShadow:"0 4px 12px rgba(0,0,0,0.15)"},onMouseEnter:h=>{h.currentTarget.style.background="#667eea",h.currentTarget.style.color="#fff",h.currentTarget.style.transform="translateY(-2px)"},onMouseLeave:h=>{h.currentTarget.style.background="rgba(255,255,255,0.9)",h.currentTarget.style.color="#667eea",h.currentTarget.style.transform="translateY(0)"},children:["← ",a("back")]}),e?i.jsxs("div",{style:{position:"relative",height:"100vh"},children:[i.jsx("button",{onClick:h=>{h.preventDefault(),h.stopPropagation(),t(null)},style:{position:"absolute",top:"clamp(20px, 4vw, 40px)",left:"clamp(20px, 4vw, 40px)",zIndex:1e3,background:"rgba(255,255,255,0.9)",border:"none",borderRadius:"50%",width:"clamp(40px, 8vw, 50px)",height:"clamp(40px, 8vw, 50px)",fontSize:"clamp(16px, 3vw, 24px)",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},children:"←"}),d()]}):i.jsxs("div",{style:{maxWidth:"1200px",margin:"0 auto"},children:[i.jsxs("div",{style:{textAlign:"center",marginBottom:"clamp(20px, 4vw, 40px)",marginTop:"clamp(60px, 8vw, 80px)"},children:[i.jsx("h1",{style:{color:"#fff",fontSize:"clamp(1.5rem, 4vw, 2.5rem)",fontWeight:"bold",marginBottom:"10px",textShadow:"2px 2px 4px rgba(0,0,0,0.3)"},children:a("title")}),i.jsx("p",{style:{color:"#fff",fontSize:"clamp(1rem, 2.5vw, 1.2rem)",opacity:.9,textShadow:"1px 1px 2px rgba(0,0,0,0.3)"},children:a("subtitle")})]}),i.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(280px, 1fr))",gap:"clamp(15px, 3vw, 30px)",padding:"clamp(10px, 2vw, 20px)"},children:c.map(h=>i.jsxs("div",{onClick:()=>t(h.id),style:{background:"rgba(255,255,255,0.95)",borderRadius:"20px",padding:"clamp(20px, 4vw, 30px)",textAlign:"center",cursor:"pointer",transition:"all 0.3s ease",boxShadow:"0 8px 32px rgba(0,0,0,0.1)",border:`3px solid ${h.color}`,position:"relative",overflow:"hidden"},onMouseEnter:m=>{m.currentTarget.style.transform="translateY(-5px)",m.currentTarget.style.boxShadow="0 12px 40px rgba(0,0,0,0.2)"},onMouseLeave:m=>{m.currentTarget.style.transform="translateY(0)",m.currentTarget.style.boxShadow="0 8px 32px rgba(0,0,0,0.1)"},children:[i.jsx("div",{style:{fontSize:"clamp(3rem, 8vw, 4rem)",marginBottom:"20px",filter:"drop-shadow(2px 2px 4px rgba(0,0,0,0.2))"},children:h.icon}),i.jsx("h3",{style:{color:h.color,fontSize:"clamp(1.2rem, 3vw, 1.5rem)",fontWeight:"bold",marginBottom:"15px"},children:h.title}),i.jsx("p",{style:{color:"#666",fontSize:"clamp(0.9rem, 2vw, 1rem)",lineHeight:"1.5"},children:h.description}),i.jsx("button",{style:{background:h.color,color:"#fff",border:"none",borderRadius:"25px",padding:"clamp(8px, 2vw, 12px) clamp(20px, 4vw, 30px)",fontSize:"clamp(0.9rem, 2vw, 1rem)",fontWeight:"bold",marginTop:"20px",cursor:"pointer",transition:"all 0.3s ease"},children:a("start")})]},h.id))})]}),e===null&&i.jsx(i.Fragment,{children:window.innerWidth<=768?i.jsx("div",{style:{width:"100%",margin:"0 auto",marginTop:24,background:"rgba(255,255,255,0.95)",borderRadius:16,padding:"16px",boxShadow:"0 2px 12px #6B5BFF22"},children:i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:8},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:20,flexWrap:"wrap"},children:[i.jsx("a",{href:"/privacy-policy",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12},children:"隱私權政策"}),i.jsx("a",{href:"/terms",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12},children:"條款/聲明"}),i.jsx("a",{href:"/data-deletion",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12},children:"資料刪除說明"})]}),i.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:20,flexWrap:"wrap"},children:[i.jsx("a",{href:"/about",style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12},children:"🧬 Restarter™｜我們是誰"}),i.jsx("a",{href:"/feedback",style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12},children:"💬 意見箱｜我們想聽你說"})]})]})}):i.jsx("div",{style:{width:"100%",margin:"0 auto",marginTop:24,background:"rgba(255,255,255,0.95)",borderRadius:16,padding:"16px",boxShadow:"0 2px 12px #6B5BFF22"},children:i.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:20,flexWrap:"wrap"},children:[i.jsx("a",{href:"/privacy-policy",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12},children:n==="zh-TW"?"隱私權政策":n==="zh-CN"?"隐私政策":n==="en"?"Privacy Policy":n==="ja"?"プライバシーポリシー":n==="ko"?"개인정보 처리방침":n==="th"?"นโยบายความเป็นส่วนตัว":n==="vi"?"Chính sách bảo mật":n==="ms"?"Dasar Privasi":"Consilium de Privata"}),i.jsx("a",{href:"/terms",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12},children:n==="zh-TW"?"條款/聲明":n==="zh-CN"?"条款/声明":n==="en"?"Terms/Statement":n==="ja"?"規約/声明":n==="ko"?"약관/성명":n==="th"?"ข้อกำหนด/แถลงการณ์":n==="vi"?"Điều khoản/Tuyên bố":n==="ms"?"Terma/Pernyataan":"Termini/Declaratio"}),i.jsx("a",{href:"/data-deletion",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12},children:n==="zh-TW"?"資料刪除說明":n==="zh-CN"?"数据删除说明":n==="en"?"Data Deletion":n==="ja"?"データ削除について":n==="ko"?"데이터 삭제 안내":n==="th"?"คำอธิบายการลบข้อมูล":n==="vi"?"Giải thích xóa dữ liệu":n==="ms"?"Penjelasan Penghapusan Data":"Explicatio Deletionis Datae"}),i.jsx("a",{href:"/about",style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12},children:n==="zh-TW"?"🧬 Restarter™｜我們是誰":n==="zh-CN"?"🧬 Restarter™｜我们是谁":n==="en"?"🧬 Restarter™｜Who We Are":n==="ja"?"🧬 Restarter™｜私たちについて":n==="ko"?"🧬 Restarter™｜우리는 누구인가":n==="th"?"🧬 Restarter™｜เราเป็นใคร":n==="vi"?"🧬 Restarter™｜Chúng tôi là ai":n==="ms"?"🧬 Restarter™｜Siapa Kami":"🧬 Restarter™｜Quis sumus"}),i.jsx("a",{href:"/feedback",style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12},children:n==="zh-TW"?"💬 意見箱｜我們想聽你說":n==="zh-CN"?"💬 意见箱｜我们想听你说":n==="en"?"💬 Feedback Box｜We Want to Hear From You":n==="ja"?"💬 ご意見箱｜私たちはあなたの声を聞きたい":n==="ko"?"💬 피드백｜우리는 당신의 말을 듣고 싶습니다":n==="th"?"💬 กล่องความคิดเห็น｜เราอยากได้ยินจากคุณ":n==="vi"?"💬 Hộp góp ý｜Chúng tôi muốn nghe từ bạn":n==="ms"?"💬 Kotak Maklum Balas｜Kami Ingin Mendengar Dari Anda":"💬 Arca Consilii｜Volumus Audire a Te"})]})})})]})}function N3({onClose:n}){const{lang:e}=Mt(),[t,r]=v.useState([]),[o,a]=v.useState(0),[c,d]=v.useState("carrot"),[h,m]=v.useState(!1),g=I=>{var F;const T={"zh-TW":{title:"生活農場",rules:"遊戲規則",hideRules:"隱藏規則",seedSelection:"種子選擇：",score:"分數",gameRules:"遊戲規則",plantStage:"種植階段：",harvestStage:"收穫階段：",plantStep1:"1. 選擇種子（6種作物可選）",plantStep2:"2. 點擊空地種植 → 獲得種植分數",plantStep3:"3. 作物會自動生長（幼苗→成熟）",harvestStep1:"1. 點擊成熟的作物進行收穫",harvestStep2:"2. 收穫後獲得更高分數",harvestStep3:"3. 空地可以重新種植",scoring:"計分系統：",scoring1:"• 種植分數：10-25分（根據作物類型）",scoring2:"• 收穫分數：50-125分（根據作物類型）",scoring3:"• 作物生長時間：3-8秒",plant:"種植",harvest:"收穫",growthTime:"生長時間",seconds:"秒",carrot:"胡蘿蔔",tomato:"番茄",corn:"玉米",potato:"馬鈴薯",strawberry:"草莓",watermelon:"西瓜"},"zh-CN":{title:"生活农场",rules:"游戏规则",hideRules:"隐藏规则",seedSelection:"种子选择：",score:"分数",gameRules:"游戏规则",plantStage:"种植阶段：",harvestStage:"收获阶段：",plantStep1:"1. 选择种子（6种作物可选）",plantStep2:"2. 点击空地种植 → 获得种植分数",plantStep3:"3. 作物会自动生长（幼苗→成熟）",harvestStep1:"1. 点击成熟的作物进行收获",harvestStep2:"2. 收获后获得更高分数",harvestStep3:"3. 空地可以重新种植",scoring:"计分系统：",scoring1:"• 种植分数：10-25分（根据作物类型）",scoring2:"• 收获分数：50-125分（根据作物类型）",scoring3:"• 作物生长时间：3-8秒",plant:"种植",harvest:"收获",growthTime:"生长时间",seconds:"秒",carrot:"胡萝卜",tomato:"番茄",corn:"玉米",potato:"马铃薯",strawberry:"草莓",watermelon:"西瓜"},en:{title:"Life Farm",rules:"Game Rules",hideRules:"Hide Rules",seedSelection:"Seed Selection:",score:"Score",gameRules:"Game Rules",plantStage:"Planting Stage:",harvestStage:"Harvest Stage:",plantStep1:"1. Select seeds (6 crop types available)",plantStep2:"2. Click empty plots to plant → Get planting score",plantStep3:"3. Crops grow automatically (seedling→mature)",harvestStep1:"1. Click mature crops to harvest",harvestStep2:"2. Get higher score after harvest",harvestStep3:"3. Empty plots can be replanted",scoring:"Scoring System:",scoring1:"• Planting score: 10-25 points (by crop type)",scoring2:"• Harvest score: 50-125 points (by crop type)",scoring3:"• Growth time: 3-8 seconds",plant:"Plant",harvest:"Harvest",growthTime:"Growth Time",seconds:"seconds",carrot:"Carrot",tomato:"Tomato",corn:"Corn",potato:"Potato",strawberry:"Strawberry",watermelon:"Watermelon"},ja:{title:"ライフファーム",rules:"ゲームルール",hideRules:"ルールを隠す",seedSelection:"種子選択：",score:"スコア",gameRules:"ゲームルール",plantStage:"植栽段階：",harvestStage:"収穫段階：",plantStep1:"1. 種子を選択（6種類の作物）",plantStep2:"2. 空き地をクリックして植栽 → 植栽スコア獲得",plantStep3:"3. 作物は自動で成長（苗→成熟）",harvestStep1:"1. 成熟した作物をクリックして収穫",harvestStep2:"2. 収穫後により高いスコア獲得",harvestStep3:"3. 空き地は再植栽可能",scoring:"スコアシステム：",scoring1:"• 植栽スコア：10-25ポイント（作物タイプ別）",scoring2:"• 収穫スコア：50-125ポイント（作物タイプ別）",scoring3:"• 成長時間：3-8秒",plant:"植栽",harvest:"収穫",growthTime:"成長時間",seconds:"秒",carrot:"ニンジン",tomato:"トマト",corn:"トウモロコシ",potato:"ジャガイモ",strawberry:"イチゴ",watermelon:"スイカ"},ko:{title:"라이프 팜",rules:"게임 규칙",hideRules:"규칙 숨기기",seedSelection:"씨앗 선택:",score:"점수",gameRules:"게임 규칙",plantStage:"심기 단계:",harvestStage:"수확 단계:",plantStep1:"1. 씨앗 선택 (6가지 작물)",plantStep2:"2. 빈 땅 클릭하여 심기 → 심기 점수 획득",plantStep3:"3. 작물 자동 성장 (묘목→성숙)",harvestStep1:"1. 성숙한 작물 클릭하여 수확",harvestStep2:"2. 수확 후 더 높은 점수 획득",harvestStep3:"3. 빈 땅 재심기 가능",scoring:"점수 시스템:",scoring1:"• 심기 점수: 10-25점 (작물 타입별)",scoring2:"• 수확 점수: 50-125점 (작물 타입별)",scoring3:"• 성장 시간: 3-8초",plant:"심기",harvest:"수확",growthTime:"성장 시간",seconds:"초",carrot:"당근",tomato:"토마토",corn:"옥수수",potato:"감자",strawberry:"딸기",watermelon:"수박"},vi:{title:"Nông Trại Cuộc Sống",rules:"Luật Chơi",hideRules:"Ẩn Luật",seedSelection:"Chọn Hạt Giống:",score:"Điểm",gameRules:"Luật Chơi",plantStage:"Giai Đoạn Trồng:",harvestStage:"Giai Đoạn Thu Hoạch:",plantStep1:"1. Chọn hạt giống (6 loại cây trồng)",plantStep2:"2. Nhấp vào ô trống để trồng → Nhận điểm trồng",plantStep3:"3. Cây trồng tự động phát triển (mầm→trưởng thành)",harvestStep1:"1. Nhấp vào cây trưởng thành để thu hoạch",harvestStep2:"2. Nhận điểm cao hơn sau thu hoạch",harvestStep3:"3. Ô trống có thể trồng lại",scoring:"Hệ Thống Điểm:",scoring1:"• Điểm trồng: 10-25 điểm (theo loại cây)",scoring2:"• Điểm thu hoạch: 50-125 điểm (theo loại cây)",scoring3:"• Thời gian phát triển: 3-8 giây",plant:"Trồng",harvest:"Thu hoạch",growthTime:"Thời gian phát triển",seconds:"giây",carrot:"Cà Rốt",tomato:"Cà Chua",corn:"Ngô",potato:"Khoai Tây",strawberry:"Dâu Tây",watermelon:"Dưa Hấu"},th:{title:"ฟาร์มชีวิต",rules:"กฎเกม",hideRules:"ซ่อนกฎ",seedSelection:"เลือกเมล็ด:",score:"คะแนน",gameRules:"กฎเกม",plantStage:"ขั้นตอนปลูก:",harvestStage:"ขั้นตอนเก็บเกี่ยว:",plantStep1:"1. เลือกเมล็ด (6 ชนิดพืช)",plantStep2:"2. คลิกที่แปลงว่างเพื่อปลูก → ได้คะแนนปลูก",plantStep3:"3. พืชเติบโตอัตโนมัติ (ต้นกล้า→สุก)",harvestStep1:"1. คลิกพืชที่สุกแล้วเพื่อเก็บเกี่ยว",harvestStep2:"2. ได้คะแนนสูงขึ้นหลังเก็บเกี่ยว",harvestStep3:"3. แปลงว่างสามารถปลูกใหม่ได้",scoring:"ระบบคะแนน:",scoring1:"• คะแนนปลูก: 10-25 คะแนน (ตามชนิดพืช)",scoring2:"• คะแนนเก็บเกี่ยว: 50-125 คะแนน (ตามชนิดพืช)",scoring3:"• เวลาเติบโต: 3-8 วินาที",plant:"ปลูก",harvest:"เก็บเกี่ยว",growthTime:"เวลาเติบโต",seconds:"วินาที",carrot:"แครอท",tomato:"มะเขือเทศ",corn:"ข้าวโพด",potato:"มันฝรั่ง",strawberry:"สตรอเบอร์รี่",watermelon:"แตงโม"},la:{title:"Villa Vitae",rules:"Regulae Ludi",hideRules:"Occulta Regulas",seedSelection:"Selectio Seminis:",score:"Puncta",gameRules:"Regulae Ludi",plantStage:"Stadium Plantandi:",harvestStage:"Stadium Messis:",plantStep1:"1. Elige semina (6 genera culturarum)",plantStep2:"2. Clicca in agros vacuos ad plantandum → Accipe puncta",plantStep3:"3. Culturae crescunt automatice (plantula→maturus)",harvestStep1:"1. Clicca culturas maturas ad messem",harvestStep2:"2. Accipe puncta altiora post messem",harvestStep3:"3. Agri vacui possunt replantari",scoring:"Systema Punctorum:",scoring1:"• Puncta plantandi: 10-25 (secundum genus)",scoring2:"• Puncta messis: 50-125 (secundum genus)",scoring3:"• Tempus crescendi: 3-8 secundis",plant:"Planta",harvest:"Messis",growthTime:"Tempus Crescendi",seconds:"secundis",carrot:"Daucus",tomato:"Lycopersicum",corn:"Zea",potato:"Solanum",strawberry:"Fragaria",watermelon:"Citrullus"},ms:{title:"Ladang Kehidupan",rules:"Peraturan Permainan",hideRules:"Sembunyikan Peraturan",seedSelection:"Pilihan Benih:",score:"Markah",gameRules:"Peraturan Permainan",plantStage:"Peringkat Menanam:",harvestStage:"Peringkat Menuai:",plantStep1:"1. Pilih benih (6 jenis tanaman)",plantStep2:"2. Klik plot kosong untuk menanam → Dapat markah menanam",plantStep3:"3. Tanaman tumbuh secara automatik (anak benih→matang)",harvestStep1:"1. Klik tanaman matang untuk menuai",harvestStep2:"2. Dapat markah lebih tinggi selepas menuai",harvestStep3:"3. Plot kosong boleh ditanam semula",scoring:"Sistem Markah:",scoring1:"• Markah menanam: 10-25 mata (mengikut jenis tanaman)",scoring2:"• Markah menuai: 50-125 mata (mengikut jenis tanaman)",scoring3:"• Masa tumbuh: 3-8 saat",plant:"Tanam",harvest:"Tuai",growthTime:"Masa Tumbuh",seconds:"saat",carrot:"Lobak Merah",tomato:"Tomato",corn:"Jagung",potato:"Kentang",strawberry:"Strawberi",watermelon:"Tembikai"}};return((F=T[e])==null?void 0:F[I])||T["zh-TW"][I]||I};v.useEffect(()=>{const I=Ld("farm");I&&(r(I.plants||[]),a(I.score||0))},[]),v.useEffect(()=>{Md("farm",{plants:t,score:o})},[t,o]);const x=[{id:"carrot",name:"胡蘿蔔",emoji:"🥕",growthTime:3e3,color:"#FF6B35",plantScore:10,harvestScore:50},{id:"tomato",name:"番茄",emoji:"🍅",growthTime:5e3,color:"#FF4444",plantScore:15,harvestScore:75},{id:"corn",name:"玉米",emoji:"🌽",growthTime:7e3,color:"#FFD700",plantScore:20,harvestScore:100},{id:"potato",name:"馬鈴薯",emoji:"🥔",growthTime:4e3,color:"#8B4513",plantScore:12,harvestScore:60},{id:"strawberry",name:"草莓",emoji:"🍓",growthTime:6e3,color:"#FF69B4",plantScore:18,harvestScore:90},{id:"watermelon",name:"西瓜",emoji:"🍉",growthTime:8e3,color:"#FF6347",plantScore:25,harvestScore:125}],S=(I,T)=>{if(t.find(q=>q.x===I&&q.y===T))return;const P=x.find(q=>q.id===c);if(!P)return;const B={id:Date.now(),type:c,growth:0,planted:Date.now(),x:I,y:T};r(q=>[...q,B]),a(q=>q+P.plantScore),setTimeout(()=>{r(q=>q.map(te=>te.id===B.id?{...te,growth:50}:te))},P.growthTime/2),setTimeout(()=>{r(q=>q.map(te=>te.id===B.id?{...te,growth:100}:te))},P.growthTime)},C=I=>{const T=t.find(F=>F.id===I);if(T&&T.growth>=100){const F=x.find(P=>P.id===T.type);r(P=>P.filter(B=>B.id!==I)),a(P=>P+((F==null?void 0:F.harvestScore)||50))}},_=(I,T)=>t.find(F=>F.x===I&&F.y===T);return i.jsx("div",{style:{height:"100vh",background:"linear-gradient(180deg, #87CEEB 0%, #90EE90 100%)",padding:"clamp(10px, 2vw, 20px)",position:"relative",display:"flex",flexDirection:"column",overflow:"hidden"},children:i.jsxs("div",{style:{display:"grid",gridTemplateColumns:window.innerWidth<=768?"1fr":"clamp(200px, 25vw, 250px) 1fr",gap:"clamp(10px, 2vw, 20px)",height:"calc(100% - 60px)",marginTop:"60px",overflow:"visible",minHeight:"0",width:"100%"},children:[i.jsxs("div",{style:{background:"rgba(255,255,255,0.95)",borderRadius:"15px",padding:"clamp(15px, 3vw, 20px)",height:"fit-content",maxHeight:window.innerWidth<=768?"200px":"100%",overflow:"auto",boxShadow:"0 4px 20px rgba(0,0,0,0.1)",alignSelf:"start",display:window.innerWidth<=768?"none":"block"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",fontSize:"clamp(1.2rem, 3vw, 1.5rem)",fontWeight:"bold",color:"#333"},children:["🌱 ",g("title")]}),i.jsx("button",{onClick:()=>m(!h),style:{background:"#4CAF50",color:"#fff",border:"none",borderRadius:"15px",padding:"4px 12px",fontSize:"clamp(0.7rem, 1.8vw, 0.8rem)",cursor:"pointer"},children:g(h?"hideRules":"rules")})]}),i.jsxs("div",{style:{marginBottom:"20px"},children:[i.jsx("h4",{style:{marginBottom:"10px",fontSize:"clamp(1rem, 2.5vw, 1.2rem)",color:"#333",fontWeight:"bold"},children:g("seedSelection")}),x.map(I=>i.jsxs("div",{onClick:()=>d(I.id),style:{padding:"clamp(8px, 2vw, 10px)",margin:"5px 0",borderRadius:"8px",cursor:"pointer",background:c===I.id?"#e8f5e8":"#f5f5f5",border:c===I.id?"2px solid #4CAF50":"2px solid transparent",fontSize:"clamp(0.9rem, 2vw, 1rem)",display:"flex",alignItems:"center",gap:"8px",transition:"all 0.3s ease"},children:[i.jsx("span",{style:{fontSize:"1.2em"},children:I.emoji}),i.jsx("span",{children:g(I.id)})]},I.id))]}),i.jsx("div",{style:{marginBottom:"20px"},children:i.jsxs("h4",{style:{fontSize:"clamp(1rem, 2.5vw, 1.2rem)",color:"#333",fontWeight:"bold"},children:[g("score"),"：",o]})}),h&&i.jsxs("div",{style:{background:"rgba(255,255,255,0.8)",borderRadius:"10px",padding:"12px",marginBottom:"15px",textAlign:"left",fontSize:"clamp(0.7rem, 1.8vw, 0.8rem)",lineHeight:"1.3"},children:[i.jsxs("h4",{style:{marginBottom:"8px",color:"#333"},children:["🎯 ",g("gameRules"),"："]}),i.jsx("p",{style:{marginBottom:"6px"},children:i.jsx("strong",{children:g("plantStage")})}),i.jsx("p",{style:{marginBottom:"6px"},children:g("plantStep1")}),i.jsx("p",{style:{marginBottom:"6px"},children:g("plantStep2")}),i.jsx("p",{style:{marginBottom:"6px"},children:g("plantStep3")}),i.jsx("p",{style:{marginBottom:"6px",marginTop:"8px"},children:i.jsx("strong",{children:g("harvestStage")})}),i.jsx("p",{style:{marginBottom:"6px"},children:g("harvestStep1")}),i.jsx("p",{style:{marginBottom:"6px"},children:g("harvestStep2")}),i.jsx("p",{style:{marginBottom:"6px"},children:g("harvestStep3")}),i.jsx("p",{style:{marginBottom:"6px",marginTop:"8px"},children:i.jsx("strong",{children:g("scoring")})}),i.jsxs("p",{style:{marginBottom:"4px"},children:["🥕 ",g("carrot"),"：",g("plant"),"+10 ",g("harvest"),"+50"]}),i.jsxs("p",{style:{marginBottom:"4px"},children:["🍅 ",g("tomato"),"：",g("plant"),"+15 ",g("harvest"),"+75"]}),i.jsxs("p",{style:{marginBottom:"4px"},children:["🌽 ",g("corn"),"：",g("plant"),"+20 ",g("harvest"),"+100"]}),i.jsxs("p",{style:{marginBottom:"4px"},children:["🥔 ",g("potato"),"：",g("plant"),"+12 ",g("harvest"),"+60"]}),i.jsxs("p",{style:{marginBottom:"4px"},children:["🍓 ",g("strawberry"),"：",g("plant"),"+18 ",g("harvest"),"+90"]}),i.jsxs("p",{style:{marginBottom:"4px"},children:["🍉 ",g("watermelon"),"：",g("plant"),"+25 ",g("harvest"),"+125"]}),i.jsx("p",{style:{marginBottom:"6px",marginTop:"8px"},children:i.jsxs("strong",{children:[g("growthTime"),"："]})}),i.jsxs("p",{style:{marginBottom:"4px"},children:["🥕 ",g("carrot"),"：3",g("seconds")]}),i.jsxs("p",{style:{marginBottom:"4px"},children:["🍅 ",g("tomato"),"：5",g("seconds")]}),i.jsxs("p",{style:{marginBottom:"4px"},children:["🌽 ",g("corn"),"：7",g("seconds")]}),i.jsxs("p",{style:{marginBottom:"4px"},children:["🥔 ",g("potato"),"：4",g("seconds")]}),i.jsxs("p",{style:{marginBottom:"4px"},children:["🍓 ",g("strawberry"),"：6",g("seconds")]}),i.jsxs("p",{style:{marginBottom:"4px"},children:["🍉 ",g("watermelon"),"：8",g("seconds")]})]})]}),i.jsxs("div",{style:{background:"rgba(255,255,255,0.9)",borderRadius:"15px",padding:window.innerWidth<=768?"clamp(5px, 1vw, 10px)":"clamp(10px, 2vw, 20px)",position:"relative",overflow:"visible",boxShadow:"0 4px 20px rgba(0,0,0,0.1)",display:"flex",flexDirection:"column",zIndex:1,minHeight:"0",width:"100%"},children:[window.innerWidth<=768&&i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"10px",marginBottom:"15px"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"10px",background:"rgba(255,255,255,0.8)",borderRadius:"10px",fontSize:"14px",position:"relative",zIndex:1},children:[i.jsxs("div",{style:{fontWeight:"bold"},children:[g("score"),"：",o]}),i.jsx("div",{style:{display:"flex",gap:"8px"},children:x.map(I=>i.jsx("button",{onClick:()=>d(I.id),style:{padding:"4px 8px",borderRadius:"6px",border:c===I.id?"2px solid #4CAF50":"1px solid #ddd",background:c===I.id?"#e8f5e8":"#fff",cursor:"pointer",fontSize:"12px"},children:I.emoji},I.id))})]}),i.jsx("div",{style:{display:"flex",justifyContent:"center"},children:i.jsx("button",{onClick:()=>m(!h),style:{background:"#4CAF50",color:"#fff",border:"none",borderRadius:"15px",padding:"6px 16px",fontSize:"12px",cursor:"pointer"},children:g(h?"hideRules":"rules")})}),h&&i.jsxs("div",{style:{background:"rgba(255,255,255,0.9)",borderRadius:"10px",padding:"12px",fontSize:"11px",lineHeight:"1.3",textAlign:"left"},children:[i.jsxs("h4",{style:{marginBottom:"6px",color:"#333"},children:["🎯 ",g("gameRules"),"："]}),i.jsxs("p",{style:{marginBottom:"4px"},children:[i.jsx("strong",{children:"種植："}),"選擇種子 → 點擊空地種植"]}),i.jsxs("p",{style:{marginBottom:"4px"},children:[i.jsx("strong",{children:"收穫："}),"點擊成熟作物收穫"]}),i.jsxs("p",{style:{marginBottom:"4px"},children:[i.jsx("strong",{children:"分數："}),"種植+10~25分，收穫+50~125分"]}),i.jsxs("p",{style:{marginBottom:"4px"},children:[i.jsx("strong",{children:"時間："}),"3~8秒成熟"]})]})]}),i.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(10, 1fr)",gridTemplateRows:"repeat(7, 1fr)",gap:"clamp(5px, 1vw, 10px)",width:"100%",height:"fit-content",minHeight:"0",overflow:"visible"},children:Array.from({length:70},(I,T)=>{const F=T%10,P=Math.floor(T/10),B=_(F,P),q=B?x.find(W=>W.id===B.type):null,te=B&&B.growth>=100;return i.jsx("div",{onClick:()=>{B&&te?C(B.id):B||S(F,P)},style:{background:B?te?"#4CAF50":"#8BC34A":"#DEB887",border:"2px solid #A0522D",borderRadius:"8px",display:"flex",alignItems:"center",justifyContent:"center",cursor:B&&!te?"not-allowed":"pointer",fontSize:B?"clamp(1.5rem, 4vw, 2rem)":"clamp(0.8rem, 2vw, 1rem)",transition:"all 0.3s ease",position:"relative",aspectRatio:"1",boxShadow:B?"0 2px 8px rgba(0,0,0,0.2)":"none",opacity:B&&!te?.7:1},children:B?i.jsx("div",{style:{fontSize:te?"clamp(1.5rem, 4vw, 2rem)":"clamp(0.8rem, 2vw, 1rem)",opacity:B.growth/100},children:q==null?void 0:q.emoji}):i.jsx("span",{style:{color:"#8B4513",fontSize:"1.5em"},children:"+"})},T)})})]})]})})}function M3({onClose:n}){const{lang:e}=Mt(),[t,r]=v.useState(0),[o,a]=v.useState(30),[c,d]=v.useState(!1),[h,m]=v.useState(null),g=v.useRef({}),x=X=>{var ne;const $={"zh-TW":{start:"開始遊戲",restart:"重新開始",score:"分數",time:"時間",level:"等級",hits:"擊中",accuracy:"準確率",combo:"連擊",highScore:"最高分",highCombo:"最高連擊",title:"打地鼠",rules:"遊戲規則",close:"關閉",gameOver:"遊戲結束",finalScore:"最終分數",basicGameplay:"基本玩法",scoreSystem:"分數系統",levelSystem:"等級系統",clickMole:"點擊出現的地鼠",getScore:"獲得分數",gameTime:"遊戲時間",seconds:"秒",moleSpeed:"地鼠出現時間會隨等級縮短",baseScore:"基礎分數",points:"分",levelBonus:"等級獎勵",perLevel:"每級",comboBonus:"連擊獎勵",per3Combo:"每3連擊",level1:"1級",level2:"2級",level3:"3級",level4:"4級",molesFaster:"地鼠更快",moreFrequent:"更頻繁",extremeSpeed:"極限速度"},"zh-CN":{start:"开始游戏",restart:"重新开始",score:"分数",time:"时间",level:"等级",hits:"击中",accuracy:"准确率",combo:"连击",highScore:"最高分",highCombo:"最高连击",title:"打地鼠",rules:"游戏规则",close:"关闭",basicGameplay:"基本玩法",scoreSystem:"分数系统",levelSystem:"等级系统",clickMole:"点击出现的地鼠",getScore:"获得分数",gameTime:"游戏时间",seconds:"秒",moleSpeed:"地鼠出现时间会随等级缩短",baseScore:"基础分数",points:"分",levelBonus:"等级奖励",perLevel:"每级",comboBonus:"连击奖励",per3Combo:"每3连击",level1:"1级",level2:"2级",level3:"3级",level4:"4级",molesFaster:"地鼠更快",moreFrequent:"更频繁",extremeSpeed:"极限速度"},en:{start:"Start Game",restart:"Restart",score:"Score",time:"Time",level:"Level",hits:"Hits",accuracy:"Accuracy",combo:"Combo",highScore:"High Score",highCombo:"High Combo",title:"Whack-a-Mole",rules:"Game Rules",close:"Close",basicGameplay:"Basic Gameplay",scoreSystem:"Score System",levelSystem:"Level System",clickMole:"Click appearing moles",getScore:"to get points",gameTime:"Game Time",seconds:"seconds",moleSpeed:"Mole appearance time shortens with level",baseScore:"Base Score",points:"points",levelBonus:"Level Bonus",perLevel:"per level",comboBonus:"Combo Bonus",per3Combo:"per 3 combos",level1:"Level 1",level2:"Level 2",level3:"Level 3",level4:"Level 4",molesFaster:"moles faster",moreFrequent:"more frequent",extremeSpeed:"extreme speed"},ja:{start:"ゲーム開始",restart:"再開",score:"スコア",time:"時間",level:"レベル",hits:"ヒット",accuracy:"精度",combo:"コンボ",highScore:"ハイスコア",highCombo:"ハイコンボ",title:"モグラたたき",rules:"ゲームルール",close:"閉じる",basicGameplay:"基本プレイ",scoreSystem:"スコアシステム",levelSystem:"レベルシステム",clickMole:"現れるモグラをクリック",getScore:"してポイントを獲得",gameTime:"ゲーム時間",seconds:"秒",moleSpeed:"モグラの出現時間はレベルに応じて短縮",baseScore:"ベーススコア",points:"ポイント",levelBonus:"レベルボーナス",perLevel:"レベルごと",comboBonus:"コンボボーナス",per3Combo:"3コンボごと",level1:"レベル1",level2:"レベル2",level3:"レベル3",level4:"レベル4",molesFaster:"モグラがより速く",moreFrequent:"より頻繁に",extremeSpeed:"極限速度"},ko:{start:"게임 시작",restart:"다시 시작",score:"점수",time:"시간",level:"레벨",hits:"타격",accuracy:"정확도",combo:"콤보",highScore:"최고 점수",highCombo:"최고 콤보",title:"두더지 잡기",rules:"게임 규칙",close:"닫기",basicGameplay:"기본 플레이",scoreSystem:"점수 시스템",levelSystem:"레벨 시스템",clickMole:"나타나는 두더지를 클릭",getScore:"하여 점수 획득",gameTime:"게임 시간",seconds:"초",moleSpeed:"두더지 출현 시간은 레벨에 따라 단축",baseScore:"기본 점수",points:"점",levelBonus:"레벨 보너스",perLevel:"레벨당",comboBonus:"콤보 보너스",per3Combo:"3콤보당",level1:"레벨 1",level2:"레벨 2",level3:"레벨 3",level4:"레벨 4",molesFaster:"두더지가 더 빠르게",moreFrequent:"더 자주",extremeSpeed:"극한 속도"},vi:{start:"Bắt Đầu Trò Chơi",restart:"Chơi Lại",score:"Điểm",time:"Thời Gian",level:"Cấp Độ",hits:"Trúng",accuracy:"Độ Chính Xác",combo:"Combo",highScore:"Điểm Cao Nhất",highCombo:"Combo Cao Nhất",title:"Đập Chuột",rules:"Luật Chơi",close:"Đóng",basicGameplay:"Cách Chơi Cơ Bản",scoreSystem:"Hệ Thống Điểm",levelSystem:"Hệ Thống Cấp Độ",clickMole:"Nhấp vào chuột xuất hiện",getScore:"để nhận điểm",gameTime:"Thời Gian Chơi",seconds:"giây",moleSpeed:"Thời gian xuất hiện chuột rút ngắn theo cấp độ",baseScore:"Điểm Cơ Bản",points:"điểm",levelBonus:"Thưởng Cấp Độ",perLevel:"mỗi cấp",comboBonus:"Thưởng Combo",per3Combo:"mỗi 3 combo",level1:"Cấp 1",level2:"Cấp 2",level3:"Cấp 3",level4:"Cấp 4",molesFaster:"chuột nhanh hơn",moreFrequent:"thường xuyên hơn",extremeSpeed:"tốc độ cực hạn"},th:{start:"เริ่มเกม",restart:"เริ่มใหม่",score:"คะแนน",time:"เวลา",level:"ระดับ",hits:"ตีถูก",accuracy:"ความแม่นยำ",combo:"คอมโบ",highScore:"คะแนนสูงสุด",highCombo:"คอมโบสูงสุด",title:"ตีตุ่น",rules:"กฎเกม",close:"ปิด",basicGameplay:"วิธีเล่นพื้นฐาน",scoreSystem:"ระบบคะแนน",levelSystem:"ระบบระดับ",clickMole:"คลิกตุ่นที่ปรากฏ",getScore:"เพื่อได้คะแนน",gameTime:"เวลาเกม",seconds:"วินาที",moleSpeed:"เวลาปรากฏของตุ่นจะสั้นลงตามระดับ",baseScore:"คะแนนพื้นฐาน",points:"คะแนน",levelBonus:"โบนัสระดับ",perLevel:"ต่อระดับ",comboBonus:"โบนัสคอมโบ",per3Combo:"ต่อ 3 คอมโบ",level1:"ระดับ 1",level2:"ระดับ 2",level3:"ระดับ 3",level4:"ระดับ 4",molesFaster:"ตุ่นเร็วขึ้น",moreFrequent:"บ่อยขึ้น",extremeSpeed:"ความเร็วสุดขีด"},la:{start:"Ludum Incipere",restart:"Iterum Incipere",score:"Puncta",time:"Tempus",level:"Gradus",hits:"Ictus",accuracy:"Accuratio",combo:"Combo",highScore:"Puncta Maxima",highCombo:"Combo Maxima",title:"Talpa Percutere",rules:"Regulae Ludi",close:"Claudere",basicGameplay:"Ludus Basicus",scoreSystem:"Systema Punctorum",levelSystem:"Systema Gradus",clickMole:"Clicca talpam apparentem",getScore:"ut puncta accipias",gameTime:"Tempus Ludi",seconds:"secundis",moleSpeed:"Tempus apparentiae talpae cum gradu brevior fit",baseScore:"Puncta Basica",points:"puncta",levelBonus:"Bonus Gradus",perLevel:"per gradum",comboBonus:"Bonus Combo",per3Combo:"per 3 combos",level1:"Gradus 1",level2:"Gradus 2",level3:"Gradus 3",level4:"Gradus 4",molesFaster:"talpae velociores",moreFrequent:"frequentiores",extremeSpeed:"velocitas extrema"},ms:{start:"Mulakan Permainan",restart:"Mulakan Semula",score:"Markah",time:"Masa",level:"Tahap",hits:"Pukulan",accuracy:"Ketepatan",combo:"Combo",highScore:"Markah Tertinggi",highCombo:"Combo Tertinggi",title:"Pukul Tikus",rules:"Peraturan Permainan",close:"Tutup",basicGameplay:"Cara Bermain Asas",scoreSystem:"Sistem Markah",levelSystem:"Sistem Tahap",clickMole:"Klik tikus yang muncul",getScore:"untuk dapat markah",gameTime:"Masa Permainan",seconds:"saat",moleSpeed:"Masa kemunculan tikus memendek dengan tahap",baseScore:"Markah Asas",points:"markah",levelBonus:"Bonus Tahap",perLevel:"setiap tahap",comboBonus:"Bonus Combo",per3Combo:"setiap 3 combo",level1:"Tahap 1",level2:"Tahap 2",level3:"Tahap 3",level4:"Tahap 4",molesFaster:"tikus lebih cepat",moreFrequent:"lebih kerap",extremeSpeed:"kelajuan melampau"}};return((ne=$[e])==null?void 0:ne[X])||$["zh-TW"][X]||X},[S,C]=v.useState(0),[_,I]=v.useState(1),[T,F]=v.useState(0),[P,B]=v.useState(0),[q,te]=v.useState(!1),[W,L]=v.useState(0),[R,A]=v.useState(0),[N,O]=v.useState(0);v.useEffect(()=>{const X=Ld("whackAMole");X&&C(X.highScore||0)},[]),v.useEffect(()=>{t>S&&(C(t),Md("whackAMole",{highScore:t}))},[t,S]),v.useEffect(()=>{const X=T+P;if(X>0){const $=T/X;_===1&&$>=.7?I(2):_===2&&$>=.6?I(3):_===3&&$>=.5&&I(4)}},[T,P,_]);const z=()=>t<0?"😅 負分？地鼠在笑你！":t<50?"🐹 新手地鼠獵人！":t<100?"🎯 有點手感了！":t<200?"⚡ 地鼠殺手！":t<300?"🔥 地鼠剋星！":t<500?"💪 地鼠終結者！":"👑 地鼠之王！";v.useEffect(()=>{},[_]),v.useEffect(()=>{const X=T+P;X>0&&O(Math.round(T/X*100))},[T,P]);const j=()=>{d(!0),r(0),a(30),I(1),F(0),B(0),L(0),A(0),O(0),m(null);let X,$;X=setInterval(()=>{a(ne=>ne<=1?(clearInterval(X),clearInterval($),d(!1),0):ne-1)},1e3),setTimeout(()=>{const ne=Math.floor(Math.random()*9);m(ne);const J=setTimeout(()=>{m(null),B(Q=>Q+1),r(Q=>Q-1),L(0)},_===1?900:_===2?700:_===3?500:350);g.current[ne]=J},300),$=setInterval(()=>{const ne=Math.floor(Math.random()*9);m(ne);const J=setTimeout(()=>{m(null),B(Q=>Q+1),r(Q=>Q-1),L(0)},_===1?900:_===2?700:_===3?500:350);g.current[ne]=J},_===1?1100:_===2?900:_===3?700:500)},V=X=>{h===X?(r($=>$+1),F($=>$+1),L($=>{const ne=$+1;return ne>R&&A(ne),ne}),m(null),g.current[X]&&(clearTimeout(g.current[X]),g.current[X]=null)):(r($=>$-1),L(0))};return i.jsxs("div",{style:{height:"100vh",background:"linear-gradient(180deg, #8B4513 0%, #A0522D 100%)",padding:"clamp(10px, 2vw, 20px)",display:"flex",flexDirection:"column",alignItems:"center",position:"relative"},children:[i.jsx("button",{onClick:n,style:{position:"absolute",top:"clamp(20px, 4vw, 40px)",left:"clamp(20px, 4vw, 40px)",background:"#fff",border:"2px solid #6B5BFF",borderRadius:"50%",width:"clamp(40px, 8vw, 50px)",height:"clamp(40px, 8vw, 50px)",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",zIndex:20,fontSize:"clamp(1.2rem, 3vw, 1.5rem)",color:"#6B5BFF"},children:"←"}),i.jsxs("div",{style:{background:"rgba(255,255,255,0.9)",borderRadius:"15px",padding:"clamp(10px, 2vw, 15px)",marginTop:"clamp(60px, 12vw, 80px)",marginBottom:"clamp(8px, 1.5vw, 15px)",textAlign:"center",width:"100%",maxWidth:"300px"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"10px"},children:[i.jsxs("h2",{style:{fontSize:"clamp(1.5rem, 4vw, 2rem)",margin:0},children:["🔨 ",x("title")]}),i.jsx("button",{onClick:()=>te(!q),style:{background:"#4CAF50",color:"#fff",border:"none",borderRadius:"20px",padding:"5px 15px",fontSize:"clamp(0.8rem, 2vw, 1rem)",cursor:"pointer"},children:x(q?"close":"rules")})]}),q&&i.jsxs("div",{style:{background:"rgba(255,255,255,0.8)",borderRadius:"10px",padding:"10px",marginBottom:"10px",textAlign:"left",fontSize:"clamp(0.7rem, 1.8vw, 0.8rem)",lineHeight:"1.3"},children:[i.jsxs("h4",{style:{marginBottom:"8px",color:"#333"},children:["🎯 ",x("rules"),"："]}),i.jsx("p",{style:{marginBottom:"6px"},children:i.jsxs("strong",{children:[x("basicGameplay"),"："]})}),i.jsxs("p",{style:{marginBottom:"6px"},children:["• ",x("clickMole")," 🐹 ",x("getScore")]}),i.jsxs("p",{style:{marginBottom:"6px"},children:["• ",x("gameTime"),"：30",x("seconds")]}),i.jsxs("p",{style:{marginBottom:"6px"},children:["• ",x("moleSpeed")]}),i.jsx("p",{style:{marginBottom:"6px",marginTop:"8px"},children:i.jsxs("strong",{children:[x("scoreSystem"),"："]})}),i.jsx("p",{style:{marginBottom:"6px"},children:"• 點擊到地鼠身上 → +1分"}),i.jsx("p",{style:{marginBottom:"6px"},children:"• 地鼠消失時沒有點擊 → -1分"}),i.jsx("p",{style:{marginBottom:"6px"},children:"• 地鼠消失後才點擊 → -1分"}),i.jsx("p",{style:{marginBottom:"6px"},children:"• 點擊地鼠坑但沒點擊到地鼠 → -1分"}),i.jsx("p",{style:{marginBottom:"6px"},children:"• 從0分開始，無正負限制"}),i.jsx("p",{style:{marginBottom:"6px",marginTop:"8px"},children:i.jsxs("strong",{children:[x("levelSystem"),"："]})}),i.jsx("p",{style:{marginBottom:"6px"},children:"• 1級：70%成功 → 2級（地鼠更快）"}),i.jsx("p",{style:{marginBottom:"6px"},children:"• 2級：60%成功 → 3級（更頻繁）"}),i.jsx("p",{style:{marginBottom:"6px"},children:"• 3級：50%成功 → 4級（極限速度）"}),i.jsx("p",{style:{marginBottom:"6px"},children:"• 成功率基於30秒內的成功比率計算"})]}),!q&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{display:"flex",gap:"clamp(6px, 1.5vw, 12px)",justifyContent:"center",flexWrap:"wrap",marginBottom:"8px"},children:[i.jsxs("div",{style:{fontSize:"clamp(0.8rem, 2.2vw, 1rem)"},children:[x("score"),"：",t]}),i.jsxs("div",{style:{fontSize:"clamp(0.8rem, 2.2vw, 1rem)"},children:[x("time"),"：",o,"秒"]}),i.jsxs("div",{style:{fontSize:"clamp(0.8rem, 2.2vw, 1rem)"},children:[x("level"),"：",_]})]}),i.jsxs("div",{style:{display:"flex",gap:"clamp(6px, 1.5vw, 12px)",justifyContent:"center",flexWrap:"wrap",marginBottom:"8px"},children:[i.jsxs("div",{style:{fontSize:"clamp(0.7rem, 1.8vw, 0.9rem)"},children:[x("hits"),"：",T]}),i.jsxs("div",{style:{fontSize:"clamp(0.7rem, 1.8vw, 0.9rem)"},children:[x("accuracy"),"：",N,"%"]}),i.jsxs("div",{style:{fontSize:"clamp(0.7rem, 1.8vw, 0.9rem)"},children:[x("combo"),"：",W]})]}),i.jsxs("div",{style:{display:"flex",gap:"clamp(6px, 1.5vw, 12px)",justifyContent:"center",flexWrap:"wrap"},children:[i.jsxs("div",{style:{fontSize:"clamp(0.7rem, 1.8vw, 0.9rem)"},children:[x("highScore"),"：",S]}),i.jsxs("div",{style:{fontSize:"clamp(0.7rem, 1.8vw, 0.9rem)"},children:[x("highCombo"),"：",R]})]}),i.jsx("div",{style:{fontSize:"clamp(0.8rem, 2vw, 1rem)",color:"#FF5722",fontWeight:"bold",marginTop:"8px",textAlign:"center"},children:z()}),!c&&i.jsx("button",{onClick:j,style:{background:"#FF5722",color:"#fff",border:"none",borderRadius:"25px",padding:"clamp(6px, 1.5vw, 8px) clamp(16px, 3vw, 24px)",fontSize:"clamp(0.9rem, 2.2vw, 1rem)",fontWeight:"bold",marginTop:"10px",cursor:"pointer",transition:"all 0.3s ease"},children:x(o===30?"start":"restart")})]})]}),!q&&i.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"clamp(8px, 1.5vw, 15px)",maxWidth:"300px",width:"100%",marginTop:"10px",padding:"clamp(10px, 2vw, 15px)",background:"rgba(255,255,255,0.9)",borderRadius:"15px",boxSizing:"border-box"},children:Array.from({length:9},(X,$)=>i.jsx("div",{onClick:()=>V($),style:{width:"clamp(60px, 10vw, 80px)",height:"clamp(60px, 10vw, 80px)",background:"#654321",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",border:"3px solid #8B4513",position:"relative",overflow:"hidden"},children:h===$&&i.jsx("div",{style:{position:"absolute",bottom:"0",width:"100%",height:"60%",background:"#8B4513",borderRadius:"50% 50% 0 0",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"clamp(1.5rem, 4vw, 2rem)",animation:"molePop 0.3s ease-out",cursor:"pointer"},children:"🐹"})},$))}),i.jsx("style",{children:`
        @keyframes molePop {
          0% { transform: translateY(100%); }
          100% { transform: translateY(0); }
        }
        
        @keyframes whack {
          0% { transform: scale(1); }
          50% { transform: scale(0.8); }
          100% { transform: scale(1); }
        }
        
        @keyframes scorePop {
          0% { opacity: 0; transform: translateY(0); }
          50% { opacity: 1; transform: translateY(-20px); }
          100% { opacity: 0; transform: translateY(-40px); }
        }
      `})]})}function L3({onClose:n}){const{lang:e}=Mt(),[t,r]=v.useState(0),[o,a]=v.useState([]),c=V=>{var $;const X={"zh-TW":{title:"採水果",start:"開始遊戲",restart:"重新開始",score:"分數",time:"時間",level:"等級",collected:"收集",highScore:"最高分",rules:"遊戲規則",close:"關閉",hideRules:"隱藏規則",basicGameplay:"基本玩法",scoreSystem:"分數系統",levelSystem:"等級系統",tips:"技巧提示",newFeatures:"新增功能",gameOver:"遊戲結束",clickFruit:"點擊掉落的水果收集分數",putFruitInBasket:"把採到的水果裝進下面的水果籃裡",gameTime:"遊戲時間",seconds:"秒",fruitSpeed:"水果會不定向掉落且速度加快",apple:"蘋果",orange:"橘子",banana:"香蕉",strawberry:"草莓",grape:"葡萄",peach:"桃子",points:"分",level1:"1級",level2:"2級",level3:"3級",level4:"4級",fruitFaster:"水果更快",moreFrequent:"更頻繁",extremeSpeed:"極限速度",prioritizeHighScore:"優先收集高分水果",stayFocused:"保持專注，快速反應",buildHighScore:"建立高分記錄",fruitFromFourDirections:"水果會從四個方向隨機出現",curvedTrajectory:"水果掉落時會呈現彎曲動線",realTimeFeedback:"遊戲中會顯示即時收集反饋",detailedStats:"遊戲結束時顯示詳細統計",fixedBasketPosition:"籃子位置完全固定不震動",increasedFrequency:"水果出現頻率大幅提升"},"zh-CN":{title:"采水果",start:"开始游戏",restart:"重新开始",score:"分数",time:"时间",level:"等级",collected:"收集",highScore:"最高分",rules:"游戏规则",close:"关闭",hideRules:"隐藏规则",basicGameplay:"基本玩法",scoreSystem:"分数系统",levelSystem:"等级系统",tips:"技巧提示",newFeatures:"新增功能",clickFruit:"点击掉落的水果收集分数",putFruitInBasket:"把采到的水果装进下面的水果篮里",gameTime:"游戏时间",seconds:"秒",fruitSpeed:"水果会不定向掉落且速度加快",apple:"苹果",orange:"橘子",banana:"香蕉",strawberry:"草莓",grape:"葡萄",peach:"桃子",points:"分",level1:"1级",level2:"2级",level3:"3级",level4:"4级",fruitFaster:"水果更快",moreFrequent:"更频繁",extremeSpeed:"极限速度",prioritizeHighScore:"优先收集高分水果",stayFocused:"保持专注，快速反应",buildHighScore:"建立高分记录",fruitFromFourDirections:"水果会从四个方向随机出现",curvedTrajectory:"水果掉落时会呈现弯曲动线",realTimeFeedback:"游戏中会显示即时收集反馈",detailedStats:"游戏结束时显示详细统计",fixedBasketPosition:"篮子位置完全固定不震动",increasedFrequency:"水果出现频率大幅提升"},en:{title:"Fruit Picking",start:"Start Game",restart:"Restart",score:"Score",time:"Time",level:"Level",collected:"Collected",highScore:"High Score",rules:"Game Rules",close:"Close",hideRules:"Hide Rules",basicGameplay:"Basic Gameplay",scoreSystem:"Score System",levelSystem:"Level System",tips:"Tips",newFeatures:"New Features",clickFruit:"Click falling fruit to collect points",putFruitInBasket:"Put collected fruit into the basket below",gameTime:"Game Time",seconds:"seconds",fruitSpeed:"Fruit will fall randomly and speed up",apple:"Apple",orange:"Orange",banana:"Banana",strawberry:"Strawberry",grape:"Grape",peach:"Peach",points:"points",level1:"Level 1",level2:"Level 2",level3:"Level 3",level4:"Level 4",fruitFaster:"fruit faster",moreFrequent:"more frequent",extremeSpeed:"extreme speed",prioritizeHighScore:"Prioritize high-score fruits",stayFocused:"Stay focused, react quickly",buildHighScore:"Build high score records",fruitFromFourDirections:"Fruit appears from four directions randomly",curvedTrajectory:"Fruit falls with curved trajectories",realTimeFeedback:"Real-time collection feedback during game",detailedStats:"Detailed statistics when game ends",fixedBasketPosition:"Basket position completely fixed without vibration",increasedFrequency:"Significantly increased fruit appearance frequency"},ja:{title:"フルーツ収穫",start:"ゲーム開始",restart:"再開",score:"スコア",time:"時間",level:"レベル",collected:"収穫",highScore:"ハイスコア",rules:"ゲームルール",close:"閉じる",hideRules:"ルール非表示",basicGameplay:"基本ゲームプレイ",scoreSystem:"スコアシステム",levelSystem:"レベルシステム",tips:"ヒント",newFeatures:"新機能",clickFruit:"落ちる果物をクリックしてポイントを獲得",putFruitInBasket:"収穫した果物を下のバスケットに入れる",gameTime:"ゲーム時間",seconds:"秒",fruitSpeed:"果物はランダムに落ちて速度が上がる",apple:"りんご",orange:"みかん",banana:"バナナ",strawberry:"いちご",grape:"ぶどう",peach:"もも",points:"ポイント",level1:"レベル1",level2:"レベル2",level3:"レベル3",level4:"レベル4",fruitFaster:"果物がより速く",moreFrequent:"より頻繁に",extremeSpeed:"極限速度",prioritizeHighScore:"高得点の果物を優先",stayFocused:"集中して素早く反応",buildHighScore:"高得点記録を築く",fruitFromFourDirections:"果物は4方向からランダムに出現",curvedTrajectory:"果物は曲線軌道で落下",realTimeFeedback:"ゲーム中のリアルタイム収穫フィードバック",detailedStats:"ゲーム終了時の詳細統計",fixedBasketPosition:"バスケット位置は完全固定で震動なし",increasedFrequency:"果物出現頻度が大幅に向上"},ko:{title:"과일 수확",start:"게임 시작",restart:"다시 시작",score:"점수",time:"시간",level:"레벨",collected:"수확",highScore:"최고 점수",rules:"게임 규칙",close:"닫기",hideRules:"규칙 숨기기",basicGameplay:"기본 게임플레이",scoreSystem:"점수 시스템",levelSystem:"레벨 시스템",tips:"팁",newFeatures:"새 기능",clickFruit:"떨어지는 과일을 클릭하여 점수 획득",putFruitInBasket:"수확한 과일을 아래 바구니에 넣기",gameTime:"게임 시간",seconds:"초",fruitSpeed:"과일이 무작위로 떨어지고 속도가 빨라짐",apple:"사과",orange:"귤",banana:"바나나",strawberry:"딸기",grape:"포도",peach:"복숭아",points:"점",level1:"레벨 1",level2:"레벨 2",level3:"레벨 3",level4:"레벨 4",fruitFaster:"과일이 더 빠르게",moreFrequent:"더 자주",extremeSpeed:"극한 속도",prioritizeHighScore:"고점수 과일 우선 수집",stayFocused:"집중하고 빠르게 반응",buildHighScore:"고점수 기록 구축",fruitFromFourDirections:"과일이 네 방향에서 무작위로 나타남",curvedTrajectory:"과일이 곡선 궤적으로 떨어짐",realTimeFeedback:"게임 중 실시간 수확 피드백",detailedStats:"게임 종료 시 상세 통계",fixedBasketPosition:"바구니 위치 완전 고정으로 진동 없음",increasedFrequency:"과일 출현 빈도 대폭 증가"},vi:{title:"Hái Trái Cây",start:"Bắt Đầu Trò Chơi",restart:"Chơi Lại",score:"Điểm",time:"Thời Gian",level:"Cấp Độ",collected:"Thu Hoạch",highScore:"Điểm Cao Nhất",rules:"Luật Chơi",close:"Đóng",hideRules:"Ẩn Luật",basicGameplay:"Cách Chơi Cơ Bản",scoreSystem:"Hệ Thống Điểm",levelSystem:"Hệ Thống Cấp Độ",tips:"Mẹo",newFeatures:"Tính Năng Mới",clickFruit:"Nhấp vào trái cây rơi để nhận điểm",putFruitInBasket:"Đặt trái cây thu hoạch vào giỏ bên dưới",gameTime:"Thời Gian Chơi",seconds:"giây",fruitSpeed:"Trái cây sẽ rơi ngẫu nhiên và tăng tốc",apple:"Táo",orange:"Cam",banana:"Chuối",strawberry:"Dâu tây",grape:"Nho",peach:"Đào",points:"điểm",level1:"Cấp 1",level2:"Cấp 2",level3:"Cấp 3",level4:"Cấp 4",fruitFaster:"trái cây nhanh hơn",moreFrequent:"thường xuyên hơn",extremeSpeed:"tốc độ cực hạn",prioritizeHighScore:"Ưu tiên trái cây điểm cao",stayFocused:"Tập trung, phản ứng nhanh",buildHighScore:"Xây dựng kỷ lục điểm cao",fruitFromFourDirections:"Trái cây xuất hiện từ bốn hướng ngẫu nhiên",curvedTrajectory:"Trái cây rơi theo quỹ đạo cong",realTimeFeedback:"Phản hồi thu hoạch thời gian thực trong game",detailedStats:"Thống kê chi tiết khi kết thúc game",fixedBasketPosition:"Vị trí giỏ hoàn toàn cố định không rung",increasedFrequency:"Tần suất xuất hiện trái cây tăng đáng kể"},th:{title:"เก็บผลไม้",start:"เริ่มเกม",restart:"เริ่มใหม่",score:"คะแนน",time:"เวลา",level:"ระดับ",collected:"เก็บ",highScore:"คะแนนสูงสุด",rules:"กฎเกม",close:"ปิด",hideRules:"ซ่อนกฎ",basicGameplay:"การเล่นพื้นฐาน",scoreSystem:"ระบบคะแนน",levelSystem:"ระบบระดับ",tips:"เคล็ดลับ",newFeatures:"คุณสมบัติใหม่",clickFruit:"คลิกผลไม้ที่ตกลงมาเพื่อได้คะแนน",putFruitInBasket:"ใส่ผลไม้ที่เก็บได้ลงในตะกร้าข้างล่าง",gameTime:"เวลาเกม",seconds:"วินาที",fruitSpeed:"ผลไม้จะตกลงมาแบบสุ่มและเร็วขึ้น",apple:"แอปเปิ้ล",orange:"ส้ม",banana:"กล้วย",strawberry:"สตรอเบอร์รี่",grape:"องุ่น",peach:"พีช",points:"คะแนน",level1:"ระดับ 1",level2:"ระดับ 2",level3:"ระดับ 3",level4:"ระดับ 4",fruitFaster:"ผลไม้เร็วขึ้น",moreFrequent:"บ่อยขึ้น",extremeSpeed:"ความเร็วสุดขีด",prioritizeHighScore:"ให้ความสำคัญกับผลไม้คะแนนสูง",stayFocused:"มีสมาธิและตอบสนองเร็ว",buildHighScore:"สร้างสถิติคะแนนสูง",fruitFromFourDirections:"ผลไม้ปรากฏจากสี่ทิศทางแบบสุ่ม",curvedTrajectory:"ผลไม้ตกลงมาด้วยวิถีโค้ง",realTimeFeedback:"การตอบสนองการเก็บเกี่ยวแบบเรียลไทม์ในเกม",detailedStats:"สถิติรายละเอียดเมื่อเกมจบ",fixedBasketPosition:"ตำแหน่งตะกร้าคงที่โดยไม่สั่น",increasedFrequency:"ความถี่การปรากฏของผลไม้เพิ่มขึ้นอย่างมาก"},la:{title:"Fructus Colligere",start:"Ludum Incipere",restart:"Iterum Incipere",score:"Puncta",time:"Tempus",level:"Gradus",collected:"Collecta",highScore:"Puncta Maxima",rules:"Regulae Ludi",close:"Claudere",hideRules:"Regulae Occultare",basicGameplay:"Ludus Basicus",scoreSystem:"Systema Punctorum",levelSystem:"Systema Graduum",tips:"Consilia",newFeatures:"Facultates Novae",clickFruit:"Clicca fructus cadentes ut puncta accipias",putFruitInBasket:"Pone fructus collectos in corbem infra",gameTime:"Tempus Ludi",seconds:"secundis",fruitSpeed:"Fructus cadent temere et velocitate crescente",apple:"Malum",orange:"Aurantium",banana:"Musa",strawberry:"Fragum",grape:"Uva",peach:"Persicum",points:"puncta",level1:"Gradus 1",level2:"Gradus 2",level3:"Gradus 3",level4:"Gradus 4",fruitFaster:"fructus velociores",moreFrequent:"frequentiores",extremeSpeed:"velocitas extrema",prioritizeHighScore:"Prioritiza fructus punctis altis",stayFocused:"Mane attentus, reage celeriter",buildHighScore:"Aedifica puncta alta",fruitFromFourDirections:"Fructus apparent ex quattuor directionibus temere",curvedTrajectory:"Fructus cadunt cum trajectoriis curvis",realTimeFeedback:"Feedback collectionis tempore reali in ludo",detailedStats:"Statisticae detaillatae cum ludus finitur",fixedBasketPosition:"Positio corbis omnino fixa sine vibratione",increasedFrequency:"Frequentia fructuum apparendi multum aucta"},ms:{title:"Kutip Buah",start:"Mulakan Permainan",restart:"Mulakan Semula",score:"Markah",time:"Masa",level:"Tahap",collected:"Kutip",highScore:"Markah Tertinggi",rules:"Peraturan Permainan",close:"Tutup",hideRules:"Sembunyikan Peraturan",basicGameplay:"Permainan Asas",scoreSystem:"Sistem Markah",levelSystem:"Sistem Tahap",tips:"Petua",newFeatures:"Ciri Baharu",clickFruit:"Klik buah yang jatuh untuk dapat markah",putFruitInBasket:"Letakkan buah yang dikutip ke dalam bakul di bawah",gameTime:"Masa Permainan",seconds:"saat",fruitSpeed:"Buah akan jatuh secara rawak dan laju bertambah",apple:"Epal",orange:"Oren",banana:"Pisang",strawberry:"Strawberi",grape:"Anggur",peach:"Pic",points:"markah",level1:"Tahap 1",level2:"Tahap 2",level3:"Tahap 3",level4:"Tahap 4",fruitFaster:"buah lebih cepat",moreFrequent:"lebih kerap",extremeSpeed:"kelajuan melampau",prioritizeHighScore:"Utamakan buah markah tinggi",stayFocused:"Kekal fokus, bertindak pantas",buildHighScore:"Bina rekod markah tinggi",fruitFromFourDirections:"Buah muncul dari empat arah secara rawak",curvedTrajectory:"Buah jatuh dengan trajektori melengkung",realTimeFeedback:"Maklum balas kutipan masa nyata semasa permainan",detailedStats:"Statistik terperinci apabila permainan tamat",fixedBasketPosition:"Kedudukan bakul tetap sepenuhnya tanpa getaran",increasedFrequency:"Kekerapan kemunculan buah meningkat dengan ketara"}};return(($=X[e])==null?void 0:$[V])||X["zh-TW"][V]||V},[d,h]=v.useState([]),[m,g]=v.useState({}),[x,S]=v.useState([]),[C,_]=v.useState(0),[I,T]=v.useState(!1),[F,P]=v.useState(30),[B,q]=v.useState(!1),[te,W]=v.useState(1),[L,R]=v.useState(0);v.useEffect(()=>{const V=Ld("fruitPicking");V&&_(V.highScore||0)},[]),v.useEffect(()=>{if(!B||o.length===0)return;const V=setInterval(()=>{a(X=>X.map(ne=>{const oe=ne.curveOffset||0,J=ne.curveSpeed||.05,Q=Date.now()*.001,D=Math.sin(Q*J+oe)*4,G=Math.cos(Q*J+oe)*2,ie=Math.sin(Q*J*2+oe)*2,ee=Math.cos(Q*J*1.5+oe)*1,Se=Math.sin(Q*J*.5+oe)*3,we=D+ie+Se,Oe=G+ee;return{...ne,y:ne.y+(ne.directionY||ne.speed||1)+Oe,x:ne.x+(ne.directionX||ne.direction||0)+we}}).filter(ne=>ne.y>-20&&ne.y<120&&ne.x>-20&&ne.x<120))},100);return()=>clearInterval(V)},[B,o.length]),v.useEffect(()=>{t>C&&(_(t),Md("fruitPicking",{highScore:t}))},[t,C]),v.useEffect(()=>{t>=100&&te===1?W(2):t>=250&&te===2?W(3):t>=500&&te===3&&W(4)},[t,te]);const A=[{type:"apple",emoji:"🍎",points:10},{type:"orange",emoji:"🍊",points:15},{type:"banana",emoji:"🍌",points:20},{type:"strawberry",emoji:"🍓",points:25},{type:"grape",emoji:"🍇",points:30},{type:"peach",emoji:"🍑",points:35}],N=()=>{q(!0),r(0),P(30),W(1),R(0),h([]),a([]),g({}),S([]);let V,X;V=setInterval(()=>{P($=>$<=1?(clearInterval(V),clearInterval(X),q(!1),0):$-1)},1e3),setTimeout(()=>{O(),X=setInterval(()=>{O(),te>=3&&setTimeout(()=>O(),200),te>=4&&setTimeout(()=>O(),400)},te===1?1200:te===2?800:te===3?600:400)},100)},O=()=>{const V=A[Math.floor(Math.random()*A.length)],X=te===1?1:te===2?1.5:te===3?2:2.5,$=Math.floor(Math.random()*4),ne=Math.random()<.3;let oe,J,Q,D;switch($){case 0:oe=Math.random()*80+10,J=-10,Q=(Math.random()-.5)*.3,D=X;break;case 1:oe=Math.random()*80+10,J=110,Q=(Math.random()-.5)*.3,D=-X;break;case 2:oe=-10,J=Math.random()*80+10,Q=X,D=(Math.random()-.5)*.3;break;case 3:oe=110,J=Math.random()*80+10,Q=-X,D=(Math.random()-.5)*.3;break;default:oe=Math.random()*80+10,J=-10,Q=(Math.random()-.5)*.3,D=X}const G={id:Date.now()+Math.random(),x:oe,y:J,type:V.type,emoji:V.emoji,speed:X,direction:0,directionX:Q,directionY:D,curveOffset:Math.random()*Math.PI*2,curveSpeed:Math.random()*.15+.08};if(a(ie=>[...ie,G]),ne){const ie=A[Math.floor(Math.random()*A.length)],ee=Math.random()*80+10,we={id:Date.now()+Math.random()+1,x:ee,y:-10,type:ie.type,emoji:ie.emoji,speed:X,direction:0,directionX:(Math.random()-.5)*.3,directionY:X,curveOffset:Math.random()*Math.PI*2,curveSpeed:Math.random()*.15+.08};a(Oe=>[...Oe,we])}},z=V=>{const X=o.find($=>$.id===V);if(X){const $=A.find(ne=>ne.type===X.type);a(ne=>ne.filter(oe=>oe.id!==V)),r(ne=>{const oe=ne+(($==null?void 0:$.points)||10);return oe>C&&_(oe),oe}),R(ne=>ne+1),h(ne=>[...ne,{type:X.type,emoji:X.emoji}]),g(ne=>{const oe={...ne};return oe[X.type]=(oe[X.type]||0)+1,oe}),S(ne=>ne.find(J=>J.type===X.type)?ne.map(J=>J.type===X.type?{...J,count:J.count+1}:J):[...ne,{type:X.type,emoji:X.emoji,count:1}])}},j=()=>L<5?"😅 新手採果者！":L<10?"🍎 有點手感了！":L<15?"🍊 水果獵人！":L<20?"🍌 採果高手！":L<25?"🍓 水果大師！":"👑 採果之王！";return v.useEffect(()=>{if(x.length>0&&B){const V=setTimeout(()=>{S([])},3e3);return()=>clearTimeout(V)}},[x,B]),i.jsxs("div",{style:{height:"100vh",background:"linear-gradient(180deg, #87CEEB 0%, #98FB98 100%)",padding:"clamp(10px, 2vw, 20px)",position:"relative",overflow:"hidden",isolation:"isolate"},children:[i.jsx("button",{onClick:n,style:{position:"absolute",top:"clamp(20px, 4vw, 40px)",left:"clamp(20px, 4vw, 40px)",background:"#fff",border:"2px solid #6B5BFF",borderRadius:"50%",width:"clamp(40px, 8vw, 50px)",height:"clamp(40px, 8vw, 50px)",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",zIndex:20,fontSize:"clamp(1.2rem, 3vw, 1.5rem)",color:"#6B5BFF"},children:"←"}),i.jsxs("div",{style:{position:"absolute",top:"clamp(20px, 4vw, 40px)",left:"clamp(60px, 12vw, 70px)",background:"rgba(255,255,255,0.9)",borderRadius:"15px",padding:"clamp(12px, 2.5vw, 16px)",zIndex:10,maxWidth:"180px"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"8px"},children:[i.jsxs("h3",{style:{fontSize:"clamp(1rem, 2.5vw, 1.2rem)",margin:0,lineHeight:"1.2"},children:["🍎 ",c("title")]}),i.jsx("button",{onClick:()=>T(!I),style:{background:"#4CAF50",color:"#fff",border:"none",borderRadius:"12px",padding:"2px 8px",fontSize:"clamp(0.6rem, 1.5vw, 0.7rem)",cursor:"pointer"},children:c(I?"hideRules":"rules")})]}),I&&i.jsxs("div",{style:{background:"rgba(255,255,255,0.8)",borderRadius:"10px",padding:"10px",marginBottom:"10px",textAlign:"left",fontSize:"clamp(0.7rem, 1.8vw, 0.8rem)",lineHeight:"1.3",maxHeight:"clamp(200px, 40vh, 300px)",overflowY:"auto",overflowX:"hidden",scrollbarWidth:"thin",scrollbarColor:"#4CAF50 #f0f0f0"},children:[i.jsxs("h4",{style:{marginBottom:"8px",color:"#333"},children:["🍎 ",c("rules"),"："]}),i.jsx("p",{style:{marginBottom:"6px"},children:i.jsxs("strong",{children:[c("basicGameplay"),"："]})}),i.jsxs("p",{style:{marginBottom:"6px"},children:["• ",c("clickFruit")]}),i.jsxs("p",{style:{marginBottom:"6px"},children:["• ",c("putFruitInBasket")]}),i.jsxs("p",{style:{marginBottom:"6px"},children:["• ",c("gameTime"),"：30",c("seconds")]}),i.jsxs("p",{style:{marginBottom:"6px"},children:["• ",c("fruitSpeed")]}),i.jsx("p",{style:{marginBottom:"6px",marginTop:"8px"},children:i.jsxs("strong",{children:[c("scoreSystem"),"："]})}),i.jsxs("p",{style:{marginBottom:"6px"},children:["• 🍎 ",c("apple"),"：10",c("points")]}),i.jsxs("p",{style:{marginBottom:"6px"},children:["• 🍊 ",c("orange"),"：15",c("points")]}),i.jsxs("p",{style:{marginBottom:"6px"},children:["• 🍌 ",c("banana"),"：20",c("points")]}),i.jsxs("p",{style:{marginBottom:"6px"},children:["• 🍓 ",c("strawberry"),"：25",c("points")]}),i.jsxs("p",{style:{marginBottom:"6px"},children:["• 🍇 ",c("grape"),"：30",c("points")]}),i.jsxs("p",{style:{marginBottom:"6px"},children:["• 🍑 ",c("peach"),"：35",c("points")]}),i.jsx("p",{style:{marginBottom:"6px",marginTop:"8px"},children:i.jsxs("strong",{children:[c("levelSystem"),"："]})}),i.jsxs("p",{style:{marginBottom:"6px"},children:["• ",c("level1"),"：100",c("points")," → ",c("level2"),"（",c("fruitFaster"),"）"]}),i.jsxs("p",{style:{marginBottom:"6px"},children:["• ",c("level2"),"：250",c("points")," → ",c("level3"),"（",c("moreFrequent"),"）"]}),i.jsxs("p",{style:{marginBottom:"6px"},children:["• ",c("level3"),"：500",c("points")," → ",c("level4"),"（",c("extremeSpeed"),"）"]}),i.jsx("p",{style:{marginBottom:"6px",marginTop:"8px"},children:i.jsxs("strong",{children:[c("tips"),"："]})}),i.jsxs("p",{style:{marginBottom:"6px"},children:["• ",c("prioritizeHighScore")]}),i.jsxs("p",{style:{marginBottom:"6px"},children:["• ",c("stayFocused")]}),i.jsxs("p",{style:{marginBottom:"6px"},children:["• ",c("buildHighScore")]}),i.jsx("p",{style:{marginBottom:"6px",marginTop:"8px"},children:i.jsxs("strong",{children:[c("newFeatures"),"："]})}),i.jsxs("p",{style:{marginBottom:"6px"},children:["• ",c("fruitFromFourDirections")]}),i.jsxs("p",{style:{marginBottom:"6px"},children:["• ",c("curvedTrajectory")]}),i.jsxs("p",{style:{marginBottom:"6px"},children:["• ",c("realTimeFeedback")]}),i.jsxs("p",{style:{marginBottom:"6px"},children:["• ",c("detailedStats")]}),i.jsxs("p",{style:{marginBottom:"6px"},children:["• ",c("fixedBasketPosition")]}),i.jsxs("p",{style:{marginBottom:"6px"},children:["• ",c("increasedFrequency")]})]}),!I&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{display:"flex",gap:"clamp(4px, 1vw, 8px)",justifyContent:"center",flexWrap:"wrap",marginBottom:"6px"},children:[i.jsxs("div",{style:{fontSize:"clamp(0.7rem, 1.8vw, 0.85rem)"},children:[c("score"),"：",t]}),i.jsxs("div",{style:{fontSize:"clamp(0.7rem, 1.8vw, 0.85rem)"},children:[c("time"),"：",F,"秒"]}),i.jsxs("div",{style:{fontSize:"clamp(0.7rem, 1.8vw, 0.85rem)"},children:[c("level"),"：",te]})]}),i.jsxs("div",{style:{display:"flex",gap:"clamp(4px, 1vw, 8px)",justifyContent:"center",flexWrap:"wrap"},children:[i.jsxs("div",{style:{fontSize:"clamp(0.6rem, 1.5vw, 0.75rem)"},children:[c("collected"),"：",L,"個"]}),i.jsxs("div",{style:{fontSize:"clamp(0.6rem, 1.5vw, 0.75rem)"},children:[c("highScore"),"：",C]})]}),i.jsx("div",{style:{fontSize:"clamp(0.7rem, 1.8vw, 0.85rem)",color:"#FF5722",fontWeight:"bold",marginTop:"6px",textAlign:"center"},children:j()}),!B&&i.jsx("button",{onClick:N,style:{background:"#FF9800",color:"#fff",border:"none",borderRadius:"20px",padding:"clamp(5px, 1.2vw, 6px) clamp(12px, 2.5vw, 18px)",fontSize:"clamp(0.8rem, 2vw, 0.9rem)",fontWeight:"bold",marginTop:"8px",cursor:"pointer",transition:"all 0.3s ease"},children:c(F===30?"start":"restart")})]})]}),!B&&F===0&&i.jsx("div",{style:{position:"absolute",bottom:"clamp(120px, 20vw, 140px)",left:"50%",transform:"translateX(-50%)",display:"flex",gap:"15px",flexWrap:"wrap",justifyContent:"center",zIndex:10},children:Object.entries(m).map(([V,X])=>{const $=A.find(ne=>ne.type===V);return i.jsxs("div",{style:{position:"relative",display:"flex",flexDirection:"column",alignItems:"center",gap:"2px"},children:[i.jsx("span",{style:{fontSize:"clamp(2rem, 5vw, 3rem)",filter:"drop-shadow(0 2px 4px rgba(0,0,0,0.3))"},children:$==null?void 0:$.emoji}),i.jsx("span",{style:{position:"absolute",top:"-5px",right:"-5px",background:"#FF5722",color:"white",borderRadius:"50%",width:"clamp(20px, 4vw, 25px)",height:"clamp(20px, 4vw, 25px)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"clamp(0.6rem, 1.5vw, 0.8rem)",fontWeight:"bold",boxShadow:"0 2px 4px rgba(0,0,0,0.3)"},children:X})]},V)})}),i.jsx("div",{style:{position:"fixed",bottom:"clamp(10px, 2vw, 20px)",left:"50%",transform:"translateX(-50%)",display:"flex",alignItems:"flex-end",justifyContent:"center",zIndex:5,width:"clamp(200px, 30vw, 250px)",pointerEvents:"none",userSelect:"none",touchAction:"none",willChange:"auto",backfaceVisibility:"hidden",contain:"layout style paint",isolation:"isolate"},children:i.jsx("div",{style:{background:"#8B4513",width:"clamp(150px, 25vw, 200px)",height:"clamp(75px, 12vw, 100px)",borderRadius:"50% 50% 0 0",border:"4px solid #654321",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"clamp(1.5rem, 4vw, 2rem)",overflow:"hidden",position:"relative",zIndex:6,pointerEvents:"none",transform:"translateZ(0)",willChange:"auto",userSelect:"none",touchAction:"none",backfaceVisibility:"hidden",perspective:"none",transformStyle:"flat",contain:"layout style paint",isolation:"isolate"},children:d.length>0?i.jsxs("div",{style:{display:"flex",flexWrap:"wrap",justifyContent:"center",alignItems:"center",gap:"2px",maxWidth:"90%",maxHeight:"90%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",pointerEvents:"none",userSelect:"none",touchAction:"none",willChange:"auto",backfaceVisibility:"hidden"},children:[x.slice(-4).map((V,X)=>i.jsxs("span",{style:{fontSize:"clamp(0.8rem, 2vw, 1rem)",position:"relative"},children:[V.emoji,i.jsx("span",{style:{position:"absolute",top:"-8px",right:"-8px",background:"#FF5722",color:"white",borderRadius:"50%",width:"clamp(12px, 2.5vw, 16px)",height:"clamp(12px, 2.5vw, 16px)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"clamp(0.5rem, 1.2vw, 0.7rem)",fontWeight:"bold"},children:V.count})]},X)),x.length===0&&d.slice(-6).map((V,X)=>i.jsx("span",{style:{fontSize:"clamp(0.8rem, 2vw, 1rem)"},children:V.emoji},X)),d.length>6&&x.length===0&&i.jsxs("span",{style:{fontSize:"clamp(0.6rem, 1.5vw, 0.8rem)",color:"#fff"},children:["+",d.length-6]})]}):i.jsx("span",{style:{color:"#654321"},children:"🧺"})})}),o.map(V=>i.jsx("div",{onClick:X=>{X.stopPropagation(),X.preventDefault(),z(V.id)},onTouchStart:X=>{X.stopPropagation(),X.preventDefault(),z(V.id)},style:{position:"absolute",left:`${V.x}%`,top:`${V.y}%`,fontSize:"clamp(1.5rem, 4vw, 2rem)",cursor:"pointer",userSelect:"none",transition:"all 0.1s ease",zIndex:20,touchAction:"manipulation",willChange:"transform",WebkitUserSelect:"none",MozUserSelect:"none",msUserSelect:"none"},children:V.emoji},V.id))]})}function O3({onClose:n}){const{lang:e}=Mt(),[t,r]=v.useState(!1),[o,a]=v.useState(0),c=me=>{var Xe;const Ve={"zh-TW":{title:"情緒泡泡爆破",start:"開始遊戲",restart:"重新開始",score:"分數",time:"時間",combo:"連擊",accuracy:"準確率",highScore:"最高分",rules:"遊戲規則",close:"關閉",hideRules:"隱藏規則",gameOver:"遊戲結束",soundOn:"音效開",soundOff:"音效關",rhythmGame:"音樂節奏",gameplay:"遊戲玩法",clickStartButton:"點擊「開始遊戲」按鈕",preciseBubblePop:"精準戳破泡泡",computer:"電腦",preciseClickCenter:"精準點擊泡泡中心戳破",mobile:"手機",preciseTouchCenter:"精準觸摸泡泡中心戳破",highAccuracyRequired:"需要高精準度，點擊泡泡邊緣無效",fastBubbles:"快速泡泡",harderToPop:"更難戳破，需要更高精準度",slowBubbles:"慢速泡泡",easierToPop:"相對容易戳破",emotionBubbleScore:"情緒泡泡分數",angryBubble:"憤怒泡泡",anxiousBubble:"焦慮泡泡",depressedBubble:"憂鬱泡泡",stressedBubble:"壓力泡泡",irritatedBubble:"暴躁泡泡",frustratedBubble:"沮喪泡泡",points:"分",specialBubbles:"特殊泡泡",bombBubble:"炸彈泡泡",clearAllNearby:"清除周圍所有泡泡",goldenBubble:"金色泡泡",doubleScore:"雙倍分數",ghostBubble:"幽靈泡泡",clickTwice:"需要點擊兩次",chainBubble:"連鎖泡泡",clearSameType:"清除同類型泡泡",timeBubble:"時間泡泡",add5Seconds:"增加5秒時間",accuracySystem:"精準度系統",above:"以上",triggerPowerMode:"觸發能量模式",goodAccuracy:"良好精準度",below:"以下",needImproveAccuracy:"需要提高精準度",powerMode:"能量模式",autoTrigger:"自動觸發",powerModeEasier:"能量模式下更容易戳破泡泡",last10Seconds:"持續10秒後自動結束",comboSystem:"連擊系統",continuousPopExtraScore:"連續戳破泡泡可獲得額外分數",timeLimit:"時間限制",sixtySecondsHighestScore:"60秒內獲得最高分數",gameGoal:"遊戲目標",precisePopEmotionBubbles:"精準戳破情緒泡泡，釋放內心壓力",accuracyChallenge:"精準度挑戰",onlyClickCenterToPop:"只有點擊泡泡中心才能戳破",fastBubblesNeedHigherAccuracy:"快速泡泡需要更高精準度"},"zh-CN":{title:"情绪泡泡爆破",start:"开始游戏",restart:"重新开始",score:"分数",time:"时间",combo:"连击",accuracy:"准确率",highScore:"最高分",rules:"游戏规则",close:"关闭",hideRules:"隐藏规则",gameplay:"游戏玩法",clickStartButton:"点击「开始游戏」按钮",preciseBubblePop:"精准戳破泡泡",computer:"电脑",preciseClickCenter:"精准点击泡泡中心戳破",mobile:"手机",preciseTouchCenter:"精准触摸泡泡中心戳破",highAccuracyRequired:"需要高精准度，点击泡泡边缘无效",fastBubbles:"快速泡泡",harderToPop:"更难戳破，需要更高精准度",slowBubbles:"慢速泡泡",easierToPop:"相对容易戳破",emotionBubbleScore:"情绪泡泡分数",angryBubble:"愤怒泡泡",anxiousBubble:"焦虑泡泡",depressedBubble:"忧郁泡泡",stressedBubble:"压力泡泡",irritatedBubble:"暴躁泡泡",frustratedBubble:"沮丧泡泡",points:"分",specialBubbles:"特殊泡泡",bombBubble:"炸弹泡泡",clearAllNearby:"清除周围所有泡泡",goldenBubble:"金色泡泡",doubleScore:"双倍分数",ghostBubble:"幽灵泡泡",clickTwice:"需要点击两次",chainBubble:"连锁泡泡",clearSameType:"清除同类型泡泡",timeBubble:"时间泡泡",add5Seconds:"增加5秒时间",accuracySystem:"精准度系统",above:"以上",triggerPowerMode:"触发能量模式",goodAccuracy:"良好精准度",below:"以下",needImproveAccuracy:"需要提高精准度",powerMode:"能量模式",autoTrigger:"自动触发",powerModeEasier:"能量模式下更容易戳破泡泡",last10Seconds:"持续10秒后自动结束",comboSystem:"连击系统",continuousPopExtraScore:"连续戳破泡泡可获得额外分数",timeLimit:"时间限制",sixtySecondsHighestScore:"60秒内获得最高分数",gameGoal:"游戏目标",precisePopEmotionBubbles:"精准戳破情绪泡泡，释放内心压力",accuracyChallenge:"精准度挑战",onlyClickCenterToPop:"只有点击泡泡中心才能戳破",fastBubblesNeedHigherAccuracy:"快速泡泡需要更高精准度"},en:{title:"Bubble Pop",start:"Start Game",restart:"Restart",score:"Score",time:"Time",combo:"Combo",accuracy:"Accuracy",highScore:"High Score",rules:"Game Rules",close:"Close",hideRules:"Hide Rules",gameplay:"Gameplay",clickStartButton:'Click "Start Game" button',preciseBubblePop:"Precise Bubble Pop",computer:"Computer",preciseClickCenter:"Precisely click bubble center to pop",mobile:"Mobile",preciseTouchCenter:"Precisely touch bubble center to pop",highAccuracyRequired:"High accuracy required, clicking bubble edge is invalid",fastBubbles:"Fast bubbles",harderToPop:"Harder to pop, requires higher accuracy",slowBubbles:"Slow bubbles",easierToPop:"Relatively easier to pop",emotionBubbleScore:"Emotion Bubble Score",angryBubble:"Angry bubble",anxiousBubble:"Anxious bubble",depressedBubble:"Depressed bubble",stressedBubble:"Stressed bubble",irritatedBubble:"Irritated bubble",frustratedBubble:"Frustrated bubble",points:"points",specialBubbles:"Special Bubbles",bombBubble:"Bomb bubble",clearAllNearby:"Clear all nearby bubbles",goldenBubble:"Golden bubble",doubleScore:"Double score",ghostBubble:"Ghost bubble",clickTwice:"Need to click twice",chainBubble:"Chain bubble",clearSameType:"Clear same type bubbles",timeBubble:"Time bubble",add5Seconds:"Add 5 seconds",accuracySystem:"Accuracy System",above:"above",triggerPowerMode:"Trigger power mode",goodAccuracy:"Good accuracy",below:"below",needImproveAccuracy:"Need to improve accuracy",powerMode:"Power Mode",autoTrigger:"Auto trigger",powerModeEasier:"Easier to pop bubbles in power mode",last10Seconds:"Last 10 seconds then auto end",comboSystem:"Combo System",continuousPopExtraScore:"Continuous pop for extra score",timeLimit:"Time Limit",sixtySecondsHighestScore:"60 seconds to get highest score",gameGoal:"Game Goal",precisePopEmotionBubbles:"Precisely pop emotion bubbles, release inner pressure",accuracyChallenge:"Accuracy Challenge",onlyClickCenterToPop:"Only by clicking the center of the bubble can you pop it",fastBubblesNeedHigherAccuracy:"Fast bubbles require higher accuracy"},ja:{title:"バブルポップ",start:"ゲーム開始",restart:"再開",score:"スコア",time:"時間",combo:"コンボ",accuracy:"精度",highScore:"ハイスコア",rules:"ゲームルール",close:"閉じる",hideRules:"ルール非表示",gameplay:"ゲームプレイ",clickStartButton:"「ゲーム開始」ボタンをクリック",preciseBubblePop:"精密バブルポップ",computer:"パソコン",preciseClickCenter:"バブルの中心を精密にクリックしてポップ",mobile:"モバイル",preciseTouchCenter:"バブルの中心を精密にタッチしてポップ",highAccuracyRequired:"高精度が必要、バブルの端をクリックは無効",fastBubbles:"高速バブル",harderToPop:"ポップしにくい、より高い精度が必要",slowBubbles:"低速バブル",easierToPop:"比較的ポップしやすい",emotionBubbleScore:"感情バブルスコア",angryBubble:"怒りバブル",anxiousBubble:"不安バブル",depressedBubble:"憂鬱バブル",stressedBubble:"ストレスバブル",irritatedBubble:"イライラバブル",frustratedBubble:"フラストレーションバブル",points:"ポイント",specialBubbles:"特殊バブル",bombBubble:"爆弾バブル",clearAllNearby:"周辺のすべてのバブルをクリア",goldenBubble:"ゴールデンバブル",doubleScore:"ダブルスコア",ghostBubble:"ゴーストバブル",clickTwice:"2回クリックが必要",chainBubble:"チェーンバブル",clearSameType:"同じタイプのバブルをクリア",timeBubble:"タイムバブル",add5Seconds:"5秒追加",accuracySystem:"精度システム",above:"以上",triggerPowerMode:"パワーモード発動",goodAccuracy:"良好な精度",below:"以下",needImproveAccuracy:"精度向上が必要",powerMode:"パワーモード",autoTrigger:"自動発動",powerModeEasier:"パワーモードでバブルがポップしやすい",last10Seconds:"10秒間続いて自動終了",comboSystem:"コンボシステム",continuousPopExtraScore:"連続ポップでボーナススコア",timeLimit:"時間制限",sixtySecondsHighestScore:"60秒で最高スコアを獲得",gameGoal:"ゲーム目標",precisePopEmotionBubbles:"感情バブルを精密にポップして、内なる圧力を解放",accuracyChallenge:"精度チャレンジ",onlyClickCenterToPop:"バブルの中心をクリックするだけでポップできる",fastBubblesNeedHigherAccuracy:"高速バブルはより高い精度が必要"},ko:{title:"버블 팝",start:"게임 시작",restart:"다시 시작",score:"점수",time:"시간",combo:"콤보",accuracy:"정확도",highScore:"최고 점수",rules:"게임 규칙",close:"닫기",hideRules:"규칙 숨기기",gameplay:"게임 플레이",clickStartButton:"「게임 시작」버튼 클릭",preciseBubblePop:"정밀 버블 팝",computer:"컴퓨터",preciseClickCenter:"버블 중심을 정밀하게 클릭하여 팝",mobile:"모바일",preciseTouchCenter:"버블 중심을 정밀하게 터치하여 팝",highAccuracyRequired:"높은 정확도 필요, 버블 가장자리 클릭은 무효",fastBubbles:"빠른 버블",harderToPop:"팝하기 어려움, 더 높은 정확도 필요",slowBubbles:"느린 버블",easierToPop:"상대적으로 팝하기 쉬움",emotionBubbleScore:"감정 버블 점수",angryBubble:"분노 버블",anxiousBubble:"불안 버블",depressedBubble:"우울 버블",stressedBubble:"스트레스 버블",irritatedBubble:"짜증 버블",frustratedBubble:"좌절 버블",points:"점",specialBubbles:"특수 버블",bombBubble:"폭탄 버블",clearAllNearby:"주변 모든 버블 제거",goldenBubble:"골든 버블",doubleScore:"더블 점수",ghostBubble:"고스트 버블",clickTwice:"두 번 클릭 필요",chainBubble:"체인 버블",clearSameType:"같은 타입 버블 제거",timeBubble:"타임 버블",add5Seconds:"5초 추가",accuracySystem:"정확도 시스템",above:"이상",triggerPowerMode:"파워 모드 발동",goodAccuracy:"좋은 정확도",below:"이하",needImproveAccuracy:"정확도 향상 필요",powerMode:"파워 모드",autoTrigger:"자동 발동",powerModeEasier:"파워 모드에서 버블이 팝하기 쉬움",last10Seconds:"10초간 지속 후 자동 종료",comboSystem:"콤보 시스템",continuousPopExtraScore:"연속 팝으로 보너스 점수",timeLimit:"시간 제한",sixtySecondsHighestScore:"60초 내 최고 점수 획득",gameGoal:"게임 목표",precisePopEmotionBubbles:"감정 버블을 정밀하게 팝하여 내면의 압력을 해방",accuracyChallenge:"정확도 챌린지",onlyClickCenterToPop:"버블의 중심을 클릭해야만 팝할 수 있다",fastBubblesNeedHigherAccuracy:"빠른 버블은 더 높은 정확도가 필요하다"},vi:{title:"Bong Bóng Nổ",start:"Bắt Đầu Trò Chơi",restart:"Chơi Lại",score:"Điểm",time:"Thời Gian",combo:"Combo",accuracy:"Độ Chính Xác",highScore:"Điểm Cao Nhất",rules:"Luật Chơi",close:"Đóng",hideRules:"Ẩn Luật",gameplay:"Cách Chơi",clickStartButton:'Nhấp vào nút "Bắt Đầu Trò Chơi"',preciseBubblePop:"Bong Bóng Nổ Chính Xác",computer:"Máy tính",preciseClickCenter:"Nhấp chính xác vào trung tâm bong bóng để nổ",mobile:"Điện thoại",preciseTouchCenter:"Chạm chính xác vào trung tâm bong bóng để nổ",highAccuracyRequired:"Cần độ chính xác cao, nhấp vào cạnh bong bóng không hiệu quả",fastBubbles:"Bong bóng nhanh",harderToPop:"Khó nổ hơn, cần độ chính xác cao hơn",slowBubbles:"Bong bóng chậm",easierToPop:"Tương đối dễ nổ",emotionBubbleScore:"Điểm Bong Bóng Cảm Xúc",angryBubble:"Bong bóng giận dữ",anxiousBubble:"Bong bóng lo lắng",depressedBubble:"Bong bóng trầm cảm",stressedBubble:"Bong bóng căng thẳng",irritatedBubble:"Bong bóng khó chịu",frustratedBubble:"Bong bóng thất vọng",points:"điểm",specialBubbles:"Bong Bóng Đặc Biệt",bombBubble:"Bong bóng bom",clearAllNearby:"Xóa tất cả bong bóng gần đó",goldenBubble:"Bong bóng vàng",doubleScore:"Điểm gấp đôi",ghostBubble:"Bong bóng ma",clickTwice:"Cần nhấp hai lần",chainBubble:"Bong bóng chuỗi",clearSameType:"Xóa bong bóng cùng loại",timeBubble:"Bong bóng thời gian",add5Seconds:"Thêm 5 giây",accuracySystem:"Hệ Thống Chính Xác",above:"trên",triggerPowerMode:"Kích hoạt chế độ năng lượng",goodAccuracy:"Độ chính xác tốt",below:"dưới",needImproveAccuracy:"Cần cải thiện độ chính xác",powerMode:"Chế Độ Năng Lượng",autoTrigger:"Tự động kích hoạt",powerModeEasier:"Dễ nổ bong bóng hơn trong chế độ năng lượng",last10Seconds:"Kéo dài 10 giây rồi tự động kết thúc",comboSystem:"Hệ Thống Combo",continuousPopExtraScore:"Nổ liên tục để có điểm thêm",timeLimit:"Giới Hạn Thời Gian",sixtySecondsHighestScore:"60 giây để đạt điểm cao nhất",gameGoal:"Mục Tiêu Trò Chơi",precisePopEmotionBubbles:"Nổ chính xác bong bóng cảm xúc, giải phóng áp lực bên trong",accuracyChallenge:"Thử Thách Độ Chính Xác",onlyClickCenterToPop:"Chỉ bằng cách nhấp vào trung tâm bong bóng mới có thể nổ",fastBubblesNeedHigherAccuracy:"Bong bóng nhanh cần độ chính xác cao hơn"},th:{title:"ป๊อปบับเบิล",start:"เริ่มเกม",restart:"เริ่มใหม่",score:"คะแนน",time:"เวลา",combo:"คอมโบ",accuracy:"ความแม่นยำ",highScore:"คะแนนสูงสุด",rules:"กฎเกม",close:"ปิด",hideRules:"ซ่อนกฎ",gameplay:"วิธีเล่น",clickStartButton:'คลิกปุ่ม "เริ่มเกม"',preciseBubblePop:"ป๊อปบับเบิลอย่างแม่นยำ",computer:"คอมพิวเตอร์",preciseClickCenter:"คลิกตรงกลางบับเบิลอย่างแม่นยำเพื่อป๊อป",mobile:"มือถือ",preciseTouchCenter:"แตะตรงกลางบับเบิลอย่างแม่นยำเพื่อป๊อป",highAccuracyRequired:"ต้องการความแม่นยำสูง การคลิกขอบบับเบิลไม่นับ",fastBubbles:"บับเบิลเร็ว",harderToPop:"ป๊อปยากขึ้น ต้องการความแม่นยำสูงขึ้น",slowBubbles:"บับเบิลช้า",easierToPop:"ค่อนข้างป๊อปง่าย",emotionBubbleScore:"คะแนนบับเบิลอารมณ์",angryBubble:"บับเบิลโกรธ",anxiousBubble:"บับเบิลกังวล",depressedBubble:"บับเบิลเศร้า",stressedBubble:"บับเบิลเครียด",irritatedBubble:"บับเบิลหงุดหงิด",frustratedBubble:"บับเบิลหงุดหงิด",points:"คะแนน",specialBubbles:"บับเบิลพิเศษ",bombBubble:"บับเบิลระเบิด",clearAllNearby:"ลบบับเบิลใกล้เคียงทั้งหมด",goldenBubble:"บับเบิลทอง",doubleScore:"คะแนนสองเท่า",ghostBubble:"บับเบิลผี",clickTwice:"ต้องคลิกสองครั้ง",chainBubble:"บับเบิลโซ่",clearSameType:"ลบบับเบิลประเภทเดียวกัน",timeBubble:"บับเบิลเวลา",add5Seconds:"เพิ่ม 5 วินาที",accuracySystem:"ระบบความแม่นยำ",above:"ขึ้นไป",triggerPowerMode:"เปิดโหมดพลัง",goodAccuracy:"ความแม่นยำดี",below:"ลงมา",needImproveAccuracy:"ต้องปรับปรุงความแม่นยำ",powerMode:"โหมดพลัง",autoTrigger:"เปิดอัตโนมัติ",powerModeEasier:"ป๊อปบับเบิลง่ายขึ้นในโหมดพลัง",last10Seconds:"คงอยู่ 10 วินาทีแล้วปิดอัตโนมัติ",comboSystem:"ระบบคอมโบ",continuousPopExtraScore:"ป๊อปต่อเนื่องเพื่อคะแนนเพิ่ม",timeLimit:"จำกัดเวลา",sixtySecondsHighestScore:"60 วินาทีเพื่อคะแนนสูงสุด",gameGoal:"เป้าหมายเกม",precisePopEmotionBubbles:"ป๊อปบับเบิลอารมณ์อย่างแม่นยำ ปลดปล่อยแรงกดดันภายใน",accuracyChallenge:"ความท้าทายความแม่นยำ",onlyClickCenterToPop:"เฉพาะการคลิกตรงกลางบับเบิลเท่านั้นที่สามารถป๊อปได้",fastBubblesNeedHigherAccuracy:"บับเบิลเร็วต้องการความแม่นยำสูงขึ้น"},la:{title:"Bulla Explodere",start:"Ludum Incipere",restart:"Iterum Incipere",score:"Puncta",time:"Tempus",combo:"Combo",accuracy:"Accuratio",highScore:"Puncta Maxima",rules:"Regulae Ludi",close:"Claudere",hideRules:"Regulae Occultare",gameplay:"Ludus",clickStartButton:'Clicca "Ludum Incipere" pugnum',preciseBubblePop:"Bulla Accurata Explodere",computer:"Computatrum",preciseClickCenter:"Clicca accurate centrum bullae ut explodat",mobile:"Mobile",preciseTouchCenter:"Tange accurate centrum bullae ut explodat",highAccuracyRequired:"Accuratio alta requiritur, cliccare marginem bullae invalidum est",fastBubbles:"Bullae veloces",harderToPop:"Difficilius explodere, accuratio altior requiritur",slowBubbles:"Bullae tardae",easierToPop:"Relativiter facilius explodere",emotionBubbleScore:"Puncta Bullae Emotionis",angryBubble:"Bulla irata",anxiousBubble:"Bulla anxia",depressedBubble:"Bulla depressa",stressedBubble:"Bulla pressa",irritatedBubble:"Bulla irritata",frustratedBubble:"Bulla frustrata",points:"puncta",specialBubbles:"Bullae Speciales",bombBubble:"Bulla bomba",clearAllNearby:"Clara omnes bullas proximas",goldenBubble:"Bulla aurea",doubleScore:"Puncta dupla",ghostBubble:"Bulla phantasma",clickTwice:"Opus est bis cliccare",chainBubble:"Bulla catena",clearSameType:"Clara bullas eiusdem generis",timeBubble:"Bulla temporis",add5Seconds:"Adde 5 secundis",accuracySystem:"Systema Accurationis",above:"supra",triggerPowerMode:"Activa modum potentiae",goodAccuracy:"Accuratio bona",below:"infra",needImproveAccuracy:"Opus est accuratio meliorare",powerMode:"Modus Potentiae",autoTrigger:"Auto activa",powerModeEasier:"Facilius explodere bullas in modo potentiae",last10Seconds:"Dura 10 secundis deinde auto finis",comboSystem:"Systema Combo",continuousPopExtraScore:"Explodere continuum pro punctis extra",timeLimit:"Finis Temporis",sixtySecondsHighestScore:"60 secundis pro punctis maximis",gameGoal:"Finis Ludi",precisePopEmotionBubbles:"Explodere accurate bullas emotionis, libera pressionem internam",accuracyChallenge:"Provocatio Accurationis",onlyClickCenterToPop:"Solum cliccare centrum bullae potest explodere",fastBubblesNeedHigherAccuracy:"Bullae veloces accuratio altior requiritur"},ms:{title:"Letup Buih",start:"Mulakan Permainan",restart:"Mulakan Semula",score:"Markah",time:"Masa",combo:"Combo",accuracy:"Ketepatan",highScore:"Markah Tertinggi",rules:"Peraturan Permainan",close:"Tutup",hideRules:"Sembunyikan Peraturan",gameplay:"Cara Bermain",clickStartButton:'Klik butang "Mulakan Permainan"',preciseBubblePop:"Letup Buih Tepat",computer:"Komputer",preciseClickCenter:"Klik tepat di tengah buih untuk meletup",mobile:"Mudah alih",preciseTouchCenter:"Sentuh tepat di tengah buih untuk meletup",highAccuracyRequired:"Ketepatan tinggi diperlukan, mengklik tepi buih tidak sah",fastBubbles:"Buih pantas",harderToPop:"Lebih sukar untuk meletup, memerlukan ketepatan lebih tinggi",slowBubbles:"Buih perlahan",easierToPop:"Relatif lebih mudah untuk meletup",emotionBubbleScore:"Markah Buih Emosi",angryBubble:"Buih marah",anxiousBubble:"Buih cemas",depressedBubble:"Buih tertekan",stressedBubble:"Buih tertekan",irritatedBubble:"Buih jengkel",frustratedBubble:"Buih kecewa",points:"markah",specialBubbles:"Buih Khas",bombBubble:"Buih bom",clearAllNearby:"Kosongkan semua buih berdekatan",goldenBubble:"Buih emas",doubleScore:"Markah berganda",ghostBubble:"Buih hantu",clickTwice:"Perlu klik dua kali",chainBubble:"Buih rantai",clearSameType:"Kosongkan buih jenis sama",timeBubble:"Buih masa",add5Seconds:"Tambah 5 saat",accuracySystem:"Sistem Ketepatan",above:"ke atas",triggerPowerMode:"Pencetus mod kuasa",goodAccuracy:"Ketepatan baik",below:"ke bawah",needImproveAccuracy:"Perlu tingkatkan ketepatan",powerMode:"Mod Kuasa",autoTrigger:"Pencetus automatik",powerModeEasier:"Lebih mudah meletup buih dalam mod kuasa",last10Seconds:"Bertahan 10 saat kemudian tamat automatik",comboSystem:"Sistem Combo",continuousPopExtraScore:"Letup berterusan untuk markah tambahan",timeLimit:"Had Masa",sixtySecondsHighestScore:"60 saat untuk markah tertinggi",gameGoal:"Matlamat Permainan",precisePopEmotionBubbles:"Letup tepat buih emosi, lepaskan tekanan dalaman",accuracyChallenge:"Cabaran Ketepatan",onlyClickCenterToPop:"Hanya dengan mengklik pusat buih boleh meletup",fastBubblesNeedHigherAccuracy:"Buih pantas memerlukan ketepatan lebih tinggi"}};return((Xe=Ve[e])==null?void 0:Xe[me])||Ve["zh-TW"][me]||me},[d,h]=v.useState(60),[m,g]=v.useState(0),[x,S]=v.useState(0),[C,_]=v.useState(!1),[I,T]=v.useState(0),[F,P]=v.useState(!1),[B,q]=v.useState(0),[te,W]=v.useState(0),[L,R]=v.useState(0),[A,N]=v.useState(!1),[O,z]=v.useState(0),[j,V]=v.useState([]),[X,$]=v.useState([]);v.useEffect(()=>{const me=localStorage.getItem("bubblePopHighScore");me&&S(parseInt(me))},[]);const ne=[{color:"#ff6b6b",emotion:"😠",points:10,name:"憤怒"},{color:"#4ecdc4",emotion:"😰",points:15,name:"焦慮"},{color:"#ffe66d",emotion:"😔",points:20,name:"憂鬱"},{color:"#a8e6cf",emotion:"😤",points:25,name:"壓力"},{color:"#ff8a80",emotion:"😡",points:30,name:"暴躁"},{color:"#9575cd",emotion:"😞",points:35,name:"沮喪"}],oe=()=>{const me=["戳破煩惱，釋放心情！","泡泡爆破，壓力全消！","情緒泡泡，一戳就爆！","連擊模式，心情舒暢！","泡泡療法，治癒心靈！"];return me[Math.floor(Math.random()*me.length)]},[J]=v.useState(oe()),Q=()=>{r(!0),a(0),h(60),g(0),V([]),$([]),q(0),W(0),R(0),N(!1),z(0)},D=()=>{if(!t)return;const me=ne[Math.floor(Math.random()*ne.length)],Ve=Math.random()*80+10,Xe=Math.random()*80+10,Je=Math.random();let He;Je<.3?He=Math.random()*10+15:Je<.6?He=Math.random()*15+25:Je<.85?He=Math.random()*20+40:He=Math.random()*25+60;const fe=Math.random();let Te="normal",_e=me.points,Fe=me.color,Be=me.emotion;if(fe<.05)Te="bomb",_e=50,Fe="#ff4757",Be="💣",He=Math.random()*15+45;else if(fe<.1)Te="golden",_e=100,Fe="#ffa502",Be="⭐",He=Math.random()*20+50;else{if(fe<.15)return Te="ghost",_e=30,Fe="#a4b0be",Be="👻",He=Math.random()*10+20,{id:Date.now(),x:Ve,y:Xe,size:He,color:Fe,emotion:Be,points:_e,speed:Math.random()*3+2,opacity:.8+Math.random()*.2,type:Te,health:2};fe<.2?(Te="chain",_e=40,Fe="#2ed573",Be="🔗",He=Math.random()*15+35):fe<.25&&(Te="time",_e=25,Fe="#3742fa",Be="⏰",He=Math.random()*12+25)}const K={id:Date.now(),x:Ve,y:Xe,size:He,color:Fe,emotion:Be,points:_e,speed:Math.random()*3+1.5,opacity:.8+Math.random()*.2,type:Te,chainId:Te==="chain"?Math.floor(Math.random()*1e3):void 0,timeBonus:Te==="time"?5:void 0};V(re=>[...re,K])},G=me=>{const Ve=j.find(Te=>Te.id===me);if(!Ve)return;const Xe=Math.floor(m/5)*5;let Je=Ve.points+Xe;if(Ve.type==="bomb"){const Te=j.filter(_e=>_e.id!==me&&Math.sqrt((_e.x-Ve.x)**2+(_e.y-Ve.y)**2)<15);Te.forEach(_e=>{Je+=_e.points,g(Fe=>Fe+1)}),V(_e=>_e.filter(Fe=>Fe.id!==me&&!Te.find(Be=>Be.id===Fe.id)))}else if(Ve.type==="golden")Je*=2,V(Te=>Te.filter(_e=>_e.id!==me));else if(Ve.type==="ghost"){if(Ve.health&&Ve.health>1){V(Te=>Te.map(_e=>_e.id===me?{..._e,health:_e.health-1}:_e));return}V(Te=>Te.filter(_e=>_e.id!==me))}else if(Ve.type==="chain"){const Te=j.filter(_e=>_e.id!==me&&_e.chainId===Ve.chainId);Te.forEach(_e=>{Je+=_e.points,g(Fe=>Fe+1)}),V(_e=>_e.filter(Fe=>Fe.id!==me&&!Te.find(Be=>Be.id===Fe.id)))}else Ve.type==="time"?(h(Te=>Te+(Ve.timeBonus||5)),V(Te=>Te.filter(_e=>_e.id!==me))):V(Te=>Te.filter(_e=>_e.id!==me));a(Te=>Te+Je),g(Te=>Te+1),T(3),m>=4&&(P(!0),Ye(),setTimeout(()=>P(!1),1e3));const He=Ve.type==="bomb"?15:8,fe=[];for(let Te=0;Te<He;Te++){const _e=Te/He*Math.PI*2,Fe=2+Math.random()*3;fe.push({id:Date.now()+Te,x:Ve.x,y:Ve.y,vx:Math.cos(_e)*Fe,vy:Math.sin(_e)*Fe,color:Ve.color,life:1})}$(Te=>[...Te,...fe])},ie=()=>{r(!1),o>x&&(S(o),localStorage.setItem("bubblePopHighScore",o.toString()))};v.useEffect(()=>{if(!t)return;const me=setInterval(()=>{const Ve=.03+(60-d)*.001,Xe=Math.min(.15,Ve*1.8);Math.random()<Xe&&D(),V(Je=>Je.map(He=>({...He,y:He.y-He.speed*1.2,opacity:He.opacity-.003,x:He.x+(Math.random()-.5)*.4})).filter(He=>He.y>-10&&He.opacity>.1)),$(Je=>Je.map(He=>({...He,x:He.x+He.vx,y:He.y+He.vy,vy:He.vy+.1,life:He.life-.02})).filter(He=>He.life>0)),I>0?T(Je=>Je-.05):m>0&&g(0),O>0?z(Je=>Je-.05):A&&N(!1)},30);return()=>clearInterval(me)},[t]),v.useEffect(()=>{if(!t||d<=0)return;const me=setInterval(()=>{h(Ve=>Ve<=1?(ie(),0):Ve-1)},1e3);return()=>clearInterval(me)},[t,d]),v.useEffect(()=>{},[t,j]);const[ee,Se]=v.useState(null),[we,Oe]=v.useState(!0);v.useEffect(()=>{if(typeof window<"u"&&window.AudioContext){const me=new AudioContext;Se(me)}},[]);const Ne=()=>{if(!(!ee||!we))try{const me=ee.createOscillator(),Ve=ee.createGain();me.connect(Ve),Ve.connect(ee.destination),me.type="sine",me.frequency.setValueAtTime(800,ee.currentTime),me.frequency.exponentialRampToValueAtTime(200,ee.currentTime+.1),Ve.gain.setValueAtTime(.3,ee.currentTime),Ve.gain.exponentialRampToValueAtTime(.01,ee.currentTime+.1),me.start(ee.currentTime),me.stop(ee.currentTime+.1)}catch(me){console.log("音效播放失敗:",me)}},Ye=()=>{if(!(!ee||!we))try{const me=ee.createOscillator(),Ve=ee.createGain();me.connect(Ve),Ve.connect(ee.destination),me.type="square",me.frequency.setValueAtTime(1e3,ee.currentTime),me.frequency.exponentialRampToValueAtTime(400,ee.currentTime+.2),Ve.gain.setValueAtTime(.2,ee.currentTime),Ve.gain.exponentialRampToValueAtTime(.01,ee.currentTime+.2),me.start(ee.currentTime),me.stop(ee.currentTime+.2)}catch(me){console.log("連擊音效播放失敗:",me)}},it=()=>{if(!(!ee||!we))try{const me=ee.createOscillator(),Ve=ee.createGain();me.connect(Ve),Ve.connect(ee.destination),me.type="sawtooth",me.frequency.setValueAtTime(600,ee.currentTime),me.frequency.exponentialRampToValueAtTime(1200,ee.currentTime+.3),Ve.gain.setValueAtTime(.15,ee.currentTime),Ve.gain.exponentialRampToValueAtTime(.01,ee.currentTime+.3),me.start(ee.currentTime),me.stop(ee.currentTime+.3)}catch(me){console.log("能量模式音效播放失敗:",me)}};return i.jsxs("div",{style:{width:"100vw",height:"100vh",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",position:"relative",overflow:"auto",cursor:t?"pointer":"default",touchAction:"pan-y",userSelect:"none",WebkitUserSelect:"none",WebkitTouchCallout:"none"},onClick:me=>{me.preventDefault(),me.stopPropagation()},onMouseDown:me=>{me.preventDefault(),me.stopPropagation()},children:[i.jsx("style",{children:`
          @keyframes float {
            0%, 100% { transform: translate(-50%, -50%) translateY(0px); }
            50% { transform: translate(-50%, -50%) translateY(-10px); }
          }
          @keyframes comboEffect {
            0% { 
              transform: translate(-50%, -50%) scale(0.5);
              opacity: 0;
            }
            50% { 
              transform: translate(-50%, -50%) scale(1.2);
              opacity: 1;
            }
            100% { 
              transform: translate(-50%, -50%) scale(1);
              opacity: 0;
            }
          }
          @keyframes powerMode {
            0% { 
              opacity: 0.7;
              textShadow: 0 0 5px #FF5722;
            }
            100% { 
              opacity: 1;
              textShadow: 0 0 15px #FF5722, 0 0 25px #FF5722;
            }
          }
          @keyframes popEffect {
            0% { 
              transform: translate(-50%, -50%) scale(1);
              opacity: 1;
            }
            50% { 
              transform: translate(-50%, -50%) scale(1.3);
              opacity: 0.8;
            }
            100% { 
              transform: translate(-50%, -50%) scale(0);
              opacity: 0;
            }
          }
        `}),i.jsx("button",{onClick:n,style:{position:"absolute",top:"clamp(20px, 4vw, 40px)",left:"clamp(20px, 4vw, 40px)",background:"#fff",border:"2px solid #9C27B0",borderRadius:"50%",width:"clamp(40px, 8vw, 50px)",height:"clamp(40px, 8vw, 50px)",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",fontSize:"clamp(1.2rem, 3vw, 1.5rem)",zIndex:10,boxShadow:"0 2px 8px rgba(0,0,0,0.2)"},children:"←"}),i.jsxs("div",{style:{position:"absolute",top:"clamp(20px, 4vw, 40px)",left:"clamp(80px, 16vw, 100px)",background:"rgba(255,255,255,0.9)",borderRadius:"15px",padding:"clamp(12px, 2.5vw, 16px)",zIndex:5,maxWidth:"180px"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"8px"},children:[i.jsxs("h3",{style:{fontSize:"clamp(1rem, 2.5vw, 1.2rem)",margin:0,lineHeight:"1.2"},children:["🫧 ",c("title")]}),i.jsx("button",{onClick:()=>_(!C),style:{background:"#9C27B0",color:"#fff",border:"none",borderRadius:"12px",padding:"2px 8px",fontSize:"clamp(0.6rem, 1.5vw, 0.7rem)",cursor:"pointer"},children:c(C?"hideRules":"rules")})]}),!C&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{display:"flex",gap:"clamp(4px, 1vw, 8px)",justifyContent:"center",flexWrap:"wrap",marginBottom:"6px"},children:[i.jsxs("div",{style:{fontSize:"clamp(0.7rem, 1.8vw, 0.85rem)"},children:[c("score"),"：",o]}),i.jsxs("div",{style:{fontSize:"clamp(0.7rem, 1.8vw, 0.85rem)"},children:[c("time"),"：",d,"秒"]}),i.jsxs("div",{style:{fontSize:"clamp(0.7rem, 1.8vw, 0.85rem)",color:m>=5?"#ff6b6b":m>=3?"#ffa502":"#333",fontWeight:m>=3?"bold":"normal"},children:[c("combo"),"：",m]})]}),i.jsxs("div",{style:{display:"flex",gap:"clamp(4px, 1vw, 8px)",justifyContent:"center",flexWrap:"wrap",marginBottom:"6px"},children:[i.jsxs("div",{style:{fontSize:"clamp(0.7rem, 1.8vw, 0.85rem)",color:B>=80?"#4CAF50":B>=60?"#FF9800":"#F44336"},children:[c("accuracy"),"：",B.toFixed(1),"%"]}),A&&i.jsx("div",{style:{fontSize:"clamp(0.7rem, 1.8vw, 0.85rem)",color:"#FF5722",fontWeight:"bold",animation:"powerMode 0.5s ease-in-out infinite alternate"},children:"⚡能量模式"})]}),i.jsxs("div",{style:{display:"flex",gap:"clamp(4px, 1vw, 8px)",justifyContent:"center",flexWrap:"wrap"},children:[i.jsxs("div",{style:{fontSize:"clamp(0.6rem, 1.5vw, 0.75rem)"},children:["泡泡：",j.length]}),i.jsxs("div",{style:{fontSize:"clamp(0.6rem, 1.5vw, 0.75rem)"},children:[c("highScore"),"：",x]}),i.jsx("div",{style:{fontSize:"clamp(0.6rem, 1.5vw, 0.75rem)",color:j.some(me=>me.speed>=3)?"#ff6b6b":j.some(me=>me.speed>=2)?"#ffa502":"#4CAF50"},children:j.some(me=>me.speed>=3)?"🚀 快速":j.some(me=>me.speed>=2)?"⚡ 中速":"🐌 慢速"})]}),i.jsx("div",{style:{display:"flex",justifyContent:"center",marginTop:"clamp(4px, 1vw, 8px)",gap:"clamp(4px, 1vw, 8px)"},children:i.jsxs("button",{onClick:()=>Oe(!we),style:{background:we?"#4CAF50":"#f44336",color:"white",border:"none",borderRadius:"8px",padding:"clamp(2px, 0.5vw, 4px) clamp(6px, 1.5vw, 8px)",fontSize:"clamp(0.5rem, 1.2vw, 0.6rem)",cursor:"pointer",display:"flex",alignItems:"center",gap:"2px"},children:[we?"🔊":"🔇"," ",c(we?"soundOn":"soundOff")]})}),i.jsx("div",{style:{fontSize:"clamp(0.7rem, 1.8vw, 0.85rem)",color:"#9C27B0",fontWeight:"bold",marginTop:"6px",textAlign:"center"},children:J}),!t&&i.jsx("button",{onClick:Q,style:{background:"#9C27B0",color:"#fff",border:"none",borderRadius:"20px",padding:"clamp(5px, 1.2vw, 6px) clamp(12px, 2.5vw, 18px)",fontSize:"clamp(0.8rem, 2vw, 0.9rem)",fontWeight:"bold",marginTop:"8px",cursor:"pointer",transition:"all 0.3s ease"},children:c("start")})]}),C&&i.jsxs("div",{style:{maxHeight:"200px",overflowY:"auto",fontSize:"clamp(0.7rem, 1.8vw, 0.85rem)",lineHeight:"1.4"},children:[i.jsxs("h4",{style:{margin:"0 0 8px 0",color:"#9C27B0"},children:[c("gameplay"),"："]}),i.jsxs("ul",{style:{margin:"0",paddingLeft:"15px"},children:[i.jsxs("li",{children:[i.jsx("strong",{children:c("start")}),"：",c("clickStartButton")]}),i.jsxs("li",{children:[i.jsx("strong",{children:c("preciseBubblePop")}),"：",i.jsx("br",{}),c("computer"),"：",c("preciseClickCenter"),i.jsx("br",{}),c("mobile"),"：",c("preciseTouchCenter"),i.jsx("br",{}),"⚠️ ",c("highAccuracyRequired"),i.jsx("br",{}),"🚀 ",c("fastBubbles"),"：",c("harderToPop"),i.jsx("br",{}),"🐌 ",c("slowBubbles"),"：",c("easierToPop")]}),i.jsxs("li",{children:[i.jsx("strong",{children:c("emotionBubbleScore")}),"：",i.jsx("br",{}),"😠 ",c("angryBubble"),"：10",c("points"),i.jsx("br",{}),"😰 ",c("anxiousBubble"),"：15",c("points"),i.jsx("br",{}),"😔 ",c("depressedBubble"),"：20",c("points"),i.jsx("br",{}),"😤 ",c("stressedBubble"),"：25",c("points"),i.jsx("br",{}),"😡 ",c("irritatedBubble"),"：30",c("points"),i.jsx("br",{}),"😞 ",c("frustratedBubble"),"：35",c("points")]}),i.jsxs("li",{children:[i.jsx("strong",{children:c("specialBubbles")}),"：",i.jsx("br",{}),"💣 ",c("bombBubble"),"：50",c("points"),"，",c("clearAllNearby"),i.jsx("br",{}),"⭐ ",c("goldenBubble"),"：100",c("points"),"，",c("doubleScore"),i.jsx("br",{}),"👻 ",c("ghostBubble"),"：30",c("points"),"，",c("clickTwice"),i.jsx("br",{}),"🔗 ",c("chainBubble"),"：40",c("points"),"，",c("clearSameType"),i.jsx("br",{}),"⏰ ",c("timeBubble"),"：25",c("points"),"，",c("add5Seconds")]}),i.jsxs("li",{children:[i.jsx("strong",{children:c("accuracySystem")}),"：",i.jsx("br",{}),"🟢 80%",c("above"),"：",c("triggerPowerMode"),i.jsx("br",{}),"🟡 60-79%：",c("goodAccuracy"),i.jsx("br",{}),"🔴 60%",c("below"),"：",c("needImproveAccuracy")]}),i.jsxs("li",{children:[i.jsx("strong",{children:c("powerMode")}),"：",i.jsx("br",{}),"⚡ 80%",c("above"),c("autoTrigger"),i.jsx("br",{}),"🎯 ",c("powerModeEasier"),i.jsx("br",{}),"⏱️ ",c("last10Seconds")]}),i.jsxs("li",{children:[i.jsx("strong",{children:c("comboSystem")}),"：",c("continuousPopExtraScore")]}),i.jsxs("li",{children:[i.jsx("strong",{children:c("timeLimit")}),"：",c("60SecondsHighestScore")]}),i.jsxs("li",{children:[i.jsx("strong",{children:c("gameGoal")}),"：",c("precisePopEmotionBubbles"),"！"]})]})]})]}),j.map(me=>{const Ve=me.type==="bomb"?{animation:"float 2s ease-in-out infinite",boxShadow:"0 0 20px #ff4757"}:me.type==="golden"?{animation:"float 1.5s ease-in-out infinite",boxShadow:"0 0 25px #ffa502"}:me.type==="ghost"?{animation:"float 1s ease-in-out infinite",opacity:.6}:me.type==="chain"?{animation:"float 1.8s ease-in-out infinite",boxShadow:"0 0 15px #2ed573"}:me.type==="time"?{animation:"float 1.2s ease-in-out infinite",boxShadow:"0 0 18px #3742fa"}:{};return i.jsx("div",{style:{position:"absolute",left:`${me.x}%`,top:`${me.y}%`,transform:"translate(-50%, -50%)",width:`${me.size*1.8}px`,height:`${me.size*1.8}px`,background:`radial-gradient(circle at 30% 30%, ${me.color}40, ${me.color})`,borderRadius:"50%",border:`2px solid ${me.color}80`,display:"flex",alignItems:"center",justifyContent:"center",fontSize:`${Math.max(12,me.size*.4)}px`,opacity:me.opacity,cursor:"pointer",transition:"all 0.2s ease",zIndex:20,...Ve},onMouseEnter:Xe=>{Xe.currentTarget.style.transform="translate(-50%, -50%) scale(1.1)"},onMouseLeave:Xe=>{Xe.currentTarget.style.transform="translate(-50%, -50%) scale(1)"},onClick:Xe=>{if(Xe.preventDefault(),Xe.stopPropagation(),console.log("泡泡被點擊:",me.id),t){const Je=Xe.currentTarget;Je.style.animation="popEffect 0.4s ease-out forwards";const He=Je.getBoundingClientRect(),fe=He.left+He.width/2,Te=He.top+He.height/2;for(let _e=0;_e<12;_e++){const Fe=document.createElement("div");Fe.style.position="fixed",Fe.style.left=fe+"px",Fe.style.top=Te+"px",Fe.style.width="6px",Fe.style.height="6px",Fe.style.background=me.color,Fe.style.borderRadius="50%",Fe.style.pointerEvents="none",Fe.style.zIndex="1000",Fe.style.boxShadow=`0 0 8px ${me.color}`,Fe.style.transition="all 0.6s ease",document.body.appendChild(Fe);const Be=_e*30*Math.PI/180,K=60+Math.random()*40,re=fe+Math.cos(Be)*K,H=Te+Math.sin(Be)*K;setTimeout(()=>{Fe.style.left=re+"px",Fe.style.top=H+"px",Fe.style.opacity="0",Fe.style.transform="scale(0)"},10),setTimeout(()=>{document.body.contains(Fe)&&document.body.removeChild(Fe)},600)}W(_e=>_e+1),R(_e=>_e+1),G(me.id),Ne(),B>=80&&!A&&(N(!0),z(10),it()),q(te>0?L/te*100:0)}},onTouchStart:Xe=>{Xe.preventDefault(),Xe.stopPropagation(),console.log("泡泡被觸摸:",me.id);const Je=Xe.currentTarget;if(Je.style.transform="translate(-50%, -50%) scale(1.2)",Je.style.transition="transform 0.1s ease",setTimeout(()=>{Je.style.transform="translate(-50%, -50%) scale(1)"},100),t){console.log("手機版直接爆破泡泡:",me.id);const He=Xe.currentTarget;He.style.animation="popEffect 0.4s ease-out forwards";const fe=He.getBoundingClientRect(),Te=fe.left+fe.width/2,_e=fe.top+fe.height/2;for(let Fe=0;Fe<12;Fe++){const Be=document.createElement("div");Be.style.position="fixed",Be.style.left=Te+"px",Be.style.top=_e+"px",Be.style.width="6px",Be.style.height="6px",Be.style.background=me.color,Be.style.borderRadius="50%",Be.style.pointerEvents="none",Be.style.zIndex="1000",Be.style.boxShadow=`0 0 8px ${me.color}`,Be.style.transition="all 0.6s ease",document.body.appendChild(Be);const K=Fe*30*Math.PI/180,re=60+Math.random()*40,H=Te+Math.cos(K)*re,Ue=_e+Math.sin(K)*re;setTimeout(()=>{Be.style.left=H+"px",Be.style.top=Ue+"px",Be.style.opacity="0",Be.style.transform="scale(0)"},10),setTimeout(()=>{document.body.contains(Be)&&document.body.removeChild(Be)},600)}W(Fe=>Fe+1),R(Fe=>Fe+1),G(me.id),Ne(),B>=80&&!A&&(N(!0),z(10),it()),q(te>0?L/te*100:0)}},children:me.emotion},me.id)}),X.map(me=>i.jsx("div",{style:{position:"absolute",left:`${me.x}%`,top:`${me.y}%`,transform:"translate(-50%, -50%)",width:"4px",height:"4px",background:me.color,borderRadius:"50%",opacity:me.life,pointerEvents:"none"}},me.id)),F&&i.jsxs("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",fontSize:"clamp(2rem, 5vw, 3rem)",fontWeight:"bold",color:"#ff6b6b",textShadow:"0 0 20px #ff6b6b",animation:"comboEffect 1s ease-out forwards",pointerEvents:"none",zIndex:1e3},children:["COMBO x",m,"!"]}),!t&&i.jsxs("div",{style:{position:"absolute",bottom:"clamp(20px, 4vw, 40px)",left:"50%",transform:"translateX(-50%)",background:"rgba(0,0,0,0.7)",color:"#fff",padding:"clamp(8px, 2vw, 12px)",borderRadius:"10px",fontSize:"clamp(0.7rem, 1.8vw, 0.85rem)",textAlign:"center",zIndex:100},children:["🎯 ",c("accuracyChallenge"),"：",c("onlyClickCenterToPop"),"！",i.jsx("br",{}),"🚀 ",c("fastBubblesNeedHigherAccuracy"),"！"]}),!t&&o>0&&i.jsxs("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",background:"rgba(255,255,255,0.95)",borderRadius:"20px",padding:"clamp(20px, 4vw, 30px)",textAlign:"center",zIndex:1001,minWidth:"clamp(250px, 50vw, 350px)"},children:[i.jsx("h2",{style:{fontSize:"clamp(1.5rem, 3.5vw, 2rem)",margin:"0 0 15px 0",color:"#9C27B0"},children:"遊戲結束！"}),i.jsxs("div",{style:{fontSize:"clamp(1rem, 2.5vw, 1.2rem)",marginBottom:"10px"},children:["最終分數：",o]}),i.jsxs("div",{style:{fontSize:"clamp(0.9rem, 2vw, 1rem)",marginBottom:"20px",color:"#666"},children:["最高分數：",x]}),i.jsxs("div",{style:{display:"flex",gap:"10px",justifyContent:"center"},children:[i.jsx("button",{onClick:Q,style:{background:"#9C27B0",color:"#fff",border:"none",borderRadius:"15px",padding:"clamp(8px, 1.5vw, 12px) clamp(16px, 3vw, 24px)",fontSize:"clamp(0.9rem, 2vw, 1rem)",cursor:"pointer"},children:"再玩一次"}),i.jsx("button",{onClick:n,style:{background:"#666",color:"#fff",border:"none",borderRadius:"15px",padding:"clamp(8px, 1.5vw, 12px) clamp(16px, 3vw, 24px)",fontSize:"clamp(0.9rem, 2vw, 1rem)",cursor:"pointer"},children:"返回"})]})]})]})}function W3({onClose:n}){const{lang:e}=Mt(),[t,r]=v.useState(0),[o,a]=v.useState(0),[c,d]=v.useState(!1),[h,m]=v.useState(60),[g,x]=v.useState(50),[S,C]=v.useState([]),[_,I]=v.useState(3),[T,F]=v.useState(1),[P,B]=v.useState(0),[q,te]=v.useState(!1),[W,L]=v.useState(!1),[R,A]=v.useState(!1),[N,O]=v.useState(!1),[z,j]=v.useState(!1),[V,X]=v.useState({x:0,y:0}),$=ee=>{var we;const Se={"zh-TW":{score:"分數",time:"時間",level:"等級",combo:"連擊",title:"極速賽車",rules:"遊戲規則",close:"關閉",gameOver:"遊戲結束",controlMethod:"控制方式",useArrowKeysOrButtons:"使用方向鍵 ← → 或螢幕按鈕控制賽車",moveLeftRightToAvoid:"左右移動避開障礙物",gameObjective:"遊戲目標",avoidAllObstacles:"避開所有障礙物（石頭、汽車、卡車）",successfulAvoidance:"成功避開獲得5分 + 連擊獎勵",collisionPenalty:"碰撞障礙物扣10分並重置連擊",scoringSystem:"計分系統",baseScore:"基礎分數：避開障礙物 +5分",comboBonus:"連擊獎勵：每次連擊額外 +1分",levelUp:"等級提升：每100分提升一個等級",speedIncrease:"速度增加：等級越高，障礙物移動越快",gameTime:"遊戲時間",sixtySecondsPerGame:"每局遊戲60秒",autoScoreWhenTimeUp:"時間結束自動結算分數"},"zh-CN":{score:"分数",time:"时间",level:"等级",combo:"连击",title:"极速赛车",rules:"游戏规则",close:"关闭",controlMethod:"控制方式",useArrowKeysOrButtons:"使用方向键 ← → 或屏幕按钮控制赛车",moveLeftRightToAvoid:"左右移动避开障碍物",gameObjective:"游戏目标",avoidAllObstacles:"避开所有障碍物（石头、汽车、卡车）",successfulAvoidance:"成功避开获得5分 + 连击奖励",collisionPenalty:"碰撞障碍物扣10分并重置连击",scoringSystem:"计分系统",baseScore:"基础分数：避开障碍物 +5分",comboBonus:"连击奖励：每次连击额外 +1分",levelUp:"等级提升：每100分提升一个等级",speedIncrease:"速度增加：等级越高，障碍物移动越快",gameTime:"游戏时间",sixtySecondsPerGame:"每局游戏60秒",autoScoreWhenTimeUp:"时间结束自动结算分数"},en:{score:"Score",time:"Time",level:"Level",combo:"Combo",title:"Speed Racing",rules:"Game Rules",close:"Close",controlMethod:"Control Method",useArrowKeysOrButtons:"Use arrow keys ← → or screen buttons to control the race car",moveLeftRightToAvoid:"Move left and right to avoid obstacles",gameObjective:"Game Objective",avoidAllObstacles:"Avoid all obstacles (stones, cars, trucks)",successfulAvoidance:"Successfully avoid to get 5 points + combo bonus",collisionPenalty:"Colliding with obstacles deducts 10 points and resets combo",scoringSystem:"Scoring System",baseScore:"Base score: avoid obstacles +5 points",comboBonus:"Combo bonus: +1 point for each combo",levelUp:"Level up: gain one level every 100 points",speedIncrease:"Speed increase: the higher the level, the faster obstacles move",gameTime:"Game Time",sixtySecondsPerGame:"60 seconds per game",autoScoreWhenTimeUp:"Auto score when time is up"},ja:{score:"スコア",time:"時間",level:"レベル",combo:"コンボ",title:"スピードレーシング",rules:"ゲームルール",close:"閉じる",controlMethod:"操作方法",useArrowKeysOrButtons:"矢印キー ← → または画面ボタンでレーシングカーを操作",moveLeftRightToAvoid:"左右に移動して障害物を避ける",gameObjective:"ゲーム目標",avoidAllObstacles:"すべての障害物（石、車、トラック）を避ける",successfulAvoidance:"成功して避けると5ポイント + コンボボーナス",collisionPenalty:"障害物に衝突すると10ポイント減点しコンボリセット",scoringSystem:"スコアシステム",baseScore:"基本スコア：障害物を避けると +5ポイント",comboBonus:"コンボボーナス：各コンボで +1ポイント",levelUp:"レベルアップ：100ポイントごとに1レベルアップ",speedIncrease:"速度増加：レベルが高いほど障害物が速く動く",gameTime:"ゲーム時間",sixtySecondsPerGame:"ゲームあたり60秒",autoScoreWhenTimeUp:"時間切れで自動スコア"},ko:{score:"점수",time:"시간",level:"레벨",combo:"콤보",title:"스피드 레이싱",rules:"게임 규칙",close:"닫기",controlMethod:"조작 방법",useArrowKeysOrButtons:"화살표 키 ← → 또는 화면 버튼으로 레이싱카 조작",moveLeftRightToAvoid:"좌우로 이동하여 장애물 피하기",gameObjective:"게임 목표",avoidAllObstacles:"모든 장애물（돌、자동차、트럭）피하기",successfulAvoidance:"성공적으로 피하면 5점 + 콤보 보너스",collisionPenalty:"장애물과 충돌하면 10점 감점하고 콤보 리셋",scoringSystem:"점수 시스템",baseScore:"기본 점수：장애물 피하기 +5점",comboBonus:"콤보 보너스：각 콤보마다 +1점",levelUp:"레벨 업：100점마다 1레벨 상승",speedIncrease:"속도 증가：레벨이 높을수록 장애물이 빨리 움직임",gameTime:"게임 시간",sixtySecondsPerGame:"게임당 60초",autoScoreWhenTimeUp:"시간 종료 시 자동 점수"},vi:{score:"Điểm",time:"Thời Gian",level:"Cấp Độ",combo:"Combo",title:"Đua Xe Tốc Độ",rules:"Luật Chơi",close:"Đóng",controlMethod:"Phương Pháp Điều Khiển",useArrowKeysOrButtons:"Sử dụng phím mũi tên ← → hoặc nút màn hình để điều khiển xe đua",moveLeftRightToAvoid:"Di chuyển trái phải để tránh chướng ngại vật",gameObjective:"Mục Tiêu Trò Chơi",avoidAllObstacles:"Tránh tất cả chướng ngại vật (đá, xe hơi, xe tải)",successfulAvoidance:"Tránh thành công được 5 điểm + phần thưởng combo",collisionPenalty:"Va chạm với chướng ngại vật trừ 10 điểm và reset combo",scoringSystem:"Hệ Thống Điểm",baseScore:"Điểm cơ bản: tránh chướng ngại vật +5 điểm",comboBonus:"Phần thưởng combo: +1 điểm cho mỗi combo",levelUp:"Tăng cấp: tăng 1 cấp mỗi 100 điểm",speedIncrease:"Tăng tốc độ: cấp càng cao, chướng ngại vật di chuyển càng nhanh",gameTime:"Thời Gian Trò Chơi",sixtySecondsPerGame:"60 giây mỗi trò chơi",autoScoreWhenTimeUp:"Tự động tính điểm khi hết thời gian"},th:{score:"คะแนน",time:"เวลา",level:"ระดับ",combo:"คอมโบ",title:"แข่งรถความเร็ว",rules:"กฎเกม",close:"ปิด",controlMethod:"วิธีการควบคุม",useArrowKeysOrButtons:"ใช้ปุ่มลูกศร ← → หรือปุ่มหน้าจอควบคุมรถแข่ง",moveLeftRightToAvoid:"เคลื่อนที่ซ้ายขวาเพื่อหลบหลีกสิ่งกีดขวาง",gameObjective:"เป้าหมายเกม",avoidAllObstacles:"หลบหลีกสิ่งกีดขวางทั้งหมด（หิน、รถยนต์、รถบรรทุก）",successfulAvoidance:"หลบหลีกสำเร็จได้ 5 คะแนน + โบนัสคอมโบ",collisionPenalty:"ชนสิ่งกีดขวางหัก 10 คะแนนและรีเซ็ตคอมโบ",scoringSystem:"ระบบคะแนน",baseScore:"คะแนนพื้นฐาน：หลบหลีกสิ่งกีดขวาง +5 คะแนน",comboBonus:"โบนัสคอมโบ：+1 คะแนนสำหรับแต่ละคอมโบ",levelUp:"เลเวลอัพ：เพิ่ม 1 เลเวลทุก 100 คะแนน",speedIncrease:"เพิ่มความเร็ว：เลเวลสูงขึ้นสิ่งกีดขวางเคลื่อนที่เร็วขึ้น",gameTime:"เวลาเกม",sixtySecondsPerGame:"60 วินาทีต่อเกม",autoScoreWhenTimeUp:"คะแนนอัตโนมัติเมื่อหมดเวลา"},la:{score:"Puncta",time:"Tempus",level:"Gradus",combo:"Combo",title:"Cursus Velocitatis",rules:"Regulae Ludi",close:"Claudere",controlMethod:"Methodus Controllandi",useArrowKeysOrButtons:"Utere clavis sagittarum ← → vel pugnis scaenae ad currum regendum",moveLeftRightToAvoid:"Move sinistra dextraque ad impedimenta vitanda",gameObjective:"Finis Ludi",avoidAllObstacles:"Vita omnia impedimenta (lapides, currus, plaustra)",successfulAvoidance:"Vitando feliciter accipe 5 puncta + praemium combo",collisionPenalty:"Collidendo cum impedimentis minus 10 puncta et reset combo",scoringSystem:"Systema Punctandi",baseScore:"Puncta fundamentalia: vitando impedimenta +5 puncta",comboBonus:"Praemium combo: +1 punctum pro quaque combo",levelUp:"Gradus sursum: accipe unum gradum pro quaque 100 punctis",speedIncrease:"Auctio velocitatis: altior gradus, velocius impedimenta moventur",gameTime:"Tempus Ludi",sixtySecondsPerGame:"60 secundis pro quaque ludo",autoScoreWhenTimeUp:"Auto puncta quando tempus finitum est"},ms:{score:"Markah",time:"Masa",level:"Tahap",combo:"Combo",title:"Lumba Kereta Laju",rules:"Peraturan Permainan",close:"Tutup",controlMethod:"Kaedah Kawalan",useArrowKeysOrButtons:"Gunakan kekunci anak panah ← → atau butang skrin untuk mengawal kereta lumba",moveLeftRightToAvoid:"Gerakkan kiri kanan untuk mengelakkan halangan",gameObjective:"Objektif Permainan",avoidAllObstacles:"Elakkan semua halangan (batu, kereta, lori)",successfulAvoidance:"Berjaya elakkan dapat 5 markah + bonus combo",collisionPenalty:"Berlanggar dengan halangan tolak 10 markah dan reset combo",scoringSystem:"Sistem Markah",baseScore:"Markah asas: elakkan halangan +5 markah",comboBonus:"Bonus combo: +1 markah untuk setiap combo",levelUp:"Naik tahap: dapat 1 tahap setiap 100 markah",speedIncrease:"Tambah kelajuan: tahap lebih tinggi, halangan bergerak lebih pantas",gameTime:"Masa Permainan",sixtySecondsPerGame:"60 saat setiap permainan",autoScoreWhenTimeUp:"Markah automatik apabila masa habis"}};return((we=Se[e])==null?void 0:we[ee])||Se["zh-TW"][ee]||ee};v.useEffect(()=>{const ee=Ld("racing");ee&&a(ee.highScore||0)},[]),v.useEffect(()=>{o>0&&Md("racing",{highScore:o})},[o]);const ne=()=>{r(0),m(60),x(50),C([]),I(3),F(1),B(0),d(!0)},oe=()=>{d(!1),t>o&&a(t)},J=ee=>{c&&x(Se=>{const we=ee==="left"?Se-8:Se+8;return Math.max(10,Math.min(90,we))})},Q=()=>{if(!c)return;const ee=["rock","car","truck"],Se=ee[Math.floor(Math.random()*ee.length)],we=[15,50,85],Ne=we[Math.floor(Math.random()*we.length)]+(Math.random()-.5)*20;C(Ye=>[...Ye,{id:Date.now(),x:Ne,y:0,type:Se}])},D=(ee,Se)=>Math.abs(ee-Se)<20/2;v.useEffect(()=>{if(!c)return;const ee=setInterval(()=>{m(Se=>Se<=.1?(oe(),0):Se-.1),Math.random()<.9+T*.15&&Q(),C(Se=>{const we=Se.map(Ye=>({...Ye,y:Ye.y+_})).filter(Ye=>Ye.y<100);let Oe=!1;return we.filter(Ye=>{if(Ye.y>70&&Ye.y<85){if(D(g,Ye.x))return Oe||(B(0),r(it=>Math.max(0,it-10)),O(!0),A(!0),X({x:g,y:75}),j(!0),setTimeout(()=>{O(!1),A(!1),j(!1)},800),Oe=!0),!1;B(it=>it+1),r(it=>it+5+P),P>=5&&(te(!0),setTimeout(()=>te(!1),1e3))}return!0})}),t>T*100&&(F(Se=>Se+1),I(Se=>Math.min(8,Se+.5)))},100);return()=>clearInterval(ee)},[c,_,T,g,P]),v.useEffect(()=>{const ee=Se=>{c&&(Se.key==="ArrowLeft"||Se.key==="a"?J("left"):(Se.key==="ArrowRight"||Se.key==="d")&&J("right"))};return window.addEventListener("keydown",ee),()=>window.removeEventListener("keydown",ee)},[c]);const G=ee=>{const Se={rock:{background:"#8B4513",borderRadius:"50%"},car:{background:"#FF4444",borderRadius:"5px"},truck:{background:"#FF8800",borderRadius:"8px"}};return Se[ee]||Se.rock},ie=ee=>{if(!c)return;ee.preventDefault();const Se=ee.touches[0],we=window.innerWidth;Se.clientX<we/2?J("left"):J("right")};return i.jsxs("div",{style:{width:"100vw",height:"100vh",background:"linear-gradient(180deg, #87CEEB 0%, #98FB98 100%)",position:"relative",overflow:"auto",fontFamily:"Arial, sans-serif",touchAction:"pan-y"},onTouchStart:ie,children:[i.jsx("button",{onClick:n,style:{position:"absolute",top:"clamp(20px, 4vw, 40px)",left:"clamp(20px, 4vw, 40px)",background:"#fff",border:"2px solid #9C27B0",borderRadius:"50%",width:"clamp(40px, 8vw, 50px)",height:"clamp(40px, 8vw, 50px)",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",fontSize:"clamp(1.2rem, 3vw, 1.5rem)",zIndex:1e3,boxShadow:"0 2px 8px rgba(0,0,0,0.2)"},children:"←"}),i.jsxs("div",{style:{position:"absolute",top:"clamp(20px, 4vw, 40px)",left:"clamp(80px, 16vw, 100px)",background:"rgba(255,255,255,0.9)",padding:"clamp(8px, 1.5vw, 12px)",borderRadius:"10px",fontSize:"clamp(0.8rem, 2vw, 1rem)",zIndex:100},children:[i.jsxs("div",{children:[$("score"),": ",t]}),i.jsxs("div",{children:[$("time"),": ",h,"s"]}),i.jsxs("div",{children:[$("level"),": ",T]}),i.jsxs("div",{children:[$("combo"),": ",P]})]}),i.jsx("div",{style:{position:"absolute",bottom:"20%",left:"0",right:"0",height:"60%",background:"linear-gradient(90deg, #696969 0%, #A9A9A9 20%, #696969 40%, #A9A9A9 60%, #696969 80%, #A9A9A9 100%)",borderTop:"4px solid #FFD700",borderBottom:"4px solid #FFD700"}}),i.jsx("div",{style:{position:"absolute",bottom:"25%",left:`${g}%`,transform:"translateX(-50%)",width:"clamp(40px, 8vw, 60px)",height:"clamp(20px, 4vw, 30px)",background:N?"linear-gradient(45deg, #FF0000, #FF4444)":"linear-gradient(45deg, #FF4444, #FF6666)",borderRadius:"8px",border:N?"3px solid #FF0000":"2px solid #CC0000",zIndex:10,transition:"left 0.1s ease",animation:N?"collisionShake 0.5s ease-in-out":"none"},children:i.jsx("div",{style:{position:"absolute",top:"-8px",left:"50%",transform:"translateX(-50%)",width:"clamp(20px, 4vw, 30px)",height:"clamp(8px, 1.5vw, 12px)",background:"#444",borderRadius:"4px"}})}),S.map(ee=>i.jsx("div",{style:{position:"absolute",top:`${ee.y}%`,left:`${ee.x}%`,transform:"translateX(-50%)",width:"clamp(30px, 6vw, 45px)",height:"clamp(15px, 3vw, 22px)",...G(ee.type),zIndex:5}},ee.id)),q&&i.jsxs("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",fontSize:"clamp(2rem, 5vw, 3rem)",fontWeight:"bold",color:"#FFD700",textShadow:"0 0 20px #FFD700",animation:"comboEffect 1s ease-out forwards",pointerEvents:"none",zIndex:1e3},children:["COMBO x",P,"!"]}),R&&i.jsx("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",fontSize:"clamp(2rem, 5vw, 3rem)",fontWeight:"bold",color:"#FF0000",textShadow:"0 0 20px #FF0000",animation:"collisionEffect 0.5s ease-out forwards",pointerEvents:"none",zIndex:1e3},children:"BOOM!"}),z&&i.jsx("div",{style:{position:"absolute",left:`${V.x}%`,top:`${V.y}%`,transform:"translate(-50%, -50%)",width:"clamp(60px, 12vw, 80px)",height:"clamp(60px, 12vw, 80px)",animation:"explosionEffect 0.8s ease-out forwards",pointerEvents:"none",zIndex:999},children:i.jsx("div",{style:{width:"100%",height:"100%",background:"radial-gradient(circle, #FFD700 0%, #FF8800 30%, #FF4444 60%, #FF0000 100%)",borderRadius:"50%",boxShadow:"0 0 30px #FFD700, 0 0 60px #FF8800, 0 0 90px #FF4444"}})}),i.jsx("style",{children:`
          @keyframes collisionShake {
            0%, 100% { transform: translateX(-50%) translateY(0px); }
            25% { transform: translateX(-50%) translateY(-5px) translateX(-3px); }
            50% { transform: translateX(-50%) translateY(0px) translateX(3px); }
            75% { transform: translateX(-50%) translateY(-5px) translateX(-3px); }
          }
          @keyframes collisionEffect {
            0% { 
              transform: translate(-50%, -50%) scale(0.5);
              opacity: 0;
            }
            50% { 
              transform: translate(-50%, -50%) scale(1.2);
              opacity: 1;
            }
            100% { 
              transform: translate(-50%, -50%) scale(1);
              opacity: 0;
            }
          }
          @keyframes explosionEffect {
            0% { 
              transform: translate(-50%, -50%) scale(0.1);
              opacity: 1;
            }
            50% { 
              transform: translate(-50%, -50%) scale(1.5);
              opacity: 1;
            }
            100% { 
              transform: translate(-50%, -50%) scale(2);
              opacity: 0;
            }
          }
        `}),i.jsxs("div",{style:{position:"absolute",bottom:"clamp(10px, 2vw, 20px)",left:"50%",transform:"translateX(-50%)",display:"flex",gap:"clamp(10px, 2vw, 20px)",zIndex:100},children:[i.jsx("button",{onClick:()=>J("left"),style:{background:"#FF4444",color:"#fff",border:"none",borderRadius:"50%",width:"clamp(50px, 10vw, 70px)",height:"clamp(50px, 10vw, 70px)",fontSize:"clamp(1.5rem, 3vw, 2rem)",cursor:"pointer",fontWeight:"bold"},children:"←"}),i.jsx("button",{onClick:()=>J("right"),style:{background:"#FF4444",color:"#fff",border:"none",borderRadius:"50%",width:"clamp(50px, 10vw, 70px)",height:"clamp(50px, 10vw, 70px)",fontSize:"clamp(1.5rem, 3vw, 2rem)",cursor:"pointer",fontWeight:"bold"},children:"→"})]}),!c&&i.jsxs("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",background:"rgba(255,255,255,0.95)",borderRadius:"20px",padding:"clamp(20px, 4vw, 30px)",textAlign:"center",zIndex:1001},children:[i.jsx("h2",{style:{fontSize:"clamp(1.5rem, 3.5vw, 2rem)",margin:"0 0 15px 0",color:"#E91E63"},children:$("title")}),i.jsx("p",{style:{fontSize:"clamp(0.9rem, 2vw, 1rem)",marginBottom:"20px",color:"#666"},children:"使用方向鍵或按鈕控制賽車，避開障礙物！"}),i.jsxs("div",{style:{display:"flex",gap:"10px",justifyContent:"center"},children:[i.jsx("button",{onClick:ne,style:{background:"#E91E63",color:"#fff",border:"none",borderRadius:"15px",padding:"clamp(10px, 2vw, 15px) clamp(20px, 4vw, 30px)",fontSize:"clamp(1rem, 2.5vw, 1.2rem)",cursor:"pointer",fontWeight:"bold"},children:$("start")}),i.jsx("button",{onClick:()=>L(!0),style:{background:"#666",color:"#fff",border:"none",borderRadius:"15px",padding:"clamp(10px, 2vw, 15px) clamp(20px, 4vw, 30px)",fontSize:"clamp(1rem, 2.5vw, 1.2rem)",cursor:"pointer"},children:$("rules")})]})]}),W&&i.jsx("div",{style:{position:"absolute",top:"0",left:"0",right:"0",bottom:"0",background:"rgba(0,0,0,0.8)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1002},children:i.jsxs("div",{style:{background:"rgba(255,255,255,0.95)",borderRadius:"20px",padding:"clamp(20px, 4vw, 30px)",maxWidth:"clamp(300px, 80vw, 500px)",maxHeight:"clamp(400px, 80vh, 600px)",overflow:"auto"},children:[i.jsxs("h3",{style:{fontSize:"clamp(1.2rem, 3vw, 1.5rem)",margin:"0 0 15px 0",color:"#E91E63",textAlign:"center"},children:[$("title")," - ",$("rules")]}),i.jsxs("div",{style:{fontSize:"clamp(0.9rem, 2vw, 1rem)",lineHeight:"1.6"},children:[i.jsx("p",{children:i.jsxs("strong",{children:["🎮 ",$("controlMethod"),"："]})}),i.jsxs("ul",{children:[i.jsx("li",{children:$("useArrowKeysOrButtons")}),i.jsx("li",{children:$("moveLeftRightToAvoid")})]}),i.jsx("p",{children:i.jsxs("strong",{children:["🎯 ",$("gameObjective"),"："]})}),i.jsxs("ul",{children:[i.jsx("li",{children:$("avoidAllObstacles")}),i.jsx("li",{children:$("successfulAvoidance")}),i.jsx("li",{children:$("collisionPenalty")})]}),i.jsx("p",{children:i.jsxs("strong",{children:["🏆 ",$("scoringSystem"),"："]})}),i.jsxs("ul",{children:[i.jsx("li",{children:$("baseScore")}),i.jsx("li",{children:$("comboBonus")}),i.jsx("li",{children:$("levelUp")}),i.jsx("li",{children:$("speedIncrease")})]}),i.jsx("p",{children:i.jsxs("strong",{children:["⏰ ",$("gameTime"),"："]})}),i.jsxs("ul",{children:[i.jsx("li",{children:$("sixtySecondsPerGame")}),i.jsx("li",{children:$("autoScoreWhenTimeUp")})]})]}),i.jsx("button",{onClick:()=>L(!1),style:{background:"#E91E63",color:"#fff",border:"none",borderRadius:"15px",padding:"clamp(8px, 1.5vw, 12px) clamp(16px, 3vw, 24px)",fontSize:"clamp(0.9rem, 2vw, 1rem)",cursor:"pointer",marginTop:"20px",width:"100%"},children:$("close")})]})}),!c&&t>0&&i.jsxs("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",background:"rgba(255,255,255,0.95)",borderRadius:"20px",padding:"clamp(20px, 4vw, 30px)",textAlign:"center",zIndex:1001},children:[i.jsxs("h2",{style:{fontSize:"clamp(1.5rem, 3.5vw, 2rem)",margin:"0 0 15px 0",color:"#E91E63"},children:[$("gameOver"),"！"]}),i.jsxs("div",{style:{fontSize:"clamp(1rem, 2.5vw, 1.2rem)",marginBottom:"10px"},children:[$("finalScore"),"：",t]}),i.jsxs("div",{style:{fontSize:"clamp(0.9rem, 2vw, 1rem)",marginBottom:"20px",color:"#666"},children:[$("highScore"),"：",o]}),i.jsxs("div",{style:{display:"flex",gap:"10px",justifyContent:"center"},children:[i.jsx("button",{onClick:ne,style:{background:"#E91E63",color:"#fff",border:"none",borderRadius:"15px",padding:"clamp(8px, 1.5vw, 12px) clamp(16px, 3vw, 24px)",fontSize:"clamp(0.9rem, 2vw, 1rem)",cursor:"pointer"},children:$("restart")}),i.jsx("button",{onClick:n,style:{background:"#666",color:"#fff",border:"none",borderRadius:"15px",padding:"clamp(8px, 1.5vw, 12px) clamp(16px, 3vw, 24px)",fontSize:"clamp(0.9rem, 2vw, 1rem)",cursor:"pointer"},children:$("back")})]})]})]})}function V3({onClose:n}){const{lang:e}=Mt(),[t,r]=v.useState(0),[o,a]=v.useState(0),[c,d]=v.useState(!1),[h,m]=v.useState(60),[g,x]=v.useState([]),[S,C]=v.useState(0),[_,I]=v.useState(!1),[T,F]=v.useState(null),[P,B]=v.useState(!0),[q,te]=v.useState(!1),W=z=>{var V;const j={"zh-TW":{score:"分數",time:"時間",combo:"連擊",title:"音樂節奏",rules:"遊戲規則",close:"關閉",gameOver:"遊戲結束",gameplay:"遊戲玩法",clickMovingRhythmPoints:"點擊從上往下移動的節奏點",fourColorsCorrespondToDifferentAudio:"四種顏色的節奏點對應不同音頻",redBlueGreenYellowFrequencies:"紅色(440Hz)、藍色(523Hz)、綠色(659Hz)、黃色(784Hz)",accuracyScoring:"精準度計分",perfect100ms:"Perfect (100ms內)：+10分",good200ms:"Good (200ms內)：+5分",ok300ms:"OK (300ms內)：+2分",missOver300ms:"Miss (超過300ms)：0分",scoring:"計分",eachSuccessfulClickIncreasesCombo:"每次成功點擊增加連擊數",combo5TimesTriggersEffect:"連擊5次以上觸發特效",missingRhythmPointResetsCombo:"錯過節奏點重置連擊",soundControl:"音效控制",soundSwitchInTopRight:"右上角音效開關控制",clickRhythmPointPlaysAudio:"點擊節奏點會播放對應音頻",canTurnSoundOnOffAnytime:"可隨時開啟/關閉音效",gameTime:"遊戲時間",sixtySecondsPerGame:"每局遊戲60秒",autoScoreWhenTimeUp:"時間結束自動結算分數",clickRhythmPointsFollowMusic:"點擊節奏點，跟隨音樂節奏！"},"zh-CN":{score:"分数",time:"时间",combo:"连击",title:"音乐节奏",rules:"游戏规则",close:"关闭",gameplay:"游戏玩法",clickMovingRhythmPoints:"点击从上往下移动的节奏点",fourColorsCorrespondToDifferentAudio:"四种颜色的节奏点对应不同音频",redBlueGreenYellowFrequencies:"红色(440Hz)、蓝色(523Hz)、绿色(659Hz)、黄色(784Hz)",accuracyScoring:"精准度计分",perfect100ms:"Perfect (100ms内)：+10分",good200ms:"Good (200ms内)：+5分",ok300ms:"OK (300ms内)：+2分",missOver300ms:"Miss (超过300ms)：0分",scoring:"计分",eachSuccessfulClickIncreasesCombo:"每次成功点击增加连击数",combo5TimesTriggersEffect:"连击5次以上触发特效",missingRhythmPointResetsCombo:"错过节奏点重置连击",soundControl:"音效控制",soundSwitchInTopRight:"右上角音效开关控制",clickRhythmPointPlaysAudio:"点击节奏点会播放对应音频",canTurnSoundOnOffAnytime:"可随时开启/关闭音效",gameTime:"游戏时间",sixtySecondsPerGame:"每局游戏60秒",autoScoreWhenTimeUp:"时间结束自动结算分数",clickRhythmPointsFollowMusic:"点击节奏点，跟随音乐节奏！"},en:{score:"Score",time:"Time",combo:"Combo",title:"Music Rhythm",rules:"Game Rules",close:"Close",gameplay:"Gameplay",clickMovingRhythmPoints:"Click rhythm points moving from top to bottom",fourColorsCorrespondToDifferentAudio:"Four colors of rhythm points correspond to different audio",redBlueGreenYellowFrequencies:"Red (440Hz), Blue (523Hz), Green (659Hz), Yellow (784Hz)",accuracyScoring:"Accuracy Scoring",perfect100ms:"Perfect (within 100ms): +10 points",good200ms:"Good (within 200ms): +5 points",ok300ms:"OK (within 300ms): +2 points",missOver300ms:"Miss (over 300ms): 0 points",scoring:"Scoring",eachSuccessfulClickIncreasesCombo:"Each successful click increases combo count",combo5TimesTriggersEffect:"Combo 5 times or more triggers special effects",missingRhythmPointResetsCombo:"Missing rhythm point resets combo",soundControl:"Sound Control",soundSwitchInTopRight:"Sound switch control in top right corner",clickRhythmPointPlaysAudio:"Clicking rhythm points plays corresponding audio",canTurnSoundOnOffAnytime:"Can turn sound on/off anytime",gameTime:"Game Time",sixtySecondsPerGame:"60 seconds per game",autoScoreWhenTimeUp:"Auto score when time is up",clickRhythmPointsFollowMusic:"Click rhythm points, follow the music rhythm!"},ja:{score:"スコア",time:"時間",combo:"コンボ",title:"音楽リズム",rules:"ゲームルール",close:"閉じる",gameplay:"ゲームプレイ",clickMovingRhythmPoints:"上から下に移動するリズムポイントをクリック",fourColorsCorrespondToDifferentAudio:"4色のリズムポイントが異なる音声に対応",redBlueGreenYellowFrequencies:"赤(440Hz)、青(523Hz)、緑(659Hz)、黄(784Hz)",accuracyScoring:"精度スコアリング",perfect100ms:"Perfect (100ms以内)：+10ポイント",good200ms:"Good (200ms以内)：+5ポイント",ok300ms:"OK (300ms以内)：+2ポイント",missOver300ms:"Miss (300ms超過)：0ポイント",scoring:"スコアリング",eachSuccessfulClickIncreasesCombo:"各成功クリックでコンボ数増加",combo5TimesTriggersEffect:"コンボ5回以上でエフェクト発動",missingRhythmPointResetsCombo:"リズムポイントを逃すとコンボリセット",soundControl:"サウンドコントロール",soundSwitchInTopRight:"右上のサウンドスイッチ制御",clickRhythmPointPlaysAudio:"リズムポイントクリックで対応音声再生",canTurnSoundOnOffAnytime:"いつでもサウンドオン/オフ可能",gameTime:"ゲーム時間",sixtySecondsPerGame:"ゲームあたり60秒",autoScoreWhenTimeUp:"時間切れで自動スコア",clickRhythmPointsFollowMusic:"リズムポイントをクリックして、音楽のリズムに従ってください！"},ko:{score:"점수",time:"시간",combo:"콤보",title:"음악 리듬",rules:"게임 규칙",close:"닫기",gameplay:"게임 플레이",clickMovingRhythmPoints:"위에서 아래로 이동하는 리듬 포인트 클릭",fourColorsCorrespondToDifferentAudio:"4가지 색상의 리듬 포인트가 다른 오디오에 대응",redBlueGreenYellowFrequencies:"빨강(440Hz)、파랑(523Hz)、초록(659Hz)、노랑(784Hz)",accuracyScoring:"정확도 점수",perfect100ms:"Perfect (100ms 이내)：+10점",good200ms:"Good (200ms 이내)：+5점",ok300ms:"OK (300ms 이내)：+2점",missOver300ms:"Miss (300ms 초과)：0점",scoring:"점수",eachSuccessfulClickIncreasesCombo:"각 성공 클릭마다 콤보 수 증가",combo5TimesTriggersEffect:"콤보 5회 이상 시 특수 효과 발동",missingRhythmPointResetsCombo:"리듬 포인트 놓치면 콤보 리셋",soundControl:"사운드 제어",soundSwitchInTopRight:"우상단 사운드 스위치 제어",clickRhythmPointPlaysAudio:"리듬 포인트 클릭 시 해당 오디오 재생",canTurnSoundOnOffAnytime:"언제든지 사운드 켜기/끄기 가능",gameTime:"게임 시간",sixtySecondsPerGame:"게임당 60초",autoScoreWhenTimeUp:"시간 종료 시 자동 점수",clickRhythmPointsFollowMusic:"리듬 포인트를 클릭하고 음악 리듬을 따라가세요!"},vi:{score:"Điểm",time:"Thời Gian",combo:"Combo",title:"Nhịp Điệu Âm Nhạc",rules:"Luật Chơi",close:"Đóng",gameplay:"Cách Chơi",clickMovingRhythmPoints:"Nhấp vào các điểm nhịp điệu di chuyển từ trên xuống dưới",fourColorsCorrespondToDifferentAudio:"Bốn màu của điểm nhịp điệu tương ứng với âm thanh khác nhau",redBlueGreenYellowFrequencies:"Đỏ (440Hz), Xanh dương (523Hz), Xanh lá (659Hz), Vàng (784Hz)",accuracyScoring:"Điểm Độ Chính Xác",perfect100ms:"Perfect (trong 100ms): +10 điểm",good200ms:"Good (trong 200ms): +5 điểm",ok300ms:"OK (trong 300ms): +2 điểm",missOver300ms:"Miss (trên 300ms): 0 điểm",scoring:"Điểm Số",eachSuccessfulClickIncreasesCombo:"Mỗi lần nhấp thành công tăng số combo",combo5TimesTriggersEffect:"Combo 5 lần trở lên kích hoạt hiệu ứng đặc biệt",missingRhythmPointResetsCombo:"Bỏ lỡ điểm nhịp điệu reset combo",soundControl:"Điều Khiển Âm Thanh",soundSwitchInTopRight:"Công tắc âm thanh ở góc trên bên phải",clickRhythmPointPlaysAudio:"Nhấp điểm nhịp điệu phát âm thanh tương ứng",canTurnSoundOnOffAnytime:"Có thể bật/tắt âm thanh bất cứ lúc nào",gameTime:"Thời Gian Trò Chơi",sixtySecondsPerGame:"60 giây mỗi trò chơi",autoScoreWhenTimeUp:"Tự động tính điểm khi hết thời gian",clickRhythmPointsFollowMusic:"Nhấp vào điểm nhịp điệu, theo nhịp điệu âm nhạc!"},th:{score:"คะแนน",time:"เวลา",combo:"คอมโบ",title:"จังหวะดนตรี",rules:"กฎเกม",close:"ปิด",gameplay:"วิธีเล่น",clickMovingRhythmPoints:"คลิกจุดจังหวะที่เคลื่อนที่จากบนลงล่าง",fourColorsCorrespondToDifferentAudio:"สี่สีของจุดจังหวะสอดคล้องกับเสียงที่แตกต่างกัน",redBlueGreenYellowFrequencies:"แดง (440Hz)、น้ำเงิน (523Hz)、เขียว (659Hz)、เหลือง (784Hz)",accuracyScoring:"คะแนนความแม่นยำ",perfect100ms:"Perfect (ภายใน 100ms)：+10 คะแนน",good200ms:"Good (ภายใน 200ms)：+5 คะแนน",ok300ms:"OK (ภายใน 300ms)：+2 คะแนน",missOver300ms:"Miss (เกิน 300ms)：0 คะแนน",scoring:"คะแนน",eachSuccessfulClickIncreasesCombo:"แต่ละการคลิกที่สำเร็จเพิ่มจำนวนคอมโบ",combo5TimesTriggersEffect:"คอมโบ 5 ครั้งขึ้นไปกระตุ้นเอฟเฟกต์พิเศษ",missingRhythmPointResetsCombo:"พลาดจุดจังหวะรีเซ็ตคอมโบ",soundControl:"ควบคุมเสียง",soundSwitchInTopRight:"สวิตช์เสียงควบคุมที่มุมขวาบน",clickRhythmPointPlaysAudio:"คลิกจุดจังหวะเล่นเสียงที่สอดคล้องกัน",canTurnSoundOnOffAnytime:"สามารถเปิด/ปิดเสียงได้ทุกเมื่อ",gameTime:"เวลาเกม",sixtySecondsPerGame:"60 วินาทีต่อเกม",autoScoreWhenTimeUp:"คะแนนอัตโนมัติเมื่อหมดเวลา",clickRhythmPointsFollowMusic:"คลิกจุดจังหวะและตามจังหวะดนตรี!"},la:{score:"Puncta",time:"Tempus",combo:"Combo",title:"Rhythmus Musicae",rules:"Regulae Ludi",close:"Claudere",gameplay:"Ludus",clickMovingRhythmPoints:"Clicca puncta rhythmi moventia de superiore ad inferiorem",fourColorsCorrespondToDifferentAudio:"Quattuor colores punctorum rhythmi correspondent diversis auditis",redBlueGreenYellowFrequencies:"Rubrum (440Hz), Caeruleum (523Hz), Viride (659Hz), Flavum (784Hz)",accuracyScoring:"Punctatio Accurationis",perfect100ms:"Perfect (intra 100ms): +10 puncta",good200ms:"Good (intra 200ms): +5 puncta",ok300ms:"OK (intra 300ms): +2 puncta",missOver300ms:"Miss (super 300ms): 0 puncta",scoring:"Punctatio",eachSuccessfulClickIncreasesCombo:"Quaelibet felix cliccatio auget numerum combo",combo5TimesTriggersEffect:"Combo 5 vicibus vel plus activat effectus speciales",missingRhythmPointResetsCombo:"Amittendo punctum rhythmi reset combo",soundControl:"Controllatio Sonorum",soundSwitchInTopRight:"Sonorum commutator in angulo superiore dextro",clickRhythmPointPlaysAudio:"Cliccando puncta rhythmi ludit auditum correspondentem",canTurnSoundOnOffAnytime:"Potest sonos aperire/claudere quandocumque",gameTime:"Tempus Ludi",sixtySecondsPerGame:"60 secundis pro quaque ludo",autoScoreWhenTimeUp:"Auto puncta quando tempus finitum est",clickRhythmPointsFollowMusic:"Puncta rhythmi preme et musicam sequere!"},ms:{score:"Markah",time:"Masa",combo:"Combo",title:"Irama Muzik",rules:"Peraturan Permainan",close:"Tutup",gameplay:"Cara Bermain",clickMovingRhythmPoints:"Klik titik irama yang bergerak dari atas ke bawah",fourColorsCorrespondToDifferentAudio:"Empat warna titik irama sepadan dengan audio berbeza",redBlueGreenYellowFrequencies:"Merah (440Hz), Biru (523Hz), Hijau (659Hz), Kuning (784Hz)",accuracyScoring:"Penilaian Ketepatan",perfect100ms:"Perfect (dalam 100ms): +10 markah",good200ms:"Good (dalam 200ms): +5 markah",ok300ms:"OK (dalam 300ms): +2 markah",missOver300ms:"Miss (melebihi 300ms): 0 markah",scoring:"Penilaian",eachSuccessfulClickIncreasesCombo:"Setiap klik berjaya menambah bilangan combo",combo5TimesTriggersEffect:"Combo 5 kali atau lebih mencetuskan kesan khas",missingRhythmPointResetsCombo:"Terlepas titik irama reset combo",soundControl:"Kawalan Bunyi",soundSwitchInTopRight:"Suis bunyi kawalan di sudut kanan atas",clickRhythmPointPlaysAudio:"Klik titik irama memainkan audio sepadan",canTurnSoundOnOffAnytime:"Boleh hidupkan/matikan bunyi bila-bila masa",gameTime:"Masa Permainan",sixtySecondsPerGame:"60 saat setiap permainan",autoScoreWhenTimeUp:"Markah automatik apabila masa habis",clickRhythmPointsFollowMusic:"Klik titik irama, ikut rentak muzik!"}};return((V=j[e])==null?void 0:V[z])||j["zh-TW"][z]||z};v.useEffect(()=>{const z=Ld("rhythm");z&&a(z.highScore||0)},[]),v.useEffect(()=>{o>0&&Md("rhythm",{highScore:o})},[o]),v.useEffect(()=>{typeof window<"u"&&window.AudioContext&&F(new AudioContext)},[]);const L=()=>{r(0),m(60),x([]),C(0),d(!0)},R=()=>{d(!1),t>o&&a(t)},A=()=>{if(!c)return;const z=["red","blue","green","yellow"],j=z[Math.floor(Math.random()*z.length)],V=Math.random()*80+10;x(X=>[...X,{id:Date.now(),x:V,y:-10,type:j,timing:Date.now()}])},N=z=>{const j=g.find($=>$.id===z);if(!j)return;const V=Date.now()-j.timing;let X=0;if(V<100?X=10:V<200?X=5:V<300?X=2:X=0,r($=>$+X),C($=>$+1),S>=5&&(I(!0),setTimeout(()=>I(!1),1e3)),T&&P){const $=T.createOscillator(),ne=T.createGain();$.connect(ne),ne.connect(T.destination);const oe={red:440,blue:523,green:659,yellow:784};$.frequency.setValueAtTime(oe[j.type],T.currentTime),$.type="sine",ne.gain.setValueAtTime(.3,T.currentTime),ne.gain.exponentialRampToValueAtTime(.01,T.currentTime+.1),$.start(T.currentTime),$.stop(T.currentTime+.1)}x($=>$.filter(ne=>ne.id!==z))};v.useEffect(()=>{if(!c)return;const z=setInterval(()=>{m(j=>j<=1?(R(),0):j-1),Math.random()<.03&&A(),x(j=>{const V=j.map(X=>({...X,y:X.y+2})).filter(X=>X.y<110);return V.forEach(X=>{X.y>90&&(C(0),x($=>$.filter(ne=>ne.id!==X.id)))}),V})},50);return()=>clearInterval(z)},[c]);const O=z=>({red:"#FF4444",blue:"#4444FF",green:"#44FF44",yellow:"#FFFF44"})[z]||"#FF4444";return i.jsxs("div",{style:{width:"100vw",height:"100vh",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",position:"relative",overflow:"hidden",fontFamily:"Arial, sans-serif"},children:[i.jsxs("div",{style:{position:"absolute",top:"clamp(20px, 4vw, 40px)",left:"clamp(80px, 16vw, 100px)",background:"rgba(255,255,255,0.9)",padding:"clamp(8px, 1.5vw, 12px)",borderRadius:"10px",fontSize:"clamp(0.8rem, 2vw, 1rem)",zIndex:100},children:[i.jsxs("div",{children:[W("score"),": ",t]}),i.jsxs("div",{children:[W("time"),": ",h,"s"]}),i.jsxs("div",{children:[W("combo"),": ",S]})]}),i.jsx("button",{onClick:()=>B(!P),style:{position:"absolute",top:"clamp(10px, 2vw, 20px)",right:"clamp(10px, 2vw, 20px)",background:P?"#4CAF50":"#f44336",color:"#fff",border:"none",borderRadius:"25px",padding:"clamp(8px, 1.5vw, 12px) clamp(16px, 3vw, 24px)",fontSize:"clamp(0.8rem, 2vw, 1rem)",cursor:"pointer",zIndex:100},children:P?"🔊":"🔇"}),i.jsx("div",{style:{position:"absolute",bottom:"20%",left:"10%",right:"10%",height:"60%",background:"rgba(0,0,0,0.3)",borderRadius:"20px",border:"2px solid rgba(255,255,255,0.3)"}}),g.map(z=>i.jsx("div",{onClick:()=>N(z.id),style:{position:"absolute",bottom:`${z.y}%`,left:`${z.x}%`,transform:"translateX(-50%)",width:"clamp(40px, 8vw, 60px)",height:"clamp(40px, 8vw, 60px)",background:O(z.type),borderRadius:"50%",cursor:"pointer",zIndex:10,boxShadow:`0 0 20px ${O(z.type)}`,animation:"pulse 0.5s ease-in-out infinite alternate"}},z.id)),_&&i.jsxs("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",fontSize:"clamp(2rem, 5vw, 3rem)",fontWeight:"bold",color:"#00BCD4",textShadow:"0 0 20px #00BCD4",animation:"comboEffect 1s ease-out forwards",pointerEvents:"none",zIndex:1e3},children:["COMBO x",S,"!"]}),!c&&i.jsxs("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",background:"rgba(255,255,255,0.95)",borderRadius:"20px",padding:"clamp(20px, 4vw, 30px)",textAlign:"center",zIndex:1001},children:[i.jsx("h2",{style:{fontSize:"clamp(1.5rem, 3.5vw, 2rem)",margin:"0 0 15px 0",color:"#00BCD4"},children:W("title")}),i.jsx("p",{style:{fontSize:"clamp(0.9rem, 2vw, 1rem)",marginBottom:"20px",color:"#666"},children:W("clickRhythmPointsFollowMusic")}),i.jsxs("div",{style:{display:"flex",gap:"10px",justifyContent:"center"},children:[i.jsx("button",{onClick:L,style:{background:"#00BCD4",color:"#fff",border:"none",borderRadius:"15px",padding:"clamp(10px, 2vw, 15px) clamp(20px, 4vw, 30px)",fontSize:"clamp(1rem, 2.5vw, 1.2rem)",cursor:"pointer",fontWeight:"bold"},children:W("start")}),i.jsx("button",{onClick:()=>te(!0),style:{background:"#666",color:"#fff",border:"none",borderRadius:"15px",padding:"clamp(10px, 2vw, 15px) clamp(20px, 4vw, 30px)",fontSize:"clamp(1rem, 2.5vw, 1.2rem)",cursor:"pointer"},children:W("rules")})]})]}),q&&i.jsx("div",{style:{position:"absolute",top:"0",left:"0",right:"0",bottom:"0",background:"rgba(0,0,0,0.8)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1002},children:i.jsxs("div",{style:{background:"rgba(255,255,255,0.95)",borderRadius:"20px",padding:"clamp(20px, 4vw, 30px)",maxWidth:"clamp(300px, 80vw, 500px)",maxHeight:"clamp(400px, 80vh, 600px)",overflow:"auto"},children:[i.jsxs("h3",{style:{fontSize:"clamp(1.2rem, 3vw, 1.5rem)",margin:"0 0 15px 0",color:"#00BCD4",textAlign:"center"},children:[W("rhythmGame")," - ",W("rules")]}),i.jsxs("div",{style:{fontSize:"clamp(0.9rem, 2vw, 1rem)",lineHeight:"1.6"},children:[i.jsx("p",{children:i.jsxs("strong",{children:["🎵 ",W("gameplay"),"："]})}),i.jsxs("ul",{children:[i.jsx("li",{children:W("clickMovingRhythmPoints")}),i.jsx("li",{children:W("fourColorsCorrespondToDifferentAudio")}),i.jsx("li",{children:W("redBlueGreenYellowFrequencies")})]}),i.jsx("p",{children:i.jsxs("strong",{children:["🎯 ",W("accuracyScoring"),"："]})}),i.jsxs("ul",{children:[i.jsx("li",{children:W("perfect100ms")}),i.jsx("li",{children:W("good200ms")}),i.jsx("li",{children:W("ok300ms")}),i.jsx("li",{children:W("missOver300ms")})]}),i.jsx("p",{children:i.jsxs("strong",{children:["🏆 ",W("scoring"),"："]})}),i.jsxs("ul",{children:[i.jsx("li",{children:W("eachSuccessfulClickIncreasesCombo")}),i.jsx("li",{children:W("combo5TimesTriggersEffect")}),i.jsx("li",{children:W("missingRhythmPointResetsCombo")})]}),i.jsx("p",{children:i.jsxs("strong",{children:["🔊 ",W("soundControl"),"："]})}),i.jsxs("ul",{children:[i.jsx("li",{children:W("soundSwitchInTopRight")}),i.jsx("li",{children:W("clickRhythmPointPlaysAudio")}),i.jsx("li",{children:W("canTurnSoundOnOffAnytime")})]}),i.jsx("p",{children:i.jsxs("strong",{children:["⏰ ",W("gameTime"),"："]})}),i.jsxs("ul",{children:[i.jsx("li",{children:W("sixtySecondsPerGame")}),i.jsx("li",{children:W("autoScoreWhenTimeUp")})]})]}),i.jsx("button",{onClick:()=>te(!1),style:{background:"#00BCD4",color:"#fff",border:"none",borderRadius:"15px",padding:"clamp(8px, 1.5vw, 12px) clamp(16px, 3vw, 24px)",fontSize:"clamp(0.9rem, 2vw, 1rem)",cursor:"pointer",marginTop:"20px",width:"100%"},children:W("close")})]})}),!c&&t>0&&i.jsxs("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",background:"rgba(255,255,255,0.95)",borderRadius:"20px",padding:"clamp(20px, 4vw, 30px)",textAlign:"center",zIndex:1001},children:[i.jsxs("h2",{style:{fontSize:"clamp(1.5rem, 3.5vw, 2rem)",margin:"0 0 15px 0",color:"#00BCD4"},children:[W("gameOver"),"！"]}),i.jsxs("div",{style:{fontSize:"clamp(1rem, 2.5vw, 1.2rem)",marginBottom:"10px"},children:[W("finalScore"),"：",t]}),i.jsxs("div",{style:{fontSize:"clamp(0.9rem, 2vw, 1rem)",marginBottom:"20px",color:"#666"},children:[W("highScore"),"：",o]}),i.jsxs("div",{style:{display:"flex",gap:"10px",justifyContent:"center"},children:[i.jsx("button",{onClick:L,style:{background:"#00BCD4",color:"#fff",border:"none",borderRadius:"15px",padding:"clamp(8px, 1.5vw, 12px) clamp(16px, 3vw, 24px)",fontSize:"clamp(0.9rem, 2vw, 1rem)",cursor:"pointer"},children:W("restart")}),i.jsx("button",{onClick:n,style:{background:"#666",color:"#fff",border:"none",borderRadius:"15px",padding:"clamp(8px, 1.5vw, 12px) clamp(16px, 3vw, 24px)",fontSize:"clamp(0.9rem, 2vw, 1rem)",cursor:"pointer"},children:W("back")})]})]}),i.jsx("style",{children:`
        @keyframes pulse {
          0% { transform: translateX(-50%) scale(1); }
          100% { transform: translateX(-50%) scale(1.1); }
        }
        @keyframes comboEffect {
          0% { opacity: 0; transform: translate(-50%, -50%) scale(0.5); }
          50% { opacity: 1; transform: translate(-50%, -50%) scale(1.2); }
          100% { opacity: 0; transform: translate(-50%, -50%) scale(1); }
        }
      `})]})}const ak={"zh-TW":{title:"社會融入度評估",subtitle:"評估您的社會融入度，獲得專業建議",subtitle2:"勇敢面對並定期檢測自身社會融入程度進步狀況，每一次評估都是成長的機會",backToHome:"返回",startAssessment:"開始評估",submitAssessment:"提交評估",cancelAssessment:"取消",closeAssessment:"關閉",assessmentComplete:"評估完成",viewReport:"查看報告",closeReport:"關閉報告",q1Title:"人際關係",q1Desc:"最近3個月，您與他人的互動和社交能力如何？包括與同事、朋友、鄰居的日常交流，以及在新環境中建立關係的能力。您是否能夠主動與他人溝通，建立信任關係，並在社交場合中感到自在？",q2Title:"就業狀況",q2Desc:"最近1年，您的工作穩定性和發展前景如何？包括工作滿意度、薪資待遇、職業發展機會、工作環境適應性，以及對未來職業規劃的清晰度。您是否對當前工作感到滿意，並有明確的職業發展目標？",q3Title:"家庭關係",q3Desc:"最近6個月，您與家人的相處和溝通狀況如何？包括與配偶、子女、父母或其他家庭成員的關係質量，溝通頻率和效果，以及家庭氛圍的和諧程度。您是否能夠有效處理家庭衝突，並為家庭成員提供情感支持？",q4Title:"未來信心",q4Desc:"您對未來1年的樂觀程度和規劃如何？包括對個人發展的信心，對生活目標的清晰度，以及面對挑戰時的積極態度。您是否對未來有明確的規劃，並相信自己能夠實現目標？",q5Title:"社會接納",q5Desc:"最近6個月，您感覺被社會接受和認可的程度如何？包括在社區中的融入度，社會地位的認同感，以及對社會規範的適應能力。您是否感到被社會接納，並對自己的社會角色感到滿意？",q6Title:"情緒管理",q6Desc:"最近3個月，您處理壓力和負面情緒的能力如何？包括面對挫折時的情緒反應，壓力調節方法，以及心理健康維護的意識。您是否能夠有效管理負面情緒，並在壓力下保持冷靜？",q7Title:"生活規律",q7Desc:"最近6個月，您的生活作息和規律性如何？包括日常作息時間，飲食習慣，運動頻率，以及生活節奏的穩定性。您是否能夠維持健康的生活習慣，並建立規律的日常生活？",q8Title:"學習成長",q8Desc:"最近1年，您在技能學習和個人成長方面的投入如何？包括新技能學習，知識更新，自我提升的積極性，以及對個人發展的投資。您是否持續學習新知識，並主動尋求個人成長機會？",q9Title:"財務管理",q9Desc:"最近1年，您的財務規劃和理財能力如何？包括收入支出管理，儲蓄習慣，投資理財意識，以及對未來財務安全的規劃。您是否能夠有效管理個人財務，並為未來做好財務準備？",q10Title:"健康狀況",q10Desc:"最近6個月，您的身體和心理健康狀況如何？包括身體健康狀況，心理健康狀態，醫療保健意識，以及對健康問題的預防和處理能力。您是否重視健康管理，並採取積極的健康維護措施？",q11Title:"社交網絡",q11Desc:"最近3個月，您建立和維護社交關係的能力如何？包括朋友數量，社交活動參與度，人際關係質量，以及社交網絡的廣度和深度。您是否擁有穩定的社交圈，並能夠與他人建立有意義的關係？",q12Title:"目標設定",q12Desc:"最近1年，您設定和追求個人目標的能力如何？包括目標的明確性，計劃的可行性，執行力，以及對目標達成度的評估。您是否能夠設定清晰的目標，並有效執行計劃？",q13Title:"適應能力",q13Desc:"最近6個月，您適應環境變化和挑戰的能力如何？包括面對新環境的適應速度，應對變化的靈活性，以及從挫折中恢復的能力。您是否能夠快速適應新環境，並在變化中保持穩定？",q14Title:"責任感",q14Desc:"最近1年，您對自己和他人負責的態度如何？包括對個人行為的責任感，對他人承諾的履行，以及對社會責任的認知。您是否能夠承擔個人責任，並對他人和社會負責？",q15Title:"自我認同",q15Desc:"最近6個月，您對自我價值和身份的認同感如何？包括對個人價值的認知，自我接納程度，以及對個人身份的滿意度。您是否對自己有清晰的認知，並能夠接納自己的優缺點？",q16Title:"社區參與",q16Desc:"最近1年，您參與社區活動和公益服務的情況如何？包括志願服務參與度，社區活動貢獻，以及對社會公益的關注和參與。您是否積極參與社區活動，並為社會做出貢獻？",q17Title:"職業發展",q17Desc:"最近1年，您在職業技能提升和職涯規劃方面的表現如何？包括專業技能發展，職業規劃清晰度，以及對職業發展機會的把握。您是否持續提升職業技能，並有明確的職業發展路徑？",q18Title:"人際衝突處理",q18Desc:"最近3個月，您處理人際衝突和分歧的能力如何？包括衝突解決技巧，溝通協調能力，以及維護關係的智慧。您是否能夠有效處理人際衝突，並在分歧中尋求共識？",q19Title:"時間管理",q19Desc:"最近1年，您合理安排時間和優先級的能力如何？包括時間規劃效率，任務優先級設定，以及工作生活平衡的維持。您是否能夠有效管理時間，並在多重任務中保持效率？",q20Title:"整體滿意度",q20Desc:"最近6個月，您對整體生活狀況的滿意度如何？包括對生活質量的整體評價，對個人成就的滿意度，以及對未來生活前景的樂觀程度。您是否對當前的生活狀況感到滿意，並對未來充滿希望？",excellent:"非常好",good:"良好",fair:"一般",poor:"需要改善",terrible:"非常糟糕",scoreLabel:"評估分數",resultLabel:"評估結果",descriptionLabel:"詳細分析",recommendationsLabel:"改善建議",analysisLabel:"專業分析",privacyPolicy:"隱私權政策",terms:"條款/聲明",dataDeletion:"資料刪除說明",about:"🧬 Restarter™｜我們是誰",feedback:"💬 意見箱｜我們想聽你說"},"zh-CN":{title:"社会融入度评估",subtitle:"评估您的社会融入度，获得专业建议",subtitle2:"勇敢面对并定期检测自身社会融入程度进步状况，每一次评估都是成长的机会",backToHome:"返回",startAssessment:"开始评估",submitAssessment:"提交评估",cancelAssessment:"取消",closeAssessment:"关闭",assessmentComplete:"评估完成",viewReport:"查看报告",closeReport:"关闭报告",q1Title:"人际关系",q1Desc:"最近3个月，您与他人的互动和社交能力如何？包括与同事、朋友、邻居的日常交流，以及在新环境中建立关系的能力。您是否能够主动与他人沟通，建立信任关系，并在社交场合中感到自在？",q2Title:"就业状况",q2Desc:"最近1年，您的工作稳定性和发展前景如何？包括工作满意度、薪资待遇、职业发展机会、工作环境适应性，以及对未来职业规划的清晰度。您是否对当前工作感到满意，并有明确的职业发展目标？",q3Title:"家庭关系",q3Desc:"最近6个月，您与家人的相处和沟通状况如何？包括与配偶、子女、父母或其他家庭成员的关系质量，沟通频率和效果，以及家庭氛围的和谐程度。您是否能够有效处理家庭冲突，并为家庭成员提供情感支持？",q4Title:"未来信心",q4Desc:"您对未来1年的乐观程度和规划如何？包括对个人发展的信心，对生活目标的清晰度，以及面对挑战时的积极态度。您是否对未来有明确的规划，并相信自己能够实现目标？",q5Title:"社会接纳",q5Desc:"最近6个月，您感觉被社会接受和认可的程度如何？包括在社区中的融入度，社会地位的认同感，以及对社会规范的适应能力。您是否感到被社会接纳，并对自己的社会角色感到满意？",q6Title:"情绪管理",q6Desc:"最近3个月，您处理压力和负面情绪的能力如何？包括面对挫折时的情绪反应，压力调节方法，以及心理健康维护的意识。您是否能够有效管理负面情绪，并在压力下保持冷静？",q7Title:"生活规律",q7Desc:"最近6个月，您的生活作息和规律性如何？包括日常作息时间，饮食习惯，运动频率，以及生活节奏的稳定性。您是否能够维持健康的生活习惯，并建立规律的日常生活？",q8Title:"学习成长",q8Desc:"最近1年，您在技能学习和个人成长方面的投入如何？包括新技能学习，知识更新，自我提升的积极性，以及对个人发展的投资。您是否持续学习新知识，并主动寻求个人成长机会？",q9Title:"财务管理",q9Desc:"最近1年，您的财务规划和理财能力如何？包括收入支出管理，储蓄习惯，投资理财意识，以及对未来财务安全的规划。您是否能够有效管理个人财务，并为未来做好财务准备？",q10Title:"健康状况",q10Desc:"最近6个月，您的身体和心理健康状况如何？包括身体健康状况，心理健康状态，医疗保健意识，以及对健康问题的预防和处理能力。您是否重视健康管理，并采取积极的健康维护措施？",q11Title:"社交网络",q11Desc:"最近3个月，您建立和维护社交关系的能力如何？包括朋友数量，社交活动参与度，人际关系质量，以及社交网络的广度和深度。您是否拥有稳定的社交圈，并能够与他人建立有意义的关系？",q12Title:"目标设定",q12Desc:"最近1年，您设定和追求个人目标的能力如何？包括目标的明确性，计划的可行性，执行力，以及对目标达成度的评估。您是否能够设定清晰的目标，并有效执行计划？",q13Title:"适应能力",q13Desc:"最近6个月，您适应环境变化和挑战的能力如何？包括面对新环境的适应速度，应对变化的灵活性，以及从挫折中恢复的能力。您是否能够快速适应新环境，并在变化中保持稳定？",q14Title:"责任感",q14Desc:"最近1年，您对自己和他人负责的态度如何？包括对个人行为的责任感，对他人承诺的履行，以及对社会责任的认识。您是否能够承担个人责任，并对他人和社会负责？",q15Title:"自我认同",q15Desc:"最近6个月，您对自我价值和身份的认同感如何？包括对个人价值的认知，自我接纳程度，以及对个人身份的满意度。您是否对自己有清晰的认知，并能够接纳自己的优缺点？",q16Title:"社区参与",q16Desc:"最近1年，您参与社区活动和公益服务的情况如何？包括志愿服务参与度，社区活动贡献，以及对社会公益的关注和参与。您是否积极参与社区活动，并为社会做出贡献？",q17Title:"职业发展",q17Desc:"最近1年，您在职业技能提升和职涯规划方面的表现如何？包括专业技能发展，职业规划清晰度，以及对职业发展机会的把握。您是否持续提升职业技能，并有明确的职业发展路径？",q18Title:"人际冲突处理",q18Desc:"最近3个月，您处理人际冲突和分歧的能力如何？包括冲突解决技巧，沟通协调能力，以及维护关系的智慧。您是否能够有效处理人际冲突，并在分歧中寻求共识？",q19Title:"时间管理",q19Desc:"最近1年，您合理安排时间和优先级的能力如何？包括时间规划效率，任务优先级设定，以及工作生活平衡的维持。您是否能够有效管理时间，并在多重任务中保持效率？",q20Title:"整体满意度",q20Desc:"最近6个月，您对整体生活状况的满意度如何？包括对生活质量的整体评价，对个人成就的满意度，以及对未来生活前景的乐观程度。您是否对当前的生活状况感到满意，并对未来充满希望？",excellent:"非常好",good:"良好",fair:"一般",poor:"需要改善",terrible:"非常糟糕",scoreLabel:"评估分数",resultLabel:"评估结果",descriptionLabel:"详细分析",recommendationsLabel:"改善建议",analysisLabel:"专业分析",privacyPolicy:"隐私权政策",terms:"条款/声明",dataDeletion:"资料删除说明",about:"🧬 Restarter™｜我们是谁",feedback:"💬 意见箱｜我们想听你说"},en:{title:"Social Integration Assessment",subtitle:"Assess your social integration and get professional advice",subtitle2:"Face challenges bravely and regularly monitor your social integration progress, every assessment is an opportunity for growth",backToHome:"Back",startAssessment:"Start Assessment",submitAssessment:"Submit Assessment",cancelAssessment:"Cancel",closeAssessment:"Close",assessmentComplete:"Assessment Complete",viewReport:"View Report",closeReport:"Close Report",q1Title:"Interpersonal Relationships",q1Desc:"In the past 3 months, how is your interaction and social ability with others? Including daily communication with colleagues, friends, and neighbors, as well as the ability to build relationships in new environments. Are you able to actively communicate with others, build trust relationships, and feel comfortable in social situations?",q2Title:"Employment Status",q2Desc:"In the past year, how is your job stability and development prospects? Including job satisfaction, salary benefits, career development opportunities, work environment adaptability, and clarity of future career planning. Are you satisfied with your current job and have clear career development goals?",q3Title:"Family Relationships",q3Desc:"In the past 6 months, how is your relationship and communication with family? Including relationship quality with spouse, children, parents or other family members, communication frequency and effectiveness, and family atmosphere harmony. Are you able to effectively handle family conflicts and provide emotional support to family members?",q4Title:"Future Confidence",q4Desc:"In the past year, how optimistic are you about the future and your planning? Including confidence in personal development, clarity of life goals, and positive attitude when facing challenges. Do you have clear plans for the future and believe you can achieve your goals?",q5Title:"Social Acceptance",q5Desc:"In the past 6 months, how accepted and recognized do you feel by society? Including community integration, social status recognition, and adaptation to social norms. Do you feel accepted by society and satisfied with your social role?",q6Title:"Emotional Management",q6Desc:"In the past 3 months, how well do you handle stress and negative emotions? Including emotional responses when facing setbacks, stress regulation methods, and awareness of mental health maintenance. Are you able to effectively manage negative emotions and stay calm under pressure?",q7Title:"Life Routine",q7Desc:"In the past year, how regular is your daily routine and lifestyle? Including daily schedule, eating habits, exercise frequency, and stability of life rhythm. Are you able to maintain healthy living habits and establish regular daily life?",q8Title:"Learning & Growth",q8Desc:"In the past year, how much have you invested in skill learning and personal growth? Including new skill learning, knowledge updates, self-improvement initiative, and investment in personal development. Do you continuously learn new knowledge and actively seek personal growth opportunities?",q9Title:"Financial Management",q9Desc:"In the past year, how is your financial planning and money management? Including income and expense management, saving habits, investment awareness, and planning for future financial security. Are you able to effectively manage personal finances and prepare for the future?",q10Title:"Health Status",q10Desc:"In the past 6 months, how is your physical and mental health? Including physical health condition, mental health status, healthcare awareness, and ability to prevent and handle health issues. Do you value health management and take active health maintenance measures?",q11Title:"Social Network",q11Desc:"In the past 3 months, how well do you build and maintain social relationships? Including number of friends, social activity participation, relationship quality, and breadth and depth of social network. Do you have a stable social circle and can build meaningful relationships with others?",q12Title:"Goal Setting",q12Desc:"In the past year, how well do you set and pursue personal goals? Including goal clarity, plan feasibility, execution ability, and assessment of goal achievement. Are you able to set clear goals and effectively execute plans?",q13Title:"Adaptability",q13Desc:"In the past 6 months, how well do you adapt to environmental changes and challenges? Including adaptation speed to new environments, flexibility in coping with changes, and ability to recover from setbacks. Are you able to quickly adapt to new environments and maintain stability in changes?",q14Title:"Responsibility",q14Desc:"In the past year, how responsible are you towards yourself and others? Including personal behavior responsibility, fulfillment of commitments to others, and awareness of social responsibility. Are you able to take personal responsibility and be responsible for others and society?",q15Title:"Self-Identity",q15Desc:"In the past 6 months, how strong is your sense of self-worth and identity? Including awareness of personal value, self-acceptance level, and satisfaction with personal identity. Do you have a clear understanding of yourself and can accept your strengths and weaknesses?",q16Title:"Community Participation",q16Desc:"In the past 3 years, how involved are you in community activities and public service? Including volunteer service participation, community activity contribution, and attention and participation in social welfare. Do you actively participate in community activities and contribute to society?",q17Title:"Career Development",q17Desc:"In the past year, how well have you performed in skill enhancement and career planning? Including professional skill development, career planning clarity, and grasp of career development opportunities. Do you continuously improve professional skills and have clear career development paths?",q18Title:"Conflict Resolution",q18Desc:"In the past 3 months, how well do you handle interpersonal conflicts and disagreements? Including conflict resolution skills, communication coordination ability, and wisdom in maintaining relationships. Are you able to effectively handle interpersonal conflicts and seek consensus in disagreements?",q19Title:"Time Management",q19Desc:"In the past year, how well do you manage time and prioritize tasks? Including time planning efficiency, task priority setting, and maintenance of work-life balance. Are you able to effectively manage time and maintain efficiency in multiple tasks?",q20Title:"Overall Satisfaction",q20Desc:"In the past 6 months, how satisfied are you with your overall life situation? Including overall evaluation of life quality, satisfaction with personal achievements, and optimism about future life prospects. Are you satisfied with your current life situation and hopeful about the future?",excellent:"Excellent",good:"Good",fair:"Fair",poor:"Needs Improvement",terrible:"Very Poor",scoreLabel:"Assessment Score",resultLabel:"Assessment Result",descriptionLabel:"Detailed Analysis",recommendationsLabel:"Improvement Suggestions",analysisLabel:"Professional Analysis",privacyPolicy:"Privacy Policy",terms:"Terms/Statement",dataDeletion:"Data Deletion Guide",about:"🧬 Restarter™｜Who We Are",feedback:"💬 Feedback｜We Want to Hear You"},ko:{title:"사회 통합도 평가",subtitle:"사회 통합도를 평가하고 전문적인 조언을 받으세요",subtitle2:"용감하게 직면하고 정기적으로 자신의 사회 통합도 진전 상황을 점검하세요. 모든 평가는 성장의 기회입니다",backToHome:"돌아가기",startAssessment:"평가 시작",submitAssessment:"평가 제출",cancelAssessment:"취소",closeAssessment:"닫기",assessmentComplete:"평가 완료",viewReport:"보고서 보기",closeReport:"보고서 닫기",q1Title:"인간관계",q1Desc:"최근 3개월간 타인과의 상호작용과 사회적 능력은 어떠한가요? 동료, 친구, 이웃과의 일상적 교류와 새로운 환경에서 관계를 구축하는 능력을 포함합니다. 적극적으로 타인과 소통하고 신뢰 관계를 구축하며 사회적 상황에서 편안함을 느낄 수 있나요?",q2Title:"고용 상황",q2Desc:"최근 1년간 직업의 안정성과 발전 전망은 어떠한가요? 직업 만족도, 급여 대우, 직업 발전 기회, 직장 환경 적응성, 그리고 미래 직업 계획의 명확성을 포함합니다. 현재 직업에 만족하며 명확한 직업 발전 목표가 있나요?",q3Title:"가족 관계",q3Desc:"최근 6개월간 가족과의 생활과 소통 상황은 어떠한가요? 배우자, 자녀, 부모 또는 다른 가족 구성원과의 관계 품질, 소통 빈도와 효과, 그리고 가족 분위기의 조화를 포함합니다. 가족 갈등을 효과적으로 처리하고 가족 구성원에게 감정적 지원을 제공할 수 있나요?",q4Title:"미래에 대한 신뢰",q4Desc:"미래 1년에 대한 낙관적 정도와 계획은 어떠한가요? 개인 발전에 대한 신뢰, 삶의 목표에 대한 명확성, 그리고 도전에 직면할 때의 적극적 태도를 포함합니다. 미래에 대한 명확한 계획이 있으며 목표를 달성할 수 있다고 믿나요?",q5Title:"사회적 수용",q5Desc:"최근 6개월간 사회로부터 받아들여지고 인정받는다고 느끼는 정도는 어떠한가요? 지역사회에서의 통합도, 사회적 지위에 대한 동일시, 그리고 사회적 규범에 대한 적응 능력을 포함합니다. 사회로부터 받아들여진다고 느끼며 자신의 사회적 역할에 만족하나요?",q6Title:"감정 관리",q6Desc:"최근 3개월간 스트레스와 부정적 감정을 처리하는 능력은 어떠한가요? 좌절에 직면할 때의 감정적 반응, 스트레스 조절 방법, 그리고 정신 건강 유지에 대한 의식을 포함합니다. 부정적 감정을 효과적으로 관리하고 스트레스 하에서도 침착함을 유지할 수 있나요?",q7Title:"생활 규칙",q7Desc:"최근 6개월간 생활 습관과 규칙성은 어떠한가요? 일상 생활 시간, 식습관, 운동 빈도, 그리고 생활 리듬의 안정성을 포함합니다. 건강한 생활 습관을 유지하고 규칙적인 일상 생활을 구축할 수 있나요?",q8Title:"학습 성장",q8Desc:"최근 1년간 기술 학습과 개인 성장에 대한 투자는 어떠한가요? 새로운 기술 학습, 지식 업데이트, 자기 향상에 대한 적극성, 그리고 개인 발전에 대한 투자를 포함합니다. 새로운 지식을 지속적으로 학습하고 개인 성장 기회를 적극적으로 찾나요?",q9Title:"재정 관리",q9Desc:"최근 1년간 재정 계획과 재정 관리 능력은 어떠한가요? 수입 지출 관리, 저축 습관, 투자 재정 의식, 그리고 미래 재정 안전에 대한 계획을 포함합니다. 개인 재정을 효과적으로 관리하고 미래를 위한 재정 준비를 할 수 있나요?",q10Title:"건강 상태",q10Desc:"최근 6개월간 신체적, 정신적 건강 상태는 어떠한가요? 신체 건강 상태, 정신 건강 상태, 의료 보건 의식, 그리고 건강 문제에 대한 예방과 처리 능력을 포함합니다. 건강 관리에 중점을 두고 적극적인 건강 유지 조치를 취하나요?",q11Title:"사회적 네트워크",q11Desc:"최근 3개월간 사회적 관계를 구축하고 유지하는 능력은 어떠한가요? 친구 수, 사회적 활동 참여도, 인간관계 품질, 그리고 사회적 네트워크의 폭과 깊이를 포함합니다. 안정적인 사회적 서클을 가지고 타인과 의미 있는 관계를 구축할 수 있나요?",q12Title:"목표 설정",q12Desc:"최근 1년간 개인 목표를 설정하고 추구하는 능력은 어떠한가요? 목표의 명확성, 계획의 실현 가능성, 실행력, 그리고 목표 달성도에 대한 평가를 포함합니다. 명확한 목표를 설정하고 계획을 효과적으로 실행할 수 있나요?",q13Title:"적응 능력",q13Desc:"최근 6개월간 환경 변화와 도전에 적응하는 능력은 어떠한가요? 새로운 환경에 대한 적응 속도, 변화에 대응하는 유연성, 그리고 좌절에서 회복하는 능력을 포함합니다. 새로운 환경에 빠르게 적응하고 변화 속에서도 안정을 유지할 수 있나요?",q14Title:"책임감",q14Desc:"최근 1년간 자신과 타인에 대한 책임감 있는 태도는 어떠한가요? 개인 행동에 대한 책임감, 타인에 대한 약속 이행, 그리고 사회적 책임에 대한 인식을 포함합니다. 개인적 책임을 질 수 있고 타인과 사회에 대해 책임을 질 수 있나요?",q15Title:"자아 정체성",q15Desc:"최근 6개월간 자아 가치와 정체성에 대한 동일시는 어떠한가요? 개인 가치에 대한 인식, 자기 수용 정도, 그리고 개인 정체성에 대한 만족도를 포함합니다. 자신에 대한 명확한 인식이 있으며 자신의 장단점을 받아들일 수 있나요?",q16Title:"지역사회 참여",q16Desc:"최근 1년간 지역사회 활동과 공익 서비스 참여 상황은 어떠한가요? 자원봉사 참여도, 지역사회 활동 기여, 그리고 사회 복지에 대한 관심과 참여를 포함합니다. 지역사회 활동에 적극적으로 참여하고 사회에 기여하나요?",q17Title:"직업 발전",q17Desc:"최근 1년간 직업 기술 향상과 경력 계획 측면에서의 성과는 어떠한가요? 전문 기술 발전, 경력 계획 명확성, 그리고 경력 발전 기회에 대한 파악을 포함합니다. 직업 기술을 지속적으로 향상시키고 명확한 경력 발전 경로가 있나요?",q18Title:"인간관계 갈등 처리",q18Desc:"최근 3개월간 인간관계 갈등과 의견 차이를 처리하는 능력은 어떠한가요? 갈등 해결 기술, 소통 조정 능력, 그리고 관계 유지의 지혜를 포함합니다. 인간관계 갈등을 효과적으로 처리하고 의견 차이에서 합의를 찾을 수 있나요?",q19Title:"시간 관리",q19Desc:"최근 1년간 시간을 합리적으로 배치하고 우선순위를 설정하는 능력은 어떠한가요? 시간 계획 효율성, 작업 우선순위 설정, 그리고 업무와 생활의 균형 유지를 포함합니다. 시간을 효과적으로 관리하고 다중 작업에서도 효율성을 유지할 수 있나요?",q20Title:"전체 만족도",q20Desc:"최근 6개월간 전체적인 생활 상황에 대한 만족도는 어떠한가요? 생활 품질에 대한 전체적 평가, 개인 성취에 대한 만족도, 그리고 미래 생활 전망에 대한 낙관적 정도를 포함합니다. 현재의 생활 상황에 만족하며 미래에 대한 희망을 가지고 있나요?",excellent:"매우 좋음",good:"좋음",fair:"보통",poor:"개선 필요",terrible:"매우 나쁨",scoreLabel:"평가 점수",resultLabel:"평가 결과",descriptionLabel:"상세 분석",recommendationsLabel:"개선 제안",analysisLabel:"전문 분석",privacyPolicy:"개인정보 보호정책",terms:"약관/성명",dataDeletion:"데이터 삭제 안내",about:"🧬 Restarter™｜우리는 누구인가",feedback:"💬 의견함｜우리는 당신의 말을 듣고 싶습니다"}};function U3(){const{lang:n}=Mt(),e=_t(),{isTestMode:t}=$i(),[r,o]=v.useState(0),a=ak[n]||ak["zh-TW"];v.useEffect(()=>{console.log("Language changed to:",n),o(P=>P+1)},[n]);const[c,d]=v.useState(!1),[h,m]=v.useState(!1),[g,x]=v.useState({q1:"",q2:"",q3:"",q4:"",q5:"",q6:"",q7:"",q8:"",q9:"",q10:"",q11:"",q12:"",q13:"",q14:"",q15:"",q16:"",q17:"",q18:"",q19:"",q20:""}),[S,C]=v.useState(null),_=P=>{const B={excellent:5,good:4,fair:3,poor:2,terrible:1},q=[B[P.q1]||3,B[P.q2]||3,B[P.q3]||3,B[P.q4]||3,B[P.q5]||3,B[P.q6]||3,B[P.q7]||3,B[P.q8]||3,B[P.q9]||3,B[P.q10]||3,B[P.q11]||3,B[P.q12]||3,B[P.q13]||3,B[P.q14]||3,B[P.q15]||3,B[P.q16]||3,B[P.q17]||3,B[P.q18]||3,B[P.q19]||3,B[P.q20]||3],W=q.reduce((N,O)=>N+O,0)/20,L={interpersonal:(q[0]+q[10]+q[17])/3,career:(q[1]+q[16])/2,family:q[2],emotional:(q[5]+q[14])/2,lifestyle:(q[6]+q[9]+q[18])/3,learning:(q[7]+q[11]+q[12])/3,financial:q[8],responsibility:q[13],community:q[15],satisfaction:q[19]},R=Object.entries(L).filter(([N,O])=>O>=4).map(([N,O])=>N),A=Object.entries(L).filter(([N,O])=>O<=2).map(([N,O])=>N);if(W>=4.5){const O=[{condition:R.includes("interpersonal")&&R.includes("career"),description:"你的社會融入度表現卓越！在人際關係和職業發展方面表現特別突出，顯示出優秀的社交能力和職業素養。",recommendations:["繼續保持優秀的人際交往能力","可以考慮擔任職場導師幫助其他更生人","分享你的職業成功經驗","參與專業社群擴大影響力"],analysis:"你在人際關係和職業發展方面的優秀表現，表明你已經完全融入社會。建議繼續發揮這些優勢，並幫助其他需要支持的人。"},{condition:R.includes("emotional")&&R.includes("family"),description:"你的社會融入度表現優秀！在情緒管理和家庭關係方面表現特別突出，顯示出良好的心理素質和家庭和諧。",recommendations:["繼續保持穩定的情緒狀態","可以擔任家庭關係諮詢志工","分享你的家庭和諧經驗","參與心理健康推廣活動"],analysis:"你在情緒管理和家庭關係方面的優秀表現，表明你具備良好的心理素質和家庭責任感。建議繼續保持這種狀態。"},{condition:R.includes("lifestyle")&&R.includes("learning"),description:"你的社會融入度表現優秀！在生活規律和學習成長方面表現特別突出，顯示出良好的自律能力和進取精神。",recommendations:["繼續保持規律的生活習慣","可以擔任學習輔導志工","分享你的學習方法和經驗","參與教育推廣活動"],analysis:"你在生活規律和學習成長方面的優秀表現，表明你具備良好的自律能力和進取精神。建議繼續發揮這些優勢。"},{condition:R.includes("financial")&&R.includes("responsibility"),description:"你的社會融入度表現優秀！在財務管理和責任感方面表現特別突出，顯示出良好的理財能力和社會責任感。",recommendations:["繼續保持穩健的財務管理","可以擔任財務規劃志工","分享你的理財經驗","參與社會責任活動"],analysis:"你在財務管理和責任感方面的優秀表現，表明你具備良好的理財能力和社會責任感。建議繼續發揮這些優勢。"},{condition:R.includes("community")&&R.includes("satisfaction"),description:"你的社會融入度表現優秀！在社區參與和整體滿意度方面表現特別突出，顯示出良好的社會參與度和生活滿意度。",recommendations:["繼續積極參與社區活動","可以擔任社區志工領袖","分享你的社區參與經驗","參與更多公益活動"],analysis:"你在社區參與和整體滿意度方面的優秀表現，表明你已經完全融入社會並對生活感到滿意。建議繼續保持這種狀態。"}].find(z=>z.condition)||{description:`恭喜您！您的社會融入度評估結果顯示您已經達到了優秀水平。在${R.length>0?R.map(z=>({interpersonal:"人際關係",career:"職業發展",family:"家庭關係",emotional:"情緒管理",lifestyle:"生活規律",learning:"學習成長",financial:"財務管理",responsibility:"責任感",community:"社區參與",satisfaction:"整體滿意度"})[z]||z).join("、"):"多個重要維度"}方面，您展現出了卓越的能力和積極的態度。這表明您已經成功建立了穩定的社會支持網絡，具備了良好的生活技能和職業素養，並且對未來充滿信心。您的表現不僅為自己創造了美好的生活，也為其他更生人樹立了積極的榜樣。`,recommendations:["繼續保持現有的優秀表現，定期進行自我評估以維持高水準","考慮擔任更生人互助團體的導師或志工，分享您的成功經驗","參與專業社群和行業交流，進一步提升職業技能和社會影響力","建立個人品牌，成為更生人融入社會的典範","定期參與公益活動，回饋社會並擴大正面影響力","考慮擔任職場導師，幫助其他更生人提升就業競爭力","建立個人發展檔案，記錄成長歷程並分享給需要支持的人"],analysis:`基於您完成的20項詳細評估，我們發現您在${R.length>0?R.map(z=>({interpersonal:"人際關係",career:"職業發展",family:"家庭關係",emotional:"情緒管理",lifestyle:"生活規律",learning:"學習成長",financial:"財務管理",responsibility:"責任感",community:"社區參與",satisfaction:"整體滿意度"})[z]||z).join("、"):"各個關鍵維度"}都表現出色。這表明您已經完全融入了社會，具備了優秀的社會適應能力、職業素養和生活技能。您的成功不僅體現在個人成就上，更重要的是您展現出了積極的生活態度和對未來的清晰規劃。建議您繼續保持這種優秀狀態，並考慮將您的經驗分享給其他需要支持的人，成為更生人融入社會的典範。您的表現證明了更生人完全有能力重新融入社會並創造美好生活。`};return{score:W,result:"優秀",description:O.description,recommendations:O.recommendations,analysis:O.analysis}}else if(W>=3.5){const O=[{condition:A.includes("interpersonal")&&R.includes("career"),description:"你的社會融入度良好，在職業發展方面表現不錯，但人際關係需要改善。",recommendations:["參加人際溝通技巧培訓","主動參與社交活動","尋求人際關係諮詢","繼續保持職業發展優勢"],analysis:"你在職業發展方面表現良好，但人際關係需要改善。建議重點提升社交能力，同時保持職業優勢。"},{condition:A.includes("emotional")&&R.includes("family"),description:"你的社會融入度良好，在家庭關係方面表現不錯，但情緒管理需要改善。",recommendations:["參加情緒管理課程","尋求心理諮商服務","學習壓力調節技巧","繼續維護良好的家庭關係"],analysis:"你在家庭關係方面表現良好，但情緒管理需要改善。建議重點提升情緒管理能力。"},{condition:A.includes("lifestyle")&&R.includes("learning"),description:"你的社會融入度良好，在學習成長方面表現不錯，但生活規律需要改善。",recommendations:["制定規律的作息時間表","建立健康的生活習慣","參加時間管理課程","繼續保持學習熱情"],analysis:"你在學習成長方面表現良好，但生活規律需要改善。建議重點建立規律的生活習慣。"},{condition:A.includes("financial")&&R.includes("responsibility"),description:"你的社會融入度良好，在責任感方面表現不錯，但財務管理需要改善。",recommendations:["參加財務規劃課程","制定個人預算計劃","學習理財知識","繼續保持責任感"],analysis:"你在責任感方面表現良好，但財務管理需要改善。建議重點提升財務管理能力。"},{condition:A.includes("community")&&R.includes("satisfaction"),description:"你的社會融入度良好，對生活滿意度不錯，但社區參與需要改善。",recommendations:["主動參與社區活動","加入志願服務團體","參與公益活動","繼續保持積極的生活態度"],analysis:"你對生活滿意度不錯，但社區參與需要改善。建議重點提升社會參與度。"}].find(z=>z.condition)||{description:`您的社會融入度評估結果顯示您達到了良好水平。在${R.length>0?R.map(z=>({interpersonal:"人際關係",career:"職業發展",family:"家庭關係",emotional:"情緒管理",lifestyle:"生活規律",learning:"學習成長",financial:"財務管理",responsibility:"責任感",community:"社區參與",satisfaction:"整體滿意度"})[z]||z).join("、"):"多個重要維度"}方面，您展現出了穩定的能力和積極的態度。這表明您已經建立了基本的社會支持網絡，具備了良好的生活技能和職業素養，並且對未來有一定的規劃。雖然在某些方面還有提升空間，但您的整體表現已經為進一步發展奠定了堅實的基礎。`,recommendations:["繼續保持現有的良好狀態，建立定期自我評估機制",A.length>0?`制定${A.join("、")}方面的具體改善計劃，設定明確的目標和時間表`:"進一步提升各方面能力，設定更具挑戰性的目標","參加專業技能培訓和認證課程，提升職業競爭力","加強與社區的互動和參與，擴大社交網絡","尋求導師指導，學習成功人士的經驗和方法","建立個人發展檔案，記錄進步歷程和成就","參與更生人互助團體，與同路人分享經驗和互相支持"],analysis:`基於您完成的20項詳細評估，我們發現您在${R.length>0?R.map(z=>({interpersonal:"人際關係",career:"職業發展",family:"家庭關係",emotional:"情緒管理",lifestyle:"生活規律",learning:"學習成長",financial:"財務管理",responsibility:"責任感",community:"社區參與",satisfaction:"整體滿意度"})[z]||z).join("、"):"多個關鍵維度"}表現良好，具備了基本的社會適應能力和生活技能。${A.length>0?`特別是在${A.map(z=>({interpersonal:"人際關係",career:"職業發展",family:"家庭關係",emotional:"情緒管理",lifestyle:"生活規律",learning:"學習成長",financial:"財務管理",responsibility:"責任感",community:"社區參與",satisfaction:"整體滿意度"})[z]||z).join("、")}方面，建議您制定具體的改善計劃，尋求專業指導和支持。`:""}您的整體表現表明您已經成功融入了社會，並且具備了進一步發展的潛力。建議您繼續保持積極的態度，設定更具挑戰性的目標，並尋求更多學習和成長的機會。您的進步證明了更生人完全有能力重新融入社會並創造美好生活。`};return{score:W,result:"良好",description:O.description,recommendations:O.recommendations,analysis:O.analysis}}else if(W>=2.5){const O=[{condition:A.includes("interpersonal")&&A.includes("career"),description:"你的社會融入度一般，在人際關係和職業發展方面都需要改善。",recommendations:["參加人際溝通技巧培訓","尋求職業技能培訓","參加更生人互助團體","建立職業發展計劃","尋求專業輔導師幫助"],analysis:"你在人際關係和職業發展方面都需要改善。建議同時提升社交能力和職業技能，尋求專業支持。"},{condition:A.includes("emotional")&&A.includes("family"),description:"你的社會融入度一般，在情緒管理和家庭關係方面都需要改善。",recommendations:["尋求心理諮商服務","參加情緒管理課程","改善家庭溝通方式","建立家庭支持系統","尋求專業輔導師幫助"],analysis:"你在情緒管理和家庭關係方面都需要改善。建議重點提升心理健康和家庭關係。"},{condition:A.includes("lifestyle")&&A.includes("learning"),description:"你的社會融入度一般，在生活規律和學習成長方面都需要改善。",recommendations:["制定規律的作息時間表","參加時間管理課程","建立學習計劃","尋找學習夥伴","尋求專業輔導師幫助"],analysis:"你在生活規律和學習成長方面都需要改善。建議重點建立規律的生活習慣和學習計劃。"},{condition:A.includes("financial")&&A.includes("responsibility"),description:"你的社會融入度一般，在財務管理和責任感方面都需要改善。",recommendations:["參加財務規劃課程","制定個人預算計劃","提升責任感意識","建立財務目標","尋求專業輔導師幫助"],analysis:"你在財務管理和責任感方面都需要改善。建議重點提升理財能力和責任感。"},{condition:A.includes("community")&&A.includes("satisfaction"),description:"你的社會融入度一般，在社區參與和整體滿意度方面都需要改善。",recommendations:["主動參與社區活動","加入志願服務團體","提升生活滿意度","建立社交網絡","尋求專業輔導師幫助"],analysis:"你在社區參與和整體滿意度方面都需要改善。建議重點提升社會參與度和生活滿意度。"}].find(z=>z.condition)||{description:`您的社會融入度評估結果顯示您目前處於一般水平。在${A.length>0?A.map(z=>({interpersonal:"人際關係",career:"職業發展",family:"家庭關係",emotional:"情緒管理",lifestyle:"生活規律",learning:"學習成長",financial:"財務管理",responsibility:"責任感",community:"社區參與",satisfaction:"整體滿意度"})[z]||z).join("、"):"某些重要維度"}方面，您需要更多的支持和改善。這表明您在社會融入過程中遇到了一些挑戰，但這並不意味著失敗，而是需要更多專業指導和支持的表現。${R.length>0?`同時，您在${R.map(z=>({interpersonal:"人際關係",career:"職業發展",family:"家庭關係",emotional:"情緒管理",lifestyle:"生活規律",learning:"學習成長",financial:"財務管理",responsibility:"責任感",community:"社區參與",satisfaction:"整體滿意度"})[z]||z).join("、")}方面的表現值得肯定，這些優勢將成為您改善其他方面的基礎。`:""}建議您積極尋求專業支持，制定系統性的改善計劃。`,recommendations:["立即聯繫專業輔導師，制定個人化的改善計劃","參加更生人支持計劃和互助團體，獲得同路人支持","建立穩定的生活規律，包括作息時間、飲食習慣和運動計劃","加強人際關係建設，學習有效的溝通技巧",R.length>0?`充分發揮${R.map(z=>({interpersonal:"人際關係",career:"職業發展",family:"家庭關係",emotional:"情緒管理",lifestyle:"生活規律",learning:"學習成長",financial:"財務管理",responsibility:"責任感",community:"社區參與",satisfaction:"整體滿意度"})[z]||z).join("、")}方面的優勢，建立自信心`:"尋找個人優勢並加以發揮，建立自信心","參加職業技能培訓，提升就業競爭力","建立支持網絡，包括家人、朋友和專業人士","制定短期和長期目標，逐步改善各方面能力","定期進行自我評估，追蹤改善進度"],analysis:`基於您完成的20項詳細評估，我們發現您在${A.length>0?A.map(z=>({interpersonal:"人際關係",career:"職業發展",family:"家庭關係",emotional:"情緒管理",lifestyle:"生活規律",learning:"學習成長",financial:"財務管理",responsibility:"責任感",community:"社區參與",satisfaction:"整體滿意度"})[z]||z).join("、"):"某些關鍵維度"}需要更多支持。${A.length>0?`特別是在${A.map(z=>({interpersonal:"人際關係",career:"職業發展",family:"家庭關係",emotional:"情緒管理",lifestyle:"生活規律",learning:"學習成長",financial:"財務管理",responsibility:"責任感",community:"社區參與",satisfaction:"整體滿意度"})[z]||z).join("、")}方面，建議您制定具體的改善計劃，尋求專業指導和支持。`:""}${R.length>0?`同時，您在${R.map(z=>({interpersonal:"人際關係",career:"職業發展",family:"家庭關係",emotional:"情緒管理",lifestyle:"生活規律",learning:"學習成長",financial:"財務管理",responsibility:"責任感",community:"社區參與",satisfaction:"整體滿意度"})[z]||z).join("、")}方面的表現值得肯定，這些優勢將成為您改善其他方面的基礎。`:""}您的評估結果表明您在社會融入過程中遇到了一些挑戰，但這並不意味著失敗。每個人的改善路徑都是不同的，重要的是您願意正視這些挑戰並尋求幫助。建議您積極尋求專業支持，制定系統性的改善計劃，並相信通過持續的努力，您一定能夠取得進步。`};return{score:W,result:"一般",description:O.description,recommendations:O.recommendations,analysis:O.analysis}}else{const O=[{condition:A.includes("interpersonal")&&A.includes("emotional"),description:"你的社會融入度需要改善，在人際關係和情緒管理方面都需要專業支持。",recommendations:["立即聯繫專業輔導師","尋求心理諮商服務","參加人際溝通技巧培訓","參加情緒管理課程","建立支持網絡"],analysis:"你在人際關係和情緒管理方面都需要專業支持。建議立即尋求專業幫助，逐步改善這些方面。"},{condition:A.includes("career")&&A.includes("financial"),description:"你的社會融入度需要改善，在職業發展和財務管理方面都需要專業支持。",recommendations:["立即聯繫專業輔導師","參加職業技能培訓","參加財務規劃課程","制定職業發展計劃","建立財務目標"],analysis:"你在職業發展和財務管理方面都需要專業支持。建議立即尋求專業幫助，制定改善計劃。"},{condition:A.includes("family")&&A.includes("lifestyle"),description:"你的社會融入度需要改善，在家庭關係和生活規律方面都需要專業支持。",recommendations:["立即聯繫專業輔導師","改善家庭溝通方式","制定規律的作息時間表","建立家庭支持系統","參加家庭關係諮詢"],analysis:"你在家庭關係和生活規律方面都需要專業支持。建議立即尋求專業幫助，改善這些方面。"},{condition:A.includes("learning")&&A.includes("responsibility"),description:"你的社會融入度需要改善，在學習成長和責任感方面都需要專業支持。",recommendations:["立即聯繫專業輔導師","制定學習計劃","提升責任感意識","尋找學習夥伴","建立目標管理系統"],analysis:"你在學習成長和責任感方面都需要專業支持。建議立即尋求專業幫助，制定改善計劃。"},{condition:A.includes("community")&&A.includes("satisfaction"),description:"你的社會融入度需要改善，在社區參與和整體滿意度方面都需要專業支持。",recommendations:["立即聯繫專業輔導師","主動參與社區活動","提升生活滿意度","加入志願服務團體","建立社交網絡"],analysis:"你在社區參與和整體滿意度方面都需要專業支持。建議立即尋求專業幫助，改善這些方面。"}].find(z=>z.condition)||{description:`您的社會融入度評估結果顯示您目前面臨較大的挑戰，在${A.length>0?A.map(z=>({interpersonal:"人際關係",career:"職業發展",family:"家庭關係",emotional:"情緒管理",lifestyle:"生活規律",learning:"學習成長",financial:"財務管理",responsibility:"責任感",community:"社區參與",satisfaction:"整體滿意度"})[z]||z).join("、"):"多個重要維度"}都需要專業支持和改善。這表明您在社會融入過程中遇到了較多的困難，但這絕對不是失敗，而是需要更多專業幫助的表現。每個人的改善路徑都是不同的，重要的是您願意正視這些挑戰並積極尋求幫助。建議您立即聯繫專業輔導師，制定系統性的改善計劃，並相信通過持續的努力和專業支持，您一定能夠逐步改善並重新融入社會。`,recommendations:["立即聯繫專業輔導師，制定個人化的改善計劃和時間表","參加更生人支持計劃和互助團體，獲得同路人支持和理解","尋求專業心理諮商服務，處理可能的情緒和心理問題","建立穩定的生活規律，包括規律的作息、健康的飲食和適度的運動","尋求家人和朋友的支持，建立穩定的支持網絡","參加職業技能培訓和就業輔導，提升就業競爭力","建立短期和長期目標，逐步改善各方面能力","定期進行自我評估，追蹤改善進度並調整計劃","學習有效的壓力管理和情緒調節技巧","參與社區活動，逐步建立社交網絡"],analysis:`基於您完成的20項詳細評估，我們發現您在${A.length>0?A.map(z=>({interpersonal:"人際關係",career:"職業發展",family:"家庭關係",emotional:"情緒管理",lifestyle:"生活規律",learning:"學習成長",financial:"財務管理",responsibility:"責任感",community:"社區參與",satisfaction:"整體滿意度"})[z]||z).join("、"):"多個關鍵維度"}需要專業支持。您的評估結果表明您目前在社會融入過程中遇到了較多的挑戰，但這絕對不是失敗。每個人的改善路徑都是不同的，重要的是您願意正視這些挑戰並積極尋求幫助。專業輔導師可以幫助您制定適合的改善計劃，提供系統性的支持和指導。建議您立即聯繫專業輔導師，制定個人化的改善計劃，並相信通過持續的努力和專業支持，您一定能夠逐步改善並重新融入社會。記住，尋求幫助是勇敢的表現，也是成功改善的第一步。`};return{score:W,result:"需要改善",description:O.description,recommendations:O.recommendations,analysis:O.analysis}}},I=()=>{if(!Object.values(g).every(te=>te!=="")){alert("請回答所有問題");return}const B=_(g),q={score:B.score,result:B.result,description:B.description,recommendations:B.recommendations,analysis:B.analysis,details:{relationships:g.q1,employment:g.q2,family:g.q3,confidence:g.q4,acceptance:g.q5,emotional:g.q6,routine:g.q7,learning:g.q8,financial:g.q9,health:g.q10,social:g.q11,goals:g.q12,adaptability:g.q13,responsibility:g.q14,identity:g.q15,community:g.q16,career:g.q17,conflict:g.q18,time:g.q19,satisfaction:g.q20}};C(q),d(!1),m(!0)},T=[{key:"q1",title:a.q1Title,desc:a.q1Desc},{key:"q2",title:a.q2Title,desc:a.q2Desc},{key:"q3",title:a.q3Title,desc:a.q3Desc},{key:"q4",title:a.q4Title,desc:a.q4Desc},{key:"q5",title:a.q5Title,desc:a.q5Desc},{key:"q6",title:a.q6Title,desc:a.q6Desc},{key:"q7",title:a.q7Title,desc:a.q7Desc},{key:"q8",title:a.q8Title,desc:a.q8Desc},{key:"q9",title:a.q9Title,desc:a.q9Desc},{key:"q10",title:a.q10Title,desc:a.q10Desc},{key:"q11",title:a.q11Title,desc:a.q11Desc},{key:"q12",title:a.q12Title,desc:a.q12Desc},{key:"q13",title:a.q13Title,desc:a.q13Desc},{key:"q14",title:a.q14Title,desc:a.q14Desc},{key:"q15",title:a.q15Title,desc:a.q15Desc},{key:"q16",title:a.q16Title,desc:a.q16Desc},{key:"q17",title:a.q17Title,desc:a.q17Desc},{key:"q18",title:a.q18Title,desc:a.q18Desc},{key:"q19",title:a.q19Title,desc:a.q19Desc},{key:"q20",title:a.q20Title,desc:a.q20Desc}],F=[{value:"excellent",label:a.excellent},{value:"good",label:a.good},{value:"fair",label:a.fair},{value:"poor",label:a.poor},{value:"terrible",label:a.terrible}];return i.jsxs("div",{style:{minHeight:"100vh",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",padding:"20px",display:"flex",flexDirection:"column"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"30px"},children:[i.jsxs("button",{onClick:()=>e("/"),style:{background:"rgba(255,255,255,0.9)",border:"none",borderRadius:"12px",padding:"12px 20px",fontSize:"16px",fontWeight:"600",cursor:"pointer",display:"flex",alignItems:"center",gap:"8px",boxShadow:"0 4px 12px rgba(0,0,0,0.1)"},children:["← ",a.backToHome]}),i.jsx("h1",{style:{color:"white",fontSize:"24px",fontWeight:"700",margin:0,textAlign:"center"},children:a.title}),i.jsx("div",{style:{zIndex:10001},children:i.jsx(Bn,{})})]}),i.jsx("div",{style:{flex:1,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:"30px"},children:i.jsxs("div",{style:{background:"rgba(255,255,255,0.95)",borderRadius:"20px",padding:"40px",maxWidth:"600px",width:"100%",textAlign:"center",boxShadow:"0 8px 32px rgba(0,0,0,0.1)"},children:[i.jsx("div",{style:{fontSize:"64px",marginBottom:"20px"},children:"📊"}),i.jsx("h2",{style:{fontSize:"28px",fontWeight:"700",color:"#333",marginBottom:"16px"},children:a.title}),i.jsx("p",{style:{fontSize:"16px",color:"#666",lineHeight:"1.6",marginBottom:"20px"},children:a.subtitle}),i.jsx("p",{style:{fontSize:"14px",color:"#888",lineHeight:"1.5",marginBottom:"30px",fontStyle:"italic"},children:a.subtitle2}),i.jsx("button",{onClick:()=>d(!0),style:{background:"linear-gradient(135deg, #6B5BFF, #5A4FCF)",color:"white",border:"none",borderRadius:"16px",padding:"16px 32px",fontSize:"18px",fontWeight:"600",cursor:"pointer",boxShadow:"0 4px 16px rgba(107, 91, 255, 0.3)",transition:"all 0.3s ease"},onMouseEnter:P=>{P.currentTarget.style.transform="translateY(-2px)",P.currentTarget.style.boxShadow="0 6px 20px rgba(107, 91, 255, 0.4)"},onMouseLeave:P=>{P.currentTarget.style.transform="translateY(0)",P.currentTarget.style.boxShadow="0 4px 16px rgba(107, 91, 255, 0.3)"},children:a.startAssessment})]})}),c&&i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,padding:"20px"},children:i.jsxs("div",{style:{background:"white",borderRadius:"20px",padding:"30px",maxWidth:"600px",width:"100%",maxHeight:"80vh",overflowY:"auto",position:"relative"},children:[i.jsx("button",{onClick:()=>d(!1),style:{position:"absolute",top:"15px",right:"20px",background:"none",border:"none",fontSize:"24px",color:"#666",cursor:"pointer",width:"30px",height:"30px",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"50%",transition:"all 0.2s ease"},onMouseEnter:P=>{P.currentTarget.style.background="#f0f0f0",P.currentTarget.style.color="#333"},onMouseLeave:P=>{P.currentTarget.style.background="none",P.currentTarget.style.color="#666"},children:"×"}),i.jsx("h3",{style:{fontSize:"24px",fontWeight:"700",color:"#333",marginBottom:"20px",textAlign:"center",paddingRight:"40px"},children:a.title}),i.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"24px"},children:T.map((P,B)=>i.jsxs("div",{style:{border:"2px solid #f0f0f0",borderRadius:"16px",padding:"20px",background:"#fafafa"},children:[i.jsxs("h4",{style:{fontSize:"18px",fontWeight:"600",color:"#333",marginBottom:"8px"},children:[B+1,". ",P.title]}),i.jsx("p",{style:{fontSize:"14px",color:"#666",marginBottom:"16px"},children:P.desc}),i.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:F.map(q=>i.jsxs("label",{style:{display:"flex",alignItems:"center",padding:"10px",borderRadius:"8px",cursor:"pointer",background:g[P.key]===q.value?"#6B5BFF":"white",color:g[P.key]===q.value?"white":"#333",border:`2px solid ${g[P.key]===q.value?"#6B5BFF":"#ddd"}`,transition:"all 0.2s ease",fontSize:"13px"},children:[i.jsx("input",{type:"radio",name:P.key,value:q.value,checked:g[P.key]===q.value,onChange:te=>x({...g,[P.key]:te.target.value}),style:{marginRight:"10px"}}),q.label]},q.value))})]},P.key))}),i.jsxs("div",{style:{display:"flex",gap:"12px",marginTop:"30px",justifyContent:"center"},children:[i.jsx("button",{onClick:()=>d(!1),style:{background:"#f0f0f0",color:"#666",border:"none",borderRadius:"12px",padding:"12px 24px",fontSize:"16px",fontWeight:"600",cursor:"pointer"},children:a.cancelAssessment}),i.jsx("button",{onClick:I,style:{background:"linear-gradient(135deg, #6B5BFF, #5A4FCF)",color:"white",border:"none",borderRadius:"12px",padding:"12px 24px",fontSize:"16px",fontWeight:"600",cursor:"pointer"},children:a.submitAssessment})]})]})}),h&&S&&i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,padding:"20px"},children:i.jsxs("div",{style:{background:"white",borderRadius:"20px",padding:"30px",maxWidth:"600px",width:"100%",maxHeight:"80vh",overflowY:"auto"},children:[i.jsxs("div",{style:{textAlign:"center",marginBottom:"30px"},children:[i.jsx("div",{style:{fontSize:"48px",marginBottom:"16px"},children:"📊"}),i.jsx("h3",{style:{fontSize:"24px",fontWeight:"700",color:"#333",marginBottom:"8px"},children:a.assessmentComplete})]}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"20px"},children:[i.jsxs("div",{style:{background:"linear-gradient(135deg, #6B5BFF, #5A4FCF)",color:"white",borderRadius:"16px",padding:"24px",textAlign:"center"},children:[i.jsxs("div",{style:{fontSize:"36px",fontWeight:"700",marginBottom:"8px"},children:[S.score.toFixed(1),"/5.0"]}),i.jsx("div",{style:{fontSize:"20px",fontWeight:"600"},children:S.result})]}),i.jsxs("div",{style:{border:"2px solid #f0f0f0",borderRadius:"16px",padding:"20px",background:"#fafafa"},children:[i.jsx("h4",{style:{fontSize:"18px",fontWeight:"600",color:"#333",marginBottom:"12px"},children:a.descriptionLabel}),i.jsx("p",{style:{fontSize:"16px",color:"#666",lineHeight:"1.6"},children:S.description})]}),i.jsxs("div",{style:{border:"2px solid #f0f0f0",borderRadius:"16px",padding:"20px",background:"#fafafa"},children:[i.jsx("h4",{style:{fontSize:"18px",fontWeight:"600",color:"#333",marginBottom:"12px"},children:a.analysisLabel}),i.jsx("p",{style:{fontSize:"16px",color:"#666",lineHeight:"1.6"},children:S.analysis})]}),i.jsxs("div",{style:{border:"2px solid #FFE4E1",borderRadius:"16px",padding:"20px",background:"linear-gradient(135deg, #FFF5F5, #FFE4E1)",boxShadow:"0 4px 12px rgba(255, 182, 193, 0.2)"},children:[i.jsxs("h4",{style:{fontSize:"18px",fontWeight:"600",color:"#D63384",marginBottom:"12px",display:"flex",alignItems:"center",gap:"8px"},children:["💡 ",a.recommendationsLabel]}),i.jsx("ul",{style:{fontSize:"16px",color:"#666",lineHeight:"1.6",paddingLeft:"20px"},children:S.recommendations.map((P,B)=>i.jsx("li",{style:{marginBottom:"8px"},children:P},B))})]})]}),i.jsx("div",{style:{display:"flex",justifyContent:"center",marginTop:"30px"},children:i.jsx("button",{onClick:()=>m(!1),style:{background:"linear-gradient(135deg, #6B5BFF, #5A4FCF)",color:"white",border:"none",borderRadius:"12px",padding:"12px 24px",fontSize:"16px",fontWeight:"600",cursor:"pointer"},children:a.closeReport})})]})}),i.jsx("div",{style:{width:"100%",margin:"0 auto",marginTop:24,background:"rgba(255,255,255,0.95)",borderRadius:16,padding:"16px",boxShadow:"0 2px 12px #6B5BFF22"},children:i.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:20,flexWrap:"wrap"},children:[i.jsx("a",{href:"/privacy-policy",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12},children:a.privacyPolicy}),i.jsx("a",{href:"/terms",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12},children:a.terms}),i.jsx("a",{href:"/data-deletion",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12},children:a.dataDeletion}),i.jsx("a",{href:"/about",style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12},children:a.about}),i.jsx("a",{href:"/feedback",style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12},children:a.feedback})]})})]})}const q3=St(Ao),lk={"zh-TW":{title:"確認註冊",confirming:"正在確認註冊...",success:"註冊成功！",error:"確認失敗",invalidToken:"確認連結無效或已過期",networkError:"網路連線失敗，請稍後再試",redirecting:"正在跳轉到首頁..."},"zh-CN":{title:"确认注册",confirming:"正在确认注册...",success:"注册成功！",error:"确认失败",invalidToken:"确认链接无效或已过期",networkError:"网络连接失败，请稍后再试",redirecting:"正在跳转到首页..."},en:{title:"Confirm Registration",confirming:"Confirming registration...",success:"Registration successful!",error:"Confirmation failed",invalidToken:"Confirmation link is invalid or expired",networkError:"Network connection failed, please try again later",redirecting:"Redirecting to homepage..."}};function H3(){const n=_t(),[e]=Sk(),{lang:t}=Mt(),r=lk[t]||lk["zh-TW"],[o,a]=v.useState("confirming"),[c,d]=v.useState("");return v.useEffect(()=>{const h=e.get("token");if(!h){a("error"),d(r.invalidToken);return}(async()=>{var g,x;try{const C=await(await fetch("https://restarter-backend-6e9s.onrender.com/api/email-verification/confirm-registration",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:h})})).json();if(C.success){const{email:_,registrationData:I}=C,T=await R0(q3,_,I.password);await af(T.user,{displayName:I.nickname}),await Ed(Vn(Wt,"profiles",T.user.uid),{nickname:I.nickname,email:_,avatar:"",gender:I.gender,country:I.country,region:I.region,age:I.age,interest:I.interest,eventType:I.eventType,improvement:I.improvement,createdAt:new Date,updatedAt:new Date}),a("success"),d(r.success),setTimeout(()=>{n("/")},3e3)}else a("error"),d(C.error||r.error)}catch(S){console.error("確認註冊錯誤:",S),a("error"),(g=S==null?void 0:S.message)!=null&&g.includes("Failed to fetch")||(x=S==null?void 0:S.message)!=null&&x.includes("NetworkError")?d(r.networkError):d((S==null?void 0:S.message)||r.error)}})()},[e,n,r]),i.jsx("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},children:i.jsxs("div",{style:{background:"white",borderRadius:"16px",padding:"40px",boxShadow:"0 20px 40px rgba(0, 0, 0, 0.1)",textAlign:"center",maxWidth:"400px",width:"90%"},children:[i.jsxs("div",{style:{marginBottom:"24px"},children:[o==="confirming"&&i.jsx("div",{style:{fontSize:"48px",marginBottom:"16px"},children:"⏳"}),o==="success"&&i.jsx("div",{style:{fontSize:"48px",marginBottom:"16px"},children:"✅"}),o==="error"&&i.jsx("div",{style:{fontSize:"48px",marginBottom:"16px"},children:"❌"}),i.jsxs("h1",{style:{color:o==="success"?"#10b981":o==="error"?"#ef4444":"#6B5BFF",fontSize:"24px",fontWeight:"bold",marginBottom:"8px"},children:[o==="confirming"&&r.confirming,o==="success"&&r.success,o==="error"&&r.error]}),i.jsx("p",{style:{color:"#666",fontSize:"16px",lineHeight:"1.5"},children:c})]}),o==="success"&&i.jsx("div",{style:{background:"#f0f9ff",padding:"16px",borderRadius:"8px",border:"1px solid #0ea5e9",marginTop:"16px"},children:i.jsx("p",{style:{color:"#0c4a6e",fontSize:"14px"},children:r.redirecting})}),o==="error"&&i.jsx("button",{onClick:()=>n("/register"),style:{background:"linear-gradient(90deg, #6e8efb, #a777e3)",color:"white",border:"none",padding:"12px 24px",borderRadius:"8px",fontSize:"16px",fontWeight:"bold",cursor:"pointer",marginTop:"16px"},children:"返回註冊頁面"})]})})}const $3=[{name:"免費版",price:"NT$0",period:"永久免費",features:["❌ 無語音功能權限","❌ 無權限使用OpenAI API功能","❌ 無法與其他使用者互動","✅ 基礎功能使用15次/月","💰 成本限制: NT$0/月"],highlight:!1,buttonText:"立即註冊",buttonAction:"register"},{name:"基礎版",price:"NT$149",period:"/月 或 NT$1490/年",features:["🤖 AI Token 限制: 50K tokens/月","👥 用戶互動: 100次/月","💬 留言/里程碑/AI聊天: 各30次/月","🎯 基礎功能: 300次/月","⚡ Token 用完僅暫停語音功能"],highlight:!0,buttonText:"選擇基礎版",buttonAction:"basic"},{name:"進階版",price:"NT$249",period:"/月 或 NT$2490/年",features:["🤖 AI Token 限制: 100K tokens/月","👥 用戶互動: 300次/月","💬 留言/里程碑/AI聊天: 各80次/月","🎯 基礎功能: 600次/月","⚡ Token 用完僅暫停語音功能"],highlight:!1,buttonText:"選擇進階版",buttonAction:"advanced"},{name:"專業版",price:"NT$349",period:"/月 或 NT$3490/年",features:["🤖 AI Token 限制: 200K tokens/月","👥 用戶互動: 800次/月","💬 留言/里程碑/AI聊天: 各150次/月","🎯 基礎功能: 1000次/月","⚡ Token 用完僅暫停語音功能"],highlight:!1,buttonText:"選擇專業版",buttonAction:"professional"},{name:"無限版",price:"NT$499",period:"/月 或 NT$4990/年",features:["🤖 AI Token 限制: 500K tokens/月","♾️ 用戶互動: 無限制","♾️ 留言/里程碑/AI聊天: 無限制","♾️ 基礎功能: 無限制","⚡ 僅受 Token 上限限制"],highlight:!1,buttonText:"選擇無限版",buttonAction:"unlimited"}],G3=["選擇適合您的訂閱方案","完成付款（支援信用卡/Apple Pay/Google Pay）","付款成功後自動升級，立即享有所有訂閱權益"],K3=[{q:"升級後可以隨時取消嗎？",a:"可以，訂閱會員可隨時取消，權益將保留至本期結束。"},{q:"付款方式有哪些？",a:"支援信用卡、Apple Pay、Google Pay 等多種方式。"},{q:"各版本的AI功能限制是什麼？",a:"Token 用完僅暫停語音功能，文字功能可繼續使用至各自限制。各功能獨立檢查使用次數。"},{q:"Token 用完可以續購嗎？",a:"可以！Token 用完但未滿一個月時，可以續購並從今天重新計算使用期，更划算。"},{q:"無限版真的無限制嗎？",a:"無限版除了AI Token上限外，其他功能都無限制使用。"},{q:"可以中途升級或降級嗎？",a:"可以，升級立即生效，降級將在當前週期結束後生效。"}];function Q3(){const n=_t(),t=St().currentUser;localStorage.getItem("lang");const[r,o]=v.useState(!1),[a,c]=v.useState(null),d=h=>{if(!t){o(!0);return}c(h),n(`/payment?plan=${h.buttonAction}`)};return i.jsxs("div",{style:{fontFamily:"-apple-system,BlinkMacSystemFont,sans-serif",background:"#f7f8fc",minHeight:"100vh",padding:"32px 0"},children:[i.jsx("button",{onClick:()=>n("/"),style:{position:"absolute",top:24,left:24,zIndex:10,background:"#fff",border:"1.5px solid #6B5BFF",color:"#6B5BFF",borderRadius:8,padding:"6px 18px",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:"0 2px 8px #0001"},children:"← 返回"}),i.jsxs("div",{style:{maxWidth:1200,margin:"0 auto",background:"#fff",borderRadius:18,boxShadow:"0 4px 24px #6B5BFF22",padding:32},children:[i.jsx("h1",{style:{fontSize:36,fontWeight:900,letterSpacing:2,background:"linear-gradient(90deg,#6B5BFF,#00CFFF)",WebkitBackgroundClip:"text",color:"transparent",marginBottom:24,textAlign:"center"},children:"Restarter 訂閱方案"}),i.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(280px, 1fr))",gap:24,marginBottom:32},children:$3.map((h,m)=>i.jsxs("div",{style:{background:h.highlight?"linear-gradient(135deg, #f3f7ff 0%, #e8f4ff 100%)":"#fff",border:h.highlight?"2px solid #6B5BFF":"1px solid #e0e0e0",borderRadius:16,padding:24,position:"relative",boxShadow:h.highlight?"0 8px 32px #6B5BFF22":"0 4px 16px #0001",transition:"all 0.3s ease",cursor:"pointer"},onClick:()=>d(h),children:[h.highlight&&i.jsx("div",{style:{position:"absolute",top:-12,left:"50%",transform:"translateX(-50%)",background:"#6B5BFF",color:"#fff",padding:"4px 16px",borderRadius:12,fontSize:14,fontWeight:700},children:"推薦方案"}),i.jsx("h3",{style:{fontSize:24,fontWeight:800,color:h.highlight?"#6B5BFF":"#333",marginBottom:8,textAlign:"center"},children:h.name}),i.jsxs("div",{style:{textAlign:"center",marginBottom:20},children:[i.jsx("span",{style:{fontSize:32,fontWeight:900,color:h.highlight?"#6B5BFF":"#333"},children:h.price}),i.jsx("span",{style:{fontSize:16,color:"#666"},children:h.period})]}),i.jsx("ul",{style:{margin:0,padding:0,listStyle:"none"},children:h.features.map((g,x)=>i.jsx("li",{style:{marginBottom:12,fontSize:14,lineHeight:1.5,color:"#555",display:"flex",alignItems:"flex-start",gap:8},children:i.jsx("span",{style:{fontSize:16,marginTop:1},children:g})},x))}),i.jsx("button",{style:{width:"100%",background:h.highlight?"linear-gradient(90deg, #6B5BFF, #00CFFF)":"#f0f0f0",color:h.highlight?"#fff":"#666",border:"none",borderRadius:8,padding:"12px 0",fontSize:16,fontWeight:700,cursor:"pointer",marginTop:20,transition:"all 0.2s ease"},children:h.buttonText})]},h.name))}),i.jsx("h2",{style:{fontSize:24,fontWeight:800,margin:"32px 0 12px",color:"#6B5BFF"},children:"升級流程"}),i.jsx("ol",{style:{fontSize:18,lineHeight:1.8,marginBottom:32,paddingLeft:24},children:G3.map((h,m)=>i.jsx("li",{children:h},m))}),i.jsx("h2",{style:{fontSize:24,fontWeight:800,margin:"32px 0 12px",color:"#6B5BFF"},children:"常見問題"}),i.jsx("div",{style:{marginBottom:32},children:K3.map((h,m)=>i.jsxs("div",{style:{marginBottom:18},children:[i.jsx("div",{style:{fontWeight:700,fontSize:18,color:"#6B5BFF"},children:h.q}),i.jsx("div",{style:{fontSize:17,color:"#444",marginLeft:8,marginTop:2},children:h.a})]},m))}),i.jsx("div",{style:{display:"flex",justifyContent:"center",marginTop:32},children:i.jsx("a",{href:"/register",style:{background:"#00CFFF",color:"#fff",fontWeight:700,fontSize:20,padding:"14px 38px",borderRadius:10,boxShadow:"0 2px 8px #00CFFF33",textDecoration:"none",transition:"0.2s"},children:"立即註冊免費版"})}),r&&i.jsx("div",{style:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",background:"rgba(0,0,0,0.5)",zIndex:9999,display:"flex",alignItems:"center",justifyContent:"center"},children:i.jsxs("div",{style:{background:"#fff",borderRadius:20,padding:32,boxShadow:"0 8px 32px rgba(0,0,0,0.2)",minWidth:380,textAlign:"center"},children:[i.jsx("div",{style:{fontSize:48,marginBottom:16,color:"#6B5BFF"},children:"🎯"}),i.jsx("div",{style:{fontSize:22,fontWeight:700,color:"#6B5BFF",marginBottom:12},children:"歡迎加入 Restarter！"}),i.jsx("div",{style:{fontSize:16,color:"#666",marginBottom:20,lineHeight:1.5},children:"註冊後即可選擇適合您的訂閱方案，開始您的重啟之旅"}),i.jsxs("div",{style:{background:"linear-gradient(135deg, #f8f9ff 0%, #e8f4ff 100%)",borderRadius:12,padding:16,marginBottom:24,border:"1px solid #e0e8ff"},children:[i.jsx("div",{style:{fontSize:14,color:"#6B5BFF",fontWeight:600,marginBottom:8},children:"💡 註冊好處"}),i.jsxs("div",{style:{fontSize:13,color:"#666",lineHeight:1.4},children:["• 免費體驗基礎功能",i.jsx("br",{}),"• 個人化使用記錄",i.jsx("br",{}),"• 安全可靠的服務"]})]}),i.jsxs("div",{style:{display:"flex",gap:12,justifyContent:"center"},children:[i.jsx("button",{onClick:()=>{o(!1),n("/register")},style:{background:"linear-gradient(135deg, #6B5BFF 0%, #00CFFF 100%)",color:"#fff",border:"none",borderRadius:12,padding:"12px 28px",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:"0 4px 12px #6B5BFF33",transition:"all 0.3s ease"},onMouseEnter:h=>{h.currentTarget.style.transform="translateY(-2px)",h.currentTarget.style.boxShadow="0 6px 16px #6B5BFF44"},onMouseLeave:h=>{h.currentTarget.style.transform="translateY(0)",h.currentTarget.style.boxShadow="0 4px 12px #6B5BFF33"},children:"🚀 立即註冊"}),i.jsx("button",{onClick:()=>o(!1),style:{background:"#f8f9ff",color:"#6B5BFF",border:"2px solid #6B5BFF",borderRadius:12,padding:"12px 28px",fontWeight:600,fontSize:16,cursor:"pointer",transition:"all 0.3s ease"},onMouseEnter:h=>{h.currentTarget.style.background="#6B5BFF",h.currentTarget.style.color="#fff"},onMouseLeave:h=>{h.currentTarget.style.background="#f8f9ff",h.currentTarget.style.color="#6B5BFF"},children:"💭 稍後再說"})]})]})})]})]})}const ck={basic:{name:"基礎版",price:"NT$149",period:"/月",features:["🤖 AI Token 限制: 50K tokens/月","👥 用戶互動: 100次/月","💬 留言/里程碑/AI聊天: 各30次/月","🎯 基礎功能: 300次/月"],buttonAction:"basic"},advanced:{name:"進階版",price:"NT$249",period:"/月",features:["🤖 AI Token 限制: 100K tokens/月","👥 用戶互動: 300次/月","💬 留言/里程碑/AI聊天: 各80次/月","🎯 基礎功能: 600次/月"],buttonAction:"advanced"},professional:{name:"專業版",price:"NT$349",period:"/月",features:["🤖 AI Token 限制: 200K tokens/月","👥 用戶互動: 800次/月","💬 留言/里程碑/AI聊天: 各150次/月","🎯 基礎功能: 1000次/月"],buttonAction:"professional"},unlimited:{name:"無限版",price:"NT$499",period:"/月",features:["🤖 AI Token 限制: 500K tokens/月","♾️ 用戶互動: 無限制","♾️ 留言/里程碑/AI聊天: 無限制","♾️ 基礎功能: 無限制"],buttonAction:"unlimited"}};function Y3(){const n=_t(),[e]=Sk(),r=St().currentUser,[o,a]=v.useState(null),[c,d]=v.useState("credit"),[h,m]=v.useState(!1),[g,x]=v.useState(!1);v.useEffect(()=>{const C=e.get("plan");C&&ck[C]?a(ck[C]):n("/plans")},[e,n]);const S=async()=>{if(!r){n("/login");return}m(!0),setTimeout(()=>{m(!1),x(!0),setTimeout(()=>{n("/")},3e3)},2e3)};return o?i.jsxs("div",{style:{fontFamily:"-apple-system,BlinkMacSystemFont,sans-serif",background:"#f7f8fc",minHeight:"100vh",padding:"32px 0"},children:[i.jsx("button",{onClick:()=>n("/plans"),style:{position:"absolute",top:24,left:24,zIndex:10,background:"#fff",border:"1.5px solid #6B5BFF",color:"#6B5BFF",borderRadius:8,padding:"6px 18px",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:"0 2px 8px #0001"},children:"← 返回"}),i.jsxs("div",{style:{maxWidth:600,margin:"0 auto",background:"#fff",borderRadius:18,boxShadow:"0 4px 24px #6B5BFF22",padding:32},children:[i.jsx("h1",{style:{fontSize:32,fontWeight:900,letterSpacing:2,background:"linear-gradient(90deg,#6B5BFF,#00CFFF)",WebkitBackgroundClip:"text",color:"transparent",marginBottom:24,textAlign:"center"},children:"完成訂閱"}),i.jsxs("div",{style:{background:"#f8f9ff",borderRadius:12,padding:24,marginBottom:32},children:[i.jsx("h2",{style:{fontSize:20,fontWeight:700,color:"#6B5BFF",marginBottom:16},children:"選擇的方案"}),i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[i.jsx("span",{style:{fontSize:18,fontWeight:600},children:o.name}),i.jsxs("span",{style:{fontSize:24,fontWeight:900,color:"#6B5BFF"},children:[o.price,o.period]})]}),i.jsx("ul",{style:{margin:0,padding:0,listStyle:"none"},children:o.features.map((C,_)=>i.jsxs("li",{style:{marginBottom:8,fontSize:14,color:"#666"},children:["• ",C]},_))})]}),i.jsxs("div",{style:{marginBottom:32},children:[i.jsx("h2",{style:{fontSize:20,fontWeight:700,color:"#6B5BFF",marginBottom:16},children:"付款方式"}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:12},children:[i.jsxs("label",{style:{display:"flex",alignItems:"center",gap:12,cursor:"pointer"},children:[i.jsx("input",{type:"radio",name:"payment",value:"credit",checked:c==="credit",onChange:C=>d(C.target.value),style:{width:18,height:18}}),i.jsx("span",{style:{fontSize:16},children:"💳 信用卡"})]}),i.jsxs("label",{style:{display:"flex",alignItems:"center",gap:12,cursor:"pointer"},children:[i.jsx("input",{type:"radio",name:"payment",value:"apple",checked:c==="apple",onChange:C=>d(C.target.value),style:{width:18,height:18}}),i.jsx("span",{style:{fontSize:16},children:"🍎 Apple Pay"})]}),i.jsxs("label",{style:{display:"flex",alignItems:"center",gap:12,cursor:"pointer"},children:[i.jsx("input",{type:"radio",name:"payment",value:"google",checked:c==="google",onChange:C=>d(C.target.value),style:{width:18,height:18}}),i.jsx("span",{style:{fontSize:16},children:"🤖 Google Pay"})]})]})]}),i.jsx("button",{onClick:S,disabled:h,style:{width:"100%",background:h?"#ccc":"linear-gradient(90deg,#6B5BFF,#00CFFF)",color:"#fff",border:"none",borderRadius:12,padding:"16px 0",fontSize:18,fontWeight:700,cursor:h?"not-allowed":"pointer",transition:"all 0.2s ease"},children:h?"處理中...":`立即付款 ${o.price}`}),g&&i.jsx("div",{style:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",background:"#0008",zIndex:9999,display:"flex",alignItems:"center",justifyContent:"center"},children:i.jsxs("div",{style:{background:"#fff",borderRadius:16,padding:32,boxShadow:"0 4px 24px #0002",minWidth:320,textAlign:"center"},children:[i.jsx("div",{style:{fontSize:48,marginBottom:16},children:"✅"}),i.jsx("div",{style:{fontSize:20,fontWeight:700,color:"#6B5BFF",marginBottom:8},children:"付款成功！"}),i.jsx("div",{style:{fontSize:16,color:"#666",marginBottom:16},children:"您的訂閱已生效，即將跳轉到首頁..."})]})})]})]}):i.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"},children:i.jsx("div",{children:"載入中..."})})}const ly={basic:{name:"基礎版",price:"NT$ 149",period:"/月",features:["🤖 AI Token 限制: 50K tokens/月","👥 用戶互動: 100次/月","💬 留言/里程碑/AI聊天: 各30次/月","🎯 基礎功能: 300次/月","⚡ Token 用完僅暫停語音功能"],stripeLink:"https://buy.stripe.com/your_basic_monthly_link",paypalLink:"https://www.paypal.com/your_basic_monthly_link",ecpayLink:"https://payment.ecpay.com.tw/your_basic_monthly_link",newebpayLink:"https://ccore.newebpay.com/your_basic_monthly_link"},advanced:{name:"進階版",price:"NT$ 249",period:"/月",features:["🤖 AI Token 限制: 100K tokens/月","👥 用戶互動: 300次/月","💬 留言/里程碑/AI聊天: 各80次/月","🎯 基礎功能: 600次/月","⚡ Token 用完僅暫停語音功能"],stripeLink:"https://buy.stripe.com/your_advanced_monthly_link",paypalLink:"https://www.paypal.com/your_advanced_monthly_link",ecpayLink:"https://payment.ecpay.com.tw/your_advanced_monthly_link",newebpayLink:"https://ccore.newebpay.com/your_advanced_monthly_link"},professional:{name:"專業版",price:"NT$ 349",period:"/月",features:["🤖 AI Token 限制: 200K tokens/月","👥 用戶互動: 800次/月","💬 留言/里程碑/AI聊天: 各150次/月","🎯 基礎功能: 1000次/月","⚡ Token 用完僅暫停語音功能"],stripeLink:"https://buy.stripe.com/your_professional_monthly_link",paypalLink:"https://www.paypal.com/your_professional_monthly_link",ecpayLink:"https://payment.ecpay.com.tw/your_professional_monthly_link",newebpayLink:"https://ccore.newebpay.com/your_professional_monthly_link"},unlimited:{name:"無限版",price:"NT$ 499",period:"/月",features:["🤖 AI Token 限制: 500K tokens/月","♾️ 用戶互動: 無限制","♾️ 留言/里程碑/AI聊天: 無限制","♾️ 基礎功能: 無限制","⚡ 僅受 Token 上限限制"],stripeLink:"https://buy.stripe.com/your_unlimited_monthly_link",paypalLink:"https://www.paypal.com/your_unlimited_monthly_link",ecpayLink:"https://payment.ecpay.com.tw/your_unlimited_monthly_link",newebpayLink:"https://ccore.newebpay.com/your_unlimited_monthly_link"}};function X3(){const n=_t(),t=St().currentUser,[r,o]=v.useState(!1),[a,c]=v.useState("basic"),[d,h]=v.useState("stripe"),[m,g]=v.useState(!1),[x,S]=v.useState(null);localStorage.getItem("lang");const C=()=>{if(!t){o(!0);return}const F=ly[a],P=F[`${d}Link`];P&&!P.includes("your_")?_():alert(`請聯絡客服完成付款設定

選擇方案：${F.name}
付款方式：${d==="stripe"?"Stripe":d==="paypal"?"PayPal":d==="ecpay"?"綠界":"藍新"}

客服 Email：support@restarter.com`)},_=async()=>{if(t)try{const F=`TXN_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,P=await fetch("/api/subscription/payment-success",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:t.uid,plan:a,paymentMethod:d,transactionId:F,amount:I(a),currency:"TWD"})});if(P.ok){const B=await P.json();S(B),g(!0),setTimeout(()=>{n("/home")},3e3)}else alert("付款處理失敗，請聯絡客服")}catch(F){console.error("付款處理錯誤:",F),alert("付款處理失敗，請聯絡客服")}},I=F=>({basic:149,advanced:249,professional:349,unlimited:499})[F]||0,T=F=>({basic:"基礎版",advanced:"進階版",professional:"專業版",unlimited:"無限版"})[F]||F;return i.jsxs("div",{style:{minHeight:"100vh",background:"#f7faff",padding:0,overflowY:"auto"},children:[i.jsx("button",{onClick:()=>n("/plans"),style:{position:"absolute",top:24,left:24,zIndex:10,background:"#fff",border:"1.5px solid #6B5BFF",color:"#6B5BFF",borderRadius:8,padding:"6px 18px",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:"0 2px 8px #0001"},children:"← 返回"}),i.jsx("div",{style:{maxWidth:900,margin:"0 auto",padding:"80px 24px 32px"},children:i.jsxs("div",{style:{background:"#fff",borderRadius:18,boxShadow:"0 4px 24px #6B5BFF11",padding:"32px 24px"},children:[i.jsx("h2",{style:{color:"#4B5BFF",fontWeight:900,fontSize:32,marginBottom:8,letterSpacing:2,textAlign:"center"},children:"升級訂閱"}),i.jsx("p",{style:{color:"#666",fontSize:18,textAlign:"center",marginBottom:32},children:"選擇最適合您的訂閱方案，立即享有完整功能"}),i.jsx("div",{style:{display:"flex",gap:24,marginBottom:32,justifyContent:"center"},children:Object.entries(ly).map(([F,P])=>i.jsxs("div",{onClick:()=>c(F),style:{background:a===F?"#6B5BFF":"#fff",color:a===F?"#fff":"#333",border:`2px solid ${a===F?"#6B5BFF":"#ddd"}`,borderRadius:12,padding:"24px",cursor:"pointer",minWidth:200,textAlign:"center",transition:"all 0.3s ease"},children:[i.jsx("div",{style:{fontWeight:700,fontSize:20,marginBottom:8},children:P.name}),i.jsxs("div",{style:{fontSize:32,fontWeight:900,marginBottom:4},children:[P.price,i.jsx("span",{style:{fontSize:16,fontWeight:400},children:P.period})]}),P.originalPrice&&i.jsx("div",{style:{fontSize:14,textDecoration:"line-through",opacity:.7,marginBottom:4},children:P.originalPrice}),P.discount&&i.jsx("div",{style:{fontSize:14,color:"#ff6b6b",fontWeight:700},children:P.discount})]},F))}),i.jsxs("div",{style:{marginBottom:32},children:[i.jsx("h3",{style:{color:"#333",fontWeight:700,fontSize:20,marginBottom:16},children:"選擇付款方式"}),i.jsx("div",{style:{display:"flex",gap:16,flexWrap:"wrap"},children:[{key:"stripe",name:"Stripe",icon:"💳"},{key:"paypal",name:"PayPal",icon:"🔵"},{key:"ecpay",name:"綠界",icon:"🟢"},{key:"newebpay",name:"藍新",icon:"🔵"}].map(F=>i.jsxs("button",{onClick:()=>h(F.key),style:{background:d===F.key?"#6B5BFF":"#fff",color:d===F.key?"#fff":"#333",border:`2px solid ${d===F.key?"#6B5BFF":"#ddd"}`,borderRadius:8,padding:"12px 20px",cursor:"pointer",fontSize:16,fontWeight:600,transition:"all 0.3s ease"},children:[F.icon," ",F.name]},F.key))})]}),i.jsxs("div",{style:{marginBottom:32},children:[i.jsx("h3",{style:{color:"#333",fontWeight:700,fontSize:20,marginBottom:16},children:"訂閱權益"}),i.jsx("div",{style:{display:"grid",gap:12},children:ly[a].features.map((F,P)=>i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[i.jsx("span",{style:{color:"#6B5BFF",fontSize:18},children:"✓"}),i.jsx("span",{style:{color:"#333",fontSize:16},children:F})]},P))})]}),i.jsx("div",{style:{textAlign:"center",marginTop:24},children:i.jsx("button",{onClick:C,style:{background:"linear-gradient(90deg,#6B5BFF 60%,#23c6e6 100%)",color:"#fff",border:"none",borderRadius:12,fontWeight:900,fontSize:20,padding:"12px 48px",boxShadow:"0 2px 12px #6B5BFF33",letterSpacing:2,cursor:"pointer"},children:"立即升級"})}),i.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:24,marginTop:32},children:[i.jsx("button",{onClick:()=>n("/payment-info"),style:{background:"#fff",color:"#6B5BFF",border:"1.5px solid #6B5BFF",borderRadius:8,padding:"10px 32px",fontWeight:600,cursor:"pointer"},children:"付款說明"}),i.jsx("button",{onClick:()=>n("/contact"),style:{background:"#fff",color:"#6B5BFF",border:"1.5px solid #6B5BFF",borderRadius:8,padding:"10px 32px",fontWeight:600,cursor:"pointer"},children:"聯絡客服"})]})]})}),r&&i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:i.jsxs("div",{style:{background:"#fff",borderRadius:20,padding:32,maxWidth:450,textAlign:"center",boxShadow:"0 8px 32px rgba(0,0,0,0.2)"},children:[i.jsx("div",{style:{fontSize:48,marginBottom:16,color:"#6B5BFF"},children:"🎯"}),i.jsx("h3",{style:{color:"#6B5BFF",fontWeight:700,fontSize:22,marginBottom:12},children:"歡迎加入 Restarter！"}),i.jsx("p",{style:{color:"#666",marginBottom:20,lineHeight:1.5,fontSize:16},children:"註冊後即可選擇適合您的訂閱方案，開始您的重啟之旅"}),i.jsxs("div",{style:{background:"linear-gradient(135deg, #f8f9ff 0%, #e8f4ff 100%)",borderRadius:12,padding:16,marginBottom:24,border:"1px solid #e0e8ff"},children:[i.jsx("div",{style:{fontSize:14,color:"#6B5BFF",fontWeight:600,marginBottom:8},children:"💡 註冊好處"}),i.jsxs("div",{style:{fontSize:13,color:"#666",lineHeight:1.4},children:["• 免費體驗基礎功能",i.jsx("br",{}),"• 個人化使用記錄",i.jsx("br",{}),"• 安全可靠的服務"]})]}),i.jsxs("div",{style:{display:"flex",gap:12,justifyContent:"center"},children:[i.jsx("button",{onClick:()=>n("/register"),style:{background:"linear-gradient(135deg, #6B5BFF 0%, #00CFFF 100%)",color:"#fff",border:"none",borderRadius:12,padding:"12px 28px",fontWeight:700,cursor:"pointer",fontSize:16,boxShadow:"0 4px 12px #6B5BFF33",transition:"all 0.3s ease"},onMouseEnter:F=>{F.currentTarget.style.transform="translateY(-2px)",F.currentTarget.style.boxShadow="0 6px 16px #6B5BFF44"},onMouseLeave:F=>{F.currentTarget.style.transform="translateY(0)",F.currentTarget.style.boxShadow="0 4px 12px #6B5BFF33"},children:"🚀 立即註冊"}),i.jsx("button",{onClick:()=>o(!1),style:{background:"#f8f9ff",color:"#6B5BFF",border:"2px solid #6B5BFF",borderRadius:12,padding:"12px 28px",fontWeight:600,cursor:"pointer",fontSize:16,transition:"all 0.3s ease"},onMouseEnter:F=>{F.currentTarget.style.background="#6B5BFF",F.currentTarget.style.color="#fff"},onMouseLeave:F=>{F.currentTarget.style.background="#f8f9ff",F.currentTarget.style.color="#6B5BFF"},children:"💭 稍後再說"})]})]})}),m&&x&&i.jsx("div",{style:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",background:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e4},children:i.jsxs("div",{style:{background:"#fff",borderRadius:20,padding:32,maxWidth:480,width:"90%",textAlign:"center",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.2)"},children:[i.jsx("div",{style:{fontSize:64,marginBottom:16,color:"#52c41a"},children:"✅"}),i.jsx("h2",{style:{fontSize:24,fontWeight:700,color:"#333",marginBottom:12},children:"付款成功！"}),i.jsx("p",{style:{fontSize:16,color:"#666",marginBottom:20,lineHeight:1.6},children:x.message}),i.jsxs("div",{style:{background:"linear-gradient(135deg, #f6ffed 0%, #d9f7be 100%)",borderRadius:12,padding:16,marginBottom:24,border:"1px solid #b7eb8f"},children:[i.jsx("div",{style:{fontSize:14,color:"#52c41a",fontWeight:600,marginBottom:8},children:"🎉 訂閱詳情"}),i.jsxs("div",{style:{fontSize:13,color:"#666",lineHeight:1.4},children:["• 方案：",T(a),i.jsx("br",{}),"• 剩餘天數：",x.remainingDays," 天",i.jsx("br",{}),"• AI Token：",x.plan.limits.aiCostLimit,"K tokens",i.jsx("br",{}),"• 立即生效，可開始使用所有 AI 功能"]})]}),i.jsx("div",{style:{display:"flex",gap:12,justifyContent:"center"},children:i.jsx("button",{onClick:()=>n("/home"),style:{background:"linear-gradient(135deg, #52c41a 0%, #73d13d 100%)",color:"#fff",border:"none",borderRadius:12,padding:"14px 28px",fontSize:16,fontWeight:700,cursor:"pointer",flex:1,boxShadow:"0 4px 12px #52c41a33",transition:"all 0.3s ease"},onMouseEnter:F=>{F.currentTarget.style.transform="translateY(-2px)",F.currentTarget.style.boxShadow="0 6px 16px #52c41a44"},onMouseLeave:F=>{F.currentTarget.style.transform="translateY(0)",F.currentTarget.style.boxShadow="0 4px 12px #52c41a33"},children:"🚀 立即開始使用"})}),i.jsx("div",{style:{marginTop:16,fontSize:14,color:"#888"},children:"3秒後自動跳轉到首頁..."})]})})]})}function J3(){const n=_t(),t=St().currentUser;return localStorage.getItem("lang"),t?i.jsxs("div",{style:{minHeight:"100vh",background:"#f7faff",padding:0},children:[i.jsx("button",{onClick:()=>n("/"),style:{position:"absolute",top:24,left:24,zIndex:10,background:"#fff",border:"1.5px solid #6B5BFF",color:"#6B5BFF",borderRadius:8,padding:"6px 18px",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:"0 2px 8px #0001"},children:"← 返回首頁"}),i.jsxs("div",{style:{maxWidth:500,margin:"0 auto",background:"#fff",borderRadius:18,boxShadow:"0 4px 24px #6B5BFF11",padding:"32px 24px",marginTop:64,textAlign:"center"},children:[i.jsx("img",{src:t.photoURL||"/avatars/Derxl.png",alt:"avatar",style:{width:88,height:88,borderRadius:"50%",objectFit:"cover",border:"2px solid #ececff",background:"#eee",marginBottom:18}}),i.jsx("div",{style:{fontSize:24,fontWeight:900,color:"#6B5BFF",marginBottom:8},children:t.displayName||t.email||"用戶"}),i.jsx("div",{style:{fontSize:16,color:"#888",marginBottom:18},children:t.email}),i.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:18,marginTop:24},children:[i.jsx("button",{onClick:()=>n("/CompleteProfile"),style:{background:"#00CFFF",color:"#fff",fontWeight:700,fontSize:18,padding:"10px 32px",borderRadius:10,boxShadow:"0 2px 8px #00CFFF33",border:"none",cursor:"pointer"},children:"編輯個人資料"}),i.jsx("button",{onClick:()=>n("/upgrade"),style:{background:"#6B5BFF",color:"#fff",fontWeight:700,fontSize:18,padding:"10px 32px",borderRadius:10,boxShadow:"0 2px 8px #6B5BFF33",border:"none",cursor:"pointer"},children:"升級訂閱"})]})]})]}):i.jsx("div",{style:{minHeight:"100vh",background:"#f7faff",display:"flex",alignItems:"center",justifyContent:"center"},children:i.jsxs("div",{style:{background:"#fff",borderRadius:16,padding:32,boxShadow:"0 4px 24px #0002",minWidth:320,textAlign:"center"},children:[i.jsx("div",{style:{fontSize:20,fontWeight:700,color:"#6B5BFF",marginBottom:18},children:"請先註冊/登入才能進入個人中心"}),i.jsx("button",{onClick:()=>n("/register"),style:{background:"#6B5BFF",color:"#fff",border:"none",borderRadius:8,padding:"8px 32px",fontWeight:700,fontSize:18,cursor:"pointer",marginTop:8},children:"前往註冊/登入"})]})})}function Z3(){const n=_t();return i.jsxs("div",{style:{minHeight:"100vh",background:"#f7faff",padding:0},children:[i.jsx("button",{onClick:()=>n("/upgrade"),style:{position:"absolute",top:24,left:24,zIndex:10,background:"#fff",border:"1.5px solid #6B5BFF",color:"#6B5BFF",borderRadius:8,padding:"6px 18px",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:"0 2px 8px #0001"},children:"← 返回"}),i.jsx("div",{style:{maxWidth:900,margin:"0 auto",padding:"80px 24px 32px"},children:i.jsxs("div",{style:{background:"#fff",borderRadius:18,boxShadow:"0 4px 24px #6B5BFF11",padding:"32px 24px"},children:[i.jsx("h2",{style:{color:"#4B5BFF",fontWeight:900,fontSize:32,marginBottom:8,letterSpacing:2,textAlign:"center"},children:"付款設定說明"}),i.jsx("p",{style:{color:"#666",fontSize:18,textAlign:"center",marginBottom:32},children:"了解如何設定付款方式與完成訂閱"}),i.jsxs("div",{style:{marginBottom:32},children:[i.jsx("h3",{style:{color:"#333",fontWeight:700,fontSize:20,marginBottom:16},children:"支援的付款方式"}),i.jsxs("div",{style:{display:"grid",gap:16},children:[i.jsxs("div",{style:{border:"1px solid #e0e7ff",borderRadius:12,padding:20},children:[i.jsx("h4",{style:{color:"#6B5BFF",fontWeight:700,fontSize:18,marginBottom:8},children:"💳 Stripe"}),i.jsx("p",{style:{color:"#666",fontSize:16,lineHeight:1.6},children:"國際信用卡支付，支援 Visa、Mastercard、American Express 等主要信用卡。"})]}),i.jsxs("div",{style:{border:"1px solid #e0e7ff",borderRadius:12,padding:20},children:[i.jsx("h4",{style:{color:"#6B5BFF",fontWeight:700,fontSize:18,marginBottom:8},children:"🔵 PayPal"}),i.jsx("p",{style:{color:"#666",fontSize:16,lineHeight:1.6},children:"國際電子錢包，支援 PayPal 帳戶或信用卡付款。"})]}),i.jsxs("div",{style:{border:"1px solid #e0e7ff",borderRadius:12,padding:20},children:[i.jsx("h4",{style:{color:"#6B5BFF",fontWeight:700,fontSize:18,marginBottom:8},children:"🟢 綠界"}),i.jsx("p",{style:{color:"#666",fontSize:16,lineHeight:1.6},children:"台灣本地支付，支援信用卡、ATM 轉帳、超商付款等。"})]}),i.jsxs("div",{style:{border:"1px solid #e0e7ff",borderRadius:12,padding:20},children:[i.jsx("h4",{style:{color:"#6B5BFF",fontWeight:700,fontSize:18,marginBottom:8},children:"🔵 藍新"}),i.jsx("p",{style:{color:"#666",fontSize:16,lineHeight:1.6},children:"台灣本地支付，支援信用卡、ATM 轉帳、超商付款等。"})]})]})]}),i.jsxs("div",{style:{marginBottom:32},children:[i.jsx("h3",{style:{color:"#333",fontWeight:700,fontSize:20,marginBottom:16},children:"付款設定步驟"}),i.jsxs("ol",{style:{fontSize:16,lineHeight:1.8,paddingLeft:24},children:[i.jsx("li",{children:"選擇您想要的訂閱方案（月費或年費）"}),i.jsx("li",{children:"選擇付款方式（Stripe、PayPal、綠界、藍新）"}),i.jsx("li",{children:"點擊「立即升級」按鈕"}),i.jsx("li",{children:"系統會導向對應的付款頁面"}),i.jsx("li",{children:"完成付款後自動升級會員權益"})]})]}),i.jsxs("div",{style:{marginBottom:32},children:[i.jsx("h3",{style:{color:"#333",fontWeight:700,fontSize:20,marginBottom:16},children:"注意事項"}),i.jsxs("ul",{style:{fontSize:16,lineHeight:1.8,paddingLeft:24},children:[i.jsx("li",{children:"付款成功後，會員權益會立即生效"}),i.jsx("li",{children:"月費方案每月自動續費，年費方案每年自動續費"}),i.jsx("li",{children:"可隨時在會員中心取消自動續費"}),i.jsx("li",{children:"如有付款問題，請聯絡客服：support@restarter.com"})]})]}),i.jsx("div",{style:{textAlign:"center",marginTop:32},children:i.jsx("button",{onClick:()=>n("/upgrade"),style:{background:"linear-gradient(90deg,#6B5BFF 60%,#23c6e6 100%)",color:"#fff",border:"none",borderRadius:12,fontWeight:900,fontSize:20,padding:"12px 48px",boxShadow:"0 2px 12px #6B5BFF33",letterSpacing:2,cursor:"pointer"},children:"返回升級頁面"})})]})})]})}function eM(){const n=_t();return i.jsxs("div",{style:{minHeight:"100vh",background:"#f7faff",padding:0},children:[i.jsx("button",{onClick:()=>n("/plans"),style:{position:"absolute",top:24,left:24,zIndex:10,background:"#fff",border:"1.5px solid #6B5BFF",color:"#6B5BFF",borderRadius:8,padding:"6px 18px",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:"0 2px 8px #0001"},children:"← 返回"}),i.jsxs("div",{style:{maxWidth:600,margin:"0 auto",background:"#fff",borderRadius:18,boxShadow:"0 4px 24px #6B5BFF11",padding:"32px 24px",marginTop:64},children:[i.jsx("h2",{style:{color:"#4B5BFF",fontWeight:900,fontSize:32,marginBottom:24,letterSpacing:1},children:"聯絡客服"}),i.jsx("div",{style:{fontSize:18,color:"#333",marginBottom:24,lineHeight:1.8},children:"如有任何問題、付款疑問、升級需求，歡迎透過以下方式聯絡我們："}),i.jsxs("ul",{style:{fontSize:17,color:"#666",marginBottom:32,marginLeft:24},children:[i.jsxs("li",{children:["Email：",i.jsx("a",{href:"mailto:support@restarter.app",style:{color:"#6B5BFF",textDecoration:"underline"},children:"support@restarter.app"})]}),i.jsxs("li",{children:["LINE 客服：",i.jsx("a",{href:"https://line.me/R/ti/p/@restarter",target:"_blank",rel:"noopener noreferrer",style:{color:"#6B5BFF",textDecoration:"underline"},children:"@restarter"})]}),i.jsxs("li",{children:["Messenger：",i.jsx("a",{href:"https://m.me/restarterapp",target:"_blank",rel:"noopener noreferrer",style:{color:"#6B5BFF",textDecoration:"underline"},children:"Restarter 粉專"})]}),i.jsxs("li",{children:["線上表單：",i.jsx("a",{href:"https://forms.gle/xxxxxx",target:"_blank",rel:"noopener noreferrer",style:{color:"#6B5BFF",textDecoration:"underline"},children:"填寫表單"})]})]}),i.jsx("div",{style:{fontSize:16,color:"#888",marginTop:24},children:"客服回覆時間：週一至週五 10:00-18:00"})]})]})}function tM(){const n=_t();St();const{checkPermission:e,recordUsage:t}=Ls(),[r,o]=v.useState([]),[a,c]=v.useState(!1),[d,h]=v.useState("test-user-123"),m=I=>{o(T=>[...T,`${new Date().toLocaleTimeString()}: ${I}`])},g=async()=>{m("模擬登入測試用戶...");try{const I={uid:d,email:"test@example.com",displayName:"Test User"};return localStorage.setItem("testUser",JSON.stringify(I)),m("測試用戶已登入"),I}catch(I){return m(`登入失敗: ${I}`),null}},x=async()=>{c(!0),m("開始測試 Token 消耗功能...");try{await g();const I=await e("aiChat");if(m(`權限檢查結果: ${I.allowed?"允許":"拒絕"} - ${I.reason||"無原因"}`),I.allowed){await t("aiChat",5),m("已記錄 5 tokens 使用量");const T=await e("aiChat");if(m(`使用後權限檢查: ${T.allowed?"允許":"拒絕"}`),T.subscriptionData){const{usage:F,limits:P}=T.subscriptionData;m(`當前使用量: ${F.aiCost}/${P.aiCostLimit} tokens`),m(`剩餘 tokens: ${Math.max(0,P.aiCostLimit-F.aiCost)}`)}}else m("權限被拒絕，無法測試 token 消耗")}catch(I){m(`測試失敗: ${I}`)}finally{c(!1)}},S=async()=>{c(!0),m("開始測試達到限制功能...");try{await g();let I=0;const T=50;for(;I<T;){const F=await e("aiChat");if(!F.allowed){m(`達到限制！在第 ${I} 次嘗試後被拒絕`),m(`拒絕原因: ${F.reason}`);break}await t("aiChat",1),I++,I%10===0&&m(`已記錄 ${I} 次使用`)}I>=T&&m("達到最大測試次數，可能沒有設置限制")}catch(I){m(`測試失敗: ${I}`)}finally{c(!1)}},C=async()=>{c(!0),m("重置使用量...");try{await g();const I=await fetch("/api/subscription/reset-usage",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:d})});if(I.ok){const T=await I.json();m(`使用量已重置: ${T.message}`)}else{const T=await I.json();m(`重置失敗: ${T.error}`)}}catch(I){m(`重置失敗: ${I}`)}finally{c(!1)}},_=async()=>{m("獲取當前訂閱狀態...");try{await g();const I=await fetch(`/api/subscription/details/${d}`);if(I.ok){const T=await I.json();m("=== 當前訂閱狀態 ==="),m(`方案: ${T.subscription}`),m(`AI Token 使用: ${T.usage.aiCost}/${T.limits.aiCostLimit}`),m(`AI 聊天次數: ${T.usage.aiChats}/${T.limits.aiChats}`),m(`剩餘天數: ${T.remainingDays} 天`),m(`是否激活: ${T.isActive?"是":"否"}`)}else{const T=await I.json();m(`無法獲取訂閱狀態: ${T.error}`)}}catch(I){m(`獲取狀態失敗: ${I}`)}};return v.useEffect(()=>{g()},[]),i.jsxs("div",{style:{minHeight:"100vh",background:"#f7faff",padding:"20px",fontFamily:"Arial, sans-serif"},children:[i.jsx("button",{onClick:()=>n("/home"),style:{position:"absolute",top:20,left:20,background:"#6B5BFF",color:"white",border:"none",borderRadius:8,padding:"10px 20px",cursor:"pointer",fontSize:16},children:"← 返回首頁"}),i.jsxs("div",{style:{maxWidth:800,margin:"0 auto",paddingTop:60},children:[i.jsx("h1",{style:{color:"#333",textAlign:"center",marginBottom:30},children:"🧪 Token 消耗測試工具"}),i.jsxs("div",{style:{background:"#fff",borderRadius:12,padding:24,marginBottom:24,boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:[i.jsx("h3",{style:{color:"#333",marginBottom:16},children:"測試功能"}),i.jsxs("div",{style:{display:"flex",gap:12,flexWrap:"wrap",marginBottom:20},children:[i.jsx("button",{onClick:x,disabled:a,style:{background:"#6B5BFF",color:"white",border:"none",borderRadius:8,padding:"12px 24px",cursor:a?"not-allowed":"pointer",fontSize:14},children:"🔄 測試 Token 消耗"}),i.jsx("button",{onClick:S,disabled:a,style:{background:"#ff6b6b",color:"white",border:"none",borderRadius:8,padding:"12px 24px",cursor:a?"not-allowed":"pointer",fontSize:14},children:"⚠️ 測試達到限制"}),i.jsx("button",{onClick:C,disabled:a,style:{background:"#51cf66",color:"white",border:"none",borderRadius:8,padding:"12px 24px",cursor:a?"not-allowed":"pointer",fontSize:14},children:"🔄 重置使用量"}),i.jsx("button",{onClick:_,disabled:a,style:{background:"#339af0",color:"white",border:"none",borderRadius:8,padding:"12px 24px",cursor:a?"not-allowed":"pointer",fontSize:14},children:"📊 顯示當前狀態"})]}),a&&i.jsx("div",{style:{textAlign:"center",color:"#666",marginBottom:16},children:"⏳ 測試中..."})]}),i.jsxs("div",{style:{background:"#fff",borderRadius:12,padding:24,boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:[i.jsx("h3",{style:{color:"#333",marginBottom:16},children:"測試結果"}),i.jsx("div",{style:{background:"#f8f9fa",borderRadius:8,padding:16,maxHeight:400,overflowY:"auto",fontFamily:"monospace",fontSize:14,lineHeight:1.5},children:r.length===0?i.jsx("div",{style:{color:"#666",fontStyle:"italic"},children:"點擊上方按鈕開始測試..."}):r.map((I,T)=>i.jsx("div",{style:{marginBottom:4},children:I},T))}),r.length>0&&i.jsx("button",{onClick:()=>o([]),style:{background:"#868e96",color:"white",border:"none",borderRadius:6,padding:"8px 16px",cursor:"pointer",fontSize:12,marginTop:12},children:"清空結果"})]})]})]})}const nM=({onTestModeChange:n})=>{const[e,t]=v.useState(!1);v.useEffect(()=>{const o=localStorage.getItem("testMode")==="true";t(o),n(o)},[n]);const r=()=>{const o=!e;t(o),localStorage.setItem("testMode",o.toString()),n(o)};return i.jsxs("div",{style:{position:"fixed",top:"20px",right:"20px",zIndex:1e4,display:"flex",flexDirection:"column",alignItems:"center",gap:"8px"},children:[i.jsx("button",{onClick:r,style:{background:e?"#ff6b6b":"#4ecdc4",color:"white",border:"none",borderRadius:"8px",padding:"8px 12px",fontSize:"12px",fontWeight:"bold",cursor:"pointer",boxShadow:"0 2px 8px rgba(0,0,0,0.2)",transition:"all 0.3s ease",minWidth:"80px"},onMouseEnter:o=>{o.currentTarget.style.transform="scale(1.05)"},onMouseLeave:o=>{o.currentTarget.style.transform="scale(1)"},children:e?"測試模式 ON":"測試模式 OFF"}),e&&i.jsx("div",{style:{background:"rgba(255, 107, 107, 0.9)",color:"white",padding:"6px 10px",borderRadius:"6px",fontSize:"10px",textAlign:"center",maxWidth:"120px",lineHeight:"1.2"},children:"語音功能已解鎖"})]})},RI=En.createContext({isTestMode:!1,setIsTestMode:()=>{}}),$i=()=>En.useContext(RI);function rM(){const{isMicOn:n}=kI();return n?i.jsx("div",{style:{position:"fixed",top:"12px",left:"50%",transform:"translateX(-50%)",zIndex:9999,background:"#ff6347",borderRadius:"50%",padding:"12px",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"0 4px 20px rgba(0,0,0,0.35)",border:"2px solid white"},children:i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"30",height:"30",viewBox:"0 0 24 24",fill:"white",children:i.jsx("path",{d:"M12 14c1.66 0 3-1.34 3-3V5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3zm5.3-3c0 3-2.54 5.1-5.3 5.1S6.7 14 6.7 11H5c0 3.41 2.72 6.23 6 6.72V21h2v-3.28c3.28-.49 6-3.31 6-6.72h-1.7z"})})}):null}function iM(){const[n,e]=v.useState(null),[t,r]=v.useState(!0),[o,a]=v.useState(!1),c=St(Ao);return v.useEffect(()=>{const d=Ns(c,h=>{e(h),r(!1)});return()=>d()},[c]),t?i.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh",fontSize:"2rem"},children:"Loading..."}):i.jsx(wD,{children:i.jsx(LN,{children:i.jsx(m3,{children:i.jsx(AN,{children:i.jsx(OR,{children:i.jsxs(RI.Provider,{value:{isTestMode:o,setIsTestMode:a},children:[i.jsx(nM,{onTestModeChange:a}),i.jsx(rM,{}),i.jsx(p3,{children:i.jsxs(DR,{children:[i.jsx(xt,{path:"/splash",element:i.jsx(uw,{})}),i.jsx(xt,{path:"/terms",element:i.jsx(MN,{})}),i.jsx(xt,{path:"/",element:i.jsx(uw,{})}),n&&i.jsx(xt,{path:"/home",element:i.jsx(TD,{})}),i.jsx(xt,{path:"/register",element:i.jsx(wN,{})}),i.jsx(xt,{path:"/confirm-registration",element:i.jsx(H3,{})}),n&&i.jsx(xt,{path:"/wall",element:i.jsx(jD,{})}),n&&i.jsx(xt,{path:"/echo-box",element:i.jsx(ID,{})}),n&&i.jsx(xt,{path:"/my-story",element:i.jsx(CD,{})}),n&&i.jsx(xt,{path:"/chat",element:i.jsx(uN,{})}),n&&i.jsx(xt,{path:"/friend",element:i.jsx(kN,{})}),n&&i.jsx(xt,{path:"/inbox",element:i.jsx(_N,{})}),n&&i.jsx(xt,{path:"/ai",element:i.jsx(jN,{})}),n&&i.jsx(xt,{path:"/tts",element:i.jsx(qS,{})}),n&&i.jsx(xt,{path:"/journal",element:i.jsx(g3,{})}),n&&i.jsx(xt,{path:"/missions",element:i.jsx($S,{})}),n&&i.jsx(xt,{path:"/restart-missions",element:i.jsx($S,{})}),n&&i.jsx(xt,{path:"/pairtalk",element:i.jsx(FN,{})}),n&&i.jsx(xt,{path:"/skillbox",element:i.jsx(zN,{})}),n&&i.jsx(xt,{path:"/skillbox/:scenarioId",element:i.jsx(XS,{})}),n&&i.jsx(xt,{path:"/practice",element:i.jsx(XS,{})}),n&&i.jsx(xt,{path:"/realistic-tts",element:i.jsx(qS,{})}),n&&i.jsx(xt,{path:"/storywall",element:i.jsx(c3,{})}),n&&i.jsx(xt,{path:"/chatroom",element:i.jsx(v3,{})}),n&&i.jsx(xt,{path:"/invites",element:i.jsx(rx,{})}),n&&i.jsx(xt,{path:"/mylinks",element:i.jsx(nx,{})}),i.jsx(xt,{path:"/about",element:i.jsx(S3,{})}),i.jsx(xt,{path:"/feedback",element:i.jsx(T3,{})}),i.jsx(xt,{path:"/admin/feedback",element:i.jsx(_3,{})}),i.jsx(xt,{path:"/CompleteProfile",element:i.jsx(I3,{})}),i.jsx(xt,{path:"/privacy-policy",element:i.jsx(R3,{})}),i.jsx(xt,{path:"/data-deletion",element:i.jsx(A3,{})}),i.jsx(xt,{path:"/HelpLab",element:i.jsx(z3,{})}),i.jsx(xt,{path:"/emotion-release",element:i.jsx(D3,{})}),n&&i.jsx(xt,{path:"/social-integration",element:i.jsx(U3,{})}),i.jsx(xt,{path:"/plans",element:i.jsx(Q3,{})}),i.jsx(xt,{path:"/payment",element:i.jsx(Y3,{})}),i.jsx(xt,{path:"/upgrade",element:i.jsx(X3,{})}),i.jsx(xt,{path:"/profile",element:i.jsx(J3,{})}),i.jsx(xt,{path:"/payment-info",element:i.jsx(Z3,{})}),i.jsx(xt,{path:"/contact",element:i.jsx(eM,{})}),i.jsx(xt,{path:"/token-test",element:i.jsx(tM,{})})]})})]})})})})})})}const oM=VC.createRoot(document.getElementById("root"));oM.render(i.jsx(iM,{}));
