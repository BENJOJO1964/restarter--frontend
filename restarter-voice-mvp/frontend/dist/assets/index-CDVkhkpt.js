import{r as qy,a as Uy,g as Bk}from"./vendor-BtP0CW_r.js";function Pk(n,e){for(var t=0;t<e.length;t++){const i=e[t];if(typeof i!="string"&&!Array.isArray(i)){for(const s in i)if(s!=="default"&&!(s in n)){const o=Object.getOwnPropertyDescriptor(i,s);o&&Object.defineProperty(n,s,o.get?o:{enumerable:!0,get:()=>i[s]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&i(a)}).observe(document,{childList:!0,subtree:!0});function t(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(s){if(s.ep)return;s.ep=!0;const o=t(s);fetch(s.href,o)}})();var jd={exports:{}},_o={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var bm;function Fk(){if(bm)return _o;bm=1;var n=qy(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),i=Object.prototype.hasOwnProperty,s=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,o={key:!0,ref:!0,__self:!0,__source:!0};function a(l,c,u){var h,p={},f=null,b=null;u!==void 0&&(f=""+u),c.key!==void 0&&(f=""+c.key),c.ref!==void 0&&(b=c.ref);for(h in c)i.call(c,h)&&!o.hasOwnProperty(h)&&(p[h]=c[h]);if(l&&l.defaultProps)for(h in c=l.defaultProps,c)p[h]===void 0&&(p[h]=c[h]);return{$$typeof:e,type:l,key:f,ref:b,props:p,_owner:s.current}}return _o.Fragment=t,_o.jsx=a,_o.jsxs=a,_o}var vm;function zk(){return vm||(vm=1,jd.exports=Fk()),jd.exports}var r=zk(),dl={},wm;function Dk(){if(wm)return dl;wm=1;var n=Uy();return dl.createRoot=n.createRoot,dl.hydrateRoot=n.hydrateRoot,dl}var Nk=Dk(),g=qy();const Kt=Bk(g),Mk=Pk({__proto__:null,default:Kt},[g]);Uy();/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function ta(){return ta=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])}return n},ta.apply(this,arguments)}var Mi;(function(n){n.Pop="POP",n.Push="PUSH",n.Replace="REPLACE"})(Mi||(Mi={}));const km="popstate";function Wk(n){n===void 0&&(n={});function e(i,s){let{pathname:o,search:a,hash:l}=i.location;return ru("",{pathname:o,search:a,hash:l},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function t(i,s){return typeof s=="string"?s:$y(s)}return Ok(e,t,null,n)}function Vt(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function Hy(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function Lk(){return Math.random().toString(36).substr(2,8)}function Sm(n,e){return{usr:n.state,key:n.key,idx:e}}function ru(n,e,t,i){return t===void 0&&(t=null),ta({pathname:typeof n=="string"?n:n.pathname,search:"",hash:""},typeof e=="string"?Xs(e):e,{state:t,key:e&&e.key||i||Lk()})}function $y(n){let{pathname:e="/",search:t="",hash:i=""}=n;return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),i&&i!=="#"&&(e+=i.charAt(0)==="#"?i:"#"+i),e}function Xs(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substr(t),n=n.substr(0,t));let i=n.indexOf("?");i>=0&&(e.search=n.substr(i),n=n.substr(0,i)),n&&(e.pathname=n)}return e}function Ok(n,e,t,i){i===void 0&&(i={});let{window:s=document.defaultView,v5Compat:o=!1}=i,a=s.history,l=Mi.Pop,c=null,u=h();u==null&&(u=0,a.replaceState(ta({},a.state,{idx:u}),""));function h(){return(a.state||{idx:null}).idx}function p(){l=Mi.Pop;let w=h(),I=w==null?null:w-u;u=w,c&&c({action:l,location:S.location,delta:I})}function f(w,I){l=Mi.Push;let j=ru(S.location,w,I);u=h()+1;let A=Sm(j,u),D=S.createHref(j);try{a.pushState(A,"",D)}catch(O){if(O instanceof DOMException&&O.name==="DataCloneError")throw O;s.location.assign(D)}o&&c&&c({action:l,location:S.location,delta:1})}function b(w,I){l=Mi.Replace;let j=ru(S.location,w,I);u=h();let A=Sm(j,u),D=S.createHref(j);a.replaceState(A,"",D),o&&c&&c({action:l,location:S.location,delta:0})}function x(w){let I=s.location.origin!=="null"?s.location.origin:s.location.href,j=typeof w=="string"?w:$y(w);return j=j.replace(/ $/,"%20"),Vt(I,"No window.location.(origin|href) available to create URL for href: "+j),new URL(j,I)}let S={get action(){return l},get location(){return n(s,a)},listen(w){if(c)throw new Error("A history only accepts one active listener");return s.addEventListener(km,p),c=w,()=>{s.removeEventListener(km,p),c=null}},createHref(w){return e(s,w)},createURL:x,encodeLocation(w){let I=x(w);return{pathname:I.pathname,search:I.search,hash:I.hash}},push:f,replace:b,go(w){return a.go(w)}};return S}var Tm;(function(n){n.data="data",n.deferred="deferred",n.redirect="redirect",n.error="error"})(Tm||(Tm={}));function Vk(n,e,t){return t===void 0&&(t="/"),qk(n,e,t)}function qk(n,e,t,i){let s=typeof e=="string"?Xs(e):e,o=Qy(s.pathname||"/",t);if(o==null)return null;let a=Gy(n);Uk(a);let l=null;for(let c=0;l==null&&c<a.length;++c){let u=n1(o);l=Zk(a[c],u)}return l}function Gy(n,e,t,i){e===void 0&&(e=[]),t===void 0&&(t=[]),i===void 0&&(i="");let s=(o,a,l)=>{let c={relativePath:l===void 0?o.path||"":l,caseSensitive:o.caseSensitive===!0,childrenIndex:a,route:o};c.relativePath.startsWith("/")&&(Vt(c.relativePath.startsWith(i),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+i+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(i.length));let u=Cr([i,c.relativePath]),h=t.concat(c);o.children&&o.children.length>0&&(Vt(o.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),Gy(o.children,e,h,u)),!(o.path==null&&!o.index)&&e.push({path:u,score:Xk(u,o.index),routesMeta:h})};return n.forEach((o,a)=>{var l;if(o.path===""||!((l=o.path)!=null&&l.includes("?")))s(o,a);else for(let c of Ky(o.path))s(o,a,c)}),e}function Ky(n){let e=n.split("/");if(e.length===0)return[];let[t,...i]=e,s=t.endsWith("?"),o=t.replace(/\?$/,"");if(i.length===0)return s?[o,""]:[o];let a=Ky(i.join("/")),l=[];return l.push(...a.map(c=>c===""?o:[o,c].join("/"))),s&&l.push(...a),l.map(c=>n.startsWith("/")&&c===""?"/":c)}function Uk(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:Jk(e.routesMeta.map(i=>i.childrenIndex),t.routesMeta.map(i=>i.childrenIndex)))}const Hk=/^:[\w-]+$/,$k=3,Gk=2,Kk=1,Qk=10,Yk=-2,jm=n=>n==="*";function Xk(n,e){let t=n.split("/"),i=t.length;return t.some(jm)&&(i+=Yk),e&&(i+=Gk),t.filter(s=>!jm(s)).reduce((s,o)=>s+(Hk.test(o)?$k:o===""?Kk:Qk),i)}function Jk(n,e){return n.length===e.length&&n.slice(0,-1).every((i,s)=>i===e[s])?n[n.length-1]-e[e.length-1]:0}function Zk(n,e,t){let{routesMeta:i}=n,s={},o="/",a=[];for(let l=0;l<i.length;++l){let c=i[l],u=l===i.length-1,h=o==="/"?e:e.slice(o.length)||"/",p=e1({path:c.relativePath,caseSensitive:c.caseSensitive,end:u},h),f=c.route;if(!p)return null;Object.assign(s,p.params),a.push({params:s,pathname:Cr([o,p.pathname]),pathnameBase:l1(Cr([o,p.pathnameBase])),route:f}),p.pathnameBase!=="/"&&(o=Cr([o,p.pathnameBase]))}return a}function e1(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,i]=t1(n.path,n.caseSensitive,n.end),s=e.match(t);if(!s)return null;let o=s[0],a=o.replace(/(.)\/+$/,"$1"),l=s.slice(1);return{params:i.reduce((u,h,p)=>{let{paramName:f,isOptional:b}=h;if(f==="*"){let S=l[p]||"";a=o.slice(0,o.length-S.length).replace(/(.)\/+$/,"$1")}const x=l[p];return b&&!x?u[f]=void 0:u[f]=(x||"").replace(/%2F/g,"/"),u},{}),pathname:o,pathnameBase:a,pattern:n}}function t1(n,e,t){e===void 0&&(e=!1),t===void 0&&(t=!0),Hy(n==="*"||!n.endsWith("*")||n.endsWith("/*"),'Route path "'+n+'" will be treated as if it were '+('"'+n.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+n.replace(/\*$/,"/*")+'".'));let i=[],s="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(a,l,c)=>(i.push({paramName:l,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return n.endsWith("*")?(i.push({paramName:"*"}),s+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?s+="\\/*$":n!==""&&n!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),i]}function n1(n){try{return n.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Hy(!1,'The URL path "'+n+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),n}}function Qy(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,i=n.charAt(t);return i&&i!=="/"?null:n.slice(t)||"/"}function i1(n,e){e===void 0&&(e="/");let{pathname:t,search:i="",hash:s=""}=typeof n=="string"?Xs(n):n;return{pathname:t?t.startsWith("/")?t:r1(t,e):e,search:c1(i),hash:d1(s)}}function r1(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(s=>{s===".."?t.length>1&&t.pop():s!=="."&&t.push(s)}),t.length>1?t.join("/"):"/"}function _d(n,e,t,i){return"Cannot include a '"+n+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(i)+"].  Please separate it out to the ")+("`to."+t+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function s1(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function o1(n,e){let t=s1(n);return e?t.map((i,s)=>s===t.length-1?i.pathname:i.pathnameBase):t.map(i=>i.pathnameBase)}function a1(n,e,t,i){i===void 0&&(i=!1);let s;typeof n=="string"?s=Xs(n):(s=ta({},n),Vt(!s.pathname||!s.pathname.includes("?"),_d("?","pathname","search",s)),Vt(!s.pathname||!s.pathname.includes("#"),_d("#","pathname","hash",s)),Vt(!s.search||!s.search.includes("#"),_d("#","search","hash",s)));let o=n===""||s.pathname==="",a=o?"/":s.pathname,l;if(a==null)l=t;else{let p=e.length-1;if(!i&&a.startsWith("..")){let f=a.split("/");for(;f[0]==="..";)f.shift(),p-=1;s.pathname=f.join("/")}l=p>=0?e[p]:"/"}let c=i1(s,l),u=a&&a!=="/"&&a.endsWith("/"),h=(o||a===".")&&t.endsWith("/");return!c.pathname.endsWith("/")&&(u||h)&&(c.pathname+="/"),c}const Cr=n=>n.join("/").replace(/\/\/+/g,"/"),l1=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),c1=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,d1=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n;function u1(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}const Yy=["post","put","patch","delete"];new Set(Yy);const h1=["get",...Yy];new Set(h1);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function na(){return na=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])}return n},na.apply(this,arguments)}const eh=g.createContext(null),p1=g.createContext(null),Sc=g.createContext(null),Tc=g.createContext(null),Kr=g.createContext({outlet:null,matches:[],isDataRoute:!1}),Xy=g.createContext(null);function jc(){return g.useContext(Tc)!=null}function xa(){return jc()||Vt(!1),g.useContext(Tc).location}function Jy(n){g.useContext(Sc).static||g.useLayoutEffect(n)}function $e(){let{isDataRoute:n}=g.useContext(Kr);return n?I1():m1()}function m1(){jc()||Vt(!1);let n=g.useContext(eh),{basename:e,future:t,navigator:i}=g.useContext(Sc),{matches:s}=g.useContext(Kr),{pathname:o}=xa(),a=JSON.stringify(o1(s,t.v7_relativeSplatPath)),l=g.useRef(!1);return Jy(()=>{l.current=!0}),g.useCallback(function(u,h){if(h===void 0&&(h={}),!l.current)return;if(typeof u=="number"){i.go(u);return}let p=a1(u,JSON.parse(a),o,h.relative==="path");n==null&&e!=="/"&&(p.pathname=p.pathname==="/"?e:Cr([e,p.pathname])),(h.replace?i.replace:i.push)(p,h.state,h)},[e,i,a,o,n])}function g1(){let{matches:n}=g.useContext(Kr),e=n[n.length-1];return e?e.params:{}}function f1(n,e){return y1(n,e)}function y1(n,e,t,i){jc()||Vt(!1);let{navigator:s}=g.useContext(Sc),{matches:o}=g.useContext(Kr),a=o[o.length-1],l=a?a.params:{};a&&a.pathname;let c=a?a.pathnameBase:"/";a&&a.route;let u=xa(),h;if(e){var p;let w=typeof e=="string"?Xs(e):e;c==="/"||(p=w.pathname)!=null&&p.startsWith(c)||Vt(!1),h=w}else h=u;let f=h.pathname||"/",b=f;if(c!=="/"){let w=c.replace(/^\//,"").split("/");b="/"+f.replace(/^\//,"").split("/").slice(w.length).join("/")}let x=Vk(n,{pathname:b}),S=k1(x&&x.map(w=>Object.assign({},w,{params:Object.assign({},l,w.params),pathname:Cr([c,s.encodeLocation?s.encodeLocation(w.pathname).pathname:w.pathname]),pathnameBase:w.pathnameBase==="/"?c:Cr([c,s.encodeLocation?s.encodeLocation(w.pathnameBase).pathname:w.pathnameBase])})),o,t,i);return e&&S?g.createElement(Tc.Provider,{value:{location:na({pathname:"/",search:"",hash:"",state:null,key:"default"},h),navigationType:Mi.Pop}},S):S}function x1(){let n=_1(),e=u1(n)?n.status+" "+n.statusText:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return g.createElement(g.Fragment,null,g.createElement("h2",null,"Unexpected Application Error!"),g.createElement("h3",{style:{fontStyle:"italic"}},e),t?g.createElement("pre",{style:s},t):null,null)}const b1=g.createElement(x1,null);class v1 extends g.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return this.state.error!==void 0?g.createElement(Kr.Provider,{value:this.props.routeContext},g.createElement(Xy.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function w1(n){let{routeContext:e,match:t,children:i}=n,s=g.useContext(eh);return s&&s.static&&s.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=t.route.id),g.createElement(Kr.Provider,{value:e},i)}function k1(n,e,t,i){var s;if(e===void 0&&(e=[]),t===void 0&&(t=null),i===void 0&&(i=null),n==null){var o;if(!t)return null;if(t.errors)n=t.matches;else if((o=i)!=null&&o.v7_partialHydration&&e.length===0&&!t.initialized&&t.matches.length>0)n=t.matches;else return null}let a=n,l=(s=t)==null?void 0:s.errors;if(l!=null){let h=a.findIndex(p=>p.route.id&&(l==null?void 0:l[p.route.id])!==void 0);h>=0||Vt(!1),a=a.slice(0,Math.min(a.length,h+1))}let c=!1,u=-1;if(t&&i&&i.v7_partialHydration)for(let h=0;h<a.length;h++){let p=a[h];if((p.route.HydrateFallback||p.route.hydrateFallbackElement)&&(u=h),p.route.id){let{loaderData:f,errors:b}=t,x=p.route.loader&&f[p.route.id]===void 0&&(!b||b[p.route.id]===void 0);if(p.route.lazy||x){c=!0,u>=0?a=a.slice(0,u+1):a=[a[0]];break}}}return a.reduceRight((h,p,f)=>{let b,x=!1,S=null,w=null;t&&(b=l&&p.route.id?l[p.route.id]:void 0,S=p.route.errorElement||b1,c&&(u<0&&f===0?(C1("route-fallback"),x=!0,w=null):u===f&&(x=!0,w=p.route.hydrateFallbackElement||null)));let I=e.concat(a.slice(0,f+1)),j=()=>{let A;return b?A=S:x?A=w:p.route.Component?A=g.createElement(p.route.Component,null):p.route.element?A=p.route.element:A=h,g.createElement(w1,{match:p,routeContext:{outlet:h,matches:I,isDataRoute:t!=null},children:A})};return t&&(p.route.ErrorBoundary||p.route.errorElement||f===0)?g.createElement(v1,{location:t.location,revalidation:t.revalidation,component:S,error:b,children:j(),routeContext:{outlet:null,matches:I,isDataRoute:!0}}):j()},null)}var Zy=function(n){return n.UseBlocker="useBlocker",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n}(Zy||{}),ex=function(n){return n.UseBlocker="useBlocker",n.UseLoaderData="useLoaderData",n.UseActionData="useActionData",n.UseRouteError="useRouteError",n.UseNavigation="useNavigation",n.UseRouteLoaderData="useRouteLoaderData",n.UseMatches="useMatches",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n.UseRouteId="useRouteId",n}(ex||{});function S1(n){let e=g.useContext(eh);return e||Vt(!1),e}function T1(n){let e=g.useContext(p1);return e||Vt(!1),e}function j1(n){let e=g.useContext(Kr);return e||Vt(!1),e}function tx(n){let e=j1(),t=e.matches[e.matches.length-1];return t.route.id||Vt(!1),t.route.id}function _1(){var n;let e=g.useContext(Xy),t=T1(),i=tx();return e!==void 0?e:(n=t.errors)==null?void 0:n[i]}function I1(){let{router:n}=S1(Zy.UseNavigateStable),e=tx(ex.UseNavigateStable),t=g.useRef(!1);return Jy(()=>{t.current=!0}),g.useCallback(function(s,o){o===void 0&&(o={}),t.current&&(typeof s=="number"?n.navigate(s):n.navigate(s,na({fromRouteId:e},o)))},[n,e])}const _m={};function C1(n,e,t){_m[n]||(_m[n]=!0)}function R1(n,e){n==null||n.v7_startTransition,n==null||n.v7_relativeSplatPath}function qe(n){Vt(!1)}function A1(n){let{basename:e="/",children:t=null,location:i,navigationType:s=Mi.Pop,navigator:o,static:a=!1,future:l}=n;jc()&&Vt(!1);let c=e.replace(/^\/*/,"/"),u=g.useMemo(()=>({basename:c,navigator:o,static:a,future:na({v7_relativeSplatPath:!1},l)}),[c,l,o,a]);typeof i=="string"&&(i=Xs(i));let{pathname:h="/",search:p="",hash:f="",state:b=null,key:x="default"}=i,S=g.useMemo(()=>{let w=Qy(h,c);return w==null?null:{location:{pathname:w,search:p,hash:f,state:b,key:x},navigationType:s}},[c,h,p,f,b,x,s]);return S==null?null:g.createElement(Sc.Provider,{value:u},g.createElement(Tc.Provider,{children:t,value:S}))}function E1(n){let{children:e,location:t}=n;return f1(su(e),t)}new Promise(()=>{});function su(n,e){e===void 0&&(e=[]);let t=[];return g.Children.forEach(n,(i,s)=>{if(!g.isValidElement(i))return;let o=[...e,s];if(i.type===g.Fragment){t.push.apply(t,su(i.props.children,o));return}i.type!==qe&&Vt(!1),!i.props.index||!i.props.children||Vt(!1);let a={id:i.props.id||o.join("-"),caseSensitive:i.props.caseSensitive,element:i.props.element,Component:i.props.Component,index:i.props.index,path:i.props.path,loader:i.props.loader,action:i.props.action,errorElement:i.props.errorElement,ErrorBoundary:i.props.ErrorBoundary,hasErrorBoundary:i.props.ErrorBoundary!=null||i.props.errorElement!=null,shouldRevalidate:i.props.shouldRevalidate,handle:i.props.handle,lazy:i.props.lazy};i.props.children&&(a.children=su(i.props.children,o)),t.push(a)}),t}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function ou(n){return n===void 0&&(n=""),new URLSearchParams(typeof n=="string"||Array.isArray(n)||n instanceof URLSearchParams?n:Object.keys(n).reduce((e,t)=>{let i=n[t];return e.concat(Array.isArray(i)?i.map(s=>[t,s]):[[t,i]])},[]))}function B1(n,e){let t=ou(n);return e&&e.forEach((i,s)=>{t.has(s)||e.getAll(s).forEach(o=>{t.append(s,o)})}),t}const P1="6";try{window.__reactRouterVersion=P1}catch{}const F1="startTransition",Im=Mk[F1];function z1(n){let{basename:e,children:t,future:i,window:s}=n,o=g.useRef();o.current==null&&(o.current=Wk({window:s,v5Compat:!0}));let a=o.current,[l,c]=g.useState({action:a.action,location:a.location}),{v7_startTransition:u}=i||{},h=g.useCallback(p=>{u&&Im?Im(()=>c(p)):c(p)},[c,u]);return g.useLayoutEffect(()=>a.listen(h),[a,h]),g.useEffect(()=>R1(i),[i]),g.createElement(A1,{basename:e,children:t,location:l.location,navigationType:l.action,navigator:a,future:i})}var Cm;(function(n){n.UseScrollRestoration="useScrollRestoration",n.UseSubmit="useSubmit",n.UseSubmitFetcher="useSubmitFetcher",n.UseFetcher="useFetcher",n.useViewTransitionState="useViewTransitionState"})(Cm||(Cm={}));var Rm;(function(n){n.UseFetcher="useFetcher",n.UseFetchers="useFetchers",n.UseScrollRestoration="useScrollRestoration"})(Rm||(Rm={}));function nx(n){let e=g.useRef(ou(n)),t=g.useRef(!1),i=xa(),s=g.useMemo(()=>B1(i.search,t.current?null:e.current),[i.search]),o=$e(),a=g.useCallback((l,c)=>{const u=ou(typeof l=="function"?l(s):l);t.current=!0,o("?"+u,c)},[o,s]);return[s,a]}const D1=()=>{const[n,e]=g.useState(!0),[t,i]=g.useState(0),[s,o]=g.useState(!1),[a,l]=g.useState(!1),c=$e();return g.useEffect(()=>{(async()=>{i(1),o(!0),l(!0),await new Promise(h=>setTimeout(h,2e3)),await new Promise(h=>setTimeout(h,500)),i(0),await new Promise(h=>setTimeout(h,400)),c("/home")})()},[c]),r.jsxs("div",{style:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",background:"radial-gradient(ellipse 80% 60% at 50% 50%, #fff 0%, #e3eafc 70%, #b3c6f7 100%)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1e4,opacity:n?1:0,transition:"opacity 0.5s ease-in-out",overflow:"hidden"},children:[r.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",opacity:t,transition:"opacity 0.7s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative"},children:[r.jsx("div",{style:{position:"absolute",width:320,height:220,borderRadius:"50% / 40%",top:"50%",left:"50%",transform:"translate(-50%, -50%)",zIndex:1,pointerEvents:"none",animation:s?"halo-rotate 2.5s linear forwards":"none",opacity:.85,background:"conic-gradient(from 0deg, #fff 0deg, #ffd700 60deg, #b3c6f7 180deg, #fff 300deg, #fff 360deg)",filter:"blur(2px)"}}),r.jsx("div",{style:{position:"absolute",width:260,height:260,borderRadius:"50%",background:"radial-gradient(circle, #fff 0%, rgba(255,255,255,0.7) 50%, transparent 80%)",zIndex:2,top:"50%",left:"50%",transform:"translate(-50%, -50%)",pointerEvents:"none"}}),r.jsx("img",{src:"/ctx-logo.png",alt:"CTX Logo",style:{width:"200px",height:"200px",filter:"drop-shadow(0 8px 32px rgba(40, 40, 40, 0.35)) drop-shadow(0 2px 8px #fff)",zIndex:3,animation:a?"logo-scale-rotate 2.5s cubic-bezier(0.4,0,0.2,1) forwards":"none",transformOrigin:"50% 50%",transform:a?void 0:"scale(1) rotate(0deg)",opacity:a?void 0:1}}),r.jsx("div",{style:{marginTop:"20px",color:"#232946",fontSize:"24px",fontWeight:"bold",textAlign:"center",textShadow:"0 2px 8px rgba(255,255,255,0.5)",zIndex:3},children:"Restarter™"}),r.jsx("div",{style:{marginTop:"8px",color:"#ffd700",fontSize:"16px",textAlign:"center",textShadow:"0 2px 8px rgba(0, 0, 0, 0.1)",zIndex:3},children:"重啟人生的平台"})]}),r.jsx("style",{children:`
        @keyframes halo-rotate {
          0% { transform: translate(-50%, -50%) rotate(0deg); }
          100% { transform: translate(-50%, -50%) rotate(360deg); }
        }
        @keyframes logo-scale-rotate {
          0% { transform: scale(0.1) rotate(-180deg); opacity: 0.2; }
          20% { opacity: 1; }
          100% { transform: scale(1) rotate(0deg); opacity: 1; }
        }
      `})]})},N1=()=>{};var Am={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ix=function(n){const e=[];let t=0;for(let i=0;i<n.length;i++){let s=n.charCodeAt(i);s<128?e[t++]=s:s<2048?(e[t++]=s>>6|192,e[t++]=s&63|128):(s&64512)===55296&&i+1<n.length&&(n.charCodeAt(i+1)&64512)===56320?(s=65536+((s&1023)<<10)+(n.charCodeAt(++i)&1023),e[t++]=s>>18|240,e[t++]=s>>12&63|128,e[t++]=s>>6&63|128,e[t++]=s&63|128):(e[t++]=s>>12|224,e[t++]=s>>6&63|128,e[t++]=s&63|128)}return e},M1=function(n){const e=[];let t=0,i=0;for(;t<n.length;){const s=n[t++];if(s<128)e[i++]=String.fromCharCode(s);else if(s>191&&s<224){const o=n[t++];e[i++]=String.fromCharCode((s&31)<<6|o&63)}else if(s>239&&s<365){const o=n[t++],a=n[t++],l=n[t++],c=((s&7)<<18|(o&63)<<12|(a&63)<<6|l&63)-65536;e[i++]=String.fromCharCode(55296+(c>>10)),e[i++]=String.fromCharCode(56320+(c&1023))}else{const o=n[t++],a=n[t++];e[i++]=String.fromCharCode((s&15)<<12|(o&63)<<6|a&63)}}return e.join("")},rx={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let s=0;s<n.length;s+=3){const o=n[s],a=s+1<n.length,l=a?n[s+1]:0,c=s+2<n.length,u=c?n[s+2]:0,h=o>>2,p=(o&3)<<4|l>>4;let f=(l&15)<<2|u>>6,b=u&63;c||(b=64,a||(f=64)),i.push(t[h],t[p],t[f],t[b])}return i.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(ix(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):M1(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let s=0;s<n.length;){const o=t[n.charAt(s++)],l=s<n.length?t[n.charAt(s)]:0;++s;const u=s<n.length?t[n.charAt(s)]:64;++s;const p=s<n.length?t[n.charAt(s)]:64;if(++s,o==null||l==null||u==null||p==null)throw new W1;const f=o<<2|l>>4;if(i.push(f),u!==64){const b=l<<4&240|u>>2;if(i.push(b),p!==64){const x=u<<6&192|p;i.push(x)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class W1 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const L1=function(n){const e=ix(n);return rx.encodeByteArray(e,!0)},ql=function(n){return L1(n).replace(/\./g,"")},sx=function(n){try{return rx.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ox(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const O1=()=>ox().__FIREBASE_DEFAULTS__,V1=()=>{if(typeof process>"u"||typeof Am>"u")return;const n=Am.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},q1=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&sx(n[1]);return e&&JSON.parse(e)},_c=()=>{try{return N1()||O1()||V1()||q1()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},ax=n=>{var e,t;return(t=(e=_c())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},lx=n=>{const e=ax(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),i]:[e.substring(0,t),i]},cx=()=>{var n;return(n=_c())===null||n===void 0?void 0:n.config},dx=n=>{var e;return(e=_c())===null||e===void 0?void 0:e[`_${n}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U1{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,i))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xi(n){return n.endsWith(".cloudworkstations.dev")}async function Ic(n){return(await fetch(n,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ux(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},i=e||"demo-project",s=n.iat||0,o=n.sub||n.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a=Object.assign({iss:`https://securetoken.google.com/${i}`,aud:i,iat:s,exp:s+3600,auth_time:s,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}}},n);return[ql(JSON.stringify(t)),ql(JSON.stringify(a)),""].join(".")}const Vo={};function H1(){const n={prod:[],emulator:[]};for(const e of Object.keys(Vo))Vo[e]?n.emulator.push(e):n.prod.push(e);return n}function $1(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let Em=!1;function th(n,e){if(typeof window>"u"||typeof document>"u"||!xi(window.location.host)||Vo[n]===e||Vo[n]||Em)return;Vo[n]=e;function t(f){return`__firebase__banner__${f}`}const i="__firebase__banner",o=H1().prod.length>0;function a(){const f=document.getElementById(i);f&&f.remove()}function l(f){f.style.display="flex",f.style.background="#7faaf0",f.style.position="fixed",f.style.bottom="5px",f.style.left="5px",f.style.padding=".5em",f.style.borderRadius="5px",f.style.alignItems="center"}function c(f,b){f.setAttribute("width","24"),f.setAttribute("id",b),f.setAttribute("height","24"),f.setAttribute("viewBox","0 0 24 24"),f.setAttribute("fill","none"),f.style.marginLeft="-6px"}function u(){const f=document.createElement("span");return f.style.cursor="pointer",f.style.marginLeft="16px",f.style.fontSize="24px",f.innerHTML=" &times;",f.onclick=()=>{Em=!0,a()},f}function h(f,b){f.setAttribute("id",b),f.innerText="Learn more",f.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",f.setAttribute("target","__blank"),f.style.paddingLeft="5px",f.style.textDecoration="underline"}function p(){const f=$1(i),b=t("text"),x=document.getElementById(b)||document.createElement("span"),S=t("learnmore"),w=document.getElementById(S)||document.createElement("a"),I=t("preprendIcon"),j=document.getElementById(I)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(f.created){const A=f.element;l(A),h(w,S);const D=u();c(j,I),A.append(j,x,w,D),document.body.appendChild(A)}o?(x.innerText="Preview backend disconnected.",j.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(j.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,x.innerText="Preview backend running in this workspace."),x.setAttribute("id",b)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",p):p()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qt(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function G1(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(qt())}function hx(){var n;const e=(n=_c())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function K1(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function Q1(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function Y1(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function X1(){const n=qt();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function px(){return!hx()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function mx(){return!hx()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function gx(){try{return typeof indexedDB=="object"}catch{return!1}}function J1(){return new Promise((n,e)=>{try{let t=!0;const i="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(i);s.onsuccess=()=>{s.result.close(),t||self.indexedDB.deleteDatabase(i),n(!0)},s.onupgradeneeded=()=>{t=!1},s.onerror=()=>{var o;e(((o=s.error)===null||o===void 0?void 0:o.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Z1="FirebaseError";class Xn extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name=Z1,Object.setPrototypeOf(this,Xn.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ba.prototype.create)}}class ba{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){const i=t[0]||{},s=`${this.service}/${e}`,o=this.errors[e],a=o?eS(o,i):"Error",l=`${this.serviceName}: ${a} (${s}).`;return new Xn(s,l,i)}}function eS(n,e){return n.replace(tS,(t,i)=>{const s=e[i];return s!=null?String(s):`<${i}?>`})}const tS=/\{\$([^}]+)}/g;function nS(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Pn(n,e){if(n===e)return!0;const t=Object.keys(n),i=Object.keys(e);for(const s of t){if(!i.includes(s))return!1;const o=n[s],a=e[s];if(Bm(o)&&Bm(a)){if(!Pn(o,a))return!1}else if(o!==a)return!1}for(const s of i)if(!t.includes(s))return!1;return!0}function Bm(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function va(n){const e=[];for(const[t,i]of Object.entries(n))Array.isArray(i)?i.forEach(s=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function Do(n){const e={};return n.replace(/^\?/,"").split("&").forEach(i=>{if(i){const[s,o]=i.split("=");e[decodeURIComponent(s)]=decodeURIComponent(o)}}),e}function No(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function iS(n,e){const t=new rS(n,e);return t.subscribe.bind(t)}class rS{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,i){let s;if(e===void 0&&t===void 0&&i===void 0)throw new Error("Missing Observer.");sS(e,["next","error","complete"])?s=e:s={next:e,error:t,complete:i},s.next===void 0&&(s.next=Id),s.error===void 0&&(s.error=Id),s.complete===void 0&&(s.complete=Id);const o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),o}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function sS(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Id(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lt(n){return n&&n._delegate?n._delegate:n}class Gi{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fr="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oS{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const i=new U1;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:t});s&&i.resolve(s)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const i=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(t=e==null?void 0:e.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(i)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:i})}catch(o){if(s)return null;throw o}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(lS(e))try{this.getOrInitializeService({instanceIdentifier:fr})}catch{}for(const[t,i]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(t);try{const o=this.getOrInitializeService({instanceIdentifier:s});i.resolve(o)}catch{}}}}clearInstance(e=fr){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=fr){return this.instances.has(e)}getOptions(e=fr){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:i,options:t});for(const[o,a]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(o);i===l&&a.resolve(s)}return s}onInit(e,t){var i;const s=this.normalizeInstanceIdentifier(t),o=(i=this.onInitCallbacks.get(s))!==null&&i!==void 0?i:new Set;o.add(e),this.onInitCallbacks.set(s,o);const a=this.instances.get(s);return a&&e(a,s),()=>{o.delete(e)}}invokeOnInitCallbacks(e,t){const i=this.onInitCallbacks.get(t);if(i)for(const s of i)try{s(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:aS(e),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=fr){return this.component?this.component.multipleInstances?e:fr:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function aS(n){return n===fr?void 0:n}function lS(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cS{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new oS(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var tt;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(tt||(tt={}));const dS={debug:tt.DEBUG,verbose:tt.VERBOSE,info:tt.INFO,warn:tt.WARN,error:tt.ERROR,silent:tt.SILENT},uS=tt.INFO,hS={[tt.DEBUG]:"log",[tt.VERBOSE]:"log",[tt.INFO]:"info",[tt.WARN]:"warn",[tt.ERROR]:"error"},pS=(n,e,...t)=>{if(e<n.logLevel)return;const i=new Date().toISOString(),s=hS[e];if(s)console[s](`[${i}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class nh{constructor(e){this.name=e,this._logLevel=uS,this._logHandler=pS,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in tt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?dS[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,tt.DEBUG,...e),this._logHandler(this,tt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,tt.VERBOSE,...e),this._logHandler(this,tt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,tt.INFO,...e),this._logHandler(this,tt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,tt.WARN,...e),this._logHandler(this,tt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,tt.ERROR,...e),this._logHandler(this,tt.ERROR,...e)}}const mS=(n,e)=>e.some(t=>n instanceof t);let Pm,Fm;function gS(){return Pm||(Pm=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function fS(){return Fm||(Fm=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const fx=new WeakMap,au=new WeakMap,yx=new WeakMap,Cd=new WeakMap,ih=new WeakMap;function yS(n){const e=new Promise((t,i)=>{const s=()=>{n.removeEventListener("success",o),n.removeEventListener("error",a)},o=()=>{t(Vi(n.result)),s()},a=()=>{i(n.error),s()};n.addEventListener("success",o),n.addEventListener("error",a)});return e.then(t=>{t instanceof IDBCursor&&fx.set(t,n)}).catch(()=>{}),ih.set(e,n),e}function xS(n){if(au.has(n))return;const e=new Promise((t,i)=>{const s=()=>{n.removeEventListener("complete",o),n.removeEventListener("error",a),n.removeEventListener("abort",a)},o=()=>{t(),s()},a=()=>{i(n.error||new DOMException("AbortError","AbortError")),s()};n.addEventListener("complete",o),n.addEventListener("error",a),n.addEventListener("abort",a)});au.set(n,e)}let lu={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return au.get(n);if(e==="objectStoreNames")return n.objectStoreNames||yx.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Vi(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function bS(n){lu=n(lu)}function vS(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const i=n.call(Rd(this),e,...t);return yx.set(i,e.sort?e.sort():[e]),Vi(i)}:fS().includes(n)?function(...e){return n.apply(Rd(this),e),Vi(fx.get(this))}:function(...e){return Vi(n.apply(Rd(this),e))}}function wS(n){return typeof n=="function"?vS(n):(n instanceof IDBTransaction&&xS(n),mS(n,gS())?new Proxy(n,lu):n)}function Vi(n){if(n instanceof IDBRequest)return yS(n);if(Cd.has(n))return Cd.get(n);const e=wS(n);return e!==n&&(Cd.set(n,e),ih.set(e,n)),e}const Rd=n=>ih.get(n);function kS(n,e,{blocked:t,upgrade:i,blocking:s,terminated:o}={}){const a=indexedDB.open(n,e),l=Vi(a);return i&&a.addEventListener("upgradeneeded",c=>{i(Vi(a.result),c.oldVersion,c.newVersion,Vi(a.transaction),c)}),t&&a.addEventListener("blocked",c=>t(c.oldVersion,c.newVersion,c)),l.then(c=>{o&&c.addEventListener("close",()=>o()),s&&c.addEventListener("versionchange",u=>s(u.oldVersion,u.newVersion,u))}).catch(()=>{}),l}const SS=["get","getKey","getAll","getAllKeys","count"],TS=["put","add","delete","clear"],Ad=new Map;function zm(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Ad.get(e))return Ad.get(e);const t=e.replace(/FromIndex$/,""),i=e!==t,s=TS.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!(s||SS.includes(t)))return;const o=async function(a,...l){const c=this.transaction(a,s?"readwrite":"readonly");let u=c.store;return i&&(u=u.index(l.shift())),(await Promise.all([u[t](...l),s&&c.done]))[0]};return Ad.set(e,o),o}bS(n=>({...n,get:(e,t,i)=>zm(e,t)||n.get(e,t,i),has:(e,t)=>!!zm(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jS{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(_S(t)){const i=t.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(t=>t).join(" ")}}function _S(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const cu="@firebase/app",Dm="0.13.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pi=new nh("@firebase/app"),IS="@firebase/app-compat",CS="@firebase/analytics-compat",RS="@firebase/analytics",AS="@firebase/app-check-compat",ES="@firebase/app-check",BS="@firebase/auth",PS="@firebase/auth-compat",FS="@firebase/database",zS="@firebase/data-connect",DS="@firebase/database-compat",NS="@firebase/functions",MS="@firebase/functions-compat",WS="@firebase/installations",LS="@firebase/installations-compat",OS="@firebase/messaging",VS="@firebase/messaging-compat",qS="@firebase/performance",US="@firebase/performance-compat",HS="@firebase/remote-config",$S="@firebase/remote-config-compat",GS="@firebase/storage",KS="@firebase/storage-compat",QS="@firebase/firestore",YS="@firebase/ai",XS="@firebase/firestore-compat",JS="firebase",ZS="11.9.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ul="[DEFAULT]",eT={[cu]:"fire-core",[IS]:"fire-core-compat",[RS]:"fire-analytics",[CS]:"fire-analytics-compat",[ES]:"fire-app-check",[AS]:"fire-app-check-compat",[BS]:"fire-auth",[PS]:"fire-auth-compat",[FS]:"fire-rtdb",[zS]:"fire-data-connect",[DS]:"fire-rtdb-compat",[NS]:"fire-fn",[MS]:"fire-fn-compat",[WS]:"fire-iid",[LS]:"fire-iid-compat",[OS]:"fire-fcm",[VS]:"fire-fcm-compat",[qS]:"fire-perf",[US]:"fire-perf-compat",[HS]:"fire-rc",[$S]:"fire-rc-compat",[GS]:"fire-gcs",[KS]:"fire-gcs-compat",[QS]:"fire-fst",[XS]:"fire-fst-compat",[YS]:"fire-vertex","fire-js":"fire-js",[JS]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hl=new Map,tT=new Map,du=new Map;function Nm(n,e){try{n.container.addComponent(e)}catch(t){pi.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function Fr(n){const e=n.name;if(du.has(e))return pi.debug(`There were multiple attempts to register component ${e}.`),!1;du.set(e,n);for(const t of Hl.values())Nm(t,n);for(const t of tT.values())Nm(t,n);return!0}function Js(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function nT(n,e,t=Ul){Js(n,e).clearInstance(t)}function mn(n){return n==null?!1:n.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iT={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},qi=new ba("app","Firebase",iT);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rT{constructor(e,t,i){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new Gi("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw qi.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qr=ZS;function xx(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const i=Object.assign({name:Ul,automaticDataCollectionEnabled:!0},e),s=i.name;if(typeof s!="string"||!s)throw qi.create("bad-app-name",{appName:String(s)});if(t||(t=cx()),!t)throw qi.create("no-options");const o=Hl.get(s);if(o){if(Pn(t,o.options)&&Pn(i,o.config))return o;throw qi.create("duplicate-app",{appName:s})}const a=new cS(s);for(const c of du.values())a.addComponent(c);const l=new rT(t,i,a);return Hl.set(s,l),l}function rh(n=Ul){const e=Hl.get(n);if(!e&&n===Ul&&cx())return xx();if(!e)throw qi.create("no-app",{appName:n});return e}function Hn(n,e,t){var i;let s=(i=eT[n])!==null&&i!==void 0?i:n;t&&(s+=`-${t}`);const o=s.match(/\s|\//),a=e.match(/\s|\//);if(o||a){const l=[`Unable to register library "${s}" with version "${e}":`];o&&l.push(`library name "${s}" contains illegal characters (whitespace or "/")`),o&&a&&l.push("and"),a&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),pi.warn(l.join(" "));return}Fr(new Gi(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sT="firebase-heartbeat-database",oT=1,ia="firebase-heartbeat-store";let Ed=null;function bx(){return Ed||(Ed=kS(sT,oT,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(ia)}catch(t){console.warn(t)}}}}).catch(n=>{throw qi.create("idb-open",{originalErrorMessage:n.message})})),Ed}async function aT(n){try{const t=(await bx()).transaction(ia),i=await t.objectStore(ia).get(vx(n));return await t.done,i}catch(e){if(e instanceof Xn)pi.warn(e.message);else{const t=qi.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});pi.warn(t.message)}}}async function Mm(n,e){try{const i=(await bx()).transaction(ia,"readwrite");await i.objectStore(ia).put(e,vx(n)),await i.done}catch(t){if(t instanceof Xn)pi.warn(t.message);else{const i=qi.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});pi.warn(i.message)}}}function vx(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lT=1024,cT=30;class dT{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new hT(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){var e,t;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),o=Wm();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===o||this._heartbeatsCache.heartbeats.some(a=>a.date===o))return;if(this._heartbeatsCache.heartbeats.push({date:o,agent:s}),this._heartbeatsCache.heartbeats.length>cT){const a=pT(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(a,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(i){pi.warn(i)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=Wm(),{heartbeatsToSend:i,unsentEntries:s}=uT(this._heartbeatsCache.heartbeats),o=ql(JSON.stringify({version:2,heartbeats:i}));return this._heartbeatsCache.lastSentHeartbeatDate=t,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),o}catch(t){return pi.warn(t),""}}}function Wm(){return new Date().toISOString().substring(0,10)}function uT(n,e=lT){const t=[];let i=n.slice();for(const s of n){const o=t.find(a=>a.agent===s.agent);if(o){if(o.dates.push(s.date),Lm(t)>e){o.dates.pop();break}}else if(t.push({agent:s.agent,dates:[s.date]}),Lm(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}class hT{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return gx()?J1().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await aT(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const s=await this.read();return Mm(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const s=await this.read();return Mm(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function Lm(n){return ql(JSON.stringify({version:2,heartbeats:n})).length}function pT(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let i=1;i<n.length;i++)n[i].date<t&&(t=n[i].date,e=i);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mT(n){Fr(new Gi("platform-logger",e=>new jS(e),"PRIVATE")),Fr(new Gi("heartbeat",e=>new dT(e),"PRIVATE")),Hn(cu,Dm,n),Hn(cu,Dm,"esm2017"),Hn("fire-js","")}mT("");var gT="firebase",fT="11.9.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Hn(gT,fT,"app");var Om=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Ui,wx;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(B,k){function T(){}T.prototype=k.prototype,B.D=k.prototype,B.prototype=new T,B.prototype.constructor=B,B.C=function(R,E,_){for(var v=Array(arguments.length-2),z=2;z<arguments.length;z++)v[z-2]=arguments[z];return k.prototype[E].apply(R,v)}}function t(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(i,t),i.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(B,k,T){T||(T=0);var R=Array(16);if(typeof k=="string")for(var E=0;16>E;++E)R[E]=k.charCodeAt(T++)|k.charCodeAt(T++)<<8|k.charCodeAt(T++)<<16|k.charCodeAt(T++)<<24;else for(E=0;16>E;++E)R[E]=k[T++]|k[T++]<<8|k[T++]<<16|k[T++]<<24;k=B.g[0],T=B.g[1],E=B.g[2];var _=B.g[3],v=k+(_^T&(E^_))+R[0]+3614090360&4294967295;k=T+(v<<7&4294967295|v>>>25),v=_+(E^k&(T^E))+R[1]+3905402710&4294967295,_=k+(v<<12&4294967295|v>>>20),v=E+(T^_&(k^T))+R[2]+606105819&4294967295,E=_+(v<<17&4294967295|v>>>15),v=T+(k^E&(_^k))+R[3]+3250441966&4294967295,T=E+(v<<22&4294967295|v>>>10),v=k+(_^T&(E^_))+R[4]+4118548399&4294967295,k=T+(v<<7&4294967295|v>>>25),v=_+(E^k&(T^E))+R[5]+1200080426&4294967295,_=k+(v<<12&4294967295|v>>>20),v=E+(T^_&(k^T))+R[6]+2821735955&4294967295,E=_+(v<<17&4294967295|v>>>15),v=T+(k^E&(_^k))+R[7]+4249261313&4294967295,T=E+(v<<22&4294967295|v>>>10),v=k+(_^T&(E^_))+R[8]+1770035416&4294967295,k=T+(v<<7&4294967295|v>>>25),v=_+(E^k&(T^E))+R[9]+2336552879&4294967295,_=k+(v<<12&4294967295|v>>>20),v=E+(T^_&(k^T))+R[10]+4294925233&4294967295,E=_+(v<<17&4294967295|v>>>15),v=T+(k^E&(_^k))+R[11]+2304563134&4294967295,T=E+(v<<22&4294967295|v>>>10),v=k+(_^T&(E^_))+R[12]+1804603682&4294967295,k=T+(v<<7&4294967295|v>>>25),v=_+(E^k&(T^E))+R[13]+4254626195&4294967295,_=k+(v<<12&4294967295|v>>>20),v=E+(T^_&(k^T))+R[14]+2792965006&4294967295,E=_+(v<<17&4294967295|v>>>15),v=T+(k^E&(_^k))+R[15]+1236535329&4294967295,T=E+(v<<22&4294967295|v>>>10),v=k+(E^_&(T^E))+R[1]+4129170786&4294967295,k=T+(v<<5&4294967295|v>>>27),v=_+(T^E&(k^T))+R[6]+3225465664&4294967295,_=k+(v<<9&4294967295|v>>>23),v=E+(k^T&(_^k))+R[11]+643717713&4294967295,E=_+(v<<14&4294967295|v>>>18),v=T+(_^k&(E^_))+R[0]+3921069994&4294967295,T=E+(v<<20&4294967295|v>>>12),v=k+(E^_&(T^E))+R[5]+3593408605&4294967295,k=T+(v<<5&4294967295|v>>>27),v=_+(T^E&(k^T))+R[10]+38016083&4294967295,_=k+(v<<9&4294967295|v>>>23),v=E+(k^T&(_^k))+R[15]+3634488961&4294967295,E=_+(v<<14&4294967295|v>>>18),v=T+(_^k&(E^_))+R[4]+3889429448&4294967295,T=E+(v<<20&4294967295|v>>>12),v=k+(E^_&(T^E))+R[9]+568446438&4294967295,k=T+(v<<5&4294967295|v>>>27),v=_+(T^E&(k^T))+R[14]+3275163606&4294967295,_=k+(v<<9&4294967295|v>>>23),v=E+(k^T&(_^k))+R[3]+4107603335&4294967295,E=_+(v<<14&4294967295|v>>>18),v=T+(_^k&(E^_))+R[8]+1163531501&4294967295,T=E+(v<<20&4294967295|v>>>12),v=k+(E^_&(T^E))+R[13]+2850285829&4294967295,k=T+(v<<5&4294967295|v>>>27),v=_+(T^E&(k^T))+R[2]+4243563512&4294967295,_=k+(v<<9&4294967295|v>>>23),v=E+(k^T&(_^k))+R[7]+1735328473&4294967295,E=_+(v<<14&4294967295|v>>>18),v=T+(_^k&(E^_))+R[12]+2368359562&4294967295,T=E+(v<<20&4294967295|v>>>12),v=k+(T^E^_)+R[5]+4294588738&4294967295,k=T+(v<<4&4294967295|v>>>28),v=_+(k^T^E)+R[8]+2272392833&4294967295,_=k+(v<<11&4294967295|v>>>21),v=E+(_^k^T)+R[11]+1839030562&4294967295,E=_+(v<<16&4294967295|v>>>16),v=T+(E^_^k)+R[14]+4259657740&4294967295,T=E+(v<<23&4294967295|v>>>9),v=k+(T^E^_)+R[1]+2763975236&4294967295,k=T+(v<<4&4294967295|v>>>28),v=_+(k^T^E)+R[4]+1272893353&4294967295,_=k+(v<<11&4294967295|v>>>21),v=E+(_^k^T)+R[7]+4139469664&4294967295,E=_+(v<<16&4294967295|v>>>16),v=T+(E^_^k)+R[10]+3200236656&4294967295,T=E+(v<<23&4294967295|v>>>9),v=k+(T^E^_)+R[13]+681279174&4294967295,k=T+(v<<4&4294967295|v>>>28),v=_+(k^T^E)+R[0]+3936430074&4294967295,_=k+(v<<11&4294967295|v>>>21),v=E+(_^k^T)+R[3]+3572445317&4294967295,E=_+(v<<16&4294967295|v>>>16),v=T+(E^_^k)+R[6]+76029189&4294967295,T=E+(v<<23&4294967295|v>>>9),v=k+(T^E^_)+R[9]+3654602809&4294967295,k=T+(v<<4&4294967295|v>>>28),v=_+(k^T^E)+R[12]+3873151461&4294967295,_=k+(v<<11&4294967295|v>>>21),v=E+(_^k^T)+R[15]+530742520&4294967295,E=_+(v<<16&4294967295|v>>>16),v=T+(E^_^k)+R[2]+3299628645&4294967295,T=E+(v<<23&4294967295|v>>>9),v=k+(E^(T|~_))+R[0]+4096336452&4294967295,k=T+(v<<6&4294967295|v>>>26),v=_+(T^(k|~E))+R[7]+1126891415&4294967295,_=k+(v<<10&4294967295|v>>>22),v=E+(k^(_|~T))+R[14]+2878612391&4294967295,E=_+(v<<15&4294967295|v>>>17),v=T+(_^(E|~k))+R[5]+4237533241&4294967295,T=E+(v<<21&4294967295|v>>>11),v=k+(E^(T|~_))+R[12]+1700485571&4294967295,k=T+(v<<6&4294967295|v>>>26),v=_+(T^(k|~E))+R[3]+2399980690&4294967295,_=k+(v<<10&4294967295|v>>>22),v=E+(k^(_|~T))+R[10]+4293915773&4294967295,E=_+(v<<15&4294967295|v>>>17),v=T+(_^(E|~k))+R[1]+2240044497&4294967295,T=E+(v<<21&4294967295|v>>>11),v=k+(E^(T|~_))+R[8]+1873313359&4294967295,k=T+(v<<6&4294967295|v>>>26),v=_+(T^(k|~E))+R[15]+4264355552&4294967295,_=k+(v<<10&4294967295|v>>>22),v=E+(k^(_|~T))+R[6]+2734768916&4294967295,E=_+(v<<15&4294967295|v>>>17),v=T+(_^(E|~k))+R[13]+1309151649&4294967295,T=E+(v<<21&4294967295|v>>>11),v=k+(E^(T|~_))+R[4]+4149444226&4294967295,k=T+(v<<6&4294967295|v>>>26),v=_+(T^(k|~E))+R[11]+3174756917&4294967295,_=k+(v<<10&4294967295|v>>>22),v=E+(k^(_|~T))+R[2]+718787259&4294967295,E=_+(v<<15&4294967295|v>>>17),v=T+(_^(E|~k))+R[9]+3951481745&4294967295,B.g[0]=B.g[0]+k&4294967295,B.g[1]=B.g[1]+(E+(v<<21&4294967295|v>>>11))&4294967295,B.g[2]=B.g[2]+E&4294967295,B.g[3]=B.g[3]+_&4294967295}i.prototype.u=function(B,k){k===void 0&&(k=B.length);for(var T=k-this.blockSize,R=this.B,E=this.h,_=0;_<k;){if(E==0)for(;_<=T;)s(this,B,_),_+=this.blockSize;if(typeof B=="string"){for(;_<k;)if(R[E++]=B.charCodeAt(_++),E==this.blockSize){s(this,R),E=0;break}}else for(;_<k;)if(R[E++]=B[_++],E==this.blockSize){s(this,R),E=0;break}}this.h=E,this.o+=k},i.prototype.v=function(){var B=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);B[0]=128;for(var k=1;k<B.length-8;++k)B[k]=0;var T=8*this.o;for(k=B.length-8;k<B.length;++k)B[k]=T&255,T/=256;for(this.u(B),B=Array(16),k=T=0;4>k;++k)for(var R=0;32>R;R+=8)B[T++]=this.g[k]>>>R&255;return B};function o(B,k){var T=l;return Object.prototype.hasOwnProperty.call(T,B)?T[B]:T[B]=k(B)}function a(B,k){this.h=k;for(var T=[],R=!0,E=B.length-1;0<=E;E--){var _=B[E]|0;R&&_==k||(T[E]=_,R=!1)}this.g=T}var l={};function c(B){return-128<=B&&128>B?o(B,function(k){return new a([k|0],0>k?-1:0)}):new a([B|0],0>B?-1:0)}function u(B){if(isNaN(B)||!isFinite(B))return p;if(0>B)return w(u(-B));for(var k=[],T=1,R=0;B>=T;R++)k[R]=B/T|0,T*=4294967296;return new a(k,0)}function h(B,k){if(B.length==0)throw Error("number format error: empty string");if(k=k||10,2>k||36<k)throw Error("radix out of range: "+k);if(B.charAt(0)=="-")return w(h(B.substring(1),k));if(0<=B.indexOf("-"))throw Error('number format error: interior "-" character');for(var T=u(Math.pow(k,8)),R=p,E=0;E<B.length;E+=8){var _=Math.min(8,B.length-E),v=parseInt(B.substring(E,E+_),k);8>_?(_=u(Math.pow(k,_)),R=R.j(_).add(u(v))):(R=R.j(T),R=R.add(u(v)))}return R}var p=c(0),f=c(1),b=c(16777216);n=a.prototype,n.m=function(){if(S(this))return-w(this).m();for(var B=0,k=1,T=0;T<this.g.length;T++){var R=this.i(T);B+=(0<=R?R:4294967296+R)*k,k*=4294967296}return B},n.toString=function(B){if(B=B||10,2>B||36<B)throw Error("radix out of range: "+B);if(x(this))return"0";if(S(this))return"-"+w(this).toString(B);for(var k=u(Math.pow(B,6)),T=this,R="";;){var E=D(T,k).g;T=I(T,E.j(k));var _=((0<T.g.length?T.g[0]:T.h)>>>0).toString(B);if(T=E,x(T))return _+R;for(;6>_.length;)_="0"+_;R=_+R}},n.i=function(B){return 0>B?0:B<this.g.length?this.g[B]:this.h};function x(B){if(B.h!=0)return!1;for(var k=0;k<B.g.length;k++)if(B.g[k]!=0)return!1;return!0}function S(B){return B.h==-1}n.l=function(B){return B=I(this,B),S(B)?-1:x(B)?0:1};function w(B){for(var k=B.g.length,T=[],R=0;R<k;R++)T[R]=~B.g[R];return new a(T,~B.h).add(f)}n.abs=function(){return S(this)?w(this):this},n.add=function(B){for(var k=Math.max(this.g.length,B.g.length),T=[],R=0,E=0;E<=k;E++){var _=R+(this.i(E)&65535)+(B.i(E)&65535),v=(_>>>16)+(this.i(E)>>>16)+(B.i(E)>>>16);R=v>>>16,_&=65535,v&=65535,T[E]=v<<16|_}return new a(T,T[T.length-1]&-2147483648?-1:0)};function I(B,k){return B.add(w(k))}n.j=function(B){if(x(this)||x(B))return p;if(S(this))return S(B)?w(this).j(w(B)):w(w(this).j(B));if(S(B))return w(this.j(w(B)));if(0>this.l(b)&&0>B.l(b))return u(this.m()*B.m());for(var k=this.g.length+B.g.length,T=[],R=0;R<2*k;R++)T[R]=0;for(R=0;R<this.g.length;R++)for(var E=0;E<B.g.length;E++){var _=this.i(R)>>>16,v=this.i(R)&65535,z=B.i(E)>>>16,H=B.i(E)&65535;T[2*R+2*E]+=v*H,j(T,2*R+2*E),T[2*R+2*E+1]+=_*H,j(T,2*R+2*E+1),T[2*R+2*E+1]+=v*z,j(T,2*R+2*E+1),T[2*R+2*E+2]+=_*z,j(T,2*R+2*E+2)}for(R=0;R<k;R++)T[R]=T[2*R+1]<<16|T[2*R];for(R=k;R<2*k;R++)T[R]=0;return new a(T,0)};function j(B,k){for(;(B[k]&65535)!=B[k];)B[k+1]+=B[k]>>>16,B[k]&=65535,k++}function A(B,k){this.g=B,this.h=k}function D(B,k){if(x(k))throw Error("division by zero");if(x(B))return new A(p,p);if(S(B))return k=D(w(B),k),new A(w(k.g),w(k.h));if(S(k))return k=D(B,w(k)),new A(w(k.g),k.h);if(30<B.g.length){if(S(B)||S(k))throw Error("slowDivide_ only works with positive integers.");for(var T=f,R=k;0>=R.l(B);)T=O(T),R=O(R);var E=P(T,1),_=P(R,1);for(R=P(R,2),T=P(T,2);!x(R);){var v=_.add(R);0>=v.l(B)&&(E=E.add(T),_=v),R=P(R,1),T=P(T,1)}return k=I(B,E.j(k)),new A(E,k)}for(E=p;0<=B.l(k);){for(T=Math.max(1,Math.floor(B.m()/k.m())),R=Math.ceil(Math.log(T)/Math.LN2),R=48>=R?1:Math.pow(2,R-48),_=u(T),v=_.j(k);S(v)||0<v.l(B);)T-=R,_=u(T),v=_.j(k);x(_)&&(_=f),E=E.add(_),B=I(B,v)}return new A(E,B)}n.A=function(B){return D(this,B).h},n.and=function(B){for(var k=Math.max(this.g.length,B.g.length),T=[],R=0;R<k;R++)T[R]=this.i(R)&B.i(R);return new a(T,this.h&B.h)},n.or=function(B){for(var k=Math.max(this.g.length,B.g.length),T=[],R=0;R<k;R++)T[R]=this.i(R)|B.i(R);return new a(T,this.h|B.h)},n.xor=function(B){for(var k=Math.max(this.g.length,B.g.length),T=[],R=0;R<k;R++)T[R]=this.i(R)^B.i(R);return new a(T,this.h^B.h)};function O(B){for(var k=B.g.length+1,T=[],R=0;R<k;R++)T[R]=B.i(R)<<1|B.i(R-1)>>>31;return new a(T,B.h)}function P(B,k){var T=k>>5;k%=32;for(var R=B.g.length-T,E=[],_=0;_<R;_++)E[_]=0<k?B.i(_+T)>>>k|B.i(_+T+1)<<32-k:B.i(_+T);return new a(E,B.h)}i.prototype.digest=i.prototype.v,i.prototype.reset=i.prototype.s,i.prototype.update=i.prototype.u,wx=i,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.A,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=u,a.fromString=h,Ui=a}).apply(typeof Om<"u"?Om:typeof self<"u"?self:typeof window<"u"?window:{});var ul=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var kx,Mo,Sx,jl,uu,Tx,jx,_x;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(d,m,y){return d==Array.prototype||d==Object.prototype||(d[m]=y.value),d};function t(d){d=[typeof globalThis=="object"&&globalThis,d,typeof window=="object"&&window,typeof self=="object"&&self,typeof ul=="object"&&ul];for(var m=0;m<d.length;++m){var y=d[m];if(y&&y.Math==Math)return y}throw Error("Cannot find global object")}var i=t(this);function s(d,m){if(m)e:{var y=i;d=d.split(".");for(var C=0;C<d.length-1;C++){var Q=d[C];if(!(Q in y))break e;y=y[Q]}d=d[d.length-1],C=y[d],m=m(C),m!=C&&m!=null&&e(y,d,{configurable:!0,writable:!0,value:m})}}function o(d,m){d instanceof String&&(d+="");var y=0,C=!1,Q={next:function(){if(!C&&y<d.length){var se=y++;return{value:m(se,d[se]),done:!1}}return C=!0,{done:!0,value:void 0}}};return Q[Symbol.iterator]=function(){return Q},Q}s("Array.prototype.values",function(d){return d||function(){return o(this,function(m,y){return y})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var a=a||{},l=this||self;function c(d){var m=typeof d;return m=m!="object"?m:d?Array.isArray(d)?"array":m:"null",m=="array"||m=="object"&&typeof d.length=="number"}function u(d){var m=typeof d;return m=="object"&&d!=null||m=="function"}function h(d,m,y){return d.call.apply(d.bind,arguments)}function p(d,m,y){if(!d)throw Error();if(2<arguments.length){var C=Array.prototype.slice.call(arguments,2);return function(){var Q=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(Q,C),d.apply(m,Q)}}return function(){return d.apply(m,arguments)}}function f(d,m,y){return f=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?h:p,f.apply(null,arguments)}function b(d,m){var y=Array.prototype.slice.call(arguments,1);return function(){var C=y.slice();return C.push.apply(C,arguments),d.apply(this,C)}}function x(d,m){function y(){}y.prototype=m.prototype,d.aa=m.prototype,d.prototype=new y,d.prototype.constructor=d,d.Qb=function(C,Q,se){for(var Se=Array(arguments.length-2),ft=2;ft<arguments.length;ft++)Se[ft-2]=arguments[ft];return m.prototype[Q].apply(C,Se)}}function S(d){const m=d.length;if(0<m){const y=Array(m);for(let C=0;C<m;C++)y[C]=d[C];return y}return[]}function w(d,m){for(let y=1;y<arguments.length;y++){const C=arguments[y];if(c(C)){const Q=d.length||0,se=C.length||0;d.length=Q+se;for(let Se=0;Se<se;Se++)d[Q+Se]=C[Se]}else d.push(C)}}class I{constructor(m,y){this.i=m,this.j=y,this.h=0,this.g=null}get(){let m;return 0<this.h?(this.h--,m=this.g,this.g=m.next,m.next=null):m=this.i(),m}}function j(d){return/^[\s\xa0]*$/.test(d)}function A(){var d=l.navigator;return d&&(d=d.userAgent)?d:""}function D(d){return D[" "](d),d}D[" "]=function(){};var O=A().indexOf("Gecko")!=-1&&!(A().toLowerCase().indexOf("webkit")!=-1&&A().indexOf("Edge")==-1)&&!(A().indexOf("Trident")!=-1||A().indexOf("MSIE")!=-1)&&A().indexOf("Edge")==-1;function P(d,m,y){for(const C in d)m.call(y,d[C],C,d)}function B(d,m){for(const y in d)m.call(void 0,d[y],y,d)}function k(d){const m={};for(const y in d)m[y]=d[y];return m}const T="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function R(d,m){let y,C;for(let Q=1;Q<arguments.length;Q++){C=arguments[Q];for(y in C)d[y]=C[y];for(let se=0;se<T.length;se++)y=T[se],Object.prototype.hasOwnProperty.call(C,y)&&(d[y]=C[y])}}function E(d){var m=1;d=d.split(":");const y=[];for(;0<m&&d.length;)y.push(d.shift()),m--;return d.length&&y.push(d.join(":")),y}function _(d){l.setTimeout(()=>{throw d},0)}function v(){var d=oe;let m=null;return d.g&&(m=d.g,d.g=d.g.next,d.g||(d.h=null),m.next=null),m}class z{constructor(){this.h=this.g=null}add(m,y){const C=H.get();C.set(m,y),this.h?this.h.next=C:this.g=C,this.h=C}}var H=new I(()=>new L,d=>d.reset());class L{constructor(){this.next=this.g=this.h=null}set(m,y){this.h=m,this.g=y,this.next=null}reset(){this.next=this.g=this.h=null}}let ee,ge=!1,oe=new z,Ie=()=>{const d=l.Promise.resolve(void 0);ee=()=>{d.then(Re)}};var Re=()=>{for(var d;d=v();){try{d.h.call(d.g)}catch(y){_(y)}var m=H;m.j(d),100>m.h&&(m.h++,d.next=m.g,m.g=d)}ge=!1};function te(){this.s=this.s,this.C=this.C}te.prototype.s=!1,te.prototype.ma=function(){this.s||(this.s=!0,this.N())},te.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function W(d,m){this.type=d,this.g=this.target=m,this.defaultPrevented=!1}W.prototype.h=function(){this.defaultPrevented=!0};var Y=function(){if(!l.addEventListener||!Object.defineProperty)return!1;var d=!1,m=Object.defineProperty({},"passive",{get:function(){d=!0}});try{const y=()=>{};l.addEventListener("test",y,m),l.removeEventListener("test",y,m)}catch{}return d}();function X(d,m){if(W.call(this,d?d.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,d){var y=this.type=d.type,C=d.changedTouches&&d.changedTouches.length?d.changedTouches[0]:null;if(this.target=d.target||d.srcElement,this.g=m,m=d.relatedTarget){if(O){e:{try{D(m.nodeName);var Q=!0;break e}catch{}Q=!1}Q||(m=null)}}else y=="mouseover"?m=d.fromElement:y=="mouseout"&&(m=d.toElement);this.relatedTarget=m,C?(this.clientX=C.clientX!==void 0?C.clientX:C.pageX,this.clientY=C.clientY!==void 0?C.clientY:C.pageY,this.screenX=C.screenX||0,this.screenY=C.screenY||0):(this.clientX=d.clientX!==void 0?d.clientX:d.pageX,this.clientY=d.clientY!==void 0?d.clientY:d.pageY,this.screenX=d.screenX||0,this.screenY=d.screenY||0),this.button=d.button,this.key=d.key||"",this.ctrlKey=d.ctrlKey,this.altKey=d.altKey,this.shiftKey=d.shiftKey,this.metaKey=d.metaKey,this.pointerId=d.pointerId||0,this.pointerType=typeof d.pointerType=="string"?d.pointerType:le[d.pointerType]||"",this.state=d.state,this.i=d,d.defaultPrevented&&X.aa.h.call(this)}}x(X,W);var le={2:"touch",3:"pen",4:"mouse"};X.prototype.h=function(){X.aa.h.call(this);var d=this.i;d.preventDefault?d.preventDefault():d.returnValue=!1};var be="closure_listenable_"+(1e6*Math.random()|0),ve=0;function Me(d,m,y,C,Q){this.listener=d,this.proxy=null,this.src=m,this.type=y,this.capture=!!C,this.ha=Q,this.key=++ve,this.da=this.fa=!1}function Ve(d){d.da=!0,d.listener=null,d.proxy=null,d.src=null,d.ha=null}function ie(d){this.src=d,this.g={},this.h=0}ie.prototype.add=function(d,m,y,C,Q){var se=d.toString();d=this.g[se],d||(d=this.g[se]=[],this.h++);var Se=We(d,m,C,Q);return-1<Se?(m=d[Se],y||(m.fa=!1)):(m=new Me(m,this.src,se,!!C,Q),m.fa=y,d.push(m)),m};function $(d,m){var y=m.type;if(y in d.g){var C=d.g[y],Q=Array.prototype.indexOf.call(C,m,void 0),se;(se=0<=Q)&&Array.prototype.splice.call(C,Q,1),se&&(Ve(m),d.g[y].length==0&&(delete d.g[y],d.h--))}}function We(d,m,y,C){for(var Q=0;Q<d.length;++Q){var se=d[Q];if(!se.da&&se.listener==m&&se.capture==!!y&&se.ha==C)return Q}return-1}var _e="closure_lm_"+(1e6*Math.random()|0),ye={};function J(d,m,y,C,Q){if(Array.isArray(m)){for(var se=0;se<m.length;se++)J(d,m[se],y,C,Q);return null}return y=Ne(y),d&&d[be]?d.K(m,y,u(C)?!!C.capture:!1,Q):pe(d,m,y,!1,C,Q)}function pe(d,m,y,C,Q,se){if(!m)throw Error("Invalid event type");var Se=u(Q)?!!Q.capture:!!Q,ft=F(d);if(ft||(d[_e]=ft=new ie(d)),y=ft.add(m,y,C,Se,se),y.proxy)return y;if(C=ce(),y.proxy=C,C.src=d,C.listener=y,d.addEventListener)Y||(Q=Se),Q===void 0&&(Q=!1),d.addEventListener(m.toString(),C,Q);else if(d.attachEvent)d.attachEvent(M(m.toString()),C);else if(d.addListener&&d.removeListener)d.addListener(C);else throw Error("addEventListener and attachEvent are unavailable.");return y}function ce(){function d(y){return m.call(d.src,d.listener,y)}const m=q;return d}function me(d,m,y,C,Q){if(Array.isArray(m))for(var se=0;se<m.length;se++)me(d,m[se],y,C,Q);else C=u(C)?!!C.capture:!!C,y=Ne(y),d&&d[be]?(d=d.i,m=String(m).toString(),m in d.g&&(se=d.g[m],y=We(se,y,C,Q),-1<y&&(Ve(se[y]),Array.prototype.splice.call(se,y,1),se.length==0&&(delete d.g[m],d.h--)))):d&&(d=F(d))&&(m=d.g[m.toString()],d=-1,m&&(d=We(m,y,C,Q)),(y=-1<d?m[d]:null)&&xe(y))}function xe(d){if(typeof d!="number"&&d&&!d.da){var m=d.src;if(m&&m[be])$(m.i,d);else{var y=d.type,C=d.proxy;m.removeEventListener?m.removeEventListener(y,C,d.capture):m.detachEvent?m.detachEvent(M(y),C):m.addListener&&m.removeListener&&m.removeListener(C),(y=F(m))?($(y,d),y.h==0&&(y.src=null,m[_e]=null)):Ve(d)}}}function M(d){return d in ye?ye[d]:ye[d]="on"+d}function q(d,m){if(d.da)d=!0;else{m=new X(m,this);var y=d.listener,C=d.ha||d.src;d.fa&&xe(d),d=y.call(C,m)}return d}function F(d){return d=d[_e],d instanceof ie?d:null}var we="__closure_events_fn_"+(1e9*Math.random()>>>0);function Ne(d){return typeof d=="function"?d:(d[we]||(d[we]=function(m){return d.handleEvent(m)}),d[we])}function Fe(){te.call(this),this.i=new ie(this),this.M=this,this.F=null}x(Fe,te),Fe.prototype[be]=!0,Fe.prototype.removeEventListener=function(d,m,y,C){me(this,d,m,y,C)};function Ue(d,m){var y,C=d.F;if(C)for(y=[];C;C=C.F)y.push(C);if(d=d.M,C=m.type||m,typeof m=="string")m=new W(m,d);else if(m instanceof W)m.target=m.target||d;else{var Q=m;m=new W(C,d),R(m,Q)}if(Q=!0,y)for(var se=y.length-1;0<=se;se--){var Se=m.g=y[se];Q=Ct(Se,C,!0,m)&&Q}if(Se=m.g=d,Q=Ct(Se,C,!0,m)&&Q,Q=Ct(Se,C,!1,m)&&Q,y)for(se=0;se<y.length;se++)Se=m.g=y[se],Q=Ct(Se,C,!1,m)&&Q}Fe.prototype.N=function(){if(Fe.aa.N.call(this),this.i){var d=this.i,m;for(m in d.g){for(var y=d.g[m],C=0;C<y.length;C++)Ve(y[C]);delete d.g[m],d.h--}}this.F=null},Fe.prototype.K=function(d,m,y,C){return this.i.add(String(d),m,!1,y,C)},Fe.prototype.L=function(d,m,y,C){return this.i.add(String(d),m,!0,y,C)};function Ct(d,m,y,C){if(m=d.i.g[String(m)],!m)return!0;m=m.concat();for(var Q=!0,se=0;se<m.length;++se){var Se=m[se];if(Se&&!Se.da&&Se.capture==y){var ft=Se.listener,Xt=Se.ha||Se.src;Se.fa&&$(d.i,Se),Q=ft.call(Xt,C)!==!1&&Q}}return Q&&!C.defaultPrevented}function ae(d,m,y){if(typeof d=="function")y&&(d=f(d,y));else if(d&&typeof d.handleEvent=="function")d=f(d.handleEvent,d);else throw Error("Invalid listener argument");return 2147483647<Number(m)?-1:l.setTimeout(d,m||0)}function Be(d){d.g=ae(()=>{d.g=null,d.i&&(d.i=!1,Be(d))},d.l);const m=d.h;d.h=null,d.m.apply(null,m)}class ct extends te{constructor(m,y){super(),this.m=m,this.l=y,this.h=null,this.i=!1,this.g=null}j(m){this.h=arguments,this.g?this.i=!0:Be(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function et(d){te.call(this),this.h=d,this.g={}}x(et,te);var ot=[];function ne(d){P(d.g,function(m,y){this.g.hasOwnProperty(y)&&xe(m)},d),d.g={}}et.prototype.N=function(){et.aa.N.call(this),ne(this)},et.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var G=l.JSON.stringify,U=l.JSON.parse,N=class{stringify(d){return l.JSON.stringify(d,void 0)}parse(d){return l.JSON.parse(d,void 0)}};function V(){}V.prototype.h=null;function he(d){return d.h||(d.h=d.i())}function fe(){}var ze={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Ce(){W.call(this,"d")}x(Ce,W);function Ee(){W.call(this,"c")}x(Ee,W);var Ye={},Xe=null;function dt(){return Xe=Xe||new Fe}Ye.La="serverreachability";function tn(d){W.call(this,Ye.La,d)}x(tn,W);function In(d){const m=dt();Ue(m,new tn(m))}Ye.STAT_EVENT="statevent";function zn(d,m){W.call(this,Ye.STAT_EVENT,d),this.stat=m}x(zn,W);function Nt(d){const m=dt();Ue(m,new zn(m,d))}Ye.Ma="timingevent";function Rt(d,m){W.call(this,Ye.Ma,d),this.size=m}x(Rt,W);function _i(d,m){if(typeof d!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){d()},m)}function Ii(){this.g=!0}Ii.prototype.xa=function(){this.g=!1};function Qa(d,m,y,C,Q,se){d.info(function(){if(d.g)if(se)for(var Se="",ft=se.split("&"),Xt=0;Xt<ft.length;Xt++){var at=ft[Xt].split("=");if(1<at.length){var nn=at[0];at=at[1];var rn=nn.split("_");Se=2<=rn.length&&rn[1]=="type"?Se+(nn+"="+at+"&"):Se+(nn+"=redacted&")}}else Se=null;else Se=se;return"XMLHTTP REQ ("+C+") [attempt "+Q+"]: "+m+`
`+y+`
`+Se})}function He(d,m,y,C,Q,se,Se){d.info(function(){return"XMLHTTP RESP ("+C+") [ attempt "+Q+"]: "+m+`
`+y+`
`+se+" "+Se})}function Dn(d,m,y,C){d.info(function(){return"XMLHTTP TEXT ("+m+"): "+hd(d,y)+(C?" "+C:"")})}function yo(d,m){d.info(function(){return"TIMEOUT: "+m})}Ii.prototype.info=function(){};function hd(d,m){if(!d.g)return m;if(!m)return null;try{var y=JSON.parse(m);if(y){for(d=0;d<y.length;d++)if(Array.isArray(y[d])){var C=y[d];if(!(2>C.length)){var Q=C[1];if(Array.isArray(Q)&&!(1>Q.length)){var se=Q[0];if(se!="noop"&&se!="stop"&&se!="close")for(var Se=1;Se<Q.length;Se++)Q[Se]=""}}}}return G(y)}catch{return m}}var Ya={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Fp={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},pd;function Xa(){}x(Xa,V),Xa.prototype.g=function(){return new XMLHttpRequest},Xa.prototype.i=function(){return{}},pd=new Xa;function Ci(d,m,y,C){this.j=d,this.i=m,this.l=y,this.R=C||1,this.U=new et(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new zp}function zp(){this.i=null,this.g="",this.h=!1}var Dp={},md={};function gd(d,m,y){d.L=1,d.v=tl(ei(m)),d.m=y,d.P=!0,Np(d,null)}function Np(d,m){d.F=Date.now(),Ja(d),d.A=ei(d.v);var y=d.A,C=d.R;Array.isArray(C)||(C=[String(C)]),Xp(y.i,"t",C),d.C=0,y=d.j.J,d.h=new zp,d.g=gm(d.j,y?m:null,!d.m),0<d.O&&(d.M=new ct(f(d.Y,d,d.g),d.O)),m=d.U,y=d.g,C=d.ca;var Q="readystatechange";Array.isArray(Q)||(Q&&(ot[0]=Q.toString()),Q=ot);for(var se=0;se<Q.length;se++){var Se=J(y,Q[se],C||m.handleEvent,!1,m.h||m);if(!Se)break;m.g[Se.key]=Se}m=d.H?k(d.H):{},d.m?(d.u||(d.u="POST"),m["Content-Type"]="application/x-www-form-urlencoded",d.g.ea(d.A,d.u,d.m,m)):(d.u="GET",d.g.ea(d.A,d.u,null,m)),In(),Qa(d.i,d.u,d.A,d.l,d.R,d.m)}Ci.prototype.ca=function(d){d=d.target;const m=this.M;m&&ti(d)==3?m.j():this.Y(d)},Ci.prototype.Y=function(d){try{if(d==this.g)e:{const rn=ti(this.g);var m=this.g.Ba();const is=this.g.Z();if(!(3>rn)&&(rn!=3||this.g&&(this.h.h||this.g.oa()||rm(this.g)))){this.J||rn!=4||m==7||(m==8||0>=is?In(3):In(2)),fd(this);var y=this.g.Z();this.X=y;t:if(Mp(this)){var C=rm(this.g);d="";var Q=C.length,se=ti(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){hr(this),xo(this);var Se="";break t}this.h.i=new l.TextDecoder}for(m=0;m<Q;m++)this.h.h=!0,d+=this.h.i.decode(C[m],{stream:!(se&&m==Q-1)});C.length=0,this.h.g+=d,this.C=0,Se=this.h.g}else Se=this.g.oa();if(this.o=y==200,He(this.i,this.u,this.A,this.l,this.R,rn,y),this.o){if(this.T&&!this.K){t:{if(this.g){var ft,Xt=this.g;if((ft=Xt.g?Xt.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!j(ft)){var at=ft;break t}}at=null}if(y=at)Dn(this.i,this.l,y,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,yd(this,y);else{this.o=!1,this.s=3,Nt(12),hr(this),xo(this);break e}}if(this.P){y=!0;let Cn;for(;!this.J&&this.C<Se.length;)if(Cn=pk(this,Se),Cn==md){rn==4&&(this.s=4,Nt(14),y=!1),Dn(this.i,this.l,null,"[Incomplete Response]");break}else if(Cn==Dp){this.s=4,Nt(15),Dn(this.i,this.l,Se,"[Invalid Chunk]"),y=!1;break}else Dn(this.i,this.l,Cn,null),yd(this,Cn);if(Mp(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),rn!=4||Se.length!=0||this.h.h||(this.s=1,Nt(16),y=!1),this.o=this.o&&y,!y)Dn(this.i,this.l,Se,"[Invalid Chunked Response]"),hr(this),xo(this);else if(0<Se.length&&!this.W){this.W=!0;var nn=this.j;nn.g==this&&nn.ba&&!nn.M&&(nn.j.info("Great, no buffering proxy detected. Bytes received: "+Se.length),Sd(nn),nn.M=!0,Nt(11))}}else Dn(this.i,this.l,Se,null),yd(this,Se);rn==4&&hr(this),this.o&&!this.J&&(rn==4?um(this.j,this):(this.o=!1,Ja(this)))}else Ak(this.g),y==400&&0<Se.indexOf("Unknown SID")?(this.s=3,Nt(12)):(this.s=0,Nt(13)),hr(this),xo(this)}}}catch{}finally{}};function Mp(d){return d.g?d.u=="GET"&&d.L!=2&&d.j.Ca:!1}function pk(d,m){var y=d.C,C=m.indexOf(`
`,y);return C==-1?md:(y=Number(m.substring(y,C)),isNaN(y)?Dp:(C+=1,C+y>m.length?md:(m=m.slice(C,C+y),d.C=C+y,m)))}Ci.prototype.cancel=function(){this.J=!0,hr(this)};function Ja(d){d.S=Date.now()+d.I,Wp(d,d.I)}function Wp(d,m){if(d.B!=null)throw Error("WatchDog timer not null");d.B=_i(f(d.ba,d),m)}function fd(d){d.B&&(l.clearTimeout(d.B),d.B=null)}Ci.prototype.ba=function(){this.B=null;const d=Date.now();0<=d-this.S?(yo(this.i,this.A),this.L!=2&&(In(),Nt(17)),hr(this),this.s=2,xo(this)):Wp(this,this.S-d)};function xo(d){d.j.G==0||d.J||um(d.j,d)}function hr(d){fd(d);var m=d.M;m&&typeof m.ma=="function"&&m.ma(),d.M=null,ne(d.U),d.g&&(m=d.g,d.g=null,m.abort(),m.ma())}function yd(d,m){try{var y=d.j;if(y.G!=0&&(y.g==d||xd(y.h,d))){if(!d.K&&xd(y.h,d)&&y.G==3){try{var C=y.Da.g.parse(m)}catch{C=null}if(Array.isArray(C)&&C.length==3){var Q=C;if(Q[0]==0){e:if(!y.u){if(y.g)if(y.g.F+3e3<d.F)al(y),sl(y);else break e;kd(y),Nt(18)}}else y.za=Q[1],0<y.za-y.T&&37500>Q[2]&&y.F&&y.v==0&&!y.C&&(y.C=_i(f(y.Za,y),6e3));if(1>=Vp(y.h)&&y.ca){try{y.ca()}catch{}y.ca=void 0}}else mr(y,11)}else if((d.K||y.g==d)&&al(y),!j(m))for(Q=y.Da.g.parse(m),m=0;m<Q.length;m++){let at=Q[m];if(y.T=at[0],at=at[1],y.G==2)if(at[0]=="c"){y.K=at[1],y.ia=at[2];const nn=at[3];nn!=null&&(y.la=nn,y.j.info("VER="+y.la));const rn=at[4];rn!=null&&(y.Aa=rn,y.j.info("SVER="+y.Aa));const is=at[5];is!=null&&typeof is=="number"&&0<is&&(C=1.5*is,y.L=C,y.j.info("backChannelRequestTimeoutMs_="+C)),C=y;const Cn=d.g;if(Cn){const cl=Cn.g?Cn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(cl){var se=C.h;se.g||cl.indexOf("spdy")==-1&&cl.indexOf("quic")==-1&&cl.indexOf("h2")==-1||(se.j=se.l,se.g=new Set,se.h&&(bd(se,se.h),se.h=null))}if(C.D){const Td=Cn.g?Cn.g.getResponseHeader("X-HTTP-Session-Id"):null;Td&&(C.ya=Td,wt(C.I,C.D,Td))}}y.G=3,y.l&&y.l.ua(),y.ba&&(y.R=Date.now()-d.F,y.j.info("Handshake RTT: "+y.R+"ms")),C=y;var Se=d;if(C.qa=mm(C,C.J?C.ia:null,C.W),Se.K){qp(C.h,Se);var ft=Se,Xt=C.L;Xt&&(ft.I=Xt),ft.B&&(fd(ft),Ja(ft)),C.g=Se}else cm(C);0<y.i.length&&ol(y)}else at[0]!="stop"&&at[0]!="close"||mr(y,7);else y.G==3&&(at[0]=="stop"||at[0]=="close"?at[0]=="stop"?mr(y,7):wd(y):at[0]!="noop"&&y.l&&y.l.ta(at),y.v=0)}}In(4)}catch{}}var mk=class{constructor(d,m){this.g=d,this.map=m}};function Lp(d){this.l=d||10,l.PerformanceNavigationTiming?(d=l.performance.getEntriesByType("navigation"),d=0<d.length&&(d[0].nextHopProtocol=="hq"||d[0].nextHopProtocol=="h2")):d=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=d?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Op(d){return d.h?!0:d.g?d.g.size>=d.j:!1}function Vp(d){return d.h?1:d.g?d.g.size:0}function xd(d,m){return d.h?d.h==m:d.g?d.g.has(m):!1}function bd(d,m){d.g?d.g.add(m):d.h=m}function qp(d,m){d.h&&d.h==m?d.h=null:d.g&&d.g.has(m)&&d.g.delete(m)}Lp.prototype.cancel=function(){if(this.i=Up(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const d of this.g.values())d.cancel();this.g.clear()}};function Up(d){if(d.h!=null)return d.i.concat(d.h.D);if(d.g!=null&&d.g.size!==0){let m=d.i;for(const y of d.g.values())m=m.concat(y.D);return m}return S(d.i)}function gk(d){if(d.V&&typeof d.V=="function")return d.V();if(typeof Map<"u"&&d instanceof Map||typeof Set<"u"&&d instanceof Set)return Array.from(d.values());if(typeof d=="string")return d.split("");if(c(d)){for(var m=[],y=d.length,C=0;C<y;C++)m.push(d[C]);return m}m=[],y=0;for(C in d)m[y++]=d[C];return m}function fk(d){if(d.na&&typeof d.na=="function")return d.na();if(!d.V||typeof d.V!="function"){if(typeof Map<"u"&&d instanceof Map)return Array.from(d.keys());if(!(typeof Set<"u"&&d instanceof Set)){if(c(d)||typeof d=="string"){var m=[];d=d.length;for(var y=0;y<d;y++)m.push(y);return m}m=[],y=0;for(const C in d)m[y++]=C;return m}}}function Hp(d,m){if(d.forEach&&typeof d.forEach=="function")d.forEach(m,void 0);else if(c(d)||typeof d=="string")Array.prototype.forEach.call(d,m,void 0);else for(var y=fk(d),C=gk(d),Q=C.length,se=0;se<Q;se++)m.call(void 0,C[se],y&&y[se],d)}var $p=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function yk(d,m){if(d){d=d.split("&");for(var y=0;y<d.length;y++){var C=d[y].indexOf("="),Q=null;if(0<=C){var se=d[y].substring(0,C);Q=d[y].substring(C+1)}else se=d[y];m(se,Q?decodeURIComponent(Q.replace(/\+/g," ")):"")}}}function pr(d){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,d instanceof pr){this.h=d.h,Za(this,d.j),this.o=d.o,this.g=d.g,el(this,d.s),this.l=d.l;var m=d.i,y=new wo;y.i=m.i,m.g&&(y.g=new Map(m.g),y.h=m.h),Gp(this,y),this.m=d.m}else d&&(m=String(d).match($p))?(this.h=!1,Za(this,m[1]||"",!0),this.o=bo(m[2]||""),this.g=bo(m[3]||"",!0),el(this,m[4]),this.l=bo(m[5]||"",!0),Gp(this,m[6]||"",!0),this.m=bo(m[7]||"")):(this.h=!1,this.i=new wo(null,this.h))}pr.prototype.toString=function(){var d=[],m=this.j;m&&d.push(vo(m,Kp,!0),":");var y=this.g;return(y||m=="file")&&(d.push("//"),(m=this.o)&&d.push(vo(m,Kp,!0),"@"),d.push(encodeURIComponent(String(y)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),y=this.s,y!=null&&d.push(":",String(y))),(y=this.l)&&(this.g&&y.charAt(0)!="/"&&d.push("/"),d.push(vo(y,y.charAt(0)=="/"?vk:bk,!0))),(y=this.i.toString())&&d.push("?",y),(y=this.m)&&d.push("#",vo(y,kk)),d.join("")};function ei(d){return new pr(d)}function Za(d,m,y){d.j=y?bo(m,!0):m,d.j&&(d.j=d.j.replace(/:$/,""))}function el(d,m){if(m){if(m=Number(m),isNaN(m)||0>m)throw Error("Bad port number "+m);d.s=m}else d.s=null}function Gp(d,m,y){m instanceof wo?(d.i=m,Sk(d.i,d.h)):(y||(m=vo(m,wk)),d.i=new wo(m,d.h))}function wt(d,m,y){d.i.set(m,y)}function tl(d){return wt(d,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),d}function bo(d,m){return d?m?decodeURI(d.replace(/%25/g,"%2525")):decodeURIComponent(d):""}function vo(d,m,y){return typeof d=="string"?(d=encodeURI(d).replace(m,xk),y&&(d=d.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),d):null}function xk(d){return d=d.charCodeAt(0),"%"+(d>>4&15).toString(16)+(d&15).toString(16)}var Kp=/[#\/\?@]/g,bk=/[#\?:]/g,vk=/[#\?]/g,wk=/[#\?@]/g,kk=/#/g;function wo(d,m){this.h=this.g=null,this.i=d||null,this.j=!!m}function Ri(d){d.g||(d.g=new Map,d.h=0,d.i&&yk(d.i,function(m,y){d.add(decodeURIComponent(m.replace(/\+/g," ")),y)}))}n=wo.prototype,n.add=function(d,m){Ri(this),this.i=null,d=ts(this,d);var y=this.g.get(d);return y||this.g.set(d,y=[]),y.push(m),this.h+=1,this};function Qp(d,m){Ri(d),m=ts(d,m),d.g.has(m)&&(d.i=null,d.h-=d.g.get(m).length,d.g.delete(m))}function Yp(d,m){return Ri(d),m=ts(d,m),d.g.has(m)}n.forEach=function(d,m){Ri(this),this.g.forEach(function(y,C){y.forEach(function(Q){d.call(m,Q,C,this)},this)},this)},n.na=function(){Ri(this);const d=Array.from(this.g.values()),m=Array.from(this.g.keys()),y=[];for(let C=0;C<m.length;C++){const Q=d[C];for(let se=0;se<Q.length;se++)y.push(m[C])}return y},n.V=function(d){Ri(this);let m=[];if(typeof d=="string")Yp(this,d)&&(m=m.concat(this.g.get(ts(this,d))));else{d=Array.from(this.g.values());for(let y=0;y<d.length;y++)m=m.concat(d[y])}return m},n.set=function(d,m){return Ri(this),this.i=null,d=ts(this,d),Yp(this,d)&&(this.h-=this.g.get(d).length),this.g.set(d,[m]),this.h+=1,this},n.get=function(d,m){return d?(d=this.V(d),0<d.length?String(d[0]):m):m};function Xp(d,m,y){Qp(d,m),0<y.length&&(d.i=null,d.g.set(ts(d,m),S(y)),d.h+=y.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const d=[],m=Array.from(this.g.keys());for(var y=0;y<m.length;y++){var C=m[y];const se=encodeURIComponent(String(C)),Se=this.V(C);for(C=0;C<Se.length;C++){var Q=se;Se[C]!==""&&(Q+="="+encodeURIComponent(String(Se[C]))),d.push(Q)}}return this.i=d.join("&")};function ts(d,m){return m=String(m),d.j&&(m=m.toLowerCase()),m}function Sk(d,m){m&&!d.j&&(Ri(d),d.i=null,d.g.forEach(function(y,C){var Q=C.toLowerCase();C!=Q&&(Qp(this,C),Xp(this,Q,y))},d)),d.j=m}function Tk(d,m){const y=new Ii;if(l.Image){const C=new Image;C.onload=b(Ai,y,"TestLoadImage: loaded",!0,m,C),C.onerror=b(Ai,y,"TestLoadImage: error",!1,m,C),C.onabort=b(Ai,y,"TestLoadImage: abort",!1,m,C),C.ontimeout=b(Ai,y,"TestLoadImage: timeout",!1,m,C),l.setTimeout(function(){C.ontimeout&&C.ontimeout()},1e4),C.src=d}else m(!1)}function jk(d,m){const y=new Ii,C=new AbortController,Q=setTimeout(()=>{C.abort(),Ai(y,"TestPingServer: timeout",!1,m)},1e4);fetch(d,{signal:C.signal}).then(se=>{clearTimeout(Q),se.ok?Ai(y,"TestPingServer: ok",!0,m):Ai(y,"TestPingServer: server error",!1,m)}).catch(()=>{clearTimeout(Q),Ai(y,"TestPingServer: error",!1,m)})}function Ai(d,m,y,C,Q){try{Q&&(Q.onload=null,Q.onerror=null,Q.onabort=null,Q.ontimeout=null),C(y)}catch{}}function _k(){this.g=new N}function Ik(d,m,y){const C=y||"";try{Hp(d,function(Q,se){let Se=Q;u(Q)&&(Se=G(Q)),m.push(C+se+"="+encodeURIComponent(Se))})}catch(Q){throw m.push(C+"type="+encodeURIComponent("_badmap")),Q}}function nl(d){this.l=d.Ub||null,this.j=d.eb||!1}x(nl,V),nl.prototype.g=function(){return new il(this.l,this.j)},nl.prototype.i=function(d){return function(){return d}}({});function il(d,m){Fe.call(this),this.D=d,this.o=m,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}x(il,Fe),n=il.prototype,n.open=function(d,m){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=d,this.A=m,this.readyState=1,So(this)},n.send=function(d){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const m={headers:this.u,method:this.B,credentials:this.m,cache:void 0};d&&(m.body=d),(this.D||l).fetch(new Request(this.A,m)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,ko(this)),this.readyState=0},n.Sa=function(d){if(this.g&&(this.l=d,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=d.headers,this.readyState=2,So(this)),this.g&&(this.readyState=3,So(this),this.g)))if(this.responseType==="arraybuffer")d.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in d){if(this.j=d.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Jp(this)}else d.text().then(this.Ra.bind(this),this.ga.bind(this))};function Jp(d){d.j.read().then(d.Pa.bind(d)).catch(d.ga.bind(d))}n.Pa=function(d){if(this.g){if(this.o&&d.value)this.response.push(d.value);else if(!this.o){var m=d.value?d.value:new Uint8Array(0);(m=this.v.decode(m,{stream:!d.done}))&&(this.response=this.responseText+=m)}d.done?ko(this):So(this),this.readyState==3&&Jp(this)}},n.Ra=function(d){this.g&&(this.response=this.responseText=d,ko(this))},n.Qa=function(d){this.g&&(this.response=d,ko(this))},n.ga=function(){this.g&&ko(this)};function ko(d){d.readyState=4,d.l=null,d.j=null,d.v=null,So(d)}n.setRequestHeader=function(d,m){this.u.append(d,m)},n.getResponseHeader=function(d){return this.h&&this.h.get(d.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const d=[],m=this.h.entries();for(var y=m.next();!y.done;)y=y.value,d.push(y[0]+": "+y[1]),y=m.next();return d.join(`\r
`)};function So(d){d.onreadystatechange&&d.onreadystatechange.call(d)}Object.defineProperty(il.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(d){this.m=d?"include":"same-origin"}});function Zp(d){let m="";return P(d,function(y,C){m+=C,m+=":",m+=y,m+=`\r
`}),m}function vd(d,m,y){e:{for(C in y){var C=!1;break e}C=!0}C||(y=Zp(y),typeof d=="string"?y!=null&&encodeURIComponent(String(y)):wt(d,m,y))}function Pt(d){Fe.call(this),this.headers=new Map,this.o=d||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}x(Pt,Fe);var Ck=/^https?$/i,Rk=["POST","PUT"];n=Pt.prototype,n.Ha=function(d){this.J=d},n.ea=function(d,m,y,C){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+d);m=m?m.toUpperCase():"GET",this.D=d,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():pd.g(),this.v=this.o?he(this.o):he(pd),this.g.onreadystatechange=f(this.Ea,this);try{this.B=!0,this.g.open(m,String(d),!0),this.B=!1}catch(se){em(this,se);return}if(d=y||"",y=new Map(this.headers),C)if(Object.getPrototypeOf(C)===Object.prototype)for(var Q in C)y.set(Q,C[Q]);else if(typeof C.keys=="function"&&typeof C.get=="function")for(const se of C.keys())y.set(se,C.get(se));else throw Error("Unknown input type for opt_headers: "+String(C));C=Array.from(y.keys()).find(se=>se.toLowerCase()=="content-type"),Q=l.FormData&&d instanceof l.FormData,!(0<=Array.prototype.indexOf.call(Rk,m,void 0))||C||Q||y.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[se,Se]of y)this.g.setRequestHeader(se,Se);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{im(this),this.u=!0,this.g.send(d),this.u=!1}catch(se){em(this,se)}};function em(d,m){d.h=!1,d.g&&(d.j=!0,d.g.abort(),d.j=!1),d.l=m,d.m=5,tm(d),rl(d)}function tm(d){d.A||(d.A=!0,Ue(d,"complete"),Ue(d,"error"))}n.abort=function(d){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=d||7,Ue(this,"complete"),Ue(this,"abort"),rl(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),rl(this,!0)),Pt.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?nm(this):this.bb())},n.bb=function(){nm(this)};function nm(d){if(d.h&&typeof a<"u"&&(!d.v[1]||ti(d)!=4||d.Z()!=2)){if(d.u&&ti(d)==4)ae(d.Ea,0,d);else if(Ue(d,"readystatechange"),ti(d)==4){d.h=!1;try{const Se=d.Z();e:switch(Se){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var m=!0;break e;default:m=!1}var y;if(!(y=m)){var C;if(C=Se===0){var Q=String(d.D).match($p)[1]||null;!Q&&l.self&&l.self.location&&(Q=l.self.location.protocol.slice(0,-1)),C=!Ck.test(Q?Q.toLowerCase():"")}y=C}if(y)Ue(d,"complete"),Ue(d,"success");else{d.m=6;try{var se=2<ti(d)?d.g.statusText:""}catch{se=""}d.l=se+" ["+d.Z()+"]",tm(d)}}finally{rl(d)}}}}function rl(d,m){if(d.g){im(d);const y=d.g,C=d.v[0]?()=>{}:null;d.g=null,d.v=null,m||Ue(d,"ready");try{y.onreadystatechange=C}catch{}}}function im(d){d.I&&(l.clearTimeout(d.I),d.I=null)}n.isActive=function(){return!!this.g};function ti(d){return d.g?d.g.readyState:0}n.Z=function(){try{return 2<ti(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(d){if(this.g){var m=this.g.responseText;return d&&m.indexOf(d)==0&&(m=m.substring(d.length)),U(m)}};function rm(d){try{if(!d.g)return null;if("response"in d.g)return d.g.response;switch(d.H){case"":case"text":return d.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in d.g)return d.g.mozResponseArrayBuffer}return null}catch{return null}}function Ak(d){const m={};d=(d.g&&2<=ti(d)&&d.g.getAllResponseHeaders()||"").split(`\r
`);for(let C=0;C<d.length;C++){if(j(d[C]))continue;var y=E(d[C]);const Q=y[0];if(y=y[1],typeof y!="string")continue;y=y.trim();const se=m[Q]||[];m[Q]=se,se.push(y)}B(m,function(C){return C.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function To(d,m,y){return y&&y.internalChannelParams&&y.internalChannelParams[d]||m}function sm(d){this.Aa=0,this.i=[],this.j=new Ii,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=To("failFast",!1,d),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=To("baseRetryDelayMs",5e3,d),this.cb=To("retryDelaySeedMs",1e4,d),this.Wa=To("forwardChannelMaxRetries",2,d),this.wa=To("forwardChannelRequestTimeoutMs",2e4,d),this.pa=d&&d.xmlHttpFactory||void 0,this.Xa=d&&d.Tb||void 0,this.Ca=d&&d.useFetchStreams||!1,this.L=void 0,this.J=d&&d.supportsCrossDomainXhr||!1,this.K="",this.h=new Lp(d&&d.concurrentRequestLimit),this.Da=new _k,this.P=d&&d.fastHandshake||!1,this.O=d&&d.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=d&&d.Rb||!1,d&&d.xa&&this.j.xa(),d&&d.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&d&&d.detectBufferingProxy||!1,this.ja=void 0,d&&d.longPollingTimeout&&0<d.longPollingTimeout&&(this.ja=d.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=sm.prototype,n.la=8,n.G=1,n.connect=function(d,m,y,C){Nt(0),this.W=d,this.H=m||{},y&&C!==void 0&&(this.H.OSID=y,this.H.OAID=C),this.F=this.X,this.I=mm(this,null,this.W),ol(this)};function wd(d){if(om(d),d.G==3){var m=d.U++,y=ei(d.I);if(wt(y,"SID",d.K),wt(y,"RID",m),wt(y,"TYPE","terminate"),jo(d,y),m=new Ci(d,d.j,m),m.L=2,m.v=tl(ei(y)),y=!1,l.navigator&&l.navigator.sendBeacon)try{y=l.navigator.sendBeacon(m.v.toString(),"")}catch{}!y&&l.Image&&(new Image().src=m.v,y=!0),y||(m.g=gm(m.j,null),m.g.ea(m.v)),m.F=Date.now(),Ja(m)}pm(d)}function sl(d){d.g&&(Sd(d),d.g.cancel(),d.g=null)}function om(d){sl(d),d.u&&(l.clearTimeout(d.u),d.u=null),al(d),d.h.cancel(),d.s&&(typeof d.s=="number"&&l.clearTimeout(d.s),d.s=null)}function ol(d){if(!Op(d.h)&&!d.s){d.s=!0;var m=d.Ga;ee||Ie(),ge||(ee(),ge=!0),oe.add(m,d),d.B=0}}function Ek(d,m){return Vp(d.h)>=d.h.j-(d.s?1:0)?!1:d.s?(d.i=m.D.concat(d.i),!0):d.G==1||d.G==2||d.B>=(d.Va?0:d.Wa)?!1:(d.s=_i(f(d.Ga,d,m),hm(d,d.B)),d.B++,!0)}n.Ga=function(d){if(this.s)if(this.s=null,this.G==1){if(!d){this.U=Math.floor(1e5*Math.random()),d=this.U++;const Q=new Ci(this,this.j,d);let se=this.o;if(this.S&&(se?(se=k(se),R(se,this.S)):se=this.S),this.m!==null||this.O||(Q.H=se,se=null),this.P)e:{for(var m=0,y=0;y<this.i.length;y++){t:{var C=this.i[y];if("__data__"in C.map&&(C=C.map.__data__,typeof C=="string")){C=C.length;break t}C=void 0}if(C===void 0)break;if(m+=C,4096<m){m=y;break e}if(m===4096||y===this.i.length-1){m=y+1;break e}}m=1e3}else m=1e3;m=lm(this,Q,m),y=ei(this.I),wt(y,"RID",d),wt(y,"CVER",22),this.D&&wt(y,"X-HTTP-Session-Id",this.D),jo(this,y),se&&(this.O?m="headers="+encodeURIComponent(String(Zp(se)))+"&"+m:this.m&&vd(y,this.m,se)),bd(this.h,Q),this.Ua&&wt(y,"TYPE","init"),this.P?(wt(y,"$req",m),wt(y,"SID","null"),Q.T=!0,gd(Q,y,null)):gd(Q,y,m),this.G=2}}else this.G==3&&(d?am(this,d):this.i.length==0||Op(this.h)||am(this))};function am(d,m){var y;m?y=m.l:y=d.U++;const C=ei(d.I);wt(C,"SID",d.K),wt(C,"RID",y),wt(C,"AID",d.T),jo(d,C),d.m&&d.o&&vd(C,d.m,d.o),y=new Ci(d,d.j,y,d.B+1),d.m===null&&(y.H=d.o),m&&(d.i=m.D.concat(d.i)),m=lm(d,y,1e3),y.I=Math.round(.5*d.wa)+Math.round(.5*d.wa*Math.random()),bd(d.h,y),gd(y,C,m)}function jo(d,m){d.H&&P(d.H,function(y,C){wt(m,C,y)}),d.l&&Hp({},function(y,C){wt(m,C,y)})}function lm(d,m,y){y=Math.min(d.i.length,y);var C=d.l?f(d.l.Na,d.l,d):null;e:{var Q=d.i;let se=-1;for(;;){const Se=["count="+y];se==-1?0<y?(se=Q[0].g,Se.push("ofs="+se)):se=0:Se.push("ofs="+se);let ft=!0;for(let Xt=0;Xt<y;Xt++){let at=Q[Xt].g;const nn=Q[Xt].map;if(at-=se,0>at)se=Math.max(0,Q[Xt].g-100),ft=!1;else try{Ik(nn,Se,"req"+at+"_")}catch{C&&C(nn)}}if(ft){C=Se.join("&");break e}}}return d=d.i.splice(0,y),m.D=d,C}function cm(d){if(!d.g&&!d.u){d.Y=1;var m=d.Fa;ee||Ie(),ge||(ee(),ge=!0),oe.add(m,d),d.v=0}}function kd(d){return d.g||d.u||3<=d.v?!1:(d.Y++,d.u=_i(f(d.Fa,d),hm(d,d.v)),d.v++,!0)}n.Fa=function(){if(this.u=null,dm(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var d=2*this.R;this.j.info("BP detection timer enabled: "+d),this.A=_i(f(this.ab,this),d)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Nt(10),sl(this),dm(this))};function Sd(d){d.A!=null&&(l.clearTimeout(d.A),d.A=null)}function dm(d){d.g=new Ci(d,d.j,"rpc",d.Y),d.m===null&&(d.g.H=d.o),d.g.O=0;var m=ei(d.qa);wt(m,"RID","rpc"),wt(m,"SID",d.K),wt(m,"AID",d.T),wt(m,"CI",d.F?"0":"1"),!d.F&&d.ja&&wt(m,"TO",d.ja),wt(m,"TYPE","xmlhttp"),jo(d,m),d.m&&d.o&&vd(m,d.m,d.o),d.L&&(d.g.I=d.L);var y=d.g;d=d.ia,y.L=1,y.v=tl(ei(m)),y.m=null,y.P=!0,Np(y,d)}n.Za=function(){this.C!=null&&(this.C=null,sl(this),kd(this),Nt(19))};function al(d){d.C!=null&&(l.clearTimeout(d.C),d.C=null)}function um(d,m){var y=null;if(d.g==m){al(d),Sd(d),d.g=null;var C=2}else if(xd(d.h,m))y=m.D,qp(d.h,m),C=1;else return;if(d.G!=0){if(m.o)if(C==1){y=m.m?m.m.length:0,m=Date.now()-m.F;var Q=d.B;C=dt(),Ue(C,new Rt(C,y)),ol(d)}else cm(d);else if(Q=m.s,Q==3||Q==0&&0<m.X||!(C==1&&Ek(d,m)||C==2&&kd(d)))switch(y&&0<y.length&&(m=d.h,m.i=m.i.concat(y)),Q){case 1:mr(d,5);break;case 4:mr(d,10);break;case 3:mr(d,6);break;default:mr(d,2)}}}function hm(d,m){let y=d.Ta+Math.floor(Math.random()*d.cb);return d.isActive()||(y*=2),y*m}function mr(d,m){if(d.j.info("Error code "+m),m==2){var y=f(d.fb,d),C=d.Xa;const Q=!C;C=new pr(C||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||Za(C,"https"),tl(C),Q?Tk(C.toString(),y):jk(C.toString(),y)}else Nt(2);d.G=0,d.l&&d.l.sa(m),pm(d),om(d)}n.fb=function(d){d?(this.j.info("Successfully pinged google.com"),Nt(2)):(this.j.info("Failed to ping google.com"),Nt(1))};function pm(d){if(d.G=0,d.ka=[],d.l){const m=Up(d.h);(m.length!=0||d.i.length!=0)&&(w(d.ka,m),w(d.ka,d.i),d.h.i.length=0,S(d.i),d.i.length=0),d.l.ra()}}function mm(d,m,y){var C=y instanceof pr?ei(y):new pr(y);if(C.g!="")m&&(C.g=m+"."+C.g),el(C,C.s);else{var Q=l.location;C=Q.protocol,m=m?m+"."+Q.hostname:Q.hostname,Q=+Q.port;var se=new pr(null);C&&Za(se,C),m&&(se.g=m),Q&&el(se,Q),y&&(se.l=y),C=se}return y=d.D,m=d.ya,y&&m&&wt(C,y,m),wt(C,"VER",d.la),jo(d,C),C}function gm(d,m,y){if(m&&!d.J)throw Error("Can't create secondary domain capable XhrIo object.");return m=d.Ca&&!d.pa?new Pt(new nl({eb:y})):new Pt(d.pa),m.Ha(d.J),m}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function fm(){}n=fm.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function ll(){}ll.prototype.g=function(d,m){return new vn(d,m)};function vn(d,m){Fe.call(this),this.g=new sm(m),this.l=d,this.h=m&&m.messageUrlParams||null,d=m&&m.messageHeaders||null,m&&m.clientProtocolHeaderRequired&&(d?d["X-Client-Protocol"]="webchannel":d={"X-Client-Protocol":"webchannel"}),this.g.o=d,d=m&&m.initMessageHeaders||null,m&&m.messageContentType&&(d?d["X-WebChannel-Content-Type"]=m.messageContentType:d={"X-WebChannel-Content-Type":m.messageContentType}),m&&m.va&&(d?d["X-WebChannel-Client-Profile"]=m.va:d={"X-WebChannel-Client-Profile":m.va}),this.g.S=d,(d=m&&m.Sb)&&!j(d)&&(this.g.m=d),this.v=m&&m.supportsCrossDomainXhr||!1,this.u=m&&m.sendRawJson||!1,(m=m&&m.httpSessionIdParam)&&!j(m)&&(this.g.D=m,d=this.h,d!==null&&m in d&&(d=this.h,m in d&&delete d[m])),this.j=new ns(this)}x(vn,Fe),vn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},vn.prototype.close=function(){wd(this.g)},vn.prototype.o=function(d){var m=this.g;if(typeof d=="string"){var y={};y.__data__=d,d=y}else this.u&&(y={},y.__data__=G(d),d=y);m.i.push(new mk(m.Ya++,d)),m.G==3&&ol(m)},vn.prototype.N=function(){this.g.l=null,delete this.j,wd(this.g),delete this.g,vn.aa.N.call(this)};function ym(d){Ce.call(this),d.__headers__&&(this.headers=d.__headers__,this.statusCode=d.__status__,delete d.__headers__,delete d.__status__);var m=d.__sm__;if(m){e:{for(const y in m){d=y;break e}d=void 0}(this.i=d)&&(d=this.i,m=m!==null&&d in m?m[d]:void 0),this.data=m}else this.data=d}x(ym,Ce);function xm(){Ee.call(this),this.status=1}x(xm,Ee);function ns(d){this.g=d}x(ns,fm),ns.prototype.ua=function(){Ue(this.g,"a")},ns.prototype.ta=function(d){Ue(this.g,new ym(d))},ns.prototype.sa=function(d){Ue(this.g,new xm)},ns.prototype.ra=function(){Ue(this.g,"b")},ll.prototype.createWebChannel=ll.prototype.g,vn.prototype.send=vn.prototype.o,vn.prototype.open=vn.prototype.m,vn.prototype.close=vn.prototype.close,_x=function(){return new ll},jx=function(){return dt()},Tx=Ye,uu={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Ya.NO_ERROR=0,Ya.TIMEOUT=8,Ya.HTTP_ERROR=6,jl=Ya,Fp.COMPLETE="complete",Sx=Fp,fe.EventType=ze,ze.OPEN="a",ze.CLOSE="b",ze.ERROR="c",ze.MESSAGE="d",Fe.prototype.listen=Fe.prototype.K,Mo=fe,Pt.prototype.listenOnce=Pt.prototype.L,Pt.prototype.getLastError=Pt.prototype.Ka,Pt.prototype.getLastErrorCode=Pt.prototype.Ba,Pt.prototype.getStatus=Pt.prototype.Z,Pt.prototype.getResponseJson=Pt.prototype.Oa,Pt.prototype.getResponseText=Pt.prototype.oa,Pt.prototype.send=Pt.prototype.ea,Pt.prototype.setWithCredentials=Pt.prototype.Ha,kx=Pt}).apply(typeof ul<"u"?ul:typeof self<"u"?self:typeof window<"u"?window:{});const Vm="@firebase/firestore",qm="4.7.17";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gt{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Gt.UNAUTHENTICATED=new Gt(null),Gt.GOOGLE_CREDENTIALS=new Gt("google-credentials-uid"),Gt.FIRST_PARTY=new Gt("first-party-uid"),Gt.MOCK_USER=new Gt("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Zs="11.9.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ki=new nh("@firebase/firestore");function gs(){return Ki.logLevel}function yT(n){Ki.setLogLevel(n)}function ue(n,...e){if(Ki.logLevel<=tt.DEBUG){const t=e.map(sh);Ki.debug(`Firestore (${Zs}): ${n}`,...t)}}function zt(n,...e){if(Ki.logLevel<=tt.ERROR){const t=e.map(sh);Ki.error(`Firestore (${Zs}): ${n}`,...t)}}function Tn(n,...e){if(Ki.logLevel<=tt.WARN){const t=e.map(sh);Ki.warn(`Firestore (${Zs}): ${n}`,...t)}}function sh(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(t){return JSON.stringify(t)}(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ae(n,e,t){let i="Unexpected state";typeof e=="string"?i=e:t=e,Ix(n,i,t)}function Ix(n,e,t){let i=`FIRESTORE (${Zs}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{i+=" CONTEXT: "+JSON.stringify(t)}catch{i+=" CONTEXT: "+t}throw zt(i),new Error(i)}function Pe(n,e,t,i){let s="Unexpected state";typeof t=="string"?s=t:i=t,n||Ix(e,s,i)}function xT(n,e){n||Ae(57014,e)}function ke(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Z={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class de extends Xn{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qt{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cx{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class Rx{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(Gt.UNAUTHENTICATED))}shutdown(){}}class bT{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class vT{constructor(e){this.t=e,this.currentUser=Gt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Pe(this.o===void 0,42304);let i=this.i;const s=c=>this.i!==i?(i=this.i,t(c)):Promise.resolve();let o=new Qt;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new Qt,e.enqueueRetryable(()=>s(this.currentUser))};const a=()=>{const c=o;e.enqueueRetryable(async()=>{await c.promise,await s(this.currentUser)})},l=c=>{ue("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(c=>l(c)),setTimeout(()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?l(c):(ue("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new Qt)}},0),a()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(i=>this.i!==e?(ue("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(Pe(typeof i.accessToken=="string",31837,{l:i}),new Cx(i.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Pe(e===null||typeof e=="string",2055,{h:e}),new Gt(e)}}class wT{constructor(e,t,i){this.P=e,this.T=t,this.I=i,this.type="FirstParty",this.user=Gt.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class kT{constructor(e,t,i){this.P=e,this.T=t,this.I=i}getToken(){return Promise.resolve(new wT(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t(Gt.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class hu{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class ST{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,mn(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Pe(this.o===void 0,3512);const i=o=>{o.error!=null&&ue("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);const a=o.token!==this.m;return this.m=o.token,ue("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?t(o.token):Promise.resolve()};this.o=o=>{e.enqueueRetryable(()=>i(o))};const s=o=>{ue("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(o=>s(o)),setTimeout(()=>{if(!this.appCheck){const o=this.V.getImmediate({optional:!0});o?s(o):ue("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new hu(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(Pe(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new hu(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}class TT{getToken(){return Promise.resolve(new hu(""))}invalidateToken(){}start(e,t){}shutdown(){}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jT(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let i=0;i<n;i++)t[i]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oh(){return new TextEncoder}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ah{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let i="";for(;i.length<20;){const s=jT(40);for(let o=0;o<s.length;++o)i.length<20&&s[o]<t&&(i+=e.charAt(s[o]%62))}return i}}function Le(n,e){return n<e?-1:n>e?1:0}function pu(n,e){let t=0;for(;t<n.length&&t<e.length;){const i=n.codePointAt(t),s=e.codePointAt(t);if(i!==s){if(i<128&&s<128)return Le(i,s);{const o=oh(),a=_T(o.encode(Um(n,t)),o.encode(Um(e,t)));return a!==0?a:Le(i,s)}}t+=i>65535?2:1}return Le(n.length,e.length)}function Um(n,e){return n.codePointAt(e)>65535?n.substring(e,e+2):n.substring(e,e+1)}function _T(n,e){for(let t=0;t<n.length&&t<e.length;++t)if(n[t]!==e[t])return Le(n[t],e[t]);return Le(n.length,e.length)}function _s(n,e,t){return n.length===e.length&&n.every((i,s)=>t(i,e[s]))}function Ax(n){return n+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hm=-62135596800,$m=1e6;class xt{static now(){return xt.fromMillis(Date.now())}static fromDate(e){return xt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),i=Math.floor((e-1e3*t)*$m);return new xt(t,i)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new de(Z.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new de(Z.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<Hm)throw new de(Z.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new de(Z.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/$m}_compareTo(e){return this.seconds===e.seconds?Le(this.nanoseconds,e.nanoseconds):Le(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds-Hm;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class De{static fromTimestamp(e){return new De(e)}static min(){return new De(new xt(0,0))}static max(){return new De(new xt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mu="__name__";class Wn{constructor(e,t,i){t===void 0?t=0:t>e.length&&Ae(637,{offset:t,range:e.length}),i===void 0?i=e.length-t:i>e.length-t&&Ae(1746,{length:i,range:e.length-t}),this.segments=e,this.offset=t,this.len=i}get length(){return this.len}isEqual(e){return Wn.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Wn?e.forEach(i=>{t.push(i)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,i=this.limit();t<i;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const i=Math.min(e.length,t.length);for(let s=0;s<i;s++){const o=Wn.compareSegments(e.get(s),t.get(s));if(o!==0)return o}return Le(e.length,t.length)}static compareSegments(e,t){const i=Wn.isNumericId(e),s=Wn.isNumericId(t);return i&&!s?-1:!i&&s?1:i&&s?Wn.extractNumericId(e).compare(Wn.extractNumericId(t)):pu(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Ui.fromString(e.substring(4,e.length-2))}}class nt extends Wn{construct(e,t,i){return new nt(e,t,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const i of e){if(i.indexOf("//")>=0)throw new de(Z.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);t.push(...i.split("/").filter(s=>s.length>0))}return new nt(t)}static emptyPath(){return new nt([])}}const IT=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class St extends Wn{construct(e,t,i){return new St(e,t,i)}static isValidIdentifier(e){return IT.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),St.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===mu}static keyField(){return new St([mu])}static fromServerFormat(e){const t=[];let i="",s=0;const o=()=>{if(i.length===0)throw new de(Z.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(i),i=""};let a=!1;for(;s<e.length;){const l=e[s];if(l==="\\"){if(s+1===e.length)throw new de(Z.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[s+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new de(Z.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=c,s+=2}else l==="`"?(a=!a,s++):l!=="."||a?(i+=l,s++):(o(),s++)}if(o(),a)throw new de(Z.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new St(t)}static emptyPath(){return new St([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Te{constructor(e){this.path=e}static fromPath(e){return new Te(nt.fromString(e))}static fromName(e){return new Te(nt.fromString(e).popFirst(5))}static empty(){return new Te(nt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&nt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return nt.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Te(new nt(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Is=-1;class Cs{constructor(e,t,i,s){this.indexId=e,this.collectionGroup=t,this.fields=i,this.indexState=s}}function gu(n){return n.fields.find(e=>e.kind===2)}function yr(n){return n.fields.filter(e=>e.kind!==2)}function CT(n,e){let t=Le(n.collectionGroup,e.collectionGroup);if(t!==0)return t;for(let i=0;i<Math.min(n.fields.length,e.fields.length);++i)if(t=RT(n.fields[i],e.fields[i]),t!==0)return t;return Le(n.fields.length,e.fields.length)}Cs.UNKNOWN_ID=-1;class Rr{constructor(e,t){this.fieldPath=e,this.kind=t}}function RT(n,e){const t=St.comparator(n.fieldPath,e.fieldPath);return t!==0?t:Le(n.kind,e.kind)}class Rs{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new Rs(0,jn.min())}}function Ex(n,e){const t=n.toTimestamp().seconds,i=n.toTimestamp().nanoseconds+1,s=De.fromTimestamp(i===1e9?new xt(t+1,0):new xt(t,i));return new jn(s,Te.empty(),e)}function Bx(n){return new jn(n.readTime,n.key,Is)}class jn{constructor(e,t,i){this.readTime=e,this.documentKey=t,this.largestBatchId=i}static min(){return new jn(De.min(),Te.empty(),Is)}static max(){return new jn(De.max(),Te.empty(),Is)}}function lh(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=Te.comparator(n.documentKey,e.documentKey),t!==0?t:Le(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Px="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Fx{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ir(n){if(n.code!==Z.FAILED_PRECONDITION||n.message!==Px)throw n;ue("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Ae(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new K((i,s)=>{this.nextCallback=o=>{this.wrapSuccess(e,o).next(i,s)},this.catchCallback=o=>{this.wrapFailure(t,o).next(i,s)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof K?t:K.resolve(t)}catch(t){return K.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):K.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):K.reject(t)}static resolve(e){return new K((t,i)=>{t(e)})}static reject(e){return new K((t,i)=>{i(e)})}static waitFor(e){return new K((t,i)=>{let s=0,o=0,a=!1;e.forEach(l=>{++s,l.next(()=>{++o,a&&o===s&&t()},c=>i(c))}),a=!0,o===s&&t()})}static or(e){let t=K.resolve(!1);for(const i of e)t=t.next(s=>s?K.resolve(s):i());return t}static forEach(e,t){const i=[];return e.forEach((s,o)=>{i.push(t.call(this,s,o))}),this.waitFor(i)}static mapArray(e,t){return new K((i,s)=>{const o=e.length,a=new Array(o);let l=0;for(let c=0;c<o;c++){const u=c;t(e[u]).next(h=>{a[u]=h,++l,l===o&&i(a)},h=>s(h))}})}static doWhile(e,t){return new K((i,s)=>{const o=()=>{e()===!0?t().next(()=>{o()},s):i()};o()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wn="SimpleDb";class Cc{static open(e,t,i,s){try{return new Cc(t,e.transaction(s,i))}catch(o){throw new qo(t,o)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.S=new Qt,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{t.error?this.S.reject(new qo(e,t.error)):this.S.resolve()},this.transaction.onerror=i=>{const s=ch(i.target.error);this.S.reject(new qo(e,s))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(ue(wn,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}v(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new ET(t)}}class $n{static delete(e){return ue(wn,"Removing database:",e),vr(ox().indexedDB.deleteDatabase(e)).toPromise()}static C(){if(!gx())return!1;if($n.F())return!0;const e=qt(),t=$n.M(e),i=0<t&&t<10,s=zx(e),o=0<s&&s<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||i||o)}static F(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.O)==="YES"}static N(e,t){return e.store(t)}static M(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),i=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(i)}constructor(e,t,i){this.name=e,this.version=t,this.B=i,this.L=null,$n.M(qt())===12.2&&zt("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async k(e){return this.db||(ue(wn,"Opening database:",this.name),this.db=await new Promise((t,i)=>{const s=indexedDB.open(this.name,this.version);s.onsuccess=o=>{const a=o.target.result;t(a)},s.onblocked=()=>{i(new qo(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},s.onerror=o=>{const a=o.target.error;a.name==="VersionError"?i(new de(Z.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):a.name==="InvalidStateError"?i(new de(Z.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+a)):i(new qo(e,a))},s.onupgradeneeded=o=>{ue(wn,'Database "'+this.name+'" requires upgrade from version:',o.oldVersion);const a=o.target.result;if(this.L!==null&&this.L!==o.oldVersion)throw new Error(`refusing to open IndexedDB database due to potential corruption of the IndexedDB database data; this corruption could be caused by clicking the "clear site data" button in a web browser; try reloading the web page to re-initialize the IndexedDB database: lastClosedDbVersion=${this.L}, event.oldVersion=${o.oldVersion}, event.newVersion=${o.newVersion}, db.version=${a.version}`);this.B.q(a,s.transaction,o.oldVersion,this.version).next(()=>{ue(wn,"Database upgrade to version "+this.version+" complete")})}}),this.db.addEventListener("close",t=>{const i=t.target;this.L=i.version},{passive:!0})),this.$&&(this.db.onversionchange=t=>this.$(t)),this.db}U(e){this.$=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,i,s){const o=t==="readonly";let a=0;for(;;){++a;try{this.db=await this.k(e);const l=Cc.open(this.db,e,o?"readonly":"readwrite",i),c=s(l).next(u=>(l.v(),u)).catch(u=>(l.abort(u),K.reject(u))).toPromise();return c.catch(()=>{}),await l.D,c}catch(l){const c=l,u=c.name!=="FirebaseError"&&a<3;if(ue(wn,"Transaction failed with error:",c.message,"Retrying:",u),this.close(),!u)return Promise.reject(c)}}}close(){this.db&&this.db.close(),this.db=void 0}}function zx(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class AT{constructor(e){this.K=e,this.W=!1,this.G=null}get isDone(){return this.W}get j(){return this.G}set cursor(e){this.K=e}done(){this.W=!0}H(e){this.G=e}delete(){return vr(this.K.delete())}}class qo extends de{constructor(e,t){super(Z.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function rr(n){return n.name==="IndexedDbTransactionError"}class ET{constructor(e){this.store=e}put(e,t){let i;return t!==void 0?(ue(wn,"PUT",this.store.name,e,t),i=this.store.put(t,e)):(ue(wn,"PUT",this.store.name,"<auto-key>",e),i=this.store.put(e)),vr(i)}add(e){return ue(wn,"ADD",this.store.name,e,e),vr(this.store.add(e))}get(e){return vr(this.store.get(e)).next(t=>(t===void 0&&(t=null),ue(wn,"GET",this.store.name,e,t),t))}delete(e){return ue(wn,"DELETE",this.store.name,e),vr(this.store.delete(e))}count(){return ue(wn,"COUNT",this.store.name),vr(this.store.count())}J(e,t){const i=this.options(e,t),s=i.index?this.store.index(i.index):this.store;if(typeof s.getAll=="function"){const o=s.getAll(i.range);return new K((a,l)=>{o.onerror=c=>{l(c.target.error)},o.onsuccess=c=>{a(c.target.result)}})}{const o=this.cursor(i),a=[];return this.Y(o,(l,c)=>{a.push(c)}).next(()=>a)}}Z(e,t){const i=this.store.getAll(e,t===null?void 0:t);return new K((s,o)=>{i.onerror=a=>{o(a.target.error)},i.onsuccess=a=>{s(a.target.result)}})}X(e,t){ue(wn,"DELETE ALL",this.store.name);const i=this.options(e,t);i.ee=!1;const s=this.cursor(i);return this.Y(s,(o,a,l)=>l.delete())}te(e,t){let i;t?i=e:(i={},t=e);const s=this.cursor(i);return this.Y(s,t)}ne(e){const t=this.cursor({});return new K((i,s)=>{t.onerror=o=>{const a=ch(o.target.error);s(a)},t.onsuccess=o=>{const a=o.target.result;a?e(a.primaryKey,a.value).next(l=>{l?a.continue():i()}):i()}})}Y(e,t){const i=[];return new K((s,o)=>{e.onerror=a=>{o(a.target.error)},e.onsuccess=a=>{const l=a.target.result;if(!l)return void s();const c=new AT(l),u=t(l.primaryKey,l.value,c);if(u instanceof K){const h=u.catch(p=>(c.done(),K.reject(p)));i.push(h)}c.isDone?s():c.j===null?l.continue():l.continue(c.j)}}).next(()=>K.waitFor(i))}options(e,t){let i;return e!==void 0&&(typeof e=="string"?i=e:t=e),{index:i,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const i=this.store.index(e.index);return e.ee?i.openKeyCursor(e.range,t):i.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function vr(n){return new K((e,t)=>{n.onsuccess=i=>{const s=i.target.result;e(s)},n.onerror=i=>{const s=ch(i.target.error);t(s)}})}let Gm=!1;function ch(n){const e=$n.M(qt());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const i=new de("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return Gm||(Gm=!0,setTimeout(()=>{throw i},0)),i}}return n}const Uo="IndexBackfiller";class BT{constructor(e,t){this.asyncQueue=e,this.re=t,this.task=null}start(){this.ie(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}ie(e){ue(Uo,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{const t=await this.re.se();ue(Uo,`Documents written: ${t}`)}catch(t){rr(t)?ue(Uo,"Ignoring IndexedDB error during index backfill: ",t):await ir(t)}await this.ie(6e4)})}}class PT{constructor(e,t){this.localStore=e,this.persistence=t}async se(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",t=>this.oe(t,e))}oe(e,t){const i=new Set;let s=t,o=!0;return K.doWhile(()=>o===!0&&s>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(a=>{if(a!==null&&!i.has(a))return ue(Uo,`Processing collection: ${a}`),this._e(e,a,s).next(l=>{s-=l,i.add(a)});o=!1})).next(()=>t-s)}_e(e,t,i){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(s=>this.localStore.localDocuments.getNextDocuments(e,t,s,i).next(o=>{const a=o.changes;return this.localStore.indexManager.updateIndexEntries(e,a).next(()=>this.ae(s,o)).next(l=>(ue(Uo,`Updating offset: ${l}`),this.localStore.indexManager.updateCollectionGroup(e,t,l))).next(()=>a.size)}))}ae(e,t){let i=e;return t.changes.forEach((s,o)=>{const a=Bx(o);lh(a,i)>0&&(i=a)}),new jn(i.readTime,i.documentKey,Math.max(t.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gn{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=i=>this.ue(i),this.ce=i=>t.writeSequenceNumber(i))}ue(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ce&&this.ce(e),e}}gn.le=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hi=-1;function wa(n){return n==null}function ra(n){return n===0&&1/n==-1/0}function Dx(n){return typeof n=="number"&&Number.isInteger(n)&&!ra(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $l="";function ln(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=Km(e)),e=FT(n.get(t),e);return Km(e)}function FT(n,e){let t=e;const i=n.length;for(let s=0;s<i;s++){const o=n.charAt(s);switch(o){case"\0":t+="";break;case $l:t+="";break;default:t+=o}}return t}function Km(n){return n+$l+""}function Vn(n){const e=n.length;if(Pe(e>=2,64408,{path:n}),e===2)return Pe(n.charAt(0)===$l&&n.charAt(1)==="",56145,{path:n}),nt.emptyPath();const t=e-2,i=[];let s="";for(let o=0;o<e;){const a=n.indexOf($l,o);switch((a<0||a>t)&&Ae(50515,{path:n}),n.charAt(a+1)){case"":const l=n.substring(o,a);let c;s.length===0?c=l:(s+=l,c=s,s=""),i.push(c);break;case"":s+=n.substring(o,a),s+="\0";break;case"":s+=n.substring(o,a+1);break;default:Ae(61167,{path:n})}o=a+2}return new nt(i)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xr="remoteDocuments",ka="owner",rs="owner",sa="mutationQueues",zT="userId",Rn="mutations",Qm="batchId",Tr="userMutationsIndex",Ym=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _l(n,e){return[n,ln(e)]}function Nx(n,e,t){return[n,ln(e),t]}const DT={},As="documentMutations",Gl="remoteDocumentsV14",NT=["prefixPath","collectionGroup","readTime","documentId"],Il="documentKeyIndex",MT=["prefixPath","collectionGroup","documentId"],Mx="collectionGroupIndex",WT=["collectionGroup","readTime","prefixPath","documentId"],oa="remoteDocumentGlobal",fu="remoteDocumentGlobalKey",Es="targets",Wx="queryTargetsIndex",LT=["canonicalId","targetId"],Bs="targetDocuments",OT=["targetId","path"],dh="documentTargetsIndex",VT=["path","targetId"],Kl="targetGlobalKey",Ar="targetGlobal",aa="collectionParents",qT=["collectionId","parent"],Ps="clientMetadata",UT="clientId",Rc="bundles",HT="bundleId",Ac="namedQueries",$T="name",uh="indexConfiguration",GT="indexId",yu="collectionGroupIndex",KT="collectionGroup",Ho="indexState",QT=["indexId","uid"],Lx="sequenceNumberIndex",YT=["uid","sequenceNumber"],$o="indexEntries",XT=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],Ox="documentKeyIndex",JT=["indexId","uid","orderedDocumentKey"],Ec="documentOverlays",ZT=["userId","collectionPath","documentId"],xu="collectionPathOverlayIndex",ej=["userId","collectionPath","largestBatchId"],Vx="collectionGroupOverlayIndex",tj=["userId","collectionGroup","largestBatchId"],hh="globals",nj="name",qx=[sa,Rn,As,xr,Es,ka,Ar,Bs,Ps,oa,aa,Rc,Ac],ij=[...qx,Ec],Ux=[sa,Rn,As,Gl,Es,ka,Ar,Bs,Ps,oa,aa,Rc,Ac,Ec],Hx=Ux,ph=[...Hx,uh,Ho,$o],rj=ph,$x=[...ph,hh],sj=$x;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bu extends Fx{constructor(e,t){super(),this.he=e,this.currentSequenceNumber=t}}function Ut(n,e){const t=ke(n);return $n.N(t.he,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xm(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function sr(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function Gx(n,e){const t=[];for(const i in n)Object.prototype.hasOwnProperty.call(n,i)&&t.push(e(n[i],i,n));return t}function Kx(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vt{constructor(e,t){this.comparator=e,this.root=t||Jt.EMPTY}insert(e,t){return new vt(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Jt.BLACK,null,null))}remove(e){return new vt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Jt.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const i=this.comparator(e,t.key);if(i===0)return t.value;i<0?t=t.left:i>0&&(t=t.right)}return null}indexOf(e){let t=0,i=this.root;for(;!i.isEmpty();){const s=this.comparator(e,i.key);if(s===0)return t+i.left.size;s<0?i=i.left:(t+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,i)=>(e(t,i),!1))}toString(){const e=[];return this.inorderTraversal((t,i)=>(e.push(`${t}:${i}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new hl(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new hl(this.root,e,this.comparator,!1)}getReverseIterator(){return new hl(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new hl(this.root,e,this.comparator,!0)}}class hl{constructor(e,t,i,s){this.isReverse=s,this.nodeStack=[];let o=1;for(;!e.isEmpty();)if(o=t?i(e.key,t):1,t&&s&&(o*=-1),o<0)e=this.isReverse?e.left:e.right;else{if(o===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Jt{constructor(e,t,i,s,o){this.key=e,this.value=t,this.color=i??Jt.RED,this.left=s??Jt.EMPTY,this.right=o??Jt.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,i,s,o){return new Jt(e??this.key,t??this.value,i??this.color,s??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let s=this;const o=i(e,s.key);return s=o<0?s.copy(null,null,null,s.left.insert(e,t,i),null):o===0?s.copy(null,t,null,null,null):s.copy(null,null,null,null,s.right.insert(e,t,i)),s.fixUp()}removeMin(){if(this.left.isEmpty())return Jt.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let i,s=this;if(t(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,t),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),t(e,s.key)===0){if(s.right.isEmpty())return Jt.EMPTY;i=s.right.min(),s=s.copy(i.key,i.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,t))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Jt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Jt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Ae(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Ae(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Ae(27949);return e+(this.isRed()?0:1)}}Jt.EMPTY=null,Jt.RED=!0,Jt.BLACK=!1;Jt.EMPTY=new class{constructor(){this.size=0}get key(){throw Ae(57766)}get value(){throw Ae(16141)}get color(){throw Ae(16727)}get left(){throw Ae(29726)}get right(){throw Ae(36894)}copy(e,t,i,s,o){return this}insert(e,t,i){return new Jt(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mt{constructor(e){this.comparator=e,this.data=new vt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,i)=>(e(t),!1))}forEachInRange(e,t){const i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){const s=i.getNext();if(this.comparator(s.key,e[1])>=0)return;t(s.key)}}forEachWhile(e,t){let i;for(i=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Jm(this.data.getIterator())}getIteratorFrom(e){return new Jm(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(i=>{t=t.add(i)}),t}isEqual(e){if(!(e instanceof mt)||this.size!==e.size)return!1;const t=this.data.getIterator(),i=e.data.getIterator();for(;t.hasNext();){const s=t.getNext().key,o=i.getNext().key;if(this.comparator(s,o)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new mt(this.comparator);return t.data=e,t}}class Jm{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function ss(n){return n.hasNext()?n.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fn{constructor(e){this.fields=e,e.sort(St.comparator)}static empty(){return new fn([])}unionWith(e){let t=new mt(St.comparator);for(const i of this.fields)t=t.add(i);for(const i of e)t=t.add(i);return new fn(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return _s(this.fields,e.fields,(t,i)=>t.isEqual(i))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qx extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oj(){return typeof atob<"u"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class At{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(s){try{return atob(s)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new Qx("Invalid base64 string: "+o):o}}(e);return new At(t)}static fromUint8Array(e){const t=function(s){let o="";for(let a=0;a<s.length;++a)o+=String.fromCharCode(s[a]);return o}(e);return new At(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){const i=new Uint8Array(t.length);for(let s=0;s<t.length;s++)i[s]=t.charCodeAt(s);return i}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Le(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}At.EMPTY_BYTE_STRING=new At("");const aj=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function mi(n){if(Pe(!!n,39018),typeof n=="string"){let e=0;const t=aj.exec(n);if(Pe(!!t,46558,{timestamp:n}),t[1]){let s=t[1];s=(s+"000000000").substr(0,9),e=Number(s)}const i=new Date(n);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:jt(n.seconds),nanos:jt(n.nanos)}}function jt(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function gi(n){return typeof n=="string"?At.fromBase64String(n):At.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yx="server_timestamp",Xx="__type__",Jx="__previous_value__",Zx="__local_write_time__";function Bc(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{})[Xx])===null||t===void 0?void 0:t.stringValue)===Yx}function Pc(n){const e=n.mapValue.fields[Jx];return Bc(e)?Pc(e):e}function la(n){const e=mi(n.mapValue.fields[Zx].timestampValue);return new xt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lj{constructor(e,t,i,s,o,a,l,c,u,h){this.databaseId=e,this.appId=t,this.persistenceKey=i,this.host=s,this.ssl=o,this.forceLongPolling=a,this.autoDetectLongPolling=l,this.longPollingOptions=c,this.useFetchStreams=u,this.isUsingEmulator=h}}const ca="(default)";class Qi{constructor(e,t){this.projectId=e,this.database=t||ca}static empty(){return new Qi("","")}get isDefaultDatabase(){return this.database===ca}isEqual(e){return e instanceof Qi&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mh="__type__",eb="__max__",Wi={mapValue:{fields:{__type__:{stringValue:eb}}}},gh="__vector__",Fs="value",Cl={nullValue:"NULL_VALUE"};function Yi(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Bc(n)?4:tb(n)?9007199254740991:Fc(n)?10:11:Ae(28295,{value:n})}function Qn(n,e){if(n===e)return!0;const t=Yi(n);if(t!==Yi(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return la(n).isEqual(la(e));case 3:return function(s,o){if(typeof s.timestampValue=="string"&&typeof o.timestampValue=="string"&&s.timestampValue.length===o.timestampValue.length)return s.timestampValue===o.timestampValue;const a=mi(s.timestampValue),l=mi(o.timestampValue);return a.seconds===l.seconds&&a.nanos===l.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(s,o){return gi(s.bytesValue).isEqual(gi(o.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(s,o){return jt(s.geoPointValue.latitude)===jt(o.geoPointValue.latitude)&&jt(s.geoPointValue.longitude)===jt(o.geoPointValue.longitude)}(n,e);case 2:return function(s,o){if("integerValue"in s&&"integerValue"in o)return jt(s.integerValue)===jt(o.integerValue);if("doubleValue"in s&&"doubleValue"in o){const a=jt(s.doubleValue),l=jt(o.doubleValue);return a===l?ra(a)===ra(l):isNaN(a)&&isNaN(l)}return!1}(n,e);case 9:return _s(n.arrayValue.values||[],e.arrayValue.values||[],Qn);case 10:case 11:return function(s,o){const a=s.mapValue.fields||{},l=o.mapValue.fields||{};if(Xm(a)!==Xm(l))return!1;for(const c in a)if(a.hasOwnProperty(c)&&(l[c]===void 0||!Qn(a[c],l[c])))return!1;return!0}(n,e);default:return Ae(52216,{left:n})}}function da(n,e){return(n.values||[]).find(t=>Qn(t,e))!==void 0}function Xi(n,e){if(n===e)return 0;const t=Yi(n),i=Yi(e);if(t!==i)return Le(t,i);switch(t){case 0:case 9007199254740991:return 0;case 1:return Le(n.booleanValue,e.booleanValue);case 2:return function(o,a){const l=jt(o.integerValue||o.doubleValue),c=jt(a.integerValue||a.doubleValue);return l<c?-1:l>c?1:l===c?0:isNaN(l)?isNaN(c)?0:-1:1}(n,e);case 3:return Zm(n.timestampValue,e.timestampValue);case 4:return Zm(la(n),la(e));case 5:return pu(n.stringValue,e.stringValue);case 6:return function(o,a){const l=gi(o),c=gi(a);return l.compareTo(c)}(n.bytesValue,e.bytesValue);case 7:return function(o,a){const l=o.split("/"),c=a.split("/");for(let u=0;u<l.length&&u<c.length;u++){const h=Le(l[u],c[u]);if(h!==0)return h}return Le(l.length,c.length)}(n.referenceValue,e.referenceValue);case 8:return function(o,a){const l=Le(jt(o.latitude),jt(a.latitude));return l!==0?l:Le(jt(o.longitude),jt(a.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return eg(n.arrayValue,e.arrayValue);case 10:return function(o,a){var l,c,u,h;const p=o.fields||{},f=a.fields||{},b=(l=p[Fs])===null||l===void 0?void 0:l.arrayValue,x=(c=f[Fs])===null||c===void 0?void 0:c.arrayValue,S=Le(((u=b==null?void 0:b.values)===null||u===void 0?void 0:u.length)||0,((h=x==null?void 0:x.values)===null||h===void 0?void 0:h.length)||0);return S!==0?S:eg(b,x)}(n.mapValue,e.mapValue);case 11:return function(o,a){if(o===Wi.mapValue&&a===Wi.mapValue)return 0;if(o===Wi.mapValue)return 1;if(a===Wi.mapValue)return-1;const l=o.fields||{},c=Object.keys(l),u=a.fields||{},h=Object.keys(u);c.sort(),h.sort();for(let p=0;p<c.length&&p<h.length;++p){const f=pu(c[p],h[p]);if(f!==0)return f;const b=Xi(l[c[p]],u[h[p]]);if(b!==0)return b}return Le(c.length,h.length)}(n.mapValue,e.mapValue);default:throw Ae(23264,{Pe:t})}}function Zm(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return Le(n,e);const t=mi(n),i=mi(e),s=Le(t.seconds,i.seconds);return s!==0?s:Le(t.nanos,i.nanos)}function eg(n,e){const t=n.values||[],i=e.values||[];for(let s=0;s<t.length&&s<i.length;++s){const o=Xi(t[s],i[s]);if(o)return o}return Le(t.length,i.length)}function zs(n){return vu(n)}function vu(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){const i=mi(t);return`time(${i.seconds},${i.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return gi(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return Te.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let i="[",s=!0;for(const o of t.values||[])s?s=!1:i+=",",i+=vu(o);return i+"]"}(n.arrayValue):"mapValue"in n?function(t){const i=Object.keys(t.fields||{}).sort();let s="{",o=!0;for(const a of i)o?o=!1:s+=",",s+=`${a}:${vu(t.fields[a])}`;return s+"}"}(n.mapValue):Ae(61005,{value:n})}function Rl(n){switch(Yi(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Pc(n);return e?16+Rl(e):16;case 5:return 2*n.stringValue.length;case 6:return gi(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return function(i){return(i.values||[]).reduce((s,o)=>s+Rl(o),0)}(n.arrayValue);case 10:case 11:return function(i){let s=0;return sr(i.fields,(o,a)=>{s+=o.length+Rl(a)}),s}(n.mapValue);default:throw Ae(13486,{value:n})}}function zr(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function wu(n){return!!n&&"integerValue"in n}function ua(n){return!!n&&"arrayValue"in n}function tg(n){return!!n&&"nullValue"in n}function ng(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Al(n){return!!n&&"mapValue"in n}function Fc(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{})[mh])===null||t===void 0?void 0:t.stringValue)===gh}function Go(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return sr(n.mapValue.fields,(t,i)=>e.mapValue.fields[t]=Go(i)),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Go(n.arrayValue.values[t]);return e}return Object.assign({},n)}function tb(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===eb}const nb={mapValue:{fields:{[mh]:{stringValue:gh},[Fs]:{arrayValue:{}}}}};function cj(n){return"nullValue"in n?Cl:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?zr(Qi.empty(),Te.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?Fc(n)?nb:{mapValue:{}}:Ae(35942,{value:n})}function dj(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?zr(Qi.empty(),Te.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?nb:"mapValue"in n?Fc(n)?{mapValue:{}}:Wi:Ae(61959,{value:n})}function ig(n,e){const t=Xi(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function rg(n,e){const t=Xi(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zt{constructor(e){this.value=e}static empty(){return new Zt({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let i=0;i<e.length-1;++i)if(t=(t.mapValue.fields||{})[e.get(i)],!Al(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Go(t)}setAll(e){let t=St.emptyPath(),i={},s=[];e.forEach((a,l)=>{if(!t.isImmediateParentOf(l)){const c=this.getFieldsMap(t);this.applyChanges(c,i,s),i={},s=[],t=l.popLast()}a?i[l.lastSegment()]=Go(a):s.push(l.lastSegment())});const o=this.getFieldsMap(t);this.applyChanges(o,i,s)}delete(e){const t=this.field(e.popLast());Al(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Qn(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let i=0;i<e.length;++i){let s=t.mapValue.fields[e.get(i)];Al(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},t.mapValue.fields[e.get(i)]=s),t=s}return t.mapValue.fields}applyChanges(e,t,i){sr(t,(s,o)=>e[s]=o);for(const s of i)delete e[s]}clone(){return new Zt(Go(this.value))}}function ib(n){const e=[];return sr(n.fields,(t,i)=>{const s=new St([t]);if(Al(i)){const o=ib(i.mapValue).fields;if(o.length===0)e.push(s);else for(const a of o)e.push(s.child(a))}else e.push(s)}),new fn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kt{constructor(e,t,i,s,o,a,l){this.key=e,this.documentType=t,this.version=i,this.readTime=s,this.createTime=o,this.data=a,this.documentState=l}static newInvalidDocument(e){return new kt(e,0,De.min(),De.min(),De.min(),Zt.empty(),0)}static newFoundDocument(e,t,i,s){return new kt(e,1,t,De.min(),i,s,0)}static newNoDocument(e,t){return new kt(e,2,t,De.min(),De.min(),Zt.empty(),0)}static newUnknownDocument(e,t){return new kt(e,3,t,De.min(),De.min(),Zt.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(De.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Zt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Zt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=De.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof kt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new kt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ji{constructor(e,t){this.position=e,this.inclusive=t}}function sg(n,e,t){let i=0;for(let s=0;s<n.position.length;s++){const o=e[s],a=n.position[s];if(o.field.isKeyField()?i=Te.comparator(Te.fromName(a.referenceValue),t.key):i=Xi(a,t.data.field(o.field)),o.dir==="desc"&&(i*=-1),i!==0)break}return i}function og(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Qn(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ha{constructor(e,t="asc"){this.field=e,this.dir=t}}function uj(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rb{}class it extends rb{constructor(e,t,i){super(),this.field=e,this.op=t,this.value=i}static create(e,t,i){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,i):new hj(e,t,i):t==="array-contains"?new gj(e,i):t==="in"?new db(e,i):t==="not-in"?new fj(e,i):t==="array-contains-any"?new yj(e,i):new it(e,t,i)}static createKeyFieldInFilter(e,t,i){return t==="in"?new pj(e,i):new mj(e,i)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Xi(t,this.value)):t!==null&&Yi(this.value)===Yi(t)&&this.matchesComparison(Xi(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Ae(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class pt extends rb{constructor(e,t){super(),this.filters=e,this.op=t,this.Te=null}static create(e,t){return new pt(e,t)}matches(e){return Ds(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.Te!==null||(this.Te=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.Te}getFilters(){return Object.assign([],this.filters)}}function Ds(n){return n.op==="and"}function ku(n){return n.op==="or"}function fh(n){return sb(n)&&Ds(n)}function sb(n){for(const e of n.filters)if(e instanceof pt)return!1;return!0}function Su(n){if(n instanceof it)return n.field.canonicalString()+n.op.toString()+zs(n.value);if(fh(n))return n.filters.map(e=>Su(e)).join(",");{const e=n.filters.map(t=>Su(t)).join(",");return`${n.op}(${e})`}}function ob(n,e){return n instanceof it?function(i,s){return s instanceof it&&i.op===s.op&&i.field.isEqual(s.field)&&Qn(i.value,s.value)}(n,e):n instanceof pt?function(i,s){return s instanceof pt&&i.op===s.op&&i.filters.length===s.filters.length?i.filters.reduce((o,a,l)=>o&&ob(a,s.filters[l]),!0):!1}(n,e):void Ae(19439)}function ab(n,e){const t=n.filters.concat(e);return pt.create(t,n.op)}function lb(n){return n instanceof it?function(t){return`${t.field.canonicalString()} ${t.op} ${zs(t.value)}`}(n):n instanceof pt?function(t){return t.op.toString()+" {"+t.getFilters().map(lb).join(" ,")+"}"}(n):"Filter"}class hj extends it{constructor(e,t,i){super(e,t,i),this.key=Te.fromName(i.referenceValue)}matches(e){const t=Te.comparator(e.key,this.key);return this.matchesComparison(t)}}class pj extends it{constructor(e,t){super(e,"in",t),this.keys=cb("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class mj extends it{constructor(e,t){super(e,"not-in",t),this.keys=cb("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function cb(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(i=>Te.fromName(i.referenceValue))}class gj extends it{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return ua(t)&&da(t.arrayValue,this.value)}}class db extends it{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&da(this.value.arrayValue,t)}}class fj extends it{constructor(e,t){super(e,"not-in",t)}matches(e){if(da(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!da(this.value.arrayValue,t)}}class yj extends it{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!ua(t)||!t.arrayValue.values)&&t.arrayValue.values.some(i=>da(this.value.arrayValue,i))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xj{constructor(e,t=null,i=[],s=[],o=null,a=null,l=null){this.path=e,this.collectionGroup=t,this.orderBy=i,this.filters=s,this.limit=o,this.startAt=a,this.endAt=l,this.Ie=null}}function Tu(n,e=null,t=[],i=[],s=null,o=null,a=null){return new xj(n,e,t,i,s,o,a)}function Dr(n){const e=ke(n);if(e.Ie===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(i=>Su(i)).join(","),t+="|ob:",t+=e.orderBy.map(i=>function(o){return o.field.canonicalString()+o.dir}(i)).join(","),wa(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(i=>zs(i)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(i=>zs(i)).join(",")),e.Ie=t}return e.Ie}function Sa(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!uj(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!ob(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!og(n.startAt,e.startAt)&&og(n.endAt,e.endAt)}function Ql(n){return Te.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function Yl(n,e){return n.filters.filter(t=>t instanceof it&&t.field.isEqual(e))}function ag(n,e,t){let i=Cl,s=!0;for(const o of Yl(n,e)){let a=Cl,l=!0;switch(o.op){case"<":case"<=":a=cj(o.value);break;case"==":case"in":case">=":a=o.value;break;case">":a=o.value,l=!1;break;case"!=":case"not-in":a=Cl}ig({value:i,inclusive:s},{value:a,inclusive:l})<0&&(i=a,s=l)}if(t!==null){for(let o=0;o<n.orderBy.length;++o)if(n.orderBy[o].field.isEqual(e)){const a=t.position[o];ig({value:i,inclusive:s},{value:a,inclusive:t.inclusive})<0&&(i=a,s=t.inclusive);break}}return{value:i,inclusive:s}}function lg(n,e,t){let i=Wi,s=!0;for(const o of Yl(n,e)){let a=Wi,l=!0;switch(o.op){case">=":case">":a=dj(o.value),l=!1;break;case"==":case"in":case"<=":a=o.value;break;case"<":a=o.value,l=!1;break;case"!=":case"not-in":a=Wi}rg({value:i,inclusive:s},{value:a,inclusive:l})>0&&(i=a,s=l)}if(t!==null){for(let o=0;o<n.orderBy.length;++o)if(n.orderBy[o].field.isEqual(e)){const a=t.position[o];rg({value:i,inclusive:s},{value:a,inclusive:t.inclusive})>0&&(i=a,s=t.inclusive);break}}return{value:i,inclusive:s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bi{constructor(e,t=null,i=[],s=[],o=null,a="F",l=null,c=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=i,this.filters=s,this.limit=o,this.limitType=a,this.startAt=l,this.endAt=c,this.Ee=null,this.de=null,this.Ae=null,this.startAt,this.endAt}}function ub(n,e,t,i,s,o,a,l){return new bi(n,e,t,i,s,o,a,l)}function eo(n){return new bi(n)}function cg(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function yh(n){return n.collectionGroup!==null}function vs(n){const e=ke(n);if(e.Ee===null){e.Ee=[];const t=new Set;for(const o of e.explicitOrderBy)e.Ee.push(o),t.add(o.field.canonicalString());const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let l=new mt(St.comparator);return a.filters.forEach(c=>{c.getFlattenedFilters().forEach(u=>{u.isInequality()&&(l=l.add(u.field))})}),l})(e).forEach(o=>{t.has(o.canonicalString())||o.isKeyField()||e.Ee.push(new ha(o,i))}),t.has(St.keyField().canonicalString())||e.Ee.push(new ha(St.keyField(),i))}return e.Ee}function cn(n){const e=ke(n);return e.de||(e.de=pb(e,vs(n))),e.de}function hb(n){const e=ke(n);return e.Ae||(e.Ae=pb(e,n.explicitOrderBy)),e.Ae}function pb(n,e){if(n.limitType==="F")return Tu(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(s=>{const o=s.dir==="desc"?"asc":"desc";return new ha(s.field,o)});const t=n.endAt?new Ji(n.endAt.position,n.endAt.inclusive):null,i=n.startAt?new Ji(n.startAt.position,n.startAt.inclusive):null;return Tu(n.path,n.collectionGroup,e,n.filters,n.limit,t,i)}}function ju(n,e){const t=n.filters.concat([e]);return new bi(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function Xl(n,e,t){return new bi(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Ta(n,e){return Sa(cn(n),cn(e))&&n.limitType===e.limitType}function mb(n){return`${Dr(cn(n))}|lt:${n.limitType}`}function fs(n){return`Query(target=${function(t){let i=t.path.canonicalString();return t.collectionGroup!==null&&(i+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(i+=`, filters: [${t.filters.map(s=>lb(s)).join(", ")}]`),wa(t.limit)||(i+=", limit: "+t.limit),t.orderBy.length>0&&(i+=`, orderBy: [${t.orderBy.map(s=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(s)).join(", ")}]`),t.startAt&&(i+=", startAt: ",i+=t.startAt.inclusive?"b:":"a:",i+=t.startAt.position.map(s=>zs(s)).join(",")),t.endAt&&(i+=", endAt: ",i+=t.endAt.inclusive?"a:":"b:",i+=t.endAt.position.map(s=>zs(s)).join(",")),`Target(${i})`}(cn(n))}; limitType=${n.limitType})`}function ja(n,e){return e.isFoundDocument()&&function(i,s){const o=s.key.path;return i.collectionGroup!==null?s.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(o):Te.isDocumentKey(i.path)?i.path.isEqual(o):i.path.isImmediateParentOf(o)}(n,e)&&function(i,s){for(const o of vs(i))if(!o.field.isKeyField()&&s.data.field(o.field)===null)return!1;return!0}(n,e)&&function(i,s){for(const o of i.filters)if(!o.matches(s))return!1;return!0}(n,e)&&function(i,s){return!(i.startAt&&!function(a,l,c){const u=sg(a,l,c);return a.inclusive?u<=0:u<0}(i.startAt,vs(i),s)||i.endAt&&!function(a,l,c){const u=sg(a,l,c);return a.inclusive?u>=0:u>0}(i.endAt,vs(i),s))}(n,e)}function gb(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function fb(n){return(e,t)=>{let i=!1;for(const s of vs(n)){const o=bj(s,e,t);if(o!==0)return o;i=i||s.field.isKeyField()}return 0}}function bj(n,e,t){const i=n.field.isKeyField()?Te.comparator(e.key,t.key):function(o,a,l){const c=a.data.field(o),u=l.data.field(o);return c!==null&&u!==null?Xi(c,u):Ae(42886)}(n.field,e,t);switch(n.dir){case"asc":return i;case"desc":return-1*i;default:return Ae(19790,{direction:n.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vi{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i!==void 0){for(const[s,o]of i)if(this.equalsFn(s,e))return o}}has(e){return this.get(e)!==void 0}set(e,t){const i=this.mapKeyFn(e),s=this.inner[i];if(s===void 0)return this.inner[i]=[[e,t]],void this.innerSize++;for(let o=0;o<s.length;o++)if(this.equalsFn(s[o][0],e))return void(s[o]=[e,t]);s.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i===void 0)return!1;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return i.length===1?delete this.inner[t]:i.splice(s,1),this.innerSize--,!0;return!1}forEach(e){sr(this.inner,(t,i)=>{for(const[s,o]of i)e(s,o)})}isEmpty(){return Kx(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vj=new vt(Te.comparator);function yn(){return vj}const yb=new vt(Te.comparator);function Wo(...n){let e=yb;for(const t of n)e=e.insert(t.key,t);return e}function xb(n){let e=yb;return n.forEach((t,i)=>e=e.insert(t,i.overlayedDocument)),e}function qn(){return Ko()}function bb(){return Ko()}function Ko(){return new vi(n=>n.toString(),(n,e)=>n.isEqual(e))}const wj=new vt(Te.comparator),kj=new mt(Te.comparator);function Ke(...n){let e=kj;for(const t of n)e=e.add(t);return e}const Sj=new mt(Le);function xh(){return Sj}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bh(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ra(e)?"-0":e}}function vb(n){return{integerValue:""+n}}function wb(n,e){return Dx(e)?vb(e):bh(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zc{constructor(){this._=void 0}}function Tj(n,e,t){return n instanceof Ns?function(s,o){const a={fields:{[Xx]:{stringValue:Yx},[Zx]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return o&&Bc(o)&&(o=Pc(o)),o&&(a.fields[Jx]=o),{mapValue:a}}(t,e):n instanceof Nr?Sb(n,e):n instanceof Mr?Tb(n,e):function(s,o){const a=kb(s,o),l=dg(a)+dg(s.Re);return wu(a)&&wu(s.Re)?vb(l):bh(s.serializer,l)}(n,e)}function jj(n,e,t){return n instanceof Nr?Sb(n,e):n instanceof Mr?Tb(n,e):t}function kb(n,e){return n instanceof Ms?function(i){return wu(i)||function(o){return!!o&&"doubleValue"in o}(i)}(e)?e:{integerValue:0}:null}class Ns extends zc{}class Nr extends zc{constructor(e){super(),this.elements=e}}function Sb(n,e){const t=jb(e);for(const i of n.elements)t.some(s=>Qn(s,i))||t.push(i);return{arrayValue:{values:t}}}class Mr extends zc{constructor(e){super(),this.elements=e}}function Tb(n,e){let t=jb(e);for(const i of n.elements)t=t.filter(s=>!Qn(s,i));return{arrayValue:{values:t}}}class Ms extends zc{constructor(e,t){super(),this.serializer=e,this.Re=t}}function dg(n){return jt(n.integerValue||n.doubleValue)}function jb(n){return ua(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _a{constructor(e,t){this.field=e,this.transform=t}}function _j(n,e){return n.field.isEqual(e.field)&&function(i,s){return i instanceof Nr&&s instanceof Nr||i instanceof Mr&&s instanceof Mr?_s(i.elements,s.elements,Qn):i instanceof Ms&&s instanceof Ms?Qn(i.Re,s.Re):i instanceof Ns&&s instanceof Ns}(n.transform,e.transform)}class Ij{constructor(e,t){this.version=e,this.transformResults=t}}class _t{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new _t}static exists(e){return new _t(void 0,e)}static updateTime(e){return new _t(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function El(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class Dc{}function _b(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new no(n.key,_t.none()):new to(n.key,n.data,_t.none());{const t=n.data,i=Zt.empty();let s=new mt(St.comparator);for(let o of e.fields)if(!s.has(o)){let a=t.field(o);a===null&&o.length>1&&(o=o.popLast(),a=t.field(o)),a===null?i.delete(o):i.set(o,a),s=s.add(o)}return new wi(n.key,i,new fn(s.toArray()),_t.none())}}function Cj(n,e,t){n instanceof to?function(s,o,a){const l=s.value.clone(),c=hg(s.fieldTransforms,o,a.transformResults);l.setAll(c),o.convertToFoundDocument(a.version,l).setHasCommittedMutations()}(n,e,t):n instanceof wi?function(s,o,a){if(!El(s.precondition,o))return void o.convertToUnknownDocument(a.version);const l=hg(s.fieldTransforms,o,a.transformResults),c=o.data;c.setAll(Ib(s)),c.setAll(l),o.convertToFoundDocument(a.version,c).setHasCommittedMutations()}(n,e,t):function(s,o,a){o.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,t)}function Qo(n,e,t,i){return n instanceof to?function(o,a,l,c){if(!El(o.precondition,a))return l;const u=o.value.clone(),h=pg(o.fieldTransforms,c,a);return u.setAll(h),a.convertToFoundDocument(a.version,u).setHasLocalMutations(),null}(n,e,t,i):n instanceof wi?function(o,a,l,c){if(!El(o.precondition,a))return l;const u=pg(o.fieldTransforms,c,a),h=a.data;return h.setAll(Ib(o)),h.setAll(u),a.convertToFoundDocument(a.version,h).setHasLocalMutations(),l===null?null:l.unionWith(o.fieldMask.fields).unionWith(o.fieldTransforms.map(p=>p.field))}(n,e,t,i):function(o,a,l){return El(o.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):l}(n,e,t)}function Rj(n,e){let t=null;for(const i of n.fieldTransforms){const s=e.data.field(i.field),o=kb(i.transform,s||null);o!=null&&(t===null&&(t=Zt.empty()),t.set(i.field,o))}return t||null}function ug(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(i,s){return i===void 0&&s===void 0||!(!i||!s)&&_s(i,s,(o,a)=>_j(o,a))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class to extends Dc{constructor(e,t,i,s=[]){super(),this.key=e,this.value=t,this.precondition=i,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class wi extends Dc{constructor(e,t,i,s,o=[]){super(),this.key=e,this.data=t,this.fieldMask=i,this.precondition=s,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}}function Ib(n){const e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const i=n.data.field(t);e.set(t,i)}}),e}function hg(n,e,t){const i=new Map;Pe(n.length===t.length,32656,{Ve:t.length,me:n.length});for(let s=0;s<t.length;s++){const o=n[s],a=o.transform,l=e.data.field(o.field);i.set(o.field,jj(a,l,t[s]))}return i}function pg(n,e,t){const i=new Map;for(const s of n){const o=s.transform,a=t.data.field(s.field);i.set(s.field,Tj(o,a,e))}return i}class no extends Dc{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class vh extends Dc{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wh{constructor(e,t,i,s){this.batchId=e,this.localWriteTime=t,this.baseMutations=i,this.mutations=s}applyToRemoteDocument(e,t){const i=t.mutationResults;for(let s=0;s<this.mutations.length;s++){const o=this.mutations[s];o.key.isEqual(e.key)&&Cj(o,e,i[s])}}applyToLocalView(e,t){for(const i of this.baseMutations)i.key.isEqual(e.key)&&(t=Qo(i,e,t,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(e.key)&&(t=Qo(i,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const i=bb();return this.mutations.forEach(s=>{const o=e.get(s.key),a=o.overlayedDocument;let l=this.applyToLocalView(a,o.mutatedFields);l=t.has(s.key)?null:l;const c=_b(a,l);c!==null&&i.set(s.key,c),a.isValidDocument()||a.convertToNoDocument(De.min())}),i}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),Ke())}isEqual(e){return this.batchId===e.batchId&&_s(this.mutations,e.mutations,(t,i)=>ug(t,i))&&_s(this.baseMutations,e.baseMutations,(t,i)=>ug(t,i))}}class kh{constructor(e,t,i,s){this.batch=e,this.commitVersion=t,this.mutationResults=i,this.docVersions=s}static from(e,t,i){Pe(e.mutations.length===i.length,58842,{fe:e.mutations.length,ge:i.length});let s=function(){return wj}();const o=e.mutations;for(let a=0;a<o.length;a++)s=s.insert(o[a].key,i[a].version);return new kh(e,t,i,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sh{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cb{constructor(e,t,i){this.alias=e,this.aggregateType=t,this.fieldPath=i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Aj{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Mt,rt;function Rb(n){switch(n){case Z.OK:return Ae(64938);case Z.CANCELLED:case Z.UNKNOWN:case Z.DEADLINE_EXCEEDED:case Z.RESOURCE_EXHAUSTED:case Z.INTERNAL:case Z.UNAVAILABLE:case Z.UNAUTHENTICATED:return!1;case Z.INVALID_ARGUMENT:case Z.NOT_FOUND:case Z.ALREADY_EXISTS:case Z.PERMISSION_DENIED:case Z.FAILED_PRECONDITION:case Z.ABORTED:case Z.OUT_OF_RANGE:case Z.UNIMPLEMENTED:case Z.DATA_LOSS:return!0;default:return Ae(15467,{code:n})}}function Ab(n){if(n===void 0)return zt("GRPC error has no .code"),Z.UNKNOWN;switch(n){case Mt.OK:return Z.OK;case Mt.CANCELLED:return Z.CANCELLED;case Mt.UNKNOWN:return Z.UNKNOWN;case Mt.DEADLINE_EXCEEDED:return Z.DEADLINE_EXCEEDED;case Mt.RESOURCE_EXHAUSTED:return Z.RESOURCE_EXHAUSTED;case Mt.INTERNAL:return Z.INTERNAL;case Mt.UNAVAILABLE:return Z.UNAVAILABLE;case Mt.UNAUTHENTICATED:return Z.UNAUTHENTICATED;case Mt.INVALID_ARGUMENT:return Z.INVALID_ARGUMENT;case Mt.NOT_FOUND:return Z.NOT_FOUND;case Mt.ALREADY_EXISTS:return Z.ALREADY_EXISTS;case Mt.PERMISSION_DENIED:return Z.PERMISSION_DENIED;case Mt.FAILED_PRECONDITION:return Z.FAILED_PRECONDITION;case Mt.ABORTED:return Z.ABORTED;case Mt.OUT_OF_RANGE:return Z.OUT_OF_RANGE;case Mt.UNIMPLEMENTED:return Z.UNIMPLEMENTED;case Mt.DATA_LOSS:return Z.DATA_LOSS;default:return Ae(39323,{code:n})}}(rt=Mt||(Mt={}))[rt.OK=0]="OK",rt[rt.CANCELLED=1]="CANCELLED",rt[rt.UNKNOWN=2]="UNKNOWN",rt[rt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",rt[rt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",rt[rt.NOT_FOUND=5]="NOT_FOUND",rt[rt.ALREADY_EXISTS=6]="ALREADY_EXISTS",rt[rt.PERMISSION_DENIED=7]="PERMISSION_DENIED",rt[rt.UNAUTHENTICATED=16]="UNAUTHENTICATED",rt[rt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",rt[rt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",rt[rt.ABORTED=10]="ABORTED",rt[rt.OUT_OF_RANGE=11]="OUT_OF_RANGE",rt[rt.UNIMPLEMENTED=12]="UNIMPLEMENTED",rt[rt.INTERNAL=13]="INTERNAL",rt[rt.UNAVAILABLE=14]="UNAVAILABLE",rt[rt.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Jl=null;/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ej=new Ui([4294967295,4294967295],0);function mg(n){const e=oh().encode(n),t=new wx;return t.update(e),new Uint8Array(t.digest())}function gg(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),i=e.getUint32(4,!0),s=e.getUint32(8,!0),o=e.getUint32(12,!0);return[new Ui([t,i],0),new Ui([s,o],0)]}class Th{constructor(e,t,i){if(this.bitmap=e,this.padding=t,this.hashCount=i,t<0||t>=8)throw new Lo(`Invalid padding: ${t}`);if(i<0)throw new Lo(`Invalid hash count: ${i}`);if(e.length>0&&this.hashCount===0)throw new Lo(`Invalid hash count: ${i}`);if(e.length===0&&t!==0)throw new Lo(`Invalid padding when bitmap length is 0: ${t}`);this.pe=8*e.length-t,this.ye=Ui.fromNumber(this.pe)}we(e,t,i){let s=e.add(t.multiply(Ui.fromNumber(i)));return s.compare(Ej)===1&&(s=new Ui([s.getBits(0),s.getBits(1)],0)),s.modulo(this.ye).toNumber()}be(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.pe===0)return!1;const t=mg(e),[i,s]=gg(t);for(let o=0;o<this.hashCount;o++){const a=this.we(i,s,o);if(!this.be(a))return!1}return!0}static create(e,t,i){const s=e%8==0?0:8-e%8,o=new Uint8Array(Math.ceil(e/8)),a=new Th(o,s,t);return i.forEach(l=>a.insert(l)),a}insert(e){if(this.pe===0)return;const t=mg(e),[i,s]=gg(t);for(let o=0;o<this.hashCount;o++){const a=this.we(i,s,o);this.Se(a)}}Se(e){const t=Math.floor(e/8),i=e%8;this.bitmap[t]|=1<<i}}class Lo extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ia{constructor(e,t,i,s,o){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=i,this.documentUpdates=s,this.resolvedLimboDocuments=o}static createSynthesizedRemoteEventForCurrentChange(e,t,i){const s=new Map;return s.set(e,Ca.createSynthesizedTargetChangeForCurrentChange(e,t,i)),new Ia(De.min(),s,new vt(Le),yn(),Ke())}}class Ca{constructor(e,t,i,s,o){this.resumeToken=e,this.current=t,this.addedDocuments=i,this.modifiedDocuments=s,this.removedDocuments=o}static createSynthesizedTargetChangeForCurrentChange(e,t,i){return new Ca(i,t,Ke(),Ke(),Ke())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bl{constructor(e,t,i,s){this.De=e,this.removedTargetIds=t,this.key=i,this.ve=s}}class Eb{constructor(e,t){this.targetId=e,this.Ce=t}}class Bb{constructor(e,t,i=At.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=t,this.resumeToken=i,this.cause=s}}class fg{constructor(){this.Fe=0,this.Me=yg(),this.xe=At.EMPTY_BYTE_STRING,this.Oe=!1,this.Ne=!0}get current(){return this.Oe}get resumeToken(){return this.xe}get Be(){return this.Fe!==0}get Le(){return this.Ne}ke(e){e.approximateByteSize()>0&&(this.Ne=!0,this.xe=e)}qe(){let e=Ke(),t=Ke(),i=Ke();return this.Me.forEach((s,o)=>{switch(o){case 0:e=e.add(s);break;case 2:t=t.add(s);break;case 1:i=i.add(s);break;default:Ae(38017,{changeType:o})}}),new Ca(this.xe,this.Oe,e,t,i)}Qe(){this.Ne=!1,this.Me=yg()}$e(e,t){this.Ne=!0,this.Me=this.Me.insert(e,t)}Ue(e){this.Ne=!0,this.Me=this.Me.remove(e)}Ke(){this.Fe+=1}We(){this.Fe-=1,Pe(this.Fe>=0,3241,{Fe:this.Fe})}Ge(){this.Ne=!0,this.Oe=!0}}class Bj{constructor(e){this.ze=e,this.je=new Map,this.He=yn(),this.Je=pl(),this.Ye=pl(),this.Ze=new vt(Le)}Xe(e){for(const t of e.De)e.ve&&e.ve.isFoundDocument()?this.et(t,e.ve):this.tt(t,e.key,e.ve);for(const t of e.removedTargetIds)this.tt(t,e.key,e.ve)}nt(e){this.forEachTarget(e,t=>{const i=this.rt(t);switch(e.state){case 0:this.it(t)&&i.ke(e.resumeToken);break;case 1:i.We(),i.Be||i.Qe(),i.ke(e.resumeToken);break;case 2:i.We(),i.Be||this.removeTarget(t);break;case 3:this.it(t)&&(i.Ge(),i.ke(e.resumeToken));break;case 4:this.it(t)&&(this.st(t),i.ke(e.resumeToken));break;default:Ae(56790,{state:e.state})}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.je.forEach((i,s)=>{this.it(s)&&t(s)})}ot(e){const t=e.targetId,i=e.Ce.count,s=this._t(t);if(s){const o=s.target;if(Ql(o))if(i===0){const a=new Te(o.path);this.tt(t,a,kt.newNoDocument(a,De.min()))}else Pe(i===1,20013,{expectedCount:i});else{const a=this.ut(t);if(a!==i){const l=this.ct(e),c=l?this.lt(l,e,a):1;if(c!==0){this.st(t);const u=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(t,u)}Jl==null||Jl.ht(function(h,p,f,b,x){var S,w,I,j,A,D;const O={localCacheCount:h,existenceFilterCount:p.count,databaseId:f.database,projectId:f.projectId},P=p.unchangedNames;return P&&(O.bloomFilter={applied:x===0,hashCount:(S=P==null?void 0:P.hashCount)!==null&&S!==void 0?S:0,bitmapLength:(j=(I=(w=P==null?void 0:P.bits)===null||w===void 0?void 0:w.bitmap)===null||I===void 0?void 0:I.length)!==null&&j!==void 0?j:0,padding:(D=(A=P==null?void 0:P.bits)===null||A===void 0?void 0:A.padding)!==null&&D!==void 0?D:0,mightContain:B=>{var k;return(k=b==null?void 0:b.mightContain(B))!==null&&k!==void 0&&k}}),O}(a,e.Ce,this.ze.Pt(),l,c))}}}}ct(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:i="",padding:s=0},hashCount:o=0}=t;let a,l;try{a=gi(i).toUint8Array()}catch(c){if(c instanceof Qx)return Tn("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{l=new Th(a,s,o)}catch(c){return Tn(c instanceof Lo?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return l.pe===0?null:l}lt(e,t,i){return t.Ce.count===i-this.Tt(e,t.targetId)?0:2}Tt(e,t){const i=this.ze.getRemoteKeysForTarget(t);let s=0;return i.forEach(o=>{const a=this.ze.Pt(),l=`projects/${a.projectId}/databases/${a.database}/documents/${o.path.canonicalString()}`;e.mightContain(l)||(this.tt(t,o,null),s++)}),s}It(e){const t=new Map;this.je.forEach((o,a)=>{const l=this._t(a);if(l){if(o.current&&Ql(l.target)){const c=new Te(l.target.path);this.Et(c).has(a)||this.dt(a,c)||this.tt(a,c,kt.newNoDocument(c,e))}o.Le&&(t.set(a,o.qe()),o.Qe())}});let i=Ke();this.Ye.forEach((o,a)=>{let l=!0;a.forEachWhile(c=>{const u=this._t(c);return!u||u.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)}),l&&(i=i.add(o))}),this.He.forEach((o,a)=>a.setReadTime(e));const s=new Ia(e,t,this.Ze,this.He,i);return this.He=yn(),this.Je=pl(),this.Ye=pl(),this.Ze=new vt(Le),s}et(e,t){if(!this.it(e))return;const i=this.dt(e,t.key)?2:0;this.rt(e).$e(t.key,i),this.He=this.He.insert(t.key,t),this.Je=this.Je.insert(t.key,this.Et(t.key).add(e)),this.Ye=this.Ye.insert(t.key,this.At(t.key).add(e))}tt(e,t,i){if(!this.it(e))return;const s=this.rt(e);this.dt(e,t)?s.$e(t,1):s.Ue(t),this.Ye=this.Ye.insert(t,this.At(t).delete(e)),this.Ye=this.Ye.insert(t,this.At(t).add(e)),i&&(this.He=this.He.insert(t,i))}removeTarget(e){this.je.delete(e)}ut(e){const t=this.rt(e).qe();return this.ze.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ke(e){this.rt(e).Ke()}rt(e){let t=this.je.get(e);return t||(t=new fg,this.je.set(e,t)),t}At(e){let t=this.Ye.get(e);return t||(t=new mt(Le),this.Ye=this.Ye.insert(e,t)),t}Et(e){let t=this.Je.get(e);return t||(t=new mt(Le),this.Je=this.Je.insert(e,t)),t}it(e){const t=this._t(e)!==null;return t||ue("WatchChangeAggregator","Detected inactive target",e),t}_t(e){const t=this.je.get(e);return t&&t.Be?null:this.ze.Rt(e)}st(e){this.je.set(e,new fg),this.ze.getRemoteKeysForTarget(e).forEach(t=>{this.tt(e,t,null)})}dt(e,t){return this.ze.getRemoteKeysForTarget(e).has(t)}}function pl(){return new vt(Te.comparator)}function yg(){return new vt(Te.comparator)}const Pj={asc:"ASCENDING",desc:"DESCENDING"},Fj={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},zj={and:"AND",or:"OR"};class Dj{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function _u(n,e){return n.useProto3Json||wa(e)?e:{value:e}}function Ws(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Pb(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function Nj(n,e){return Ws(n,e.toTimestamp())}function Dt(n){return Pe(!!n,49232),De.fromTimestamp(function(t){const i=mi(t);return new xt(i.seconds,i.nanos)}(n))}function jh(n,e){return Iu(n,e).canonicalString()}function Iu(n,e){const t=function(s){return new nt(["projects",s.projectId,"databases",s.database])}(n).child("documents");return e===void 0?t:t.child(e)}function Fb(n){const e=nt.fromString(n);return Pe(Ub(e),10190,{key:e.toString()}),e}function pa(n,e){return jh(n.databaseId,e.path)}function Gn(n,e){const t=Fb(e);if(t.get(1)!==n.databaseId.projectId)throw new de(Z.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new de(Z.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new Te(Nb(t))}function zb(n,e){return jh(n.databaseId,e)}function Db(n){const e=Fb(n);return e.length===4?nt.emptyPath():Nb(e)}function Cu(n){return new nt(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function Nb(n){return Pe(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function xg(n,e,t){return{name:pa(n,e),fields:t.value.mapValue.fields}}function Mb(n,e,t){const i=Gn(n,e.name),s=Dt(e.updateTime),o=e.createTime?Dt(e.createTime):De.min(),a=new Zt({mapValue:{fields:e.fields}}),l=kt.newFoundDocument(i,s,o,a);return t&&l.setHasCommittedMutations(),t?l.setHasCommittedMutations():l}function Mj(n,e){return"found"in e?function(i,s){Pe(!!s.found,43571),s.found.name,s.found.updateTime;const o=Gn(i,s.found.name),a=Dt(s.found.updateTime),l=s.found.createTime?Dt(s.found.createTime):De.min(),c=new Zt({mapValue:{fields:s.found.fields}});return kt.newFoundDocument(o,a,l,c)}(n,e):"missing"in e?function(i,s){Pe(!!s.missing,3894),Pe(!!s.readTime,22933);const o=Gn(i,s.missing),a=Dt(s.readTime);return kt.newNoDocument(o,a)}(n,e):Ae(7234,{result:e})}function Wj(n,e){let t;if("targetChange"in e){e.targetChange;const i=function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:Ae(39313,{state:u})}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],o=function(u,h){return u.useProto3Json?(Pe(h===void 0||typeof h=="string",58123),At.fromBase64String(h||"")):(Pe(h===void 0||h instanceof Buffer||h instanceof Uint8Array,16193),At.fromUint8Array(h||new Uint8Array))}(n,e.targetChange.resumeToken),a=e.targetChange.cause,l=a&&function(u){const h=u.code===void 0?Z.UNKNOWN:Ab(u.code);return new de(h,u.message||"")}(a);t=new Bb(i,s,o,l||null)}else if("documentChange"in e){e.documentChange;const i=e.documentChange;i.document,i.document.name,i.document.updateTime;const s=Gn(n,i.document.name),o=Dt(i.document.updateTime),a=i.document.createTime?Dt(i.document.createTime):De.min(),l=new Zt({mapValue:{fields:i.document.fields}}),c=kt.newFoundDocument(s,o,a,l),u=i.targetIds||[],h=i.removedTargetIds||[];t=new Bl(u,h,c.key,c)}else if("documentDelete"in e){e.documentDelete;const i=e.documentDelete;i.document;const s=Gn(n,i.document),o=i.readTime?Dt(i.readTime):De.min(),a=kt.newNoDocument(s,o),l=i.removedTargetIds||[];t=new Bl([],l,a.key,a)}else if("documentRemove"in e){e.documentRemove;const i=e.documentRemove;i.document;const s=Gn(n,i.document),o=i.removedTargetIds||[];t=new Bl([],o,s,null)}else{if(!("filter"in e))return Ae(11601,{Vt:e});{e.filter;const i=e.filter;i.targetId;const{count:s=0,unchangedNames:o}=i,a=new Aj(s,o),l=i.targetId;t=new Eb(l,a)}}return t}function ma(n,e){let t;if(e instanceof to)t={update:xg(n,e.key,e.value)};else if(e instanceof no)t={delete:pa(n,e.key)};else if(e instanceof wi)t={update:xg(n,e.key,e.data),updateMask:Hj(e.fieldMask)};else{if(!(e instanceof vh))return Ae(16599,{ft:e.type});t={verify:pa(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(i=>function(o,a){const l=a.transform;if(l instanceof Ns)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof Nr)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof Mr)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof Ms)return{fieldPath:a.field.canonicalString(),increment:l.Re};throw Ae(20930,{transform:a.transform})}(0,i))),e.precondition.isNone||(t.currentDocument=function(s,o){return o.updateTime!==void 0?{updateTime:Nj(s,o.updateTime)}:o.exists!==void 0?{exists:o.exists}:Ae(27497)}(n,e.precondition)),t}function Ru(n,e){const t=e.currentDocument?function(o){return o.updateTime!==void 0?_t.updateTime(Dt(o.updateTime)):o.exists!==void 0?_t.exists(o.exists):_t.none()}(e.currentDocument):_t.none(),i=e.updateTransforms?e.updateTransforms.map(s=>function(a,l){let c=null;if("setToServerValue"in l)Pe(l.setToServerValue==="REQUEST_TIME",16630,{proto:l}),c=new Ns;else if("appendMissingElements"in l){const h=l.appendMissingElements.values||[];c=new Nr(h)}else if("removeAllFromArray"in l){const h=l.removeAllFromArray.values||[];c=new Mr(h)}else"increment"in l?c=new Ms(a,l.increment):Ae(16584,{proto:l});const u=St.fromServerFormat(l.fieldPath);return new _a(u,c)}(n,s)):[];if(e.update){e.update.name;const s=Gn(n,e.update.name),o=new Zt({mapValue:{fields:e.update.fields}});if(e.updateMask){const a=function(c){const u=c.fieldPaths||[];return new fn(u.map(h=>St.fromServerFormat(h)))}(e.updateMask);return new wi(s,o,a,t,i)}return new to(s,o,t,i)}if(e.delete){const s=Gn(n,e.delete);return new no(s,t)}if(e.verify){const s=Gn(n,e.verify);return new vh(s,t)}return Ae(1463,{proto:e})}function Lj(n,e){return n&&n.length>0?(Pe(e!==void 0,14353),n.map(t=>function(s,o){let a=s.updateTime?Dt(s.updateTime):Dt(o);return a.isEqual(De.min())&&(a=Dt(o)),new Ij(a,s.transformResults||[])}(t,e))):[]}function Wb(n,e){return{documents:[zb(n,e.path)]}}function Nc(n,e){const t={structuredQuery:{}},i=e.path;let s;e.collectionGroup!==null?(s=i,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=i.popLast(),t.structuredQuery.from=[{collectionId:i.lastSegment()}]),t.parent=zb(n,s);const o=function(u){if(u.length!==0)return qb(pt.create(u,"and"))}(e.filters);o&&(t.structuredQuery.where=o);const a=function(u){if(u.length!==0)return u.map(h=>function(f){return{field:zi(f.field),direction:Vj(f.dir)}}(h))}(e.orderBy);a&&(t.structuredQuery.orderBy=a);const l=_u(n,e.limit);return l!==null&&(t.structuredQuery.limit=l),e.startAt&&(t.structuredQuery.startAt=function(u){return{before:u.inclusive,values:u.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(u){return{before:!u.inclusive,values:u.position}}(e.endAt)),{gt:t,parent:s}}function Lb(n,e,t,i){const{gt:s,parent:o}=Nc(n,e),a={},l=[];let c=0;return t.forEach(u=>{const h=i?u.alias:"aggregate_"+c++;a[h]=u.alias,u.aggregateType==="count"?l.push({alias:h,count:{}}):u.aggregateType==="avg"?l.push({alias:h,avg:{field:zi(u.fieldPath)}}):u.aggregateType==="sum"&&l.push({alias:h,sum:{field:zi(u.fieldPath)}})}),{request:{structuredAggregationQuery:{aggregations:l,structuredQuery:s.structuredQuery},parent:s.parent},yt:a,parent:o}}function Ob(n){let e=Db(n.parent);const t=n.structuredQuery,i=t.from?t.from.length:0;let s=null;if(i>0){Pe(i===1,65062);const h=t.from[0];h.allDescendants?s=h.collectionId:e=e.child(h.collectionId)}let o=[];t.where&&(o=function(p){const f=Vb(p);return f instanceof pt&&fh(f)?f.getFilters():[f]}(t.where));let a=[];t.orderBy&&(a=function(p){return p.map(f=>function(x){return new ha(ys(x.field),function(w){switch(w){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(x.direction))}(f))}(t.orderBy));let l=null;t.limit&&(l=function(p){let f;return f=typeof p=="object"?p.value:p,wa(f)?null:f}(t.limit));let c=null;t.startAt&&(c=function(p){const f=!!p.before,b=p.values||[];return new Ji(b,f)}(t.startAt));let u=null;return t.endAt&&(u=function(p){const f=!p.before,b=p.values||[];return new Ji(b,f)}(t.endAt)),ub(e,s,a,o,l,"F",c,u)}function Oj(n,e){const t=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Ae(28987,{purpose:s})}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function Vb(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":const i=ys(t.unaryFilter.field);return it.create(i,"==",{doubleValue:NaN});case"IS_NULL":const s=ys(t.unaryFilter.field);return it.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const o=ys(t.unaryFilter.field);return it.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=ys(t.unaryFilter.field);return it.create(a,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Ae(61313);default:return Ae(60726)}}(n):n.fieldFilter!==void 0?function(t){return it.create(ys(t.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Ae(58110);default:return Ae(50506)}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return pt.create(t.compositeFilter.filters.map(i=>Vb(i)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return Ae(1026)}}(t.compositeFilter.op))}(n):Ae(30097,{filter:n})}function Vj(n){return Pj[n]}function qj(n){return Fj[n]}function Uj(n){return zj[n]}function zi(n){return{fieldPath:n.canonicalString()}}function ys(n){return St.fromServerFormat(n.fieldPath)}function qb(n){return n instanceof it?function(t){if(t.op==="=="){if(ng(t.value))return{unaryFilter:{field:zi(t.field),op:"IS_NAN"}};if(tg(t.value))return{unaryFilter:{field:zi(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(ng(t.value))return{unaryFilter:{field:zi(t.field),op:"IS_NOT_NAN"}};if(tg(t.value))return{unaryFilter:{field:zi(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:zi(t.field),op:qj(t.op),value:t.value}}}(n):n instanceof pt?function(t){const i=t.getFilters().map(s=>qb(s));return i.length===1?i[0]:{compositeFilter:{op:Uj(t.op),filters:i}}}(n):Ae(54877,{filter:n})}function Hj(n){const e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function Ub(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class li{constructor(e,t,i,s,o=De.min(),a=De.min(),l=At.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=t,this.purpose=i,this.sequenceNumber=s,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=l,this.expectedCount=c}withSequenceNumber(e){return new li(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new li(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new li(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new li(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hb{constructor(e){this.wt=e}}function $j(n,e){let t;if(e.document)t=Mb(n.wt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const i=Te.fromSegments(e.noDocument.path),s=Lr(e.noDocument.readTime);t=kt.newNoDocument(i,s),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return Ae(56709);{const i=Te.fromSegments(e.unknownDocument.path),s=Lr(e.unknownDocument.version);t=kt.newUnknownDocument(i,s)}}return e.readTime&&t.setReadTime(function(s){const o=new xt(s[0],s[1]);return De.fromTimestamp(o)}(e.readTime)),t}function bg(n,e){const t=e.key,i={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:Zl(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())i.document=function(o,a){return{name:pa(o,a.key),fields:a.data.value.mapValue.fields,updateTime:Ws(o,a.version.toTimestamp()),createTime:Ws(o,a.createTime.toTimestamp())}}(n.wt,e);else if(e.isNoDocument())i.noDocument={path:t.path.toArray(),readTime:Wr(e.version)};else{if(!e.isUnknownDocument())return Ae(57904,{document:e});i.unknownDocument={path:t.path.toArray(),version:Wr(e.version)}}return i}function Zl(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function Wr(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Lr(n){const e=new xt(n.seconds,n.nanoseconds);return De.fromTimestamp(e)}function wr(n,e){const t=(e.baseMutations||[]).map(o=>Ru(n.wt,o));for(let o=0;o<e.mutations.length-1;++o){const a=e.mutations[o];if(o+1<e.mutations.length&&e.mutations[o+1].transform!==void 0){const l=e.mutations[o+1];a.updateTransforms=l.transform.fieldTransforms,e.mutations.splice(o+1,1),++o}}const i=e.mutations.map(o=>Ru(n.wt,o)),s=xt.fromMillis(e.localWriteTimeMs);return new wh(e.batchId,s,t,i)}function Oo(n){const e=Lr(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?Lr(n.lastLimboFreeSnapshotVersion):De.min();let i;return i=function(o){return o.documents!==void 0}(n.query)?function(o){const a=o.documents.length;return Pe(a===1,1966,{count:a}),cn(eo(Db(o.documents[0])))}(n.query):function(o){return cn(Ob(o))}(n.query),new li(i,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,At.fromBase64String(n.resumeToken))}function $b(n,e){const t=Wr(e.snapshotVersion),i=Wr(e.lastLimboFreeSnapshotVersion);let s;s=Ql(e.target)?Wb(n.wt,e.target):Nc(n.wt,e.target).gt;const o=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Dr(e.target),readTime:t,resumeToken:o,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:i,query:s}}function _h(n){const e=Ob({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Xl(e,e.limit,"L"):e}function Bd(n,e){return new Sh(e.largestBatchId,Ru(n.wt,e.overlayMutation))}function vg(n,e){const t=e.path.lastSegment();return[n,ln(e.path.popLast()),t]}function wg(n,e,t,i){return{indexId:n,uid:e,sequenceNumber:t,readTime:Wr(i.readTime),documentKey:ln(i.documentKey.path),largestBatchId:i.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gj{getBundleMetadata(e,t){return kg(e).get(t).next(i=>{if(i)return function(o){return{id:o.bundleId,createTime:Lr(o.createTime),version:o.version}}(i)})}saveBundleMetadata(e,t){return kg(e).put(function(s){return{bundleId:s.id,createTime:Wr(Dt(s.createTime)),version:s.version}}(t))}getNamedQuery(e,t){return Sg(e).get(t).next(i=>{if(i)return function(o){return{name:o.name,query:_h(o.bundledQuery),readTime:Lr(o.readTime)}}(i)})}saveNamedQuery(e,t){return Sg(e).put(function(s){return{name:s.name,readTime:Wr(Dt(s.readTime)),bundledQuery:s.bundledQuery}}(t))}}function kg(n){return Ut(n,Rc)}function Sg(n){return Ut(n,Ac)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mc{constructor(e,t){this.serializer=e,this.userId=t}static bt(e,t){const i=t.uid||"";return new Mc(e,i)}getOverlay(e,t){return Io(e).get(vg(this.userId,t)).next(i=>i?Bd(this.serializer,i):null)}getOverlays(e,t){const i=qn();return K.forEach(t,s=>this.getOverlay(e,s).next(o=>{o!==null&&i.set(s,o)})).next(()=>i)}saveOverlays(e,t,i){const s=[];return i.forEach((o,a)=>{const l=new Sh(t,a);s.push(this.St(e,l))}),K.waitFor(s)}removeOverlaysForBatchId(e,t,i){const s=new Set;t.forEach(a=>s.add(ln(a.getCollectionPath())));const o=[];return s.forEach(a=>{const l=IDBKeyRange.bound([this.userId,a,i],[this.userId,a,i+1],!1,!0);o.push(Io(e).X(xu,l))}),K.waitFor(o)}getOverlaysForCollection(e,t,i){const s=qn(),o=ln(t),a=IDBKeyRange.bound([this.userId,o,i],[this.userId,o,Number.POSITIVE_INFINITY],!0);return Io(e).J(xu,a).next(l=>{for(const c of l){const u=Bd(this.serializer,c);s.set(u.getKey(),u)}return s})}getOverlaysForCollectionGroup(e,t,i,s){const o=qn();let a;const l=IDBKeyRange.bound([this.userId,t,i],[this.userId,t,Number.POSITIVE_INFINITY],!0);return Io(e).te({index:Vx,range:l},(c,u,h)=>{const p=Bd(this.serializer,u);o.size()<s||p.largestBatchId===a?(o.set(p.getKey(),p),a=p.largestBatchId):h.done()}).next(()=>o)}St(e,t){return Io(e).put(function(s,o,a){const[l,c,u]=vg(o,a.mutation.key);return{userId:o,collectionPath:c,documentId:u,collectionGroup:a.mutation.key.getCollectionGroup(),largestBatchId:a.largestBatchId,overlayMutation:ma(s.wt,a.mutation)}}(this.serializer,this.userId,t))}}function Io(n){return Ut(n,Ec)}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kj{Dt(e){return Ut(e,hh)}getSessionToken(e){return this.Dt(e).get("sessionToken").next(t=>{const i=t==null?void 0:t.value;return i?At.fromUint8Array(i):At.EMPTY_BYTE_STRING})}setSessionToken(e,t){return this.Dt(e).put({name:"sessionToken",value:t.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kr{constructor(){}vt(e,t){this.Ct(e,t),t.Ft()}Ct(e,t){if("nullValue"in e)this.Mt(t,5);else if("booleanValue"in e)this.Mt(t,10),t.xt(e.booleanValue?1:0);else if("integerValue"in e)this.Mt(t,15),t.xt(jt(e.integerValue));else if("doubleValue"in e){const i=jt(e.doubleValue);isNaN(i)?this.Mt(t,13):(this.Mt(t,15),ra(i)?t.xt(0):t.xt(i))}else if("timestampValue"in e){let i=e.timestampValue;this.Mt(t,20),typeof i=="string"&&(i=mi(i)),t.Ot(`${i.seconds||""}`),t.xt(i.nanos||0)}else if("stringValue"in e)this.Nt(e.stringValue,t),this.Bt(t);else if("bytesValue"in e)this.Mt(t,30),t.Lt(gi(e.bytesValue)),this.Bt(t);else if("referenceValue"in e)this.kt(e.referenceValue,t);else if("geoPointValue"in e){const i=e.geoPointValue;this.Mt(t,45),t.xt(i.latitude||0),t.xt(i.longitude||0)}else"mapValue"in e?tb(e)?this.Mt(t,Number.MAX_SAFE_INTEGER):Fc(e)?this.qt(e.mapValue,t):(this.Qt(e.mapValue,t),this.Bt(t)):"arrayValue"in e?(this.$t(e.arrayValue,t),this.Bt(t)):Ae(19022,{Ut:e})}Nt(e,t){this.Mt(t,25),this.Kt(e,t)}Kt(e,t){t.Ot(e)}Qt(e,t){const i=e.fields||{};this.Mt(t,55);for(const s of Object.keys(i))this.Nt(s,t),this.Ct(i[s],t)}qt(e,t){var i,s;const o=e.fields||{};this.Mt(t,53);const a=Fs,l=((s=(i=o[a].arrayValue)===null||i===void 0?void 0:i.values)===null||s===void 0?void 0:s.length)||0;this.Mt(t,15),t.xt(jt(l)),this.Nt(a,t),this.Ct(o[a],t)}$t(e,t){const i=e.values||[];this.Mt(t,50);for(const s of i)this.Ct(s,t)}kt(e,t){this.Mt(t,37),Te.fromName(e).path.forEach(i=>{this.Mt(t,60),this.Kt(i,t)})}Mt(e,t){e.xt(t)}Bt(e){e.xt(2)}}kr.Wt=new kr;/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law | agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES | CONDITIONS OF ANY KIND, either express | implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const os=255;function Qj(n){if(n===0)return 8;let e=0;return n>>4||(e+=4,n<<=4),n>>6||(e+=2,n<<=2),n>>7||(e+=1),e}function Tg(n){const e=64-function(i){let s=0;for(let o=0;o<8;++o){const a=Qj(255&i[o]);if(s+=a,a!==8)break}return s}(n);return Math.ceil(e/8)}class Yj{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Gt(e){const t=e[Symbol.iterator]();let i=t.next();for(;!i.done;)this.zt(i.value),i=t.next();this.jt()}Ht(e){const t=e[Symbol.iterator]();let i=t.next();for(;!i.done;)this.Jt(i.value),i=t.next();this.Yt()}Zt(e){for(const t of e){const i=t.charCodeAt(0);if(i<128)this.zt(i);else if(i<2048)this.zt(960|i>>>6),this.zt(128|63&i);else if(t<"\uD800"||"\uDBFF"<t)this.zt(480|i>>>12),this.zt(128|63&i>>>6),this.zt(128|63&i);else{const s=t.codePointAt(0);this.zt(240|s>>>18),this.zt(128|63&s>>>12),this.zt(128|63&s>>>6),this.zt(128|63&s)}}this.jt()}Xt(e){for(const t of e){const i=t.charCodeAt(0);if(i<128)this.Jt(i);else if(i<2048)this.Jt(960|i>>>6),this.Jt(128|63&i);else if(t<"\uD800"||"\uDBFF"<t)this.Jt(480|i>>>12),this.Jt(128|63&i>>>6),this.Jt(128|63&i);else{const s=t.codePointAt(0);this.Jt(240|s>>>18),this.Jt(128|63&s>>>12),this.Jt(128|63&s>>>6),this.Jt(128|63&s)}}this.Yt()}en(e){const t=this.tn(e),i=Tg(t);this.nn(1+i),this.buffer[this.position++]=255&i;for(let s=t.length-i;s<t.length;++s)this.buffer[this.position++]=255&t[s]}rn(e){const t=this.tn(e),i=Tg(t);this.nn(1+i),this.buffer[this.position++]=~(255&i);for(let s=t.length-i;s<t.length;++s)this.buffer[this.position++]=~(255&t[s])}sn(){this._n(os),this._n(255)}an(){this.un(os),this.un(255)}reset(){this.position=0}seed(e){this.nn(e.length),this.buffer.set(e,this.position),this.position+=e.length}cn(){return this.buffer.slice(0,this.position)}tn(e){const t=function(o){const a=new DataView(new ArrayBuffer(8));return a.setFloat64(0,o,!1),new Uint8Array(a.buffer)}(e),i=!!(128&t[0]);t[0]^=i?255:128;for(let s=1;s<t.length;++s)t[s]^=i?255:0;return t}zt(e){const t=255&e;t===0?(this._n(0),this._n(255)):t===os?(this._n(os),this._n(0)):this._n(t)}Jt(e){const t=255&e;t===0?(this.un(0),this.un(255)):t===os?(this.un(os),this.un(0)):this.un(e)}jt(){this._n(0),this._n(1)}Yt(){this.un(0),this.un(1)}_n(e){this.nn(1),this.buffer[this.position++]=e}un(e){this.nn(1),this.buffer[this.position++]=~e}nn(e){const t=e+this.position;if(t<=this.buffer.length)return;let i=2*this.buffer.length;i<t&&(i=t);const s=new Uint8Array(i);s.set(this.buffer),this.buffer=s}}class Xj{constructor(e){this.ln=e}Lt(e){this.ln.Gt(e)}Ot(e){this.ln.Zt(e)}xt(e){this.ln.en(e)}Ft(){this.ln.sn()}}class Jj{constructor(e){this.ln=e}Lt(e){this.ln.Ht(e)}Ot(e){this.ln.Xt(e)}xt(e){this.ln.rn(e)}Ft(){this.ln.an()}}class Co{constructor(){this.ln=new Yj,this.hn=new Xj(this.ln),this.Pn=new Jj(this.ln)}seed(e){this.ln.seed(e)}Tn(e){return e===0?this.hn:this.Pn}cn(){return this.ln.cn()}reset(){this.ln.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sr{constructor(e,t,i,s){this.In=e,this.En=t,this.dn=i,this.An=s}Rn(){const e=this.An.length,t=e===0||this.An[e-1]===255?e+1:e,i=new Uint8Array(t);return i.set(this.An,0),t!==e?i.set([0],this.An.length):++i[i.length-1],new Sr(this.In,this.En,this.dn,i)}Vn(e,t,i){return{indexId:this.In,uid:e,arrayValue:Pl(this.dn),directionalValue:Pl(this.An),orderedDocumentKey:Pl(t),documentKey:i.path.toArray()}}mn(e,t,i){const s=this.Vn(e,t,i);return[s.indexId,s.uid,s.arrayValue,s.directionalValue,s.orderedDocumentKey,s.documentKey]}}function Ei(n,e){let t=n.In-e.In;return t!==0?t:(t=jg(n.dn,e.dn),t!==0?t:(t=jg(n.An,e.An),t!==0?t:Te.comparator(n.En,e.En)))}function jg(n,e){for(let t=0;t<n.length&&t<e.length;++t){const i=n[t]-e[t];if(i!==0)return i}return n.length-e.length}function Pl(n){return mx()?function(t){let i="";for(let s=0;s<t.length;s++)i+=String.fromCharCode(t[s]);return i}(n):n}function _g(n){return typeof n!="string"?n:function(t){const i=new Uint8Array(t.length);for(let s=0;s<t.length;s++)i[s]=t.charCodeAt(s);return i}(n)}class Ig{constructor(e){this.fn=new mt((t,i)=>St.comparator(t.field,i.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.gn=e.orderBy,this.pn=[];for(const t of e.filters){const i=t;i.isInequality()?this.fn=this.fn.add(i):this.pn.push(i)}}get yn(){return this.fn.size>1}wn(e){if(Pe(e.collectionGroup===this.collectionId,49279),this.yn)return!1;const t=gu(e);if(t!==void 0&&!this.bn(t))return!1;const i=yr(e);let s=new Set,o=0,a=0;for(;o<i.length&&this.bn(i[o]);++o)s=s.add(i[o].fieldPath.canonicalString());if(o===i.length)return!0;if(this.fn.size>0){const l=this.fn.getIterator().getNext();if(!s.has(l.field.canonicalString())){const c=i[o];if(!this.Sn(l,c)||!this.Dn(this.gn[a++],c))return!1}++o}for(;o<i.length;++o){const l=i[o];if(a>=this.gn.length||!this.Dn(this.gn[a++],l))return!1}return!0}vn(){if(this.yn)return null;let e=new mt(St.comparator);const t=[];for(const i of this.pn)if(!i.field.isKeyField())if(i.op==="array-contains"||i.op==="array-contains-any")t.push(new Rr(i.field,2));else{if(e.has(i.field))continue;e=e.add(i.field),t.push(new Rr(i.field,0))}for(const i of this.gn)i.field.isKeyField()||e.has(i.field)||(e=e.add(i.field),t.push(new Rr(i.field,i.dir==="asc"?0:1)));return new Cs(Cs.UNKNOWN_ID,this.collectionId,t,Rs.empty())}bn(e){for(const t of this.pn)if(this.Sn(t,e))return!0;return!1}Sn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const i=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===i}Dn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gb(n){var e,t;if(Pe(n instanceof it||n instanceof pt,20012),n instanceof it){if(n instanceof db){const s=((t=(e=n.value.arrayValue)===null||e===void 0?void 0:e.values)===null||t===void 0?void 0:t.map(o=>it.create(n.field,"==",o)))||[];return pt.create(s,"or")}return n}const i=n.filters.map(s=>Gb(s));return pt.create(i,n.op)}function Zj(n){if(n.getFilters().length===0)return[];const e=Bu(Gb(n));return Pe(Kb(e),7391),Au(e)||Eu(e)?[e]:e.getFilters()}function Au(n){return n instanceof it}function Eu(n){return n instanceof pt&&fh(n)}function Kb(n){return Au(n)||Eu(n)||function(t){if(t instanceof pt&&ku(t)){for(const i of t.getFilters())if(!Au(i)&&!Eu(i))return!1;return!0}return!1}(n)}function Bu(n){if(Pe(n instanceof it||n instanceof pt,34018),n instanceof it)return n;if(n.filters.length===1)return Bu(n.filters[0]);const e=n.filters.map(i=>Bu(i));let t=pt.create(e,n.op);return t=ec(t),Kb(t)?t:(Pe(t instanceof pt,64498),Pe(Ds(t),40251),Pe(t.filters.length>1,57927),t.filters.reduce((i,s)=>Ih(i,s)))}function Ih(n,e){let t;return Pe(n instanceof it||n instanceof pt,38388),Pe(e instanceof it||e instanceof pt,25473),t=n instanceof it?e instanceof it?function(s,o){return pt.create([s,o],"and")}(n,e):Cg(n,e):e instanceof it?Cg(e,n):function(s,o){if(Pe(s.filters.length>0&&o.filters.length>0,48005),Ds(s)&&Ds(o))return ab(s,o.getFilters());const a=ku(s)?s:o,l=ku(s)?o:s,c=a.filters.map(u=>Ih(u,l));return pt.create(c,"or")}(n,e),ec(t)}function Cg(n,e){if(Ds(e))return ab(e,n.getFilters());{const t=e.filters.map(i=>Ih(n,i));return pt.create(t,"or")}}function ec(n){if(Pe(n instanceof it||n instanceof pt,11850),n instanceof it)return n;const e=n.getFilters();if(e.length===1)return ec(e[0]);if(sb(n))return n;const t=e.map(s=>ec(s)),i=[];return t.forEach(s=>{s instanceof it?i.push(s):s instanceof pt&&(s.op===n.op?i.push(...s.filters):i.push(s))}),i.length===1?i[0]:pt.create(i,n.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e_{constructor(){this.Cn=new Ch}addToCollectionParentIndex(e,t){return this.Cn.add(t),K.resolve()}getCollectionParents(e,t){return K.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return K.resolve()}deleteFieldIndex(e,t){return K.resolve()}deleteAllFieldIndexes(e){return K.resolve()}createTargetIndexes(e,t){return K.resolve()}getDocumentsMatchingTarget(e,t){return K.resolve(null)}getIndexType(e,t){return K.resolve(0)}getFieldIndexes(e,t){return K.resolve([])}getNextCollectionGroupToUpdate(e){return K.resolve(null)}getMinOffset(e,t){return K.resolve(jn.min())}getMinOffsetFromCollectionGroup(e,t){return K.resolve(jn.min())}updateCollectionGroup(e,t,i){return K.resolve()}updateIndexEntries(e,t){return K.resolve()}}class Ch{constructor(){this.index={}}add(e){const t=e.lastSegment(),i=e.popLast(),s=this.index[t]||new mt(nt.comparator),o=!s.has(i);return this.index[t]=s.add(i),o}has(e){const t=e.lastSegment(),i=e.popLast(),s=this.index[t];return s&&s.has(i)}getEntries(e){return(this.index[e]||new mt(nt.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rg="IndexedDbIndexManager",ml=new Uint8Array(0);class t_{constructor(e,t){this.databaseId=t,this.Fn=new Ch,this.Mn=new vi(i=>Dr(i),(i,s)=>Sa(i,s)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.Fn.has(t)){const i=t.lastSegment(),s=t.popLast();e.addOnCommittedListener(()=>{this.Fn.add(t)});const o={collectionId:i,parent:ln(s)};return Ag(e).put(o)}return K.resolve()}getCollectionParents(e,t){const i=[],s=IDBKeyRange.bound([t,""],[Ax(t),""],!1,!0);return Ag(e).J(s).next(o=>{for(const a of o){if(a.collectionId!==t)break;i.push(Vn(a.parent))}return i})}addFieldIndex(e,t){const i=Ro(e),s=function(l){return{indexId:l.indexId,collectionGroup:l.collectionGroup,fields:l.fields.map(c=>[c.fieldPath.canonicalString(),c.kind])}}(t);delete s.indexId;const o=i.add(s);if(t.indexState){const a=ls(e);return o.next(l=>{a.put(wg(l,this.uid,t.indexState.sequenceNumber,t.indexState.offset))})}return o.next()}deleteFieldIndex(e,t){const i=Ro(e),s=ls(e),o=as(e);return i.delete(t.indexId).next(()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>o.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const t=Ro(e),i=as(e),s=ls(e);return t.X().next(()=>i.X()).next(()=>s.X())}createTargetIndexes(e,t){return K.forEach(this.xn(t),i=>this.getIndexType(e,i).next(s=>{if(s===0||s===1){const o=new Ig(i).vn();if(o!=null)return this.addFieldIndex(e,o)}}))}getDocumentsMatchingTarget(e,t){const i=as(e);let s=!0;const o=new Map;return K.forEach(this.xn(t),a=>this.On(e,a).next(l=>{s&&(s=!!l),o.set(a,l)})).next(()=>{if(s){let a=Ke();const l=[];return K.forEach(o,(c,u)=>{ue(Rg,`Using index ${function(A){return`id=${A.indexId}|cg=${A.collectionGroup}|f=${A.fields.map(D=>`${D.fieldPath}:${D.kind}`).join(",")}`}(c)} to execute ${Dr(t)}`);const h=function(A,D){const O=gu(D);if(O===void 0)return null;for(const P of Yl(A,O.fieldPath))switch(P.op){case"array-contains-any":return P.value.arrayValue.values||[];case"array-contains":return[P.value]}return null}(u,c),p=function(A,D){const O=new Map;for(const P of yr(D))for(const B of Yl(A,P.fieldPath))switch(B.op){case"==":case"in":O.set(P.fieldPath.canonicalString(),B.value);break;case"not-in":case"!=":return O.set(P.fieldPath.canonicalString(),B.value),Array.from(O.values())}return null}(u,c),f=function(A,D){const O=[];let P=!0;for(const B of yr(D)){const k=B.kind===0?ag(A,B.fieldPath,A.startAt):lg(A,B.fieldPath,A.startAt);O.push(k.value),P&&(P=k.inclusive)}return new Ji(O,P)}(u,c),b=function(A,D){const O=[];let P=!0;for(const B of yr(D)){const k=B.kind===0?lg(A,B.fieldPath,A.endAt):ag(A,B.fieldPath,A.endAt);O.push(k.value),P&&(P=k.inclusive)}return new Ji(O,P)}(u,c),x=this.Nn(c,u,f),S=this.Nn(c,u,b),w=this.Bn(c,u,p),I=this.Ln(c.indexId,h,x,f.inclusive,S,b.inclusive,w);return K.forEach(I,j=>i.Z(j,t.limit).next(A=>{A.forEach(D=>{const O=Te.fromSegments(D.documentKey);a.has(O)||(a=a.add(O),l.push(O))})}))}).next(()=>l)}return K.resolve(null)})}xn(e){let t=this.Mn.get(e);return t||(e.filters.length===0?t=[e]:t=Zj(pt.create(e.filters,"and")).map(i=>Tu(e.path,e.collectionGroup,e.orderBy,i.getFilters(),e.limit,e.startAt,e.endAt)),this.Mn.set(e,t),t)}Ln(e,t,i,s,o,a,l){const c=(t!=null?t.length:1)*Math.max(i.length,o.length),u=c/(t!=null?t.length:1),h=[];for(let p=0;p<c;++p){const f=t?this.kn(t[p/u]):ml,b=this.qn(e,f,i[p%u],s),x=this.Qn(e,f,o[p%u],a),S=l.map(w=>this.qn(e,f,w,!0));h.push(...this.createRange(b,x,S))}return h}qn(e,t,i,s){const o=new Sr(e,Te.empty(),t,i);return s?o:o.Rn()}Qn(e,t,i,s){const o=new Sr(e,Te.empty(),t,i);return s?o.Rn():o}On(e,t){const i=new Ig(t),s=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,s).next(o=>{let a=null;for(const l of o)i.wn(l)&&(!a||l.fields.length>a.fields.length)&&(a=l);return a})}getIndexType(e,t){let i=2;const s=this.xn(t);return K.forEach(s,o=>this.On(e,o).next(a=>{a?i!==0&&a.fields.length<function(c){let u=new mt(St.comparator),h=!1;for(const p of c.filters)for(const f of p.getFlattenedFilters())f.field.isKeyField()||(f.op==="array-contains"||f.op==="array-contains-any"?h=!0:u=u.add(f.field));for(const p of c.orderBy)p.field.isKeyField()||(u=u.add(p.field));return u.size+(h?1:0)}(o)&&(i=1):i=0})).next(()=>function(a){return a.limit!==null}(t)&&s.length>1&&i===2?1:i)}$n(e,t){const i=new Co;for(const s of yr(e)){const o=t.data.field(s.fieldPath);if(o==null)return null;const a=i.Tn(s.kind);kr.Wt.vt(o,a)}return i.cn()}kn(e){const t=new Co;return kr.Wt.vt(e,t.Tn(0)),t.cn()}Un(e,t){const i=new Co;return kr.Wt.vt(zr(this.databaseId,t),i.Tn(function(o){const a=yr(o);return a.length===0?0:a[a.length-1].kind}(e))),i.cn()}Bn(e,t,i){if(i===null)return[];let s=[];s.push(new Co);let o=0;for(const a of yr(e)){const l=i[o++];for(const c of s)if(this.Kn(t,a.fieldPath)&&ua(l))s=this.Wn(s,a,l);else{const u=c.Tn(a.kind);kr.Wt.vt(l,u)}}return this.Gn(s)}Nn(e,t,i){return this.Bn(e,t,i.position)}Gn(e){const t=[];for(let i=0;i<e.length;++i)t[i]=e[i].cn();return t}Wn(e,t,i){const s=[...e],o=[];for(const a of i.arrayValue.values||[])for(const l of s){const c=new Co;c.seed(l.cn()),kr.Wt.vt(a,c.Tn(t.kind)),o.push(c)}return o}Kn(e,t){return!!e.filters.find(i=>i instanceof it&&i.field.isEqual(t)&&(i.op==="in"||i.op==="not-in"))}getFieldIndexes(e,t){const i=Ro(e),s=ls(e);return(t?i.J(yu,IDBKeyRange.bound(t,t)):i.J()).next(o=>{const a=[];return K.forEach(o,l=>s.get([l.indexId,this.uid]).next(c=>{a.push(function(h,p){const f=p?new Rs(p.sequenceNumber,new jn(Lr(p.readTime),new Te(Vn(p.documentKey)),p.largestBatchId)):Rs.empty(),b=h.fields.map(([x,S])=>new Rr(St.fromServerFormat(x),S));return new Cs(h.indexId,h.collectionGroup,b,f)}(l,c))})).next(()=>a)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(t=>t.length===0?null:(t.sort((i,s)=>{const o=i.indexState.sequenceNumber-s.indexState.sequenceNumber;return o!==0?o:Le(i.collectionGroup,s.collectionGroup)}),t[0].collectionGroup))}updateCollectionGroup(e,t,i){const s=Ro(e),o=ls(e);return this.zn(e).next(a=>s.J(yu,IDBKeyRange.bound(t,t)).next(l=>K.forEach(l,c=>o.put(wg(c.indexId,this.uid,a,i)))))}updateIndexEntries(e,t){const i=new Map;return K.forEach(t,(s,o)=>{const a=i.get(s.collectionGroup);return(a?K.resolve(a):this.getFieldIndexes(e,s.collectionGroup)).next(l=>(i.set(s.collectionGroup,l),K.forEach(l,c=>this.jn(e,s,c).next(u=>{const h=this.Hn(o,c);return u.isEqual(h)?K.resolve():this.Jn(e,o,c,u,h)}))))})}Yn(e,t,i,s){return as(e).put(s.Vn(this.uid,this.Un(i,t.key),t.key))}Zn(e,t,i,s){return as(e).delete(s.mn(this.uid,this.Un(i,t.key),t.key))}jn(e,t,i){const s=as(e);let o=new mt(Ei);return s.te({index:Ox,range:IDBKeyRange.only([i.indexId,this.uid,Pl(this.Un(i,t))])},(a,l)=>{o=o.add(new Sr(i.indexId,t,_g(l.arrayValue),_g(l.directionalValue)))}).next(()=>o)}Hn(e,t){let i=new mt(Ei);const s=this.$n(t,e);if(s==null)return i;const o=gu(t);if(o!=null){const a=e.data.field(o.fieldPath);if(ua(a))for(const l of a.arrayValue.values||[])i=i.add(new Sr(t.indexId,e.key,this.kn(l),s))}else i=i.add(new Sr(t.indexId,e.key,ml,s));return i}Jn(e,t,i,s,o){ue(Rg,"Updating index entries for document '%s'",t.key);const a=[];return function(c,u,h,p,f){const b=c.getIterator(),x=u.getIterator();let S=ss(b),w=ss(x);for(;S||w;){let I=!1,j=!1;if(S&&w){const A=h(S,w);A<0?j=!0:A>0&&(I=!0)}else S!=null?j=!0:I=!0;I?(p(w),w=ss(x)):j?(f(S),S=ss(b)):(S=ss(b),w=ss(x))}}(s,o,Ei,l=>{a.push(this.Yn(e,t,i,l))},l=>{a.push(this.Zn(e,t,i,l))}),K.waitFor(a)}zn(e){let t=1;return ls(e).te({index:Lx,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(i,s,o)=>{o.done(),t=s.sequenceNumber+1}).next(()=>t)}createRange(e,t,i){i=i.sort((a,l)=>Ei(a,l)).filter((a,l,c)=>!l||Ei(a,c[l-1])!==0);const s=[];s.push(e);for(const a of i){const l=Ei(a,e),c=Ei(a,t);if(l===0)s[0]=e.Rn();else if(l>0&&c<0)s.push(a),s.push(a.Rn());else if(c>0)break}s.push(t);const o=[];for(let a=0;a<s.length;a+=2){if(this.Xn(s[a],s[a+1]))return[];const l=s[a].mn(this.uid,ml,Te.empty()),c=s[a+1].mn(this.uid,ml,Te.empty());o.push(IDBKeyRange.bound(l,c))}return o}Xn(e,t){return Ei(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(Eg)}getMinOffset(e,t){return K.mapArray(this.xn(t),i=>this.On(e,i).next(s=>s||Ae(44426))).next(Eg)}}function Ag(n){return Ut(n,aa)}function as(n){return Ut(n,$o)}function Ro(n){return Ut(n,uh)}function ls(n){return Ut(n,Ho)}function Eg(n){Pe(n.length!==0,28825);let e=n[0].indexState.offset,t=e.largestBatchId;for(let i=1;i<n.length;i++){const s=n[i].indexState.offset;lh(s,e)<0&&(e=s),t<s.largestBatchId&&(t=s.largestBatchId)}return new jn(e.readTime,e.documentKey,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bg={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Qb=41943040;class on{static withCacheSize(e){return new on(e,on.DEFAULT_COLLECTION_PERCENTILE,on.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yb(n,e,t){const i=n.store(Rn),s=n.store(As),o=[],a=IDBKeyRange.only(t.batchId);let l=0;const c=i.te({range:a},(h,p,f)=>(l++,f.delete()));o.push(c.next(()=>{Pe(l===1,47070,{batchId:t.batchId})}));const u=[];for(const h of t.mutations){const p=Nx(e,h.key.path,t.batchId);o.push(s.delete(p)),u.push(h.key)}return K.waitFor(o).next(()=>u)}function tc(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw Ae(14731);e=n.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */on.DEFAULT_COLLECTION_PERCENTILE=10,on.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,on.DEFAULT=new on(Qb,on.DEFAULT_COLLECTION_PERCENTILE,on.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),on.DISABLED=new on(-1,0,0);class Wc{constructor(e,t,i,s){this.userId=e,this.serializer=t,this.indexManager=i,this.referenceDelegate=s,this.er={}}static bt(e,t,i,s){Pe(e.uid!=="",64387);const o=e.isAuthenticated()?e.uid:"";return new Wc(o,t,i,s)}checkEmpty(e){let t=!0;const i=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Bi(e).te({index:Tr,range:i},(s,o,a)=>{t=!1,a.done()}).next(()=>t)}addMutationBatch(e,t,i,s){const o=xs(e),a=Bi(e);return a.add({}).next(l=>{Pe(typeof l=="number",49019);const c=new wh(l,t,i,s),u=function(b,x,S){const w=S.baseMutations.map(j=>ma(b.wt,j)),I=S.mutations.map(j=>ma(b.wt,j));return{userId:x,batchId:S.batchId,localWriteTimeMs:S.localWriteTime.toMillis(),baseMutations:w,mutations:I}}(this.serializer,this.userId,c),h=[];let p=new mt((f,b)=>Le(f.canonicalString(),b.canonicalString()));for(const f of s){const b=Nx(this.userId,f.key.path,l);p=p.add(f.key.path.popLast()),h.push(a.put(u)),h.push(o.put(b,DT))}return p.forEach(f=>{h.push(this.indexManager.addToCollectionParentIndex(e,f))}),e.addOnCommittedListener(()=>{this.er[l]=c.keys()}),K.waitFor(h).next(()=>c)})}lookupMutationBatch(e,t){return Bi(e).get(t).next(i=>i?(Pe(i.userId===this.userId,48,"Unexpected user for mutation batch",{userId:i.userId,batchId:t}),wr(this.serializer,i)):null)}tr(e,t){return this.er[t]?K.resolve(this.er[t]):this.lookupMutationBatch(e,t).next(i=>{if(i){const s=i.keys();return this.er[t]=s,s}return null})}getNextMutationBatchAfterBatchId(e,t){const i=t+1,s=IDBKeyRange.lowerBound([this.userId,i]);let o=null;return Bi(e).te({index:Tr,range:s},(a,l,c)=>{l.userId===this.userId&&(Pe(l.batchId>=i,47524,{nr:i}),o=wr(this.serializer,l)),c.done()}).next(()=>o)}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let i=Hi;return Bi(e).te({index:Tr,range:t,reverse:!0},(s,o,a)=>{i=o.batchId,a.done()}).next(()=>i)}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,Hi],[this.userId,Number.POSITIVE_INFINITY]);return Bi(e).J(Tr,t).next(i=>i.map(s=>wr(this.serializer,s)))}getAllMutationBatchesAffectingDocumentKey(e,t){const i=_l(this.userId,t.path),s=IDBKeyRange.lowerBound(i),o=[];return xs(e).te({range:s},(a,l,c)=>{const[u,h,p]=a,f=Vn(h);if(u===this.userId&&t.path.isEqual(f))return Bi(e).get(p).next(b=>{if(!b)throw Ae(61480,{rr:a,batchId:p});Pe(b.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:b.userId,batchId:p}),o.push(wr(this.serializer,b))});c.done()}).next(()=>o)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new mt(Le);const s=[];return t.forEach(o=>{const a=_l(this.userId,o.path),l=IDBKeyRange.lowerBound(a),c=xs(e).te({range:l},(u,h,p)=>{const[f,b,x]=u,S=Vn(b);f===this.userId&&o.path.isEqual(S)?i=i.add(x):p.done()});s.push(c)}),K.waitFor(s).next(()=>this.ir(e,i))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,s=i.length+1,o=_l(this.userId,i),a=IDBKeyRange.lowerBound(o);let l=new mt(Le);return xs(e).te({range:a},(c,u,h)=>{const[p,f,b]=c,x=Vn(f);p===this.userId&&i.isPrefixOf(x)?x.length===s&&(l=l.add(b)):h.done()}).next(()=>this.ir(e,l))}ir(e,t){const i=[],s=[];return t.forEach(o=>{s.push(Bi(e).get(o).next(a=>{if(a===null)throw Ae(35274,{batchId:o});Pe(a.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:a.userId,batchId:o}),i.push(wr(this.serializer,a))}))}),K.waitFor(s).next(()=>i)}removeMutationBatch(e,t){return Yb(e.he,this.userId,t).next(i=>(e.addOnCommittedListener(()=>{this.sr(t.batchId)}),K.forEach(i,s=>this.referenceDelegate.markPotentiallyOrphaned(e,s))))}sr(e){delete this.er[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return K.resolve();const i=IDBKeyRange.lowerBound(function(a){return[a]}(this.userId)),s=[];return xs(e).te({range:i},(o,a,l)=>{if(o[0]===this.userId){const c=Vn(o[1]);s.push(c)}else l.done()}).next(()=>{Pe(s.length===0,56720,{_r:s.map(o=>o.canonicalString())})})})}containsKey(e,t){return Xb(e,this.userId,t)}ar(e){return Jb(e).get(this.userId).next(t=>t||{userId:this.userId,lastAcknowledgedBatchId:Hi,lastStreamToken:""})}}function Xb(n,e,t){const i=_l(e,t.path),s=i[1],o=IDBKeyRange.lowerBound(i);let a=!1;return xs(n).te({range:o,ee:!0},(l,c,u)=>{const[h,p,f]=l;h===e&&p===s&&(a=!0),u.done()}).next(()=>a)}function Bi(n){return Ut(n,Rn)}function xs(n){return Ut(n,As)}function Jb(n){return Ut(n,sa)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Or{constructor(e){this.ur=e}next(){return this.ur+=2,this.ur}static cr(){return new Or(0)}static lr(){return new Or(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n_{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.hr(e).next(t=>{const i=new Or(t.highestTargetId);return t.highestTargetId=i.next(),this.Pr(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.hr(e).next(t=>De.fromTimestamp(new xt(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.hr(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,i){return this.hr(e).next(s=>(s.highestListenSequenceNumber=t,i&&(s.lastRemoteSnapshotVersion=i.toTimestamp()),t>s.highestListenSequenceNumber&&(s.highestListenSequenceNumber=t),this.Pr(e,s)))}addTargetData(e,t){return this.Tr(e,t).next(()=>this.hr(e).next(i=>(i.targetCount+=1,this.Ir(t,i),this.Pr(e,i))))}updateTargetData(e,t){return this.Tr(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>cs(e).delete(t.targetId)).next(()=>this.hr(e)).next(i=>(Pe(i.targetCount>0,8065),i.targetCount-=1,this.Pr(e,i)))}removeTargets(e,t,i){let s=0;const o=[];return cs(e).te((a,l)=>{const c=Oo(l);c.sequenceNumber<=t&&i.get(c.targetId)===null&&(s++,o.push(this.removeTargetData(e,c)))}).next(()=>K.waitFor(o)).next(()=>s)}forEachTarget(e,t){return cs(e).te((i,s)=>{const o=Oo(s);t(o)})}hr(e){return Pg(e).get(Kl).next(t=>(Pe(t!==null,2888),t))}Pr(e,t){return Pg(e).put(Kl,t)}Tr(e,t){return cs(e).put($b(this.serializer,t))}Ir(e,t){let i=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,i=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,i=!0),i}getTargetCount(e){return this.hr(e).next(t=>t.targetCount)}getTargetData(e,t){const i=Dr(t),s=IDBKeyRange.bound([i,Number.NEGATIVE_INFINITY],[i,Number.POSITIVE_INFINITY]);let o=null;return cs(e).te({range:s,index:Wx},(a,l,c)=>{const u=Oo(l);Sa(t,u.target)&&(o=u,c.done())}).next(()=>o)}addMatchingKeys(e,t,i){const s=[],o=Di(e);return t.forEach(a=>{const l=ln(a.path);s.push(o.put({targetId:i,path:l})),s.push(this.referenceDelegate.addReference(e,i,a))}),K.waitFor(s)}removeMatchingKeys(e,t,i){const s=Di(e);return K.forEach(t,o=>{const a=ln(o.path);return K.waitFor([s.delete([i,a]),this.referenceDelegate.removeReference(e,i,o)])})}removeMatchingKeysForTargetId(e,t){const i=Di(e),s=IDBKeyRange.bound([t],[t+1],!1,!0);return i.delete(s)}getMatchingKeysForTargetId(e,t){const i=IDBKeyRange.bound([t],[t+1],!1,!0),s=Di(e);let o=Ke();return s.te({range:i,ee:!0},(a,l,c)=>{const u=Vn(a[1]),h=new Te(u);o=o.add(h)}).next(()=>o)}containsKey(e,t){const i=ln(t.path),s=IDBKeyRange.bound([i],[Ax(i)],!1,!0);let o=0;return Di(e).te({index:dh,ee:!0,range:s},([a,l],c,u)=>{a!==0&&(o++,u.done())}).next(()=>o>0)}Rt(e,t){return cs(e).get(t).next(i=>i?Oo(i):null)}}function cs(n){return Ut(n,Es)}function Pg(n){return Ut(n,Ar)}function Di(n){return Ut(n,Bs)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fg="LruGarbageCollector",Zb=1048576;function zg([n,e],[t,i]){const s=Le(n,t);return s===0?Le(e,i):s}class i_{constructor(e){this.Er=e,this.buffer=new mt(zg),this.dr=0}Ar(){return++this.dr}Rr(e){const t=[e,this.Ar()];if(this.buffer.size<this.Er)this.buffer=this.buffer.add(t);else{const i=this.buffer.last();zg(t,i)<0&&(this.buffer=this.buffer.delete(i).add(t))}}get maxValue(){return this.buffer.last()[0]}}class e0{constructor(e,t,i){this.garbageCollector=e,this.asyncQueue=t,this.localStore=i,this.Vr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.mr(6e4)}stop(){this.Vr&&(this.Vr.cancel(),this.Vr=null)}get started(){return this.Vr!==null}mr(e){ue(Fg,`Garbage collection scheduled in ${e}ms`),this.Vr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Vr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){rr(t)?ue(Fg,"Ignoring IndexedDB error during garbage collection: ",t):await ir(t)}await this.mr(3e5)})}}class r_{constructor(e,t){this.gr=e,this.params=t}calculateTargetCount(e,t){return this.gr.pr(e).next(i=>Math.floor(t/100*i))}nthSequenceNumber(e,t){if(t===0)return K.resolve(gn.le);const i=new i_(t);return this.gr.forEachTarget(e,s=>i.Rr(s.sequenceNumber)).next(()=>this.gr.yr(e,s=>i.Rr(s))).next(()=>i.maxValue)}removeTargets(e,t,i){return this.gr.removeTargets(e,t,i)}removeOrphanedDocuments(e,t){return this.gr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(ue("LruGarbageCollector","Garbage collection skipped; disabled"),K.resolve(Bg)):this.getCacheSize(e).next(i=>i<this.params.cacheSizeCollectionThreshold?(ue("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Bg):this.wr(e,t))}getCacheSize(e){return this.gr.getCacheSize(e)}wr(e,t){let i,s,o,a,l,c,u;const h=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(p=>(p>this.params.maximumSequenceNumbersToCollect?(ue("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${p}`),s=this.params.maximumSequenceNumbersToCollect):s=p,a=Date.now(),this.nthSequenceNumber(e,s))).next(p=>(i=p,l=Date.now(),this.removeTargets(e,i,t))).next(p=>(o=p,c=Date.now(),this.removeOrphanedDocuments(e,i))).next(p=>(u=Date.now(),gs()<=tt.DEBUG&&ue("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${a-h}ms
	Determined least recently used ${s} in `+(l-a)+`ms
	Removed ${o} targets in `+(c-l)+`ms
	Removed ${p} documents in `+(u-c)+`ms
Total Duration: ${u-h}ms`),K.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:o,documentsRemoved:p})))}}function t0(n,e){return new r_(n,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s_{constructor(e,t){this.db=e,this.garbageCollector=t0(this,t)}pr(e){const t=this.br(e);return this.db.getTargetCache().getTargetCount(e).next(i=>t.next(s=>i+s))}br(e){let t=0;return this.yr(e,i=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}yr(e,t){return this.Sr(e,(i,s)=>t(s))}addReference(e,t,i){return gl(e,i)}removeReference(e,t,i){return gl(e,i)}removeTargets(e,t,i){return this.db.getTargetCache().removeTargets(e,t,i)}markPotentiallyOrphaned(e,t){return gl(e,t)}Dr(e,t){return function(s,o){let a=!1;return Jb(s).ne(l=>Xb(s,l,o).next(c=>(c&&(a=!0),K.resolve(!c)))).next(()=>a)}(e,t)}removeOrphanedDocuments(e,t){const i=this.db.getRemoteDocumentCache().newChangeBuffer(),s=[];let o=0;return this.Sr(e,(a,l)=>{if(l<=t){const c=this.Dr(e,a).next(u=>{if(!u)return o++,i.getEntry(e,a).next(()=>(i.removeEntry(a,De.min()),Di(e).delete(function(p){return[0,ln(p.path)]}(a))))});s.push(c)}}).next(()=>K.waitFor(s)).next(()=>i.apply(e)).next(()=>o)}removeTarget(e,t){const i=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,i)}updateLimboDocument(e,t){return gl(e,t)}Sr(e,t){const i=Di(e);let s,o=gn.le;return i.te({index:dh},([a,l],{path:c,sequenceNumber:u})=>{a===0?(o!==gn.le&&t(new Te(Vn(s)),o),o=u,s=c):o=gn.le}).next(()=>{o!==gn.le&&t(new Te(Vn(s)),o)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function gl(n,e){return Di(n).put(function(i,s){return{targetId:0,path:ln(i.path),sequenceNumber:s}}(e,n.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n0{constructor(){this.changes=new vi(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,kt.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const i=this.changes.get(t);return i!==void 0?K.resolve(i):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o_{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,i){return gr(e).put(i)}removeEntry(e,t,i){return gr(e).delete(function(o,a){const l=o.path.toArray();return[l.slice(0,l.length-2),l[l.length-2],Zl(a),l[l.length-1]]}(t,i))}updateMetadata(e,t){return this.getMetadata(e).next(i=>(i.byteSize+=t,this.vr(e,i)))}getEntry(e,t){let i=kt.newInvalidDocument(t);return gr(e).te({index:Il,range:IDBKeyRange.only(Ao(t))},(s,o)=>{i=this.Cr(t,o)}).next(()=>i)}Fr(e,t){let i={size:0,document:kt.newInvalidDocument(t)};return gr(e).te({index:Il,range:IDBKeyRange.only(Ao(t))},(s,o)=>{i={document:this.Cr(t,o),size:tc(o)}}).next(()=>i)}getEntries(e,t){let i=yn();return this.Mr(e,t,(s,o)=>{const a=this.Cr(s,o);i=i.insert(s,a)}).next(()=>i)}Or(e,t){let i=yn(),s=new vt(Te.comparator);return this.Mr(e,t,(o,a)=>{const l=this.Cr(o,a);i=i.insert(o,l),s=s.insert(o,tc(a))}).next(()=>({documents:i,Nr:s}))}Mr(e,t,i){if(t.isEmpty())return K.resolve();let s=new mt(Mg);t.forEach(c=>s=s.add(c));const o=IDBKeyRange.bound(Ao(s.first()),Ao(s.last())),a=s.getIterator();let l=a.getNext();return gr(e).te({index:Il,range:o},(c,u,h)=>{const p=Te.fromSegments([...u.prefixPath,u.collectionGroup,u.documentId]);for(;l&&Mg(l,p)<0;)i(l,null),l=a.getNext();l&&l.isEqual(p)&&(i(l,u),l=a.hasNext()?a.getNext():null),l?h.H(Ao(l)):h.done()}).next(()=>{for(;l;)i(l,null),l=a.hasNext()?a.getNext():null})}getDocumentsMatchingQuery(e,t,i,s,o){const a=t.path,l=[a.popLast().toArray(),a.lastSegment(),Zl(i.readTime),i.documentKey.path.isEmpty()?"":i.documentKey.path.lastSegment()],c=[a.popLast().toArray(),a.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return gr(e).J(IDBKeyRange.bound(l,c,!0)).next(u=>{o==null||o.incrementDocumentReadCount(u.length);let h=yn();for(const p of u){const f=this.Cr(Te.fromSegments(p.prefixPath.concat(p.collectionGroup,p.documentId)),p);f.isFoundDocument()&&(ja(t,f)||s.has(f.key))&&(h=h.insert(f.key,f))}return h})}getAllFromCollectionGroup(e,t,i,s){let o=yn();const a=Ng(t,i),l=Ng(t,jn.max());return gr(e).te({index:Mx,range:IDBKeyRange.bound(a,l,!0)},(c,u,h)=>{const p=this.Cr(Te.fromSegments(u.prefixPath.concat(u.collectionGroup,u.documentId)),u);o=o.insert(p.key,p),o.size===s&&h.done()}).next(()=>o)}newChangeBuffer(e){return new a_(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return Dg(e).get(fu).next(t=>(Pe(!!t,20021),t))}vr(e,t){return Dg(e).put(fu,t)}Cr(e,t){if(t){const i=$j(this.serializer,t);if(!(i.isNoDocument()&&i.version.isEqual(De.min())))return i}return kt.newInvalidDocument(e)}}function i0(n){return new o_(n)}class a_ extends n0{constructor(e,t){super(),this.Br=e,this.trackRemovals=t,this.Lr=new vi(i=>i.toString(),(i,s)=>i.isEqual(s))}applyChanges(e){const t=[];let i=0,s=new mt((o,a)=>Le(o.canonicalString(),a.canonicalString()));return this.changes.forEach((o,a)=>{const l=this.Lr.get(o);if(t.push(this.Br.removeEntry(e,o,l.readTime)),a.isValidDocument()){const c=bg(this.Br.serializer,a);s=s.add(o.path.popLast());const u=tc(c);i+=u-l.size,t.push(this.Br.addEntry(e,o,c))}else if(i-=l.size,this.trackRemovals){const c=bg(this.Br.serializer,a.convertToNoDocument(De.min()));t.push(this.Br.addEntry(e,o,c))}}),s.forEach(o=>{t.push(this.Br.indexManager.addToCollectionParentIndex(e,o))}),t.push(this.Br.updateMetadata(e,i)),K.waitFor(t)}getFromCache(e,t){return this.Br.Fr(e,t).next(i=>(this.Lr.set(t,{size:i.size,readTime:i.document.readTime}),i.document))}getAllFromCache(e,t){return this.Br.Or(e,t).next(({documents:i,Nr:s})=>(s.forEach((o,a)=>{this.Lr.set(o,{size:a,readTime:i.get(o).readTime})}),i))}}function Dg(n){return Ut(n,oa)}function gr(n){return Ut(n,Gl)}function Ao(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function Ng(n,e){const t=e.documentKey.path.toArray();return[n,Zl(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function Mg(n,e){const t=n.path.toArray(),i=e.path.toArray();let s=0;for(let o=0;o<t.length-2&&o<i.length-2;++o)if(s=Le(t[o],i[o]),s)return s;return s=Le(t.length,i.length),s||(s=Le(t[t.length-2],i[i.length-2]),s||Le(t[t.length-1],i[i.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l_{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r0{constructor(e,t,i,s){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=i,this.indexManager=s}getDocument(e,t){let i=null;return this.documentOverlayCache.getOverlay(e,t).next(s=>(i=s,this.remoteDocumentCache.getEntry(e,t))).next(s=>(i!==null&&Qo(i.mutation,s,fn.empty(),xt.now()),s))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(i=>this.getLocalViewOfDocuments(e,i,Ke()).next(()=>i))}getLocalViewOfDocuments(e,t,i=Ke()){const s=qn();return this.populateOverlays(e,s,t).next(()=>this.computeViews(e,t,s,i).next(o=>{let a=Wo();return o.forEach((l,c)=>{a=a.insert(l,c.overlayedDocument)}),a}))}getOverlayedDocuments(e,t){const i=qn();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,Ke()))}populateOverlays(e,t,i){const s=[];return i.forEach(o=>{t.has(o)||s.push(o)}),this.documentOverlayCache.getOverlays(e,s).next(o=>{o.forEach((a,l)=>{t.set(a,l)})})}computeViews(e,t,i,s){let o=yn();const a=Ko(),l=function(){return Ko()}();return t.forEach((c,u)=>{const h=i.get(u.key);s.has(u.key)&&(h===void 0||h.mutation instanceof wi)?o=o.insert(u.key,u):h!==void 0?(a.set(u.key,h.mutation.getFieldMask()),Qo(h.mutation,u,h.mutation.getFieldMask(),xt.now())):a.set(u.key,fn.empty())}),this.recalculateAndSaveOverlays(e,o).next(c=>(c.forEach((u,h)=>a.set(u,h)),t.forEach((u,h)=>{var p;return l.set(u,new l_(h,(p=a.get(u))!==null&&p!==void 0?p:null))}),l))}recalculateAndSaveOverlays(e,t){const i=Ko();let s=new vt((a,l)=>a-l),o=Ke();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(a=>{for(const l of a)l.keys().forEach(c=>{const u=t.get(c);if(u===null)return;let h=i.get(c)||fn.empty();h=l.applyToLocalView(u,h),i.set(c,h);const p=(s.get(l.batchId)||Ke()).add(c);s=s.insert(l.batchId,p)})}).next(()=>{const a=[],l=s.getReverseIterator();for(;l.hasNext();){const c=l.getNext(),u=c.key,h=c.value,p=bb();h.forEach(f=>{if(!o.has(f)){const b=_b(t.get(f),i.get(f));b!==null&&p.set(f,b),o=o.add(f)}}),a.push(this.documentOverlayCache.saveOverlays(e,u,p))}return K.waitFor(a)}).next(()=>i)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(i=>this.recalculateAndSaveOverlays(e,i))}getDocumentsMatchingQuery(e,t,i,s){return function(a){return Te.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):yh(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,i,s):this.getDocumentsMatchingCollectionQuery(e,t,i,s)}getNextDocuments(e,t,i,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,i,s).next(o=>{const a=s-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,i.largestBatchId,s-o.size):K.resolve(qn());let l=Is,c=o;return a.next(u=>K.forEach(u,(h,p)=>(l<p.largestBatchId&&(l=p.largestBatchId),o.get(h)?K.resolve():this.remoteDocumentCache.getEntry(e,h).next(f=>{c=c.insert(h,f)}))).next(()=>this.populateOverlays(e,u,o)).next(()=>this.computeViews(e,c,u,Ke())).next(h=>({batchId:l,changes:xb(h)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Te(t)).next(i=>{let s=Wo();return i.isFoundDocument()&&(s=s.insert(i.key,i)),s})}getDocumentsMatchingCollectionGroupQuery(e,t,i,s){const o=t.collectionGroup;let a=Wo();return this.indexManager.getCollectionParents(e,o).next(l=>K.forEach(l,c=>{const u=function(p,f){return new bi(f,null,p.explicitOrderBy.slice(),p.filters.slice(),p.limit,p.limitType,p.startAt,p.endAt)}(t,c.child(o));return this.getDocumentsMatchingCollectionQuery(e,u,i,s).next(h=>{h.forEach((p,f)=>{a=a.insert(p,f)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,t,i,s){let o;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,i.largestBatchId).next(a=>(o=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,i,o,s))).next(a=>{o.forEach((c,u)=>{const h=u.getKey();a.get(h)===null&&(a=a.insert(h,kt.newInvalidDocument(h)))});let l=Wo();return a.forEach((c,u)=>{const h=o.get(c);h!==void 0&&Qo(h.mutation,u,fn.empty(),xt.now()),ja(t,u)&&(l=l.insert(c,u))}),l})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c_{constructor(e){this.serializer=e,this.kr=new Map,this.qr=new Map}getBundleMetadata(e,t){return K.resolve(this.kr.get(t))}saveBundleMetadata(e,t){return this.kr.set(t.id,function(s){return{id:s.id,version:s.version,createTime:Dt(s.createTime)}}(t)),K.resolve()}getNamedQuery(e,t){return K.resolve(this.qr.get(t))}saveNamedQuery(e,t){return this.qr.set(t.name,function(s){return{name:s.name,query:_h(s.bundledQuery),readTime:Dt(s.readTime)}}(t)),K.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d_{constructor(){this.overlays=new vt(Te.comparator),this.Qr=new Map}getOverlay(e,t){return K.resolve(this.overlays.get(t))}getOverlays(e,t){const i=qn();return K.forEach(t,s=>this.getOverlay(e,s).next(o=>{o!==null&&i.set(s,o)})).next(()=>i)}saveOverlays(e,t,i){return i.forEach((s,o)=>{this.St(e,t,o)}),K.resolve()}removeOverlaysForBatchId(e,t,i){const s=this.Qr.get(i);return s!==void 0&&(s.forEach(o=>this.overlays=this.overlays.remove(o)),this.Qr.delete(i)),K.resolve()}getOverlaysForCollection(e,t,i){const s=qn(),o=t.length+1,a=new Te(t.child("")),l=this.overlays.getIteratorFrom(a);for(;l.hasNext();){const c=l.getNext().value,u=c.getKey();if(!t.isPrefixOf(u.path))break;u.path.length===o&&c.largestBatchId>i&&s.set(c.getKey(),c)}return K.resolve(s)}getOverlaysForCollectionGroup(e,t,i,s){let o=new vt((u,h)=>u-h);const a=this.overlays.getIterator();for(;a.hasNext();){const u=a.getNext().value;if(u.getKey().getCollectionGroup()===t&&u.largestBatchId>i){let h=o.get(u.largestBatchId);h===null&&(h=qn(),o=o.insert(u.largestBatchId,h)),h.set(u.getKey(),u)}}const l=qn(),c=o.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((u,h)=>l.set(u,h)),!(l.size()>=s)););return K.resolve(l)}St(e,t,i){const s=this.overlays.get(i.key);if(s!==null){const a=this.Qr.get(s.largestBatchId).delete(i.key);this.Qr.set(s.largestBatchId,a)}this.overlays=this.overlays.insert(i.key,new Sh(t,i));let o=this.Qr.get(t);o===void 0&&(o=Ke(),this.Qr.set(t,o)),this.Qr.set(t,o.add(i.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u_{constructor(){this.sessionToken=At.EMPTY_BYTE_STRING}getSessionToken(e){return K.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,K.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rh{constructor(){this.$r=new mt($t.Ur),this.Kr=new mt($t.Wr)}isEmpty(){return this.$r.isEmpty()}addReference(e,t){const i=new $t(e,t);this.$r=this.$r.add(i),this.Kr=this.Kr.add(i)}Gr(e,t){e.forEach(i=>this.addReference(i,t))}removeReference(e,t){this.zr(new $t(e,t))}jr(e,t){e.forEach(i=>this.removeReference(i,t))}Hr(e){const t=new Te(new nt([])),i=new $t(t,e),s=new $t(t,e+1),o=[];return this.Kr.forEachInRange([i,s],a=>{this.zr(a),o.push(a.key)}),o}Jr(){this.$r.forEach(e=>this.zr(e))}zr(e){this.$r=this.$r.delete(e),this.Kr=this.Kr.delete(e)}Yr(e){const t=new Te(new nt([])),i=new $t(t,e),s=new $t(t,e+1);let o=Ke();return this.Kr.forEachInRange([i,s],a=>{o=o.add(a.key)}),o}containsKey(e){const t=new $t(e,0),i=this.$r.firstAfterOrEqual(t);return i!==null&&e.isEqual(i.key)}}class $t{constructor(e,t){this.key=e,this.Zr=t}static Ur(e,t){return Te.comparator(e.key,t.key)||Le(e.Zr,t.Zr)}static Wr(e,t){return Le(e.Zr,t.Zr)||Te.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h_{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.nr=1,this.Xr=new mt($t.Ur)}checkEmpty(e){return K.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,i,s){const o=this.nr;this.nr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new wh(o,t,i,s);this.mutationQueue.push(a);for(const l of s)this.Xr=this.Xr.add(new $t(l.key,o)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return K.resolve(a)}lookupMutationBatch(e,t){return K.resolve(this.ei(t))}getNextMutationBatchAfterBatchId(e,t){const i=t+1,s=this.ti(i),o=s<0?0:s;return K.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return K.resolve(this.mutationQueue.length===0?Hi:this.nr-1)}getAllMutationBatches(e){return K.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const i=new $t(t,0),s=new $t(t,Number.POSITIVE_INFINITY),o=[];return this.Xr.forEachInRange([i,s],a=>{const l=this.ei(a.Zr);o.push(l)}),K.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new mt(Le);return t.forEach(s=>{const o=new $t(s,0),a=new $t(s,Number.POSITIVE_INFINITY);this.Xr.forEachInRange([o,a],l=>{i=i.add(l.Zr)})}),K.resolve(this.ni(i))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,s=i.length+1;let o=i;Te.isDocumentKey(o)||(o=o.child(""));const a=new $t(new Te(o),0);let l=new mt(Le);return this.Xr.forEachWhile(c=>{const u=c.key.path;return!!i.isPrefixOf(u)&&(u.length===s&&(l=l.add(c.Zr)),!0)},a),K.resolve(this.ni(l))}ni(e){const t=[];return e.forEach(i=>{const s=this.ei(i);s!==null&&t.push(s)}),t}removeMutationBatch(e,t){Pe(this.ri(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let i=this.Xr;return K.forEach(t.mutations,s=>{const o=new $t(s.key,t.batchId);return i=i.delete(o),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.Xr=i})}sr(e){}containsKey(e,t){const i=new $t(t,0),s=this.Xr.firstAfterOrEqual(i);return K.resolve(t.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,K.resolve()}ri(e,t){return this.ti(e)}ti(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}ei(e){const t=this.ti(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p_{constructor(e){this.ii=e,this.docs=function(){return new vt(Te.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const i=t.key,s=this.docs.get(i),o=s?s.size:0,a=this.ii(t);return this.docs=this.docs.insert(i,{document:t.mutableCopy(),size:a}),this.size+=a-o,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const i=this.docs.get(t);return K.resolve(i?i.document.mutableCopy():kt.newInvalidDocument(t))}getEntries(e,t){let i=yn();return t.forEach(s=>{const o=this.docs.get(s);i=i.insert(s,o?o.document.mutableCopy():kt.newInvalidDocument(s))}),K.resolve(i)}getDocumentsMatchingQuery(e,t,i,s){let o=yn();const a=t.path,l=new Te(a.child("__id-9223372036854775808__")),c=this.docs.getIteratorFrom(l);for(;c.hasNext();){const{key:u,value:{document:h}}=c.getNext();if(!a.isPrefixOf(u.path))break;u.path.length>a.length+1||lh(Bx(h),i)<=0||(s.has(h.key)||ja(t,h))&&(o=o.insert(h.key,h.mutableCopy()))}return K.resolve(o)}getAllFromCollectionGroup(e,t,i,s){Ae(9500)}si(e,t){return K.forEach(this.docs,i=>t(i))}newChangeBuffer(e){return new m_(this)}getSize(e){return K.resolve(this.size)}}class m_ extends n0{constructor(e){super(),this.Br=e}applyChanges(e){const t=[];return this.changes.forEach((i,s)=>{s.isValidDocument()?t.push(this.Br.addEntry(e,s)):this.Br.removeEntry(i)}),K.waitFor(t)}getFromCache(e,t){return this.Br.getEntry(e,t)}getAllFromCache(e,t){return this.Br.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g_{constructor(e){this.persistence=e,this.oi=new vi(t=>Dr(t),Sa),this.lastRemoteSnapshotVersion=De.min(),this.highestTargetId=0,this._i=0,this.ai=new Rh,this.targetCount=0,this.ui=Or.cr()}forEachTarget(e,t){return this.oi.forEach((i,s)=>t(s)),K.resolve()}getLastRemoteSnapshotVersion(e){return K.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return K.resolve(this._i)}allocateTargetId(e){return this.highestTargetId=this.ui.next(),K.resolve(this.highestTargetId)}setTargetsMetadata(e,t,i){return i&&(this.lastRemoteSnapshotVersion=i),t>this._i&&(this._i=t),K.resolve()}Tr(e){this.oi.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ui=new Or(t),this.highestTargetId=t),e.sequenceNumber>this._i&&(this._i=e.sequenceNumber)}addTargetData(e,t){return this.Tr(t),this.targetCount+=1,K.resolve()}updateTargetData(e,t){return this.Tr(t),K.resolve()}removeTargetData(e,t){return this.oi.delete(t.target),this.ai.Hr(t.targetId),this.targetCount-=1,K.resolve()}removeTargets(e,t,i){let s=0;const o=[];return this.oi.forEach((a,l)=>{l.sequenceNumber<=t&&i.get(l.targetId)===null&&(this.oi.delete(a),o.push(this.removeMatchingKeysForTargetId(e,l.targetId)),s++)}),K.waitFor(o).next(()=>s)}getTargetCount(e){return K.resolve(this.targetCount)}getTargetData(e,t){const i=this.oi.get(t)||null;return K.resolve(i)}addMatchingKeys(e,t,i){return this.ai.Gr(t,i),K.resolve()}removeMatchingKeys(e,t,i){this.ai.jr(t,i);const s=this.persistence.referenceDelegate,o=[];return s&&t.forEach(a=>{o.push(s.markPotentiallyOrphaned(e,a))}),K.waitFor(o)}removeMatchingKeysForTargetId(e,t){return this.ai.Hr(t),K.resolve()}getMatchingKeysForTargetId(e,t){const i=this.ai.Yr(t);return K.resolve(i)}containsKey(e,t){return K.resolve(this.ai.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ah{constructor(e,t){this.ci={},this.overlays={},this.li=new gn(0),this.hi=!1,this.hi=!0,this.Pi=new u_,this.referenceDelegate=e(this),this.Ti=new g_(this),this.indexManager=new e_,this.remoteDocumentCache=function(s){return new p_(s)}(i=>this.referenceDelegate.Ii(i)),this.serializer=new Hb(t),this.Ei=new c_(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.hi=!1,Promise.resolve()}get started(){return this.hi}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new d_,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let i=this.ci[e.toKey()];return i||(i=new h_(t,this.referenceDelegate),this.ci[e.toKey()]=i),i}getGlobalsCache(){return this.Pi}getTargetCache(){return this.Ti}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ei}runTransaction(e,t,i){ue("MemoryPersistence","Starting transaction:",e);const s=new f_(this.li.next());return this.referenceDelegate.di(),i(s).next(o=>this.referenceDelegate.Ai(s).next(()=>o)).toPromise().then(o=>(s.raiseOnCommittedEvent(),o))}Ri(e,t){return K.or(Object.values(this.ci).map(i=>()=>i.containsKey(e,t)))}}class f_ extends Fx{constructor(e){super(),this.currentSequenceNumber=e}}class Lc{constructor(e){this.persistence=e,this.Vi=new Rh,this.mi=null}static fi(e){return new Lc(e)}get gi(){if(this.mi)return this.mi;throw Ae(60996)}addReference(e,t,i){return this.Vi.addReference(i,t),this.gi.delete(i.toString()),K.resolve()}removeReference(e,t,i){return this.Vi.removeReference(i,t),this.gi.add(i.toString()),K.resolve()}markPotentiallyOrphaned(e,t){return this.gi.add(t.toString()),K.resolve()}removeTarget(e,t){this.Vi.Hr(t.targetId).forEach(s=>this.gi.add(s.toString()));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,t.targetId).next(s=>{s.forEach(o=>this.gi.add(o.toString()))}).next(()=>i.removeTargetData(e,t))}di(){this.mi=new Set}Ai(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return K.forEach(this.gi,i=>{const s=Te.fromPath(i);return this.pi(e,s).next(o=>{o||t.removeEntry(s,De.min())})}).next(()=>(this.mi=null,t.apply(e)))}updateLimboDocument(e,t){return this.pi(e,t).next(i=>{i?this.gi.delete(t.toString()):this.gi.add(t.toString())})}Ii(e){return 0}pi(e,t){return K.or([()=>K.resolve(this.Vi.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ri(e,t)])}}class nc{constructor(e,t){this.persistence=e,this.yi=new vi(i=>ln(i.path),(i,s)=>i.isEqual(s)),this.garbageCollector=t0(this,t)}static fi(e,t){return new nc(e,t)}di(){}Ai(e){return K.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}pr(e){const t=this.br(e);return this.persistence.getTargetCache().getTargetCount(e).next(i=>t.next(s=>i+s))}br(e){let t=0;return this.yr(e,i=>{t++}).next(()=>t)}yr(e,t){return K.forEach(this.yi,(i,s)=>this.Dr(e,i,s).next(o=>o?K.resolve():t(s)))}removeTargets(e,t,i){return this.persistence.getTargetCache().removeTargets(e,t,i)}removeOrphanedDocuments(e,t){let i=0;const s=this.persistence.getRemoteDocumentCache(),o=s.newChangeBuffer();return s.si(e,a=>this.Dr(e,a,t).next(l=>{l||(i++,o.removeEntry(a,De.min()))})).next(()=>o.apply(e)).next(()=>i)}markPotentiallyOrphaned(e,t){return this.yi.set(t,e.currentSequenceNumber),K.resolve()}removeTarget(e,t){const i=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,i)}addReference(e,t,i){return this.yi.set(i,e.currentSequenceNumber),K.resolve()}removeReference(e,t,i){return this.yi.set(i,e.currentSequenceNumber),K.resolve()}updateLimboDocument(e,t){return this.yi.set(t,e.currentSequenceNumber),K.resolve()}Ii(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Rl(e.data.value)),t}Dr(e,t,i){return K.or([()=>this.persistence.Ri(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const s=this.yi.get(t);return K.resolve(s!==void 0&&s>i)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y_{constructor(e){this.serializer=e}q(e,t,i,s){const o=new Cc("createOrUpgrade",t);i<1&&s>=1&&(function(c){c.createObjectStore(ka)}(e),function(c){c.createObjectStore(sa,{keyPath:zT}),c.createObjectStore(Rn,{keyPath:Qm,autoIncrement:!0}).createIndex(Tr,Ym,{unique:!0}),c.createObjectStore(As)}(e),Wg(e),function(c){c.createObjectStore(xr)}(e));let a=K.resolve();return i<3&&s>=3&&(i!==0&&(function(c){c.deleteObjectStore(Bs),c.deleteObjectStore(Es),c.deleteObjectStore(Ar)}(e),Wg(e)),a=a.next(()=>function(c){const u=c.store(Ar),h={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:De.min().toTimestamp(),targetCount:0};return u.put(Kl,h)}(o))),i<4&&s>=4&&(i!==0&&(a=a.next(()=>function(c,u){return u.store(Rn).J().next(p=>{c.deleteObjectStore(Rn),c.createObjectStore(Rn,{keyPath:Qm,autoIncrement:!0}).createIndex(Tr,Ym,{unique:!0});const f=u.store(Rn),b=p.map(x=>f.put(x));return K.waitFor(b)})}(e,o))),a=a.next(()=>{(function(c){c.createObjectStore(Ps,{keyPath:UT})})(e)})),i<5&&s>=5&&(a=a.next(()=>this.wi(o))),i<6&&s>=6&&(a=a.next(()=>(function(c){c.createObjectStore(oa)}(e),this.bi(o)))),i<7&&s>=7&&(a=a.next(()=>this.Si(o))),i<8&&s>=8&&(a=a.next(()=>this.Di(e,o))),i<9&&s>=9&&(a=a.next(()=>{(function(c){c.objectStoreNames.contains("remoteDocumentChanges")&&c.deleteObjectStore("remoteDocumentChanges")})(e)})),i<10&&s>=10&&(a=a.next(()=>this.Ci(o))),i<11&&s>=11&&(a=a.next(()=>{(function(c){c.createObjectStore(Rc,{keyPath:HT})})(e),function(c){c.createObjectStore(Ac,{keyPath:$T})}(e)})),i<12&&s>=12&&(a=a.next(()=>{(function(c){const u=c.createObjectStore(Ec,{keyPath:ZT});u.createIndex(xu,ej,{unique:!1}),u.createIndex(Vx,tj,{unique:!1})})(e)})),i<13&&s>=13&&(a=a.next(()=>function(c){const u=c.createObjectStore(Gl,{keyPath:NT});u.createIndex(Il,MT),u.createIndex(Mx,WT)}(e)).next(()=>this.Fi(e,o)).next(()=>e.deleteObjectStore(xr))),i<14&&s>=14&&(a=a.next(()=>this.Mi(e,o))),i<15&&s>=15&&(a=a.next(()=>function(c){c.createObjectStore(uh,{keyPath:GT,autoIncrement:!0}).createIndex(yu,KT,{unique:!1}),c.createObjectStore(Ho,{keyPath:QT}).createIndex(Lx,YT,{unique:!1}),c.createObjectStore($o,{keyPath:XT}).createIndex(Ox,JT,{unique:!1})}(e))),i<16&&s>=16&&(a=a.next(()=>{t.objectStore(Ho).clear()}).next(()=>{t.objectStore($o).clear()})),i<17&&s>=17&&(a=a.next(()=>{(function(c){c.createObjectStore(hh,{keyPath:nj})})(e)})),i<18&&s>=18&&mx()&&(a=a.next(()=>{t.objectStore(Ho).clear()}).next(()=>{t.objectStore($o).clear()})),a}bi(e){let t=0;return e.store(xr).te((i,s)=>{t+=tc(s)}).next(()=>{const i={byteSize:t};return e.store(oa).put(fu,i)})}wi(e){const t=e.store(sa),i=e.store(Rn);return t.J().next(s=>K.forEach(s,o=>{const a=IDBKeyRange.bound([o.userId,Hi],[o.userId,o.lastAcknowledgedBatchId]);return i.J(Tr,a).next(l=>K.forEach(l,c=>{Pe(c.userId===o.userId,18650,"Cannot process batch from unexpected user",{batchId:c.batchId});const u=wr(this.serializer,c);return Yb(e,o.userId,u).next(()=>{})}))}))}Si(e){const t=e.store(Bs),i=e.store(xr);return e.store(Ar).get(Kl).next(s=>{const o=[];return i.te((a,l)=>{const c=new nt(a),u=function(p){return[0,ln(p)]}(c);o.push(t.get(u).next(h=>h?K.resolve():(p=>t.put({targetId:0,path:ln(p),sequenceNumber:s.highestListenSequenceNumber}))(c)))}).next(()=>K.waitFor(o))})}Di(e,t){e.createObjectStore(aa,{keyPath:qT});const i=t.store(aa),s=new Ch,o=a=>{if(s.add(a)){const l=a.lastSegment(),c=a.popLast();return i.put({collectionId:l,parent:ln(c)})}};return t.store(xr).te({ee:!0},(a,l)=>{const c=new nt(a);return o(c.popLast())}).next(()=>t.store(As).te({ee:!0},([a,l,c],u)=>{const h=Vn(l);return o(h.popLast())}))}Ci(e){const t=e.store(Es);return t.te((i,s)=>{const o=Oo(s),a=$b(this.serializer,o);return t.put(a)})}Fi(e,t){const i=t.store(xr),s=[];return i.te((o,a)=>{const l=t.store(Gl),c=function(p){return p.document?new Te(nt.fromString(p.document.name).popFirst(5)):p.noDocument?Te.fromSegments(p.noDocument.path):p.unknownDocument?Te.fromSegments(p.unknownDocument.path):Ae(36783)}(a).path.toArray(),u={prefixPath:c.slice(0,c.length-2),collectionGroup:c[c.length-2],documentId:c[c.length-1],readTime:a.readTime||[0,0],unknownDocument:a.unknownDocument,noDocument:a.noDocument,document:a.document,hasCommittedMutations:!!a.hasCommittedMutations};s.push(l.put(u))}).next(()=>K.waitFor(s))}Mi(e,t){const i=t.store(Rn),s=i0(this.serializer),o=new Ah(Lc.fi,this.serializer.wt);return i.J().next(a=>{const l=new Map;return a.forEach(c=>{var u;let h=(u=l.get(c.userId))!==null&&u!==void 0?u:Ke();wr(this.serializer,c).keys().forEach(p=>h=h.add(p)),l.set(c.userId,h)}),K.forEach(l,(c,u)=>{const h=new Gt(u),p=Mc.bt(this.serializer,h),f=o.getIndexManager(h),b=Wc.bt(h,this.serializer,f,o.referenceDelegate);return new r0(s,b,p,f).recalculateAndSaveOverlaysForDocumentKeys(new bu(t,gn.le),c).next()})})}}function Wg(n){n.createObjectStore(Bs,{keyPath:OT}).createIndex(dh,VT,{unique:!0}),n.createObjectStore(Es,{keyPath:"targetId"}).createIndex(Wx,LT,{unique:!0}),n.createObjectStore(Ar)}const Pi="IndexedDbPersistence",Pd=18e5,Fd=5e3,zd="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",s0="main";class Eh{constructor(e,t,i,s,o,a,l,c,u,h,p=18){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=i,this.xi=o,this.window=a,this.document=l,this.Oi=u,this.Ni=h,this.Bi=p,this.li=null,this.hi=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Li=null,this.inForeground=!1,this.ki=null,this.qi=null,this.Qi=Number.NEGATIVE_INFINITY,this.$i=f=>Promise.resolve(),!Eh.C())throw new de(Z.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new s_(this,s),this.Ui=t+s0,this.serializer=new Hb(c),this.Ki=new $n(this.Ui,this.Bi,new y_(this.serializer)),this.Pi=new Kj,this.Ti=new n_(this.referenceDelegate,this.serializer),this.remoteDocumentCache=i0(this.serializer),this.Ei=new Gj,this.window&&this.window.localStorage?this.Wi=this.window.localStorage:(this.Wi=null,h===!1&&zt(Pi,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Gi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new de(Z.FAILED_PRECONDITION,zd);return this.zi(),this.ji(),this.Hi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Ti.getHighestSequenceNumber(e))}).then(e=>{this.li=new gn(e,this.Oi)}).then(()=>{this.hi=!0}).catch(e=>(this.Ki&&this.Ki.close(),Promise.reject(e)))}Ji(e){return this.$i=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ki.U(async t=>{t.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.xi.enqueueAndForget(async()=>{this.started&&await this.Gi()}))}Gi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>fl(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.Yi(e).next(t=>{t||(this.isPrimary=!1,this.xi.enqueueRetryable(()=>this.$i(!1)))})}).next(()=>this.Zi(e)).next(t=>this.isPrimary&&!t?this.Xi(e).next(()=>!1):!!t&&this.es(e).next(()=>!0))).catch(e=>{if(rr(e))return ue(Pi,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return ue(Pi,"Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.xi.enqueueRetryable(()=>this.$i(e)),this.isPrimary=e})}Yi(e){return Eo(e).get(rs).next(t=>K.resolve(this.ts(t)))}ns(e){return fl(e).delete(this.clientId)}async rs(){if(this.isPrimary&&!this.ss(this.Qi,Pd)){this.Qi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",t=>{const i=Ut(t,Ps);return i.J().next(s=>{const o=this._s(s,Pd),a=s.filter(l=>o.indexOf(l)===-1);return K.forEach(a,l=>i.delete(l.clientId)).next(()=>a)})}).catch(()=>[]);if(this.Wi)for(const t of e)this.Wi.removeItem(this.us(t.clientId))}}Hi(){this.qi=this.xi.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.Gi().then(()=>this.rs()).then(()=>this.Hi()))}ts(e){return!!e&&e.ownerId===this.clientId}Zi(e){return this.Ni?K.resolve(!0):Eo(e).get(rs).next(t=>{if(t!==null&&this.ss(t.leaseTimestampMs,Fd)&&!this.cs(t.ownerId)){if(this.ts(t)&&this.networkEnabled)return!0;if(!this.ts(t)){if(!t.allowTabSynchronization)throw new de(Z.FAILED_PRECONDITION,zd);return!1}}return!(!this.networkEnabled||!this.inForeground)||fl(e).J().next(i=>this._s(i,Fd).find(s=>{if(this.clientId!==s.clientId){const o=!this.networkEnabled&&s.networkEnabled,a=!this.inForeground&&s.inForeground,l=this.networkEnabled===s.networkEnabled;if(o||a&&l)return!0}return!1})===void 0)}).next(t=>(this.isPrimary!==t&&ue(Pi,`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}async shutdown(){this.hi=!1,this.ls(),this.qi&&(this.qi.cancel(),this.qi=null),this.hs(),this.Ps(),await this.Ki.runTransaction("shutdown","readwrite",[ka,Ps],e=>{const t=new bu(e,gn.le);return this.Xi(t).next(()=>this.ns(t))}),this.Ki.close(),this.Ts()}_s(e,t){return e.filter(i=>this.ss(i.updateTimeMs,t)&&!this.cs(i.clientId))}Is(){return this.runTransaction("getActiveClients","readonly",e=>fl(e).J().next(t=>this._s(t,Pd).map(i=>i.clientId)))}get started(){return this.hi}getGlobalsCache(){return this.Pi}getMutationQueue(e,t){return Wc.bt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Ti}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new t_(e,this.serializer.wt.databaseId)}getDocumentOverlayCache(e){return Mc.bt(this.serializer,e)}getBundleCache(){return this.Ei}runTransaction(e,t,i){ue(Pi,"Starting transaction:",e);const s=t==="readonly"?"readonly":"readwrite",o=function(c){return c===18?sj:c===17?$x:c===16?rj:c===15?ph:c===14?Hx:c===13?Ux:c===12?ij:c===11?qx:void Ae(60245)}(this.Bi);let a;return this.Ki.runTransaction(e,s,o,l=>(a=new bu(l,this.li?this.li.next():gn.le),t==="readwrite-primary"?this.Yi(a).next(c=>!!c||this.Zi(a)).next(c=>{if(!c)throw zt(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.xi.enqueueRetryable(()=>this.$i(!1)),new de(Z.FAILED_PRECONDITION,Px);return i(a)}).next(c=>this.es(a).next(()=>c)):this.Es(a).next(()=>i(a)))).then(l=>(a.raiseOnCommittedEvent(),l))}Es(e){return Eo(e).get(rs).next(t=>{if(t!==null&&this.ss(t.leaseTimestampMs,Fd)&&!this.cs(t.ownerId)&&!this.ts(t)&&!(this.Ni||this.allowTabSynchronization&&t.allowTabSynchronization))throw new de(Z.FAILED_PRECONDITION,zd)})}es(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Eo(e).put(rs,t)}static C(){return $n.C()}Xi(e){const t=Eo(e);return t.get(rs).next(i=>this.ts(i)?(ue(Pi,"Releasing primary lease."),t.delete(rs)):K.resolve())}ss(e,t){const i=Date.now();return!(e<i-t)&&(!(e>i)||(zt(`Detected an update time that is in the future: ${e} > ${i}`),!1))}zi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.ki=()=>{this.xi.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.Gi()))},this.document.addEventListener("visibilitychange",this.ki),this.inForeground=this.document.visibilityState==="visible")}hs(){this.ki&&(this.document.removeEventListener("visibilitychange",this.ki),this.ki=null)}ji(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.Li=()=>{this.ls();const t=/(?:Version|Mobile)\/1[456]/;px()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.xi.enterRestrictedMode(!0),this.xi.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Li))}Ps(){this.Li&&(this.window.removeEventListener("pagehide",this.Li),this.Li=null)}cs(e){var t;try{const i=((t=this.Wi)===null||t===void 0?void 0:t.getItem(this.us(e)))!==null;return ue(Pi,`Client '${e}' ${i?"is":"is not"} zombied in LocalStorage`),i}catch(i){return zt(Pi,"Failed to get zombied client id.",i),!1}}ls(){if(this.Wi)try{this.Wi.setItem(this.us(this.clientId),String(Date.now()))}catch(e){zt("Failed to set zombie client id.",e)}}Ts(){if(this.Wi)try{this.Wi.removeItem(this.us(this.clientId))}catch{}}us(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Eo(n){return Ut(n,ka)}function fl(n){return Ut(n,Ps)}function Bh(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ph{constructor(e,t,i,s){this.targetId=e,this.fromCache=t,this.ds=i,this.As=s}static Rs(e,t){let i=Ke(),s=Ke();for(const o of t.docChanges)switch(o.type){case 0:i=i.add(o.doc.key);break;case 1:s=s.add(o.doc.key)}return new Ph(e,t.fromCache,i,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x_{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o0{constructor(){this.Vs=!1,this.fs=!1,this.gs=100,this.ps=function(){return px()?8:zx(qt())>0?6:4}()}initialize(e,t){this.ys=e,this.indexManager=t,this.Vs=!0}getDocumentsMatchingQuery(e,t,i,s){const o={result:null};return this.ws(e,t).next(a=>{o.result=a}).next(()=>{if(!o.result)return this.bs(e,t,s,i).next(a=>{o.result=a})}).next(()=>{if(o.result)return;const a=new x_;return this.Ss(e,t,a).next(l=>{if(o.result=l,this.fs)return this.Ds(e,t,a,l.size)})}).next(()=>o.result)}Ds(e,t,i,s){return i.documentReadCount<this.gs?(gs()<=tt.DEBUG&&ue("QueryEngine","SDK will not create cache indexes for query:",fs(t),"since it only creates cache indexes for collection contains","more than or equal to",this.gs,"documents"),K.resolve()):(gs()<=tt.DEBUG&&ue("QueryEngine","Query:",fs(t),"scans",i.documentReadCount,"local documents and returns",s,"documents as results."),i.documentReadCount>this.ps*s?(gs()<=tt.DEBUG&&ue("QueryEngine","The SDK decides to create cache indexes for query:",fs(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,cn(t))):K.resolve())}ws(e,t){if(cg(t))return K.resolve(null);let i=cn(t);return this.indexManager.getIndexType(e,i).next(s=>s===0?null:(t.limit!==null&&s===1&&(t=Xl(t,null,"F"),i=cn(t)),this.indexManager.getDocumentsMatchingTarget(e,i).next(o=>{const a=Ke(...o);return this.ys.getDocuments(e,a).next(l=>this.indexManager.getMinOffset(e,i).next(c=>{const u=this.vs(t,l);return this.Cs(t,u,a,c.readTime)?this.ws(e,Xl(t,null,"F")):this.Fs(e,u,t,c)}))})))}bs(e,t,i,s){return cg(t)||s.isEqual(De.min())?K.resolve(null):this.ys.getDocuments(e,i).next(o=>{const a=this.vs(t,o);return this.Cs(t,a,i,s)?K.resolve(null):(gs()<=tt.DEBUG&&ue("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),fs(t)),this.Fs(e,a,t,Ex(s,Is)).next(l=>l))})}vs(e,t){let i=new mt(fb(e));return t.forEach((s,o)=>{ja(e,o)&&(i=i.add(o))}),i}Cs(e,t,i,s){if(e.limit===null)return!1;if(i.size!==t.size)return!0;const o=e.limitType==="F"?t.last():t.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(s)>0)}Ss(e,t,i){return gs()<=tt.DEBUG&&ue("QueryEngine","Using full collection scan to execute query:",fs(t)),this.ys.getDocumentsMatchingQuery(e,t,jn.min(),i)}Fs(e,t,i,s){return this.ys.getDocumentsMatchingQuery(e,i,s).next(o=>(t.forEach(a=>{o=o.insert(a.key,a)}),o))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fh="LocalStore",b_=3e8;class v_{constructor(e,t,i,s){this.persistence=e,this.Ms=t,this.serializer=s,this.xs=new vt(Le),this.Os=new vi(o=>Dr(o),Sa),this.Ns=new Map,this.Bs=e.getRemoteDocumentCache(),this.Ti=e.getTargetCache(),this.Ei=e.getBundleCache(),this.Ls(i)}Ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new r0(this.Bs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Bs.setIndexManager(this.indexManager),this.Ms.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.xs))}}function a0(n,e,t,i){return new v_(n,e,t,i)}async function l0(n,e){const t=ke(n);return await t.persistence.runTransaction("Handle user change","readonly",i=>{let s;return t.mutationQueue.getAllMutationBatches(i).next(o=>(s=o,t.Ls(e),t.mutationQueue.getAllMutationBatches(i))).next(o=>{const a=[],l=[];let c=Ke();for(const u of s){a.push(u.batchId);for(const h of u.mutations)c=c.add(h.key)}for(const u of o){l.push(u.batchId);for(const h of u.mutations)c=c.add(h.key)}return t.localDocuments.getDocuments(i,c).next(u=>({ks:u,removedBatchIds:a,addedBatchIds:l}))})})}function w_(n,e){const t=ke(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",i=>{const s=e.batch.keys(),o=t.Bs.newChangeBuffer({trackRemovals:!0});return function(l,c,u,h){const p=u.batch,f=p.keys();let b=K.resolve();return f.forEach(x=>{b=b.next(()=>h.getEntry(c,x)).next(S=>{const w=u.docVersions.get(x);Pe(w!==null,48541),S.version.compareTo(w)<0&&(p.applyToRemoteDocument(S,u),S.isValidDocument()&&(S.setReadTime(u.commitVersion),h.addEntry(S)))})}),b.next(()=>l.mutationQueue.removeMutationBatch(c,p))}(t,i,e,o).next(()=>o.apply(i)).next(()=>t.mutationQueue.performConsistencyCheck(i)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(i,s,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,function(l){let c=Ke();for(let u=0;u<l.mutationResults.length;++u)l.mutationResults[u].transformResults.length>0&&(c=c.add(l.batch.mutations[u].key));return c}(e))).next(()=>t.localDocuments.getDocuments(i,s))})}function c0(n){const e=ke(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Ti.getLastRemoteSnapshotVersion(t))}function k_(n,e){const t=ke(n),i=e.snapshotVersion;let s=t.xs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",o=>{const a=t.Bs.newChangeBuffer({trackRemovals:!0});s=t.xs;const l=[];e.targetChanges.forEach((h,p)=>{const f=s.get(p);if(!f)return;l.push(t.Ti.removeMatchingKeys(o,h.removedDocuments,p).next(()=>t.Ti.addMatchingKeys(o,h.addedDocuments,p)));let b=f.withSequenceNumber(o.currentSequenceNumber);e.targetMismatches.get(p)!==null?b=b.withResumeToken(At.EMPTY_BYTE_STRING,De.min()).withLastLimboFreeSnapshotVersion(De.min()):h.resumeToken.approximateByteSize()>0&&(b=b.withResumeToken(h.resumeToken,i)),s=s.insert(p,b),function(S,w,I){return S.resumeToken.approximateByteSize()===0||w.snapshotVersion.toMicroseconds()-S.snapshotVersion.toMicroseconds()>=b_?!0:I.addedDocuments.size+I.modifiedDocuments.size+I.removedDocuments.size>0}(f,b,h)&&l.push(t.Ti.updateTargetData(o,b))});let c=yn(),u=Ke();if(e.documentUpdates.forEach(h=>{e.resolvedLimboDocuments.has(h)&&l.push(t.persistence.referenceDelegate.updateLimboDocument(o,h))}),l.push(d0(o,a,e.documentUpdates).next(h=>{c=h.qs,u=h.Qs})),!i.isEqual(De.min())){const h=t.Ti.getLastRemoteSnapshotVersion(o).next(p=>t.Ti.setTargetsMetadata(o,o.currentSequenceNumber,i));l.push(h)}return K.waitFor(l).next(()=>a.apply(o)).next(()=>t.localDocuments.getLocalViewOfDocuments(o,c,u)).next(()=>c)}).then(o=>(t.xs=s,o))}function d0(n,e,t){let i=Ke(),s=Ke();return t.forEach(o=>i=i.add(o)),e.getEntries(n,i).next(o=>{let a=yn();return t.forEach((l,c)=>{const u=o.get(l);c.isFoundDocument()!==u.isFoundDocument()&&(s=s.add(l)),c.isNoDocument()&&c.version.isEqual(De.min())?(e.removeEntry(l,c.readTime),a=a.insert(l,c)):!u.isValidDocument()||c.version.compareTo(u.version)>0||c.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(c),a=a.insert(l,c)):ue(Fh,"Ignoring outdated watch update for ",l,". Current version:",u.version," Watch version:",c.version)}),{qs:a,Qs:s}})}function S_(n,e){const t=ke(n);return t.persistence.runTransaction("Get next mutation batch","readonly",i=>(e===void 0&&(e=Hi),t.mutationQueue.getNextMutationBatchAfterBatchId(i,e)))}function Ls(n,e){const t=ke(n);return t.persistence.runTransaction("Allocate target","readwrite",i=>{let s;return t.Ti.getTargetData(i,e).next(o=>o?(s=o,K.resolve(s)):t.Ti.allocateTargetId(i).next(a=>(s=new li(e,a,"TargetPurposeListen",i.currentSequenceNumber),t.Ti.addTargetData(i,s).next(()=>s))))}).then(i=>{const s=t.xs.get(i.targetId);return(s===null||i.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(t.xs=t.xs.insert(i.targetId,i),t.Os.set(e,i.targetId)),i})}async function Os(n,e,t){const i=ke(n),s=i.xs.get(e),o=t?"readwrite":"readwrite-primary";try{t||await i.persistence.runTransaction("Release target",o,a=>i.persistence.referenceDelegate.removeTarget(a,s))}catch(a){if(!rr(a))throw a;ue(Fh,`Failed to update sequence numbers for target ${e}: ${a}`)}i.xs=i.xs.remove(e),i.Os.delete(s.target)}function ic(n,e,t){const i=ke(n);let s=De.min(),o=Ke();return i.persistence.runTransaction("Execute query","readwrite",a=>function(c,u,h){const p=ke(c),f=p.Os.get(h);return f!==void 0?K.resolve(p.xs.get(f)):p.Ti.getTargetData(u,h)}(i,a,cn(e)).next(l=>{if(l)return s=l.lastLimboFreeSnapshotVersion,i.Ti.getMatchingKeysForTargetId(a,l.targetId).next(c=>{o=c})}).next(()=>i.Ms.getDocumentsMatchingQuery(a,e,t?s:De.min(),t?o:Ke())).next(l=>(p0(i,gb(e),l),{documents:l,$s:o})))}function u0(n,e){const t=ke(n),i=ke(t.Ti),s=t.xs.get(e);return s?Promise.resolve(s.target):t.persistence.runTransaction("Get target data","readonly",o=>i.Rt(o,e).next(a=>a?a.target:null))}function h0(n,e){const t=ke(n),i=t.Ns.get(e)||De.min();return t.persistence.runTransaction("Get new document changes","readonly",s=>t.Bs.getAllFromCollectionGroup(s,e,Ex(i,Is),Number.MAX_SAFE_INTEGER)).then(s=>(p0(t,e,s),s))}function p0(n,e,t){let i=n.Ns.get(e)||De.min();t.forEach((s,o)=>{o.readTime.compareTo(i)>0&&(i=o.readTime)}),n.Ns.set(e,i)}async function T_(n,e,t,i){const s=ke(n);let o=Ke(),a=yn();for(const u of t){const h=e.Us(u.metadata.name);u.document&&(o=o.add(h));const p=e.Ks(u);p.setReadTime(e.Ws(u.metadata.readTime)),a=a.insert(h,p)}const l=s.Bs.newChangeBuffer({trackRemovals:!0}),c=await Ls(s,function(h){return cn(eo(nt.fromString(`__bundle__/docs/${h}`)))}(i));return s.persistence.runTransaction("Apply bundle documents","readwrite",u=>d0(u,l,a).next(h=>(l.apply(u),h)).next(h=>s.Ti.removeMatchingKeysForTargetId(u,c.targetId).next(()=>s.Ti.addMatchingKeys(u,o,c.targetId)).next(()=>s.localDocuments.getLocalViewOfDocuments(u,h.qs,h.Qs)).next(()=>h.qs)))}async function j_(n,e,t=Ke()){const i=await Ls(n,cn(_h(e.bundledQuery))),s=ke(n);return s.persistence.runTransaction("Save named query","readwrite",o=>{const a=Dt(e.readTime);if(i.snapshotVersion.compareTo(a)>=0)return s.Ei.saveNamedQuery(o,e);const l=i.withResumeToken(At.EMPTY_BYTE_STRING,a);return s.xs=s.xs.insert(l.targetId,l),s.Ti.updateTargetData(o,l).next(()=>s.Ti.removeMatchingKeysForTargetId(o,i.targetId)).next(()=>s.Ti.addMatchingKeys(o,t,i.targetId)).next(()=>s.Ei.saveNamedQuery(o,e))})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m0="firestore_clients";function Lg(n,e){return`${m0}_${n}_${e}`}const g0="firestore_mutations";function Og(n,e,t){let i=`${g0}_${n}_${t}`;return e.isAuthenticated()&&(i+=`_${e.uid}`),i}const f0="firestore_targets";function Dd(n,e){return`${f0}_${n}_${e}`}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ln="SharedClientState";class rc{constructor(e,t,i,s){this.user=e,this.batchId=t,this.state=i,this.error=s}static Gs(e,t,i){const s=JSON.parse(i);let o,a=typeof s=="object"&&["pending","acknowledged","rejected"].indexOf(s.state)!==-1&&(s.error===void 0||typeof s.error=="object");return a&&s.error&&(a=typeof s.error.message=="string"&&typeof s.error.code=="string",a&&(o=new de(s.error.code,s.error.message))),a?new rc(e,t,s.state,o):(zt(Ln,`Failed to parse mutation state for ID '${t}': ${i}`),null)}zs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Yo{constructor(e,t,i){this.targetId=e,this.state=t,this.error=i}static Gs(e,t){const i=JSON.parse(t);let s,o=typeof i=="object"&&["not-current","current","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return o&&i.error&&(o=typeof i.error.message=="string"&&typeof i.error.code=="string",o&&(s=new de(i.error.code,i.error.message))),o?new Yo(e,i.state,s):(zt(Ln,`Failed to parse target state for ID '${e}': ${t}`),null)}zs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class sc{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Gs(e,t){const i=JSON.parse(t);let s=typeof i=="object"&&i.activeTargetIds instanceof Array,o=xh();for(let a=0;s&&a<i.activeTargetIds.length;++a)s=Dx(i.activeTargetIds[a]),o=o.add(i.activeTargetIds[a]);return s?new sc(e,o):(zt(Ln,`Failed to parse client data for instance '${e}': ${t}`),null)}}class zh{constructor(e,t){this.clientId=e,this.onlineState=t}static Gs(e){const t=JSON.parse(e);return typeof t=="object"&&["Unknown","Online","Offline"].indexOf(t.onlineState)!==-1&&typeof t.clientId=="string"?new zh(t.clientId,t.onlineState):(zt(Ln,`Failed to parse online state: ${e}`),null)}}class Pu{constructor(){this.activeTargetIds=xh()}js(e){this.activeTargetIds=this.activeTargetIds.add(e)}Hs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}zs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Nd{constructor(e,t,i,s,o){this.window=e,this.xi=t,this.persistenceKey=i,this.Js=s,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.Ys=this.Zs.bind(this),this.Xs=new vt(Le),this.started=!1,this.eo=[];const a=i.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=o,this.no=Lg(this.persistenceKey,this.Js),this.ro=function(c){return`firestore_sequence_number_${c}`}(this.persistenceKey),this.Xs=this.Xs.insert(this.Js,new Pu),this.io=new RegExp(`^${m0}_${a}_([^_]*)$`),this.so=new RegExp(`^${g0}_${a}_(\\d+)(?:_(.*))?$`),this.oo=new RegExp(`^${f0}_${a}_(\\d+)$`),this._o=function(c){return`firestore_online_state_${c}`}(this.persistenceKey),this.ao=function(c){return`firestore_bundle_loaded_v2_${c}`}(this.persistenceKey),this.window.addEventListener("storage",this.Ys)}static C(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.Is();for(const i of e){if(i===this.Js)continue;const s=this.getItem(Lg(this.persistenceKey,i));if(s){const o=sc.Gs(i,s);o&&(this.Xs=this.Xs.insert(o.clientId,o))}}this.uo();const t=this.storage.getItem(this._o);if(t){const i=this.co(t);i&&this.lo(i)}for(const i of this.eo)this.Zs(i);this.eo=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0}writeSequenceNumber(e){this.setItem(this.ro,JSON.stringify(e))}getAllActiveQueryTargets(){return this.ho(this.Xs)}isActiveQueryTarget(e){let t=!1;return this.Xs.forEach((i,s)=>{s.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this.Po(e,"pending")}updateMutationState(e,t,i){this.Po(e,t,i),this.To(e)}addLocalQueryTarget(e,t=!0){let i="not-current";if(this.isActiveQueryTarget(e)){const s=this.storage.getItem(Dd(this.persistenceKey,e));if(s){const o=Yo.Gs(e,s);o&&(i=o.state)}}return t&&this.Io.js(e),this.uo(),i}removeLocalQueryTarget(e){this.Io.Hs(e),this.uo()}isLocalQueryTarget(e){return this.Io.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(Dd(this.persistenceKey,e))}updateQueryState(e,t,i){this.Eo(e,t,i)}handleUserChange(e,t,i){t.forEach(s=>{this.To(s)}),this.currentUser=e,i.forEach(s=>{this.addPendingMutation(s)})}setOnlineState(e){this.Ao(e)}notifyBundleLoaded(e){this.Ro(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.Ys),this.removeItem(this.no),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return ue(Ln,"READ",e,t),t}setItem(e,t){ue(Ln,"SET",e,t),this.storage.setItem(e,t)}removeItem(e){ue(Ln,"REMOVE",e),this.storage.removeItem(e)}Zs(e){const t=e;if(t.storageArea===this.storage){if(ue(Ln,"EVENT",t.key,t.newValue),t.key===this.no)return void zt("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.xi.enqueueRetryable(async()=>{if(this.started){if(t.key!==null){if(this.io.test(t.key)){if(t.newValue==null){const i=this.Vo(t.key);return this.mo(i,null)}{const i=this.fo(t.key,t.newValue);if(i)return this.mo(i.clientId,i)}}else if(this.so.test(t.key)){if(t.newValue!==null){const i=this.po(t.key,t.newValue);if(i)return this.yo(i)}}else if(this.oo.test(t.key)){if(t.newValue!==null){const i=this.wo(t.key,t.newValue);if(i)return this.bo(i)}}else if(t.key===this._o){if(t.newValue!==null){const i=this.co(t.newValue);if(i)return this.lo(i)}}else if(t.key===this.ro){const i=function(o){let a=gn.le;if(o!=null)try{const l=JSON.parse(o);Pe(typeof l=="number",30636,{So:o}),a=l}catch(l){zt(Ln,"Failed to read sequence number from WebStorage",l)}return a}(t.newValue);i!==gn.le&&this.sequenceNumberHandler(i)}else if(t.key===this.ao){const i=this.Do(t.newValue);await Promise.all(i.map(s=>this.syncEngine.vo(s)))}}}else this.eo.push(t)})}}get Io(){return this.Xs.get(this.Js)}uo(){this.setItem(this.no,this.Io.zs())}Po(e,t,i){const s=new rc(this.currentUser,e,t,i),o=Og(this.persistenceKey,this.currentUser,e);this.setItem(o,s.zs())}To(e){const t=Og(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Ao(e){const t={clientId:this.Js,onlineState:e};this.storage.setItem(this._o,JSON.stringify(t))}Eo(e,t,i){const s=Dd(this.persistenceKey,e),o=new Yo(e,t,i);this.setItem(s,o.zs())}Ro(e){const t=JSON.stringify(Array.from(e));this.setItem(this.ao,t)}Vo(e){const t=this.io.exec(e);return t?t[1]:null}fo(e,t){const i=this.Vo(e);return sc.Gs(i,t)}po(e,t){const i=this.so.exec(e),s=Number(i[1]),o=i[2]!==void 0?i[2]:null;return rc.Gs(new Gt(o),s,t)}wo(e,t){const i=this.oo.exec(e),s=Number(i[1]);return Yo.Gs(s,t)}co(e){return zh.Gs(e)}Do(e){return JSON.parse(e)}async yo(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.Co(e.batchId,e.state,e.error);ue(Ln,`Ignoring mutation for non-active user ${e.user.uid}`)}bo(e){return this.syncEngine.Fo(e.targetId,e.state,e.error)}mo(e,t){const i=t?this.Xs.insert(e,t):this.Xs.remove(e),s=this.ho(this.Xs),o=this.ho(i),a=[],l=[];return o.forEach(c=>{s.has(c)||a.push(c)}),s.forEach(c=>{o.has(c)||l.push(c)}),this.syncEngine.Mo(a,l).then(()=>{this.Xs=i})}lo(e){this.Xs.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}ho(e){let t=xh();return e.forEach((i,s)=>{t=t.unionWith(s.activeTargetIds)}),t}}class y0{constructor(){this.xo=new Pu,this.Oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,i){}addLocalQueryTarget(e,t=!0){return t&&this.xo.js(e),this.Oo[e]||"not-current"}updateQueryState(e,t,i){this.Oo[e]=t}removeLocalQueryTarget(e){this.xo.Hs(e)}isLocalQueryTarget(e){return this.xo.activeTargetIds.has(e)}clearQueryState(e){delete this.Oo[e]}getAllActiveQueryTargets(){return this.xo.activeTargetIds}isActiveQueryTarget(e){return this.xo.activeTargetIds.has(e)}start(){return this.xo=new Pu,Promise.resolve()}handleUserChange(e,t,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __{No(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vg="ConnectivityMonitor";class qg{constructor(){this.Bo=()=>this.Lo(),this.ko=()=>this.qo(),this.Qo=[],this.$o()}No(e){this.Qo.push(e)}shutdown(){window.removeEventListener("online",this.Bo),window.removeEventListener("offline",this.ko)}$o(){window.addEventListener("online",this.Bo),window.addEventListener("offline",this.ko)}Lo(){ue(Vg,"Network connectivity changed: AVAILABLE");for(const e of this.Qo)e(0)}qo(){ue(Vg,"Network connectivity changed: UNAVAILABLE");for(const e of this.Qo)e(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let yl=null;function Fu(){return yl===null?yl=function(){return 268435456+Math.round(2147483648*Math.random())}():yl++,"0x"+yl.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Md="RestConnection",I_={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class C_{get Uo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Ko=t+"://"+e.host,this.Wo=`projects/${i}/databases/${s}`,this.Go=this.databaseId.database===ca?`project_id=${i}`:`project_id=${i}&database_id=${s}`}zo(e,t,i,s,o){const a=Fu(),l=this.jo(e,t.toUriEncodedString());ue(Md,`Sending RPC '${e}' ${a}:`,l,i);const c={"google-cloud-resource-prefix":this.Wo,"x-goog-request-params":this.Go};this.Ho(c,s,o);const{host:u}=new URL(l),h=xi(u);return this.Jo(e,l,c,i,h).then(p=>(ue(Md,`Received RPC '${e}' ${a}: `,p),p),p=>{throw Tn(Md,`RPC '${e}' ${a} failed with error: `,p,"url: ",l,"request:",i),p})}Yo(e,t,i,s,o,a){return this.zo(e,t,i,s,o)}Ho(e,t,i){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Zs}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((s,o)=>e[o]=s),i&&i.headers.forEach((s,o)=>e[o]=s)}jo(e,t){const i=I_[e];return`${this.Ko}/v1/${t}:${i}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R_{constructor(e){this.Zo=e.Zo,this.Xo=e.Xo}e_(e){this.t_=e}n_(e){this.r_=e}i_(e){this.s_=e}onMessage(e){this.o_=e}close(){this.Xo()}send(e){this.Zo(e)}__(){this.t_()}a_(){this.r_()}u_(e){this.s_(e)}c_(e){this.o_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sn="WebChannelConnection";class A_ extends C_{constructor(e){super(e),this.l_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,i,s,o){const a=Fu();return new Promise((l,c)=>{const u=new kx;u.setWithCredentials(!0),u.listenOnce(Sx.COMPLETE,()=>{try{switch(u.getLastErrorCode()){case jl.NO_ERROR:const p=u.getResponseJson();ue(sn,`XHR for RPC '${e}' ${a} received:`,JSON.stringify(p)),l(p);break;case jl.TIMEOUT:ue(sn,`RPC '${e}' ${a} timed out`),c(new de(Z.DEADLINE_EXCEEDED,"Request time out"));break;case jl.HTTP_ERROR:const f=u.getStatus();if(ue(sn,`RPC '${e}' ${a} failed with status:`,f,"response text:",u.getResponseText()),f>0){let b=u.getResponseJson();Array.isArray(b)&&(b=b[0]);const x=b==null?void 0:b.error;if(x&&x.status&&x.message){const S=function(I){const j=I.toLowerCase().replace(/_/g,"-");return Object.values(Z).indexOf(j)>=0?j:Z.UNKNOWN}(x.status);c(new de(S,x.message))}else c(new de(Z.UNKNOWN,"Server responded with status "+u.getStatus()))}else c(new de(Z.UNAVAILABLE,"Connection failed."));break;default:Ae(9055,{h_:e,streamId:a,P_:u.getLastErrorCode(),T_:u.getLastError()})}}finally{ue(sn,`RPC '${e}' ${a} completed.`)}});const h=JSON.stringify(s);ue(sn,`RPC '${e}' ${a} sending request:`,s),u.send(t,"POST",h,i,15)})}I_(e,t,i){const s=Fu(),o=[this.Ko,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=_x(),l=jx(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(c.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(c.useFetchStreams=!0),this.Ho(c.initMessageHeaders,t,i),c.encodeInitMessageHeaders=!0;const h=o.join("");ue(sn,`Creating RPC '${e}' stream ${s}: ${h}`,c);const p=a.createWebChannel(h,c);this.E_(p);let f=!1,b=!1;const x=new R_({Zo:w=>{b?ue(sn,`Not sending because RPC '${e}' stream ${s} is closed:`,w):(f||(ue(sn,`Opening RPC '${e}' stream ${s} transport.`),p.open(),f=!0),ue(sn,`RPC '${e}' stream ${s} sending:`,w),p.send(w))},Xo:()=>p.close()}),S=(w,I,j)=>{w.listen(I,A=>{try{j(A)}catch(D){setTimeout(()=>{throw D},0)}})};return S(p,Mo.EventType.OPEN,()=>{b||(ue(sn,`RPC '${e}' stream ${s} transport opened.`),x.__())}),S(p,Mo.EventType.CLOSE,()=>{b||(b=!0,ue(sn,`RPC '${e}' stream ${s} transport closed`),x.u_(),this.d_(p))}),S(p,Mo.EventType.ERROR,w=>{b||(b=!0,Tn(sn,`RPC '${e}' stream ${s} transport errored. Name:`,w.name,"Message:",w.message),x.u_(new de(Z.UNAVAILABLE,"The operation could not be completed")))}),S(p,Mo.EventType.MESSAGE,w=>{var I;if(!b){const j=w.data[0];Pe(!!j,16349);const A=j,D=(A==null?void 0:A.error)||((I=A[0])===null||I===void 0?void 0:I.error);if(D){ue(sn,`RPC '${e}' stream ${s} received error:`,D);const O=D.status;let P=function(T){const R=Mt[T];if(R!==void 0)return Ab(R)}(O),B=D.message;P===void 0&&(P=Z.INTERNAL,B="Unknown error status: "+O+" with message "+D.message),b=!0,x.u_(new de(P,B)),p.close()}else ue(sn,`RPC '${e}' stream ${s} received:`,j),x.c_(j)}}),S(l,Tx.STAT_EVENT,w=>{w.stat===uu.PROXY?ue(sn,`RPC '${e}' stream ${s} detected buffering proxy`):w.stat===uu.NOPROXY&&ue(sn,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{x.a_()},0),x}terminate(){this.l_.forEach(e=>e.close()),this.l_=[]}E_(e){this.l_.push(e)}d_(e){this.l_=this.l_.filter(t=>t===e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function x0(){return typeof window<"u"?window:null}function Fl(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ra(n){return new Dj(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dh{constructor(e,t,i=1e3,s=1.5,o=6e4){this.xi=e,this.timerId=t,this.A_=i,this.R_=s,this.V_=o,this.m_=0,this.f_=null,this.g_=Date.now(),this.reset()}reset(){this.m_=0}p_(){this.m_=this.V_}y_(e){this.cancel();const t=Math.floor(this.m_+this.w_()),i=Math.max(0,Date.now()-this.g_),s=Math.max(0,t-i);s>0&&ue("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.m_} ms, delay with jitter: ${t} ms, last attempt: ${i} ms ago)`),this.f_=this.xi.enqueueAfterDelay(this.timerId,s,()=>(this.g_=Date.now(),e())),this.m_*=this.R_,this.m_<this.A_&&(this.m_=this.A_),this.m_>this.V_&&(this.m_=this.V_)}b_(){this.f_!==null&&(this.f_.skipDelay(),this.f_=null)}cancel(){this.f_!==null&&(this.f_.cancel(),this.f_=null)}w_(){return(Math.random()-.5)*this.m_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ug="PersistentStream";class b0{constructor(e,t,i,s,o,a,l,c){this.xi=e,this.S_=i,this.D_=s,this.connection=o,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=l,this.listener=c,this.state=0,this.v_=0,this.C_=null,this.F_=null,this.stream=null,this.M_=0,this.x_=new Dh(e,t)}O_(){return this.state===1||this.state===5||this.N_()}N_(){return this.state===2||this.state===3}start(){this.M_=0,this.state!==4?this.auth():this.B_()}async stop(){this.O_()&&await this.close(0)}L_(){this.state=0,this.x_.reset()}k_(){this.N_()&&this.C_===null&&(this.C_=this.xi.enqueueAfterDelay(this.S_,6e4,()=>this.q_()))}Q_(e){this.U_(),this.stream.send(e)}async q_(){if(this.N_())return this.close(0)}U_(){this.C_&&(this.C_.cancel(),this.C_=null)}K_(){this.F_&&(this.F_.cancel(),this.F_=null)}async close(e,t){this.U_(),this.K_(),this.x_.cancel(),this.v_++,e!==4?this.x_.reset():t&&t.code===Z.RESOURCE_EXHAUSTED?(zt(t.toString()),zt("Using maximum backoff delay to prevent overloading the backend."),this.x_.p_()):t&&t.code===Z.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.i_(t)}W_(){}auth(){this.state=1;const e=this.G_(this.v_),t=this.v_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([i,s])=>{this.v_===t&&this.z_(i,s)},i=>{e(()=>{const s=new de(Z.UNKNOWN,"Fetching auth token failed: "+i.message);return this.j_(s)})})}z_(e,t){const i=this.G_(this.v_);this.stream=this.H_(e,t),this.stream.e_(()=>{i(()=>this.listener.e_())}),this.stream.n_(()=>{i(()=>(this.state=2,this.F_=this.xi.enqueueAfterDelay(this.D_,1e4,()=>(this.N_()&&(this.state=3),Promise.resolve())),this.listener.n_()))}),this.stream.i_(s=>{i(()=>this.j_(s))}),this.stream.onMessage(s=>{i(()=>++this.M_==1?this.J_(s):this.onNext(s))})}B_(){this.state=5,this.x_.y_(async()=>{this.state=0,this.start()})}j_(e){return ue(Ug,`close with error: ${e}`),this.stream=null,this.close(4,e)}G_(e){return t=>{this.xi.enqueueAndForget(()=>this.v_===e?t():(ue(Ug,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class E_ extends b0{constructor(e,t,i,s,o,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,i,s,a),this.serializer=o}H_(e,t){return this.connection.I_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.x_.reset();const t=Wj(this.serializer,e),i=function(o){if(!("targetChange"in o))return De.min();const a=o.targetChange;return a.targetIds&&a.targetIds.length?De.min():a.readTime?Dt(a.readTime):De.min()}(e);return this.listener.Y_(t,i)}Z_(e){const t={};t.database=Cu(this.serializer),t.addTarget=function(o,a){let l;const c=a.target;if(l=Ql(c)?{documents:Wb(o,c)}:{query:Nc(o,c).gt},l.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){l.resumeToken=Pb(o,a.resumeToken);const u=_u(o,a.expectedCount);u!==null&&(l.expectedCount=u)}else if(a.snapshotVersion.compareTo(De.min())>0){l.readTime=Ws(o,a.snapshotVersion.toTimestamp());const u=_u(o,a.expectedCount);u!==null&&(l.expectedCount=u)}return l}(this.serializer,e);const i=Oj(this.serializer,e);i&&(t.labels=i),this.Q_(t)}X_(e){const t={};t.database=Cu(this.serializer),t.removeTarget=e,this.Q_(t)}}class B_ extends b0{constructor(e,t,i,s,o,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,i,s,a),this.serializer=o}get ea(){return this.M_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.ea&&this.ta([])}H_(e,t){return this.connection.I_("Write",e,t)}J_(e){return Pe(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Pe(!e.writeResults||e.writeResults.length===0,55816),this.listener.na()}onNext(e){Pe(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.x_.reset();const t=Lj(e.writeResults,e.commitTime),i=Dt(e.commitTime);return this.listener.ra(i,t)}ia(){const e={};e.database=Cu(this.serializer),this.Q_(e)}ta(e){const t={streamToken:this.lastStreamToken,writes:e.map(i=>ma(this.serializer,i))};this.Q_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P_{}class F_ extends P_{constructor(e,t,i,s){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=i,this.serializer=s,this.sa=!1}oa(){if(this.sa)throw new de(Z.FAILED_PRECONDITION,"The client has already been terminated.")}zo(e,t,i,s){return this.oa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.zo(e,Iu(t,i),s,o,a)).catch(o=>{throw o.name==="FirebaseError"?(o.code===Z.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new de(Z.UNKNOWN,o.toString())})}Yo(e,t,i,s,o){return this.oa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,l])=>this.connection.Yo(e,Iu(t,i),s,a,l,o)).catch(a=>{throw a.name==="FirebaseError"?(a.code===Z.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new de(Z.UNKNOWN,a.toString())})}terminate(){this.sa=!0,this.connection.terminate()}}class z_{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this._a=0,this.aa=null,this.ua=!0}ca(){this._a===0&&(this.la("Unknown"),this.aa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.aa=null,this.ha("Backend didn't respond within 10 seconds."),this.la("Offline"),Promise.resolve())))}Pa(e){this.state==="Online"?this.la("Unknown"):(this._a++,this._a>=1&&(this.Ta(),this.ha(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.la("Offline")))}set(e){this.Ta(),this._a=0,e==="Online"&&(this.ua=!1),this.la(e)}la(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ha(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.ua?(zt(t),this.ua=!1):ue("OnlineStateTracker",t)}Ta(){this.aa!==null&&(this.aa.cancel(),this.aa=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vr="RemoteStore";class D_{constructor(e,t,i,s,o){this.localStore=e,this.datastore=t,this.asyncQueue=i,this.remoteSyncer={},this.Ia=[],this.Ea=new Map,this.da=new Set,this.Aa=[],this.Ra=o,this.Ra.No(a=>{i.enqueueAndForget(async()=>{or(this)&&(ue(Vr,"Restarting streams for network reachability change."),await async function(c){const u=ke(c);u.da.add(4),await io(u),u.Va.set("Unknown"),u.da.delete(4),await Aa(u)}(this))})}),this.Va=new z_(i,s)}}async function Aa(n){if(or(n))for(const e of n.Aa)await e(!0)}async function io(n){for(const e of n.Aa)await e(!1)}function Oc(n,e){const t=ke(n);t.Ea.has(e.targetId)||(t.Ea.set(e.targetId,e),Wh(t)?Mh(t):so(t).N_()&&Nh(t,e))}function Vs(n,e){const t=ke(n),i=so(t);t.Ea.delete(e),i.N_()&&v0(t,e),t.Ea.size===0&&(i.N_()?i.k_():or(t)&&t.Va.set("Unknown"))}function Nh(n,e){if(n.ma.Ke(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(De.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}so(n).Z_(e)}function v0(n,e){n.ma.Ke(e),so(n).X_(e)}function Mh(n){n.ma=new Bj({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),Rt:e=>n.Ea.get(e)||null,Pt:()=>n.datastore.serializer.databaseId}),so(n).start(),n.Va.ca()}function Wh(n){return or(n)&&!so(n).O_()&&n.Ea.size>0}function or(n){return ke(n).da.size===0}function w0(n){n.ma=void 0}async function N_(n){n.Va.set("Online")}async function M_(n){n.Ea.forEach((e,t)=>{Nh(n,e)})}async function W_(n,e){w0(n),Wh(n)?(n.Va.Pa(e),Mh(n)):n.Va.set("Unknown")}async function L_(n,e,t){if(n.Va.set("Online"),e instanceof Bb&&e.state===2&&e.cause)try{await async function(s,o){const a=o.cause;for(const l of o.targetIds)s.Ea.has(l)&&(await s.remoteSyncer.rejectListen(l,a),s.Ea.delete(l),s.ma.removeTarget(l))}(n,e)}catch(i){ue(Vr,"Failed to remove targets %s: %s ",e.targetIds.join(","),i),await oc(n,i)}else if(e instanceof Bl?n.ma.Xe(e):e instanceof Eb?n.ma.ot(e):n.ma.nt(e),!t.isEqual(De.min()))try{const i=await c0(n.localStore);t.compareTo(i)>=0&&await function(o,a){const l=o.ma.It(a);return l.targetChanges.forEach((c,u)=>{if(c.resumeToken.approximateByteSize()>0){const h=o.Ea.get(u);h&&o.Ea.set(u,h.withResumeToken(c.resumeToken,a))}}),l.targetMismatches.forEach((c,u)=>{const h=o.Ea.get(c);if(!h)return;o.Ea.set(c,h.withResumeToken(At.EMPTY_BYTE_STRING,h.snapshotVersion)),v0(o,c);const p=new li(h.target,c,u,h.sequenceNumber);Nh(o,p)}),o.remoteSyncer.applyRemoteEvent(l)}(n,t)}catch(i){ue(Vr,"Failed to raise snapshot:",i),await oc(n,i)}}async function oc(n,e,t){if(!rr(e))throw e;n.da.add(1),await io(n),n.Va.set("Offline"),t||(t=()=>c0(n.localStore)),n.asyncQueue.enqueueRetryable(async()=>{ue(Vr,"Retrying IndexedDB access"),await t(),n.da.delete(1),await Aa(n)})}function k0(n,e){return e().catch(t=>oc(n,t,e))}async function ro(n){const e=ke(n),t=Zi(e);let i=e.Ia.length>0?e.Ia[e.Ia.length-1].batchId:Hi;for(;O_(e);)try{const s=await S_(e.localStore,i);if(s===null){e.Ia.length===0&&t.k_();break}i=s.batchId,V_(e,s)}catch(s){await oc(e,s)}S0(e)&&T0(e)}function O_(n){return or(n)&&n.Ia.length<10}function V_(n,e){n.Ia.push(e);const t=Zi(n);t.N_()&&t.ea&&t.ta(e.mutations)}function S0(n){return or(n)&&!Zi(n).O_()&&n.Ia.length>0}function T0(n){Zi(n).start()}async function q_(n){Zi(n).ia()}async function U_(n){const e=Zi(n);for(const t of n.Ia)e.ta(t.mutations)}async function H_(n,e,t){const i=n.Ia.shift(),s=kh.from(i,e,t);await k0(n,()=>n.remoteSyncer.applySuccessfulWrite(s)),await ro(n)}async function $_(n,e){e&&Zi(n).ea&&await async function(i,s){if(function(a){return Rb(a)&&a!==Z.ABORTED}(s.code)){const o=i.Ia.shift();Zi(i).L_(),await k0(i,()=>i.remoteSyncer.rejectFailedWrite(o.batchId,s)),await ro(i)}}(n,e),S0(n)&&T0(n)}async function Hg(n,e){const t=ke(n);t.asyncQueue.verifyOperationInProgress(),ue(Vr,"RemoteStore received new credentials");const i=or(t);t.da.add(3),await io(t),i&&t.Va.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.da.delete(3),await Aa(t)}async function zu(n,e){const t=ke(n);e?(t.da.delete(2),await Aa(t)):e||(t.da.add(2),await io(t),t.Va.set("Unknown"))}function so(n){return n.fa||(n.fa=function(t,i,s){const o=ke(t);return o.oa(),new E_(i,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,s)}(n.datastore,n.asyncQueue,{e_:N_.bind(null,n),n_:M_.bind(null,n),i_:W_.bind(null,n),Y_:L_.bind(null,n)}),n.Aa.push(async e=>{e?(n.fa.L_(),Wh(n)?Mh(n):n.Va.set("Unknown")):(await n.fa.stop(),w0(n))})),n.fa}function Zi(n){return n.ga||(n.ga=function(t,i,s){const o=ke(t);return o.oa(),new B_(i,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,s)}(n.datastore,n.asyncQueue,{e_:()=>Promise.resolve(),n_:q_.bind(null,n),i_:$_.bind(null,n),na:U_.bind(null,n),ra:H_.bind(null,n)}),n.Aa.push(async e=>{e?(n.ga.L_(),await ro(n)):(await n.ga.stop(),n.Ia.length>0&&(ue(Vr,`Stopping write stream with ${n.Ia.length} pending writes`),n.Ia=[]))})),n.ga}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lh{constructor(e,t,i,s,o){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=i,this.op=s,this.removalCallback=o,this.deferred=new Qt,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,i,s,o){const a=Date.now()+i,l=new Lh(e,t,a,s,o);return l.start(i),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new de(Z.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function oo(n,e){if(zt("AsyncQueue",`${e}: ${n}`),rr(n))return new de(Z.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ws{static emptySet(e){return new ws(e.comparator)}constructor(e){this.comparator=e?(t,i)=>e(t,i)||Te.comparator(t.key,i.key):(t,i)=>Te.comparator(t.key,i.key),this.keyedMap=Wo(),this.sortedSet=new vt(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,i)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof ws)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;t.hasNext();){const s=t.getNext().key,o=i.getNext().key;if(!s.isEqual(o))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const i=new ws;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=t,i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $g{constructor(){this.pa=new vt(Te.comparator)}track(e){const t=e.doc.key,i=this.pa.get(t);i?e.type!==0&&i.type===3?this.pa=this.pa.insert(t,e):e.type===3&&i.type!==1?this.pa=this.pa.insert(t,{type:i.type,doc:e.doc}):e.type===2&&i.type===2?this.pa=this.pa.insert(t,{type:2,doc:e.doc}):e.type===2&&i.type===0?this.pa=this.pa.insert(t,{type:0,doc:e.doc}):e.type===1&&i.type===0?this.pa=this.pa.remove(t):e.type===1&&i.type===2?this.pa=this.pa.insert(t,{type:1,doc:i.doc}):e.type===0&&i.type===1?this.pa=this.pa.insert(t,{type:2,doc:e.doc}):Ae(63341,{Vt:e,ya:i}):this.pa=this.pa.insert(t,e)}wa(){const e=[];return this.pa.inorderTraversal((t,i)=>{e.push(i)}),e}}class qs{constructor(e,t,i,s,o,a,l,c,u){this.query=e,this.docs=t,this.oldDocs=i,this.docChanges=s,this.mutatedKeys=o,this.fromCache=a,this.syncStateChanged=l,this.excludesMetadataChanges=c,this.hasCachedResults=u}static fromInitialDocuments(e,t,i,s,o){const a=[];return t.forEach(l=>{a.push({type:0,doc:l})}),new qs(e,t,ws.emptySet(t),a,i,s,!0,!1,o)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Ta(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,i=e.docChanges;if(t.length!==i.length)return!1;for(let s=0;s<t.length;s++)if(t[s].type!==i[s].type||!t[s].doc.isEqual(i[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G_{constructor(){this.ba=void 0,this.Sa=[]}Da(){return this.Sa.some(e=>e.va())}}class K_{constructor(){this.queries=Gg(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,i){const s=ke(t),o=s.queries;s.queries=Gg(),o.forEach((a,l)=>{for(const c of l.Sa)c.onError(i)})})(this,new de(Z.ABORTED,"Firestore shutting down"))}}function Gg(){return new vi(n=>mb(n),Ta)}async function Oh(n,e){const t=ke(n);let i=3;const s=e.query;let o=t.queries.get(s);o?!o.Da()&&e.va()&&(i=2):(o=new G_,i=e.va()?0:1);try{switch(i){case 0:o.ba=await t.onListen(s,!0);break;case 1:o.ba=await t.onListen(s,!1);break;case 2:await t.onFirstRemoteStoreListen(s)}}catch(a){const l=oo(a,`Initialization of query '${fs(e.query)}' failed`);return void e.onError(l)}t.queries.set(s,o),o.Sa.push(e),e.Fa(t.onlineState),o.ba&&e.Ma(o.ba)&&qh(t)}async function Vh(n,e){const t=ke(n),i=e.query;let s=3;const o=t.queries.get(i);if(o){const a=o.Sa.indexOf(e);a>=0&&(o.Sa.splice(a,1),o.Sa.length===0?s=e.va()?0:1:!o.Da()&&e.va()&&(s=2))}switch(s){case 0:return t.queries.delete(i),t.onUnlisten(i,!0);case 1:return t.queries.delete(i),t.onUnlisten(i,!1);case 2:return t.onLastRemoteStoreUnlisten(i);default:return}}function Q_(n,e){const t=ke(n);let i=!1;for(const s of e){const o=s.query,a=t.queries.get(o);if(a){for(const l of a.Sa)l.Ma(s)&&(i=!0);a.ba=s}}i&&qh(t)}function Y_(n,e,t){const i=ke(n),s=i.queries.get(e);if(s)for(const o of s.Sa)o.onError(t);i.queries.delete(e)}function qh(n){n.Ca.forEach(e=>{e.next()})}var Du,Kg;(Kg=Du||(Du={})).xa="default",Kg.Cache="cache";class Uh{constructor(e,t,i){this.query=e,this.Oa=t,this.Na=!1,this.Ba=null,this.onlineState="Unknown",this.options=i||{}}Ma(e){if(!this.options.includeMetadataChanges){const i=[];for(const s of e.docChanges)s.type!==3&&i.push(s);e=new qs(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Na?this.La(e)&&(this.Oa.next(e),t=!0):this.ka(e,this.onlineState)&&(this.qa(e),t=!0),this.Ba=e,t}onError(e){this.Oa.error(e)}Fa(e){this.onlineState=e;let t=!1;return this.Ba&&!this.Na&&this.ka(this.Ba,e)&&(this.qa(this.Ba),t=!0),t}ka(e,t){if(!e.fromCache||!this.va())return!0;const i=t!=="Offline";return(!this.options.Qa||!i)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}La(e){if(e.docChanges.length>0)return!0;const t=this.Ba&&this.Ba.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}qa(e){e=qs.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Na=!0,this.Oa.next(e)}va(){return this.options.source!==Du.Cache}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X_{constructor(e,t){this.$a=e,this.byteLength=t}Ua(){return"metadata"in this.$a}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qg{constructor(e){this.serializer=e}Us(e){return Gn(this.serializer,e)}Ks(e){return e.metadata.exists?Mb(this.serializer,e.document,!1):kt.newNoDocument(this.Us(e.metadata.name),this.Ws(e.metadata.readTime))}Ws(e){return Dt(e)}}class J_{constructor(e,t,i){this.Ka=e,this.localStore=t,this.serializer=i,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=j0(e)}Wa(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.$a.namedQuery)this.queries.push(e.$a.namedQuery);else if(e.$a.documentMetadata){this.documents.push({metadata:e.$a.documentMetadata}),e.$a.documentMetadata.exists||++t;const i=nt.fromString(e.$a.documentMetadata.name);this.collectionGroups.add(i.get(i.length-2))}else e.$a.document&&(this.documents[this.documents.length-1].document=e.$a.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}Ga(e){const t=new Map,i=new Qg(this.serializer);for(const s of e)if(s.metadata.queries){const o=i.Us(s.metadata.name);for(const a of s.metadata.queries){const l=(t.get(a)||Ke()).add(o);t.set(a,l)}}return t}async complete(){const e=await T_(this.localStore,new Qg(this.serializer),this.documents,this.Ka.id),t=this.Ga(this.documents);for(const i of this.queries)await j_(this.localStore,i,t.get(i.name));return this.progress.taskState="Success",{progress:this.progress,za:this.collectionGroups,ja:e}}}function j0(n){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:n.totalDocuments,totalBytes:n.totalBytes}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _0{constructor(e){this.key=e}}class I0{constructor(e){this.key=e}}class C0{constructor(e,t){this.query=e,this.Ha=t,this.Ja=null,this.hasCachedResults=!1,this.current=!1,this.Ya=Ke(),this.mutatedKeys=Ke(),this.Za=fb(e),this.Xa=new ws(this.Za)}get eu(){return this.Ha}tu(e,t){const i=t?t.nu:new $g,s=t?t.Xa:this.Xa;let o=t?t.mutatedKeys:this.mutatedKeys,a=s,l=!1;const c=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,u=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((h,p)=>{const f=s.get(h),b=ja(this.query,p)?p:null,x=!!f&&this.mutatedKeys.has(f.key),S=!!b&&(b.hasLocalMutations||this.mutatedKeys.has(b.key)&&b.hasCommittedMutations);let w=!1;f&&b?f.data.isEqual(b.data)?x!==S&&(i.track({type:3,doc:b}),w=!0):this.ru(f,b)||(i.track({type:2,doc:b}),w=!0,(c&&this.Za(b,c)>0||u&&this.Za(b,u)<0)&&(l=!0)):!f&&b?(i.track({type:0,doc:b}),w=!0):f&&!b&&(i.track({type:1,doc:f}),w=!0,(c||u)&&(l=!0)),w&&(b?(a=a.add(b),o=S?o.add(h):o.delete(h)):(a=a.delete(h),o=o.delete(h)))}),this.query.limit!==null)for(;a.size>this.query.limit;){const h=this.query.limitType==="F"?a.last():a.first();a=a.delete(h.key),o=o.delete(h.key),i.track({type:1,doc:h})}return{Xa:a,nu:i,Cs:l,mutatedKeys:o}}ru(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,i,s){const o=this.Xa;this.Xa=e.Xa,this.mutatedKeys=e.mutatedKeys;const a=e.nu.wa();a.sort((h,p)=>function(b,x){const S=w=>{switch(w){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ae(20277,{Vt:w})}};return S(b)-S(x)}(h.type,p.type)||this.Za(h.doc,p.doc)),this.iu(i),s=s!=null&&s;const l=t&&!s?this.su():[],c=this.Ya.size===0&&this.current&&!s?1:0,u=c!==this.Ja;return this.Ja=c,a.length!==0||u?{snapshot:new qs(this.query,e.Xa,o,a,e.mutatedKeys,c===0,u,!1,!!i&&i.resumeToken.approximateByteSize()>0),ou:l}:{ou:l}}Fa(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Xa:this.Xa,nu:new $g,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{ou:[]}}_u(e){return!this.Ha.has(e)&&!!this.Xa.has(e)&&!this.Xa.get(e).hasLocalMutations}iu(e){e&&(e.addedDocuments.forEach(t=>this.Ha=this.Ha.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ha=this.Ha.delete(t)),this.current=e.current)}su(){if(!this.current)return[];const e=this.Ya;this.Ya=Ke(),this.Xa.forEach(i=>{this._u(i.key)&&(this.Ya=this.Ya.add(i.key))});const t=[];return e.forEach(i=>{this.Ya.has(i)||t.push(new I0(i))}),this.Ya.forEach(i=>{e.has(i)||t.push(new _0(i))}),t}au(e){this.Ha=e.$s,this.Ya=Ke();const t=this.tu(e.documents);return this.applyChanges(t,!0)}uu(){return qs.fromInitialDocuments(this.query,this.Xa,this.mutatedKeys,this.Ja===0,this.hasCachedResults)}}const ar="SyncEngine";class Z_{constructor(e,t,i){this.query=e,this.targetId=t,this.view=i}}class e2{constructor(e){this.key=e,this.cu=!1}}class t2{constructor(e,t,i,s,o,a){this.localStore=e,this.remoteStore=t,this.eventManager=i,this.sharedClientState=s,this.currentUser=o,this.maxConcurrentLimboResolutions=a,this.lu={},this.hu=new vi(l=>mb(l),Ta),this.Pu=new Map,this.Tu=new Set,this.Iu=new vt(Te.comparator),this.Eu=new Map,this.du=new Rh,this.Au={},this.Ru=new Map,this.Vu=Or.lr(),this.onlineState="Unknown",this.mu=void 0}get isPrimaryClient(){return this.mu===!0}}async function n2(n,e,t=!0){const i=Vc(n);let s;const o=i.hu.get(e);return o?(i.sharedClientState.addLocalQueryTarget(o.targetId),s=o.view.uu()):s=await R0(i,e,t,!0),s}async function i2(n,e){const t=Vc(n);await R0(t,e,!0,!1)}async function R0(n,e,t,i){const s=await Ls(n.localStore,cn(e)),o=s.targetId,a=n.sharedClientState.addLocalQueryTarget(o,t);let l;return i&&(l=await Hh(n,e,o,a==="current",s.resumeToken)),n.isPrimaryClient&&t&&Oc(n.remoteStore,s),l}async function Hh(n,e,t,i,s){n.fu=(p,f,b)=>async function(S,w,I,j){let A=w.view.tu(I);A.Cs&&(A=await ic(S.localStore,w.query,!1).then(({documents:B})=>w.view.tu(B,A)));const D=j&&j.targetChanges.get(w.targetId),O=j&&j.targetMismatches.get(w.targetId)!=null,P=w.view.applyChanges(A,S.isPrimaryClient,D,O);return Nu(S,w.targetId,P.ou),P.snapshot}(n,p,f,b);const o=await ic(n.localStore,e,!0),a=new C0(e,o.$s),l=a.tu(o.documents),c=Ca.createSynthesizedTargetChangeForCurrentChange(t,i&&n.onlineState!=="Offline",s),u=a.applyChanges(l,n.isPrimaryClient,c);Nu(n,t,u.ou);const h=new Z_(e,t,a);return n.hu.set(e,h),n.Pu.has(t)?n.Pu.get(t).push(e):n.Pu.set(t,[e]),u.snapshot}async function r2(n,e,t){const i=ke(n),s=i.hu.get(e),o=i.Pu.get(s.targetId);if(o.length>1)return i.Pu.set(s.targetId,o.filter(a=>!Ta(a,e))),void i.hu.delete(e);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(s.targetId),i.sharedClientState.isActiveQueryTarget(s.targetId)||await Os(i.localStore,s.targetId,!1).then(()=>{i.sharedClientState.clearQueryState(s.targetId),t&&Vs(i.remoteStore,s.targetId),Us(i,s.targetId)}).catch(ir)):(Us(i,s.targetId),await Os(i.localStore,s.targetId,!0))}async function s2(n,e){const t=ke(n),i=t.hu.get(e),s=t.Pu.get(i.targetId);t.isPrimaryClient&&s.length===1&&(t.sharedClientState.removeLocalQueryTarget(i.targetId),Vs(t.remoteStore,i.targetId))}async function o2(n,e,t){const i=Qh(n);try{const s=await function(a,l){const c=ke(a),u=xt.now(),h=l.reduce((b,x)=>b.add(x.key),Ke());let p,f;return c.persistence.runTransaction("Locally write mutations","readwrite",b=>{let x=yn(),S=Ke();return c.Bs.getEntries(b,h).next(w=>{x=w,x.forEach((I,j)=>{j.isValidDocument()||(S=S.add(I))})}).next(()=>c.localDocuments.getOverlayedDocuments(b,x)).next(w=>{p=w;const I=[];for(const j of l){const A=Rj(j,p.get(j.key).overlayedDocument);A!=null&&I.push(new wi(j.key,A,ib(A.value.mapValue),_t.exists(!0)))}return c.mutationQueue.addMutationBatch(b,u,I,l)}).next(w=>{f=w;const I=w.applyToLocalDocumentSet(p,S);return c.documentOverlayCache.saveOverlays(b,w.batchId,I)})}).then(()=>({batchId:f.batchId,changes:xb(p)}))}(i.localStore,e);i.sharedClientState.addPendingMutation(s.batchId),function(a,l,c){let u=a.Au[a.currentUser.toKey()];u||(u=new vt(Le)),u=u.insert(l,c),a.Au[a.currentUser.toKey()]=u}(i,s.batchId,t),await ki(i,s.changes),await ro(i.remoteStore)}catch(s){const o=oo(s,"Failed to persist write");t.reject(o)}}async function A0(n,e){const t=ke(n);try{const i=await k_(t.localStore,e);e.targetChanges.forEach((s,o)=>{const a=t.Eu.get(o);a&&(Pe(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1,22616),s.addedDocuments.size>0?a.cu=!0:s.modifiedDocuments.size>0?Pe(a.cu,14607):s.removedDocuments.size>0&&(Pe(a.cu,42227),a.cu=!1))}),await ki(t,i,e)}catch(i){await ir(i)}}function Yg(n,e,t){const i=ke(n);if(i.isPrimaryClient&&t===0||!i.isPrimaryClient&&t===1){const s=[];i.hu.forEach((o,a)=>{const l=a.view.Fa(e);l.snapshot&&s.push(l.snapshot)}),function(a,l){const c=ke(a);c.onlineState=l;let u=!1;c.queries.forEach((h,p)=>{for(const f of p.Sa)f.Fa(l)&&(u=!0)}),u&&qh(c)}(i.eventManager,e),s.length&&i.lu.Y_(s),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function a2(n,e,t){const i=ke(n);i.sharedClientState.updateQueryState(e,"rejected",t);const s=i.Eu.get(e),o=s&&s.key;if(o){let a=new vt(Te.comparator);a=a.insert(o,kt.newNoDocument(o,De.min()));const l=Ke().add(o),c=new Ia(De.min(),new Map,new vt(Le),a,l);await A0(i,c),i.Iu=i.Iu.remove(o),i.Eu.delete(e),Kh(i)}else await Os(i.localStore,e,!1).then(()=>Us(i,e,t)).catch(ir)}async function l2(n,e){const t=ke(n),i=e.batch.batchId;try{const s=await w_(t.localStore,e);Gh(t,i,null),$h(t,i),t.sharedClientState.updateMutationState(i,"acknowledged"),await ki(t,s)}catch(s){await ir(s)}}async function c2(n,e,t){const i=ke(n);try{const s=await function(a,l){const c=ke(a);return c.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let h;return c.mutationQueue.lookupMutationBatch(u,l).next(p=>(Pe(p!==null,37113),h=p.keys(),c.mutationQueue.removeMutationBatch(u,p))).next(()=>c.mutationQueue.performConsistencyCheck(u)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(u,h,l)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,h)).next(()=>c.localDocuments.getDocuments(u,h))})}(i.localStore,e);Gh(i,e,t),$h(i,e),i.sharedClientState.updateMutationState(e,"rejected",t),await ki(i,s)}catch(s){await ir(s)}}async function d2(n,e){const t=ke(n);or(t.remoteStore)||ue(ar,"The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const i=await function(a){const l=ke(a);return l.persistence.runTransaction("Get highest unacknowledged batch id","readonly",c=>l.mutationQueue.getHighestUnacknowledgedBatchId(c))}(t.localStore);if(i===Hi)return void e.resolve();const s=t.Ru.get(i)||[];s.push(e),t.Ru.set(i,s)}catch(i){const s=oo(i,"Initialization of waitForPendingWrites() operation failed");e.reject(s)}}function $h(n,e){(n.Ru.get(e)||[]).forEach(t=>{t.resolve()}),n.Ru.delete(e)}function Gh(n,e,t){const i=ke(n);let s=i.Au[i.currentUser.toKey()];if(s){const o=s.get(e);o&&(t?o.reject(t):o.resolve(),s=s.remove(e)),i.Au[i.currentUser.toKey()]=s}}function Us(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const i of n.Pu.get(e))n.hu.delete(i),t&&n.lu.gu(i,t);n.Pu.delete(e),n.isPrimaryClient&&n.du.Hr(e).forEach(i=>{n.du.containsKey(i)||E0(n,i)})}function E0(n,e){n.Tu.delete(e.path.canonicalString());const t=n.Iu.get(e);t!==null&&(Vs(n.remoteStore,t),n.Iu=n.Iu.remove(e),n.Eu.delete(t),Kh(n))}function Nu(n,e,t){for(const i of t)i instanceof _0?(n.du.addReference(i.key,e),u2(n,i)):i instanceof I0?(ue(ar,"Document no longer in limbo: "+i.key),n.du.removeReference(i.key,e),n.du.containsKey(i.key)||E0(n,i.key)):Ae(19791,{pu:i})}function u2(n,e){const t=e.key,i=t.path.canonicalString();n.Iu.get(t)||n.Tu.has(i)||(ue(ar,"New document in limbo: "+t),n.Tu.add(i),Kh(n))}function Kh(n){for(;n.Tu.size>0&&n.Iu.size<n.maxConcurrentLimboResolutions;){const e=n.Tu.values().next().value;n.Tu.delete(e);const t=new Te(nt.fromString(e)),i=n.Vu.next();n.Eu.set(i,new e2(t)),n.Iu=n.Iu.insert(t,i),Oc(n.remoteStore,new li(cn(eo(t.path)),i,"TargetPurposeLimboResolution",gn.le))}}async function ki(n,e,t){const i=ke(n),s=[],o=[],a=[];i.hu.isEmpty()||(i.hu.forEach((l,c)=>{a.push(i.fu(c,e,t).then(u=>{var h;if((u||t)&&i.isPrimaryClient){const p=u?!u.fromCache:(h=t==null?void 0:t.targetChanges.get(c.targetId))===null||h===void 0?void 0:h.current;i.sharedClientState.updateQueryState(c.targetId,p?"current":"not-current")}if(u){s.push(u);const p=Ph.Rs(c.targetId,u);o.push(p)}}))}),await Promise.all(a),i.lu.Y_(s),await async function(c,u){const h=ke(c);try{await h.persistence.runTransaction("notifyLocalViewChanges","readwrite",p=>K.forEach(u,f=>K.forEach(f.ds,b=>h.persistence.referenceDelegate.addReference(p,f.targetId,b)).next(()=>K.forEach(f.As,b=>h.persistence.referenceDelegate.removeReference(p,f.targetId,b)))))}catch(p){if(!rr(p))throw p;ue(Fh,"Failed to update sequence numbers: "+p)}for(const p of u){const f=p.targetId;if(!p.fromCache){const b=h.xs.get(f),x=b.snapshotVersion,S=b.withLastLimboFreeSnapshotVersion(x);h.xs=h.xs.insert(f,S)}}}(i.localStore,o))}async function h2(n,e){const t=ke(n);if(!t.currentUser.isEqual(e)){ue(ar,"User change. New user:",e.toKey());const i=await l0(t.localStore,e);t.currentUser=e,function(o,a){o.Ru.forEach(l=>{l.forEach(c=>{c.reject(new de(Z.CANCELLED,a))})}),o.Ru.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),await ki(t,i.ks)}}function p2(n,e){const t=ke(n),i=t.Eu.get(e);if(i&&i.cu)return Ke().add(i.key);{let s=Ke();const o=t.Pu.get(e);if(!o)return s;for(const a of o){const l=t.hu.get(a);s=s.unionWith(l.view.eu)}return s}}async function m2(n,e){const t=ke(n),i=await ic(t.localStore,e.query,!0),s=e.view.au(i);return t.isPrimaryClient&&Nu(t,e.targetId,s.ou),s}async function g2(n,e){const t=ke(n);return h0(t.localStore,e).then(i=>ki(t,i))}async function f2(n,e,t,i){const s=ke(n),o=await function(l,c){const u=ke(l),h=ke(u.mutationQueue);return u.persistence.runTransaction("Lookup mutation documents","readonly",p=>h.tr(p,c).next(f=>f?u.localDocuments.getDocuments(p,f):K.resolve(null)))}(s.localStore,e);o!==null?(t==="pending"?await ro(s.remoteStore):t==="acknowledged"||t==="rejected"?(Gh(s,e,i||null),$h(s,e),function(l,c){ke(ke(l).mutationQueue).sr(c)}(s.localStore,e)):Ae(6720,"Unknown batchState",{yu:t}),await ki(s,o)):ue(ar,"Cannot apply mutation batch with id: "+e)}async function y2(n,e){const t=ke(n);if(Vc(t),Qh(t),e===!0&&t.mu!==!0){const i=t.sharedClientState.getAllActiveQueryTargets(),s=await Xg(t,i.toArray());t.mu=!0,await zu(t.remoteStore,!0);for(const o of s)Oc(t.remoteStore,o)}else if(e===!1&&t.mu!==!1){const i=[];let s=Promise.resolve();t.Pu.forEach((o,a)=>{t.sharedClientState.isLocalQueryTarget(a)?i.push(a):s=s.then(()=>(Us(t,a),Os(t.localStore,a,!0))),Vs(t.remoteStore,a)}),await s,await Xg(t,i),function(a){const l=ke(a);l.Eu.forEach((c,u)=>{Vs(l.remoteStore,u)}),l.du.Jr(),l.Eu=new Map,l.Iu=new vt(Te.comparator)}(t),t.mu=!1,await zu(t.remoteStore,!1)}}async function Xg(n,e,t){const i=ke(n),s=[],o=[];for(const a of e){let l;const c=i.Pu.get(a);if(c&&c.length!==0){l=await Ls(i.localStore,cn(c[0]));for(const u of c){const h=i.hu.get(u),p=await m2(i,h);p.snapshot&&o.push(p.snapshot)}}else{const u=await u0(i.localStore,a);l=await Ls(i.localStore,u),await Hh(i,B0(u),a,!1,l.resumeToken)}s.push(l)}return i.lu.Y_(o),s}function B0(n){return ub(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function x2(n){return function(t){return ke(ke(t).persistence).Is()}(ke(n).localStore)}async function b2(n,e,t,i){const s=ke(n);if(s.mu)return void ue(ar,"Ignoring unexpected query state notification.");const o=s.Pu.get(e);if(o&&o.length>0)switch(t){case"current":case"not-current":{const a=await h0(s.localStore,gb(o[0])),l=Ia.createSynthesizedRemoteEventForCurrentChange(e,t==="current",At.EMPTY_BYTE_STRING);await ki(s,a,l);break}case"rejected":await Os(s.localStore,e,!0),Us(s,e,i);break;default:Ae(64155,t)}}async function v2(n,e,t){const i=Vc(n);if(i.mu){for(const s of e){if(i.Pu.has(s)&&i.sharedClientState.isActiveQueryTarget(s)){ue(ar,"Adding an already active target "+s);continue}const o=await u0(i.localStore,s),a=await Ls(i.localStore,o);await Hh(i,B0(o),a.targetId,!1,a.resumeToken),Oc(i.remoteStore,a)}for(const s of t)i.Pu.has(s)&&await Os(i.localStore,s,!1).then(()=>{Vs(i.remoteStore,s),Us(i,s)}).catch(ir)}}function Vc(n){const e=ke(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=A0.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=p2.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=a2.bind(null,e),e.lu.Y_=Q_.bind(null,e.eventManager),e.lu.gu=Y_.bind(null,e.eventManager),e}function Qh(n){const e=ke(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=l2.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=c2.bind(null,e),e}function w2(n,e,t){const i=ke(n);(async function(o,a,l){try{const c=await a.getMetadata();if(await function(b,x){const S=ke(b),w=Dt(x.createTime);return S.persistence.runTransaction("hasNewerBundle","readonly",I=>S.Ei.getBundleMetadata(I,x.id)).then(I=>!!I&&I.createTime.compareTo(w)>=0)}(o.localStore,c))return await a.close(),l._completeWith(function(b){return{taskState:"Success",documentsLoaded:b.totalDocuments,bytesLoaded:b.totalBytes,totalDocuments:b.totalDocuments,totalBytes:b.totalBytes}}(c)),Promise.resolve(new Set);l._updateProgress(j0(c));const u=new J_(c,o.localStore,a.serializer);let h=await a.wu();for(;h;){const f=await u.Wa(h);f&&l._updateProgress(f),h=await a.wu()}const p=await u.complete();return await ki(o,p.ja,void 0),await function(b,x){const S=ke(b);return S.persistence.runTransaction("Save bundle","readwrite",w=>S.Ei.saveBundleMetadata(w,x))}(o.localStore,c),l._completeWith(p.progress),Promise.resolve(p.za)}catch(c){return Tn(ar,`Loading bundle failed with ${c}`),l._failWith(c),Promise.resolve(new Set)}})(i,e,t).then(s=>{i.sharedClientState.notifyBundleLoaded(s)})}class Hs{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Ra(e.databaseInfo.databaseId),this.sharedClientState=this.bu(e),this.persistence=this.Su(e),await this.persistence.start(),this.localStore=this.Du(e),this.gcScheduler=this.vu(e,this.localStore),this.indexBackfillerScheduler=this.Cu(e,this.localStore)}vu(e,t){return null}Cu(e,t){return null}Du(e){return a0(this.persistence,new o0,e.initialUser,this.serializer)}Su(e){return new Ah(Lc.fi,this.serializer)}bu(e){return new y0}async terminate(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Hs.provider={build:()=>new Hs};class Yh extends Hs{constructor(e){super(),this.cacheSizeBytes=e}vu(e,t){Pe(this.persistence.referenceDelegate instanceof nc,46915);const i=this.persistence.referenceDelegate.garbageCollector;return new e0(i,e.asyncQueue,t)}Su(e){const t=this.cacheSizeBytes!==void 0?on.withCacheSize(this.cacheSizeBytes):on.DEFAULT;return new Ah(i=>nc.fi(i,t),this.serializer)}}class Xh extends Hs{constructor(e,t,i){super(),this.Fu=e,this.cacheSizeBytes=t,this.forceOwnership=i,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.Fu.initialize(this,e),await Qh(this.Fu.syncEngine),await ro(this.Fu.remoteStore),await this.persistence.Ji(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}Du(e){return a0(this.persistence,new o0,e.initialUser,this.serializer)}vu(e,t){const i=this.persistence.referenceDelegate.garbageCollector;return new e0(i,e.asyncQueue,t)}Cu(e,t){const i=new PT(t,this.persistence);return new BT(e.asyncQueue,i)}Su(e){const t=Bh(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),i=this.cacheSizeBytes!==void 0?on.withCacheSize(this.cacheSizeBytes):on.DEFAULT;return new Eh(this.synchronizeTabs,t,e.clientId,i,e.asyncQueue,x0(),Fl(),this.serializer,this.sharedClientState,!!this.forceOwnership)}bu(e){return new y0}}class P0 extends Xh{constructor(e,t){super(e,t,!1),this.Fu=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const t=this.Fu.syncEngine;this.sharedClientState instanceof Nd&&(this.sharedClientState.syncEngine={Co:f2.bind(null,t),Fo:b2.bind(null,t),Mo:v2.bind(null,t),Is:x2.bind(null,t),vo:g2.bind(null,t)},await this.sharedClientState.start()),await this.persistence.Ji(async i=>{await y2(this.Fu.syncEngine,i),this.gcScheduler&&(i&&!this.gcScheduler.started?this.gcScheduler.start():i||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(i&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():i||this.indexBackfillerScheduler.stop())})}bu(e){const t=x0();if(!Nd.C(t))throw new de(Z.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const i=Bh(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new Nd(t,e.asyncQueue,i,e.clientId,e.initialUser)}}class er{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>Yg(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=h2.bind(null,this.syncEngine),await zu(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new K_}()}createDatastore(e){const t=Ra(e.databaseInfo.databaseId),i=function(o){return new A_(o)}(e.databaseInfo);return function(o,a,l,c){return new F_(o,a,l,c)}(e.authCredentials,e.appCheckCredentials,i,t)}createRemoteStore(e){return function(i,s,o,a,l){return new D_(i,s,o,a,l)}(this.localStore,this.datastore,e.asyncQueue,t=>Yg(this.syncEngine,t,0),function(){return qg.C()?new qg:new __}())}createSyncEngine(e,t){return function(s,o,a,l,c,u,h){const p=new t2(s,o,a,l,c,u);return h&&(p.mu=!0),p}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(s){const o=ke(s);ue(Vr,"RemoteStore shutting down."),o.da.add(5),await io(o),o.Ra.shutdown(),o.Va.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(t=this.eventManager)===null||t===void 0||t.terminate()}}er.provider={build:()=>new er};function Jg(n,e=10240){let t=0;return{async read(){if(t<n.byteLength){const i={value:n.slice(t,t+e),done:!1};return t+=e,i}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qc{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Mu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Mu(this.observer.error,e):zt("Uncaught Error in snapshot listener:",e.toString()))}xu(){this.muted=!0}Mu(e,t){setTimeout(()=>{this.muted||e(t)},0)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k2{constructor(e,t){this.Ou=e,this.serializer=t,this.metadata=new Qt,this.buffer=new Uint8Array,this.Nu=function(){return new TextDecoder("utf-8")}(),this.Bu().then(i=>{i&&i.Ua()?this.metadata.resolve(i.$a.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(i==null?void 0:i.$a)}`))},i=>this.metadata.reject(i))}close(){return this.Ou.cancel()}async getMetadata(){return this.metadata.promise}async wu(){return await this.getMetadata(),this.Bu()}async Bu(){const e=await this.Lu();if(e===null)return null;const t=this.Nu.decode(e),i=Number(t);isNaN(i)&&this.ku(`length string (${t}) is not valid number`);const s=await this.qu(i);return new X_(JSON.parse(s),e.length+i)}Qu(){return this.buffer.findIndex(e=>e===123)}async Lu(){for(;this.Qu()<0&&!await this.$u(););if(this.buffer.length===0)return null;const e=this.Qu();e<0&&this.ku("Reached the end of bundle when a length string is expected.");const t=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),t}async qu(e){for(;this.buffer.length<e;)await this.$u()&&this.ku("Reached the end of bundle when more is expected.");const t=this.Nu.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),t}ku(e){throw this.Ou.cancel(),new Error(`Invalid bundle format: ${e}`)}async $u(){const e=await this.Ou.read();if(!e.done){const t=new Uint8Array(this.buffer.length+e.value.length);t.set(this.buffer),t.set(e.value,this.buffer.length),this.buffer=t}return e.done}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S2{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new de(Z.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const t=await async function(s,o){const a=ke(s),l={documents:o.map(p=>pa(a.serializer,p))},c=await a.Yo("BatchGetDocuments",a.serializer.databaseId,nt.emptyPath(),l,o.length),u=new Map;c.forEach(p=>{const f=Mj(a.serializer,p);u.set(f.key.toString(),f)});const h=[];return o.forEach(p=>{const f=u.get(p.toString());Pe(!!f,55234,{key:p}),h.push(f)}),h}(this.datastore,e);return t.forEach(i=>this.recordVersion(i)),t}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(i){this.lastTransactionError=i}this.writtenDocs.add(e.toString())}delete(e){this.write(new no(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach(t=>{e.delete(t.key.toString())}),e.forEach((t,i)=>{const s=Te.fromPath(i);this.mutations.push(new vh(s,this.precondition(s)))}),await async function(i,s){const o=ke(i),a={writes:s.map(l=>ma(o.serializer,l))};await o.zo("Commit",o.serializer.databaseId,nt.emptyPath(),a)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw Ae(50498,{Uu:e.constructor.name});t=De.min()}const i=this.readVersions.get(e.key.toString());if(i){if(!t.isEqual(i))throw new de(Z.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(De.min())?_t.exists(!1):_t.updateTime(t):_t.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(De.min()))throw new de(Z.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return _t.updateTime(t)}return _t.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T2{constructor(e,t,i,s,o){this.asyncQueue=e,this.datastore=t,this.options=i,this.updateFunction=s,this.deferred=o,this.Ku=i.maxAttempts,this.x_=new Dh(this.asyncQueue,"transaction_retry")}Wu(){this.Ku-=1,this.Gu()}Gu(){this.x_.y_(async()=>{const e=new S2(this.datastore),t=this.zu(e);t&&t.then(i=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(i)}).catch(s=>{this.ju(s)}))}).catch(i=>{this.ju(i)})})}zu(e){try{const t=this.updateFunction(e);return!wa(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}ju(e){this.Ku>0&&this.Hu(e)?(this.Ku-=1,this.asyncQueue.enqueueAndForget(()=>(this.Gu(),Promise.resolve()))):this.deferred.reject(e)}Hu(e){if(e.name==="FirebaseError"){const t=e.code;return t==="aborted"||t==="failed-precondition"||t==="already-exists"||!Rb(t)}return!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tr="FirestoreClient";class j2{constructor(e,t,i,s,o){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=i,this.databaseInfo=s,this.user=Gt.UNAUTHENTICATED,this.clientId=ah.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=o,this.authCredentials.start(i,async a=>{ue(tr,"Received user=",a.uid),await this.authCredentialListener(a),this.user=a}),this.appCheckCredentials.start(i,a=>(ue(tr,"Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Qt;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const i=oo(t,"Failed to shutdown persistence");e.reject(i)}}),e.promise}}async function Wd(n,e){n.asyncQueue.verifyOperationInProgress(),ue(tr,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let i=t.initialUser;n.setCredentialChangeListener(async s=>{i.isEqual(s)||(await l0(e.localStore,s),i=s)}),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e}async function Zg(n,e){n.asyncQueue.verifyOperationInProgress();const t=await Jh(n);ue(tr,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener(i=>Hg(e.remoteStore,i)),n.setAppCheckTokenChangeListener((i,s)=>Hg(e.remoteStore,s)),n._onlineComponents=e}async function Jh(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){ue(tr,"Using user provided OfflineComponentProvider");try{await Wd(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!function(s){return s.name==="FirebaseError"?s.code===Z.FAILED_PRECONDITION||s.code===Z.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(t))throw t;Tn("Error using user provided cache. Falling back to memory cache: "+t),await Wd(n,new Hs)}}else ue(tr,"Using default OfflineComponentProvider"),await Wd(n,new Yh(void 0));return n._offlineComponents}async function Uc(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(ue(tr,"Using user provided OnlineComponentProvider"),await Zg(n,n._uninitializedComponentsProvider._online)):(ue(tr,"Using default OnlineComponentProvider"),await Zg(n,new er))),n._onlineComponents}function F0(n){return Jh(n).then(e=>e.persistence)}function ao(n){return Jh(n).then(e=>e.localStore)}function z0(n){return Uc(n).then(e=>e.remoteStore)}function Zh(n){return Uc(n).then(e=>e.syncEngine)}function D0(n){return Uc(n).then(e=>e.datastore)}async function $s(n){const e=await Uc(n),t=e.eventManager;return t.onListen=n2.bind(null,e.syncEngine),t.onUnlisten=r2.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=i2.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=s2.bind(null,e.syncEngine),t}function _2(n){return n.asyncQueue.enqueue(async()=>{const e=await F0(n),t=await z0(n);return e.setNetworkEnabled(!0),function(s){const o=ke(s);return o.da.delete(0),Aa(o)}(t)})}function I2(n){return n.asyncQueue.enqueue(async()=>{const e=await F0(n),t=await z0(n);return e.setNetworkEnabled(!1),async function(s){const o=ke(s);o.da.add(0),await io(o),o.Va.set("Offline")}(t)})}function C2(n,e){const t=new Qt;return n.asyncQueue.enqueueAndForget(async()=>async function(s,o,a){try{const l=await function(u,h){const p=ke(u);return p.persistence.runTransaction("read document","readonly",f=>p.localDocuments.getDocument(f,h))}(s,o);l.isFoundDocument()?a.resolve(l):l.isNoDocument()?a.resolve(null):a.reject(new de(Z.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(l){const c=oo(l,`Failed to get document '${o} from cache`);a.reject(c)}}(await ao(n),e,t)),t.promise}function N0(n,e,t={}){const i=new Qt;return n.asyncQueue.enqueueAndForget(async()=>function(o,a,l,c,u){const h=new qc({next:f=>{h.xu(),a.enqueueAndForget(()=>Vh(o,p));const b=f.docs.has(l);!b&&f.fromCache?u.reject(new de(Z.UNAVAILABLE,"Failed to get document because the client is offline.")):b&&f.fromCache&&c&&c.source==="server"?u.reject(new de(Z.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(f)},error:f=>u.reject(f)}),p=new Uh(eo(l.path),h,{includeMetadataChanges:!0,Qa:!0});return Oh(o,p)}(await $s(n),n.asyncQueue,e,t,i)),i.promise}function R2(n,e){const t=new Qt;return n.asyncQueue.enqueueAndForget(async()=>async function(s,o,a){try{const l=await ic(s,o,!0),c=new C0(o,l.$s),u=c.tu(l.documents),h=c.applyChanges(u,!1);a.resolve(h.snapshot)}catch(l){const c=oo(l,`Failed to execute query '${o} against cache`);a.reject(c)}}(await ao(n),e,t)),t.promise}function M0(n,e,t={}){const i=new Qt;return n.asyncQueue.enqueueAndForget(async()=>function(o,a,l,c,u){const h=new qc({next:f=>{h.xu(),a.enqueueAndForget(()=>Vh(o,p)),f.fromCache&&c.source==="server"?u.reject(new de(Z.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(f)},error:f=>u.reject(f)}),p=new Uh(l,h,{includeMetadataChanges:!0,Qa:!0});return Oh(o,p)}(await $s(n),n.asyncQueue,e,t,i)),i.promise}function A2(n,e,t){const i=new Qt;return n.asyncQueue.enqueueAndForget(async()=>{try{const s=await D0(n);i.resolve(async function(a,l,c){var u;const h=ke(a),{request:p,yt:f,parent:b}=Lb(h.serializer,hb(l),c);h.connection.Uo||delete p.parent;const x=(await h.Yo("RunAggregationQuery",h.serializer.databaseId,b,p,1)).filter(w=>!!w.result);Pe(x.length===1,64727);const S=(u=x[0].result)===null||u===void 0?void 0:u.aggregateFields;return Object.keys(S).reduce((w,I)=>(w[f[I]]=S[I],w),{})}(s,e,t))}catch(s){i.reject(s)}}),i.promise}function E2(n,e){const t=new qc(e);return n.asyncQueue.enqueueAndForget(async()=>function(s,o){ke(s).Ca.add(o),o.next()}(await $s(n),t)),()=>{t.xu(),n.asyncQueue.enqueueAndForget(async()=>function(s,o){ke(s).Ca.delete(o)}(await $s(n),t))}}function B2(n,e,t,i){const s=function(a,l){let c;return c=typeof a=="string"?oh().encode(a):a,function(h,p){return new k2(h,p)}(function(h,p){if(h instanceof Uint8Array)return Jg(h,p);if(h instanceof ArrayBuffer)return Jg(new Uint8Array(h),p);if(h instanceof ReadableStream)return h.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(c),l)}(t,Ra(e));n.asyncQueue.enqueueAndForget(async()=>{w2(await Zh(n),s,i)})}function P2(n,e){return n.asyncQueue.enqueue(async()=>function(i,s){const o=ke(i);return o.persistence.runTransaction("Get named query","readonly",a=>o.Ei.getNamedQuery(a,s))}(await ao(n),e))}function F2(n,e){return n.asyncQueue.enqueue(async()=>async function(i,s){const o=ke(i),a=o.indexManager,l=[];return o.persistence.runTransaction("Configure indexes","readwrite",c=>a.getFieldIndexes(c).next(u=>function(p,f,b,x,S){p=[...p],f=[...f],p.sort(b),f.sort(b);const w=p.length,I=f.length;let j=0,A=0;for(;j<I&&A<w;){const D=b(p[A],f[j]);D<0?S(p[A++]):D>0?x(f[j++]):(j++,A++)}for(;j<I;)x(f[j++]);for(;A<w;)S(p[A++])}(u,s,CT,h=>{l.push(a.addFieldIndex(c,h))},h=>{l.push(a.deleteFieldIndex(c,h))})).next(()=>K.waitFor(l)))}(await ao(n),e))}function z2(n,e){return n.asyncQueue.enqueue(async()=>function(i,s){ke(i).Ms.fs=s}(await ao(n),e))}function D2(n){return n.asyncQueue.enqueue(async()=>function(t){const i=ke(t),s=i.indexManager;return i.persistence.runTransaction("Delete All Indexes","readwrite",o=>s.deleteAllFieldIndexes(o))}(await ao(n)))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function W0(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ef=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ep(n,e,t){if(!t)throw new de(Z.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function L0(n,e,t,i){if(e===!0&&i===!0)throw new de(Z.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function tf(n){if(!Te.isDocumentKey(n))throw new de(Z.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function nf(n){if(Te.isDocumentKey(n))throw new de(Z.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function Hc(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=function(i){return i.constructor?i.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":Ae(12329,{type:typeof n})}function Ze(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new de(Z.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=Hc(n);throw new de(Z.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function O0(n,e){if(e<=0)throw new de(Z.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const V0="firestore.googleapis.com",rf=!0;class sf{constructor(e){var t,i;if(e.host===void 0){if(e.ssl!==void 0)throw new de(Z.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=V0,this.ssl=rf}else this.host=e.host,this.ssl=(t=e.ssl)!==null&&t!==void 0?t:rf;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=Qb;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<Zb)throw new de(Z.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}L0("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=W0((i=e.experimentalLongPollingOptions)!==null&&i!==void 0?i:{}),function(o){if(o.timeoutSeconds!==void 0){if(isNaN(o.timeoutSeconds))throw new de(Z.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (must not be NaN)`);if(o.timeoutSeconds<5)throw new de(Z.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (minimum allowed value is 5)`);if(o.timeoutSeconds>30)throw new de(Z.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(i,s){return i.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Ea{constructor(e,t,i,s){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=i,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new sf({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new de(Z.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new de(Z.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new sf(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(i){if(!i)return new Rx;switch(i.type){case"firstParty":return new kT(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new de(Z.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const i=ef.get(t);i&&(ue("ComponentProvider","Removing Datastore"),ef.delete(t),i.terminate())}(this),Promise.resolve()}}function q0(n,e,t,i={}){var s;n=Ze(n,Ea);const o=xi(e),a=n._getSettings(),l=Object.assign(Object.assign({},a),{emulatorOptions:n._getEmulatorOptions()}),c=`${e}:${t}`;o&&(Ic(`https://${c}`),th("Firestore",!0)),a.host!==V0&&a.host!==c&&Tn("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const u=Object.assign(Object.assign({},a),{host:c,ssl:o,emulatorOptions:i});if(!Pn(u,l)&&(n._setSettings(u),i.mockUserToken)){let h,p;if(typeof i.mockUserToken=="string")h=i.mockUserToken,p=Gt.MOCK_USER;else{h=ux(i.mockUserToken,(s=n._app)===null||s===void 0?void 0:s.options.projectId);const f=i.mockUserToken.sub||i.mockUserToken.user_id;if(!f)throw new de(Z.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");p=new Gt(f)}n._authCredentials=new bT(new Cx(h,p))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yt{constructor(e,t,i){this.converter=t,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new Yt(this.firestore,e,this._query)}}class Ft{constructor(e,t,i){this.converter=t,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new En(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Ft(this.firestore,e,this._key)}}class En extends Yt{constructor(e,t,i){super(e,t,eo(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Ft(this.firestore,null,new Te(e))}withConverter(e){return new En(this.firestore,e,this._path)}}function Wt(n,e,...t){if(n=lt(n),ep("collection","path",e),n instanceof Ea){const i=nt.fromString(e,...t);return nf(i),new En(n,null,i)}{if(!(n instanceof Ft||n instanceof En))throw new de(Z.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(nt.fromString(e,...t));return nf(i),new En(n.firestore,null,i)}}function N2(n,e){if(n=Ze(n,Ea),ep("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new de(Z.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new Yt(n,null,function(i){return new bi(nt.emptyPath(),i)}(e))}function Ot(n,e,...t){if(n=lt(n),arguments.length===1&&(e=ah.newId()),ep("doc","path",e),n instanceof Ea){const i=nt.fromString(e,...t);return tf(i),new Ft(n,null,new Te(i))}{if(!(n instanceof Ft||n instanceof En))throw new de(Z.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(nt.fromString(e,...t));return tf(i),new Ft(n.firestore,n instanceof En?n.converter:null,new Te(i))}}function M2(n,e){return n=lt(n),e=lt(e),(n instanceof Ft||n instanceof En)&&(e instanceof Ft||e instanceof En)&&n.firestore===e.firestore&&n.path===e.path&&n.converter===e.converter}function tp(n,e){return n=lt(n),e=lt(e),n instanceof Yt&&e instanceof Yt&&n.firestore===e.firestore&&Ta(n._query,e._query)&&n.converter===e.converter}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const of="AsyncQueue";class af{constructor(e=Promise.resolve()){this.Ju=[],this.Yu=!1,this.Zu=[],this.Xu=null,this.ec=!1,this.tc=!1,this.nc=[],this.x_=new Dh(this,"async_queue_retry"),this.rc=()=>{const i=Fl();i&&ue(of,"Visibility state changed to "+i.visibilityState),this.x_.b_()},this.sc=e;const t=Fl();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.rc)}get isShuttingDown(){return this.Yu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.oc(),this._c(e)}enterRestrictedMode(e){if(!this.Yu){this.Yu=!0,this.tc=e||!1;const t=Fl();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.rc)}}enqueue(e){if(this.oc(),this.Yu)return new Promise(()=>{});const t=new Qt;return this._c(()=>this.Yu&&this.tc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Ju.push(e),this.ac()))}async ac(){if(this.Ju.length!==0){try{await this.Ju[0](),this.Ju.shift(),this.x_.reset()}catch(e){if(!rr(e))throw e;ue(of,"Operation failed with retryable error: "+e)}this.Ju.length>0&&this.x_.y_(()=>this.ac())}}_c(e){const t=this.sc.then(()=>(this.ec=!0,e().catch(i=>{throw this.Xu=i,this.ec=!1,zt("INTERNAL UNHANDLED ERROR: ",lf(i)),i}).then(i=>(this.ec=!1,i))));return this.sc=t,t}enqueueAfterDelay(e,t,i){this.oc(),this.nc.indexOf(e)>-1&&(t=0);const s=Lh.createAndSchedule(this,e,t,i,o=>this.uc(o));return this.Zu.push(s),s}oc(){this.Xu&&Ae(47125,{cc:lf(this.Xu)})}verifyOperationInProgress(){}async lc(){let e;do e=this.sc,await e;while(e!==this.sc)}hc(e){for(const t of this.Zu)if(t.timerId===e)return!0;return!1}Pc(e){return this.lc().then(()=>{this.Zu.sort((t,i)=>t.targetTimeMs-i.targetTimeMs);for(const t of this.Zu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.lc()})}Tc(e){this.nc.push(e)}uc(e){const t=this.Zu.indexOf(e);this.Zu.splice(t,1)}}function lf(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mu(n){return function(t,i){if(typeof t!="object"||t===null)return!1;const s=t;for(const o of i)if(o in s&&typeof s[o]=="function")return!0;return!1}(n,["next","error","complete"])}class U0{constructor(){this._progressObserver={},this._taskCompletionResolver=new Qt,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,i){this._progressObserver={next:e,error:t,complete:i}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const W2=-1;class gt extends Ea{constructor(e,t,i,s){super(e,t,i,s),this.type="firestore",this._queue=new af,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new af(e),this._firestoreClient=void 0,await e}}}function L2(n,e,t){t||(t=ca);const i=Js(n,"firestore");if(i.isInitialized(t)){const s=i.getImmediate({identifier:t}),o=i.getOptions(t);if(Pn(o,e))return s;throw new de(Z.FAILED_PRECONDITION,"initializeFirestore() has already been called with different options. To avoid this error, call initializeFirestore() with the same options as when it was originally called, or call getFirestore() to return the already initialized instance.")}if(e.cacheSizeBytes!==void 0&&e.localCache!==void 0)throw new de(Z.INVALID_ARGUMENT,"cache and cacheSizeBytes cannot be specified at the same time as cacheSizeBytes willbe deprecated. Instead, specify the cache size in the cache object");if(e.cacheSizeBytes!==void 0&&e.cacheSizeBytes!==-1&&e.cacheSizeBytes<Zb)throw new de(Z.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");return e.host&&xi(e.host)&&Ic(e.host),i.initialize({options:e,instanceIdentifier:t})}function Ba(n,e){const t=typeof n=="object"?n:rh(),i=typeof n=="string"?n:e||ca,s=Js(t,"firestore").getImmediate({identifier:i});if(!s._initialized){const o=lx("firestore");o&&q0(s,...o)}return s}function It(n){if(n._terminated)throw new de(Z.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||H0(n),n._firestoreClient}function H0(n){var e,t,i;const s=n._freezeSettings(),o=function(l,c,u,h){return new lj(l,c,u,h.host,h.ssl,h.experimentalForceLongPolling,h.experimentalAutoDetectLongPolling,W0(h.experimentalLongPollingOptions),h.useFetchStreams,h.isUsingEmulator)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,s);n._componentsProvider||!((t=s.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((i=s.localCache)===null||i===void 0)&&i._onlineComponentProvider)&&(n._componentsProvider={_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider}),n._firestoreClient=new j2(n._authCredentials,n._appCheckCredentials,n._queue,o,n._componentsProvider&&function(l){const c=l==null?void 0:l._online.build();return{_offline:l==null?void 0:l._offline.build(c),_online:c}}(n._componentsProvider))}function O2(n,e){Tn("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=n._freezeSettings();return $0(n,er.provider,{build:i=>new Xh(i,t.cacheSizeBytes,e==null?void 0:e.forceOwnership)}),Promise.resolve()}async function V2(n){Tn("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const e=n._freezeSettings();$0(n,er.provider,{build:t=>new P0(t,e.cacheSizeBytes)})}function $0(n,e,t){if((n=Ze(n,gt))._firestoreClient||n._terminated)throw new de(Z.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(n._componentsProvider||n._getSettings().localCache)throw new de(Z.FAILED_PRECONDITION,"SDK cache is already specified.");n._componentsProvider={_online:e,_offline:t},H0(n)}function q2(n){if(n._initialized&&!n._terminated)throw new de(Z.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new Qt;return n._queue.enqueueAndForgetEvenWhileRestricted(async()=>{try{await async function(i){if(!$n.C())return Promise.resolve();const s=i+s0;await $n.delete(s)}(Bh(n._databaseId,n._persistenceKey)),e.resolve()}catch(t){e.reject(t)}}),e.promise}function U2(n){return function(t){const i=new Qt;return t.asyncQueue.enqueueAndForget(async()=>d2(await Zh(t),i)),i.promise}(It(n=Ze(n,gt)))}function H2(n){return _2(It(n=Ze(n,gt)))}function $2(n){return I2(It(n=Ze(n,gt)))}function G2(n){return nT(n.app,"firestore",n._databaseId.database),n._delete()}function K2(n,e){const t=It(n=Ze(n,gt)),i=new U0;return B2(t,n._databaseId,e,i),i}function Q2(n,e){return P2(It(n=Ze(n,gt)),e).then(t=>t?new Yt(n,null,t.query):null)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gs{constructor(e="count",t){this._internalFieldPath=t,this.type="AggregateField",this.aggregateType=e}}class G0{constructor(e,t,i){this._userDataWriter=t,this._data=i,this.type="AggregateQuerySnapshot",this.query=e}data(){return this._userDataWriter.convertObjectMap(this._data)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nr{constructor(e){this._byteString=e}static fromBase64String(e){try{return new nr(At.fromBase64String(e))}catch(t){throw new de(Z.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new nr(At.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lr{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new de(Z.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new St(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}function Y2(){return new lr(mu)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cr{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $c{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new de(Z.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new de(Z.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Le(this._lat,e._lat)||Le(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pa{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(i,s){if(i.length!==s.length)return!1;for(let o=0;o<i.length;++o)if(i[o]!==s[o])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const X2=/^__.*__$/;class J2{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return this.fieldMask!==null?new wi(e,this.data,this.fieldMask,t,this.fieldTransforms):new to(e,this.data,t,this.fieldTransforms)}}class K0{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return new wi(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function Q0(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Ae(40011,{Ic:n})}}class Gc{constructor(e,t,i,s,o,a){this.settings=e,this.databaseId=t,this.serializer=i,this.ignoreUndefinedProperties=s,o===void 0&&this.Ec(),this.fieldTransforms=o||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Ic(){return this.settings.Ic}dc(e){return new Gc(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Ac(e){var t;const i=(t=this.path)===null||t===void 0?void 0:t.child(e),s=this.dc({path:i,Rc:!1});return s.Vc(e),s}mc(e){var t;const i=(t=this.path)===null||t===void 0?void 0:t.child(e),s=this.dc({path:i,Rc:!1});return s.Ec(),s}fc(e){return this.dc({path:void 0,Rc:!0})}gc(e){return ac(e,this.settings.methodName,this.settings.yc||!1,this.path,this.settings.wc)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}Ec(){if(this.path)for(let e=0;e<this.path.length;e++)this.Vc(this.path.get(e))}Vc(e){if(e.length===0)throw this.gc("Document fields must not be empty");if(Q0(this.Ic)&&X2.test(e))throw this.gc('Document fields cannot begin and end with "__"')}}class Z2{constructor(e,t,i){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=i||Ra(e)}bc(e,t,i,s=!1){return new Gc({Ic:e,methodName:t,wc:i,path:St.emptyPath(),Rc:!1,yc:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Yr(n){const e=n._freezeSettings(),t=Ra(n._databaseId);return new Z2(n._databaseId,!!e.ignoreUndefinedProperties,t)}function Kc(n,e,t,i,s,o={}){const a=n.bc(o.merge||o.mergeFields?2:0,e,t,s);lp("Data must be an object, but it was:",a,i);const l=J0(i,a);let c,u;if(o.merge)c=new fn(a.fieldMask),u=a.fieldTransforms;else if(o.mergeFields){const h=[];for(const p of o.mergeFields){const f=ga(e,p,t);if(!a.contains(f))throw new de(Z.INVALID_ARGUMENT,`Field '${f}' is specified in your field mask but missing from your input data.`);ev(h,f)||h.push(f)}c=new fn(h),u=a.fieldTransforms.filter(p=>c.covers(p.field))}else c=null,u=a.fieldTransforms;return new J2(new Zt(l),c,u)}class Fa extends cr{_toFieldTransform(e){if(e.Ic!==2)throw e.Ic===1?e.gc(`${this._methodName}() can only appear at the top level of your update data`):e.gc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Fa}}function Y0(n,e,t){return new Gc({Ic:3,wc:e.settings.wc,methodName:n._methodName,Rc:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class np extends cr{_toFieldTransform(e){return new _a(e.path,new Ns)}isEqual(e){return e instanceof np}}class ip extends cr{constructor(e,t){super(e),this.Sc=t}_toFieldTransform(e){const t=Y0(this,e,!0),i=this.Sc.map(o=>Xr(o,t)),s=new Nr(i);return new _a(e.path,s)}isEqual(e){return e instanceof ip&&Pn(this.Sc,e.Sc)}}class rp extends cr{constructor(e,t){super(e),this.Sc=t}_toFieldTransform(e){const t=Y0(this,e,!0),i=this.Sc.map(o=>Xr(o,t)),s=new Mr(i);return new _a(e.path,s)}isEqual(e){return e instanceof rp&&Pn(this.Sc,e.Sc)}}class sp extends cr{constructor(e,t){super(e),this.Dc=t}_toFieldTransform(e){const t=new Ms(e.serializer,wb(e.serializer,this.Dc));return new _a(e.path,t)}isEqual(e){return e instanceof sp&&this.Dc===e.Dc}}function op(n,e,t,i){const s=n.bc(1,e,t);lp("Data must be an object, but it was:",s,i);const o=[],a=Zt.empty();sr(i,(c,u)=>{const h=Qc(e,c,t);u=lt(u);const p=s.mc(h);if(u instanceof Fa)o.push(h);else{const f=Xr(u,p);f!=null&&(o.push(h),a.set(h,f))}});const l=new fn(o);return new K0(a,l,s.fieldTransforms)}function ap(n,e,t,i,s,o){const a=n.bc(1,e,t),l=[ga(e,i,t)],c=[s];if(o.length%2!=0)throw new de(Z.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let f=0;f<o.length;f+=2)l.push(ga(e,o[f])),c.push(o[f+1]);const u=[],h=Zt.empty();for(let f=l.length-1;f>=0;--f)if(!ev(u,l[f])){const b=l[f];let x=c[f];x=lt(x);const S=a.mc(b);if(x instanceof Fa)u.push(b);else{const w=Xr(x,S);w!=null&&(u.push(b),h.set(b,w))}}const p=new fn(u);return new K0(h,p,a.fieldTransforms)}function X0(n,e,t,i=!1){return Xr(t,n.bc(i?4:3,e))}function Xr(n,e){if(Z0(n=lt(n)))return lp("Unsupported field value:",e,n),J0(n,e);if(n instanceof cr)return function(i,s){if(!Q0(s.Ic))throw s.gc(`${i._methodName}() can only be used with update() and set()`);if(!s.path)throw s.gc(`${i._methodName}() is not currently supported inside arrays`);const o=i._toFieldTransform(s);o&&s.fieldTransforms.push(o)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.Rc&&e.Ic!==4)throw e.gc("Nested arrays are not supported");return function(i,s){const o=[];let a=0;for(const l of i){let c=Xr(l,s.fc(a));c==null&&(c={nullValue:"NULL_VALUE"}),o.push(c),a++}return{arrayValue:{values:o}}}(n,e)}return function(i,s){if((i=lt(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return wb(s.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){const o=xt.fromDate(i);return{timestampValue:Ws(s.serializer,o)}}if(i instanceof xt){const o=new xt(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:Ws(s.serializer,o)}}if(i instanceof $c)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof nr)return{bytesValue:Pb(s.serializer,i._byteString)};if(i instanceof Ft){const o=s.databaseId,a=i.firestore._databaseId;if(!a.isEqual(o))throw s.gc(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${o.projectId}/${o.database}`);return{referenceValue:jh(i.firestore._databaseId||s.databaseId,i._key.path)}}if(i instanceof Pa)return function(a,l){return{mapValue:{fields:{[mh]:{stringValue:gh},[Fs]:{arrayValue:{values:a.toArray().map(u=>{if(typeof u!="number")throw l.gc("VectorValues must only contain numeric values.");return bh(l.serializer,u)})}}}}}}(i,s);throw s.gc(`Unsupported field value: ${Hc(i)}`)}(n,e)}function J0(n,e){const t={};return Kx(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):sr(n,(i,s)=>{const o=Xr(s,e.Ac(i));o!=null&&(t[i]=o)}),{mapValue:{fields:t}}}function Z0(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof xt||n instanceof $c||n instanceof nr||n instanceof Ft||n instanceof cr||n instanceof Pa)}function lp(n,e,t){if(!Z0(t)||!function(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}(t)){const i=Hc(t);throw i==="an object"?e.gc(n+" a custom object"):e.gc(n+" "+i)}}function ga(n,e,t){if((e=lt(e))instanceof lr)return e._internalPath;if(typeof e=="string")return Qc(n,e);throw ac("Field path arguments must be of type string or ",n,!1,void 0,t)}const eI=new RegExp("[~\\*/\\[\\]]");function Qc(n,e,t){if(e.search(eI)>=0)throw ac(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new lr(...e.split("."))._internalPath}catch{throw ac(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function ac(n,e,t,i,s){const o=i&&!i.isEmpty(),a=s!==void 0;let l=`Function ${e}() called with invalid data`;t&&(l+=" (via `toFirestore()`)"),l+=". ";let c="";return(o||a)&&(c+=" (found",o&&(c+=` in field ${i}`),a&&(c+=` in document ${s}`),c+=")"),new de(Z.INVALID_ARGUMENT,l+n+c)}function ev(n,e){return n.some(t=>t.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fa{constructor(e,t,i,s,o){this._firestore=e,this._userDataWriter=t,this._key=i,this._document=s,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new Ft(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new tI(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(Yc("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class tI extends fa{data(){return super.data()}}function Yc(n,e){return typeof e=="string"?Qc(n,e):e instanceof lr?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tv(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new de(Z.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class cp{}class lo extends cp{}function un(n,e,...t){let i=[];e instanceof cp&&i.push(e),i=i.concat(t),function(o){const a=o.filter(c=>c instanceof Jr).length,l=o.filter(c=>c instanceof co).length;if(a>1||a>0&&l>0)throw new de(Z.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(i);for(const s of i)n=s._apply(n);return n}class co extends lo{constructor(e,t,i){super(),this._field=e,this._op=t,this._value=i,this.type="where"}static _create(e,t,i){return new co(e,t,i)}_apply(e){const t=this._parse(e);return iv(e._query,t),new Yt(e.firestore,e.converter,ju(e._query,t))}_parse(e){const t=Yr(e.firestore);return function(o,a,l,c,u,h,p){let f;if(u.isKeyField()){if(h==="array-contains"||h==="array-contains-any")throw new de(Z.INVALID_ARGUMENT,`Invalid Query. You can't perform '${h}' queries on documentId().`);if(h==="in"||h==="not-in"){df(p,h);const x=[];for(const S of p)x.push(cf(c,o,S));f={arrayValue:{values:x}}}else f=cf(c,o,p)}else h!=="in"&&h!=="not-in"&&h!=="array-contains-any"||df(p,h),f=X0(l,a,p,h==="in"||h==="not-in");return it.create(u,h,f)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function Lt(n,e,t){const i=e,s=Yc("where",n);return co._create(s,i,t)}class Jr extends cp{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new Jr(e,t)}_parse(e){const t=this._queryConstraints.map(i=>i._parse(e)).filter(i=>i.getFilters().length>0);return t.length===1?t[0]:pt.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:(function(s,o){let a=s;const l=o.getFlattenedFilters();for(const c of l)iv(a,c),a=ju(a,c)}(e._query,t),new Yt(e.firestore,e.converter,ju(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function nI(...n){return n.forEach(e=>rv("or",e)),Jr._create("or",n)}function iI(...n){return n.forEach(e=>rv("and",e)),Jr._create("and",n)}class Xc extends lo{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new Xc(e,t)}_apply(e){const t=function(s,o,a){if(s.startAt!==null)throw new de(Z.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new de(Z.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new ha(o,a)}(e._query,this._field,this._direction);return new Yt(e.firestore,e.converter,function(s,o){const a=s.explicitOrderBy.concat([o]);return new bi(s.path,s.collectionGroup,a,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)}(e._query,t))}}function lc(n,e="asc"){const t=e,i=Yc("orderBy",n);return Xc._create(i,t)}class za extends lo{constructor(e,t,i){super(),this.type=e,this._limit=t,this._limitType=i}static _create(e,t,i){return new za(e,t,i)}_apply(e){return new Yt(e.firestore,e.converter,Xl(e._query,this._limit,this._limitType))}}function rI(n){return O0("limit",n),za._create("limit",n,"F")}function sI(n){return O0("limitToLast",n),za._create("limitToLast",n,"L")}class Da extends lo{constructor(e,t,i){super(),this.type=e,this._docOrFields=t,this._inclusive=i}static _create(e,t,i){return new Da(e,t,i)}_apply(e){const t=nv(e,this.type,this._docOrFields,this._inclusive);return new Yt(e.firestore,e.converter,function(s,o){return new bi(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),s.limit,s.limitType,o,s.endAt)}(e._query,t))}}function oI(...n){return Da._create("startAt",n,!0)}function aI(...n){return Da._create("startAfter",n,!1)}class Na extends lo{constructor(e,t,i){super(),this.type=e,this._docOrFields=t,this._inclusive=i}static _create(e,t,i){return new Na(e,t,i)}_apply(e){const t=nv(e,this.type,this._docOrFields,this._inclusive);return new Yt(e.firestore,e.converter,function(s,o){return new bi(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),s.limit,s.limitType,s.startAt,o)}(e._query,t))}}function lI(...n){return Na._create("endBefore",n,!1)}function cI(...n){return Na._create("endAt",n,!0)}function nv(n,e,t,i){if(t[0]=lt(t[0]),t[0]instanceof fa)return function(o,a,l,c,u){if(!c)throw new de(Z.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${l}().`);const h=[];for(const p of vs(o))if(p.field.isKeyField())h.push(zr(a,c.key));else{const f=c.data.field(p.field);if(Bc(f))throw new de(Z.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+p.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(f===null){const b=p.field.canonicalString();throw new de(Z.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${b}' (used as the orderBy) does not exist.`)}h.push(f)}return new Ji(h,u)}(n._query,n.firestore._databaseId,e,t[0]._document,i);{const s=Yr(n.firestore);return function(a,l,c,u,h,p){const f=a.explicitOrderBy;if(h.length>f.length)throw new de(Z.INVALID_ARGUMENT,`Too many arguments provided to ${u}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const b=[];for(let x=0;x<h.length;x++){const S=h[x];if(f[x].field.isKeyField()){if(typeof S!="string")throw new de(Z.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${u}(), but got a ${typeof S}`);if(!yh(a)&&S.indexOf("/")!==-1)throw new de(Z.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${u}() must be a plain document ID, but '${S}' contains a slash.`);const w=a.path.child(nt.fromString(S));if(!Te.isDocumentKey(w))throw new de(Z.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${u}() must result in a valid document path, but '${w}' is not because it contains an odd number of segments.`);const I=new Te(w);b.push(zr(l,I))}else{const w=X0(c,u,S);b.push(w)}}return new Ji(b,p)}(n._query,n.firestore._databaseId,s,e,t,i)}}function cf(n,e,t){if(typeof(t=lt(t))=="string"){if(t==="")throw new de(Z.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!yh(e)&&t.indexOf("/")!==-1)throw new de(Z.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const i=e.path.child(nt.fromString(t));if(!Te.isDocumentKey(i))throw new de(Z.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return zr(n,new Te(i))}if(t instanceof Ft)return zr(n,t._key);throw new de(Z.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Hc(t)}.`)}function df(n,e){if(!Array.isArray(n)||n.length===0)throw new de(Z.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function iv(n,e){const t=function(s,o){for(const a of s)for(const l of a.getFlattenedFilters())if(o.indexOf(l.op)>=0)return l.op;return null}(n.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new de(Z.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new de(Z.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}function rv(n,e){if(!(e instanceof co||e instanceof Jr))throw new de(Z.INVALID_ARGUMENT,`Function ${n}() requires AppliableConstraints created with a call to 'where(...)', 'or(...)', or 'and(...)'.`)}class dp{convertValue(e,t="none"){switch(Yi(e)){case 0:return null;case 1:return e.booleanValue;case 2:return jt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(gi(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Ae(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const i={};return sr(e,(s,o)=>{i[s]=this.convertValue(o,t)}),i}convertVectorValue(e){var t,i,s;const o=(s=(i=(t=e.fields)===null||t===void 0?void 0:t[Fs].arrayValue)===null||i===void 0?void 0:i.values)===null||s===void 0?void 0:s.map(a=>jt(a.doubleValue));return new Pa(o)}convertGeoPoint(e){return new $c(jt(e.latitude),jt(e.longitude))}convertArray(e,t){return(e.values||[]).map(i=>this.convertValue(i,t))}convertServerTimestamp(e,t){switch(t){case"previous":const i=Pc(e);return i==null?null:this.convertValue(i,t);case"estimate":return this.convertTimestamp(la(e));default:return null}}convertTimestamp(e){const t=mi(e);return new xt(t.seconds,t.nanos)}convertDocumentKey(e,t){const i=nt.fromString(e);Pe(Ub(i),9688,{name:e});const s=new Qi(i.get(1),i.get(3)),o=new Te(i.popFirst(5));return s.isEqual(t)||zt(`Document ${o} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jc(n,e,t){let i;return i=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,i}class dI extends dp{constructor(e){super(),this.firestore=e}convertBytes(e){return new nr(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Ft(this.firestore,null,t)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uI(n){return new Gs("sum",ga("sum",n))}function hI(n){return new Gs("avg",ga("average",n))}function sv(){return new Gs("count")}function pI(n,e){var t,i;return n instanceof Gs&&e instanceof Gs&&n.aggregateType===e.aggregateType&&((t=n._internalFieldPath)===null||t===void 0?void 0:t.canonicalString())===((i=e._internalFieldPath)===null||i===void 0?void 0:i.canonicalString())}function mI(n,e){return tp(n.query,e.query)&&Pn(n.data(),e.data())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Li{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class qr extends fa{constructor(e,t,i,s,o,a){super(e,t,i,s,a),this._firestore=e,this._firestoreImpl=e,this.metadata=o}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Xo(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const i=this._document.data.field(Yc("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,t.serverTimestamps)}}}class Xo extends qr{data(e={}){return super.data(e)}}class Ur{constructor(e,t,i,s){this._firestore=e,this._userDataWriter=t,this._snapshot=s,this.metadata=new Li(s.hasPendingWrites,s.fromCache),this.query=i}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(i=>{e.call(t,new Xo(this._firestore,this._userDataWriter,i.key,i,new Li(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new de(Z.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(s,o){if(s._snapshot.oldDocs.isEmpty()){let a=0;return s._snapshot.docChanges.map(l=>{const c=new Xo(s._firestore,s._userDataWriter,l.doc.key,l.doc,new Li(s._snapshot.mutatedKeys.has(l.doc.key),s._snapshot.fromCache),s.query.converter);return l.doc,{type:"added",doc:c,oldIndex:-1,newIndex:a++}})}{let a=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(l=>o||l.type!==3).map(l=>{const c=new Xo(s._firestore,s._userDataWriter,l.doc.key,l.doc,new Li(s._snapshot.mutatedKeys.has(l.doc.key),s._snapshot.fromCache),s.query.converter);let u=-1,h=-1;return l.type!==0&&(u=a.indexOf(l.doc.key),a=a.delete(l.doc.key)),l.type!==1&&(a=a.add(l.doc),h=a.indexOf(l.doc.key)),{type:gI(l.type),doc:c,oldIndex:u,newIndex:h}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function gI(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ae(61501,{type:n})}}function fI(n,e){return n instanceof qr&&e instanceof qr?n._firestore===e._firestore&&n._key.isEqual(e._key)&&(n._document===null?e._document===null:n._document.isEqual(e._document))&&n._converter===e._converter:n instanceof Ur&&e instanceof Ur&&n._firestore===e._firestore&&tp(n.query,e.query)&&n.metadata.isEqual(e.metadata)&&n._snapshot.isEqual(e._snapshot)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fi(n){n=Ze(n,Ft);const e=Ze(n.firestore,gt);return N0(It(e),n._key).then(t=>hp(e,n,t))}class dr extends dp{constructor(e){super(),this.firestore=e}convertBytes(e){return new nr(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Ft(this.firestore,null,t)}}function yI(n){n=Ze(n,Ft);const e=Ze(n.firestore,gt),t=It(e),i=new dr(e);return C2(t,n._key).then(s=>new qr(e,i,n._key,s,new Li(s!==null&&s.hasLocalMutations,!0),n.converter))}function xI(n){n=Ze(n,Ft);const e=Ze(n.firestore,gt);return N0(It(e),n._key,{source:"server"}).then(t=>hp(e,n,t))}function kn(n){n=Ze(n,Yt);const e=Ze(n.firestore,gt),t=It(e),i=new dr(e);return tv(n._query),M0(t,n._query).then(s=>new Ur(e,i,n,s))}function bI(n){n=Ze(n,Yt);const e=Ze(n.firestore,gt),t=It(e),i=new dr(e);return R2(t,n._query).then(s=>new Ur(e,i,n,s))}function vI(n){n=Ze(n,Yt);const e=Ze(n.firestore,gt),t=It(e),i=new dr(e);return M0(t,n._query,{source:"server"}).then(s=>new Ur(e,i,n,s))}function Ma(n,e,t){n=Ze(n,Ft);const i=Ze(n.firestore,gt),s=Jc(n.converter,e,t);return uo(i,[Kc(Yr(i),"setDoc",n._key,s,n.converter!==null,t).toMutation(n._key,_t.none())])}function cc(n,e,t,...i){n=Ze(n,Ft);const s=Ze(n.firestore,gt),o=Yr(s);let a;return a=typeof(e=lt(e))=="string"||e instanceof lr?ap(o,"updateDoc",n._key,e,t,i):op(o,"updateDoc",n._key,e),uo(s,[a.toMutation(n._key,_t.exists(!0))])}function dc(n){return uo(Ze(n.firestore,gt),[new no(n._key,_t.none())])}function $i(n,e){const t=Ze(n.firestore,gt),i=Ot(n),s=Jc(n.converter,e);return uo(t,[Kc(Yr(n.firestore),"addDoc",i._key,s,n.converter!==null,{}).toMutation(i._key,_t.exists(!1))]).then(()=>i)}function up(n,...e){var t,i,s;n=lt(n);let o={includeMetadataChanges:!1,source:"default"},a=0;typeof e[a]!="object"||Mu(e[a])||(o=e[a],a++);const l={includeMetadataChanges:o.includeMetadataChanges,source:o.source};if(Mu(e[a])){const p=e[a];e[a]=(t=p.next)===null||t===void 0?void 0:t.bind(p),e[a+1]=(i=p.error)===null||i===void 0?void 0:i.bind(p),e[a+2]=(s=p.complete)===null||s===void 0?void 0:s.bind(p)}let c,u,h;if(n instanceof Ft)u=Ze(n.firestore,gt),h=eo(n._key.path),c={next:p=>{e[a]&&e[a](hp(u,n,p))},error:e[a+1],complete:e[a+2]};else{const p=Ze(n,Yt);u=Ze(p.firestore,gt),h=p._query;const f=new dr(u);c={next:b=>{e[a]&&e[a](new Ur(u,f,p,b))},error:e[a+1],complete:e[a+2]},tv(n._query)}return function(f,b,x,S){const w=new qc(S),I=new Uh(b,w,x);return f.asyncQueue.enqueueAndForget(async()=>Oh(await $s(f),I)),()=>{w.xu(),f.asyncQueue.enqueueAndForget(async()=>Vh(await $s(f),I))}}(It(u),h,l,c)}function wI(n,e){return E2(It(n=Ze(n,gt)),Mu(e)?e:{next:e})}function uo(n,e){return function(i,s){const o=new Qt;return i.asyncQueue.enqueueAndForget(async()=>o2(await Zh(i),s,o)),o.promise}(It(n),e)}function hp(n,e,t){const i=t.docs.get(e._key),s=new dr(n);return new qr(n,s,e._key,i,new Li(t.hasPendingWrites,t.fromCache),e.converter)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kI(n){return ov(n,{count:sv()})}function ov(n,e){const t=Ze(n.firestore,gt),i=It(t),s=Gx(e,(o,a)=>new Cb(a,o.aggregateType,o._internalFieldPath));return A2(i,n._query,s).then(o=>function(l,c,u){const h=new dr(l);return new G0(c,h,u)}(t,n,o))}class SI{constructor(e){this.kind="memory",this._onlineComponentProvider=er.provider,e!=null&&e.garbageCollector?this._offlineComponentProvider=e.garbageCollector._offlineComponentProvider:this._offlineComponentProvider={build:()=>new Yh(void 0)}}toJSON(){return{kind:this.kind}}}class TI{constructor(e){let t;this.kind="persistent",e!=null&&e.tabManager?(e.tabManager._initialize(e),t=e.tabManager):(t=av(void 0),t._initialize(e)),this._onlineComponentProvider=t._onlineComponentProvider,this._offlineComponentProvider=t._offlineComponentProvider}toJSON(){return{kind:this.kind}}}class jI{constructor(){this.kind="memoryEager",this._offlineComponentProvider=Hs.provider}toJSON(){return{kind:this.kind}}}class _I{constructor(e){this.kind="memoryLru",this._offlineComponentProvider={build:()=>new Yh(e)}}toJSON(){return{kind:this.kind}}}function II(){return new jI}function CI(n){return new _I(n==null?void 0:n.cacheSizeBytes)}function RI(n){return new SI(n)}function AI(n){return new TI(n)}class EI{constructor(e){this.forceOwnership=e,this.kind="persistentSingleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=er.provider,this._offlineComponentProvider={build:t=>new Xh(t,e==null?void 0:e.cacheSizeBytes,this.forceOwnership)}}}class BI{constructor(){this.kind="PersistentMultipleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=er.provider,this._offlineComponentProvider={build:t=>new P0(t,e==null?void 0:e.cacheSizeBytes)}}}function av(n){return new EI(n==null?void 0:n.forceOwnership)}function PI(){return new BI}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FI={maxAttempts:5};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lv{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=Yr(e)}set(e,t,i){this._verifyNotCommitted();const s=Oi(e,this._firestore),o=Jc(s.converter,t,i),a=Kc(this._dataReader,"WriteBatch.set",s._key,o,s.converter!==null,i);return this._mutations.push(a.toMutation(s._key,_t.none())),this}update(e,t,i,...s){this._verifyNotCommitted();const o=Oi(e,this._firestore);let a;return a=typeof(t=lt(t))=="string"||t instanceof lr?ap(this._dataReader,"WriteBatch.update",o._key,t,i,s):op(this._dataReader,"WriteBatch.update",o._key,t),this._mutations.push(a.toMutation(o._key,_t.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=Oi(e,this._firestore);return this._mutations=this._mutations.concat(new no(t._key,_t.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new de(Z.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function Oi(n,e){if((n=lt(n)).firestore!==e)throw new de(Z.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zI{constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=Yr(e)}get(e){const t=Oi(e,this._firestore),i=new dI(this._firestore);return this._transaction.lookup([t._key]).then(s=>{if(!s||s.length!==1)return Ae(24041);const o=s[0];if(o.isFoundDocument())return new fa(this._firestore,i,o.key,o,t.converter);if(o.isNoDocument())return new fa(this._firestore,i,t._key,null,t.converter);throw Ae(18433,{doc:o})})}set(e,t,i){const s=Oi(e,this._firestore),o=Jc(s.converter,t,i),a=Kc(this._dataReader,"Transaction.set",s._key,o,s.converter!==null,i);return this._transaction.set(s._key,a),this}update(e,t,i,...s){const o=Oi(e,this._firestore);let a;return a=typeof(t=lt(t))=="string"||t instanceof lr?ap(this._dataReader,"Transaction.update",o._key,t,i,s):op(this._dataReader,"Transaction.update",o._key,t),this._transaction.update(o._key,a),this}delete(e){const t=Oi(e,this._firestore);return this._transaction.delete(t._key),this}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cv extends zI{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=Oi(e,this._firestore),i=new dr(this._firestore);return super.get(e).then(s=>new qr(this._firestore,i,t._key,s._document,new Li(!1,!1),t.converter))}}function DI(n,e,t){n=Ze(n,gt);const i=Object.assign(Object.assign({},FI),t);return function(o){if(o.maxAttempts<1)throw new de(Z.INVALID_ARGUMENT,"Max attempts must be at least 1")}(i),function(o,a,l){const c=new Qt;return o.asyncQueue.enqueueAndForget(async()=>{const u=await D0(o);new T2(o.asyncQueue,u,l,a,c).Wu()}),c.promise}(It(n),s=>e(new cv(n,s)),i)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NI(){return new Fa("deleteField")}function pp(){return new np("serverTimestamp")}function MI(...n){return new ip("arrayUnion",n)}function WI(...n){return new rp("arrayRemove",n)}function LI(n){return new sp("increment",n)}function OI(n){return new Pa(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VI(n){return It(n=Ze(n,gt)),new lv(n,e=>uo(n,e))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qI(n,e){const t=It(n=Ze(n,gt));if(!t._uninitializedComponentsProvider||t._uninitializedComponentsProvider._offline.kind==="memory")return Tn("Cannot enable indexes when persistence is disabled"),Promise.resolve();const i=function(o){const a=typeof o=="string"?function(u){try{return JSON.parse(u)}catch(h){throw new de(Z.INVALID_ARGUMENT,"Failed to parse JSON: "+(h==null?void 0:h.message))}}(o):o,l=[];if(Array.isArray(a.indexes))for(const c of a.indexes){const u=uf(c,"collectionGroup"),h=[];if(Array.isArray(c.fields))for(const p of c.fields){const f=Qc("setIndexConfiguration",uf(p,"fieldPath"));p.arrayConfig==="CONTAINS"?h.push(new Rr(f,2)):p.order==="ASCENDING"?h.push(new Rr(f,0)):p.order==="DESCENDING"&&h.push(new Rr(f,1))}l.push(new Cs(Cs.UNKNOWN_ID,u,h,Rs.empty()))}return l}(e);return F2(t,i)}function uf(n,e){if(typeof n[e]!="string")throw new de(Z.INVALID_ARGUMENT,"Missing string value for: "+e);return n[e]}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dv{constructor(e){this._firestore=e,this.type="PersistentCacheIndexManager"}}function UI(n){var e;n=Ze(n,gt);const t=hf.get(n);if(t)return t;if(((e=It(n)._uninitializedComponentsProvider)===null||e===void 0?void 0:e._offline.kind)!=="persistent")return null;const i=new dv(n);return hf.set(n,i),i}function HI(n){uv(n,!0)}function $I(n){uv(n,!1)}function GI(n){D2(It(n._firestore)).then(e=>ue("deleting all persistent cache indexes succeeded")).catch(e=>Tn("deleting all persistent cache indexes failed",e))}function uv(n,e){z2(It(n._firestore),e).then(t=>ue(`setting persistent cache index auto creation isEnabled=${e} succeeded`)).catch(t=>Tn(`setting persistent cache index auto creation isEnabled=${e} failed`,t))}const hf=new WeakMap;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KI(n){var e;const t=(e=It(Ze(n.firestore,gt))._onlineComponents)===null||e===void 0?void 0:e.datastore.serializer;return t===void 0?null:Nc(t,cn(n._query)).gt}function QI(n,e){var t;const i=Gx(e,(o,a)=>new Cb(a,o.aggregateType,o._internalFieldPath)),s=(t=It(Ze(n.firestore,gt))._onlineComponents)===null||t===void 0?void 0:t.datastore.serializer;return s===void 0?null:Lb(s,hb(n._query),i,!0).request}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YI{constructor(){throw new Error("instances of this class should not be created")}static onExistenceFilterMismatch(e){return mp.instance.onExistenceFilterMismatch(e)}}class mp{constructor(){this.vc=new Map}static get instance(){return xl||(xl=new mp,function(t){if(Jl)throw new Error("a TestingHooksSpi instance is already set");Jl=t}(xl)),xl}ht(e){this.vc.forEach(t=>t(e))}onExistenceFilterMismatch(e){const t=Symbol(),i=this.vc;return i.set(t,e),()=>i.delete(t)}}let xl=null;(function(e,t=!0){(function(s){Zs=s})(Qr),Fr(new Gi("firestore",(i,{instanceIdentifier:s,options:o})=>{const a=i.getProvider("app").getImmediate(),l=new gt(new vT(i.getProvider("auth-internal")),new ST(a,i.getProvider("app-check-internal")),function(u,h){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new de(Z.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Qi(u.options.projectId,h)}(a,s),a);return o=Object.assign({useFetchStreams:t},o),l._setSettings(o),l},"PUBLIC").setMultipleInstances(!0)),Hn(Vm,qm,e),Hn(Vm,qm,"esm2017")})();const uc=Object.freeze(Object.defineProperty({__proto__:null,AbstractUserDataWriter:dp,AggregateField:Gs,AggregateQuerySnapshot:G0,Bytes:nr,CACHE_SIZE_UNLIMITED:W2,CollectionReference:En,DocumentReference:Ft,DocumentSnapshot:qr,FieldPath:lr,FieldValue:cr,Firestore:gt,FirestoreError:de,GeoPoint:$c,LoadBundleTask:U0,PersistentCacheIndexManager:dv,Query:Yt,QueryCompositeFilterConstraint:Jr,QueryConstraint:lo,QueryDocumentSnapshot:Xo,QueryEndAtConstraint:Na,QueryFieldFilterConstraint:co,QueryLimitConstraint:za,QueryOrderByConstraint:Xc,QuerySnapshot:Ur,QueryStartAtConstraint:Da,SnapshotMetadata:Li,Timestamp:xt,Transaction:cv,VectorValue:Pa,WriteBatch:lv,_AutoId:ah,_ByteString:At,_DatabaseId:Qi,_DocumentKey:Te,_EmptyAppCheckTokenProvider:TT,_EmptyAuthCredentialsProvider:Rx,_FieldPath:St,_TestingHooks:YI,_cast:Ze,_debugAssert:xT,_internalAggregationQueryToProtoRunAggregationQueryRequest:QI,_internalQueryToProtoQueryTarget:KI,_isBase64Available:oj,_logWarn:Tn,_validateIsNotUsedTogether:L0,addDoc:$i,aggregateFieldEqual:pI,aggregateQuerySnapshotEqual:mI,and:iI,arrayRemove:WI,arrayUnion:MI,average:hI,clearIndexedDbPersistence:q2,collection:Wt,collectionGroup:N2,connectFirestoreEmulator:q0,count:sv,deleteAllPersistentCacheIndexes:GI,deleteDoc:dc,deleteField:NI,disableNetwork:$2,disablePersistentCacheIndexAutoCreation:$I,doc:Ot,documentId:Y2,enableIndexedDbPersistence:O2,enableMultiTabIndexedDbPersistence:V2,enableNetwork:H2,enablePersistentCacheIndexAutoCreation:HI,endAt:cI,endBefore:lI,ensureFirestoreConfigured:It,executeWrite:uo,getAggregateFromServer:ov,getCountFromServer:kI,getDoc:fi,getDocFromCache:yI,getDocFromServer:xI,getDocs:kn,getDocsFromCache:bI,getDocsFromServer:vI,getFirestore:Ba,getPersistentCacheIndexManager:UI,increment:LI,initializeFirestore:L2,limit:rI,limitToLast:sI,loadBundle:K2,memoryEagerGarbageCollector:II,memoryLocalCache:RI,memoryLruGarbageCollector:CI,namedQuery:Q2,onSnapshot:up,onSnapshotsInSync:wI,or:nI,orderBy:lc,persistentLocalCache:AI,persistentMultipleTabManager:PI,persistentSingleTabManager:av,query:un,queryEqual:tp,refEqual:M2,runTransaction:DI,serverTimestamp:pp,setDoc:Ma,setIndexConfiguration:qI,setLogLevel:yT,snapshotEqual:fI,startAfter:aI,startAt:oI,sum:uI,terminate:G2,updateDoc:cc,vector:OI,waitForPendingWrites:U2,where:Lt,writeBatch:VI},Symbol.toStringTag,{value:"Module"}));function gp(n,e){var t={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(n);s<i.length;s++)e.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(n,i[s])&&(t[i[s]]=n[i[s]]);return t}function hv(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const pv=hv,mv=new ba("auth","Firebase",hv());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hc=new nh("@firebase/auth");function XI(n,...e){hc.logLevel<=tt.WARN&&hc.warn(`Auth (${Qr}): ${n}`,...e)}function zl(n,...e){hc.logLevel<=tt.ERROR&&hc.error(`Auth (${Qr}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _n(n,...e){throw yp(n,...e)}function Bn(n,...e){return yp(n,...e)}function fp(n,e,t){const i=Object.assign(Object.assign({},pv()),{[e]:t});return new ba("auth","Firebase",i).create(e,{appName:n.name})}function ui(n){return fp(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function JI(n,e,t){const i=t;if(!(e instanceof i))throw i.name!==e.constructor.name&&_n(n,"argument-error"),fp(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function yp(n,...e){if(typeof n!="string"){const t=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=n.name),n._errorFactory.create(t,...i)}return mv.create(n,...e)}function Oe(n,e,...t){if(!n)throw yp(e,...t)}function ci(n){const e="INTERNAL ASSERTION FAILED: "+n;throw zl(e),new Error(e)}function yi(n,e){n||ci(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wu(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function ZI(){return pf()==="http:"||pf()==="https:"}function pf(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eC(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(ZI()||Q1()||"connection"in navigator)?navigator.onLine:!0}function tC(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wa{constructor(e,t){this.shortDelay=e,this.longDelay=t,yi(t>e,"Short delay should be less than long delay!"),this.isMobile=G1()||Y1()}get(){return eC()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xp(n,e){yi(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gv{static initialize(e,t,i){this.fetchImpl=e,t&&(this.headersImpl=t),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;ci("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;ci("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;ci("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nC={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iC=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],rC=new Wa(3e4,6e4);function Si(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}async function Jn(n,e,t,i,s={}){return fv(n,s,async()=>{let o={},a={};i&&(e==="GET"?a=i:o={body:JSON.stringify(i)});const l=va(Object.assign({key:n.config.apiKey},a)).slice(1),c=await n._getAdditionalHeaders();c["Content-Type"]="application/json",n.languageCode&&(c["X-Firebase-Locale"]=n.languageCode);const u=Object.assign({method:e,headers:c},o);return K1()||(u.referrerPolicy="no-referrer"),n.emulatorConfig&&xi(n.emulatorConfig.host)&&(u.credentials="include"),gv.fetch()(await yv(n,n.config.apiHost,t,l),u)})}async function fv(n,e,t){n._canInitEmulator=!1;const i=Object.assign(Object.assign({},nC),e);try{const s=new oC(n),o=await Promise.race([t(),s.promise]);s.clearNetworkTimeout();const a=await o.json();if("needConfirmation"in a)throw bl(n,"account-exists-with-different-credential",a);if(o.ok&&!("errorMessage"in a))return a;{const l=o.ok?a.errorMessage:a.error.message,[c,u]=l.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw bl(n,"credential-already-in-use",a);if(c==="EMAIL_EXISTS")throw bl(n,"email-already-in-use",a);if(c==="USER_DISABLED")throw bl(n,"user-disabled",a);const h=i[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw fp(n,h,u);_n(n,h)}}catch(s){if(s instanceof Xn)throw s;_n(n,"network-request-failed",{message:String(s)})}}async function La(n,e,t,i,s={}){const o=await Jn(n,e,t,i,s);return"mfaPendingCredential"in o&&_n(n,"multi-factor-auth-required",{_serverResponse:o}),o}async function yv(n,e,t,i){const s=`${e}${t}?${i}`,o=n,a=o.config.emulator?xp(n.config,s):`${n.config.apiScheme}://${s}`;return iC.includes(t)&&(await o._persistenceManagerAvailable,o._getPersistenceType()==="COOKIE")?o._getPersistence()._getFinalTarget(a).toString():a}function sC(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class oC{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,i)=>{this.timer=setTimeout(()=>i(Bn(this.auth,"network-request-failed")),rC.get())})}}function bl(n,e,t){const i={appName:n.name};t.email&&(i.email=t.email),t.phoneNumber&&(i.phoneNumber=t.phoneNumber);const s=Bn(n,e,i);return s.customData._tokenResponse=t,s}function mf(n){return n!==void 0&&n.enterprise!==void 0}class aC{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return sC(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function lC(n,e){return Jn(n,"GET","/v2/recaptchaConfig",Si(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function cC(n,e){return Jn(n,"POST","/v1/accounts:delete",e)}async function pc(n,e){return Jn(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jo(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function xv(n,e=!1){const t=lt(n),i=await t.getIdToken(e),s=bp(i);Oe(s&&s.exp&&s.auth_time&&s.iat,t.auth,"internal-error");const o=typeof s.firebase=="object"?s.firebase:void 0,a=o==null?void 0:o.sign_in_provider;return{claims:s,token:i,authTime:Jo(Ld(s.auth_time)),issuedAtTime:Jo(Ld(s.iat)),expirationTime:Jo(Ld(s.exp)),signInProvider:a||null,signInSecondFactor:(o==null?void 0:o.sign_in_second_factor)||null}}function Ld(n){return Number(n)*1e3}function bp(n){const[e,t,i]=n.split(".");if(e===void 0||t===void 0||i===void 0)return zl("JWT malformed, contained fewer than 3 sections"),null;try{const s=sx(t);return s?JSON.parse(s):(zl("Failed to decode base64 JWT payload"),null)}catch(s){return zl("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function gf(n){const e=bp(n);return Oe(e,"internal-error"),Oe(typeof e.exp<"u","internal-error"),Oe(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ks(n,e,t=!1){if(t)return e;try{return await e}catch(i){throw i instanceof Xn&&dC(i)&&n.auth.currentUser===n&&await n.auth.signOut(),i}}function dC({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uC{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const i=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),i}else{this.errorBackoff=3e4;const s=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lu{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Jo(this.lastLoginAt),this.creationTime=Jo(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function mc(n){var e;const t=n.auth,i=await n.getIdToken(),s=await Ks(n,pc(t,{idToken:i}));Oe(s==null?void 0:s.users.length,t,"internal-error");const o=s.users[0];n._notifyReloadListener(o);const a=!((e=o.providerUserInfo)===null||e===void 0)&&e.length?vv(o.providerUserInfo):[],l=hC(n.providerData,a),c=n.isAnonymous,u=!(n.email&&o.passwordHash)&&!(l!=null&&l.length),h=c?u:!1,p={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:l,metadata:new Lu(o.createdAt,o.lastLoginAt),isAnonymous:h};Object.assign(n,p)}async function bv(n){const e=lt(n);await mc(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function hC(n,e){return[...n.filter(i=>!e.some(s=>s.providerId===i.providerId)),...e]}function vv(n){return n.map(e=>{var{providerId:t}=e,i=gp(e,["providerId"]);return{providerId:t,uid:i.rawId||"",displayName:i.displayName||null,email:i.email||null,phoneNumber:i.phoneNumber||null,photoURL:i.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function pC(n,e){const t=await fv(n,{},async()=>{const i=va({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:o}=n.config,a=await yv(n,s,"/v1/token",`key=${o}`),l=await n._getAdditionalHeaders();l["Content-Type"]="application/x-www-form-urlencoded";const c={method:"POST",headers:l,body:i};return n.emulatorConfig&&xi(n.emulatorConfig.host)&&(c.credentials="include"),gv.fetch()(a,c)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function mC(n,e){return Jn(n,"POST","/v2/accounts:revokeToken",Si(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ks{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Oe(e.idToken,"internal-error"),Oe(typeof e.idToken<"u","internal-error"),Oe(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):gf(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Oe(e.length!==0,"internal-error");const t=gf(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(Oe(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:i,refreshToken:s,expiresIn:o}=await pC(e,t);this.updateTokensAndExpiration(i,s,Number(o))}updateTokensAndExpiration(e,t,i){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,t){const{refreshToken:i,accessToken:s,expirationTime:o}=t,a=new ks;return i&&(Oe(typeof i=="string","internal-error",{appName:e}),a.refreshToken=i),s&&(Oe(typeof s=="string","internal-error",{appName:e}),a.accessToken=s),o&&(Oe(typeof o=="number","internal-error",{appName:e}),a.expirationTime=o),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new ks,this.toJSON())}_performRefresh(){return ci("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fi(n,e){Oe(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class An{constructor(e){var{uid:t,auth:i,stsTokenManager:s}=e,o=gp(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new uC(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=i,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=o.displayName||null,this.email=o.email||null,this.emailVerified=o.emailVerified||!1,this.phoneNumber=o.phoneNumber||null,this.photoURL=o.photoURL||null,this.isAnonymous=o.isAnonymous||!1,this.tenantId=o.tenantId||null,this.providerData=o.providerData?[...o.providerData]:[],this.metadata=new Lu(o.createdAt||void 0,o.lastLoginAt||void 0)}async getIdToken(e){const t=await Ks(this,this.stsTokenManager.getToken(this.auth,e));return Oe(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return xv(this,e)}reload(){return bv(this)}_assign(e){this!==e&&(Oe(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new An(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){Oe(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),t&&await mc(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(mn(this.auth.app))return Promise.reject(ui(this.auth));const e=await this.getIdToken();return await Ks(this,cC(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var i,s,o,a,l,c,u,h;const p=(i=t.displayName)!==null&&i!==void 0?i:void 0,f=(s=t.email)!==null&&s!==void 0?s:void 0,b=(o=t.phoneNumber)!==null&&o!==void 0?o:void 0,x=(a=t.photoURL)!==null&&a!==void 0?a:void 0,S=(l=t.tenantId)!==null&&l!==void 0?l:void 0,w=(c=t._redirectEventId)!==null&&c!==void 0?c:void 0,I=(u=t.createdAt)!==null&&u!==void 0?u:void 0,j=(h=t.lastLoginAt)!==null&&h!==void 0?h:void 0,{uid:A,emailVerified:D,isAnonymous:O,providerData:P,stsTokenManager:B}=t;Oe(A&&B,e,"internal-error");const k=ks.fromJSON(this.name,B);Oe(typeof A=="string",e,"internal-error"),Fi(p,e.name),Fi(f,e.name),Oe(typeof D=="boolean",e,"internal-error"),Oe(typeof O=="boolean",e,"internal-error"),Fi(b,e.name),Fi(x,e.name),Fi(S,e.name),Fi(w,e.name),Fi(I,e.name),Fi(j,e.name);const T=new An({uid:A,auth:e,email:f,emailVerified:D,displayName:p,isAnonymous:O,photoURL:x,phoneNumber:b,tenantId:S,stsTokenManager:k,createdAt:I,lastLoginAt:j});return P&&Array.isArray(P)&&(T.providerData=P.map(R=>Object.assign({},R))),w&&(T._redirectEventId=w),T}static async _fromIdTokenResponse(e,t,i=!1){const s=new ks;s.updateFromServerResponse(t);const o=new An({uid:t.localId,auth:e,stsTokenManager:s,isAnonymous:i});return await mc(o),o}static async _fromGetAccountInfoResponse(e,t,i){const s=t.users[0];Oe(s.localId!==void 0,"internal-error");const o=s.providerUserInfo!==void 0?vv(s.providerUserInfo):[],a=!(s.email&&s.passwordHash)&&!(o!=null&&o.length),l=new ks;l.updateFromIdToken(i);const c=new An({uid:s.localId,auth:e,stsTokenManager:l,isAnonymous:a}),u={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new Lu(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(o!=null&&o.length)};return Object.assign(c,u),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ff=new Map;function di(n){yi(n instanceof Function,"Expected a class definition");let e=ff.get(n);return e?(yi(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,ff.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wv{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}wv.type="NONE";const Ou=wv;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dl(n,e,t){return`firebase:${n}:${e}:${t}`}class Ss{constructor(e,t,i){this.persistence=e,this.auth=t,this.userKey=i;const{config:s,name:o}=this.auth;this.fullUserKey=Dl(this.userKey,s.apiKey,o),this.fullPersistenceKey=Dl("persistence",s.apiKey,o),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await pc(this.auth,{idToken:e}).catch(()=>{});return t?An._fromGetAccountInfoResponse(this.auth,t,e):null}return An._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,i="authUser"){if(!t.length)return new Ss(di(Ou),e,i);const s=(await Promise.all(t.map(async u=>{if(await u._isAvailable())return u}))).filter(u=>u);let o=s[0]||di(Ou);const a=Dl(i,e.config.apiKey,e.name);let l=null;for(const u of t)try{const h=await u._get(a);if(h){let p;if(typeof h=="string"){const f=await pc(e,{idToken:h}).catch(()=>{});if(!f)break;p=await An._fromGetAccountInfoResponse(e,f,h)}else p=An._fromJSON(e,h);u!==o&&(l=p),o=u;break}}catch{}const c=s.filter(u=>u._shouldAllowMigration);return!o._shouldAllowMigration||!c.length?new Ss(o,e,i):(o=c[0],l&&await o._set(a,l.toJSON()),await Promise.all(t.map(async u=>{if(u!==o)try{await u._remove(a)}catch{}})),new Ss(o,e,i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yf(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(jv(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(kv(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Iv(e))return"Blackberry";if(Cv(e))return"Webos";if(Sv(e))return"Safari";if((e.includes("chrome/")||Tv(e))&&!e.includes("edge/"))return"Chrome";if(_v(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=n.match(t);if((i==null?void 0:i.length)===2)return i[1]}return"Other"}function kv(n=qt()){return/firefox\//i.test(n)}function Sv(n=qt()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Tv(n=qt()){return/crios\//i.test(n)}function jv(n=qt()){return/iemobile/i.test(n)}function _v(n=qt()){return/android/i.test(n)}function Iv(n=qt()){return/blackberry/i.test(n)}function Cv(n=qt()){return/webos/i.test(n)}function vp(n=qt()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function gC(n=qt()){var e;return vp(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function fC(){return X1()&&document.documentMode===10}function Rv(n=qt()){return vp(n)||_v(n)||Cv(n)||Iv(n)||/windows phone/i.test(n)||jv(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Av(n,e=[]){let t;switch(n){case"Browser":t=yf(qt());break;case"Worker":t=`${yf(qt())}-${n}`;break;default:t=n}const i=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Qr}/${i}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yC{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const i=o=>new Promise((a,l)=>{try{const c=e(o);a(c)}catch(c){l(c)}});i.onAbort=t,this.queue.push(i);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const i of this.queue)await i(e),i.onAbort&&t.push(i.onAbort)}catch(i){t.reverse();for(const s of t)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i==null?void 0:i.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xC(n,e={}){return Jn(n,"GET","/v2/passwordPolicy",Si(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bC=6;class vC{constructor(e){var t,i,s,o;const a=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=a.minPasswordLength)!==null&&t!==void 0?t:bC,a.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=a.maxPasswordLength),a.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=a.containsLowercaseCharacter),a.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=a.containsUppercaseCharacter),a.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=a.containsNumericCharacter),a.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=a.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(s=(i=e.allowedNonAlphanumericCharacters)===null||i===void 0?void 0:i.join(""))!==null&&s!==void 0?s:"",this.forceUpgradeOnSignin=(o=e.forceUpgradeOnSignin)!==null&&o!==void 0?o:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,i,s,o,a,l;const c={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,c),this.validatePasswordCharacterOptions(e,c),c.isValid&&(c.isValid=(t=c.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),c.isValid&&(c.isValid=(i=c.meetsMaxPasswordLength)!==null&&i!==void 0?i:!0),c.isValid&&(c.isValid=(s=c.containsLowercaseLetter)!==null&&s!==void 0?s:!0),c.isValid&&(c.isValid=(o=c.containsUppercaseLetter)!==null&&o!==void 0?o:!0),c.isValid&&(c.isValid=(a=c.containsNumericCharacter)!==null&&a!==void 0?a:!0),c.isValid&&(c.isValid=(l=c.containsNonAlphanumericCharacter)!==null&&l!==void 0?l:!0),c}validatePasswordLengthOptions(e,t){const i=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;i&&(t.meetsMinPasswordLength=e.length>=i),s&&(t.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let i;for(let s=0;s<e.length;s++)i=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(t,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,t,i,s,o){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=o))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wC{constructor(e,t,i,s){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=i,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new xf(this),this.idTokenSubscription=new xf(this),this.beforeStateQueue=new yC(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=mv,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(o=>this._resolvePersistenceManagerAvailable=o)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=di(t)),this._initializationPromise=this.queue(async()=>{var i,s,o;if(!this._deleted&&(this.persistenceManager=await Ss.create(this,e),(i=this._resolvePersistenceManagerAvailable)===null||i===void 0||i.call(this),!this._deleted)){if(!((s=this._popupRedirectResolver)===null||s===void 0)&&s._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((o=this.currentUser)===null||o===void 0?void 0:o.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await pc(this,{idToken:e}),i=await An._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(i)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(mn(this.app)){const a=this.app.settings.authIdToken;return a?new Promise(l=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(l,l))}):this.directlySetCurrentUser(null)}const i=await this.assertedPersistence.getCurrentUser();let s=i,o=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const a=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,l=s==null?void 0:s._redirectEventId,c=await this.tryRedirectSignIn(e);(!a||a===l)&&(c!=null&&c.user)&&(s=c.user,o=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(o)try{await this.beforeStateQueue.runMiddleware(s)}catch(a){s=i,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return Oe(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await mc(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=tC()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(mn(this.app))return Promise.reject(ui(this));const t=e?lt(e):null;return t&&Oe(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Oe(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return mn(this.app)?Promise.reject(ui(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return mn(this.app)?Promise.reject(ui(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(di(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await xC(this),t=new vC(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new ba("auth","Firebase",e())}onAuthStateChanged(e,t,i){return this.registerStateListener(this.authStateSubscription,e,t,i)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,i){return this.registerStateListener(this.idTokenSubscription,e,t,i)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const i=this.onAuthStateChanged(()=>{i(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(i.tenantId=this.tenantId),await mC(this,i)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,t){const i=await this.getOrInitRedirectPersistenceManager(t);return e===null?i.removeCurrentUser():i.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&di(e)||this._popupRedirectResolver;Oe(t,this,"argument-error"),this.redirectPersistenceManager=await Ss.create(this,[di(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,i;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((i=this.redirectUser)===null||i===void 0?void 0:i._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const i=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==i&&(this.lastNotifiedUid=i,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,i,s){if(this._deleted)return()=>{};const o=typeof t=="function"?t:t.next.bind(t);let a=!1;const l=this._isInitialized?Promise.resolve():this._initializationPromise;if(Oe(l,this,"internal-error"),l.then(()=>{a||o(this.currentUser)}),typeof t=="function"){const c=e.addObserver(t,i,s);return()=>{a=!0,c()}}else{const c=e.addObserver(t);return()=>{a=!0,c()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Oe(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Av(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const i=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());i&&(t["X-Firebase-Client"]=i);const s=await this._getAppCheckToken();return s&&(t["X-Firebase-AppCheck"]=s),t}async _getAppCheckToken(){var e;if(mn(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const t=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return t!=null&&t.error&&XI(`Error while retrieving App Check token: ${t.error}`),t==null?void 0:t.token}}function Zn(n){return lt(n)}class xf{constructor(e){this.auth=e,this.observer=null,this.addObserver=iS(t=>this.observer=t)}get next(){return Oe(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Zc={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function kC(n){Zc=n}function Ev(n){return Zc.loadJS(n)}function SC(){return Zc.recaptchaEnterpriseScript}function TC(){return Zc.gapiScript}function jC(n){return`__${n}${Math.floor(Math.random()*1e6)}`}class _C{constructor(){this.enterprise=new IC}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class IC{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const CC="recaptcha-enterprise",Bv="NO_RECAPTCHA";class RC{constructor(e){this.type=CC,this.auth=Zn(e)}async verify(e="verify",t=!1){async function i(o){if(!t){if(o.tenantId==null&&o._agentRecaptchaConfig!=null)return o._agentRecaptchaConfig.siteKey;if(o.tenantId!=null&&o._tenantRecaptchaConfigs[o.tenantId]!==void 0)return o._tenantRecaptchaConfigs[o.tenantId].siteKey}return new Promise(async(a,l)=>{lC(o,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(c=>{if(c.recaptchaKey===void 0)l(new Error("recaptcha Enterprise site key undefined"));else{const u=new aC(c);return o.tenantId==null?o._agentRecaptchaConfig=u:o._tenantRecaptchaConfigs[o.tenantId]=u,a(u.siteKey)}}).catch(c=>{l(c)})})}function s(o,a,l){const c=window.grecaptcha;mf(c)?c.enterprise.ready(()=>{c.enterprise.execute(o,{action:e}).then(u=>{a(u)}).catch(()=>{a(Bv)})}):l(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new _C().execute("siteKey",{action:"verify"}):new Promise((o,a)=>{i(this.auth).then(l=>{if(!t&&mf(window.grecaptcha))s(l,o,a);else{if(typeof window>"u"){a(new Error("RecaptchaVerifier is only supported in browser"));return}let c=SC();c.length!==0&&(c+=l),Ev(c).then(()=>{s(l,o,a)}).catch(u=>{a(u)})}}).catch(l=>{a(l)})})}}async function bf(n,e,t,i=!1,s=!1){const o=new RC(n);let a;if(s)a=Bv;else try{a=await o.verify(t)}catch{a=await o.verify(t,!0)}const l=Object.assign({},e);if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in l){const c=l.phoneEnrollmentInfo.phoneNumber,u=l.phoneEnrollmentInfo.recaptchaToken;Object.assign(l,{phoneEnrollmentInfo:{phoneNumber:c,recaptchaToken:u,captchaResponse:a,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in l){const c=l.phoneSignInInfo.recaptchaToken;Object.assign(l,{phoneSignInInfo:{recaptchaToken:c,captchaResponse:a,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return l}return i?Object.assign(l,{captchaResp:a}):Object.assign(l,{captchaResponse:a}),Object.assign(l,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(l,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),l}async function gc(n,e,t,i,s){var o;if(!((o=n._getRecaptchaConfig())===null||o===void 0)&&o.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const a=await bf(n,e,t,t==="getOobCode");return i(n,a)}else return i(n,e).catch(async a=>{if(a.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const l=await bf(n,e,t,t==="getOobCode");return i(n,l)}else return Promise.reject(a)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pv(n,e){const t=Js(n,"auth");if(t.isInitialized()){const s=t.getImmediate(),o=t.getOptions();if(Pn(o,e??{}))return s;_n(s,"already-initialized")}return t.initialize({options:e})}function AC(n,e){const t=(e==null?void 0:e.persistence)||[],i=(Array.isArray(t)?t:[t]).map(di);e!=null&&e.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(i,e==null?void 0:e.popupRedirectResolver)}function Fv(n,e,t){const i=Zn(n);Oe(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const s=!1,o=zv(e),{host:a,port:l}=EC(e),c=l===null?"":`:${l}`,u={url:`${o}//${a}${c}/`},h=Object.freeze({host:a,port:l,protocol:o.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!i._canInitEmulator){Oe(i.config.emulator&&i.emulatorConfig,i,"emulator-config-failed"),Oe(Pn(u,i.config.emulator)&&Pn(h,i.emulatorConfig),i,"emulator-config-failed");return}i.config.emulator=u,i.emulatorConfig=h,i.settings.appVerificationDisabledForTesting=!0,xi(a)?(Ic(`${o}//${a}${c}`),th("Auth",!0)):BC()}function zv(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function EC(n){const e=zv(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const i=t[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(i);if(s){const o=s[1];return{host:o,port:vf(i.substr(o.length+1))}}else{const[o,a]=i.split(":");return{host:o,port:vf(a)}}}function vf(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function BC(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ed{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return ci("not implemented")}_getIdTokenResponse(e){return ci("not implemented")}_linkToIdToken(e,t){return ci("not implemented")}_getReauthenticationResolver(e){return ci("not implemented")}}async function PC(n,e){return Jn(n,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function FC(n,e){return La(n,"POST","/v1/accounts:signInWithPassword",Si(n,e))}async function zC(n,e){return Jn(n,"POST","/v1/accounts:sendOobCode",Si(n,e))}async function DC(n,e){return zC(n,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function NC(n,e){return La(n,"POST","/v1/accounts:signInWithEmailLink",Si(n,e))}async function MC(n,e){return La(n,"POST","/v1/accounts:signInWithEmailLink",Si(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qs extends ed{constructor(e,t,i,s=null){super("password",i),this._email=e,this._password=t,this._tenantId=s}static _fromEmailAndPassword(e,t){return new Qs(e,t,"password")}static _fromEmailAndCode(e,t,i=null){return new Qs(e,t,"emailLink",i)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t!=null&&t.email&&(t!=null&&t.password)){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return gc(e,t,"signInWithPassword",FC);case"emailLink":return NC(e,{email:this._email,oobCode:this._password});default:_n(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const i={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return gc(e,i,"signUpPassword",PC);case"emailLink":return MC(e,{idToken:t,email:this._email,oobCode:this._password});default:_n(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ts(n,e){return La(n,"POST","/v1/accounts:signInWithIdp",Si(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WC="http://localhost";class Yn extends ed{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Yn(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):_n("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:s}=t,o=gp(t,["providerId","signInMethod"]);if(!i||!s)return null;const a=new Yn(i,s);return a.idToken=o.idToken||void 0,a.accessToken=o.accessToken||void 0,a.secret=o.secret,a.nonce=o.nonce,a.pendingToken=o.pendingToken||null,a}_getIdTokenResponse(e){const t=this.buildRequest();return Ts(e,t)}_linkToIdToken(e,t){const i=this.buildRequest();return i.idToken=t,Ts(e,i)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Ts(e,t)}buildRequest(){const e={requestUri:WC,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=va(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LC(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function OC(n){const e=Do(No(n)).link,t=e?Do(No(e)).deep_link_id:null,i=Do(No(n)).deep_link_id;return(i?Do(No(i)).link:null)||i||t||e||n}class td{constructor(e){var t,i,s,o,a,l;const c=Do(No(e)),u=(t=c.apiKey)!==null&&t!==void 0?t:null,h=(i=c.oobCode)!==null&&i!==void 0?i:null,p=LC((s=c.mode)!==null&&s!==void 0?s:null);Oe(u&&h&&p,"argument-error"),this.apiKey=u,this.operation=p,this.code=h,this.continueUrl=(o=c.continueUrl)!==null&&o!==void 0?o:null,this.languageCode=(a=c.lang)!==null&&a!==void 0?a:null,this.tenantId=(l=c.tenantId)!==null&&l!==void 0?l:null}static parseLink(e){const t=OC(e);try{return new td(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zr{constructor(){this.providerId=Zr.PROVIDER_ID}static credential(e,t){return Qs._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const i=td.parseLink(t);return Oe(i,"argument-error"),Qs._fromEmailAndCode(e,i.code,i.tenantId)}}Zr.PROVIDER_ID="password";Zr.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Zr.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wp{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ho extends wp{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class js extends ho{static credentialFromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;return Oe("providerId"in t&&"signInMethod"in t,"argument-error"),Yn._fromParams(t)}credential(e){return this._credential(Object.assign(Object.assign({},e),{nonce:e.rawNonce}))}_credential(e){return Oe(e.idToken||e.accessToken,"argument-error"),Yn._fromParams(Object.assign(Object.assign({},e),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(e){return js.oauthCredentialFromTaggedObject(e)}static credentialFromError(e){return js.oauthCredentialFromTaggedObject(e.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:i,oauthTokenSecret:s,pendingToken:o,nonce:a,providerId:l}=e;if(!i&&!s&&!t&&!o||!l)return null;try{return new js(l)._credential({idToken:t,accessToken:i,nonce:a,pendingToken:o})}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class si extends ho{constructor(){super("facebook.com")}static credential(e){return Yn._fromParams({providerId:si.PROVIDER_ID,signInMethod:si.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return si.credentialFromTaggedObject(e)}static credentialFromError(e){return si.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return si.credential(e.oauthAccessToken)}catch{return null}}}si.FACEBOOK_SIGN_IN_METHOD="facebook.com";si.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class On extends ho{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Yn._fromParams({providerId:On.PROVIDER_ID,signInMethod:On.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return On.credentialFromTaggedObject(e)}static credentialFromError(e){return On.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:i}=e;if(!t&&!i)return null;try{return On.credential(t,i)}catch{return null}}}On.GOOGLE_SIGN_IN_METHOD="google.com";On.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oi extends ho{constructor(){super("github.com")}static credential(e){return Yn._fromParams({providerId:oi.PROVIDER_ID,signInMethod:oi.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return oi.credentialFromTaggedObject(e)}static credentialFromError(e){return oi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return oi.credential(e.oauthAccessToken)}catch{return null}}}oi.GITHUB_SIGN_IN_METHOD="github.com";oi.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ai extends ho{constructor(){super("twitter.com")}static credential(e,t){return Yn._fromParams({providerId:ai.PROVIDER_ID,signInMethod:ai.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return ai.credentialFromTaggedObject(e)}static credentialFromError(e){return ai.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:i}=e;if(!t||!i)return null;try{return ai.credential(t,i)}catch{return null}}}ai.TWITTER_SIGN_IN_METHOD="twitter.com";ai.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function VC(n,e){return La(n,"POST","/v1/accounts:signUp",Si(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hr{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,i,s=!1){const o=await An._fromIdTokenResponse(e,i,s),a=wf(i);return new Hr({user:o,providerId:a,_tokenResponse:i,operationType:t})}static async _forOperation(e,t,i){await e._updateTokensIfNecessary(i,!0);const s=wf(i);return new Hr({user:e,providerId:s,_tokenResponse:i,operationType:t})}}function wf(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fc extends Xn{constructor(e,t,i,s){var o;super(t.code,t.message),this.operationType=i,this.user=s,Object.setPrototypeOf(this,fc.prototype),this.customData={appName:e.name,tenantId:(o=e.tenantId)!==null&&o!==void 0?o:void 0,_serverResponse:t.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,t,i,s){return new fc(e,t,i,s)}}function Dv(n,e,t,i){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(o=>{throw o.code==="auth/multi-factor-auth-required"?fc._fromErrorAndOperation(n,o,e,i):o})}async function qC(n,e,t=!1){const i=await Ks(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return Hr._forOperation(n,"link",i)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function UC(n,e,t=!1){const{auth:i}=n;if(mn(i.app))return Promise.reject(ui(i));const s="reauthenticate";try{const o=await Ks(n,Dv(i,s,e,n),t);Oe(o.idToken,i,"internal-error");const a=bp(o.idToken);Oe(a,i,"internal-error");const{sub:l}=a;return Oe(n.uid===l,i,"user-mismatch"),Hr._forOperation(n,s,o)}catch(o){throw(o==null?void 0:o.code)==="auth/user-not-found"&&_n(i,"user-mismatch"),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Nv(n,e,t=!1){if(mn(n.app))return Promise.reject(ui(n));const i="signIn",s=await Dv(n,i,e),o=await Hr._fromIdTokenResponse(n,i,s);return t||await n._updateCurrentUser(o.user),o}async function Mv(n,e){return Nv(Zn(n),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Wv(n){const e=Zn(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function Lv(n,e,t){const i=Zn(n);await gc(i,{requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"},"getOobCode",DC)}async function kp(n,e,t){if(mn(n.app))return Promise.reject(ui(n));const i=Zn(n),a=await gc(i,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",VC).catch(c=>{throw c.code==="auth/password-does-not-meet-requirements"&&Wv(n),c}),l=await Hr._fromIdTokenResponse(i,"signIn",a);return await i._updateCurrentUser(l.user),l}function Ov(n,e,t){return mn(n.app)?Promise.reject(ui(n)):Mv(lt(n),Zr.credential(e,t)).catch(async i=>{throw i.code==="auth/password-does-not-meet-requirements"&&Wv(n),i})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function HC(n,e){return Jn(n,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function yc(n,{displayName:e,photoURL:t}){if(e===void 0&&t===void 0)return;const i=lt(n),o={idToken:await i.getIdToken(),displayName:e,photoUrl:t,returnSecureToken:!0},a=await Ks(i,HC(i.auth,o));i.displayName=a.displayName||null,i.photoURL=a.photoUrl||null;const l=i.providerData.find(({providerId:c})=>c==="password");l&&(l.displayName=i.displayName,l.photoURL=i.photoURL),await i._updateTokensIfNecessary(a)}function Vv(n,e,t,i){return lt(n).onIdTokenChanged(e,t,i)}function qv(n,e,t){return lt(n).beforeAuthStateChanged(e,t)}function ur(n,e,t,i){return lt(n).onAuthStateChanged(e,t,i)}function hn(n){return lt(n).signOut()}const xc="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uv{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(xc,"1"),this.storage.removeItem(xc),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $C=1e3,GC=10;class Hv extends Uv{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=Rv(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const i=this.storage.getItem(t),s=this.localCache[t];i!==s&&e(t,s,i)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((a,l,c)=>{this.notifyListeners(a,c)});return}const i=e.key;t?this.detachListener():this.stopPolling();const s=()=>{const a=this.storage.getItem(i);!t&&this.localCache[i]===a||this.notifyListeners(i,a)},o=this.storage.getItem(i);fC()&&o!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,GC):s()}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const s of Array.from(i))s(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:i}),!0)})},$C)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}Hv.type="LOCAL";const $v=Hv;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gv extends Uv{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}Gv.type="SESSION";const Sp=Gv;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KC(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nd{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(s=>s.isListeningto(e));if(t)return t;const i=new nd(e);return this.receivers.push(i),i}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:i,eventType:s,data:o}=t.data,a=this.handlersMap[s];if(!(a!=null&&a.size))return;t.ports[0].postMessage({status:"ack",eventId:i,eventType:s});const l=Array.from(a).map(async u=>u(t.origin,o)),c=await KC(l);t.ports[0].postMessage({status:"done",eventId:i,eventType:s,response:c})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}nd.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tp(n="",e=10){let t="";for(let i=0;i<e;i++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QC{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,i=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let o,a;return new Promise((l,c)=>{const u=Tp("",20);s.port1.start();const h=setTimeout(()=>{c(new Error("unsupported_event"))},i);a={messageChannel:s,onMessage(p){const f=p;if(f.data.eventId===u)switch(f.data.status){case"ack":clearTimeout(h),o=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(o),l(f.data.response);break;default:clearTimeout(h),clearTimeout(o),c(new Error("invalid_response"));break}}},this.handlers.add(a),s.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:u,data:t},[s.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kn(){return window}function YC(n){Kn().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kv(){return typeof Kn().WorkerGlobalScope<"u"&&typeof Kn().importScripts=="function"}async function XC(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function JC(){var n;return((n=navigator==null?void 0:navigator.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function ZC(){return Kv()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qv="firebaseLocalStorageDb",eR=1,bc="firebaseLocalStorage",Yv="fbase_key";class Oa{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function id(n,e){return n.transaction([bc],e?"readwrite":"readonly").objectStore(bc)}function tR(){const n=indexedDB.deleteDatabase(Qv);return new Oa(n).toPromise()}function Vu(){const n=indexedDB.open(Qv,eR);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const i=n.result;try{i.createObjectStore(bc,{keyPath:Yv})}catch(s){t(s)}}),n.addEventListener("success",async()=>{const i=n.result;i.objectStoreNames.contains(bc)?e(i):(i.close(),await tR(),e(await Vu()))})})}async function kf(n,e,t){const i=id(n,!0).put({[Yv]:e,value:t});return new Oa(i).toPromise()}async function nR(n,e){const t=id(n,!1).get(e),i=await new Oa(t).toPromise();return i===void 0?null:i.value}function Sf(n,e){const t=id(n,!0).delete(e);return new Oa(t).toPromise()}const iR=800,rR=3;class Xv{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Vu(),this.db)}async _withRetries(e){let t=0;for(;;)try{const i=await this._openDb();return await e(i)}catch(i){if(t++>rR)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Kv()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=nd._getInstance(ZC()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await XC(),!this.activeServiceWorker)return;this.sender=new QC(this.activeServiceWorker);const i=await this.sender._send("ping",{},800);i&&!((e=i[0])===null||e===void 0)&&e.fulfilled&&!((t=i[0])===null||t===void 0)&&t.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||JC()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Vu();return await kf(e,xc,"1"),await Sf(e,xc),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(i=>kf(i,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(i=>nR(i,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>Sf(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const o=id(s,!1).getAll();return new Oa(o).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],i=new Set;if(e.length!==0)for(const{fbase_key:s,value:o}of e)i.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(o)&&(this.notifyListeners(s,o),t.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!i.has(s)&&(this.notifyListeners(s,null),t.push(s));return t}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const s of Array.from(i))s(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),iR)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}Xv.type="LOCAL";const Jv=Xv;new Wa(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zv(n,e){return e?di(e):(Oe(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jp extends ed{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Ts(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Ts(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Ts(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function sR(n){return Nv(n.auth,new jp(n),n.bypassAuthState)}function oR(n){const{auth:e,user:t}=n;return Oe(t,e,"internal-error"),UC(t,new jp(n),n.bypassAuthState)}async function aR(n){const{auth:e,user:t}=n;return Oe(t,e,"internal-error"),qC(t,new jp(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ew{constructor(e,t,i,s,o=!1){this.auth=e,this.resolver=i,this.user=s,this.bypassAuthState=o,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:i,postBody:s,tenantId:o,error:a,type:l}=e;if(a){this.reject(a);return}const c={auth:this.auth,requestUri:t,sessionId:i,tenantId:o||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(l)(c))}catch(u){this.reject(u)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return sR;case"linkViaPopup":case"linkViaRedirect":return aR;case"reauthViaPopup":case"reauthViaRedirect":return oR;default:_n(this.auth,"internal-error")}}resolve(e){yi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){yi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lR=new Wa(2e3,1e4);async function Nl(n,e,t){if(mn(n.app))return Promise.reject(Bn(n,"operation-not-supported-in-this-environment"));const i=Zn(n);JI(n,e,wp);const s=Zv(i,t);return new jr(i,"signInViaPopup",e,s).executeNotNull()}class jr extends ew{constructor(e,t,i,s,o){super(e,t,s,o),this.provider=i,this.authWindow=null,this.pollId=null,jr.currentPopupAction&&jr.currentPopupAction.cancel(),jr.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Oe(e,this.auth,"internal-error"),e}async onExecution(){yi(this.filter.length===1,"Popup operations only handle one event");const e=Tp();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(Bn(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(Bn(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,jr.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,i;if(!((i=(t=this.authWindow)===null||t===void 0?void 0:t.window)===null||i===void 0)&&i.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Bn(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,lR.get())};e()}}jr.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cR="pendingRedirect",Ml=new Map;class dR extends ew{constructor(e,t,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,i),this.eventId=null}async execute(){let e=Ml.get(this.auth._key());if(!e){try{const i=await uR(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(i)}catch(t){e=()=>Promise.reject(t)}Ml.set(this.auth._key(),e)}return this.bypassAuthState||Ml.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function uR(n,e){const t=mR(e),i=pR(n);if(!await i._isAvailable())return!1;const s=await i._get(t)==="true";return await i._remove(t),s}function hR(n,e){Ml.set(n._key(),e)}function pR(n){return di(n._redirectPersistence)}function mR(n){return Dl(cR,n.config.apiKey,n.name)}async function gR(n,e){return await Zn(n)._initializationPromise,tw(n,e,!1)}async function tw(n,e,t=!1){if(mn(n.app))return Promise.reject(ui(n));const i=Zn(n),s=Zv(i,e),a=await new dR(i,s,t).execute();return a&&!t&&(delete a.user._redirectEventId,await i._persistUserIfCurrent(a.user),await i._setRedirectUser(null,e)),a}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fR=10*60*1e3;class yR{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(t=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!xR(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var i;if(e.error&&!nw(e)){const s=((i=e.error.code)===null||i===void 0?void 0:i.split("auth/")[1])||"internal-error";t.onError(Bn(this.auth,s))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const i=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=fR&&this.cachedEventUids.clear(),this.cachedEventUids.has(Tf(e))}saveEventToCache(e){this.cachedEventUids.add(Tf(e)),this.lastProcessedEventTime=Date.now()}}function Tf(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function nw({type:n,error:e}){return n==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function xR(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return nw(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function bR(n,e={}){return Jn(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vR=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,wR=/^https?/;async function kR(n){if(n.config.emulator)return;const{authorizedDomains:e}=await bR(n);for(const t of e)try{if(SR(t))return}catch{}_n(n,"unauthorized-domain")}function SR(n){const e=Wu(),{protocol:t,hostname:i}=new URL(e);if(n.startsWith("chrome-extension://")){const a=new URL(n);return a.hostname===""&&i===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&a.hostname===i}if(!wR.test(t))return!1;if(vR.test(n))return i===n;const s=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(i)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TR=new Wa(3e4,6e4);function jf(){const n=Kn().___jsl;if(n!=null&&n.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function jR(n){return new Promise((e,t)=>{var i,s,o;function a(){jf(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{jf(),t(Bn(n,"network-request-failed"))},timeout:TR.get()})}if(!((s=(i=Kn().gapi)===null||i===void 0?void 0:i.iframes)===null||s===void 0)&&s.Iframe)e(gapi.iframes.getContext());else if(!((o=Kn().gapi)===null||o===void 0)&&o.load)a();else{const l=jC("iframefcb");return Kn()[l]=()=>{gapi.load?a():t(Bn(n,"network-request-failed"))},Ev(`${TC()}?onload=${l}`).catch(c=>t(c))}}).catch(e=>{throw Wl=null,e})}let Wl=null;function _R(n){return Wl=Wl||jR(n),Wl}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IR=new Wa(5e3,15e3),CR="__/auth/iframe",RR="emulator/auth/iframe",AR={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},ER=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function BR(n){const e=n.config;Oe(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?xp(e,RR):`https://${n.config.authDomain}/${CR}`,i={apiKey:e.apiKey,appName:n.name,v:Qr},s=ER.get(n.config.apiHost);s&&(i.eid=s);const o=n._getFrameworks();return o.length&&(i.fw=o.join(",")),`${t}?${va(i).slice(1)}`}async function PR(n){const e=await _R(n),t=Kn().gapi;return Oe(t,n,"internal-error"),e.open({where:document.body,url:BR(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:AR,dontclear:!0},i=>new Promise(async(s,o)=>{await i.restyle({setHideOnLeave:!1});const a=Bn(n,"network-request-failed"),l=Kn().setTimeout(()=>{o(a)},IR.get());function c(){Kn().clearTimeout(l),s(i)}i.ping(c).then(c,()=>{o(a)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FR={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},zR=500,DR=600,NR="_blank",MR="http://localhost";class _f{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function WR(n,e,t,i=zR,s=DR){const o=Math.max((window.screen.availHeight-s)/2,0).toString(),a=Math.max((window.screen.availWidth-i)/2,0).toString();let l="";const c=Object.assign(Object.assign({},FR),{width:i.toString(),height:s.toString(),top:o,left:a}),u=qt().toLowerCase();t&&(l=Tv(u)?NR:t),kv(u)&&(e=e||MR,c.scrollbars="yes");const h=Object.entries(c).reduce((f,[b,x])=>`${f}${b}=${x},`,"");if(gC(u)&&l!=="_self")return LR(e||"",l),new _f(null);const p=window.open(e||"",l,h);Oe(p,n,"popup-blocked");try{p.focus()}catch{}return new _f(p)}function LR(n,e){const t=document.createElement("a");t.href=n,t.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(i)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OR="__/auth/handler",VR="emulator/auth/handler",qR=encodeURIComponent("fac");async function If(n,e,t,i,s,o){Oe(n.config.authDomain,n,"auth-domain-config-required"),Oe(n.config.apiKey,n,"invalid-api-key");const a={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:i,v:Qr,eventId:s};if(e instanceof wp){e.setDefaultLanguage(n.languageCode),a.providerId=e.providerId||"",nS(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(const[h,p]of Object.entries({}))a[h]=p}if(e instanceof ho){const h=e.getScopes().filter(p=>p!=="");h.length>0&&(a.scopes=h.join(","))}n.tenantId&&(a.tid=n.tenantId);const l=a;for(const h of Object.keys(l))l[h]===void 0&&delete l[h];const c=await n._getAppCheckToken(),u=c?`#${qR}=${encodeURIComponent(c)}`:"";return`${UR(n)}?${va(l).slice(1)}${u}`}function UR({config:n}){return n.emulator?xp(n,VR):`https://${n.authDomain}/${OR}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Od="webStorageSupport";class HR{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Sp,this._completeRedirectFn=tw,this._overrideRedirectResult=hR}async _openPopup(e,t,i,s){var o;yi((o=this.eventManagers[e._key()])===null||o===void 0?void 0:o.manager,"_initialize() not called before _openPopup()");const a=await If(e,t,i,Wu(),s);return WR(e,a,Tp())}async _openRedirect(e,t,i,s){await this._originValidation(e);const o=await If(e,t,i,Wu(),s);return YC(o),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:s,promise:o}=this.eventManagers[t];return s?Promise.resolve(s):(yi(o,"If manager is not set, promise should be"),o)}const i=this.initAndGetManager(e);return this.eventManagers[t]={promise:i},i.catch(()=>{delete this.eventManagers[t]}),i}async initAndGetManager(e){const t=await PR(e),i=new yR(e);return t.register("authEvent",s=>(Oe(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:i.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=t,i}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Od,{type:Od},s=>{var o;const a=(o=s==null?void 0:s[0])===null||o===void 0?void 0:o[Od];a!==void 0&&t(!!a),_n(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=kR(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return Rv()||Sv()||vp()}}const iw=HR;var Cf="@firebase/auth",Rf="1.10.7";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $R{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(i=>{e((i==null?void 0:i.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Oe(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GR(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function KR(n){Fr(new Gi("auth",(e,{options:t})=>{const i=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),o=e.getProvider("app-check-internal"),{apiKey:a,authDomain:l}=i.options;Oe(a&&!a.includes(":"),"invalid-api-key",{appName:i.name});const c={apiKey:a,authDomain:l,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Av(n)},u=new wC(i,s,o,c);return AC(u,t),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,i)=>{e.getProvider("auth-internal").initialize()})),Fr(new Gi("auth-internal",e=>{const t=Zn(e.getProvider("auth").getImmediate());return(i=>new $R(i))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Hn(Cf,Rf,GR(n)),Hn(Cf,Rf,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QR=5*60,YR=dx("authIdTokenMaxAge")||QR;let Af=null;const XR=n=>async e=>{const t=e&&await e.getIdTokenResult(),i=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(i&&i>YR)return;const s=t==null?void 0:t.token;Af!==s&&(Af=s,await fetch(n,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function Je(n=rh()){const e=Js(n,"auth");if(e.isInitialized())return e.getImmediate();const t=Pv(n,{popupRedirectResolver:iw,persistence:[Jv,$v,Sp]}),i=dx("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){const o=new URL(i,location.origin);if(location.origin===o.origin){const a=XR(o.toString());qv(t,a,()=>a(t.currentUser)),Vv(t,l=>a(l))}}const s=ax("auth");return s&&Fv(t,`http://${s}`),t}function JR(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}kC({loadJS(n){return new Promise((e,t)=>{const i=document.createElement("script");i.setAttribute("src",n),i.onload=e,i.onerror=s=>{const o=Bn("internal-error");o.customData=s,t(o)},i.type="text/javascript",i.charset="UTF-8",JR().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});KR("Browser");const Ef=Object.freeze(Object.defineProperty({__proto__:null,ActionCodeURL:td,AuthCredential:ed,EmailAuthCredential:Qs,EmailAuthProvider:Zr,FacebookAuthProvider:si,GithubAuthProvider:oi,GoogleAuthProvider:On,OAuthCredential:Yn,OAuthProvider:js,TwitterAuthProvider:ai,beforeAuthStateChanged:qv,browserLocalPersistence:$v,browserPopupRedirectResolver:iw,browserSessionPersistence:Sp,connectAuthEmulator:Fv,createUserWithEmailAndPassword:kp,getAuth:Je,getIdTokenResult:xv,getRedirectResult:gR,inMemoryPersistence:Ou,indexedDBLocalPersistence:Jv,initializeAuth:Pv,onAuthStateChanged:ur,onIdTokenChanged:Vv,prodErrorMap:pv,reload:bv,sendPasswordResetEmail:Lv,signInWithCredential:Mv,signInWithEmailAndPassword:Ov,signInWithPopup:Nl,signOut:hn,updateProfile:yc},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rw="firebasestorage.googleapis.com",sw="storageBucket",ZR=2*60*1e3,eA=10*60*1e3,tA=1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bt extends Xn{constructor(e,t,i=0){super(Vd(e),`Firebase Storage: ${t} (${Vd(e)})`),this.status_=i,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Bt.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Vd(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Tt;(function(n){n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Tt||(Tt={}));function Vd(n){return"storage/"+n}function _p(){const n="An unknown error occurred, please check the error payload for server response.";return new Bt(Tt.UNKNOWN,n)}function nA(n){return new Bt(Tt.OBJECT_NOT_FOUND,"Object '"+n+"' does not exist.")}function iA(n){return new Bt(Tt.QUOTA_EXCEEDED,"Quota for bucket '"+n+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function rA(){const n="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new Bt(Tt.UNAUTHENTICATED,n)}function sA(){return new Bt(Tt.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function oA(n){return new Bt(Tt.UNAUTHORIZED,"User does not have permission to access '"+n+"'.")}function ow(){return new Bt(Tt.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function aw(){return new Bt(Tt.CANCELED,"User canceled the upload/download.")}function aA(n){return new Bt(Tt.INVALID_URL,"Invalid URL '"+n+"'.")}function lA(n){return new Bt(Tt.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function cA(){return new Bt(Tt.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+sw+"' property when initializing the app?")}function lw(){return new Bt(Tt.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function dA(){return new Bt(Tt.SERVER_FILE_WRONG_SIZE,"Server recorded incorrect upload file size, please retry the upload.")}function uA(){return new Bt(Tt.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function hA(n){return new Bt(Tt.UNSUPPORTED_ENVIRONMENT,`${n} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function qu(n){return new Bt(Tt.INVALID_ARGUMENT,n)}function cw(){return new Bt(Tt.APP_DELETED,"The Firebase app was deleted.")}function pA(n){return new Bt(Tt.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function Zo(n,e){return new Bt(Tt.INVALID_FORMAT,"String does not match format '"+n+"': "+e)}function Bo(n){throw new Bt(Tt.INTERNAL_ERROR,"Internal error: "+n)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sn{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let i;try{i=Sn.makeFromUrl(e,t)}catch{return new Sn(e,"")}if(i.path==="")return i;throw lA(e)}static makeFromUrl(e,t){let i=null;const s="([A-Za-z0-9.\\-_]+)";function o(D){D.path.charAt(D.path.length-1)==="/"&&(D.path_=D.path_.slice(0,-1))}const a="(/(.*))?$",l=new RegExp("^gs://"+s+a,"i"),c={bucket:1,path:3};function u(D){D.path_=decodeURIComponent(D.path)}const h="v[A-Za-z0-9_]+",p=t.replace(/[.]/g,"\\."),f="(/([^?#]*).*)?$",b=new RegExp(`^https?://${p}/${h}/b/${s}/o${f}`,"i"),x={bucket:1,path:3},S=t===rw?"(?:storage.googleapis.com|storage.cloud.google.com)":t,w="([^?#]*)",I=new RegExp(`^https?://${S}/${s}/${w}`,"i"),A=[{regex:l,indices:c,postModify:o},{regex:b,indices:x,postModify:u},{regex:I,indices:{bucket:1,path:2},postModify:u}];for(let D=0;D<A.length;D++){const O=A[D],P=O.regex.exec(e);if(P){const B=P[O.indices.bucket];let k=P[O.indices.path];k||(k=""),i=new Sn(B,k),O.postModify(i);break}}if(i==null)throw aA(e);return i}}class mA{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gA(n,e,t){let i=1,s=null,o=null,a=!1,l=0;function c(){return l===2}let u=!1;function h(...w){u||(u=!0,e.apply(null,w))}function p(w){s=setTimeout(()=>{s=null,n(b,c())},w)}function f(){o&&clearTimeout(o)}function b(w,...I){if(u){f();return}if(w){f(),h.call(null,w,...I);return}if(c()||a){f(),h.call(null,w,...I);return}i<64&&(i*=2);let A;l===1?(l=2,A=0):A=(i+Math.random())*1e3,p(A)}let x=!1;function S(w){x||(x=!0,f(),!u&&(s!==null?(w||(l=2),clearTimeout(s),p(0)):w||(l=1)))}return p(0),o=setTimeout(()=>{a=!0,S(!0)},t),S}function fA(n){n(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yA(n){return n!==void 0}function xA(n){return typeof n=="function"}function bA(n){return typeof n=="object"&&!Array.isArray(n)}function rd(n){return typeof n=="string"||n instanceof String}function Bf(n){return Ip()&&n instanceof Blob}function Ip(){return typeof Blob<"u"}function Pf(n,e,t,i){if(i<e)throw qu(`Invalid value for '${n}'. Expected ${e} or greater.`);if(i>t)throw qu(`Invalid value for '${n}'. Expected ${t} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Va(n,e,t){let i=e;return t==null&&(i=`https://${e}`),`${t}://${i}/v0${n}`}function dw(n){const e=encodeURIComponent;let t="?";for(const i in n)if(n.hasOwnProperty(i)){const s=e(i)+"="+e(n[i]);t=t+s+"&"}return t=t.slice(0,-1),t}var Er;(function(n){n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT"})(Er||(Er={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uw(n,e){const t=n>=500&&n<600,s=[408,429].indexOf(n)!==-1,o=e.indexOf(n)!==-1;return t||s||o}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vA{constructor(e,t,i,s,o,a,l,c,u,h,p,f=!0,b=!1){this.url_=e,this.method_=t,this.headers_=i,this.body_=s,this.successCodes_=o,this.additionalRetryCodes_=a,this.callback_=l,this.errorCallback_=c,this.timeout_=u,this.progressCallback_=h,this.connectionFactory_=p,this.retry=f,this.isUsingEmulator=b,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((x,S)=>{this.resolve_=x,this.reject_=S,this.start_()})}start_(){const e=(i,s)=>{if(s){i(!1,new vl(!1,null,!0));return}const o=this.connectionFactory_();this.pendingConnection_=o;const a=l=>{const c=l.loaded,u=l.lengthComputable?l.total:-1;this.progressCallback_!==null&&this.progressCallback_(c,u)};this.progressCallback_!==null&&o.addUploadProgressListener(a),o.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&o.removeUploadProgressListener(a),this.pendingConnection_=null;const l=o.getErrorCode()===Er.NO_ERROR,c=o.getStatus();if(!l||uw(c,this.additionalRetryCodes_)&&this.retry){const h=o.getErrorCode()===Er.ABORT;i(!1,new vl(!1,null,h));return}const u=this.successCodes_.indexOf(c)!==-1;i(!0,new vl(u,o))})},t=(i,s)=>{const o=this.resolve_,a=this.reject_,l=s.connection;if(s.wasSuccessCode)try{const c=this.callback_(l,l.getResponse());yA(c)?o(c):o()}catch(c){a(c)}else if(l!==null){const c=_p();c.serverResponse=l.getErrorText(),this.errorCallback_?a(this.errorCallback_(l,c)):a(c)}else if(s.canceled){const c=this.appDelete_?cw():aw();a(c)}else{const c=ow();a(c)}};this.canceled_?t(!1,new vl(!1,null,!0)):this.backoffId_=gA(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&fA(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class vl{constructor(e,t,i){this.wasSuccessCode=e,this.connection=t,this.canceled=!!i}}function wA(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function kA(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function SA(n,e){e&&(n["X-Firebase-GMPID"]=e)}function TA(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function jA(n,e,t,i,s,o,a=!0,l=!1){const c=dw(n.urlParams),u=n.url+c,h=Object.assign({},n.headers);return SA(h,e),wA(h,t),kA(h,o),TA(h,i),new vA(u,n.method,h,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,s,a,l)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _A(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function IA(...n){const e=_A();if(e!==void 0){const t=new e;for(let i=0;i<n.length;i++)t.append(n[i]);return t.getBlob()}else{if(Ip())return new Blob(n);throw new Bt(Tt.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function CA(n,e,t){return n.webkitSlice?n.webkitSlice(e,t):n.mozSlice?n.mozSlice(e,t):n.slice?n.slice(e,t):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RA(n){if(typeof atob>"u")throw hA("base-64");return atob(n)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Un={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class qd{constructor(e,t){this.data=e,this.contentType=t||null}}function AA(n,e){switch(n){case Un.RAW:return new qd(hw(e));case Un.BASE64:case Un.BASE64URL:return new qd(pw(n,e));case Un.DATA_URL:return new qd(BA(e),PA(e))}throw _p()}function hw(n){const e=[];for(let t=0;t<n.length;t++){let i=n.charCodeAt(t);if(i<=127)e.push(i);else if(i<=2047)e.push(192|i>>6,128|i&63);else if((i&64512)===55296)if(!(t<n.length-1&&(n.charCodeAt(t+1)&64512)===56320))e.push(239,191,189);else{const o=i,a=n.charCodeAt(++t);i=65536|(o&1023)<<10|a&1023,e.push(240|i>>18,128|i>>12&63,128|i>>6&63,128|i&63)}else(i&64512)===56320?e.push(239,191,189):e.push(224|i>>12,128|i>>6&63,128|i&63)}return new Uint8Array(e)}function EA(n){let e;try{e=decodeURIComponent(n)}catch{throw Zo(Un.DATA_URL,"Malformed data URL.")}return hw(e)}function pw(n,e){switch(n){case Un.BASE64:{const s=e.indexOf("-")!==-1,o=e.indexOf("_")!==-1;if(s||o)throw Zo(n,"Invalid character '"+(s?"-":"_")+"' found: is it base64url encoded?");break}case Un.BASE64URL:{const s=e.indexOf("+")!==-1,o=e.indexOf("/")!==-1;if(s||o)throw Zo(n,"Invalid character '"+(s?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let t;try{t=RA(e)}catch(s){throw s.message.includes("polyfill")?s:Zo(n,"Invalid character found")}const i=new Uint8Array(t.length);for(let s=0;s<t.length;s++)i[s]=t.charCodeAt(s);return i}class mw{constructor(e){this.base64=!1,this.contentType=null;const t=e.match(/^data:([^,]+)?,/);if(t===null)throw Zo(Un.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const i=t[1]||null;i!=null&&(this.base64=FA(i,";base64"),this.contentType=this.base64?i.substring(0,i.length-7):i),this.rest=e.substring(e.indexOf(",")+1)}}function BA(n){const e=new mw(n);return e.base64?pw(Un.BASE64,e.rest):EA(e.rest)}function PA(n){return new mw(n).contentType}function FA(n,e){return n.length>=e.length?n.substring(n.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ni{constructor(e,t){let i=0,s="";Bf(e)?(this.data_=e,i=e.size,s=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),i=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),i=e.length),this.size_=i,this.type_=s}size(){return this.size_}type(){return this.type_}slice(e,t){if(Bf(this.data_)){const i=this.data_,s=CA(i,e,t);return s===null?null:new Ni(s)}else{const i=new Uint8Array(this.data_.buffer,e,t-e);return new Ni(i,!0)}}static getBlob(...e){if(Ip()){const t=e.map(i=>i instanceof Ni?i.data_:i);return new Ni(IA.apply(null,t))}else{const t=e.map(a=>rd(a)?AA(Un.RAW,a).data:a.data_);let i=0;t.forEach(a=>{i+=a.byteLength});const s=new Uint8Array(i);let o=0;return t.forEach(a=>{for(let l=0;l<a.length;l++)s[o++]=a[l]}),new Ni(s,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gw(n){let e;try{e=JSON.parse(n)}catch{return null}return bA(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zA(n){if(n.length===0)return null;const e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function DA(n,e){const t=e.split("/").filter(i=>i.length>0).join("/");return n.length===0?t:n+"/"+t}function fw(n){const e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NA(n,e){return e}class dn{constructor(e,t,i,s){this.server=e,this.local=t||e,this.writable=!!i,this.xform=s||NA}}let wl=null;function MA(n){return!rd(n)||n.length<2?n:fw(n)}function yw(){if(wl)return wl;const n=[];n.push(new dn("bucket")),n.push(new dn("generation")),n.push(new dn("metageneration")),n.push(new dn("name","fullPath",!0));function e(o,a){return MA(a)}const t=new dn("name");t.xform=e,n.push(t);function i(o,a){return a!==void 0?Number(a):a}const s=new dn("size");return s.xform=i,n.push(s),n.push(new dn("timeCreated")),n.push(new dn("updated")),n.push(new dn("md5Hash",null,!0)),n.push(new dn("cacheControl",null,!0)),n.push(new dn("contentDisposition",null,!0)),n.push(new dn("contentEncoding",null,!0)),n.push(new dn("contentLanguage",null,!0)),n.push(new dn("contentType",null,!0)),n.push(new dn("metadata","customMetadata",!0)),wl=n,wl}function WA(n,e){function t(){const i=n.bucket,s=n.fullPath,o=new Sn(i,s);return e._makeStorageReference(o)}Object.defineProperty(n,"ref",{get:t})}function LA(n,e,t){const i={};i.type="file";const s=t.length;for(let o=0;o<s;o++){const a=t[o];i[a.local]=a.xform(i,e[a.server])}return WA(i,n),i}function xw(n,e,t){const i=gw(e);return i===null?null:LA(n,i,t)}function OA(n,e,t,i){const s=gw(e);if(s===null||!rd(s.downloadTokens))return null;const o=s.downloadTokens;if(o.length===0)return null;const a=encodeURIComponent;return o.split(",").map(u=>{const h=n.bucket,p=n.fullPath,f="/b/"+a(h)+"/o/"+a(p),b=Va(f,t,i),x=dw({alt:"media",token:u});return b+x})[0]}function bw(n,e){const t={},i=e.length;for(let s=0;s<i;s++){const o=e[s];o.writable&&(t[o.server]=n[o.local])}return JSON.stringify(t)}class po{constructor(e,t,i,s){this.url=e,this.method=t,this.handler=i,this.timeout=s,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hi(n){if(!n)throw _p()}function Cp(n,e){function t(i,s){const o=xw(n,s,e);return hi(o!==null),o}return t}function VA(n,e){function t(i,s){const o=xw(n,s,e);return hi(o!==null),OA(o,s,n.host,n._protocol)}return t}function qa(n){function e(t,i){let s;return t.getStatus()===401?t.getErrorText().includes("Firebase App Check token is invalid")?s=sA():s=rA():t.getStatus()===402?s=iA(n.bucket):t.getStatus()===403?s=oA(n.path):s=i,s.status=t.getStatus(),s.serverResponse=i.serverResponse,s}return e}function vw(n){const e=qa(n);function t(i,s){let o=e(i,s);return i.getStatus()===404&&(o=nA(n.path)),o.serverResponse=s.serverResponse,o}return t}function qA(n,e,t){const i=e.fullServerUrl(),s=Va(i,n.host,n._protocol),o="GET",a=n.maxOperationRetryTime,l=new po(s,o,Cp(n,t),a);return l.errorHandler=vw(e),l}function UA(n,e,t){const i=e.fullServerUrl(),s=Va(i,n.host,n._protocol),o="GET",a=n.maxOperationRetryTime,l=new po(s,o,VA(n,t),a);return l.errorHandler=vw(e),l}function HA(n,e){return n&&n.contentType||e&&e.type()||"application/octet-stream"}function ww(n,e,t){const i=Object.assign({},t);return i.fullPath=n.path,i.size=e.size(),i.contentType||(i.contentType=HA(null,e)),i}function $A(n,e,t,i,s){const o=e.bucketOnlyServerUrl(),a={"X-Goog-Upload-Protocol":"multipart"};function l(){let A="";for(let D=0;D<2;D++)A=A+Math.random().toString().slice(2);return A}const c=l();a["Content-Type"]="multipart/related; boundary="+c;const u=ww(e,i,s),h=bw(u,t),p="--"+c+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+h+`\r
--`+c+`\r
Content-Type: `+u.contentType+`\r
\r
`,f=`\r
--`+c+"--",b=Ni.getBlob(p,i,f);if(b===null)throw lw();const x={name:u.fullPath},S=Va(o,n.host,n._protocol),w="POST",I=n.maxUploadRetryTime,j=new po(S,w,Cp(n,t),I);return j.urlParams=x,j.headers=a,j.body=b.uploadData(),j.errorHandler=qa(e),j}class vc{constructor(e,t,i,s){this.current=e,this.total=t,this.finalized=!!i,this.metadata=s||null}}function Rp(n,e){let t=null;try{t=n.getResponseHeader("X-Goog-Upload-Status")}catch{hi(!1)}return hi(!!t&&(e||["active"]).indexOf(t)!==-1),t}function GA(n,e,t,i,s){const o=e.bucketOnlyServerUrl(),a=ww(e,i,s),l={name:a.fullPath},c=Va(o,n.host,n._protocol),u="POST",h={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${i.size()}`,"X-Goog-Upload-Header-Content-Type":a.contentType,"Content-Type":"application/json; charset=utf-8"},p=bw(a,t),f=n.maxUploadRetryTime;function b(S){Rp(S);let w;try{w=S.getResponseHeader("X-Goog-Upload-URL")}catch{hi(!1)}return hi(rd(w)),w}const x=new po(c,u,b,f);return x.urlParams=l,x.headers=h,x.body=p,x.errorHandler=qa(e),x}function KA(n,e,t,i){const s={"X-Goog-Upload-Command":"query"};function o(u){const h=Rp(u,["active","final"]);let p=null;try{p=u.getResponseHeader("X-Goog-Upload-Size-Received")}catch{hi(!1)}p||hi(!1);const f=Number(p);return hi(!isNaN(f)),new vc(f,i.size(),h==="final")}const a="POST",l=n.maxUploadRetryTime,c=new po(t,a,o,l);return c.headers=s,c.errorHandler=qa(e),c}const Ff=256*1024;function QA(n,e,t,i,s,o,a,l){const c=new vc(0,0);if(a?(c.current=a.current,c.total=a.total):(c.current=0,c.total=i.size()),i.size()!==c.total)throw dA();const u=c.total-c.current;let h=u;s>0&&(h=Math.min(h,s));const p=c.current,f=p+h;let b="";h===0?b="finalize":u===h?b="upload, finalize":b="upload";const x={"X-Goog-Upload-Command":b,"X-Goog-Upload-Offset":`${c.current}`},S=i.slice(p,f);if(S===null)throw lw();function w(D,O){const P=Rp(D,["active","final"]),B=c.current+h,k=i.size();let T;return P==="final"?T=Cp(e,o)(D,O):T=null,new vc(B,k,P==="final",T)}const I="POST",j=e.maxUploadRetryTime,A=new po(t,I,w,j);return A.headers=x,A.body=S.uploadData(),A.progressCallback=l||null,A.errorHandler=qa(n),A}const pn={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function Ud(n){switch(n){case"running":case"pausing":case"canceling":return pn.RUNNING;case"paused":return pn.PAUSED;case"success":return pn.SUCCESS;case"canceled":return pn.CANCELED;case"error":return pn.ERROR;default:return pn.ERROR}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YA{constructor(e,t,i){if(xA(e)||t!=null||i!=null)this.next=e,this.error=t??void 0,this.complete=i??void 0;else{const o=e;this.next=o.next,this.error=o.error,this.complete=o.complete}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ds(n){return(...e)=>{Promise.resolve().then(()=>n(...e))}}class XA{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Er.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=Er.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=Er.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,t,i,s,o){if(this.sent_)throw Bo("cannot .send() more than once");if(xi(e)&&i&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(t,e,!0),o!==void 0)for(const a in o)o.hasOwnProperty(a)&&this.xhr_.setRequestHeader(a,o[a].toString());return s!==void 0?this.xhr_.send(s):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw Bo("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw Bo("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw Bo("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw Bo("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class JA extends XA{initXhr(){this.xhr_.responseType="text"}}function bs(){return new JA}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZA{isExponentialBackoffExpired(){return this.sleepTime>this.maxSleepTime}constructor(e,t,i=null){this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=e,this._blob=t,this._metadata=i,this._mappings=yw(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=s=>{if(this._request=void 0,this._chunkMultiplier=1,s._codeEquals(Tt.CANCELED))this._needToFetchStatus=!0,this.completeTransitions_();else{const o=this.isExponentialBackoffExpired();if(uw(s.status,[]))if(o)s=ow();else{this.sleepTime=Math.max(this.sleepTime*2,tA),this._needToFetchStatus=!0,this.completeTransitions_();return}this._error=s,this._transition("error")}},this._metadataErrorHandler=s=>{this._request=void 0,s._codeEquals(Tt.CANCELED)?this.completeTransitions_():(this._error=s,this._transition("error"))},this.sleepTime=0,this.maxSleepTime=this._ref.storage.maxUploadRetryTime,this._promise=new Promise((s,o)=>{this._resolve=s,this._reject=o,this._start()}),this._promise.then(null,()=>{})}_makeProgressCallback(){const e=this._transferred;return t=>this._updateProgress(e+t)}_shouldDoResumable(e){return e.size()>256*1024}_start(){this._state==="running"&&this._request===void 0&&(this._resumable?this._uploadUrl===void 0?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this.pendingTimeout=setTimeout(()=>{this.pendingTimeout=void 0,this._continueUpload()},this.sleepTime):this._oneShotUpload())}_resolveToken(e){Promise.all([this._ref.storage._getAuthToken(),this._ref.storage._getAppCheckToken()]).then(([t,i])=>{switch(this._state){case"running":e(t,i);break;case"canceling":this._transition("canceled");break;case"pausing":this._transition("paused");break}})}_createResumable(){this._resolveToken((e,t)=>{const i=GA(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),s=this._ref.storage._makeRequest(i,bs,e,t);this._request=s,s.getPromise().then(o=>{this._request=void 0,this._uploadUrl=o,this._needToFetchStatus=!1,this.completeTransitions_()},this._errorHandler)})}_fetchStatus(){const e=this._uploadUrl;this._resolveToken((t,i)=>{const s=KA(this._ref.storage,this._ref._location,e,this._blob),o=this._ref.storage._makeRequest(s,bs,t,i);this._request=o,o.getPromise().then(a=>{a=a,this._request=void 0,this._updateProgress(a.current),this._needToFetchStatus=!1,a.finalized&&(this._needToFetchMetadata=!0),this.completeTransitions_()},this._errorHandler)})}_continueUpload(){const e=Ff*this._chunkMultiplier,t=new vc(this._transferred,this._blob.size()),i=this._uploadUrl;this._resolveToken((s,o)=>{let a;try{a=QA(this._ref._location,this._ref.storage,i,this._blob,e,this._mappings,t,this._makeProgressCallback())}catch(c){this._error=c,this._transition("error");return}const l=this._ref.storage._makeRequest(a,bs,s,o,!1);this._request=l,l.getPromise().then(c=>{this._increaseMultiplier(),this._request=void 0,this._updateProgress(c.current),c.finalized?(this._metadata=c.metadata,this._transition("success")):this.completeTransitions_()},this._errorHandler)})}_increaseMultiplier(){Ff*this._chunkMultiplier*2<32*1024*1024&&(this._chunkMultiplier*=2)}_fetchMetadata(){this._resolveToken((e,t)=>{const i=qA(this._ref.storage,this._ref._location,this._mappings),s=this._ref.storage._makeRequest(i,bs,e,t);this._request=s,s.getPromise().then(o=>{this._request=void 0,this._metadata=o,this._transition("success")},this._metadataErrorHandler)})}_oneShotUpload(){this._resolveToken((e,t)=>{const i=$A(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),s=this._ref.storage._makeRequest(i,bs,e,t);this._request=s,s.getPromise().then(o=>{this._request=void 0,this._metadata=o,this._updateProgress(this._blob.size()),this._transition("success")},this._errorHandler)})}_updateProgress(e){const t=this._transferred;this._transferred=e,this._transferred!==t&&this._notifyObservers()}_transition(e){if(this._state!==e)switch(e){case"canceling":case"pausing":this._state=e,this._request!==void 0?this._request.cancel():this.pendingTimeout&&(clearTimeout(this.pendingTimeout),this.pendingTimeout=void 0,this.completeTransitions_());break;case"running":const t=this._state==="paused";this._state=e,t&&(this._notifyObservers(),this._start());break;case"paused":this._state=e,this._notifyObservers();break;case"canceled":this._error=aw(),this._state=e,this._notifyObservers();break;case"error":this._state=e,this._notifyObservers();break;case"success":this._state=e,this._notifyObservers();break}}completeTransitions_(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start();break}}get snapshot(){const e=Ud(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:e,metadata:this._metadata,task:this,ref:this._ref}}on(e,t,i,s){const o=new YA(t||void 0,i||void 0,s||void 0);return this._addObserver(o),()=>{this._removeObserver(o)}}then(e,t){return this._promise.then(e,t)}catch(e){return this.then(null,e)}_addObserver(e){this._observers.push(e),this._notifyObserver(e)}_removeObserver(e){const t=this._observers.indexOf(e);t!==-1&&this._observers.splice(t,1)}_notifyObservers(){this._finishPromise(),this._observers.slice().forEach(t=>{this._notifyObserver(t)})}_finishPromise(){if(this._resolve!==void 0){let e=!0;switch(Ud(this._state)){case pn.SUCCESS:ds(this._resolve.bind(null,this.snapshot))();break;case pn.CANCELED:case pn.ERROR:const t=this._reject;ds(t.bind(null,this._error))();break;default:e=!1;break}e&&(this._resolve=void 0,this._reject=void 0)}}_notifyObserver(e){switch(Ud(this._state)){case pn.RUNNING:case pn.PAUSED:e.next&&ds(e.next.bind(e,this.snapshot))();break;case pn.SUCCESS:e.complete&&ds(e.complete.bind(e))();break;case pn.CANCELED:case pn.ERROR:e.error&&ds(e.error.bind(e,this._error))();break;default:e.error&&ds(e.error.bind(e,this._error))()}}resume(){const e=this._state==="paused"||this._state==="pausing";return e&&this._transition("running"),e}pause(){const e=this._state==="running";return e&&this._transition("pausing"),e}cancel(){const e=this._state==="running"||this._state==="pausing";return e&&this._transition("canceling"),e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $r{constructor(e,t){this._service=e,t instanceof Sn?this._location=t:this._location=Sn.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new $r(e,t)}get root(){const e=new Sn(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return fw(this._location.path)}get storage(){return this._service}get parent(){const e=zA(this._location.path);if(e===null)return null;const t=new Sn(this._location.bucket,e);return new $r(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw pA(e)}}function eE(n,e,t){return n._throwIfRoot("uploadBytesResumable"),new ZA(n,new Ni(e),t)}function tE(n){n._throwIfRoot("getDownloadURL");const e=UA(n.storage,n._location,yw());return n.storage.makeRequestWithTokens(e,bs).then(t=>{if(t===null)throw uA();return t})}function nE(n,e){const t=DA(n._location.path,e),i=new Sn(n._location.bucket,t);return new $r(n.storage,i)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iE(n){return/^[A-Za-z]+:\/\//.test(n)}function rE(n,e){return new $r(n,e)}function kw(n,e){if(n instanceof Ap){const t=n;if(t._bucket==null)throw cA();const i=new $r(t,t._bucket);return e!=null?kw(i,e):i}else return e!==void 0?nE(n,e):n}function sE(n,e){if(e&&iE(e)){if(n instanceof Ap)return rE(n,e);throw qu("To use ref(service, url), the first argument must be a Storage instance.")}else return kw(n,e)}function zf(n,e){const t=e==null?void 0:e[sw];return t==null?null:Sn.makeFromBucketSpec(t,n)}function oE(n,e,t,i={}){n.host=`${e}:${t}`;const s=xi(e);s&&(Ic(`https://${n.host}/b`),th("Storage",!0)),n._isUsingEmulator=!0,n._protocol=s?"https":"http";const{mockUserToken:o}=i;o&&(n._overrideAuthToken=typeof o=="string"?o:ux(o,n.app.options.projectId))}class Ap{constructor(e,t,i,s,o,a=!1){this.app=e,this._authProvider=t,this._appCheckProvider=i,this._url=s,this._firebaseVersion=o,this._isUsingEmulator=a,this._bucket=null,this._host=rw,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=ZR,this._maxUploadRetryTime=eA,this._requests=new Set,s!=null?this._bucket=Sn.makeFromBucketSpec(s,this._host):this._bucket=zf(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Sn.makeFromBucketSpec(this._url,e):this._bucket=zf(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){Pf("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){Pf("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(mn(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new $r(this,e)}_makeRequest(e,t,i,s,o=!0){if(this._deleted)return new mA(cw());{const a=jA(e,this._appId,i,s,t,this._firebaseVersion,o,this._isUsingEmulator);return this._requests.add(a),a.getPromise().then(()=>this._requests.delete(a),()=>this._requests.delete(a)),a}}async makeRequestWithTokens(e,t){const[i,s]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,i,s).getPromise()}}const Df="@firebase/storage",Nf="0.13.13";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sw="storage";function aE(n,e,t){return n=lt(n),eE(n,e,t)}function lE(n){return n=lt(n),tE(n)}function cE(n,e){return n=lt(n),sE(n,e)}function dE(n=rh(),e){n=lt(n);const i=Js(n,Sw).getImmediate({identifier:e}),s=lx("storage");return s&&uE(i,...s),i}function uE(n,e,t,i={}){oE(n,e,t,i)}function hE(n,{instanceIdentifier:e}){const t=n.getProvider("app").getImmediate(),i=n.getProvider("auth-internal"),s=n.getProvider("app-check-internal");return new Ap(t,i,s,e,Qr)}function pE(){Fr(new Gi(Sw,hE,"PUBLIC").setMultipleInstances(!0)),Hn(Df,Nf,""),Hn(Df,Nf,"esm2017")}pE();const mE={apiKey:"AIzaSyDi9hdqloCIg_8sfjjyERqnfAr-pW3BeNY",authDomain:"restarter-app.firebaseapp.com",projectId:"restarter-app",storageBucket:"restarter-app.firebasestorage.app",messagingSenderId:"393816322828",appId:"1:393816322828:web:32a9ed91fe95ab9cdd8f29",measurementId:"G-CX4DYFJ5B4"},Ti=xx(mE),ht=Ba(Ti),_r=Je(Ti),gE=dE(Ti),Hd=[{code:"zh-TW",label:"繁中"},{code:"zh-CN",label:"简中"},{code:"en",label:"EN"},{code:"ja",label:"日本語"},{code:"ko",label:"한국어"},{code:"th",label:"ภาษาไทย"},{code:"vi",label:"Tiếng Việt"},{code:"ms",label:"Bahasa Melayu"},{code:"la",label:"Latīna"}],Tw=g.createContext(null),Qe=()=>{const n=g.useContext(Tw);if(!n)throw new Error("useLanguage must be used within a LanguageProvider");return n},fE=({children:n})=>{const[e,t]=g.useState(()=>{try{const o=localStorage.getItem("lang");if(o&&Hd.some(a=>a.code===o))return o}catch(o){console.warn("Failed to read language from localStorage:",o)}return"zh-TW"});g.useEffect(()=>{try{const o=localStorage.getItem("lang");if(o&&Hd.some(u=>u.code===o))return;const a={en:"en","en-US":"en","en-GB":"en","zh-TW":"zh-TW","zh-HK":"zh-TW","zh-Hant":"zh-TW","zh-CN":"zh-CN","zh-Hans":"zh-CN",ja:"ja",ko:"ko",vi:"vi",th:"th",ms:"ms",la:"la"},l=navigator.language||navigator.languages&&navigator.languages[0]||"";let c="en";a[l]?c=a[l]:a[l.split("-")[0]]&&(c=a[l.split("-")[0]]),c!==e&&(t(c),localStorage.setItem("lang",c))}catch(o){console.warn("Failed to detect browser language:",o)}},[]);const s={lang:e,setLang:o=>{try{t(o),localStorage.setItem("lang",o)}catch(a){console.warn("Failed to save language to localStorage:",a)}},LANGS:Hd};return r.jsx(Tw.Provider,{value:s,children:n})},en=({className:n="",style:e={}})=>{const{lang:t,setLang:i,LANGS:s}=Qe(),o={padding:"3px 6px",borderRadius:4,fontWeight:600,fontSize:11,border:"1px solid #6B5BFF",color:"#6B5BFF",background:"#fff",cursor:"pointer",transition:"background 0.18s, color 0.18s, border 0.18s",minWidth:e.minWidth!==void 0?e.minWidth:50,...e};return r.jsx("select",{value:t,onChange:a=>i(a.target.value),className:n,style:o,children:s.map(a=>r.jsx("option",{value:a.code,children:a.label},a.code))})},yE=({isOpen:n,onClose:e,title:t,message:i,requiredPlan:s="basic"})=>{const o=$e(),a=window.innerWidth<=768;if(!n)return null;const l={basic:"基礎版 (NT$ 149/月)",advanced:"進階版 (NT$ 249/月)",professional:"專業版 (NT$ 349/月)",unlimited:"無限版 (NT$ 499/月)"};return r.jsx("div",{style:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",background:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e4},children:r.jsxs("div",{style:{background:"#fff",borderRadius:16,padding:a?20:32,maxWidth:400,width:"90%",maxHeight:"80vh",overflowY:"auto",textAlign:"center",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.2)"},children:[r.jsx("div",{style:{fontSize:a?36:48,marginBottom:a?12:16,color:"#6B5BFF"},children:"🚀"}),r.jsx("h2",{style:{fontSize:a?20:24,fontWeight:700,color:"#333",marginBottom:a?8:12},children:t}),r.jsx("p",{style:{fontSize:a?14:16,color:"#666",marginBottom:a?16:20,lineHeight:1.6},children:i}),r.jsxs("div",{style:{background:"linear-gradient(135deg, #f8f9ff 0%, #e8f4ff 100%)",borderRadius:12,padding:a?12:16,marginBottom:a?16:24,border:"1px solid #e0e8ff"},children:[r.jsx("div",{style:{fontSize:a?12:14,color:"#6B5BFF",fontWeight:600,marginBottom:a?6:8},children:"💡 升級小提醒"}),r.jsxs("div",{style:{fontSize:a?11:13,color:"#666",lineHeight:1.4},children:["• 升級後立即生效，無需等待",r.jsx("br",{}),"• 可隨時取消，權益保留至本期結束",r.jsx("br",{}),"• 支援多種付款方式，安全便捷"]})]}),s&&r.jsx("div",{style:{background:"#fff",borderRadius:10,padding:a?10:14,marginBottom:a?16:24,border:"2px solid #6B5BFF",boxShadow:"0 2px 8px #6B5BFF22"},children:r.jsxs("span",{style:{fontSize:a?12:14,color:"#6B5BFF",fontWeight:700},children:["✨ 建議方案：",l[s]," 或更高"]})}),r.jsxs("div",{style:{display:"flex",gap:12,justifyContent:"center"},children:[r.jsx("button",{onClick:()=>{e(),o("/plans")},style:{background:"linear-gradient(135deg, #6B5BFF 0%, #00CFFF 100%)",color:"#fff",border:"none",borderRadius:12,padding:"14px 28px",fontSize:16,fontWeight:700,cursor:"pointer",flex:1,boxShadow:"0 4px 12px #6B5BFF33",transition:"all 0.3s ease"},onMouseEnter:c=>{c.currentTarget.style.transform="translateY(-2px)",c.currentTarget.style.boxShadow="0 6px 16px #6B5BFF44"},onMouseLeave:c=>{c.currentTarget.style.transform="translateY(0)",c.currentTarget.style.boxShadow="0 4px 12px #6B5BFF33"},children:"🚀 立即升級"}),r.jsx("button",{onClick:e,style:{background:"#f8f9ff",color:"#6B5BFF",border:"2px solid #6B5BFF",borderRadius:12,padding:"14px 28px",fontSize:16,fontWeight:600,cursor:"pointer",flex:1,transition:"all 0.3s ease"},onMouseEnter:c=>{c.currentTarget.style.background="#6B5BFF",c.currentTarget.style.color="#fff"},onMouseLeave:c=>{c.currentTarget.style.background="#f8f9ff",c.currentTarget.style.color="#6B5BFF"},children:"💭 稍後再說"})]})]})})},es=({isOpen:n,onClose:e,currentPlan:t,remainingDays:i,usedTokens:s,totalTokens:o})=>{const a=$e();if(!n)return null;const l={basic:"基礎版",advanced:"進階版",professional:"專業版",unlimited:"無限版"},c={basic:"50K",advanced:"100K",professional:"200K",unlimited:"500K"},u={basic:"NT$ 149",advanced:"NT$ 249",professional:"NT$ 349",unlimited:"NT$ 499"},h=()=>{e(),a("/plans")};return r.jsx("div",{style:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",background:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e4},children:r.jsxs("div",{style:{background:"#fff",borderRadius:20,padding:32,maxWidth:480,width:"90%",textAlign:"center",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.2)"},children:[r.jsx("h2",{style:{fontSize:24,fontWeight:700,color:"#333",marginBottom:12},children:"Token 已用完，需要續購嗎？"}),r.jsxs("p",{style:{fontSize:16,color:"#666",marginBottom:20,lineHeight:1.6},children:["您的 ",l[t]," 方案 Token 已用完，但還有 ",i," 天到期。"]}),r.jsxs("div",{style:{background:"linear-gradient(135deg, #f8f9ff 0%, #e8f4ff 100%)",borderRadius:12,padding:16,marginBottom:24,border:"1px solid #e0e8ff"},children:[r.jsx("div",{style:{fontSize:14,color:"#6B5BFF",fontWeight:600,marginBottom:8},children:"📊 本月使用狀況"}),r.jsxs("div",{style:{fontSize:13,color:"#666",lineHeight:1.4},children:["• 已使用：",Math.round(s/1e3),"K / ",Math.round(o/1e3),"K tokens",r.jsx("br",{}),"• 剩餘天數：",i," 天",r.jsx("br",{}),"• 當前方案：",l[t]]})]}),r.jsxs("div",{style:{background:"#fff",borderRadius:12,padding:20,marginBottom:24,border:"2px solid #6B5BFF",boxShadow:"0 2px 8px #6B5BFF22"},children:[r.jsx("div",{style:{fontSize:16,color:"#6B5BFF",fontWeight:700,marginBottom:12},children:"💡 續購方案"}),r.jsxs("div",{style:{fontSize:14,color:"#666",lineHeight:1.5,marginBottom:16},children:[r.jsx("strong",{children:"立即續購："}),"重新獲得 ",c[t]," tokens，",r.jsx("br",{}),"並從今天開始重新計算 ",i," 天使用期"]}),r.jsx("div",{style:{fontSize:18,fontWeight:700,color:"#6B5BFF"},children:u[t]})]}),r.jsxs("div",{style:{background:"linear-gradient(135deg, #fff3cd 0%, #ffeaa7 100%)",borderRadius:12,padding:16,marginBottom:24,border:"1px solid #ffeaa7"},children:[r.jsx("div",{style:{fontSize:14,color:"#856404",fontWeight:600,marginBottom:8},children:"✨ 續購好處"}),r.jsxs("div",{style:{fontSize:13,color:"#856404",lineHeight:1.4},children:["• 立即恢復語音功能使用",r.jsx("br",{}),"• 時間從今天重新計算，更划算",r.jsx("br",{}),"• 文字功能不受影響，可繼續使用"]})]}),r.jsxs("div",{style:{display:"flex",gap:12,justifyContent:"center"},children:[r.jsx("button",{onClick:h,style:{background:"linear-gradient(135deg, #6B5BFF 0%, #00CFFF 100%)",color:"#fff",border:"none",borderRadius:12,padding:"14px 28px",fontSize:16,fontWeight:700,cursor:"pointer",flex:1,boxShadow:"0 4px 12px #6B5BFF33",transition:"all 0.3s ease"},onMouseEnter:p=>{p.currentTarget.style.transform="translateY(-2px)",p.currentTarget.style.boxShadow="0 6px 16px #6B5BFF44"},onMouseLeave:p=>{p.currentTarget.style.transform="translateY(0)",p.currentTarget.style.boxShadow="0 4px 12px #6B5BFF33"},children:"⚡ 立即續購"}),r.jsx("button",{onClick:e,style:{background:"#f8f9ff",color:"#6B5BFF",border:"2px solid #6B5BFF",borderRadius:12,padding:"14px 28px",fontSize:16,fontWeight:600,cursor:"pointer",flex:1,transition:"all 0.3s ease"},onMouseEnter:p=>{p.currentTarget.style.background="#6B5BFF",p.currentTarget.style.color="#fff"},onMouseLeave:p=>{p.currentTarget.style.background="#f8f9ff",p.currentTarget.style.color="#6B5BFF"},children:"💫 稍後再說"})]}),r.jsx("div",{style:{marginTop:16},children:r.jsx("button",{onClick:e,style:{background:"none",border:"none",color:"#888",fontSize:14,cursor:"pointer",textDecoration:"underline"},children:"稍後再說"})})]})})},xE={production:{baseURL:"https://restarter-backend-6e9s.onrender.com/api",wsURL:"wss://restarter-backend-6e9s.onrender.com"}},jw=xE.production,_w=jw.baseURL,Iw=jw.wsURL,ea=n=>`${_w}${n}`,bE=()=>Iw;console.log("🌍 環境:","生產");console.log("🔗 API URL:",_w);console.log("🔌 WebSocket URL:",Iw);const Mf=({className:n="",showDetails:e=!1})=>{const{lang:t}=Qe(),[i,s]=g.useState(null),[o,a]=g.useState(!0),[l,c]=g.useState(null);g.useEffect(()=>{u()},[t]);const u=async()=>{try{a(!0),c(null);const b="Taipei";console.log("Fetching weather for:",b);const x=await fetch(ea(`/weather/current?city=${b}`));if(!x.ok)throw new Error(`HTTP error! status: ${x.status}`);const S=await x.json();if(console.log("Weather API response:",S),S.weather){const w=h(S.weather,t);console.log("Localized weather:",w),s(w)}else c(S.error||"無法獲取天氣資訊")}catch(b){c("天氣服務暫時無法使用"),console.error("Weather fetch error:",b)}finally{a(!1)}},h=(b,x)=>{var O,P,B;const S={"zh-TW":{"clear sky":"晴天","few clouds":"少雲","scattered clouds":"多雲","broken clouds":"陰天","shower rain":"陣雨",rain:"下雨",thunderstorm:"雷雨",snow:"下雪",haze:"霾",smoke:"煙霧",dust:"沙塵",sand:"沙塵",ash:"火山灰",squall:"狂風",tornado:"龍捲風",sunny:"晴天","partly cloudy":"多雲時晴",cloudy:"陰天",overcast:"陰天",mist:"霧",fog:"霧","patchy rain possible":"可能有陣雨","patchy snow possible":"可能有雪","patchy sleet possible":"可能有雨夾雪","patchy freezing drizzle possible":"可能有凍雨","thundery outbreaks possible":"可能有雷雨","blowing snow":"吹雪",blizzard:"暴風雪","freezing fog":"凍霧","patchy light drizzle":"零星小雨","light drizzle":"小雨","freezing drizzle":"凍雨","heavy freezing drizzle":"強凍雨","patchy light rain":"零星小雨","light rain":"小雨","moderate rain at times":"間歇性中雨","moderate rain":"中雨","heavy rain at times":"間歇性大雨","heavy rain":"大雨","light freezing rain":"輕凍雨","moderate or heavy freezing rain":"中到強凍雨","light sleet":"輕雨夾雪","moderate or heavy sleet":"中到強雨夾雪","patchy light snow":"零星小雪","light snow":"小雪","patchy moderate snow":"零星中雪","moderate snow":"中雪","patchy heavy snow":"零星大雪","heavy snow":"大雪","ice pellets":"冰雹","light rain shower":"小雨陣","moderate or heavy rain shower":"中到強雨陣","torrential rain shower":"暴雨陣","light sleet showers":"小雨夾雪陣","moderate or heavy sleet showers":"中到強雨夾雪陣","light snow showers":"小雪陣","moderate or heavy snow showers":"中到強雪陣","light showers of ice pellets":"輕冰雹陣","moderate or heavy showers of ice pellets":"中到強冰雹陣","patchy light rain with thunder":"零星小雨伴雷","moderate or heavy rain with thunder":"中到強雨伴雷","patchy light snow with thunder":"零星小雪伴雷","moderate or heavy snow with thunder":"中到強雪伴雷",局部多云:"局部多云"},"zh-CN":{"clear sky":"晴天","few clouds":"少云","scattered clouds":"多云","broken clouds":"阴天","shower rain":"阵雨",rain:"下雨",thunderstorm:"雷雨",snow:"下雪",haze:"霾",smoke:"烟雾",dust:"沙尘",sand:"沙尘",ash:"火山灰",squall:"狂风",tornado:"龙卷风",sunny:"晴天","partly cloudy":"多云时晴",cloudy:"阴天",overcast:"阴天",mist:"雾",fog:"雾","patchy rain possible":"可能有阵雨","patchy snow possible":"可能有雪","patchy sleet possible":"可能有雨夹雪","patchy freezing drizzle possible":"可能有冻雨","thundery outbreaks possible":"可能有雷雨","blowing snow":"吹雪",blizzard:"暴风雪","freezing fog":"冻雾","patchy light drizzle":"零星小雨","light drizzle":"小雨","freezing drizzle":"冻雨","heavy freezing drizzle":"强冻雨","patchy light rain":"零星小雨","light rain":"小雨","moderate rain at times":"间歇性中雨","moderate rain":"中雨","heavy rain at times":"间歇性大雨","heavy rain":"大雨","light freezing rain":"轻冻雨","moderate or heavy freezing rain":"中到强冻雨","light sleet":"轻雨夹雪","moderate or heavy sleet":"中到强雨夹雪","patchy light snow":"零星小雪","light snow":"小雪","patchy moderate snow":"零星中雪","moderate snow":"中雪","patchy heavy snow":"零星大雪","heavy snow":"大雪","ice pellets":"冰雹","light rain shower":"小雨阵","moderate or heavy rain shower":"中到强雨阵","torrential rain shower":"暴雨阵","light sleet showers":"小雨夹雪阵","moderate or heavy sleet showers":"中到强雨夹雪阵","light snow showers":"小雪阵","moderate or heavy snow showers":"中到强雪阵","light showers of ice pellets":"轻冰雹阵","moderate or heavy showers of ice pellets":"中到强冰雹阵","patchy light rain with thunder":"零星小雨伴雷","moderate or heavy rain with thunder":"中到强雨伴雷","patchy light snow with thunder":"零星小雪伴雷","moderate or heavy snow with thunder":"中到强雪伴雷",局部多云:"Partly Cloudy"},en:{"clear sky":"Clear","few clouds":"Partly Cloudy","scattered clouds":"Cloudy","broken clouds":"Overcast","shower rain":"Showers",rain:"Rain",thunderstorm:"Thunderstorm",snow:"Snow",haze:"Haze",smoke:"Smoke",dust:"Dust",sand:"Sand",ash:"Ash",squall:"Squall",tornado:"Tornado",sunny:"Sunny","partly cloudy":"Partly Cloudy",cloudy:"Cloudy",overcast:"Overcast",mist:"Mist",fog:"Fog","patchy rain possible":"Patchy Rain","patchy snow possible":"Patchy Snow","patchy sleet possible":"Patchy Sleet","patchy freezing drizzle possible":"Patchy Freezing Drizzle","thundery outbreaks possible":"Thundery Outbreaks","blowing snow":"Blowing Snow",blizzard:"Blizzard","freezing fog":"Freezing Fog","patchy light drizzle":"Patchy Light Drizzle","light drizzle":"Light Drizzle","freezing drizzle":"Freezing Drizzle","heavy freezing drizzle":"Heavy Freezing Drizzle","patchy light rain":"Patchy Light Rain","light rain":"Light Rain","moderate rain at times":"Moderate Rain","moderate rain":"Moderate Rain","heavy rain at times":"Heavy Rain","heavy rain":"Heavy Rain","light freezing rain":"Light Freezing Rain","moderate or heavy freezing rain":"Moderate or Heavy Freezing Rain","light sleet":"Light Sleet","moderate or heavy sleet":"Moderate or Heavy Sleet","patchy light snow":"Patchy Light Snow","light snow":"Light Snow","patchy moderate snow":"Patchy Moderate Snow","moderate snow":"Moderate Snow","patchy heavy snow":"Patchy Heavy Snow","heavy snow":"Heavy Snow","ice pellets":"Ice Pellets","light rain shower":"Light Rain Shower","moderate or heavy rain shower":"Moderate or Heavy Rain Shower","torrential rain shower":"Torrential Rain Shower","light sleet showers":"Light Sleet Showers","moderate or heavy sleet showers":"Moderate or Heavy Sleet Showers","light snow showers":"Light Snow Showers","moderate or heavy snow showers":"Moderate or Heavy Snow Showers","light showers of ice pellets":"Light Ice Pellet Showers","moderate or heavy showers of ice pellets":"Moderate or Heavy Ice Pellet Showers","patchy light rain with thunder":"Patchy Light Rain with Thunder","moderate or heavy rain with thunder":"Moderate or Heavy Rain with Thunder","patchy light snow with thunder":"Patchy Light Snow with Thunder","moderate or heavy snow with thunder":"Moderate or Heavy Snow with Thunder",局部多云:"Partly Cloudy"},ja:{"clear sky":"晴天","few clouds":"晴れ時々曇り","scattered clouds":"曇り","broken clouds":"曇り","shower rain":"にわか雨",rain:"雨",thunderstorm:"雷雨",snow:"雪",haze:"もや",smoke:"煙",dust:"砂塵",sand:"砂塵",ash:"火山灰",squall:"突風",tornado:"竜巻",sunny:"晴天","partly cloudy":"晴れ時々曇り",cloudy:"曇り",overcast:"曇り",mist:"霧",fog:"霧","patchy rain possible":"にわか雨の可能性","patchy snow possible":"にわか雪の可能性","patchy sleet possible":"にわかみぞれの可能性","patchy freezing drizzle possible":"にわか凍る霧雨の可能性","thundery outbreaks possible":"雷雨の可能性","blowing snow":"吹雪",blizzard:"猛吹雪","freezing fog":"凍る霧","patchy light drizzle":"にわか小雨","light drizzle":"小雨","freezing drizzle":"凍る霧雨","heavy freezing drizzle":"強い凍る霧雨","patchy light rain":"にわか小雨","light rain":"小雨","moderate rain at times":"時々中雨","moderate rain":"中雨","heavy rain at times":"時々大雨","heavy rain":"大雨","light freezing rain":"軽い凍る雨","moderate or heavy freezing rain":"中程度または強い凍る雨","light sleet":"軽いみぞれ","moderate or heavy sleet":"中程度または強いみぞれ","patchy light snow":"にわか小雪","light snow":"小雪","patchy moderate snow":"にわか中雪","moderate snow":"中雪","patchy heavy snow":"にわか大雪","heavy snow":"大雪","ice pellets":"氷の粒","light rain shower":"小雨のシャワー","moderate or heavy rain shower":"中程度または強い雨のシャワー","torrential rain shower":"豪雨のシャワー","light sleet showers":"軽いみぞれのシャワー","moderate or heavy sleet showers":"中程度または強いみぞれのシャワー","light snow showers":"小雪のシャワー","moderate or heavy snow showers":"中程度または強い雪のシャワー","light showers of ice pellets":"軽い氷の粒のシャワー","moderate or heavy showers of ice pellets":"中程度または強い氷の粒のシャワー","patchy light rain with thunder":"にわか小雨と雷","moderate or heavy rain with thunder":"中程度または強い雨と雷","patchy light snow with thunder":"にわか小雪と雷","moderate or heavy snow with thunder":"中程度または強い雪と雷",局部多云:"晴れ時々曇り"},ko:{"clear sky":"맑음","few clouds":"구름 조금","scattered clouds":"구름 많음","broken clouds":"흐림","shower rain":"소나기",rain:"비",thunderstorm:"천둥번개",snow:"눈",haze:"연무",smoke:"연기",dust:"먼지",sand:"모래",ash:"화산재",squall:"돌풍",tornado:"토네이도",sunny:"맑음","partly cloudy":"구름 조금",cloudy:"흐림",overcast:"흐림",mist:"안개",fog:"안개","patchy rain possible":"소나기 가능","patchy snow possible":"눈 가능","patchy sleet possible":"진눈깨비 가능","patchy freezing drizzle possible":"얼음비 가능","thundery outbreaks possible":"천둥번개 가능","blowing snow":"눈보라",blizzard:"폭설","freezing fog":"얼음안개","patchy light drizzle":"가벼운 이슬비","light drizzle":"이슬비","freezing drizzle":"얼음비","heavy freezing drizzle":"강한 얼음비","patchy light rain":"가벼운 비","light rain":"가벼운 비","moderate rain at times":"중간 비","moderate rain":"중간 비","heavy rain at times":"강한 비","heavy rain":"강한 비","light freezing rain":"가벼운 얼음비","moderate or heavy freezing rain":"중간 또는 강한 얼음비","light sleet":"가벼운 진눈깨비","moderate or heavy sleet":"중간 또는 강한 진눈깨비","patchy light snow":"가벼운 눈","light snow":"가벼운 눈","patchy moderate snow":"중간 눈","moderate snow":"중간 눈","patchy heavy snow":"강한 눈","heavy snow":"강한 눈","ice pellets":"얼음알갱이","light rain shower":"가벼운 소나기","moderate or heavy rain shower":"중간 또는 강한 소나기","torrential rain shower":"폭우","light sleet showers":"가벼운 진눈깨비 소나기","moderate or heavy sleet showers":"중간 또는 강한 진눈깨비 소나기","light snow showers":"가벼운 눈 소나기","moderate or heavy snow showers":"중간 또는 강한 눈 소나기","light showers of ice pellets":"가벼운 얼음알갱이 소나기","moderate or heavy showers of ice pellets":"중간 또는 강한 얼음알갱이 소나기","patchy light rain with thunder":"가벼운 비와 천둥","moderate or heavy rain with thunder":"중간 또는 강한 비와 천둥","patchy light snow with thunder":"가벼운 눈과 천둥","moderate or heavy snow with thunder":"중간 또는 강한 눈과 천둥",局部多云:"구름 조금"},th:{"clear sky":"ท้องฟ้าแจ่มใส","few clouds":"มีเมฆบางส่วน","scattered clouds":"มีเมฆมาก","broken clouds":"เมฆมาก","shower rain":"ฝนตกเป็นช่วง",rain:"ฝนตก",thunderstorm:"พายุฝนฟ้าคะนอง",snow:"หิมะตก",haze:"หมอกควัน",smoke:"ควัน",dust:"ฝุ่น",sand:"ทราย",ash:"เถ้าถ่าน",squall:"ลมกระโชก",tornado:"พายุทอร์นาโด",sunny:"ท้องฟ้าแจ่มใส","partly cloudy":"มีเมฆบางส่วน",cloudy:"เมฆมาก",overcast:"เมฆมาก",mist:"หมอก",fog:"หมอก","patchy rain possible":"อาจมีฝนตกเป็นช่วง","patchy snow possible":"อาจมีหิมะตกเป็นช่วง","patchy sleet possible":"อาจมีหิมะปนฝนเป็นช่วง","patchy freezing drizzle possible":"อาจมีน้ำค้างแข็งเป็นช่วง","thundery outbreaks possible":"อาจมีพายุฝนฟ้าคะนอง","blowing snow":"หิมะปลิว",blizzard:"พายุหิมะ","freezing fog":"หมอกแข็ง","patchy light drizzle":"น้ำค้างเบาเป็นช่วง","light drizzle":"น้ำค้างเบา","freezing drizzle":"น้ำค้างแข็ง","heavy freezing drizzle":"น้ำค้างแข็งแรง","patchy light rain":"ฝนเบาเป็นช่วง","light rain":"ฝนเบา","moderate rain at times":"ฝนปานกลางเป็นครั้งคราว","moderate rain":"ฝนปานกลาง","heavy rain at times":"ฝนแรงเป็นครั้งคราว","heavy rain":"ฝนแรง","light freezing rain":"ฝนแข็งเบา","moderate or heavy freezing rain":"ฝนแข็งปานกลางหรือแรง","light sleet":"หิมะปนฝนเบา","moderate or heavy sleet":"หิมะปนฝนปานกลางหรือแรง","patchy light snow":"หิมะเบาเป็นช่วง","light snow":"หิมะเบา","patchy moderate snow":"หิมะปานกลางเป็นช่วง","moderate snow":"หิมะปานกลาง","patchy heavy snow":"หิมะแรงเป็นช่วง","heavy snow":"หิมะแรง","ice pellets":"ลูกเห็บ","light rain shower":"ฝนเบาสั้นๆ","moderate or heavy rain shower":"ฝนปานกลางหรือแรงสั้นๆ","torrential rain shower":"ฝนแรงสั้นๆ","light sleet showers":"หิมะปนฝนเบาสั้นๆ","moderate or heavy sleet showers":"หิมะปนฝนปานกลางหรือแรงสั้นๆ","light snow showers":"หิมะเบาสั้นๆ","moderate or heavy snow showers":"หิมะปานกลางหรือแรงสั้นๆ","light showers of ice pellets":"ลูกเห็บเบาสั้นๆ","moderate or heavy showers of ice pellets":"ลูกเห็บปานกลางหรือแรงสั้นๆ","patchy light rain with thunder":"ฝนเบาเป็นช่วงพร้อมฟ้าผ่า","moderate or heavy rain with thunder":"ฝนปานกลางหรือแรงพร้อมฟ้าผ่า","patchy light snow with thunder":"หิมะเบาเป็นช่วงพร้อมฟ้าผ่า","moderate or heavy snow with thunder":"หิมะปานกลางหรือแรงพร้อมฟ้าผ่า",局部多云:"มีเมฆบางส่วน"},vi:{"clear sky":"Trời quang","few clouds":"Ít mây","scattered clouds":"Nhiều mây","broken clouds":"U ám","shower rain":"Mưa rào",rain:"Mưa",thunderstorm:"Giông bão",snow:"Tuyết",haze:"Sương mù nhẹ",smoke:"Khói",dust:"Bụi",sand:"Cát",ash:"Tro núi lửa",squall:"Gió mạnh",tornado:"Lốc xoáy",sunny:"Trời nắng","partly cloudy":"Ít mây",cloudy:"Nhiều mây",overcast:"U ám",mist:"Sương mù",fog:"Sương mù","patchy rain possible":"Có thể mưa rào","patchy snow possible":"Có thể có tuyết","patchy sleet possible":"Có thể có mưa tuyết","patchy freezing drizzle possible":"Có thể có mưa đá","thundery outbreaks possible":"Có thể có giông bão","blowing snow":"Tuyết bay",blizzard:"Bão tuyết","freezing fog":"Sương mù đóng băng","patchy light drizzle":"Mưa phùn nhẹ","light drizzle":"Mưa phùn nhẹ","freezing drizzle":"Mưa đá","heavy freezing drizzle":"Mưa đá mạnh","patchy light rain":"Mưa nhẹ","light rain":"Mưa nhẹ","moderate rain at times":"Mưa vừa","moderate rain":"Mưa vừa","heavy rain at times":"Mưa to","heavy rain":"Mưa to","light freezing rain":"Mưa đá nhẹ","moderate or heavy freezing rain":"Mưa đá vừa hoặc mạnh","light sleet":"Mưa tuyết nhẹ","moderate or heavy sleet":"Mưa tuyết vừa hoặc mạnh","patchy light snow":"Tuyết nhẹ","light snow":"Tuyết nhẹ","patchy moderate snow":"Tuyết vừa","moderate snow":"Tuyết vừa","patchy heavy snow":"Tuyết to","heavy snow":"Tuyết to","ice pellets":"Mưa đá","light rain shower":"Mưa rào nhẹ","moderate or heavy rain shower":"Mưa rào vừa hoặc mạnh","torrential rain shower":"Mưa rào to","light sleet showers":"Mưa tuyết nhẹ","moderate or heavy sleet showers":"Mưa tuyết vừa hoặc mạnh","light snow showers":"Tuyết nhẹ","moderate or heavy snow showers":"Tuyết vừa hoặc mạnh","light showers of ice pellets":"Mưa đá nhẹ","moderate or heavy showers of ice pellets":"Mưa đá vừa hoặc mạnh","patchy light rain with thunder":"Mưa nhẹ có sấm","moderate or heavy rain with thunder":"Mưa vừa hoặc mạnh có sấm","patchy light snow with thunder":"Tuyết nhẹ có sấm","moderate or heavy snow with thunder":"Tuyết vừa hoặc mạnh có sấm",局部多云:"Ít mây"},ms:{"clear sky":"Cerah","few clouds":"Sedikit berawan","scattered clouds":"Berawan","broken clouds":"Mendung","shower rain":"Hujan renyai",rain:"Hujan",thunderstorm:"Ribut petir",snow:"Salji",haze:"Jerebu",smoke:"Asap",dust:"Debu",sand:"Pasir",ash:"Abu gunung berapi",squall:"Angin kencang",tornado:"Puting beliung",sunny:"Cerah","partly cloudy":"Sedikit berawan",cloudy:"Berawan",overcast:"Mendung",mist:"Kabut",fog:"Kabut","patchy rain possible":"Hujan renyai mungkin","patchy snow possible":"Salji mungkin","patchy sleet possible":"Hujan salji mungkin","patchy freezing drizzle possible":"Hujan beku mungkin","thundery outbreaks possible":"Ribut petir mungkin","blowing snow":"Salji berterbangan",blizzard:"Ribut salji","freezing fog":"Kabut beku","patchy light drizzle":"Hujan renyai ringan","light drizzle":"Hujan renyai ringan","freezing drizzle":"Hujan beku","heavy freezing drizzle":"Hujan beku lebat","patchy light rain":"Hujan ringan","light rain":"Hujan ringan","moderate rain at times":"Hujan sederhana","moderate rain":"Hujan sederhana","heavy rain at times":"Hujan lebat","heavy rain":"Hujan lebat","light freezing rain":"Hujan beku ringan","moderate or heavy freezing rain":"Hujan beku sederhana atau lebat","light sleet":"Hujan salji ringan","moderate or heavy sleet":"Hujan salji sederhana atau lebat","patchy light snow":"Salji ringan","light snow":"Salji ringan","patchy moderate snow":"Salji sederhana","moderate snow":"Salji sederhana","patchy heavy snow":"Salji lebat","heavy snow":"Salji lebat","ice pellets":"Hujan batu","light rain shower":"Hujan ringan","moderate or heavy rain shower":"Hujan sederhana atau lebat","torrential rain shower":"Hujan lebat","light sleet showers":"Hujan salji ringan","moderate or heavy sleet showers":"Hujan salji sederhana atau lebat","light snow showers":"Salji ringan","moderate or heavy snow showers":"Salji sederhana atau lebat","light showers of ice pellets":"Hujan batu ringan","moderate or heavy showers of ice pellets":"Hujan batu sederhana atau lebat","patchy light rain with thunder":"Hujan ringan dengan petir","moderate or heavy rain with thunder":"Hujan sederhana atau lebat dengan petir","patchy light snow with thunder":"Salji ringan dengan petir","moderate or heavy snow with thunder":"Salji sederhana atau lebat dengan petir",局部多云:"Sedikit berawan"},la:{"clear sky":"Serenum","few clouds":"Nubibus paucis","scattered clouds":"Nubibus dispersis","broken clouds":"Nubibus fractis","shower rain":"Imbre",rain:"Pluvia",thunderstorm:"Tempestas",snow:"Nix",haze:"Caligo",smoke:"Fumus",dust:"Pulvis",sand:"Arena",ash:"Cinis",squall:"Procella",tornado:"Turbo",sunny:"Serenum","partly cloudy":"Nubibus paucis",cloudy:"Nubibus",overcast:"Nubibus densis",mist:"Nebula",fog:"Nebula","patchy rain possible":"Imbre possibilis","patchy snow possible":"Nix possibilis","patchy sleet possible":"Nix pluvia possibilis","patchy freezing drizzle possible":"Gelida pluvia possibilis","thundery outbreaks possible":"Tempestas possibilis","blowing snow":"Nix ventosa",blizzard:"Procella nivis","freezing fog":"Gelida nebula","patchy light drizzle":"Levis pluvia","light drizzle":"Levis pluvia","freezing drizzle":"Gelida pluvia","heavy freezing drizzle":"Gravis gelida pluvia","patchy light rain":"Levis pluvia","light rain":"Levis pluvia","moderate rain at times":"Moderata pluvia","moderate rain":"Moderata pluvia","heavy rain at times":"Gravis pluvia","heavy rain":"Gravis pluvia","light freezing rain":"Levis gelida pluvia","moderate or heavy freezing rain":"Moderata vel gravis gelida pluvia","light sleet":"Levis nix pluvia","moderate or heavy sleet":"Moderata vel gravis nix pluvia","patchy light snow":"Levis nix","light snow":"Levis nix","patchy moderate snow":"Moderata nix","moderate snow":"Moderata nix","patchy heavy snow":"Gravis nix","heavy snow":"Gravis nix","ice pellets":"Glacies grana","light rain shower":"Levis pluvia","moderate or heavy rain shower":"Moderata vel gravis pluvia","torrential rain shower":"Torrens pluvia","light sleet showers":"Levis nix pluvia","moderate or heavy sleet showers":"Moderata vel gravis nix pluvia","light snow showers":"Levis nix","moderate or heavy snow showers":"Moderata vel gravis nix","light showers of ice pellets":"Levis glacies grana","moderate or heavy showers of ice pellets":"Moderata vel gravis glacies grana","patchy light rain with thunder":"Levis pluvia cum tonitru","moderate or heavy rain with thunder":"Moderata vel gravis pluvia cum tonitru","patchy light snow with thunder":"Levis nix cum tonitru","moderate or heavy snow with thunder":"Moderata vel gravis nix cum tonitru",局部多云:"Nubibus paucis"}},w={"zh-TW":{Taipei:"台北市",Taichung:"台中市",Tainan:"台南市",Kaohsiung:"高雄市","New Taipei":"新北市",Taoyuan:"桃園市",Hsinchu:"新竹市",Chiayi:"嘉義市",Keelung:"基隆市",Hualien:"花蓮縣",Taitung:"台東縣",Pingtung:"屏東縣",Yilan:"宜蘭縣",Nantou:"南投縣",Yunlin:"雲林縣",Changhua:"彰化縣",Miaoli:"苗栗縣"},"zh-CN":{Taipei:"台北市",Taichung:"台中市",Tainan:"台南市",Kaohsiung:"高雄市","New Taipei":"新北市",Taoyuan:"桃园市",Hsinchu:"新竹市",Chiayi:"嘉义市",Keelung:"基隆市",Hualien:"花莲县",Taitung:"台东县",Pingtung:"屏东县",Yilan:"宜兰县",Nantou:"南投县",Yunlin:"云林县",Changhua:"彰化县",Miaoli:"苗栗县"},en:{Taipei:"Taipei",Taichung:"Taichung",Tainan:"Tainan",Kaohsiung:"Kaohsiung","New Taipei":"New Taipei",Taoyuan:"Taoyuan",Hsinchu:"Hsinchu",Chiayi:"Chiayi",Keelung:"Keelung",Hualien:"Hualien",Taitung:"Taitung",Pingtung:"Pingtung",Yilan:"Yilan",Nantou:"Nantou",Yunlin:"Yunlin",Changhua:"Changhua",Miaoli:"Miaoli"},ja:{Taipei:"台北",Taichung:"台中",Tainan:"台南",Kaohsiung:"高雄","New Taipei":"新北",Taoyuan:"桃園",Hsinchu:"新竹",Chiayi:"嘉義",Keelung:"基隆",Hualien:"花蓮",Taitung:"台東",Pingtung:"屏東",Yilan:"宜蘭",Nantou:"南投",Yunlin:"雲林",Changhua:"彰化",Miaoli:"苗栗"},ko:{Taipei:"타이페이",Taichung:"타이중",Tainan:"타이난",Kaohsiung:"가오슝","New Taipei":"신베이",Taoyuan:"타오위안",Hsinchu:"신주",Chiayi:"자이",Keelung:"지룽",Hualien:"화롄",Taitung:"타이둥",Pingtung:"핑둥",Yilan:"이란",Nantou:"난터우",Yunlin:"윈린",Changhua:"창화",Miaoli:"먀오리"},th:{Taipei:"ไทเป",Taichung:"ไทจง",Tainan:"ไทหนาน",Kaohsiung:"เกาสง","New Taipei":"ซินเป่ย์",Taoyuan:"เถาหยวน",Hsinchu:"ซินจู๋",Chiayi:"เจียอี้",Keelung:"จีหลง",Hualien:"ฮวาเหลียน",Taitung:"ไถตง",Pingtung:"ผิงตง",Yilan:"อี๋หลาน",Nantou:"หนานโถว",Yunlin:"ยฺหวินหลิน",Changhua:"จางฮัว",Miaoli:"เหมียวลี่"},vi:{Taipei:"Đài Bắc",Taichung:"Đài Trung",Tainan:"Đài Nam",Kaohsiung:"Cao Hùng","New Taipei":"Tân Bắc",Taoyuan:"Đào Viên",Hsinchu:"Tân Trúc",Chiayi:"Gia Nghĩa",Keelung:"Cơ Long",Hualien:"Hoa Liên",Taitung:"Đài Đông",Pingtung:"Bình Đông",Yilan:"Nghi Lan",Nantou:"Nam Đầu",Yunlin:"Vân Lâm",Changhua:"Chương Hóa",Miaoli:"Miêu Lật"},ms:{Taipei:"Taipei",Taichung:"Taichung",Tainan:"Tainan",Kaohsiung:"Kaohsiung","New Taipei":"New Taipei",Taoyuan:"Taoyuan",Hsinchu:"Hsinchu",Chiayi:"Chiayi",Keelung:"Keelung",Hualien:"Hualien",Taitung:"Taitung",Pingtung:"Pingtung",Yilan:"Yilan",Nantou:"Nantou",Yunlin:"Yunlin",Changhua:"Changhua",Miaoli:"Miaoli"},la:{Taipei:"Taipeium",Taichung:"Taichungum",Tainan:"Tainanum",Kaohsiung:"Kaohsiungum","New Taipei":"Novum Taipeium",Taoyuan:"Taoyuanum",Hsinchu:"Hsinchuum",Chiayi:"Chiayium",Keelung:"Keelungum",Hualien:"Hualienum",Taitung:"Taitungum",Pingtung:"Pingtungum",Yilan:"Yilanum",Nantou:"Nantouum",Yunlin:"Yunlinum",Changhua:"Changhuaum",Miaoli:"Miaolium"}},I={"zh-TW":["星期日","星期一","星期二","星期三","星期四","星期五","星期六"],"zh-CN":["星期日","星期一","星期二","星期三","星期四","星期五","星期六"],en:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],ja:["日曜日","月曜日","火曜日","水曜日","木曜日","金曜日","土曜日"],ko:["일요일","월요일","화요일","수요일","목요일","금요일","토요일"],th:["วันอาทิตย์","วันจันทร์","วันอังคาร","วันพุธ","วันพฤหัสบดี","วันศุกร์","วันเสาร์"],vi:["Chủ nhật","Thứ hai","Thứ ba","Thứ tư","Thứ năm","Thứ sáu","Thứ bảy"],ms:["Ahad","Isnin","Selasa","Rabu","Khamis","Jumaat","Sabtu"],la:["Dies Solis","Dies Lunae","Dies Martis","Dies Mercurii","Dies Iovis","Dies Veneris","Dies Saturni"]},j=((O=S[x])==null?void 0:O[b.description.toLowerCase()])||b.description,A=((P=w[x])==null?void 0:P[b.city])||b.city,D=((B=I[x])==null?void 0:B[new Date().getDay()])||I.en[new Date().getDay()];return{...b,description:j,city:A,weekday:D}};if(o)return r.jsx("div",{className:`weather-widget ${n}`,style:{background:"#ffffff",borderRadius:"8px",padding:"8px 12px",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.1)",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',marginTop:"8px"},children:r.jsx("div",{style:{fontSize:"12px",color:"#666",textAlign:"center"},children:"載入中..."})});if(l)return r.jsx("div",{className:`weather-widget ${n}`,style:{background:"#ffffff",borderRadius:"8px",padding:"8px 12px",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.1)",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',marginTop:"8px"},children:r.jsx("div",{style:{fontSize:"12px",color:"#ff6b6b",textAlign:"center"},children:l})});if(!i)return null;const p=h(i,t),f=()=>{const b=(i==null?void 0:i.city)||"Taipei",x=`https://www.google.com/search?q=weather+${encodeURIComponent(b)}`;window.open(x,"_blank")};return r.jsx("div",{className:`weather-widget ${n}`,onClick:f,style:{background:"#ffffff",borderRadius:"8px",padding:"8px 12px",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.1)",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',marginTop:"8px",cursor:"pointer",transition:"all 0.2s ease"},onMouseEnter:b=>{b.currentTarget.style.boxShadow="0 4px 12px rgba(0, 0, 0, 0.15)",b.currentTarget.style.transform="translateY(-1px)"},onMouseLeave:b=>{b.currentTarget.style.boxShadow="0 2px 8px rgba(0, 0, 0, 0.1)",b.currentTarget.style.transform="translateY(0)"},children:r.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:"8px"},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"4px"},children:[r.jsx("span",{style:{fontSize:"16px"},children:"☀️"}),r.jsxs("div",{style:{fontSize:"14px",fontWeight:600,color:"#6B5BFF"},children:[p.temp,"°C"]}),r.jsx("div",{style:{fontSize:"10px",color:"#666"},children:p.description})]}),r.jsx("div",{style:{fontSize:"12px",color:"#666"},children:p.city}),r.jsx("div",{style:{fontSize:"12px",color:"#666"},children:p.weekday})]})})},$d={"zh-TW":{slogan:["找回信任的起點，重新出發不孤單！"],desc:`Restarter™ 一個重啟人生的平台，這裡沒有標籤，只有理解。
從「社會融入評估」開始，AI 將陪你走進十個關卡：情緒解鎖、心聲釋放、挑戰任務、交友連結……每一站都為了幫助你找回信任與方向。
情緒來了不需要壓抑——專屬的情緒發洩遊戲區讓你不傷人更能盡情釋放壓力。
你不是被定型的人，而是有勇氣重新選擇的人。
在這裡，你可以放心說出自己的故事與情緒，找到解方，為自己活出下一章。`,wall:"你可以放心說出自己的故事與心情，這裡有理解與同行。",friend:"交友區",voice:"即時語音輸入",ai:"AI 風格回覆",tts:"擬真語音輸出",chat:"來聊天吧！",emotion:"情緒圖像實驗室",welcomeRegister:"歡迎註冊"},"zh-CN":{slogan:["找回信任的起点，重新出发不孤单！"],desc:`Restarter™ 一个重启人生的平台，这里没有标签，只有理解。
从「社会融入评估」开始，AI 将陪你走进十个关卡：情绪解锁、心声释放、挑战任务、交友连结……每一站都为了帮助你找回信任与方向。
情绪来了不需要压抑——专属的情绪发泄游戏区让你不伤人更能尽情释放压力。
你不是被定型的人，而是有勇气重新选择的人。
在这里，你可以放心说出自己的故事与情绪，找到解方，为自己活出下一章。`,wall:"你可以放心说出自己的故事与心情，这里有理解与同行。",friend:"交友区",voice:"即时语音输入",ai:"AI 风格回复",tts:"拟真语音输出",chat:"来聊天吧！",emotion:"情绪图像实验室",welcomeRegister:"欢迎注册"},en:{slogan:["Regain trust and start anew, you are never alone!"],desc:`Restarter™ is a platform for restarting your life. Here, there are no labels, only understanding.
Starting with "Social Integration Assessment", AI will accompany you through ten levels: emotional unlocking, voice release, challenging tasks, friend connections... every stop is to help you find trust and direction.
When emotions come, there is no need to suppress them—a dedicated emotional release game zone allows you to fully release stress without harming others.
You are not a fixed person, but someone with the courage to choose again.
Here, you can confidently tell your stories and emotions, find solutions, and live out your next chapter.`,wall:"You can safely share your story and feelings here, where you will find understanding and companionship.",friend:"Friend Match",voice:"Voice Input",ai:"AI Style Reply",tts:"Realistic TTS",chat:"Let's Chat!",emotion:"Emotion Visual Lab",welcomeRegister:"Welcome Register"},ja:{slogan:["信頼を取り戻し、新たな一歩を踏み出そう！"],desc:`Restarter™は人生を再出発するためのプラットフォームです。ここにはラベルはなく、理解だけがあります。
「社会的統合評価」から始まり、AIがあなたと一緒に10のレベルを進みます：感情の解放、心の声の解放、挑戦的なタスク、友達とのつながり... 各ステップはあなたが信頼と方向性を見つけるのを助けるためです。
感情が湧いてきた時、それを抑える必要はありません——専用の感情解放ゲームゾーンで、他の人を傷つけることなくストレスを完全に解放できます。
あなたは固定された人ではなく、再び選択する勇気を持つ人です。
ここでは、自分の物語と感情を安心して話し、解決策を見つけ、次の章を生きることができます。`,wall:"ここでは安心して自分のストーリーや気持ちを話せます。理解と共感がここにあります。",friend:"友達マッチ",voice:"音声入力",ai:"AIスタイル返信",tts:"リアルTTS",chat:"話しましょう！",emotion:"感情ビジュアルラボ",welcomeRegister:"登録へようこそ"},ko:{slogan:["신뢰를 되찾고, 새롭게 시작하세요. 당신은 결코 혼자가 아닙니다!"],desc:`Restarter™는 인생을 재시작하는 플랫폼입니다. 이곳에는 낙인이 없고, 오직 이해만이 있습니다.
「사회적 통합 평가」부터 시작하여 AI가 당신과 함께 10개의 레벨을 진행합니다: 감정 해방, 마음의 소리 해방, 도전적인 임무, 친구 연결... 각 정류장은 당신이 신뢰와 방향을 찾는 것을 돕기 위한 것입니다.
감정이 올 때 그것을 억누를 필요가 없습니다——전용 감정 해방 게임 존에서 다른 사람을 다치게 하지 않고 스트레스를 완전히 해방할 수 있습니다.
당신은 고정된 사람이 아니라 다시 선택할 용기를 가진 사람입니다.
여기서는 자신의 이야기와 감정을 안심하고 말하고, 해결책을 찾아 다음 장을 살아갈 수 있습니다.`,wall:"여기서는 자신의 이야기와 감정을 안심하고 말할 수 있습니다. 이곳에는 이해와 동행이 있습니다.",friend:"친구 매칭",voice:"음성 입력",ai:"AI 스타일 답장",tts:"현실적인 TTS",chat:"채팅하자!",emotion:"감정 비주얼 랩",welcomeRegister:"가입 환영"},th:{slogan:["เริ่มต้นใหม่ด้วยความไว้วางใจ คุณไม่ได้อยู่คนเดียว!"],desc:`Restarter™ คือแพลตฟอร์มสำหรับเริ่มต้นชีวิตใหม่ ที่นี่ไม่มีป้ายกำกับ มีแต่ความเข้าใจ
เริ่มต้นจาก「การประเมินการผสมผสานทางสังคม」AI จะอยู่เคียงข้างคุณผ่าน 10 ระดับ: การปลดล็อคอารมณ์ การปลดปล่อยเสียงในใจ งานท้าทาย การเชื่อมต่อเพื่อน... ทุกจุดหยุดเพื่อช่วยให้คุณค้นพบความไว้วางใจและทิศทาง
เมื่ออารมณ์มา ไม่จำเป็นต้องกดดัน——โซนเกมปลดปล่อยอารมณ์เฉพาะช่วยให้คุณปลดปล่อยความเครียดได้อย่างเต็มที่โดยไม่ทำร้ายผู้อื่น
คุณไม่ใช่คนที่ถูกกำหนดไว้ แต่เป็นคนที่มีความกล้าหาญที่จะเลือกใหม่
ที่นี่ คุณสามารถบอกเล่าเรื่องราวและอารมณ์ของตัวเองได้อย่างสบายใจ หาแนวทางแก้ไข และใช้ชีวิตบทถัดไป`,wall:"คุณสามารถพูดเรื่องราวและความรู้สึกของคุณได้อย่างสบายใจ ที่นี่มีความเข้าใจและเพื่อนร่วมทาง",friend:"จับคู่เพื่อน",voice:"ป้อนข้อมูลด้วยเสียง",ai:"ตอบกลับสไตล์ AI",tts:"TTS ที่สมจริง",chat:"มาคุยกันเถอะ!",emotion:"ห้องทดลองภาพอารมณ์",welcomeRegister:"ยินดีต้อนรับการลงทะเบียน"},vi:{slogan:["Tìm lại niềm tin, bắt đầu lại, bạn không bao giờ đơn độc!"],desc:`Restarter™ là nền tảng để làm lại cuộc đời. Ở đây không có nhãn mác, chỉ có sự thấu hiểu.
Bắt đầu từ「Đánh giá Hòa nhập Xã hội」, AI sẽ đồng hành cùng bạn qua 10 cấp độ: mở khóa cảm xúc, giải phóng tiếng nói nội tâm, nhiệm vụ thách thức, kết nối bạn bè... mỗi điểm dừng để giúp bạn tìm lại niềm tin và định hướng.
Khi cảm xúc đến, không cần phải kìm nén——khu vực trò chơi giải phóng cảm xúc chuyên biệt cho phép bạn giải phóng căng thẳng hoàn toàn mà không làm tổn thương người khác.
Bạn không phải là người bị định hình, mà là người có dũng khí để lựa chọn lại.
Ở đây, bạn có thể yên tâm chia sẻ câu chuyện và cảm xúc của mình, tìm ra giải pháp, và sống chương tiếp theo của cuộc đời.`,wall:"Bạn có thể yên tâm chia sẻ câu chuyện và cảm xúc của mình tại đây, nơi có sự thấu hiểu và đồng hành.",friend:"Ghép bạn bè",voice:"Nhập liệu bằng giọng nói",ai:"Trả lời theo phong cách AI",tts:"TTS thực tế",chat:"Hãy trò chuyện!",emotion:"Phòng thí nghiệm hình ảnh cảm xúc",welcomeRegister:"Chào mừng đăng ký"},ms:{slogan:["Temui semula kepercayaan, mulakan semula, anda tidak pernah keseorangan!"],desc:`Restarter™ ialah platform untuk memulakan semula kehidupan. Di sini tiada label, hanya pemahaman.
Bermula dari「Penilaian Integrasi Sosial」, AI akan menemani anda melalui 10 peringkat: membuka kunci emosi, melepaskan suara hati, tugas mencabar, sambungan rakan... setiap perhentian untuk membantu anda mencari kepercayaan dan arah tuju.
Apabila emosi datang, tidak perlu menekan——zon permainan pelepasan emosi khusus membolehkan anda melepaskan tekanan sepenuhnya tanpa mencederakan orang lain.
Anda bukan orang yang ditetapkan, tetapi seseorang yang mempunyai keberanian untuk memilih semula.
Di sini, anda boleh berkongsi kisah dan emosi anda dengan tenang, mencari penyelesaian, dan hidup bab seterusnya.`,wall:"Anda boleh berkongsi kisah dan perasaan anda dengan tenang di sini, di mana ada pemahaman dan teman seperjalanan.",friend:"Padanan Rakan",voice:"Input Suara",ai:"Balasan Gaya AI",tts:"TTS Realistik",chat:"Jom Sembang!",emotion:"Makmal Visual Emosi",welcomeRegister:"Selamat Datang Daftar"},la:{slogan:["Fidem recupera et iterum incipe, numquam solus es!"],desc:`Restarter™ est suggestum ad vitam iterum incipiendam. Hic nullae notae sunt, tantum intellectus.
Incipiendo ab「Aestimatio Integrationis Socialis」, AI tecum per decem gradus ambulabit: solutio affectuum, emissio vocis cordis, negotia provocantia, nexus amicorum... omnis statio ad te adiuvandum fidem et directionem inveniendam.
Cum affectus veniunt, non necesse est eos supprimere——zona ludi emissionis affectuum dedicata te sinit tensionem plene emittere sine aliis laedendis.
Tu non es homo fixus, sed qui audaciam habet iterum eligendi.
Hic, tuto fabulas tuas et affectus narrare potes, solutiones invenire, et proximum caput vivere.`,wall:"Hic tuto fabulas tuas et sensus tuos narrare potes: hic intellectus et comitatus invenies.",friend:"Par Amicus",voice:"Vox Input",ai:"AI Stylus Responsio",tts:"Verus TTS",chat:"Loquamur!",emotion:"Emotion Visual Lab",welcomeRegister:"Benevenite Registrare"}},Wf={"zh-TW":"🧑‍🤝‍🧑","zh-CN":"🧑‍🤝‍🧑",en:"🧑‍🤝‍🧑",ja:"🧑‍🤝‍🧑",ko:"🧑‍🤝‍🧑",th:"🧑‍🤝‍🧑",vi:"🧑‍🤝‍🧑",ms:"🧑‍🤝‍🧑",la:"🧑‍🤝‍🧑"},Gd={"zh-TW":{privacy:"隱私權政策",terms:"條款/聲明",deletion:"資料刪除說明"},"zh-CN":{privacy:"隐私政策",terms:"条款/声明",deletion:"资料删除说明"},en:{privacy:"Privacy Policy",terms:"Terms/Statement",deletion:"Data Deletion"},ja:{privacy:"プライバシーポリシー",terms:"規約/声明",deletion:"データ削除について"},ko:{privacy:"개인정보처리방침",terms:"약관/성명",deletion:"데이터 삭제 안내"},th:{privacy:"นโยบายความเป็นส่วนตัว",terms:"ข้อกำหนด/แถลงการณ์",deletion:"คำอธิบายการลบข้อมูล"},vi:{privacy:"Chính sách bảo mật",terms:"Điều khoản/Tuyên bố",deletion:"Giải thích xóa dữ liệu"},ms:{privacy:"Dasar Privasi",terms:"Terma/Pernyataan",deletion:"Penjelasan Penghapusan Data"},la:{privacy:"Consilium Privacy",terms:"Termini/Declaratio",deletion:"Norma Deletionis Datae"}},Lf={"zh-TW":"訂閱方案","zh-CN":"订阅方案",en:"Subscription Plans",ja:"サブスクリプションプラン",ko:"구독 플랜",th:"แผนการสมัครสมาชิก",vi:"Gói Đăng Ký",ms:"Pelan Langganan",la:"Plana Subscriptionis"};function Of(){const n=$e(),{lang:e,setLang:t}=Qe(),i=$d[e],s=g.useRef(null),o=g.useRef(null),[a,l]=g.useState(0),c=Je(Ti),[u,h]=g.useState(c.currentUser),[p,f]=g.useState(!1),[b,x]=g.useState(!1),[S,w]=g.useState(!1),[I,j]=g.useState(!1),[A,D]=g.useState(!1),[O,P]=g.useState({title:"",message:"",requiredPlan:"basic"}),{isTestMode:B}=ji(),[k,T]=g.useState(!1),[R,E]=g.useState({currentPlan:"basic",remainingDays:0,usedTokens:0,totalTokens:0}),[_,v]=g.useState(()=>typeof window<"u"?window.innerWidth<=768:!1);g.useEffect(()=>{const W=()=>v(window.innerWidth<=768);W(),window.addEventListener("resize",W);const Y=setTimeout(()=>{const X=document.querySelector("footer");X&&(X.style.transition="none",setTimeout(()=>{X.style.transition="top 0.3s ease"},50))},500);return()=>{window.removeEventListener("resize",W),clearTimeout(Y)}},[]);const z=[{key:"echo-box",icon:"🎤",title:{"zh-TW":"心聲釋放","zh-CN":"心声释放",ja:"心の声を解放",en:"Voice Release",ko:"마음의 소리 해방",th:"ปลดปล่อยเสียงในใจ",vi:"Giải Phóng Tiếng Lòng",ms:"Pelepasan Suara Hati",la:"Vox Liberatio"},desc:{"zh-TW":"你可盡情說出心裡對某些人事物的不滿，釋放後或許有解方，天下沒有不能解決的難題","zh-CN":"你可尽情说出心里对某些人事物的不满，释放后或许有解方，天下没有不能解决的难题",ja:"心の中の特定の人や物事への不満を自由に言い、解放後には解決策があるかもしれない、解決できない問題はない",en:"You can freely speak out your dissatisfaction with certain people or things, after release there may be a solution, there is no problem that cannot be solved",ko:"마음속 특정 사람이나 사물에 대한 불만을 자유롭게 말하고, 해방 후에는 해결책이 있을지도 모르며, 해결할 수 없는 문제는 없다",th:"คุณสามารถพูดความไม่พอใจต่อคนหรือสิ่งต่างๆ ได้อย่างอิสระ หลังปลดปล่อยแล้วอาจมีวิธีแก้ไข ไม่มีปัญหาที่แก้ไขไม่ได้",vi:"Bạn có thể tự do nói ra sự bất mãn với những người hoặc sự việc cụ thể, sau khi giải phóng có thể có giải pháp, không có vấn đề nào không thể giải quyết",ms:"Anda boleh bebas mengucapkan ketidakpuasan terhadap orang atau perkara tertentu, selepas melepaskan mungkin ada penyelesaian, tiada masalah yang tidak dapat diselesaikan",la:"Libere dissatisfactionem cum hominibus vel rebus certis profer, post liberationem fortasse solutio est, nulla quaestio insolubilis est"},path:"/echo-box"},{key:"restart-wall",icon:"🧱",title:{"zh-TW":"情緒重啟牆","zh-CN":"情绪重启墙",ja:"感情リスタートウォール",en:"Emotional Restart Wall",ko:"감정 재시작 벽",th:"กำแพงรีสตาร์ทอารมณ์",vi:"Tường Khởi Động Lại Cảm Xúc",ms:"Dinding Restart Emosi",la:"Murus Restart Affectus"},desc:{"zh-TW":"舒暢分享心情，獲得支持與理解","zh-CN":"舒畅分享心情，获得支持与理解",ja:"気持ちを快く共有し、サポートと理解を得る",en:"Share feelings comfortably, get support and understanding",ko:"편안하게 감정을 공유하고 지원과 이해를 받으세요",th:"แบ่งปันความรู้สึกอย่างสบายใจ รับการสนับสนุนและความเข้าใจ",vi:"Chia sẻ cảm xúc thoải mái, nhận được hỗ trợ và thấu hiểu",ms:"Kongsi perasaan dengan selesa, dapatkan sokongan dan pemahaman",la:"Sensus libere partiri, auxilium et intelligentiam accipe"},path:"/wall"},{key:"my-story",icon:"📖",title:{"zh-TW":"我的里程碑","zh-CN":"我的里程碑",ja:"私のマイルストーン",en:"My Milestones",ko:"내 이정표",th:"เหตุการณ์สำคัญของฉัน",vi:"Cột Mốc Của Tôi",ms:"Pencapaian Saya",la:"Mea Milestones"},desc:{"zh-TW":"記錄個人成長里程碑，見證改變歷程","zh-CN":"记录个人成长里程碑，见证改变历程",ja:"個人の成長マイルストーンを記録し、変化の過程を目撃",en:"Record personal growth milestones, witness the journey of change",ko:"개인 성장의 이정표를 기록하고 변화의 여정을 목격하세요",th:"บันทึกเหตุการณ์สำคัญของการเติบโตส่วนบุคคล เป็นพยานในการเดินทางแห่งการเปลี่ยนแปลง",vi:"Ghi lại các cột mốc phát triển cá nhân, chứng kiến hành trình thay đổi",ms:"Rekod pencapaian pertumbuhan peribadi, saksikan perjalanan perubahan",la:"Milestones crescendi personalis inscribe, iter mutationis testare"},path:"/my-story"},{key:"journal",icon:"🌳",title:{"zh-TW":"心情解鎖盒","zh-CN":"心情解锁盒",ja:"気持ちアンロックボックス",en:"Mood Unlock Box",ko:"감정 언락 박스",th:"กล่องปลดล็อกอารมณ์",vi:"Hộp Mở Khóa Cảm Xúc",ms:"Kotak Buka Kunci Emosi",la:"Arca Unlock Affectus"},desc:{"zh-TW":"每天記錄心情，解鎖拼圖碎片，拼出完整的自己！","zh-CN":"每天记录心情，解锁拼图碎片，拼出完整的自己！",ja:"毎日気持ちを記録して、パズルのピースをアンロックし、完全な自分を完成させよう！",en:"Record your mood daily, unlock puzzle pieces, and piece together your complete self!",ko:"매일 기분을 기록하고 퍼즐 조각을 열어 완전한 자신을 완성하세요!",th:"บันทึกอารมณ์ทุกวัน ปลดล็อกชิ้นส่วนจิ๊กซอว์ และต่อภาพตัวเองที่สมบูรณ์!",vi:"Ghi lại tâm trạng mỗi ngày, mở khóa các mảnh ghép, và ghép thành hình ảnh hoàn chỉnh của chính mình!",ms:"Catat perasaan setiap hari, buka kepingan teka-teki, dan lengkapkan diri anda yang sempurna!",la:"Cotidie animum inscribe, fragmenta aenigmatis solve, et te ipsum perfectum compone!"},path:"/journal"},{key:"missions",icon:"🎯",title:{"zh-TW":"挑戰任務","zh-CN":"挑战任务",en:"Challenge Missions",ja:"ミッションに挑戦",ko:"임무 도전",th:"ท้าทายภารกิจ",vi:"Thử thách nhiệm vụ",ms:"Cabaran Misi",la:"Provocatio Missionum"},desc:{"zh-TW":"五站重啟路，讓你更堅強","zh-CN":"五站重启路，让你更坚强",en:"Five-Station Restart Journey, Make You Stronger",ja:"五つのステーション再起動の道、あなたをより強くする",ko:"다섯 단계 재시작 여정, 당신을 더 강하게 만들어요",th:"เส้นทางรีสตาร์ทห้าสถานี ทำให้คุณแข็งแกร่งขึ้น",vi:"Hành trình khởi động lại năm trạm, làm cho bạn mạnh mẽ hơn",ms:"Perjalanan Restart Lima Stesen, Membuat Anda Lebih Kuat",la:"Iter Restart Quinque Stationum, Te Fortiorem Facit"},path:"/restart-missions"},{key:"storywall",icon:"📖",title:{"zh-TW":"我是誰故事鏈","zh-CN":"我是誰故事鏈",ja:"ストーリーウォール",en:"Story Wall",ko:"스토리 월",th:"กำแพงเรื่องราว",vi:"Tường Truyện",ms:"Dinding Cerita",la:"Murus Fabularum"},desc:{"zh-TW":"分享故事，建立連結","zh-CN":"分享故事，建立连接",ja:"ストーリーを共有し、つながりを築く",en:"Share Stories, Build Connections",ko:"이야기를 공유하고 연결을 구축",th:"แบ่งปันเรื่องราว สร้างการเชื่อมต่อ",vi:"Chia sẻ câu chuyện, xây dựng kết nối",ms:"Kongsi cerita, bina hubungan",la:"Fabulas partiri, nexus construere"},path:"/storywall"},{key:"skillbox",icon:"🛠️",title:{"zh-TW":"社會模擬所","zh-CN":"技能方块",ja:"スキルボックス",en:"Skill Box",ko:"스킬 박스",th:"กล่องทักษะ",vi:"Hộp Kỹ Năng",ms:"Kotak Kemahiran",la:"Arca Peritiae"},desc:{"zh-TW":"練習社會互動，解鎖成就","zh-CN":"练习社会互动，解锁成就",en:"Practice social skills, unlock achievements",ja:"社会スキル練習で実績解除",ko:"사회적 기술 연습, 업적 잠금 해제",th:"ฝึกฝนทักษะทางสังคม, ปลดล็อกความสำเร็จ",vi:"Thực hành kỹ năng xã hội, mở khóa thành tích",ms:"Latih kemahiran sosial, buka pencapaian",la:"Practice social skills, unlock achievements"},path:"/skillbox"},{key:"emotionRelease",icon:"🎮",title:{"zh-TW":"情緒發洩區","zh-CN":"情绪发泄区",ja:"感情発散エリア",en:"Emotion Release Zone",ko:"감정 발산 구역",th:"พื้นที่ระบายอารมณ์",vi:"Khu Vực Giải Tỏa Cảm Xúc",ms:"Zon Pelepasan Emosi",la:"Zona Emotio Liberationis"},desc:{"zh-TW":"透過遊戲釋放壓力，找回平靜","zh-CN":"通过游戏释放压力，找回平静",en:"Release stress through games, find peace",ja:"ゲームでストレスを発散し、平静を取り戻す",ko:"게임으로 스트레스를 해소하고 평온을 찾으세요",th:"ปลดปล่อยความเครียดผ่านเกม หาความสงบ",vi:"Giải tỏa căng thẳng qua trò chơi, tìm lại bình yên",ms:"Lepaskan tekanan melalui permainan, temui ketenangan",la:"Libera tensionem per ludos, inveni pacem"},path:"/emotion-release"}];g.useLayoutEffect(()=>{if(s.current&&o.current){const W=s.current.getBoundingClientRect().top,Y=o.current.getBoundingClientRect().top,X=s.current.getBoundingClientRect().height,le=o.current.getBoundingClientRect().height;l(W+X-(Y+le))}},[e]),g.useEffect(()=>{const W=ur(c,Y=>{h(Y),f(!0)});return()=>W()},[c]);const H=g.useRef(null);g.useEffect(()=>{if(!b)return;const W=Y=>{H.current&&!H.current.contains(Y.target)&&x(!1)};return document.addEventListener("mousedown",W),()=>document.removeEventListener("mousedown",W)},[b]);const L=g.useRef(null);g.useEffect(()=>{if(!S)return;const W=Y=>{L.current&&!L.current.contains(Y.target)&&w(!1)};return document.addEventListener("mousedown",W),()=>document.removeEventListener("mousedown",W)},[S]);const ee=W=>{n("/chat")},ge={"zh-TW":"登出","zh-CN":"登出",en:"Logout",ja:"ログアウト",ko:"로그아웃",th:"ออกจากระบบ",vi:"Đăng xuất",ms:"Keluar",la:"Exire"},oe={"zh-TW":"互相幫助&合作實驗室","zh-CN":"互相帮助&合作实验室",en:"Mutual Help & Collaboration Lab",ja:"相互支援＆協力ラボ",ko:"상호도움&협력실험실",th:"ห้องทดลองช่วยเหลือและร่วมมือ",vi:"Phòng thí nghiệm Hỗ trợ & Hợp tác",ms:"Makmal Bantuan & Kerjasama",la:"Laboratorium Auxilii Mutui et Cooperationis"},Re={"zh-TW":{title:"請先註冊/登入才能使用此功能",btn:"前往註冊/登入",close:"關閉"},"zh-CN":{title:"请先注册/登录才能使用此功能",btn:"前往注册/登录",close:"关闭"},en:{title:"Please register/login to use this feature",btn:"Go to Register/Login",close:"Close"},ja:{title:"ご利用には登録/ログインが必要です",btn:"登録/ログインへ",close:"閉じる"},ko:{title:"이 기능을 사용하려면 가입/로그인 해주세요",btn:"가입/로그인으로 이동",close:"닫기"},th:{title:"กรุณาสมัคร/เข้าสู่ระบบก่อนใช้ฟีเจอร์นี้",btn:"ไปที่สมัคร/เข้าสู่ระบบ",close:"ปิด"},vi:{title:"Vui lòng đăng ký/đăng nhập để sử dụng chức năng này",btn:"Đến đăng ký/đăng nhập",close:"Đóng"},ms:{title:"Sila daftar/log masuk untuk menggunakan ciri ini",btn:"Pergi ke Daftar/Log Masuk",close:"Tutup"},la:{title:"Quaeso registra/aperi ut hoc munus utaris",btn:"Ad registra/login",close:"Claude"}}[e],te=async(W,Y)=>{if(!u){j(!0);return}if(B){W();return}if(Y)try{const X=await fetch("/api/subscription/check-permission",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:u.uid,feature:Y})});if(!X.ok)throw new Error("權限檢查失敗");const le=await X.json();if(!le.allowed){le.canRenew?(E({currentPlan:le.currentPlan,remainingDays:le.remainingDays,usedTokens:le.usedTokens,totalTokens:le.totalTokens}),T(!0)):(P({title:"功能需要升級",message:le.reason||"此功能需要升級訂閱才能使用",requiredPlan:le.requiredPlan||"basic"}),D(!0));return}}catch(X){console.error("權限檢查錯誤:",X)}W()};return p?r.jsxs("div",{style:{position:"relative",minHeight:"100vh"},children:[_?r.jsxs("div",{style:{position:"fixed",top:0,left:0,right:0,zIndex:100,background:"rgba(255,255,255,0.95)",padding:"8px 16px",display:"flex",justifyContent:"space-between",alignItems:"center",boxShadow:"0 2px 8px #0001"},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[r.jsx("img",{src:"/ctx-logo.png",alt:"logo",style:{width:72,height:72,cursor:"pointer"},onClick:()=>n("/")}),r.jsx("span",{style:{fontSize:14,fontWeight:700,color:"#6B5BFF"},children:"Restarter™"})]}),r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[u?r.jsxs(r.Fragment,{children:[r.jsx("img",{src:u.photoURL||"/ctx-logo.png",alt:"avatar",style:{width:28,height:28,borderRadius:"50%",objectFit:"cover",border:"2px solid #6B5BFF"}}),r.jsx("span",{style:{color:"#6B5BFF",fontWeight:600,fontSize:12,maxWidth:60,overflow:"hidden",textOverflow:"ellipsis"},children:u.displayName||u.email||"用戶"}),r.jsx("button",{className:"topbar-btn",onClick:async()=>{await hn(c)},style:{width:"80px",fontSize:14,padding:"6px 10px",height:"28px",borderRadius:4,fontWeight:600,border:"1px solid #ff6347",color:"#ff6347",background:"#fff",cursor:"pointer",transition:"background 0.18s, color 0.18s, border 0.18s"},children:ge[e]})]}):r.jsx("button",{className:"topbar-btn",onClick:()=>n("/register"),style:{background:"#fff",color:"#1976d2",border:"1px solid #1976d2",borderRadius:6,fontWeight:600,fontSize:12,padding:"4px 8px"},children:e==="zh-TW"?"註冊":e==="zh-CN"?"注册":e==="en"?"Register":e==="ja"?"登録":e==="ko"?"가입":e==="th"?"สมัคร":e==="vi"?"Đăng ký":e==="ms"?"Daftar":"Registrare"}),r.jsx(en,{style:{width:"80px",fontSize:14,padding:"6px 10px",height:"28px"}})]})]}):r.jsxs("div",{style:{position:"fixed",top:8,right:36,zIndex:9999,display:"flex",flexDirection:"row",alignItems:"center",gap:18,pointerEvents:"auto",width:"100%",justifyContent:"flex-end"},children:[r.jsxs("div",{style:{display:"flex",flexDirection:"row",gap:18,marginRight:24},children:[r.jsx("button",{className:"topbar-btn",onClick:()=>n("/about"),style:{background:"#fff",color:"#6B5BFF",border:"2px solid #6B5BFF",borderRadius:6,fontWeight:700,fontSize:12,padding:"4px 8px",minWidth:80},"aria-label":e==="zh-TW"||e==="zh-CN"?"了解 Restarter 平台":e==="en"?"Learn about Restarter platform":e==="ja"?"Restarter プラットフォームについて":e==="ko"?"Restarter 플랫폼에 대해 알아보기":e==="th"?"เรียนรู้เกี่ยวกับแพลตฟอร์ม Restarter":e==="vi"?"Tìm hiểu về nền tảng Restarter":e==="ms"?"Ketahui tentang platform Restarter":"Cognosce de suggestum Restarter",role:"button",children:e==="zh-TW"?"🧬 Restarter™｜我們是誰":e==="zh-CN"?"🧬 Restarter™｜我们是谁":e==="en"?"🧬 Restarter™｜Who We Are":e==="ja"?"🧬 Restarter™｜私たちについて":e==="ko"?"🧬 Restarter™｜우리는 누구인가":e==="th"?"🧬 Restarter™｜เราเป็นใคร":e==="vi"?"🧬 Restarter™｜Chúng tôi là ai":e==="ms"?"🧬 Restarter™｜Siapa Kami":"🧬 Restarter™｜Quis sumus"}),r.jsx("button",{className:"topbar-btn",onClick:()=>n("/feedback"),style:{background:"#fff",color:"#6B5BFF",border:"2px solid #6B5BFF",borderRadius:6,fontWeight:700,fontSize:12,padding:"4px 8px",minWidth:100},"aria-label":e==="zh-TW"?"提供意見和建議":e==="zh-CN"?"提供意见和建议":e==="en"?"Provide feedback and suggestions":e==="ja"?"ご意見やご提案を提供":e==="ko"?"의견과 제안 제공":e==="th"?"ให้ข้อเสนอแนะและคำแนะนำ":e==="vi"?"Cung cấp phản hồiและ đề xuất":e==="ms"?"Berikan maklum balas dan cadangan":"Praebe consilia et suggestiones",role:"button",children:e==="zh-TW"?"💬 意見箱｜我們想聽你說":e==="zh-CN"?"💬 意见箱｜我们想听你说":e==="en"?"💬 Feedback｜We Want to Hear You":e==="ja"?"💬 ご意見箱｜あなたの声を聞かせて":e==="ko"?"💬 피드백｜여러분의 의견을 듣고 싶어요":e==="th"?"💬 กล่องความคิดเห็น｜เราอยากฟังคุณ":e==="vi"?"💬 Hộp góp ý｜Chúng tôi muốn lắng nghe bạn":e==="ms"?"💬 Kotak Maklum Balas｜Kami ingin mendengar anda":"💬 Arca Consilii｜Te audire volumus"}),u?r.jsx(r.Fragment,{children:r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[r.jsx("img",{src:u.photoURL||"/ctx-logo.png",alt:"avatar",style:{width:36,height:36,borderRadius:"50%",objectFit:"cover",border:"2px solid #90caf9"}}),r.jsx("span",{style:{color:"#1976d2",fontWeight:700,fontSize:16},children:u.displayName||u.email||"用戶"}),r.jsx("button",{className:"topbar-btn",onClick:async()=>{await hn(c)},style:{background:"#fff",color:"#ff6347",border:"2px solid #ffb4a2",borderRadius:8,fontWeight:700,fontSize:16,padding:"8px 14px",marginLeft:6},children:ge[e]})]})}):r.jsx("button",{className:"topbar-btn",onClick:()=>n("/register"),style:{background:"#fff",color:"#1976d2",border:"2px solid #90caf9",borderRadius:8,fontWeight:700,fontSize:16,padding:"8px 10px",minWidth:90},children:e==="zh-TW"?"註冊/登入":e==="zh-CN"?"注册/登录":e==="en"?"Register / Login":e==="ja"?"登録/ログイン":e==="ko"?"가입/로그인":e==="th"?"สมัคร/เข้าสู่ระบบ":e==="vi"?"Đăng ký/Đăng nhập":e==="ms"?"Daftar / Log Masuk":"Registrare / Login"})]}),r.jsxs("div",{style:{position:"relative",display:"inline-block"},ref:H,children:[r.jsxs("button",{className:"topbar-btn",style:{background:"#6B5BFF",color:"#fff",border:"2px solid #6B5BFF",borderRadius:8,fontWeight:700,fontSize:16,padding:"8px 10px",minWidth:90,maxWidth:120,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},onClick:()=>x(W=>!W),children:[e==="zh-TW"?"繁中":e==="zh-CN"?"简中":e==="en"?"English":e==="ja"?"日本語":e==="ko"?"한국어":e==="th"?"ไทย":e==="vi"?"Tiếng Việt":e==="ms"?"Bahasa Melayu":"Latin",r.jsx("span",{style:{marginLeft:6},children:"▼"})]}),b&&r.jsx("div",{style:{position:"absolute",right:0,top:"110%",background:"#fff",border:"1.5px solid #6B5BFF",borderRadius:8,boxShadow:"0 4px 16px #0002",zIndex:9999,minWidth:120},children:["zh-TW","zh-CN","en","ja","ko","th","vi","ms","la"].map(W=>r.jsx("div",{style:{padding:"10px 18px",cursor:"pointer",color:W===e?"#6B5BFF":"#232946",fontWeight:W===e?700:500,background:W===e?"#f3f0ff":"#fff"},onClick:()=>{t(W),x(!1)},children:W==="zh-TW"?"繁中":W==="zh-CN"?"简中":W==="en"?"English":W==="ja"?"日本語":W==="ko"?"한국어":W==="th"?"ไทย":W==="vi"?"Tiếng Việt":W==="ms"?"Bahasa Melayu":"Latin"},W))})]}),r.jsxs("div",{style:{position:"relative",display:"inline-block"},ref:L,children:[r.jsx("button",{className:"topbar-btn",style:{background:"#fff",color:"#6B5BFF",border:"2px solid #6B5BFF",borderRadius:8,fontWeight:700,fontSize:16,padding:"8px 12px",minWidth:50,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.3s ease"},onClick:()=>w(W=>!W),onMouseOver:W=>{W.currentTarget.style.background="#6B5BFF",W.currentTarget.style.color="#fff"},onMouseOut:W=>{W.currentTarget.style.background="#fff",W.currentTarget.style.color="#6B5BFF"},children:r.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"2px"},children:[r.jsx("div",{style:{width:"16px",height:"2px",background:"currentColor",borderRadius:"1px"}}),r.jsx("div",{style:{width:"16px",height:"2px",background:"currentColor",borderRadius:"1px"}}),r.jsx("div",{style:{width:"16px",height:"2px",background:"currentColor",borderRadius:"1px"}})]})}),S&&r.jsxs("div",{style:{position:"absolute",right:0,top:"110%",background:"#fff",border:"1.5px solid #6B5BFF",borderRadius:8,boxShadow:"0 4px 16px #0002",zIndex:9999,minWidth:200,maxWidth:250,padding:"8px 0"},children:[r.jsx("div",{style:{padding:"8px 16px",borderBottom:"1px solid #eee",marginBottom:"4px"},children:r.jsx("span",{style:{fontSize:"14px",fontWeight:700,color:"#6B5BFF"},children:e==="zh-TW"||e==="zh-CN"?"法律文件":e==="en"?"Legal Documents":e==="ja"?"法的文書":e==="ko"?"법적 문서":e==="th"?"เอกสารทางกฎหมาย":e==="vi"?"Tài liệu pháp lý":e==="ms"?"Dokumen Undang-undang":"Documenta Iuridica"})}),[{key:"privacy",title:Gd,titleKey:"privacy",path:"/privacy-policy"},{key:"terms",title:Gd,titleKey:"terms",path:"/terms"},{key:"data",title:Gd,titleKey:"deletion",path:"/data-deletion"},{key:"ai",title:{"zh-TW":"AI使用聲明","zh-CN":"AI使用声明",en:"AI Usage Statement",ja:"AI利用声明",ko:"AI 사용 성명",th:"คำแถลงการใช้ AI",vi:"Tuyên bố sử dụng AI",ms:"Penyata Penggunaan AI",la:"Declaratio Usus AI"},path:"/ai-statement"},{key:"mental",title:{"zh-TW":"心理健康免責聲明","zh-CN":"心理健康免责声明",en:"Mental Health Disclaimer",ja:"メンタルヘルス免責事項",ko:"정신건강 면책조항",th:"ข้อจำกัดความรับผิดชอบด้านสุขภาพจิต",vi:"Tuyên bố miễn trừ sức khỏe tâm thần",ms:"Penafian Kesihatan Mental",la:"Renuntiatio Salutis Mentalis"},path:"/mental-health-disclaimer"},{key:"cookie",title:{"zh-TW":"Cookie政策","zh-CN":"Cookie政策",en:"Cookie Policy",ja:"Cookieポリシー",ko:"쿠키 정책",th:"นโยบายคุกกี้",vi:"Chính sách Cookie",ms:"Dasar Cookie",la:"Politica Cookie"},path:"/cookie-policy"},{key:"children",title:{"zh-TW":"兒童隱私保護","zh-CN":"儿童隐私保护",en:"Children's Privacy",ja:"児童プライバシー保護",ko:"아동 개인정보 보호",th:"การคุ้มครองความเป็นส่วนตัวของเด็ก",vi:"Bảo vệ quyền riêng tư trẻ em",ms:"Privasi Kanak-kanak",la:"Privata Puerorum"},path:"/children-privacy"},{key:"international",title:{"zh-TW":"國際用戶聲明","zh-CN":"国际用户声明",en:"International Users",ja:"国際ユーザー声明",ko:"국제 사용자 성명",th:"คำแถลงสำหรับผู้ใช้ระหว่างประเทศ",vi:"Tuyên bố người dùng quốc tế",ms:"Penyata Pengguna Antarabangsa",la:"Declaratio Usuarii Internationalis"},path:"/international-users"},{key:"security",title:{"zh-TW":"安全聲明","zh-CN":"安全声明",en:"Security Statement",ja:"セキュリティ声明",ko:"보안 성명",th:"คำแถลงความปลอดภัย",vi:"Tuyên bố bảo mật",ms:"Penyata Keselamatan",la:"Declaratio Securitatis"},path:"/security-statement"},{key:"update",title:{"zh-TW":"更新通知機制","zh-CN":"更新通知机制",en:"Update Notification",ja:"更新通知メカニズム",ko:"업데이트 알림 메커니즘",th:"กลไกการแจ้งเตือนการอัปเดต",vi:"Cơ chế thông báo cập nhật",ms:"Mekanisme Pemberitahuan Kemas Kini",la:"Mechanismus Notificationis Renovationis"},path:"/update-notification"}].map(W=>{var Y;return r.jsx("div",{style:{padding:"10px 16px",cursor:"pointer",color:"#232946",fontWeight:500,background:"#fff",fontSize:"13px",borderBottom:"1px solid #f0f0f0",transition:"all 0.2s ease"},onClick:()=>{n(W.path),w(!1)},onMouseOver:X=>{X.currentTarget.style.background="#f3f0ff",X.currentTarget.style.color="#6B5BFF"},onMouseOut:X=>{X.currentTarget.style.background="#fff",X.currentTarget.style.color="#232946"},children:W.titleKey?((Y=W.title[e])==null?void 0:Y[W.titleKey])||W.title["zh-TW"][W.titleKey]:W.title[e]||W.title["zh-TW"]},W.key)})]})]})]}),_?r.jsxs("div",{style:{width:"100vw",minHeight:"100vh",background:"url('/plains.png') center center/cover no-repeat",display:"flex",flexDirection:"column",alignItems:"center",paddingTop:100},children:[r.jsx("div",{style:{width:"100%",padding:"0 16px",marginBottom:16},children:r.jsx(Mf,{})}),r.jsxs("div",{style:{width:"100%",padding:"20px 16px",textAlign:"center"},children:[r.jsx("div",{style:{marginBottom:16},children:r.jsx("span",{style:{fontWeight:900,color:"#232946",fontSize:16,lineHeight:1.2,letterSpacing:.3,textShadow:"1px 2px 8px #fff",whiteSpace:"nowrap"},children:e==="zh-TW"?"找回信任的起點，重新出發不孤單！":e==="zh-CN"?"找回信任的起点，重新出发不孤单！":e==="en"?"Regain trust and start anew, you are never alone!":e==="ja"?"信頼を取り戻し、新たな一歩を踏み出そう！":e==="ko"?"신뢰를 되찾고, 새롭게 시작하세요. 당신은 결코 혼자가 아닙니다!":e==="th"?"เริ่มต้นใหม่ด้วยความไว้วางใจ คุณไม่ได้อยู่คนเดียว!":e==="vi"?"Tìm lại niềm tin, bắt đầu lại, bạn không bao giờ đơn độc!":e==="ms"?"Temui semula kepercayaan, mulakan semula, anda tidak pernah keseorangan!":"Fidem recupera et iterum incipe, numquam solus es!"})}),r.jsxs("h1",{style:{fontSize:24,fontWeight:900,color:"#fff",marginBottom:12,textShadow:"0 2px 8px #232946"},children:[r.jsx("span",{style:{color:"#6B5BFF"},children:"Restarter™"})," Global Platform"]}),r.jsx("div",{style:{marginBottom:10},children:r.jsx("span",{style:{color:"#232946",fontWeight:500,fontSize:14,lineHeight:1.4,whiteSpace:"pre-line"},children:$d[e].desc})})]}),r.jsx("div",{style:{width:"100%",padding:"0 16px",marginBottom:16,display:"flex",justifyContent:"center"},children:r.jsx("img",{src:"/herogirl.png",style:{width:"100%",maxWidth:300,height:"auto",objectFit:"contain",borderRadius:"16px",boxShadow:"0 4px 16px rgba(0,0,0,0.1)"}})}),r.jsxs("div",{style:{width:"100%",padding:"0 16px",marginBottom:"16px",position:"relative"},children:[r.jsxs("button",{onClick:()=>te(()=>n("/social-integration")),style:{background:"linear-gradient(135deg, #6B5BFF 0%, #5A4FCF 100%)",border:"none",borderRadius:"16px",padding:"12px 24px",color:"white",cursor:"pointer",fontSize:"16px",fontWeight:"600",boxShadow:"0 4px 16px rgba(107, 91, 255, 0.3)",transition:"all 0.3s ease",display:"flex",alignItems:"center",gap:"8px",width:"100%",justifyContent:"center",position:"relative"},onMouseOver:W=>{W.currentTarget.style.transform="translateY(-2px)",W.currentTarget.style.boxShadow="0 6px 20px rgba(107, 91, 255, 0.4)";const Y=W.currentTarget.nextElementSibling;Y&&(Y.style.opacity="1")},onMouseOut:W=>{W.currentTarget.style.transform="translateY(0)",W.currentTarget.style.boxShadow="0 4px 16px rgba(107, 91, 255, 0.3)";const Y=W.currentTarget.nextElementSibling;Y&&(Y.style.opacity="0")},children:[r.jsx("span",{style:{fontSize:"18px"},children:"📊"}),e==="zh-TW"?"社會融入度評估":e==="zh-CN"?"社会融入度评估":e==="ja"?"社会統合度評価":e==="en"?"Social Integration Assessment":e==="ko"?"사회 통합도 평가":e==="th"?"การประเมินการผสมผสานทางสังคม":e==="vi"?"Đánh Giá Hòa Nhập Xã Hội":e==="ms"?"Penilaian Integrasi Sosial":"Aestimatio Integrationis Socialis"]}),r.jsx("div",{style:{position:"absolute",bottom:"100%",left:"50%",transform:"translateX(-50%)",background:"#232946",color:"white",padding:"6px 10px",borderRadius:"6px",fontSize:"10px",fontWeight:"500",textAlign:"center",whiteSpace:"nowrap",opacity:"0",transition:"opacity 0.3s ease",zIndex:1e3,pointerEvents:"none",maxWidth:"200px",marginBottom:"8px"},children:e==="zh-TW"?"評估個人社會融入度，獲得專業建議和改善方向":e==="zh-CN"?"评估个人社会融入度，获得专业建议和改善方向":e==="ja"?"個人の社会統合度を評価し、専門的なアドバイスと改善方向を獲得":e==="en"?"Assess personal social integration, get professional advice and improvement direction":e==="ko"?"개인 사회 통합도를 평가하고 전문적인 조언과 개선 방향을 얻으세요":e==="th"?"ประเมินการผสมผสานทางสังคมส่วนบุคคล รับคำแนะนำจากผู้เชี่ยวชาญและทิศทางการปรับปรุง":e==="vi"?"Đánh giá mức độ hòa nhập xã hội cá nhân, nhận lời khuyên chuyên môn và hướng cải thiện":e==="ms"?"Nilai integrasi sosial peribadi, dapatkan nasihat profesional dan arah penambahbaikan":"Aestima integrationem socialem personalem, consilium professionalem et directionem meliorationis accipe"})]}),r.jsxs("div",{style:{width:"100%",padding:"0 16px",display:"flex",flexDirection:"column",gap:12},children:[r.jsxs("div",{style:{display:"flex",flexDirection:"row",gap:8,flexWrap:"wrap"},children:[r.jsxs("button",{className:"feature-btn",style:{flex:1,minWidth:"calc(50% - 4px)",padding:"16px 8px",borderRadius:12,border:"2px solid #6B5BFF",background:"#fff",color:"#6B5BFF",fontWeight:700,fontSize:14,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:4},onClick:()=>te(()=>n("/friend")),children:[r.jsx("span",{style:{fontSize:20},children:Wf[e]}),r.jsx("span",{style:{fontSize:12,textAlign:"center"},children:i.friend})]}),r.jsxs("button",{className:"feature-btn",style:{flex:1,minWidth:"calc(50% - 4px)",padding:"16px 8px",borderRadius:12,border:"2px solid #6B5BFF",background:"#fff",color:"#6B5BFF",fontWeight:700,fontSize:14,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:4},onClick:()=>te(()=>ee(),"aiChat"),children:[r.jsx("span",{style:{fontSize:20},children:"💬"}),r.jsx("span",{style:{fontSize:12,textAlign:"center"},children:i.chat})]})]}),r.jsx("div",{style:{display:"flex",flexDirection:"row",gap:8,flexWrap:"wrap"},children:z.slice(0,2).map(W=>r.jsxs("button",{className:"feature-btn",style:{flex:1,minWidth:"calc(50% - 4px)",padding:"16px 8px",borderRadius:12,border:"2px solid #6B5BFF",background:"#fff",color:"#6B5BFF",fontWeight:700,fontSize:14,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:4},onClick:()=>te(()=>n(W.path)),children:[r.jsx("span",{style:{fontSize:20},children:W.icon}),r.jsx("span",{style:{fontSize:12,textAlign:"center"},children:W.title[e]})]},W.key))}),r.jsx("div",{style:{display:"flex",flexDirection:"row",gap:8,flexWrap:"wrap"},children:z.slice(2,4).map(W=>r.jsxs("button",{className:"feature-btn",style:{flex:1,minWidth:"calc(50% - 4px)",padding:"16px 8px",borderRadius:12,border:"2px solid #6B5BFF",background:"#fff",color:"#6B5BFF",fontWeight:700,fontSize:14,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:4},onClick:()=>te(()=>n(W.path)),children:[r.jsx("span",{style:{fontSize:20},children:W.icon}),r.jsx("span",{style:{fontSize:12,textAlign:"center"},children:W.title[e]})]},W.key))}),r.jsxs("div",{style:{display:"flex",flexDirection:"row",gap:8,flexWrap:"wrap"},children:[z.slice(4).map(W=>r.jsxs("button",{className:"feature-btn",style:{flex:1,minWidth:"calc(50% - 4px)",padding:"16px 8px",borderRadius:12,border:"2px solid #6B5BFF",background:"#fff",color:"#6B5BFF",fontWeight:700,fontSize:14,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:4},onClick:()=>te(()=>n(W.path)),children:[r.jsx("span",{style:{fontSize:20},children:W.icon}),r.jsx("span",{style:{fontSize:12,textAlign:"center"},children:W.title[e]})]},W.key)),r.jsxs("button",{className:"feature-btn",style:{flex:1,minWidth:"calc(50% - 4px)",padding:"16px 8px",borderRadius:12,background:"linear-gradient(90deg, #ffe0b2 0%, #ffb74d 100%)",color:"#b85c00",border:"2px solid #ffb74d",fontWeight:900,fontSize:14,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:4},onClick:()=>te(()=>n("/HelpLab")),children:[r.jsx("span",{style:{fontSize:20},children:"🧪"}),r.jsx("span",{style:{fontSize:12,textAlign:"center"},children:oe[e]})]})]})]}),r.jsx("div",{style:{width:"100%",padding:"20px 16px",display:"flex",flexDirection:"column",gap:12,boxSizing:"border-box"},children:r.jsx("span",{href:"/plans",style:{width:"100%",padding:"12px",borderRadius:10,background:"#6B5BFF",color:"#fff",fontWeight:700,fontSize:14,textDecoration:"none",border:"2px solid #6B5BFF",cursor:"pointer",textAlign:"center",display:"block",boxSizing:"border-box"},children:Lf[e]})})]}):r.jsxs("div",{style:{width:"100vw",minHeight:"160vh",background:"url('/plains.png') center center/cover no-repeat",display:"flex",flexDirection:"row",alignItems:"flex-start",justifyContent:"center"},children:[r.jsxs("div",{className:"home-left-col left-relative",style:{flex:1,minWidth:320,maxWidth:600,display:"flex",flexDirection:"column",alignItems:"flex-start",justifyContent:"flex-start",padding:"120px 0 0 0",zIndex:2},children:[r.jsx("div",{className:"fixed-logo-box",style:{position:"fixed",top:16,left:42,display:"flex",flexDirection:"row",alignItems:"center",gap:12,zIndex:1e4,paddingTop:0,marginTop:0},children:r.jsx("img",{src:"/ctx-logo.png",className:"fixed-logo-img",style:{marginBottom:0,width:182,height:182,cursor:"pointer",marginTop:"-40px"},onClick:()=>n("/")})}),r.jsxs("div",{className:"column-content",style:{justifyContent:"center",alignItems:"center",height:"100%",paddingTop:e==="vi"?"200px":e==="ms"?"220px":e==="la"?"240px":e==="en"?"180px":"80px"},children:[r.jsx("div",{style:{width:"100%",maxWidth:900,margin:"0 auto 16px auto",textAlign:"center",wordBreak:"break-word",whiteSpace:"normal",marginLeft:"0px"},children:r.jsx("span",{style:{fontWeight:900,color:"#232946",fontSize:20,lineHeight:1.2,letterSpacing:.5,textShadow:"2px 4px 12px #fff, 0 2px 8px #23294688",display:"inline-block",whiteSpace:"nowrap"},children:e==="zh-TW"?"找回信任的起點，重新出發不孤單！":e==="zh-CN"?"找回信任的起点，重新出发不孤单！":e==="en"?"Regain trust and start anew, you are never alone!":e==="ja"?"信頼を取り戻し、新たな一歩を踏み出そう！":e==="ko"?"신뢰를 되찾고, 새롭게 시작하세요. 당신은 결코 혼자가 아닙니다!":e==="th"?"เริ่มต้นใหม่ด้วยความไว้วางใจ คุณไม่ได้อยู่คนเดียว!":e==="vi"?"Tìm lại niềm tin, bắt đầu lại, bạn không bao giờ đơn độc!":e==="ms"?"Temui semula kepercayaan, mulakan semula, anda tidak pernah keseorangan!":"Fidem recupera et iterum incipe, numquam solus es!"})}),r.jsxs("h1",{className:"main-title",style:{position:"relative",left:"0px",fontSize:36,fontWeight:900,color:"#fff",marginBottom:18,textShadow:"0 2px 12px #232946, 0 4px 24px #0008"},children:[r.jsx("span",{style:{color:"#6B5BFF"},children:"Restarter™"})," Global Platform"]}),r.jsx("div",{style:{width:"100%",textAlign:"center",margin:"0 auto",marginBottom:16,marginTop:"0px"},children:r.jsx("span",{style:{color:"#232946",fontWeight:500,fontSize:16,lineHeight:1.5,letterSpacing:.5,whiteSpace:"pre-line"},children:$d[e].desc})}),r.jsxs("div",{style:{display:"flex",justifyContent:"center",marginBottom:"24px",position:"relative"},children:[r.jsxs("button",{onClick:()=>te(()=>n("/social-integration")),style:{background:"linear-gradient(135deg, #6B5BFF 0%, #5A4FCF 100%)",border:"none",borderRadius:"16px",padding:"16px 32px",color:"white",cursor:"pointer",fontSize:"18px",fontWeight:"600",boxShadow:"0 4px 16px rgba(107, 91, 255, 0.3)",transition:"all 0.3s ease",display:"flex",alignItems:"center",gap:"12px",position:"relative"},onMouseOver:W=>{W.currentTarget.style.transform="translateY(-2px)",W.currentTarget.style.boxShadow="0 6px 20px rgba(107, 91, 255, 0.4)";const Y=W.currentTarget.nextElementSibling;Y&&(Y.style.opacity="1")},onMouseOut:W=>{W.currentTarget.style.transform="translateY(0)",W.currentTarget.style.boxShadow="0 4px 16px rgba(107, 91, 255, 0.3)";const Y=W.currentTarget.nextElementSibling;Y&&(Y.style.opacity="0")},children:[r.jsx("span",{style:{fontSize:"24px"},children:"📊"}),e==="zh-TW"?"社會融入度評估":e==="zh-CN"?"社会融入度评估":e==="ja"?"社会統合度評価":e==="en"?"Social Integration Assessment":e==="ko"?"사회 통합도 평가":e==="th"?"การประเมินการผสมผสานทางสังคม":e==="vi"?"Đánh Giá Hòa Nhập Xã Hội":e==="ms"?"Penilaian Integrasi Sosial":"Aestimatio Integrationis Socialis"]}),r.jsx("div",{style:{position:"absolute",top:"-50px",left:"50%",transform:"translateX(-50%)",background:"#232946",color:"white",padding:"8px 12px",borderRadius:"8px",fontSize:"12px",fontWeight:"500",textAlign:"center",whiteSpace:"nowrap",opacity:"0",transition:"opacity 0.3s ease",zIndex:1e3,pointerEvents:"none"},children:e==="zh-TW"?"評估個人社會融入度，獲得專業建議和改善方向":e==="zh-CN"?"评估个人社会融入度，获得专业建议和改善方向":e==="ja"?"個人の社会統合度を評価し、専門的なアドバイスと改善方向を獲得":e==="en"?"Assess personal social integration, get professional advice and improvement direction":e==="ko"?"개인 사회 통합도를 평가하고 전문적인 조언과 개선 방향을 얻으세요":e==="th"?"ประเมินการผสมผสานทางสังคมส่วนบุคคล รับคำแนะนำจากผู้เชี่ยวชาญและทิศทางการปรับปรุง":e==="vi"?"Đánh giá mức độ hòa nhập xã hội cá nhân, nhận lời khuyên chuyên môn và hướng cải thiện":e==="ms"?"Nilai integrasi sosial peribadi, dapatkan nasihat profesional dan arah penambahbaikan":"Aestima integrationem socialem personalem, consilium professionalem et directionem meliorationis accipe"})]}),r.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:18,marginBottom:60,justifyContent:"center",width:"100%"},children:[r.jsxs("div",{style:{display:"flex",flexDirection:"row",gap:18,justifyContent:"center"},children:[r.jsxs("button",{className:"feature-btn",style:{fontSize:18,padding:"16px 16px",minWidth:160,minHeight:80,display:"flex",flexDirection:"column",alignItems:"center",gap:8,justifyContent:"center",background:"#fff",color:"#6B5BFF",border:"2px solid #6B5BFF"},onClick:()=>te(()=>n("/friend"),"userInteraction"),"aria-label":e==="zh-TW"?"進入交友區，尋找新朋友，建立支持圈":e==="zh-CN"?"进入交友区，寻找新朋友，建立支持圈":e==="en"?"Enter friend matching area to find new friends and build support circle":e==="ja"?"友達マッチングエリアに入って新しい友達を見つけ、サポートサークルを築く":e==="ko"?"친구 매칭 영역으로 이동하여 새로운 친구를 찾고 지원 서클을 구축":e==="th"?"เข้าสู่พื้นที่จับคู่เพื่อนเพื่อหาเพื่อนใหม่และสร้างวงกลมสนับสนุน":e==="vi"?"Vào khu vực ghép bạn bè để tìm bạn mới và xây dựng vòng tròn hỗ trợ":e==="ms"?"Masuk ke kawasan padanan rakan untuk mencari rakan baru dan membina bulatan sokongan":"Intra in area par amicus ad inveniendos novos amicos et construendam circulum auxilii",role:"button",children:[r.jsx("span",{style:{fontSize:32},children:Wf[e]}),r.jsx("span",{style:{fontWeight:700,textAlign:"center",lineHeight:1.2},children:i.friend})]}),z.slice(0,2).map(W=>r.jsxs("button",{className:"feature-btn",style:{fontSize:18,padding:"16px 16px",minWidth:160,minHeight:80,display:"flex",flexDirection:"column",alignItems:"center",gap:8,justifyContent:"center",background:"#fff",color:"#6B5BFF",border:"2px solid #6B5BFF"},onClick:()=>te(()=>n(W.path)),"aria-label":W.desc[e],role:"button",children:[r.jsx("span",{style:{fontSize:32,transform:W.icon==="🎤"?"translateY(8px)":"none"},children:W.icon}),r.jsx("span",{style:{fontWeight:700,textAlign:"center",lineHeight:1.2},children:W.title[e]})]},W.key))]}),r.jsx("div",{style:{display:"flex",flexDirection:"row",gap:18,justifyContent:"center"},children:z.slice(2,5).map(W=>r.jsxs("button",{className:"feature-btn",style:{fontSize:18,padding:"16px 16px",minWidth:160,minHeight:80,display:"flex",flexDirection:"column",alignItems:"center",gap:8,justifyContent:"center",background:"#fff",color:"#6B5BFF",border:"2px solid #6B5BFF"},onClick:()=>te(()=>n(W.path)),"aria-label":W.desc[e],role:"button",children:[r.jsx("span",{style:{fontSize:32},children:W.icon}),r.jsx("span",{style:{fontWeight:700,textAlign:"center",lineHeight:1.2},children:W.title[e]})]},W.key))}),r.jsxs("div",{style:{display:"flex",flexDirection:"row",gap:18,justifyContent:"center",marginTop:10},children:[r.jsxs("button",{className:"feature-btn",style:{fontSize:18,padding:"16px 16px",minWidth:160,minHeight:80,display:"flex",flexDirection:"column",alignItems:"center",gap:8,justifyContent:"center",background:"#fff",color:"#6B5BFF",border:"2px solid #6B5BFF"},onClick:()=>te(()=>n("/storywall")),"aria-label":e==="zh-TW"?"分享故事，建立連結":e==="zh-CN"?"分享故事，建立连接":e==="en"?"Share Stories, Build Connections":e==="ja"?"ストーリーを共有し、つながりを築く":e==="ko"?"이야기를 공유하고 연결을 구축":e==="th"?"แบ่งปันเรื่องราว สร้างการเชื่อมต่อ":e==="vi"?"Chia sẻ câu chuyện, xây dựng kết nối":e==="ms"?"Kongsi cerita, bina hubungan":"Fabulas partiri, nexus construere",role:"button",children:[r.jsx("span",{style:{fontSize:32},children:"📖"}),r.jsx("span",{style:{fontWeight:700,textAlign:"center",lineHeight:1.2},children:e==="zh-TW"||e==="zh-CN"?"我是誰故事鏈":e==="ja"?"ストーリーウォール":e==="en"?"Story Wall":e==="ko"?"스토리 월":e==="th"?"กำแพงเรื่องราว":e==="vi"?"Tường Truyện":e==="ms"?"Dinding Cerita":"Murus Fabularum"})]}),r.jsxs("button",{className:"feature-btn mutual-help-btn",style:{fontSize:18,padding:"16px 16px",minWidth:180,maxWidth:240,minHeight:80,display:"flex",flexDirection:"column",alignItems:"center",gap:8,justifyContent:"center",background:"linear-gradient(90deg, #ffe0b2 0%, #ffb74d 100%)",color:"#b85c00",border:"2px solid #ffb74d",fontWeight:900,boxShadow:"0 2px 12px #ffb74d55"},onClick:()=>te(()=>n("/HelpLab")),"aria-label":e==="zh-TW"?"提供與獲得幫助，一樣重要":e==="zh-CN"?"提供与获得帮助，一样重要":e==="en"?"Providing and receiving help are equally important":e==="ja"?"助けを提供することと受けることは同じように重要":e==="ko"?"도움을 제공하고 받는 것은 똑같이 중요합니다":e==="th"?"การให้และรับความช่วยเหลือมีความสำคัญเท่ากัน":e==="vi"?"Cung cấp và nhận sự giúp đỡ đều quan trọng như nhau":e==="ms"?"Memberi dan menerima bantuan sama penting":"Auxilium praebere et accipere aequo modo magni momenti sunt",role:"button",children:[r.jsx("span",{style:{fontSize:32},children:"🧪"}),r.jsx("span",{style:{fontWeight:900,color:"#1976d2",textAlign:"center",lineHeight:1.2},children:oe[e]})]}),r.jsxs("button",{className:"feature-btn",style:{fontSize:18,padding:"16px 16px",minWidth:160,minHeight:80,display:"flex",flexDirection:"column",alignItems:"center",gap:8,justifyContent:"center",background:"#fff",color:"#6B5BFF",border:"2px solid #6B5BFF"},onClick:()=>te(()=>n("/emotion-release")),"aria-label":e==="zh-TW"?"透過遊戲釋放壓力，找回平靜":e==="zh-CN"?"通过游戏释放压力，找回平静":e==="en"?"Release stress through games, find peace":e==="ja"?"ゲームでストレスを発散し、平静を取り戻す":e==="ko"?"게임으로 스트레스를 해소하고 평온을 찾으세요":e==="th"?"ปลดปล่อยความเครียดผ่านเกม หาความสงบ":e==="vi"?"Giải tỏa căng thẳng qua trò chơi, tìm lại bình yên":e==="ms"?"Lepaskan tekanan melalui permainan, temui ketenangan":"Libera tensionem per ludos, inveni pacem",role:"button",children:[r.jsx("span",{style:{fontSize:32},children:"🎮"}),r.jsx("span",{style:{fontWeight:700,textAlign:"center",lineHeight:1.2},children:e==="zh-TW"?"情緒發洩區":e==="zh-CN"?"情绪发泄区":e==="ja"?"感情発散エリア":e==="en"?"Emotion Release Zone":e==="ko"?"감정 발산 구역":e==="th"?"พื้นที่ระบายอารมณ์":e==="vi"?"Khu Vực Giải Tỏa Cảm Xúc":e==="ms"?"Zon Pelepasan Emosi":"Zona Emotio Liberationis"})]})]})]})]})]}),r.jsxs("div",{className:"home-right-col",style:{flex:1,minWidth:320,maxWidth:520,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"flex-start",paddingTop:120,zIndex:2},children:[r.jsx("div",{style:{display:"flex",gap:18,marginBottom:18,justifyContent:"center",width:"100%"},children:r.jsx("span",{href:"/plans",style:{background:"#6B5BFF",color:"#fff",fontWeight:700,fontSize:18,padding:"10px 28px",borderRadius:10,boxShadow:"0 2px 8px #6B5BFF33",textDecoration:"none",border:"2px solid #6B5BFF",cursor:"pointer"},children:Lf[e]})}),r.jsx("div",{style:{marginBottom:18,width:"100%",maxWidth:300},children:r.jsx(Mf,{})}),r.jsx("img",{src:"/herogirl.png",className:"home-mic-img",style:{marginBottom:0,height:"calc(100vh - 120px)",maxHeight:600,minHeight:400,width:"100%",objectFit:"contain",borderRadius:"0",boxShadow:"none",border:"none",marginTop:"-100px"}}),r.jsxs("button",{ref:o,className:"feature-btn home-chat-btn",style:{height:80,marginTop:0,marginBottom:0,position:"relative",top:"-40px",gap:8,padding:"16px 16px",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",background:"#fff",color:"#6B5BFF",border:"2px solid #6B5BFF"},onClick:()=>te(()=>ee(),"aiChat"),"aria-label":e==="zh-TW"?"開始與 AI 聊天對話":e==="zh-CN"?"开始与 AI 聊天对话":e==="en"?"Start chatting with AI":e==="ja"?"AIとのチャットを開始":e==="ko"?"AI와 채팅 시작":e==="th"?"เริ่มแชทกับ AI":e==="vi"?"Bắt đầu trò chuyệnกับ AI":e==="ms"?"Mula berbual dengan AI":"Incipe colloquium cum AI",role:"button",children:[r.jsx("span",{role:"img","aria-label":"chat",style:{fontSize:32},children:"💬"}),r.jsx("span",{className:"home-chat-btn-text",style:{fontWeight:700,textAlign:"center",lineHeight:1.2},children:i.chat})]})]})]}),I&&r.jsx("div",{style:{position:"fixed",left:0,top:0,width:"100vw",height:"100vh",background:"rgba(40,40,80,0.18)",zIndex:1e4,display:"flex",alignItems:"center",justifyContent:"center"},children:r.jsxs("div",{style:{background:"#fff",borderRadius:18,boxShadow:"0 4px 24px #6B5BFF33",padding:28,minWidth:280,maxWidth:340,width:"90vw",position:"relative",display:"flex",flexDirection:"column",gap:12},children:[r.jsx("button",{type:"button",onClick:()=>j(!1),style:{position:"absolute",top:10,right:12,background:"none",border:"none",fontSize:22,color:"#888",cursor:"pointer",fontWeight:700},children:"×"}),r.jsx("div",{style:{fontWeight:800,fontSize:18,color:"#6B5BFF",textAlign:"center",marginBottom:2},children:Re.title}),r.jsx("button",{onClick:()=>n("/register"),style:{background:"linear-gradient(90deg, #6e8efb, #a777e3)",color:"#fff",border:"none",borderRadius:14,padding:"12px 0",fontWeight:700,fontSize:17,cursor:"pointer",margin:"12px 0"},children:Re.btn}),r.jsx("button",{onClick:()=>j(!1),style:{background:"#eee",color:"#666",border:"none",borderRadius:14,padding:"10px 0",fontWeight:700,fontSize:16,cursor:"pointer"},children:Re.close})]})}),r.jsx(yE,{isOpen:A,onClose:()=>D(!1),title:O.title,message:O.message,requiredPlan:O.requiredPlan}),r.jsx(es,{isOpen:k,onClose:()=>T(!1),currentPlan:R.currentPlan,remainingDays:R.remainingDays,usedTokens:R.usedTokens,totalTokens:R.totalTokens}),r.jsx("style",{children:`
        .feature-btn, .home-chat-btn, .topbar-btn {
          transition: background 0.18s, color 0.18s, box-shadow 0.18s;
          cursor: pointer;
        }
        /* 移除懸停效果以避免畫面停滯和耗電 */
        .feature-btn, .home-chat-btn {
          background: #fff;
          border-radius: 12px;
          border: 2px solid #6B5BFF;
          color: #6B5BFF;
          font-weight: 700;
          font-size: 16px;
          padding: 8px 16px;
          backdrop-filter: blur(10px);
        }
        .home-chat-btn-text {
          font-size: 18px;
          margin-left: 2px;
        }
        .topbar-btn {
          background: #6c63ff;
          border-radius: 8px;
          border: none;
          color: #fff;
          font-weight: 700;
          font-size: 16px;
          padding: 8px 18px;
        }
        .fixed-logo-box {
          position: fixed;
          top: 16px;
          left: 42px;
          display: flex;
          align-items: center;
          gap: 12px;
          z-index: 10000;
        }
        .fixed-logo-img {
          width: 54px;
          height: 54px;
        }
        .fixed-logo-slogan {
          font-size: 20px;
          font-weight: 700;
          color: #fff;
          text-shadow: 0 2px 8px #232946, 0 4px 18px #0008;
        }
      `})]}):r.jsx("div",{style:{textAlign:"center",marginTop:"30vh",fontSize:24},children:"載入中..."})}function mo(){const[n,e]=g.useState(null),[t,i]=g.useState(!1),s=Je(),o=async()=>{const c=s.currentUser;if(!c)return null;try{i(!0);const u=await fetch(`/api/subscription/status/${c.uid}`);if(u.ok){const h=await u.json();return e(h),h}}catch(u){console.error("獲取訂閱狀態失敗:",u)}finally{i(!1)}return null},a=async c=>{const u=s.currentUser;let h=u==null?void 0:u.uid;if(!h){const p=localStorage.getItem("testUser");if(p)h=JSON.parse(p).uid;else return{allowed:!1,reason:"請先登入"}}try{const p=await fetch(`/api/subscription/details/${h}`);let f=null;p.ok&&(f=await p.json());const b=localStorage.getItem("testMode")==="true";if(b)return{allowed:!0,reason:void 0,featureName:{aiChat:"AI 聊天功能",voiceInput:"語音輸入功能",voiceOutput:"語音輸出功能",videoChat:"視訊通話功能",voiceRecording:"語音錄製功能"}[c]||c,isFreeUser:!0,isTestMode:!0,currentPlan:"test"};const x=await fetch("/api/subscription/check-permission",{method:"POST",headers:{"Content-Type":"application/json","x-test-mode":b?"true":"false"},body:JSON.stringify({userId:h,feature:c})});if(x.ok){const S=await x.json(),w={aiChat:"AI 聊天功能",voiceInput:"語音輸入功能",voiceOutput:"語音輸出功能",videoChat:"視訊通話功能",voiceRecording:"語音錄製功能"},I=f&&f.isActive&&f.startDate&&new Date(f.startDate).getTime()>Date.now()-24*60*60*1e3;return{...S,featureName:w[c]||c,isFreeUser:S.currentPlan==="free"||!S.currentPlan,isNewSubscription:I,subscriptionData:f}}else return{allowed:!1,reason:"權限檢查失敗",featureName:c,isFreeUser:!0}}catch(p){return console.error("權限檢查錯誤:",p),{allowed:!1,reason:"網路錯誤",featureName:c,isFreeUser:!0}}},l=async(c,u=0)=>{const h=s.currentUser;let p=h==null?void 0:h.uid;if(!p){const b=localStorage.getItem("testUser");if(b)p=JSON.parse(b).uid;else return}const f=localStorage.getItem("testMode")==="true";try{await fetch("/api/subscription/record-usage",{method:"POST",headers:{"Content-Type":"application/json","x-test-mode":f?"true":"false"},body:JSON.stringify({userId:p,feature:c,cost:u})})}catch(b){console.error("記錄使用量失敗:",b)}};return g.useEffect(()=>{s.currentUser&&o()},[s.currentUser]),{subscriptionStatus:n,loading:t,checkPermission:a,recordUsage:l,fetchSubscriptionStatus:o}}const vE=[{code:"zh-TW",label:"繁中"},{code:"zh-CN",label:"简中"},{code:"en",label:"EN"},{code:"ja",label:"日本語"},{code:"ko",label:"한국어"},{code:"vi",label:"Tiếng Việt"},{code:"th",label:"ไทย"},{code:"la",label:"Latina"},{code:"ms",label:"Bahasa Melayu"}],Vf={"zh-TW":{back:"返回",logout:"登出",title:"🧱 情緒牆 Restart Wall",subtitle:"社交情感支援平台",subtitleDesc:"在這裡，每個人都能找到情感上的歸屬感和支援。分享你的心情，或為他人提供溫暖的支援留言，讓我們一起建立溫暖的社群。",inbox:"💌 我的留言箱",placeholder:"說出你的心聲...(200字內)",send:window.innerWidth<=768?"送出":"發送",sending:"發送中...",noMessages:"還沒有留言，快來發表你的心聲吧！",commentsTitle:"支援留言：",noComments:"還沒有人留言支援",modalTitle:"這是他的心情貼文：",modalAction:"給他支援留言：",nicknamePlaceholder:"你的暱稱",commentPlaceholder:"支援內容...",submitComment:"送出支援",supportMessage:"💝 給予支援",supportDesc:"看到別人的情感分享，給予溫暖的支援和鼓勵",recording:"錄音中",pressToStop:"按下停止",readyToRecord:"準備開始錄音",recordInstruction:"點擊「開始錄音」後，系統將開始錄製您的語音留言。",recordTimeLimit:"錄音時間限制為1分鐘",cancel:"取消",startRecording:"開始錄音",voice:"語音"},"zh-CN":{back:"返回",logout:"登出",title:"🧱 情绪墙 Restart Wall",subtitle:"社交情感支援平台",subtitleDesc:"在这里，每个人都能找到情感上的归属感和支援。分享你的心情，或为他人提供温暖的支援留言，让我们一起建立温暖的社群。",inbox:"💌 我的留言箱",placeholder:"说出你的心声...",send:"发送",sending:"发送中...",noMessages:"还没有留言，快来发表你的心声吧！",commentsTitle:"支援留言：",noComments:"还没有人留言支援",modalTitle:"这是他的心情贴文：",modalAction:"给他支援留言：",nicknamePlaceholder:"你的昵称",commentPlaceholder:"支援内容...",submitComment:"送出支援",supportMessage:"💝 给予支援",supportDesc:"看到别人的情感分享，给予温暖的支援和鼓励",recording:"录音中",pressToStop:"按下停止",readyToRecord:"准备开始录音",recordInstruction:"点击「开始录音」后，系统将开始录制您的语音留言。",recordTimeLimit:"录音时间限制为1分钟",cancel:"取消",startRecording:"开始录音",voice:"语音"},en:{back:"Back",logout:"Logout",title:"🧱 Emotion Wall Restart Wall",subtitle:"Social Emotional Support Platform",subtitleDesc:"Here, everyone can find emotional belonging and support. Share your feelings, or provide warm support messages to others. Let's build a caring community together.",inbox:"💌 My Inbox",placeholder:"Say what you feel...",send:"Send",sending:"Sending...",noMessages:"No messages yet. Come and share your feelings!",commentsTitle:"Support Messages:",noComments:"No support messages yet",modalTitle:"Here's their post:",modalAction:"Leave support message:",nicknamePlaceholder:"Your Nickname",commentPlaceholder:"Support content...",submitComment:"Send Support",supportMessage:"💝 Give Support",supportDesc:"See others' emotional sharing and give warm support and encouragement",recording:"Recording",pressToStop:"Press to Stop",readyToRecord:"Ready to Start Recording",recordInstruction:'After clicking "Start Recording", the system will begin recording your voice message.',recordTimeLimit:"Recording time limit is 1 minute",cancel:"Cancel",startRecording:"Start Recording",voice:"Voice"},ja:{back:"戻る",logout:"ログアウト",title:"🧱 感情の壁 Restart Wall",subtitle:"ソーシャル感情サポートプラットフォーム",subtitleDesc:"ここでは、誰もが感情的な帰属意識とサポートを見つけることができます。あなたの気持ちを共有したり、他の人に温かい支援メッセージを提供したりして、一緒に思いやりのあるコミュニティを築きましょう。",inbox:"💌 私の受信箱",placeholder:"あなたの気持ちを話して...",send:"送信",sending:"送信中...",noMessages:"まだメッセージはありません。あなたの気持ちを投稿しに来てください！",commentsTitle:"支援メッセージ：",noComments:"まだ支援メッセージはありません",modalTitle:"彼の投稿です：",modalAction:"彼に支援メッセージを送る：",nicknamePlaceholder:"あなたのニックネーム",commentPlaceholder:"支援内容...",submitComment:"支援を送信",supportMessage:"💝 支援を送る",supportDesc:"他の人の感情的な共有を見て、温かい支援と励ましを提供する",recording:"録音中",pressToStop:"押して停止",readyToRecord:"録音の準備",recordInstruction:"「録音開始」をクリックすると、システムが音声メッセージの録音を開始します。",recordTimeLimit:"録音時間は1分に制限されています",cancel:"キャンセル",startRecording:"録音開始",voice:"音声"},ko:{back:"돌아가기",logout:"로그아웃",title:"🧱 감정의 벽 Restart Wall",subtitle:"소셜 감정 지원 플랫폼",subtitleDesc:"여기서 모든 사람이 감정적 소속감과 지원을 찾을 수 있습니다. 당신의 감정을 공유하거나 다른 사람에게 따뜻한 지원 메시지를 제공하여 함께 돌봄의 커뮤니티를 만들어봅시다.",inbox:"💌 내 메시지함",placeholder:"당신의 마음을 말해보세요...",send:"전송",sending:"전송 중...",noMessages:"아직 메시지가 없습니다. 와서 당신의 마음을 표현하세요!",commentsTitle:"지원 메시지:",noComments:"아직 지원 메시지가 없습니다",modalTitle:"그의 게시물입니다:",modalAction:"그에게 지원 메시지 남기기:",nicknamePlaceholder:"닉네임",commentPlaceholder:"지원 내용...",submitComment:"지원 보내기",supportMessage:"💝 지원하기",supportDesc:"다른 사람의 감정적 공유를 보고 따뜻한 지원과 격려를 제공",recording:"녹음 중",pressToStop:"누르면 중지",readyToRecord:"녹음 준비",recordInstruction:"「녹음 시작」을 클릭하면 시스템이 음성 메시지 녹음을 시작합니다.",recordTimeLimit:"녹음 시간은 1분으로 제한됩니다",cancel:"취소",startRecording:"녹음 시작",voice:"음성"},vi:{back:"Quay lại",logout:"Đăng xuất",title:"🧱 Bức tường Cảm xúc Restart Wall",subtitle:"Nền tảng Hỗ trợ Cảm xúc Xã hội",subtitleDesc:"Ở đây, mọi người đều có thể tìm thấy sự thuộc về và hỗ trợ về mặt cảm xúc. Chia sẻ cảm xúc của bạn, hoặc cung cấp tin nhắn hỗ trợ ấm áp cho người khác. Hãy cùng nhau xây dựng một cộng đồng quan tâm.",inbox:"💌 Hộp thư của tôi",placeholder:"Nói ra cảm xúc của bạn...",send:"Gửi",sending:"Đang gửi...",noMessages:"Chưa có tin nhắn nào. Hãy đến và chia sẻ cảm xúc của bạn!",commentsTitle:"Tin nhắn hỗ trợ:",noComments:"Chưa có tin nhắn hỗ trợ nào",modalTitle:"Đây là bài đăng của họ:",modalAction:"Để lại tin nhắn hỗ trợ:",nicknamePlaceholder:"Biệt danh của bạn",commentPlaceholder:"Nội dung hỗ trợ...",submitComment:"Gửi hỗ trợ",supportMessage:"💝 Gửi hỗ trợ",supportDesc:"Xem chia sẻ cảm xúc của người khác và đưa ra hỗ trợ và khích lệ ấm áp",recording:"Đang ghi âm",pressToStop:"Nhấn để dừng",readyToRecord:"Sẵn sàng ghi âm",recordInstruction:'Sau khi nhấp vào "Bắt đầu ghi âm", hệ thống sẽ bắt đầu ghi âm tin nhắn giọng nói của bạn.',recordTimeLimit:"Thời gian ghi âm giới hạn 1 phút",cancel:"Hủy",startRecording:"Bắt đầu ghi âm",voice:"Giọng nói"},th:{back:"กลับ",logout:"ออกจากระบบ",title:"🧱 กำแพงอารมณ์ Restart Wall",subtitle:"แพลตฟอร์มสนับสนุนอารมณ์ทางสังคม",subtitleDesc:"ที่นี่ ทุกคนสามารถหาความเป็นเจ้าของและความสนับสนุนทางอารมณ์ได้ แบ่งปันความรู้สึกของคุณ หรือให้ข้อความสนับสนุนที่อบอุ่นแก่ผู้อื่น มาเริ่มสร้างชุมชนที่ห่วงใยกันเถอะ",inbox:"💌 กล่องข้อความของฉัน",placeholder:"บอกความรู้สึกของคุณ...",send:"ส่ง",sending:"กำลังส่ง...",noMessages:"ยังไม่มีข้อความ มาแบ่งปันความรู้สึกของคุณสิ!",commentsTitle:"ข้อความสนับสนุน:",noComments:"ยังไม่มีข้อความสนับสนุน",modalTitle:"นี่คือโพสต์ของพวกเขา:",modalAction:"แสดงข้อความสนับสนุน:",nicknamePlaceholder:"ชื่อเล่นของคุณ",commentPlaceholder:"เนื้อหาสนับสนุน...",submitComment:"ส่งการสนับสนุน",supportMessage:"💝 ให้การสนับสนุน",supportDesc:"ดูการแบ่งปันอารมณ์ของผู้อื่นและให้การสนับสนุนและกำลังใจที่อบอุ่น",recording:"กำลังบันทึก",pressToStop:"กดเพื่อหยุด",readyToRecord:"พร้อมบันทึกเสียง",recordInstruction:'หลังจากคลิก "เริ่มบันทึก" ระบบจะเริ่มบันทึกข้อความเสียงของคุณ',recordTimeLimit:"เวลาบันทึกเสียงจำกัด 1 นาที",cancel:"ยกเลิก",startRecording:"เริ่มบันทึก",voice:"เสียง"},la:{back:"Redire",logout:"Exire",title:"🧱 Murus Emotionum Restart Wall",subtitle:"Platea Socialis Sustentationis Emotionalis",subtitleDesc:"Hic, omnes possunt invenire pertinere emotionalem et sustentationem. Communica sensus tuos, vel praebe calidas sustentationis epistulas aliis. Simul aedificemus communitatem curantem.",inbox:"💌 Cista Mea",placeholder:"Dic quod sentis...",send:"Mittere",sending:"Mittens...",noMessages:"Nullae epistulae adhuc. Veni et communica sensus tuos!",commentsTitle:"Epistulae Sustentationis:",noComments:"Nullae epistulae sustentationis adhuc",modalTitle:"Ecce nuntius eorum:",modalAction:"Mitte epistulam sustentationis:",nicknamePlaceholder:"Tuum agnomen",commentPlaceholder:"Contentum sustentationis...",submitComment:"Mitte Sustentationem",supportMessage:"💝 Da Sustentationem",supportDesc:"Vide communicationem emotionalem aliorum et praebe calidam sustentationem et cohortationem",recording:"Recordans",pressToStop:"Preme ad Desinere",readyToRecord:"Paratus ad Recordandum",recordInstruction:'Postquam "Incipe Recordandum" cliccas, systema incipiet recordare nuntium vocis tuae.',recordTimeLimit:"Tempus recordandi limitatur ad 1 minuta",cancel:"Cancella",startRecording:"Incipe Recordandum",voice:"Vox"},ms:{back:"Kembali",logout:"Log Keluar",title:"🧱 Tembok Emosi Restart Wall",subtitle:"Platform Sokongan Emosi Sosial",subtitleDesc:"Di sini, semua orang dapat mencari rasa kepunyaan dan sokongan emosi. Kongsi perasaan anda, atau berikan mesej sokongan yang hangat kepada orang lain. Mari kita bina komuniti yang prihatin bersama.",inbox:"💌 Kotak Mesej Saya",placeholder:"Katakan perasaan anda...",send:"Hantar",sending:"Menghantar...",noMessages:"Belum ada mesej lagi. Datang dan kongsi perasaan anda!",commentsTitle:"Mesej Sokongan:",noComments:"Belum ada mesej sokongan",modalTitle:"Ini adalah siaran mereka:",modalAction:"Tinggalkan mesej sokongan:",nicknamePlaceholder:"Nama samaran anda",commentPlaceholder:"Kandungan sokongan...",submitComment:"Hantar Sokongan",supportMessage:"💝 Beri Sokongan",supportDesc:"Lihat perkongsian emosi orang lain dan berikan sokongan dan galakan yang hangat",recording:"Merakam",pressToStop:"Tekan untuk Berhenti",readyToRecord:"Sedia untuk Merakam",recordInstruction:'Selepas mengklik "Mula Merakam", sistem akan mula merakam mesej suara anda.',recordTimeLimit:"Masa rakaman terhad kepada 1 minit",cancel:"Batal",startRecording:"Mula Merakam",voice:"Suara"}};function wE(){const n=$e(),e=Je(),t=Ba(),[i,s]=g.useState([]),[o,a]=g.useState(""),[l,c]=g.useState(!1),[u,h]=g.useState(null),[p,f]=g.useState(""),[b,x]=g.useState(!1),[S,w]=g.useState(null),[I,j]=g.useState(!1),[A,D]=g.useState(!1),[O,P]=g.useState(0),[B,k]=g.useState(null),[T,R]=g.useState([]),[E,_]=g.useState(!1),[v,z]=g.useState(""),[H,L]=g.useState(0),[ee,ge]=g.useState(!1),oe=g.useRef(null),Ie=g.useRef([]),Re=g.useRef(0),[te,W]=g.useState(null),[Y,X]=g.useState(null),[le,be]=g.useState(0),[ve,Me]=g.useState(null),[Ve,ie]=g.useState(!1),{lang:$,setLang:We}=Qe(),_e=Vf[$]||Vf["zh-TW"],{checkPermission:ye,recordUsage:J}=mo(),[pe,ce]=g.useState(!1),[me,xe]=g.useState(null),{isTestMode:M}=ji(),q=async N=>{var V,he,fe;try{const ze=Ot(t,"profiles",N),Ce=await fi(ze);if(Ce.exists()){const Ee=Ce.data();return{name:Ee.nickname||Ee.name||"用戶",avatar:Ee.avatar||"/avatars/Derxl.png",country:Ee.country||"台灣",gender:Ee.gender||"未知",age:Ee.age||25,email:((V=e.currentUser)==null?void 0:V.email)||"unknown@example.com"}}else{const Ee=e.currentUser;return{name:(Ee==null?void 0:Ee.displayName)||((he=Ee==null?void 0:Ee.email)==null?void 0:he.split("@")[0])||"用戶",avatar:(Ee==null?void 0:Ee.photoURL)||"/avatars/Derxl.png",country:"台灣",gender:"未知",age:25,email:(Ee==null?void 0:Ee.email)||"unknown@example.com"}}}catch(ze){console.error("獲取用戶資料失敗:",ze);const Ce=e.currentUser;return{name:(Ce==null?void 0:Ce.displayName)||((fe=Ce==null?void 0:Ce.email)==null?void 0:fe.split("@")[0])||"用戶",avatar:(Ce==null?void 0:Ce.photoURL)||"/avatars/Derxl.png",country:"台灣",gender:"未知",age:25,email:(Ce==null?void 0:Ce.email)||"unknown@example.com"}}};g.useEffect(()=>{const N=localStorage.getItem("messages");if(N)try{const V=JSON.parse(N),he=Je(),fe=he.currentUser,Ce=V.filter(Xe=>!fe||Xe.user.id!=="user123"&&Xe.user.id!=="user456"&&Xe.user.id!=="user789").filter(Xe=>Xe.text.includes("[語音留言")&&(!Xe.duration||Xe.duration<=0)?(console.log("移除無效的語音消息:",Xe),!1):!0),Ee=Ce.sort((Xe,dt)=>new Date(dt.createdAt).getTime()-new Date(Xe.createdAt).getTime());s(Ee),console.log("已加載localStorage中的消息:",Ee.length,"條"),console.log("消息內容:",Ee),Ce.length!==V.length&&(localStorage.setItem("messages",JSON.stringify(Ce)),console.log("已清理假數據和無效語音消息"));const Ye=he.currentUser;Ye&&(async()=>{try{let dt=!1;const tn=await q(Ye.uid),In=Ce.map(zn=>{if(zn.comments){const Nt=zn.comments.map(Rt=>((Rt.nickname==="lkjh123"||Rt.commenterEmail==="as0@gmail.com"||!Rt.commenterId||Rt.commenterAge===0||Rt.commenterAge===35||Rt.commenterAge===39)&&(Rt.commenterId=Ye.uid,Rt.nickname=tn.name,Rt.commenterEmail=tn.email,Rt.commenterAvatar=tn.avatar,Rt.commenterCountry=tn.country,Rt.commenterGender=tn.gender,Rt.commenterAge=tn.age,Rt.createdAt=Rt.createdAt||new Date().toISOString(),dt=!0,console.log("強制修復支援留言:",Rt)),Rt));return{...zn,comments:Nt}}return zn});dt&&(s(In),localStorage.setItem("messages",JSON.stringify(In)),console.log("已修復舊的支援留言數據"))}catch(dt){console.error("修復支援留言數據失敗:",dt)}})()}catch(V){console.error("解析localStorage消息失敗:",V)}else console.log("localStorage中沒有保存的消息")},[]);const F=N=>{const he=Je().currentUser;return he&&N.user.id===he.uid},we=N=>{const he=Je().currentUser;return he&&N.commenterId===he.uid},Ne=()=>{const V=Je().currentUser;return V?i.filter(he=>he.user.id===V.uid):[]},Fe=()=>{const V=Je().currentUser,he=[];return V?(console.log("當前用戶UID:",V.uid),console.log("所有留言:",i),i.forEach(fe=>{var ze,Ce;console.log("檢查留言:",fe.id,"支援留言數量:",((ze=fe.comments)==null?void 0:ze.length)||0),(Ce=fe.comments)==null||Ce.forEach(Ee=>{var Ye;if(!Ee.commenterId){const Xe=V.displayName||((Ye=V.email)==null?void 0:Ye.split("@")[0])||"用戶",dt=V.email;(Ee.nickname===Xe||Ee.commenterEmail===dt)&&(Ee.commenterId=V.uid,console.log("為舊支援留言添加commenterId:",Ee))}console.log("支援留言:",Ee.nickname,"commenterId:",Ee.commenterId,"當前用戶UID:",V.uid),Ee.commenterId===V.uid&&(console.log("找到我的支援留言:",Ee),he.push({message:fe,comment:Ee}))})}),console.log("我的支援留言總數:",he.length),he):(console.log("沒有登入用戶"),he)},Ue=async()=>{if(A){oe.current&&oe.current.state==="recording"&&oe.current.stop(),B&&(clearInterval(B),k(null)),D(!1),j(!1),P(0);return}if(localStorage.getItem("testMode")==="true"){ge(!0);return}const V=await ye("aiChat");if(!V.allowed){xe(V),ce(!0);return}ge(!0)},Ct=async()=>{ge(!1);try{const N=await navigator.mediaDevices.getUserMedia({audio:!0}),V=new MediaRecorder(N,{mimeType:"audio/webm;codecs=opus"});R([]),Ie.current=[],P(0),Re.current=0,be(0),V.ondataavailable=fe=>{console.log("收到音頻數據，大小:",fe.data.size),fe.data.size>0&&(Ie.current.push(fe.data),R(ze=>{const Ce=[...ze,fe.data];return console.log("更新音頻塊，當前數量:",Ce.length),Ce}))},V.onstop=()=>{B&&(clearInterval(B),k(null));const fe=[...Ie.current];console.log("錄音停止，音頻塊數量:",fe.length);const ze=fe.length>0?new Blob(fe,{type:"audio/webm"}):new Blob([""],{type:"audio/webm"}),Ce=Math.max(1,Re.current);console.log("創建音頻blob，大小:",ze.size,"實際錄音時長:",Ce);const Ee=URL.createObjectURL(ze);z(Ee),L(Ce),_(!0),N.getTracks().forEach(Ye=>Ye.stop()),D(!1),j(!1)},V.start(100),oe.current=V,D(!0),j(!0);const he=setInterval(()=>{P(fe=>{const ze=fe+1;return Re.current=ze,ze>=60&&(oe.current&&oe.current.state==="recording"&&oe.current.stop(),he&&(clearInterval(he),k(null)),D(!1),j(!1),alert(`⏰ 親愛的朋友，錄音時間已達1分鐘限制，已自動停止錄音囉～

💭 我們希望給您足夠的時間表達，但也要照顧其他朋友的使用體驗。`)),ze})},1e3);k(he),console.log("開始錄音...")}catch(N){console.error("錄音失敗:",N),alert(`🎤 親愛的朋友，無法訪問麥克風呢～

🔧 請檢查瀏覽器權限設置，允許我們使用麥克風功能。

💡 通常在網址列旁邊有個麥克風圖示，點擊允許即可。`)}},ae=()=>{ge(!1)},Be=async()=>{if(v){const N=Math.max(1,H),V=`[語音留言 - ${Math.floor(N/60)}:${(N%60).toString().padStart(2,"0")}]`;console.log("發送語音留言:",{voiceText:V,actualDuration:N}),c(!0);const he=e.currentUser;if(!he){alert("請先登入"),c(!1);return}const fe=await q(he.uid),ze={id:Date.now().toString(),text:V,aiReply:"",toneId:"",createdAt:new Date().toISOString(),audioUrl:v,duration:N,user:{id:he.uid,name:fe.name,avatar:fe.avatar,country:fe.country,region:fe.country,email:fe.email},comments:[]};console.log("語音留言詳情:",{duration:H,audioUrl:v,voiceText:V}),console.log("創建的語音留言對象:",ze);const Ce=[ze,...i];s(Ce),localStorage.setItem("messages",JSON.stringify(Ce)),console.log("語音留言已保存到localStorage"),await J("aiChat",1),z(""),L(0),_(!1),c(!1),x(!0)}},ct=()=>{_(!1),z(""),L(0)},et=N=>{if(te===N.id&&Y){Y.pause(),W(null),X(null),ve&&(clearInterval(ve),Me(null)),be(0);return}if(te===N.id&&!Y){const V=new Audio(N.audioUrl),he=N.duration?N.duration-le:0;V.currentTime=he,W(N.id),X(V);const fe=setInterval(()=>{be(ze=>ze<=1?(clearInterval(fe),W(null),X(null),Me(null),0):ze-1)},1e3);Me(fe),V.play().then(()=>{console.log("繼續播放原音...")}).catch(ze=>{console.error("播放失敗:",ze),ot(N.text)});return}if(Y&&(Y.pause(),ve&&(clearInterval(ve),Me(null)),be(0)),N.audioUrl){console.log("播放音頻:",{audioUrl:N.audioUrl,duration:N.duration,messageId:N.id});const V=new Audio(N.audioUrl);W(N.id),X(V),be(N.duration||0),V.onerror=fe=>{console.error("音頻加載失敗:",fe),ot(N.text)},V.onended=()=>{W(null),X(null),be(0),ve&&(clearInterval(ve),Me(null))};const he=setInterval(()=>{be(fe=>fe<=1?(clearInterval(he),W(null),X(null),Me(null),0):fe-1)},1e3);Me(he),V.play().then(()=>{console.log("正在播放原音...")}).catch(fe=>{console.error("播放失敗:",fe),ot(N.text)})}else ot(N.text)},ot=N=>{if("speechSynthesis"in window){const V=new SpeechSynthesisUtterance(N);V.lang="zh-TW",V.rate=.9,V.pitch=1,window.speechSynthesis.cancel(),window.speechSynthesis.speak(V),console.log("正在播放留言內容（文字轉語音）...")}else alert("瀏覽器不支援語音播放功能")},ne=async()=>{if(!o.trim()){console.log("沒有輸入內容，無法發送");return}console.log("發送消息:",{input:o}),c(!0);const N=e.currentUser;if(!N){alert("請先登入"),c(!1);return}const V=await q(N.uid),he={id:Date.now().toString(),text:o,aiReply:"",toneId:"",createdAt:new Date().toISOString(),user:{id:N.uid,name:V.name,avatar:V.avatar,country:V.country,region:V.country,email:V.email},comments:[]};console.log("創建的消息對象:",he);const fe=[he,...i];s(fe),localStorage.setItem("messages",JSON.stringify(fe)),console.log("消息已保存到localStorage"),a(""),c(!1)},G=()=>{ce(!1),xe(null)},U=N=>{if(window.confirm(`🤗 親愛的朋友，您真的要刪除這條留言嗎？

💭 我們理解您可能想要重新整理思緒，但刪除後就無法找回囉～

✨ 如果您確定要刪除，我們會溫柔地幫您處理。`)){const V=i.filter(he=>he.id!==N);s(V),localStorage.setItem("messages",JSON.stringify(V)),console.log("已刪除留言:",N)}};return r.jsxs("div",{className:"modern-bg",style:{background:(window.innerWidth<=768,"#8a8a8a"),backgroundImage:"url(/soil.png)",backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat",minHeight:"100vh",display:"flex",flexDirection:"column"},children:[r.jsxs("div",{style:{position:"absolute",top:0,left:0,width:"100%",zIndex:100,display:"flex",justifyContent:"space-between",alignItems:"center",padding:window.innerWidth<=768?"12px 16px 0 16px":"18px 32px 0 32px",boxSizing:"border-box",background:"transparent"},children:[r.jsx("button",{onClick:()=>n("/"),style:{background:"#fff",border:"2px solid #6B5BFF",borderRadius:8,color:"#6B5BFF",fontWeight:700,fontSize:window.innerWidth<=768?14:16,cursor:"pointer",padding:window.innerWidth<=768?"4px 12px":"6px 18px",transition:"background 0.2s, color 0.2s, box-shadow 0.2s"},children:_e.back}),r.jsxs("div",{style:{display:"flex",gap:window.innerWidth<=768?8:12,marginRight:window.innerWidth<=768?4:8},children:[r.jsx("button",{className:"topbar-btn",onClick:async()=>{await Je().signOut(),localStorage.clear(),window.location.href="/"},onMouseOver:N=>{N.currentTarget.style.background="#6B5BFF",N.currentTarget.style.color="#fff"},onMouseOut:N=>{N.currentTarget.style.background="",N.currentTarget.style.color=""},style:{fontSize:window.innerWidth<=768?12:16,padding:window.innerWidth<=768?"4px 8px":"6px 12px"},children:_e.logout}),r.jsx("select",{className:"topbar-select",value:$,onChange:N=>{const V=N.target.value;We(V),localStorage.setItem("lang",V)},style:{padding:window.innerWidth<=768?"4px 6px":"6px 8px",borderRadius:8,fontWeight:600,cursor:"pointer",minWidth:window.innerWidth<=768?"40px":"50px",width:window.innerWidth<=768?"40px":"50px",fontSize:window.innerWidth<=768?12:14},onMouseOver:N=>{N.currentTarget.style.background="#6B5BFF",N.currentTarget.style.color="#fff"},onMouseOut:N=>{N.currentTarget.style.background="",N.currentTarget.style.color=""},children:vE.map(N=>r.jsx("option",{value:N.code,children:N.label},N.code))})]})]}),r.jsxs("div",{className:"modern-container",style:{maxWidth:window.innerWidth<=768?"100%":600,width:"100%",margin:"0 auto",flex:1,display:"flex",flexDirection:"column",justifyContent:"center",padding:window.innerWidth<=768?"140px 16px 20px 16px":"0",boxSizing:"border-box",minHeight:window.innerWidth<=768?"100vh":"auto",position:"relative",zIndex:1,overflow:"hidden",background:(window.innerWidth<=768,"linear-gradient(135deg, #FFB366 0%, #FFE5CC 100%)"),transform:"translate3d(0, 0, 0)",backfaceVisibility:"hidden",perspective:"1000px",willChange:"auto"},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:(window.innerWidth<=768,12),flexDirection:(window.innerWidth<=768,"column"),gap:(window.innerWidth<=768,8),width:"100%",minHeight:(window.innerWidth<=768,"auto"),background:(window.innerWidth<=768,"linear-gradient(135deg, #FFB366 0%, #FFE5CC 100%)")},children:[r.jsx("h2",{className:"modern-title",style:{fontSize:(window.innerWidth<=768,"1.4rem"),margin:0,flex:1,textAlign:"center",color:"#6B5BFF",textShadow:"0 2px 12px #6B5BFF88, 0 4px 24px #0008",letterSpacing:1,display:"flex",alignItems:"center",gap:(window.innerWidth<=768,2),whiteSpace:"nowrap",flexWrap:"wrap",justifyContent:"center",background:(window.innerWidth<=768,"linear-gradient(135deg, #FFB366 0%, #FFE5CC 100%)")},children:_e.title}),window.innerWidth<=768&&r.jsx("button",{onClick:()=>{console.log("【我的留言】按鈕被點擊，當前狀態:",b),x(!b),console.log("設置新狀態:",!b)},style:{background:b?"linear-gradient(135deg, #23c6e6 60%, #6B5BFF 100%)":"linear-gradient(135deg, #6B5BFF 60%, #23c6e6 100%)",color:"#fff",border:"none",borderRadius:12,fontWeight:900,fontSize:10,padding:"8px 12px",boxShadow:"0 2px 12px #6B5BFF33",letterSpacing:1,display:"flex",alignItems:"center",justifyContent:"center",gap:"2px",whiteSpace:"nowrap",width:"120px",minHeight:"32px",cursor:"pointer",zIndex:9999,position:"relative",pointerEvents:"auto",userSelect:"none",WebkitUserSelect:"none",MozUserSelect:"none",msUserSelect:"none",touchAction:"manipulation"},children:b?$==="zh-TW"||$==="zh-CN"?"🌍 所有留言":$==="en"?"🌍 All Messages":$==="ja"?"🌍 すべてのメッセージ":$==="ko"?"🌍 모든 메시지":$==="vi"?"🌍 Tất cả tin nhắn":$==="th"?"🌍 ข้อความทั้งหมด":$==="la"?"🌍 Visi ziņojumi":$==="ms"?"🌍 Semua mesej":"🌍 所有留言":$==="zh-TW"||$==="zh-CN"?"💌 我的留言":$==="en"?"💌 My Messages":$==="ja"?"💌 私のメッセージ":$==="ko"?"💌 내 메시지":$==="vi"?"💌 Tin nhắn của tôi":$==="th"?"💌 ข้อความของฉัน":$==="la"?"💌 Mani ziņojumi":$==="ms"?"💌 Mesej saya":"💌 我的留言"})]}),r.jsxs("div",{style:{background:"linear-gradient(135deg, rgba(107, 91, 255, 0.1) 0%, rgba(35, 198, 230, 0.1) 100%)",borderRadius:"20px",padding:window.innerWidth<=768?"16px":"24px",marginBottom:"18px",border:"2px solid rgba(107, 91, 255, 0.2)",boxShadow:"0 8px 32px rgba(107, 91, 255, 0.15)",backdropFilter:"blur(10px)",textAlign:"center",marginTop:window.innerWidth<=768?"40px":window.innerWidth<=768?"20px":"10px"},children:[r.jsx("h3",{style:{color:"#fff",fontSize:(window.innerWidth<=768,"1.2rem"),fontWeight:"700",margin:"0 0 12px 0",textShadow:"0 2px 8px rgba(107, 91, 255, 0.3)"},children:_e.subtitle}),r.jsx("p",{style:{color:"#000",fontSize:window.innerWidth<=768?"0.8rem":"0.9rem",lineHeight:"1.6",margin:"0",opacity:"0.9"},children:"在這裡，分享你真實的情感與心情，或為他人提供溫暖的支援留言，彼此傾聽支持，每個人都能找到情感上的歸屬感和後盾，讓我們一起建立溫暖的社群，共同打造一個有溫度大家庭。"})]}),r.jsx("div",{className:"tone-list",style:{marginBottom:18}}),r.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:12,marginBottom:18,padding:(window.innerWidth<=768,"0 8px"),width:"100%",maxWidth:"600px",margin:"0 auto"},children:[r.jsx("input",{className:"quote-card",style:{width:window.innerWidth<=768?"100%":"calc(100% - 32px)",fontSize:window.innerWidth<=768?16:18,padding:window.innerWidth<=768?"10px 14px":"12px 16px",border:"2px solid rgba(107, 91, 255, 0.5)",outline:"none",background:"#232946",color:"#fff",borderRadius:"12px",marginBottom:"8px",boxSizing:"border-box",margin:window.innerWidth<=768?void 0:"0 auto 8px auto"},maxLength:200,placeholder:_e.placeholder,value:o,onChange:N=>a(N.target.value),onKeyDown:N=>N.key==="Enter"&&ne(),disabled:l}),r.jsxs("div",{style:{display:"flex",gap:8,justifyContent:"space-between",width:window.innerWidth<=768?"100%":"calc(100% - 32px)",padding:window.innerWidth<=768?"0 8px":"0 8px 0 16px",margin:window.innerWidth<=768?void 0:"0 auto"},children:[r.jsx("button",{className:"tone-card selected",style:{fontSize:window.innerWidth<=768?14:16,padding:window.innerWidth<=768?"8px 12px":"10px 16px",minWidth:window.innerWidth<=768?"60px":"70px",whiteSpace:"nowrap",flexShrink:0,borderRadius:"8px",background:"linear-gradient(135deg, #6B5BFF 0%, #23c6e6 100%)",color:"#fff",border:"none",cursor:"pointer"},onClick:()=>{console.log("發送按鈕被點擊"),console.log("當前狀態:",{input:o,loading:l}),ne()},disabled:l,children:l?_e.sending:_e.send}),r.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"},children:[r.jsxs("button",{onClick:Ue,style:{background:I?"linear-gradient(135deg, #f44336 0%, #d32f2f 100%)":"linear-gradient(135deg, #2196F3 0%, #1976D2 100%)",border:"none",borderRadius:"12px",padding:window.innerWidth<=768?"10px 16px":"10px 10px",color:"white",cursor:"pointer",fontSize:"16px",fontWeight:"600",boxShadow:I?"0 4px 16px rgba(244, 67, 54, 0.3)":"0 4px 16px rgba(33, 150, 243, 0.3)",transition:"all 0.3s ease",display:"flex",alignItems:"center",gap:"8px",animation:I?"pulse 1.5s infinite":"none",minWidth:window.innerWidth<=768?"70px":"56px",whiteSpace:"nowrap",flexShrink:0,marginRight:window.innerWidth<=768?void 0:8},onMouseOver:N=>{I||(N.currentTarget.style.transform="translateY(-2px)",N.currentTarget.style.boxShadow="0 6px 20px rgba(33, 150, 243, 0.4)")},onMouseOut:N=>{I||(N.currentTarget.style.transform="translateY(0)",N.currentTarget.style.boxShadow="0 4px 16px rgba(33, 150, 243, 0.3)")},children:[r.jsx("span",{style:{fontSize:"18px"},children:"🎤"}),I?`${_e.recording} ${Math.floor(O/60)}:${(O%60).toString().padStart(2,"0")}`:_e.voice]}),I&&r.jsx("div",{style:{fontSize:"12px",color:"#f44336",marginTop:"4px",fontWeight:"500"},children:_e.pressToStop}),window.innerWidth>768&&r.jsx("button",{onClick:()=>{console.log("【我的留言】按鈕被點擊，當前狀態:",b),x(!b),console.log("設置新狀態:",!b)},style:{background:b?"linear-gradient(135deg, #23c6e6 60%, #6B5BFF 100%)":"linear-gradient(135deg, #6B5BFF 60%, #23c6e6 100%)",color:"#fff",border:"none",borderRadius:12,fontWeight:900,fontSize:10,padding:"6px 10px",boxShadow:"0 2px 12px #6B5BFF33",letterSpacing:1,display:"flex",alignItems:"center",justifyContent:"center",gap:"2px",whiteSpace:"nowrap",width:"100px",minHeight:"28px",cursor:"pointer",zIndex:9999,position:"relative",pointerEvents:"auto",userSelect:"none",WebkitUserSelect:"none",MozUserSelect:"none",msUserSelect:"none",touchAction:"manipulation",marginTop:"8px"},children:b?$==="zh-TW"||$==="zh-CN"?"🌍 所有留言":$==="en"?"🌍 All":$==="ja"?"🌍 すべて":$==="ko"?"🌍 모든":$==="vi"?"🌍 Tất cả":$==="th"?"🌍 ทั้งหมด":$==="la"?"🌍 Visi":$==="ms"?"🌍 Semua":"🌍 所有留言":$==="zh-TW"||$==="zh-CN"?"💌 我的留言":$==="en"?"💌 My":$==="ja"?"💌 私の":$==="ko"?"💌 내":$==="vi"?"💌 Tin nhắn":$==="th"?"💌 ข้อความ":$==="la"?"💌 Mani":$==="ms"?"💌 Mesej":"💌 我的留言"})]})]}),r.jsx("div",{className:"quote-list",children:b?r.jsxs("div",{children:[r.jsxs("h3",{style:{color:"#6B5BFF",fontSize:"1.5rem",marginBottom:"20px",textAlign:"center",fontWeight:"700"},children:["💌 ",$==="zh-TW"||$==="zh-CN"?"我的留言":$==="en"?"My Messages":$==="ja"?"私のメッセージ":$==="ko"?"내 메시지":$==="vi"?"Tin nhắn của tôi":$==="th"?"ข้อความของฉัน":$==="la"?"Mani ziņojumi":$==="ms"?"Mesej saya":"我的留言"]}),r.jsxs("div",{style:{marginBottom:"24px"},children:[r.jsx("h3",{style:{color:"#6B5BFF",fontSize:"1.2rem",marginBottom:"12px",textAlign:"center"},children:"📝 我發表的留言"}),Ne().length===0?r.jsx("div",{style:{color:"#000",textAlign:"center",padding:"20px"},children:"您還沒有發表過留言"}):Ne().map(N=>r.jsxs("div",{className:"quote-card",style:{position:"relative",paddingLeft:64,marginBottom:"12px"},children:[r.jsx("img",{src:N.user.avatar,alt:"avatar",style:{width:48,height:48,borderRadius:"50%",objectFit:"cover",position:"absolute",left:8,top:16,cursor:"pointer",border:"2px solid #6B5BFF"},onClick:()=>h(N)}),r.jsx("button",{onClick:()=>U(N.id),style:{position:"absolute",top:"8px",right:"8px",background:"linear-gradient(135deg, #ff6b6b 60%, #ff8e8e 100%)",color:"#fff",border:"none",borderRadius:"12px",padding:"4px 8px",fontSize:"12px",fontWeight:"600",cursor:"pointer",boxShadow:"0 2px 8px rgba(255, 107, 107, 0.3)",zIndex:10},children:"刪除"}),r.jsx("div",{className:"quote-text",children:N.text}),N.audioUrl&&r.jsxs("div",{style:{marginTop:"8px",display:"flex",alignItems:"center",gap:"8px"},children:[r.jsxs("button",{onClick:()=>et(N),style:{background:"linear-gradient(135deg, #4CAF50 0%, #45a049 100%)",border:"none",borderRadius:"6px",padding:"4px 8px",color:"white",cursor:"pointer",fontSize:"12px",display:"flex",alignItems:"center",gap:"4px"},children:[r.jsx("span",{children:te===N.id?"⏹️":"▶️"}),te===N.id?"停止播放":"播放原音"]}),r.jsxs("span",{style:{fontSize:"12px",color:"#ccc"},children:["錄音時長: ",N.duration&&N.duration>0?`${Math.floor(N.duration/60)}:${(N.duration%60).toString().padStart(2,"0")}`:"未知"]})]}),r.jsx("div",{style:{fontSize:12,color:"#fff",marginTop:6},children:new Date(N.createdAt).toLocaleString()}),r.jsxs("div",{style:{marginTop:14,background:"#f7f7ff",borderRadius:10,padding:"10px 14px",boxShadow:"0 1px 6px #6B5BFF11"},children:[r.jsx("b",{style:{color:"#6B5BFF",fontSize:16},children:_e.commentsTitle}),(N.comments||[]).length===0&&r.jsx("span",{style:{color:"#bbb",marginLeft:8},children:_e.noComments}),r.jsx("div",{style:{display:"flex",flexDirection:"column",gap:6,marginTop:6},children:(N.comments||[]).sort((V,he)=>{const fe=V.createdAt?new Date(V.createdAt).getTime():new Date(N.createdAt).getTime();return(he.createdAt?new Date(he.createdAt).getTime():new Date(N.createdAt).getTime())-fe}).map((V,he)=>r.jsxs("div",{style:{background:"#fff",borderRadius:8,padding:"8px 12px",color:"#232946",fontSize:15,border:"1px solid #eee",boxShadow:"0 1px 4px #6B5BFF08",position:"relative",paddingLeft:"60px"},children:[r.jsx("img",{src:V.commenterAvatar||"https://via.placeholder.com/40x40/6B7280/FFFFFF?text=?",alt:"commenter avatar",style:{width:40,height:40,borderRadius:"50%",objectFit:"cover",position:"absolute",left:8,top:8,border:"2px solid #6B5BFF"}}),r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"4px"},children:[r.jsx("b",{style:{color:"#6B5BFF"},children:V.nickname}),(F(N)||we(V))&&r.jsxs("div",{style:{fontSize:"12px",color:"#666"},children:[r.jsxs("div",{children:["📧 ",V.commenterEmail]}),r.jsxs("div",{children:["🌍 ",V.commenterCountry]}),r.jsxs("div",{children:["👤 ",V.commenterGender,"・",V.commenterAge,"歲"]})]}),!F(N)&&!we(V)&&r.jsx("div",{style:{fontSize:"12px",color:"#666"},children:r.jsxs("div",{children:["🌍 ",V.commenterCountry]})})]}),r.jsx("div",{children:V.content}),r.jsx("div",{style:{fontSize:10,color:"#999",marginTop:4},children:V.createdAt?new Date(V.createdAt).toLocaleString():new Date(N.createdAt).toLocaleString()}),F(N)&&!we(V)&&r.jsx("button",{onClick:()=>alert(`聯繫 ${V.nickname}：
郵箱：${V.commenterEmail}
國家：${V.commenterCountry}
性別：${V.commenterGender}
年齡：${V.commenterAge}`),style:{position:"absolute",top:"8px",right:"8px",background:"linear-gradient(135deg, #6B5BFF 60%, #23c6e6 100%)",color:"#fff",border:"none",borderRadius:"12px",padding:"4px 8px",fontSize:"10px",cursor:"pointer",fontWeight:"600"},children:"📞 聯繫"})]},he))})]})]},N.id))]})]}):r.jsxs(r.Fragment,{children:[r.jsxs("h3",{style:{color:"#6B5BFF",fontSize:"1.2rem",marginBottom:"20px",textAlign:"center",fontWeight:"700"},children:["🌍 ",$==="zh-TW"||$==="zh-CN"?"全部留言":$==="en"?"All Messages":$==="ja"?"すべてのメッセージ":$==="ko"?"모든 메시지":$==="vi"?"Tất cả tin nhắn":$==="th"?"ข้อความทั้งหมด":$==="la"?"Visi ziņojumi":$==="ms"?"Semua mesej":"全部留言"]}),i.filter(N=>!F(N)).length===0&&r.jsx("div",{style:{color:"#000",textAlign:"center",marginTop:32},children:_e.noMessages}),r.jsxs("div",{style:{marginTop:"40px",marginBottom:"40px"},children:[r.jsx("h3",{style:{color:"#6B5BFF",fontSize:"1rem",marginBottom:"12px",textAlign:"center"},children:"💝 我給別人的支援留言"}),(()=>{const N=Fe();return console.log("我的支援留言數量:",N.length),console.log("我的支援留言:",N),N.length===0?r.jsx("div",{style:{color:"#000",textAlign:"center",padding:"20px"},children:"您還沒有給別人留過支援留言"}):N.map(({message:V,comment:he},fe)=>r.jsxs("div",{className:"quote-card",style:{position:"relative",paddingLeft:64,marginBottom:"12px"},children:[r.jsx("img",{src:V.user.avatar,alt:"avatar",style:{width:48,height:48,borderRadius:"50%",objectFit:"cover",position:"absolute",left:8,top:16,border:"2px solid #6B5BFF"}}),r.jsxs("div",{style:{fontSize:"12px",color:"#666",marginBottom:"4px"},children:["給 ",r.jsx("b",{style:{color:"#6B5BFF"},children:V.user.name})," 的支援留言："]}),r.jsx("div",{className:"quote-text",style:{background:"#f0f8ff",padding:"8px 12px",borderRadius:"8px",border:"1px solid #e6f3ff"},children:he.content}),r.jsx("div",{style:{fontSize:12,color:"#614425",marginTop:6},children:he.createdAt?new Date(he.createdAt).toLocaleString():new Date(V.createdAt).toLocaleString()})]},fe))})()]}),i.filter(N=>!F(N)).map(N=>r.jsxs("div",{className:"quote-card",style:{position:"relative",paddingLeft:64},children:[r.jsx("img",{src:N.user.avatar,alt:"avatar",style:{width:48,height:48,borderRadius:"50%",objectFit:"cover",position:"absolute",left:8,top:16,cursor:"pointer",border:"2px solid #6B5BFF"},onClick:()=>h(N)}),r.jsx("div",{className:"quote-text",children:N.text}),N.audioUrl&&r.jsxs("div",{style:{marginTop:"8px",display:"flex",alignItems:"center",gap:"8px"},children:[r.jsxs("button",{onClick:()=>et(N),style:{background:"linear-gradient(135deg, #4CAF50 0%, #45a049 100%)",border:"none",borderRadius:"6px",padding:"4px 8px",color:"white",cursor:"pointer",fontSize:"12px",display:"flex",alignItems:"center",gap:"4px"},children:[r.jsx("span",{children:te===N.id?"⏹️":"▶️"}),te===N.id?"停止播放":"播放原音"]}),r.jsxs("span",{style:{fontSize:"12px",color:"#ccc"},children:["錄音時長: ",N.duration&&N.duration>0?`${Math.floor(N.duration/60)}:${(N.duration%60).toString().padStart(2,"0")}`:"未知"]})]}),r.jsx("div",{style:{fontSize:12,color:"#fff",marginTop:6},children:new Date(N.createdAt).toLocaleString()}),r.jsx("div",{style:{marginTop:12,display:"flex",justifyContent:"center"},children:r.jsx("button",{onClick:()=>h(N),style:{background:"linear-gradient(135deg, #6B5BFF 60%, #23c6e6 100%)",color:"#fff",border:"none",borderRadius:"20px",padding:"8px 20px",fontSize:"14px",fontWeight:"600",cursor:"pointer",boxShadow:"0 2px 8px rgba(107, 91, 255, 0.3)"},children:_e.supportMessage})}),r.jsxs("div",{style:{marginTop:14,background:"#f7f7ff",borderRadius:10,padding:"10px 14px",boxShadow:"0 1px 6px #6B5BFF11"},children:[r.jsx("b",{style:{color:"#6B5BFF",fontSize:16},children:_e.commentsTitle}),(N.comments||[]).length===0&&r.jsx("span",{style:{color:"#bbb",marginLeft:8},children:_e.noComments}),r.jsx("div",{style:{display:"flex",flexDirection:"column",gap:6,marginTop:6},children:(N.comments||[]).sort((V,he)=>{const fe=V.createdAt?new Date(V.createdAt).getTime():new Date(N.createdAt).getTime();return(he.createdAt?new Date(he.createdAt).getTime():new Date(N.createdAt).getTime())-fe}).map((V,he)=>r.jsxs("div",{style:{background:"#fff",borderRadius:8,padding:"8px 12px",color:"#232946",fontSize:15,border:"1px solid #eee",boxShadow:"0 1px 4px #6B5BFF08",position:"relative",paddingLeft:"60px"},children:[r.jsx("img",{src:V.commenterAvatar||"https://via.placeholder.com/40x40/6B7280/FFFFFF?text=?",alt:"commenter avatar",style:{width:40,height:40,borderRadius:"50%",objectFit:"cover",position:"absolute",left:8,top:8,border:"2px solid #6B5BFF"}}),r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"4px"},children:[r.jsx("b",{style:{color:"#6B5BFF"},children:V.nickname}),(F(N)||we(V))&&r.jsxs("div",{style:{fontSize:"12px",color:"#666"},children:[r.jsxs("div",{children:["📧 ",V.commenterEmail]}),r.jsxs("div",{children:["🌍 ",V.commenterCountry]}),r.jsxs("div",{children:["👤 ",V.commenterGender,"・",V.commenterAge,"歲"]})]}),!F(N)&&!we(V)&&r.jsx("div",{style:{fontSize:"12px",color:"#666"},children:r.jsxs("div",{children:["🌍 ",V.commenterCountry]})})]}),r.jsx("div",{children:V.content}),r.jsx("div",{style:{fontSize:10,color:"#999",marginTop:4},children:V.createdAt?new Date(V.createdAt).toLocaleString():new Date(N.createdAt).toLocaleString()}),F(N)&&!we(V)&&r.jsx("button",{onClick:()=>alert(`聯繫 ${V.nickname}：
郵箱：${V.commenterEmail}
國家：${V.commenterCountry}
性別：${V.commenterGender}
年齡：${V.commenterAge}`),style:{position:"absolute",top:"8px",right:"8px",background:"linear-gradient(135deg, #6B5BFF 60%, #23c6e6 100%)",color:"#fff",border:"none",borderRadius:"12px",padding:"4px 8px",fontSize:"10px",cursor:"pointer",fontWeight:"600"},children:"📞 聯繫"})]},he))})]})]},N.id))]})})]})]}),ee&&r.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.5)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1e3},children:r.jsxs("div",{style:{background:"white",borderRadius:"16px",padding:"24px",maxWidth:"400px",width:"90%",textAlign:"center",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.3)"},children:[r.jsx("div",{style:{fontSize:"48px",marginBottom:"16px"},children:"🎤"}),r.jsx("h3",{style:{margin:"0 0 16px 0",color:"#333",fontSize:"20px"},children:_e.readyToRecord}),r.jsxs("p",{style:{margin:"0 0 20px 0",color:"#666",lineHeight:"1.5"},children:[_e.recordInstruction,r.jsx("br",{}),r.jsxs("strong",{style:{color:"#ff6b6b"},children:["⚠️ ",_e.recordTimeLimit]})]}),r.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"center"},children:[r.jsx("button",{onClick:ae,style:{background:"#f44336",border:"none",borderRadius:"8px",padding:"12px 24px",color:"white",cursor:"pointer",fontSize:"16px",fontWeight:"600",minWidth:"120px"},children:_e.cancel}),r.jsx("button",{onClick:Ct,style:{background:"linear-gradient(135deg, #2196F3 0%, #1976D2 100%)",border:"none",borderRadius:"8px",padding:"12px 24px",color:"white",cursor:"pointer",fontSize:"16px",fontWeight:"600",minWidth:"120px"},children:_e.startRecording})]})]})}),E&&r.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.5)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1e3},children:r.jsxs("div",{style:{background:"white",borderRadius:"16px",padding:"24px",maxWidth:"400px",width:"90%",textAlign:"center",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.3)"},children:[r.jsx("h3",{style:{margin:"0 0 16px 0",color:"#333"},children:"語音錄製完成"}),r.jsxs("p",{style:{margin:"0 0 20px 0",color:"#666"},children:["錄音時長: ",H>0?`${Math.floor(H/60)}:${(H%60).toString().padStart(2,"0")}`:"0:00"," (實際錄音: ",Math.max(1,H),"秒)"]}),r.jsxs("button",{onClick:()=>{if(v){const N=Math.max(1,H);if(Y){Y.pause(),X(null),ve&&(clearInterval(ve),Me(null));return}const V=new Audio(v);X(V),be(N),V.onended=()=>{X(null),be(0),ve&&(clearInterval(ve),Me(null))};const he=setInterval(()=>{be(fe=>fe<=1?(clearInterval(he),X(null),0):fe-1)},1e3);Me(he),V.play()}},style:{background:"linear-gradient(135deg, #4CAF50 0%, #45a049 100%)",border:"none",borderRadius:"8px",padding:"8px 16px",color:"white",cursor:"pointer",fontSize:"14px",marginBottom:"16px",display:"flex",alignItems:"center",gap:"6px",margin:"0 auto 16px auto"},children:[r.jsx("span",{children:Y?"⏹️":"▶️"}),Y?"停止播放":"播放錄音"]}),r.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"center"},children:[r.jsx("button",{onClick:Be,style:{background:"linear-gradient(135deg, #2196F3 0%, #1976D2 100%)",border:"none",borderRadius:"8px",padding:"10px 20px",color:"white",cursor:"pointer",fontSize:"14px",fontWeight:"600"},children:"確定"}),r.jsx("button",{onClick:ct,style:{background:"#f44336",border:"none",borderRadius:"8px",padding:"10px 20px",color:"white",cursor:"pointer",fontSize:"14px",fontWeight:"600"},children:"取消"})]})]})}),pe&&me&&r.jsx(es,{isOpen:pe,onClose:G,currentPlan:me.currentPlan,remainingDays:me.remainingDays,usedTokens:me.usedTokens,totalTokens:me.totalTokens}),r.jsx("div",{style:{width:"100%",margin:"0 auto",marginTop:24,background:"rgba(255,255,255,0.95)",borderRadius:16,padding:"16px",boxShadow:"0 2px 12px #6B5BFF22"},children:r.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:20,flexWrap:"wrap"},children:[r.jsx("span",{onClick:()=>n("/about"),style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12,cursor:"pointer"},children:$==="zh-TW"?"🧬 Restarter™｜我們是誰":$==="zh-CN"?"🧬 Restarter™｜我们是谁":$==="en"?"🧬 Restarter™｜Who We Are":$==="ja"?"🧬 Restarter™｜私たちについて":$==="ko"?"🧬 Restarter™｜우리는 누구인가":$==="th"?"🧬 Restarter™｜เราเป็นใคร":$==="vi"?"🧬 Restarter™｜Chúng tôi là ai":$==="ms"?"🧬 Restarter™｜Siapa Kami":"🧬 Restarter™｜Quis sumus"}),r.jsx("span",{onClick:()=>n("/privacy-policy"),style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12,cursor:"pointer"},children:$==="zh-TW"?"隱私權政策":$==="zh-CN"?"隐私政策":$==="en"?"Privacy Policy":$==="ja"?"プライバシーポリシー":$==="ko"?"개인정보 처리방침":$==="th"?"นโยบายความเป็นส่วนตัว":$==="vi"?"Chính sách bảo mật":$==="ms"?"Dasar Privasi":"Consilium de Privata"}),r.jsx("span",{onClick:()=>n("/terms"),style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12,cursor:"pointer"},children:$==="zh-TW"?"條款/聲明":$==="zh-CN"?"条款/声明":$==="en"?"Terms/Statement":$==="ja"?"規約/声明":$==="ko"?"약관/성명":$==="th"?"ข้อกำหนด/แถลงการณ์":$==="vi"?"Điều khoản/Tuyên bố":$==="ms"?"Terma/Pernyataan":"Termini/Declaratio"}),r.jsx("span",{onClick:()=>n("/data-deletion"),style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12,cursor:"pointer"},children:$==="zh-TW"?"資料刪除說明":$==="zh-CN"?"数据删除说明":$==="en"?"Data Deletion":$==="ja"?"データ削除について":$==="ko"?"데이터 삭제 안내":$==="th"?"คำอธิบายการลบข้อมูล":$==="vi"?"Giải thích xóa dữ liệu":$==="ms"?"Penjelasan Penghapusan Data":"Explicatio Deletionis Datae"}),r.jsx("span",{onClick:()=>n("/feedback"),style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12,cursor:"pointer"},children:$==="zh-TW"?"💬 意見箱｜我們想聽你說":$==="zh-CN"?"💬 意见箱｜我们想听你说":$==="en"?"💬 Feedback Box｜We Want to Hear From You":$==="ja"?"💬 ご意見箱｜私たちはあなたの声を聞きたい":$==="ko"?"💬 피드백｜우리는 당신의 말을 듣고 싶습니다":$==="th"?"💬 กล่องความคิดเห็น｜เราอยากได้ยินจากคุณ":$==="vi"?"💬 Hộp góp ý｜Chúng tôi muốn nghe từ bạn":$==="ms"?"💬 Kotak Maklum Balas｜Kami Ingin Mendengar Dari Anda":"💬 Arca Consilii｜Volumus Audire a Te"})]})})]})}const qf={"zh-TW":{title:"心聲釋放 Voice Release",subtitle:"無需放在心裡...對哪些人事物不滿你可盡情說出，天下沒有不能解決的難題",holdToRecord:"按住錄音",webSimulation:"(網頁版使用模擬錄音)",recording:"錄音中...",stopRecording:"停止錄音",todayMood:"今天的心情",reflectionMoment:"反思時刻",addDiary:"添加心聲",editDiary:"編輯心聲",deleteDiary:"刪除心聲",save:"保存",cancel:"取消",backToHome:"← 返回首頁",logout:"登出",noDiaries:"還沒有心聲日記，開始錄音吧！",startSpeaking:"開始說話",submit:"送出",submitVoice:"送出心聲",recordingComplete:"錄音完成",submitToSave:"點擊送出保存心聲",emotion:{happy:"開心",sad:"難過",angry:"生氣",neutral:"平靜",excited:"興奮",calm:"放鬆"}},"zh-CN":{title:"心声释放 Voice Release",subtitle:"无需放在心里...对哪些人事物不满你可尽情说出，天下没有不能解决的难题",holdToRecord:"按住录音",webSimulation:"(网页版使用模拟录音)",recording:"录音中...",stopRecording:"停止录音",todayMood:"今天的心情",reflectionMoment:"反思时刻",addDiary:"添加心声",editDiary:"编辑心声",deleteDiary:"删除心声",save:"保存",cancel:"取消",backToHome:"← 返回首页",logout:"登出",noDiaries:"还没有心声日记，开始录音吧！",startSpeaking:"开始说话",submit:"送出",submitVoice:"送出心声",recordingComplete:"录音完成",submitToSave:"点击送出保存心声",emotion:{happy:"开心",sad:"难过",angry:"生气",neutral:"平静",excited:"兴奋",calm:"放松"}},ja:{title:"心の声を解放 Voice Release",subtitle:"心に留めておく必要はない...どの人や物事への不満も自由に言い、解決できない問題はない",holdToRecord:"録音を押し続ける",webSimulation:"(Web版は模擬録音を使用)",recording:"録音中...",stopRecording:"録音停止",todayMood:"今日の気分",reflectionMoment:"反省の瞬間",addDiary:"心の声を追加",editDiary:"心の声を編集",deleteDiary:"心の声を削除",save:"保存",cancel:"キャンセル",backToHome:"← ホームに戻る",logout:"ログアウト",noDiaries:"まだ心の声の日記がありません。録音を始めましょう！",startSpeaking:"話し始める",submit:"送信",submitVoice:"心の声を送信",recordingComplete:"録音完了",submitToSave:"送信して心の声を保存",emotion:{happy:"嬉しい",sad:"悲しい",angry:"怒り",neutral:"平静",excited:"興奮",calm:"リラックス"}},ko:{title:"마음의 소리 해방 Voice Release",subtitle:"마음속에 담아둘 필요 없이...어떤 사람이나 사물에 대한 불만을 자유롭게 말하고, 해결할 수 없는 문제는 없다",holdToRecord:"녹음하려면 길게 누르세요",webSimulation:"(웹 버전은 시뮬레이션 녹음 사용)",recording:"녹음 중...",stopRecording:"녹음 중지",todayMood:"오늘의 기분",reflectionMoment:"성찰의 순간",addDiary:"마음의 소리 추가",editDiary:"마음의 소리 편집",deleteDiary:"마음의 소리 삭제",save:"저장",cancel:"취소",backToHome:"← 홈으로 돌아가기",logout:"로그아웃",noDiaries:"아직 마음의 소리 일기가 없습니다. 녹음을 시작해보세요!",startSpeaking:"말하기 시작",submit:"제출",submitVoice:"마음의 소리 제출",recordingComplete:"녹음 완료",submitToSave:"제출하여 마음의 소리 저장",emotion:{happy:"행복",sad:"슬픔",angry:"분노",neutral:"평온",excited:"흥분",calm:"차분"}},th:{title:"ปลดปล่อยเสียงในใจ Voice Release",subtitle:"ไม่จำเป็นต้องเก็บไว้ในใจ...คุณสามารถพูดความไม่พอใจต่อคนหรือสิ่งต่างๆ ได้อย่างอิสระ ไม่มีปัญหาที่แก้ไขไม่ได้",holdToRecord:"กดค้างเพื่อบันทึก",webSimulation:"(เวอร์ชันเว็บใช้การบันทึกจำลอง)",recording:"กำลังบันทึก...",stopRecording:"หยุดบันทึก",todayMood:"อารมณ์วันนี้",reflectionMoment:"ช่วงเวลาสะท้อนคิด",addDiary:"เพิ่มเสียงในใจ",editDiary:"แก้ไขเสียงในใจ",deleteDiary:"ลบเสียงในใจ",save:"บันทึก",cancel:"ยกเลิก",backToHome:"← กลับหน้าหลัก",logout:"ออกจากระบบ",noDiaries:"ยังไม่มีไดอารี่เสียงในใจ เริ่มบันทึกกันเลย!",startSpeaking:"เริ่มพูด",submit:"ส่ง",submitVoice:"ส่งเสียงในใจ",recordingComplete:"บันทึกเสร็จสิ้น",submitToSave:"คลิกส่งเพื่อบันทึกเสียงในใจ",emotion:{happy:"มีความสุข",sad:"เศร้า",angry:"โกรธ",neutral:"สงบ",excited:"ตื่นเต้น",calm:"ผ่อนคลาย"}},vi:{title:"Giải Phóng Tiếng Lòng Voice Release",subtitle:"Không cần giữ trong lòng...bạn có thể tự do nói ra sự bất mãn với những người hoặc sự việc nào đó, không có vấn đề nào không thể giải quyết",holdToRecord:"Giữ để ghi âm",webSimulation:"(Phiên bản web sử dụng ghi âm mô phỏng)",recording:"Đang ghi âm...",stopRecording:"Dừng ghi âm",todayMood:"Tâm trạng hôm nay",reflectionMoment:"Khoảnh khắc suy ngẫm",addDiary:"Thêm tiếng lòng",editDiary:"Chỉnh sửa tiếng lòng",deleteDiary:"Xóa tiếng lòng",save:"Lưu",cancel:"Hủy",backToHome:"← Về trang chủ",logout:"Đăng xuất",noDiaries:"Chưa có nhật ký tiếng lòng, hãy bắt đầu ghi âm!",startSpeaking:"Bắt đầu nói",submit:"Gửi",submitVoice:"Gửi tiếng lòng",recordingComplete:"Ghi âm hoàn thành",submitToSave:"Nhấp để gửi và lưu tiếng lòng",emotion:{happy:"Vui vẻ",sad:"Buồn",angry:"Tức giận",neutral:"Bình tĩnh",excited:"Hưng phấn",calm:"Thư giãn"}},ms:{title:"Pelepasan Suara Hati Voice Release",subtitle:"Tidak perlu disimpan dalam hati...anda boleh bebas mengucapkan ketidakpuasan terhadap orang atau perkara tertentu, tiada masalah yang tidak dapat diselesaikan",holdToRecord:"Tahan untuk Rakam",webSimulation:"(Versi web menggunakan rakaman simulasi)",recording:"Merakam...",stopRecording:"Hentikan Rakaman",todayMood:"Mood Hari Ini",reflectionMoment:"Saat Refleksi",addDiary:"Tambah Suara Hati",editDiary:"Sunting Suara Hati",deleteDiary:"Padam Suara Hati",save:"Simpan",cancel:"Batal",backToHome:"← Kembali ke Rumah",logout:"Log Keluar",noDiaries:"Belum ada diari suara hati, mulakan rakaman!",startSpeaking:"Mula Bercakap",submit:"Hantar",submitVoice:"Hantar Suara Hati",recordingComplete:"Rakaman Selesai",submitToSave:"Klik untuk hantar dan simpan suara hati",emotion:{happy:"Gembira",sad:"Sedih",angry:"Marah",neutral:"Tenang",excited:"Teruja",calm:"Selesa"}},la:{title:"Vox Liberatio Voice Release",subtitle:"Non necesse est in corde servare...liberam dissatisfactionem cum hominibus vel rebus quibusdam profer, nulla quaestio insolubilis est",holdToRecord:"Tene ad Recordandum",webSimulation:"(Versio interretialis simulatione utitur)",recording:"Recordans...",stopRecording:"Recordationem Cessa",todayMood:"Affectus Hodiernus",reflectionMoment:"Momentum Cogitationis",addDiary:"Vox Adde",editDiary:"Vox Edita",deleteDiary:"Vox Dele",save:"Serva",cancel:"Cancella",backToHome:"← Ad Domum Reverte",logout:"Exi",noDiaries:"Nondum diaria vocis cordis, incipiamus recordare!",startSpeaking:"Incipe Loqui",submit:"Submitte",submitVoice:"Vox Submitte",recordingComplete:"Recordatio Perfecta",submitToSave:"Click ut submitte et serva vocem",emotion:{happy:"Laetus",sad:"Tristis",angry:"Iratus",neutral:"Tranquillus",excited:"Excitatus",calm:"Placidus"}},en:{title:"Voice Release",subtitle:"No need to keep it in your heart...you can freely speak out your dissatisfaction with which people or things, there is no problem that cannot be solved",holdToRecord:"Hold to Record",webSimulation:"(Web version uses simulated recording)",recording:"Recording...",stopRecording:"Stop Recording",todayMood:"Today's Mood",reflectionMoment:"Reflection Moment",addDiary:"Add Voice",editDiary:"Edit Voice",deleteDiary:"Delete Voice",save:"Save",cancel:"Cancel",backToHome:"← Back to Home",logout:"Logout",noDiaries:"No heart voice diaries yet, start recording!",startSpeaking:"Start Speaking",submit:"Submit",submitVoice:"Submit Voice",recordingComplete:"Recording Complete",submitToSave:"Click to submit and save voice",emotion:{happy:"Happy",sad:"Sad",angry:"Angry",neutral:"Neutral",excited:"Excited",calm:"Calm"}}};function kE(){const n=$e(),{lang:e,setLang:t}=Qe(),i=qf[e]||qf["zh-TW"],[s,o]=g.useState(!1),[a,l]=g.useState(null),[c,u]=g.useState([]),h=g.useRef([]),[p,f]=g.useState(()=>{const ae=localStorage.getItem("voiceDiaries");return ae?JSON.parse(ae):[{id:1,title:"今天的心情",content:"今天感覺很棒，完成了所有計劃的任務。",date:new Date().toISOString(),emotion:"happy",expanded:!1},{id:2,title:"反思時刻",content:"需要學會更好地管理時間，提高效率。",date:new Date(Date.now()-24*60*60*1e3).toISOString(),emotion:"neutral",expanded:!1}]}),[b,x]=g.useState(!1),[S,w]=g.useState(!1),[I,j]=g.useState(null),[A,D]=g.useState({title:"",content:"",emotion:"neutral"}),[O,P]=g.useState(0),[B,k]=g.useState(null),[T,R]=g.useState(null),[E,_]=g.useState(!1),[v,z]=g.useState(!1),{checkPermission:H,recordUsage:L}=mo(),[ee,ge]=g.useState(!1),[oe,Ie]=g.useState(null),[Re,te]=g.useState(null),[W,Y]=g.useState(null),{isTestMode:X}=ji(),[le,be]=g.useState(!1),[ve,Me]=g.useState(null),Ve=async()=>{if(s){a&&a.state==="recording"&&a.stop(),B&&(clearInterval(B),k(null)),o(!1),x(!1),P(0);return}const ae=await H("aiChat");if(!ae.allowed){if(X){z(!0);return}ae.canRenew,Ie(ae),ge(!0);return}z(!0)},ie=async()=>{z(!1);try{const ae=await navigator.mediaDevices.getUserMedia({audio:!0}),Be=new MediaRecorder(ae,{mimeType:"audio/webm;codecs=opus"});u([]),h.current=[],P(0),Be.ondataavailable=et=>{console.log("收到音頻數據，大小:",et.data.size),et.data.size>0&&(h.current.push(et.data),u(ot=>{const ne=[...ot,et.data];return console.log("更新音頻塊，當前數量:",ne.length),ne}))},Be.onstop=()=>{const et=[...h.current];console.log("錄音停止，音頻塊數量:",et.length);const ot=et.length>0?new Blob(et,{type:"audio/webm"}):new Blob([""],{type:"audio/webm"}),ne=Math.max(1,Math.floor(et.length*.1));console.log("創建音頻blob，大小:",ot.size,"估算錄音時長:",ne),R({blob:ot,duration:ne}),_(!0),u([]),h.current=[],console.log("設置送出對話框狀態"),ae.getTracks().forEach(G=>G.stop())},Be.start(100),l(Be),o(!0),x(!0);const ct=setInterval(()=>{P(et=>{const ot=et+1;return ot>=60&&(a&&a.state==="recording"&&a.stop(),ct&&(clearInterval(ct),k(null)),o(!1),x(!1),alert("錄音時間已達1分鐘限制，已自動停止錄音")),ot})},1e3);k(ct)}catch(ae){console.error("錄音錯誤:",ae),alert("無法啟動麥克風，請檢查權限設置")}},$=()=>{z(!1)},We=(ae,Be)=>{const ct=URL.createObjectURL(ae),et=["今天心情很好，完成了所有工作。","遇到了一些挑戰，但都克服了。","學會了新的技能，感覺很有成就感。","和朋友聊天很開心，分享了很多想法。","反思今天的行為，發現還有改進空間。"],ot=et[Math.floor(Math.random()*et.length)],ne=["happy","neutral","calm"][Math.floor(Math.random()*3)],U=[{id:Date.now(),title:"心聲日記",content:ot,date:new Date().toISOString(),emotion:ne,expanded:!1,audioUrl:ct,duration:Be},...p];f(U),ye(U),x(!1)},_e=()=>{T&&(We(T.blob,T.duration),R(null),_(!1),L("aiChat",1))},ye=ae=>{localStorage.setItem("voiceDiaries",JSON.stringify(ae))},J=()=>{R(null),_(!1)},pe=()=>{if(A.title.trim()&&A.content.trim()){const Be=[{id:Date.now(),title:A.title,content:A.content,date:new Date().toISOString(),emotion:A.emotion,expanded:!1,duration:0},...p];f(Be),ye(Be),D({title:"",content:"",emotion:"neutral"}),w(!1)}},ce=ae=>{j(ae),D({title:ae.title,content:ae.content,emotion:ae.emotion})},me=()=>{if(I&&A.title.trim()&&A.content.trim()){const ae=p.map(Be=>Be.id===I.id?{...Be,title:A.title,content:A.content,emotion:A.emotion}:Be);f(ae),ye(ae),j(null),D({title:"",content:"",emotion:"neutral"})}},xe=ae=>{Me(ae),be(!0)},M=()=>{if(ve){const ae=p.filter(Be=>Be.id!==ve);f(ae),ye(ae),be(!1),Me(null)}},q=()=>{be(!1),Me(null)},F=ae=>{const Be=p.map(ct=>ct.id===ae?{...ct,expanded:!ct.expanded}:{...ct,expanded:!1});f(Be),ye(Be)},we=ae=>{if(Re===ae.id){W&&(W.pause(),W.currentTime=0),window.speechSynthesis.speaking&&window.speechSynthesis.cancel(),te(null),Y(null);return}if(W&&(W.pause(),W.currentTime=0),window.speechSynthesis.speaking&&window.speechSynthesis.cancel(),ae.audioUrl){const Be=new Audio(ae.audioUrl);Be.onended=()=>{te(null),Y(null)},Be.onerror=ct=>{console.error("音頻加載失敗:",ct),te(null),Y(null),Ne(ae.content)},Be.play().then(()=>{console.log("正在播放原音..."),te(ae.id),Y(Be)}).catch(ct=>{console.error("播放失敗:",ct),te(null),Y(null),Ne(ae.content)})}else te(ae.id),Ne(ae.content)},Ne=ae=>{if("speechSynthesis"in window){if(window.speechSynthesis.speaking){window.speechSynthesis.cancel(),te(null),Y(null);return}const Be=new SpeechSynthesisUtterance(ae);Be.lang="zh-TW",Be.rate=.9,Be.pitch=1,Be.onend=()=>{te(null),Y(null)},Be.onerror=()=>{te(null),Y(null)},window.speechSynthesis.speak(Be),console.log("正在播放心聲日記內容（文字轉語音）...")}else alert("瀏覽器不支援語音播放功能"),te(null),Y(null)},Fe=ae=>({happy:"#4CAF50",sad:"#2196F3",angry:"#F44336",neutral:"#9E9E9E",excited:"#FF9800",calm:"#8BC34A"})[ae]||"#9E9E9E",Ue=ae=>new Date(ae).toLocaleString("zh-TW",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"});g.useEffect(()=>()=>{B&&clearInterval(B)},[B]);const Ct=()=>{ge(!1),Ie(null)};return r.jsxs(r.Fragment,{children:[r.jsxs("div",{style:{minHeight:"100vh",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",padding:"20px"},children:[r.jsx("style",{children:`
            @keyframes pulse {
              0% { transform: scale(1); }
              50% { transform: scale(1.05); }
              100% { transform: scale(1); }
            }
            @keyframes bounce {
              0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
              40% { transform: translateY(-3px); }
              60% { transform: translateY(-2px); }
            }
          `}),r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"30px"},children:[r.jsx("button",{onClick:()=>n("/home"),style:{background:"#fff",border:"1.5px solid #6B5BFF",borderRadius:"8px",padding:"6px 10px",color:"#6B5BFF",cursor:"pointer",fontSize:"16px",fontWeight:"600",transition:"background 0.18s, color 0.18s, border 0.18s"},children:"返回"}),r.jsx("h1",{style:{color:"white",fontSize:"24px",fontWeight:"bold",margin:0},children:i.title}),r.jsxs("div",{style:{display:"flex",gap:"10px"},children:[r.jsx(en,{}),r.jsx("button",{onClick:()=>n("/logout"),style:{background:"rgba(255,255,255,0.2)",border:"none",borderRadius:"8px",padding:"8px 16px",color:"white",cursor:"pointer",fontSize:"14px"},children:i.logout})]})]}),r.jsxs("div",{style:{maxWidth:"800px",margin:"0 auto"},children:[r.jsxs("div",{style:{background:"rgba(255,255,255,0.95)",borderRadius:"20px",padding:"40px",textAlign:"center",marginBottom:"30px",boxShadow:"0 8px 32px rgba(0,0,0,0.1)"},children:[r.jsxs("div",{style:{marginBottom:"20px"},children:[r.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",marginBottom:"15px"},children:r.jsx("button",{onClick:Ve,style:{width:"80px",height:"80px",borderRadius:"50%",background:s?"linear-gradient(45deg, #ff5722, #ff9800)":"linear-gradient(45deg, #ff9800, #ff5722)",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:s?"0 0 0 4px #ffe0b2, 0 0 20px rgba(255, 87, 34, 0.5)":"0 4px 16px rgba(255, 152, 0, 0.3)",cursor:"pointer",transition:"all 0.3s ease",border:"none",animation:s?"pulse 1.5s infinite":"none"},onMouseEnter:ae=>{s||(ae.currentTarget.style.transform="scale(1.1)")},onMouseLeave:ae=>{s||(ae.currentTarget.style.transform="scale(1)")},children:r.jsx("span",{style:{fontSize:"32px",color:"white",filter:s?"drop-shadow(0 0 6px #ff9800)":""},children:s?"⏹️":"🎤"})})}),r.jsx("div",{style:{color:s?"#ff5722":"#ff9800",fontSize:"16px",fontWeight:"700",marginBottom:"10px",textAlign:"center"},children:s?i.stopRecording:i.startSpeaking}),s&&r.jsxs("div",{style:{color:"#ff5722",fontSize:"14px",fontWeight:"600",textAlign:"center",marginBottom:"10px"},children:["錄音中... ",Math.floor(O/60),":",(O%60).toString().padStart(2,"0")]})]}),r.jsx("p",{style:{color:"#666",fontSize:"14px",marginBottom:"20px"},children:i.holdToRecord}),r.jsx("p",{style:{color:"#999",fontSize:"12px",fontStyle:"italic"},children:i.webSimulation}),r.jsxs("button",{onClick:()=>w(!0),style:{background:"linear-gradient(45deg, #667eea, #764ba2)",border:"none",borderRadius:"12px",padding:"12px 24px",color:"white",cursor:"pointer",fontSize:"16px",fontWeight:"600",marginTop:"20px"},children:["+ ",i.addDiary]})]}),r.jsxs("div",{style:{marginBottom:"30px"},children:[r.jsxs("h3",{style:{color:"white",fontSize:"20px",marginBottom:"20px",fontWeight:"600"},children:["心聲日記 (",p.length,")"]}),p.length===0?r.jsx("div",{style:{background:"rgba(255,255,255,0.95)",borderRadius:"16px",padding:"40px",textAlign:"center",color:"#666"},children:i.noDiaries}):r.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:p.map(ae=>r.jsx("div",{style:{background:"rgba(255,255,255,0.95)",borderRadius:"16px",padding:"20px",boxShadow:"0 4px 16px rgba(0,0,0,0.1)"},children:r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"12px"},children:[r.jsxs("div",{style:{flex:1},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",marginBottom:"8px"},children:[r.jsx("button",{onClick:()=>F(ae.id),style:{background:"none",border:"none",cursor:"pointer",fontSize:"16px",fontWeight:"600",color:"#333",textAlign:"left",flex:1},children:ae.title}),r.jsx("button",{onClick:()=>we(ae),style:{background:Re===ae.id?"linear-gradient(45deg, #ff5722, #ff9800)":"linear-gradient(45deg, #4CAF50, #45a049)",border:"none",borderRadius:"50%",width:"36px",height:"36px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",transition:"transform 0.2s"},onMouseEnter:Be=>{Be.currentTarget.style.transform="scale(1.1)"},onMouseLeave:Be=>{Be.currentTarget.style.transform="scale(1)"},children:r.jsx("span",{style:{fontSize:"16px",color:"white"},children:Re===ae.id?"⏹️":"▶️"})}),r.jsx("span",{style:{background:Fe(ae.emotion),color:"white",padding:"4px 8px",borderRadius:"12px",fontSize:"12px",fontWeight:"600"},children:i.emotion[ae.emotion]})]}),ae.expanded&&r.jsxs("div",{style:{marginTop:"12px",padding:"12px",background:"rgba(0,0,0,0.05)",borderRadius:"8px"},children:[r.jsx("p",{style:{color:"#666",fontSize:"14px",lineHeight:"1.5",marginBottom:"8px"},children:ae.content}),r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:"8px"},children:[r.jsx("p",{style:{color:"#999",fontSize:"12px"},children:Ue(ae.date)}),ae.duration&&r.jsxs("span",{style:{color:"#667eea",fontSize:"12px",fontWeight:"500",background:"rgba(102, 126, 234, 0.1)",padding:"2px 6px",borderRadius:"4px"},children:["⏱️ ",Math.floor(ae.duration/60),":",(ae.duration%60).toString().padStart(2,"0")]})]})]})]}),r.jsxs("div",{style:{display:"flex",gap:"8px"},children:[r.jsxs("button",{onClick:()=>ce(ae),style:{background:"#4CAF50",border:"none",borderRadius:"6px",padding:"6px 12px",color:"white",cursor:"pointer",fontSize:"12px"},children:["✏️ ",i.editDiary]}),r.jsxs("button",{onClick:()=>xe(ae.id),style:{background:"#F44336",border:"none",borderRadius:"6px",padding:"6px 12px",color:"white",cursor:"pointer",fontSize:"12px"},children:["🗑️ ",i.deleteDiary]})]})]})},ae.id))})]})]}),S&&r.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:r.jsxs("div",{style:{background:"white",borderRadius:"16px",padding:"30px",width:"90%",maxWidth:"500px"},children:[r.jsx("h3",{style:{marginBottom:"20px",color:"#333"},children:i.addDiary}),r.jsxs("div",{style:{marginBottom:"16px"},children:[r.jsx("label",{style:{display:"block",marginBottom:"8px",color:"#666"},children:"標題"}),r.jsx("input",{type:"text",value:A.title,onChange:ae=>D(Be=>({...Be,title:ae.target.value})),style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid #ddd",fontSize:"14px"},placeholder:"輸入日記標題"})]}),r.jsxs("div",{style:{marginBottom:"16px"},children:[r.jsx("label",{style:{display:"block",marginBottom:"8px",color:"#666"},children:"內容"}),r.jsx("textarea",{value:A.content,onChange:ae=>D(Be=>({...Be,content:ae.target.value})),style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid #ddd",fontSize:"14px",minHeight:"100px",resize:"vertical"},placeholder:"輸入日記內容"})]}),r.jsxs("div",{style:{marginBottom:"20px"},children:[r.jsx("label",{style:{display:"block",marginBottom:"8px",color:"#666"},children:"情緒"}),r.jsxs("select",{value:A.emotion,onChange:ae=>D(Be=>({...Be,emotion:ae.target.value})),style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid #ddd",fontSize:"14px"},children:[r.jsx("option",{value:"happy",children:i.emotion.happy}),r.jsx("option",{value:"sad",children:i.emotion.sad}),r.jsx("option",{value:"angry",children:i.emotion.angry}),r.jsx("option",{value:"neutral",children:i.emotion.neutral}),r.jsx("option",{value:"excited",children:i.emotion.excited}),r.jsx("option",{value:"calm",children:i.emotion.calm})]})]}),r.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"flex-end"},children:[r.jsx("button",{onClick:()=>w(!1),style:{background:"#f5f5f5",border:"none",borderRadius:"8px",padding:"12px 24px",color:"#666",cursor:"pointer",fontSize:"14px"},children:i.cancel}),r.jsx("button",{onClick:pe,style:{background:"linear-gradient(45deg, #667eea, #764ba2)",border:"none",borderRadius:"8px",padding:"12px 24px",color:"white",cursor:"pointer",fontSize:"14px",fontWeight:"600"},children:i.save})]})]})}),I&&r.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:r.jsxs("div",{style:{background:"white",borderRadius:"16px",padding:"30px",width:"90%",maxWidth:"500px"},children:[r.jsx("h3",{style:{marginBottom:"20px",color:"#333"},children:i.editDiary}),r.jsxs("div",{style:{marginBottom:"16px"},children:[r.jsx("label",{style:{display:"block",marginBottom:"8px",color:"#666"},children:"標題"}),r.jsx("input",{type:"text",value:A.title,onChange:ae=>D(Be=>({...Be,title:ae.target.value})),style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid #ddd",fontSize:"14px"}})]}),r.jsxs("div",{style:{marginBottom:"16px"},children:[r.jsx("label",{style:{display:"block",marginBottom:"8px",color:"#666"},children:"內容"}),r.jsx("textarea",{value:A.content,onChange:ae=>D(Be=>({...Be,content:ae.target.value})),style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid #ddd",fontSize:"14px",minHeight:"100px",resize:"vertical"}})]}),r.jsxs("div",{style:{marginBottom:"20px"},children:[r.jsx("label",{style:{display:"block",marginBottom:"8px",color:"#666"},children:"情緒"}),r.jsxs("select",{value:A.emotion,onChange:ae=>D(Be=>({...Be,emotion:ae.target.value})),style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid #ddd",fontSize:"14px"},children:[r.jsx("option",{value:"happy",children:i.emotion.happy}),r.jsx("option",{value:"sad",children:i.emotion.sad}),r.jsx("option",{value:"angry",children:i.emotion.angry}),r.jsx("option",{value:"neutral",children:i.emotion.neutral}),r.jsx("option",{value:"excited",children:i.emotion.excited}),r.jsx("option",{value:"calm",children:i.emotion.calm})]})]}),r.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"flex-end"},children:[r.jsx("button",{onClick:()=>j(null),style:{background:"#f5f5f5",border:"none",borderRadius:"8px",padding:"12px 24px",color:"#666",cursor:"pointer",fontSize:"14px"},children:i.cancel}),r.jsx("button",{onClick:me,style:{background:"linear-gradient(45deg, #667eea, #764ba2)",border:"none",borderRadius:"8px",padding:"12px 24px",color:"white",cursor:"pointer",fontSize:"14px",fontWeight:"600"},children:i.save})]})]})}),v&&r.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:r.jsxs("div",{style:{background:"white",borderRadius:"16px",padding:"30px",width:"90%",maxWidth:"500px",textAlign:"center"},children:[r.jsx("div",{style:{fontSize:"48px",marginBottom:"20px"},children:"🎤"}),r.jsx("h3",{style:{marginBottom:"16px",color:"#333",fontSize:"20px",fontWeight:"600"},children:"準備開始錄音"}),r.jsxs("p",{style:{marginBottom:"20px",color:"#666",fontSize:"16px",lineHeight:"1.5"},children:["點擊「開始錄音」後，系統將開始錄製您的語音日記。",r.jsx("br",{}),r.jsx("strong",{style:{color:"#ff6b6b"},children:"⚠️ 錄音時間限制為1分鐘"})]}),r.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"center"},children:[r.jsx("button",{onClick:$,style:{background:"#f5f5f5",border:"none",borderRadius:"8px",padding:"12px 24px",color:"#666",cursor:"pointer",fontSize:"14px",fontWeight:"500"},children:"取消"}),r.jsx("button",{onClick:ie,style:{background:"linear-gradient(45deg, #667eea, #764ba2)",border:"none",borderRadius:"8px",padding:"12px 24px",color:"white",cursor:"pointer",fontSize:"14px",fontWeight:"600",boxShadow:"0 4px 12px rgba(102, 126, 234, 0.3)"},children:"開始錄音"})]})]})}),E&&T&&(console.log("渲染送出對話框，pendingAudio:",T),!0)&&r.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:r.jsxs("div",{style:{background:"white",borderRadius:"16px",padding:"30px",width:"90%",maxWidth:"500px",textAlign:"center"},children:[r.jsx("div",{style:{fontSize:"48px",marginBottom:"20px"},children:"🎤"}),r.jsx("h3",{style:{marginBottom:"10px",color:"#333",fontSize:"20px",fontWeight:"600"},children:i.recordingComplete}),r.jsx("p",{style:{marginBottom:"20px",color:"#666",fontSize:"16px"},children:i.submitToSave}),r.jsx("div",{style:{marginBottom:"20px",padding:"15px",background:"#f8f9fa",borderRadius:"8px",border:"1px solid #e9ecef"},children:r.jsxs("div",{style:{color:"#495057",fontSize:"14px",fontWeight:"500"},children:["錄音時長: ",Math.floor(T.duration/60),":",(T.duration%60).toString().padStart(2,"0")]})}),r.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"center"},children:[r.jsx("button",{onClick:J,style:{background:"#f5f5f5",border:"none",borderRadius:"8px",padding:"12px 24px",color:"#666",cursor:"pointer",fontSize:"14px",fontWeight:"500"},children:i.cancel}),r.jsx("button",{onClick:_e,style:{background:"linear-gradient(45deg, #667eea, #764ba2)",border:"none",borderRadius:"8px",padding:"12px 24px",color:"white",cursor:"pointer",fontSize:"14px",fontWeight:"600",boxShadow:"0 4px 12px rgba(102, 126, 234, 0.3)"},children:i.submit})]})]})}),le&&r.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:r.jsxs("div",{style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",borderRadius:"20px",padding:"40px",width:"90%",maxWidth:"450px",textAlign:"center",boxShadow:"0 20px 40px rgba(0,0,0,0.3)",border:"2px solid rgba(255,255,255,0.2)"},children:[r.jsx("div",{style:{fontSize:"64px",marginBottom:"20px",animation:"pulse 2s infinite"},children:"💔"}),r.jsx("h3",{style:{marginBottom:"15px",color:"white",fontSize:"22px",fontWeight:"600",textShadow:"0 2px 4px rgba(0,0,0,0.3)"},children:"這個心聲對您來說很重要嗎？"}),r.jsx("p",{style:{marginBottom:"30px",color:"rgba(255,255,255,0.9)",fontSize:"16px",lineHeight:"1.5",textShadow:"0 1px 2px rgba(0,0,0,0.3)"},children:"刪除後將無法恢復，請確認是否真的要刪除？"}),r.jsxs("div",{style:{display:"flex",gap:"15px",justifyContent:"center"},children:[r.jsx("button",{onClick:q,style:{background:"rgba(255,255,255,0.2)",border:"2px solid rgba(255,255,255,0.3)",borderRadius:"12px",padding:"14px 28px",color:"white",cursor:"pointer",fontSize:"16px",fontWeight:"600",transition:"all 0.3s ease",backdropFilter:"blur(10px)"},onMouseEnter:ae=>{ae.currentTarget.style.background="rgba(255,255,255,0.3)",ae.currentTarget.style.transform="translateY(-2px)"},onMouseLeave:ae=>{ae.currentTarget.style.background="rgba(255,255,255,0.2)",ae.currentTarget.style.transform="translateY(0)"},children:"取消"}),r.jsx("button",{onClick:M,style:{background:"linear-gradient(45deg, #ff6b6b, #ee5a52)",border:"none",borderRadius:"12px",padding:"14px 28px",color:"white",cursor:"pointer",fontSize:"16px",fontWeight:"600",boxShadow:"0 8px 20px rgba(255,107,107,0.4)",transition:"all 0.3s ease"},onMouseEnter:ae=>{ae.currentTarget.style.transform="translateY(-2px)",ae.currentTarget.style.boxShadow="0 12px 25px rgba(255,107,107,0.5)"},onMouseLeave:ae=>{ae.currentTarget.style.transform="translateY(0)",ae.currentTarget.style.boxShadow="0 8px 20px rgba(255,107,107,0.4)"},children:"確定刪除"})]})]})})]}),ee&&oe&&r.jsx(es,{isOpen:ee,onClose:Ct,currentPlan:oe.currentPlan,remainingDays:oe.remainingDays,usedTokens:oe.usedTokens,totalTokens:oe.totalTokens}),r.jsx("div",{style:{width:"100%",margin:"0 auto",marginTop:24,background:"rgba(255,255,255,0.95)",borderRadius:16,padding:"16px",boxShadow:"0 2px 12px #6B5BFF22"},children:r.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:20,flexWrap:"wrap"},children:[r.jsx("span",{onClick:()=>n("/about"),style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12,cursor:"pointer"},children:e==="zh-TW"?"🧬 Restarter™｜我們是誰":e==="zh-CN"?"🧬 Restarter™｜我们是谁":e==="en"?"🧬 Restarter™｜Who We Are":e==="ja"?"🧬 Restarter™｜私たちについて":e==="ko"?"🧬 Restarter™｜우리는 누구인가":e==="th"?"🧬 Restarter™｜เราเป็นใคร":e==="vi"?"🧬 Restarter™｜Chúng tôi là ai":e==="ms"?"🧬 Restarter™｜Siapa Kami":"🧬 Restarter™｜Quis sumus"}),r.jsx("span",{onClick:()=>n("/privacy-policy"),style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12,cursor:"pointer"},children:e==="zh-TW"?"隱私權政策":e==="zh-CN"?"隐私政策":e==="en"?"Privacy Policy":e==="ja"?"プライバシーポリシー":e==="ko"?"개인정보 처리방침":e==="th"?"นโยบายความเป็นส่วนตัว":e==="vi"?"Chính sách bảo mật":e==="ms"?"Dasar Privasi":"Consilium de Privata"}),r.jsx("span",{onClick:()=>n("/terms"),style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12,cursor:"pointer"},children:e==="zh-TW"?"條款/聲明":e==="zh-CN"?"条款/声明":e==="en"?"Terms/Statement":e==="ja"?"規約/声明":e==="ko"?"약관/성명":e==="th"?"ข้อกำหนด/แถลงการณ์":e==="vi"?"Điều khoản/Tuyên bố":e==="ms"?"Terma/Pernyataan":"Termini/Declaratio"}),r.jsx("span",{onClick:()=>n("/data-deletion"),style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12,cursor:"pointer"},children:e==="zh-TW"?"資料刪除說明":e==="zh-CN"?"数据删除说明":e==="en"?"Data Deletion":e==="ja"?"データ削除について":e==="ko"?"데이터 삭제 안내":e==="th"?"คำอธิบายการลบข้อมูล":e==="vi"?"Giải thích xóa dữ liệu":e==="ms"?"Penjelasan Penghapusan Data":"Explicatio Deletionis Datae"}),r.jsx("span",{onClick:()=>n("/feedback"),style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12,cursor:"pointer"},children:e==="zh-TW"?"💬 意見箱｜我們想聽你說":e==="zh-CN"?"💬 意见箱｜我们想听你说":e==="en"?"💬 Feedback Box｜We Want to Hear From You":e==="ja"?"💬 ご意見箱｜私たちはあなたの声を聞きたい":e==="ko"?"💬 피드백｜우리는 당신의 말을 듣고 싶습니다":e==="th"?"💬 กล่องความคิดเห็น｜เราอยากได้ยินจากคุณ":e==="vi"?"💬 Hộp góp ý｜Chúng tôi muốn nghe từ bạn":e==="ms"?"💬 Kotak Maklum Balas｜Kami Ingin Mendengar Dari Anda":"💬 Arca Consilii｜Volumus Audire a Te"})]})})]})}const Cw=({isOpen:n,onClose:e,featureName:t})=>{const i=$e(),s=window.innerWidth<=768;if(!n)return null;const o={basic:{price:"NT$ 149",tokens:"50K",features:["語音功能","AI 聊天","語音轉文字","文字轉語音","用戶互動: 100次/月"]}},a=()=>{e(),i("/plans")};return r.jsx("div",{style:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",background:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e4},children:r.jsxs("div",{style:{background:"#fff",borderRadius:20,padding:s?16:32,maxWidth:480,width:"90%",textAlign:"center",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.2)"},children:[!s&&r.jsx("div",{style:{fontSize:48,marginBottom:16,color:"#6B5BFF"},children:"🚀"}),r.jsxs("h2",{style:{fontSize:s?18:24,fontWeight:700,color:"#333",marginBottom:s?6:12},children:["升級方案，解鎖 ",t]}),r.jsxs("p",{style:{fontSize:s?12:16,color:"#666",marginBottom:s?12:20,lineHeight:1.4},children:["您目前使用的是免費方案，",t," 需要升級才能使用。"]}),r.jsxs("div",{style:{background:"linear-gradient(135deg, #f8f9ff 0%, #e8f4ff 100%)",borderRadius:12,padding:s?12:16,marginBottom:s?16:24,border:"1px solid #e0e8ff"},children:[r.jsx("div",{style:{fontSize:s?12:14,color:"#6B5BFF",fontWeight:600,marginBottom:s?6:8},children:"📊 方案對比"}),r.jsxs("div",{style:{fontSize:s?11:13,color:"#666",lineHeight:1.3},children:["• 免費方案：僅限文字功能",r.jsx("br",{}),"• 付費方案：解鎖語音、AI 聊天等進階功能",r.jsx("br",{}),"• 立即升級：享受完整功能體驗"]})]}),r.jsxs("div",{style:{background:"#fff",borderRadius:12,padding:s?14:20,marginBottom:s?16:24,border:"2px solid #6B5BFF",boxShadow:"0 2px 8px #6B5BFF22"},children:[r.jsx("div",{style:{fontSize:s?14:16,color:"#6B5BFF",fontWeight:700,marginBottom:s?8:12},children:"💡 推薦方案"}),r.jsxs("div",{style:{fontSize:s?12:14,color:"#666",lineHeight:1.4,marginBottom:s?12:16},children:[r.jsx("strong",{children:"基礎版："}),"最受歡迎的入門方案",r.jsx("br",{}),"包含 ",o.basic.tokens," tokens，",o.basic.features.join("、")]}),r.jsx("div",{style:{fontSize:s?16:18,fontWeight:700,color:"#6B5BFF"},children:o.basic.price})]}),r.jsxs("div",{style:{background:"linear-gradient(135deg, #fff3cd 0%, #ffeaa7 100%)",borderRadius:12,padding:s?12:16,marginBottom:s?16:24,border:"1px solid #ffeaa7"},children:[r.jsx("div",{style:{fontSize:s?12:14,color:"#856404",fontWeight:600,marginBottom:s?6:8},children:"✨ 升級好處"}),r.jsxs("div",{style:{fontSize:s?11:13,color:"#856404",lineHeight:1.3},children:["• 立即解鎖 ",t,r.jsx("br",{}),"• 享受完整的 AI 體驗",r.jsx("br",{}),"• 無限制使用語音功能",r.jsx("br",{}),"• 優先技術支援"]})]}),r.jsxs("div",{style:{display:"flex",gap:s?8:12,justifyContent:"center"},children:[r.jsx("button",{onClick:a,style:{background:"linear-gradient(135deg, #6B5BFF 0%, #00CFFF 100%)",color:"#fff",border:"none",borderRadius:12,padding:s?"12px 20px":"14px 28px",fontSize:s?14:16,fontWeight:700,cursor:"pointer",flex:1,boxShadow:"0 4px 12px #6B5BFF33",transition:"all 0.3s ease"},onMouseEnter:l=>{l.currentTarget.style.transform="translateY(-2px)",l.currentTarget.style.boxShadow="0 6px 16px #6B5BFF44"},onMouseLeave:l=>{l.currentTarget.style.transform="translateY(0)",l.currentTarget.style.boxShadow="0 4px 12px #6B5BFF33"},children:"🚀 立即升級"}),r.jsx("button",{onClick:e,style:{background:"#f8f9ff",color:"#6B5BFF",border:"2px solid #6B5BFF",borderRadius:12,padding:s?"12px 20px":"14px 28px",fontSize:s?14:16,fontWeight:600,cursor:"pointer",flex:1,transition:"all 0.3s ease"},onMouseEnter:l=>{l.currentTarget.style.background="#6B5BFF",l.currentTarget.style.color="#fff"},onMouseLeave:l=>{l.currentTarget.style.background="#f8f9ff",l.currentTarget.style.color="#6B5BFF"},children:"💫 稍後再說"})]}),r.jsx("div",{style:{marginTop:16},children:r.jsx("button",{onClick:e,style:{background:"none",border:"none",color:"#888",fontSize:14,cursor:"pointer",textDecoration:"underline"},children:"稍後再說"})})]})})},Uf={"zh-TW":{title:"我的故事 My Story",subtitle:"記錄你的成長歷程，見證改變的每一步",backToHome:"← 返回首頁",logout:"登出",addMilestone:"添加里程碑",editMilestone:"編輯里程碑",deleteMilestone:"刪除里程碑",save:"保存",cancel:"取消",totalDays:"總天數",achievements:"成就",currentStreak:"連續",days:"天",myMilestones:"我的里程碑",noMilestones:"還沒有里程碑，開始記錄你的故事吧！",socialIntegration:"社會融入度評估",socialIntegrationTitle:"社會融入度評估",socialIntegrationDesc:"評估你在社會中的融入程度，包括人際關係、就業狀況、家庭關係等",socialIntegrationQuestions:{q1:"你覺得與他人的關係如何？",q2:"你對目前的工作/學習狀況滿意嗎？",q3:"你與家人的關係如何？",q4:"你對未來有信心嗎？",q5:"你覺得社會對你的接納程度如何？"},socialIntegrationOptions:{excellent:"非常好",good:"良好",fair:"一般",poor:"需要改善"},milestoneTypes:{start:"開始",achievement:"成就",growth:"成長",habit:"習慣",help:"幫助",goal:"目標",social:"社會融入"}},"zh-CN":{title:"我的故事 My Story",subtitle:"记录你的成长历程，见证改变的每一步",backToHome:"← 返回首页",logout:"登出",addMilestone:"添加里程碑",editMilestone:"编辑里程碑",deleteMilestone:"删除里程碑",save:"保存",cancel:"取消",totalDays:"总天数",achievements:"成就",currentStreak:"连续",days:"天",myMilestones:"我的里程碑",noMilestones:"还没有里程碑，开始记录你的故事吧！",socialIntegration:"社会融入度评估",socialIntegrationTitle:"社会融入度评估",socialIntegrationDesc:"评估你在社会中的融入程度，包括人际关系、就业状况、家庭关系等",socialIntegrationQuestions:{q1:"你觉得与他人的关系如何？",q2:"你对目前的工作/学习状况满意吗？",q3:"你与家人的关系如何？",q4:"你对未来有信心吗？",q5:"你觉得社会对你的接纳程度如何？"},socialIntegrationOptions:{excellent:"非常好",good:"良好",fair:"一般",poor:"需要改善"},milestoneTypes:{start:"开始",achievement:"成就",growth:"成长",habit:"习惯",help:"帮助",goal:"目标",social:"社会融入"}},en:{title:"My Story",subtitle:"Record your growth journey, witness every step of change",backToHome:"← Back to Home",logout:"Logout",addMilestone:"Add Milestone",editMilestone:"Edit Milestone",deleteMilestone:"Delete Milestone",save:"Save",cancel:"Cancel",totalDays:"Total Days",achievements:"Achievements",currentStreak:"Current Streak",days:"days",myMilestones:"My Milestones",noMilestones:"No milestones yet, start recording your story!",socialIntegration:"Social Integration Assessment",socialIntegrationTitle:"Social Integration Assessment",socialIntegrationDesc:"Assess your level of social integration, including relationships, employment status, family relationships, etc.",socialIntegrationQuestions:{q1:"How do you feel about your relationships with others?",q2:"Are you satisfied with your current work/study situation?",q3:"How are your relationships with family?",q4:"Do you have confidence in the future?",q5:"How do you feel about society's acceptance of you?"},socialIntegrationOptions:{excellent:"Excellent",good:"Good",fair:"Fair",poor:"Needs Improvement"},milestoneTypes:{start:"Start",achievement:"Achievement",growth:"Growth",habit:"Habit",help:"Help",goal:"Goal",social:"Social Integration"}},ja:{title:"マイストーリー",subtitle:"成長の旅を記録し、変化の一歩一歩を目撃する",backToHome:"← ホームに戻る",logout:"ログアウト",addMilestone:"マイルストーンを追加",editMilestone:"マイルストーンを編集",deleteMilestone:"マイルストーンを削除",save:"保存",cancel:"キャンセル",totalDays:"総日数",achievements:"達成",currentStreak:"連続",days:"日",myMilestones:"マイマイルストーン",noMilestones:"まだマイルストーンがありません。ストーリーを記録し始めましょう！",socialIntegration:"社会的統合度評価",socialIntegrationTitle:"社会的統合度評価",socialIntegrationDesc:"人間関係、就業状況、家族関係などを含む社会的統合度を評価する",socialIntegrationQuestions:{q1:"他者との関係をどう感じていますか？",q2:"現在の仕事/学習状況に満足していますか？",q3:"家族との関係はどうですか？",q4:"将来に自信がありますか？",q5:"社会からの受け入れられ方をどう感じていますか？"},socialIntegrationOptions:{excellent:"非常に良い",good:"良い",fair:"普通",poor:"改善が必要"},milestoneTypes:{start:"開始",achievement:"達成",growth:"成長",habit:"習慣",help:"支援",goal:"目標",social:"社会的統合"}},ko:{title:"내 이야기",subtitle:"성장 여정을 기록하고 변화의 모든 단계를 목격하세요",backToHome:"← 홈으로",logout:"로그아웃",addMilestone:"마일스톤 추가",editMilestone:"마일스톤 편집",deleteMilestone:"마일스톤 삭제",save:"저장",cancel:"취소",totalDays:"총 일수",achievements:"성취",currentStreak:"연속",days:"일",myMilestones:"내 마일스톤",noMilestones:"아직 마일스톤이 없습니다. 이야기를 기록하기 시작하세요!",socialIntegration:"사회 통합도 평가",socialIntegrationTitle:"사회 통합도 평가",socialIntegrationDesc:"인간관계, 고용상태, 가족관계 등을 포함한 사회 통합도를 평가하세요",socialIntegrationQuestions:{q1:"다른 사람과의 관계를 어떻게 느끼나요?",q2:"현재의 일/학습 상황에 만족하나요?",q3:"가족과의 관계는 어떠한가요?",q4:"미래에 대한 자신감이 있나요?",q5:"사회로부터의 수용도를 어떻게 느끼나요?"},socialIntegrationOptions:{excellent:"매우 좋음",good:"좋음",fair:"보통",poor:"개선 필요"},milestoneTypes:{start:"시작",achievement:"성취",growth:"성장",habit:"습관",help:"도움",goal:"목표",social:"사회 통합"}},th:{title:"เรื่องราวของฉัน",subtitle:"บันทึกการเดินทางแห่งการเติบโต เป็นพยานทุกก้าวของการเปลี่ยนแปลง",backToHome:"← กลับหน้าหลัก",logout:"ออกจากระบบ",addMilestone:"เพิ่มจุดหมาย",editMilestone:"แก้ไขจุดหมาย",deleteMilestone:"ลบจุดหมาย",save:"บันทึก",cancel:"ยกเลิก",totalDays:"จำนวนวันทั้งหมด",achievements:"ความสำเร็จ",currentStreak:"ต่อเนื่อง",days:"วัน",myMilestones:"จุดหมายของฉัน",noMilestones:"ยังไม่มีจุดหมาย เริ่มบันทึกเรื่องราวของคุณเลย!",socialIntegration:"การประเมินการรวมตัวทางสังคม",socialIntegrationTitle:"การประเมินการรวมตัวทางสังคม",socialIntegrationDesc:"ประเมินระดับการรวมตัวทางสังคมของคุณ รวมถึงความสัมพันธ์ สถานะการจ้างงาน ความสัมพันธ์ในครอบครัว",socialIntegrationQuestions:{q1:"คุณรู้สึกอย่างไรกับความสัมพันธ์กับผู้อื่น?",q2:"คุณพอใจกับสถานการณ์การทำงาน/การเรียนปัจจุบันหรือไม่?",q3:"ความสัมพันธ์กับครอบครัวเป็นอย่างไร?",q4:"คุณมีความมั่นใจในอนาคตหรือไม่?",q5:"คุณรู้สึกอย่างไรกับการยอมรับจากสังคม?"},socialIntegrationOptions:{excellent:"ดีมาก",good:"ดี",fair:"ปานกลาง",poor:"ต้องปรับปรุง"},milestoneTypes:{start:"เริ่มต้น",achievement:"ความสำเร็จ",growth:"การเติบโต",habit:"นิสัย",help:"ความช่วยเหลือ",goal:"เป้าหมาย",social:"การรวมตัวทางสังคม"}},vi:{title:"Câu chuyện của tôi",subtitle:"Ghi lại hành trình phát triển, chứng kiến từng bước thay đổi",backToHome:"← Về trang chủ",logout:"Đăng xuất",addMilestone:"Thêm cột mốc",editMilestone:"Chỉnh sửa cột mốc",deleteMilestone:"Xóa cột mốc",save:"Lưu",cancel:"Hủy",totalDays:"Tổng số ngày",achievements:"Thành tựu",currentStreak:"Liên tiếp",days:"ngày",myMilestones:"Cột mốc của tôi",noMilestones:"Chưa có cột mốc nào, hãy bắt đầu ghi lại câu chuyện của bạn!",socialIntegration:"Đánh giá hòa nhập xã hội",socialIntegrationTitle:"Đánh giá hòa nhập xã hội",socialIntegrationDesc:"Đánh giá mức độ hòa nhập xã hội của bạn, bao gồm các mối quan hệ, tình trạng việc làm, mối quan hệ gia đình",socialIntegrationQuestions:{q1:"Bạn cảm thấy thế nào về mối quan hệ với người khác?",q2:"Bạn có hài lòng với tình hình công việc/học tập hiện tại không?",q3:"Mối quan hệ với gia đình như thế nào?",q4:"Bạn có tự tin về tương lai không?",q5:"Bạn cảm thấy thế nào về sự chấp nhận từ xã hội?"},socialIntegrationOptions:{excellent:"Rất tốt",good:"Tốt",fair:"Bình thường",poor:"Cần cải thiện"},milestoneTypes:{start:"Bắt đầu",achievement:"Thành tựu",growth:"Phát triển",habit:"Thói quen",help:"Hỗ trợ",goal:"Mục tiêu",social:"Hòa nhập xã hội"}},ms:{title:"Cerita Saya",subtitle:"Rakam perjalanan pertumbuhan anda, saksikan setiap langkah perubahan",backToHome:"← Kembali ke Laman Utama",logout:"Log keluar",addMilestone:"Tambah Pencapaian",editMilestone:"Edit Pencapaian",deleteMilestone:"Padam Pencapaian",save:"Simpan",cancel:"Batal",totalDays:"Jumlah Hari",achievements:"Pencapaian",currentStreak:"Berturut-turut",days:"hari",myMilestones:"Pencapaian Saya",noMilestones:"Belum ada pencapaian, mulakan rakam cerita anda!",socialIntegration:"Penilaian Integrasi Sosial",socialIntegrationTitle:"Penilaian Integrasi Sosial",socialIntegrationDesc:"Nilai tahap integrasi sosial anda, termasuk hubungan, status pekerjaan, hubungan keluarga",socialIntegrationQuestions:{q1:"Bagaimana perasaan anda tentang hubungan dengan orang lain?",q2:"Adakah anda berpuas hati dengan situasi kerja/pembelajaran semasa?",q3:"Bagaimana hubungan anda dengan keluarga?",q4:"Adakah anda yakin dengan masa hadapan?",q5:"Bagaimana perasaan anda tentang penerimaan masyarakat?"},socialIntegrationOptions:{excellent:"Sangat Baik",good:"Baik",fair:"Sederhana",poor:"Perlu Penambahbaikan"},milestoneTypes:{start:"Mula",achievement:"Pencapaian",growth:"Pertumbuhan",habit:"Tabiat",help:"Bantuan",goal:"Matlamat",social:"Integrasi Sosial"}},la:{title:"Fabula Mea",subtitle:"Iter incrementi tuum inscribe, mutationis gradum quemque testare",backToHome:"← Redi ad domum",logout:"Exire",addMilestone:"Addere Lapidem Milliarium",editMilestone:"Lapidem Milliarium Edere",deleteMilestone:"Lapidem Milliarium Delere",save:"Servare",cancel:"Cancellare",totalDays:"Dies Totales",achievements:"Res Gestae",currentStreak:"Series",days:"dies",myMilestones:"Lapides Milliarii Mei",noMilestones:"Nondum lapides milliarii, incipe fabulam tuam inscribere!",socialIntegration:"Aestimatio Integrationis Socialis",socialIntegrationTitle:"Aestimatio Integrationis Socialis",socialIntegrationDesc:"Aestima gradum integrationis socialis tuae, includens relationes, statum operis, relationes familiae",socialIntegrationQuestions:{q1:"Quomodo sentis de relationibus cum aliis?",q2:"Esne contentus cum statu operis/studii praesenti?",q3:"Quomodo sunt relationes tuae cum familia?",q4:"Habesne fiduciam in futuro?",q5:"Quomodo sentis de acceptatione societatis?"},socialIntegrationOptions:{excellent:"Optime",good:"Bene",fair:"Mediocriter",poor:"Emendatione Opus"},milestoneTypes:{start:"Initiare",achievement:"Res Gesta",growth:"Incrementum",habit:"Consuetudo",help:"Auxilium",goal:"Propositum",social:"Integratio Socialis"}}};function SE(){const n=$e(),{lang:e,setLang:t}=Qe(),i=Uf[e]||Uf["zh-TW"],{isTestMode:s}=ji(),o=async()=>{try{const U=Je().currentUser;if(U){const N=Ba(),V=Ot(N,"profiles",U.uid),he=await fi(V);if(he.exists()){const fe=he.data();fe.avatar&&te(fe.avatar)}}}catch(G){console.error("獲取用戶頭像失敗:",G)}},[a,l]=g.useState(()=>{const G=localStorage.getItem("userMilestones");return G?JSON.parse(G):[{id:1,title:"開始新的旅程",description:"決定重新開始，為自己設定新的目標",date:new Date(Date.now()-30*24*60*60*1e3).toISOString(),type:"start",completed:!0},{id:2,title:"完成第一個小目標",description:"成功完成了一項小任務，感覺很棒",date:new Date(Date.now()-25*24*60*60*1e3).toISOString(),type:"achievement",completed:!0},{id:3,title:"學會控制情緒",description:"在困難時刻保持冷靜，學會了情緒管理",date:new Date(Date.now()-20*24*60*60*1e3).toISOString(),type:"growth",completed:!0},{id:4,title:"建立新的習慣",description:"每天堅持做一些小事情，建立正向習慣",date:new Date(Date.now()-15*24*60*60*1e3).toISOString(),type:"habit",completed:!0},{id:5,title:"幫助他人",description:"第一次主動幫助別人，感受到付出的快樂",date:new Date(Date.now()-10*24*60*60*1e3).toISOString(),type:"help",completed:!0},{id:6,title:"設定更大的目標",description:"為自己設定更具挑戰性的目標",date:new Date(Date.now()+5*24*60*60*1e3).toISOString(),type:"goal",completed:!1}]}),[c]=g.useState({name:"我的故事",startDate:new Date(Date.now()-30*24*60*60*1e3),totalDays:30,achievements:5,currentStreak:7}),[u,h]=g.useState(!1),[p,f]=g.useState(!1),[b,x]=g.useState(!1),[S,w]=g.useState(null),[I,j]=g.useState(null),[A,D]=g.useState({title:"",description:"",type:"achievement"}),[O,P]=g.useState(!1),[B,k]=g.useState(!1),[T,R]=g.useState(0),[E,_]=g.useState(null),[v,z]=g.useState(!1),[H,L]=g.useState(!1),[ee,ge]=g.useState(null),[oe,Ie]=g.useState(null),[Re,te]=g.useState("/avatars/Derxl.png"),[W,Y]=g.useState([]),X=g.useRef([]),{checkPermission:le,recordUsage:be}=mo(),[ve,Me]=g.useState(!1),[Ve,ie]=g.useState(!1),[$,We]=g.useState(null);g.useEffect(()=>{o()},[]);const _e=G=>{localStorage.setItem("userMilestones",JSON.stringify(G))},ye=()=>{if(A.title.trim()&&A.description.trim()){const U=[{id:Date.now(),title:A.title,description:A.description,date:new Date().toISOString(),type:A.type,completed:!1},...a];l(U),_e(U),D({title:"",description:"",type:"achievement"}),h(!1)}},J=G=>{j(G),D({title:G.title,description:G.description,type:G.type})},pe=()=>{if(I&&A.title.trim()&&A.description.trim()){const G=a.map(U=>U.id===I.id?{...U,title:A.title,description:A.description,type:A.type}:U);l(G),_e(G),j(null),D({title:"",description:"",type:"achievement"})}},ce=G=>{if(window.confirm(`🌟 親愛的朋友，您真的要刪除這個里程碑嗎？

💫 每個里程碑都記錄著您成長的足跡，刪除後就無法找回囉～

✨ 如果您確定要刪除，我們會溫柔地幫您處理。`)){const U=a.filter(N=>N.id!==G);l(U),_e(U)}},me=async()=>{if(B){ee&&ee.state==="recording"&&ee.stop(),oe&&(clearInterval(oe),Ie(null)),k(!1),P(!1),R(0);return}const G=await le("aiChat");if(!G.allowed){if(s)return;G.isFreeUser?ie(!0):(G.canRenew,We(G),Me(!0));return}L(!0)},xe=async()=>{L(!1);try{const G=await navigator.mediaDevices.getUserMedia({audio:!0}),U=new MediaRecorder(G,{mimeType:"audio/webm;codecs=opus"});Y([]),X.current=[],R(0),U.ondataavailable=V=>{console.log("收到音頻數據，大小:",V.data.size),V.data.size>0&&(X.current.push(V.data),Y(he=>{const fe=[...he,V.data];return console.log("更新音頻塊，當前數量:",fe.length),fe}))},U.onstop=()=>{const V=[...X.current];console.log("錄音停止，音頻塊數量:",V.length);const he=V.length>0?new Blob(V,{type:"audio/webm"}):new Blob([""],{type:"audio/webm"}),fe=Math.max(1,Math.floor(V.length*.1));console.log("創建音頻blob，大小:",he.size,"估算錄音時長:",fe),_({blob:he,duration:fe}),z(!0),Y([]),X.current=[],console.log("設置送出對話框狀態"),G.getTracks().forEach(ze=>ze.stop())},U.start(100),ge(U),k(!0),P(!0);const N=setInterval(()=>{R(V=>{const he=V+1;return he>=60&&(ee&&ee.state==="recording"&&ee.stop(),N&&(clearInterval(N),Ie(null)),k(!1),P(!1),alert("錄音時間已達1分鐘限制，已自動停止錄音")),he})},1e3);Ie(N)}catch(G){console.error("錄音錯誤:",G),alert("無法啟動麥克風，請檢查權限設置")}},M=()=>{L(!1)},q=()=>{E&&(Ct(E.blob,E.duration),_(null),z(!1),be("aiChat",1))},F=()=>{_(null),z(!1)},[we,Ne]=g.useState({q1:"",q2:"",q3:"",q4:"",q5:""}),Fe=G=>{const U={excellent:5,good:4,fair:3,poor:2},he=[U[G.q1]||3,U[G.q2]||3,U[G.q3]||3,U[G.q4]||3,U[G.q5]||3].reduce((fe,ze)=>fe+ze,0)/5;return he>=4.5?{score:he,result:"優秀",description:"你的社會融入度非常高，在人際關係、就業狀況、家庭關係等方面都表現出色。",recommendations:["繼續保持現有的良好狀態","可以考慮擔任志工幫助其他更生人","分享你的成功經驗給其他需要幫助的人","參與社區活動擴大影響力"],analysis:"基於你的評估結果，你在各個方面都表現優秀，顯示出良好的社會適應能力和積極的生活態度。建議繼續保持這種狀態，並可以考慮幫助其他需要支持的人。"}:he>=3.5?{score:he,result:"良好",description:"你的社會融入度良好，在大部分方面都有不錯的表現，還有提升空間。",recommendations:["參加更多社交活動擴大交友圈","尋求職業技能培訓提升就業競爭力","與家人多溝通改善家庭關係","制定具體的個人發展計劃"],analysis:"你的社會融入度處於良好水平，顯示出積極的改善趨勢。建議在現有基礎上進一步提升，特別是在就業技能和人際關係方面。"}:he>=2.5?{score:he,result:"一般",description:"你的社會融入度一般，在某些方面需要改善，建議尋求更多支持。",recommendations:["建議尋求專業輔導師協助","參加更生人互助團體","制定具體的改善計劃","逐步建立支持網絡"],analysis:"你的社會融入度處於一般水平，這表明在某些方面還需要改善。建議尋求專業支持，制定具體的改善計劃，並逐步建立支持網絡。"}:{score:he,result:"需要改善",description:"你的社會融入度需要改善，建議尋求專業輔導和支持。",recommendations:["立即聯繫專業輔導師","參加更生人支持計劃","尋求心理諮商服務","建立穩定的生活規律"],analysis:"你的社會融入度需要改善，建議立即尋求專業輔導和支持。這不是失敗，而是需要更多幫助的表現。專業輔導師可以幫助你制定適合的改善計劃。"}},Ue=()=>{if(!Object.values(we).every(fe=>fe!=="")){alert("請回答所有問題");return}const U=Fe(we),N={score:U.score,result:U.result,description:U.description,recommendations:U.recommendations,analysis:U.analysis,details:{relationships:we.q1,employment:we.q2,family:we.q3,confidence:we.q4,acceptance:we.q5}},he=[{id:Date.now(),title:`${i.socialIntegrationTitle} - ${U.result}`,description:`${U.description} 評估分數: ${U.score.toFixed(1)}/5.0

分析：
${U.analysis}

建議：
${U.recommendations.map(fe=>`• ${fe}`).join(`
`)}`,date:new Date().toISOString(),type:"social",completed:!0},...a];l(he),_e(he),Ne({q1:"",q2:"",q3:"",q4:"",q5:""}),f(!1),x(!0),w(N)},Ct=(G,U)=>{const N=URL.createObjectURL(G),V=["今天完成了一個重要目標，感覺很有成就感。","學會了新的技能，為自己的成長感到驕傲。","克服了困難，證明了自己的能力。","幫助了別人，感受到付出的快樂。","建立了新的習慣，為未來打下基礎。"],he=V[Math.floor(Math.random()*V.length)],fe=["achievement","growth","habit","help","goal"][Math.floor(Math.random()*5)],Ce=[{id:Date.now(),title:"語音里程碑",description:he,date:new Date().toISOString(),type:fe,completed:!0,audioUrl:N,duration:U},...a];l(Ce),_e(Ce)},ae=G=>({start:"#2196F3",achievement:"#4CAF50",growth:"#9C27B0",habit:"#FF9800",help:"#E91E63",goal:"#F44336",social:"#6B5BFF"})[G]||"#9E9E9E",Be=G=>new Date(G).toLocaleString("zh-TW",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}),ct=G=>{if(G.audioUrl){const U=new Audio(G.audioUrl);U.onerror=N=>{console.error("音頻加載失敗:",N),et(G.description)},U.play().then(()=>{console.log("正在播放原音...")}).catch(N=>{console.error("播放失敗:",N),et(G.description)})}else et(G.description)},et=G=>{if("speechSynthesis"in window){const U=new SpeechSynthesisUtterance(G);U.lang="zh-TW",U.rate=.9,U.pitch=1,window.speechSynthesis.cancel(),window.speechSynthesis.speak(U),console.log("正在播放里程碑內容（文字轉語音）...")}else alert("瀏覽器不支援語音播放功能")},ot=a.filter(G=>G.completed).length,ne=()=>{Me(!1),We(null)};return r.jsxs("div",{style:{minHeight:"100vh",background:"linear-gradient(135deg, #4CAF50 0%, #8BC34A 100%)",padding:"20px"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"30px"},children:[r.jsx("button",{onClick:()=>n("/home"),style:{background:"#fff",border:"1.5px solid #6B5BFF",borderRadius:"8px",padding:"6px 10px",color:"#6B5BFF",cursor:"pointer",fontSize:"16px",fontWeight:"600",transition:"all 0.3s ease"},children:i.backToHome}),r.jsx("h1",{style:{color:"white",fontSize:"24px",fontWeight:"bold",margin:0,marginBottom:"8px"},children:i.myMilestones}),r.jsx("p",{style:{color:"rgba(255,255,255,0.8)",fontSize:"14px",fontWeight:400,margin:0,textAlign:"center",lineHeight:1.4},children:i.subtitle}),r.jsxs("div",{style:{display:"flex",gap:"10px"},children:[r.jsx("button",{onClick:()=>n("/logout"),style:{background:"#fff",border:"1.5px solid #6B5BFF",borderRadius:"8px",padding:"6px 10px",color:"#6B5BFF",cursor:"pointer",fontSize:"16px",fontWeight:"600",transition:"all 0.3s ease"},children:i.logout}),r.jsx(en,{})]})]}),r.jsxs("div",{style:{maxWidth:"800px",margin:"0 auto"},children:[r.jsxs("div",{style:{background:"rgba(255,255,255,0.95)",borderRadius:"20px",padding:"24px",marginBottom:"24px",boxShadow:"0 8px 32px rgba(0,0,0,0.1)"},children:[r.jsxs("div",{style:{textAlign:"center",marginBottom:"20px"},children:[r.jsxs("div",{style:{width:"70px",height:"70px",borderRadius:"50%",background:"white",display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto 12px",boxShadow:"0 4px 16px rgba(0,0,0,0.1)",overflow:"hidden"},children:[r.jsx("img",{src:Re,alt:"用戶頭像",style:{width:"100%",height:"100%",objectFit:"cover",borderRadius:"50%"},onError:G=>{const U=G.currentTarget;U.style.display="none";const N=U.nextElementSibling;N&&(N.style.display="flex")}}),r.jsx("span",{style:{fontSize:"35px",color:"#4CAF50",display:"none",position:"absolute"},children:"👤"})]}),r.jsx("h2",{style:{color:"#333",fontSize:"22px",fontWeight:"bold",marginBottom:"6px"},children:e==="zh-TW"||e==="zh-CN"?"里程碑":e==="en"?"Milestone":e==="ja"?"マイルストーン":e==="ko"?"마일스톤":e==="th"?"จุดหมาย":e==="vi"?"Cột mốc":e==="ms"?"Pencapaian":"Lapis Milliarius"}),r.jsxs("p",{style:{color:"#666",fontSize:"13px",marginBottom:"20px"},children:["開始於 ",c.startDate.toLocaleDateString("zh-TW")]})]}),r.jsxs("div",{style:{display:"flex",justifyContent:"space-around"},children:[r.jsxs("div",{style:{textAlign:"center"},children:[r.jsx("div",{style:{fontSize:"22px",fontWeight:"bold",color:"#4CAF50",marginBottom:"3px"},children:c.totalDays}),r.jsx("div",{style:{fontSize:"11px",color:"#666"},children:i.totalDays})]}),r.jsxs("div",{style:{textAlign:"center"},children:[r.jsx("div",{style:{fontSize:"22px",fontWeight:"bold",color:"#FF9800",marginBottom:"3px"},children:ot}),r.jsx("div",{style:{fontSize:"11px",color:"#666"},children:i.achievements})]}),r.jsxs("div",{style:{textAlign:"center"},children:[r.jsx("div",{style:{fontSize:"22px",fontWeight:"bold",color:"#2196F3",marginBottom:"3px"},children:c.currentStreak}),r.jsxs("div",{style:{fontSize:"11px",color:"#666"},children:[i.currentStreak," ",i.days]})]})]})]}),r.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:"16px",marginBottom:"24px",flexWrap:"wrap"},children:[r.jsxs("button",{onClick:()=>h(!0),style:{background:"linear-gradient(135deg, #2196F3 0%, #1976D2 100%)",border:"none",borderRadius:"16px",padding:"12px 24px",color:"white",cursor:"pointer",fontSize:"16px",fontWeight:"600",boxShadow:"0 4px 16px rgba(33, 150, 243, 0.3)",transition:"all 0.3s ease",display:"flex",alignItems:"center",gap:"8px"},onMouseOver:G=>{G.currentTarget.style.transform="translateY(-2px)",G.currentTarget.style.boxShadow="0 6px 20px rgba(33, 150, 243, 0.4)"},onMouseOut:G=>{G.currentTarget.style.transform="translateY(0)",G.currentTarget.style.boxShadow="0 4px 16px rgba(33, 150, 243, 0.3)"},children:[r.jsx("span",{style:{fontSize:"18px"},children:"+"}),i.addMilestone]}),r.jsxs("button",{onClick:me,style:{background:O?"linear-gradient(135deg, #f44336 0%, #d32f2f 100%)":"linear-gradient(135deg, #2196F3 0%, #1976D2 100%)",border:"none",borderRadius:"16px",padding:"12px 24px",color:"white",cursor:"pointer",fontSize:"16px",fontWeight:"600",boxShadow:O?"0 4px 16px rgba(244, 67, 54, 0.3)":"0 4px 16px rgba(33, 150, 243, 0.3)",transition:"all 0.3s ease",display:"flex",alignItems:"center",gap:"8px",animation:O?"pulse 1.5s infinite":"none"},onMouseOver:G=>{O||(G.currentTarget.style.transform="translateY(-2px)",G.currentTarget.style.boxShadow="0 6px 20px rgba(33, 150, 243, 0.4)")},onMouseOut:G=>{O||(G.currentTarget.style.transform="translateY(0)",G.currentTarget.style.boxShadow="0 4px 16px rgba(33, 150, 243, 0.3)")},children:[r.jsx("span",{style:{fontSize:"18px"},children:"🎤"}),O?`${e==="zh-TW"?"錄音中":e==="zh-CN"?"录音中":e==="en"?"Recording":e==="ja"?"録音中":e==="ko"?"녹음 중":e==="th"?"กำลังบันทึก":e==="vi"?"Đang ghi âm":e==="ms"?"Sedang Merakam":"Recording"} ${Math.floor(T/60)}:${(T%60).toString().padStart(2,"0")}`:e==="zh-TW"?"語音輸入":e==="zh-CN"?"语音输入":e==="en"?"Voice Input":e==="ja"?"音声入力":e==="ko"?"음성 입력":e==="th"?"ป้อนเสียง":e==="vi"?"Nhập giọng nói":e==="ms"?"Input Suara":"Input Vox"]})]}),r.jsx("div",{style:{marginBottom:"30px"},children:a.length===0?r.jsx("div",{style:{background:"rgba(255,255,255,0.95)",borderRadius:"16px",padding:"40px",textAlign:"center",color:"#666"},children:i.noMilestones}):r.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:a.map((G,U)=>r.jsx("div",{style:{background:"rgba(255,255,255,0.95)",borderRadius:"16px",padding:"20px",boxShadow:"0 4px 16px rgba(0,0,0,0.1)",position:"relative"},children:r.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:"16px"},children:[r.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",minWidth:"40px"},children:[r.jsx("div",{style:{width:"20px",height:"20px",borderRadius:"50%",background:G.completed?ae(G.type):"#ddd",display:"flex",alignItems:"center",justifyContent:"center",marginBottom:"8px"},children:G.completed&&r.jsx("span",{style:{color:"white",fontSize:"12px"},children:"✓"})}),U<a.length-1&&r.jsx("div",{style:{width:"2px",height:"40px",background:"#ddd"}})]}),r.jsxs("div",{style:{flex:1},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"8px"},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[r.jsx("span",{style:{background:ae(G.type),color:"white",padding:"4px 8px",borderRadius:"12px",fontSize:"12px",fontWeight:"600"},children:i.milestoneTypes[G.type]}),r.jsx("span",{style:{color:"#999",fontSize:"12px"},children:Be(G.date)})]}),r.jsxs("div",{style:{display:"flex",gap:"8px"},children:[G.title!=="語音里程碑"&&r.jsx("button",{onClick:()=>J(G),style:{background:"#4CAF50",border:"none",borderRadius:"6px",padding:"4px 8px",color:"white",cursor:"pointer",fontSize:"12px"},children:"✏️"}),r.jsx("button",{onClick:()=>ce(G.id),style:{background:"#F44336",border:"none",borderRadius:"6px",padding:"4px 8px",color:"white",cursor:"pointer",fontSize:"12px"},children:"🗑️"})]})]}),r.jsx("h4",{style:{margin:"0 0 8px 0",fontSize:"16px",fontWeight:"600",color:G.completed?"#333":"#666"},children:G.title}),r.jsx("p",{style:{color:"#666",fontSize:"14px",lineHeight:"1.5",margin:0,marginBottom:"8px"},children:G.description}),G.audioUrl&&r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",marginTop:"8px"},children:[r.jsxs("button",{onClick:()=>ct(G),style:{background:"linear-gradient(135deg, #4CAF50 0%, #8BC34A 100%)",border:"none",borderRadius:"8px",padding:"6px 12px",color:"white",cursor:"pointer",fontSize:"12px",fontWeight:"600",display:"flex",alignItems:"center",gap:"4px"},children:[r.jsx("span",{style:{fontSize:"14px"},children:"▶️"}),"播放原音"]}),G.duration&&r.jsxs("span",{style:{color:"#666",fontSize:"12px",background:"#f5f5f5",padding:"4px 8px",borderRadius:"6px"},children:["錄音時長: ",Math.floor(G.duration/60),":",(G.duration%60).toString().padStart(2,"0")]})]})]})]})},G.id))})})]}),u&&r.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:r.jsxs("div",{style:{background:"white",borderRadius:"16px",padding:"30px",width:"90%",maxWidth:"500px"},children:[r.jsx("h3",{style:{marginBottom:"20px",color:"#333"},children:i.addMilestone}),r.jsxs("div",{style:{marginBottom:"16px"},children:[r.jsx("label",{style:{display:"block",marginBottom:"8px",color:"#666"},children:"標題"}),r.jsx("input",{type:"text",value:A.title,onChange:G=>D(U=>({...U,title:G.target.value})),style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid #ddd",fontSize:"14px"},placeholder:"輸入里程碑標題"})]}),r.jsxs("div",{style:{marginBottom:"16px"},children:[r.jsx("label",{style:{display:"block",marginBottom:"8px",color:"#666"},children:"描述"}),r.jsx("textarea",{value:A.description,onChange:G=>D(U=>({...U,description:G.target.value})),style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid #ddd",fontSize:"14px",minHeight:"100px",resize:"vertical"},placeholder:"輸入里程碑描述"})]}),r.jsxs("div",{style:{marginBottom:"20px"},children:[r.jsx("label",{style:{display:"block",marginBottom:"8px",color:"#666"},children:"類型"}),r.jsxs("select",{value:A.type,onChange:G=>D(U=>({...U,type:G.target.value})),style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid #ddd",fontSize:"14px"},children:[r.jsx("option",{value:"start",children:i.milestoneTypes.start}),r.jsx("option",{value:"achievement",children:i.milestoneTypes.achievement}),r.jsx("option",{value:"growth",children:i.milestoneTypes.growth}),r.jsx("option",{value:"habit",children:i.milestoneTypes.habit}),r.jsx("option",{value:"help",children:i.milestoneTypes.help}),r.jsx("option",{value:"goal",children:i.milestoneTypes.goal}),r.jsx("option",{value:"social",children:i.milestoneTypes.social})]})]}),r.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"flex-end"},children:[r.jsx("button",{onClick:()=>h(!1),style:{background:"#f5f5f5",border:"none",borderRadius:"8px",padding:"12px 24px",color:"#666",cursor:"pointer",fontSize:"14px"},children:i.cancel}),r.jsx("button",{onClick:ye,style:{background:"linear-gradient(45deg, #4CAF50, #8BC34A)",border:"none",borderRadius:"8px",padding:"12px 24px",color:"white",cursor:"pointer",fontSize:"14px",fontWeight:"600"},children:i.save})]})]})}),v&&E&&r.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:r.jsxs("div",{style:{background:"white",borderRadius:"16px",padding:"30px",width:"90%",maxWidth:"500px",textAlign:"center"},children:[r.jsx("h3",{style:{marginBottom:"20px",color:"#333"},children:"語音里程碑"}),r.jsxs("div",{style:{marginBottom:"20px"},children:[r.jsxs("p",{style:{color:"#666",marginBottom:"10px"},children:["錄音時長: ",Math.floor(E.duration/60),":",(E.duration%60).toString().padStart(2,"0")]}),r.jsx("audio",{controls:!0,style:{width:"100%",marginBottom:"20px"},src:URL.createObjectURL(E.blob)})]}),r.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"center"},children:[r.jsx("button",{onClick:F,style:{background:"#f5f5f5",border:"none",borderRadius:"8px",padding:"12px 24px",color:"#666",cursor:"pointer",fontSize:"14px",fontWeight:"600"},children:"取消"}),r.jsx("button",{onClick:q,style:{background:"linear-gradient(45deg, #4CAF50, #8BC34A)",border:"none",borderRadius:"8px",padding:"12px 24px",color:"white",cursor:"pointer",fontSize:"14px",fontWeight:"600"},children:"送出"})]})]})}),H&&r.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:r.jsxs("div",{style:{background:"white",borderRadius:"16px",padding:"30px",width:"90%",maxWidth:"500px",textAlign:"center"},children:[r.jsx("div",{style:{fontSize:"48px",marginBottom:"20px"},children:"🎤"}),r.jsx("h3",{style:{marginBottom:"16px",color:"#333",fontSize:"20px",fontWeight:"600"},children:"準備開始錄音"}),r.jsxs("p",{style:{marginBottom:"20px",color:"#666",fontSize:"16px",lineHeight:"1.5"},children:["點擊「開始錄音」後，系統將開始錄製您的語音里程碑。",r.jsx("br",{}),r.jsx("strong",{style:{color:"#ff6b6b"},children:"⚠️ 錄音時間限制為1分鐘"})]}),r.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"center"},children:[r.jsx("button",{onClick:M,style:{background:"#f5f5f5",border:"none",borderRadius:"8px",padding:"12px 24px",color:"#666",cursor:"pointer",fontSize:"14px",fontWeight:"500"},children:"取消"}),r.jsx("button",{onClick:xe,style:{background:"linear-gradient(45deg, #4CAF50, #8BC34A)",border:"none",borderRadius:"8px",padding:"12px 24px",color:"white",cursor:"pointer",fontSize:"14px",fontWeight:"600",boxShadow:"0 4px 12px rgba(76, 175, 80, 0.3)"},children:"開始錄音"})]})]})}),I&&r.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:r.jsxs("div",{style:{background:"white",borderRadius:"16px",padding:"30px",width:"90%",maxWidth:"500px"},children:[r.jsx("h3",{style:{marginBottom:"20px",color:"#333"},children:i.editMilestone}),r.jsxs("div",{style:{marginBottom:"16px"},children:[r.jsx("label",{style:{display:"block",marginBottom:"8px",color:"#666"},children:"標題"}),r.jsx("input",{type:"text",value:A.title,onChange:G=>D(U=>({...U,title:G.target.value})),style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid #ddd",fontSize:"14px"}})]}),r.jsxs("div",{style:{marginBottom:"16px"},children:[r.jsx("label",{style:{display:"block",marginBottom:"8px",color:"#666"},children:"描述"}),r.jsx("textarea",{value:A.description,onChange:G=>D(U=>({...U,description:G.target.value})),style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid #ddd",fontSize:"14px",minHeight:"100px",resize:"vertical"}})]}),r.jsxs("div",{style:{marginBottom:"20px"},children:[r.jsx("label",{style:{display:"block",marginBottom:"8px",color:"#666"},children:"類型"}),r.jsxs("select",{value:A.type,onChange:G=>D(U=>({...U,type:G.target.value})),style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid #ddd",fontSize:"14px"},children:[r.jsx("option",{value:"start",children:i.milestoneTypes.start}),r.jsx("option",{value:"achievement",children:i.milestoneTypes.achievement}),r.jsx("option",{value:"growth",children:i.milestoneTypes.growth}),r.jsx("option",{value:"habit",children:i.milestoneTypes.habit}),r.jsx("option",{value:"help",children:i.milestoneTypes.help}),r.jsx("option",{value:"goal",children:i.milestoneTypes.goal}),r.jsx("option",{value:"social",children:i.milestoneTypes.social})]})]}),r.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"flex-end"},children:[r.jsx("button",{onClick:()=>j(null),style:{background:"#f5f5f5",border:"none",borderRadius:"8px",padding:"12px 24px",color:"#666",cursor:"pointer",fontSize:"14px"},children:i.cancel}),r.jsx("button",{onClick:pe,style:{background:"linear-gradient(45deg, #4CAF50, #8BC34A)",border:"none",borderRadius:"8px",padding:"12px 24px",color:"white",cursor:"pointer",fontSize:"14px",fontWeight:"600"},children:i.save})]})]})}),ve&&$&&r.jsx(es,{isOpen:ve,onClose:ne,currentPlan:$.currentPlan,remainingDays:$.remainingDays,usedTokens:$.usedTokens,totalTokens:$.totalTokens}),Ve&&r.jsx(Cw,{isOpen:Ve,onClose:()=>ie(!1),featureName:"語音錄製功能"}),p&&r.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:r.jsxs("div",{style:{background:"white",borderRadius:"16px",padding:"30px",width:"90%",maxWidth:"600px",maxHeight:"80vh",overflowY:"auto"},children:[r.jsx("h3",{style:{marginBottom:"20px",color:"#333",textAlign:"center"},children:i.socialIntegrationTitle}),r.jsx("p",{style:{marginBottom:"24px",color:"#666",textAlign:"center",lineHeight:"1.5"},children:i.socialIntegrationDesc}),r.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"20px"},children:[r.jsxs("div",{children:[r.jsx("label",{style:{display:"block",marginBottom:"8px",color:"#333",fontWeight:"600"},children:i.socialIntegrationQuestions.q1}),r.jsxs("select",{value:we.q1,onChange:G=>Ne(U=>({...U,q1:G.target.value})),style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid #ddd",fontSize:"14px"},children:[r.jsx("option",{value:"",children:"請選擇..."}),r.jsx("option",{value:"excellent",children:i.socialIntegrationOptions.excellent}),r.jsx("option",{value:"good",children:i.socialIntegrationOptions.good}),r.jsx("option",{value:"fair",children:i.socialIntegrationOptions.fair}),r.jsx("option",{value:"poor",children:i.socialIntegrationOptions.poor})]})]}),r.jsxs("div",{children:[r.jsx("label",{style:{display:"block",marginBottom:"8px",color:"#333",fontWeight:"600"},children:i.socialIntegrationQuestions.q2}),r.jsxs("select",{value:we.q2,onChange:G=>Ne(U=>({...U,q2:G.target.value})),style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid #ddd",fontSize:"14px"},children:[r.jsx("option",{value:"",children:"請選擇..."}),r.jsx("option",{value:"excellent",children:i.socialIntegrationOptions.excellent}),r.jsx("option",{value:"good",children:i.socialIntegrationOptions.good}),r.jsx("option",{value:"fair",children:i.socialIntegrationOptions.fair}),r.jsx("option",{value:"poor",children:i.socialIntegrationOptions.poor})]})]}),r.jsxs("div",{children:[r.jsx("label",{style:{display:"block",marginBottom:"8px",color:"#333",fontWeight:"600"},children:i.socialIntegrationQuestions.q3}),r.jsxs("select",{value:we.q3,onChange:G=>Ne(U=>({...U,q3:G.target.value})),style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid #ddd",fontSize:"14px"},children:[r.jsx("option",{value:"",children:"請選擇..."}),r.jsx("option",{value:"excellent",children:i.socialIntegrationOptions.excellent}),r.jsx("option",{value:"good",children:i.socialIntegrationOptions.good}),r.jsx("option",{value:"fair",children:i.socialIntegrationOptions.fair}),r.jsx("option",{value:"poor",children:i.socialIntegrationOptions.poor})]})]}),r.jsxs("div",{children:[r.jsx("label",{style:{display:"block",marginBottom:"8px",color:"#333",fontWeight:"600"},children:i.socialIntegrationQuestions.q4}),r.jsxs("select",{value:we.q4,onChange:G=>Ne(U=>({...U,q4:G.target.value})),style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid #ddd",fontSize:"14px"},children:[r.jsx("option",{value:"",children:"請選擇..."}),r.jsx("option",{value:"excellent",children:i.socialIntegrationOptions.excellent}),r.jsx("option",{value:"good",children:i.socialIntegrationOptions.good}),r.jsx("option",{value:"fair",children:i.socialIntegrationOptions.fair}),r.jsx("option",{value:"poor",children:i.socialIntegrationOptions.poor})]})]}),r.jsxs("div",{children:[r.jsx("label",{style:{display:"block",marginBottom:"8px",color:"#333",fontWeight:"600"},children:i.socialIntegrationQuestions.q5}),r.jsxs("select",{value:we.q5,onChange:G=>Ne(U=>({...U,q5:G.target.value})),style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid #ddd",fontSize:"14px"},children:[r.jsx("option",{value:"",children:"請選擇..."}),r.jsx("option",{value:"excellent",children:i.socialIntegrationOptions.excellent}),r.jsx("option",{value:"good",children:i.socialIntegrationOptions.good}),r.jsx("option",{value:"fair",children:i.socialIntegrationOptions.fair}),r.jsx("option",{value:"poor",children:i.socialIntegrationOptions.poor})]})]})]}),r.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"center",marginTop:"24px"},children:[r.jsx("button",{onClick:()=>f(!1),style:{background:"#f5f5f5",border:"none",borderRadius:"8px",padding:"12px 24px",color:"#666",cursor:"pointer",fontSize:"14px"},children:i.cancel}),r.jsx("button",{onClick:Ue,disabled:!Object.values(we).every(G=>G!==""),style:{background:Object.values(we).every(G=>G!=="")?"linear-gradient(45deg, #6B5BFF, #5A4FCF)":"#ccc",border:"none",borderRadius:"8px",padding:"12px 24px",color:"white",cursor:Object.values(we).every(G=>G!=="")?"pointer":"not-allowed",fontSize:"14px",fontWeight:"600"},children:"提交評估"})]})]})}),b&&S&&r.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:r.jsxs("div",{style:{background:"white",borderRadius:"16px",padding:"30px",width:"90%",maxWidth:"600px",maxHeight:"80vh",overflowY:"auto"},children:[r.jsx("h3",{style:{marginBottom:"20px",color:"#333",textAlign:"center"},children:"📊 社會融入度評估報告"}),r.jsxs("div",{style:{background:"linear-gradient(135deg, #6B5BFF 0%, #5A4FCF 100%)",borderRadius:"12px",padding:"20px",color:"white",marginBottom:"20px",textAlign:"center"},children:[r.jsx("div",{style:{fontSize:"24px",fontWeight:"bold",marginBottom:"8px"},children:S.result}),r.jsxs("div",{style:{fontSize:"18px",marginBottom:"8px"},children:["總分：",S.score.toFixed(1),"/5.0"]}),r.jsx("div",{style:{fontSize:"14px",opacity:.9},children:S.description})]}),r.jsxs("div",{style:{marginBottom:"20px"},children:[r.jsx("h4",{style:{color:"#333",marginBottom:"12px",fontWeight:"600"},children:"📋 詳細分析"}),r.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"8px",background:"#f8f9fa",borderRadius:"6px"},children:[r.jsx("span",{style:{color:"#666"},children:"人際關係"}),r.jsx("span",{style:{fontWeight:"600",color:"#6B5BFF"},children:S.details.relationships==="excellent"?"優秀":S.details.relationships==="good"?"良好":S.details.relationships==="fair"?"一般":"需要改善"})]}),r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"8px",background:"#f8f9fa",borderRadius:"6px"},children:[r.jsx("span",{style:{color:"#666"},children:"就業狀況"}),r.jsx("span",{style:{fontWeight:"600",color:"#6B5BFF"},children:S.details.employment==="excellent"?"優秀":S.details.employment==="good"?"良好":S.details.employment==="fair"?"一般":"需要改善"})]}),r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"8px",background:"#f8f9fa",borderRadius:"6px"},children:[r.jsx("span",{style:{color:"#666"},children:"家庭關係"}),r.jsx("span",{style:{fontWeight:"600",color:"#6B5BFF"},children:S.details.family==="excellent"?"優秀":S.details.family==="good"?"良好":S.details.family==="fair"?"一般":"需要改善"})]}),r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"8px",background:"#f8f9fa",borderRadius:"6px"},children:[r.jsx("span",{style:{color:"#666"},children:"未來信心"}),r.jsx("span",{style:{fontWeight:"600",color:"#6B5BFF"},children:S.details.confidence==="excellent"?"優秀":S.details.confidence==="good"?"良好":S.details.confidence==="fair"?"一般":"需要改善"})]}),r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"8px",background:"#f8f9fa",borderRadius:"6px"},children:[r.jsx("span",{style:{color:"#666"},children:"社會接納"}),r.jsx("span",{style:{fontWeight:"600",color:"#6B5BFF"},children:S.details.acceptance==="excellent"?"優秀":S.details.acceptance==="good"?"良好":S.details.acceptance==="fair"?"一般":"需要改善"})]})]})]}),r.jsxs("div",{style:{marginBottom:"20px"},children:[r.jsx("h4",{style:{color:"#333",marginBottom:"12px",fontWeight:"600"},children:"💡 改善建議"}),r.jsx("div",{style:{background:"#f8f9fa",borderRadius:"8px",padding:"16px"},children:S.recommendations.map((G,U)=>r.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:"8px",marginBottom:"8px",fontSize:"14px",lineHeight:"1.4"},children:[r.jsx("span",{style:{color:"#6B5BFF",fontWeight:"bold"},children:"•"}),r.jsx("span",{style:{color:"#333"},children:G})]},U))})]}),r.jsxs("div",{style:{background:"linear-gradient(135deg, #FF9800 0%, #F57C00 100%)",borderRadius:"8px",padding:"16px",marginBottom:"20px"},children:[r.jsx("h4",{style:{color:"white",marginBottom:"8px",fontWeight:"600"},children:"🎯 專業輔導建議"}),r.jsx("p",{style:{color:"white",fontSize:"14px",lineHeight:"1.4",margin:0},children:"基於您的評估結果，我們建議您考慮尋求專業輔導師的協助。專業輔導師可以為您提供個性化的改善計劃和持續的支持。"})]}),r.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"center"},children:[r.jsx("button",{onClick:()=>x(!1),style:{background:"#f5f5f5",border:"none",borderRadius:"8px",padding:"12px 24px",color:"#666",cursor:"pointer",fontSize:"14px"},children:"關閉報告"}),r.jsx("button",{onClick:()=>{x(!1),alert("功能開發中：聯繫專業輔導師")},style:{background:"linear-gradient(45deg, #6B5BFF, #5A4FCF)",border:"none",borderRadius:"8px",padding:"12px 24px",color:"white",cursor:"pointer",fontSize:"14px",fontWeight:"600"},children:"聯繫輔導師"})]})]})}),window.innerWidth<=768?r.jsxs("footer",{style:{textAlign:"center",fontSize:12,color:"#888",marginTop:20,padding:12,background:"rgba(255,255,255,0.95)",borderTop:"1px solid #eee",display:"flex",flexDirection:"column",gap:8},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:16,flexWrap:"wrap"},children:[r.jsx("span",{onClick:()=>n("/about"),style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12,cursor:"pointer"},style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:600,fontSize:11},children:e==="zh-TW"?"🧬 我們是誰":e==="zh-CN"?"🧬 我们是谁":e==="en"?"🧬 Who We Are":e==="ja"?"🧬 私たちについて":e==="ko"?"🧬 우리는 누구인가":e==="th"?"🧬 เราเป็นใคร":e==="vi"?"🧬 Chúng tôi là ai":e==="ms"?"🧬 Siapa Kami":"🧬 Quis sumus"}),r.jsx("span",{onClick:()=>n("/privacy-policy"),style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12,cursor:"pointer"},style:{color:"#6B5BFF",textDecoration:"underline",fontSize:11},children:e==="zh-TW"?"隱私權政策":e==="zh-CN"?"隐私政策":e==="en"?"Privacy Policy":e==="ja"?"プライバシーポリシー":e==="ko"?"개인정보 처리방침":e==="th"?"นโยบายความเป็นส่วนตัว":e==="vi"?"Chính sách bảo mật":e==="ms"?"Dasar Privasi":"Consilium de Privata"}),r.jsx("span",{onClick:()=>n("/terms"),style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12,cursor:"pointer"},style:{color:"#6B5BFF",textDecoration:"underline",fontSize:11},children:e==="zh-TW"?"條款/聲明":e==="zh-CN"?"条款/声明":e==="en"?"Terms/Statement":e==="ja"?"規約/声明":e==="ko"?"약관/성명":e==="th"?"ข้อกำหนด/แถลงการณ์":e==="vi"?"Điều khoản/Tuyên bố":e==="ms"?"Terma/Pernyataan":"Termini/Declaratio"})]}),r.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:16,flexWrap:"wrap"},children:[r.jsx("span",{onClick:()=>n("/data-deletion"),style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12,cursor:"pointer"},style:{color:"#6B5BFF",textDecoration:"underline",fontSize:11},children:e==="zh-TW"?"資料刪除說明":e==="zh-CN"?"数据删除说明":e==="en"?"Data Deletion":e==="ja"?"データ削除について":e==="ko"?"데이터 삭제 안내":e==="th"?"คำอธิบายการลบข้อมูล":e==="vi"?"Giải thích xóa dữ liệu":e==="ms"?"Penjelasan Penghapusan Data":"Explicatio Deletionis Datae"}),r.jsx("span",{onClick:()=>n("/feedback"),style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12,cursor:"pointer"},style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:600,fontSize:11},children:e==="zh-TW"?"💬 意見箱":e==="zh-CN"?"💬 意见箱":e==="en"?"💬 Feedback":e==="ja"?"💬 ご意見箱":e==="ko"?"💬 피드백":e==="th"?"💬 กล่องความคิดเห็น":e==="vi"?"💬 Hộp góp ý":e==="ms"?"💬 Kotak Maklum Balas":"💬 Arca Consilii"})]})]}):r.jsx("div",{style:{width:"100%",margin:"0 auto",marginTop:24,background:"rgba(255,255,255,0.95)",borderRadius:16,padding:"16px",boxShadow:"0 2px 12px #6B5BFF22"},children:r.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:20,flexWrap:"wrap"},children:[r.jsx("span",{onClick:()=>n("/about"),style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12,cursor:"pointer"},children:e==="zh-TW"?"🧬 Restarter™｜我們是誰":e==="zh-CN"?"🧬 Restarter™｜我们是谁":e==="en"?"🧬 Restarter™｜Who We Are":e==="ja"?"🧬 Restarter™｜私たちについて":e==="ko"?"🧬 Restarter™｜우리는 누구인가":e==="th"?"🧬 Restarter™｜เราเป็นใคร":e==="vi"?"🧬 Restarter™｜Chúng tôi là ai":e==="ms"?"🧬 Restarter™｜Siapa Kami":"🧬 Restarter™｜Quis sumus"}),r.jsx("span",{onClick:()=>n("/privacy-policy"),style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12,cursor:"pointer"},children:e==="zh-TW"?"隱私權政策":e==="zh-CN"?"隐私政策":e==="en"?"Privacy Policy":e==="ja"?"プライバシーポリシー":e==="ko"?"개인정보 처리방침":e==="th"?"นโยบายความเป็นส่วนตัว":e==="vi"?"Chính sách bảo mật":e==="ms"?"Dasar Privasi":"Consilium de Privata"}),r.jsx("span",{onClick:()=>n("/terms"),style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12,cursor:"pointer"},children:e==="zh-TW"?"條款/聲明":e==="zh-CN"?"条款/声明":e==="en"?"Terms/Statement":e==="ja"?"規約/声明":e==="ko"?"약관/성명":e==="th"?"ข้อกำหนด/แถลงการณ์":e==="vi"?"Điều khoản/Tuyên bố":e==="ms"?"Terma/Pernyataan":"Termini/Declaratio"}),r.jsx("span",{onClick:()=>n("/data-deletion"),style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12,cursor:"pointer"},children:e==="zh-TW"?"資料刪除說明":e==="zh-CN"?"数据删除说明":e==="en"?"Data Deletion":e==="ja"?"データ削除について":e==="ko"?"데이터 삭제 안내":e==="th"?"คำอธิบายการลบข้อมูล":e==="vi"?"Giải thích xóa dữ liệu":e==="ms"?"Penjelasan Penghapusan Data":"Explicatio Deletionis Datae"}),r.jsx("span",{onClick:()=>n("/feedback"),style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12,cursor:"pointer"},children:e==="zh-TW"?"💬 意見箱｜我們想聽你說":e==="zh-CN"?"💬 意见箱｜我们想听你说":e==="en"?"💬 Feedback Box｜We Want to Hear From You":e==="ja"?"💬 ご意見箱｜私たちはあなたの声を聞きたい":e==="ko"?"💬 피드백｜우리는 당신의 말을 듣고 싶습니다":e==="th"?"💬 กล่องความคิดเห็น｜เราอยากได้ยินจากคุณ":e==="vi"?"💬 Hộp góp ý｜Chúng tôi muốn nghe từ bạn":e==="ms"?"💬 Kotak Maklum Balas｜Kami Ingin Mendengar Dari Anda":"💬 Arca Consilii｜Volumus Audire a Te"})]})})]})}const TE={male:"/avatars/male.png",female:"/avatars/female.png"};function jE({avatar:n,videoUrl:e,audioUrl:t,isSpeaking:i,onAvatarChange:s,size:o=160}){const a=g.useRef(null),[l,c]=g.useState(!1),u=()=>{a.current&&(a.current.currentTime=0,a.current.play(),c(!0))},h=()=>c(!1),p=()=>n==="male"||n==="female"?TE[n]:n;return r.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",marginBottom:24},children:[r.jsxs("div",{style:{position:"relative",width:o,height:o,marginBottom:8},children:[e?r.jsx("video",{src:e,width:o,height:o,autoPlay:!0,muted:!0,loop:!0,style:{borderRadius:"50%",objectFit:"cover"}}):r.jsx("img",{src:p(),width:o,height:o,style:{borderRadius:"50%",objectFit:"cover",filter:i?"brightness(1.1)":"none"},alt:"avatar"}),s&&(n==="male"||n==="female")&&r.jsx("button",{onClick:()=>s(n==="male"?"female":"male"),style:{position:"absolute",right:8,bottom:8,background:"#fff",borderRadius:"50%",border:"none",width:36,height:36,cursor:"pointer",fontSize:18},children:"切換"})]}),t&&r.jsx("audio",{ref:a,src:t,onEnded:h}),t&&r.jsx("button",{onClick:u,style:{padding:"6px 18px",borderRadius:8,background:"#6c63ff",color:"#fff",border:"none",fontWeight:700,fontSize:16,marginTop:8},disabled:l,children:l?"播放中...":"播放語音"})]})}function Rw(n,e){return function(){return n.apply(e,arguments)}}const{toString:_E}=Object.prototype,{getPrototypeOf:Ep}=Object,{iterator:sd,toStringTag:Aw}=Symbol,od=(n=>e=>{const t=_E.call(e);return n[t]||(n[t]=t.slice(8,-1).toLowerCase())})(Object.create(null)),Fn=n=>(n=n.toLowerCase(),e=>od(e)===n),ad=n=>e=>typeof e===n,{isArray:go}=Array,ya=ad("undefined");function IE(n){return n!==null&&!ya(n)&&n.constructor!==null&&!ya(n.constructor)&&xn(n.constructor.isBuffer)&&n.constructor.isBuffer(n)}const Ew=Fn("ArrayBuffer");function CE(n){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(n):e=n&&n.buffer&&Ew(n.buffer),e}const RE=ad("string"),xn=ad("function"),Bw=ad("number"),ld=n=>n!==null&&typeof n=="object",AE=n=>n===!0||n===!1,Ll=n=>{if(od(n)!=="object")return!1;const e=Ep(n);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Aw in n)&&!(sd in n)},EE=Fn("Date"),BE=Fn("File"),PE=Fn("Blob"),FE=Fn("FileList"),zE=n=>ld(n)&&xn(n.pipe),DE=n=>{let e;return n&&(typeof FormData=="function"&&n instanceof FormData||xn(n.append)&&((e=od(n))==="formdata"||e==="object"&&xn(n.toString)&&n.toString()==="[object FormData]"))},NE=Fn("URLSearchParams"),[ME,WE,LE,OE]=["ReadableStream","Request","Response","Headers"].map(Fn),VE=n=>n.trim?n.trim():n.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Ua(n,e,{allOwnKeys:t=!1}={}){if(n===null||typeof n>"u")return;let i,s;if(typeof n!="object"&&(n=[n]),go(n))for(i=0,s=n.length;i<s;i++)e.call(null,n[i],i,n);else{const o=t?Object.getOwnPropertyNames(n):Object.keys(n),a=o.length;let l;for(i=0;i<a;i++)l=o[i],e.call(null,n[l],l,n)}}function Pw(n,e){e=e.toLowerCase();const t=Object.keys(n);let i=t.length,s;for(;i-- >0;)if(s=t[i],e===s.toLowerCase())return s;return null}const Ir=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,Fw=n=>!ya(n)&&n!==Ir;function Uu(){const{caseless:n}=Fw(this)&&this||{},e={},t=(i,s)=>{const o=n&&Pw(e,s)||s;Ll(e[o])&&Ll(i)?e[o]=Uu(e[o],i):Ll(i)?e[o]=Uu({},i):go(i)?e[o]=i.slice():e[o]=i};for(let i=0,s=arguments.length;i<s;i++)arguments[i]&&Ua(arguments[i],t);return e}const qE=(n,e,t,{allOwnKeys:i}={})=>(Ua(e,(s,o)=>{t&&xn(s)?n[o]=Rw(s,t):n[o]=s},{allOwnKeys:i}),n),UE=n=>(n.charCodeAt(0)===65279&&(n=n.slice(1)),n),HE=(n,e,t,i)=>{n.prototype=Object.create(e.prototype,i),n.prototype.constructor=n,Object.defineProperty(n,"super",{value:e.prototype}),t&&Object.assign(n.prototype,t)},$E=(n,e,t,i)=>{let s,o,a;const l={};if(e=e||{},n==null)return e;do{for(s=Object.getOwnPropertyNames(n),o=s.length;o-- >0;)a=s[o],(!i||i(a,n,e))&&!l[a]&&(e[a]=n[a],l[a]=!0);n=t!==!1&&Ep(n)}while(n&&(!t||t(n,e))&&n!==Object.prototype);return e},GE=(n,e,t)=>{n=String(n),(t===void 0||t>n.length)&&(t=n.length),t-=e.length;const i=n.indexOf(e,t);return i!==-1&&i===t},KE=n=>{if(!n)return null;if(go(n))return n;let e=n.length;if(!Bw(e))return null;const t=new Array(e);for(;e-- >0;)t[e]=n[e];return t},QE=(n=>e=>n&&e instanceof n)(typeof Uint8Array<"u"&&Ep(Uint8Array)),YE=(n,e)=>{const i=(n&&n[sd]).call(n);let s;for(;(s=i.next())&&!s.done;){const o=s.value;e.call(n,o[0],o[1])}},XE=(n,e)=>{let t;const i=[];for(;(t=n.exec(e))!==null;)i.push(t);return i},JE=Fn("HTMLFormElement"),ZE=n=>n.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(t,i,s){return i.toUpperCase()+s}),Hf=(({hasOwnProperty:n})=>(e,t)=>n.call(e,t))(Object.prototype),e6=Fn("RegExp"),zw=(n,e)=>{const t=Object.getOwnPropertyDescriptors(n),i={};Ua(t,(s,o)=>{let a;(a=e(s,o,n))!==!1&&(i[o]=a||s)}),Object.defineProperties(n,i)},t6=n=>{zw(n,(e,t)=>{if(xn(n)&&["arguments","caller","callee"].indexOf(t)!==-1)return!1;const i=n[t];if(xn(i)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+t+"'")})}})},n6=(n,e)=>{const t={},i=s=>{s.forEach(o=>{t[o]=!0})};return go(n)?i(n):i(String(n).split(e)),t},i6=()=>{},r6=(n,e)=>n!=null&&Number.isFinite(n=+n)?n:e;function s6(n){return!!(n&&xn(n.append)&&n[Aw]==="FormData"&&n[sd])}const o6=n=>{const e=new Array(10),t=(i,s)=>{if(ld(i)){if(e.indexOf(i)>=0)return;if(!("toJSON"in i)){e[s]=i;const o=go(i)?[]:{};return Ua(i,(a,l)=>{const c=t(a,s+1);!ya(c)&&(o[l]=c)}),e[s]=void 0,o}}return i};return t(n,0)},a6=Fn("AsyncFunction"),l6=n=>n&&(ld(n)||xn(n))&&xn(n.then)&&xn(n.catch),Dw=((n,e)=>n?setImmediate:e?((t,i)=>(Ir.addEventListener("message",({source:s,data:o})=>{s===Ir&&o===t&&i.length&&i.shift()()},!1),s=>{i.push(s),Ir.postMessage(t,"*")}))(`axios@${Math.random()}`,[]):t=>setTimeout(t))(typeof setImmediate=="function",xn(Ir.postMessage)),c6=typeof queueMicrotask<"u"?queueMicrotask.bind(Ir):typeof process<"u"&&process.nextTick||Dw,d6=n=>n!=null&&xn(n[sd]),re={isArray:go,isArrayBuffer:Ew,isBuffer:IE,isFormData:DE,isArrayBufferView:CE,isString:RE,isNumber:Bw,isBoolean:AE,isObject:ld,isPlainObject:Ll,isReadableStream:ME,isRequest:WE,isResponse:LE,isHeaders:OE,isUndefined:ya,isDate:EE,isFile:BE,isBlob:PE,isRegExp:e6,isFunction:xn,isStream:zE,isURLSearchParams:NE,isTypedArray:QE,isFileList:FE,forEach:Ua,merge:Uu,extend:qE,trim:VE,stripBOM:UE,inherits:HE,toFlatObject:$E,kindOf:od,kindOfTest:Fn,endsWith:GE,toArray:KE,forEachEntry:YE,matchAll:XE,isHTMLForm:JE,hasOwnProperty:Hf,hasOwnProp:Hf,reduceDescriptors:zw,freezeMethods:t6,toObjectSet:n6,toCamelCase:ZE,noop:i6,toFiniteNumber:r6,findKey:Pw,global:Ir,isContextDefined:Fw,isSpecCompliantForm:s6,toJSONObject:o6,isAsyncFn:a6,isThenable:l6,setImmediate:Dw,asap:c6,isIterable:d6};function Ge(n,e,t,i,s){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=n,this.name="AxiosError",e&&(this.code=e),t&&(this.config=t),i&&(this.request=i),s&&(this.response=s,this.status=s.status?s.status:null)}re.inherits(Ge,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:re.toJSONObject(this.config),code:this.code,status:this.status}}});const Nw=Ge.prototype,Mw={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(n=>{Mw[n]={value:n}});Object.defineProperties(Ge,Mw);Object.defineProperty(Nw,"isAxiosError",{value:!0});Ge.from=(n,e,t,i,s,o)=>{const a=Object.create(Nw);return re.toFlatObject(n,a,function(c){return c!==Error.prototype},l=>l!=="isAxiosError"),Ge.call(a,n.message,e,t,i,s),a.cause=n,a.name=n.name,o&&Object.assign(a,o),a};const u6=null;function Hu(n){return re.isPlainObject(n)||re.isArray(n)}function Ww(n){return re.endsWith(n,"[]")?n.slice(0,-2):n}function $f(n,e,t){return n?n.concat(e).map(function(s,o){return s=Ww(s),!t&&o?"["+s+"]":s}).join(t?".":""):e}function h6(n){return re.isArray(n)&&!n.some(Hu)}const p6=re.toFlatObject(re,{},null,function(e){return/^is[A-Z]/.test(e)});function cd(n,e,t){if(!re.isObject(n))throw new TypeError("target must be an object");e=e||new FormData,t=re.toFlatObject(t,{metaTokens:!0,dots:!1,indexes:!1},!1,function(S,w){return!re.isUndefined(w[S])});const i=t.metaTokens,s=t.visitor||h,o=t.dots,a=t.indexes,c=(t.Blob||typeof Blob<"u"&&Blob)&&re.isSpecCompliantForm(e);if(!re.isFunction(s))throw new TypeError("visitor must be a function");function u(x){if(x===null)return"";if(re.isDate(x))return x.toISOString();if(re.isBoolean(x))return x.toString();if(!c&&re.isBlob(x))throw new Ge("Blob is not supported. Use a Buffer instead.");return re.isArrayBuffer(x)||re.isTypedArray(x)?c&&typeof Blob=="function"?new Blob([x]):Buffer.from(x):x}function h(x,S,w){let I=x;if(x&&!w&&typeof x=="object"){if(re.endsWith(S,"{}"))S=i?S:S.slice(0,-2),x=JSON.stringify(x);else if(re.isArray(x)&&h6(x)||(re.isFileList(x)||re.endsWith(S,"[]"))&&(I=re.toArray(x)))return S=Ww(S),I.forEach(function(A,D){!(re.isUndefined(A)||A===null)&&e.append(a===!0?$f([S],D,o):a===null?S:S+"[]",u(A))}),!1}return Hu(x)?!0:(e.append($f(w,S,o),u(x)),!1)}const p=[],f=Object.assign(p6,{defaultVisitor:h,convertValue:u,isVisitable:Hu});function b(x,S){if(!re.isUndefined(x)){if(p.indexOf(x)!==-1)throw Error("Circular reference detected in "+S.join("."));p.push(x),re.forEach(x,function(I,j){(!(re.isUndefined(I)||I===null)&&s.call(e,I,re.isString(j)?j.trim():j,S,f))===!0&&b(I,S?S.concat(j):[j])}),p.pop()}}if(!re.isObject(n))throw new TypeError("data must be an object");return b(n),e}function Gf(n){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(n).replace(/[!'()~]|%20|%00/g,function(i){return e[i]})}function Bp(n,e){this._pairs=[],n&&cd(n,this,e)}const Lw=Bp.prototype;Lw.append=function(e,t){this._pairs.push([e,t])};Lw.toString=function(e){const t=e?function(i){return e.call(this,i,Gf)}:Gf;return this._pairs.map(function(s){return t(s[0])+"="+t(s[1])},"").join("&")};function m6(n){return encodeURIComponent(n).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function Ow(n,e,t){if(!e)return n;const i=t&&t.encode||m6;re.isFunction(t)&&(t={serialize:t});const s=t&&t.serialize;let o;if(s?o=s(e,t):o=re.isURLSearchParams(e)?e.toString():new Bp(e,t).toString(i),o){const a=n.indexOf("#");a!==-1&&(n=n.slice(0,a)),n+=(n.indexOf("?")===-1?"?":"&")+o}return n}class Kf{constructor(){this.handlers=[]}use(e,t,i){return this.handlers.push({fulfilled:e,rejected:t,synchronous:i?i.synchronous:!1,runWhen:i?i.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){re.forEach(this.handlers,function(i){i!==null&&e(i)})}}const Vw={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},g6=typeof URLSearchParams<"u"?URLSearchParams:Bp,f6=typeof FormData<"u"?FormData:null,y6=typeof Blob<"u"?Blob:null,x6={isBrowser:!0,classes:{URLSearchParams:g6,FormData:f6,Blob:y6},protocols:["http","https","file","blob","url","data"]},Pp=typeof window<"u"&&typeof document<"u",$u=typeof navigator=="object"&&navigator||void 0,b6=Pp&&(!$u||["ReactNative","NativeScript","NS"].indexOf($u.product)<0),v6=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",w6=Pp&&window.location.href||"http://localhost",k6=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Pp,hasStandardBrowserEnv:b6,hasStandardBrowserWebWorkerEnv:v6,navigator:$u,origin:w6},Symbol.toStringTag,{value:"Module"})),an={...k6,...x6};function S6(n,e){return cd(n,new an.classes.URLSearchParams,Object.assign({visitor:function(t,i,s,o){return an.isNode&&re.isBuffer(t)?(this.append(i,t.toString("base64")),!1):o.defaultVisitor.apply(this,arguments)}},e))}function T6(n){return re.matchAll(/\w+|\[(\w*)]/g,n).map(e=>e[0]==="[]"?"":e[1]||e[0])}function j6(n){const e={},t=Object.keys(n);let i;const s=t.length;let o;for(i=0;i<s;i++)o=t[i],e[o]=n[o];return e}function qw(n){function e(t,i,s,o){let a=t[o++];if(a==="__proto__")return!0;const l=Number.isFinite(+a),c=o>=t.length;return a=!a&&re.isArray(s)?s.length:a,c?(re.hasOwnProp(s,a)?s[a]=[s[a],i]:s[a]=i,!l):((!s[a]||!re.isObject(s[a]))&&(s[a]=[]),e(t,i,s[a],o)&&re.isArray(s[a])&&(s[a]=j6(s[a])),!l)}if(re.isFormData(n)&&re.isFunction(n.entries)){const t={};return re.forEachEntry(n,(i,s)=>{e(T6(i),s,t,0)}),t}return null}function _6(n,e,t){if(re.isString(n))try{return(e||JSON.parse)(n),re.trim(n)}catch(i){if(i.name!=="SyntaxError")throw i}return(t||JSON.stringify)(n)}const Ha={transitional:Vw,adapter:["xhr","http","fetch"],transformRequest:[function(e,t){const i=t.getContentType()||"",s=i.indexOf("application/json")>-1,o=re.isObject(e);if(o&&re.isHTMLForm(e)&&(e=new FormData(e)),re.isFormData(e))return s?JSON.stringify(qw(e)):e;if(re.isArrayBuffer(e)||re.isBuffer(e)||re.isStream(e)||re.isFile(e)||re.isBlob(e)||re.isReadableStream(e))return e;if(re.isArrayBufferView(e))return e.buffer;if(re.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let l;if(o){if(i.indexOf("application/x-www-form-urlencoded")>-1)return S6(e,this.formSerializer).toString();if((l=re.isFileList(e))||i.indexOf("multipart/form-data")>-1){const c=this.env&&this.env.FormData;return cd(l?{"files[]":e}:e,c&&new c,this.formSerializer)}}return o||s?(t.setContentType("application/json",!1),_6(e)):e}],transformResponse:[function(e){const t=this.transitional||Ha.transitional,i=t&&t.forcedJSONParsing,s=this.responseType==="json";if(re.isResponse(e)||re.isReadableStream(e))return e;if(e&&re.isString(e)&&(i&&!this.responseType||s)){const a=!(t&&t.silentJSONParsing)&&s;try{return JSON.parse(e)}catch(l){if(a)throw l.name==="SyntaxError"?Ge.from(l,Ge.ERR_BAD_RESPONSE,this,null,this.response):l}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:an.classes.FormData,Blob:an.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};re.forEach(["delete","get","head","post","put","patch"],n=>{Ha.headers[n]={}});const I6=re.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),C6=n=>{const e={};let t,i,s;return n&&n.split(`
`).forEach(function(a){s=a.indexOf(":"),t=a.substring(0,s).trim().toLowerCase(),i=a.substring(s+1).trim(),!(!t||e[t]&&I6[t])&&(t==="set-cookie"?e[t]?e[t].push(i):e[t]=[i]:e[t]=e[t]?e[t]+", "+i:i)}),e},Qf=Symbol("internals");function Po(n){return n&&String(n).trim().toLowerCase()}function Ol(n){return n===!1||n==null?n:re.isArray(n)?n.map(Ol):String(n)}function R6(n){const e=Object.create(null),t=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let i;for(;i=t.exec(n);)e[i[1]]=i[2];return e}const A6=n=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(n.trim());function Kd(n,e,t,i,s){if(re.isFunction(i))return i.call(this,e,t);if(s&&(e=t),!!re.isString(e)){if(re.isString(i))return e.indexOf(i)!==-1;if(re.isRegExp(i))return i.test(e)}}function E6(n){return n.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,t,i)=>t.toUpperCase()+i)}function B6(n,e){const t=re.toCamelCase(" "+e);["get","set","has"].forEach(i=>{Object.defineProperty(n,i+t,{value:function(s,o,a){return this[i].call(this,e,s,o,a)},configurable:!0})})}let bn=class{constructor(e){e&&this.set(e)}set(e,t,i){const s=this;function o(l,c,u){const h=Po(c);if(!h)throw new Error("header name must be a non-empty string");const p=re.findKey(s,h);(!p||s[p]===void 0||u===!0||u===void 0&&s[p]!==!1)&&(s[p||c]=Ol(l))}const a=(l,c)=>re.forEach(l,(u,h)=>o(u,h,c));if(re.isPlainObject(e)||e instanceof this.constructor)a(e,t);else if(re.isString(e)&&(e=e.trim())&&!A6(e))a(C6(e),t);else if(re.isObject(e)&&re.isIterable(e)){let l={},c,u;for(const h of e){if(!re.isArray(h))throw TypeError("Object iterator must return a key-value pair");l[u=h[0]]=(c=l[u])?re.isArray(c)?[...c,h[1]]:[c,h[1]]:h[1]}a(l,t)}else e!=null&&o(t,e,i);return this}get(e,t){if(e=Po(e),e){const i=re.findKey(this,e);if(i){const s=this[i];if(!t)return s;if(t===!0)return R6(s);if(re.isFunction(t))return t.call(this,s,i);if(re.isRegExp(t))return t.exec(s);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,t){if(e=Po(e),e){const i=re.findKey(this,e);return!!(i&&this[i]!==void 0&&(!t||Kd(this,this[i],i,t)))}return!1}delete(e,t){const i=this;let s=!1;function o(a){if(a=Po(a),a){const l=re.findKey(i,a);l&&(!t||Kd(i,i[l],l,t))&&(delete i[l],s=!0)}}return re.isArray(e)?e.forEach(o):o(e),s}clear(e){const t=Object.keys(this);let i=t.length,s=!1;for(;i--;){const o=t[i];(!e||Kd(this,this[o],o,e,!0))&&(delete this[o],s=!0)}return s}normalize(e){const t=this,i={};return re.forEach(this,(s,o)=>{const a=re.findKey(i,o);if(a){t[a]=Ol(s),delete t[o];return}const l=e?E6(o):String(o).trim();l!==o&&delete t[o],t[l]=Ol(s),i[l]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const t=Object.create(null);return re.forEach(this,(i,s)=>{i!=null&&i!==!1&&(t[s]=e&&re.isArray(i)?i.join(", "):i)}),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,t])=>e+": "+t).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...t){const i=new this(e);return t.forEach(s=>i.set(s)),i}static accessor(e){const i=(this[Qf]=this[Qf]={accessors:{}}).accessors,s=this.prototype;function o(a){const l=Po(a);i[l]||(B6(s,a),i[l]=!0)}return re.isArray(e)?e.forEach(o):o(e),this}};bn.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);re.reduceDescriptors(bn.prototype,({value:n},e)=>{let t=e[0].toUpperCase()+e.slice(1);return{get:()=>n,set(i){this[t]=i}}});re.freezeMethods(bn);function Qd(n,e){const t=this||Ha,i=e||t,s=bn.from(i.headers);let o=i.data;return re.forEach(n,function(l){o=l.call(t,o,s.normalize(),e?e.status:void 0)}),s.normalize(),o}function Uw(n){return!!(n&&n.__CANCEL__)}function fo(n,e,t){Ge.call(this,n??"canceled",Ge.ERR_CANCELED,e,t),this.name="CanceledError"}re.inherits(fo,Ge,{__CANCEL__:!0});function Hw(n,e,t){const i=t.config.validateStatus;!t.status||!i||i(t.status)?n(t):e(new Ge("Request failed with status code "+t.status,[Ge.ERR_BAD_REQUEST,Ge.ERR_BAD_RESPONSE][Math.floor(t.status/100)-4],t.config,t.request,t))}function P6(n){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(n);return e&&e[1]||""}function F6(n,e){n=n||10;const t=new Array(n),i=new Array(n);let s=0,o=0,a;return e=e!==void 0?e:1e3,function(c){const u=Date.now(),h=i[o];a||(a=u),t[s]=c,i[s]=u;let p=o,f=0;for(;p!==s;)f+=t[p++],p=p%n;if(s=(s+1)%n,s===o&&(o=(o+1)%n),u-a<e)return;const b=h&&u-h;return b?Math.round(f*1e3/b):void 0}}function z6(n,e){let t=0,i=1e3/e,s,o;const a=(u,h=Date.now())=>{t=h,s=null,o&&(clearTimeout(o),o=null),n.apply(null,u)};return[(...u)=>{const h=Date.now(),p=h-t;p>=i?a(u,h):(s=u,o||(o=setTimeout(()=>{o=null,a(s)},i-p)))},()=>s&&a(s)]}const wc=(n,e,t=3)=>{let i=0;const s=F6(50,250);return z6(o=>{const a=o.loaded,l=o.lengthComputable?o.total:void 0,c=a-i,u=s(c),h=a<=l;i=a;const p={loaded:a,total:l,progress:l?a/l:void 0,bytes:c,rate:u||void 0,estimated:u&&l&&h?(l-a)/u:void 0,event:o,lengthComputable:l!=null,[e?"download":"upload"]:!0};n(p)},t)},Yf=(n,e)=>{const t=n!=null;return[i=>e[0]({lengthComputable:t,total:n,loaded:i}),e[1]]},Xf=n=>(...e)=>re.asap(()=>n(...e)),D6=an.hasStandardBrowserEnv?((n,e)=>t=>(t=new URL(t,an.origin),n.protocol===t.protocol&&n.host===t.host&&(e||n.port===t.port)))(new URL(an.origin),an.navigator&&/(msie|trident)/i.test(an.navigator.userAgent)):()=>!0,N6=an.hasStandardBrowserEnv?{write(n,e,t,i,s,o){const a=[n+"="+encodeURIComponent(e)];re.isNumber(t)&&a.push("expires="+new Date(t).toGMTString()),re.isString(i)&&a.push("path="+i),re.isString(s)&&a.push("domain="+s),o===!0&&a.push("secure"),document.cookie=a.join("; ")},read(n){const e=document.cookie.match(new RegExp("(^|;\\s*)("+n+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove(n){this.write(n,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function M6(n){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(n)}function W6(n,e){return e?n.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):n}function $w(n,e,t){let i=!M6(e);return n&&(i||t==!1)?W6(n,e):e}const Jf=n=>n instanceof bn?{...n}:n;function Gr(n,e){e=e||{};const t={};function i(u,h,p,f){return re.isPlainObject(u)&&re.isPlainObject(h)?re.merge.call({caseless:f},u,h):re.isPlainObject(h)?re.merge({},h):re.isArray(h)?h.slice():h}function s(u,h,p,f){if(re.isUndefined(h)){if(!re.isUndefined(u))return i(void 0,u,p,f)}else return i(u,h,p,f)}function o(u,h){if(!re.isUndefined(h))return i(void 0,h)}function a(u,h){if(re.isUndefined(h)){if(!re.isUndefined(u))return i(void 0,u)}else return i(void 0,h)}function l(u,h,p){if(p in e)return i(u,h);if(p in n)return i(void 0,u)}const c={url:o,method:o,data:o,baseURL:a,transformRequest:a,transformResponse:a,paramsSerializer:a,timeout:a,timeoutMessage:a,withCredentials:a,withXSRFToken:a,adapter:a,responseType:a,xsrfCookieName:a,xsrfHeaderName:a,onUploadProgress:a,onDownloadProgress:a,decompress:a,maxContentLength:a,maxBodyLength:a,beforeRedirect:a,transport:a,httpAgent:a,httpsAgent:a,cancelToken:a,socketPath:a,responseEncoding:a,validateStatus:l,headers:(u,h,p)=>s(Jf(u),Jf(h),p,!0)};return re.forEach(Object.keys(Object.assign({},n,e)),function(h){const p=c[h]||s,f=p(n[h],e[h],h);re.isUndefined(f)&&p!==l||(t[h]=f)}),t}const Gw=n=>{const e=Gr({},n);let{data:t,withXSRFToken:i,xsrfHeaderName:s,xsrfCookieName:o,headers:a,auth:l}=e;e.headers=a=bn.from(a),e.url=Ow($w(e.baseURL,e.url,e.allowAbsoluteUrls),n.params,n.paramsSerializer),l&&a.set("Authorization","Basic "+btoa((l.username||"")+":"+(l.password?unescape(encodeURIComponent(l.password)):"")));let c;if(re.isFormData(t)){if(an.hasStandardBrowserEnv||an.hasStandardBrowserWebWorkerEnv)a.setContentType(void 0);else if((c=a.getContentType())!==!1){const[u,...h]=c?c.split(";").map(p=>p.trim()).filter(Boolean):[];a.setContentType([u||"multipart/form-data",...h].join("; "))}}if(an.hasStandardBrowserEnv&&(i&&re.isFunction(i)&&(i=i(e)),i||i!==!1&&D6(e.url))){const u=s&&o&&N6.read(o);u&&a.set(s,u)}return e},L6=typeof XMLHttpRequest<"u",O6=L6&&function(n){return new Promise(function(t,i){const s=Gw(n);let o=s.data;const a=bn.from(s.headers).normalize();let{responseType:l,onUploadProgress:c,onDownloadProgress:u}=s,h,p,f,b,x;function S(){b&&b(),x&&x(),s.cancelToken&&s.cancelToken.unsubscribe(h),s.signal&&s.signal.removeEventListener("abort",h)}let w=new XMLHttpRequest;w.open(s.method.toUpperCase(),s.url,!0),w.timeout=s.timeout;function I(){if(!w)return;const A=bn.from("getAllResponseHeaders"in w&&w.getAllResponseHeaders()),O={data:!l||l==="text"||l==="json"?w.responseText:w.response,status:w.status,statusText:w.statusText,headers:A,config:n,request:w};Hw(function(B){t(B),S()},function(B){i(B),S()},O),w=null}"onloadend"in w?w.onloadend=I:w.onreadystatechange=function(){!w||w.readyState!==4||w.status===0&&!(w.responseURL&&w.responseURL.indexOf("file:")===0)||setTimeout(I)},w.onabort=function(){w&&(i(new Ge("Request aborted",Ge.ECONNABORTED,n,w)),w=null)},w.onerror=function(){i(new Ge("Network Error",Ge.ERR_NETWORK,n,w)),w=null},w.ontimeout=function(){let D=s.timeout?"timeout of "+s.timeout+"ms exceeded":"timeout exceeded";const O=s.transitional||Vw;s.timeoutErrorMessage&&(D=s.timeoutErrorMessage),i(new Ge(D,O.clarifyTimeoutError?Ge.ETIMEDOUT:Ge.ECONNABORTED,n,w)),w=null},o===void 0&&a.setContentType(null),"setRequestHeader"in w&&re.forEach(a.toJSON(),function(D,O){w.setRequestHeader(O,D)}),re.isUndefined(s.withCredentials)||(w.withCredentials=!!s.withCredentials),l&&l!=="json"&&(w.responseType=s.responseType),u&&([f,x]=wc(u,!0),w.addEventListener("progress",f)),c&&w.upload&&([p,b]=wc(c),w.upload.addEventListener("progress",p),w.upload.addEventListener("loadend",b)),(s.cancelToken||s.signal)&&(h=A=>{w&&(i(!A||A.type?new fo(null,n,w):A),w.abort(),w=null)},s.cancelToken&&s.cancelToken.subscribe(h),s.signal&&(s.signal.aborted?h():s.signal.addEventListener("abort",h)));const j=P6(s.url);if(j&&an.protocols.indexOf(j)===-1){i(new Ge("Unsupported protocol "+j+":",Ge.ERR_BAD_REQUEST,n));return}w.send(o||null)})},V6=(n,e)=>{const{length:t}=n=n?n.filter(Boolean):[];if(e||t){let i=new AbortController,s;const o=function(u){if(!s){s=!0,l();const h=u instanceof Error?u:this.reason;i.abort(h instanceof Ge?h:new fo(h instanceof Error?h.message:h))}};let a=e&&setTimeout(()=>{a=null,o(new Ge(`timeout ${e} of ms exceeded`,Ge.ETIMEDOUT))},e);const l=()=>{n&&(a&&clearTimeout(a),a=null,n.forEach(u=>{u.unsubscribe?u.unsubscribe(o):u.removeEventListener("abort",o)}),n=null)};n.forEach(u=>u.addEventListener("abort",o));const{signal:c}=i;return c.unsubscribe=()=>re.asap(l),c}},q6=function*(n,e){let t=n.byteLength;if(t<e){yield n;return}let i=0,s;for(;i<t;)s=i+e,yield n.slice(i,s),i=s},U6=async function*(n,e){for await(const t of H6(n))yield*q6(t,e)},H6=async function*(n){if(n[Symbol.asyncIterator]){yield*n;return}const e=n.getReader();try{for(;;){const{done:t,value:i}=await e.read();if(t)break;yield i}}finally{await e.cancel()}},Zf=(n,e,t,i)=>{const s=U6(n,e);let o=0,a,l=c=>{a||(a=!0,i&&i(c))};return new ReadableStream({async pull(c){try{const{done:u,value:h}=await s.next();if(u){l(),c.close();return}let p=h.byteLength;if(t){let f=o+=p;t(f)}c.enqueue(new Uint8Array(h))}catch(u){throw l(u),u}},cancel(c){return l(c),s.return()}},{highWaterMark:2})},dd=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",Kw=dd&&typeof ReadableStream=="function",$6=dd&&(typeof TextEncoder=="function"?(n=>e=>n.encode(e))(new TextEncoder):async n=>new Uint8Array(await new Response(n).arrayBuffer())),Qw=(n,...e)=>{try{return!!n(...e)}catch{return!1}},G6=Kw&&Qw(()=>{let n=!1;const e=new Request(an.origin,{body:new ReadableStream,method:"POST",get duplex(){return n=!0,"half"}}).headers.has("Content-Type");return n&&!e}),ey=64*1024,Gu=Kw&&Qw(()=>re.isReadableStream(new Response("").body)),kc={stream:Gu&&(n=>n.body)};dd&&(n=>{["text","arrayBuffer","blob","formData","stream"].forEach(e=>{!kc[e]&&(kc[e]=re.isFunction(n[e])?t=>t[e]():(t,i)=>{throw new Ge(`Response type '${e}' is not supported`,Ge.ERR_NOT_SUPPORT,i)})})})(new Response);const K6=async n=>{if(n==null)return 0;if(re.isBlob(n))return n.size;if(re.isSpecCompliantForm(n))return(await new Request(an.origin,{method:"POST",body:n}).arrayBuffer()).byteLength;if(re.isArrayBufferView(n)||re.isArrayBuffer(n))return n.byteLength;if(re.isURLSearchParams(n)&&(n=n+""),re.isString(n))return(await $6(n)).byteLength},Q6=async(n,e)=>{const t=re.toFiniteNumber(n.getContentLength());return t??K6(e)},Y6=dd&&(async n=>{let{url:e,method:t,data:i,signal:s,cancelToken:o,timeout:a,onDownloadProgress:l,onUploadProgress:c,responseType:u,headers:h,withCredentials:p="same-origin",fetchOptions:f}=Gw(n);u=u?(u+"").toLowerCase():"text";let b=V6([s,o&&o.toAbortSignal()],a),x;const S=b&&b.unsubscribe&&(()=>{b.unsubscribe()});let w;try{if(c&&G6&&t!=="get"&&t!=="head"&&(w=await Q6(h,i))!==0){let O=new Request(e,{method:"POST",body:i,duplex:"half"}),P;if(re.isFormData(i)&&(P=O.headers.get("content-type"))&&h.setContentType(P),O.body){const[B,k]=Yf(w,wc(Xf(c)));i=Zf(O.body,ey,B,k)}}re.isString(p)||(p=p?"include":"omit");const I="credentials"in Request.prototype;x=new Request(e,{...f,signal:b,method:t.toUpperCase(),headers:h.normalize().toJSON(),body:i,duplex:"half",credentials:I?p:void 0});let j=await fetch(x,f);const A=Gu&&(u==="stream"||u==="response");if(Gu&&(l||A&&S)){const O={};["status","statusText","headers"].forEach(T=>{O[T]=j[T]});const P=re.toFiniteNumber(j.headers.get("content-length")),[B,k]=l&&Yf(P,wc(Xf(l),!0))||[];j=new Response(Zf(j.body,ey,B,()=>{k&&k(),S&&S()}),O)}u=u||"text";let D=await kc[re.findKey(kc,u)||"text"](j,n);return!A&&S&&S(),await new Promise((O,P)=>{Hw(O,P,{data:D,headers:bn.from(j.headers),status:j.status,statusText:j.statusText,config:n,request:x})})}catch(I){throw S&&S(),I&&I.name==="TypeError"&&/Load failed|fetch/i.test(I.message)?Object.assign(new Ge("Network Error",Ge.ERR_NETWORK,n,x),{cause:I.cause||I}):Ge.from(I,I&&I.code,n,x)}}),Ku={http:u6,xhr:O6,fetch:Y6};re.forEach(Ku,(n,e)=>{if(n){try{Object.defineProperty(n,"name",{value:e})}catch{}Object.defineProperty(n,"adapterName",{value:e})}});const ty=n=>`- ${n}`,X6=n=>re.isFunction(n)||n===null||n===!1,Yw={getAdapter:n=>{n=re.isArray(n)?n:[n];const{length:e}=n;let t,i;const s={};for(let o=0;o<e;o++){t=n[o];let a;if(i=t,!X6(t)&&(i=Ku[(a=String(t)).toLowerCase()],i===void 0))throw new Ge(`Unknown adapter '${a}'`);if(i)break;s[a||"#"+o]=i}if(!i){const o=Object.entries(s).map(([l,c])=>`adapter ${l} `+(c===!1?"is not supported by the environment":"is not available in the build"));let a=e?o.length>1?`since :
`+o.map(ty).join(`
`):" "+ty(o[0]):"as no adapter specified";throw new Ge("There is no suitable adapter to dispatch the request "+a,"ERR_NOT_SUPPORT")}return i},adapters:Ku};function Yd(n){if(n.cancelToken&&n.cancelToken.throwIfRequested(),n.signal&&n.signal.aborted)throw new fo(null,n)}function ny(n){return Yd(n),n.headers=bn.from(n.headers),n.data=Qd.call(n,n.transformRequest),["post","put","patch"].indexOf(n.method)!==-1&&n.headers.setContentType("application/x-www-form-urlencoded",!1),Yw.getAdapter(n.adapter||Ha.adapter)(n).then(function(i){return Yd(n),i.data=Qd.call(n,n.transformResponse,i),i.headers=bn.from(i.headers),i},function(i){return Uw(i)||(Yd(n),i&&i.response&&(i.response.data=Qd.call(n,n.transformResponse,i.response),i.response.headers=bn.from(i.response.headers))),Promise.reject(i)})}const Xw="1.10.0",ud={};["object","boolean","number","function","string","symbol"].forEach((n,e)=>{ud[n]=function(i){return typeof i===n||"a"+(e<1?"n ":" ")+n}});const iy={};ud.transitional=function(e,t,i){function s(o,a){return"[Axios v"+Xw+"] Transitional option '"+o+"'"+a+(i?". "+i:"")}return(o,a,l)=>{if(e===!1)throw new Ge(s(a," has been removed"+(t?" in "+t:"")),Ge.ERR_DEPRECATED);return t&&!iy[a]&&(iy[a]=!0,console.warn(s(a," has been deprecated since v"+t+" and will be removed in the near future"))),e?e(o,a,l):!0}};ud.spelling=function(e){return(t,i)=>(console.warn(`${i} is likely a misspelling of ${e}`),!0)};function J6(n,e,t){if(typeof n!="object")throw new Ge("options must be an object",Ge.ERR_BAD_OPTION_VALUE);const i=Object.keys(n);let s=i.length;for(;s-- >0;){const o=i[s],a=e[o];if(a){const l=n[o],c=l===void 0||a(l,o,n);if(c!==!0)throw new Ge("option "+o+" must be "+c,Ge.ERR_BAD_OPTION_VALUE);continue}if(t!==!0)throw new Ge("Unknown option "+o,Ge.ERR_BAD_OPTION)}}const Vl={assertOptions:J6,validators:ud},Nn=Vl.validators;let Br=class{constructor(e){this.defaults=e||{},this.interceptors={request:new Kf,response:new Kf}}async request(e,t){try{return await this._request(e,t)}catch(i){if(i instanceof Error){let s={};Error.captureStackTrace?Error.captureStackTrace(s):s=new Error;const o=s.stack?s.stack.replace(/^.+\n/,""):"";try{i.stack?o&&!String(i.stack).endsWith(o.replace(/^.+\n.+\n/,""))&&(i.stack+=`
`+o):i.stack=o}catch{}}throw i}}_request(e,t){typeof e=="string"?(t=t||{},t.url=e):t=e||{},t=Gr(this.defaults,t);const{transitional:i,paramsSerializer:s,headers:o}=t;i!==void 0&&Vl.assertOptions(i,{silentJSONParsing:Nn.transitional(Nn.boolean),forcedJSONParsing:Nn.transitional(Nn.boolean),clarifyTimeoutError:Nn.transitional(Nn.boolean)},!1),s!=null&&(re.isFunction(s)?t.paramsSerializer={serialize:s}:Vl.assertOptions(s,{encode:Nn.function,serialize:Nn.function},!0)),t.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?t.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:t.allowAbsoluteUrls=!0),Vl.assertOptions(t,{baseUrl:Nn.spelling("baseURL"),withXsrfToken:Nn.spelling("withXSRFToken")},!0),t.method=(t.method||this.defaults.method||"get").toLowerCase();let a=o&&re.merge(o.common,o[t.method]);o&&re.forEach(["delete","get","head","post","put","patch","common"],x=>{delete o[x]}),t.headers=bn.concat(a,o);const l=[];let c=!0;this.interceptors.request.forEach(function(S){typeof S.runWhen=="function"&&S.runWhen(t)===!1||(c=c&&S.synchronous,l.unshift(S.fulfilled,S.rejected))});const u=[];this.interceptors.response.forEach(function(S){u.push(S.fulfilled,S.rejected)});let h,p=0,f;if(!c){const x=[ny.bind(this),void 0];for(x.unshift.apply(x,l),x.push.apply(x,u),f=x.length,h=Promise.resolve(t);p<f;)h=h.then(x[p++],x[p++]);return h}f=l.length;let b=t;for(p=0;p<f;){const x=l[p++],S=l[p++];try{b=x(b)}catch(w){S.call(this,w);break}}try{h=ny.call(this,b)}catch(x){return Promise.reject(x)}for(p=0,f=u.length;p<f;)h=h.then(u[p++],u[p++]);return h}getUri(e){e=Gr(this.defaults,e);const t=$w(e.baseURL,e.url,e.allowAbsoluteUrls);return Ow(t,e.params,e.paramsSerializer)}};re.forEach(["delete","get","head","options"],function(e){Br.prototype[e]=function(t,i){return this.request(Gr(i||{},{method:e,url:t,data:(i||{}).data}))}});re.forEach(["post","put","patch"],function(e){function t(i){return function(o,a,l){return this.request(Gr(l||{},{method:e,headers:i?{"Content-Type":"multipart/form-data"}:{},url:o,data:a}))}}Br.prototype[e]=t(),Br.prototype[e+"Form"]=t(!0)});let Z6=class Jw{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let t;this.promise=new Promise(function(o){t=o});const i=this;this.promise.then(s=>{if(!i._listeners)return;let o=i._listeners.length;for(;o-- >0;)i._listeners[o](s);i._listeners=null}),this.promise.then=s=>{let o;const a=new Promise(l=>{i.subscribe(l),o=l}).then(s);return a.cancel=function(){i.unsubscribe(o)},a},e(function(o,a,l){i.reason||(i.reason=new fo(o,a,l),t(i.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const t=this._listeners.indexOf(e);t!==-1&&this._listeners.splice(t,1)}toAbortSignal(){const e=new AbortController,t=i=>{e.abort(i)};return this.subscribe(t),e.signal.unsubscribe=()=>this.unsubscribe(t),e.signal}static source(){let e;return{token:new Jw(function(s){e=s}),cancel:e}}};function eB(n){return function(t){return n.apply(null,t)}}function tB(n){return re.isObject(n)&&n.isAxiosError===!0}const Qu={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Qu).forEach(([n,e])=>{Qu[e]=n});function Zw(n){const e=new Br(n),t=Rw(Br.prototype.request,e);return re.extend(t,Br.prototype,e,{allOwnKeys:!0}),re.extend(t,e,null,{allOwnKeys:!0}),t.create=function(s){return Zw(Gr(n,s))},t}const Et=Zw(Ha);Et.Axios=Br;Et.CanceledError=fo;Et.CancelToken=Z6;Et.isCancel=Uw;Et.VERSION=Xw;Et.toFormData=cd;Et.AxiosError=Ge;Et.Cancel=Et.CanceledError;Et.all=function(e){return Promise.all(e)};Et.spread=eB;Et.isAxiosError=tB;Et.mergeConfig=Gr;Et.AxiosHeaders=bn;Et.formToJSON=n=>qw(re.isHTMLForm(n)?new FormData(n):n);Et.getAdapter=Yw.getAdapter;Et.HttpStatusCode=Qu;Et.default=Et;const{Axios:cP,AxiosError:dP,CanceledError:uP,isCancel:hP,CancelToken:pP,VERSION:mP,all:gP,Cancel:fP,isAxiosError:yP,spread:xP,toFormData:bP,AxiosHeaders:vP,HttpStatusCode:wP,formToJSON:kP,getAdapter:SP,mergeConfig:TP}=Et;async function*Xd(n,e,t,i){try{const o=Je().currentUser;if(!o)throw new Error("用戶未登入");const a=await Et.post("/api/gpt",{messages:[{sender:"user",text:n}],system_prompt:t,userId:o.uid},{headers:{"x-test-mode":i?"true":"false"}}),l=a.data.reply;if(console.log("API Response:",a.data),l&&l.trim()){const c=l.split("");for(const u of c)yield u,await new Promise(h=>setTimeout(h,50))}else throw console.error("Empty reply from API"),new Error("AI回覆為空，請稍後再試。")}catch(s){throw console.error("Error calling GPT API:",s),s instanceof Error?new Error(`API錯誤：${s.message}`):new Error("抱歉，我現在無法回應，請稍後再試。")}}const ek=["Annie.png","berlex.png","Bray.png","Cayly.png","Derxl.png","El.png","Fenny.png","Gily.png","Henny.png","Jesy.png","Karl.png","michy.png","Mily.png","Neysher.png","sandy.png","Sherl.png","Shu.png","Shyly.png"],nB=ek.map(n=>`/avatars/${n}`);ek.map(n=>n.replace(/\.png$/i,""));const ry={"zh-TW":{friend:"朋友",avatarTitle:"選我做你的朋友",companionPhrase:["🕊️ 守在海這端，","我都聽著呢。"],changeAvatar:"更換我的頭像",aiReplyTemplate:n=>`AI陪聊：我明白你的意思，「${n}」，讓我再多聽你說說...`,aiSystemPrompt:"你是一個溫暖、善解人意的虛擬人，請用鼓勵、正向語氣回應。",speechErrorBrowser:"此瀏覽器不支援語音辨識，請改用 Chrome/Edge。",speechErrorFail:"語音辨識失敗，請再試一次。",speechErrorNoDetect:"沒有偵測到語音，請再試一次。",logout:"登出",inputPlaceholder:"或者，直接輸入文字... (Enter 送出)",welcome:n=>`嗨，${n}，我是你的 AI 朋友，你可以開始跟我說話囉！`,welcomePickAvatar:n=>`嗨，${n}，先幫我選個頭像後我們再輕鬆自在，天南地北痛快聊...`,welcomeChat:(n,e)=>`${n}說：嗨，${e}，今天想聊點什麼呢？`,whoAmI:"你想我是誰？",tapToTalk:"按一下開始語音聊天...",aiReplying:"AI 正在回覆中，輸入新訊息可立即打斷",recognizing:"正在辨識中..."},"zh-CN":{friend:"朋友",avatarTitle:"选我做你的朋友",companionPhrase:["🕊️ 守在海这端，","我都听着呢。"],changeAvatar:"更换我的头像",aiReplyTemplate:n=>`AI陪聊：我明白你的意思，"${n}"，让我再多听你聊聊...`,aiSystemPrompt:"你是一个温暖、善解人意的虚拟人，请用鼓励、正向语气回应。",speechErrorBrowser:"此浏览器不支持语音识别，请改用 Chrome/Edge。",speechErrorFail:"语音识别失败，请再试一次。",speechErrorNoDetect:"没有检测到语音，请再试一次。",logout:"登出",inputPlaceholder:"或者，直接输入文字... (Enter 发送)",welcome:n=>`嗨，${n}，我是你的 AI 朋友，你可以开始跟我说话啰！`,welcomePickAvatar:n=>`嗨，${n}，先帮我选个头像后我们再轻松自在，天南地北畅快聊...`,welcomeChat:(n,e)=>`${n}说：嗨，${e}，今天想聊点什么呢？`,whoAmI:"你想我是谁？",tapToTalk:"点一下开始语音聊天...",aiReplying:"AI 正在回复中，输入新消息可立即打断",recognizing:"正在识别中..."},en:{friend:"Friend",avatarTitle:"Pick Me as Your Friend",companionPhrase:["🕊️ I'm here by the sea,","I'm listening."],changeAvatar:"Change My Avatar",aiReplyTemplate:n=>`AI Chat: I understand what you mean, "${n}", let me hear more from you...`,aiSystemPrompt:"You are a warm, empathetic virtual person. Please respond in an encouraging and positive tone.",speechErrorBrowser:"This browser does not support speech recognition. Please use Chrome/Edge.",speechErrorFail:"Speech recognition failed, please try again.",speechErrorNoDetect:"No speech detected, please try again.",logout:"Logout",inputPlaceholder:"Or, type text directly... (Enter to send)",welcome:n=>`Hi, ${n}, I'm your AI friend. You can start talking to me now!`,welcomePickAvatar:n=>`Hi, ${n}, pick my avatar and let's chat freely!`,welcomeChat:(n,e)=>`${n}: Hi, ${e}, what do you want to talk about today?`,whoAmI:"Who do you want me to be?",tapToTalk:"Tap to start voice chat...",aiReplying:"AI is replying, type a new message to interrupt.",recognizing:"Recognizing..."},ja:{friend:"友達",avatarTitle:"友達に選んでね",companionPhrase:["🕊️ この海辺で待ってるよ、","ずっと聞いているから。"],changeAvatar:"アバターを変更",aiReplyTemplate:n=>`AIチャット：あなたの言うこと、「${n}」、わかります。もっと聞かせてください...`,aiSystemPrompt:"あなたは温かく、共感的なバーチャルパーソンです。励ましとポジティブなトーンで応答してください。",speechErrorBrowser:"このブラウザは音声認識に対応していません。Chrome/Edgeを使用してください。",speechErrorFail:"音声認識に失敗しました。もう一度お試しください。",speechErrorNoDetect:"音声が検出されませんでした。もう一度お試しください。",logout:"ログアウト",inputPlaceholder:"あるいは、直接テキストを入力... (Enterで送信)",welcome:n=>`こんにちは、${n}さん。あなたのAIの友達です。さあ、話しましょう！`,welcomePickAvatar:n=>`やあ、${n}、まずは私のアバターを選んでから、気軽に何でも話そう！`,welcomeChat:(n,e)=>`${n}：やあ、${e}、今日は何を話そうか？`,whoAmI:"私が誰であってほしいですか？",tapToTalk:"タップして音声チャット開始",aiReplying:"AIが返信中です。新しいメッセージを入力するとすぐに中断できます",recognizing:"認識中..."},ko:{friend:"친구",avatarTitle:"나를 친구로 선택해줘",companionPhrase:["🕊️ 바다 이편에서 지키고 있을게,","다 듣고 있어."],changeAvatar:"내 아바타 변경",aiReplyTemplate:n=>`AI 채팅: 무슨 말인지 알겠어, "${n}", 더 얘기해줘...`,aiSystemPrompt:"당신은 따뜻하고 공감 능력이 뛰어난 가상 인간입니다. 격려하고 긍정적인 톤으로 응답해주세요.",speechErrorBrowser:"이 브라우저는 음성 인식을 지원하지 않습니다. Chrome/Edge를 사용해주세요.",speechErrorFail:"음성 인식이 실패했습니다. 다시 시도해주세요.",speechErrorNoDetect:"음성이 감지되지 않았습니다. 다시 시도해주세요.",logout:"로그아웃",inputPlaceholder:"아니면, 직접 텍스트를 입력하세요... (Enter로 전송)",welcome:n=>`안녕, ${n}. 나는 너의 AI 친구야. 이제 나에게 말을 걸 수 있어!`,welcomePickAvatar:n=>`안녕, ${n}. 먼저 내 아바타를 고르고 자유롭게 얘기하자!`,welcomeChat:(n,e)=>`${n}: 안녕, ${e}, 오늘 무슨 얘기하고 싶어?`,whoAmI:"내가 누구였으면 좋겠어?",tapToTalk:"탭하여 음성 채팅 시작...",aiReplying:"AI가 답장 중입니다. 새 메시지를 입력하여 중단할 수 있습니다.",recognizing:"인식 중..."},vi:{friend:"Bạn bè",avatarTitle:"Chọn tôi làm bạn của bạn",companionPhrase:["🕊️ Em ở đây bên bờ biển,","Em đang lắng nghe đây."],changeAvatar:"Thay đổi Avatar của tôi",aiReplyTemplate:n=>`Trò chuyện AI: Tôi hiểu ý bạn, "${n}", hãy cho tôi nghe thêm...`,aiSystemPrompt:"Bạn là một người ảo ấm áp, đồng cảm. Vui lòng trả lời bằng giọng điệu khích lệ và tích cực.",speechErrorBrowser:"Trình duyệt này không hỗ trợ nhận dạng giọng nói. Vui lòng sử dụng Chrome/Edge.",speechErrorFail:"Nhận dạng giọng nói thất bại, vui lòng thử lại.",speechErrorNoDetect:"Không phát hiện thấy giọng nói, vui lòng thử lại.",logout:"Đăng xuất",inputPlaceholder:"Hoặc, nhập văn bản trực tiếp... (Enter để gửi)",welcome:n=>`Chào, ${n}. Tôi là người bạn AI của bạn. Bây giờ bạn có thể bắt đầu nói chuyện với tôi!`,welcomePickAvatar:n=>`Chào, ${n}, hãy chọn avatar của tôi và chúng ta hãy trò chuyện thoải mái!`,welcomeChat:(n,e)=>`${n}: Chào, ${e}, hôm nay bạn muốn nói về điều gì?`,whoAmI:"Bạn muốn tôi là ai?",tapToTalk:"Nhấn để bắt đầu trò chuyện thoại...",aiReplying:"AI đang trả lời, nhập tin nhắn mới để ngắt.",recognizing:"Đang nhận dạng..."},th:{friend:"เพื่อน",avatarTitle:"เลือกฉันเป็นเพื่อนของคุณ",companionPhrase:["🕊️ ฉันอยู่ที่นี่ริมทะเล,","ฉันกำลังฟังอยู่"],changeAvatar:"เปลี่ยนอวตารของฉัน",aiReplyTemplate:n=>`แชท AI: ฉันเข้าใจที่คุณหมายถึง, "${n}", เล่าให้ฉันฟังอีกสิ...`,aiSystemPrompt:"คุณเป็นบุคคลเสมือนที่อบอุ่นและเข้าอกเข้าใจ โปรดตอบกลับด้วยน้ำเสียงที่ให้กำลังใจและเป็นบวก",speechErrorBrowser:"เบราว์เซอร์นี้ไม่รองรับการจำแนกเสียงพูด กรุณาใช้ Chrome/Edge",speechErrorFail:"การจำแนกเสียงพูดล้มเหลว กรุณาลองอีกครั้ง",speechErrorNoDetect:"ไม่พบเสียงพูด กรุณาลองอีกครั้ง",logout:"ออกจากระบบ",inputPlaceholder:"หรือพิมพ์ข้อความโดยตรง... (Enter เพื่อส่ง)",welcome:n=>`สวัสดี, ${n}. ฉันคือเพื่อน AI ของคุณ คุณสามารถเริ่มคุยกับฉันได้เลย!`,welcomePickAvatar:n=>`สวัสดี, ${n}, เลือกอวตารของฉันแล้วมาคุยกันอย่างอิสระ!`,welcomeChat:(n,e)=>`${n}: สวัสดี, ${e}, วันนี้คุณอยากคุยเรื่องอะไร?`,whoAmI:"คุณอยากให้ฉันเป็นใคร?",tapToTalk:"แตะเพื่อเริ่มแชทด้วยเสียง...",aiReplying:"AI กำลังตอบกลับ, พิมพ์ข้อความใหม่เพื่อขัดจังหวะ",recognizing:"กำลังจดจำ..."},la:{friend:"Amicus",avatarTitle:"Elige Me ut Amicum Tuum",companionPhrase:["🕊️ Hic adsum ad mare,","Audio."],changeAvatar:"Muta Imaginem Meam",aiReplyTemplate:n=>`AI Curabitur: Intellego quid velis, "${n}", sine me plura a te audire...`,aiSystemPrompt:"Tu es persona virtualis calida et empathetica. Quaeso responde sono hortanti et positivo.",speechErrorBrowser:"Hic navigator recognitionem vocis non sustinet. Quaeso utere Chrome/Edge.",speechErrorFail:"Recognitio vocis defecit, quaeso iterum conare.",speechErrorNoDetect:"Nulla oratio detecta, quaeso iterum conare.",logout:"Exire",inputPlaceholder:"Aut, textum directe scribe... (Enter mittere)",welcome:n=>`Salve, ${n}. Amicus tuus AI sum. Iam potes mecum loqui!`,welcomePickAvatar:n=>`Salve, ${n}, elige imaginem meam et libere loquamur!`,welcomeChat:(n,e)=>`${n}: Salve, ${e}, de quo hodie loqui vis?`,whoAmI:"Quis vis me esse?",tapToTalk:"Tange ut colloquium vocale incipias...",aiReplying:"AI respondet, scribe novum nuntium ad interrumpendum.",recognizing:"Agnoscens..."},ms:{friend:"Kawan",avatarTitle:"Pilih Saya sebagai Kawan Anda",companionPhrase:["🕊️ Saya di sini di tepi laut,","Saya sedang mendengar."],changeAvatar:"Tukar Avatar Saya",aiReplyTemplate:n=>`Sembang AI: Saya faham maksud awak, "${n}", beritahu saya lagi...`,aiSystemPrompt:"Anda adalah orang maya yang mesra dan empati. Sila balas dengan nada yang menggalakkan dan positif.",speechErrorBrowser:"Pelayar ini tidak menyokong pengecaman pertuturan. Sila gunakan Chrome/Edge.",speechErrorFail:"Pengecaman pertuturan gagal, sila cuba lagi.",speechErrorNoDetect:"Tiada pertuturan dikesan, sila cuba lagi.",logout:"Log keluar",inputPlaceholder:"Atau, taip teks secara terus... (Enter untuk hantar)",welcome:n=>`Hai, ${n}. Saya kawan AI anda. Anda boleh mula bercakap dengan saya sekarang!`,welcomePickAvatar:n=>`Hai, ${n}, pilih avatar saya dan mari berbual dengan bebas!`,welcomeChat:(n,e)=>`${n}: Hai, ${e}, apa yang anda mahu bualkan hari ini?`,whoAmI:"Awak nak saya jadi siapa?",tapToTalk:"Ketik untuk memulakan sembang suara...",aiReplying:"AI sedang membalas, taip mesej baru untuk mengganggu.",recognizing:"Mengecam..."}},iB={"zh-TW":"返回","zh-CN":"返回",en:"Back",ja:"戻る",ko:"뒤로",th:"ย้อนกลับ",vi:"Quay lại",ms:"Kembali",la:"Redi"},rB={"zh-TW":"更換頭像","zh-CN":"更换头像",en:"Change Avatar",ja:"アバターを変更",ko:"아바타 변경",th:"เปลี่ยนภาพประจำตัว",vi:"Đổi avatar",ms:"Tukar Avatar",la:"Muta Imaginem"};function sB(){var ct,et,ot,ne,G;const n=$e(),[e,t]=g.useState([]),[i,s]=g.useState(""),[o,a]=g.useState(!1),l=g.useRef(null),c=g.useRef(null),u=g.useRef(null),[h,p]=g.useState(!1),[f,b]=g.useState(!1),[x,S]=g.useState(""),[w,I]=g.useState(!1),[j,A]=g.useState(""),[D,O]=g.useState(""),[P,B]=g.useState(!1),[k,T]=g.useState(!1),[R,E]=g.useState(""),[_,v]=g.useState(""),{lang:z,setLang:H}=Qe(),L=ry[z]||ry["zh-TW"],ee=g.useRef(null),{isTestMode:ge}=ji(),[oe,Ie]=g.useState(!1),Re=g.useRef(null),[te,W]=g.useState(!1),{checkPermission:Y,recordUsage:X}=mo(),[le,be]=g.useState(!1),[ve,Me]=g.useState(!1),[Ve,ie]=g.useState(null),$=()=>{const U=Je().currentUser;return U&&U.displayName||localStorage.getItem("nickname")||L.friend},[We,_e]=g.useState($()),[ye,J]=g.useState(()=>localStorage.getItem("lastUid")),[pe,ce]=g.useState(()=>!localStorage.getItem("avatarWelcomed")),[me,xe]=g.useState(()=>!localStorage.getItem("aiAvatar")),[M,q]=g.useState(""),F=g.useRef(null);g.useEffect(()=>{localStorage.setItem("lang",z),_e($());const U=window.SpeechRecognition||window.webkitSpeechRecognition;U?(ee.current=new U,ee.current.continuous=!0,ee.current.interimResults=!0,ee.current.lang=z,ee.current.onresult=N=>{let V="",he="";for(let fe=N.resultIndex;fe<N.results.length;++fe)N.results[fe].isFinal?he+=N.results[fe][0].transcript:V+=N.results[fe][0].transcript;if(s(_+he+V),he){const fe=_+he;v(ze=>ze+he),(async()=>{const ze={id:`user-${Date.now()}`,text:fe,sender:"user"};t(Ee=>[...Ee,ze]),s(""),l.current&&clearTimeout(l.current);const Ce=`ai-${Date.now()}`;t(Ee=>[...Ee,{id:Ce,text:"",sender:"ai",status:"streaming"}]),a(!0);try{const Ee=await Xd(fe,z,L.aiSystemPrompt,ge);let Ye="";for await(const Xe of Ee)Ye+=Xe,t(dt=>dt.map(tn=>tn.id===Ce?{...tn,text:Ye}:tn));t(Xe=>Xe.map(dt=>dt.id===Ce?{...dt,status:"done"}:dt))}catch(Ee){console.error("Error in AI pipeline: ",Ee);const Ye=Ee instanceof Error?Ee.message:"未知錯誤";t(Xe=>Xe.map(dt=>dt.id===Ce?{...dt,text:`API錯誤：${Ye}`,status:"done"}:dt))}finally{a(!1)}})()}},ee.current.onerror=N=>{console.error("Speech recognition error",N.error);let V="";switch(N.error){case"no-speech":V=L.speechErrorNoDetect;break;case"audio-capture":case"network":V=L.speechErrorFail;break;default:V=""}E(V),T(!1),b(!1)},ee.current.onend=()=>{T(!1)}):E(L.speechErrorBrowser)},[z,L.speechErrorBrowser,L.speechErrorFail,L.speechErrorNoDetect,f,_]),g.useEffect(()=>{ee.current&&(ee.current.onend=()=>{T(!1),oe&&f&&!te&&(Re.current=setTimeout(()=>{!f||te||(i.trim()&&(Ne(i),s(""),v("")),setTimeout(()=>{f&&oe&&!te&&(ee.current.start(),T(!0))},500))},100))})},[oe,f,i,te]),g.useEffect(()=>{var V,he;const U=localStorage.getItem("aiAvatar");U?(S(U),I(!1)):I(!0);const N=(V=Je().currentUser)==null?void 0:V.uid;N!==ye&&(localStorage.removeItem("aiAvatar"),localStorage.removeItem("avatarWelcomed"),S(""),J(N||null),N&&localStorage.setItem("lastUid",N)),Je().currentUser&&_e(((he=Je().currentUser)==null?void 0:he.displayName)||L.friend)},[ye,L.friend]),g.useEffect(()=>{u.current&&(u.current.scrollTop=u.current.scrollHeight)},[e]);const we=U=>{S(U),localStorage.setItem("aiAvatar",U),I(!1),pe&&(t([{id:"welcome-1",text:L.welcomeChat(Fe(U),We),sender:"ai"}]),localStorage.setItem("avatarWelcomed","true"),ce(!1))},Ne=async(U=i)=>{if(!U.trim())return;const N=await Y("aiChat");if(!N.allowed){if(ge){const fe={id:`user-${Date.now()}`,text:U,sender:"user"};t(Ce=>[...Ce,fe]),s(""),v(""),l.current&&clearTimeout(l.current);const ze=`ai-${Date.now()}`;t(Ce=>[...Ce,{id:ze,text:"",sender:"ai",status:"streaming"}]),a(!0);try{const Ce=await Xd(U,z,L.aiSystemPrompt,ge);let Ee="";for await(const Ye of Ce)Ee+=Ye,t(Xe=>Xe.map(dt=>dt.id===ze?{...dt,text:Ee}:dt));t(Ye=>Ye.map(Xe=>Xe.id===ze?{...Xe,status:"done"}:Xe))}catch(Ce){console.error("Error in AI pipeline: ",Ce);const Ee=Ce instanceof Error?Ce.message:"未知錯誤";t(Ye=>Ye.map(Xe=>Xe.id===ze?{...Xe,text:`API錯誤：${Ee}`,status:"done"}:Xe))}finally{a(!1)}return}N.isFreeUser?Me(!0):(N.canRenew,ie(N),be(!0));return}const V={id:`user-${Date.now()}`,text:U,sender:"user"};t(fe=>[...fe,V]),s(""),v(""),l.current&&clearTimeout(l.current);const he=`ai-${Date.now()}`;t(fe=>[...fe,{id:he,text:"",sender:"ai",status:"streaming"}]),a(!0);try{const fe=await Xd(U,z,L.aiSystemPrompt,ge);let ze="";for await(const Ce of fe)ze+=Ce,t(Ee=>Ee.map(Ye=>Ye.id===he?{...Ye,text:ze}:Ye));t(Ce=>Ce.map(Ee=>Ee.id===he?{...Ee,status:"done"}:Ee)),B(!0),await X("aiChat",2)}catch(fe){console.error("Error in AI pipeline: ",fe),t(ze=>ze.map(Ce=>Ce.id===he?{...Ce,text:"Oops, something went wrong.",status:"done"}:Ce))}finally{a(!1),B(!1)}},Fe=U=>{if(!U)return"";const N=U.split("/");return N[N.length-1].replace(/\.png$/i,"")},Ue=async()=>{if(ee.current)if(f||oe||k)ee.current.stop(),b(!1),T(!1),Ie(!1),Re.current&&clearTimeout(Re.current),W(!0);else{const U=await Y("aiChat");if(!U.allowed){if(ge){v(""),s(""),ee.current.start(),b(!0),T(!0),E(""),Ie(!0),W(!1);return}U.isFreeUser?Me(!0):(U.canRenew,ie(U),be(!0));return}v(""),s(""),ee.current.start(),b(!0),T(!0),E(""),Ie(!0),W(!1),await X("aiChat",1)}},Ct=U=>{var V;const N=(V=U.target.files)==null?void 0:V[0];if(N){if(!N.type.startsWith("image/")){alert("請選擇圖片文件");return}if(N.size>5*1024*1024){alert("圖片大小不能超過 5MB");return}const he=new FileReader;he.onload=fe=>{var Ce;const ze=(Ce=fe.target)==null?void 0:Ce.result;q(ze),we(ze)},he.readAsDataURL(N)}},ae=()=>{var U;(U=F.current)==null||U.click()};g.useEffect(()=>{!f&&!oe&&W(!1)},[f,oe]);const Be=()=>{be(!1),ie(null)};return r.jsxs("div",{style:{display:"flex",flexDirection:"column",height:"100vh",backgroundColor:"#f0f2f5"},children:[r.jsxs("header",{style:{display:"flex",flexDirection:"column",backgroundColor:"#fff",borderBottom:"1px solid #ddd",position:"relative",padding:0},children:[r.jsxs("div",{style:{width:"100%",display:"flex",alignItems:"center",justifyContent:"center",padding:"10px 20px 0 20px",position:"relative"},children:[r.jsx("button",{onClick:()=>n(-1),style:{position:"absolute",left:20,background:"#6B5BFF",color:"#fff",border:"none",borderRadius:8,padding:"8px 18px",fontWeight:700,fontSize:16,cursor:"pointer"},children:iB[z]}),r.jsx("span",{className:"ai-name-desktop",style:{fontWeight:700,color:"#ff9800",fontSize:18,marginRight:12,minWidth:50,textAlign:"right",maxWidth:70,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:Fe(x)||L.whoAmI}),r.jsx("div",{style:{fontSize:20,fontWeight:700,textAlign:"center",flexShrink:0},children:"💬 聊天了吧"}),r.jsx("span",{style:{fontWeight:700,color:"#1976d2",fontSize:18,marginLeft:12,minWidth:50,textAlign:"left",maxWidth:70,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:((ct=Je().currentUser)==null?void 0:ct.displayName)||((et=Je().currentUser)==null?void 0:et.email)||"用戶"})]}),r.jsx("div",{style:{textAlign:"center",marginTop:4},children:r.jsx("div",{style:{fontSize:16,color:"#888"},children:"在這裡你可以盡情,暢快,放開地聊😊"})})]}),w&&r.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.8)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:100},children:r.jsxs("div",{style:{background:"#fff",padding:24,borderRadius:12,textAlign:"center",position:"relative"},children:[r.jsx("button",{onClick:()=>I(!1),style:{position:"absolute",top:12,right:12,background:"none",border:"none",fontSize:24,color:"#888",cursor:"pointer",fontWeight:700},children:"×"}),r.jsx("h2",{children:L.avatarTitle}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(5, 1fr)",gap:16,margin:"24px 0"},children:[nB.slice(0,15).map(U=>r.jsx("img",{src:U,alt:Fe(U),onClick:()=>we(U),style:{width:80,height:80,borderRadius:"50%",cursor:"pointer",objectFit:"cover"}},U)),r.jsx("div",{style:{width:80,height:80,borderRadius:"50%",border:"2px dashed #6B5BFF",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",background:"#f8f8ff",color:"#6B5BFF",fontSize:12,fontWeight:600},onClick:ae,children:"上傳心儀頭像"})]}),r.jsx("input",{ref:F,type:"file",accept:"image/*",style:{display:"none"},onChange:Ct})]})}),!x&&!w&&r.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",padding:24,textAlign:"center"},children:[r.jsx("p",{style:{fontSize:18,marginBottom:24},children:L.welcomePickAvatar(We)}),r.jsx("button",{onClick:()=>I(!0),style:{padding:"10px 20px",borderRadius:8,background:"#1877f2",color:"#fff",border:"none",fontWeight:700,fontSize:16},children:L.avatarTitle})]}),x&&r.jsx("main",{ref:u,style:{flex:1,overflowY:"auto",padding:"20px",maxHeight:"calc(100vh - 240px)",scrollBehavior:"smooth",boxSizing:"border-box"},children:r.jsxs("div",{style:{maxWidth:800,margin:"0 auto",minHeight:"100%"},children:[e.length===0&&r.jsx("div",{style:{textAlign:"center",color:"#888",marginTop:40},children:r.jsx("p",{style:{fontSize:18},children:L.welcomeChat(Fe(x),We)})}),e.map(U=>r.jsx("div",{style:{display:"flex",justifyContent:U.sender==="user"?"flex-end":"flex-start",margin:"10px 0",wordWrap:"break-word"},children:r.jsxs("div",{style:{backgroundColor:U.sender==="user"?"#0084ff":"#e4e6eb",color:U.sender==="user"?"#fff":"#000",padding:"12px 16px",borderRadius:18,maxWidth:"70%",wordBreak:"break-word",whiteSpace:"pre-wrap",lineHeight:"1.4"},children:[U.text,U.status==="streaming"&&"..."]})},U.id)),r.jsx("div",{style:{height:"20px"}})]})}),x&&r.jsxs("footer",{style:{padding:"10px 20px 10px 20px",backgroundColor:"#fff",borderTop:"1px solid #ddd",position:"relative",minHeight:"160px",boxSizing:"border-box"},children:[r.jsx("div",{style:{maxWidth:800,margin:"0 auto",display:"flex",alignItems:"flex-start",justifyContent:"center"},children:r.jsxs("div",{style:{flex:1,marginLeft:0,marginRight:0},children:[r.jsxs("div",{className:"mobile-avatars-row",style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:12,padding:"0 8px"},children:[r.jsxs("div",{className:"mobile-ai-avatar",style:{display:"flex",alignItems:"center",gap:8},children:[r.jsx("div",{style:{width:80,height:80,borderRadius:"50% / 45%",border:"4px solid #2196f3",display:"flex",alignItems:"center",justifyContent:"center",background:"#fff",overflow:"hidden"},children:r.jsx("div",{style:{width:72,height:72,minWidth:72,minHeight:72,borderRadius:"50%",overflow:"hidden",position:"relative"},children:r.jsx("div",{style:{width:"100%",height:"100%",position:"relative",overflow:"hidden"},children:r.jsx(jE,{avatar:x,videoUrl:j,audioUrl:D,isSpeaking:P,size:72})})})}),r.jsx("button",{onClick:()=>I(!0),style:{background:"#6B5BFF",color:"#fff",border:"none",borderRadius:6,padding:"4px 8px",fontWeight:600,fontSize:10,cursor:"pointer",boxShadow:"0 2px 4px rgba(107, 91, 255, 0.3)",whiteSpace:"nowrap"},children:rB[z]})]}),r.jsx("div",{style:{flex:1,textAlign:"center",padding:"0 12px"},children:r.jsxs("div",{style:{fontSize:14,color:"#666",lineHeight:"1.4"},children:[r.jsx("span",{style:{fontWeight:700,color:"#ff9800"},children:Fe(x)||"Fenny"}),r.jsx("br",{}),r.jsx("span",{style:{color:"#1976d2"},children:"讓我們來聊天..."}),r.jsx("br",{}),r.jsx("span",{style:{color:"#1976d2"},children:((ot=Je().currentUser)==null?void 0:ot.displayName)||((ne=Je().currentUser)==null?void 0:ne.email)||"用戶"}),r.jsx("br",{}),r.jsx("span",{style:{color:"#666"},children:"聊什麼都可以喔 😊"})]})}),r.jsx("div",{style:{width:80,height:80,borderRadius:"50% / 45%",border:"4px solid #2196f3",display:"flex",alignItems:"center",justifyContent:"center",background:"#fff",overflow:"visible"},children:r.jsx("img",{src:((G=Je().currentUser)==null?void 0:G.photoURL)||"/ctx-logo.png",alt:"user",style:{width:72,height:72,minWidth:72,minHeight:72,borderRadius:"50%",objectFit:"cover",border:"none",verticalAlign:"bottom"}})})]}),r.jsx("div",{style:{display:"flex",alignItems:"flex-end",height:80},children:r.jsx("input",{ref:c,type:"text",value:i,onChange:U=>s(U.target.value),onKeyPress:U=>U.key==="Enter"&&Ne(),placeholder:o?L.aiReplying:L.inputPlaceholder,style:{width:"100%",padding:12,borderRadius:18,border:"1px solid #ccc"},disabled:o||k})}),r.jsxs("div",{className:"chat-action-row-mobile",style:{width:"100%",display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center",marginTop:12,gap:16},children:[r.jsx("button",{onClick:()=>Ne(),disabled:o||!i,style:{padding:"10px 28px",borderRadius:8,border:"none",background:"#1976d2",color:"#fff",fontWeight:700,fontSize:16,cursor:o||!i?"not-allowed":"pointer"},children:"送出"}),r.jsx("button",{onClick:Ue,disabled:o,style:{padding:16,borderRadius:"50%",border:"none",background:f||oe||k?"#ff4d4d":"#1877f2",color:"#fff",cursor:"pointer",fontSize:20},children:f||oe||k?"停止":"🎤"})]}),r.jsxs("div",{className:"chat-action-row-desktop",style:{width:"100%",display:"none",flexDirection:"row",alignItems:"center",justifyContent:"center",marginTop:12,gap:16},children:[r.jsx("button",{onClick:()=>Ne(),disabled:o||!i,style:{padding:"10px 28px",borderRadius:8,border:"none",background:"#1976d2",color:"#fff",fontWeight:700,fontSize:16,cursor:o||!i?"not-allowed":"pointer"},children:"送出"}),r.jsx("button",{onClick:Ue,disabled:o,style:{padding:16,borderRadius:"50%",border:"none",background:f||oe||k?"#ff4d4d":"#1877f2",color:"#fff",cursor:"pointer",fontSize:20},children:f||oe||k?"停止":"🎤"})]}),r.jsxs("div",{style:{height:40,display:"flex",alignItems:"center",justifyContent:"center"},children:[R&&r.jsx("p",{style:{color:"red",margin:0},children:R}),!R&&!i&&!k&&!o&&!f&&!oe&&r.jsx("p",{style:{color:"#888",margin:0,cursor:"pointer"},onClick:Ue,children:L.tapToTalk}),!R&&k&&r.jsx("p",{style:{color:"#888",margin:0},children:L.recognizing}),!R&&(i||o||f||oe)&&r.jsx("p",{style:{color:"transparent",margin:0},children:"佔位"})]})]})}),r.jsx("div",{style:{textAlign:"center",marginTop:10,fontSize:12,color:"#aaa"},children:r.jsxs("p",{children:[L.companionPhrase[0],L.companionPhrase[1]]})})]}),window.innerWidth<=768?r.jsxs("footer",{style:{textAlign:"center",fontSize:12,color:"#888",marginTop:20,padding:12,background:"rgba(255,255,255,0.95)",borderTop:"1px solid #eee",display:"flex",flexDirection:"column",gap:8},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:16,flexWrap:"wrap"},children:[r.jsx("span",{onClick:()=>n("/about"),style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12,cursor:"pointer"},style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:600,fontSize:11},children:z==="zh-TW"?"🧬 我們是誰":z==="zh-CN"?"🧬 我们是谁":z==="en"?"🧬 Who We Are":z==="ja"?"🧬 私たちについて":z==="ko"?"🧬 우리는 누구인가":z==="th"?"🧬 เราเป็นใคร":z==="vi"?"🧬 Chúng tôi là ai":z==="ms"?"🧬 Siapa Kami":"🧬 Quis sumus"}),r.jsx("span",{onClick:()=>n("/privacy-policy"),style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12,cursor:"pointer"},style:{color:"#6B5BFF",textDecoration:"underline",fontSize:11},children:z==="zh-TW"?"隱私權政策":z==="zh-CN"?"隐私政策":z==="en"?"Privacy Policy":z==="ja"?"プライバシーポリシー":z==="ko"?"개인정보 처리방침":z==="th"?"นโยบายความเป็นส่วนตัว":z==="vi"?"Chính sách bảo mật":z==="ms"?"Dasar Privasi":"Consilium de Privata"}),r.jsx("span",{onClick:()=>n("/terms"),style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12,cursor:"pointer"},style:{color:"#6B5BFF",textDecoration:"underline",fontSize:11},children:z==="zh-TW"?"條款/聲明":z==="zh-CN"?"条款/声明":z==="en"?"Terms/Statement":z==="ja"?"規約/声明":z==="ko"?"약관/성명":z==="th"?"ข้อกำหนด/แถลงการณ์":z==="vi"?"Điều khoản/Tuyên bố":z==="ms"?"Terma/Pernyataan":"Termini/Declaratio"})]}),r.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:16,flexWrap:"wrap"},children:[r.jsx("span",{onClick:()=>n("/data-deletion"),style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12,cursor:"pointer"},style:{color:"#6B5BFF",textDecoration:"underline",fontSize:11},children:z==="zh-TW"?"資料刪除說明":z==="zh-CN"?"数据删除说明":z==="en"?"Data Deletion":z==="ja"?"データ削除について":z==="ko"?"데이터 삭제 안내":z==="th"?"คำอธิบายการลบข้อมูล":z==="vi"?"Giải thích xóa dữ liệu":z==="ms"?"Penjelasan Penghapusan Data":"Explicatio Deletionis Datae"}),r.jsx("span",{onClick:()=>n("/feedback"),style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12,cursor:"pointer"},style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:600,fontSize:11},children:z==="zh-TW"?"💬 意見箱":z==="zh-CN"?"💬 意见箱":z==="en"?"💬 Feedback":z==="ja"?"💬 ご意見箱":z==="ko"?"💬 피드백":z==="th"?"💬 กล่องความคิดเห็น":z==="vi"?"💬 Hộp góp ý":z==="ms"?"💬 Kotak Maklum Balas":"💬 Arca Consilii"})]})]}):r.jsx("div",{style:{width:"100%",margin:"0 auto",marginTop:24,background:"rgba(255,255,255,0.95)",borderRadius:16,padding:"16px",boxShadow:"0 2px 12px #6B5BFF22"},children:r.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:20,flexWrap:"wrap"},children:[r.jsx("span",{onClick:()=>n("/about"),style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12,cursor:"pointer"},children:z==="zh-TW"?"🧬 Restarter™｜我們是誰":z==="zh-CN"?"🧬 Restarter™｜我们是谁":z==="en"?"🧬 Restarter™｜Who We Are":z==="ja"?"🧬 Restarter™｜私たちについて":z==="ko"?"🧬 Restarter™｜우리는 누구인가":z==="th"?"🧬 Restarter™｜เราเป็นใคร":z==="vi"?"🧬 Restarter™｜Chúng tôi là ai":z==="ms"?"🧬 Restarter™｜Siapa Kami":"🧬 Restarter™｜Quis sumus"}),r.jsx("span",{onClick:()=>n("/privacy-policy"),style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12,cursor:"pointer"},children:z==="zh-TW"?"隱私權政策":z==="zh-CN"?"隐私政策":z==="en"?"Privacy Policy":z==="ja"?"プライバシーポリシー":z==="ko"?"개인정보 처리방침":z==="th"?"นโยบายความเป็นส่วนตัว":z==="vi"?"Chính sách bảo mật":z==="ms"?"Dasar Privasi":"Consilium de Privata"}),r.jsx("span",{onClick:()=>n("/terms"),style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12,cursor:"pointer"},children:z==="zh-TW"?"條款/聲明":z==="zh-CN"?"条款/声明":z==="en"?"Terms/Statement":z==="ja"?"規約/声明":z==="ko"?"약관/성명":z==="th"?"ข้อกำหนด/แถลงการณ์":z==="vi"?"Điều khoản/Tuyên bố":z==="ms"?"Terma/Pernyataan":"Termini/Declaratio"}),r.jsx("span",{onClick:()=>n("/data-deletion"),style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12,cursor:"pointer"},children:z==="zh-TW"?"資料刪除說明":z==="zh-CN"?"数据删除说明":z==="en"?"Data Deletion":z==="ja"?"データ削除について":z==="ko"?"데이터 삭제 안내":z==="th"?"คำอธิบายการลบข้อมูล":z==="vi"?"Giải thích xóa dữ liệu":z==="ms"?"Penjelasan Penghapusan Data":"Explicatio Deletionis Datae"}),r.jsx("span",{onClick:()=>n("/feedback"),style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12,cursor:"pointer"},children:z==="zh-TW"?"💬 意見箱｜我們想聽你說":z==="zh-CN"?"💬 意见箱｜我们想听你说":z==="en"?"💬 Feedback Box｜We Want to Hear From You":z==="ja"?"💬 ご意見箱｜私たちはあなたの声を聞きたい":z==="ko"?"💬 피드백｜우리는 당신의 말을 듣고 싶습니다":z==="th"?"💬 กล่องความคิดเห็น｜เราอยากได้ยินจากคุณ":z==="vi"?"💬 Hộp góp ý｜Chúng tôi muốn nghe từ bạn":z==="ms"?"💬 Kotak Maklum Balas｜Kami Ingin Mendengar Dari Anda":"💬 Arca Consilii｜Volumus Audire a Te"})]})}),le&&Ve&&r.jsx(es,{isOpen:le,onClose:Be,currentPlan:Ve.currentPlan,remainingDays:Ve.remainingDays,usedTokens:Ve.usedTokens,totalTokens:Ve.totalTokens}),ve&&r.jsx(Cw,{isOpen:ve,onClose:()=>Me(!1),featureName:"AI 聊天"})]})}const oB="modulepreload",aB=function(n){return"/"+n},sy={},Ys=function(e,t,i){let s=Promise.resolve();if(t&&t.length>0){let a=function(u){return Promise.all(u.map(h=>Promise.resolve(h).then(p=>({status:"fulfilled",value:p}),p=>({status:"rejected",reason:p}))))};document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),c=(l==null?void 0:l.nonce)||(l==null?void 0:l.getAttribute("nonce"));s=a(t.map(u=>{if(u=aB(u),u in sy)return;sy[u]=!0;const h=u.endsWith(".css"),p=h?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${p}`))return;const f=document.createElement("link");if(f.rel=h?"stylesheet":oB,h||(f.as="script"),f.crossOrigin="",f.href=u,c&&f.setAttribute("nonce",c),document.head.appendChild(f),h)return new Promise((b,x)=>{f.addEventListener("load",b),f.addEventListener("error",()=>x(new Error(`Unable to preload CSS for ${u}`)))})}))}function o(a){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=a,window.dispatchEvent(l),!l.defaultPrevented)throw a}return s.then(a=>{for(const l of a||[])l.status==="rejected"&&o(l.reason);return e().catch(o)})},br=Je(Ti),lB={"zh-TW":{heroLeftTop:"救贖不是罪，",heroLeftMain:"只是走錯太久。",heroLeftSub:"",heroLeftYellow:"野花昂首盡綻放！",heroRightTop:"我要重新開始...",heroRightMain:"每一次的經歷，都是獨一無二的篇章",heroRightSub:"而不是成長的絆腳石。",heroRightYellow:"從灰燼中重生！",title:"Restarter™ 註冊",email:"電子郵件 *必填",password:"密碼(至少6位，含英文及數字)*必填",nickname:"暱稱*必填",age:"年齡*選填",selectAge:"請選擇年齡區間*必選",country:"國家(地區)*必選",city:"城市(可選)",interest:"興趣*選填",eventType:"經歷事件**選填",whatToImprove:"想改善什麼*選填",uploadAvatar:"上傳頭像",male:"男",female:"女",genderRequired:"(必選)",register:"🚀 註冊",registering:"註冊中...",errorAvatar:"請上傳頭像",errorGender:"請選擇性別",errorEmailFormat:"電子郵件格式無效",errorPasswordFormat:"密碼必須至少8個字符，且包含字母和數字",errorNicknameFormat:"暱稱必須是6-16個字符",errorAgeFormat:"年齡必須在18到99歲之間",errorCountry:"請選擇國家/地區",errorRegion:"請輸入城市",errorInterest:"請選擇興趣",errorEventType:"請選擇事件類型",errorImprovement:"請選擇想改善的項目",formTopSlogan:"你來了，就值得被歡迎！",login:"登入",terms:"條款/聲明",privacy:"隱私權政策",deletion:"資料刪除說明",googleLogin:"使用 Google 登入",appleLogin:"使用 Apple 登入"},"zh-CN":{heroLeftTop:"救赎不是罪，",heroLeftMain:"只是走错太久。",heroLeftSub:"",heroLeftYellow:"野花昂首尽绽放！",heroRightTop:"我要重新开始...",heroRightMain:"每一次的经历，都是独一无二的篇章",heroRightSub:"而不是成长的绊脚石。",heroRightYellow:"从灰烬中重生！",title:"Restarter™ 注册",email:"电子邮件 *必填",password:"密码 (至少8位，含英文及数字) *必填",nickname:"昵称 (6-16字) *必填",age:"年龄*选填",selectAge:"请选择年龄区间*必选",country:"国家(地区)*必选",city:"城市(可选)",interest:"兴趣*选填",eventType:"经历事件**选填",whatToImprove:"想改善什么*选填",uploadAvatar:"上传头像",male:"男",female:"女",genderRequired:"(必选)",register:"🚀 注册",registering:"注册中...",errorAvatar:"请上传头像",errorGender:"请选择性别",errorEmailFormat:"电子邮件格式无效",errorPasswordFormat:"密码必须至少8个字符，且包含字母和数字",errorNicknameFormat:"昵称必须是6-16个字符",errorAgeFormat:"年龄必须在18到99岁之间",errorCountry:"请选择国家/地区",errorRegion:"请输入城市",errorInterest:"请选择兴趣",errorEventType:"请选择事件类型",errorImprovement:"请选择想改善的项目",formTopSlogan:"你來了，就值得被歡迎！",login:"登录",terms:"条款/声明",privacy:"隐私政策",deletion:"数据删除说明",googleLogin:"使用 Google 登录",appleLogin:"使用 Apple 登录"},en:{heroLeftTop:"Redemption is not a crime,",heroLeftMain:"just went down the wrong path for too long.",heroLeftSub:"",heroLeftYellow:"Wildflowers bloom bravely!",heroRightTop:"I want a new start...",heroRightMain:"Every experience is a unique chapter,",heroRightSub:"not a barrier to growth.",heroRightYellow:"Rise from the ashes!",title:"Restarter™ Registration",email:"Email *required",password:"Password (min 8 chars, letter & number) *required",nickname:"Nickname (6-16 chars) *required",age:"Age*optional",selectAge:"Select age range",country:"Country (Region)*optional",city:"City (optional)",interest:"Interest*optional",eventType:"History Event**optional",whatToImprove:"What to improve*optional",uploadAvatar:"Upload Avatar",male:"Male",female:"Female",genderRequired:"(*required)",register:"🚀 Register",registering:"Registering...",errorAvatar:"Please upload an avatar.",errorGender:"Please select a gender.",errorEmailFormat:"Invalid email format.",errorPasswordFormat:"Password must be at least 8 characters long and contain both letters and numbers.",errorNicknameFormat:"Nickname must be 6-16 characters long.",errorAgeFormat:"Age must be between 18 and 99.",errorCountry:"Please select a country.",errorRegion:"Please enter a city.",errorInterest:"Please select an interest.",errorEventType:"Please select an event type.",errorImprovement:"Please select an item to improve.",formTopSlogan:"It's not wrong to rise up!",login:"Login",terms:"Terms/Statement",privacy:"Privacy Policy",deletion:"Data Deletion",googleLogin:"Sign in with Google",appleLogin:"Sign in with Apple"},ja:{heroLeftTop:"贖いは罪ではない、",heroLeftMain:"ただ道に迷った時間が長すぎただけだ。",heroLeftSub:"",heroLeftYellow:"野の花も堂々と咲く！",heroRightTop:"私は新しく始めたい...",heroRightMain:"一つ一つの経験が、ユニークな章であり、",heroRightSub:"成長の障害ではない。",heroRightYellow:"灰の中から蘇れ！",title:"Restarter™ 登録",email:"メールアドレス *必須",password:"パスワード (8文字以上、英数字を含む) *必須",nickname:"ニックネーム (6-16文字) *必須",age:"年齢*任意",selectAge:"年齢層を選択",country:"国/地域*任意",city:"都市(任意)",interest:"興味*任意",eventType:"経験した出来事**任意",whatToImprove:"改善したいこと*任意",uploadAvatar:"アバターをアップロード",male:"男性",female:"女性",genderRequired:"(*必須)",register:"🚀 登録",registering:"登録中...",errorAvatar:"アバターをアップロードしてください。",errorGender:"性別を選択してください。",errorEmailFormat:"無効なメール形式です。",errorPasswordFormat:"パスワードは8文字以上で、文字と数字の両方を含める必要があります。",errorNicknameFormat:"ニックネームは6～16文字である必要があります。",errorAgeFormat:"年齢は18歳から99歳の間でなければなりません。",errorCountry:"国を選択してください。",errorRegion:"都市を入力してください。",errorInterest:"興味を選択してください。",errorEventType:"イベントタイプを選択してください。",errorImprovement:"改善したい項目を選択してください。",formTopSlogan:"立ち上がることは間違いじゃない！",login:"ログイン",terms:"規約/声明",privacy:"プライバシーポリシー",deletion:"データ削除について",googleLogin:"Googleでログイン",appleLogin:"Appleでログイン"},ko:{heroLeftTop:"구원은 죄가 아니며,",heroLeftMain:"그저 너무 오랫동안 길을 잃었을 뿐이다.",heroLeftSub:"",heroLeftYellow:"들꽃은 용감하게 핀다!",heroRightTop:"새로운 시작을 원해...",heroRightMain:"모든 경험은 독특한 장이며,",heroRightSub:"성장의 장벽이 아니다.",heroRightYellow:"잿더미에서 일어나라!",title:"Restarter™ 회원가입",email:"이메일 *필수",password:"비밀번호 (최소 8자, 영문/숫자 포함) *필수",nickname:"닉네임 (6-16자) *필수",age:"나이*선택",selectAge:"연령대 선택",country:"국가/지역*선택",city:"도시(선택 사항)",interest:"관심사*선택",eventType:"경험한 사건**선택",whatToImprove:"개선하고 싶은 점*선택",uploadAvatar:"아바타 업로드",male:"남성",female:"여성",genderRequired:"(*필수)",register:"🚀 가입하기",registering:"가입 중...",errorAvatar:"아바타를 업로드해주세요.",errorGender:"성별을 선택해주세요.",errorEmailFormat:"유효하지 않은 이메일 형식입니다.",errorPasswordFormat:"비밀번호는 최소 8자 이상이며, 문자와 숫자를 모두 포함해야 합니다.",errorNicknameFormat:"닉네임은 6-16자여야 합니다.",errorAgeFormat:"나이는 18세에서 99세 사이여야 합니다.",errorCountry:"국가를 선택해주세요.",errorRegion:"도시를 입력해주세요.",errorInterest:"관심사를 선택해주세요.",errorEventType:"사건 유형을 선택해주세요.",errorImprovement:"개선할 항목을 선택해주세요.",formTopSlogan:"일어서는 것은 잘못이 아니야!",login:"로그인",terms:"약관/성명서",privacy:"개인정보처리방침",deletion:"데이터 삭제 안내",googleLogin:"Google로 로그인",appleLogin:"Apple로 로그인"},th:{heroLeftTop:"การไถ่บาปไม่ใช่ความผิด",heroLeftMain:"เพียงแค่หลงทางมานานเกินไป",heroLeftSub:"",heroLeftYellow:"ดอกไม้ป่าบานอย่างกล้าหาญ!",heroRightTop:"ฉันต้องการเริ่มต้นใหม่...",heroRightMain:"ทุกประสบการณ์คือบทที่พิเศษ",heroRightSub:"ไม่ใช่อุปสรรคต่อการเติบโต",heroRightYellow:"ลุกขึ้นจากเถ้าถ่าน!",title:"Restarter™ ลงทะเบียน",email:"อีเมล *จำเป็น",password:"รหัสผ่าน (ขั้นต่ำ 8 ตัวอักษร, ประกอบด้วยตัวอักษรและตัวเลข) *จำเป็น",nickname:"ชื่อเล่น (6-16 ตัวอักษร) *จำเป็น",age:"อายุ*ไม่บังคับ",selectAge:"เลือกช่วงอายุ",country:"ประเทศ/ภูมิภาค*ไม่บังคับ",city:"เมือง (ไม่บังคับ)",interest:"ความสนใจ*ไม่บังคับ",eventType:"เหตุการณ์ที่ผ่านมา**ไม่บังคับ",whatToImprove:"สิ่งที่ต้องการปรับปรุง*ไม่บังคับ",uploadAvatar:"อัปโหลดรูปภาพ",male:"ชาย",female:"หญิง",genderRequired:"(*จำเป็น)",register:"🚀 ลงทะเบียน",registering:"กำลังลงทะเบียน...",errorAvatar:"กรุณาอัปโหลดรูปโปรไฟล์",errorGender:"กรุณาเลือกเพศ",errorEmailFormat:"รูปแบบอีเมลไม่ถูกต้อง",errorPasswordFormat:"รหัสผ่านต้องมีความยาวอย่างน้อย 8 ตัวอักษรและมีทั้งตัวอักษรและตัวเลข",errorNicknameFormat:"ชื่อเล่นต้องมีความยาว 6-16 ตัวอักษร",errorAgeFormat:"อายุต้องอยู่ระหว่าง 18 ถึง 99 ปี",errorCountry:"กรุณาเลือกประเทศ",errorRegion:"กรุณากรอกเมือง",errorInterest:"กรุณาเลือกความสนใจ",errorEventType:"กรุณาเลือกประเภทเหตุการณ์",errorImprovement:"กรุณาเลือกรายการที่ต้องการปรับปรุง",formTopSlogan:"การลุกขึ้นสู้ไม่ใช่เรื่องผิด!",login:"เข้าสู่ระบบ",terms:"ข้อกำหนด/คำชี้แจง",privacy:"นโยบายความเป็นส่วนตัว",deletion:"นโยบายการลบข้อมูล",googleLogin:"เข้าสู่ระบบด้วย Google",appleLogin:"เข้าสู่ระบบด้วย Apple"},vi:{heroLeftTop:"Sự chuộc lỗi không phải là tội ác,",heroLeftMain:"chỉ là đi sai đường quá lâu.",heroLeftSub:"",heroLeftYellow:"Hoa dại nở rộ dũng cảm!",heroRightTop:"Tôi muốn một khởi đầu mới...",heroRightMain:"Mỗi trải nghiệm là một chương độc đáo,",heroRightSub:"Không phải là rào cản cho sự phát triển.",heroRightYellow:"Vươn lên từ đống tro tàn!",title:"Đăng ký Restarter™",email:"Email *bắt buộc",password:"Mật khẩu (tối thiểu 8 ký tự, gồm chữ và số) *bắt buộc",nickname:"Biệt danh (6-16 ký tự) *bắt buộc",age:"Tuổi*không bắt buộc",selectAge:"Chọn độ tuổi",country:"Quốc gia/Khu vực*không bắt buộc",city:"Thành phố (tùy chọn)",interest:"Sở thích*không bắt buộc",eventType:"Sự kiện đã trải qua**không bắt buộc",whatToImprove:"Điều muốn cải thiện*không bắt buộc",uploadAvatar:"Tải lên hình đại diện",male:"Nam",female:"Nữ",genderRequired:"(*bắt buộc)",register:"🚀 Đăng ký",registering:"Đang đăng ký...",errorAvatar:"Vui lòng tải lên ảnh đại diện.",errorGender:"Vui lòng chọn giới tính.",errorEmailFormat:"Định dạng email không hợp lệ.",errorPasswordFormat:"Mật khẩu phải dài ít nhất 8 ký tự và chứa cả chữ cái và số.",errorNicknameFormat:"Biệt danh phải dài từ 6-16 ký tự.",errorAgeFormat:"Tuổi phải từ 18 đến 99.",errorCountry:"Vui lòng chọn một quốc gia.",errorRegion:"Vui lòng nhập thành phố.",errorInterest:"Vui lòng chọn một sở thích.",errorEventType:"Vui lòng chọn một loại sự kiện.",errorImprovement:"Vui lòng chọn một mục để cải thiện.",formTopSlogan:"Vươn lên không phải là sai!",login:"Đăng nhập",terms:"Điều khoản/Tuyên bố",privacy:"Chính sách bảo mật",deletion:"Chính sách xóa dữ liệu",googleLogin:"Đăng nhập bằng Google",appleLogin:"Đăng nhập bằng Apple"},ms:{heroLeftTop:"Penebusan bukanlah jenayah,",heroLeftMain:"hanya tersalah jalan terlalu lama.",heroLeftSub:"",heroLeftYellow:"Bunga liar mekar dengan berani!",heroRightTop:"Saya mahu permulaan yang baru...",heroRightMain:"Setiap pengalaman adalah satu bab yang unik,",heroRightSub:"bukan penghalang kepada pertumbuhan.",heroRightYellow:"Bangkit dari abu!",title:"Pendaftaran Restarter™",email:"E-mel *diperlukan",password:"Kata laluan (min 8 aksara, huruf & nombor) *diperlukan",nickname:"Nama samaran (6-16 aksara) *diperlukan",age:"Umur*pilihan",selectAge:"Pilih julat umur",country:"Negara/Wilayah*pilihan",city:"Bandar (pilihan)",interest:"Minat*pilihan",eventType:"Peristiwa Bersejarah**pilihan",whatToImprove:"Apa yang ingin diperbaiki*pilihan",uploadAvatar:"Muat naik gambar profil",male:"Lelaki",female:"Perempuan",genderRequired:"(*diperlukan)",register:"🚀 Daftar",registering:"Mendaftar...",errorAvatar:"Sila muat naik avatar.",errorGender:"Sila pilih jantina.",errorEmailFormat:"Format e-mel tidak sah.",errorPasswordFormat:"Kata laluan mesti sekurang-kurangnya 8 aksara dan mengandungi kedua-dua huruf dan nombor.",errorNicknameFormat:"Nama samaran mestilah 6-16 aksara.",errorAgeFormat:"Umur mestilah antara 18 dan 99.",errorCountry:"Sila pilih negara.",errorRegion:"Sila masukkan bandar.",errorInterest:"Sila pilih minat.",errorEventType:"Sila pilih jenis acara.",errorImprovement:"Sila pilih item untuk diperbaiki.",formTopSlogan:"Bukan salah untuk bangkit!",login:"Log masuk",terms:"Terma/Penyata",privacy:"Dasar Privasi",deletion:"Dasar Pemadaman Data",googleLogin:"Log masuk dengan Google",appleLogin:"Log masuk dengan Apple"},la:{heroLeftTop:"Redemptio non est crimen,",heroLeftMain:"modo errasse diu.",heroLeftSub:"",heroLeftYellow:"Flores feri fortiter efflorescunt!",heroRightTop:"Novum initium volo...",heroRightMain:"Omnis experientia unicum capitulum est,",heroRightSub:"non impedimentum incrementi.",heroRightYellow:"Resurge ex cineribus!",title:"Restarter™ Inscriptio",email:"Email *requiritur",password:"Password (min 8 chars, letter & number) *requiritur",nickname:"Nickname (6-16 chars) *requiritur",age:"Aetas*optio",selectAge:"Selecta aetatis spatium",country:"Patria (Regio)*optio",city:"Urbs (optio)",interest:"Studium*optio",eventType:"Eventus Historiae**optio",whatToImprove:"Quid emendare vis*optio",uploadAvatar:"Upload Avatar",male:"Male",female:"Female",genderRequired:"(*required)",register:"🚀 Register",registering:"Registering...",errorAvatar:"Please upload an avatar.",errorGender:"Please select a gender.",errorEmailFormat:"Invalid email format.",errorPasswordFormat:"Password must be at least 8 characters long and contain both letters and numbers.",errorNicknameFormat:"Nickname must be 6-16 characters long.",errorAgeFormat:"Age must be between 18 and 99.",errorCountry:"Please select a country.",errorRegion:"Please enter a city.",errorInterest:"Please select an interest.",errorEventType:"Please select an event type.",errorImprovement:"Please select an item to improve.",formTopSlogan:"Surgere non est peccatum!",login:"Inire",terms:"Termini/Declaratio",privacy:"Consilium Privacy",deletion:"Norma Deletionis Datae",googleLogin:"Intra cum Google",appleLogin:"Intra cum Apple"}},oy={"zh-TW":"請先補齊個人資料","zh-CN":"请先补齐个人资料",en:"Please complete your profile first",ja:"まずプロフィールを完成させてください",ko:"먼저 프로필을 완성해 주세요",th:"กรุณากรอกข้อมูลส่วนตัวให้ครบก่อน",vi:"Vui lòng hoàn thiện hồ sơ cá nhân trước",ms:"Sila lengkapkan profil anda terlebih dahulu",la:"Quaeso prius profile tuum comple"},ay={"zh-TW":"每一位更生人，都是世界的一員！","zh-CN":"每一位更生人，都是世界的一员！",en:"Every Restarter is still one of us.",ja:"すべての更生者は世界の一員です！",ko:"모든 Restarter는 우리 중 한 명입니다!",th:"ทุกคนที่ถูกกำพฤติกรรมก็ยังเป็นหนึ่งของเรา!",vi:"Mỗi người được định hình đều là một thành viên của chúng tôi!",ms:"Setiap Restarter masih satu di antara kita!",la:"Omnis Restarter adhuc unus ex nobis est."},cB={"zh-TW":"Restarter™ 是更生者的 副駕 / 合作人。","zh-CN":"Restarter™ 是更生者的 副驾 / 合作人。",en:"Restarter™ is a co-pilot/partner for Restarters.",ja:"Restarter™ は更生者の副操縦士・パートナーです。",ko:"Restarter™는 재생자의 부승무 또는 파트너입니다.",th:"Restarter™ เป็นคู่ควบคุมหรือพาร์ทเนอร์สำหรับ Restarters.",vi:"Restarter™ là phi công phụ hoặc đối tác cho Restarters.",ms:"Restarter™ adalah kopilot/pasukan untuk Restarters.",la:"Restarter™ est co-pilotus/socius pro Restarters."},dB={"zh-TW":"Restarter™ 是更生者的情緒管家 / 生產助手","zh-CN":"Restarter™ 是更生者的情绪管家 / 生产助手",en:"Restarter™ is an emotional steward/productivity assistant for Restarters.",ja:"Restarter™ は更生者の感情マネージャー・生産アシスタントです。",ko:"Restarter™는 재생자의 감정 관리자 및 생산 보조자입니다.",th:"Restarter™ เป็นผู้ดูแลอารมณ์และผู้ช่วยในการผลิตสำหรับ Restarters.",vi:"Restarter™ là người quản lý cảm xúc và người trợ giúp sản xuất cho Restarters.",ms:"Restarter™ adalah pengurus emosi / pembantu produktiviti untuk Restarters.",la:"Restarter™ est motus oeconomus/producentis adiutor pro Restarters."},tk={"zh-TW":["經濟","運動","閱讀","電影","旅遊","交友","唱歌","電商","做生意","電腦","AI","寵物","學技能","一個人安靜","其他"],"zh-CN":["经济","运动","阅读","电影","旅游","交友","唱歌","电商","做生意","电脑","AI","宠物","学技能","一个人安静","其他"],en:["Economy","Sports","Reading","Movie","Travel","Friendship","Singing","E-commerce","Business","Computer","AI","Pets","Learning Skills","Quiet time alone","Other"],ja:["経済","スポーツ","読書","映画","旅行","友達","カラオケ","EC","ビジネス","パソコン","AI","ペット","スキル学習","一人で静かに過ごす","その他"],ko:["경제","스포츠","독서","영화","여행","친구 사귀기","노래 부르기","전자상거래","사업","컴퓨터","AI","애완동물","기술 배우기","혼자 조용히 있기","기타"],th:["เศรษฐกิจ","กีฬา","การอ่าน","ภาพยนตร์","การเดินทาง","มิตรภาพ","การร้องเพลง","อีคอมเมิร์ซ","ธุรกิจ","คอมพิวเตอร์","AI","สัตว์เลี้ยง","การเรียนรู้ทักษะ","เวลาเงียบๆคนเดียว","อื่นๆ"],vi:["Kinh tế","Thể thao","Đọc sách","Phim ảnh","Du lịch","Tình bạn","Ca hát","Thương mại điện tử","Kinh doanh","Máy tính","AI","Thú cưng","Học kỹ năng","Ở một mình yên tĩnh","Khác"],ms:["Ekonomi","Sukan","Membaca","Filem","Melancong","Persahabatan","Menyanyi","E-dagang","Perniagaan","Komputer","AI","Haiwan Peliharaan","Belajar Kemahiran","Masa sunyi bersendirian","Lain-lain"],la:["Oeconomia","Ludi","Lectio","Pellicula","Iter","Amicitia","Cantus","E-commercium","Negotium","Computatrum","AI","Animalia Domestica","Discere Artes","Tempus quietum solus","Aliud"]},nk={"zh-TW":["台灣","中國大陸","日本","韓國","馬來西亞","新加坡","印尼","越南","菲律賓","英國","法國","德國","美國","加拿大","非洲","歐洲","南美洲","中東","其他"],"zh-CN":["台湾","中国大陆","日本","韩国","马来西亚","新加坡","印尼","越南","菲律宾","英国","法国","德国","美国","加拿大","非洲","欧洲","南美洲","中东","其他"],en:["Taiwan","China","Japan","Korea","Malaysia","Singapore","Indonesia","Vietnam","Philippines","UK","France","Germany","USA","Canada","Africa","Europe","South America","Middle East","Other"],ja:["台湾","中国","日本","韓国","マレーシア","シンガポール","インドネシア","ベトナム","フィリピン","イギリス","フランス","ドイツ","アメリカ","カナダ","アフリカ","ヨーロッパ","南アメリカ","中東","その他"],ko:["대만","중국","일본","한국","말레이시아","싱가포르","인도네시아","베트남","필리핀","영국","프랑스","독일","미국","캐나다","아프리카","유럽","남아메리카","중동","기타"],th:["ไต้หวัน","จีน","ญี่ปุ่น","เกาหลี","มาเลเซีย","สิงคโปร์","อินโดนีเซีย","เวียดนาม","ฟิลิปปินส์","สหราชอาณาจักร","ฝรั่งเศส","เยอรมนี","สหรัฐอเมริกา","แคนาดา","แอฟริกา","ยุโรป","อเมริกาใต้","ตะวันออกกลาง","อื่นๆ"],vi:["Đài Loan","Trung Quốc","Nhật Bản","Hàn Quốc","Malaysia","Singapore","Indonesia","Việt Nam","Philippines","Anh","Pháp","Đức","Mỹ","Canada","Châu Phi","Châu Âu","Nam Mỹ","Trung Đông","Khác"],ms:["Taiwan","China","Jepun","Korea","Malaysia","Singapura","Indonesia","Vietnam","Filipina","UK","Perancis","Jerman","AS","Kanada","Afrika","Eropah","Amerika Selatan","Timur Tengah","Lain-lain"],la:["Taivania","Sina","Iaponia","Corea","Malaisia","Singapura","Indonesia","Vietnamia","Philippinae","UK","Gallia","Germania","USA","Canada","Africa","Europa","America Meridionalis","Oriens Medius","Aliud"]},uB={"zh-TW":["經濟事件","毒品濫用","暴力事件","家暴加害","家暴受害","幫派背景","詐欺相關","竊盜前科","性別/身體創傷","未成年犯罪","長期失業 / 社會邊緣","其他"]},hB={"zh-TW":["人際","鬥志","習慣","工作","情緒","自律","其他"],"zh-CN":["人际","斗志","习惯","工作","情绪","自律","其他"],en:["Interpersonal","Motivation","Habits","Work","Emotions","Self-discipline","Other"],ja:["人間関係","闘志","習慣","仕事","感情","自己規律","その他"],ko:["대인관계","투지","습관","업무","감정","자기관리","기타"],th:["ความสัมพันธ์ระหว่างบุคคล","แรงจูงใจ","นิสัย","การงาน","อารมณ์","การมีวินัยในตนเอง","อื่นๆ"],vi:["Quan hệ giữa các cá nhân","Ý chí chiến đấu","Thói quen","Công việc","Cảm xúc","Kỷ luật tự giác","Khác"],ms:["Antara peribadi","Semangat juang","Tabiat","Kerja","Emosi","Disiplin diri","Lain-lain"],la:["Interpersonalis","Animus","Consuetudines","Opus","Affectus","Disciplina sui","Aliud"]},ik=["18-24","25-29","30-34","35-39","40-44","45-49","50-54","55-59","60-64","65-69","70+"];function pB(n){return/^[^@\s]+@[^@\s]+\.[^@\s]+$/.test(n)}function mB(n){return/^(?=.*[A-Za-z])(?=.*\d)[A-Za-z\d]{6,}$/.test(n)}function gB(n){return!(!n||n.trim()==="")}function ly(n){if(!n)return null;const e=n.match(/^(Restarter™)(.*)$/);return e?r.jsxs("span",{children:[r.jsx("span",{style:{color:"#fff",fontWeight:700},children:"Restarter™"}),r.jsx("span",{style:{color:"#ffd700",fontWeight:700},children:e[2]})]}):n}function fB({t:n,setShowLogin:e,navigate:t,setShowReset:i}){const[s,o]=g.useState(""),[a,l]=g.useState(""),[c,u]=g.useState(""),h=async p=>{p.preventDefault(),u("");try{await(await Ov(br,s,a)).user.reload(),e(!1),t("/")}catch(f){f.code==="auth/user-not-found"||f.code==="auth/wrong-password"||f.code==="auth/invalid-credential"?u("帳號或密碼錯誤，請重新確認"):f.code==="auth/user-disabled"?u("此帳號已被停用，請聯絡客服"):u(f.message||"登入失敗，請稍後再試")}};return r.jsx("div",{style:{position:"fixed",top:0,left:0,width:"100%",height:"100%",background:"rgba(0,0,0,0.6)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:200},children:r.jsxs("div",{style:{background:"white",padding:32,borderRadius:16,width:"90%",maxWidth:400,position:"relative",boxShadow:"0 8px 32px #0000004d"},children:[r.jsx("button",{onClick:()=>e(!1),style:{position:"absolute",top:8,right:12,background:"none",border:"none",fontSize:28,cursor:"pointer",color:"#888"},children:"×"}),r.jsx("h2",{style:{textAlign:"center",color:"#333",marginBottom:24},children:n.login}),c&&r.jsx("p",{style:{color:"red",textAlign:"center",marginBottom:"1rem"},children:c}),r.jsxs("form",{onSubmit:h,children:[r.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:16},children:[r.jsx("input",{type:"email",autoComplete:"off",placeholder:n.email,value:s,onChange:p=>o(p.target.value),className:"reg-input",required:!0}),r.jsx("input",{type:"password",autoComplete:"off",placeholder:n.password,value:a,onChange:p=>l(p.target.value),className:"reg-input",required:!0})]}),r.jsx("button",{type:"submit",style:{width:"100%",marginTop:24,background:"linear-gradient(90deg, #6e8efb, #a777e3)",color:"white",border:"none",borderRadius:8,padding:"14px 0",fontSize:18,fontWeight:700,cursor:"pointer"},children:n.login}),r.jsx("div",{style:{textAlign:"right",marginTop:8},children:r.jsx("span",{href:"#",style:{color:"#6B5BFF",fontSize:14,textDecoration:"underline",cursor:"pointer"},onClick:p=>{p.preventDefault(),i(!0)},children:"忘記密碼？"})})]})]})})}const Fo={border:"none",borderRadius:28,padding:0,fontSize:16,fontWeight:800,cursor:"pointer",boxShadow:"0 2px 12px #a777e355",display:"flex",alignItems:"center",justifyContent:"center",gap:8,width:"100%",height:"40px"},cy={width:18,height:18,marginRight:6,verticalAlign:"middle"};function yB(){const n=$e(),e=xa(),t=new URLSearchParams(e.search),{lang:i,setLang:s}=Qe();g.useEffect(()=>{localStorage.setItem("lang",i)},[i]),g.useEffect(()=>{Ys(async()=>{const{getAuth:ne}=await Promise.resolve().then(()=>Ef);return{getAuth:ne}},void 0).then(({getAuth:ne})=>{ne().currentUser&&n("/")})},[n]),g.useEffect(()=>{(async()=>{var G;try{const{getRedirectResult:U}=await Ys(async()=>{const{getRedirectResult:V}=await Promise.resolve().then(()=>Ef);return{getRedirectResult:V}},void 0),N=await U(br);if(N){console.log("Redirect 登入成功，user.uid:",N.user.uid),await N.user.reload(),console.log("user reload 完成");const V=await fi(Ot(ht,"users",N.user.uid));console.log("Firestore 查詢結果:",{exists:V.exists(),data:V.data(),completed:(G=V.data())==null?void 0:G.completed}),!V.exists()||!V.data()||!V.data().completed?(console.log("導向 /CompleteProfile"),n("/CompleteProfile")):(console.log("導向首頁 /"),n("/"))}}catch(U){console.error("處理 redirect 結果時發生錯誤:",U)}})()},[n]);const o=t.get("needProfile")==="1",a=lB[i],[l,c]=g.useState(""),[u,h]=g.useState(""),[p,f]=g.useState(""),[b,x]=g.useState(""),[S,w]=g.useState(""),[I,j]=g.useState(""),[A,D]=g.useState(""),[O,P]=g.useState(null),[B,k]=g.useState(""),[T,R]=g.useState(""),[E,_]=g.useState(!1),[v,z]=g.useState(""),[H,L]=g.useState(""),[ee,ge]=g.useState(!1),[oe,Ie]=g.useState(0),[Re,te]=g.useState("idle"),[W,Y]=g.useState(""),X=g.useRef(null),le=g.useRef(null);g.useEffect(()=>{if(!E)return;const ne=setInterval(()=>{Ie(G=>(G+1)%4)},400);return()=>clearInterval(ne)},[E]);const[be,ve]=g.useState(!1),[Me,Ve]=g.useState(!1),[ie,$]=g.useState(!1),[We,_e]=g.useState(!1),[ye,J]=g.useState(""),[pe,ce]=g.useState(!1),[me,xe]=g.useState(!1),M=async()=>{if(console.log("按鈕被點擊！驗證碼:",ye),!ye){R("請輸入驗證碼");return}console.log("前端發送驗證碼:",ye),console.log("前端發送 email:",l);try{const ne={nickname:p,password:u,gender:A,country:b,region:S,age:I,interest:v,improvement:H},G=await fetch(ea("/email-verification/verify-code"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:l,code:ye})});console.log("驗證 API 回應狀態:",G.status);const U=await G.json();console.log("驗證 API 回應資料:",U),U.success?await we():R(U.error||"驗證失敗")}catch(ne){R(ne.message||"驗證失敗，請稍後再試")}},q=async()=>{xe(!0),R("");try{const ne={nickname:p,password:u,gender:A,country:b,region:S,age:I,interest:v,improvement:H};console.log("重發驗證碼到:",l);const U=await(await fetch(ea("/email-verification/send-code"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:l,registrationData:ne})})).json();U.success?(J(""),R("已重新發送驗證碼，請輸入新的驗證碼"),_e(!0),Ve(!1)):R(U.error||"重發驗證碼失敗")}catch(ne){console.error("重發驗證碼錯誤:",ne),R("重發驗證碼失敗，請稍後再試")}finally{xe(!1)}},F=async ne=>{ne.preventDefault(),R(""),ve(!1);let G=setTimeout(()=>ve(!0),1500);try{if(!O){R(a.errorAvatar);return}if(!A){R(a.errorGender);return}if(!pB(l)){R(a.errorEmailFormat);return}if(!mB(u)){R(a.errorPasswordFormat);return}if(!gB(p)){R(a.errorNicknameFormat);return}if(!I){R(a.errorAgeFormat);return}if(!b){R(a.errorCountry);return}$(!0);const U={nickname:p,password:u,gender:A,country:b,region:S,age:I,interest:v,improvement:H};console.log("正在發送 email 驗證碼到:",l);const N=await fetch(ea("/email-verification/send-code"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:l,registrationData:U})});console.log("Email API 回應狀態:",N.status);const V=await N.json();if(console.log("Email API 回應資料:",V),V.success)ce(!0),_e(!0),Ve(!1),J(""),$(!1),clearTimeout(G),ve(!1),R("");else throw new Error(V.error||"生成驗證碼失敗")}catch(U){console.error("註冊錯誤:",U),R(U.message||"註冊失敗，請稍後再試"),$(!1),clearTimeout(G),ve(!1)}},we=async()=>{var G,U,N;_(!0);let ne=setTimeout(()=>ve(!0),1500);try{const V=await kp(br,l,u);await yc(V.user,{displayName:p});let he="";if(O){const fe=cE(gE,`avatars/${V.user.uid}/${O.name}`),ze=aE(fe,O);let Ce=null;await Promise.race([new Promise((Ee,Ye)=>{ze.on("state_changed",null,Xe=>{Ce=Xe,Ye(Xe)},async()=>{he=await lE(ze.snapshot.ref),Ee()})}),new Promise((Ee,Ye)=>setTimeout(()=>{Ce=new Error("頭像上傳逾時，請檢查網路或稍後再試"),Ye(Ce)},1e4))]).catch(Ee=>{throw Ce||Ee}),await yc(V.user,{photoURL:he})}await Ma(Ot(ht,"profiles",V.user.uid),{nickname:p,email:l,avatar:he,gender:A,country:b,region:S,age:I,interest:v,improvement:H,createdAt:new Date,updatedAt:new Date}),localStorage.removeItem("aiAvatar"),localStorage.removeItem("avatarWelcomed"),_(!1),clearTimeout(ne),ve(!1),n("/")}catch(V){(G=V==null?void 0:V.message)!=null&&G.includes("Failed to fetch")||(U=V==null?void 0:V.message)!=null&&U.includes("NetworkError")||(N=V==null?void 0:V.message)!=null&&N.includes("ECONNREFUSED")?R("伺服器連線失敗，請稍後再試或聯絡管理員"):R((V==null?void 0:V.message)||"註冊失敗，請稍後再試"),_(!1),clearTimeout(ne),ve(!1)}},Ne=async()=>{const ne=new On;try{console.log("開始 Google 登入..."),_(!0),ve(!1);let G=setTimeout(()=>ve(!0),1500);const U=window.innerWidth<=768;console.log("是否為手機版:",U);let N;if(U)N=await Nl(br,ne);else{N=await Nl(br,ne),clearTimeout(G),ve(!1),_(!1),n("/");return}clearTimeout(G),ve(!1),_(!1),console.log("Google 登入成功，user.uid:",N.user.uid),n("/")}catch(G){_(!1),ve(!1),console.error("Google 登入錯誤:",G);let U="Google 登入失敗："+G.message;G.code==="auth/popup-closed-by-user"?U="登入視窗被關閉，請重新嘗試":G.code==="auth/popup-blocked"?U="登入視窗被瀏覽器阻擋，請允許彈出視窗後重新嘗試":G.code==="auth/network-request-failed"?U="網路連線失敗，請檢查網路後重新嘗試":G.code==="auth/too-many-requests"&&(U="登入嘗試過於頻繁，請稍後再試"),console.log("Google 登入錯誤代碼:",G.code),console.log("Google 登入錯誤訊息:",U),alert(U)}},Fe=async()=>{var G;const ne=new js("apple.com");try{console.log("開始 Apple 登入...");const N=(await Nl(br,ne)).user;console.log("Apple 登入成功，user.uid:",N.uid),await N.reload(),console.log("user reload 完成");const V=await fi(Ot(ht,"users",N.uid));console.log("Firestore 查詢結果:",{exists:V.exists(),data:V.data(),completed:(G=V.data())==null?void 0:G.completed}),!V.exists()||!V.data()||!V.data().completed?(console.log("導向 /CompleteProfile"),n("/CompleteProfile")):(console.log("導向首頁 /"),n("/"))}catch(U){console.error("Apple 登入錯誤:",U);let N="Apple 登入失敗："+U.message;U.code==="auth/popup-closed-by-user"?N="登入視窗被關閉，請重新嘗試":U.code==="auth/popup-blocked"?N="登入視窗被瀏覽器阻擋，請允許彈出視窗後重新嘗試":U.code==="auth/network-request-failed"?N="網路連線失敗，請檢查網路後重新嘗試":U.code==="auth/too-many-requests"&&(N="登入嘗試過於頻繁，請稍後再試"),console.log("Apple 登入錯誤代碼:",U.code),console.log("Apple 登入錯誤訊息:",N),alert(N)}};async function Ue(){var G,U;if(!((U=(G=X.current)==null?void 0:G.value)==null?void 0:U.trim())){te("invalid"),Y("請輸入暱稱"),setTimeout(()=>{var N;(N=X.current)==null||N.focus()},100);return}te("ok"),Y("你的名稱非常好👍"),setTimeout(()=>{var N;(N=le.current)==null||N.focus()},200)}e.pathname;const[Ct,ae]=g.useState(!1),[Be,ct]=g.useState(""),[et,ot]=g.useState("");return r.jsxs("div",{style:{minHeight:"100vh",background:"#fff",position:"relative"},children:[o&&r.jsx("div",{style:{position:"absolute",top:"40%",left:"50%",transform:"translate(-50%, -50%)",fontSize:22,color:"#374151",fontWeight:600,textAlign:"center"},children:oy[i]||oy["zh-TW"]}),r.jsx("div",{style:{position:"relative"},children:r.jsxs("div",{style:{minHeight:"100vh",background:"url('/city-blur.jpg') center/cover no-repeat",position:"relative",display:"flex",flexDirection:"column"},children:[window.innerWidth<=768?r.jsxs(r.Fragment,{children:[r.jsxs("button",{onClick:()=>window.history.back(),style:{position:"fixed",top:16,left:16,zIndex:1e3,background:"rgba(255,255,255,0.9)",border:"none",borderRadius:"20px",padding:"8px 16px",fontSize:"14px",fontWeight:"bold",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",color:"#667eea",transition:"all 0.3s ease",boxShadow:"0 2px 8px rgba(0,0,0,0.15)",height:"36px"},onMouseEnter:ne=>{ne.currentTarget.style.background="#667eea",ne.currentTarget.style.color="#fff",ne.currentTarget.style.transform="translateY(-1px)"},onMouseLeave:ne=>{ne.currentTarget.style.background="rgba(255,255,255,0.9)",ne.currentTarget.style.color="#667eea",ne.currentTarget.style.transform="translateY(0)"},children:["← ",i==="zh-TW"||i==="zh-CN"?"返回":i==="en"?"Back":i==="ja"?"戻る":i==="ko"?"돌아가기":i==="vi"?"Quay Lại":i==="th"?"กลับ":i==="la"?"Regredi":i==="ms"?"Kembali":"Back"]}),r.jsx("div",{style:{position:"fixed",top:16,right:16,zIndex:1e3},children:r.jsx(en,{style:{background:"rgba(255,255,255,0.9)",border:"none",borderRadius:"20px",padding:"8px 16px",fontSize:"14px",fontWeight:"bold",color:"#667eea",transition:"all 0.3s ease",boxShadow:"0 2px 8px rgba(0,0,0,0.15)",width:"60px",minWidth:"60px",maxWidth:"60px",height:"36px",cursor:"pointer"}})}),r.jsx("div",{style:{position:"fixed",top:60,left:"50%",transform:"translateX(-50%)",zIndex:100},children:r.jsx("span",{style:{fontWeight:900,fontSize:18,color:"#ffd700",letterSpacing:1,textShadow:"0 2px 8px #23294688",whiteSpace:"nowrap",textAlign:"left",lineHeight:"1.2",marginLeft:"8px"},children:ay[i]})})]}):r.jsxs(r.Fragment,{children:[r.jsx("button",{onClick:()=>window.history.back(),style:{position:"fixed",top:24,left:24,zIndex:1e3,background:"rgba(255,255,255,0.9)",border:"none",borderRadius:"25px",padding:"8px 16px",fontSize:"14px",fontWeight:"bold",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",color:"#667eea",transition:"all 0.3s ease",boxShadow:"0 4px 12px rgba(0,0,0,0.15)"},onMouseEnter:ne=>{ne.currentTarget.style.background="#667eea",ne.currentTarget.style.color="#fff",ne.currentTarget.style.transform="translateY(-2px)"},onMouseLeave:ne=>{ne.currentTarget.style.background="rgba(255,255,255,0.9)",ne.currentTarget.style.color="#667eea",ne.currentTarget.style.transform="translateY(0)"},children:i==="zh-TW"||i==="zh-CN"?"返回":i==="en"?"Back":i==="ja"?"戻る":i==="ko"?"돌아가기":i==="vi"?"Quay Lại":i==="th"?"กลับ":i==="la"?"Regredi":i==="ms"?"Kembali":"Back"}),r.jsx("div",{style:{position:"fixed",top:24,left:"50%",transform:"translateX(-50%)",zIndex:100},children:r.jsx("span",{style:{fontWeight:900,fontSize:24,color:"#ffd700",letterSpacing:2,textShadow:"0 2px 8px #23294688",whiteSpace:"nowrap",textAlign:"left",marginLeft:"12px"},children:ay[i]})}),r.jsxs("select",{value:window.lang||"zh-TW",onChange:ne=>{const G=ne.target.value;window.lang=G,localStorage.setItem("lang",G),window.location.reload()},style:{position:"fixed",top:24,right:120,zIndex:10001,background:"rgba(255,255,255,0.9)",border:"none",borderRadius:"25px",padding:"8px 16px",fontSize:"14px",fontWeight:"bold",cursor:"pointer",color:"#667eea",transition:"all 0.3s ease",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",width:"80px",minWidth:"80px",maxWidth:"80px",outline:"none"},onMouseEnter:ne=>{ne.currentTarget.style.background="#667eea",ne.currentTarget.style.color="#fff",ne.currentTarget.style.transform="translateY(-2px)"},onMouseLeave:ne=>{ne.currentTarget.style.background="rgba(255,255,255,0.9)",ne.currentTarget.style.color="#667eea",ne.currentTarget.style.transform="translateY(0)"},children:[r.jsx("option",{value:"zh-TW",children:"繁中"}),r.jsx("option",{value:"zh-CN",children:"简中"}),r.jsx("option",{value:"en",children:"English"}),r.jsx("option",{value:"ja",children:"日本語"}),r.jsx("option",{value:"ko",children:"한국어"}),r.jsx("option",{value:"vi",children:"Tiếng Việt"}),r.jsx("option",{value:"th",children:"ไทย"}),r.jsx("option",{value:"la",children:"Latin"}),r.jsx("option",{value:"ms",children:"Bahasa Melayu"})]})]}),r.jsxs("div",{style:{display:"flex",flex:1,minHeight:"100vh",alignItems:"stretch",justifyContent:"center",width:"100%",marginTop:window.innerWidth<=768?120:60,flexDirection:window.innerWidth<=768?"column":"row"},children:[r.jsxs("div",{style:{flex:1,display:window.innerWidth<=768?"none":"flex",flexDirection:"column",alignItems:"center",background:"rgba(60,40,20,0.18)",padding:"0 12px",minHeight:"calc(100vh - 60px)",boxSizing:"border-box",justifyContent:"space-between"},children:[r.jsx("div",{style:{position:"relative",width:"100%",textAlign:"center",paddingTop:78},children:r.jsx("div",{style:{fontSize:18,fontWeight:700,textShadow:"0 2px 8px #23294688"},children:ly(cB[i])})}),r.jsx("img",{src:"/left-hero.png",alt:"left hero",style:{width:300,maxWidth:"98%",objectFit:"contain"}}),r.jsxs("div",{style:{paddingBottom:80,textAlign:"center"},children:[r.jsxs("div",{style:{color:"#fff",fontWeight:700,fontSize:22,margin:"12px 0 8px"},children:[a.heroLeftTop,r.jsx("br",{}),a.heroLeftMain,r.jsx("br",{}),a.heroLeftSub]}),r.jsx("div",{style:{color:"#ffd700",fontWeight:700,fontSize:18},children:a.heroLeftYellow})]})]}),ee&&r.jsx(fB,{t:a,setShowLogin:ge,navigate:n,setShowReset:ae}),r.jsx("div",{style:{flex:window.innerWidth<=768?"1":"0 1 500px",display:"flex",justifyContent:"center",alignItems:"center",padding:window.innerWidth<=768?"10px":"20px 0",width:window.innerWidth<=768?"100%":"auto"},children:r.jsxs("form",{onSubmit:F,style:{background:"#ffffffcc",borderRadius:20,padding:window.innerWidth<=768?"20px 16px":"24px 32px",width:"100%",maxWidth:window.innerWidth<=768?"100%":500,boxShadow:"0 8px 32px #0000004d",position:"relative",boxSizing:"border-box",margin:window.innerWidth<=768?"0 10px":"0"},children:[r.jsx("img",{src:"/ctx-logo.png",alt:"Logo",style:{width:window.innerWidth<=768?60:100,height:window.innerWidth<=768?60:100,position:"absolute",top:5,left:5,zIndex:0,opacity:1}}),r.jsxs("div",{style:{position:"relative",zIndex:1},children:[r.jsx("div",{style:{width:"100%",textAlign:"center",fontWeight:900,fontSize:window.innerWidth<=768?20:26,color:"#ffd700",marginBottom:8,textShadow:"0 2px 4px #00000055"},children:a.formTopSlogan}),r.jsx("h2",{style:{textAlign:"center",color:"#333",marginBottom:16,fontSize:window.innerWidth<=768?24:28,fontWeight:800},children:a.title}),T&&r.jsx("p",{style:{color:"red",textAlign:"center",marginBottom:"1rem"},children:T}),We&&r.jsxs("div",{style:{background:"linear-gradient(135deg, #3b82f6, #1d4ed8)",color:"white",padding:"16px",borderRadius:"12px",marginBottom:"1rem",textAlign:"center",boxShadow:"0 4px 12px rgba(59, 130, 246, 0.3)"},children:[r.jsx("div",{style:{fontSize:"20px",marginBottom:"8px"},children:"📧"}),r.jsx("div",{style:{fontWeight:"bold",marginBottom:"8px"},children:"請輸入驗證碼"}),r.jsxs("div",{style:{fontSize:"14px",marginBottom:"12px"},children:["驗證碼已發送到 ",l]}),r.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"8px",alignItems:"center"},children:[r.jsxs("div",{style:{display:"flex",gap:"8px",alignItems:"center"},children:[r.jsx("input",{type:"text",value:ye,onChange:ne=>J(ne.target.value),placeholder:"請輸入 6 位數驗證碼",style:{width:"150px",padding:"8px 12px",borderRadius:"6px",border:"none",fontSize:"16px",textAlign:"center"},maxLength:6}),r.jsx("button",{type:"button",onClick:M,disabled:!ye||ye.length!==6,style:{background:ye&&ye.length===6?"#10b981":"#6b7280",color:"white",border:"none",padding:"8px 16px",borderRadius:"6px",fontSize:"14px",fontWeight:"bold",cursor:ye&&ye.length===6?"pointer":"not-allowed",transition:"all 0.2s ease",transform:(ye&&ye.length===6,"scale(1)"),boxShadow:ye&&ye.length===6?"0 2px 8px rgba(16, 185, 129, 0.3)":"none"},onMouseEnter:ne=>{ye&&ye.length===6&&(ne.currentTarget.style.background="#059669",ne.currentTarget.style.transform="scale(1.05)",ne.currentTarget.style.boxShadow="0 4px 12px rgba(16, 185, 129, 0.4)")},onMouseLeave:ne=>{ye&&ye.length===6&&(ne.currentTarget.style.background="#10b981",ne.currentTarget.style.transform="scale(1)",ne.currentTarget.style.boxShadow="0 2px 8px rgba(16, 185, 129, 0.3)")},onMouseDown:ne=>{ye&&ye.length===6&&(ne.currentTarget.style.transform="scale(0.95)")},onMouseUp:ne=>{ye&&ye.length===6&&(ne.currentTarget.style.transform="scale(1.05)")},children:"驗證並註冊"})]}),r.jsx("button",{type:"button",onClick:q,disabled:me,style:{background:me?"#6b7280":"#3b82f6",color:"white",border:"none",padding:"6px 12px",borderRadius:"6px",fontSize:"12px",fontWeight:"bold",cursor:me?"not-allowed":"pointer",transition:"all 0.2s ease",transform:"scale(1)",boxShadow:me?"none":"0 2px 8px rgba(59, 130, 246, 0.3)"},onMouseEnter:ne=>{me||(ne.currentTarget.style.background="#2563eb",ne.currentTarget.style.transform="scale(1.05)",ne.currentTarget.style.boxShadow="0 4px 12px rgba(59, 130, 246, 0.4)")},onMouseLeave:ne=>{me||(ne.currentTarget.style.background="#3b82f6",ne.currentTarget.style.transform="scale(1)",ne.currentTarget.style.boxShadow="0 2px 8px rgba(59, 130, 246, 0.3)")},onMouseDown:ne=>{me||(ne.currentTarget.style.transform="scale(0.95)")},onMouseUp:ne=>{me||(ne.currentTarget.style.transform="scale(1.05)")},children:me?"重發中...":"重發驗證碼"})]})]}),r.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"12px",width:"100%",minWidth:0},children:[r.jsx("input",{type:"text",style:{display:"none"},autoComplete:"username"}),r.jsx("input",{type:"password",style:{display:"none"},autoComplete:"current-password"}),r.jsx("input",{type:"email",autoComplete:"new-password",placeholder:a.email,value:l,onChange:ne=>c(ne.target.value),style:{gridColumn:"1 / -1",width:"100%",minWidth:0,maxWidth:"100%",boxSizing:"border-box",overflow:"hidden"},className:"reg-input",required:!0}),r.jsx("input",{type:"password",autoComplete:"new-password",placeholder:a.password,value:u,onChange:ne=>h(ne.target.value),style:{gridColumn:"1 / -1",width:"100%",minWidth:0,maxWidth:"100%",boxSizing:"border-box",overflow:"hidden"},className:"reg-input",required:!0}),r.jsx("input",{type:"text",autoComplete:"off",placeholder:a.nickname,value:p,onChange:ne=>{f(ne.target.value),te("idle"),Y("")},onBlur:Ue,className:"reg-input",style:{width:"100%",minWidth:0,maxWidth:"100%",boxSizing:"border-box",overflow:"hidden",color:"#888"},required:!0,ref:X}),W&&r.jsx("div",{style:{gridColumn:"1 / -1",color:Re==="ok"?"#1a7f1a":Re==="invalid"||Re==="exists"?"red":"#333",fontSize:14,marginTop:-8,marginBottom:4},children:W}),r.jsxs("select",{value:I,onChange:ne=>j(ne.target.value),className:"reg-input",style:{width:"100%",minWidth:0,maxWidth:"100%",boxSizing:"border-box",overflow:"hidden",color:I?"#333":"#888",background:"#fff"},required:!0,children:[r.jsx("option",{value:"",style:{color:"#888"},children:a.selectAge}),ik.map(ne=>r.jsx("option",{value:ne,children:ne},ne))]}),r.jsxs("select",{value:b,onChange:ne=>x(ne.target.value),className:"reg-input",style:{width:"100%",minWidth:0,maxWidth:"100%",boxSizing:"border-box",overflow:"hidden",color:b?"#333":"#888",background:"#fff"},required:!0,children:[r.jsx("option",{value:"",style:{color:"#888"},children:a.country}),(nk[i]||[]).map(ne=>r.jsx("option",{value:ne,children:ne},ne))]}),r.jsx("input",{type:"text",placeholder:a.city,value:S,onChange:ne=>w(ne.target.value),className:"reg-input",style:{width:"100%",minWidth:0,maxWidth:"100%",boxSizing:"border-box",overflow:"hidden"}}),r.jsxs("select",{value:v,onChange:ne=>z(ne.target.value),className:"reg-input",style:{width:"100%",minWidth:0,maxWidth:"100%",boxSizing:"border-box",overflow:"hidden",color:v?"#333":"#888",background:"#fff"},children:[r.jsx("option",{value:"",style:{color:"#888"},children:a.interest}),(tk[i]||[]).map(ne=>r.jsx("option",{value:ne,children:ne},ne))]}),r.jsxs("select",{value:H,onChange:ne=>L(ne.target.value),className:"reg-input",style:{gridColumn:"1 / -1",width:"100%",minWidth:0,maxWidth:"100%",boxSizing:"border-box",overflow:"hidden",color:H?"#333":"#888",background:"#fff"},children:[r.jsx("option",{value:"",style:{color:"#888"},children:a.whatToImprove}),(hB[i]||[]).map(ne=>r.jsx("option",{value:ne,children:ne},ne))]}),r.jsx("div",{style:{gridColumn:"1 / -1",display:"flex",flexDirection:"column",alignItems:"center",marginBottom:8},children:r.jsxs("label",{htmlFor:"avatar-upload",style:{cursor:"pointer",display:"flex",flexDirection:"column",alignItems:"center",gap:4},children:[r.jsx("div",{style:{width:64,height:64,borderRadius:"50%",overflow:"hidden",background:"#eee",border:"2px solid #b6b6f6",marginBottom:4},children:B?r.jsx("img",{src:B,alt:"avatar",style:{width:"100%",height:"100%",objectFit:"cover"}}):r.jsx("span",{style:{display:"flex",width:"100%",height:"100%",alignItems:"center",justifyContent:"center",color:"#bbb",fontSize:32},children:"+"})}),r.jsx("span",{style:{color:"#6B5BFF",fontWeight:700,fontSize:15},children:a.uploadAvatar}),r.jsx("input",{id:"avatar-upload",type:"file",accept:"image/*",style:{display:"none"},onChange:ne=>{if(ne.target.files&&ne.target.files[0]){P(ne.target.files[0]);const G=new FileReader;G.onload=U=>{var N;return k((N=U.target)==null?void 0:N.result)},G.readAsDataURL(ne.target.files[0])}}})]})}),r.jsxs("div",{style:{gridColumn:"1 / -1",display:"flex",alignItems:"center",gap:18,justifyContent:"center",marginBottom:8},children:[r.jsx("span",{style:{fontWeight:600,color:"#6B5BFF",fontSize:15},children:a.genderRequired}),r.jsxs("label",{style:{display:"flex",alignItems:"center",gap:4},children:[r.jsx("input",{type:"radio",name:"gender",value:"male",checked:A==="male",onChange:()=>D("male"),required:!0}),r.jsx("span",{children:a.male})]}),r.jsxs("label",{style:{display:"flex",alignItems:"center",gap:4},children:[r.jsx("input",{type:"radio",name:"gender",value:"female",checked:A==="female",onChange:()=>D("female"),required:!0}),r.jsx("span",{children:a.female})]})]})]}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:window.innerWidth<=768?"1fr":"1fr 1fr",gap:8,margin:"16px 0 8px 0"},children:[Me?r.jsxs("div",{style:{gridColumn:"1 / -1",display:"flex",flexDirection:"column",gap:"12px",alignItems:"center"},children:[r.jsxs("div",{style:{textAlign:"center",marginBottom:"8px"},children:[r.jsx("p",{style:{color:"#6B5BFF",fontWeight:600,marginBottom:"4px"},children:"📧 確認郵件已發送到您的 email"}),r.jsx("p",{style:{color:"#666",fontSize:"14px"},children:"請檢查您的收件匣並點擊確認連結完成註冊"})]}),r.jsxs("div",{style:{background:"#f8f9ff",padding:"16px",borderRadius:"8px",border:"1px solid #e0e7ff",textAlign:"center"},children:[r.jsx("p",{style:{color:"#6B5BFF",fontWeight:600,marginBottom:"8px"},children:"📬 請查看您的 email"}),r.jsxs("p",{style:{color:"#666",fontSize:"14px",marginBottom:"12px"},children:["我們已發送確認郵件到：",r.jsx("strong",{children:l})]}),r.jsx("p",{style:{color:"#666",fontSize:"12px"},children:"點擊郵件中的「✅ 確認註冊」按鈕即可完成註冊"})]}),r.jsx("button",{type:"button",onClick:()=>{Ve(!1),R("")},style:{...Fo,background:"#f5f5f5",color:"#666",border:"1px solid #ddd",width:"120px"},children:"🔄 重新發送"})]}):r.jsxs("button",{type:"submit",disabled:E||ie,style:{...Fo,background:"linear-gradient(90deg, #6e8efb, #a777e3)",color:"white",opacity:E||ie?.6:1,cursor:E||ie?"not-allowed":"pointer"},children:[E?r.jsxs("span",{style:{display:"flex",alignItems:"center",justifyContent:"center",fontWeight:700,fontSize:18},children:[a.registering,".".repeat(oe+1)]}):ie?r.jsx("span",{style:{display:"flex",alignItems:"center",justifyContent:"center",fontWeight:700,fontSize:18},children:"註冊中..."}):r.jsx("span",{style:{marginRight:10},children:"🚀"}),!E&&!ie&&a.register]}),r.jsxs("button",{type:"button",onClick:()=>ge(!0),disabled:E,style:{...Fo,background:"linear-gradient(90deg, #89f7fe, #66a6ff)",color:"white",opacity:E?.6:1,cursor:E?"not-allowed":"pointer"},children:[r.jsx("span",{style:{marginRight:10},children:"🔑"}),a.login]}),r.jsxs("button",{type:"button",onClick:Ne,disabled:E,style:{...Fo,background:"#fff",color:"#333",opacity:E?.6:1,cursor:E?"not-allowed":"pointer"},children:[r.jsx("img",{src:"https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg",alt:"Google",style:cy}),a.googleLogin]}),r.jsxs("button",{type:"button",onClick:Fe,disabled:E,style:{...Fo,background:"#000",color:"#fff",opacity:E?.6:1,cursor:E?"not-allowed":"pointer"},children:[r.jsx("img",{src:"https://upload.wikimedia.org/wikipedia/commons/f/fa/Apple_logo_black.svg",alt:"Apple",style:{...cy,filter:"invert(1)"}}),a.appleLogin]})]}),r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:24,gap:8,flexDirection:"row",textAlign:"center",fontSize:12,flexWrap:"nowrap",overflow:"hidden"},children:[r.jsx("span",{onClick:()=>n("/privacy-policy"),style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12,cursor:"pointer"},style:{color:"#6B5BFF",textDecoration:"underline",fontSize:12,flex:1,textAlign:"center",whiteSpace:"nowrap"},children:a.privacy||"隱私權政策"}),r.jsx("span",{style:{color:"#666",fontSize:12},children:"/"}),r.jsx("button",{type:"button",onClick:()=>n("/terms"),style:{background:"none",border:"none",color:"#666",textDecoration:"underline",cursor:"pointer",fontSize:12,flex:1,textAlign:"center",whiteSpace:"nowrap"},children:a.terms}),r.jsx("span",{style:{color:"#666",fontSize:12},children:"/"}),r.jsx("span",{onClick:()=>n("/data-deletion"),style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12,cursor:"pointer"},style:{color:"#6B5BFF",textDecoration:"underline",fontSize:12,flex:1,textAlign:"center",whiteSpace:"nowrap"},children:a.deletion||"資料刪除說明"})]})]})]})}),r.jsxs("div",{style:{flex:1,display:window.innerWidth<=768?"none":"flex",flexDirection:"column",alignItems:"center",background:"rgba(60,40,20,0.18)",padding:"0 12px",minHeight:"calc(100vh - 60px)",boxSizing:"border-box",justifyContent:"space-between"},children:[r.jsx("div",{style:{position:"relative",width:"100%",textAlign:"center",paddingTop:78},children:r.jsx("div",{style:{fontSize:18,fontWeight:700,textShadow:"0 2px 8px #23294688"},children:ly(dB[i])})}),r.jsx("img",{src:"/right-hero.png",alt:"right hero",style:{width:280,maxWidth:"98%",objectFit:"contain"}}),r.jsxs("div",{style:{paddingBottom:80,textAlign:"center"},children:[r.jsx("div",{style:{color:"#fff",fontWeight:700,fontSize:22,margin:"12px 0 8px"},children:a.heroRightMain}),r.jsx("div",{style:{color:"#ffd700",fontWeight:700,fontSize:18},children:a.heroRightYellow})]})]})]}),r.jsx("div",{style:{position:"fixed",bottom:10,left:36,color:"#fff",textShadow:"0 1px 2px #000",fontSize:14,zIndex:10},children:"CTX Goodlife Copyright 2025"})]})}),Ct&&r.jsx("div",{style:{position:"fixed",left:0,top:0,width:"100vw",height:"100vh",background:"rgba(40,40,80,0.18)",zIndex:1e4,display:"flex",alignItems:"center",justifyContent:"center"},children:r.jsxs("div",{style:{background:"#fff",borderRadius:18,boxShadow:"0 4px 24px #6B5BFF33",padding:28,minWidth:280,maxWidth:340,width:"90vw",position:"relative",display:"flex",flexDirection:"column",gap:12},children:[r.jsx("button",{type:"button",onClick:()=>ae(!1),style:{position:"absolute",top:10,right:12,background:"none",border:"none",fontSize:22,color:"#888",cursor:"pointer",fontWeight:700},children:"×"}),r.jsx("div",{style:{fontWeight:800,fontSize:18,color:"#6B5BFF",textAlign:"center",marginBottom:2},children:"重設密碼"}),r.jsx("input",{type:"email",value:Be,onChange:ne=>ct(ne.target.value),placeholder:"請輸入註冊時的 email",style:{border:"1px solid #e0e7ff",borderRadius:8,padding:"6px 10px",fontSize:15}}),r.jsx("button",{onClick:async()=>{ot("");try{await Lv(br,Be),ot("已寄出密碼重設信，請到信箱收信！")}catch{ot("發送失敗，請確認 email 是否正確")}},style:{background:"linear-gradient(90deg, #6e8efb, #a777e3)",color:"#fff",border:"none",borderRadius:14,padding:"6px 18px",fontWeight:700,fontSize:15,cursor:"pointer",alignSelf:"center"},children:"發送重設信"}),et&&r.jsx("div",{style:{color:"#6B5BFF",fontWeight:700,textAlign:"center",marginTop:8},children:et})]})}),be&&r.jsx("div",{style:{color:"#ff9800",textAlign:"center",marginTop:8,fontWeight:600},children:"網路較慢，請耐心等候..."})]})}const zo={"zh-TW":{back:"← 返回上一頁",title:"我的連結",chat:"進入聊天",task:"共修任務",noLink:"目前沒有已建立的連結",goal:"目標："},"zh-CN":{back:"← 返回上一页",title:"我的连接",chat:"进入聊天",task:"共修任务",noLink:"目前没有已建立的连接",goal:"目标："},en:{back:"← Back",title:"My Links",chat:"Chat",task:"Co-Task",noLink:"No links established",goal:"Goal: "},ja:{back:"← 前のページへ",title:"私のリンク",chat:"チャットへ",task:"共修タスク",noLink:"まだリンクがありません",goal:"目標："},ko:{back:"← 이전 페이지",title:"내 링크",chat:"채팅하기",task:"공동 작업",noLink:"아직 연결된 링크가 없습니다",goal:"목표: "},th:{back:"← กลับ",title:"ลิงก์ของฉัน",chat:"แชท",task:"งานร่วมกัน",noLink:"ยังไม่มีลิงก์ที่สร้างขึ้น",goal:"เป้าหมาย: "},vi:{back:"← Quay lại",title:"Liên kết của tôi",chat:"Trò chuyện",task:"Nhiệm vụ chung",noLink:"Chưa có liên kết nào",goal:"Mục tiêu: "},ms:{back:"← Kembali",title:"Pautan Saya",chat:"Sembang",task:"Tugas Bersama",noLink:"Belum ada pautan yang dibuat",goal:"Matlamat: "},la:{back:"← Redire",title:"Nexus Mei",chat:"Colloquium",task:"Munus Commune",noLink:"Nullae nexus constitutae",goal:"Propositum: "}},xB={"zh-TW":{connected:"已配對",pending:"等待對方回覆",rejected:"已拒絕"},"zh-CN":{connected:"已配对",pending:"等待对方回复",rejected:"已拒绝"},en:{connected:"Connected",pending:"Pending",rejected:"Rejected"},ja:{connected:"マッチ済み",pending:"返事待ち",rejected:"拒否されました"},ko:{connected:"연결됨",pending:"대기 중",rejected:"거절됨"},th:{connected:"เชื่อมต่อแล้ว",pending:"รอการตอบกลับ",rejected:"ถูกปฏิเสธ"},vi:{connected:"Đã kết nối",pending:"Đang chờ",rejected:"Đã bị từ chối"},ms:{connected:"Telah dihubungkan",pending:"Menunggu",rejected:"Ditolak"},la:{connected:"Coniunctus",pending:"Exspectans",rejected:"Reiectus"}},kl={"zh-TW":"解除連結","zh-CN":"解除连接",en:"Remove",ja:"リンク解除",ko:"연결 해제",th:"ยกเลิกการเชื่อมต่อ",vi:"Hủy liên kết",ms:"Buang Pautan",la:"Remove"},Sl={"zh-TW":"取消邀請","zh-CN":"取消邀请",en:"Cancel Invite",ja:"招待をキャンセル",ko:"초대 취소",th:"ยกเลิกคำเชิญ",vi:"Hủy lời mời",ms:"Batal Jemputan",la:"Invitationem Remove"};function Yu(n){const e=$e(),{lang:t,setLang:i}=Qe(),[s,o]=g.useState([]),[a,l]=g.useState(null),[c,u]=g.useState(!0),[h,p]=g.useState(null),[f,b]=g.useState(null),x=t;g.useEffect(()=>{const j=ur(_r,async A=>{A?(l(A),await S(A.uid)):e("/")});return()=>j()},[e]);const S=async j=>{try{u(!0);const A=Wt(ht,"links"),D=un(A,Lt("user1Id","==",j)),O=un(A,Lt("user2Id","==",j)),[P,B]=await Promise.all([kn(D),kn(O)]),k=[];P.forEach(T=>{const R=T.data();k.push({id:T.id,...R})}),B.forEach(T=>{const R=T.data();k.push({id:T.id,user1Id:R.user2Id,user1Name:R.user2Name,user2Id:R.user1Id,user2Name:R.user1Name,role:R.role,goal:R.goal,status:R.status,createdAt:R.createdAt})}),o(k),u(!1)}catch(A){console.error("Error loading links:",A),u(!1)}},w=async j=>{try{await dc(Ot(ht,"links",j)),p(null),alert(kl[x]+" 成功！")}catch(A){console.error("Error removing link:",A),alert("操作失敗")}},I=async j=>{try{await dc(Ot(ht,"links",j)),b(null),alert(Sl[x]+" 成功！")}catch(A){console.error("Error canceling link:",A),alert("操作失敗")}};return c?r.jsx("div",{style:n.embedded?{width:"100%",background:"none",minHeight:"unset",boxShadow:"none",padding:0}:{background:"url('/green_hut.png') center center / cover no-repeat",minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center"},children:r.jsx("div",{style:{color:"#fff",fontSize:18},children:"載入中..."})}):r.jsxs("div",{style:n.embedded?{width:"100%",background:"none",minHeight:"unset",boxShadow:"none",padding:0}:{background:"url('/green_hut.png') center center / cover no-repeat",minHeight:"100vh",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",paddingTop:40},children:[!n.embedded&&r.jsx("button",{onClick:()=>e("/friend"),style:{position:"absolute",top:24,left:24,zIndex:10,background:"#fff",border:"1.5px solid #6B5BFF",color:"#6B5BFF",borderRadius:8,padding:"6px 18px",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:"0 2px 8px #0001"},children:zo[x].back}),!n.embedded&&r.jsx(en,{}),r.jsxs("div",{style:{maxWidth:500,margin:n.embedded?"0 auto":"40px auto",background:"#fff",borderRadius:16,boxShadow:n.embedded?"none":"0 2px 8px #0001",padding:32},children:[r.jsx("h2",{style:{fontWeight:700,fontSize:22,marginBottom:24},children:zo[x].title}),s.length===0&&r.jsx("div",{style:{color:"#888"},children:zo[x].noLink}),s.map(j=>r.jsxs("div",{style:{marginBottom:24,borderBottom:"1px solid #eee",paddingBottom:16,opacity:j.status==="rejected"?.5:1},children:[r.jsxs("div",{style:{fontWeight:600},children:[j.user2Name,"（",j.role,"）"]}),r.jsxs("div",{style:{color:"#666",margin:"8px 0"},children:[zo[x].goal,j.goal]}),r.jsx("div",{style:{color:j.status==="connected"?"#23c6e6":j.status==="pending"?"#e6b800":"#e4572e",fontWeight:700,marginBottom:8},children:xB[x][j.status]}),r.jsxs("div",{style:{display:"flex",gap:12},children:[j.status==="connected"&&r.jsx("button",{onClick:()=>e("/chatroom"),style:{background:"#8ec6f7",color:"#fff",border:"none",borderRadius:6,padding:"6px 18px",fontWeight:700,cursor:"pointer"},children:zo[x].chat}),j.status==="connected"&&r.jsx("button",{onClick:()=>p(j.id),style:{background:"#eee",color:"#888",border:"none",borderRadius:6,padding:"6px 18px",fontWeight:700,cursor:"pointer"},children:kl[x]}),j.status==="pending"&&r.jsx("button",{onClick:()=>b(j.id),style:{background:"#eee",color:"#888",border:"none",borderRadius:6,padding:"6px 18px",fontWeight:700,cursor:"pointer"},children:Sl[x]})]})]},j.id))]}),h&&r.jsx("div",{style:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",background:"#0006",zIndex:9999,display:"flex",alignItems:"center",justifyContent:"center"},children:r.jsxs("div",{style:{background:"#fff",borderRadius:12,padding:32,boxShadow:"0 2px 16px #0002",minWidth:280},children:[r.jsx("div",{style:{fontWeight:700,fontSize:18,marginBottom:18},children:kl[x]}),r.jsxs("div",{style:{display:"flex",gap:16,justifyContent:"flex-end"},children:[r.jsx("button",{onClick:()=>p(null),style:{background:"#eee",color:"#888",border:"none",borderRadius:6,padding:"6px 18px",fontWeight:700,cursor:"pointer"},children:"取消"}),r.jsx("button",{onClick:()=>w(h),style:{background:"#e4572e",color:"#fff",border:"none",borderRadius:6,padding:"6px 18px",fontWeight:700,cursor:"pointer"},children:kl[x]})]})]})}),f&&r.jsx("div",{style:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",background:"#0006",zIndex:9999,display:"flex",alignItems:"center",justifyContent:"center"},children:r.jsxs("div",{style:{background:"#fff",borderRadius:12,padding:32,boxShadow:"0 2px 16px #0002",minWidth:280},children:[r.jsx("div",{style:{fontWeight:700,fontSize:18,marginBottom:18},children:Sl[x]}),r.jsxs("div",{style:{display:"flex",gap:16,justifyContent:"flex-end"},children:[r.jsx("button",{onClick:()=>b(null),style:{background:"#eee",color:"#888",border:"none",borderRadius:6,padding:"6px 18px",fontWeight:700,cursor:"pointer"},children:"取消"}),r.jsx("button",{onClick:()=>I(f),style:{background:"#e4572e",color:"#fff",border:"none",borderRadius:6,padding:"6px 18px",fontWeight:700,cursor:"pointer"},children:Sl[x]})]})]})})]})}const Mn={"zh-TW":{back:"← 返回上一頁",title:"邀請通知",accept:"接受",reject:"拒絕",noInvite:"目前沒有新的邀請",goal:"目標："},"zh-CN":{back:"← 返回上一页",title:"邀请通知",accept:"接受",reject:"拒绝",noInvite:"目前没有新的邀请",goal:"目标："},en:{back:"← Back",title:"Invitations",accept:"Accept",reject:"Reject",noInvite:"No new invitations",goal:"Goal: "},ja:{back:"← 前のページへ",title:"招待通知",accept:"承認",reject:"拒否",noInvite:"新しい招待はありません",goal:"目標："},ko:{back:"← 이전 페이지",title:"초대 알림",accept:"수락",reject:"거절",noInvite:"새 초대가 없습니다",goal:"목표: "},th:{back:"← กลับ",title:"การแจ้งเตือนคำเชิญ",accept:"ยอมรับ",reject:"ปฏิเสธ",noInvite:"ไม่มีคำเชิญใหม่",goal:"เป้าหมาย: "},vi:{back:"← Quay lại",title:"Thông báo mời",accept:"Chấp nhận",reject:"Từ chối",noInvite:"Không có lời mời mới",goal:"Mục tiêu: "},ms:{back:"← Kembali",title:"Notis Jemputan",accept:"Terima",reject:"Tolak",noInvite:"Tiada jemputan baru",goal:"Matlamat: "},la:{back:"← Redire",title:"Notitia Invitationis",accept:"Accipe",reject:"Reici",noInvite:"Nullae invitationes novae",goal:"Propositum: "}};function Xu(n){const[e,t]=g.useState([]),{lang:i,setLang:s}=Qe(),[o,a]=g.useState(null),[l,c]=g.useState(!0),[u,h]=g.useState(null),p=$e();g.useEffect(()=>{let x;const S=ur(_r,async w=>{w?(a(w),x=await f(w.uid)):p("/")});return()=>{S(),x&&x()}},[p]);const f=async x=>{try{c(!0);const S=Wt(ht,"invites"),w=un(S,Lt("toUserId","==",x),Lt("status","==","pending"));return up(w,j=>{const A=[];j.forEach(D=>{A.push({id:D.id,...D.data()})}),t(A),c(!1)})}catch(S){console.error("Error loading invites:",S),c(!1);return}},b=async(x,S)=>{if(o)try{const w=Ot(ht,"invites",x);if(S){await cc(w,{status:"accepted"});const I=e.find(j=>j.id===x);I&&await $i(Wt(ht,"links"),{user1Id:I.fromUserId,user1Name:I.fromUserName,user2Id:I.toUserId,user2Name:I.toUserName,role:I.role,goal:I.goal,status:"connected",createdAt:new Date}),h(Mn[i].accept+" 成功！"),setTimeout(()=>h(null),2e3)}else await cc(w,{status:"rejected"}),h(Mn[i].reject+" 成功！"),setTimeout(()=>h(null),2e3)}catch(w){console.error("Error handling invite:",w),alert("操作失敗")}};return l?r.jsx("div",{style:n.embedded?{width:"100%",background:"none",minHeight:"unset",boxShadow:"none",padding:0}:{background:"url('/green_hut.png') center center / cover no-repeat",minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center"},children:r.jsx("div",{style:{color:"#fff",fontSize:18},children:"載入中..."})}):!l&&e.length===0?r.jsxs("div",{style:n.embedded?{width:"100%",background:"none",minHeight:"unset",boxShadow:"none",padding:0}:{background:"url('/green_hut.png') center center / cover no-repeat",minHeight:"100vh",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",paddingTop:40},children:[!n.embedded&&r.jsx("button",{onClick:()=>p("/friend"),style:{position:"absolute",top:24,left:24,zIndex:10,background:"#fff",border:"1.5px solid #6B5BFF",color:"#6B5BFF",borderRadius:8,padding:"6px 18px",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:"0 2px 8px #0001"},children:Mn[i].back}),r.jsx(en,{}),r.jsxs("div",{style:{maxWidth:500,margin:n.embedded?"0 auto":"40px auto",background:"#fff",borderRadius:16,boxShadow:n.embedded?"none":"0 2px 8px #0001",padding:32},children:[r.jsx("h2",{style:{fontWeight:700,fontSize:22,marginBottom:24},children:Mn[i].title}),r.jsx("div",{style:{color:"#888",textAlign:"center",fontSize:18},children:Mn[i].noInvite})]})]}):r.jsxs("div",{style:n.embedded?{width:"100%",background:"none",minHeight:"unset",boxShadow:"none",padding:0}:{background:"url('/green_hut.png') center center / cover no-repeat",minHeight:"100vh",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",paddingTop:40},children:[u&&r.jsx("div",{style:{position:"fixed",top:40,left:"50%",transform:"translateX(-50%)",background:"#fff",color:"#6B5BFF",fontWeight:700,fontSize:18,borderRadius:16,boxShadow:"0 4px 24px #6B5BFF22",padding:"18px 36px",zIndex:99999,textAlign:"center",letterSpacing:1},children:u}),!n.embedded&&r.jsx("button",{onClick:()=>p("/friend"),style:{position:"absolute",top:24,left:24,zIndex:10,background:"#fff",border:"1.5px solid #6B5BFF",color:"#6B5BFF",borderRadius:8,padding:"6px 18px",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:"0 2px 8px #0001"},children:Mn[i].back}),r.jsx(en,{}),r.jsxs("div",{style:{maxWidth:500,margin:n.embedded?"0 auto":"40px auto",background:"#fff",borderRadius:16,boxShadow:n.embedded?"none":"0 2px 8px #0001",padding:32},children:[r.jsx("h2",{style:{fontWeight:700,fontSize:22,marginBottom:24},children:Mn[i].title}),e.map(x=>r.jsxs("div",{style:{marginBottom:24,borderBottom:"1px solid #eee",paddingBottom:16},children:[r.jsxs("div",{style:{fontWeight:600},children:[x.fromUserName," 邀請你成為 ",x.role]}),r.jsxs("div",{style:{color:"#666",margin:"8px 0"},children:[Mn[i].goal,x.goal]}),r.jsx("button",{onClick:()=>b(x.id,!0),style:{marginRight:12,background:"#8ec6f7",color:"#fff",border:"none",borderRadius:6,padding:"6px 18px",fontWeight:700,cursor:"pointer"},children:Mn[i].accept}),r.jsx("button",{onClick:()=>b(x.id,!1),style:{background:"#eee",color:"#888",border:"none",borderRadius:6,padding:"6px 18px",fontWeight:700,cursor:"pointer"},children:Mn[i].reject})]},x.id))]})]})}const st={backToHome:{"zh-TW":"← 返回","zh-CN":"← 返回",ja:"← 戻る",en:"← Back",ko:"← 뒤로",th:"← กลับ",vi:"← Quay lại",ms:"← Kembali",la:"← Redire"},logout:{"zh-TW":"登出","zh-CN":"登出",ja:"ログアウト",en:"Logout",ko:"로그아웃",th:"ออกจากระบบ",vi:"Đăng xuất",ms:"Log keluar",la:"Exire"},pageTitle:{"zh-TW":"【破繭重生】夥伴計畫","zh-CN":"【破茧重生】伙伴计划",ja:"【再出発】パートナー計画",en:"Project Butterfly",ko:"【새출발】 파트너 계획",th:"【เกิดใหม่】แผนพันธมิตร",vi:"【Tái sinh】Kế hoạch đối tác",ms:"【Lahir Semula】Rancangan Rakan Kongsi",la:"【Renascitur】Propositum Socius"},editProfile:{"zh-TW":"編輯我的檔案","zh-CN":"编辑我的档案",ja:"プロフィール編集",en:"Edit My Profile",ko:"내 프로필 편집",th:"แก้ไขโปรไฟล์ของฉัน",vi:"Chỉnh sửa hồ sơ của tôi",ms:"Sunting Profil Saya",la:"Meum Profilum Muta"},partnerRoleTitle:{"zh-TW":"我想尋找的夥伴角色","zh-CN":"我想寻找的伙伴角色",ja:"探している仲間",en:"I'm looking for a",ko:"찾고 있는 파트너 역할",th:"บทบาทพันธมิตรที่ฉันมองหา",vi:"Vai trò đối tác tôi đang tìm",ms:"Peranan Rakan Kongsi Yang Saya Cari",la:"Partem Socii Quam Quæro"},peer:{"zh-TW":"同行者","zh-CN":"同行者",ja:"同じ道の仲間",en:"Peer",ko:"동행자",th:"เพื่อนร่วมทาง",vi:"Bạn đồng hành",ms:"Rakan Sebaya",la:"Par"},mentor:{"zh-TW":"生命導師","zh-CN":"生命导师",ja:"人生の師",en:"Mentor",ko:"인생 멘토",th:"ที่ปรึกษาชีวิต",vi:"Người hướng dẫn",ms:"Mentor Kehidupan",la:"Mentor"},skillPartner:{"zh-TW":"技能夥伴","zh-CN":"技能伙伴",ja:"スキル仲間",en:"Skill Partner",ko:"기술 파트너",th:"พันธมิตรด้านทักษะ",vi:"Đối tác kỹ năng",ms:"Rakan Kemahiran",la:"Socius Peritiae"},mainGoalTitle:{"zh-TW":"我的主要目標","zh-CN":"我的主要目标",ja:"私の主な目標",en:"My Main Goal",ko:"나의 주요 목표",th:"เป้าหมายหลักของฉัน",vi:"Mục tiêu chính của tôi",ms:"Matlamat Utama Saya",la:"Meum Propositum Principale"},allGoals:{"zh-TW":"所有目標","zh-CN":"所有目标",ja:"すべての目標",en:"All Goals",ko:"모든 목표",th:"เป้าหมายทั้งหมด",vi:"Tất cả mục tiêu",ms:"Semua Matlamat",la:"Omnia Proposita"},goalLabel:{"zh-TW":"目標","zh-CN":"目标",ja:"目標",en:"Goal",ko:"목표",th:"เป้าหมาย",vi:"Mục tiêu",ms:"Matlamat",la:"Propositum"},goalOptions:{jobSeeking:{"zh-TW":"尋找工作","zh-CN":"寻找工作",en:"Job Seeking",ja:"仕事探し",ko:"구직",th:"หางาน",vi:"Tìm việc",ms:"Mencari Kerja",la:"Quaerere Opus"},learnNewSkills:{"zh-TW":"學習新技能","zh-CN":"学习新技能",en:"Learn New Skills",ja:"新しいスキルを学ぶ",ko:"새로운 기술 배우기",th:"เรียนรู้ทักษะใหม่",vi:"Học kỹ năng mới",ms:"Belajar Kemahiran Baru",la:"Disce Novas Artes"},emotionalSupport:{"zh-TW":"情緒支持","zh-CN":"情绪支持",en:"Emotional Support",ja:"心のサポート",ko:"정서적 지원",th:"การสนับสนุนทางอารมณ์",vi:"Hỗ trợ tinh thần",ms:"Sokongan Emosi",la:"Auxilium Emotionale"},networking:{"zh-TW":"建立人脈","zh-CN":"建立人脉",en:"Networking",ja:"人脈作り",ko:"네트워킹",th:"สร้างเครือข่าย",vi:"Xây dựng mạng lưới",ms:"Rangkaian",la:"Nexus Creare"},startupPrep:{"zh-TW":"創業準備","zh-CN":"创业准备",en:"Startup Prep",ja:"起業準備",ko:"창업 준비",th:"เตรียมตัวเริ่มต้นธุรกิจ",vi:"Chuẩn bị khởi nghiệp",ms:"Persediaan Permulaan",la:"Praeparatio Negotii"}},pass:{"zh-TW":"跳過","zh-CN":"跳过",ja:"スキップ",en:"Pass",ko:"건너뛰기",th:"ข้าม",vi:"Bỏ qua",ms:"Langkau",la:"Transilire"},like:{"zh-TW":"建立連結","zh-CN":"建立连结",ja:"繋がる",en:"Connect",ko:"연결하기",th:"เชื่อมต่อ",vi:"Kết nối",ms:"Berhubung",la:"Coniungere"},noMoreUsers:{"zh-TW":"目前沒有更多夥伴了，請稍後再試。","zh-CN":"目前没有更多伙伴了，请稍后再试。",ja:"現在、他の仲間はいません。後でもう一度お試しください。",en:"No more partners for now. Please try again later.",ko:"지금은 더 이상 파트너가 없습니다. 나중에 다시 시도해주세요.",th:"ไม่มีพันธมิตรเพิ่มเติมในขณะนี้ กรุณาลองใหม่อีกครั้งในภายหลัง",vi:"Hiện tại không có đối tác nào khác. Vui lòng thử lại sau.",ms:"Tiada lagi rakan kongsi buat masa ini. Sila cuba lagi nanti.",la:"Nulli socii nunc. Quaeso, postea iterum conare."},profileModal:{nameLabel:{"zh-TW":"暱稱 / Name","zh-CN":"昵称 / Name",en:"Name",ja:"ニックネーム",ko:"닉네임",th:"ชื่อเล่น",vi:"Biệt danh",ms:"Nama Panggilan",la:"Nomen"},bioLabel:{"zh-TW":"簡介 / Bio","zh-CN":"简介 / Bio",en:"Bio",ja:"自己紹介",ko:"소개",th:"ประวัติ",vi:"Tiểu sử",ms:"Bio",la:"Descriptio"},goalLabel:{"zh-TW":"主要目標 / Main Goal","zh-CN":"主要目标 / Main Goal",en:"Main Goal",ja:"主な目標",ko:"주요 목표",th:"เป้าหมายหลัก",vi:"Mục tiêu chính",ms:"Matlamat Utama",la:"Propositum Principale"},skillsLabel:{"zh-TW":"技能 / Skills","zh-CN":"技能 / Skills",en:"Skills",ja:"スキル",ko:"기술",th:"ทักษะ",vi:"Kỹ năng",ms:"Kemahiran",la:"Artes"},selectDefault:{"zh-TW":"請選擇","zh-CN":"请选择",en:"Please select",ja:"選択してください",ko:"선택하세요",th:"กรุณาเลือก",vi:"Vui lòng chọn",ms:"Sila pilih",la:"Quaeso selige"},cancelButton:{"zh-TW":"取消","zh-CN":"取消",en:"Cancel",ja:"キャンセル",ko:"취소",th:"ยกเลิก",vi:"Hủy bỏ",ms:"Batal",la:"Abrogare"},saveButton:{"zh-TW":"儲存","zh-CN":"保存",en:"Save",ja:"保存",ko:"저장",th:"บันทึก",vi:"Lưu",ms:"Simpan",la:"Servare"},avatarLabel:{"zh-TW":"頭像 / Avatar","zh-CN":"头像 / Avatar",en:"Avatar",ja:"アバター",ko:"아바타",th:"รูปประจำตัว",vi:"Ảnh đại diện",ms:"Avatar",la:"Imago"},uploading:{"zh-TW":"上傳中...","zh-CN":"上传中...",en:"Uploading...",ja:"アップロード中...",ko:"업로드 중...",th:"กำลังอัปโหลด...",vi:"Đang tải lên...",ms:"Memuat naik...",la:"Imponens..."}},chatroom:{"zh-TW":"聊天室","zh-CN":"聊天室",en:"Chat Room",ja:"チャットルーム",ko:"채팅방",th:"ห้องแชท",vi:"Phòng chat",ms:"Bilik Sembang",la:"Cella Colloquii"},invites:{"zh-TW":"邀請通知","zh-CN":"邀请通知",en:"Invitations",ja:"招待通知",ko:"초대 알림",th:"การแจ้งเตือนคำเชิญ",vi:"Thông báo mời",ms:"Notis Jemputan",la:"Notitia Invitationis"},mylinks:{"zh-TW":"我的連結","zh-CN":"我的连接",en:"My Links",ja:"私のリンク",ko:"내 링크",th:"ลิงก์ของฉัน",vi:"Liên kết của tôi",ms:"Pautan Saya",la:"Nexus Mei"},returnFriendStories:{"zh-TW":"返回好友故事","zh-CN":"返回好友故事",en:"Return to Friend Stories",ja:"友達のストーリーに戻る",ko:"친구 이야기로 돌아가기",th:"กลับไปที่เรื่องราวของเพื่อน",vi:"Quay lại câu chuyện bạn bè",ms:"Kembali ke Cerita Rakan",la:"Redi ad Fabulas Amicorum"},hello:{"zh-TW":"你好，","zh-CN":"你好，",ja:"こんにちは、",en:"Hello,",ko:"안녕하세요,",th:"สวัสดี,",vi:"Xin chào,",ms:"Hai,",la:"Salve,"},partnerTitle:{"zh-TW":"尋求夥伴同行","zh-CN":"寻找伙伴同行",ja:"仲間を探す",en:"Find a Partner",ko:"동행자 찾기",th:"ค้นหาคู่หู",vi:"Tìm bạn đồng hành",ms:"Cari Rakan Kongsi",la:"Socius Quaerere"},partnerSubtitle:{"zh-TW":"請選擇你的夥伴目標","zh-CN":"请选择你的伙伴目标",ja:"パートナー目標を選択してください",en:"Please select your partner goal",ko:"파트너 목표를 선택하세요",th:"โปรดเลือกเป้าหมายของคู่หู",vi:"Vui lòng chọn mục tiêu đối tác",ms:"Sila pilih matlamat rakan kongsi anda",la:"Quaeso selige propositum socii tui"},noPartnerYet:{"zh-TW":"🦋你的夥伴很快就會出現喔，請耐心等待...","zh-CN":"🦋你的伙伴很快就會出现哦，请耐心等待...",ja:"🦋あなたのパートナーはすぐに現れます。お待ちください。",en:"🦋 Your partner will appear soon. Please be patient.",ko:"🦋 당신의 파트너가 곧 나타날 것입니다. 조금만 기다려주세요.",th:"🦋พันธมิตรของคุณจะปรากฏในขณะนี้ โปรดอดทนต่อไป",vi:"🦋 Bạn đồng hành của bạn sẽ xuất hiện sớm. Vui lòng đợi để chờ đợi...",ms:"🦋 Rakan kongsi anda akan muncul segera. Sila tunggu dengan sabar...",la:"🦋 Socius tuus apparebit. Quaeso, patientia attendas..."}};function bB(){const n=$e(),[e,t]=g.useState(null),{lang:i,setLang:s}=Qe(),[o,a]=g.useState([]),[l,c]=g.useState([]),[u,h]=g.useState(0),[p,f]=g.useState("peer"),[b,x]=g.useState(""),[S,w]=g.useState(!1),[I,j]=g.useState({name:"",bio:"",goal:"",skills:"",avatar:"",customSkill:"",country:"",gender:""}),[A,D]=g.useState({name:"",bio:"",goal:"",skills:"",avatar:"",customSkill:"",country:"",gender:""}),[O,P]=g.useState(""),[B,k]=g.useState(null),[T,R]=g.useState(null),[E,_]=g.useState(!0),[v,z]=g.useState("main"),[H,L]=g.useState("none"),[ee,ge]=g.useState(null);g.useRef(u),g.useEffect(()=>{const te=ur(_r,async W=>{if(W){t(W);const Y=Ot(ht,"profiles",W.uid),X=await fi(Y);if(X.exists()){const le=X.data();j({name:le.nickname||le.name||"新用戶",bio:le.bio,goal:le.goal,skills:le.skills,avatar:le.avatar,customSkill:le.customSkill||"",country:le.country||"",gender:le.gender||""})}else{const le={name:W.displayName||"新用戶",bio:"",goal:"",skills:"",avatar:W.photoURL||"/avatars/Derxl.png",customSkill:"",country:"",gender:""};j(le),await Ma(Y,le)}await oe(W.uid)}else n("/")});return()=>te()},[_r,ht,n]);const oe=async te=>{try{_(!0);const W=Wt(ht,"profiles"),Y=un(W,Lt("__name__","!=",te)),X=await kn(Y),le=[];X.forEach(be=>{const ve=be.data();le.push({id:be.id,name:ve.name||"Unknown",goal:ve.goal||"learnNewSkills",role:ve.role||"peer",bio:ve.bio||{"zh-TW":"No bio available","zh-CN":"暂无简介",en:"No bio available",ja:"自己紹介なし",ko:"소개 없음",th:"ไม่มีประวัติ",vi:"Không có tiểu sử",ms:"Tiada bio",la:"Nulla descriptio"},avatar:ve.avatar||"/avatars/Derxl.png",skills:ve.skills||"",createdAt:ve.createdAt,country:ve.country||"",gender:ve.gender||""})}),a(le),c(le)}catch(W){console.error("Error loading users:",W)}finally{_(!1)}},Ie=async(te,W)=>{if(e)try{const Y={fromUserId:e.uid,fromUserName:I.name,fromUserAvatar:I.avatar,fromUserCountry:I.country||"",fromUserGender:I.gender||"",fromUserEmail:e.email||"",fromUserNickname:I.name||"",toUserId:te,toUserName:W.name,role:W.role,goal:W.goal,status:"pending",createdAt:pp()};await $i(Wt(ht,"invites"),Y),ge(st.like[i]+" 成功！"),setTimeout(()=>ge(null),2e3)}catch(Y){console.error("Error sending invite:",Y),alert("發送邀請失敗")}};g.useMemo(()=>Array(l.length).fill(0).map(te=>Kt.createRef()),[l.length]),g.useEffect(()=>{if(o.length>0){const te=o.filter(W=>{const Y=W.role===p,X=b?W.goal===b:!0;return Y&&X});c(te),h(te.length-1)}},[p,b,o]),g.useEffect(()=>{S&&(D(I),P(I.avatar),R(null),k(null))},[S,I]),l[u];const Re=["jobSeeking","learnNewSkills","emotionalSupport","networking","startupPrep"];return g.useEffect(()=>{if(!localStorage.getItem("lang")){const te=navigator.language;let W="zh-TW";te.startsWith("zh-CN")?W="zh-CN":te.startsWith("zh-TW")?W="zh-TW":te.startsWith("ja")?W="ja":te.startsWith("ko")?W="ko":te.startsWith("th")?W="th":te.startsWith("vi")?W="vi":te.startsWith("ms")?W="ms":te.startsWith("la")?W="la":te.startsWith("en")&&(W="en"),s(W),localStorage.setItem("lang",W)}},[s]),g.useEffect(()=>{if(H==="in"){const te=document.getElementById("user-card");te&&te.animate([{transform:"translateX(-120%) scale(0.4)",opacity:0},{transform:"translateX(0) scale(1)",opacity:1}],{duration:400}),setTimeout(()=>L("none"),400)}},[H]),r.jsxs("div",{style:{width:"100vw",height:"100vh",overflow:"hidden",position:"relative"},children:[window.innerWidth<=768?r.jsxs("div",{style:{width:"100%",height:"100vh",display:"flex",flexDirection:"column",background:"url('/green_hut.png') center center / cover no-repeat fixed"},children:[r.jsxs("div",{style:{position:"fixed",top:0,left:0,right:0,zIndex:100,background:"rgba(255,255,255,0.95)",padding:"8px 16px",display:"flex",justifyContent:"space-between",alignItems:"center",boxShadow:"0 2px 8px #0001"},children:[r.jsx("button",{className:"topbar-btn",onClick:()=>n("/"),style:{fontWeight:700,fontSize:14,padding:"6px 12px",borderRadius:8,border:"1.5px solid #6B5BFF",background:"#fff",color:"#6B5BFF",cursor:"pointer"},children:st.backToHome[i]}),r.jsxs("h2",{style:{fontSize:"1.2rem",fontWeight:900,color:"#6B5BFF",margin:0,textAlign:"center"},children:["🦋 ",st.pageTitle[i]]}),r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[r.jsx("button",{className:"topbar-btn",onClick:async()=>{await hn(_r),localStorage.clear(),window.location.href="/"},style:{fontWeight:700,fontSize:14,padding:"6px 12px",borderRadius:8,border:"1.5px solid #6B5BFF",background:"#fff",color:"#6B5BFF",cursor:"pointer"},children:st.logout[i]}),r.jsx(en,{style:{width:"80px",fontSize:14,padding:"6px 10px"}})]})]}),r.jsxs("div",{style:{marginTop:60,padding:"16px",flex:1,overflowY:"auto"},children:[r.jsxs("div",{style:{background:"rgba(255,255,255,0.95)",borderRadius:16,padding:"16px",marginBottom:16,boxShadow:"0 2px 12px #6B5BFF22"},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,marginBottom:12},children:[r.jsx("div",{style:{fontSize:24},children:"🦋"}),r.jsx("div",{style:{fontWeight:700,fontSize:14,color:"#6B5BFF"},children:st.hello?st.hello[i]:"你好，"}),r.jsx("img",{src:I.avatar,alt:"avatar",style:{width:36,height:36,borderRadius:"50%",objectFit:"cover",border:"2px solid #6B5BFF"}}),r.jsx("div",{style:{fontWeight:700,fontSize:14,color:"#333"},children:I.name})]}),r.jsxs("div",{style:{background:"rgba(128,128,128,0.1)",borderRadius:12,padding:"16px",marginBottom:16,boxShadow:"0 4px 12px rgba(0,0,0,0.15)"},children:[r.jsx("div",{style:{fontWeight:700,fontSize:16,color:"#6B5BFF",textAlign:"center",marginBottom:8},children:st.partnerTitle?st.partnerTitle[i]:"尋求夥伴同行"}),r.jsx("div",{style:{fontSize:12,color:"#888",textAlign:"center",marginBottom:12},children:st.partnerSubtitle?st.partnerSubtitle[i]:"請選擇你的夥伴目標"}),r.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:8},children:Re.map(te=>r.jsx("button",{onClick:()=>{x(te),z("main")},style:{flex:"1 1 calc(50% - 4px)",padding:"8px 4px",borderRadius:8,border:b===te?"2px solid #23c6e6":"1px solid #eee",background:b===te?"#e6f7ff":"#fff",color:b===te?"#23c6e6":"#333",fontWeight:600,fontSize:12,cursor:"pointer",boxShadow:b===te?"0 2px 8px #23c6e622":"0 1px 4px #0001"},children:st.goalOptions[te][i]},te))})]}),r.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:8},children:[r.jsx("button",{onClick:()=>n("/chatroom"),style:{padding:"8px",borderRadius:8,border:v==="chat"?"2px solid #8ec6f7":"1px solid #eee",background:v==="chat"?"#e6f7ff":"#fff",color:v==="chat"?"#23c6e6":"#333",fontWeight:600,fontSize:14,cursor:"pointer"},children:st.chatroom[i]}),r.jsx("button",{onClick:()=>z("invites"),style:{padding:"8px",borderRadius:8,border:v==="invites"?"2px solid #6B5BFF":"1px solid #eee",background:v==="invites"?"#f5f4ff":"#fff",color:v==="invites"?"#6B5BFF":"#333",fontWeight:600,fontSize:14,cursor:"pointer"},children:st.invites[i]}),r.jsx("button",{onClick:()=>z("links"),style:{padding:"8px",borderRadius:8,border:v==="links"?"2px solid #6B5BFF":"1px solid #eee",background:v==="links"?"#f5f4ff":"#fff",color:v==="links"?"#6B5BFF":"#333",fontWeight:600,fontSize:14,cursor:"pointer"},children:st.mylinks[i]}),r.jsxs("span",{href:"/storywall",style:{padding:"8px",borderRadius:8,border:"1px solid #23c6e6",background:"#fff",color:"#23c6e6",fontWeight:600,fontSize:14,cursor:"pointer",textAlign:"center",textDecoration:"none",display:"block"},children:[st.returnFriendStories[i]," 🦋"]})]})]}),r.jsxs("div",{style:{background:"rgba(255,255,255,0.95)",borderRadius:16,padding:"16px",minHeight:400},children:[v==="main"&&r.jsx(r.Fragment,{children:(()=>{var Y,X;const te=l.filter(le=>!b||le.goal===b);if(te.length===0)return r.jsx("div",{style:{textAlign:"center",color:"#e74c3c",fontSize:16,marginTop:40,fontWeight:700},children:((Y=st.noPartnerYet)==null?void 0:Y[i])||"🦋你的夥伴很快就會出現喔，請耐心等待..."});const W=te[u>=0&&u<te.length?u:0];return W?r.jsxs("div",{id:"user-card",style:{textAlign:"center",transition:"box-shadow 0.2s, transform 0.4s",transform:H==="in"?"translateX(-120%) scale(0.4)":H==="out"?"translateX(120%) scale(0.4)":"translateX(0) scale(1)",opacity:1},onAnimationEnd:()=>{H==="in"&&L("none")},children:[r.jsx("img",{src:W.avatar,alt:"avatar",style:{width:80,height:80,borderRadius:"50%",objectFit:"cover",border:"3px solid #6B5BFF",marginBottom:12}}),r.jsx("div",{style:{fontWeight:800,fontSize:18,color:"#6B5BFF",marginBottom:8},children:W.name}),r.jsxs("div",{style:{color:"#888",fontSize:14,marginBottom:4},children:["國家/地區：",W.country||"未填寫"]}),r.jsxs("div",{style:{color:"#888",fontSize:14,marginBottom:4},children:["性別：",W.gender||"未填寫"]}),r.jsxs("div",{style:{color:"#888",fontSize:14,marginBottom:4},children:["目標：",((X=st.goalOptions[W.goal])==null?void 0:X[i])||W.goal]}),r.jsxs("div",{style:{color:"#888",fontSize:14,marginBottom:16},children:["技能：",W.skills||"未填寫"]}),r.jsxs("div",{style:{display:"flex",gap:12,justifyContent:"center"},children:[r.jsx("button",{onClick:()=>{const le=document.getElementById("user-card");le&&(L("out"),le.animate([{transform:"translateX(0) scale(1)",opacity:1},{transform:"translateX(120%) scale(0.4)",opacity:0}],{duration:400})),setTimeout(()=>{h(be=>(L("in"),(be-1+te.length)%te.length))},400)},style:{padding:"8px 20px",borderRadius:8,border:"1.5px solid #bbb",background:"#fff",color:"#888",fontWeight:600,fontSize:14,cursor:"pointer"},children:"跳過"}),r.jsx("button",{onClick:()=>Ie(W.id,W),style:{padding:"8px 20px",borderRadius:8,border:"1.5px solid #6B5BFF",background:"#6B5BFF",color:"#fff",fontWeight:600,fontSize:14,cursor:"pointer"},children:"建立連結"})]})]}):null})()}),v==="chat"&&r.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:20,justifyContent:"center",alignItems:"center",minHeight:"50vh",padding:"20px 0"},children:[r.jsxs("div",{style:{background:"rgba(128,128,128,0.15)",borderRadius:16,padding:"24px",boxShadow:"0 6px 16px rgba(0,0,0,0.2)",width:"95%",maxWidth:320,border:"1px solid rgba(128,128,128,0.2)"},children:[r.jsx("div",{style:{fontWeight:800,fontSize:20,color:"#6B5BFF",marginBottom:16,textAlign:"center"},children:"好友列表"}),r.jsx("div",{style:{textAlign:"center",color:"#666",fontSize:15,lineHeight:1.4},children:"請先加好友,才能開始聊天"})]}),r.jsxs("div",{style:{background:"rgba(128,128,128,0.15)",borderRadius:16,padding:"24px",boxShadow:"0 6px 16px rgba(0,0,0,0.2)",width:"95%",maxWidth:320,border:"1px solid rgba(128,128,128,0.2)"},children:[r.jsx("div",{style:{fontWeight:800,fontSize:20,color:"#6B5BFF",marginBottom:16,textAlign:"center"},children:"聊天訊息框"}),r.jsx("div",{style:{textAlign:"center",color:"#666",fontSize:15,lineHeight:1.4},children:"還沒有朋友,去交友區加好友吧!"})]})]}),v==="links"&&r.jsx(Yu,{embedded:!0}),v==="invites"&&r.jsx(Xu,{embedded:!0})]}),r.jsx("div",{style:{width:"100%",margin:"0 auto",marginTop:24},children:r.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:8},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:20,flexWrap:"wrap"},children:[r.jsx("span",{onClick:()=>n("/about"),style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12,cursor:"pointer"},children:"🧬 Restarter™｜我們是誰"}),r.jsx("span",{onClick:()=>n("/privacy-policy"),style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12,cursor:"pointer"},children:"隱私權政策"}),r.jsx("span",{onClick:()=>n("/terms"),style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12,cursor:"pointer"},children:"條款/聲明"})]}),r.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:20,flexWrap:"wrap"},children:[r.jsx("span",{onClick:()=>n("/data-deletion"),style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12,cursor:"pointer"},children:"資料刪除說明"}),r.jsx("span",{onClick:()=>n("/feedback"),style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12,cursor:"pointer"},children:"💬 意見箱｜我們想聽你說"})]})]})})]})]}):r.jsxs(r.Fragment,{children:[r.jsxs("div",{style:{position:"fixed",top:0,left:0,right:0,zIndex:100,background:"rgba(255,255,255,0.95)",padding:"12px 24px",display:"flex",justifyContent:"space-between",alignItems:"center",boxShadow:"0 2px 8px #0001"},children:[r.jsx("button",{className:"topbar-btn",onClick:()=>n("/"),style:{fontWeight:700,fontSize:16,padding:"8px 16px",borderRadius:8,border:"1.5px solid #6B5BFF",background:"#fff",color:"#6B5BFF",cursor:"pointer"},children:st.backToHome[i]}),r.jsxs("h1",{style:{fontSize:"1.8rem",fontWeight:900,color:"#6B5BFF",margin:0,textAlign:"center"},children:["🦋 ",st.pageTitle[i]]}),r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[r.jsx("button",{className:"topbar-btn",onClick:async()=>{await hn(_r),localStorage.clear(),window.location.href="/"},style:{fontWeight:700,fontSize:16,padding:"8px 16px",borderRadius:8,border:"1.5px solid #6B5BFF",background:"#fff",color:"#6B5BFF",cursor:"pointer"},children:st.logout[i]}),r.jsx(en,{style:{width:"100px",fontSize:16,padding:"8px 12px"}})]})]}),r.jsx("div",{style:{position:"fixed",left:0,top:60,width:340,height:"calc(100vh - 60px)",background:"rgba(255,255,255,0.95)",borderRight:"1px solid #eee",overflowY:"auto",zIndex:2,padding:"24px 16px"},children:r.jsxs("div",{style:{background:"rgba(255,255,255,0.95)",borderRadius:16,padding:"20px",marginBottom:24,boxShadow:"0 2px 12px #6B5BFF22"},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:16,marginBottom:16},children:[r.jsx("div",{style:{fontSize:32},children:"🦋"}),r.jsx("div",{style:{fontWeight:700,fontSize:16,color:"#6B5BFF"},children:st.hello?st.hello[i]:"你好，"}),r.jsx("img",{src:I.avatar,alt:"avatar",style:{width:48,height:48,borderRadius:"50%",objectFit:"cover",border:"3px solid #6B5BFF"}}),r.jsx("div",{style:{fontWeight:700,fontSize:16,color:"#333"},children:I.name})]}),r.jsxs("div",{style:{background:"rgba(128,128,128,0.1)",borderRadius:12,padding:"20px",marginBottom:24,boxShadow:"0 4px 12px rgba(0,0,0,0.15)"},children:[r.jsx("div",{style:{fontWeight:700,fontSize:18,color:"#6B5BFF",textAlign:"center",marginBottom:12},children:st.partnerTitle?st.partnerTitle[i]:"尋求夥伴同行"}),r.jsx("div",{style:{fontSize:14,color:"#888",textAlign:"center",marginBottom:20},children:st.partnerSubtitle?st.partnerSubtitle[i]:"請選擇你的夥伴目標"}),r.jsx("div",{style:{display:"flex",flexDirection:"column",gap:12},children:Re.map(te=>r.jsx("button",{onClick:()=>{x(te),z("main")},style:{width:"100%",padding:"12px 16px",borderRadius:10,border:b===te?"2px solid #23c6e6":"1.5px solid #eee",background:b===te?"#e6f7ff":"#fff",color:b===te?"#23c6e6":"#333",fontWeight:700,fontSize:15,cursor:"pointer",boxShadow:b===te?"0 2px 8px #23c6e622":"0 2px 8px #0001",transition:"all 0.2s",outline:"none",borderLeft:b===te?"6px solid #23c6e6":"6px solid transparent",marginBottom:0},children:st.goalOptions[te][i]},te))})]}),r.jsx("button",{onClick:()=>n("/chatroom"),style:{width:"100%",marginBottom:12,padding:"12px 0",borderRadius:10,border:v==="chat"?"2px solid #8ec6f7":"1.5px solid #eee",background:v==="chat"?"#e6f7ff":"#fff",color:v==="chat"?"#23c6e6":"#333",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:v==="chat"?"0 2px 8px #23c6e622":"0 2px 8px #0001",transition:"all 0.2s"},children:st.chatroom[i]}),r.jsx("button",{onClick:()=>z("invites"),style:{width:"100%",marginBottom:12,padding:"12px 0",borderRadius:10,border:v==="invites"?"2px solid #6B5BFF":"1.5px solid #eee",background:v==="invites"?"#f5f4ff":"#fff",color:v==="invites"?"#6B5BFF":"#333",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:v==="invites"?"0 2px 8px #6B5BFF22":"0 2px 8px #0001",transition:"all 0.2s"},children:st.invites[i]}),r.jsx("button",{onClick:()=>z("links"),style:{width:"100%",marginBottom:12,padding:"12px 0",borderRadius:10,border:v==="links"?"2px solid #6B5BFF":"1.5px solid #eee",background:v==="links"?"#f5f4ff":"#fff",color:v==="links"?"#6B5BFF":"#333",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:v==="links"?"0 2px 8px #6B5BFF22":"0 2px 8px #0001",transition:"all 0.2s"},children:st.mylinks[i]}),r.jsxs("span",{href:"/storywall",style:{width:"100%",marginBottom:12,padding:"12px 0",borderRadius:10,border:"1.5px solid #23c6e6",background:"#fff",color:"#23c6e6",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:"0 2px 8px #23c6e622",textAlign:"center",textDecoration:"none",display:"block",transition:"all 0.2s"},children:[st.returnFriendStories[i]," 🦋"]})]})}),r.jsx("div",{style:{position:"fixed",left:340,top:60,width:"calc(100vw - 340px)",height:"calc(100vh - 60px)",overflowY:"auto",display:"flex",flexDirection:"column",alignItems:"center",background:"url('/green_hut.png') center center / cover no-repeat fixed",zIndex:1,pointerEvents:"auto",paddingLeft:0},children:r.jsxs("div",{style:{width:"100%",maxWidth:900,marginTop:60},children:[v==="main"&&r.jsx(r.Fragment,{children:(()=>{var Y,X;const te=l.filter(le=>!b||le.goal===b);if(te.length===0)return r.jsx("div",{style:{textAlign:"center",color:"#e74c3c",fontSize:18,marginTop:40,fontWeight:700},children:((Y=st.noPartnerYet)==null?void 0:Y[i])||"🦋你的夥伴很快就會出現喔，請耐心等待..."});const W=te[u>=0&&u<te.length?u:0];return W?r.jsxs("div",{id:"user-card",style:{width:340,margin:"0 auto",background:"#fff",borderRadius:18,boxShadow:"0 2px 16px #6B5BFF22",padding:32,display:"flex",flexDirection:"column",alignItems:"center",position:"relative",minHeight:380,transition:"box-shadow 0.2s, transform 0.4s",transform:H==="in"?"translateX(-120%) scale(0.4)":H==="out"?"translateX(120%) scale(0.4)":"translateX(0) scale(1)",opacity:1},onAnimationEnd:()=>{H==="in"&&L("none")},children:[r.jsx("img",{src:W.avatar,alt:"avatar",style:{width:88,height:88,borderRadius:"50%",objectFit:"cover",border:"3px solid #6B5BFF",marginBottom:16}}),r.jsx("div",{style:{fontWeight:800,fontSize:22,color:"#6B5BFF",marginBottom:8},children:W.name}),r.jsxs("div",{style:{color:"#888",fontSize:15,marginBottom:4},children:["國家/地區：",W.country||"未填寫"]}),r.jsxs("div",{style:{color:"#888",fontSize:15,marginBottom:4},children:["性別：",W.gender||"未填寫"]}),r.jsxs("div",{style:{color:"#888",fontSize:15,marginBottom:4},children:["目標：",((X=st.goalOptions[W.goal])==null?void 0:X[i])||W.goal]}),r.jsxs("div",{style:{color:"#888",fontSize:15,marginBottom:12},children:["技能：",W.skills||"未填寫"]}),r.jsxs("div",{style:{display:"flex",gap:16,marginTop:24},children:[r.jsx("button",{onClick:()=>{const le=document.getElementById("user-card");le&&(L("out"),le.animate([{transform:"translateX(0) scale(1)",opacity:1},{transform:"translateX(120%) scale(0.4)",opacity:0}],{duration:400})),setTimeout(()=>{h(be=>(L("in"),(be-1+te.length)%te.length))},400)},style:{padding:"10px 28px",borderRadius:8,border:"1.5px solid #bbb",background:"#fff",color:"#888",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:"0 2px 8px #0001",transition:"all 0.2s"},children:"跳過"}),r.jsx("button",{onClick:()=>Ie(W.id,W),style:{padding:"10px 28px",borderRadius:8,border:"1.5px solid #6B5BFF",background:"#6B5BFF",color:"#fff",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:"0 2px 8px #6B5BFF22",transition:"all 0.2s"},children:"建立連結"})]})]}):null})()}),v==="chat"&&r.jsx("div",{children:"聊天室功能開發中"}),v==="links"&&r.jsx(Yu,{embedded:!0}),v==="invites"&&r.jsx(Xu,{embedded:!0})]})}),r.jsx("div",{style:{position:"absolute",bottom:0,left:340,right:0,zIndex:100},children:r.jsx("div",{style:{width:"100%",margin:"0 auto",marginTop:24,background:"rgba(255,255,255,0.95)",borderRadius:16,padding:"16px",boxShadow:"0 2px 12px #6B5BFF22"},children:r.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:20,flexWrap:"wrap"},children:[r.jsx("span",{onClick:()=>n("/about"),style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12,cursor:"pointer"},children:i==="zh-TW"?"🧬 Restarter™｜我們是誰":i==="zh-CN"?"🧬 Restarter™｜我们是谁":i==="en"?"🧬 Restarter™｜Who We Are":i==="ja"?"🧬 Restarter™｜私たちについて":i==="ko"?"🧬 Restarter™｜우리는 누구인가":i==="th"?"🧬 Restarter™｜เราเป็นใคร":i==="vi"?"🧬 Restarter™｜Chúng tôi là ai":i==="ms"?"🧬 Restarter™｜Siapa Kami":"🧬 Restarter™｜Quis sumus"}),r.jsx("span",{onClick:()=>n("/privacy-policy"),style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12,cursor:"pointer"},children:i==="zh-TW"?"隱私權政策":i==="zh-CN"?"隐私政策":i==="en"?"Privacy Policy":i==="ja"?"プライバシーポリシー":i==="ko"?"개인정보 처리방침":i==="th"?"นโยบายความเป็นส่วนตัว":i==="vi"?"Chính sách bảo mật":i==="ms"?"Dasar Privasi":"Consilium de Privata"}),r.jsx("span",{onClick:()=>n("/terms"),style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12,cursor:"pointer"},children:i==="zh-TW"?"條款/聲明":i==="zh-CN"?"条款/声明":i==="en"?"Terms/Statement":i==="ja"?"規約/声明":i==="ko"?"약관/성명":i==="th"?"ข้อกำหนด/แถลงการณ์":i==="vi"?"Điều khoản/Tuyên bố":i==="ms"?"Terma/Pernyataan":"Termini/Declaratio"}),r.jsx("span",{onClick:()=>n("/data-deletion"),style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12,cursor:"pointer"},children:i==="zh-TW"?"資料刪除說明":i==="zh-CN"?"数据删除说明":i==="en"?"Data Deletion":i==="ja"?"データ削除について":i==="ko"?"데이터 삭제 안내":i==="th"?"คำอธิบายการลบข้อมูล":i==="vi"?"Giải thích xóa dữ liệu":i==="ms"?"Penjelasan Penghapusan Data":"Explicatio Deletionis Datae"}),r.jsx("span",{onClick:()=>n("/feedback"),style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12,cursor:"pointer"},children:i==="zh-TW"?"💬 意見箱｜我們想聽你說":i==="zh-CN"?"💬 意见箱｜我们想听你说":i==="en"?"💬 Feedback Box｜We Want to Hear From You":i==="ja"?"💬 ご意見箱｜私たちはあなたの声を聞きたい":i==="ko"?"💬 피드백｜우리는 당신의 말을 듣고 싶습니다":i==="th"?"💬 กล่องความคิดเห็น｜เราอยากได้ยินจากคุณ":i==="vi"?"💬 Hộp góp ý｜Chúng tôi muốn nghe từ bạn":i==="ms"?"💬 Kotak Maklum Balas｜Kami Ingin Mendengar Dari Anda":"💬 Arca Consilii｜Volumus Audire a Te"})]})})})]}),ee&&r.jsx("div",{style:{position:"fixed",top:32,left:"50%",transform:"translateX(-50%)",background:"#1976d2",color:"#fff",padding:"14px 32px",borderRadius:16,fontSize:18,fontWeight:700,zIndex:9999,boxShadow:"0 2px 16px #1976d288",letterSpacing:1,textAlign:"center",opacity:.97},children:ee})]})}function vB(){try{return JSON.parse(localStorage.getItem("messages")||"[]")}catch{return[]}}function wB(){const n=localStorage.getItem("userId")||"",e=vB(),t=localStorage.getItem("lang")||"zh-TW",i={"zh-TW":{title:"我的留言箱",noMessages:"目前沒有收到任何留言",messageFrom:"留言：",aboutPost:"針對你的貼文：「"},"zh-CN":{title:"我的留言箱",noMessages:"目前没有收到任何留言",messageFrom:"留言：",aboutPost:"针对你的贴文：「"},en:{title:"My Inbox",noMessages:"No messages received yet",messageFrom:"message:",aboutPost:'About your post: "'},ja:{title:"メッセージボックス",noMessages:"まだメッセージがありません",messageFrom:"メッセージ：",aboutPost:"あなたの投稿について：「"},ko:{title:"내 메시지함",noMessages:"아직 받은 메시지가 없습니다",messageFrom:"메시지:",aboutPost:'당신의 게시물에 대해: "'},vi:{title:"Hộp thư của tôi",noMessages:"Chưa có tin nhắn nào",messageFrom:"tin nhắn:",aboutPost:'Về bài đăng của bạn: "'},th:{title:"กล่องข้อความของฉัน",noMessages:"ยังไม่มีข้อความ",messageFrom:"ข้อความ:",aboutPost:'เกี่ยวกับโพสต์ของคุณ: "'},la:{title:"Mea Inbox",noMessages:"Nondum epistulae receptae",messageFrom:"epistula:",aboutPost:'De tuo post: "'},ms:{title:"Peti Surat Saya",noMessages:"Belum ada mesej diterima",messageFrom:"mesej:",aboutPost:'Mengenai siaran anda: "'}},s=i[t]||i.en,o=e.flatMap(a=>(a.comments||[]).filter(l=>l.toUserId===n).map(l=>({...l,post:a.text,from:a.user.name})));return r.jsx("div",{className:"modern-bg",style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center"},children:r.jsxs("div",{className:"modern-container",style:{maxWidth:600,width:"100%",margin:"0 auto",padding:32},children:[r.jsx("h2",{style:{textAlign:"center",color:"#6B5BFF",fontWeight:900,marginBottom:24},children:s.title}),o.length===0&&r.jsx("div",{style:{color:"#bbb",textAlign:"center"},children:s.noMessages}),o.map((a,l)=>r.jsxs("div",{style:{background:"#f7f7ff",borderRadius:12,padding:16,boxShadow:"0 2px 8px #6B5BFF11",marginBottom:16},children:[r.jsxs("div",{style:{color:"#6B5BFF",fontWeight:700},children:[a.from," ",s.messageFrom]}),r.jsx("div",{style:{color:"#232946",margin:"8px 0"},children:a.content}),r.jsxs("div",{style:{color:"#6B4F27",fontSize:14},children:[s.aboutPost,a.post,"」"]})]},l))]})})}const dy={"zh-TW":{title:"AI 風格回覆",comingSoon:"體驗即將開放，敬請期待！",playing:"播放中...",playAudio:"播放語音"},"zh-CN":{title:"AI 风格回复",comingSoon:"体验即将开放，敬请期待！",playing:"播放中...",playAudio:"播放语音"},en:{title:"AI-Styled Reply",comingSoon:"Experience coming soon, stay tuned!",playing:"Playing...",playAudio:"Play Audio"},ja:{title:"AI風返信",comingSoon:"体験は近日公開予定です、お楽しみに！",playing:"再生中...",playAudio:"音声を再生"},ko:{title:"AI 스타일 응답",comingSoon:"체험이 곧 시작될 예정이니 기대해주세요!",playing:"재생 중...",playAudio:"오디오 재생"},vi:{title:"Trả lời theo phong cách AI",comingSoon:"Trải nghiệm sắp ra mắt, hãy theo dõi!",playing:"Đang phát...",playAudio:"Phát âm thanh"},th:{title:"การตอบกลับสไตล์ AI",comingSoon:"ประสบการณ์กำลังจะมาเร็วๆ นี้ โปรดติดตาม!",playing:"กำลังเล่น...",playAudio:"เล่นเสียง"},la:{title:"Responsum Stilo AI",comingSoon:"Experientia mox praesto erit, mane exspectans!",playing:"Ludens...",playAudio:"Sonum redde"},ms:{title:"Balasan Gaya AI",comingSoon:"Pengalaman akan datang, nantikan!",playing:"Sedang dimainkan...",playAudio:"Mainkan Audio"}};function kB(){const[n,e]=Kt.useState(!1),[t,i]=Kt.useState(()=>localStorage.getItem("lang")||"zh-TW"),s=dy[t]||dy["zh-TW"];Kt.useEffect(()=>{localStorage.setItem("lang",t)},[t]);const o=()=>{e(!0),setTimeout(()=>e(!1),3e3)};return r.jsxs("div",{className:"modern-bg",style:{minHeight:"100vh",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",position:"relative"},children:[r.jsx(en,{}),r.jsxs("div",{className:"modern-container",style:{maxWidth:480,width:"100%",margin:"0 auto",textAlign:"center",padding:48,borderRadius:18,background:"rgba(60,40,20,0.18)",boxShadow:"0 4px 24px #0002"},children:[r.jsx("h2",{style:{color:"#6B5BFF",fontWeight:900,fontSize:28,marginBottom:24},children:s.title}),r.jsx("div",{style:{color:"#6B4F27",fontSize:22,fontWeight:700},children:s.comingSoon}),r.jsx("button",{onClick:o,style:{padding:"6px 18px",borderRadius:8,background:"#6c63ff",color:"#fff",border:"none",fontWeight:700,fontSize:16,marginTop:8},disabled:n,children:n?s.playing:s.playAudio})]})]})}const SB=[{code:"zh-TW",label:"繁中"},{code:"zh-CN",label:"简中"},{code:"en",label:"EN"},{code:"ja",label:"日本語"},{code:"ko",label:"한국어"},{code:"vi",label:"Tiếng Việt"},{code:"th",label:"ไทย"},{code:"la",label:"Latina"},{code:"ms",label:"Bahasa Melayu"}],uy={"zh-TW":{title:"擬真語音輸出",comingSoon:"體驗即將開放，敬請期待！",playing:"播放中...",playAudio:"播放語音"},"zh-CN":{title:"拟真语音输出",comingSoon:"体验即将开放，敬请期待！",playing:"播放中...",playAudio:"播放语音"},en:{title:"Realistic TTS",comingSoon:"Experience coming soon, stay tuned!",playing:"Playing...",playAudio:"Play Audio"},ja:{title:"リアルな音声出力",comingSoon:"体験は近日公開予定です、お楽しみに！",playing:"再生中...",playAudio:"音声を再生"},ko:{title:"사실적인 음성 출력",comingSoon:"체험이 곧 시작될 예정이니 기대해주세요!",playing:"재생 중...",playAudio:"오디오 재생"},vi:{title:"Đầu ra giọng nói thực tế",comingSoon:"Trải nghiệm sắp ra mắt, hãy theo dõi!",playing:"Đang phát...",playAudio:"Phát âm thanh"},th:{title:"การส่งออกเสียงที่สมจริง",comingSoon:"ประสบการณ์กำลังจะมาเร็วๆ นี้ โปรดติดตาม!",playing:"กำลังเล่น...",playAudio:"เล่นเสียง"},la:{title:"Sermo Verus Output",comingSoon:"Experientia mox praesto erit, mane exspectans!",playing:"Ludens...",playAudio:"Sonum redde"},ms:{title:"Output Suara Realistik",comingSoon:"Pengalaman akan datang, nantikan!",playing:"Sedang dimainkan...",playAudio:"Mainkan Audio"}};function hy(){const[n,e]=Kt.useState(!1),[t,i]=Kt.useState("zh-TW"),s=uy[t]||uy["zh-TW"];Kt.useEffect(()=>{const a=localStorage.getItem("lang");a&&SB.find(l=>l.code===a)&&i(a)},[]),Kt.useEffect(()=>{localStorage.setItem("lang",t)},[t]);const o=()=>{e(!0),setTimeout(()=>e(!1),2e3)};return r.jsxs("div",{className:"modern-bg",style:{minHeight:"100vh",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",position:"relative"},children:[r.jsx("div",{style:{position:"absolute",top:24,right:36,zIndex:100},children:r.jsx(en,{})}),r.jsxs("div",{className:"modern-container",style:{maxWidth:480,width:"100%",margin:"0 auto",textAlign:"center",padding:48,borderRadius:18,background:"rgba(60,40,20,0.18)",boxShadow:"0 4px 24px #0002"},children:[r.jsx("h2",{style:{color:"#6B5BFF",fontWeight:900,fontSize:28,marginBottom:24},children:s.title}),r.jsx("div",{style:{color:"#6B4F27",fontSize:22,fontWeight:700},children:s.comingSoon}),r.jsx("button",{onClick:o,style:{padding:"6px 18px",borderRadius:8,background:"#6c63ff",color:"#fff",border:"none",fontWeight:700,fontSize:16,marginTop:8},disabled:n,children:n?s.playing:s.playAudio})]})]})}const py={"zh-TW":{back:"返回",logout:"登出",title:"重啟之路",subtitle:"一步步走出迷霧，看見全新的自己",steps:[{title:"第一站：迷霧山谷",desc:"寫下最近一件讓你感到強烈情緒的事。不必評判自己，單純描述事情的經過、你的感受，以及這個感受帶來的影響。",placeholder:"在這裡寫下你的故事...(300字內)"},{title:"第二站：希望之丘",desc:"回顧你剛剛寫下的事件，請思考：在那個情境下，你有沒有做過什麼小小的努力或嘗試？即使很微小，也請寫下來。",placeholder:"寫下你做過的努力或嘗試...(300字內)"},{title:"第三站：勇氣森林",desc:"根據你剛剛發現的努力或資源，請設定一個你願意嘗試的小行動，並寫下你預期會遇到的困難，以及你打算怎麼面對。",placeholder:"寫下你的小行動與預期困難...(300字內)"},{title:"第四站：智慧溪流",desc:"回顧你剛剛的行動經驗，請反思：這個過程中，你學到了什麼？有沒有什麼新的發現或領悟？",placeholder:"寫下你的學習與領悟...(300字內)"},{title:"第五站：重啟之巔",desc:"綜合前面所有關卡的經歷，請寫下你給未來自己的祝福或期許，並思考：如果未來再遇到困難，你會怎麼鼓勵自己？",placeholder:"寫下給自己的祝福或期許...(300字內)"}],submit:"提交，尋求指引",loading:"請稍候...",next:"前往下一站",finish:"恭喜你完成重啟之路！",finishSub:"未來也請繼續善待自己！",error:"發生錯誤，請稍後再試。",retry:"再來一次"},"zh-CN":{back:"返回首页",logout:"登出",title:"日常任务挑战",subtitle:"一步步走出迷雾，看见全新的自己",steps:[{title:"第一站：迷雾山谷",desc:"写下最近一件让你感到强烈情绪的事。不必评判自己，单纯描述事情的经过、你的感受，以及这个感受带来的影响。",placeholder:"在这里写下你的故事...(300字内)"},{title:"第二站：希望之丘",desc:"回顾你刚刚写下的事件，请思考：在那个情境下，你有没有做过什么小小的努力或尝试？即使很微小，也请写下来。",placeholder:"写下你做过的努力或尝试...(300字内)"},{title:"第三站：勇气森林",desc:"根据你刚刚发现的努力或资源，请设定一个你愿意尝试的小行动，并写下你预期会遇到的困难，以及你打算怎么面对。",placeholder:"写下你的小行动与预期困难...(300字内)"},{title:"第四站：智慧溪流",desc:"回顾你刚刚的行动经验，请反思：这个过程中，你学到了什么？有没有什么新的发现或领悟？",placeholder:"写下你的学习与领悟...(300字内)"},{title:"第五站：重启之巅",desc:"综合前面所有关卡的经历，请写下你给未来自己的祝福或期许，并思考：如果未来再遇到困难，你会怎么鼓励自己？",placeholder:"写下给自己的祝福或期许...(300字内)"}],submit:"提交，寻求指引",loading:"请稍候...",next:"前往下一站",finish:"恭喜你完成重启之路！",finishSub:"未来也请继续善待自己！",error:"发生错误，请稍后再试。",retry:"再来一次"},en:{back:"Back to Home",logout:"Logout",title:"Restart Journey",subtitle:"Step by step out of the mist, see a new self",steps:[{title:"Step 1: Misty Valley",desc:"Write about a recent event that made you feel strong emotions. No need to judge yourself, just describe what happened, how you felt, and how it affected you.",placeholder:"Write your story here...(300 words max)"},{title:"Step 2: Hill of Hope",desc:"Review the event you just wrote. Did you make any small effort or try anything in that situation? Even if it was minor, write it down.",placeholder:"Write your effort or attempt...(300 words max)"},{title:"Step 3: Forest of Courage",desc:"Based on your discovered effort or resources, set a small action you are willing to try, and write down the difficulties you expect and how you plan to face them.",placeholder:"Write your action and expected difficulties...(300 words max)"},{title:"Step 4: Stream of Wisdom",desc:"Reflect on your action experience. What did you learn? Any new discoveries or insights?",placeholder:"Write your learning and insights...(300 words max)"},{title:"Step 5: Summit of Restart",desc:"Summarize all your experiences and write a blessing or expectation for your future self. If you face difficulties again, how will you encourage yourself?",placeholder:"Write your blessing or expectation...(300 words max)"}],submit:"Submit for Guidance",loading:"Please wait...",next:"Next Step",finish:"Congratulations on completing your restart journey!",finishSub:"Please continue to be kind to yourself in the future!",error:"An error occurred, please try again later.",retry:"Try Again"},ja:{back:"ホームに戻る",logout:"ログアウト",title:"日課ミッション挑戦",subtitle:"一歩ずつ霧を抜けて、新しい自分に出会おう",steps:[{title:"第1ステップ：霧の谷",desc:"最近あなたが強い感情を抱いた出来事について書いてください。自分を評価せず、出来事の経過や感情、その影響を素直に書きましょう。",placeholder:"ここにあなたのストーリーを書いてください...(300字以内)"},{title:"第2ステップ：希望の丘",desc:"先ほど書いた出来事を振り返り、その状況であなたが行った小さな努力や試みがあれば書いてください。些細なことでも構いません。",placeholder:"あなたの努力や試みを書いてください...(300字以内)"},{title:"第3ステップ：勇気の森",desc:"発見した努力やリソースをもとに、挑戦したい小さな行動と、予想される困難、それにどう向き合うかを書いてください。",placeholder:"行動と予想される困難を書いてください...(300字以内)"},{title:"第4ステップ：知恵の流れ",desc:"行動の経験を振り返り、学んだことや新たな気づきがあれば書いてください。",placeholder:"学びや気づきを書いてください...(300字以内)"},{title:"第5ステップ：再出発の頂",desc:"これまでの経験をまとめ、未来の自分へのメッセージや期待を書いてください。困難に直面したとき、どう自分を励ますかも考えてみましょう。",placeholder:"未来の自分へのメッセージや期待を書いてください...(300字以内)"}],submit:"提出して指導を求める",loading:"お待ちください...",next:"次のステップへ",finish:"再出発の道を完了しました！",finishSub:"これからも自分を大切にしてください！",error:"エラーが発生しました。しばらくしてから再度お試しください。",retry:"もう一度"},ko:{back:"홈으로",logout:"로그아웃",title:"일일 미션 도전",subtitle:"한 걸음씩 안개를 걷고, 새로운 나를 만나보세요",steps:[{title:"1단계: 안개의 계곡",desc:"최근에 강한 감정을 느꼈던 일을 적어보세요. 자신을 평가하지 말고, 그 일의 과정과 감정, 그리고 그 감정이 가져온 영향을 솔직하게 적어보세요.",placeholder:"여기에 당신의 이야기를 적어주세요...(300자 이내)"},{title:"2단계: 희망의 언덕",desc:"방금 적은 일을 돌아보며, 그 상황에서 했던 작은 노력이나 시도가 있다면 적어보세요. 아주 사소한 것도 괜찮아요.",placeholder:"노력이나 시도를 적어주세요...(300자 이내)"},{title:"3단계: 용기의 숲",desc:"발견한 노력이나 자원을 바탕으로, 시도해보고 싶은 작은 행동과 예상되는 어려움, 그리고 어떻게 대처할지 적어보세요.",placeholder:"행동과 예상되는 어려움을 적어주세요...(300자 이내)"},{title:"4단계: 지혜의 시냇물",desc:"행동 경험을 돌아보며, 배운 점이나 새로운 깨달음이 있다면 적어보세요.",placeholder:"배운 점이나 깨달음을 적어주세요...(300자 이내)"},{title:"5단계: 재시작의 정상",desc:"지금까지의 경험을 종합해 미래의 나에게 전하고 싶은 메시지나 기대를 적어보세요. 앞으로 어려움이 닥칠 때 어떻게 자신을 격려할지도 생각해보세요.",placeholder:"미래의 나에게 전하고 싶은 메시지나 기대를 적어주세요...(300자 이내)"}],submit:"제출하고 안내받기",loading:"잠시만 기다려주세요...",next:"다음 단계로",finish:"재시작의 여정을 완료했습니다!",finishSub:"앞으로도 자신을 소중히 하세요!",error:"오류가 발생했습니다. 잠시 후 다시 시도해주세요.",retry:"다시 시도"},th:{back:"กลับหน้าหลัก",logout:"ออกจากระบบ",title:"ภารกิจประจำวัน",subtitle:"ก้าวออกจากหมอกทีละก้าว พบกับตัวเองในมุมใหม่",steps:[{title:"ขั้นที่ 1: หุบเขาหมอก",desc:"เขียนเกี่ยวกับเหตุการณ์ล่าสุดที่ทำให้คุณรู้สึกอารมณ์รุนแรง ไม่ต้องตัดสินตัวเอง เพียงบรรยายเหตุการณ์ ความรู้สึก และผลกระทบที่เกิดขึ้น",placeholder:"เขียนเรื่องราวของคุณที่นี่...(300 คำ)"},{title:"ขั้นที่ 2: เนินแห่งความหวัง",desc:"ทบทวนเหตุการณ์ที่เพิ่งเขียนไป มีความพยายามหรือการลองทำอะไรเล็กๆ ในสถานการณ์นั้นหรือไม่ แม้จะเล็กน้อยก็เขียนได้",placeholder:"เขียนความพยายามหรือสิ่งที่ลองทำ...(300 คำ)"},{title:"ขั้นที่ 3: ป่าแห่งความกล้าหาญ",desc:"จากความพยายามหรือทรัพยากรที่ค้นพบ กำหนดการกระทำเล็กๆ ที่อยากลอง พร้อมทั้งอุปสรรคที่คาดว่าจะเจอและวิธีรับมือ",placeholder:"เขียนการกระทำและอุปสรรคที่คาดไว้...(300 คำ)"},{title:"ขั้นที่ 4: ลำธารแห่งปัญญา",desc:"ทบทวนประสบการณ์การกระทำของคุณ มีอะไรที่ได้เรียนรู้หรือค้นพบใหม่ๆ หรือไม่",placeholder:"เขียนสิ่งที่ได้เรียนรู้หรือค้นพบ...(300 คำ)"},{title:"ขั้นที่ 5: ยอดเขาแห่งการเริ่มต้นใหม่",desc:"สรุปประสบการณ์ทั้งหมด เขียนคำอวยพรหรือความคาดหวังถึงตัวเองในอนาคต หากเจออุปสรรคอีกจะให้กำลังใจตัวเองอย่างไร",placeholder:"เขียนคำอวยพรหรือความคาดหวัง...(300 คำ)"}],submit:"ส่งและขอคำแนะนำ",loading:"กรุณารอสักครู่...",next:"ไปยังขั้นถัดไป",finish:"คุณสำเร็จภารกิจเริ่มต้นใหม่แล้ว!",finishSub:"ขอให้ดูแลตัวเองต่อไป!",error:"เกิดข้อผิดพลาด กรุณาลองใหม่อีกครั้งภายหลัง",retry:"ลองอีกครั้ง"},vi:{back:"Về trang chủ",logout:"Đăng xuất",title:"Thử thách nhiệm vụ hàng ngày",subtitle:"Từng bước vượt qua sương mù, khám phá bản thân mới",steps:[{title:"Bước 1: Thung lũng sương mù",desc:"Viết về một sự kiện gần đây khiến bạn cảm xúc mạnh. Không cần phán xét bản thân, chỉ cần mô tả diễn biến, cảm xúc và ảnh hưởng của nó.",placeholder:"Viết câu chuyện của bạn tại đây...(300 từ)"},{title:"Bước 2: Đồi hy vọng",desc:"Xem lại sự kiện vừa viết, bạn có nỗ lực hoặc thử điều gì nhỏ không? Dù nhỏ cũng hãy ghi lại.",placeholder:"Viết nỗ lực hoặc điều bạn đã thử...(300 từ)"},{title:"Bước 3: Rừng dũng cảm",desc:"Dựa trên nỗ lực hoặc nguồn lực vừa phát hiện, hãy đặt ra một hành động nhỏ muốn thử, dự đoán khó khăn và cách đối mặt.",placeholder:"Viết hành động và khó khăn dự đoán...(300 từ)"},{title:"Bước 4: Suối trí tuệ",desc:"Xem lại trải nghiệm hành động, bạn học được gì? Có phát hiện hay nhận thức mới không?",placeholder:"Viết điều bạn học được hoặc nhận ra...(300 từ)"},{title:"Bước 5: Đỉnh tái khởi động",desc:"Tổng hợp mọi trải nghiệm, viết lời chúc hoặc kỳ vọng cho bản thân tương lai. Nếu gặp khó khăn, bạn sẽ động viên mình thế nào?",placeholder:"Viết lời chúc hoặc kỳ vọng...(300 từ)"}],submit:"Gửi và nhận hướng dẫn",loading:"Vui lòng chờ...",next:"Bước tiếp theo",finish:"Chúc mừng bạn đã hoàn thành hành trình tái khởi động!",finishSub:"Hãy tiếp tục yêu thương bản thân nhé!",error:"Đã xảy ra lỗi, vui lòng thử lại sau.",retry:"Thử lại"},la:{back:"Redi ad domum",logout:"Exire",title:"Provocatio Cotidiana",subtitle:"Gradatim e nebula progredere, novum te aspice",steps:[{title:"Gradus I: Vallis Nebulosa",desc:"Scribe de re nuper te vehementer commotum. Te ipsum iudicare noli, sed simpliciter rem, sensus tuos, et effectus describas.",placeholder:"Hic fabulam tuam scribe...(300 verba)"},{title:"Gradus II: Collis Spei",desc:"Recense rem modo scriptam. In illa condicione quid parvum conatus es? Etiam minima, scribe.",placeholder:"Conatum tuum scribe...(300 verba)"},{title:"Gradus III: Silva Virtutis",desc:"Ex conatu aut opibus inventis, parvam actionem temptare velis, difficultates praevides et quomodo eas superaturus sis scribe.",placeholder:"Actionem et difficultates scribe...(300 verba)"},{title:"Gradus IV: Rivus Sapientiae",desc:"Recense experientiam actionis. Quid didicisti? Quid novi invenisti?",placeholder:"Quae didicisti scribe...(300 verba)"},{title:"Gradus V: Culmen Renovationis",desc:"Omnia experientia colligens, votum aut spem tibi futuro scribe. Si iterum difficultates occurrant, quomodo te hortaberis?",placeholder:"Votum aut spem scribe...(300 verba)"}],submit:"Mitte et consilium pete",loading:"Exspecta quaeso...",next:"Ad gradum proximum",finish:"Iter renovationis confecisti!",finishSub:"Te ipsum semper cura!",error:"Error factus est, quaeso postea repete.",retry:"Iterum conare"},ms:{back:"Kembali ke Laman Utama",logout:"Log keluar",title:"Cabaran Misi Harian",subtitle:"Melangkah keluar dari kabus, temui diri baharu",steps:[{title:"Langkah 1: Lembah Berkabus",desc:"Tulis tentang peristiwa baru-baru ini yang membuatkan anda beremosi kuat. Tidak perlu menilai diri, hanya gambarkan peristiwa, perasaan dan kesannya.",placeholder:"Tulis kisah anda di sini...(300 patah perkataan)"},{title:"Langkah 2: Bukit Harapan",desc:"Imbas kembali peristiwa tadi, adakah anda berusaha atau mencuba sesuatu walaupun kecil? Catatkan walaupun kecil.",placeholder:"Tulis usaha atau percubaan anda...(300 patah perkataan)"},{title:"Langkah 3: Hutan Keberanian",desc:"Berdasarkan usaha atau sumber yang ditemui, tetapkan tindakan kecil yang ingin dicuba, jangka cabaran dan cara menghadapinya.",placeholder:"Tulis tindakan dan cabaran dijangka...(300 patah perkataan)"},{title:"Langkah 4: Sungai Kebijaksanaan",desc:"Imbas kembali pengalaman tindakan anda, apa yang anda pelajari? Ada penemuan atau kesedaran baharu?",placeholder:"Tulis apa yang anda pelajari...(300 patah perkataan)"},{title:"Langkah 5: Puncak Permulaan Semula",desc:"Gabungkan semua pengalaman, tulis harapan atau ucapan untuk diri masa depan. Jika hadapi cabaran lagi, bagaimana anda akan beri semangat pada diri?",placeholder:"Tulis harapan atau ucapan...(300 patah perkataan)"}],submit:"Hantar & mohon panduan",loading:"Sila tunggu...",next:"Langkah seterusnya",finish:"Tahniah, anda telah tamat perjalanan permulaan semula!",finishSub:"Teruskan sayangi diri anda!",error:"Ralat berlaku, sila cuba lagi kemudian.",retry:"Cuba lagi"}};function my(){var P,B,k,T;const n=$e(),e=Je(),{lang:t}=Qe(),i=py["zh-TW"],s=py[t]||i,o={...i,...s,steps:s.steps||i.steps,submit:s.submit||i.submit,loading:s.loading||i.loading,next:s.next||i.next,finish:s.finish||i.finish,finishSub:s.finishSub||i.finishSub,error:s.error||i.error,retry:s.retry||i.retry},[a,l]=g.useState(0),[c,u]=g.useState(""),[h,p]=g.useState([]),[f,b]=g.useState(""),[x,S]=g.useState(!1),[w,I]=g.useState(!1),j=(P=o.steps)==null?void 0:P[a];g.useEffect(()=>{var R;if(f&&a===(((R=o.steps)==null?void 0:R.length)||0)-1){I(!0);const E=setTimeout(()=>I(!1),3e3);return()=>clearTimeout(E)}},[f,a]);const A=async R=>{R.preventDefault(),S(!0),b("");try{console.log("Sending request to /api/mission-ai with:",{step:a,input:c,history:h});const E=await fetch("/api/mission-ai",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({step:a,input:c,history:h})});if(console.log("Response status:",E.status),!E.ok)throw new Error(`HTTP error! status: ${E.status}`);const _=await E.json();console.log("Response data:",_),b(_.reply||"AI教練祝福你！"),p(v=>[...v,c])}catch(E){console.error("Error in handleSubmit:",E),b("發生錯誤，請稍後再試。錯誤詳情："+(E instanceof Error?E.message:"未知錯誤"))}finally{S(!1)}},D=()=>{u(""),b(""),l(a+1)},O=()=>r.jsxs("div",{style:{position:"fixed",left:0,top:0,width:"100vw",height:"100vh",pointerEvents:"none",zIndex:9999,display:"flex",justifyContent:"center",alignItems:"center"},children:[r.jsx("iframe",{src:"https://embed.lottiefiles.com/animation/85716",style:{width:400,height:400,border:"none",background:"transparent"},title:"fireworks1"}),r.jsx("iframe",{src:"https://embed.lottiefiles.com/animation/85716",style:{width:400,height:400,border:"none",background:"transparent",position:"absolute",left:"20vw",top:"10vh"},title:"fireworks2"}),r.jsx("iframe",{src:"https://embed.lottiefiles.com/animation/85716",style:{width:400,height:400,border:"none",background:"transparent",position:"absolute",right:"20vw",top:"20vh"},title:"fireworks3"})]});return r.jsxs("div",{style:{minHeight:"100vh",width:"100vw",position:"relative",overflowX:"hidden",background:"url('/mountain.png') center center / cover no-repeat fixed, linear-gradient(to bottom, #eaf6ff 0%, #f7fafc 100%)"},children:[window.innerWidth<=768?r.jsxs("div",{style:{position:"absolute",top:"20px",left:"20px",right:"20px",zIndex:1e3,display:"flex",alignItems:"center",justifyContent:"space-between",background:"rgba(255,255,255,0.95)",borderRadius:16,padding:"12px 16px",boxShadow:"0 4px 20px rgba(0,0,0,0.1)"},children:[r.jsx("button",{onClick:()=>n("/"),style:{fontWeight:700,fontSize:16,padding:"8px 16px",borderRadius:8,border:"1.5px solid #6B5BFF",background:"#fff",color:"#6B5BFF",cursor:"pointer",minWidth:80,boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:o.back}),r.jsxs("h1",{style:{fontWeight:900,fontSize:18,color:"#6B5BFF",margin:0,lineHeight:1,textShadow:"0 2px 8px #6B5BFF88",textAlign:"center",flex:1},children:[r.jsx("span",{role:"img","aria-label":"mission",children:"🎯"})," 挑戰任務"]}),r.jsx("button",{onClick:async()=>{await hn(e),localStorage.clear(),window.location.href="/"},style:{fontWeight:700,fontSize:16,padding:"8px 16px",borderRadius:8,border:"1.5px solid #6B5BFF",background:"#fff",color:"#6B5BFF",cursor:"pointer",minWidth:80,boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:o.logout})]}):r.jsxs(r.Fragment,{children:[r.jsx("button",{onClick:()=>n("/"),style:{position:"absolute",top:"20px",left:"20px",zIndex:1e3,fontWeight:700,fontSize:16,padding:"8px 16px",borderRadius:8,border:"1.5px solid #6B5BFF",background:"#fff",color:"#6B5BFF",cursor:"pointer",minWidth:80,boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:o.back}),r.jsxs("div",{style:{position:"absolute",top:"20px",right:"20px",zIndex:1e3,display:"flex",alignItems:"center",gap:12},children:[r.jsx("button",{onClick:async()=>{await hn(e),localStorage.clear(),window.location.href="/"},style:{fontWeight:700,fontSize:16,padding:"8px 16px",borderRadius:8,border:"1.5px solid #6B5BFF",background:"#fff",color:"#6B5BFF",cursor:"pointer",minWidth:80,boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:o.logout}),r.jsx("div",{style:{width:"80px"},children:r.jsx(en,{style:{width:"100%",fontSize:"16px",padding:"8px 16px",minWidth:"80px"}})})]})]}),window.innerWidth>768&&r.jsx("div",{style:{width:"100%",maxWidth:700,margin:"20px auto 20px auto",padding:"16px 24px",background:"rgba(255,255,255,0.95)",borderRadius:16,boxShadow:"0 4px 20px rgba(0,0,0,0.1)",display:"flex",alignItems:"center",justifyContent:"center",position:"relative"},children:r.jsxs("h1",{style:{fontWeight:900,fontSize:18,color:"#6B5BFF",margin:0,lineHeight:1,textShadow:"0 2px 8px #6B5BFF88",textAlign:"center"},children:[r.jsx("span",{role:"img","aria-label":"mission",children:"🎯"})," 挑戰任務"]})}),r.jsxs("div",{style:{maxWidth:600,margin:"0 auto",padding:window.innerWidth<=768?"1rem 0 2rem 0":"2rem 0 2rem 0",background:"rgba(255,255,255,0.92)",borderRadius:24,boxShadow:"0 8px 32px rgba(0,0,0,0.08)",marginTop:window.innerWidth<=768?"120px":"0"},children:[r.jsx("h1",{style:{textAlign:"center",fontWeight:700,fontSize:"2rem",marginBottom:8},children:o.title}),r.jsx("div",{style:{textAlign:"center",color:"#666",marginBottom:32},children:o.subtitle}),r.jsxs("div",{style:{background:"#fff",borderRadius:16,padding:32,boxShadow:"0 2px 8px #0001",marginBottom:24},children:[r.jsx("div",{style:{fontWeight:700,fontSize:"1.3rem",color:"#2a5d8f",marginBottom:8},children:(j==null?void 0:j.title)||""}),r.jsx("div",{style:{color:"#333",marginBottom:24},children:(j==null?void 0:j.desc)||""}),r.jsxs("form",{onSubmit:A,children:[r.jsx("textarea",{value:c,onChange:R=>u(R.target.value),placeholder:(j==null?void 0:j.placeholder)||"",style:{width:"100%",minHeight:100,borderRadius:8,border:"1px solid #ccc",padding:12,marginBottom:16},required:!0}),r.jsx("button",{type:"submit",disabled:x||!c,style:{width:"100%",background:"#6B5BFF",color:"#fff",fontWeight:700,fontSize:18,border:"none",borderRadius:8,padding:"12px 0",cursor:x?"not-allowed":"pointer",opacity:x?.99:1,filter:"none",textShadow:"none",transition:"background 0.18s"},children:x?o.loading:o.submit})]}),f&&r.jsx("div",{style:{marginTop:24,background:"#f5f5f5",borderRadius:8,padding:16,color:"#2a5d8f"},children:f}),f&&a<(((B=o.steps)==null?void 0:B.length)||0)-1&&r.jsx("button",{onClick:D,style:{marginTop:16,width:"100%",background:"#6B5BFF",color:"#fff",fontWeight:700,fontSize:16,border:"none",borderRadius:8,padding:"10px 0",cursor:"pointer",transition:"background 0.18s"},children:o.next}),f&&a===(((k=o.steps)==null?void 0:k.length)||0)-1&&r.jsxs("div",{style:{marginTop:24,textAlign:"center",color:"#e6b800",fontWeight:700,fontSize:20},children:[o.finish,r.jsx("br",{}),r.jsx("span",{style:{fontSize:16,color:"#888"},children:o.finishSub}),w&&r.jsx(O,{}),r.jsx("div",{style:{marginTop:24},children:r.jsx("button",{onClick:()=>{l(0),u(""),p([]),b("")},style:{background:"#6B5BFF",color:"#fff",fontWeight:700,fontSize:16,border:"none",borderRadius:8,padding:"10px 32px",cursor:"pointer",marginTop:8,boxShadow:"0 2px 8px #0001",transition:"background 0.18s"},children:o.retry})})]})]}),r.jsx("div",{style:{textAlign:"center",color:"#aaa",fontSize:14},children:(o.steps||[]).map((R,E)=>r.jsx("span",{style:{display:"inline-block",width:18,height:18,borderRadius:"50%",background:E<=a?"#8ec6f7":"#e0e0e0",margin:"0 4px",border:E===a?"2px solid #2a5d8f":"none",transition:"all 0.2s"}},E))})]}),r.jsx("div",{style:{width:"100%",margin:"0 auto",marginTop:24,background:"rgba(255,255,255,0.95)",borderRadius:16,padding:"16px",boxShadow:"0 2px 12px #6B5BFF22"},children:r.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:20,flexWrap:"wrap"},children:[r.jsx("span",{onClick:()=>n("/about"),style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12,cursor:"pointer"},children:t==="zh-TW"?"🧬 Restarter™｜我們是誰":t==="zh-CN"?"🧬 Restarter™｜我们是谁":t==="en"?"🧬 Restarter™｜Who We Are":t==="ja"?"🧬 Restarter™｜私たちについて":t==="ko"?"🧬 Restarter™｜우리는 누구인가":t==="th"?"🧬 Restarter™｜เราเป็นใคร":t==="vi"?"🧬 Restarter™｜Chúng tôi là ai":t==="ms"?"🧬 Restarter™｜Siapa Kami":"🧬 Restarter™｜Quis sumus"}),r.jsx("span",{onClick:()=>n("/privacy-policy"),style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12,cursor:"pointer"},children:t==="zh-TW"?"隱私權政策":t==="zh-CN"?"隐私政策":t==="en"?"Privacy Policy":t==="ja"?"プライバシーポリシー":t==="ko"?"개인정보 처리방침":t==="th"?"นโยบายความเป็นส่วนตัว":t==="vi"?"Chính sách bảo mật":t==="ms"?"Dasar Privasi":"Consilium de Privata"}),r.jsx("span",{onClick:()=>n("/terms"),style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12,cursor:"pointer"},children:t==="zh-TW"?"條款/聲明":t==="zh-CN"?"条款/声明":t==="en"?"Terms/Statement":t==="ja"?"規約/声明":t==="ko"?"약관/성명":t==="th"?"ข้อกำหนด/แถลงการณ์":t==="vi"?"Điều khoản/Tuyên bố":t==="ms"?"Terma/Pernyataan":"Termini/Declaratio"}),r.jsx("span",{onClick:()=>n("/data-deletion"),style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12,cursor:"pointer"},children:t==="zh-TW"?"資料刪除說明":t==="zh-CN"?"数据删除说明":t==="en"?"Data Deletion":t==="ja"?"データ削除について":t==="ko"?"데이터 삭제 안내":t==="th"?"คำอธิบายการลบข้อมูล":t==="vi"?"Giải thích xóa dữ liệu":t==="ms"?"Penjelasan Penghapusan Data":"Explicatio Deletionis Datae"}),r.jsx("span",{onClick:()=>n("/feedback"),style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12,cursor:"pointer"},children:t==="zh-TW"?"💬 意見箱｜我們想聽你說":t==="zh-CN"?"💬 意见箱｜我们想听你说":t==="en"?"💬 Feedback Box｜We Want to Hear From You":t==="ja"?"💬 ご意見箱｜私たちはあなたの声を聞きたい":t==="ko"?"💬 피드백｜우리는 당신의 말을 듣고 싶습니다":t==="th"?"💬 กล่องความคิดเห็น｜เราอยากได้ยินจากคุณ":t==="vi"?"💬 Hộp góp ý｜Chúng tôi muốn nghe từ bạn":t==="ms"?"💬 Kotak Maklum Balas｜Kami Ingin Mendengar Dari Anda":"💬 Arca Consilii｜Volumus Audire a Te"})]})}),f&&a===(((T=o.steps)==null?void 0:T.length)||0)-1&&w&&r.jsx(O,{})]})}const TB={encouragement:"/videos/encouragement.mp4",reproach:"/videos/reproach.mp4",motivation:"/videos/motivation.mp4",disappointment:"/videos/disappointment.mp4",joy:"/videos/joy.mp4",lost:"/videos/lost.mp4",breakthrough:"/videos/breakthrough.mp4",clarity:"/videos/clarity.mp4",reluctance:"/videos/reluctance.mp4",confusion:"/videos/confusion.mp4",affection:"/videos/affection.mp4",regret:"/videos/regret.mp4",admiration:"/videos/admiration.mp4",teasing:"/videos/teasing.mp4"};function jB({reactionType:n,onEnd:e,style:t,className:i="",autoPlay:s=!0,...o}){const a=g.useRef(null);return g.useEffect(()=>{s&&a.current&&(a.current.currentTime=0,a.current.play())},[n,s]),r.jsx("div",{className:`video-reaction-player ${i}`,style:{position:"fixed",left:0,top:0,width:"100vw",height:"100vh",zIndex:3e3,background:"rgba(0,0,0,0.32)",display:"flex",alignItems:"center",justifyContent:"center",...t},...o,children:r.jsx("video",{ref:a,src:TB[n],style:{maxWidth:"90vw",maxHeight:"80vh",borderRadius:18,boxShadow:"0 8px 32px #0008",background:"#000"},autoPlay:s,onEnded:e,controls:!1,playsInline:!0})})}const rk=g.createContext({setVideoReaction:()=>{}});function _B(){return g.useContext(rk)}function IB({children:n}){const[e,t]=g.useState(null);return r.jsxs(rk.Provider,{value:{setVideoReaction:t},children:[n,e&&r.jsx(jB,{reactionType:e,onEnd:()=>t(null)})]})}const yt={backToHome:{"zh-TW":"← 返回首頁","zh-CN":"← 返回首页",ja:"← ホームへ戻る",en:"← Home",ko:"← 홈으로 돌아가기",th:"← กลับหน้าหลัก",vi:"← Về trang chủ",ms:"← Kembali ke Laman Utama",la:"← Ad domum redire"},back:{"zh-TW":"↩ 返回上一頁","zh-CN":"↩ 返回上一页",ja:"↩ 前のページへ",en:"↩ Back",ko:"↩ 이전 페이지로",th:"↩ กลับไป",vi:"↩ Quay lại",ms:"↩ Kembali",la:"↩ Redire"},logout:{"zh-TW":"登出","zh-CN":"登出",ja:"ログアウト",en:"Logout",ko:"로그아웃",th:"ออกจากระบบ",vi:"Đăng xuất",ms:"Log keluar",la:"Exire"},pageTitle:{"zh-TW":"配對對聊 PairTalk","zh-CN":"配对对聊 PairTalk",ja:"ペアトーク PairTalk",en:"PairTalk",ko:"페어톡",th:"คู่คุย",vi:"Trò chuyện đôi",ms:"PairTalk",la:"PairTalk"},subtitle:{"zh-TW":"劫後餘生的交友最珍貴，沒人怕跨出第一步！","zh-CN":"劫后余生的交友最珍贵，没人怕跨出第一步！",en:"Friendship after hardship is the most precious, no one is afraid to take the first step!",ja:"困難を乗り越えた後の友情こそが最も貴重、一歩踏み出すのは誰も怖くない！",ko:"역경 후의 우정이 가장 소중하며, 첫 걸음을 내딛는 것을 두려워하는 사람은 아무도 없습니다!",th:"มิตรภาพหลังความยากลำบากนั้นมีค่าที่สุด ไม่มีใครกลัวที่จะก้าวแรก!",vi:"Tình bạn sau gian khó là quý giá nhất, không ai ngại bước bước đầu tiên!",ms:"Persahabatan selepas kesusahan adalah yang paling berharga, tiada siapa yang takut untuk mengambil langkah pertama!",la:"Amicitia post aerumnas pretiosissima est, nemo primum gradum timere metuit!"},matchStatus:{"zh-TW":"配對狀態","zh-CN":"配对状态",ja:"マッチ状況",en:"Match Status",ko:"매칭 상태",th:"สถานะการจับคู่",vi:"Tình trạng ghép đôi",ms:"Status Padanan",la:"Status Par"},empty:{"zh-TW":"目前沒有配對，等待系統為你尋找夥伴...","zh-CN":"目前没有配对，等待系统为你寻找伙伴...",en:"No matches yet. Waiting for a companion...",ja:"まだマッチがありません。相手を探しています...",ko:"아직 매칭이 없습니다. 상대를 기다리는 중...",th:"ยังไม่มีคู่ รอระบบหาคู่ให้อยู่...",vi:"Chưa có ai được ghép đôi. Đang chờ hệ thống tìm bạn đồng hành...",ms:"Tiada padanan lagi. Menunggu teman...",la:"Nulli pares adhuc. Socium exspectans..."},todayMatch:{"zh-TW":"今日配對：","zh-CN":"今日配对：",ja:"今日のマッチ：",en:"Today's Match:",ko:"오늘의 매칭:",th:"คู่ของวันนี้:",vi:"Ghép đôi hôm nay:",ms:"Padanan Hari Ini:",la:"Par Hodiernus:"},timeLeft:{"zh-TW":"剩餘時間：","zh-CN":"剩余时间：",ja:"残り時間：",en:"Time Left:",ko:"남은 시간:",th:"เวลาที่เหลือ:",vi:"Thời gian còn lại:",ms:"Masa Tinggal:",la:"Tempus Reliquum:"},archive:{"zh-TW":"封存對話","zh-CN":"封存对话",ja:"アーカイブ",en:"Archive",ko:"보관",th:"เก็บถาวร",vi:"Lưu trữ",ms:"Arkib",la:"Archivum"},rematch:{"zh-TW":"重配","zh-CN":"重配",ja:"再マッチ",en:"Rematch",ko:"재매칭",th:"จับคู่ใหม่",vi:"Ghép lại",ms:"Padan semula",la:"Repar"},history:{"zh-TW":"歷史配對","zh-CN":"历史配对",ja:"履歴",en:"History",ko:"기록",th:"ประวัติ",vi:"Lịch sử",ms:"Sejarah",la:"Historia"},viewDetails:{"zh-TW":"查看完整資料","zh-CN":"查看完整资料",ja:"詳細を見る",en:"View Details",ko:"상세 정보 보기",th:"ดูรายละเอียด",vi:"Xem chi tiết",ms:"Lihat Butiran",la:"Singula Videre"},hideDetails:{"zh-TW":"收合資料","zh-CN":"收起资料",ja:"閉じる",en:"Hide",ko:"숨기기",th:"ซ่อน",vi:"Ẩn",ms:"Sembunyi",la:"Celare"},nickname:{"zh-TW":"暱稱","zh-CN":"昵称",ja:"ニックネーム",en:"Nickname",ko:"닉네임",th:"ชื่อเล่น",vi:"Biệt danh",ms:"Nama Samaran",la:"Agnomen"},country:{"zh-TW":"國家","zh-CN":"国家",ja:"国",en:"Country",ko:"국가",th:"ประเทศ",vi:"Quốc gia",ms:"Negara",la:"Natio"},age:{"zh-TW":"年齡","zh-CN":"年龄",ja:"年齢",en:"Age",ko:"나이",th:"อายุ",vi:"Tuổi",ms:"Umur",la:"Aetas"},gender:{"zh-TW":"性別","zh-CN":"性别",ja:"性別",en:"Gender",ko:"성별",th:"เพศ",vi:"Giới tính",ms:"Jantina",la:"Genus"},interest:{"zh-TW":"興趣","zh-CN":"兴趣",ja:"趣味",en:"Interest",ko:"관심사",th:"ความสนใจ",vi:"Sở thích",ms:"Minat",la:"Studium"},eventType:{"zh-TW":"事件類型","zh-CN":"事件类型",ja:"イベントタイプ",en:"Event Type",ko:"이벤트 유형",th:"ประเภทเหตุการณ์",vi:"Loại sự kiện",ms:"Jenis Acara",la:"Genus Eventus"},bio:{"zh-TW":"簡介","zh-CN":"简介",ja:"自己紹介",en:"Bio",ko:"소개",th:"ประวัติ",vi:"Tiểu sử",ms:"Bio",la:"Bio"},sendGift:{"zh-TW":"送出禮物","zh-CN":"送出礼物",ja:"ギフトを送る",en:"Send Gift",ko:"선물 보내기",th:"ส่งของขวัญ",vi:"Gửi quà",ms:"Hantar Hadiah",la:"Donum Mittere"},sendEmail:{"zh-TW":"發送Email","zh-CN":"发送Email",ja:"メール送信",en:"Send Email",ko:"이메일 보내기",th:"ส่งอีเมล",vi:"Gửi Email",ms:"Hantar E-mel",la:"Epistulam Mittere"},next:{"zh-TW":"下一頁","zh-CN":"下一页",ja:"次へ",en:"Next",ko:"다음",th:"ถัดไป",vi:"Tiếp",ms:"Seterusnya",la:"Proximus"},lastPage:{"zh-TW":"最後一頁","zh-CN":"最后一页",ja:"最後のページ",en:"Last page",ko:"마지막 페이지",th:"หน้าสุดท้าย",vi:"Trang cuối",ms:"Halaman terakhir",la:"Pagina Ultima"}},CB=[{id:1,partner:"小明",status:"active",aiGuide:"你可以問對方：今天過得如何？"},{id:2,partner:"Sandy",status:"archived",aiGuide:"你可以問對方：最近有什麼開心的事？"}],Jd=[{id:1,nickname:"Alice",country:"台灣",age:28,gender:"female",email:"alice@example.com",bio:"喜歡閱讀與旅行",interest:"閱讀",eventType:"經濟",avatar:"/avatars/female1.jpg"},{id:2,nickname:"Bob",country:"日本",age:32,gender:"male",email:"bob@example.com",bio:"音樂愛好者",interest:"音樂",eventType:"科技",avatar:"/avatars/male1.jpg"}],gy={"zh-TW":{male:"男性",female:"女性",other:"其他"},"zh-CN":{male:"男性",female:"女性",other:"其他"},en:{male:"Male",female:"Female",other:"Other"},ja:{male:"男性",female:"女性",other:"その他"},ko:{male:"남성",female:"여성",other:"기타"},th:{male:"ชาย",female:"หญิง",other:"อื่นๆ"},vi:{male:"Nam",female:"Nữ",other:"Khác"},ms:{male:"Lelaki",female:"Perempuan",other:"Lain-lain"},la:{male:"Mas",female:"Femina",other:"Aliud"}},fy=[{value:"🌹",label:"🌹"},{value:"💍",label:"💍"},{value:"🍰",label:"🍰"},{value:"🎩",label:"🎩"},{value:"🌺",label:"🌺"},{value:"👗",label:"👗"},{value:"✒️",label:"✒️"},{value:"🏎️",label:"🏎️"}],RB={"zh-TW":"歲","zh-CN":"岁",en:"yrs",ja:"歳",ko:"세",th:"ปี",vi:"tuổi",ms:"tahun",la:"anni"};function AB(){var T,R,E,_;const n=$e(),e=Je(),t=((T=e.currentUser)==null?void 0:T.email)||"",i=Qe(),[s,o]=g.useState(JSON.parse(localStorage.getItem("pairs")||"[]")||CB),[a,l]=g.useState(300),[c,u]=g.useState(((R=s.find(v=>v.status==="active"))==null?void 0:R.id)||null),[h,p]=g.useState("AI：記得保持友善，互相傾聽！"),[f,b]=g.useState(0),x=Jd[f],[S,w]=g.useState(!1),[I,j]=g.useState(fy[0].value),{setVideoReaction:A}=_B();Kt.useEffect(()=>{if(c){const v=setInterval(()=>l(z=>z>0?z-1:0),1e3);return()=>clearInterval(v)}},[c]);const D=v=>{o(s.map(z=>z.id===v?{...z,status:"archived"}:z)),localStorage.setItem("pairs",JSON.stringify(s.map(z=>z.id===v?{...z,status:"archived"}:z))),A("disappointment")},O=()=>{A("breakthrough")},P=()=>{alert(`${I} 已送出給 ${x.nickname}！`)},B=()=>{window.location.href=`mailto:${x.email}?subject=PairTalk&body=Hi${t?`&from=${t}`:""}`},k=()=>{if(Jd.length<=1||f===Jd.length-1){alert(yt.lastPage[i]);return}w(!1),b(v=>v+1)};return r.jsxs("div",{className:"modern-bg",style:{background:"url('/valley.png') center center / cover no-repeat",minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center"},children:[r.jsxs("div",{style:{position:"absolute",top:0,left:0,zIndex:100,display:"flex",alignItems:"center",padding:"18px 32px 0 32px",background:"transparent"},children:[r.jsx("button",{className:"topbar-btn",onClick:()=>n("/"),style:{fontWeight:700,fontSize:18,padding:"6px 16px",borderRadius:8,border:"1.5px solid #6B5BFF",background:"#fff",color:"#6B5BFF",cursor:"pointer",transition:"background 0.18s, color 0.18s, border 0.18s",marginRight:8},onMouseOver:v=>{v.currentTarget.style.background="#6B5BFF",v.currentTarget.style.color="#fff"},onMouseOut:v=>{v.currentTarget.style.background="#fff",v.currentTarget.style.color="#6B5BFF"},children:yt.backToHome[i]}),window.location.pathname!=="/pairtalk"&&r.jsx("button",{className:"topbar-btn",onClick:()=>n(-1),style:{fontWeight:700,fontSize:18,padding:"6px 16px",borderRadius:8,border:"1.5px solid #6B5BFF",background:"#fff",color:"#6B5BFF",cursor:"pointer",transition:"background 0.18s, color 0.18s, border 0.18s",marginLeft:8},onMouseOver:v=>{v.currentTarget.style.background="#6B5BFF",v.currentTarget.style.color="#fff"},onMouseOut:v=>{v.currentTarget.style.background="#fff",v.currentTarget.style.color="#6B5BFF"},children:yt.back[i]})]}),r.jsxs("div",{style:{position:"absolute",top:0,right:0,zIndex:100,display:"flex",alignItems:"center",padding:"18px 32px 0 32px",background:"transparent",gap:12},children:[r.jsx("button",{className:"topbar-btn",onClick:async()=>{await hn(e),localStorage.clear(),window.location.href="/"},style:{fontWeight:700,fontSize:18,padding:"6px 16px",borderRadius:8,border:"1.5px solid #6B5BFF",background:"#fff",color:"#6B5BFF",cursor:"pointer",transition:"background 0.18s, color 0.18s, border 0.18s"},onMouseOver:v=>{v.currentTarget.style.background="#6B5BFF",v.currentTarget.style.color="#fff"},onMouseOut:v=>{v.currentTarget.style.background="#fff",v.currentTarget.style.color="#6B5BFF"},children:yt.logout[i]}),r.jsx(en,{})]}),r.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[r.jsxs("h2",{style:{fontSize:"2.2rem",fontWeight:900,color:"#6B5BFF",textShadow:"0 2px 12px #6B5BFF88, 0 4px 24px #0008",letterSpacing:1,background:"#fff",borderRadius:12,boxShadow:"0 2px 12px #6B5BFF22",padding:"12px 32px",margin:0,marginBottom:24,display:"flex",alignItems:"center",gap:12},children:["🤝 ",yt.pageTitle[i]]}),r.jsxs("div",{style:{maxWidth:540,width:"100%",background:"#fff",borderRadius:16,padding:32,boxShadow:"0 4px 24px #0002",display:"flex",flexDirection:"column",alignItems:"center"},children:[r.jsx("div",{style:{fontSize:22,color:"#6B5BFF",fontWeight:900,marginBottom:24,textAlign:"center",textShadow:"0 2px 12px #6B5BFF88, 0 4px 24px #0008"},children:yt.subtitle[i]}),r.jsx("h2",{style:{fontSize:28,fontWeight:900,marginBottom:18},children:yt.pageTitle[i]}),r.jsxs("div",{style:{marginTop:18},children:[r.jsx("b",{children:yt.matchStatus[i]}),r.jsx("div",{style:{marginTop:8},children:yt.empty[i]})]}),c?r.jsxs("div",{style:{marginBottom:16},children:[r.jsx("b",{children:yt.todayMatch[i]})," ",(E=s.find(v=>v.id===c))==null?void 0:E.partner,r.jsxs("div",{style:{marginTop:8,color:"#6B5BFF"},children:[yt.timeLeft[i],Math.floor(a/60),":",(a%60).toString().padStart(2,"0")]}),r.jsx("div",{style:{marginTop:8,color:"#23c6e6"},children:(_=s.find(v=>v.id===c))==null?void 0:_.aiGuide}),r.jsx("div",{style:{marginTop:8,color:"#614425"},children:h}),r.jsx("button",{onClick:()=>D(c),style:{marginTop:10,borderRadius:8,background:"#eee",color:"#6B5BFF",border:"none",fontWeight:700,padding:"6px 18px"},children:yt.archive[i]}),r.jsx("button",{onClick:O,style:{marginTop:10,marginLeft:10,borderRadius:8,background:"#6B5BFF",color:"#fff",border:"none",fontWeight:700,padding:"6px 18px"},children:yt.rematch[i]})]}):r.jsx("div",{style:{color:"#614425",fontSize:18,textAlign:"center",marginTop:40},children:yt.empty[i]}),r.jsxs("div",{style:{marginTop:18},children:[r.jsx("b",{children:yt.history[i]}),r.jsx("ul",{style:{marginTop:8,paddingLeft:0,listStyle:"none"},children:s.filter(v=>v.status==="archived").map((v,z)=>r.jsxs("li",{style:{background:"#f7f7ff",borderRadius:8,padding:10,marginBottom:8},children:[r.jsx("div",{style:{fontWeight:700},children:v.partner}),r.jsx("div",{style:{color:"#614425",marginTop:4},children:v.aiGuide})]},z))})]}),r.jsxs("div",{style:{width:"100%",maxWidth:420,margin:"0 auto",background:"#f7f7ff",borderRadius:16,padding:24,boxShadow:"0 2px 12px #6B5BFF11",marginBottom:24,textAlign:"center",position:"relative"},children:[r.jsx("img",{src:x.avatar,alt:"avatar",style:{width:72,height:72,borderRadius:"50%",objectFit:"cover",border:"2px solid #6B5BFF",background:"#eee",marginBottom:12}}),r.jsx("div",{style:{fontWeight:700,fontSize:20,color:"#6B5BFF",marginBottom:6},children:x.nickname}),r.jsxs("div",{style:{color:"#614425",fontSize:16,marginBottom:6},children:[x.country," / ",x.age,RB[i]," / ",gy[i][x.gender]]}),r.jsx("button",{onClick:()=>w(v=>!v),style:{margin:"8px 0",padding:"6px 18px",borderRadius:8,fontWeight:700,background:"#fff",color:"#6B5BFF",border:"2px solid #6B5BFF",cursor:"pointer",fontSize:15,transition:"background 0.18s, color 0.18s, box-shadow 0.18s"},onMouseOver:v=>{v.currentTarget.style.background="#6B5BFF",v.currentTarget.style.color="#fff",v.currentTarget.style.boxShadow="0 6px 32px #6B5BFF99"},onMouseOut:v=>{v.currentTarget.style.background="#fff",v.currentTarget.style.color="#6B5BFF",v.currentTarget.style.boxShadow="none"},children:S?yt.hideDetails[i]:yt.viewDetails[i]}),S&&r.jsxs("div",{style:{marginTop:8,color:"#232946",fontSize:15,background:"#fff",borderRadius:8,padding:12,boxShadow:"0 2px 8px #6B5BFF11",display:"flex",flexDirection:"column",alignItems:"center",gap:8},children:[r.jsx("img",{src:x.avatar,alt:"avatar",style:{width:72,height:72,borderRadius:"50%",objectFit:"cover",border:"2px solid #6B5BFF",background:"#eee",marginBottom:6}}),r.jsxs("div",{children:[r.jsxs("b",{children:[yt.nickname[i],"："]}),x.nickname]}),r.jsxs("div",{children:[r.jsxs("b",{children:[yt.country[i],"："]}),x.country]}),r.jsxs("div",{children:[r.jsxs("b",{children:[yt.age[i],"："]}),x.age]}),r.jsxs("div",{children:[r.jsxs("b",{children:[yt.gender[i],"："]}),gy[i][x.gender]]}),r.jsxs("div",{children:[r.jsx("b",{children:"Email："}),x.email]}),r.jsxs("div",{children:[r.jsxs("b",{children:[yt.interest[i],"："]}),x.interest]}),r.jsxs("div",{children:[r.jsxs("b",{children:[yt.eventType[i],"："]}),x.eventType]}),r.jsxs("div",{children:[r.jsxs("b",{children:[yt.bio[i],"："]}),x.bio]})]}),r.jsxs("div",{style:{marginTop:14,display:"flex",flexDirection:"row",gap:10,justifyContent:"center",alignItems:"center"},children:[r.jsx("select",{value:I,onChange:v=>j(v.target.value),style:{padding:"6px 12px",borderRadius:8,border:"1.5px solid #6B5BFF",fontSize:18},children:fy.map(v=>r.jsx("option",{value:v.value,children:v.label},v.value))}),r.jsx("button",{onClick:P,style:{padding:"6px 18px",borderRadius:8,fontWeight:700,background:"linear-gradient(135deg, #6B5BFF 60%, #23c6e6 100%)",color:"#fff",border:"none",fontSize:16,transition:"background 0.18s, box-shadow 0.18s"},onMouseOver:v=>{v.currentTarget.style.background="linear-gradient(135deg, #3a2fff 60%, #0e7fd6 100%)",v.currentTarget.style.boxShadow="0 6px 32px #6B5BFF99"},onMouseOut:v=>{v.currentTarget.style.background="linear-gradient(135deg, #6B5BFF 60%, #23c6e6 100%)",v.currentTarget.style.boxShadow="none"},children:yt.sendGift[i]}),r.jsx("button",{onClick:B,style:{padding:"6px 18px",borderRadius:8,fontWeight:700,background:"#fff",color:"#6B5BFF",border:"2px solid #6B5BFF",fontSize:16,transition:"background 0.18s, color 0.18s, box-shadow 0.18s"},onMouseOver:v=>{v.currentTarget.style.background="#6B5BFF",v.currentTarget.style.color="#fff",v.currentTarget.style.boxShadow="0 6px 32px #6B5BFF99"},onMouseOut:v=>{v.currentTarget.style.background="#fff",v.currentTarget.style.color="#6B5BFF",v.currentTarget.style.boxShadow="none"},children:yt.sendEmail[i]})]}),r.jsx("button",{onClick:k,style:{position:"absolute",right:18,bottom:0,transform:"translateY(60px)",padding:"8px 24px",borderRadius:8,fontWeight:700,background:"linear-gradient(135deg, #6B5BFF 60%, #23c6e6 100%)",color:"#fff",border:"none",fontSize:16,boxShadow:"0 2px 8px #6B5BFF33",transition:"background 0.18s, box-shadow 0.18s, transform 0.18s",cursor:"pointer"},onMouseOver:v=>{v.currentTarget.style.background="linear-gradient(135deg, #3a2fff 60%, #0e7fd6 100%)",v.currentTarget.style.boxShadow="0 6px 32px #6B5BFF99",v.currentTarget.style.transform="translateY(55px) scale(1.04)"},onMouseOut:v=>{v.currentTarget.style.background="linear-gradient(135deg, #6B5BFF 60%, #23c6e6 100%)",v.currentTarget.style.boxShadow="0 2px 8px #6B5BFF33",v.currentTarget.style.transform="translateY(60px)"},children:yt.next[i]})]})]})]}),r.jsx("div",{style:{width:"100%",margin:"0 auto",marginTop:24,background:"rgba(255,255,255,0.95)",borderRadius:16,padding:"16px",boxShadow:"0 2px 12px #6B5BFF22"},children:r.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:20,flexWrap:"wrap"},children:[r.jsx("span",{onClick:()=>n("/privacy-policy"),style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12,cursor:"pointer"},children:"隱私權政策"}),r.jsx("span",{onClick:()=>n("/terms"),style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12,cursor:"pointer"},children:"條款/聲明"}),r.jsx("span",{onClick:()=>n("/data-deletion"),style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12,cursor:"pointer"},children:"資料刪除說明"}),r.jsx("span",{onClick:()=>n("/about"),style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12,cursor:"pointer"},children:"🧬 Restarter™｜我們是誰"}),r.jsx("span",{onClick:()=>n("/feedback"),style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12,cursor:"pointer"},children:"💬 意見箱｜我們想聽你說"})]})})]})}const ni={backToHome:{"zh-TW":"← 返回","zh-CN":"← 返回",ja:"← 戻る",en:"← Back",ko:"← 뒤로",th:"← กลับ",vi:"← Quay lại",ms:"← Kembali",la:"← Redire"},logout:{"zh-TW":"登出","zh-CN":"登出",ja:"ログアウト",en:"Logout",ko:"로그아웃",th:"ออกจากระบบ",vi:"Đăng xuất",ms:"Log keluar",la:"Exire"},pageTitle:{"zh-TW":"情境模擬室 SkillBox","zh-CN":"情境模拟室 SkillBox",en:"SkillBox Scenario Room",ja:"シナリオ練習室 SkillBox",ko:"상황 시뮬레이션실 SkillBox",th:"ห้องจำลองสถานการณ์ SkillBox",vi:"Phòng mô phỏng tình huống SkillBox",ms:"Bilik Senario SkillBox",la:"Camera Scaenarii SkillBox"},subtitle:{"zh-TW":"在這裡磨練你的對話技巧，應對各種挑戰。","zh-CN":"在这里磨练你的对话技巧，应对各种挑战。",en:"Hone your conversation skills here for any challenge.",ja:"ここで会話スキルを磨き、様々な挑戦に備えましょう。",ko:"여기서 대화 기술을 연마하여 모든 도전에 대비하세요.",th:"ฝึกฝนทักษะการสนทนาของคุณที่นี่เพื่อรับมือกับทุกความท้าทาย",vi:"Rèn luyện kỹ năng trò chuyện của bạn ở đây cho mọi thử thách.",ms:"Asah kemahiran perbualan anda di sini untuk sebarang cabaran.",la:"Hic peritiam colloquii tui exacue ad quamvis provocationem."},selectScenario:{"zh-TW":"選擇一個情境開始練習","zh-CN":"选择一个情境开始练习",en:"Select a scenario to start practicing",ja:"練習を始めるシナリオを選択してください",ko:"연습을 시작할 시나리오를 선택하세요",th:"เลือกสถานการณ์เพื่อเริ่มฝึก",vi:"Chọn một kịch bản để bắt đầu luyện tập",ms:"Pilih senario untuk mula berlatih",la:"Scaenarium elige ut exercere incipias"},startPractice:{"zh-TW":"進入模擬","zh-CN":"进入模拟",en:"Enter Simulation",ja:"シミュレーションに入る",ko:"시뮬레이션 시작",th:"เข้าสู่การจำลอง",vi:"Vào mô phỏng",ms:"Masuk Simulasi",la:"Intra Simulationem"},scenarioDifficulty:{"zh-TW":"難度","zh-CN":"难度",en:"Difficulty",ja:"難易度",ko:"난이도",th:"ความยาก",vi:"Độ khó",ms:"Kesukaran",la:"Difficultas"},cancelButton:{"zh-TW":"取消","zh-CN":"取消",en:"Cancel",ja:"キャンセル",ko:"취소",th:"ยกเลิก",vi:"Hủy",ms:"Batal",la:"Abstinere"}};function EB(){const n=$e(),e=Je(),{lang:t}=Qe(),i=t||localStorage.getItem("lang")||"zh-TW",[s,o]=g.useState(null),[a,l]=g.useState([]),[c,u]=g.useState(!0),[h,p]=g.useState(!1),[f,b]=g.useState(null);g.useEffect(()=>{(async()=>{u(!0);try{const j=await fetch(`/locales/${i}/scenarios.json`);if(!j.ok)throw new Error("Failed to fetch scenarios");const A=await j.json();l(A)}catch(j){console.error("Error fetching scenarios:",j),l([])}finally{u(!1)}})()},[i]);const x=I=>{b(I),o(I.id),p(!0)},S=()=>{s?n(`/skillbox/${s}`):alert(ni.selectScenario[i])},w=()=>{p(!1),b(null),o(null)};return c?r.jsx("div",{children:"Loading scenarios..."}):r.jsxs("div",{className:"modern-bg",style:{background:"url('/plains.png') center center / cover no-repeat fixed",minHeight:"100vh",width:"100vw",overflow:"hidden",position:"relative"},children:[r.jsxs("div",{style:{width:"100%",maxWidth:700,margin:"20px auto 20px auto",padding:"16px 24px",background:"rgba(255,255,255,0.95)",borderRadius:16,boxShadow:"0 4px 20px rgba(0,0,0,0.1)",display:"flex",alignItems:"center",justifyContent:"space-between",position:"relative"},children:[r.jsx("button",{onClick:()=>n("/"),style:{fontWeight:700,fontSize:16,padding:"8px 16px",borderRadius:8,border:"1.5px solid #6B5BFF",background:"#fff",color:"#6B5BFF",cursor:"pointer",minWidth:80},children:ni.backToHome[i]}),r.jsxs("h1",{style:{fontWeight:900,fontSize:18,color:"#6B5BFF",margin:0,lineHeight:1,textShadow:"0 2px 8px #6B5BFF88",textAlign:"center",flex:1},children:[r.jsx("span",{role:"img","aria-label":"skillbox",children:"🛠️"})," ",ni.pageTitle[i]]}),r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[r.jsx("button",{onClick:async()=>{await hn(e),localStorage.clear(),window.location.href="/"},style:{fontWeight:700,fontSize:16,padding:"8px 16px",borderRadius:8,border:"1.5px solid #6B5BFF",background:"#fff",color:"#6B5BFF",cursor:"pointer",minWidth:80},children:ni.logout[i]}),r.jsx("div",{style:{width:80},children:r.jsx(en,{style:{width:"100%"}})})]})]}),r.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",width:"100%",padding:"24px",marginTop:20,minHeight:"calc(100vh - 120px)",overflowY:"auto"},children:[r.jsx("div",{style:{fontSize:18,color:"#4A4A4A",fontWeight:500,marginBottom:24,textAlign:"center",background:"rgba(255,255,255,0.7)",padding:"8px 16px",borderRadius:8},children:ni.subtitle[i]}),r.jsxs("div",{style:{maxWidth:800,width:"100%",background:"#fff",borderRadius:16,padding:"24px 32px",boxShadow:"0 4px 24px #0002",display:"flex",flexDirection:"column",alignItems:"center"},children:[r.jsx("h3",{style:{fontSize:24,fontWeight:700,color:"#6B5BFF",marginBottom:24},children:ni.selectScenario[i]}),r.jsx("div",{style:{width:"100%",display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"24px"},children:a.map(I=>r.jsxs("div",{onClick:()=>x(I),style:{background:s===I.id?"linear-gradient(135deg, #6B5BFF 0%, #4D8FFF 100%)":"#f7f7ff",color:s===I.id?"#fff":"#4A4A4A",borderRadius:12,padding:20,boxShadow:s===I.id?"0 8px 24px #6B5BFF66":"0 4px 12px #0000001a",cursor:"pointer",transition:"all 0.3s ease",border:s===I.id?"2px solid #fff":"2px solid transparent",transform:s===I.id?"translateY(-5px)":"none",display:"flex",flexDirection:"column",alignItems:"center",textAlign:"center"},children:[r.jsx("div",{style:{fontSize:48,marginBottom:12},children:I.emoji}),r.jsx("h4",{style:{fontSize:18,fontWeight:700,margin:"0 0 8px 0"},children:I.title}),r.jsx("p",{style:{fontSize:14,margin:"0 0 12px 0",opacity:.8,minHeight:"40px"},children:I.description}),r.jsxs("div",{style:{fontWeight:600,fontSize:14,padding:"4px 12px",borderRadius:16,background:s===I.id?"rgba(255,255,255,0.2)":"rgba(107, 91, 255, 0.1)",color:s===I.id?"#fff":"#6B5BFF"},children:[ni.scenarioDifficulty[i],": ",I.difficulty]})]},I.id))})]})]}),h&&f&&r.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},onClick:w,children:r.jsxs("div",{style:{background:"#fff",borderRadius:16,padding:"32px",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.3)",maxWidth:400,width:"90%",textAlign:"center",position:"relative"},onClick:I=>I.stopPropagation(),children:[r.jsx("button",{onClick:w,style:{position:"absolute",top:12,right:12,background:"none",border:"none",fontSize:24,cursor:"pointer",color:"#999",width:32,height:32,display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"50%",transition:"background-color 0.2s"},onMouseOver:I=>I.currentTarget.style.backgroundColor="#f0f0f0",onMouseOut:I=>I.currentTarget.style.backgroundColor="transparent",children:"×"}),r.jsx("div",{style:{fontSize:48,marginBottom:16},children:f.emoji}),r.jsx("h3",{style:{fontSize:20,fontWeight:700,color:"#6B5BFF",margin:"0 0 8px 0"},children:f.title}),r.jsx("p",{style:{fontSize:14,color:"#666",margin:"0 0 16px 0",lineHeight:1.5},children:f.description}),r.jsxs("div",{style:{display:"flex",gap:12,justifyContent:"center"},children:[r.jsx("button",{onClick:w,style:{padding:"10px 20px",borderRadius:8,border:"1px solid #ddd",background:"#f8f9fa",color:"#666",cursor:"pointer",fontSize:14,fontWeight:600,transition:"all 0.2s"},onMouseOver:I=>I.currentTarget.style.background="#e9ecef",onMouseOut:I=>I.currentTarget.style.background="#f8f9fa",children:ni.cancelButton[i]||"取消"}),r.jsx("button",{onClick:S,style:{padding:"10px 24px",borderRadius:8,border:"none",background:"linear-gradient(135deg, #6B5BFF 0%, #4D8FFF 100%)",color:"#fff",cursor:"pointer",fontSize:14,fontWeight:700,transition:"all 0.2s",boxShadow:"0 4px 12px rgba(107, 91, 255, 0.3)"},onMouseOver:I=>I.currentTarget.style.transform="translateY(-1px)",onMouseOut:I=>I.currentTarget.style.transform="translateY(0)",children:ni.startPractice[i]})]})]})}),r.jsx("div",{style:{width:"100%",margin:"0 auto",marginTop:24,background:"rgba(255,255,255,0.95)",borderRadius:16,padding:"16px",boxShadow:"0 2px 12px #6B5BFF22"},children:r.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:20,flexWrap:"wrap"},children:[r.jsx("span",{onClick:()=>n("/privacy-policy"),style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12,cursor:"pointer"},children:"隱私權政策"}),r.jsx("span",{onClick:()=>n("/terms"),style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12,cursor:"pointer"},children:"條款/聲明"}),r.jsx("span",{onClick:()=>n("/data-deletion"),style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12,cursor:"pointer"},children:"資料刪除說明"}),r.jsx("span",{onClick:()=>n("/about"),style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12,cursor:"pointer"},children:"🧬 Restarter™｜我們是誰"}),r.jsx("span",{onClick:()=>n("/feedback"),style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12,cursor:"pointer"},children:"💬 意見箱｜我們想聽你說"})]})})]})}const BB={"zh-TW":r.jsxs("div",{children:[r.jsx("h1",{children:"Restarter™ 使用條款與更生者聲明"}),r.jsx("h2",{children:"一、平台理念聲明"}),r.jsx("p",{children:"Restarter™ 是幫助更生人社會、心理、生活自信恢復的 AI 平台。我們透過情感引導、角色扮演、任務挑戰，協助用戶釋放負面情緒、重建目標與自信，更引導使用者逐步建立內在動力與行動信心。"}),r.jsx("p",{children:"我們相信每一位更生人都值得被尊重與重新認識。即使你曾經犯錯，在這裡不再被貼標籤。"}),r.jsx("h2",{children:"二、用戶身份與行為規範"}),r.jsx("p",{children:"本平台歡迎曾經服刑、戒癮、感化、接受司法保護、霸凌或因社會排斥而渴望重新開始的個人註冊使用。"}),r.jsx("p",{children:"為確保社群安全與信任，嚴禁下列行為："}),r.jsxs("ul",{children:[r.jsx("li",{children:"冒用他人身份或誤導他人註冊資料"}),r.jsx("li",{children:"散佈仇恨、歧視、暴力、色情、違法內容"}),r.jsx("li",{children:"上傳侵犯他人肖像權或機敏資料的圖片"})]}),r.jsx("p",{children:"違反上述條款者，平台有權立即中止其帳號與使用權限。"}),r.jsx("h2",{children:"三、AI 使用與責任聲明"}),r.jsx("p",{children:"平台所提供的 AI 對話、建議與角色模擬，僅供陪伴、練習與個人成長參考，不構成法律、醫療或心理專業意見。"}),r.jsxs("ul",{children:[r.jsx("li",{children:"平台不對使用者依據 AI 輸出所做的決策承擔法律責任"}),r.jsx("li",{children:"平台不保證 AI 對話完全正確或與真實情境一致"}),r.jsx("li",{children:"請勿將 AI 對話內容散佈作為公共引用資訊"})]}),r.jsx("p",{children:"我們已設置基本風險過濾與話術限制，但 AI 存在輸出偏差或感受誤解的可能。"}),r.jsx("p",{children:"若遇到不適當內容，請透過回報機制通知我們，我們將持續優化模型。"}),r.jsx("h3",{children:"三之一、AI 對話內容使用規範"}),r.jsxs("ul",{children:[r.jsx("li",{children:"不得詢問或輸入他人私密資訊（如住址、犯罪紀錄）"}),r.jsx("li",{children:"不得操作 AI 模擬暴力、自殘或誘導非法行為"}),r.jsx("li",{children:"不得以 Restarter™ 名義散佈虛假或詐騙訊息"}),r.jsx("li",{children:"所有對話資料僅用於匿名模型優化，不作個人追蹤"}),r.jsx("li",{children:"如有必要，平台保留法律配合義務"}),r.jsx("li",{children:"未滿十八歲使用者，需經家長同意方可使用本平台"}),r.jsx("li",{children:"本平台禁止自動爬蟲或未授權系統串接"}),r.jsx("li",{children:"使用者需自負資料輸入內容之法律風險"})]}),r.jsx("h2",{children:"四、資料處理與隱私權聲明"}),r.jsx("p",{children:"平台僅會蒐集註冊所需最基本資料，如暱稱、電子信箱與使用語言偏好。"}),r.jsx("p",{children:"所有資料經加密儲存，不會轉售第三方或做商業行銷使用。"}),r.jsx("p",{children:"使用者可隨時申請帳號刪除，並請求系統清除其所有紀錄。"}),r.jsx("h2",{children:"五、帳號停用與終止權利"}),r.jsx("p",{children:"平台保留中止任何違反本條款使用者帳號的權利，且無須事前通知。"}),r.jsx("p",{children:"如帳號長期未使用，平台將主動發出提醒並保留停用處理權限。"}),r.jsx("p",{children:"用戶可自行隨時停用帳號並刪除所有資料紀錄。"}),r.jsx("h2",{children:"六、本條款之調整與最終解釋權"}),r.jsx("p",{children:"平台有權依據法律、政策與服務優化隨時修改本條款內容。"}),r.jsx("p",{children:"重大異動將透過站內公告與電子郵件通知用戶。"}),r.jsx("p",{children:"本條款之最終解釋權歸 Restarter™ 平台所有。"})]}),"zh-CN":r.jsxs("div",{children:[r.jsx("h1",{children:"Restarter™ 使用条款与更生者声明"}),r.jsx("h2",{children:"一、平台理念声明"}),r.jsx("p",{children:"Restarter™ 是帮助更生人社会、心理、生活自信恢复的 AI 平台。我们通过情感引导、角色扮演、任务挑战，协助用户释放负面情绪、重建目标与自信，并引导用户逐步建立内在动力与行动信心。"}),r.jsx("p",{children:"我们相信每一位更生人都值得被尊重与重新认识。即使你曾经犯错，在这里不再被贴标签。"}),r.jsx("h2",{children:"二、用户身份与行为规范"}),r.jsx("p",{children:"本平台欢迎曾经服刑、戒瘾、感化、接受司法保护、霸凌或因社会排斥而渴望重新开始的个人注册使用。"}),r.jsx("p",{children:"为确保社群安全与信任，严禁下列行为："}),r.jsxs("ul",{children:[r.jsx("li",{children:"冒用他人身份或误导他人注册资料"}),r.jsx("li",{children:"散布仇恨、歧视、暴力、色情、违法内容"}),r.jsx("li",{children:"上传侵犯他人肖像权或敏感资料的图片"})]}),r.jsx("p",{children:"违反上述条款者，平台有权立即中止其账号与使用权限。"}),r.jsx("h2",{children:"三、AI 使用与责任声明"}),r.jsx("p",{children:"平台所提供的 AI 对话、建议与角色模拟，仅供陪伴、练习与个人成长参考，不构成法律、医疗或心理专业意见。"}),r.jsxs("ul",{children:[r.jsx("li",{children:"平台不对用户依据 AI 输出所做的决策承担法律责任"}),r.jsx("li",{children:"平台不保证 AI 对话完全正确或与真实情境一致"}),r.jsx("li",{children:"请勿将 AI 对话内容散布作为公共引用信息"})]}),r.jsx("p",{children:"我们已设置基本风险过滤与话术限制，但 AI 存在输出偏差或感受误解的可能。"}),r.jsx("p",{children:"若遇到不适当内容，请通过举报机制通知我们，我们将持续优化模型。"}),r.jsx("h3",{children:"三之一、AI 对话内容使用规范"}),r.jsxs("ul",{children:[r.jsx("li",{children:"不得询问或输入他人私密信息（如住址、犯罪记录）"}),r.jsx("li",{children:"不得操作 AI 模拟暴力、自残或诱导非法行为"}),r.jsx("li",{children:"不得以 Restarter™ 名义散布虚假或诈骗信息"}),r.jsx("li",{children:"全对话资料仅用于匿名模型优化，不作个人追踪"}),r.jsx("li",{children:"如有必要，平台保留法律配合义务"}),r.jsx("li",{children:"未满十八岁用户，需经家长同意方可使用本平台"}),r.jsx("li",{children:"本平台禁止自动爬虫或未授权系统串接"}),r.jsx("li",{children:"用户需自负资料输入内容之法律风险"})]}),r.jsx("h2",{children:"四、资料处理与隐私权声明"}),r.jsx("p",{children:"平台仅会收集注册所需最基本资料，如昵称、电子邮箱与使用语言偏好。"}),r.jsx("p",{children:"所有资料经加密存储，不会转售第三方或做商业营销使用。"}),r.jsx("p",{children:"用户可随时申请账号删除，并请求系统清除其所有记录。"}),r.jsx("h2",{children:"五、账号停用与终止权利"}),r.jsx("p",{children:"平台保留中止任何违反本条款用户账号的权利，且无需事前通知。"}),r.jsx("p",{children:"如账号长期未使用，平台将主动发出提醒并保留停用处理权限。"}),r.jsx("p",{children:"用户可自行随时停用账号并删除所有资料记录。"}),r.jsx("h2",{children:"六、本条款之调整与最终解释权"}),r.jsx("p",{children:"平台有权依据法律、政策与服务优化随时修改本条款内容。"}),r.jsx("p",{children:"重大变动将通过站内公告与电子邮件通知用户。"}),r.jsx("p",{children:"本条款之最终解释权归 Restarter™ 平台所有。"})]}),en:r.jsxs("div",{children:[r.jsx("h1",{children:"Restarter™ Terms of Use and Ex-Offender Declaration"}),r.jsx("h2",{children:"1. Platform Philosophy Statement"}),r.jsx("p",{children:"Restarter™ is an AI platform dedicated to helping ex-offenders rebuild social, psychological, and life confidence. Through emotional guidance, role-playing, and task challenges, we help users release negative emotions, rebuild goals and confidence, and guide them to gradually build inner motivation and action confidence."}),r.jsx("p",{children:"We believe that every ex-offender deserves respect and a new recognition. Even if you have made mistakes, you will not be labeled here."}),r.jsx("h2",{children:"2. User Identity and Code of Conduct"}),r.jsx("p",{children:"This platform welcomes individuals who have served sentences, undergone rehabilitation, received judicial protection, experienced bullying, or wish to start over due to social exclusion."}),r.jsx("p",{children:"To ensure community safety and trust, the following behaviors are strictly prohibited:"}),r.jsxs("ul",{children:[r.jsx("li",{children:"Impersonating others or providing misleading registration information"}),r.jsx("li",{children:"Spreading hate, discrimination, violence, pornography, or illegal content"}),r.jsx("li",{children:"Uploading images that infringe on others' portrait rights or sensitive data"})]}),r.jsx("p",{children:"Those who violate the above terms may have their accounts and access immediately terminated by the platform."}),r.jsx("h2",{children:"3. AI Usage and Responsibility Statement"}),r.jsx("p",{children:"The AI dialogues, suggestions, and role simulations provided by the platform are for companionship, practice, and personal growth reference only, and do not constitute legal, medical, or psychological professional advice."}),r.jsxs("ul",{children:[r.jsx("li",{children:"The platform is not legally responsible for decisions made by users based on AI output"}),r.jsx("li",{children:"The platform does not guarantee that AI dialogues are completely accurate or consistent with real situations"}),r.jsx("li",{children:"Do not distribute AI dialogue content as public reference information"})]}),r.jsx("p",{children:"We have set up basic risk filtering and dialogue restrictions, but AI may still produce biased or misunderstood outputs."}),r.jsx("p",{children:"If you encounter inappropriate content, please notify us through the reporting mechanism, and we will continue to optimize the model."}),r.jsx("h3",{children:"3.1 AI Dialogue Content Usage Guidelines"}),r.jsxs("ul",{children:[r.jsx("li",{children:"Do not ask for or input others' private information (such as address or criminal record)"}),r.jsx("li",{children:"Do not use AI to simulate violence, self-harm, or induce illegal behavior"}),r.jsx("li",{children:"Do not distribute false or fraudulent information in the name of Restarter™"}),r.jsx("li",{children:"All dialogue data is used only for anonymous model optimization, not for personal tracking"}),r.jsx("li",{children:"The platform reserves the right to cooperate with legal authorities if necessary"}),r.jsx("li",{children:"Users under 18 must have parental consent to use this platform"}),r.jsx("li",{children:"The platform prohibits automated crawling or unauthorized system integration"}),r.jsx("li",{children:"Users are responsible for the legal risks of the content they input"})]}),r.jsx("h2",{children:"4. Data Processing and Privacy Statement"}),r.jsx("p",{children:"The platform only collects the most basic registration information, such as nickname, email, and language preference."}),r.jsx("p",{children:"All data is stored encrypted and will not be sold to third parties or used for commercial marketing."}),r.jsx("p",{children:"Users can request account deletion at any time and ask the system to clear all their records."}),r.jsx("h2",{children:"5. Account Suspension and Termination Rights"}),r.jsx("p",{children:"The platform reserves the right to terminate any user's account that violates these terms at any time without prior notice."}),r.jsx("p",{children:"If an account is inactive for a long period, the platform will proactively send reminders and reserves the right to suspend the account."}),r.jsx("p",{children:"Users can deactivate their accounts and delete all data records at any time."}),r.jsx("h2",{children:"6. Amendments and Final Interpretation"}),r.jsx("p",{children:"The platform reserves the right to modify these terms at any time in accordance with laws, policies, and service optimization."}),r.jsx("p",{children:"Major changes will be announced on the platform and via email notifications to users."}),r.jsx("p",{children:"The final interpretation of these terms belongs to the Restarter™ platform."})]}),ja:r.jsxs("div",{children:[r.jsx("h1",{children:"Restarter™ 利用規約および更生者宣言"}),r.jsx("h2",{children:"1. プラットフォーム理念声明"}),r.jsx("p",{children:"Restarter™ は更生者の社会的・心理的・生活的自信の回復を支援するAIプラットフォームです。感情ガイダンス、ロールプレイ、タスクチャレンジを通じて、ユーザーがネガティブな感情を解放し、目標と自信を再構築し、内面の動機と行動への自信を段階的に築くことをサポートします。"}),r.jsx("p",{children:"私たちは、すべての更生者が尊重され、新たに認識される価値があると信じています。過去に過ちを犯したとしても、ここではラベルを貼られません。"}),r.jsx("h2",{children:"2. ユーザーの身分と行動規範"}),r.jsx("p",{children:"本プラットフォームは、服役経験者、依存症克服者、感化・司法保護を受けた方、いじめや社会的排除を経験し再出発を望む方の登録を歓迎します。"}),r.jsx("p",{children:"コミュニティの安全と信頼を守るため、以下の行為を厳禁とします："}),r.jsxs("ul",{children:[r.jsx("li",{children:"他人の身分を詐称または誤った登録情報の提供"}),r.jsx("li",{children:"憎悪・差別・暴力・ポルノ・違法コンテンツの拡散"}),r.jsx("li",{children:"他人の肖像権や機密情報を侵害する画像のアップロード"})]}),r.jsx("p",{children:"上記規約に違反した場合、プラットフォームは直ちにアカウントと利用権限を停止する権利を有します。"}),r.jsx("h2",{children:"3. AI利用と責任声明"}),r.jsx("p",{children:"本プラットフォームが提供するAI対話・提案・ロールプレイは、伴走・練習・自己成長の参考用であり、法的・医療的・心理的な専門アドバイスではありません。"}),r.jsxs("ul",{children:[r.jsx("li",{children:"AI出力に基づく意思決定に対し、プラットフォームは法的責任を負いません"}),r.jsx("li",{children:"AI対話が常に正確または現実と一致することを保証しません"}),r.jsx("li",{children:"AI対話内容を公共の引用情報として拡散しないでください"})]}),r.jsx("p",{children:"基本的なリスクフィルタと発話制限を設けていますが、AIには出力の偏りや誤解が生じる可能性があります。"}),r.jsx("p",{children:"不適切な内容に遭遇した場合は、報告機能からご連絡ください。モデルの最適化に努めます。"}),r.jsx("h3",{children:"3.1 AI対話内容の利用規範"}),r.jsxs("ul",{children:[r.jsx("li",{children:"他人の個人情報（住所・犯罪歴等）を尋ねたり入力しない"}),r.jsx("li",{children:"AIで暴力・自傷・違法行為を模擬しない"}),r.jsx("li",{children:"Restarter™名義で虚偽・詐欺情報を拡散しない"}),r.jsx("li",{children:"全対話データは匿名モデル最適化のみに利用し、個人追跡はしません"}),r.jsx("li",{children:"必要に応じて法的協力義務を負います"}),r.jsx("li",{children:"未満18歳の方は保護者の同意が必要です"}),r.jsx("li",{children:"自動クローラーや未承認システム連携は禁止します"}),r.jsx("li",{children:"入力内容の法的リスクは利用者自身が負います"})]}),r.jsx("h2",{children:"4. データ処理とプライバシー声明"}),r.jsx("p",{children:"登録時に必要最低限の情報（ニックネーム・メール・言語設定）のみ収集します。"}),r.jsx("p",{children:"全データは暗号化保存され、第三者への販売や商用利用はしません。"}),r.jsx("p",{children:"アカウント削除申請と全記録の消去依頼がいつでも可能です。"}),r.jsx("h2",{children:"5. アカウント停止と終了権利"}),r.jsx("p",{children:"本規約違反者のアカウントは、事前通知なく停止できる権利を有します。"}),r.jsx("p",{children:"長期間未使用の場合、リマインダー送信や停止処理権限を保持します。"}),r.jsx("p",{children:"利用者はいつでもアカウント停止・全データ削除が可能です。"}),r.jsx("h2",{children:"6. アカウント停止と終了権利"}),r.jsx("p",{children:"本規約違反者のアカウントは、事前通知なく停止できる権利を有します。"}),r.jsx("p",{children:"長期間未使用の場合、リマインダー送信や停止処理権限を保持します。"}),r.jsx("p",{children:"利用者はいつでもアカウント停止・全データ削除が可能です。"}),r.jsx("h2",{children:"6. 本規約の改定と最終解釈権"}),r.jsx("p",{children:"法令・政策・サービス最適化に応じて本規約を随時改定します。"}),r.jsx("p",{children:"重大な変更はサイト告知やメールで通知します。"}),r.jsx("p",{children:"最終解釈権はRestarter™プラットフォームに帰属します。"})]}),ko:r.jsxs("div",{children:[r.jsx("h1",{children:"Restarter™ 이용약관 및 갱생자 선언"}),r.jsx("h2",{children:"1. 플랫폼 이념 선언"}),r.jsx("p",{children:"Restarter™는 갱생인의 사회적, 심리적, 생활적 자신감 회복을 돕는 AI 플랫폼입니다. 감정 안내, 역할극, 과제 도전을 통해 사용자가 부정적 감정을 해소하고 목표와 자신감을 재구축하며, 내면 동기와 행동 자신감을 단계적으로 쌓을 수 있도록 지원합니다."}),r.jsx("p",{children:"우리는 모든 갱생인이 존중받고 새롭게 인식받을 가치가 있다고 믿습니다. 과거에 실수했더라도 여기서는 낙인찍지 않습니다."}),r.jsx("h2",{children:"2. 사용자 신분 및 행동 규범"}),r.jsx("p",{children:"본 플랫폼은 형을 마친 자, 중독을 극복한 자, 감화를 받은 자, 사법 보호를 받은 자, 따돌림이나 사회적 배제를 경험하고 재출발을 원하는 자의 가입을 환영합니다."}),r.jsx("p",{children:"커뮤니티의 안전과 신뢰를 위해 다음 행위를 엄격히 금지합니다:"}),r.jsxs("ul",{children:[r.jsx("li",{children:"타인 신분 도용 또는 허위 등록 정보 제공"}),r.jsx("li",{children:"증오, 차별, 폭력, 음란, 불법 콘텐츠 유포"}),r.jsx("li",{children:"타인의 초상권 또는 민감 정보 침해 이미지 업로드"})]}),r.jsx("p",{children:"위 조항 위반 시 플랫폼은 즉시 계정 및 이용 권한을 중지할 수 있습니다."}),r.jsx("h2",{children:"3. AI 이용 및 책임 선언"}),r.jsx("p",{children:"플랫폼이 제공하는 AI 대화, 제안, 역할 시뮬레이션은 동반, 연습, 자기 성장 참고용이며, 법률·의료·심리 전문가의 조언이 아닙니다."}),r.jsxs("ul",{children:[r.jsx("li",{children:"플랫폼은 AI에 따른 결정에 대해 법적 책임을 지지 않습니다"}),r.jsx("li",{children:"플랫폼은 AI 대화가 항상 정확하거나 실제와 일치함을 보장하지 않습니다"}),r.jsx("li",{children:"AI 대화 내용을 공공 인용 정보로 유포하지 마십시오"})]}),r.jsx("p",{children:"기본 위험 필터와 발화 제한을 두었으나, AI는 편향되거나 오해를 불러일으킬 수 있습니다."}),r.jsx("p",{children:"부적절한 내용 발견 시 신고 기능을 통해 알려주시면 지속적으로 모델을 개선하겠습니다."}),r.jsx("h3",{children:"3.1 AI 대화 내용 이용 규범"}),r.jsxs("ul",{children:[r.jsx("li",{children:"타인 개인정보(주소, 범죄기록 등) 문의·입력 금지"}),r.jsx("li",{children:"AI로 폭력·자해·불법행위 모의 금지"}),r.jsx("li",{children:"Restarter™ 명의로 허위·사기 정보 유포 금지"}),r.jsx("li",{children:"모든 대화 데이터는 익명 모델 최적화에만 사용, 개인 추적 불가"}),r.jsx("li",{children:"필요시 법적 협조 의무 보유"}),r.jsx("li",{children:"18세 미만은 부모 동의 필요"}),r.jsx("li",{children:"자동 크롤러·미승인 시스템 연동 금지"}),r.jsx("li",{children:"입력 내용의 법적 책임은 사용자 본인에게 있음"})]}),r.jsx("h2",{children:"4. 데이터 처리 및 개인정보 보호"}),r.jsx("p",{children:"가입 시 닉네임, 이메일, 언어 설정 등 최소 정보만 수집합니다."}),r.jsx("p",{children:"모든 데이터는 암호화 저장되며, 제3자 판매·상업적 이용은 없습니다."}),r.jsx("p",{children:"언제든 계정 삭제 및 기록 삭제 요청 가능"}),r.jsx("h2",{children:"5. 계정 정지 및 종료 권리"}),r.jsx("p",{children:"플랫폼은 본 약관 위반 계정을 사전 통보 없이 정지할 수 있습니다."}),r.jsx("p",{children:"장기간 미사용 시 알림 발송 및 정지 처리 권한 보유"}),r.jsx("p",{children:"사용자는 언제든 계정 정지 및 데이터 삭제 가능"}),r.jsx("h2",{children:"6. 약관 개정 및 최종 해석권"}),r.jsx("p",{children:"법령·정책·서비스 최적화에 따라 약관을 수시로 개정할 수 있습니다."}),r.jsx("p",{children:"중대한 변경은 사이트 공지 및 이메일로 안내"}),r.jsx("p",{children:"최종 해석권은 Restarter™ 플랫폼에 있음"})]}),th:r.jsxs("div",{children:[r.jsx("h1",{children:"Restarter™ ข้อกำหนดการใช้งานและประกาศสำหรับผู้กลับตัว"}),r.jsx("h2",{children:"1. ปรัชญาแพลตฟอร์ม"}),r.jsx("p",{children:"Restarter™ เป็นแพลตฟอร์ม AI ที่ช่วยฟื้นฟูความมั่นใจทางสังคม จิตใจ และชีวิตของผู้กลับตัว ผ่านการชี้นำทางอารมณ์ บทบาทสมมติ และภารกิจท้าทาย เพื่อช่วยให้ผู้ใช้ปลดปล่อยอารมณ์ลบ สร้างเป้าหมายและความมั่นใจ และสร้างแรงบันดาลใจภายในและความมั่นใจในการลงมือทำ"}),r.jsx("p",{children:"เราเชื่อว่าทุกคนที่กลับตัวสมควรได้รับความเคารพและการยอมรับใหม่ แม้คุณจะเคยทำผิด ที่นี่จะไม่มีใครติดป้ายคุณอีก"}),r.jsx("h2",{children:"2. ตัวตนและข้อปฏิบัติของผู้ใช้"}),r.jsx("p",{children:"แพลตฟอร์มนี้ยินดีต้อนรับผู้ที่เคยต้องโทษ เลิกยา ฟื้นฟู ได้รับการคุ้มครองทางกฎหมาย ถูกกลั่นแกล้ง หรือถูกกีดกันทางสังคมและต้องการเริ่มต้นใหม่"}),r.jsx("p",{children:"เพื่อความปลอดภัยและความไว้วางใจในชุมชน ห้ามกระทำดังต่อไปนี้อย่างเด็ดขาด:"}),r.jsxs("ul",{children:[r.jsx("li",{children:"แอบอ้างตัวตนหรือให้ข้อมูลสมัครสมาชิกที่ทำให้เข้าใจผิด"}),r.jsx("li",{children:"เผยแพร่ความเกลียดชัง การเลือกปฏิบัติ ความรุนแรง สื่อลามก หรือเนื้อหาผิดกฎหมาย"}),r.jsx("li",{children:"อัปโหลดภาพที่ละเมิดสิทธิ์ในภาพบุคคลหรือข้อมูลสำคัญของผู้อื่น"})]}),r.jsx("p",{children:"หากฝ่าฝืนข้อกำหนดข้างต้น แพลตฟอร์มมีสิทธิ์ระงับบัญชีและสิทธิ์การใช้งานทันที"}),r.jsx("h2",{children:"3. การใช้ AI และคำประกาศความรับผิดชอบ"}),r.jsx("p",{children:"AI ที่แพลตฟอร์มให้บริการใช้สำหรับการพูดคุย แนะนำ และจำลองสถานการณ์เพื่อการฝึกฝนและพัฒนาตนเองเท่านั้น ไม่ถือเป็นคำแนะนำทางกฎหมาย การแพทย์ หรือจิตวิทยา"}),r.jsxs("ul",{children:[r.jsx("li",{children:"แพลตฟอร์มไม่รับผิดชอบทางกฎหมายต่อการตัดสินใจที่เกิดจาก AI"}),r.jsx("li",{children:"แพลตฟอร์มไม่รับประกันว่า AI จะถูกต้องสมบูรณ์หรือสอดคล้องกับสถานการณ์จริงเสมอไป"}),r.jsx("li",{children:"ห้ามนำเนื้อหาการสนทนา AI ไปเผยแพร่เป็นข้อมูลอ้างอิงสาธารณะ"})]}),r.jsx("p",{children:"แม้จะมีการกรองความเสี่ยงและจำกัดเนื้อหาแล้ว AI อาจยังมีความคลาดเคลื่อนหรือเข้าใจผิดได้"}),r.jsx("p",{children:"หากพบเนื้อหาไม่เหมาะสม กรุณาแจ้งผ่านระบบรายงาน เราจะปรับปรุงโมเดลอย่างต่อเนื่อง"}),r.jsx("h3",{children:"3.1 ข้อกำหนดการใช้เนื้อหาการสนทนา AI"}),r.jsxs("ul",{children:[r.jsx("li",{children:"ห้ามสอบถามหรือกรอกข้อมูลส่วนตัวของผู้อื่น (เช่น ที่อยู่ ประวัติอาชญากรรม)"}),r.jsx("li",{children:"ห้ามใช้ AI จำลองความรุนแรง ทำร้ายตนเอง หรือชักจูงให้กระทำผิดกฎหมาย"}),r.jsx("li",{children:"ห้ามใช้ชื่อ Restarter™ เผยแพร่ข้อมูลเท็จหรือหลอกลวง"}),r.jsx("li",{children:"ข้อมูลการสนทนาทั้งหมดใช้เพื่อปรับปรุงโมเดลแบบไม่ระบุตัวตนเท่านั้น ไม่ติดตามตัวบุคคล"}),r.jsx("li",{children:"หากจำเป็น แพลตฟอร์มขอสงวนสิทธิ์ให้ความร่วมมือทางกฎหมาย"}),r.jsx("li",{children:"ผู้ใช้ที่อายุต่ำกว่า 18 ปี ต้องได้รับความยินยอมจากผู้ปกครอง"}),r.jsx("li",{children:"ห้ามใช้บอทหรือเชื่อมต่อระบบโดยไม่ได้รับอนุญาต"}),r.jsx("li",{children:"ผู้ใช้ต้องรับผิดชอบความเสี่ยงทางกฎหมายของข้อมูลที่กรอกเอง"})]}),r.jsx("h2",{children:"4. การจัดการข้อมูลและนโยบายความเป็นส่วนตัว"}),r.jsx("p",{children:"แพลตฟอร์มจะเก็บเฉพาะข้อมูลที่จำเป็นสำหรับการสมัคร เช่น ชื่อเล่น อีเมล และภาษาที่ใช้"}),r.jsx("p",{children:"ข้อมูลทั้งหมดจะถูกเข้ารหัสและไม่ขายให้บุคคลที่สามหรือใช้เพื่อการตลาด"}),r.jsx("p",{children:"ผู้ใช้สามารถขอลบบัญชีและข้อมูลทั้งหมดได้ตลอดเวลา"}),r.jsx("h2",{children:"5. สิทธิ์ในการระงับและยกเลิกบัญชี"}),r.jsx("p",{children:"แพลตฟอร์มขอสงวนสิทธิ์ในการระงับบัญชีผู้ใช้ที่ละเมิดข้อกำหนดโดยไม่ต้องแจ้งล่วงหน้า"}),r.jsx("p",{children:"หากบัญชีไม่ได้ใช้งานเป็นเวลานาน แพลตฟอร์มจะส่งการแจ้งเตือนและขอสงวนสิทธิ์ในการระงับบัญชี"}),r.jsx("p",{children:"ผู้ใช้สามารถระงับบัญชีและลบข้อมูลได้ตลอดเวลา"}),r.jsx("h2",{children:"6. การปรับปรุงและการตีความข้อกำหนด"}),r.jsx("p",{children:"แพลตฟอร์มมีสิทธิ์ปรับปรุงข้อกำหนดนี้ได้ตลอดเวลาเพื่อให้สอดคล้องกับกฎหมาย นโยบาย และการให้บริการ"}),r.jsx("p",{children:"การเปลี่ยนแปลงสำคัญจะแจ้งให้ผู้ใช้ทราบผ่านประกาศในระบบและอีเมล"}),r.jsx("p",{children:"สิทธิ์ในการตีความข้อกำหนดนี้เป็นของแพลตฟอร์ม Restarter™"})]}),vi:r.jsxs("div",{children:[r.jsx("h1",{children:"Restarter™ Điều khoản sử dụng và Tuyên bố hoàn lương"}),r.jsx("h2",{children:"1. Tuyên bố triết lý nền tảng"}),r.jsx("p",{children:"Restarter™ là nền tảng AI giúp người hoàn lương xây dựng lại sự tự tin xã hội, tâm lý và cuộc sống. Thông qua hướng dẫn cảm xúc, nhập vai và thử thách nhiệm vụ, chúng tôi giúp người dùng giải tỏa cảm xúc tiêu cực, xây dựng lại mục tiêu và sự tự tin, đồng thời hướng dẫn người dùng từng bước xây dựng động lực nội tại và sự tự tin hành động."}),r.jsx("p",{children:"Chúng tôi tin rằng mọi người hoàn lương đều xứng đáng được tôn trọng và công nhận lại. Dù bạn từng mắc sai lầm, ở đây bạn sẽ không bị dán nhãn."}),r.jsx("h2",{children:"2. Danh tính và quy tắc hành vi của người dùng"}),r.jsx("p",{children:"Nền tảng này chào đón những người từng bị kết án, men thuốc, correctionem acceperunt, tutela iudiciali fruuntur, vexationem passi sunt, aut ob exclusionem socialem iterum incipere cupiunt."}),r.jsx("p",{children:"Bagi memastikan keselamatan dan kepercayaan komuniti, haec acta stricte vetantur:"}),r.jsxs("ul",{children:[r.jsx("li",{children:"Personae alienae simulationem aut falsam informationem praebere"}),r.jsx("li",{children:"Odium, discriminationem, violentiam, pornographiam, contenta illicita disseminare"}),r.jsx("li",{children:"Imagines iura aliorum vel data sensitiva violantes onerare"})]}),r.jsx("p",{children:"Qui haec violaverint, suggestum statim rationem et usum intercludere potest."}),r.jsx("h2",{children:"3. Usus AI et Declaratio Responsabilitatis"}),r.jsx("p",{children:"Colloquia, consilia, simulationesque AI a suggesto praebita tantum ad comitatum, exercitationem, progressionemque personalem spectant, non ad consilium legale, medicum, psychologicumque."}),r.jsxs("ul",{children:[r.jsx("li",{children:"Suggestum non tenetur de decisionibus ex AI ortis"}),r.jsx("li",{children:"Non praestat colloquia AI semper recta aut实实在在congruentia esse"}),r.jsx("li",{children:"Ne dissemines colloquia AI ut informationem publicam"})]}),r.jsx("p",{children:"Filtra periculorum et restrictiones sermonum posuimus, sed AI adhuc praeiudicium aut errorem gignere potest."}),r.jsx("p",{children:"Si quid incommodum inveneris, per mechanismum referendi nos certiorem facias; modelum continue emendabimus."}),r.jsx("h3",{children:"3.1 Praecepta Usus Colloquiorum AI"}),r.jsxs("ul",{children:[r.jsx("li",{children:"Ne quaeras aut inseras informationes privatas aliorum (ut domicilium, delicta)"}),r.jsx("li",{children:"Ne AI adhibeas ad violentiam, sui laesionem, aut actus illicitos simulandos"}),r.jsx("li",{children:"Ne dissemines falsa aut fraudulenta sub nomine Restarter™"}),r.jsx("li",{children:"Omnia colloquia ad optimizationem anonymam tantum, non ad tracking personalem"}),r.jsx("li",{children:"Suggestum, si opus sit, cum auctoritatibus legalibus cooperabitur"}),r.jsx("li",{children:"Usoribus minoribus XVIII annis consensus parentum requiritur"}),r.jsx("li",{children:"Automata aut systemata non auctorata vetantur"}),r.jsx("li",{children:"Usor ipse de periculis legalibus contentorum suorum respondet"})]}),r.jsx("h2",{children:"4. Processus Datae et Declaratio Privacy"}),r.jsx("p",{children:"Suggestum tantum colligit notitias adnotationis fundamentales, ut cognomen, email, linguam praeoptatam."}),r.jsx("p",{children:"Omnia data cryptate servantur nec tertiis partibus venduntur nec ad mercaturam adhibentur."}),r.jsx("p",{children:"Usor rationem suam et omnia data delere potest quovis tempore"}),r.jsx("h2",{children:"5. Ius Suspensionis et Terminationis Rationis"}),r.jsx("p",{children:"Suggestum ius habet rationem usoris qui haec violat statim sine praevia notitia suspendere"}),r.jsx("p",{children:"Si ratio diu non utatur, suggestum admonitionem mittet et ius suspensionis retinebit"}),r.jsx("p",{children:"Usor rationem suam et omnia data delere potest quovis tempore"}),r.jsx("h2",{children:"6. Emendationes et Interpretatio Finalis"}),r.jsx("p",{children:"Suggestum ius habet haec emendandi pro legibus, consiliis, et optimizatione servitii"}),r.jsx("p",{children:"Mutationes maximi momenti per systema et email nuntiabuntur"}),r.jsx("p",{children:"Ius interpretationis finalis harum condicionum Restarter™ suggestui reservatur"})]}),ms:r.jsxs("div",{children:[r.jsx("h1",{children:"Restarter™ Terma Penggunaan dan Pengisytiharan Bekas Banduan"}),r.jsx("h2",{children:"1. Kenyataan Falsafah Platform"}),r.jsx("p",{children:"Restarter™ ialah platform AI yang membantu bekas banduan membina semula keyakinan sosial, psikologi dan kehidupan. Melalui bimbingan emosi, lakonan peranan dan cabaran tugasan, kami membantu pengguna melepaskan emosi negatif, membina semula matlamat dan keyakinan, serta membimbing mereka membina motivasi dalaman dan keyakinan bertindak secara berperingkat."}),r.jsx("p",{children:"Kami percaya setiap bekas banduan layak dihormati dan diiktiraf semula. Etiamsi peccaveris, hic non amplius notaberis."}),r.jsx("h2",{children:"2. Identiti dan Tatakelakuan Pengguna"}),r.jsx("p",{children:"Platform ini mengalu-alukan individu yang pernah dipenjarakan, abusus vicerunt, correctionem acceperunt, tutela iudiciali fruuntur, vexationem passi sunt, aut ob exclusionem socialem iterum incipere cupiunt."}),r.jsx("p",{children:"Bagi memastikan keselamatan dan kepercayaan komuniti, haec acta stricte vetantur:"}),r.jsxs("ul",{children:[r.jsx("li",{children:"Personae alienae simulationem aut falsam informationem praebere"}),r.jsx("li",{children:"Odium, discriminationem, violentiam, pornographiam, contenta illicita disseminare"}),r.jsx("li",{children:"Imagines iura aliorum vel data sensitiva violantes onerare"})]}),r.jsx("p",{children:"Qui haec violaverint, suggestum statim rationem et usum intercludere potest."}),r.jsx("h2",{children:"3. Usus AI et Declaratio Responsabilitatis"}),r.jsx("p",{children:"Colloquia, consilia, simulationesque AI a suggesto praebita tantum ad comitatum, exercitationem, progressionemque personalem spectant, non ad consilium legale, medicum, psychologicumque."}),r.jsxs("ul",{children:[r.jsx("li",{children:"Suggestum non tenetur de decisionibus ex AI ortis"}),r.jsx("li",{children:"Non praestat colloquia AI semper recta aut实实在在congruentia esse"}),r.jsx("li",{children:"Ne dissemines colloquia AI ut informationem publicam"})]}),r.jsx("p",{children:"Filtra periculorum et restrictiones sermonum posuimus, sed AI adhuc praeiudicium aut errorem gignere potest."}),r.jsx("p",{children:"Si quid incommodum inveneris, per mechanismum referendi nos certiorem facias; modelum continue emendabimus."}),r.jsx("h3",{children:"3.1 Praecepta Usus Colloquiorum AI"}),r.jsxs("ul",{children:[r.jsx("li",{children:"Ne quaeras aut inseras informationes privatas aliorum (ut domicilium, delicta)"}),r.jsx("li",{children:"Ne AI adhibeas ad violentiam, sui laesionem, aut actus illicitos simulandos"}),r.jsx("li",{children:"Ne dissemines falsa aut fraudulenta sub nomine Restarter™"}),r.jsx("li",{children:"Omnia colloquia ad optimizationem anonymam tantum, non ad tracking personalem"}),r.jsx("li",{children:"Suggestum, si opus sit, cum auctoritatibus legalibus cooperabitur"}),r.jsx("li",{children:"Usoribus minoribus XVIII annis consensus parentum requiritur"}),r.jsx("li",{children:"Automata aut systemata non auctorata vetantur"}),r.jsx("li",{children:"Usor ipse de periculis legalibus contentorum suorum respondet"})]}),r.jsx("h2",{children:"4. Processus Datae et Declaratio Privacy"}),r.jsx("p",{children:"Suggestum tantum colligit notitias adnotationis fundamentales, ut cognomen, email, linguam praeoptatam."}),r.jsx("p",{children:"Omnia data cryptate servantur nec tertiis partibus venduntur nec ad mercaturam adhibentur."}),r.jsx("p",{children:"Usor rationem suam et omnia data delere potest quovis tempore"}),r.jsx("h2",{children:"5. Ius Suspensionis et Terminationis Rationis"}),r.jsx("p",{children:"Suggestum ius habet rationem usoris qui haec violat statim sine praevia notitia suspendere"}),r.jsx("p",{children:"Si ratio diu non utatur, suggestum admonitionem mittet et ius suspensionis retinebit"}),r.jsx("p",{children:"Usor rationem suam et omnia data delere potest quovis tempore"}),r.jsx("h2",{children:"6. Emendationes et Interpretatio Finalis"}),r.jsx("p",{children:"Suggestum ius habet haec emendandi pro legibus, consiliis, et optimizatione servitii"}),r.jsx("p",{children:"Mutationes maximi momenti per systema et email nuntiabuntur"}),r.jsx("p",{children:"Ius interpretationis finalis harum condicionum Restarter™ suggestui reservatur"})]}),la:r.jsxs("div",{children:[r.jsx("h1",{children:"Restarter™ Condiciones Usus et Declaratio Redemptorum"}),r.jsx("h2",{children:"1. Propositum et Philosophia"}),r.jsx("p",{children:"Restarter™ est suggestum AI adiuuans redemptos fiduciam socialem, animi, vitae restituere. Per ductum animi, partes simulandas, provocationesque, utentes adiuvat ad vitia superanda, metas restituendas, fiduciamque recuperandam, simulque gradatim motivum internum et fiduciam agendi aedificare."}),r.jsx("p",{children:"Censemus omnes redemptos dignos esse honore et recognitione nova. Etiamsi peccaveris, hic non amplius notaberis."}),r.jsx("h2",{children:"2. Identitas et Regulae Usoris"}),r.jsx("p",{children:"Haec suggestum recipit eos qui poenam egerunt, abusus vicerunt, correctionem acceperunt, tutela iudiciali fruuntur, vexationem passi sunt, aut ob exclusionem socialem iterum incipere cupiunt."}),r.jsx("p",{children:"Ad salutem et fidem communitatis tuendam, haec acta stricte vetantur:"}),r.jsxs("ul",{children:[r.jsx("li",{children:"Personae alienae simulationem aut falsam informationem praebere"}),r.jsx("li",{children:"Odium, discriminationem, violentiam, pornographiam, contenta illicita disseminare"}),r.jsx("li",{children:"Imagines iura aliorum vel data sensitiva violantes onerare"})]}),r.jsx("p",{children:"Qui haec violaverint, suggestum statim rationem et usum intercludere potest."}),r.jsx("h2",{children:"3. Usus AI et Declaratio Responsabilitatis"}),r.jsx("p",{children:"Colloquia, consilia, simulationesque AI a suggesto praebita tantum ad comitatum, exercitationem, progressionemque personalem spectant, non ad consilium legale, medicum, psychologicumque."}),r.jsxs("ul",{children:[r.jsx("li",{children:"Suggestum non tenetur de decisionibus ex AI ortis"}),r.jsx("li",{children:"Non praestat colloquia AI semper recta aut实实在在congruentia esse"}),r.jsx("li",{children:"Ne dissemines colloquia AI ut informationem publicam"})]}),r.jsx("p",{children:"Filtra periculorum et restrictiones sermonum posuimus, sed AI adhuc praeiudicium aut errorem gignere potest."}),r.jsx("p",{children:"Si quid incommodum inveneris, per mechanismum referendi nos certiorem facias; modelum continue emendabimus."}),r.jsx("h3",{children:"3.1 Praecepta Usus Colloquiorum AI"}),r.jsxs("ul",{children:[r.jsx("li",{children:"Ne quaeras aut inseras informationes privatas aliorum (ut domicilium, delicta)"}),r.jsx("li",{children:"Ne AI adhibeas ad violentiam, sui laesionem, aut actus illicitos simulandos"}),r.jsx("li",{children:"Ne dissemines falsa aut fraudulenta sub nomine Restarter™"}),r.jsx("li",{children:"Omnia colloquia ad optimizationem anonymam tantum, non ad tracking personalem"}),r.jsx("li",{children:"Suggestum, si opus sit, cum auctoritatibus legalibus cooperabitur"}),r.jsx("li",{children:"Usoribus minoribus XVIII annis consensus parentum requiritur"}),r.jsx("li",{children:"Automata aut systemata non auctorata vetantur"}),r.jsx("li",{children:"Usor ipse de periculis legalibus contentorum suorum respondet"})]}),r.jsx("h2",{children:"4. Processus Datae et Declaratio Privacy"}),r.jsx("p",{children:"Suggestum tantum colligit notitias adnotationis fundamentales, ut cognomen, email, linguam praeoptatam."}),r.jsx("p",{children:"Omnia data cryptate servantur nec tertiis partibus venduntur nec ad mercaturam adhibentur."}),r.jsx("p",{children:"Usor rationem suam et omnia data delere potest quovis tempore"}),r.jsx("h2",{children:"5. Ius Suspensionis et Terminationis Rationis"}),r.jsx("p",{children:"Suggestum ius habet rationem usoris qui haec violat statim sine praevia notitia suspendere"}),r.jsx("p",{children:"Si ratio diu non utatur, suggestum admonitionem mittet et ius suspensionis retinebit"}),r.jsx("p",{children:"Usor rationem suam et omnia data delere potest quovis tempore"}),r.jsx("h2",{children:"6. Emendationes et Interpretatio Finalis"}),r.jsx("p",{children:"Suggestum ius habet haec emendandi pro legibus, consiliis, et optimizatione servitii"}),r.jsx("p",{children:"Mutationes maximi momenti per systema et email nuntiabuntur"}),r.jsx("p",{children:"Ius interpretationis finalis harum condicionum Restarter™ suggestui reservatur"})]})},PB={"zh-TW":"返回","zh-CN":"返回",en:"Back",ja:"戻る",ko:"뒤로",th:"กลับ",vi:"Quay lại",ms:"Kembali",la:"Revertere"};function FB(){const[n,e]=g.useState(localStorage.getItem("lang")||"zh-TW"),t=$e();return g.useEffect(()=>{const i=()=>e(localStorage.getItem("lang")||"zh-TW");return window.addEventListener("storage",i),()=>window.removeEventListener("storage",i)},[]),g.useEffect(()=>{const i=setInterval(()=>{const s=localStorage.getItem("lang")||"zh-TW";s!==n&&e(s)},300);return()=>clearInterval(i)},[n]),r.jsxs("div",{style:{minHeight:"100vh",background:"#111827",color:"white",padding:"2rem",display:"flex",flexDirection:"column"},children:[r.jsxs("button",{onClick:()=>t("/",{replace:!0}),style:{position:"absolute",top:32,left:36,zIndex:10,backgroundColor:"#374151",color:"white",fontWeight:"bold",padding:"0.5rem 1rem",borderRadius:"0.375rem",border:"none",cursor:"pointer",fontSize:16},children:["← ",PB[n]||"返回"]}),r.jsx("div",{style:{flex:"1 0 auto"},children:r.jsxs("div",{style:{maxWidth:800,margin:"0 auto",background:"#fff",color:"#111",borderRadius:16,padding:32,position:"relative"},children:[BB[n],r.jsx("div",{style:{textAlign:"center",marginTop:48,color:"#888",fontSize:16},children:"CTX Goodlife Copyright 2025"})]})}),r.jsx("div",{style:{width:"100%",margin:"0 auto",marginTop:24,background:"rgba(255,255,255,0.95)",borderRadius:16,padding:"16px",boxShadow:"0 2px 12px #6B5BFF22"},children:r.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:20,flexWrap:"wrap"},children:[r.jsx("span",{onClick:()=>t("/privacy-policy"),style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12,cursor:"pointer"},children:"隱私權政策"}),r.jsx("span",{onClick:()=>t("/terms"),style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12,cursor:"pointer"},children:"條款/聲明"}),r.jsx("span",{onClick:()=>t("/data-deletion"),style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12,cursor:"pointer"},children:"資料刪除說明"}),r.jsx("span",{onClick:()=>t("/about"),style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12,cursor:"pointer"},children:"🧬 Restarter™｜我們是誰"}),r.jsx("span",{onClick:()=>t("/feedback"),style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12,cursor:"pointer"},children:"💬 意見箱｜我們想聽你說"})]})})]})}const sk=g.createContext(void 0),zB=({children:n})=>{const[e,t]=g.useState(!1);return r.jsx(sk.Provider,{value:{isMicOn:e,setMicOn:t},children:n})},ok=()=>{const n=g.useContext(sk);if(n===void 0)throw new Error("useMicStatus must be used within a MicStatusProvider");return n};function DB({onSpeechStart:n,onSpeechEnd:e,silenceThreshold:t=1e3,fftSize:i=256,minDecibels:s=-70}){const{setMicOn:o}=ok(),[a,l]=g.useState(!1),[c,u]=g.useState(!1),h=g.useRef(null),p=g.useRef(null),f=g.useRef(null),b=g.useRef(null),x=g.useRef([]),S=g.useCallback(()=>{h.current&&h.current.state==="recording"&&h.current.stop(),p.current&&p.current.state!=="closed"&&p.current.close(),b.current&&clearTimeout(b.current),f.current=null,u(!1),l(!1),o(!1)},[o]),w=g.useCallback(()=>{if(!f.current)return;const j=new Uint8Array(f.current.frequencyBinCount);f.current.getByteFrequencyData(j);const O=j.reduce((P,B)=>P+B,0)/j.length>5;O&&!a?(l(!0),b.current&&clearTimeout(b.current)):!O&&a&&(b.current||(b.current=setTimeout(()=>{l(!1),S()},t))),c&&requestAnimationFrame(w)},[a,c,t,S]),I=g.useCallback(async()=>{if(!c)try{const j=await navigator.mediaDevices.getUserMedia({audio:!0});p.current=new AudioContext,f.current=p.current.createAnalyser(),f.current.fftSize=i,f.current.minDecibels=s,p.current.createMediaStreamSource(j).connect(f.current),h.current=new MediaRecorder(j),x.current=[],h.current.ondataavailable=D=>{x.current.push(D.data)},h.current.onstart=()=>{o(!0),n==null||n(),requestAnimationFrame(w)},h.current.onstop=()=>{o(!1);const D=new Blob(x.current,{type:"audio/webm"});D.size>0&&(e==null||e(D)),j.getTracks().forEach(O=>O.stop())},h.current.start(),u(!0)}catch(j){console.error("Error starting VAD:",j),o(!1)}},[c,n,e,w,i,s,o]);return{isSpeaking:a,isListening:c,startListening:I,stopListening:S}}const yy={"zh-TW":{start:"開始說話",stop:"停止",noPermission:"需要訂閱才能使用語音功能"},"zh-CN":{start:"开始说话",stop:"停止",noPermission:"需要订阅才能使用语音功能"},en:{start:"Start talking",stop:"Stop",noPermission:"Subscription required for voice features"},ja:{start:"話し始める",stop:"停止",noPermission:"音声機能にはサブスクリプションが必要です"},ko:{start:"말하기 시작",stop:"정지",noPermission:"음성 기능을 사용하려면 구독이 필요합니다"},th:{start:"เริ่มพูด",stop:"หยุด",noPermission:"ต้องสมัครสมาชิกเพื่อใช้ฟีเจอร์เสียง"},vi:{start:"Bắt đầu nói",stop:"Dừng lại",noPermission:"Cần đăng ký để sử dụng tính năng giọng nói"},ms:{start:"Mula bercakap",stop:"Berhenti",noPermission:"Langganan diperlukan untuk ciri suara"},la:{start:"Incipe loqui",stop:"Desine",noPermission:"Subscriptio requiritur pro vocis functionibus"}};function NB({onAudio:n,lang:e}){const{isListening:t,startListening:i,stopListening:s}=DB({onSpeechEnd:I=>{n(I)}}),{lang:o}=Qe?Qe():{lang:void 0},a=e||o||localStorage.getItem("lang")||"zh-TW",l=yy[a]||yy["zh-TW"],{checkPermission:c,recordUsage:u}=mo(),[h,p]=g.useState(!1),[f,b]=g.useState(null),{isTestMode:x}=ji(),S=async()=>{if(t){s();return}const I=await c("aiChat");if(!I.allowed){if(x)return;I.canRenew,b(I),p(!0);return}i(),await u("aiChat",1)},w=()=>{p(!1),b(null)};return r.jsxs(r.Fragment,{children:[r.jsxs("div",{children:[r.jsx("button",{onClick:S,style:{width:56,height:56,borderRadius:"50%",background:"#ff9800",border:"none",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:t?"0 0 0 4px #ffe0b2":"0 2px 8px #0002",cursor:"pointer",outline:"none",position:"relative",zIndex:20},"aria-label":t?l.stop:l.start,children:r.jsx("span",{style:{fontSize:36,color:"#fff",filter:t?"drop-shadow(0 0 6px #ff9800)":""},children:"🎤"})}),r.jsx("div",{style:{textAlign:"center",fontSize:14,color:"#ff9800",marginTop:4,fontWeight:700},children:t?l.stop:l.start})]}),h&&f&&r.jsx(es,{isOpen:h,onClose:w,currentPlan:f.currentPlan,remainingDays:f.remainingDays,usedTokens:f.usedTokens,totalTokens:f.totalTokens})]})}const Zd={backToScenarios:{"zh-TW":"← 返回情境列表","zh-CN":"← 返回情境列表",ja:"← シナリオ一覧へ戻る",en:"← Back to Scenarios",ko:"← 시나리오 목록으로",th:"← กลับไปที่รายการสถานการณ์",vi:"← Quay lại danh sách kịch bản",ms:"← Kembali ke Senarai Senario",la:"← Ad indicem scaenariorum redire"},yourTurn:{"zh-TW":"換你說了","zh-CN":"换你说了",ja:"あなたの番です",en:"Your turn",ko:"당신 차례입니다",th:"ตาคุณแล้ว",vi:"Đến lượt bạn",ms:"Giliran anda",la:"Tua vice est"},send:{"zh-TW":"傳送","zh-CN":"发送",ja:"送信",en:"Send",ko:"보내기",th:"ส่ง",vi:"Gửi",ms:"Hantar",la:"Mitte"}},xy={category:{"zh-TW":"分類","zh-CN":"分类",en:"Category",ja:"カテゴリ",ko:"분류",th:"หมวดหมู่",vi:"Phân loại",ms:"Kategori",la:"Categoria"},difficulty:{"zh-TW":"難度","zh-CN":"难度",en:"Difficulty",ja:"難易度",ko:"난이도",th:"ความยาก",vi:"Độ khó",ms:"Kesukaran",la:"Difficultas"}},MB={hard:{"zh-TW":"困難","zh-CN":"困难",en:"Hard",ja:"難しい",ko:"어려움",th:"ยาก",vi:"Khó",ms:"Sukar",la:"Difficile"},medium:{"zh-TW":"中等","zh-CN":"中等",en:"Medium",ja:"普通",ko:"보통",th:"ปานกลาง",vi:"Trung bình",ms:"Sederhana",la:"Mediocris"},easy:{"zh-TW":"簡單","zh-CN":"简单",en:"Easy",ja:"簡単",ko:"쉬움",th:"ง่าย",vi:"Dễ",ms:"Mudah",la:"Facilis"}};function WB(n,e,t){const i=n.find(s=>s.id===e);return i?i.translations&&i.translations[t]?{...i,...i.translations[t]}:i:null}function by(){var v,z;const n=$e(),{scenarioId:e}=g1(),t=e||"",i=Je(),s=localStorage.getItem("lang")||"zh-TW",[o,a]=g.useState(null),[l,c]=g.useState([]),[u,h]=g.useState(""),[p,f]=g.useState(!0),b=g.useRef(null),[x,S]=g.useState(""),w=H=>{S(H),setTimeout(()=>S(""),1800)},{checkPermission:I}=mo(),[j,A]=g.useState(!1),[D,O]=g.useState(null),{isTestMode:P}=ji();function B(H){return!(!H||H.trim().length<12)}g.useEffect(()=>{e&&(async()=>{f(!0),console.log("[useEffect] fetchScenarioDetails start, isLoading:",!0);try{const L=await fetch(`/locales/${s}/scenarios.json`);if(!L.ok)throw new Error("Failed to fetch scenarios");const ee=await L.json(),ge=WB(ee,t,s);ge?(a(ge),c([{sender:"ai",text:ge.starting_line||ge.system_prompt||""}]),console.log("[useEffect] scenario loaded:",ge)):(a(null),console.log("[useEffect] scenario not found"))}catch(L){console.error("[useEffect] Error fetching scenario details:",L),a(null)}finally{f(!1),console.log("[useEffect] fetchScenarioDetails end, isLoading:",!1)}})()},[e,s]);const k=async(H,L,ee={})=>{console.log("[callApi] url:",H,"body:",L);const ge=await fetch(H,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(L),...ee});if(!ge.ok)throw new Error("API call failed");return ge},T=async H=>{f(!0),console.log("[handleAudio] isLoading:",!0);try{const L=i.currentUser;if(!L){w("請先登入");return}const ee=await I("aiChat");if(!ee.allowed){if(P)return;ee.canRenew,O(ee),A(!0);return}const ge=new FormData;ge.append("audio",H,"audio.webm"),ge.append("userId",L.uid);const oe=await fetch("/api/whisper",{method:"POST",body:ge});if(!oe.ok){const te=await oe.text();throw new Error(`Whisper API failed: ${te}`)}const Ie=await oe.json(),Re=Ie.transcript||Ie.text||"";Re&&(h(Re),setTimeout(()=>{R()},300))}catch(L){console.error("Error with audio processing:",L)}finally{f(!1),console.log("[handleAudio] end, isLoading:",!1)}},R=async()=>{if(!u.trim()){w("請先輸入內容再送出");return}if(!B(u)){w("請輸入至少12個字訓練表達能力");return}if(!i.currentUser){w("請先登入");return}const L=await I("aiChat");if(!L.allowed){if(P)return;L.canRenew?(O(L),A(!0)):w("需要訂閱才能使用 AI 聊天功能");return}const ee=u;c(ge=>{const oe=[...ge,{sender:"user",text:ee}];return E(oe),oe}),h("")},E=async H=>{f(!0),console.log("[getAIResponse] called, currentMessages:",H);try{const L=H.filter(Y=>Y&&Y.text&&Y.text.trim()).map(Y=>({sender:Y.sender,text:Y.text.trim()})),ee=o?{system_prompt:o.system_prompt||"",title:o.title||"",description:o.description||""}:{},ge=i.currentUser,Ie=await(await k("/api/gpt",{messages:L,...ee,userId:ge==null?void 0:ge.uid})).json(),Re=Ie.reply||Ie.message||"AI 無回應";c(Y=>[...Y,{sender:"ai",text:Re}]),console.log("[getAIResponse] AI message:",Re);const W=await(await k("/api/tts",{text:Re},{responseType:"blob"})).blob();b.current&&(b.current.src=URL.createObjectURL(W),b.current.play())}catch(L){console.error("[getAIResponse] Error getting AI response:",L),c(ee=>[...ee,{sender:"ai",text:"抱歉，我現在遇到一些問題，請稍後再試。"}])}finally{f(!1),console.log("[getAIResponse] end, isLoading:",!1)}};if(!o)return r.jsxs("div",{style:{textAlign:"center",marginTop:80},children:[r.jsx("div",{style:{fontSize:22,marginBottom:16},children:"⚠️ Scenario not found."}),r.jsx("button",{onClick:()=>n("/skillbox"),style:{padding:"10px 28px",borderRadius:8,background:"#6B5BFF",color:"#fff",fontWeight:700,fontSize:16,border:"none",cursor:"pointer"},children:"Go back"})]});const _=()=>{A(!1),O(null)};return r.jsxs("div",{className:"modern-bg",style:{background:"url('/senario.png') center center / cover no-repeat fixed",minHeight:"100vh",width:"100vw",overflow:"hidden",position:"relative"},children:[r.jsx("audio",{ref:b,hidden:!0}),r.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,zIndex:200,display:"flex",justifyContent:"flex-start",alignItems:"center",padding:"18px 32px 0 32px",background:"transparent",width:"100vw",pointerEvents:"auto"},children:r.jsx("button",{className:"topbar-btn",onClick:()=>n("/skillbox"),style:{fontWeight:700,fontSize:18,padding:"6px 16px",borderRadius:8,border:"1.5px solid #6B5BFF",background:"#fff",color:"#6B5BFF",cursor:"pointer"},children:Zd.backToScenarios[s]})}),r.jsxs("div",{style:{width:"100%",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",marginTop:80,overflowY:"auto",maxHeight:"calc(100vh - 80px)",padding:"24px"},children:[r.jsxs("div",{style:{width:"100%",maxWidth:700,background:"rgba(255,255,255,0.97)",borderRadius:16,padding:"32px 32px 18px 32px",boxShadow:"0 4px 24px #0002",display:"flex",flexDirection:"column",alignItems:"center",marginBottom:0,position:"relative"},children:[r.jsx("div",{style:{fontSize:54,marginBottom:8},children:o.emoji}),r.jsx("h2",{style:{color:"#6B5BFF",fontWeight:900,fontSize:28,marginBottom:24,textAlign:"center"},children:o.title}),r.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:12,marginBottom:8},children:[r.jsxs("span",{style:{fontWeight:600,fontSize:14,padding:"4px 12px",borderRadius:16,background:"#6B5BFF22",color:"#6B5BFF"},children:[xy.category[s],": ",o.category]}),r.jsxs("span",{style:{fontWeight:600,fontSize:14,padding:"4px 12px",borderRadius:16,background:"#23c6e622",color:"#23c6e6"},children:[xy.difficulty[s],": ",((v=MB[o.difficulty])==null?void 0:v[s])||o.difficulty]})]}),r.jsx("p",{style:{fontSize:16,color:"#4A4A4A",textAlign:"center",margin:"0 0 8px 0",lineHeight:1.6},children:o.description}),r.jsx("div",{style:{display:"flex",flexWrap:"wrap",justifyContent:"center",gap:8,marginBottom:16},children:(z=o.tags)==null?void 0:z.map(H=>r.jsx("span",{style:{fontSize:13,background:"#f7f7ff",color:"#6B5BFF",borderRadius:12,padding:"2px 10px"},children:H},H))})]}),r.jsxs("div",{style:{width:"100%",maxWidth:700,background:"rgba(255,255,255,0.93)",borderRadius:16,padding:"18px 32px 24px 32px",boxShadow:"0 4px 24px #0002",display:"flex",flexDirection:"column",marginTop:0},children:[r.jsx("div",{style:{minHeight:"32vh",maxHeight:"44vh",overflowY:"auto",background:"#f6f7fa",borderRadius:12,padding:16,marginBottom:24,display:"flex",flexDirection:"column",gap:"12px",boxShadow:"0 2px 8px #6B5BFF11"},children:l.map((H,L)=>r.jsx("div",{style:{alignSelf:H.sender==="user"?"flex-end":"flex-start",maxWidth:"75%"},children:r.jsx("div",{style:{background:H.sender==="user"?"linear-gradient(135deg, #6B5BFF 60%, #23c6e6 100%)":"#fff",color:H.sender==="user"?"#fff":"#4A4A4A",padding:"10px 16px",borderRadius:"18px",boxShadow:"0 2px 4px rgba(0,0,0,0.08)"},children:H.text})},L))}),r.jsxs("div",{style:{display:"flex",gap:"12px",alignItems:"center",position:"relative"},children:[r.jsx("div",{style:{marginRight:0},children:r.jsx(NB,{onAudio:T,lang:s})}),r.jsx("input",{type:"text",value:u,onChange:H=>h(H.target.value),placeholder:p?"AI正在思考...":Zd.yourTurn[s],disabled:p,style:{flex:1,padding:"12px 16px",borderRadius:12,border:"2px solid #ddd",fontSize:16,outline:"none",background:p?"#f0f0f0":"#fff"},onKeyDown:H=>H.key==="Enter"&&R()}),r.jsx("button",{onClick:R,disabled:p,style:{padding:"12px 24px",borderRadius:12,background:p?"#ccc":"#6B5BFF",color:"#fff",border:"none",fontWeight:700,fontSize:16,cursor:p?"not-allowed":"pointer"},children:p?"...":Zd.send[s]}),p&&r.jsx("div",{style:{position:"absolute",right:-36,top:"50%",transform:"translateY(-50%)"},children:r.jsx("span",{className:"loader",style:{display:"inline-block",width:24,height:24,border:"3px solid #6B5BFF",borderTop:"3px solid #fff",borderRadius:"50%",animation:"spin 1s linear infinite"}})})]}),u&&!B(u)&&r.jsx("div",{style:{color:"#ff9800",fontSize:15,marginTop:6,fontWeight:600},children:"請輸入至少12個字訓練表達能力"})]})]}),x&&r.jsx("div",{style:{position:"fixed",top:32,left:"50%",transform:"translateX(-50%)",background:"#ff9800",color:"#fff",padding:"12px 32px",borderRadius:16,fontWeight:700,fontSize:18,zIndex:9999,boxShadow:"0 2px 12px #0002"},children:x}),r.jsx("style",{children:"@keyframes spin { 0% { transform: rotate(0deg);} 100% { transform: rotate(360deg);} }"}),j&&D&&r.jsx(es,{isOpen:j,onClose:_,currentPlan:D.currentPlan,remainingDays:D.remainingDays,usedTokens:D.usedTokens,totalTokens:D.totalTokens})]})}const LB=(n,e,t,i)=>{var o,a,l,c;const s=[t,{code:e,...i||{}}];if((a=(o=n==null?void 0:n.services)==null?void 0:o.logger)!=null&&a.forward)return n.services.logger.forward(s,"warn","react-i18next::",!0);Pr(s[0])&&(s[0]=`react-i18next:: ${s[0]}`),(c=(l=n==null?void 0:n.services)==null?void 0:l.logger)!=null&&c.warn?n.services.logger.warn(...s):console!=null&&console.warn&&console.warn(...s)},vy={},Ju=(n,e,t,i)=>{Pr(t)&&vy[t]||(Pr(t)&&(vy[t]=new Date),LB(n,e,t,i))},ak=(n,e)=>()=>{if(n.isInitialized)e();else{const t=()=>{setTimeout(()=>{n.off("initialized",t)},0),e()};n.on("initialized",t)}},Zu=(n,e,t)=>{n.loadNamespaces(e,ak(n,t))},wy=(n,e,t,i)=>{if(Pr(t)&&(t=[t]),n.options.preload&&n.options.preload.indexOf(e)>-1)return Zu(n,t,i);t.forEach(s=>{n.options.ns.indexOf(s)<0&&n.options.ns.push(s)}),n.loadLanguages(e,ak(n,i))},OB=(n,e,t={})=>!e.languages||!e.languages.length?(Ju(e,"NO_LANGUAGES","i18n.languages were undefined or empty",{languages:e.languages}),!0):e.hasLoadedNamespace(n,{lng:t.lng,precheck:(i,s)=>{var o;if(((o=t.bindI18n)==null?void 0:o.indexOf("languageChanging"))>-1&&i.services.backendConnector.backend&&i.isLanguageChangingTo&&!s(i.isLanguageChangingTo,n))return!1}}),Pr=n=>typeof n=="string",VB=n=>typeof n=="object"&&n!==null,qB=/&(?:amp|#38|lt|#60|gt|#62|apos|#39|quot|#34|nbsp|#160|copy|#169|reg|#174|hellip|#8230|#x2F|#47);/g,UB={"&amp;":"&","&#38;":"&","&lt;":"<","&#60;":"<","&gt;":">","&#62;":">","&apos;":"'","&#39;":"'","&quot;":'"',"&#34;":'"',"&nbsp;":" ","&#160;":" ","&copy;":"©","&#169;":"©","&reg;":"®","&#174;":"®","&hellip;":"…","&#8230;":"…","&#x2F;":"/","&#47;":"/"},HB=n=>UB[n],$B=n=>n.replace(qB,HB);let GB={bindI18n:"languageChanged",bindI18nStore:"",transEmptyNodeValue:"",transSupportBasicHtmlNodes:!0,transWrapTextNodes:"",transKeepBasicHtmlNodesFor:["br","strong","i","p"],useSuspense:!0,unescape:$B};const KB=()=>GB;let QB;const YB=()=>QB,XB=g.createContext();class JB{constructor(){this.usedNamespaces={}}addUsedNamespaces(e){e.forEach(t=>{this.usedNamespaces[t]||(this.usedNamespaces[t]=!0)})}getUsedNamespaces(){return Object.keys(this.usedNamespaces)}}const ZB=(n,e)=>{const t=g.useRef();return g.useEffect(()=>{t.current=n},[n,e]),t.current},lk=(n,e,t,i)=>n.getFixedT(e,t,i),e5=(n,e,t,i)=>g.useCallback(lk(n,e,t,i),[n,e,t,i]),t5=(n,e={})=>{var D,O,P,B;const{i18n:t}=e,{i18n:i,defaultNS:s}=g.useContext(XB)||{},o=t||i||YB();if(o&&!o.reportNamespaces&&(o.reportNamespaces=new JB),!o){Ju(o,"NO_I18NEXT_INSTANCE","useTranslation: You will need to pass in an i18next instance by using initReactI18next");const k=(R,E)=>Pr(E)?E:VB(E)&&Pr(E.defaultValue)?E.defaultValue:Array.isArray(R)?R[R.length-1]:R,T=[k,{},!1];return T.t=k,T.i18n={},T.ready=!1,T}(D=o.options.react)!=null&&D.wait&&Ju(o,"DEPRECATED_OPTION","useTranslation: It seems you are still using the old wait option, you may migrate to the new useSuspense behaviour.");const a={...KB(),...o.options.react,...e},{useSuspense:l,keyPrefix:c}=a;let u=s||((O=o.options)==null?void 0:O.defaultNS);u=Pr(u)?[u]:u||["translation"],(B=(P=o.reportNamespaces).addUsedNamespaces)==null||B.call(P,u);const h=(o.isInitialized||o.initializedStoreOnce)&&u.every(k=>OB(k,o,a)),p=e5(o,e.lng||null,a.nsMode==="fallback"?u:u[0],c),f=()=>p,b=()=>lk(o,e.lng||null,a.nsMode==="fallback"?u:u[0],c),[x,S]=g.useState(f);let w=u.join();e.lng&&(w=`${e.lng}${w}`);const I=ZB(w),j=g.useRef(!0);g.useEffect(()=>{const{bindI18n:k,bindI18nStore:T}=a;j.current=!0,!h&&!l&&(e.lng?wy(o,e.lng,u,()=>{j.current&&S(b)}):Zu(o,u,()=>{j.current&&S(b)})),h&&I&&I!==w&&j.current&&S(b);const R=()=>{j.current&&S(b)};return k&&(o==null||o.on(k,R)),T&&(o==null||o.store.on(T,R)),()=>{j.current=!1,o&&(k==null||k.split(" ").forEach(E=>o.off(E,R))),T&&o&&T.split(" ").forEach(E=>o.store.off(E,R))}},[o,w]),g.useEffect(()=>{j.current&&h&&S(f)},[o,c,h]);const A=[x,o,h];if(A.t=x,A.i18n=o,A.ready=h,h||!h&&!l)return A;throw new Promise(k=>{e.lng?wy(o,e.lng,u,()=>k()):Zu(o,u,()=>k())})},n5={"zh-TW":{male:"男",female:"女",other:"其他"},"zh-CN":{male:"男",female:"女",other:"其他"},en:{male:"Male",female:"Female",other:"Other"},ja:{male:"男性",female:"女性",other:"その他"},ko:{male:"남성",female:"여성",other:"기타"},th:{male:"ชาย",female:"หญิง",other:"อื่นๆ"},vi:{male:"Nam",female:"Nữ",other:"Khác"},ms:{male:"Lelaki",female:"Perempuan",other:"Lain-lain"},la:{male:"Mas",female:"Femina",other:"Aliud"}},i5={"zh-TW":"歲","zh-CN":"岁",en:"y/o",ja:"歳",ko:"세",th:"ปี",vi:"tuổi",ms:"tahun",la:"annos"},ii={"zh-TW":{nickname:"暱稱",gender:"性別",age:"年齡",country:"國家/地區",interest:"興趣",eventType:"事件類型",improvement:"想改善",email:"Email",bio:"簡介"},"zh-CN":{nickname:"昵称",gender:"性别",age:"年龄",country:"国家/地区",interest:"兴趣",eventType:"事件类型",improvement:"想改善",email:"邮箱",bio:"简介"},en:{nickname:"Nickname",gender:"Gender",age:"Age",country:"Country/Region",interest:"Interest",eventType:"Event Type",improvement:"To Improve",email:"Email",bio:"Bio"},ja:{nickname:"ニックネーム",gender:"性別",age:"年齢",country:"国/地域",interest:"興味",eventType:"イベントタイプ",improvement:"改善したいこと",email:"メール",bio:"自己紹介"},ko:{nickname:"닉네임",gender:"성별",age:"나이",country:"국가/지역",interest:"관심사",eventType:"이벤트 유형",improvement:"개선하고 싶은 점",email:"이메일",bio:"소개"},th:{nickname:"ชื่อเล่น",gender:"เพศ",age:"อายุ",country:"ประเทศ/ภูมิภาค",interest:"ความสนใจ",eventType:"ประเภทเหตุการณ์",improvement:"สิ่งที่อยากปรับปรุง",email:"อีเมล",bio:"แนะนำตัว"},vi:{nickname:"Biệt danh",gender:"Giới tính",age:"Tuổi",country:"Quốc gia/Khu vực",interest:"Sở thích",eventType:"Loại sự kiện",improvement:"Điều muốn cải thiện",email:"Email",bio:"Giới thiệu"},ms:{nickname:"Nama panggilan",gender:"Jantina",age:"Umur",country:"Negara/Wilayah",interest:"Minat",eventType:"Jenis Acara",improvement:"Perkara untuk Diperbaiki",email:"Email",bio:"Pengenalan"},la:{nickname:"Cognomen",gender:"Sexus",age:"Aetas",country:"Patria/Regio",interest:"Studium",eventType:"Genus Eventus",improvement:"Emendare",email:"Email",bio:"Introductio"}},ky=({profile:n,variant:e="compact",showAvatar:t=!0,className:i="",style:s={}})=>{var u;const{lang:o}=Qe(),a=n.avatar||n.avatarUrl||"/avatars/Derxl.png",l=n.gender?((u=n5[o])==null?void 0:u[n.gender])||n.gender:"",c=i5[o];return e==="compact"?r.jsxs("div",{className:`user-profile-compact ${i}`,style:{display:"flex",alignItems:"center",gap:12,marginBottom:2,...s},children:[t&&r.jsx("img",{src:a,alt:"avatar",style:{width:36,height:36,borderRadius:"50%",objectFit:"cover",border:"2px solid #ececff"}}),r.jsx("span",{style:{fontWeight:600},children:n.nickname||"-"}),r.jsxs("span",{children:[n.age||"-",c]}),r.jsx("span",{children:l}),r.jsxs("span",{children:[n.country||"-",n.region?`/${n.region}`:""]})]}):r.jsxs("div",{className:`user-profile-detailed ${i}`,style:{marginTop:10,fontSize:14,color:"#6B5BFF",fontWeight:500,background:"#f7f8fc",borderRadius:8,padding:"8px 12px",...s},children:[t&&r.jsx("div",{style:{textAlign:"center",marginBottom:8},children:r.jsx("img",{src:a,alt:"avatar",style:{width:48,height:48,borderRadius:"50%",objectFit:"cover",border:"2px solid #6B5BFF"}})}),r.jsxs("div",{children:[ii[o].nickname,"：",n.nickname||"-"]}),r.jsxs("div",{children:[ii[o].gender,"：",l]}),r.jsxs("div",{children:[ii[o].age,"：",n.age||"-",c]}),r.jsxs("div",{children:[ii[o].country,"：",n.country||"-"," ",n.region||""]}),r.jsxs("div",{children:[ii[o].interest,"：",n.interest||"-"]}),r.jsxs("div",{children:[ii[o].eventType,"：",n.eventType||"-"]}),n.improvement&&r.jsxs("div",{children:[ii[o].improvement,"：",n.improvement]}),n.email&&r.jsxs("div",{children:[ii[o].email,"：",n.email]}),n.bio&&r.jsxs("div",{children:[ii[o].bio,"：",n.bio]})]})},je={pageTitle:{"zh-TW":"故事鏈ReStoryChain™","zh-CN":"故事链ReStoryChain™",en:"ReStoryChain™",ja:"ストーリーチェーンReStoryChain™",ko:"스토리체인ReStoryChain™",th:"ReStoryChain™",vi:"ReStoryChain™",ms:"ReStoryChain™",la:"ReStoryChain™"},encouragement:{"zh-TW":"AI鼓勵語","zh-CN":"AI鼓励语",en:"AI Encouragement",ja:"AI励まし",ko:"AI 격려",th:"AI ให้กำลังใจ",vi:"AI động viên",ms:"AI Galakan",la:"AI Hortatio"},back:{"zh-TW":"返回","zh-CN":"返回",en:"Back",ja:"戻る",ko:"돌아가기",th:"กลับ",vi:"Quay lại",ms:"Kembali",la:"Redire"},logout:{"zh-TW":"登出","zh-CN":"登出",en:"Logout",ja:"ログアウト",ko:"로그아웃",th:"ออกจากระบบ",vi:"Đăng xuất",ms:"Log keluar",la:"Exire"},titlePlaceholder:{"zh-TW":"請輸入標題(限30字)","zh-CN":"请输入标题(限30字)",en:"Enter title (max 30 chars)",ja:"タイトルを入力（30文字以内）",ko:"제목을 입력하세요(30자 이내)",th:"กรอกชื่อเรื่อง (สูงสุด 30 ตัวอักษร)",vi:"Nhập tiêu đề (tối đa 30 ký tự)",ms:"Masukkan tajuk (maks 30 aksara)",la:"Titulum insere (max 30 litterae)"},contentPlaceholder:{"zh-TW":"請輸入內容(限500字)","zh-CN":"请输入内容(限500字)",en:"Enter content (max 500 chars)",ja:"内容を入力（500文字以内）",ko:"내용을 입력하세요(500자 이내)",th:"กรอกเนื้อหา (สูงสุด 500 ตัวอักษร)",vi:"Nhập nội dung (tối đa 500 ký tự)",ms:"Masukkan kandungan (maks 500 aksara)",la:"Contentum insere (max 500 litterae)"},formTitle:{"zh-TW":"分享你的故事","zh-CN":"分享你的故事",en:"Share Your Story",ja:"ストーリーを共有",ko:"이야기 공유",th:"แบ่งปันเรื่องราวของคุณ",vi:"Chia sẻ câu chuyện của bạn",ms:"Kongsi Cerita Anda",la:"Communica Fabulas Tuas"},formSubmit:{"zh-TW":"送出","zh-CN":"提交",en:"Post",ja:"投稿",ko:"게시",th:"โพสต์",vi:"Đăng",ms:"Hantar",la:"Submittere"},encouragementDefault:{"zh-TW":"繼續前進！你的故事很重要。","zh-CN":"继续前进！你的故事很重要。",en:"Keep going! Your story matters.",ja:"前に進もう！あなたのストーリーは大切です。",ko:"계속 나아가세요! 당신의 이야기는 소중합니다.",th:"เดินหน้าต่อไป! เรื่องราวของคุณสำคัญ",vi:"Tiếp tục nhé! Câu chuyện của bạn rất ý nghĩa.",ms:"Teruskan! Cerita anda penting.",la:"Perge! Fabula tua magni momenti est."},storyQuoteLine1:{"zh-TW":"有些故事不為了解釋，只是為了放下！","zh-CN":"有些故事不是为了说明，只是为了放下！",en:"Some stories are not for explanation, but for letting go!",ja:"いくつかの物語は説明のためではなく、手放すためのものです！",ko:"어떤 이야기는 설명을 위한 것이 아니라 내려놓기 위한 것입니다!",th:"เรื่องราวบางเรื่องไม่ได้มีไว้เพื่ออธิบาย แต่มีไว้เพื่อปล่อยวาง!",vi:"Có những câu chuyện không phải để giải thích, mà là để buông bỏ!",ms:"Sesetengah cerita bukan untuk dijelaskan, tetapi untuk dilepaskan!",la:"Nonnullae fabulae non ad explicandum, sed ad dimittendum sunt!"},storyQuoteLine2:{"zh-TW":"寫下來，也是一種放過自己... 寫下來，也是一種勇敢。","zh-CN":"写下来，也是放过自己... 写下来，也是勇敢。",en:"Writing it down is also a way to release yourself... Writing it down is also a kind of courage.",ja:"書き出すことは自分を解放する方法でもあり... 書き出すことは勇気でもあります。",ko:"써내려가는 것은 자신을 놓아주는 방법이기도 하고... 써내려가는 것은 용기이기도 합니다.",th:"การเขียนออกมาก็เป็นการปลดปล่อยตัวเอง... การเขียนออกมาก็เป็นความกล้าหาญอย่างหนึ่ง",vi:"Viết ra cũng là một cách tha thứ cho bản thân... Viết ra cũng là một sự dũng cảm.",ms:"Menulisnya adalah satu cara melepaskan diri... Menulisnya adalah satu keberanian.",la:"Scribere est te ipsum dimittere... Scribere est etiam audacia."},storyQuoteLine3:{"zh-TW":"有人願意說出口，就有人不再那麼孤單，分享就是力量。","zh-CN":"有人愿意说出口，就有人不再那么孤单，分享就是力量。",en:"When someone is willing to speak out, someone else is no longer alone. Sharing is power.",ja:"誰かが声に出してくれることで、誰かがもう孤独ではなくなります。シェアすることは力です。",ko:"누군가 말할 용기를 내면, 누군가는 더 이상 외롭지 않습니다. 나눔은 힘입니다.",th:"เมื่อมีใครสักคนกล้าที่จะพูดออกมา ก็จะมีใครสักคนที่ไม่ต้องโดดเดี่ยวอีกต่อไป การแบ่งปันคือพลัง",vi:"Khi ai đó dám nói ra, sẽ có người không còn cô đơn nữa. Chia sẻ là sức mạnh.",ms:"Apabila seseorang sanggup meluahkan, seseorang yang lain tidak lagi keseorangan. Berkongsi adalah kekuatan.",la:"Cum aliquis loqui velit, aliquis non iam solus est. Communicatio est potestas."},blockchainNote:{"zh-TW":"💡 區塊鏈功能正在開發中，目前僅為標記功能，實際封存功能將在未來版本中推出","zh-CN":"💡 区块链功能正在开发中，目前仅为标记功能，实际封存功能将在未来版本中推出",en:"💡 Blockchain feature is under development. Currently only a marker function, actual preservation will be available in future versions",ja:"💡 ブロックチェーン機能は開発中です。現在はマーカー機能のみで、実際の保存機能は将来のバージョンで提供予定です",ko:"💡 블록체인 기능이 개발 중입니다. 현재는 마커 기능만 있으며, 실제 보존 기능은 향후 버전에서 제공될 예정입니다",th:"💡 ฟีเจอร์บล็อกเชนกำลังอยู่ในขั้นตอนการพัฒนา ปัจจุบันเป็นเพียงฟังก์ชันเครื่องหมาย การเก็บรักษาจริงจะพร้อมใช้งานในเวอร์ชันอนาคต",vi:"💡 Tính năng blockchain đang được phát triển. Hiện tại chỉ là chức năng đánh dấu, tính năng lưu trữ thực tế sẽ có trong phiên bản tương lai",ms:"💡 Ciri blockchain sedang dalam pembangunan. Kini hanya fungsi penanda, fungsi pemeliharaan sebenar akan tersedia dalam versi masa hadapan",la:"💡 Blockchain functio in progressu est. Nunc tantum signum functionis, vera conservatio in futuris versionibus praesto erit"},storyPrompt:{"zh-TW":"如果只能留下一個故事，你想從哪裡開始呢？","zh-CN":"如果只能留下一个故事，你想从哪里开始呢？",en:"If you could only leave one story, where would you start?",ja:"もし一つの物語しか残せないとしたら、どこから始めますか？",ko:"만약 하나의 이야기만 남길 수 있다면, 어디서부터 시작하시겠습니까?",th:"หากคุณสามารถทิ้งเรื่องราวไว้เพียงเรื่องเดียว คุณจะเริ่มต้นจากที่ไหน?",vi:"Nếu bạn chỉ có thể để lại một câu chuyện, bạn sẽ bắt đầu từ đâu?",ms:"Jika anda hanya boleh tinggalkan satu cerita, di mana anda akan mula?",la:"Si unam tantum fabulam relinquere posses, unde inciperes?"},partnersStories:{"zh-TW":"夥伴們的分享","zh-CN":"伙伴们的分享",en:"Partners' Stories",ja:"仲間たちのシェア",ko:"파트너들의 이야기",th:"เรื่องราวของเพื่อนๆ",vi:"Chia sẻ của các bạn",ms:"Kisah Rakan-rakan",la:"Communicatio Sociorum"},myStories:{"zh-TW":"我的故事","zh-CN":"我的故事",en:"My Stories",ja:"私のストーリー",ko:"나의 이야기",th:"เรื่องราวของฉัน",vi:"Câu chuyện của tôi",ms:"Cerita Saya",la:"Fabulae Meae"},friendStories:{"zh-TW":"好友故事","zh-CN":"好友故事",en:"Friend Stories",ja:"友達のストーリー",ko:"친구 이야기",th:"เรื่องราวของเพื่อน",vi:"Câu chuyện bạn bè",ms:"Cerita Rakan",la:"Fabulae Amicorum"},noFriends:{"zh-TW":"你還沒有好友連結，快去","zh-CN":"你还没有好友连结，快去",en:"You have no friend connections yet, go to",ja:"まだ友達のつながりがありません。",ko:"아직 친구 연결이 없습니다. 빨리",th:"คุณยังไม่มีการเชื่อมต่อเพื่อน",vi:"Bạn chưa có kết nối bạn bè nào, hãy đến",ms:"Anda masih tiada sambungan rakan, pergi ke",la:"Nondum amicos conexos habes, ad"},goToPairTalk:{"zh-TW":"交友區建立連結吧！","zh-CN":"交友区建立连结吧！",en:"Go to Friend Zone to connect!",ja:"フレンドゾーンでつながろう！",ko:"프렌드존에서 연결하세요!",th:"ไปที่ Friend Zone เพื่อเชื่อมต่อ!",vi:"đến Friend Zone để kết nối!",ms:"ke Friend Zone untuk sambung!",la:"ad Friend Zone coniunge!"},visibilityPrivate:{"zh-TW":"私密","zh-CN":"私密",en:"Private",ja:"非公開",ko:"비공개",th:"ส่วนตัว",vi:"Riêng tư",ms:"Peribadi",la:"Privatus"},visibilityFriends:{"zh-TW":"限好友","zh-CN":"限好友",en:"Friends Only",ja:"友達のみ",ko:"친구만",th:"เฉพาะเพื่อน",vi:"Chỉ bạn bè",ms:"Hanya Rakan",la:"Amicis Tantum"},visibilityPublic:{"zh-TW":"開放分享","zh-CN":"开放分享",en:"Public",ja:"公開",ko:"공개",th:"สาธารณะ",vi:"Công khai",ms:"Umum",la:"Publicus"},profileLabels:{"zh-TW":`暱稱：{nickname}
性別：{gender}
年齡：{age}
國家/地區：{country}
興趣：{interest}
事件類型：{eventType}`,"zh-CN":`昵称：{nickname}
性别：{gender}
年龄：{age}
国家/地区：{country}
兴趣：{interest}
事件类型：{eventType}`,en:`Nickname: {nickname}
Gender: {gender}
Age: {age}
Country/Region: {country}
Interest: {interest}
Event Type: {eventType}`,ja:`ニックネーム：{nickname}
性別：{gender}
年齢：{age}
国/地域：{country}
興味：{interest}
イベントタイプ：{eventType}`,ko:`닉네임: {nickname}
성별: {gender}
나이: {age}
국가/지역: {country}
관심사: {interest}
이벤트 유형: {eventType}`,th:`ชื่อเล่น: {nickname}
เพศ: {gender}
อายุ: {age}
ประเทศ/ภูมิภาค: {country}
ความสนใจ: {interest}
ประเภทเหตุการณ์: {eventType}`,vi:`Biệt danh: {nickname}
Giới tính: {gender}
Tuổi: {age}
Quốc gia/Khu vực: {country}
Sở thích: {interest}
Loại sự kiện: {eventType}`,ms:`Nama panggilan: {nickname}
Jantina: {gender}
Umur: {age}
Negara/Wilayah: {country}
Minat: {interest}
Jenis Acara: {eventType}`,la:`Cognomen: {nickname}
Sexus: {gender}
Aetas: {age}
Patria/Regio: {country}
Studium: {interest}
Genus Eventus: {eventType}`}},eu=["bg-gradient-to-br from-[#7f8fff] to-[#b6b6f6]","bg-gradient-to-br from-[#ffb6b6] to-[#ffd6e0]","bg-gradient-to-br from-[#6be6ff] to-[#b6f6ff]","bg-gradient-to-br from-[#ffe66b] to-[#ffb86b]"];function Sy(n){if(!n||typeof n!="string")return eu[0];let e=0;for(let t=0;t<n.length;t++)e+=n.charCodeAt(t);return eu[e%eu.length]}const ut={"zh-TW":{work_restart:"工作重啟",family_trust:"家庭信任",social_treatment:"社會對待",inner_choice:"內心選擇",misunderstood_and_recovered:"誤解與復原",restart_path:"重啟之路"},"zh-CN":{work_restart:"工作重启",family_trust:"家庭信任",social_treatment:"社会对待",inner_choice:"内心选择",misunderstood_and_recovered:"误解与复原",restart_path:"重启之路"},en:{work_restart:"Work Restart",family_trust:"Family Trust",social_treatment:"Social Treatment",inner_choice:"Inner Choice",misunderstood_and_recovered:"Misunderstood & Recovered",restart_path:"Restart Path"},ja:{work_restart:"仕事の再出発",family_trust:"家族の信頼",social_treatment:"社会の扱い",inner_choice:"内なる選択",misunderstood_and_recovered:"誤解と回復",restart_path:"再出発の道"},ko:{work_restart:"일 재시작",family_trust:"가족의 신뢰",social_treatment:"사회적 대우",inner_choice:"내면의 선택",misunderstood_and_recovered:"오해와 회복",restart_path:"재시작의 길"},th:{work_restart:"เริ่มงานใหม่",family_trust:"ความไว้วางใจในครอบครัว",social_treatment:"การปฏิบัติของสังคม",inner_choice:"ทางเลือกภายในใจ",misunderstood_and_recovered:"ความเข้าใจผิดและการฟื้นฟู",restart_path:"เส้นทางเริ่มต้นใหม่"},vi:{work_restart:"Khởi động lại công việc",family_trust:"Niềm tin gia đình",social_treatment:"Cách đối xử của xã hội",inner_choice:"Lựa chọn nội tâm",misunderstood_and_recovered:"Hiểu lầm và phục hồi",restart_path:"Con đường làm lại"},ms:{work_restart:"Mula Kerja Semula",family_trust:"Kepercayaan Keluarga",social_treatment:"Layanan Sosial",inner_choice:"Pilihan Dalaman",misunderstood_and_recovered:"Salah Faham & Pemulihan",restart_path:"Jalan Permulaan Semula"},la:{work_restart:"Opus Renovatum",family_trust:"Fides Familiaris",social_treatment:"Tractatio Socialis",inner_choice:"Electio Interior",misunderstood_and_recovered:"Error et Recuperatio",restart_path:"Iter Renovationis"}},Ty={"zh-TW":"✔ 我願意將這段見證封存於區塊鏈（開發中）","zh-CN":"✔ 我愿意将这段见证封存于区块链（开发中）",en:"✔ I agree to preserve this testimony on the blockchain (In Development)",ja:"✔ この証言をブロックチェーンに保存することに同意します（開発中）",ko:"✔ 이 증언을 블록체인에 보존하는 것에 동의합니다（개발 중）",th:"✔ ฉันยินยอมให้บันทึกเรื่องราวนี้บนบล็อกเชน（กำลังพัฒนา）",vi:"✔ Tôi đồng ý lưu giữ câu chuyện này trên blockchain (Đang phát triển)",ms:"✔ Saya bersetuju untuk menyimpan kisah ini di blockchain (Dalam Pembangunan)",la:"✔ Assentior hanc testificationem in blockchain servari (In Progressu)"},tu={"zh-TW":{private:"只有我",friends:"好友可見",public:"所有人",label:"誰可以看到這段故事？"},"zh-CN":{private:"只有我",friends:"好友可见",public:"所有人",label:"谁可以看到这段故事？"},en:{private:"Only me",friends:"Friends only",public:"Everyone",label:"Who can see this story?"},ja:{private:"自分だけ",friends:"友達のみ",public:"全員",label:"誰がこのストーリーを見られますか？"},ko:{private:"나만 보기",friends:"친구만 보기",public:"모두 보기",label:"이 이야기를 누가 볼 수 있나요?"},th:{private:"เฉพาะฉัน",friends:"เพื่อนเท่านั้น",public:"ทุกคน",label:"ใครสามารถเห็นเรื่องราวนี้ได้บ้าง?"},vi:{private:"Chỉ mình tôi",friends:"Chỉ bạn bè",public:"Mọi người",label:"Ai có thể xem câu chuyện này?"},ms:{private:"Hanya saya",friends:"Hanya rakan",public:"Semua orang",label:"Siapa boleh melihat cerita ini?"},la:{private:"Solus ego",friends:"Amici tantum",public:"Omnes",label:"Quis hanc historiam videre potest?"}},r5={"zh-TW":{launch:"寫下來，也是⼀種勇敢。",ask:"如果只能留下一個故事，你會從哪裡說起？",thanks:"🎉 感謝你分享，這是你的故事",success:"你寫得很好，這段經歷值得被看見。",randomEncourage:["你的過去不定義你，選擇講述它，才是你的力量。","每個故事都值得被聽見。","你願意分享真心，我們願意陪你走一段。","你的經歷很珍貴，謝謝你願意說出來。"],chain:"我要將這段故事封存於區塊鏈",anonymous:"我要匿名分享",countryName:{中國大陸:"中國大陸",台灣:"台灣",日本:"日本",韓國:"韓國",美國:"美國",其他:"其他"},eventTypeName:{家暴加害:"家暴加害",家暴受害:"家暴受害",其他:"其他"}},"zh-CN":{launch:"写下来，也是一种勇敢。",ask:"这次你想聊的是什么？",thanks:"🎉 感谢你的分享，这是你的故事",success:"你写得很好，这段经历值得被看见。",randomEncourage:["你的过去不定义你，选择讲述它，才是你的力量。","每个故事都值得被听见。","你愿意分享真心，我们愿意陪你走一段。","你的经历很珍贵，谢谢你愿意说出来。"],chain:"我要将这段故事封存于区块链",anonymous:"我要匿名分享",countryName:{中國大陸:"中国大陆",台灣:"台湾",日本:"日本",韓國:"韩国",美國:"美国",其他:"其他"},eventTypeName:{家暴加害:"家暴加害",家暴受害:"家暴受害",其他:"其他"}},en:{launch:"Writing it down is also an act of courage.",ask:"What do you want to talk about this time?",thanks:"🎉 Thank you for sharing, this is your story",success:"You wrote beautifully. This experience deserves to be seen.",randomEncourage:["Your past does not define you. Choosing to tell it is your power.","Every story deserves to be heard.","You share your heart, we walk with you.","Your experience is precious, thank you for sharing."],chain:"I want to preserve this story on the blockchain",anonymous:"I want to share anonymously",countryName:{中國大陸:"China",台灣:"Taiwan",日本:"Japan",韓國:"Korea",美國:"USA",其他:"Other"},eventTypeName:{家暴加害:"Domestic Violence Perpetrator",家暴受害:"Domestic Violence Victim",其他:"Other"}},ja:{launch:"",ask:"",thanks:"",success:"",randomEncourage:[""],chain:"",anonymous:""},ko:{launch:"",ask:"",thanks:"",success:"",randomEncourage:[""],chain:"",anonymous:""},th:{launch:"",ask:"",thanks:"",success:"",randomEncourage:[""],chain:"",anonymous:""},vi:{launch:"",ask:"",thanks:"",success:"",randomEncourage:[""],chain:"",anonymous:""},ms:{launch:"",ask:"",thanks:"",success:"",randomEncourage:[""],chain:"",anonymous:""},la:{launch:"",ask:"",thanks:"",success:"",randomEncourage:[""],chain:"",anonymous:""}};async function nu(n,e,t){var s;const i={[e]:n};for(const o of t)if(o!==e)try{const l=await(await fetch("/api/translate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:n,from:e,to:o})})).json();i[o]=l.translated||""}catch{try{const l=await(await fetch(`https://translate.googleapis.com/translate_a/single?client=gtx&sl=${e}&tl=${o}&dt=t&q=${encodeURIComponent(n)}`)).json();i[o]=((s=l[0])==null?void 0:s.map(c=>c[0]).join(""))||""}catch{i[o]=""}}return i}function us(n,e){return n.titleLangs&&n.titleLangs[e]||n.title}function hs(n,e){return n.contentLangs&&n.contentLangs[e]||n.content}const ps={"zh-TW":{中國大陸:"中國大陸",台灣:"台灣",日本:"日本",韓國:"韓國",美國:"美國",其他:"其他"},"zh-CN":{中國大陸:"中国大陆",台灣:"台湾",日本:"日本",韓國:"韩国",美國:"美国",其他:"其他"},en:{中國大陸:"China",台灣:"Taiwan",日本:"Japan",韓國:"Korea",美國:"USA",其他:"Other"},ja:{中國大陸:"中国大陸",台灣:"台湾",日本:"日本",韓國:"韓国",美國:"アメリカ",其他:"その他"},ko:{中國大陸:"중국",台灣:"대만",日本:"일본",韓國:"한국",美國:"미국",其他:"기타"},th:{中國大陸:"จีน",台灣:"ไต้หวัน",日本:"ญี่ปุ่น",韓國:"เกาหลี",美國:"สหรัฐอเมริกา",其他:"อื่นๆ"},vi:{中國大陸:"Trung Quốc",台灣:"Đài Loan",日本:"Nhật Bản",韓國:"Hàn Quốc",美國:"Mỹ",其他:"Khác"},ms:{中國大陸:"China",台灣:"Taiwan",日本:"Jepun",韓國:"Korea",美國:"Amerika",其他:"Lain-lain"},la:{中國大陸:"Sina",台灣:"Taiwan",日本:"Iaponia",韓國:"Corea",美國:"CFA",其他:"Aliud"}},ms={"zh-TW":{家暴加害:"家暴加害",家暴受害:"家暴受害",其他:"其他"},"zh-CN":{家暴加害:"家暴加害",家暴受害:"家暴受害",其他:"其他"},en:{家暴加害:"Domestic Violence Perpetrator",家暴受害:"Domestic Violence Victim",其他:"Other"},ja:{家暴加害:"家庭内暴力加害者",家暴受害:"家庭内暴力被害者",其他:"その他"},ko:{家暴加害:"가정폭력 가해자",家暴受害:"가정폭력 피해자",其他:"기타"},th:{家暴加害:"ผู้กระทำความรุนแรงในครอบครัว",家暴受害:"เหยื่อความรุนแรงในครอบครัว",其他:"อื่นๆ"},vi:{家暴加害:"Người gây bạo lực gia đình",家暴受害:"Nạn nhân bạo lực gia đình",其他:"Khác"},ms:{家暴加害:"Pelaku Keganasan Rumah Tangga",家暴受害:"Mangsa Keganasan Rumah Tangga",其他:"Lain-lain"},la:{家暴加害:"Violentus Domesticus",家暴受害:"Victima Violentiae Domesticae",其他:"Aliud"}},s5=()=>{const n=Ba(Ti),e=Je(),t=$e(),{t:i,i18n:s}=t5(),[o,a]=g.useState("zh-TW");g.useEffect(()=>{const q=localStorage.getItem("lang");q&&["zh-TW","zh-CN","en","ja","ko","th","vi","ms","la"].includes(q)&&a(q)},[]);const[l,c]=g.useState(null),[u,h]=g.useState([]),[p,f]=g.useState(""),[b,x]=g.useState(""),[S,w]=g.useState(""),[I,j]=g.useState(null),[A,D]=g.useState(!1),[O,P]=g.useState(""),[B,k]=g.useState(!1),[T,R]=g.useState("public"),[E,_]=g.useState({tags:{}}),[v,z]=g.useState(null),[H,L]=g.useState(!1),[ee,ge]=g.useState(!1),[oe,Ie]=g.useState(""),[Re,te]=g.useState(null),[W,Y]=g.useState(""),[X,le]=g.useState(!1),[be,ve]=g.useState({}),[Me,Ve]=g.useState({}),[ie,$]=g.useState({}),[We,_e]=g.useState(!1),[ye,J]=g.useState([]);g.useEffect(()=>{const q=ur(e,F=>c(F));return()=>q()},[e]),g.useEffect(()=>{(async()=>{const F=un(Wt(n,"stories"),lc("createdAt","desc")),we=await kn(F);h(we.docs.map(Ne=>({id:Ne.id,...Ne.data()})))})()},[n]),g.useEffect(()=>{fetch(`/locales/${o}/tags.json`).then(q=>q.json()).then(q=>_(q)).catch(()=>_({tags:{}}))},[o]),g.useEffect(()=>{let q;if(ee){let F=0;q=setInterval(()=>{F=(F+1)%6,Ie(".".repeat(F))},400)}else Ie("");return()=>clearInterval(q)},[ee]),g.useEffect(()=>{async function q(){const F=await Ys(()=>Promise.resolve().then(()=>uc),void 0).then(Ne=>Ne.getDocs(Ne.collection(n,"profiles"))),we={};F.forEach(Ne=>{const Fe=Ne.data();Fe.nickname&&(we[Fe.nickname]=Fe),Fe.name&&(we[Fe.name]=Fe)}),Ve(we)}q()},[]),g.useEffect(()=>{async function q(){const F=await Ys(()=>Promise.resolve().then(()=>uc),void 0).then(Ne=>Ne.getDocs(Ne.collection(n,"profiles"))),we={};F.forEach(Ne=>{const Fe=Ne.data();Fe.email&&(we[Fe.email]=Fe)}),$(we)}q()},[]),g.useEffect(()=>{l&&(async()=>{const F=Wt(n,"links"),we=un(F,Lt("user1Id","==",l.uid),Lt("status","==","connected")),Ne=un(F,Lt("user2Id","==",l.uid),Lt("status","==","connected")),[Fe,Ue]=await Promise.all([kn(we),kn(Ne)]),Ct=new Set;Fe.forEach(ae=>Ct.add(ae.data().user2Id)),Ue.forEach(ae=>Ct.add(ae.data().user1Id)),J(Array.from(Ct))})()},[l]);const pe=async()=>{if(!p.trim()||!b.trim())return;ge(!0),L(!1);let q=0;const F=setInterval(()=>{q=(q+1)%6,Ie(".".repeat(q))},400);try{D(!0);const[we,Ne,Fe]=await Promise.all([fetch("/api/gpt/encourage",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({story:b})}).then(ne=>ne.json()).catch(()=>({encouragement:""})),nu(p,o,["zh-TW","zh-CN","en"]),nu(b,o,["zh-TW","zh-CN","en"])]),Ue=we.encouragement||"",Ct=Ue?await nu(Ue,o,["zh-TW","zh-CN","en"]):{},ae=r5[M].randomEncourage,Be=ae[Math.floor(Math.random()*ae.length)];Y(Be),await $i(Wt(n,"stories"),{title:p,content:b,author:(l==null?void 0:l.displayName)||"匿名",authorEmail:(l==null?void 0:l.email)||"",createdAt:new Date,comments:[],likes:0,encouragement:Ue,encouragementLangs:Ct,tag:O,visibility:T,onChain:B,titleLangs:Ne,contentLangs:Fe}),f(""),x(""),D(!1);const ct=un(Wt(n,"stories"),lc("createdAt","desc")),ot=(await kn(ct)).docs.map(ne=>({id:ne.id,...ne.data()}));h(ot),z(ot[0]||null)}catch(we){console.error("Error adding story:",we),f(""),x(""),D(!1)}finally{clearInterval(F),ge(!1)}};function ce(q){return q.encouragementLangs&&q.encouragementLangs[M]?q.encouragementLangs[M]:q.encouragement||je.encouragementDefault[M]}["intro.sunday","intro.monday","intro.tuesday","intro.wednesday","intro.thursday","intro.friday","intro.saturday"][new Date().getDay()];const me=async q=>{await dc(Ot(n,"stories",q)),h(u.filter(F=>F.id!==q)),v&&v.id===q&&z(null)},xe=q=>{R(q),q!=="public"&&k(!1)},M=o||"zh-TW";return r.jsx("div",{children:window.innerWidth<=768?r.jsxs(r.Fragment,{children:[r.jsxs("div",{style:{position:"absolute",top:0,left:0,right:0,zIndex:100,background:"rgba(255,255,255,0.95)",borderRadius:"0 0 16px 16px",padding:"18px 16px",boxShadow:"0 2px 12px #6B5BFF22",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[r.jsx("button",{onClick:()=>t("/"),style:{fontWeight:700,fontSize:18,padding:"6px 16px",borderRadius:8,border:"1.5px solid #6B5BFF",background:"#fff",color:"#6B5BFF",cursor:"pointer"},children:je.back[M]}),r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[r.jsx("span",{style:{fontSize:"1.5rem",fontWeight:900,color:"#6B5BFF"},children:"📖"}),r.jsx("span",{style:{fontSize:"1.2rem",fontWeight:900,color:"#6B5BFF"},children:je.pageTitle[M]})]}),r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[r.jsx("button",{onClick:async()=>{await hn(e),localStorage.clear(),t("/")},style:{fontWeight:700,fontSize:16,padding:"6px 12px",borderRadius:8,border:"1.5px solid #6B5BFF",background:"#fff",color:"#6B5BFF",cursor:"pointer"},children:je.logout[M]}),r.jsx(en,{})]})]}),r.jsxs("div",{style:{marginTop:80,marginBottom:16,background:"rgba(255,255,255,0.95)",borderRadius:16,padding:"16px",boxShadow:"0 2px 12px #6B5BFF22",textAlign:"center"},children:[r.jsx("div",{style:{fontSize:14,color:"#000",fontWeight:600,marginBottom:8},children:je.storyQuoteLine1[M]}),r.jsx("div",{style:{fontSize:14,color:"#000",fontWeight:600,marginBottom:8},children:je.storyQuoteLine2[M]}),r.jsx("div",{style:{fontSize:12,color:"#888",fontWeight:500},children:je.storyQuoteLine3[M]})]}),r.jsxs("div",{style:{background:"rgba(255,255,255,0.95)",borderRadius:16,padding:"16px",marginBottom:16,boxShadow:"0 2px 12px #6B5BFF22"},children:[r.jsx("div",{style:{padding:"12px 20px",background:"linear-gradient(135deg, #6B5BFF 60%, #23c6e6 100%)",color:"#fff",border:"none",borderRadius:10,fontWeight:900,fontSize:17,letterSpacing:1,textAlign:"center",marginBottom:16},children:je.formTitle[M]}),r.jsx("div",{style:{fontSize:16,color:"#6B5BFF",fontWeight:600,marginBottom:16,textAlign:"center"},children:je.storyPrompt[M]}),r.jsx("input",{value:p,onChange:q=>f(q.target.value),placeholder:je.titlePlaceholder[M],style:{width:"100%",boxSizing:"border-box",padding:12,borderRadius:16,border:"1px solid #ddd",fontSize:16,marginBottom:8,color:"#232946"}}),r.jsx("textarea",{value:b,onChange:q=>x(q.target.value),rows:3,placeholder:je.contentPlaceholder[M],style:{width:"100%",height:120,boxSizing:"border-box",padding:12,borderRadius:16,border:"1px solid #ddd",fontSize:16,marginBottom:8,color:"#232946",resize:"none"}}),r.jsxs("div",{style:{display:"flex",gap:16,alignItems:"center",marginBottom:8,fontSize:15},children:[r.jsxs("label",{style:{display:"flex",alignItems:"center",gap:2},children:[r.jsx("input",{type:"radio",name:"visibility",value:"private",checked:T==="private",onChange:()=>xe("private")})," ",je.visibilityPrivate[M]]}),r.jsxs("label",{style:{display:"flex",alignItems:"center",gap:2},children:[r.jsx("input",{type:"radio",name:"visibility",value:"friends",checked:T==="friends",onChange:()=>xe("friends")})," ",je.visibilityFriends[M]]}),r.jsxs("label",{style:{display:"flex",alignItems:"center",gap:2},children:[r.jsx("input",{type:"radio",name:"visibility",value:"public",checked:T==="public",onChange:()=>xe("public")})," ",je.visibilityPublic[M]]})]}),T==="public"&&r.jsxs("div",{style:{marginBottom:8},children:[r.jsxs("label",{style:{display:"flex",alignItems:"center",fontSize:15},children:[r.jsx("input",{type:"checkbox",checked:B,onChange:q=>k(q.target.checked),style:{marginRight:4}})," ",Ty[M]]}),r.jsx("div",{style:{fontSize:12,color:"#888",marginTop:4,fontStyle:"italic"},children:je.blockchainNote[M]})]}),r.jsx("button",{onClick:pe,disabled:A,style:{padding:"12px 20px",background:"linear-gradient(135deg, #6B5BFF 60%, #23c6e6 100%)",color:"#fff",border:"none",borderRadius:10,fontWeight:900,fontSize:17,letterSpacing:1,cursor:A?"not-allowed":"pointer",opacity:A?.6:1},children:je.formSubmit[M]})]}),r.jsxs("div",{style:{background:"rgba(255,255,255,0.95)",borderRadius:16,padding:"16px",marginBottom:16,boxShadow:"0 2px 12px #6B5BFF22"},children:[r.jsxs("div",{style:{display:"flex",gap:4,marginBottom:16,flexWrap:"nowrap",justifyContent:"space-between"},children:[r.jsxs("button",{onClick:()=>{L(!0),_e(!1),le(!1),te(null)},style:{padding:"6px 8px",borderRadius:18,border:"none",background:H?"linear-gradient(90deg,#ffb86b 60%,#6B5BFF 100%)":"#eee",color:H?"#fff":"#6B5BFF",fontWeight:700,fontSize:12,cursor:"pointer",flex:1,marginRight:4},children:["#💬",je.partnersStories[M]]}),r.jsxs("button",{onClick:()=>{_e(!0),L(!1),le(!1),te(null)},style:{padding:"6px 8px",borderRadius:18,border:"none",background:We?"linear-gradient(90deg,#23c6e6 60%,#6B5BFF 100%)":"#eee",color:We?"#fff":"#6B5BFF",fontWeight:700,fontSize:12,cursor:"pointer",flex:1,marginRight:4},children:["#🤝",je.friendStories[M]]}),r.jsxs("button",{onClick:()=>{le(!0),L(!1),_e(!1),te(null)},style:{padding:"6px 8px",borderRadius:18,border:"none",background:X?"linear-gradient(90deg,#6B5BFF 60%,#23c6e6 100%)":"#eee",color:X?"#fff":"#6B5BFF",fontWeight:700,fontSize:12,cursor:"pointer",flex:1},children:["#📝",je.myStories[M]]})]}),r.jsx("div",{style:{maxHeight:400,overflowY:"auto",width:"100%",paddingRight:6},children:We?ye.length===0?r.jsxs("div",{style:{color:"#888",fontWeight:600,fontSize:16,padding:"32px 0",textAlign:"center"},children:[je.noFriends[M],r.jsx("span",{onClick:()=>t("/friend"),style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,cursor:"pointer"},children:je.goToPairTalk[M]})]}):u.filter(q=>q.visibility==="friends"&&ye.includes(q.authorEmail)).map(q=>{const F=ie[q.authorEmail]||{};return r.jsxs("div",{style:{background:"#fff",borderRadius:14,boxShadow:"0 2px 8px #b6b6f622",padding:14,marginBottom:14,cursor:"pointer"},children:[r.jsx("div",{style:{fontWeight:700,color:"#6B5BFF",fontSize:16,marginBottom:4},onClick:we=>{we.stopPropagation(),te(Re===q.id?null:q.id)},children:us(q,M)}),r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:4,fontSize:"12px",flexWrap:"nowrap",whiteSpace:"nowrap"},children:[r.jsx("img",{src:F.avatar||F.avatarUrl||"/avatars/Derxl.png",alt:"avatar",style:{width:24,height:24,borderRadius:"50%",objectFit:"cover",border:"2px solid #ececff"}}),r.jsx("span",{style:{fontWeight:600},children:F&&F.nickname?F.nickname:"-"}),r.jsxs("span",{children:["，",F&&F.age?F.age:"-"]}),r.jsxs("span",{children:["，",F&&F.gender?F.gender:"-"]})]}),Re===q.id&&r.jsxs("div",{style:{marginTop:8},children:[r.jsx("div",{style:{color:"#232946",fontSize:14,marginBottom:4,whiteSpace:"pre-line"},children:hs(q,M)}),r.jsxs("div",{style:{background:"linear-gradient(90deg, #f7f8fc 60%, #e3e6f3 100%)",borderRadius:12,padding:"6px 10px",margin:"6px 0",display:"flex",alignItems:"center",gap:6,boxShadow:"0 2px 8px #b6b6f622",fontSize:12},children:[r.jsxs("span",{style:{color:"#7f8fff",fontWeight:700},children:["🤖 ",je.encouragement[M],"："]}),r.jsx("span",{style:{color:"#4b4b6b",fontWeight:500},children:ce(q)})]}),q.tag&&r.jsx("div",{style:{fontSize:12,color:"#6B5BFF",fontWeight:700,marginBottom:4},children:ut[M][q.tag]}),q.onChain&&r.jsx("span",{style:{fontSize:12,color:"#23c6e6",fontWeight:700,marginLeft:8},children:"🔗 已封存"}),r.jsx("div",{style:{marginTop:8,fontSize:12,color:"#6B5BFF",fontWeight:500,background:"#f7f8fc",borderRadius:8,padding:"6px 10px"},children:r.jsxs("div",{children:[`${je.profileLabels[M].split(`
`)[0].split("：")[0]}：${F&&F.nickname?F.nickname:"-"}，`,`${je.profileLabels[M].split(`
`)[1].split("：")[0]}：${F&&F.gender?F.gender:"-"}，`,`${je.profileLabels[M].split(`
`)[2].split("：")[0]}：${F&&F.age?F.age:"-"}，`,`${je.profileLabels[M].split(`
`)[3].split("：")[0]}：${F&&typeof F.country=="string"&&F.country?ps[M][F.country]||F.country:"-"}，`,`${je.profileLabels[M].split(`
`)[4].split("：")[0]}：${F&&typeof F.interest=="string"&&F.interest?ut&&ut[M]&&ut[M][F.interest]?ut[M][F.interest]:F.interest:"-"}，`,`${je.profileLabels[M].split(`
`)[5].split("：")[0]}：${F&&typeof F.eventType=="string"&&F.eventType?ms[M][F.eventType]||F.eventType:"-"}`]})})]})]},q.id)}):X?u.filter(q=>q.author===(l==null?void 0:l.displayName)).map(q=>{var we;const F=ie[q.authorEmail]||{};return r.jsxs("div",{style:{background:"#fff",borderRadius:14,boxShadow:"0 2px 8px #b6b6f622",padding:14,marginBottom:14,position:"relative"},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10},children:[r.jsx("div",{className:`w-6 h-6 rounded-full flex items-center justify-center text-white font-extrabold text-sm border-2 border-[#ececff] shadow ${Sy(q.author)}`,children:((we=q.author)==null?void 0:we[0])||"A"}),r.jsx("div",{style:{fontWeight:700,color:"#6B5BFF",fontSize:14,cursor:"pointer"},onClick:Ne=>{Ne.stopPropagation(),te(Re===q.id?null:q.id)},children:us(q,M)}),r.jsx("button",{onClick:()=>me(q.id),style:{marginLeft:"auto",background:"#ff6b6b",color:"#fff",border:"none",borderRadius:6,padding:"2px 8px",fontWeight:700,cursor:"pointer",fontSize:12},children:"刪除"})]}),Re===q.id&&r.jsxs("div",{style:{marginTop:8},children:[r.jsx("div",{style:{color:"#232946",fontSize:14,marginBottom:4},children:hs(q,M)}),r.jsxs("div",{style:{background:"linear-gradient(90deg, #f7f8fc 60%, #e3e6f3 100%)",borderRadius:12,padding:"6px 10px",margin:"6px 0",display:"flex",alignItems:"center",gap:6,boxShadow:"0 2px 8px #b6b6f622",fontSize:12},children:[r.jsxs("span",{style:{color:"#7f8fff",fontWeight:700},children:["🤖 ",je.encouragement[M],"："]}),r.jsx("span",{style:{color:"#4b4b6b",fontWeight:500},children:ce(q)})]}),q.tag&&r.jsx("div",{style:{fontSize:12,color:"#6B5BFF",fontWeight:700,marginBottom:4},children:ut[M][q.tag]}),q.onChain&&r.jsx("span",{style:{fontSize:12,color:"#23c6e6",fontWeight:700,marginLeft:8},children:"🔗 已封存"}),r.jsx("div",{style:{marginTop:8,fontSize:12,color:"#6B5BFF",fontWeight:500,background:"#f7f8fc",borderRadius:8,padding:"6px 10px"},children:r.jsxs("div",{children:[`${je.profileLabels[M].split(`
`)[0].split("：")[0]}：${F&&F.nickname?F.nickname:"-"}，`,`${je.profileLabels[M].split(`
`)[1].split("：")[0]}：${F&&F.gender?F.gender:"-"}，`,`${je.profileLabels[M].split(`
`)[2].split("：")[0]}：${F&&F.age?F.age:"-"}，`,`${je.profileLabels[M].split(`
`)[3].split("：")[0]}：${F&&typeof F.country=="string"&&F.country?ps[M][F.country]||F.country:"-"}，`,`${je.profileLabels[M].split(`
`)[4].split("：")[0]}：${F&&typeof F.interest=="string"&&F.interest?ut&&ut[M]&&ut[M][F.interest]?ut[M][F.interest]:F.interest:"-"}，`,`${je.profileLabels[M].split(`
`)[5].split("：")[0]}：${F&&typeof F.eventType=="string"&&F.eventType?ms[M][F.eventType]||F.eventType:"-"}`]})})]})]},q.id)}):u.filter(q=>q.visibility==="public").map(q=>{const F=ie[q.authorEmail]||{};return r.jsxs("div",{style:{background:"#fff",borderRadius:14,boxShadow:"0 2px 8px #b6b6f622",padding:14,marginBottom:14,cursor:"pointer"},children:[r.jsx("div",{style:{fontWeight:700,color:"#6B5BFF",fontSize:16,marginBottom:4},onClick:we=>{we.stopPropagation(),te(Re===q.id?null:q.id)},children:us(q,M)}),r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:4,fontSize:"12px",flexWrap:"nowrap",whiteSpace:"nowrap"},children:[r.jsx("img",{src:F.avatar||F.avatarUrl||"/avatars/Derxl.png",alt:"avatar",style:{width:24,height:24,borderRadius:"50%",objectFit:"cover",border:"2px solid #ececff"}}),r.jsx("span",{style:{fontWeight:600},children:F&&F.nickname?F.nickname:"-"}),r.jsxs("span",{children:["，",F&&F.age?F.age:"-"]}),r.jsxs("span",{children:["，",F&&F.gender?F.gender:"-"]})]}),Re===q.id&&r.jsxs("div",{style:{marginTop:8},children:[r.jsx("div",{style:{color:"#232946",fontSize:14,marginBottom:4,whiteSpace:"pre-line"},children:hs(q,M)}),r.jsxs("div",{style:{background:"linear-gradient(90deg, #f7f8fc 60%, #e3e6f3 100%)",borderRadius:12,padding:"6px 10px",margin:"6px 0",display:"flex",alignItems:"center",gap:6,boxShadow:"0 2px 8px #b6b6f622",fontSize:12},children:[r.jsxs("span",{style:{color:"#7f8fff",fontWeight:700},children:["🤖 ",je.encouragement[M],"："]}),r.jsx("span",{style:{color:"#4b4b6b",fontWeight:500},children:ce(q)})]}),q.tag&&r.jsx("div",{style:{fontSize:12,color:"#6B5BFF",fontWeight:700,marginBottom:4},children:ut[M][q.tag]}),q.onChain&&r.jsx("span",{style:{fontSize:12,color:"#23c6e6",fontWeight:700,marginLeft:8},children:"🔗 已封存"}),r.jsx("div",{style:{marginTop:8,fontSize:12,color:"#6B5BFF",fontWeight:500,background:"#f7f8fc",borderRadius:8,padding:"6px 10px"},children:r.jsxs("div",{children:[`${je.profileLabels[M].split(`
`)[0].split("：")[0]}：${F&&F.nickname?F.nickname:"-"}，`,`${je.profileLabels[M].split(`
`)[1].split("：")[0]}：${F&&F.gender?F.gender:"-"}，`,`${je.profileLabels[M].split(`
`)[2].split("：")[0]}：${F&&F.age?F.age:"-"}，`,`${je.profileLabels[M].split(`
`)[3].split("：")[0]}：${F&&typeof F.country=="string"&&F.country?ps[M][F.country]||F.country:"-"}，`,`${je.profileLabels[M].split(`
`)[4].split("：")[0]}：${F&&typeof F.interest=="string"&&F.interest?ut&&ut[M]&&ut[M][F.interest]?ut[M][F.interest]:F.interest:"-"}，`,`${je.profileLabels[M].split(`
`)[5].split("：")[0]}：${F&&typeof F.eventType=="string"&&F.eventType?ms[M][F.eventType]||F.eventType:"-"}`]})})]})]},q.id)})})]}),r.jsx("div",{style:{width:"100%",margin:"0 auto",marginTop:24,background:"rgba(255,255,255,0.95)",borderRadius:16,padding:"16px",boxShadow:"0 2px 12px #6B5BFF22"},children:r.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:20,flexWrap:"wrap"},children:[r.jsx("span",{onClick:()=>t("/about"),style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12,cursor:"pointer"},children:"🧬 Restarter™｜我們是誰"}),r.jsx("span",{onClick:()=>t("/privacy-policy"),style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12,cursor:"pointer"},children:"隱私權政策"}),r.jsx("span",{onClick:()=>t("/terms"),style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12,cursor:"pointer"},children:"條款/聲明"}),r.jsx("span",{onClick:()=>t("/data-deletion"),style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12,cursor:"pointer"},children:"資料刪除說明"}),r.jsx("span",{onClick:()=>t("/feedback"),style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12,cursor:"pointer"},children:"💬 意見箱｜我們想聽你說"})]})})]}):r.jsxs(r.Fragment,{children:[r.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundImage:"url(/skytree.png)",backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat",zIndex:-1}}),r.jsxs("div",{style:{position:"absolute",top:0,left:0,right:0,zIndex:100,display:"flex",justifyContent:"space-between",alignItems:"center",padding:"18px 32px"},children:[r.jsx("button",{onClick:()=>t("/"),style:{fontWeight:700,fontSize:18,padding:"6px 16px",borderRadius:8,border:"1.5px solid #6B5BFF",background:"#fff",color:"#6B5BFF",cursor:"pointer"},children:je.back[M]}),r.jsx("div",{style:{display:"flex",alignItems:"center",gap:16},children:r.jsxs("span",{style:{fontSize:"2rem",fontWeight:900,color:"#6B5BFF"},children:["📖 ",je.pageTitle[M]]})}),r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[r.jsx("button",{onClick:async()=>{await hn(e),localStorage.clear(),t("/")},style:{fontWeight:700,fontSize:18,padding:"6px 16px",borderRadius:8,border:"1.5px solid #6B5BFF",background:"#fff",color:"#6B5BFF",cursor:"pointer"},children:je.logout[M]}),r.jsx(en,{})]})]}),r.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"100vh",padding:"80px 20px 20px 20px"},children:r.jsxs("div",{className:"modern-container",style:{width:"90%",maxWidth:1e3,display:"flex",flexDirection:"column",gap:32,background:"rgba(255, 255, 255, 0.9)",backdropFilter:"blur(10px)",borderRadius:20,padding:32,boxShadow:"0 8px 32px 0 rgba(31, 38, 135, 0.37)"},children:[r.jsxs("div",{style:{textAlign:"center",marginBottom:24},children:[r.jsx("p",{style:{fontSize:"1rem",color:"#000",fontWeight:600,margin:"0 0 8px 0",lineHeight:1.5},children:je.storyQuoteLine1[M]}),r.jsx("p",{style:{fontSize:"1rem",color:"#000",fontWeight:600,margin:"0 0 8px 0",lineHeight:1.5},children:je.storyQuoteLine2[M]}),r.jsx("p",{style:{fontSize:"0.9rem",color:"#888",fontWeight:500,margin:0,lineHeight:1.4},children:je.storyQuoteLine3[M]})]}),r.jsxs("div",{style:{display:"flex",gap:32},children:[r.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",gap:24},children:[r.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:16,marginBottom:16},children:[r.jsx("div",{style:{display:"flex",alignItems:"center",gap:16},children:r.jsx("div",{style:{padding:"12px 20px",background:"linear-gradient(135deg, #6B5BFF 60%, #23c6e6 100%)",color:"#fff",border:"none",borderRadius:10,fontWeight:900,fontSize:17,letterSpacing:1,textAlign:"center"},children:je.formTitle[M]})}),r.jsx("div",{style:{fontSize:16,color:"#6B5BFF",fontWeight:600,textAlign:"center"},children:je.storyPrompt[M]})]}),r.jsx("input",{value:p,onChange:q=>f(q.target.value),placeholder:je.titlePlaceholder[M],style:{width:"100%",boxSizing:"border-box",padding:12,borderRadius:16,border:"1px solid #ddd",fontSize:16,marginBottom:8,color:"#232946"}}),r.jsx("textarea",{value:b,onChange:q=>x(q.target.value),rows:3,placeholder:je.contentPlaceholder[M],style:{width:"100%",height:120,boxSizing:"border-box",padding:12,borderRadius:16,border:"1px solid #ddd",fontSize:16,marginBottom:8,color:"#232946",resize:"none"}}),r.jsxs("div",{style:{display:"flex",gap:16,alignItems:"center",marginBottom:8,fontSize:15},children:[r.jsxs("label",{style:{display:"flex",alignItems:"center",gap:2},children:[r.jsx("input",{type:"radio",name:"visibility",value:"private",checked:T==="private",onChange:()=>xe("private")})," ",je.visibilityPrivate[M]]}),r.jsxs("label",{style:{display:"flex",alignItems:"center",gap:2},children:[r.jsx("input",{type:"radio",name:"visibility",value:"friends",checked:T==="friends",onChange:()=>xe("friends")})," ",je.visibilityFriends[M]]}),r.jsxs("label",{style:{display:"flex",alignItems:"center",gap:2},children:[r.jsx("input",{type:"radio",name:"visibility",value:"public",checked:T==="public",onChange:()=>xe("public")})," ",je.visibilityPublic[M]]})]}),T==="public"&&r.jsxs("div",{style:{marginBottom:8},children:[r.jsxs("label",{style:{display:"flex",alignItems:"center",fontSize:15},children:[r.jsx("input",{type:"checkbox",checked:B,onChange:q=>k(q.target.checked),style:{marginRight:4}})," ",Ty[M]]}),r.jsx("div",{style:{fontSize:12,color:"#888",marginTop:4,fontStyle:"italic"},children:je.blockchainNote[M]})]}),r.jsx("button",{onClick:pe,disabled:A,style:{padding:"12px 20px",background:"linear-gradient(135deg, #6B5BFF 60%, #23c6e6 100%)",color:"#fff",border:"none",borderRadius:10,fontWeight:900,fontSize:17,letterSpacing:1,cursor:A?"not-allowed":"pointer",opacity:A?.6:1},children:je.formSubmit[M]})]}),r.jsxs("div",{style:{flex:2,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[r.jsxs("div",{style:{display:"flex",gap:10,marginBottom:18},children:[r.jsxs("button",{onClick:()=>{L(!0),_e(!1),le(!1),te(null)},style:{padding:"8px 18px",borderRadius:18,border:"none",background:H?"linear-gradient(90deg,#ffb86b 60%,#6B5BFF 100%)":"#eee",color:H?"#fff":"#6B5BFF",fontWeight:700,fontSize:16,cursor:"pointer"},children:["#💬",je.partnersStories[M]]}),r.jsxs("button",{onClick:()=>{_e(!0),L(!1),le(!1),te(null)},style:{padding:"8px 18px",borderRadius:18,border:"none",background:We?"linear-gradient(90deg,#23c6e6 60%,#6B5BFF 100%)":"#eee",color:We?"#fff":"#6B5BFF",fontWeight:700,fontSize:16,cursor:"pointer"},children:["#🤝",je.friendStories[M]]}),r.jsxs("button",{onClick:()=>{le(!0),L(!1),_e(!1),te(null)},style:{padding:"8px 18px",borderRadius:18,border:"none",background:X?"linear-gradient(90deg,#6B5BFF 60%,#23c6e6 100%)":"#eee",color:X?"#fff":"#6B5BFF",fontWeight:700,fontSize:16,cursor:"pointer"},children:["#📝",je.myStories[M]]})]}),ee?r.jsxs("div",{style:{padding:"48px 0",textAlign:"center",color:"#6B5BFF",fontWeight:700,fontSize:22},children:["🤖 AI正在幫你包裝故事，請稍候",oe,r.jsx("div",{style:{fontSize:15,color:"#888",marginTop:12},children:"（有時AI會偷偷加點幽默，請耐心等候...）"})]}):We?r.jsxs("div",{style:{width:"100%",background:"#fff",borderRadius:18,boxShadow:"0 2px 12px #6B5BFF22",padding:"18px 12px",marginBottom:18},children:[r.jsxs("div",{style:{fontWeight:700,fontSize:18,marginBottom:10,background:"linear-gradient(90deg,#23c6e6 60%,#6B5BFF 100%)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text"},children:["#🤝",je.friendStories[M]]}),r.jsx("button",{onClick:()=>{_e(!1),L(!0),le(!1),te(null)},style:{margin:"0 0 18px 0",padding:"8px 18px",borderRadius:18,border:"none",background:"#eee",color:"#6B5BFF",fontWeight:700,fontSize:16,cursor:"pointer"},children:"返回夥伴們的故事"}),r.jsx("div",{style:{maxHeight:420,overflowY:"auto",width:"100%",paddingRight:6},children:ye.length===0?r.jsxs("div",{style:{color:"#888",fontWeight:600,fontSize:16,padding:"32px 0",textAlign:"center"},children:[je.noFriends[M],r.jsx("span",{onClick:()=>t("/friend"),style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,cursor:"pointer"},children:je.goToPairTalk[M]})]}):u.filter(q=>q.visibility==="friends"&&ye.includes(q.authorEmail)).map(q=>{const F=ie[q.authorEmail]||{};return r.jsxs("div",{style:{background:"#fff",borderRadius:14,boxShadow:"0 2px 8px #b6b6f622",padding:14,marginBottom:14,cursor:"pointer"},children:[r.jsx("div",{style:{fontWeight:700,color:"#6B5BFF",fontSize:18,cursor:"pointer",marginBottom:4},onClick:we=>{we.stopPropagation(),te(Re===q.id?null:q.id)},children:us(q,M)}),r.jsx(ky,{profile:F,variant:"compact"}),Re===q.id&&r.jsxs("div",{style:{marginTop:10},children:[r.jsx("div",{style:{color:"#232946",fontSize:15,marginBottom:4,whiteSpace:"pre-line"},children:hs(q,M)}),r.jsxs("div",{style:{background:"linear-gradient(90deg, #f7f8fc 60%, #e3e6f3 100%)",borderRadius:12,padding:"8px 12px",margin:"8px 0",display:"flex",alignItems:"center",gap:8,boxShadow:"0 2px 8px #b6b6f622",fontSize:14},children:[r.jsxs("span",{style:{color:"#7f8fff",fontWeight:700},children:["🤖 ",je.encouragement[M],"："]}),r.jsx("span",{style:{color:"#4b4b6b",fontWeight:500},children:ce(q)})]}),q.tag&&r.jsx("div",{style:{fontSize:14,color:"#6B5BFF",fontWeight:700,marginBottom:4},children:ut[M][q.tag]}),q.onChain&&r.jsx("span",{style:{fontSize:14,color:"#23c6e6",fontWeight:700,marginLeft:8},children:"🔗 已封存"}),q.visibility&&["private","friends","public"].includes(q.visibility)&&r.jsx("span",{style:{fontSize:13,color:"#888",marginLeft:8},children:tu[M][q.visibility]}),r.jsx(ky,{profile:F,variant:"detailed"})]})]},q.id)})})]}):X?r.jsxs("div",{style:{width:"100%",background:"#fff",borderRadius:18,boxShadow:"0 2px 12px #6B5BFF22",padding:"18px 12px",marginBottom:18},children:[r.jsxs("div",{style:{fontWeight:700,fontSize:18,marginBottom:10,background:"linear-gradient(90deg,#6B5BFF 0%,#23c6e6 100%)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text"},children:["#📝",je.myStories[M]]}),r.jsx("button",{onClick:()=>{le(!1),L(!0),_e(!1),te(null)},style:{margin:"0 0 18px 0",padding:"8px 18px",borderRadius:18,border:"none",background:"#eee",color:"#6B5BFF",fontWeight:700,fontSize:16,cursor:"pointer"},children:"返回夥伴們的故事"}),r.jsx("div",{style:{maxHeight:420,overflowY:"auto",width:"100%",paddingRight:6},children:u.filter(q=>q.author===(l==null?void 0:l.displayName)).map(q=>{var we;const F=ie[q.authorEmail]||{};return r.jsxs("div",{style:{background:"#fff",borderRadius:14,boxShadow:"0 2px 8px #b6b6f622",padding:14,marginBottom:14,position:"relative"},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10},children:[r.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-white font-extrabold text-lg border-2 border-[#ececff] shadow ${Sy(q.author)}`,children:((we=q.author)==null?void 0:we[0])||"A"}),r.jsx("div",{style:{fontWeight:700,color:"#6B5BFF",fontSize:16,cursor:"pointer"},onClick:Ne=>{Ne.stopPropagation(),te(Re===q.id?null:q.id)},children:us(q,M)}),r.jsx("button",{onClick:()=>me(q.id),style:{marginLeft:"auto",background:"#ff6b6b",color:"#fff",border:"none",borderRadius:8,padding:"4px 12px",fontWeight:700,cursor:"pointer"},children:"刪除"})]}),Re===q.id&&r.jsxs("div",{style:{marginTop:10},children:[r.jsx("div",{style:{color:"#232946",fontSize:15,marginBottom:4},children:hs(q,M)}),r.jsxs("div",{style:{background:"linear-gradient(90deg, #f7f8fc 60%, #e3e6f3 100%)",borderRadius:12,padding:"8px 12px",margin:"8px 0",display:"flex",alignItems:"center",gap:8,boxShadow:"0 2px 8px #b6b6f622",fontSize:14},children:[r.jsxs("span",{style:{color:"#7f8fff",fontWeight:700},children:["🤖 ",je.encouragement[M],"："]}),r.jsx("span",{style:{color:"#4b4b6b",fontWeight:500},children:ce(q)})]}),q.tag&&r.jsx("div",{style:{fontSize:14,color:"#6B5BFF",fontWeight:700,marginBottom:4},children:ut[M][q.tag]}),q.onChain&&r.jsx("span",{style:{fontSize:14,color:"#23c6e6",fontWeight:700,marginLeft:8},children:"🔗 已封存"}),q.visibility&&["private","friends","public"].includes(q.visibility)&&r.jsx("span",{style:{fontSize:13,color:"#888",marginLeft:8},children:tu[M][q.visibility]}),r.jsx("div",{style:{marginTop:10,fontSize:14,color:"#6B5BFF",fontWeight:500,background:"#f7f8fc",borderRadius:8,padding:"8px 12px"},children:r.jsxs("div",{children:[`${je.profileLabels[M].split(`
`)[0].split("：")[0]}：${F&&F.nickname?F.nickname:"-"}，`,`${je.profileLabels[M].split(`
`)[1].split("：")[0]}：${F&&F.gender?F.gender:"-"}，`,`${je.profileLabels[M].split(`
`)[2].split("：")[0]}：${F&&F.age?F.age:"-"}，`,`${je.profileLabels[M].split(`
`)[3].split("：")[0]}：${F&&typeof F.country=="string"&&F.country?ps[M][F.country]||F.country:"-"}，`,`${je.profileLabels[M].split(`
`)[4].split("：")[0]}：${F&&typeof F.interest=="string"&&F.interest?ut&&ut[M]&&ut[M][F.interest]?ut[M][F.interest]:F.interest:"-"}，`,`${je.profileLabels[M].split(`
`)[5].split("：")[0]}：${F&&typeof F.eventType=="string"&&F.eventType?ms[M][F.eventType]||F.eventType:"-"}`]})})]})]},q.id)})})]}):r.jsxs("div",{style:{width:"100%",background:"#fff",borderRadius:18,boxShadow:"0 2px 12px #6B5BFF22",padding:"18px 12px",marginBottom:18},children:[r.jsxs("div",{style:{fontWeight:700,fontSize:18,marginBottom:10,background:"linear-gradient(90deg,#ffb86b 60%,#6B5BFF 100%)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text"},children:["#💬",je.partnersStories[M]]}),r.jsx("button",{onClick:()=>{le(!0),L(!1),_e(!1),te(null)},style:{margin:"0 0 18px 0",padding:"8px 18px",borderRadius:18,border:"none",background:"#eee",color:"#6B5BFF",fontWeight:700,fontSize:16,cursor:"pointer"},children:"返回我的故事"}),r.jsx("div",{style:{maxHeight:420,overflowY:"auto",width:"100%",paddingRight:6},children:u.filter(q=>q.visibility==="public").map(q=>{const F=ie[q.authorEmail]||{};return r.jsxs("div",{style:{background:"#fff",borderRadius:14,boxShadow:"0 2px 8px #b6b6f622",padding:14,marginBottom:14,cursor:"pointer"},children:[r.jsx("div",{style:{fontWeight:700,color:"#6B5BFF",fontSize:18,cursor:"pointer",marginBottom:4},onClick:we=>{we.stopPropagation(),te(Re===q.id?null:q.id)},children:us(q,M)}),r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,marginBottom:2,fontSize:"14px",flexWrap:"nowrap",whiteSpace:"nowrap"},children:[r.jsx("img",{src:F.avatar||F.avatarUrl||"/avatars/Derxl.png",alt:"avatar",style:{width:36,height:36,borderRadius:"50%",objectFit:"cover",border:"2px solid #ececff"}}),r.jsx("span",{style:{fontWeight:600},children:F&&F.nickname?F.nickname:"-"}),r.jsxs("span",{children:["，",F&&F.age?F.age:"-"]}),r.jsxs("span",{children:["，",F&&F.gender?F.gender:"-"]}),r.jsxs("span",{children:["，",F&&typeof F.country=="string"&&F.country?ps[M][F.country]||F.country:"-"]}),r.jsxs("span",{children:["，",F&&typeof F.interest=="string"&&F.interest?ut&&ut[M]&&ut[M][F.interest]?ut[M][F.interest]:F.interest:"-"]}),r.jsxs("span",{children:["，",F&&typeof F.eventType=="string"&&F.eventType?ms[M][F.eventType]||F.eventType:"-"]})]}),Re===q.id&&r.jsxs("div",{style:{marginTop:10},children:[r.jsx("div",{style:{color:"#232946",fontSize:15,marginBottom:4,whiteSpace:"pre-line"},children:hs(q,M)}),r.jsxs("div",{style:{background:"linear-gradient(90deg, #f7f8fc 60%, #e3e6f3 100%)",borderRadius:12,padding:"8px 12px",margin:"8px 0",display:"flex",alignItems:"center",gap:8,boxShadow:"0 2px 8px #b6b6f622",fontSize:14},children:[r.jsxs("span",{style:{color:"#7f8fff",fontWeight:700},children:["🤖 ",je.encouragement[M],"："]}),r.jsx("span",{style:{color:"#4b4b6b",fontWeight:500},children:ce(q)})]}),q.tag&&r.jsx("div",{style:{fontSize:14,color:"#6B5BFF",fontWeight:700,marginBottom:4},children:ut[M][q.tag]}),q.onChain&&r.jsx("span",{style:{fontSize:14,color:"#23c6e6",fontWeight:700,marginLeft:8},children:"🔗 已封存"}),q.visibility&&["private","friends","public"].includes(q.visibility)&&r.jsx("span",{style:{fontSize:13,color:"#888",marginLeft:8},children:tu[M][q.visibility]}),r.jsx("div",{style:{marginTop:10,fontSize:14,color:"#6B5BFF",fontWeight:500,background:"#f7f8fc",borderRadius:8,padding:"8px 12px"},children:r.jsxs("div",{children:[`${je.profileLabels[M].split(`
`)[0].split("：")[0]}：${F&&F.nickname?F.nickname:"-"}，`,`${je.profileLabels[M].split(`
`)[1].split("：")[0]}：${F&&F.gender?F.gender:"-"}，`,`${je.profileLabels[M].split(`
`)[2].split("：")[0]}：${F&&F.age?F.age:"-"}，`,`${je.profileLabels[M].split(`
`)[3].split("：")[0]}：${F&&typeof F.country=="string"&&F.country?ps[M][F.country]||F.country:"-"}，`,`${je.profileLabels[M].split(`
`)[4].split("：")[0]}：${F&&typeof F.interest=="string"&&F.interest?ut&&ut[M]&&ut[M][F.interest]?ut[M][F.interest]:F.interest:"-"}，`,`${je.profileLabels[M].split(`
`)[5].split("：")[0]}：${F&&typeof F.eventType=="string"&&F.eventType?ms[M][F.eventType]||F.eventType:"-"}`]})})]})]},q.id)})})]})]})]})]})}),r.jsx("div",{style:{width:"100%",margin:"0 auto",marginTop:24,background:"rgba(255,255,255,0.95)",borderRadius:16,padding:"16px",boxShadow:"0 2px 12px #6B5BFF22"},children:r.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:20,flexWrap:"wrap"},children:[r.jsx("span",{onClick:()=>t("/privacy-policy"),style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12,cursor:"pointer"},children:M==="zh-TW"?"隱私權政策":M==="zh-CN"?"隐私政策":M==="en"?"Privacy Policy":M==="ja"?"プライバシーポリシー":M==="ko"?"개인정보 처리방침":M==="th"?"นโยบายความเป็นส่วนตัว":M==="vi"?"Chính sách bảo mật":M==="ms"?"Dasar Privasi":"Consilium de Privata"}),r.jsx("span",{onClick:()=>t("/terms"),style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12,cursor:"pointer"},children:M==="zh-TW"?"條款/聲明":M==="zh-CN"?"条款/声明":M==="en"?"Terms/Statement":M==="ja"?"規約/声明":M==="ko"?"약관/성명":M==="th"?"ข้อกำหนด/แถลงการณ์":M==="vi"?"Điều khoản/Tuyên bố":M==="ms"?"Terma/Pernyataan":"Termini/Declaratio"}),r.jsx("span",{onClick:()=>t("/data-deletion"),style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12,cursor:"pointer"},children:M==="zh-TW"?"資料刪除說明":M==="zh-CN"?"数据删除说明":M==="en"?"Data Deletion":M==="ja"?"データ削除について":M==="ko"?"데이터 삭제 안내":M==="th"?"คำอธิบายการลบข้อมูล":M==="vi"?"Giải thích xóa dữ liệu":M==="ms"?"Penjelasan Penghapusan Data":"Explicatio Deletionis Datae"}),r.jsx("span",{onClick:()=>t("/about"),style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12,cursor:"pointer"},children:M==="zh-TW"?"🧬 Restarter™｜我們是誰":M==="zh-CN"?"🧬 Restarter™｜我们是谁":M==="en"?"🧬 Restarter™｜Who We Are":M==="ja"?"🧬 Restarter™｜私たちについて":M==="ko"?"🧬 Restarter™｜우리는 누구인가":M==="th"?"🧬 Restarter™｜เราเป็นใคร":M==="vi"?"🧬 Restarter™｜Chúng tôi là ai":M==="ms"?"🧬 Restarter™｜Siapa Kami":"🧬 Restarter™｜Quis sumus"}),r.jsx("span",{onClick:()=>t("/feedback"),style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12,cursor:"pointer"},children:M==="zh-TW"?"💬 意見箱｜我們想聽你說":M==="zh-CN"?"💬 意见箱｜我们想听你说":M==="en"?"💬 Feedback Box｜We Want to Hear From You":M==="ja"?"💬 ご意見箱｜私たちはあなたの声を聞きたい":M==="ko"?"💬 피드백｜우리는 당신의 말을 듣고 싶습니다":M==="th"?"💬 กล่องความคิดเห็น｜เราอยากได้ยินจากคุณ":M==="vi"?"💬 Hộp góp ý｜Chúng tôi muốn nghe từ bạn":M==="ms"?"💬 Kotak Maklum Balas｜Kami Ingin Mendengar Dari Anda":"💬 Arca Consilii｜Volumus Audire a Te"})]})})]})})},ck=[{id:1,name_zh:"書吏",name_en:"Scribe",icon:"📜",upgrade_cost:10},{id:2,name_zh:"縣丞",name_en:"County Clerk",icon:"🪪",upgrade_cost:10},{id:3,name_zh:"通判",name_en:"Overseer",icon:"🧾",upgrade_cost:10},{id:4,name_zh:"巡撫",name_en:"Inspector",icon:"🛡️",upgrade_cost:10},{id:5,name_zh:"尚書",name_en:"Minister",icon:"🏛️",upgrade_cost:10},{id:6,name_zh:"太保",name_en:"Imperial Counselor",icon:"📯",upgrade_cost:10},{id:7,name_zh:"宰相",name_en:"Chancellor",icon:"🏯",upgrade_cost:10},{id:8,name_zh:"皇帝",name_en:"Emperor",icon:"🏰🫅",upgrade_cost:0}];function dk(n){return ck.find(e=>e.id===n)}function o5(n){return ck.find(e=>e.id===n+1)}function a5(n,e){const t=dk(e);return!!t&&t.upgrade_cost>0&&n>=t.upgrade_cost}const l5=g.createContext(void 0);function c5({children:n}){const[e,t]=g.useState(parseInt(localStorage.getItem("badges")||"0",10)),[i,s]=g.useState(parseInt(localStorage.getItem("rankId")||"1",10)),[o,a]=g.useState(!1);function l(){let h=e+1,p=i,f=!1;return a5(h,i)&&(p=i+1,h=0,f=!0,a(!0),setTimeout(()=>a(!1),3e3)),t(h),s(p),localStorage.setItem("badges",String(h)),localStorage.setItem("rankId",String(p)),f}const c=dk(i),u=o5(i);return r.jsx(l5.Provider,{value:{badges:e,rankId:i,rank:c,nextRank:u,promotion:o,addBadge:l,setBadges:t,setRankId:s},children:n})}const d5=g.createContext(null);function u5({children:n}){const e=g.useRef(null);return g.useEffect(()=>{try{return console.log("嘗試連接 WebSocket..."),e.current=new WebSocket(bE()),e.current.onopen=()=>{console.log("WebSocket 連接成功")},e.current.onerror=t=>{console.error("WebSocket 連接錯誤:",t)},e.current.onclose=()=>{console.log("WebSocket 連接關閉")},()=>{var t;return(t=e.current)==null?void 0:t.close()}}catch(t){console.error("WebSocket 初始化錯誤:",t)}},[]),r.jsx(d5.Provider,{value:e.current,children:n})}const Ht={backToHome:{"zh-TW":"返回","zh-CN":"返回",ja:"戻る",en:"Back",ko:"뒤로",th:"กลับ",vi:"Quay lại",ms:"Kembali",la:"Redire"},logout:{"zh-TW":"登出","zh-CN":"登出",ja:"ログアウト",en:"Logout",ko:"로그아웃",th:"ออกจากระบบ",vi:"Đăng xuất",ms:"Log keluar",la:"Exire"},pageTitle:{"zh-TW":"心情解鎖盒","zh-CN":"心情解锁盒",ja:"気持ちアンロックボックス",en:"Mood Unlock Box",ko:"감정 언락 박스",th:"กล่องปลดล็อกอารมณ์",vi:"Hộp Mở Khóa Cảm Xúc",ms:"Kotak Buka Kunci Emosi",la:"Arca Unlock Affectus"},subtitle:{"zh-TW":"每天自我反思，抒發心情，追蹤情緒，照顧自己","zh-CN":"每天自我反思，抒發心情，追蹤情緒，照顧自己",ja:"毎日自分を見つめ、気持ちを表現し、感情を追いかけ、自分を大切に",en:"Daily self-reflection, express your feelings, track emotions, take care of yourself",ko:"매일 자기 성찰, 감정 표현, 감정 추적, 자신을 돌보기",th:"สะท้อนตนเองทุกวัน ระบายความรู้สึก ติดตามอารมณ์ ดูแลตัวเอง",vi:"Tự phản ánh mỗi ngày, bày tỏ cảm xúc, theo dõi cảm xúc, chăm sóc bản thân",ms:"Refleksi diri setiap hari, luahkan perasaan, jejak emosi, jaga diri",la:"Cotidie te ipsum considera, affectus exprime, motus tuos persequere, te ipsum cura"},inputPlaceholder:{"zh-TW":"請寫下你的心情...(30字內)","zh-CN":"请写下你的心情...(30字内)",en:"Write your mood... (max 30 chars)",ja:"あなたの気持ちを書いてください...(30文字以内)",ko:"당신의 기분을 적어주세요...(30자 이내)",th:"เขียนความรู้สึกของคุณ...(ไม่เกิน 30 ตัวอักษร)",vi:"Hãy viết tâm trạng của bạn...(tối đa 30 ký tự)",ms:"Tulis perasaan anda...(maksimum 30 aksara)",la:"Animum tuum scribe...(max 30 litterae)"},plantButton:{"zh-TW":"記錄此刻心情","zh-CN":"记录此刻心情",ja:"今の気持ちを記録する",en:"Record Today's Mood",ko:"오늘의 기분 기록",th:"บันทึกอารมณ์วันนี้",vi:"Ghi lại tâm trạng hôm nay",ms:"Catat Perasaan Hari Ini",la:"Inscribere hodiernum animum"},completeTitle:{"zh-TW":"🎉 恭喜你完成拼圖！🎉","zh-CN":"🎉 恭喜你完成拼图！🎉",en:"🎉 Puzzle Completed! 🎉",ja:"🎉 パズル完成！🎉",ko:"🎉 퍼즐 완성! 🎉",th:"🎉 ต่อจิ๊กซอว์สำเร็จ! 🎉",vi:"🎉 Hoàn thành ghép hình! 🎉",ms:"🎉 Teka-teki Selesai! 🎉",la:"🎉 Puzzle Perfectum! 🎉"},completeDesc:{"zh-TW":"你已經解鎖全部心情拼圖，準備好迎接下一個挑戰了嗎？","zh-CN":"你已经解锁全部心情拼图，准备好迎接下一个挑战了吗？",en:"You have unlocked all mood puzzle pieces. Ready for the next challenge?",ja:"すべての気持ちパズルを解放しました。次のチャレンジの準備はできましたか？",ko:"모든 감정 퍼즐을 해제했습니다. 다음 도전을 준비하세요!",th:"คุณได้ปลดล็อกจิ๊กซอว์อารมณ์ทั้งหมดแล้ว พร้อมสำหรับความท้าทายถัดไปหรือยัง?",vi:"Bạn đã mở khóa tất cả các mảnh ghép cảm xúc. Sẵn sàng cho thử thách tiếp theo chưa?",ms:"Anda telah membuka semua kepingan teka-teki emosi. Sedia untuk cabaran seterusnya?",la:"Omnes partes animi puzzle aperuisti. Paratus es ad provocationem sequentem?"},nextChallenge:{"zh-TW":"前往{size}x{size}新挑戰","zh-CN":"前往{size}x{size}新挑战",en:"Next {size}x{size} Challenge",ja:"{size}x{size}新しいチャレンジへ",ko:"{size}x{size} 새 도전으로",th:"ไปยังความท้าทาย {size}x{size} ถัดไป",vi:"Thử thách {size}x{size} tiếp theo",ms:"Cabaran {size}x{size} Seterusnya",la:"Ad novam provocationem {size}x{size}"},encouragement:{"zh-TW":"有時候，記錄心情，就是給自己一份溫柔的陪伴。","zh-CN":"有时候，记录心情，就是给自己一份温柔的陪伴。",en:"Sometimes, recording your feelings is a gentle way to accompany yourself.",ja:"ときどき、気持ちを記録することは自分へのやさしい寄り添いです。",ko:"가끔은 마음을 기록하는 것이 자신에게 주는 따뜻한 동행입니다.",th:"บางครั้งการบันทึกความรู้สึก คือการมอบความอ่อนโยนให้ตัวเอง",vi:"Đôi khi, ghi lại cảm xúc là cách dịu dàng để đồng hành cùng chính mình.",ms:"Kadang-kadang, mencatat perasaan adalah teman yang lembut untuk diri sendiri.",la:"Aliquando, animum inscribere est tibi ipsum leniter comitari."},toastInput:{"zh-TW":"請先輸入你的心情！","zh-CN":"请先输入你的心情！",en:"Please enter your mood first!",ja:"まず気持ちを入力してください！",ko:"먼저 기분을 입력해주세요!",th:"กรุณากรอกความรู้สึกของคุณก่อน!",vi:"Vui lòng nhập tâm trạng của bạn trước!",ms:"Sila masukkan perasaan anda dahulu!",la:"Primum animum tuum inscribe!"},invalidMood:{"zh-TW":"請輸入有意義的心情內容（不能全是數字、符號或重複字元）","zh-CN":"请输入有意义的心情内容（不能全是数字、符号或重复字符）",en:"Please enter a meaningful mood (not just numbers, symbols, or repeated characters)",ja:"意味のある気持ちを入力してください（数字や記号、同じ文字だけは不可）",ko:"의미 있는 기분을 입력해주세요(숫자, 기호, 반복문자만은 불가)",th:"กรุณากรอกความรู้สึกที่มีความหมาย (ห้ามเป็นตัวเลข สัญลักษณ์ หรืออักษรซ้ำ)",vi:"Vui lòng nhập tâm trạng có ý nghĩa (không chỉ là số, ký hiệu hoặc ký tự lặp lại)",ms:"Sila masukkan perasaan yang bermakna (bukan hanya nombor, simbol atau aksara berulang)",la:"Sententiam significantem inscribe (non solum numeri, signa aut litterae repetitae)"},completeNext:{"zh-TW":"已完成本關，請點擊前往新挑戰","zh-CN":"已完成本关，请点击前往新挑战",en:"Puzzle completed! Please proceed to the next challenge.",ja:"このステージはクリアしました。次のチャレンジへ進んでください。",ko:"이 단계는 완료되었습니다. 다음 도전으로 이동하세요.",th:"คุณผ่านด่านนี้แล้ว กรุณาไปยังความท้าทายถัดไป",vi:"Bạn đã hoàn thành màn này, hãy chuyển sang thử thách tiếp theo.",ms:"Tahap ini telah selesai. Sila ke cabaran seterusnya.",la:"Hoc gradum perfecisti. Ad provocationem sequentem procede."},finalCompleteTitle:{"zh-TW":"🎉🎉 你已經完成所有心情拼圖！ 🎉🎉","zh-CN":"🎉🎉 你已经完成所有心情拼图！ 🎉🎉",en:"🎉🎉 You have completed all mood puzzles! 🎉🎉",ja:"🎉🎉 すべての気持ちパズルを完成しました！ 🎉🎉",ko:"🎉🎉 모든 감정 퍼즐을 완성했습니다! 🎉🎉",th:"🎉🎉 คุณได้ต่อจิ๊กซอว์อารมณ์ครบทุกชิ้นแล้ว! 🎉🎉",vi:"🎉🎉 Bạn đã hoàn thành tất cả các mảnh ghép cảm xúc! 🎉🎉",ms:"🎉🎉 Anda telah melengkapkan semua teka-teki emosi! 🎉🎉",la:"🎉🎉 Omnes partes animi puzzle perfecisti! 🎉🎉"},finalCompleteDesc:{"zh-TW":"你已經解鎖所有拼圖碎片，這是屬於你的堅持與成就！請繼續相信自己，未來每一天都值得被記錄與慶祝！","zh-CN":"你已经解锁所有拼图碎片，这是属于你的坚持与成就！请继续相信自己，未来每一天都值得被记录与庆祝！",en:"You have unlocked every puzzle piece. This is your perseverance and achievement! Keep believing in yourself—every day ahead is worth celebrating!",ja:"すべてのピースをアンロックしました。これはあなたの努力と成果です！これからも自分を信じて、毎日を大切にしてください！",ko:"모든 퍼즐 조각을 해제했습니다. 이것은 당신의 끈기와 성취입니다! 앞으로도 자신을 믿고, 매일을 소중히 하세요!",th:"คุณได้ปลดล็อกจิ๊กซอว์ทุกชิ้นแล้ว นี่คือความพยายามและความสำเร็จของคุณ! จงเชื่อมั่นในตัวเองและเฉลิมฉลองทุกวัน!",vi:"Bạn đã mở khóa mọi mảnh ghép. Đây là sự kiên trì và thành tựu của bạn! Hãy tiếp tục tin vào bản thân và ăn mừng mỗi ngày!",ms:"Anda telah membuka semua kepingan teka-teki. Ini adalah ketabahan dan pencapaian anda! Teruskan percaya pada diri sendiri dan raikan setiap hari!",la:"Omnia fragmenta aenigmatis aperuisti. Haec est constantia et perfectio tua! Crede tibi et diem quemque celebra!"}};function h5(){var Y;const n=$e(),e=Je(),{lang:t,setLang:i}=Qe(),[s,o]=g.useState(""),[a,l]=g.useState(!1),[c,u]=g.useState([]),h=((Y=e.currentUser)==null?void 0:Y.uid)||"",[p,f]=g.useState(!1),[b,x]=g.useState(""),S=new Date().toISOString().slice(0,10);g.useEffect(()=>{h&&fetch(`/api/mood?userId=${h}`).then(X=>X.json()).then(X=>u(X))},[h]);const[w,I]=Kt.useState(()=>{const X=localStorage.getItem("puzzleStage");return X?JSON.parse(X):{size:3,unlocked:0,completed:!1,lastDate:""}});Kt.useEffect(()=>{localStorage.setItem("puzzleStage",JSON.stringify(w))},[w]);const j=w.size||3,A=j+1,O=`/puzzle${j-2}.png`,P=j,B=P*P;function k(X){return Array.from({length:B},(le,be)=>be<X)}function T(){const X={size:A,unlocked:0,completed:!1,lastDate:new Date().toISOString().slice(0,10)};I(X),u([]),L(null)}const R=async()=>{if(!h){x("請先登入才能解鎖拼圖"),f(!0),setTimeout(()=>f(!1),2e3);return}let X=!1;if(w.lastDate===S&&(X=!0),!X&&Array.isArray(c)){for(const be of c)if(be&&Array.isArray(be.petals)&&be.petals.some(ve=>typeof ve.date=="string"&&ve.date.slice(0,10)===S)){X=!0;break}}if(!X){const be=`mood_${h}_${S}`;localStorage.getItem(be)&&(X=!0)}if(X){x("今天已經記錄過心情了，明天再來解鎖新的拼圖吧！✨"),f(!0),setTimeout(()=>f(!1),2e3);return}if(ee){x(Ht.completeNext[t]),f(!0),setTimeout(()=>f(!1),2e3);return}if(!s){x(Ht.toastInput[t]),f(!0),setTimeout(()=>f(!1),2e3);return}const le=s.replace(/\s/g,"");if(/^\d+$/.test(le)){x(Ht.invalidMood[t]),f(!0),setTimeout(()=>f(!1),2e3);return}if(/^[\p{P}\p{S}]+$/u.test(le)){x(Ht.invalidMood[t]),f(!0),setTimeout(()=>f(!1),2e3);return}if(le.length>=4&&/^(.)\1+$/.test(le)){x(Ht.invalidMood[t]),f(!0),setTimeout(()=>f(!1),2e3);return}if(le.length<4){x(Ht.invalidMood[t]),f(!0),setTimeout(()=>f(!1),2e3);return}l(!0);try{await fetch("/api/mood",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:h,mood:s,date:new Date().toISOString().slice(0,10)+"-"+Math.random()})}),o(""),fetch(`/api/mood?userId=${h}`).then(Ve=>Ve.json()).then(Ve=>u(Ve)),l(!1),I(Ve=>({...Ve,unlocked:Ve.unlocked+1,lastDate:new Date().toISOString().slice(0,10)}));const be=`mood_${h}_${S}`;localStorage.setItem(be,JSON.stringify({date:S,mood:s,timestamp:Date.now()}));const ve=new Date,Me=ve.getDay();L({date:ve.toISOString().slice(0,10),mood:te[Me],isTodayNewPiece:!0})}catch{l(!1),x("解鎖失敗，請稍後再試"),f(!0),setTimeout(()=>f(!1),2e3)}},E=w.unlocked,_=k(E),[v,z]=Kt.useState(!1),[H,L]=Kt.useState(null),ee=E>=B;function ge(){const X={size:3,unlocked:0,completed:!1,lastDate:""};localStorage.setItem("puzzleStage",JSON.stringify(X)),window.location.reload()}function oe(){const X={...w,unlocked:0,lastDate:""};localStorage.setItem("puzzleStage",JSON.stringify(X)),window.location.reload()}const Ie={};if(Array.isArray(c)&&(console.log("處理 garden 數據，項目數量:",c.length),c.forEach((X,le)=>{console.log(`garden[${le}]:`,X);let be=null;X&&Array.isArray(X.petals)?be=X.petals:X&&Array.isArray(X)?be=X:X&&typeof X=="object"&&X.mood&&X.date&&(be=[X]),be?(console.log("找到 petals 數據:",be),be.forEach((ve,Me)=>{if(console.log(`petal[${Me}]:`,ve),ve&&typeof ve.mood=="string"&&typeof ve.date=="string"){const Ve=ve.date.slice(0,10);Ie[Ve]={mood:ve.mood,date:Ve},console.log("成功解析心情數據:",{date:Ve,mood:ve.mood})}else ve&&typeof ve=="object"&&console.log("petal 結構不符合預期:",ve)})):console.log("未找到有效的 petals 數據結構")})),Object.keys(Ie).length===0){console.log("嘗試從本地存儲獲取心情數據...");for(let X=0;X<localStorage.length;X++){const le=localStorage.key(X);if(le&&le.startsWith("mood_"))try{const be=JSON.parse(localStorage.getItem(le)||"{}");if(be.date&&be.mood){const ve=be.date.slice(0,10);Ie[ve]={mood:be.mood,date:ve}}}catch{console.log("解析本地存儲數據失敗:",le)}}}const Re=Object.values(Ie).sort((X,le)=>X.date.localeCompare(le.date));console.log("DEBUG garden:",c),console.log("DEBUG moodByDate:",Ie),console.log("DEBUG allPetals:",Re);const te=["明天記得再來喔 🌈","每天一點點，心情拼圖就會完成！🧩","你的心情很重要，明天也來記錄吧！📝","給自己一個鼓勵，明天見！💪","一天一片，慢慢拼出美好心情！🌟","明天再來解鎖新拼圖吧！🔓","保持好心情，明天繼續加油！😊"],W={"zh-TW":"用心情解鎖拼圖","zh-CN":"用心情解锁拼图",en:"Unlock puzzles with your mood",ja:"気持ちでパズルを解こう",ko:"마음으로 퍼즐을 해제하세요",th:"ปลดล็อกจิ๊กซอว์ด้วยอารมณ์",vi:"Mở khóa ghép hình bằng cảm xúc",ms:"Buka teka-teki dengan perasaan",la:"Affectibus tuis aenigmata solve"};return r.jsxs("div",{style:{width:"100vw",position:"relative",overflowX:"hidden",background:"url('/snowmountain.png') center center / cover no-repeat fixed, linear-gradient(to bottom, #eaf6ff 0%, #f7fafc 100%)",minHeight:"0"},children:[p&&r.jsx("div",{style:{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",background:"rgba(255,255,255,0.98)",color:"#6B5BFF",fontWeight:700,fontSize:20,padding:"28px 48px",borderRadius:18,boxShadow:"0 4px 32px #6B5BFF33",zIndex:3e3,textAlign:"center",letterSpacing:1.5,transition:"opacity 0.3s"},children:b}),r.jsxs("div",{style:{width:"100%",maxWidth:700,margin:"20px auto 20px auto",padding:"16px 24px",background:"rgba(255,255,255,0.95)",borderRadius:16,boxShadow:"0 4px 20px rgba(0,0,0,0.1)",display:"flex",alignItems:"center",justifyContent:"space-between",position:"relative"},children:[r.jsx("button",{className:"topbar-btn",onClick:()=>n("/"),style:{fontWeight:700,fontSize:16,padding:"8px 16px",borderRadius:8,border:"1.5px solid #6B5BFF",background:"#fff",color:"#6B5BFF",cursor:"pointer",minWidth:80},children:Ht.backToHome[t]}),r.jsxs("h1",{style:{fontWeight:900,fontSize:18,color:"#6B5BFF",margin:0,lineHeight:1,textShadow:"0 2px 8px #6B5BFF88",textAlign:"center",flex:1},children:[r.jsx("span",{role:"img","aria-label":"mood",children:"🌱"})," ",Ht.pageTitle[t]]}),r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[r.jsx("button",{className:"topbar-btn",onClick:async()=>{await hn(e),localStorage.clear(),window.location.href="/"},style:{fontWeight:700,fontSize:16,padding:"8px 16px",borderRadius:8,border:"1.5px solid #6B5BFF",background:"#fff",color:"#6B5BFF",cursor:"pointer",minWidth:80},children:Ht.logout[t]}),r.jsx(en,{style:{width:80,height:"auto",padding:"8px 16px",fontSize:16,fontWeight:700,borderRadius:8,border:"1.5px solid #6B5BFF",background:"#fff",color:"#6B5BFF",cursor:"pointer",minWidth:80}})]})]}),r.jsxs("div",{style:{maxWidth:700,margin:"0 auto 0 auto",padding:"1.2rem 2vw 0 2vw",background:"rgba(255,255,255,0.92)",borderRadius:24,boxShadow:"0 8px 32px rgba(0,0,0,0.08)",position:"relative"},children:[r.jsx("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center",gap:12,flexWrap:"nowrap",marginBottom:8},children:r.jsx("span",{style:{fontSize:15,color:"#888",fontWeight:700,letterSpacing:1,textShadow:"0 2px 12px #6B5BFF55",whiteSpace:"nowrap"},children:W[t]||W.en})}),r.jsx("div",{style:{color:"#888",fontSize:18,marginBottom:0,textAlign:"center",fontWeight:700,letterSpacing:1,textShadow:"0 2px 12px #6B5BFF55"},children:Ht.subtitle[t]}),r.jsxs("div",{style:{width:"100%",textAlign:"center",color:"#232323",fontSize:17,fontWeight:500,margin:"0 0 10px 0",letterSpacing:.5,lineHeight:1.5,textShadow:"0 2px 8px #bbb8"},children:[Ht.encouragement[t],r.jsx("span",{role:"img","aria-label":"rainbow",children:"🌈"})]}),r.jsxs("div",{style:{display:"flex",flexDirection:"row",alignItems:"flex-end",gap:12,width:"100%",justifyContent:"center",marginBottom:8},children:[r.jsx("textarea",{value:s,onChange:X=>o(X.target.value),placeholder:Ht.inputPlaceholder[t],maxLength:30,rows:3,style:{width:260,minWidth:180,maxWidth:320,padding:12,borderRadius:8,border:"1.5px solid #ddd",fontSize:16,resize:"vertical",marginRight:0}}),r.jsx("button",{onClick:R,disabled:a,style:{width:140,minWidth:100,padding:"14px 0",background:a?"#ccc":"linear-gradient(135deg, #6B5BFF 60%, #23c6e6 100%)",color:"#fff",border:"none",borderRadius:10,fontWeight:900,fontSize:16,letterSpacing:1,cursor:a?"not-allowed":"pointer",transition:"all 0.2s ease",marginLeft:0,marginBottom:0},children:a?"...":Ht.plantButton[t]})]}),r.jsx("div",{style:{borderTop:"1px solid #eee",margin:"16px 0"}}),r.jsx("div",{children:r.jsxs("div",{style:{minHeight:0,background:"#f0f8ff",borderRadius:12,display:"block",color:"#aaa",position:"relative",width:"100%",maxWidth:540,overflow:"hidden",margin:"0 auto",padding:"0 0 24px 0"},children:[r.jsx("div",{style:{display:"grid",gridTemplateColumns:`repeat(${P}, 1fr)`,gridTemplateRows:`repeat(${P}, 1fr)`,width:"100%",maxWidth:"100%",margin:"0 auto",aspectRatio:"1 / 1",position:"relative",zIndex:1,gap:0,background:"#fff",boxShadow:"0 2px 24px #6B5BFF22",boxSizing:"border-box"},children:_.map((X,le)=>{const be=Re[le]||null,ve=(be==null?void 0:be.mood)||"",Me=(be==null?void 0:be.date)||"",Ve=Math.floor(le/P),ie=le%P,$=X&&!!be;return r.jsxs("div",{style:{width:"100%",height:"100%",aspectRatio:"1/1",overflow:"hidden",position:"relative",border:"none",boxSizing:"border-box",cursor:$?"pointer":"default",display:"flex",alignItems:"center",justifyContent:"center"},onClick:()=>{console.log("點擊拼圖:",{idx:le,canClick:$,petal:be,date:Me,mood:ve}),$&&(console.log("設置 showInfo:",{date:Me,mood:ve}),L({date:Me,mood:ve}))},children:[r.jsx("img",{src:O,alt:"puzzle",style:{width:`calc(100% * ${P})`,height:`calc(100% * ${P})`,objectFit:"cover",position:"absolute",left:`-${ie*100}%`,top:`-${Ve*100}%`,filter:X?"none":"blur(8px) grayscale(1) brightness(1.2)",opacity:X?1:.5,transition:"filter 0.3s, opacity 0.3s"}}),!X&&r.jsx("div",{style:{position:"absolute",inset:0,background:"rgba(255,255,255,0.7)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:32},children:"?"})]},le)})}),H&&!ee&&r.jsx("div",{style:{position:"fixed",left:0,top:0,width:"100vw",height:"100vh",zIndex:2e3,display:"flex",alignItems:"center",justifyContent:"center"},onClick:()=>L(null),children:r.jsxs("div",{style:{background:"#fff",borderRadius:16,padding:"32px 40px",boxShadow:"0 4px 32px #0008",minWidth:260,maxWidth:320,textAlign:"center",fontSize:18,fontWeight:700},children:[r.jsx("div",{style:{fontSize:16,color:"#6B5BFF",marginBottom:8},children:H.date}),r.jsx("div",{style:{fontSize:22,color:"#232946",marginBottom:8},children:H.mood}),H.isTodayNewPiece&&r.jsx("div",{style:{fontSize:15,color:"#888",marginTop:8},children:"(一天只能解鎖一片，明天再來！)"}),r.jsx("div",{style:{fontSize:14,color:"#888"},children:"（點擊空白處關閉）"})]})}),ee&&r.jsx(r.Fragment,{children:r.jsx("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",zIndex:2,pointerEvents:"auto",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",textAlign:"center",background:"rgba(255,255,255,0.0)"},children:w.size===22?r.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",width:"100%",maxWidth:"90vw",margin:"0 auto"},children:[r.jsx("div",{style:{fontSize:32,fontWeight:900,color:"#ff9800",textShadow:"0 2px 12px #fff,0 4px 24px #ff980088",letterSpacing:2,marginBottom:12,lineHeight:1.2,wordBreak:"break-word",maxWidth:"100%"},children:Ht.finalCompleteTitle[t]}),r.jsx("div",{style:{fontSize:18,fontWeight:600,color:"#6B5BFF",textShadow:"0 2px 12px #6B5BFF88",letterSpacing:1,lineHeight:1.5,wordBreak:"break-word",maxWidth:"100%",marginBottom:24},children:Ht.finalCompleteDesc[t]}),r.jsx("button",{onClick:ge,style:{padding:"14px 40px",background:"linear-gradient(135deg,#6B5BFF 60%,#23c6e6 100%)",color:"#fff",border:"none",borderRadius:16,fontWeight:900,fontSize:22,boxShadow:"0 2px 12px #6B5BFF44",cursor:"pointer",letterSpacing:2,transition:"transform 0.2s",outline:"none",display:"block"},children:"再來一次"})]}):r.jsxs(r.Fragment,{children:[r.jsx("div",{style:{position:"relative",fontSize:24,fontWeight:900,color:"#ff9800",textShadow:"0 2px 12px #fff,0 4px 24px #ff980088",transform:"scale(0.7)",opacity:1,animation:"flyIn1 0.5s 0.1s cubic-bezier(.68,-0.55,.27,1.55) forwards"},children:Ht.completeTitle[t]}),r.jsx("div",{style:{position:"relative",fontSize:20,fontWeight:700,color:"#6B5BFF",marginTop:18,opacity:0,animation:"flyIn2 0.5s 0.6s cubic-bezier(.68,-0.55,.27,1.55) forwards"},children:Ht.completeDesc[t]}),r.jsx("div",{style:{position:"relative",marginTop:32,opacity:0,animation:"flyIn3 0.5s 1.1s cubic-bezier(.68,-0.55,.27,1.55) forwards"},children:r.jsx("button",{type:"button",onClick:T,style:{padding:"18px 48px",background:"linear-gradient(135deg,#6B5BFF 60%,#23c6e6 100%)",color:"#fff",borderRadius:16,fontWeight:900,fontSize:24,boxShadow:"0 2px 12px #6B5BFF44",border:"none",cursor:"pointer",letterSpacing:2,transition:"transform 0.2s",outline:"none",display:"block"},children:Ht.nextChallenge[t].replace(/\{size\}/g,String(A))})}),r.jsx("style",{children:`
@keyframes flyIn1 { from { opacity:0; transform:translateY(40px) scale(0.7);} to { opacity:1; transform:translateY(0) scale(1);} }
@keyframes flyIn2 { from { opacity:0; transform:translateY(40px) scale(0.7);} to { opacity:1; transform:translateY(0) scale(1);} }
@keyframes flyIn3 { from { opacity:0; transform:translateY(40px) scale(0.7);} to { opacity:1; transform:translateY(0) scale(1);} }
`})]})})})]})})]}),r.jsx("div",{style:{width:"100%",maxWidth:700,margin:"20px auto 0 auto",background:"rgba(255,255,255,0.95)",borderRadius:16,padding:"16px",boxShadow:"0 2px 12px #6B5BFF22"},children:r.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:12,flexWrap:"wrap"},children:[r.jsx("button",{onClick:oe,style:{padding:"8px 16px",background:"linear-gradient(135deg,#ff6b6b 60%,#ff8e8e 100%)",color:"#fff",border:"none",borderRadius:8,fontWeight:700,fontSize:14,cursor:"pointer",letterSpacing:1},children:"清理當前拼圖"}),r.jsx("button",{onClick:ge,style:{padding:"8px 16px",background:"linear-gradient(135deg,#4ecdc4 60%,#6bcfc4 100%)",color:"#fff",border:"none",borderRadius:8,fontWeight:700,fontSize:14,cursor:"pointer",letterSpacing:1},children:"重置到第一關"})]})}),r.jsx("div",{style:{width:"100%",margin:"0 auto",marginTop:24,background:"rgba(255,255,255,0.95)",borderRadius:16,padding:"16px",boxShadow:"0 2px 12px #6B5BFF22"},children:r.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:20,flexWrap:"wrap"},children:[r.jsx("span",{onClick:()=>n("/about"),style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12,cursor:"pointer"},children:t==="zh-TW"?"🧬 Restarter™｜我們是誰":t==="zh-CN"?"🧬 Restarter™｜我们是谁":t==="en"?"🧬 Restarter™｜Who We Are":t==="ja"?"🧬 Restarter™｜私たちについて":t==="ko"?"🧬 Restarter™｜우리는 누구인가":t==="th"?"🧬 Restarter™｜เราเป็นใคร":t==="vi"?"🧬 Restarter™｜Chúng tôi là ai":t==="ms"?"🧬 Restarter™｜Siapa Kami":"🧬 Restarter™｜Quis sumus"}),r.jsx("span",{onClick:()=>n("/privacy-policy"),style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12,cursor:"pointer"},children:t==="zh-TW"?"隱私權政策":t==="zh-CN"?"隐私政策":t==="en"?"Privacy Policy":t==="ja"?"プライバシーポリシー":t==="ko"?"개인정보 처리방침":t==="th"?"นโยบายความเป็นส่วนตัว":t==="vi"?"Chính sách bảo mật":t==="ms"?"Dasar Privasi":"Consilium de Privata"}),r.jsx("span",{onClick:()=>n("/terms"),style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12,cursor:"pointer"},children:t==="zh-TW"?"條款/聲明":t==="zh-CN"?"条款/声明":t==="en"?"Terms/Statement":t==="ja"?"規約/声明":t==="ko"?"약관/성명":t==="th"?"ข้อกำหนด/แถลงการณ์":t==="vi"?"Điều khoản/Tuyên bố":t==="ms"?"Terma/Pernyataan":"Termini/Declaratio"}),r.jsx("span",{onClick:()=>n("/data-deletion"),style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12,cursor:"pointer"},children:t==="zh-TW"?"資料刪除說明":t==="zh-CN"?"数据删除说明":t==="en"?"Data Deletion":t==="ja"?"データ削除について":t==="ko"?"데이터 삭제 안내":t==="th"?"คำอธิบายการลบข้อมูล":t==="vi"?"Giải thích xóa dữ liệu":t==="ms"?"Penjelasan Penghapusan Data":"Explicatio Deletionis Datae"}),r.jsx("span",{onClick:()=>n("/feedback"),style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12,cursor:"pointer"},children:t==="zh-TW"?"💬 意見箱｜我們想聽你說":t==="zh-CN"?"💬 意见箱｜我们想听你说":t==="en"?"💬 Feedback Box｜We Want to Hear From You":t==="ja"?"💬 ご意見箱｜私たちはあなたの声を聞きたい":t==="ko"?"💬 피드백｜우리는 당신의 말을 듣고 싶습니다":t==="th"?"💬 กล่องความคิดเห็น｜เราอยากได้ยินจากคุณ":t==="vi"?"💬 Hộp góp ý｜Chúng tôi muốn nghe từ bạn":t==="ms"?"💬 Kotak Maklum Balas｜Kami Ingin Mendengar Dari Anda":"💬 Arca Consilii｜Volumus Audire a Te"})]})})]})}const Tl={"zh-TW":{back:"← 返回上一頁",title:"聊天室",send:"送出",placeholder:"輸入訊息..."},"zh-CN":{back:"← 返回上一页",title:"聊天室",send:"发送",placeholder:"输入信息..."},en:{back:"← Back",title:"Chat Room",send:"Send",placeholder:"Type a message..."},ja:{back:"← 前のページへ",title:"チャットルーム",send:"送信",placeholder:"メッセージを入力..."},ko:{back:"← 이전 페이지",title:"채팅방",send:"보내기",placeholder:"메시지 입력..."},th:{back:"← กลับ",title:"ห้องแชท",send:"ส่ง",placeholder:"พิมพ์ข้อความ..."},vi:{back:"← Quay lại",title:"Phòng chat",send:"Gửi",placeholder:"Nhập tin nhắn..."},ms:{back:"← Kembali",title:"Bilik Sembang",send:"Hantar",placeholder:"Taip mesej..."},la:{back:"← Redire",title:"Cella Colloquii",send:"Mitte",placeholder:"Nuntium insere..."}};function p5({open:n,onClose:e,roomId:t,friendName:i}){const[s,o]=g.useState(!1),[a,l]=g.useState(!0),[c,u]=g.useState(""),[h,p]=g.useState([]),f=g.useRef(null),b=g.useRef(null),[x,S]=g.useState(null);g.useEffect(()=>{n&&w()},[n]);const w=async()=>{try{const O=await navigator.mediaDevices.getUserMedia({video:!0,audio:!0});S(O),f.current&&(f.current.srcObject=O);const P=O.getAudioTracks()[0];P&&(P.enabled=!1)}catch(O){console.error("無法取得視訊權限:",O),alert("無法取得視訊權限，請檢查瀏覽器設定")}},I=()=>{if(x){const O=x.getAudioTracks()[0];O&&(O.enabled=!O.enabled,o(O.enabled))}},j=()=>{if(x){const O=x.getVideoTracks()[0];O&&(O.enabled=!O.enabled,l(O.enabled))}},A=()=>{if(c.trim()){const O={id:Date.now().toString(),text:c,sender:"我",time:new Date().toLocaleTimeString()};p(P=>[...P,O]),u("")}},D=O=>{O.key==="Enter"&&A()};return n?r.jsx("div",{style:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",background:"#0007",zIndex:9999,display:"flex",alignItems:"center",justifyContent:"center"},children:r.jsxs("div",{style:{background:"#fff",borderRadius:16,padding:24,boxShadow:"0 2px 16px #0003",width:"80%",maxWidth:800,height:"80%",maxHeight:600,position:"relative",display:"flex",flexDirection:"column"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[r.jsx("h2",{style:{color:"#6B5BFF",fontWeight:700,fontSize:20,margin:0},children:"免費一對一視訊聊天"}),r.jsx("button",{onClick:e,style:{background:"#eee",border:"none",borderRadius:8,padding:"6px 14px",fontWeight:700,cursor:"pointer"},children:"關閉"})]}),r.jsxs("div",{style:{display:"flex",flex:1,gap:16},children:[r.jsxs("div",{style:{flex:2,display:"flex",flexDirection:"column",gap:12},children:[r.jsxs("div",{style:{display:"flex",gap:12,flex:1},children:[r.jsxs("div",{style:{flex:1},children:[r.jsx("div",{style:{fontWeight:700,marginBottom:8,fontSize:14},children:"我"}),r.jsx("video",{ref:f,autoPlay:!0,playsInline:!0,muted:!0,style:{width:"100%",height:120,background:"#000",borderRadius:8,objectFit:"cover",transform:"scaleX(-1)"}})]}),r.jsxs("div",{style:{flex:1},children:[r.jsx("div",{style:{fontWeight:700,marginBottom:8,fontSize:14},children:i}),r.jsx("video",{ref:b,autoPlay:!0,playsInline:!0,style:{width:"100%",height:120,background:"#000",borderRadius:8,objectFit:"cover"}})]})]}),r.jsxs("div",{style:{display:"flex",gap:8,justifyContent:"center"},children:[r.jsx("button",{onClick:I,style:{background:"#6B5BFF",color:"#fff",border:"none",borderRadius:6,padding:"8px 16px",fontWeight:700,fontSize:14,cursor:"pointer"},children:s?"關閉語音":"開啟語音"}),r.jsx("button",{onClick:j,style:{background:"#6B5BFF",color:"#fff",border:"none",borderRadius:6,padding:"8px 16px",fontWeight:700,fontSize:14,cursor:"pointer"},children:a?"關閉視訊":"開啟視訊"})]})]}),r.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",border:"1px solid #eee",borderRadius:8,padding:12},children:[r.jsx("div",{style:{fontWeight:700,marginBottom:8,fontSize:14},children:"即時聊天"}),r.jsx("div",{style:{flex:1,background:"#f7f7f7",borderRadius:6,padding:8,marginBottom:8,overflowY:"auto",minHeight:100},children:h.length===0?r.jsx("div",{style:{fontSize:12,color:"#666",textAlign:"center",marginTop:20},children:"視訊聊天中，可以同時打字聊天"}):h.map(O=>r.jsxs("div",{style:{marginBottom:8,fontSize:12},children:[r.jsx("div",{style:{fontWeight:600,color:"#6B5BFF"},children:O.sender}),r.jsx("div",{style:{color:"#333",marginTop:2},children:O.text}),r.jsx("div",{style:{fontSize:10,color:"#999",marginTop:2},children:O.time})]},O.id))}),r.jsxs("div",{style:{display:"flex",gap:8},children:[r.jsx("input",{value:c,onChange:O=>u(O.target.value),onKeyPress:D,placeholder:"輸入訊息...",style:{flex:1,borderRadius:6,border:"1px solid #ccc",padding:"6px 8px",fontSize:12}}),r.jsx("button",{onClick:A,style:{background:"#6B5BFF",color:"#fff",border:"none",borderRadius:6,padding:"6px 12px",fontWeight:700,fontSize:12,cursor:"pointer"},children:"發送"})]})]})]})]})}):null}function m5(){const[n,e]=g.useState([]),[t,i]=g.useState(null),[s,o]=g.useState([]),[a,l]=g.useState(""),{lang:c,setLang:u}=Qe(),[h,p]=g.useState(null),[f,b]=g.useState(!0),x=g.useRef(null),S=$e(),[w,I]=g.useState(!1),{isTestMode:j}=ji();g.useEffect(()=>{const P=ur(_r,async B=>{B?(p(B),await A(B.uid)):S("/")});return()=>P()},[S]);const A=async P=>{b(!0);const B=Wt(ht,"links"),k=un(B,Lt("user1Id","==",P),Lt("status","==","connected")),T=un(B,Lt("user2Id","==",P),Lt("status","==","connected")),[R,E]=await Promise.all([kn(k),kn(T)]),_=new Set;R.forEach(z=>_.add(z.data().user2Id)),E.forEach(z=>_.add(z.data().user1Id));const v=[];for(const z of _){const H=Ot(ht,"profiles",z),L=await fi(H);if(L.exists()){const ee=L.data();v.push({id:z,name:ee.name||"好友",avatar:ee.avatar||"/avatars/Derxl.png",online:!!ee.online})}}if(j&&v.push({id:"test-friend-1",name:"測試好友 1",avatar:"/avatars/Annie.png",online:!0},{id:"test-friend-2",name:"測試好友 2",avatar:"/avatars/Bray.png",online:!1},{id:"test-friend-3",name:"測試好友 3",avatar:"/avatars/berlex.png",online:!0}),e(v),b(!1),j&&v.length>0){const z=v.find(H=>H.id.startsWith("test-friend-"));z&&i(z)}};g.useEffect(()=>{if(h&&t){if(b(!0),j&&t.id.startsWith("test-friend-")){const T=[{id:"test-msg-1",fromUserId:t.id,fromUserName:t.name,toUserId:h.uid,toUserName:h.displayName||"我",text:"你好！很高興認識你 😊",participants:[h.uid,t.id],createdAt:new Date(Date.now()-3e5)},{id:"test-msg-2",fromUserId:h.uid,fromUserName:h.displayName||"我",toUserId:t.id,toUserName:t.name,text:"你好！我也很高興認識你 👋",participants:[h.uid,t.id],createdAt:new Date(Date.now()-24e4)},{id:"test-msg-3",fromUserId:t.id,fromUserName:t.name,toUserId:h.uid,toUserName:h.displayName||"我",text:"今天天氣真不錯，你有什麼計劃嗎？",participants:[h.uid,t.id],createdAt:new Date(Date.now()-18e4)},{id:"test-msg-4",fromUserId:h.uid,fromUserName:h.displayName||"我",toUserId:t.id,toUserName:t.name,text:"我想去公園散步，你要一起嗎？",participants:[h.uid,t.id],createdAt:new Date(Date.now()-12e4)},{id:"test-msg-5",fromUserId:t.id,fromUserName:t.name,toUserId:h.uid,toUserName:h.displayName||"我",text:"好啊！聽起來很有趣 🌳",participants:[h.uid,t.id],createdAt:new Date(Date.now()-6e4)}];o(T),b(!1);return}const P=Wt(ht,"messages"),B=un(P,Lt("participants","array-contains",h.uid),lc("createdAt","asc")),k=up(B,T=>{const R=[];T.forEach(E=>{const _=E.data();_.participants.includes(t.id)&&R.push({..._,id:E.id})}),o(R),b(!1)});return()=>k()}},[h,t,j]),g.useEffect(()=>{var P;(P=x.current)==null||P.scrollIntoView({behavior:"smooth"})},[s]);const D=async()=>{if(!(!a.trim()||!h||!t)){if(j&&t.id.startsWith("test-friend-")){const P={id:`test-msg-${Date.now()}`,fromUserId:h.uid,fromUserName:h.displayName||"我",toUserId:t.id,toUserName:t.name,text:a,participants:[h.uid,t.id],createdAt:new Date};o(B=>[...B,P]),l("");return}try{const P={fromUserId:h.uid,fromUserName:h.displayName||"我",toUserId:t.id,toUserName:t.name,text:a,participants:[h.uid,t.id],createdAt:pp()};await $i(Wt(ht,"messages"),P),l("")}catch{alert("發送訊息失敗")}}},O=P=>{P.key==="Enter"&&!P.shiftKey&&(P.preventDefault(),D())};return f?r.jsx("div",{style:{background:"url('/green_hut.png') center center / cover no-repeat",minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center"},children:r.jsx("div",{style:{color:"#fff",fontSize:18},children:"載入中..."})}):r.jsxs("div",{style:{background:"url('/green_hut.png') center center / cover no-repeat",minHeight:"100vh",display:(window.innerWidth<=768,"flex"),flexDirection:window.innerWidth<=768?"column":"row",alignItems:window.innerWidth<=768?"center":"flex-start",justifyContent:"center",paddingTop:window.innerWidth<=768?20:40,position:"relative"},children:[r.jsx("button",{onClick:()=>S("/friend"),style:{position:"fixed",top:24,left:24,zIndex:10001,background:"#fff",border:"1.5px solid #6B5BFF",color:"#6B5BFF",borderRadius:8,padding:"6px 18px",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:"0 2px 8px #0001"},children:"返回上一頁"}),window.innerWidth<=768?r.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:20,justifyContent:"center",alignItems:"center",width:"100%",maxWidth:400,padding:"20px"},children:[j&&r.jsxs("div",{style:{background:"rgba(255,255,255,0.9)",padding:"8px 12px",borderRadius:8,fontSize:12,color:"#666",marginBottom:10},children:["測試模式：好友數量 ",n.length,"，選中好友 ",(t==null?void 0:t.name)||"無"]}),r.jsxs("div",{style:{background:"rgba(255,255,255,0.95)",borderRadius:16,padding:"24px",boxShadow:"0 8px 24px rgba(0,0,0,0.3)",width:"95%",maxWidth:320,border:"2px solid rgba(107,91,255,0.3)"},children:[r.jsx("div",{style:{fontWeight:800,fontSize:22,color:"#6B5BFF",marginBottom:16,textAlign:"center",textShadow:"0 1px 2px rgba(0,0,0,0.1)"},children:"好友列表"}),r.jsx("div",{style:{textAlign:"center",color:"#333",fontSize:16,lineHeight:1.5,fontWeight:500,marginBottom:16},children:n.length===0?j?"測試模式已啟用，但沒有測試好友":"請先加好友,才能開始聊天":"選擇好友開始聊天"}),n.length>0&&r.jsx("div",{style:{maxHeight:200,overflowY:"auto"},children:n.map(P=>r.jsxs("div",{onClick:()=>P.online&&i(P),style:{display:"flex",alignItems:"center",gap:12,marginBottom:12,cursor:P.online?"pointer":"not-allowed",padding:"8px",borderRadius:8,background:(t==null?void 0:t.id)===P.id?"rgba(107,91,255,0.1)":"transparent",border:(t==null?void 0:t.id)===P.id?"1px solid #6B5BFF":"1px solid transparent",opacity:P.online?1:.5},children:[r.jsx("img",{src:P.avatar,alt:P.name,style:{width:36,height:36,borderRadius:"50%",filter:P.online?"none":"grayscale(1)",border:(t==null?void 0:t.id)===P.id?"2px solid #6B5BFF":"2px solid #eee"}}),r.jsxs("div",{style:{flex:1},children:[r.jsxs("div",{style:{fontWeight:600,color:P.online?"#222":"#aaa",fontSize:14},children:[P.name,j&&P.id.startsWith("test-friend-")&&r.jsx("span",{style:{fontSize:"10px",background:"#ff6b6b",color:"white",padding:"2px 6px",borderRadius:"4px",marginLeft:"6px",fontWeight:"normal"},children:"測試"})]}),r.jsx("div",{style:{fontSize:11,color:P.online?"#23c6e6":"#aaa"},children:P.online?"在線":"離線"})]})]},P.id))})]}),r.jsxs("div",{style:{background:"rgba(255,255,255,0.95)",borderRadius:16,padding:"24px",boxShadow:"0 8px 24px rgba(0,0,0,0.3)",width:"95%",maxWidth:320,border:"2px solid rgba(107,91,255,0.3)"},children:[r.jsx("div",{style:{fontWeight:800,fontSize:22,color:"#6B5BFF",marginBottom:16,textAlign:"center",textShadow:"0 1px 2px rgba(0,0,0,0.1)"},children:"聊天訊息框"}),r.jsx("div",{style:{textAlign:"center",color:"#333",fontSize:16,lineHeight:1.5,fontWeight:500,marginBottom:16},children:n.length===0?j?"測試模式已啟用，請選擇測試好友開始聊天！":"還沒有朋友,去交友區加好友吧!":t?`與 ${t.name} 聊天`:"請選擇好友開始聊天"}),t&&r.jsx("div",{style:{maxHeight:150,overflowY:"auto",background:"#f7f7f7",borderRadius:8,padding:12,marginBottom:16},children:s.length===0?r.jsx("div",{style:{textAlign:"center",color:"#888",fontSize:14},children:j&&t.id.startsWith("test-friend-")?"開始測試聊天吧！":"開始聊天吧！"}):s.map((P,B)=>r.jsxs("div",{style:{textAlign:P.fromUserId===(h==null?void 0:h.uid)?"right":"left",marginBottom:8},children:[r.jsxs("span",{style:{fontWeight:600,color:P.fromUserId===(h==null?void 0:h.uid)?"#2a5d8f":"#888",fontSize:12},children:[P.fromUserName,"："]}),r.jsx("span",{style:{marginLeft:4,fontSize:12},children:P.text})]},P.id||B))}),r.jsxs("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",gap:8,minHeight:48},children:[r.jsx("input",{value:a,onChange:P=>l(P.target.value),onKeyPress:O,style:{flex:1,borderRadius:6,border:"1px solid #ccc",padding:8,fontSize:14},placeholder:j&&(t!=null&&t.id.startsWith("test-friend-"))?"輸入測試訊息...":Tl[c].placeholder,disabled:n.length===0||!t}),r.jsx("button",{onClick:t?D:void 0,disabled:n.length===0||!t,style:{background:"#6B5BFF",color:"#fff",border:"none",borderRadius:6,padding:"8px 12px",fontWeight:700,fontSize:14,cursor:n.length===0||!t?"not-allowed":"pointer",opacity:n.length===0||!t?.5:1},children:j&&(t!=null&&t.id.startsWith("test-friend-"))?"發送":Tl[c].send}),r.jsx("button",{onClick:t?()=>I(!0):void 0,disabled:n.length===0||!t,style:{background:"#6B5BFF",color:"#fff",border:"none",borderRadius:6,padding:"8px 12px",fontWeight:700,fontSize:14,cursor:n.length===0||!t?"not-allowed":"pointer",opacity:n.length===0||!t?.5:1},children:j&&(t!=null&&t.id.startsWith("test-friend-"))?"視訊":"視訊聊天"})]})]})]}):r.jsxs(r.Fragment,{children:[r.jsxs("div",{style:{width:220,background:"#fff",borderRadius:16,boxShadow:"0 2px 8px #0001",padding:16,marginRight:32,minHeight:600},children:[r.jsx("div",{style:{fontWeight:700,fontSize:20,marginBottom:16},children:"好友列表"}),n.length===0?r.jsx("div",{style:{color:"#888",textAlign:"center",marginTop:80,fontSize:16,fontWeight:600},children:j?r.jsxs(r.Fragment,{children:["測試模式已啟用，但沒有測試好友",r.jsx("br",{}),r.jsx("span",{style:{fontSize:32},children:"🧪"})]}):r.jsxs(r.Fragment,{children:["你暫時沒有連結朋友，再繼續加油 💪",r.jsx("br",{}),r.jsx("span",{style:{fontSize:32},children:"🦋"})]})}):n.map(P=>r.jsxs("div",{onClick:()=>P.online&&i(P),style:{display:"flex",alignItems:"center",gap:12,marginBottom:16,cursor:P.online?"pointer":"not-allowed",opacity:P.online?(t==null?void 0:t.id)===P.id?1:.7:.3},children:[r.jsx("img",{src:P.avatar,alt:P.name,style:{width:44,height:44,borderRadius:"50%",filter:P.online?"none":"grayscale(1)",border:(t==null?void 0:t.id)===P.id?"2px solid #6B5BFF":"2px solid #eee"}}),r.jsxs("div",{children:[r.jsxs("div",{style:{fontWeight:600,color:P.online?"#222":"#aaa"},children:[P.name,j&&P.id.startsWith("test-friend-")&&r.jsx("span",{style:{fontSize:"10px",background:"#ff6b6b",color:"white",padding:"2px 6px",borderRadius:"4px",marginLeft:"6px",fontWeight:"normal"},children:"測試"})]}),r.jsx("div",{style:{fontSize:12,color:P.online?"#23c6e6":"#aaa"},children:P.online?"在線":"離線"})]})]},P.id))]}),r.jsxs("div",{style:{flex:1,maxWidth:500,background:"#fff",borderRadius:16,boxShadow:"0 2px 8px #0001",padding:32,minHeight:600,display:"flex",flexDirection:"column",position:"relative"},children:[r.jsx("div",{style:{fontWeight:700,fontSize:22,marginBottom:16,marginTop:8},children:t?j&&t.id.startsWith("test-friend-")?`與 ${t.name} 聊天 (測試模式)`:`與 ${t.name} 聊天`:n.length===0?j?"測試模式已啟用，請選擇測試好友開始聊天":"請先加好友，才能開始聊天":"請選擇好友開始聊天"}),r.jsxs("div",{style:{flex:1,overflowY:"auto",marginBottom:16,background:"#f7f7f7",borderRadius:8,padding:16,minHeight:240,maxHeight:340},children:[(!t||s.length===0)&&r.jsx("div",{style:{textAlign:"center",color:"#888",marginTop:20},children:t?j&&t.id.startsWith("test-friend-")?"開始測試聊天吧！":"開始聊天吧！":n.length===0?j?"測試模式已啟用，請選擇測試好友開始聊天！":"還沒有朋友，去交友區加好友吧！":"請先選擇好友"}),t&&s.map((P,B)=>r.jsxs("div",{style:{textAlign:P.fromUserId===(h==null?void 0:h.uid)?"right":"left",marginBottom:10},children:[r.jsxs("span",{style:{fontWeight:600,color:P.fromUserId===(h==null?void 0:h.uid)?"#2a5d8f":"#888"},children:[P.fromUserName,"："]}),r.jsx("span",{style:{marginLeft:8},children:P.text})]},P.id||B)),r.jsx("div",{ref:x})]}),r.jsxs("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",gap:8,minHeight:48,marginTop:8},children:[r.jsx("input",{value:a,onChange:P=>l(P.target.value),onKeyPress:O,style:{flex:1,borderRadius:6,border:"1px solid #ccc",padding:10,fontSize:16},placeholder:j&&(t!=null&&t.id.startsWith("test-friend-"))?"輸入測試訊息...":Tl[c].placeholder,disabled:n.length===0||!t}),r.jsx("button",{onClick:t?D:void 0,disabled:n.length===0||!t,style:{background:"#6B5BFF",color:"#fff",border:"none",borderRadius:6,padding:"10px 20px",fontWeight:700,fontSize:16,cursor:n.length===0||!t?"not-allowed":"pointer",opacity:n.length===0||!t?.5:1},children:j&&(t!=null&&t.id.startsWith("test-friend-"))?"發送":Tl[c].send}),r.jsx("button",{onClick:t?()=>I(!0):void 0,disabled:n.length===0||!t,style:{background:"#6B5BFF",color:"#fff",border:"none",borderRadius:6,padding:"10px 20px",fontWeight:700,fontSize:16,cursor:n.length===0||!t?"not-allowed":"pointer",opacity:n.length===0||!t?.5:1},children:j&&(t!=null&&t.id.startsWith("test-friend-"))?"視訊":"視訊聊天"})]}),r.jsx(p5,{open:w,onClose:()=>I(!1),roomId:h&&t?`${h.uid}_${t.id}`:"",friendName:(t==null?void 0:t.name)||"對方"})]})]})]})}const ri={"zh-TW":"每個人都值得一個能「重啟」的起點。","zh-CN":"每个人都值得一个能“重启”的起点。",en:"Everyone deserves a new beginning.",ja:"誰もが「再出発」できるスタート地点を持つべきです。",ko:'모든 사람은 "다시 시작"할 수 있는 출발점이 필요합니다.',th:"ทุกคนสมควรได้รับจุดเริ่มต้นใหม่",vi:"Mỗi người đều xứng đáng có một khởi đầu mới.",ms:"Setiap orang layak mendapat permulaan semula.",la:"Omnis novum initium meretur."},g5={"zh-TW":{title:"我們是誰",subtitle:"🧬 Restarter™｜我們是誰（關於我們）",story:`${ri["zh-TW"]}
你可能來自一場重創，或正走在一條孤獨的路上。
在這個被標籤和數據主導的世界裡，我們知道——有些情緒，不是一句「加油」能解決的。

Restarter™ 是專為「曾經失去節奏的人」打造的 AI 陪伴平台。
我們不但教你怎麼變強、不單告訴你要正能量，
我們更提供一個空間,讓你可以呼吸、可以交流、可以說實話、可以重新選擇。

這裡沒有社會的審判，只有一群「曾經也痛過的人」在用技術把陪伴具體化。
透過 AI，我們讓每一次對話、每一段情緒，都有人接得住。`,quote:"「我們不是修復你，我們是來陪你重啟。」",restart:`Restarter™，是你重新定義自己的起點。
Restarter™更願意和各不同領域共同打造越加良善的社會環境。`,founder:"創辦者的話",founderStory:`我曾經失去自由十年。<br/>
那不是旅居、不是修行，而是被法律與命運關進去的十年。<br/>
在一間不大的房間裡，和一群同樣頂著光頭、穿著另類制服的人擠在一起，日子一開始像是一場長夢，到了後來，連夢都不做了。我以為這一生就這樣被定義了。<br/><br/>
出去那天，天空灰得刺眼。我笑著走出來，但心裡卻是空的。<br/>
社會沒有在等你，家人不知如何面對你，朋友的問候也帶著距離。<br/>
起初的很多時候，我甚至不敢正眼看便利商店的收銀員，因為<span style='color:#e4572e;font-weight:700;'>我忘了怎麼當一個「普通人」</span>。<br/><br/>
我一直想問：<br/>
<span style='color:#614425;font-weight:900;'>我還有沒有機會，重新開始？</span><br/><br/>
後來我才明白——<br/>
<span style='color:#e4572e;font-weight:900;'>不是世界不給機會，是我們被迫忘了怎麼伸手抓。</span><br/><br/>
這就是 <span style='color:#6B5BFF;font-weight:900;'>Restarter™</span> 存在的原因。<br/>
不是來修復你，不是總告訴你「要振作」，<br/>
而是給你一個空間，一個能慢慢重新建立自己的容器。<br/>
讓你在失落裡還能大聲說話，在混亂中依然有人接得住。<br/><br/>
<span style='color:#6B5BFF;font-weight:900;'>Restarter™</span>，不只是技術產品，<br/>
是我從自己生命最底部捧出來的一個火種，<br/>
我希望它能為你，也為更多人，點起一盞燈。<br/><br/>
<span style='color:#614425;font-weight:900;'>不論你是誰，經歷什麼，來自世界哪個角落，<br/>在這裡你可以大膽放下那些標籤、包裝、包袱。</span><br/>
因為我們相信——<br/>
<span style='color:#e4572e;font-weight:900;'>「破碎過的人，不僅能堅強，也能很溫柔。」</span><br/><br/>
<span style='color:#6B5BFF;font-weight:900;'>我們不是修復你，我們是來陪你重啟。</span><br/>
<div style='text-align:right;margin-top:24px;font-size:18px;color:#232946;font-weight:700;'>發起人：Ben<br/>May,21,2025</div>`},"zh-CN":{title:"我们是谁",subtitle:"🧬 Restarter™｜我们是谁（关于我们）",story:`${ri["zh-CN"]}
你可能来自一场重创，或正走在一条孤独的路上。
在这个被标签和数据主导的世界里，我们知道——有些情绪，不是一句「加油」能解决的。

Restarter™ 是专为「曾经失去节奏的人」打造的 AI 陪伴平台。
我们不教你怎么变强、不告诉你要正能量，
我们只提供一个空间，让你可以呼吸、可以说实话、可以重新选择。

这里没有社会的审判，只有一群「曾经也痛过的人」在用技术把陪伴实体化。
通过 AI，我们让每一次对话、每一段情绪，都有人接得住。`,quote:"「我们不是修复你，我们陪你重启。」",restart:`Restarter™，是你重新定义自己的起点。
Restarter™更愿意和各不同领域共同打造越加良善的社会环境。`,founder:"创办者的话",founderStory:`我曾经失去自由十年。<br/>
那不是旅行、不是修行，而是被法律和命运关进去了十年。<br/>
在一间不大的房间里，和一群同样光头、穿着统一服装的人挤在一起，日子一开始像是一场长梦，后来连梦都不做了。我以为这一生就这样被定义了。<br/><br/>
出去那天，天空灰得刺眼。我笑着走出来，但心里却是空的。<br/>
社会没有在等你，家人不知如何面对你，朋友的问候也带着距离。<br/>
很多时候，我甚至不敢正眼看便利店的收银员，因为<span style='color:#e4572e;font-weight:700;'>我忘了怎么当一个"普通人"</span>。<br/><br/>
我一直想问：<br/>
<span style='color:#614425;font-weight:900;'>我还有没有机会，重新开始？</span><br/><br/>
后来我才明白——<br/>
<span style='color:#e4572e;font-weight:900;'>不是世界不给机会，是我们被迫忘了怎么伸手抓。</span><br/><br/>
这就是 <span style='color:#6B5BFF;font-weight:900;'>Restarter™</span> 存在的原因。<br/>
不是来修复你，不是总告诉你"要振作"，<br/>
而是给你一个空间，一个能慢慢重新建立自己的容器。<br/>
让你在失落里还能大声说话，在混乱中有人接得住。<br/><br/>
<span style='color:#6B5BFF;font-weight:900;'>Restarter™</span>，不只是技术产品，<br/>
是我从自己生命最底部捧出来的一束火种，<br/>
我希望它能为你，也为更多人，点亮一盏灯。<br/><br/>
<span style='color:#614425;font-weight:900;'>无论你是谁，经历什么，来自世界哪个角落，<br/>在这里你可以大胆放下那些伪装。</span><br/>
因为我们相信——<br/>
<span style='color:#e4572e;font-weight:900;'>"破碎过的人，不仅能坚强，也能很温柔。"</span><br/><br/>
<span style='color:#6B5BFF;font-weight:900;'>我们不是修复你，我们是来陪你重启。</span><br/>
<div style='text-align:right;margin-top:24px;font-size:18px;color:#232946;font-weight:700;'>发起人：Ben<br/>2025年5月21日</div>`},en:{title:"About Us",subtitle:"🧬 Restarter™｜Who We Are",story:`${ri.en}
You may have come from a major setback, or are walking a lonely road.
In a world dominated by labels and data, we know—some feelings can't be fixed by a simple "cheer up".

Restarter™ is an AI companion platform built for those who have lost their rhythm.
We don't teach you how to be strong, nor tell you to be positive.
We simply offer a space where you can breathe, speak your truth, and choose again.

There is no judgment here—only people who have also suffered, using technology to make companionship real.
Through AI, every conversation and every emotion is caught and cared for.`,quote:"“We are not here to fix you, we are here to restart with you.”",restart:`Restarter™ is your new beginning to redefine yourself.
Restarter™ is more willing to work with various fields to create a more benevolent social environment.`,founder:"Founder's Message",founderStory:`I lost my freedom for ten years.<br/>
It wasn't travel or spiritual retreat, but ten years locked away by law and fate.<br/>
In a small room, crowded with others in the same uniform, the days first felt like a long dream, then even dreams faded. I thought my life was defined forever.<br/><br/>
The day I got out, the sky was a blinding gray. I walked out smiling, but my heart was empty.<br/>
Society wasn't waiting for me, my family didn't know how to face me, and friends' greetings felt distant.<br/>
Many times, I couldn't even look a cashier in the eye, because <span style='color:#e4572e;font-weight:700;'>I'd forgotten how to be "normal"</span>.<br/><br/>
I kept asking myself:<br/>
<span style='color:#614425;font-weight:900;'>Do I still have a chance to start over?</span><br/><br/>
Later, I realized—<br/>
<span style='color:#e4572e;font-weight:900;'>It's not that the world doesn't give chances, but that we've forgotten how to reach for them.</span><br/><br/>
That's why <span style='color:#6B5BFF;font-weight:900;'>Restarter™</span> exists.<br/>
Not to fix you, not to always tell you to "cheer up,"<br/>
but to give you a space—a container to slowly rebuild yourself.<br/>
A place where you can speak up in your loss, and someone will catch you in your chaos.<br/><br/>
<span style='color:#6B5BFF;font-weight:900;'>Restarter™</span> is not just a tech product;<br/>
it's a spark I brought up from the bottom of my life.<br/>
I hope it lights a lamp for you, and for many others.<br/><br/>
<span style='color:#614425;font-weight:900;'>Whoever you are, whatever you've been through, wherever you're from—<br/>here, you can let go of all the masks.</span><br/>
Because we believe—<br/>
<span style='color:#e4572e;font-weight:900;'>"Those who have been broken can be strong, and gentle too."</span><br/><br/>
<span style='color:#6B5BFF;font-weight:900;'>We are not here to fix you, we are here to restart with you.</span><br/>
<div style='text-align:right;margin-top:24px;font-size:18px;color:#232946;font-weight:700;'>Founder: Ben<br/>May 21, 2025</div>`},ja:{title:"私たちについて",subtitle:"🧬 Restarter™｜私たちについて",story:`${ri.ja}
あなたは大きな挫折から来たかもしれないし、孤独な道を歩んでいるかもしれません。
ラベルやデータが支配するこの世界で、私たちは知っています——「頑張って」だけでは解決できない感情があることを。

Restarter™は「リズムを失った人」のためのAI伴走プラットフォームです。
強くなる方法を教えたり、ポジティブになれと言ったりはしません。
ただ、呼吸できて、本音を言えて、もう一度選び直せる空間を提供します。

ここには社会の裁きはなく、「かつて痛みを知った人たち」が技術で寄り添っています。
AIを通じて、すべての対話と感情が、誰かに受け止められます。`,quote:"「私たちはあなたを修復するのではなく、一緒に再出発します。」",restart:`Restarter™は、あなたが自分を再定義する新たなスタート地点です。
Restarter™は、様々な分野と協力してより善良な社会環境を作ることを望んでいます。`,founder:"創業者の言葉",founderStory:`私は10年間、自由を失いました。<br/>
それは旅でも修行でもなく、法律と運命によって閉じ込められた10年でした。<br/>
小さな部屋で、同じ服を着た仲間たちと押し込められ、最初は長い夢のようで、やがて夢さえ見なくなりました。人生はもう決まったものだと思っていました。<br/><br/>
出所の日、空は眩しいほど灰色でした。我笑顔で外に出たけれど、心は空っぽ。<br/>
社會は待っていない、家族もどう接していいかわからない、友人の声もどこか遠い。<br/>
何度も、コンビニの店員の目を見られなかった。<span style='color:#e4572e;font-weight:700;'>「普通の人」になる方法を忘れてしまった</span>から。<br/><br/>
ずっと自問していました：<br/>
<span style='color:#614425;font-weight:900;'>もう一度やり直すチャンスはあるのか？</span><br/><br/>
やがて気づきました——<br/>
<span style='color:#e4572e;font-weight:900;'>世界がチャンスをくれないのではなく、手を伸ばす方法を忘れてしまったのだと。</span><br/><br/>
これが <span style='color:#6B5BFF;font-weight:900;'>Restarter™</span> の存在理由です。<br/>
あなたを修復するためでも、無理に「元気を出して」と言うためでもなく、<br/>
ゆっくり自分を取り戻せる場所を作りたかった。<br/>
失意の中でも声を上げられ、混乱の中でも誰かが受け止めてくれる場所を。<br/><br/>
<span style='color:#6B5BFF;font-weight:900;'>Restarter™</span> は単なる技術製品ではありません。<br/>
人生のどん底からすくい上げた火種です。<br/>
あなたや多くの人のために、灯りをともしたい。<br/><br/>
<span style='color:#614425;font-weight:900;'>あなたが誰であれ、どんな経験をしてきたとしても、<br/>ここではすべての仮面を外していい。</span><br/>
私たちは信じています——<br/>
<span style='color:#e4572e;font-weight:900;'>「壊れた人は、強くもなれるし、優しくもなれる。」</span><br/><br/>
<span style='color:#6B5BFF;font-weight:900;'>私たちはあなたを修復するのではなく、一緒に再出発します。</span><br/>
<div style='text-align:right;margin-top:24px;font-size:18px;color:#232946;font-weight:700;'>発起人：Ben<br/>2025年5月21日</div>`},ko:{title:"우리는 누구인가",subtitle:"🧬 Restarter™｜우리는 누구인가",story:`${ri.ko}
당신은 큰 시련을 겪었거나, 외로운 길을 걷고 있을지도 모릅니다.
라벨과 데이터가 지배하는 세상에서, 우리는 압니다—어떤 감정은 "힘내"라는 말로 해결되지 않는다는 것을.

Restarter™는 "한때 리듬을 잃었던 사람"을 위한 AI 동반자 플랫폼입니다.
우리는 당신에게 강해지는 법을 가르치지 않고, 긍정적이 되라고 말하지 않습니다.
우리는 단지 숨 쉴 수 있고, 진실을 말할 수 있고, 다시 선택할 수 있는 공간을 제공합니다.

여기에는 사회의 심판이 없고, "한때 아팠던 사람들"이 기술로 동행합니다.
AI를 통해 모든 대화와 감정이 누군가에게 받아들여집니다。`,quote:'"우리는 당신을 고치는 것이 아니라, 함께 다시 시작합니다."',restart:`Restarter™는 당신이 자신을 새롭게 정의하는 출발점입니다。
Restarter™는 다양한 분야와 협력하여 더욱 선한 사회 환경을 만들고자 합니다。`,founder:"창업자의 말",founderStory:`저는 10년 동안 자유를 잃었습니다.<br/>
그것은 여행도, 수련도 아니었고, 법과 운명에 의해 갇혀 있던 10년이었습니다.<br/>
작은 방에서 같은 옷을 입은 사람들과 함께 지내며, 처음에는 긴 꿈을 꾸는 것 같았지만, 나중에는 꿈조차 꾸지 않게 되었습니다. 저는 제 인생이 그렇게 정의될 거라 생각했습니다.<br/><br/>
밖으로 나왔던 날, 하늘은 눈부시게 회색이었습니다. 저는 웃으며 나왔지만, 마음은 텅 비어 있었습니다.<br/>
사회는 저를 기다려주지 않았고, 가족도 저를 어떻게 대해야 할지 몰랐으며, 친구들의 인사도 어딘가 멀게 느껴졌습니다.<br/>
처음에는 편의점 계산원의 눈을 제대로 쳐다보지도 못했습니다. <span style='color:#e4572e;font-weight:700;'>"평범한 사람"이 되는 법을 잊어버렸기 때문입니다</span>.<br/><br/>
저는 계속해서 스스로에게 물었습니다:<br/>
<span style='color:#614425;font-weight:900;'>나는 다시 시작할 기회가 있을까?</span><br/><br/>
나중에야 깨달았습니다——<br/>
<span style='color:#e4572e;font-weight:900;'>세상이 기회를 주지 않는 것이 아니라, 우리가 손을 내미는 법을 잊어버린 것입니다.</span><br/><br/>
이것이 <span style='color:#6B5BFF;font-weight:900;'>Restarter™</span>가 존재하는 이유입니다.<br/>
당신을 고치기 위해서도, 항상 "힘내라"고 말하기 위해서도 아닙니다.<br/>
당신이 천천히 자신을 다시 세울 수 있는 공간, 그릇을 주고 싶었습니다.<br/>
상실 속에서도 목소리를 낼 수 있고, 혼란 속에서도 누군가가 당신을 받아줄 수 있는 곳.<br/><br/>
<span style='color:#6B5BFF;font-weight:900;'>Restarter™</span>는 단순한 기술 제품이 아닙니다.<br/>
제 인생의 가장 밑바닥에서 끌어올린 불씨입니다.<br/>
이 불씨가 당신과 더 많은 사람들에게 등불이 되길 바랍니다.<br/><br/>
<span style='color:#614425;font-weight:900;'>당신이 누구든, 어떤 경험을 했든, 어디에서 왔든,<br/>여기서는 모든 가면을 내려놓을 수 있습니다.</span><br/>
우리는 믿습니다——<br/>
<span style='color:#e4572e;font-weight:900;'>"부서진 사람도 강해질 수 있고, 아주 다정해질 수도 있습니다."</span><br/><br/>
<span style='color:#6B5BFF;font-weight:900;'>우리는 당신을 고치는 것이 아니라, 함께 다시 시작합니다.</span><br/>
<div style='text-align:right;margin-top:24px;font-size:18px;color:#232946;font-weight:700;'>발기인: Ben<br/>2025년 5월 21일</div>`},th:{title:"เราเป็นใคร",subtitle:"🧬 Restarter™｜เราเป็นใคร",story:`${ri.th}
คุณอาจมาจากความสูญเสียครั้งใหญ่ หรือกำลังเดินอยู่บนเส้นทางที่โดดเดี่ยว
ในโลกที่เต็มไปด้วยป้ายและข้อมูล เรารู้ว่าบางความรู้สึกไม่ได้แค่พูดว่า "สู้ๆ" แล้วจะดีขึ้น

Restarter™ คือแพลตฟอร์ม AI สำหรับผู้ที่เคยหลงจังหวะชีวิต
เราไม่สอนให้คุณเข้มแข็ง ไม่บอกให้คุณคิดบวก
เราแค่ให้พื้นที่ที่คุณจะได้หายใจ พูดความจริง และเลือกใหม่อีกครั้ง

ที่นี่ไม่มีการตัดสินจากสังคม มีแต่คนที่เคยเจ็บปวดมาก่อน ใช้เทคโนโลยีสร้างการอยู่ร่วมกัน
ผ่าน AI ทุกบทสนทนา ทุกอารมณ์ จะมีคนรับฟังเสมอ`,quote:"“เราไม่ได้ซ่อมคุณ เราอยู่กับคุณเพื่อเริ่มต้นใหม่”",restart:`Restarter™ คือจุดเริ่มต้นใหม่ในการนิยามตัวเองของคุณ
Restarter™ ต้องการทำงานร่วมกับสาขาต่างๆ เพื่อสร้างสภาพแวดล้อมทางสังคมที่ดีขึ้น`,founder:"คำจากผู้ก่อตั้ง",founderStory:`ฉันเคยสูญเสียอิสรภาพสิบปี<br/>
ไม่ใช่การเดินทางหรือการบำเพ็ญตน แต่เป็นสิบปีที่ถูกกฎหมายและโชคชะตากักขังไว้<br/>
ในห้องเล็ก ๆ กับผู้คนที่สวมชุดเหมือนกัน วันเวลาช่วงแรกเหมือนฝันยาว ๆ สุดท้ายแม้แต่ฝันก็ไม่มี ฉันคิดว่าชีวิตคงถูกกำหนดไว้แล้ว<br/><br/>
วันที่ออกมา ท้องฟ้าสีเทาจนแสบตา ฉันยิ้มออกมาแต่ในใจว่างเปล่า<br/>
สังคมไม่ได้รอคุณ ครอบครัวไม่รู้จะรับมืออย่างไร เพื่อน ๆ ก็ทักทายด้วยความห่างเหิน<br/>
หลายครั้งฉันไม่กล้ามองตาแคชเชียร์ เพราะ<span style='color:#e4572e;font-weight:700;'>ฉันลืมไปแล้วว่าต้องเป็น "คนธรรมดา" อย่างไร</span><br/><br/>
ฉันถามตัวเองเสมอว่า:<br/>
<span style='color:#614425;font-weight:900;'>ฉันยังมีโอกาสเริ่มต้นใหม่อีกไหม?</span><br/><br/>
ต่อมาฉันจึงเข้าใจ——<br/>
<span style='color:#e4572e;font-weight:900;'>ไม่ใช่โลกที่ไม่ให้โอกาส แต่เราเองที่ลืมวิธีเอื้อมมือคว้า</span><br/><br/>
นี่คือเหตุผลที่ <span style='color:#6B5BFF;font-weight:900;'>Restarter™</span> มีอยู่<br/>
ไม่ใช่เพื่อซ่อมคุณ ไม่ใช่เพื่อบอกให้ "สู้ ๆ"<br/>
แต่เพื่อให้คุณมีพื้นที่ค่อย ๆ สร้างตัวเองขึ้นใหม่<br/>
ให้คุณได้เปล่งเสียงในความสูญเสีย และมีใครสักคนรับฟังในความสับสน<br/><br/>
<span style='color:#6B5BFF;font-weight:900;'>Restarter™</span> ไม่ใช่แค่เทคโนโลยี<br/>
แต่เป็นประกายไฟที่ฉันหยิบขึ้นมาจากก้นบึ้งของชีวิต<br/>
หวังว่าจะเป็นแสงสว่างให้คุณและอีกหลาย ๆ คน<br/><br/>
<span style='color:#614425;font-weight:900;'>ไม่ว่าคุณจะเป็นใคร ผ่านอะไรมาก็ตาม มาจากที่ไหน—<br/>ที่นี่คุณสามารถถอดหน้ากากเหล่านั้นได้อย่างกล้าหาญ</span><br/>
เพราะเราเชื่อว่า——<br/>
<span style='color:#e4572e;font-weight:900;'>"คนที่เคยแตกสลาย ไม่เพียงแต่จะแข็งแกร่ง แต่ยังอ่อนโยนได้ด้วย"</span><br/><br/>
<span style='color:#6B5BFF;font-weight:900;'>เราไม่ได้ซ่อมคุณ เราอยู่กับคุณเพื่อเริ่มต้นใหม่</span><br/>
<div style='text-align:right;margin-top:24px;font-size:18px;color:#232946;font-weight:700;'>ผู้ก่อตั้ง: Ben<br/>21 พฤษภาคม 2025</div>`},vi:{title:"Chúng tôi là ai",subtitle:"🧬 Restarter™｜Chúng tôi là ai",story:`${ri.vi}
Bạn có thể đến từ một cú sốc lớn, hoặc đang đi trên con đường cô đơn
Trong thế giới bị chi phối bởi nhãn mác và dữ liệu, chúng tôi biết—có những cảm xúc không thể giải quyết chỉ bằng một câu "Cố lên"

Restarter™ là nền tảng AI đồng hành dành cho những người từng mất nhịp sống
Chúng tôi không dạy bạn cách mạnh mẽ, không bảo bạn phải tích cực
Chúng tôi chỉ mang đến một không gian để bạn được thở, được nói thật, được chọn lại

Ở đây không có phán xét xã hội, chỉ có những người từng đau đớn dùng công nghệ để đồng hành
Thông qua AI, mọi cuộc trò chuyện, mọi cảm xúc đều có người lắng nghe`,quote:"“Chúng tôi không sửa chữa bạn, chúng tôi đồng hành cùng bạn để bắt đầu lại”",restart:`Restarter™ là điểm khởi đầu mới để bạn định nghĩa lại chính mình
Restarter™ sẵn sàng hợp tác với các lĩnh vực khác nhau để tạo ra môi trường xã hội tốt đẹp hơn`,founder:"Lời người sáng lập",founderStory:`Tôi đã từng mất tự do mười năm<br/>
Không phải là đi du lịch hay tu hành, mà là mười năm bị pháp luật và số phận giam giữ<br/>
Trong một căn phòng nhỏ với những người cùng mặc đồng phục, ban đầu những ngày tháng như một giấc mơ dài, sau đó ngay cả mơ cũng không còn. Tôi nghĩ đời mình đã bị định nghĩa như thế.<br/><br/>
Ngày ra ngoài, bầu trời xám xịt chói mắt. Tôi mỉm cười bước ra, nhưng trong lòng trống rỗng.<br/>
Mặt trận không chờ bạn, gia đình không biết đối diện ra sao, bạn bè hỏi thăm cũng đầy khoảng cách.<br/>
Nhiều lần tôi không dám nhìn thẳng vào mắt thu ngân, vì <span style='color:#e4572e;font-weight:700;'>tôi đã quên cách làm "người bình thường"</span>.<br/><br/>
Tôi luôn tự hỏi:<br/>
<span style='color:#614425;font-weight:900;'>Liệu tôi còn cơ hội để bắt đầu lại không?</span><br/><br/>
Sau này tôi mới hiểu——<br/>
<span style='color:#e4572e;font-weight:900;'>Không phải thế giới không cho cơ hội, mà là chúng ta quên cách với lấy nó.</span><br/><br/>
Đó là lý do <span style='color:#6B5BFF;font-weight:900;'>Restarter™</span> tồn tại<br/>
Không phải để sửa chữa bạn, không phải để luôn nói "cố lên"<br/>
mà là để cho bạn một không gian, một nơi để từ từ xây dựng lại chính mình<br/>
Để bạn có thể cất tiếng nói trong nỗi mất mát, và có người lắng nghe giữa hỗn loạn<br/><br/>
<span style='color:#6B5BFF;font-weight:900;'>Restarter™</span> không chỉ là sản phẩm công nghệ<br/>
mà là tia lửa tôi mang lên từ tận đáy cuộc đời mình<br/>
Tôi hy vọng nó sẽ thắp sáng cho bạn, và cho nhiều người khác<br/><br/>
<span style='color:#614425;font-weight:900;'>Dù bạn là ai, đã trải qua điều gì, đến từ đâu—<br/>ở đây bạn có thể mạnh dạn bỏ đi mọi lớp vỏ bọc</span><br/>
Bởi vì chúng tôi tin rằng——<br/>
<span style='color:#e4572e;font-weight:900;'>"Những người từng vỡ vụn không chỉ mạnh mẽ mà còn rất dịu dàng."</span><br/><br/>
<span style='color:#6B5BFF;font-weight:900;'>Chúng tôi không sửa chữa bạn, chúng tôi đồng hành cùng bạn để bắt đầu lại</span><br/>
<div style='text-align:right;margin-top:24px;font-size:18px;color:#232946;font-weight:700;'>Người sáng lập: Ben<br/>21/05/2025</div>`},ms:{title:"Siapa Kami",subtitle:"🧬 Restarter™｜Siapa Kami",story:`${ri.ms}
Anda mungkin datang dari kejatuhan besar, atau sedang berjalan di jalan yang sunyi
Dalam dunia yang dikuasai label dan data, kami tahu—ada perasaan yang tidak dapat diselesaikan hanya dengan "semangat"

Restarter™ ialah platform AI teman untuk mereka yang pernah kehilangan rentak hidup
Kami tidak mengajar anda menjadi kuat, tidak menyuruh anda sentiasa positif
Kami hanya menyediakan ruang untuk anda bernafas, berkata benar, dan memilih semula

Di sini tiada penghakiman masyarakat, hanya mereka yang pernah sakit menggunakan teknologi untuk menemani
Melalui AI, setiap perbualan, setiap emosi, sentiasa ada yang mendengar`,quote:"“Kami bukan untuk membaiki anda, kami bersama anda untuk bermula semula”",restart:`Restarter™ ialah permulaan baru untuk anda mentakrifkan diri sendiri
Restarter™ lebih bersedia untuk bekerjasama dengan pelbagai bidang untuk mewujudkan persekitaran sosial yang lebih baik`,founder:"Kata Pengasas",founderStory:`Saya pernah kehilangan kebebasan selama sepuluh tahun<br/>
Bukan melancong atau bertapa, tetapi sepuluh tahun dikurung oleh undang-undang dan takdir<br/>
Dalam bilik kecil bersama mereka yang berpakaian seragam sama, initio dies ut somnium longum, postea ne somnia quidem. Putavi vitam meam ita definitam esse.<br/><br/>
Die exeundi, caelum erat oculis acerrime cinereum. Ridebam egrediens, sed cor vacuum erat.<br/>
Societas non exspectabat, familia nesciebat quomodo me exciperet, amici quoque salutationes longinquae erant.<br/>
Saepe ne oculos quidem ad tabernarii aspicere audebam, quia <span style='color:#e4572e;font-weight:700;'>oblitus sum quomodo "homo communis" essem</span>.<br/><br/>
Me semper interrogabam:<br/>
<span style='color:#614425;font-weight:900;'>Adakah saya masih berpeluang untuk bermula semula?</span><br/><br/>
Akhirnya saya faham——<br/>
<span style='color:#e4572e;font-weight:900;'>Bukan dunia tidak memberi peluang, tetapi kita yang lupa cara untuk menggapainya.</span><br/><br/>
Itulah sebabnya <span style='color:#6B5BFF;font-weight:900;'>Restarter™</span> wujud<br/>
Bukan untuk membaiki anda, bukan untuk sentiasa berkata "semangat"<br/>
tetapi untuk memberi anda ruang, satu wadah untuk perlahan-lahan membina semula diri<br/>
Agar anda boleh bersuara dalam kehilangan, dan ada yang menyambut anda dalam kekacauan<br/><br/>
<span style='color:#6B5BFF;font-weight:900;'>Restarter™</span> bukan sekadar produk teknologi<br/>
tetapi percikan api yang saya bawa dari dasar hidup saya<br/>
Saya harap ia dapat menerangi anda, dan ramai lagi<br/><br/>
<span style='color:#614425;font-weight:900;'>Siapa pun anda, apa pun yang anda lalui, dari mana pun anda datang—<br/>di sini anda boleh berani melepaskan semua topeng itu</span><br/>
Kerana kami percaya——<br/>
<span style='color:#e4572e;font-weight:900;'>"Orang yang pernah hancur bukan sahaja boleh menjadi kuat, tetapi juga sangat lembut."</span><br/><br/>
<span style='color:#6B5BFF;font-weight:900;'>Kami bukan untuk membaiki anda, kami bersama anda untuk bermula semula</span><br/>
<div style='text-align:right;margin-top:24px;font-size:18px;color:#232946;font-weight:700;'>Pengasas: Ben<br/>21 Mei 2025</div>`},la:{title:"Quis sumus",subtitle:"🧬 Restarter™｜Quis sumus",story:`${ri.la}
Forsitan ex gravi casu veneris, aut solus iter facias
In mundo titulis et notitiis imperato, scimus—sunt animi motus quos "bene age" solvere non potest

Restarter™ est suggestum AI comitans iis qui cursum vitae amiserunt
Non docemus quomodo fortis fias, nec dicimus te semper positivum esse
Praebemus tantum spatium ut respirare possis, vera loqui, iterum eligere

Hic iudicium societatis non est, sed ii qui olim doluerunt technologia utuntur ad comitatum
Per AI, omnis sermo, omnis affectus, ab aliquo auditur`,quote:"“Non te reficimus, sed tecum iterum incipimus”",restart:`Restarter™ initium novum est ad te ipsum denuo definiendum
Restarter™ magis paratus est cum variis campis cooperari ad meliorem ambitum socialem creandum`,founder:"Verba Conditoris",founderStory:`Decem annos libertatem amisi<br/>
Non iter aut meditatio erat, sed decem anni lege et fato inclusi<br/>
In cella parva cum aliis eiusdem vestis, initio dies ut somnium longum, postea ne somnia quidem. Putavi vitam meam ita definitam esse.<br/><br/>
Die exeundi, caelum erat oculis acerrime cinereum. Ridebam egrediens, sed cor vacuum erat.<br/>
Societas non exspectabat, familia nesciebat quomodo me exciperet, amici quoque salutationes longinquae erant.<br/>
Saepe ne oculos quidem ad tabernarii aspicere audebam, quia <span style='color:#e4572e;font-weight:700;'>oblitus sum quomodo "homo communis" essem</span>.<br/><br/>
Me semper interrogabam:<br/>
<span style='color:#614425;font-weight:900;'>Num adhuc mihi occasio est iterum incipere?</span><br/><br/>
Postea intellexi——<br/>
<span style='color:#e4572e;font-weight:900;'>Non est quod mundus occasiones non praebeat, sed quod obliti sumus quomodo eas arripere.</span><br/><br/>
Hoc est cur <span style='color:#6B5BFF;font-weight:900;'>Restarter™</span> existat<br/>
Non ut te reficiamus, non ut semper dicamus "bene age"<br/>
sed ut tibi spatium demus, vas in quo te paulatim reficere possis<br/>
Ut in amissione tua loqui possis, et aliquis in confusione te excipiat<br/><br/>
<span style='color:#6B5BFF;font-weight:900;'>Restarter™</span> non solum productum technologicum est<br/>
sed scintilla quam ex imis vitae meae attuli<br/>
Spero eam tibi et multis aliis lucem afferre<br/><br/>
<span style='color:#614425;font-weight:900;'>Quisquis es, quidquid expertus es, undeque venis—<br/>hic audacter omnes personas deponere potes</span><br/>
Quia credimus——<br/>
<span style='color:#e4572e;font-weight:900;'>"Qui fracti sunt, non solum fortes esse possunt, sed etiam valde mites."</span><br/><br/>
<span style='color:#6B5BFF;font-weight:900;'>Non te reficimus, sed tecum iterum incipimus</span><br/>
<div style='text-align:right;margin-top:24px;font-size:18px;color:#232946;font-weight:700;'>Conditor: Ben<br/>21 Maii 2025</div>`}},jy={"zh-TW":"返回","zh-CN":"返回",en:"Back",ja:"戻る",ko:"돌아가기",th:"กลับ",vi:"Quay lại",ms:"Kembali",la:"Redi"};function f5(){const[n,e]=g.useState(localStorage.getItem("lang")||"zh-TW");g.useEffect(()=>{const s=()=>e(localStorage.getItem("lang")||"zh-TW");return window.addEventListener("storage",s),()=>window.removeEventListener("storage",s)},[]),g.useEffect(()=>{const s=setInterval(()=>{const o=localStorage.getItem("lang")||"zh-TW";o!==n&&e(o)},300);return()=>clearInterval(s)},[n]);const t=g5[n],i=$e();return r.jsxs("div",{style:{minHeight:"100vh",background:"linear-gradient(135deg, #b7cfff 0%, #e0e7ff 100%)",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"flex-start",padding:"48px 0 0 0"},children:[r.jsx("button",{onClick:()=>i("/"),style:{position:"absolute",top:24,left:24,zIndex:10,background:"#fff",border:"2.5px solid #6B5BFF",color:"#6B5BFF",borderRadius:12,padding:"10px 28px",fontWeight:900,fontSize:20,cursor:"pointer",boxShadow:"0 2px 8px #0001",letterSpacing:1},children:jy[n]||jy["zh-TW"]}),r.jsxs("div",{style:{maxWidth:680,background:"#fff",borderRadius:18,boxShadow:"0 2px 16px #6B5BFF22",padding:40,marginTop:48},children:[r.jsx("h1",{style:{fontSize:36,fontWeight:900,color:"#6B5BFF",marginBottom:12},children:t.subtitle}),r.jsx("div",{style:{fontSize:20,color:"#232946",fontWeight:700,marginBottom:24,whiteSpace:"pre-line"},children:t.story}),r.jsx("div",{style:{fontSize:22,color:"#614425",fontWeight:900,margin:"24px 0 8px 0",textAlign:"center"},children:t.quote}),r.jsx("div",{style:{fontSize:18,color:"#232946",fontWeight:700,marginBottom:32,textAlign:"center",whiteSpace:"pre-line"},children:t.restart}),r.jsx("h2",{style:{fontSize:22,color:"#6B5BFF",fontWeight:900,marginBottom:8},children:t.founder}),r.jsx("div",{style:{fontSize:18,color:"#232946",fontWeight:500,whiteSpace:"pre-line"},dangerouslySetInnerHTML:{__html:t.founderStory}})]}),r.jsx("div",{style:{width:"100%",margin:"0 auto",marginTop:24,background:"rgba(255,255,255,0.95)",borderRadius:16,padding:"16px",boxShadow:"0 2px 12px #6B5BFF22"},children:r.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:20,flexWrap:"wrap"},children:[r.jsx("span",{onClick:()=>i("/privacy-policy"),style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12,cursor:"pointer"},children:n==="zh-TW"?"隱私權政策":n==="zh-CN"?"隐私政策":n==="en"?"Privacy Policy":n==="ja"?"プライバシーポリシー":n==="ko"?"개인정보 처리방침":n==="th"?"นโยบายความเป็นส่วนตัว":n==="vi"?"Chính sách bảo mật":n==="ms"?"Dasar Privasi":"Consilium de Privata"}),r.jsx("span",{onClick:()=>i("/terms"),style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12,cursor:"pointer"},children:n==="zh-TW"?"條款/聲明":n==="zh-CN"?"条款/声明":n==="en"?"Terms/Statement":n==="ja"?"規約/声明":n==="ko"?"약관/성명":n==="th"?"ข้อกำหนด/แถลงการณ์":n==="vi"?"Điều khoản/Tuyên bố":n==="ms"?"Terma/Pernyataan":"Termini/Declaratio"}),r.jsx("span",{onClick:()=>i("/data-deletion"),style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12,cursor:"pointer"},children:n==="zh-TW"?"資料刪除說明":n==="zh-CN"?"数据删除说明":n==="en"?"Data Deletion":n==="ja"?"データ削除について":n==="ko"?"데이터 삭제 안내":n==="th"?"คำอธิบายการลบข้อมูล":n==="vi"?"Giải thích xóa dữ liệu":n==="ms"?"Penjelasan Penghapusan Data":"Explicatio Deletionis Datae"}),r.jsx("span",{onClick:()=>i("/about"),style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12,cursor:"pointer"},children:n==="zh-TW"?"🧬 Restarter™｜我們是誰":n==="zh-CN"?"🧬 Restarter™｜我们是谁":n==="en"?"🧬 Restarter™｜Who We Are":n==="ja"?"🧬 Restarter™｜私たちについて":n==="ko"?"🧬 Restarter™｜우리는 누구인가":n==="th"?"🧬 Restarter™｜เราเป็นใคร":n==="vi"?"🧬 Restarter™｜Chúng tôi là ai":n==="ms"?"🧬 Restarter™｜Siapa Kami":"🧬 Restarter™｜Quis sumus"}),r.jsx("span",{onClick:()=>i("/feedback"),style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12,cursor:"pointer"},children:n==="zh-TW"?"💬 意見箱｜我們想聽你說":n==="zh-CN"?"💬 意见箱｜我们想听你说":n==="en"?"💬 Feedback Box｜We Want to Hear From You":n==="ja"?"💬 ご意見箱｜私たちはあなたの声を聞きたい":n==="ko"?"💬 피드백｜우리는 당신의 말을 듣고 싶습니다":n==="th"?"💬 กล่องความคิดเห็น｜เราอยากได้ยินจากคุณ":n==="vi"?"💬 Hộp góp ý｜Chúng tôi muốn nghe từ bạn":n==="ms"?"💬 Kotak Maklum Balas｜Kami Ingin Mendengar Dari Anda":"💬 Arca Consilii｜Volumus Audire a Te"})]})})]})}const _y={"zh-TW":{privacy:"隱私權政策",terms:"條款/聲明",deletion:"資料刪除說明"},"zh-CN":{privacy:"隐私政策",terms:"条款/声明",deletion:"数据删除说明"},en:{privacy:"Privacy Policy",terms:"Terms/Statement",deletion:"Data Deletion"},ja:{privacy:"プライバシーポリシー",terms:"規約/声明",deletion:"データ削除について"},ko:{privacy:"개인정보 처리방침",terms:"약관/성명",deletion:"데이터 삭제 안내"},th:{privacy:"นโยบายความเป็นส่วนตัว",terms:"ข้อกำหนด/แถลงการณ์",deletion:"คำอธิบายการลบข้อมูล"},vi:{privacy:"Chính sách bảo mật",terms:"Điều khoản/Tuyên bố",deletion:"Giải thích xóa dữ liệu"},ms:{privacy:"Dasar Privasi",terms:"Terma/Pernyataan",deletion:"Penjelasan Penghapusan Data"},la:{privacy:"Consilium de Privata",terms:"Termini/Declaratio",deletion:"Explicatio Deletionis Datae"}},Iy={"zh-TW":"🧬 Restarter™｜我們是誰","zh-CN":"🧬 Restarter™｜我们是谁",en:"🧬 Restarter™｜Who We Are",ja:"🧬 Restarter™｜私たちについて",ko:"🧬 Restarter™｜우리는 누구인가",th:"🧬 Restarter™｜เราเป็นใคร",vi:"🧬 Restarter™｜Chúng tôi là ai",ms:"🧬 Restarter™｜Siapa Kami",la:"🧬 Restarter™｜Quis sumus"},Cy={"zh-TW":"💬 意見箱｜我們想聽你說","zh-CN":"💬 意见箱｜我们想听你说",en:"💬 Feedback｜We Want to Hear You",ja:"💬 ご意見箱｜あなたの声を聞かせて",ko:"💬 피드백｜여러분의 의견을 듣고 싶어요",th:"💬 กล่องความคิดเห็น｜เราอยากฟังคุณ",vi:"💬 Hộp góp ý｜Chúng tôi muốn lắng nghe bạn",ms:"💬 Kotak Maklum Balas｜Kami ingin mendengar anda",la:"💬 Arca Consilii｜Te audire volumus"},$a=()=>{const{lang:n}=Qe(),e=xa(),t=$e(),i=_y[n]||_y["zh-TW"],[s,o]=g.useState(20),a=e.pathname==="/feedback",l=e.pathname==="/"||e.pathname==="/home";return g.useEffect(()=>{if(a){o(20);return}if(l){o(24);return}o(20)},[n,a,l]),l&&typeof window<"u"&&window.innerWidth>768?null:r.jsxs("footer",{style:{width:"100%",margin:"0 auto",marginTop:0,background:l?"rgba(255,255,255,0.95)":"rgba(255,255,255,0.92)",borderRadius:l?16:0,padding:l?"16px":"8px 0",boxShadow:l?"0 2px 12px #6B5BFF22":"0 -2px 8px #0001",borderTop:l?"none":"1px solid #eee",position:a?"fixed":l?"relative":"static",bottom:a?0:"auto",top:a?"auto":l?`${s}px`:"auto",zIndex:10,transition:a?"none":l?"top 0.3s ease":"none"},children:[r.jsxs("div",{style:{width:"100%",maxWidth:800,margin:"0 auto",display:"flex",flexDirection:"row",justifyContent:"center",alignItems:"center",gap:l?20:40,flexWrap:"wrap",padding:l?"0":"0 20px"},children:[r.jsx("span",{onClick:()=>t("/privacy-policy"),style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:l?12:14,cursor:"pointer"},children:i.privacy}),r.jsx("span",{onClick:()=>t("/terms"),style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:l?12:14,cursor:"pointer"},children:i.terms}),r.jsx("span",{onClick:()=>t("/data-deletion"),style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:l?12:14,cursor:"pointer"},children:i.deletion}),r.jsx("span",{onClick:()=>t("/about"),style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:l?12:14,cursor:"pointer"},children:Iy[n]||Iy["zh-TW"]}),r.jsx("span",{onClick:()=>t("/feedback"),style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:l?12:14,cursor:"pointer"},children:Cy[n]||Cy["zh-TW"]})]}),r.jsx("style",{children:`
        @media (max-width: 768px) {
          footer {
            padding: 4px 16px 24px 16px !important;
            marginTop: 0 !important;
            position: relative !important;
            bottom: auto !important;
            top: auto !important;
          }
          footer > div {
            gap: 12px !important;
            flex-direction: row !important;
            justify-content: flex-start !important;
            flex-wrap: wrap !important;
            padding-left: 20px !important;
          }
          footer > div > a {
            padding: 4px 6px !important;
            fontSize: 12px !important;
          }
        }
        @media (min-width: 700px) {
          footer {
            padding: 8px !important;
          }
          footer > div {
            flex-direction: row !important;
            gap: 40px !important;
            justify-content: center !important;
            flex-wrap: wrap !important;
          }
          footer > div > a {
            padding: 4px 8px !important;
          }
        }
      `})]})},Ry={"zh-TW":["💡 你希望多一個什麼功能？","💬 有沒有讓你感動，或失望的使用時刻？","🔧 你覺得哪裡還不夠順、不夠暖、不夠真？","今天我想說...","如果我能改一件事，我會..."],"zh-CN":["💡 你希望多一个什么功能？","💬 有没有让你感动，或失望的使用时刻？","🔧 你觉得哪里还不够顺、不够暖、不够真？","今天我想说...","如果我能改一件事，我会..."],en:["💡 What feature do you wish for?","💬 Any moment that moved or disappointed you?","🔧 Where could we be smoother, warmer, or more real?","Today I want to say...","If I could change one thing, I would..."],ja:["💡 どんな機能が欲しいですか？","💬 感動した、またはがっかりした瞬間はありますか？","🔧 どこがもっとスムーズで、温かく、リアルになれると思いますか？","今日はこう言いたい...","もし一つ変えられるなら、私は..."],ko:["💡 어떤 기능이 더 있었으면 하나요?","💬 감동하거나 실망했던 순간이 있나요?","🔧 어디가 더 부드럽고, 따뜻하고, 진실해질 수 있을까요?","오늘 나는 이렇게 말하고 싶어요...","만약 한 가지를 바꿀 수 있다면, 나는..."],th:["💡 คุณอยากได้ฟีเจอร์อะไรเพิ่ม?","💬 มีช่วงเวลาไหนที่คุณประทับใจหรือผิดหวังไหม?","🔧 ตรงไหนที่คุณคิดว่ายังไม่ลื่นไหล ไม่อบอุ่น หรือไม่จริงใจ?","วันนี้ฉันอยากพูดว่า...","ถ้าฉันเปลี่ยนอะไรได้สักอย่าง ฉันจะ..."],vi:["💡 Bạn muốn có thêm tính năng gì?","💬 Có khoảnh khắc nào khiến bạn cảm động hoặc thất vọng không?","🔧 Bạn nghĩ chỗ nào chưa đủ mượt, chưa đủ ấm, chưa đủ thật?","Hôm nay tôi muốn nói...","Nếu tôi có thể thay đổi một điều, tôi sẽ..."],ms:["💡 Apa ciri yang anda inginkan?","💬 Ada detik yang menyentuh atau mengecewakan anda?","🔧 Di mana yang anda rasa belum cukup lancar, hangat, atau benar?","Hari ini saya ingin berkata...","Jika saya boleh ubah satu perkara, saya akan..."],la:["💡 Quam rem novam optas?","💬 Estne momentum quod te movit aut destituit?","🔧 Ubi putas nondum satis lenem, calidum, verum esse?","Hodie dicere volo...","Si unum mutare possem, id facerem..."]},Ay={"zh-TW":{title:"💬 意見箱｜我們想聽你說",submit:"送出",success:"我們聽見你了，感謝你願意說出來。",subtitle:"你的建議，可能會成為下一版的靈魂！"},"zh-CN":{title:"💬 意见箱｜我们想听你说",submit:"提交",success:"我们听见你了，感谢你愿意说出来。",subtitle:"你的建议，可能会成为下一个版本的灵魂！"},en:{title:"💬 Feedback｜We Want to Hear You",submit:"Send",success:"We hear you. Thank you for sharing your thoughts.",subtitle:"Your suggestion could be the soul of our next update!"},ja:{title:"💬 ご意見箱｜あなたの声を聞かせて",submit:"送信",success:"あなたの声が届きました。伝えてくれてありがとう。",subtitle:"あなたの提案が次のアップデートの魂になるかも！"},ko:{title:"💬 의견함｜당신의 이야기를 듣고 싶어요",submit:"보내기",success:"당신의 목소리를 들었습니다. 말해줘서 고마워요.",subtitle:"당신의 제안이 다음 업데이트의 영혼이 될 수 있어요!"},th:{title:"💬 กล่องความคิดเห็น｜เราอยากฟังคุณ",submit:"ส่ง",success:"เราได้รับข้อความของคุณแล้ว ขอบคุณที่แบ่งปันความคิดของคุณ",subtitle:"ข้อเสนอของคุณอาจเป็นหัวใจของอัปเดตถัดไป!"},vi:{title:"💬 Hộp góp ý｜Chúng tôi muốn lắng nghe bạn",submit:"Gửi",success:"Chúng tôi đã nghe bạn. Cảm ơn bạn đã chia sẻ.",subtitle:"Góp ý của bạn có thể là linh hồn của bản cập nhật tiếp theo!"},ms:{title:"💬 Kotak Maklum Balas｜Kami ingin mendengar anda",submit:"Hantar",success:"Kami telah mendengar anda. Terima kasih kerana berkongsi.",subtitle:"Cadangan anda mungkin menjadi jiwa kemas kini kami yang seterusnya!"},la:{title:"💬 Arca Consilii｜Te audire volumus",submit:"Mitte",success:"Te audivimus. Gratias quod communicasti.",subtitle:"Consilium tuum animam versionis proximæ efficere potest!"}};function y5(){const n=$e(),e=Je(),[t,i]=g.useState(""),[s,o]=g.useState(!1),[a,l]=g.useState(!1),[c,u]=g.useState(""),[h,p]=g.useState("zh-TW"),[f,b]=g.useState(0),x=Ay[h]||Ay["zh-TW"];g.useEffect(()=>{const w=()=>p(localStorage.getItem("lang")||"zh-TW");return w(),window.addEventListener("storage",w),()=>window.removeEventListener("storage",w)},[]),g.useEffect(()=>{const w=setInterval(()=>{b(I=>(I+1)%Ry[h].length)},3e3);return()=>clearInterval(w)},[h]);const S=async()=>{if(t.trim()){l(!0),u("");try{const w=e.currentUser,I=await fetch("/api/feedback",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:t.trim(),userEmail:(w==null?void 0:w.email)||"",userNickname:(w==null?void 0:w.displayName)||"匿名",userLang:h})}),j=await I.json();I.ok?(o(!0),i("")):u(j.error||"提交失敗，請稍後再試")}catch{u("網路錯誤，請稍後再試")}finally{l(!1)}}};return r.jsxs("div",{style:{minHeight:"100vh",background:"linear-gradient(135deg, #e0e7ff 0%, #b7cfff 100%)",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"flex-start",padding:"48px 0 120px 0"},children:[r.jsx("button",{onClick:()=>n("/"),style:{position:"absolute",top:24,left:24,zIndex:10,background:"#fff",border:"1.5px solid #6B5BFF",color:"#6B5BFF",borderRadius:8,padding:"6px 18px",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:"0 2px 8px #0001"},children:"返回"}),r.jsxs("div",{style:{maxWidth:520,background:"#fff",borderRadius:18,boxShadow:"0 2px 16px #6B5BFF22",padding:40,marginTop:64,display:"flex",flexDirection:"column",alignItems:"center"},children:[r.jsx("h1",{style:{fontSize:32,fontWeight:900,color:"#6B5BFF",marginBottom:8},children:x.title}),r.jsx("div",{style:{fontSize:18,color:"#614425",fontWeight:700,marginBottom:18,textAlign:"center"},children:x.subtitle}),s?r.jsx("div",{style:{fontSize:22,color:"#614425",fontWeight:900,marginTop:32,textAlign:"center",minHeight:80},children:x.success}):r.jsxs(r.Fragment,{children:[r.jsx("textarea",{value:t,onChange:w=>i(w.target.value),placeholder:Ry[h][f],style:{width:"100%",minHeight:160,fontSize:20,border:"none",outline:"none",resize:"vertical",background:"#f7f8fa",borderRadius:12,padding:18,marginBottom:18,boxShadow:"0 2px 8px #6B5BFF11"}}),c&&r.jsx("div",{style:{color:"#ff4d4f",fontSize:14,marginBottom:12,textAlign:"center"},children:c}),r.jsx("button",{onClick:S,style:{background:a?"#ccc":"#6B5BFF",color:"#fff",border:"none",borderRadius:8,padding:"12px 32px",fontWeight:900,fontSize:20,cursor:a?"not-allowed":"pointer",boxShadow:"0 2px 8px #6B5BFF33",marginTop:8},disabled:!t.trim()||a,children:a?"送出中...":x.submit})]})]}),r.jsx($a,{})]})}const x5=()=>{const[n,e]=g.useState([]),[t,i]=g.useState(!0),[s,o]=g.useState(""),[a,l]=g.useState(""),[c,u]=g.useState(!1),h=async()=>{try{const b=await Et.get(`/api/admin-feedback?adminKey=${a}`);e(b.data.feedbacks),i(!1)}catch{o("取得意見列表失敗"),i(!1)}},p=()=>{a==="restarter_admin_2024"?(u(!0),h()):o("管理員密碼錯誤")},f=async()=>{try{const b=await Et.post("/api/admin-feedback/export",{adminKey:a});alert(`意見已匯出，共 ${b.data.totalExported} 條`)}catch{alert("匯出失敗")}};return c?r.jsx("div",{className:"min-h-screen bg-gradient-to-br from-purple-50 to-blue-50 p-4",children:r.jsx("div",{className:"max-w-6xl mx-auto",children:r.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[r.jsxs("div",{className:"flex justify-between items-center mb-6",children:[r.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:"意見管理系統"}),r.jsxs("div",{className:"space-x-4",children:[r.jsx("button",{onClick:h,className:"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 transition-colors",children:"重新整理"}),r.jsx("button",{onClick:f,className:"bg-green-600 text-white px-4 py-2 rounded-md hover:bg-green-700 transition-colors",children:"匯出意見"})]})]}),t?r.jsxs("div",{className:"text-center py-8",children:[r.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-600 mx-auto"}),r.jsx("p",{className:"mt-4 text-gray-600",children:"載入中..."})]}):s?r.jsx("div",{className:"text-center py-8",children:r.jsx("p",{className:"text-red-500",children:s})}):r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"text-sm text-gray-600 mb-4",children:["共 ",n.length," 條意見"]}),n.map(b=>r.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow",children:[r.jsxs("div",{className:"flex justify-between items-start mb-3",children:[r.jsxs("div",{children:[r.jsx("h3",{className:"font-semibold text-gray-800",children:b.userNickname||"匿名用戶"}),r.jsx("p",{className:"text-sm text-gray-500",children:b.userEmail||"未提供 Email"})]}),r.jsxs("div",{className:"text-right",children:[r.jsx("span",{className:"text-xs text-gray-500",children:b.timestamp}),r.jsx("div",{className:"mt-1",children:r.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${b.source==="local"?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"}`,children:b.source==="local"?"本地儲存":"Firebase"})})]})]}),r.jsx("div",{className:"bg-gray-50 rounded-md p-3 mb-3",children:r.jsx("p",{className:"text-gray-700 whitespace-pre-wrap",children:b.content})}),r.jsxs("div",{className:"flex justify-between items-center text-sm text-gray-500",children:[r.jsxs("span",{children:["語言: ",b.userLang]}),r.jsxs("span",{children:["狀態: ",b.status]})]}),b.adminNotes&&r.jsx("div",{className:"mt-3 p-3 bg-blue-50 rounded-md",children:r.jsxs("p",{className:"text-sm text-blue-800",children:[r.jsx("strong",{children:"管理員備註:"})," ",b.adminNotes]})})]},b.id)),n.length===0&&r.jsx("div",{className:"text-center py-8 text-gray-500",children:"目前沒有意見"})]})]})})}):r.jsx("div",{className:"min-h-screen bg-gradient-to-br from-purple-50 to-blue-50 flex items-center justify-center",children:r.jsxs("div",{className:"bg-white p-8 rounded-lg shadow-lg max-w-md w-full",children:[r.jsx("h1",{className:"text-2xl font-bold text-center mb-6 text-gray-800",children:"管理員登入"}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"管理員密碼"}),r.jsx("input",{type:"password",value:a,onChange:b=>l(b.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500",placeholder:"輸入管理員密碼"})]}),r.jsx("button",{onClick:p,className:"w-full bg-purple-600 text-white py-2 px-4 rounded-md hover:bg-purple-700 transition-colors",children:"登入"}),s&&r.jsx("p",{className:"text-red-500 text-sm text-center",children:s})]})]})})},b5={"zh-TW":"返回","zh-CN":"返回",en:"Back",ja:"戻る",ko:"뒤로",th:"กลับ",vi:"Quay lại",ms:"Kembali",la:"Revertere"};function v5(){const n=$e(),e=Je(),t=e.currentUser,i=localStorage.getItem("lang")||"zh-TW";g.useEffect(()=>{t||n("/register",{replace:!0})},[t,n]);const[s,o]=g.useState((t==null?void 0:t.displayName)||""),[a]=g.useState((t==null?void 0:t.email)||""),[l,c]=g.useState((t==null?void 0:t.photoURL)||""),[u,h]=g.useState(""),[p,f]=g.useState(""),[b,x]=g.useState(""),[S,w]=g.useState(""),[I,j]=g.useState(""),[A,D]=g.useState(""),[O,P]=g.useState(""),[B,k]=g.useState(""),[T,R]=g.useState(!1);g.useEffect(()=>{let _=!1;const v=async()=>{_||(_=!0,await hn(e),n("/register?needProfile=1",{replace:!0}))},z=L=>{L.preventDefault(),L.returnValue="",v()},H=L=>{var ee;(ee=L==null?void 0:L.preventDefault)==null||ee.call(L),v(),window.history.pushState(null,"","/CompleteProfile")};return window.addEventListener("beforeunload",z),window.addEventListener("popstate",H),window.history.pushState(null,"","/CompleteProfile"),()=>{window.removeEventListener("beforeunload",z),window.removeEventListener("popstate",H)}},[e,n]);const E=async _=>{if(_.preventDefault(),k(""),!s||!u||!p||!S||!I||!A||!O){k("請填寫所有欄位");return}R(!0);try{await Ma(Ot(ht,"users",t.uid),{nickname:s,email:a,avatarUrl:l,gender:u,country:p,region:b,age:S,interest:I,eventType:A,improvement:O,completed:!0,updatedAt:new Date}),R(!1),n("/",{replace:!0})}catch(v){k(v.message),R(!1)}};return g.useEffect(()=>{(async()=>{if(t!=null&&t.uid){const v=await Ys(()=>Promise.resolve().then(()=>uc),void 0).then(z=>z.getDoc(z.doc(ht,"users",t.uid)));v.exists()&&v.data().completed&&(await hn(e),n("/register",{replace:!0}))}})()},[t,e,n]),r.jsxs("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",background:"#f7f7fa",position:"relative"},children:[r.jsxs("button",{onClick:()=>n("/register",{replace:!0}),style:{position:"absolute",top:32,left:36,zIndex:10,backgroundColor:"#374151",color:"white",fontWeight:"bold",padding:"0.5rem 1rem",borderRadius:"0.375rem",border:"none",cursor:"pointer",fontSize:16},children:["← ",b5[i]||"返回"]}),r.jsxs("form",{onSubmit:E,style:{background:"#fff",borderRadius:16,padding:32,boxShadow:"0 4px 24px #0001",width:360,position:"relative"},children:[r.jsx("button",{type:"button",onClick:async()=>{await hn(e),n("/register?needProfile=1",{replace:!0})},style:{position:"absolute",top:16,right:16,background:"none",border:"none",fontSize:22,color:"#888",cursor:"pointer"},children:"×"}),r.jsx("h2",{style:{textAlign:"center",marginBottom:16},children:"補充個人資料"}),B&&r.jsx("div",{style:{color:"red",marginBottom:12},children:B}),r.jsxs("div",{style:{marginBottom:12},children:[r.jsx("label",{children:"暱稱："}),r.jsx("input",{value:s,onChange:_=>o(_.target.value),required:!0,style:{width:"100%"}})]}),r.jsxs("div",{style:{marginBottom:12},children:[r.jsx("label",{children:"電子郵件："}),r.jsx("input",{value:a,disabled:!0,style:{width:"100%",background:"#eee"}})]}),r.jsxs("div",{style:{marginBottom:12},children:[r.jsx("label",{children:"頭像網址："}),r.jsx("input",{value:l,onChange:_=>c(_.target.value),style:{width:"100%"}})]}),r.jsxs("div",{style:{marginBottom:12},children:[r.jsx("label",{children:"性別："}),r.jsxs("select",{value:u,onChange:_=>h(_.target.value),required:!0,style:{width:"100%"},children:[r.jsx("option",{value:"",children:"請選擇"}),r.jsx("option",{value:"male",children:"男"}),r.jsx("option",{value:"female",children:"女"})]})]}),r.jsxs("div",{style:{marginBottom:12},children:[r.jsx("label",{children:"國家/地區："}),r.jsxs("select",{value:p,onChange:_=>f(_.target.value),required:!0,style:{width:"100%"},children:[r.jsx("option",{value:"",children:"請選擇"}),(nk["zh-TW"]||[]).map(_=>r.jsx("option",{value:_,children:_},_))]})]}),r.jsxs("div",{style:{marginBottom:12},children:[r.jsx("label",{children:"城市："}),r.jsx("input",{value:b,onChange:_=>x(_.target.value),style:{width:"100%"}})]}),r.jsxs("div",{style:{marginBottom:12},children:[r.jsx("label",{children:"年齡："}),r.jsxs("select",{value:S,onChange:_=>w(_.target.value),required:!0,style:{width:"100%"},children:[r.jsx("option",{value:"",children:"請選擇"}),ik.map(_=>r.jsx("option",{value:_,children:_},_))]})]}),r.jsxs("div",{style:{marginBottom:12},children:[r.jsx("label",{children:"興趣："}),r.jsxs("select",{value:I,onChange:_=>j(_.target.value),required:!0,style:{width:"100%"},children:[r.jsx("option",{value:"",children:"請選擇"}),(tk["zh-TW"]||[]).map(_=>r.jsx("option",{value:_,children:_},_))]})]}),r.jsxs("div",{style:{marginBottom:12},children:[r.jsx("label",{children:"事件類別："}),r.jsxs("select",{value:A,onChange:_=>D(_.target.value),required:!0,style:{width:"100%"},children:[r.jsx("option",{value:"",children:"請選擇"}),(uB["zh-TW"]||[]).map(_=>r.jsx("option",{value:_,children:_},_))]})]}),r.jsxs("div",{style:{marginBottom:12},children:[r.jsx("label",{children:"想改善什麼："}),r.jsx("input",{value:O,onChange:_=>P(_.target.value),required:!0,style:{width:"100%"}})]}),r.jsx("button",{type:"submit",disabled:T,style:{width:"100%",padding:10,fontWeight:700,fontSize:18,background:"#4caf50",color:"#fff",border:"none",borderRadius:8},children:T?"儲存中...":"完成"})]})]})}const w5={"zh-TW":"返回","zh-CN":"返回",en:"Back",ja:"戻る",ko:"뒤로",th:"กลับ",vi:"Quay lại",ms:"Kembali",la:"Revertere"},Ey={"zh-TW":r.jsxs("div",{children:[r.jsx("h1",{children:"Restarter™ App 隱私權政策"}),r.jsx("p",{children:"本應用程式由 Restarter™ 團隊開發，致力於保護您的個人資料與隱私權。本政策說明我們如何收集、使用、儲存、保護及分享您的個人資料，並說明您對於個人資料的權利。"}),r.jsx("h2",{children:"一、我們收集的資料"}),r.jsxs("ul",{children:[r.jsx("li",{children:"電子郵件地址（Email）"}),r.jsx("li",{children:"使用者名稱/暱稱"}),r.jsx("li",{children:"頭像（如有上傳）"}),r.jsx("li",{children:"性別、年齡、國家/地區、城市（如用戶自願填寫）"}),r.jsx("li",{children:"興趣、經歷事件、個人描述等自願填寫的資料"}),r.jsx("li",{children:"登入紀錄、操作紀錄（僅用於安全與服務優化）"})]}),r.jsx("h2",{children:"二、資料用途"}),r.jsxs("ul",{children:[r.jsx("li",{children:"用於身份驗證、帳號管理與個人化服務"}),r.jsx("li",{children:"用於社群互動、配對、任務、花園等功能"}),r.jsx("li",{children:"用於服務安全、錯誤偵測與防止濫用"}),r.jsx("li",{children:"用於統計分析與產品優化（僅以匿名方式）"}),r.jsx("li",{children:"不會將您的個人資料出售、出租或未經授權分享給第三方"})]}),r.jsx("h2",{children:"三、第三方服務"}),r.jsxs("p",{children:["本應用程式使用 Google Firebase 作為後端服務平台，Firebase 可能會根據其 ",r.jsx("span",{href:"https://firebase.google.com/support/privacy",target:"_blank",rel:"noopener noreferrer",children:"隱私政策"})," 處理技術資料（如裝置資訊、IP、操作紀錄等）。"]}),r.jsx("p",{children:"如您使用 Google、Apple、Facebook 等第三方帳號登入，僅會取得必要的公開資訊（如 email、暱稱、頭像），不會取得您的密碼。"}),r.jsx("h2",{children:"四、Cookie 與追蹤技術"}),r.jsx("p",{children:"本應用程式可能使用 Cookie 或類似技術以提升用戶體驗與安全性。您可於瀏覽器設定中管理 Cookie 偏好。"}),r.jsx("h2",{children:"五、資料儲存與保護"}),r.jsxs("ul",{children:[r.jsx("li",{children:"所有個人資料均儲存於 Google Firebase 雲端，並採用業界標準的加密與安全措施。"}),r.jsx("li",{children:"僅授權人員可存取您的個人資料，且僅限於服務維護與法規要求。"})]}),r.jsx("h2",{children:"六、您的權利"}),r.jsxs("ul",{children:[r.jsx("li",{children:"您有權查詢、更正、下載或刪除您的個人資料。"}),r.jsx("li",{children:"您可隨時於 App 內或來信要求刪除帳號與所有資料，我們將於 3-5 個工作天內完成。"}),r.jsxs("li",{children:["聯絡信箱：",r.jsx("span",{href:"mailto:rbben521@gmail.com",children:"rbben521@gmail.com"})]})]}),r.jsx("h2",{children:"七、政策變更"}),r.jsx("p",{children:"如本政策有重大變更，將於 App 內公告並更新本頁內容。"})]}),"zh-CN":r.jsxs("div",{children:[r.jsx("h1",{children:"Restarter™ App 隐私政策"}),r.jsx("p",{children:"本应用程序由 Restarter™ 团队开发，致力于保护您的个人资料与隐私权。本政策说明我们如何收集、使用、存储、保护及分享您的个人资料，并说明您对于个人资料的权利。"}),r.jsx("h2",{children:"一、我们收集的资料"}),r.jsxs("ul",{children:[r.jsx("li",{children:"电子邮件地址（Email）"}),r.jsx("li",{children:"用户名/昵称"}),r.jsx("li",{children:"头像（如有上传）"}),r.jsx("li",{children:"性别、年龄、国家/地区、城市（如用户自愿填写）"}),r.jsx("li",{children:"兴趣、经历事件、个人描述等自愿填写的资料"}),r.jsx("li",{children:"登录记录、操作记录（仅用于安全与服务优化）"})]}),r.jsx("h2",{children:"二、资料用途"}),r.jsxs("ul",{children:[r.jsx("li",{children:"用于身份验证、账号管理与个性化服务"}),r.jsx("li",{children:"用于社群互动、配对、任务、花园等功能"}),r.jsx("li",{children:"用于服务安全、错误检测与防止滥用"}),r.jsx("li",{children:"用于统计分析与产品优化（仅以匿名方式）"}),r.jsx("li",{children:"不会将您的个人资料出售、出租或未经授权分享给第三方"})]}),r.jsx("h2",{children:"三、第三方服务"}),r.jsxs("p",{children:["本应用程序使用 Google Firebase 作为后端服务平台，Firebase 可能会根据其 ",r.jsx("span",{href:"https://firebase.google.com/support/privacy",target:"_blank",rel:"noopener noreferrer",children:"隐私政策"})," 处理技术资料（如设备信息、IP、操作记录等）。"]}),r.jsx("p",{children:"如您使用 Google、Apple、Facebook 等第三方账号登录，仅会取得必要的公开信息（如 email、昵称、头像），不会取得您的密码。"}),r.jsx("h2",{children:"四、Cookie 与追踪技术"}),r.jsx("p",{children:"本应用程序可能使用 Cookie 或类似技术以提升用户体验与安全性。您可于浏览器设置中管理 Cookie 偏好。"}),r.jsx("h2",{children:"五、资料存储与保护"}),r.jsxs("ul",{children:[r.jsx("li",{children:"所有个人资料均存储于 Google Firebase 云端，并采用业界标准的加密与安全措施。"}),r.jsx("li",{children:"仅授权人员可存取您的个人资料，且仅限于服务维护与法规要求。"})]}),r.jsx("h2",{children:"六、您的权利"}),r.jsxs("ul",{children:[r.jsx("li",{children:"您有权查询、更正、下载或删除您的个人资料。"}),r.jsx("li",{children:"您可随时于 App 内或来信要求删除账号与所有资料，我们将于 3-5 个工作天内完成。"}),r.jsxs("li",{children:["联系邮箱：",r.jsx("span",{href:"mailto:rbben521@gmail.com",children:"rbben521@gmail.com"})]})]}),r.jsx("h2",{children:"七、政策变更"}),r.jsx("p",{children:"如本政策有重大变更，将于 App 内公告并更新本页内容。"})]}),en:r.jsxs("div",{children:[r.jsx("h1",{children:"Privacy Policy for Restarter™ App"}),r.jsx("p",{children:"Restarter™ is committed to protecting your privacy. This policy explains how we collect, use, store, and protect your personal information, and your rights regarding your data."}),r.jsx("h2",{children:"1. Information We Collect"}),r.jsxs("ul",{children:[r.jsx("li",{children:"Email address"}),r.jsx("li",{children:"Username/Nickname"}),r.jsx("li",{children:"Avatar (if uploaded)"}),r.jsx("li",{children:"Gender, age, country/region, city (if provided)"}),r.jsx("li",{children:"Interests, life events, personal description (if provided)"}),r.jsx("li",{children:"Login and activity logs (for security and service improvement)"})]}),r.jsx("h2",{children:"2. Purpose of Collection"}),r.jsxs("ul",{children:[r.jsx("li",{children:"Authentication, account management, and personalized services"}),r.jsx("li",{children:"Community interaction, matching, missions, garden features"}),r.jsx("li",{children:"Service security, error detection, and abuse prevention"}),r.jsx("li",{children:"Statistical analysis and product improvement (anonymized)"}),r.jsx("li",{children:"We do not sell, rent, or share your personal data with third parties without your consent"})]}),r.jsx("h2",{children:"3. Third-Party Services"}),r.jsxs("p",{children:["This app uses Google Firebase as its backend. Firebase may process technical data according to its ",r.jsx("span",{href:"https://firebase.google.com/support/privacy",target:"_blank",rel:"noopener noreferrer",children:"Privacy Policy"})," (e.g., device info, IP, activity logs)."]}),r.jsx("p",{children:"If you log in via Google, Apple, or Facebook, we only access your public info (email, nickname, avatar), never your password."}),r.jsx("h2",{children:"4. Cookies and Tracking"}),r.jsx("p",{children:"We may use cookies or similar technologies to enhance your experience and security. You can manage cookie preferences in your browser settings."}),r.jsx("h2",{children:"5. Data Storage and Protection"}),r.jsxs("ul",{children:[r.jsx("li",{children:"All personal data is stored on Google Firebase cloud with industry-standard encryption and security."}),r.jsx("li",{children:"Only authorized personnel can access your data, solely for service maintenance or legal compliance."})]}),r.jsx("h2",{children:"6. Your Rights"}),r.jsxs("ul",{children:[r.jsx("li",{children:"You have the right to access, correct, download, or delete your personal data."}),r.jsx("li",{children:"You may request account/data deletion at any time via the app or by email. We will process your request within 3-5 business days."}),r.jsxs("li",{children:["Contact: ",r.jsx("span",{href:"mailto:rbben521@gmail.com",children:"rbben521@gmail.com"})]})]}),r.jsx("h2",{children:"7. Policy Updates"}),r.jsx("p",{children:"We will notify users of major changes to this policy via in-app announcements and update this page accordingly."})]}),ja:r.jsxs("div",{children:[r.jsx("h1",{children:"Restarter™ アプリ プライバシーポリシー"}),r.jsx("p",{children:"本アプリはRestarter™チームによって開発され、ユーザーの個人情報とプライバシーの保護に努めています。本ポリシーは、どのように個人情報を収集・利用・保存・保護・共有するか、またユーザーの権利について説明します。"}),r.jsx("h2",{children:"1. 収集する情報"}),r.jsxs("ul",{children:[r.jsx("li",{children:"メールアドレス"}),r.jsx("li",{children:"ユーザー名/ニックネーム"}),r.jsx("li",{children:"アバター（アップロードした場合）"}),r.jsx("li",{children:"性別、年齢、国/地域、都市（任意）"}),r.jsx("li",{children:"興味、経験イベント、自己紹介（任意）"}),r.jsx("li",{children:"ログイン・操作履歴（セキュリティ・サービス向上のため）"})]}),r.jsx("h2",{children:"2. 利用目的"}),r.jsxs("ul",{children:[r.jsx("li",{children:"認証、アカウント管理、パーソナライズサービス"}),r.jsx("li",{children:"コミュニティ交流、マッチング、ミッション、ガーデン機能"}),r.jsx("li",{children:"サービスの安全性、エラー検出、不正防止"}),r.jsx("li",{children:"統計分析・製品改善（匿名化）"}),r.jsx("li",{children:"同意なく第三者に個人情報を販売・共有しません"})]}),r.jsx("h2",{children:"3. サードパーティサービス"}),r.jsxs("p",{children:["本アプリはGoogle Firebaseをバックエンドとして使用しています。Firebaseは ",r.jsx("span",{href:"https://firebase.google.com/support/privacy",target:"_blank",rel:"noopener noreferrer",children:"プライバシーポリシー"})," に従い技術情報（デバイス情報、IP、操作履歴など）を処理する場合があります。"]}),r.jsx("p",{children:"Google、Apple、Facebook等でログインした場合、公開情報（メール、ニックネーム、アバター）のみ取得し、パスワードは取得しません。"}),r.jsx("h2",{children:"4. Cookieとトラッキング技術"}),r.jsx("p",{children:"本アプリはユーザー体験と安全性向上のため コッキー または類似技術を使用する場合があります。ブラウザ設定でCookieの管理が可能です。"}),r.jsx("h2",{children:"5. データ保存と保護"}),r.jsxs("ul",{children:[r.jsx("li",{children:"全ての個人情報はGoogle Firebaseクラウドに保存され、業界標準の暗号化とセキュリティで保護されます。"}),r.jsx("li",{children:"認可された担当者のみがサービス保守や法令遵守のためにアクセス可能です。"})]}),r.jsx("h2",{children:"6. ユーザーの権利"}),r.jsxs("ul",{children:[r.jsx("li",{children:"個人情報の照会、訂正、ダウンロード、削除が可能です。"}),r.jsx("li",{children:"アプリ内またはメールでいつでも削除依頼ができ、3～5営業日以内に対応します。"}),r.jsxs("li",{children:["連絡先：",r.jsx("span",{href:"mailto:rbben521@gmail.com",children:"rbben521@gmail.com"})]})]}),r.jsx("h2",{children:"7. ポリシーの変更"}),r.jsx("p",{children:"本ポリシーに重大な変更がある場合、アプリ内で告知し本ページを更新します。"})]}),ko:r.jsxs("div",{children:[r.jsx("h1",{children:"Restarter™ 앱 개인정보처리방침"}),r.jsx("p",{children:"본 앱은 Restarter™ 팀이 개발하였으며, 사용자의 개인정보와 프라이버시 보호에 최선을 다합니다. 본 정책은 개인정보의 수집, 이용, 저장, 보호, 공유 방법과 사용자의 권리에 대해 설명합니다."}),r.jsx("h2",{children:"1. 수집하는 정보"}),r.jsxs("ul",{children:[r.jsx("li",{children:"이메일 주소"}),r.jsx("li",{children:"사용자명/닉네임"}),r.jsx("li",{children:"아바타(업로드한 경우)"}),r.jsx("li",{children:"성별, 나이, 국가/지역, 도시(선택사항)"}),r.jsx("li",{children:"관심사, 경험 이벤트, 자기소개(선택사항)"}),r.jsx("li",{children:"로그인 및 활동 기록(보안 및 서비스 개선 목적)"})]}),r.jsx("h2",{children:"2. 수집 목적"}),r.jsxs("ul",{children:[r.jsx("li",{children:"인증, 계정 관리, 개인화 서비스"}),r.jsx("li",{children:"커뮤니티 상호작용, 매칭, 미션, 가든 기능"}),r.jsx("li",{children:"서비스 보안, 오류 탐지, 오용 방지"}),r.jsx("li",{children:"통계 분석 및 제품 개선(익명화)"}),r.jsx("li",{children:"동의 없이 제3자에게 개인정보를 판매, 임대, 공유하지 않습니다"})]}),r.jsx("h2",{children:"3. 제3자 서비스"}),r.jsxs("p",{children:["본 앱은 Google Firebase를 백엔드로 사용합니다. Firebase는 ",r.jsx("span",{href:"https://firebase.google.com/support/privacy",target:"_blank",rel:"noopener noreferrer",children:"개인정보처리방침"}),"에 따라 기술 정보를 처리할 수 있습니다(예: 기기 정보, IP, 활동 기록 등)."]}),r.jsx("p",{children:"Google, Apple, Facebook 등으로 로그인 시 공개 정보(이메일, 닉네임, 아바타)만 수집하며, 비밀번호는 수집하지 않습니다."}),r.jsx("h2",{children:"4. 쿠키 및 추적 기술"}),r.jsx("p",{children:"본 앱은 사용자 경험 및 보안 향상을 위해 쿠키 또는 유사 기술을 사용할 수 있습니다. 브라우저 설정에서 쿠키 환경설정이 가능합니다."}),r.jsx("h2",{children:"5. 데이터 저장 및 보호"}),r.jsxs("ul",{children:[r.jsx("li",{children:"모든 개인정보는 Google Firebase 클라우드에 저장되며, 업계 표준 암호화 및 보안이 적용됩니다."}),r.jsx("li",{children:"서비스 유지보수 및 법적 요구에 한해 인가된 인원만 접근할 수 있습니다."})]}),r.jsx("h2",{children:"6. 사용자의 권리"}),r.jsxs("ul",{children:[r.jsx("li",{children:"개인정보의 조회, 수정, 다운로드, 삭제가 가능합니다."}),r.jsx("li",{children:"앱 내 또는 이메일로 언제든 삭제 요청이 가능하며, 3~5영업일 이내에 처리됩니다."}),r.jsxs("li",{children:["연락처: ",r.jsx("span",{href:"mailto:rbben521@gmail.com",children:"rbben521@gmail.com"})]})]}),r.jsx("h2",{children:"7. 정책 변경"}),r.jsx("p",{children:"정책에 중대한 변경이 있을 경우 앱 내 공지 및 본 페이지를 업데이트합니다."})]}),th:r.jsxs("div",{children:[r.jsx("h1",{children:"นโยบายความเป็นส่วนตัวของแอป Restarter™"}),r.jsx("p",{children:"แอปนี้พัฒนาโดยทีมงาน Restarter™ มุ่งมั่นในการปกป้องข้อมูลส่วนบุคคลและความเป็นส่วนตัวของคุณ นโยบายนี้อธิบายวิธีการเก็บรวบรวม ใช้ จัดเก็บ ปกป้อง และแบ่งปันข้อมูลส่วนบุคคลของคุณ รวมถึงสิทธิ์ของคุณ"}),r.jsx("h2",{children:"1. ข้อมูลที่เราเก็บรวบรวม"}),r.jsxs("ul",{children:[r.jsx("li",{children:"ที่อยู่อีเมล"}),r.jsx("li",{children:"ชื่อผู้ใช้/ชื่อเล่น"}),r.jsx("li",{children:"อวาตาร์ (ถ้าอัปโหลด)"}),r.jsx("li",{children:"เพศ อายุ ประเทศ/ภูมิภาค เมือง (ถ้าระบุ)"}),r.jsx("li",{children:"ความสนใจ เหตุการณ์ในชีวิต คำอธิบายส่วนตัว (ถ้าระบุ)"}),r.jsx("li",{children:"บันทึกการเข้าสู่ระบบและกิจกรรม (เพื่อความปลอดภัยและปรับปรุงบริการ)"})]}),r.jsx("h2",{children:"2. วัตถุประสงค์ของการเก็บข้อมูล"}),r.jsxs("ul",{children:[r.jsx("li",{children:"การยืนยันตัวตน การจัดการบัญชี และบริการส่วนบุคคล"}),r.jsx("li",{children:"การมีปฏิสัมพันธ์ในชุมชน การจับคู่ ภารกิจ ฟีเจอร์สวน"}),r.jsx("li",{children:"ความปลอดภัยของบริการ การตรวจจับข้อผิดพลาด และป้องกันการละเมิด"}),r.jsx("li",{children:"การวิเคราะห์สถิติและปรับปรุงผลิตภัณฑ์ (แบบไม่ระบุตัวตน)"}),r.jsx("li",{children:"จะไม่ขาย ให้เช่า หรือแบ่งปันข้อมูลส่วนบุคคลของคุณกับบุคคลที่สามโดยไม่ได้รับความยินยอม"})]}),r.jsx("h2",{children:"3. บริการของบุคคลที่สาม"}),r.jsxs("p",{children:["แอปนี้ใช้ Google Firebase เป็นแบ็กเอนด์ Firebase อาจประมวลผลข้อมูลทางเทคนิคตาม ",r.jsx("span",{href:"https://firebase.google.com/support/privacy",target:"_blank",rel:"noopener noreferrer",children:"นโยบายความเป็นส่วนตัว"})," (เช่น ข้อมูลอุปกรณ์ IP บันทึกกิจกรรม)"]}),r.jsx("p",{children:"หากคุณเข้าสู่ระบบผ่าน Google, Apple หรือ Facebook เราจะเข้าถึงเฉพาะข้อมูลสาธารณะ (อีเมล ชื่อเล่น อวาตาร์) ไม่เคยเข้าถึงรหัสผ่านของคุณ"}),r.jsx("h2",{children:"4. คุกกี้และการติดตาม"}),r.jsx("p",{children:"เราอาจใช้คุกกี้หรือเทคโนโลยีที่คล้ายกันเพื่อปรับปรุงประสบการณ์และความปลอดภัยของคุณ คุณสามารถจัดการคุกกี้ได้ในเบราว์เซอร์ของคุณ"}),r.jsx("h2",{children:"5. การจัดเก็บและปกป้องข้อมูล"}),r.jsxs("ul",{children:[r.jsx("li",{children:"ข้อมูลส่วนบุคคลทั้งหมดจะถูกจัดเก็บบนคลาวด์ Google Firebase ด้วยการเข้ารหัสและความปลอดภัยตามมาตรฐานอุตสาหกรรม"}),r.jsx("li",{children:"มีเพียงบุคลากรที่ได้รับอนุญาตเท่านั้นที่สามารถเข้าถึงข้อมูลของคุณเพื่อการบำรุงรักษาบริการหรือปฏิบัติตามกฎหมาย"})]}),r.jsx("h2",{children:"6. สิทธิ์ของคุณ"}),r.jsxs("ul",{children:[r.jsx("li",{children:"คุณมีสิทธิ์เข้าถึง แก้ไข ดาวน์โหลด หรือขอลบข้อมูลส่วนบุคคลของคุณ"}),r.jsx("li",{children:"คุณสามารถขอลบบัญชี/ข้อมูลได้ตลอดเวลาผ่านแอปหรืออีเมล เราจะดำเนินการภายใน 3-5 วันทำการ"}),r.jsxs("li",{children:["ติดต่อ: ",r.jsx("span",{href:"mailto:rbben521@gmail.com",children:"rbben521@gmail.com"})]})]}),r.jsx("h2",{children:"7. การอัปเดตนโยบาย"}),r.jsx("p",{children:"เราจะแจ้งให้ผู้ใช้ทราบถึงการเปลี่ยนแปลงที่สำคัญของนโยบายนี้ผ่านการประกาศในแอปและอัปเดตหน้านี้ตามความเหมาะสม"})]}),vi:r.jsxs("div",{children:[r.jsx("h1",{children:"Chính sách bảo mật cho ứng dụng Restarter™"}),r.jsx("p",{children:"Restarter™ cam kết bảo vệ quyền riêng tư của bạn. Chính sách này giải thích cách chúng tôi thu thập, sử dụng, lưu trữ và bảo vệ thông tin cá nhân của bạn, cũng như quyền của bạn đối với dữ liệu đó."}),r.jsx("h2",{children:"1. Thông tin chúng tôi thu thập"}),r.jsxs("ul",{children:[r.jsx("li",{children:"Địa chỉ email"}),r.jsx("li",{children:"Tên người dùng/Biệt danh"}),r.jsx("li",{children:"Ảnh đại diện (nếu tải lên)"}),r.jsx("li",{children:"Giới tính, tuổi, quốc gia/khu vực, thành phố (nếu cung cấp)"}),r.jsx("li",{children:"Sở thích, sự kiện cuộc sống, mô tả cá nhân (nếu cung cấp)"}),r.jsx("li",{children:"Nhật ký đăng nhập và hoạt động (để bảo mật và cải thiện dịch vụ)"})]}),r.jsx("h2",{children:"2. Mục đích thu thập"}),r.jsxs("ul",{children:[r.jsx("li",{children:"Xác thực, quản lý tài khoản và dịch vụ cá nhân hóa"}),r.jsx("li",{children:"Tương tác cộng đồng, ghép đôi, nhiệm vụ, tính năng vườn"}),r.jsx("li",{children:"Bảo mật dịch vụ, phát hiện lỗi và ngăn chặn lạm dụng"}),r.jsx("li",{children:"Phân tích thống kê và cải tiến sản phẩm (ẩn danh)"}),r.jsx("li",{children:"Chúng tôi không bán, cho thuê hoặc chia sẻ dữ liệu cá nhân của bạn với bên thứ ba nếu không có sự đồng ý của bạn"})]}),r.jsx("h2",{children:"3. Dịch vụ của bên thứ ba"}),r.jsxs("p",{children:["Ứng dụng này sử dụng Google Firebase làm backend. Firebase có thể xử lý dữ liệu kỹ thuật theo ",r.jsx("span",{href:"https://firebase.google.com/support/privacy",target:"_blank",rel:"noopener noreferrer",children:"Chính sách bảo mật"})," (ví dụ: thông tin thiết bị, IP, nhật ký hoạt động)."]}),r.jsx("p",{children:"Nếu bạn đăng nhập qua Google, Apple hoặc Facebook, chúng tôi chỉ truy cập thông tin công khai của bạn (email, biệt danh, ảnh đại diện), không bao giờ truy cập mật khẩu của bạn."}),r.jsx("h2",{children:"4. Cookie và theo dõi"}),r.jsx("p",{children:"Chúng tôi có thể sử dụng cookie hoặc các công nghệ tương tự để nâng cao trải nghiệm và bảo mật của bạn. Bạn có thể quản lý cookie trong cài đặt trình duyệt của mình."}),r.jsx("h2",{children:"5. Lưu trữ và bảo vệ dữ liệu"}),r.jsxs("ul",{children:[r.jsx("li",{children:"Tất cả dữ liệu cá nhân được lưu trữ trên đám mây Google Firebase với mã hóa và bảo mật tiêu chuẩn ngành."}),r.jsx("li",{children:"Chỉ những nhân viên được ủy quyền mới có thể truy cập dữ liệu của bạn, chỉ để bảo trì dịch vụ hoặc tuân thủ pháp luật."})]}),r.jsx("h2",{children:"6. Quyền của bạn"}),r.jsxs("ul",{children:[r.jsx("li",{children:"Bạn có quyền truy cập, chỉnh sửa, tải xuống hoặc xóa dữ liệu cá nhân của mình."}),r.jsx("li",{children:"Bạn có thể yêu cầu xóa tài khoản/dữ liệu bất cứ lúc nào qua ứng dụng hoặc email. Chúng tôi sẽ xử lý yêu cầu của bạn trong vòng 3-5 ngày làm việc."}),r.jsxs("li",{children:["Liên hệ: ",r.jsx("span",{href:"mailto:rbben521@gmail.com",children:"rbben521@gmail.com"})]})]}),r.jsx("h2",{children:"7. Cập nhật chính sách"}),r.jsx("p",{children:"Chúng tôi sẽ thông báo cho người dùng về những thay đổi lớn đối với chính sách này qua thông báo trong ứng dụng và cập nhật trang này cho phù hợp."})]}),ms:r.jsxs("div",{children:[r.jsx("h1",{children:"Dasar Privasi untuk Aplikasi Restarter™"}),r.jsx("p",{children:"Restarter™ komited untuk melindungi privasi anda. Polisi ini menerangkan bagaimana kami mengumpul, menggunakan, menyimpan dan melindungi maklumat peribadi anda, serta hak anda terhadap data tersebut."}),r.jsx("h2",{children:"1. Maklumat yang Kami Kumpul"}),r.jsxs("ul",{children:[r.jsx("li",{children:"Alamat emel"}),r.jsx("li",{children:"Nama pengguna/Nama samaran"}),r.jsx("li",{children:"Avatar (jika dimuat naik)"}),r.jsx("li",{children:"Jantina, umur, negara/wilayah, bandar (jika diberikan)"}),r.jsx("li",{children:"Minat, peristiwa hidup, keterangan peribadi (jika diberikan)"}),r.jsx("li",{children:"Log masuk dan aktiviti (untuk keselamatan dan penambahbaikan perkhidmatan)"})]}),r.jsx("h2",{children:"2. Tujuan Pengumpulan"}),r.jsxs("ul",{children:[r.jsx("li",{children:"Pengesahan, pengurusan akaun dan perkhidmatan peribadi"}),r.jsx("li",{children:"Interaksi komuniti, padanan, misi, ciri taman"}),r.jsx("li",{children:"Keselamatan perkhidmatan, pengesanan ralat dan pencegahan penyalahgunaan"}),r.jsx("li",{children:"Analisis statistik dan penambahbaikan produk (tanpa nama)"}),r.jsx("li",{children:"Kami tidak akan menjual, menyewa atau berkongsi data peribadi anda dengan pihak ketiga tanpa kebenaran anda"})]}),r.jsx("h2",{children:"3. Perkhidmatan Pihak Ketiga"}),r.jsxs("p",{children:["Aplikasi ini menggunakan Google Firebase sebagai backend. Firebase mungkin memproses data teknikal mengikut ",r.jsx("span",{href:"https://firebase.google.com/support/privacy",target:"_blank",rel:"noopener noreferrer",children:"Dasar Privasi"})," (cth: maklumat peranti, IP, log aktiviti)."]}),r.jsx("p",{children:"Jika anda log masuk melalui Google, Apple atau Facebook, kami hanya mengakses maklumat awam anda (emel, nama samaran, avatar), tidak pernah kata laluan anda."}),r.jsx("h2",{children:"4. Kuki dan Penjejakan"}),r.jsx("p",{children:"Kami mungkin menggunakan kuki atau teknologi serupa untuk meningkatkan pengalaman dan keselamatan anda. Anda boleh mengurus pilihan kuki dalam tetapan pelayar anda."}),r.jsx("h2",{children:"5. Penyimpanan dan Perlindungan Data"}),r.jsxs("ul",{children:[r.jsx("li",{children:"Semua data peribadi disimpan di awan Google Firebase dengan penyulitan dan keselamatan piawaian industri."}),r.jsx("li",{children:"Soli homines auctoritate praediti possunt tuas notitias accedere, tantum ad servitium vel leges tuendas."})]}),r.jsx("h2",{children:"6. Hak Anda"}),r.jsxs("ul",{children:[r.jsx("li",{children:"Anda berhak untuk mengakses, membetulkan, memuat turun atau memadam data peribadi anda."}),r.jsx("li",{children:"Anda boleh meminta pemadaman akaun/data pada bila-bila masa melalui aplikasi atau e-mel. Kami akan memproses permintaan anda dalam masa 3-5 hari bekerja."}),r.jsxs("li",{children:["Hubungi: ",r.jsx("span",{href:"mailto:rbben521@gmail.com",children:"rbben521@gmail.com"})]})]}),r.jsx("h2",{children:"7. Kemas Kini Polisi"}),r.jsx("p",{children:"Kami akan memaklumkan pengguna tentang perubahan besar pada polisi ini melalui pengumuman dalam aplikasi dan mengemas kini halaman ini dengan sewajarnya."})]}),la:r.jsxs("div",{children:[r.jsx("h1",{children:"Consilium Privacy pro Restarter™ App"}),r.jsx("p",{children:"Restarter™ ad tuendam tuam privacy studet. Haec consilia explicat quomodo notitias personales colligamus, utamur, condamus, tueamur, et iura tua de notitiis exponat."}),r.jsx("h2",{children:"1. Quae colligimus"}),r.jsxs("ul",{children:[r.jsx("li",{children:"Inscriptionem electronicam"}),r.jsx("li",{children:"Nomen usoris/Sobriquet"}),r.jsx("li",{children:"Avatar (si sublatus)"}),r.jsx("li",{children:"Sexus, aetas, regio/natio, urbs (si praebetur)"}),r.jsx("li",{children:"Studia, eventus vitae, descriptio personalis (si praebetur)"}),r.jsx("li",{children:"Acta login et actio (ad securitatem et emendationem servitii)"})]}),r.jsx("h2",{children:"2. Propositum collectionis"}),r.jsxs("ul",{children:[r.jsx("li",{children:"Authenticatio, administratio rationis, officia personalia"}),r.jsx("li",{children:"Communitas, paria, missiones, hortus"}),r.jsx("li",{children:"Securitas servitii, errorum detectio, abusus praeventio"}),r.jsx("li",{children:"Analysis statistica et emendatio producti (anonymizata)"}),r.jsx("li",{children:"Notitias tuas non vendimus, locamus, nec sine consensu communicamus"})]}),r.jsx("h2",{children:"3. Officia tertiarum partium"}),r.jsxs("p",{children:["Haec app utitur Google Firebase ut backend. Firebase potest notitias technicas tractare secundum ",r.jsx("span",{href:"https://firebase.google.com/support/privacy",target:"_blank",rel:"noopener noreferrer",children:"Consilium Privacy"})," (ex. info de machina, IP, acta actionum)."]}),r.jsx("p",{children:"Si per Google, Apple, Facebook ingredieris, solum publicas notitias tuas accedimus (email, sobriquet, avatar), numquam tesseram tuam."}),r.jsx("h2",{children:"4. Cookies et vestigatio"}),r.jsx("p",{children:"Possumus uti cookies aut similibus technologiis ad experientiam et securitatem tuam augendam. Praeferentias cookies in navigatoris tuis regere potes."}),r.jsx("h2",{children:"5. Reconditio et tutela notitiarum"}),r.jsxs("ul",{children:[r.jsx("li",{children:"Omnes notitiae personales in Google Firebase nube servantur, cum encryptione et securitate industriae."}),r.jsx("li",{children:"Soli homines auctoritate praediti possunt tuas notitias accedere, tantum ad servitium vel leges tuendas."})]}),r.jsx("h2",{children:"6. Iura tua"}),r.jsxs("ul",{children:[r.jsx("li",{children:"Ius habes accedere, corrigere, extrahere, aut delere notitias tuas personales."}),r.jsx("li",{children:"Potes petere deletionem rationis/datae quovis tempore per app vel email. Processum intra 3-5 dies negotiales perficimus."}),r.jsxs("li",{children:["Contactus: ",r.jsx("span",{href:"mailto:rbben521@gmail.com",children:"rbben521@gmail.com"})]})]}),r.jsx("h2",{children:"7. Renovatio consilii"}),r.jsx("p",{children:"De mutationibus maioribus huius consilii usores per nuntios in app certiorem faciemus et hanc paginam proinde renovabimus."})]})};function k5(){const n=localStorage.getItem("lang")||"zh-TW",e=$e();return r.jsxs("div",{style:{minHeight:"100vh",background:"#111827",color:"white",padding:"2rem",display:"flex",flexDirection:"column"},children:[r.jsxs("button",{onClick:()=>e("/",{replace:!0}),style:{position:"absolute",top:32,left:36,zIndex:10,backgroundColor:"#374151",color:"white",fontWeight:"bold",padding:"0.5rem 1rem",borderRadius:"0.375rem",border:"none",cursor:"pointer",fontSize:16},children:["← ",w5[n]||"返回"]}),r.jsx("div",{style:{flex:"1 0 auto"},children:r.jsxs("div",{style:{maxWidth:800,margin:"0 auto",background:"#fff",color:"#111",borderRadius:16,padding:32,position:"relative"},children:[Ey[n]||Ey["zh-TW"],r.jsx("div",{style:{textAlign:"center",marginTop:48,color:"#888",fontSize:16},children:"CTX Goodlife Copyright 2025"})]})}),r.jsx("div",{style:{width:"100%",margin:"0 auto",marginTop:24,background:"rgba(255,255,255,0.95)",borderRadius:16,padding:"16px",boxShadow:"0 2px 12px #6B5BFF22"},children:r.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:20,flexWrap:"wrap"},children:[r.jsx("span",{onClick:()=>e("/privacy-policy"),style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12,cursor:"pointer"},children:"隱私權政策"}),r.jsx("span",{onClick:()=>e("/terms"),style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12,cursor:"pointer"},children:"條款/聲明"}),r.jsx("span",{onClick:()=>e("/data-deletion"),style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12,cursor:"pointer"},children:"資料刪除說明"}),r.jsx("span",{onClick:()=>e("/about"),style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12,cursor:"pointer"},children:"🧬 Restarter™｜我們是誰"}),r.jsx("span",{onClick:()=>e("/feedback"),style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12,cursor:"pointer"},children:"💬 意見箱｜我們想聽你說"})]})})]})}const By={"zh-TW":r.jsxs("div",{children:[r.jsx("h1",{children:"資料刪除說明"}),r.jsx("p",{children:"若您希望刪除在 Restarter App 中儲存的個人資料，請來信至："}),r.jsx("p",{children:r.jsx("strong",{children:"rbben521@gmail.com"})}),r.jsx("p",{children:"我們會在 3-5 個工作天內完成資料刪除作業。"})]}),"zh-CN":r.jsxs("div",{children:[r.jsx("h1",{children:"资料删除说明"}),r.jsx("p",{children:"如需删除在 Restarter App 中存储的个人资料，请发送邮件至："}),r.jsx("p",{children:r.jsx("strong",{children:"rbben521@gmail.com"})}),r.jsx("p",{children:"我们将在 3-5 个工作日内完成资料删除。"})]}),en:r.jsxs("div",{children:[r.jsx("h1",{children:"Data Deletion Policy"}),r.jsx("p",{children:"If you wish to delete your personal data stored in the Restarter App, please contact:"}),r.jsx("p",{children:r.jsx("strong",{children:"rbben521@gmail.com"})}),r.jsx("p",{children:"We will complete the deletion process within 3-5 business days."})]}),ja:r.jsxs("div",{children:[r.jsx("h1",{children:"データ削除のご案内"}),r.jsx("p",{children:"Restarterアプリに保存されている個人データの削除をご希望の場合は、以下までご連絡ください："}),r.jsx("p",{children:r.jsx("strong",{children:"rbben521@gmail.com"})}),r.jsx("p",{children:"3～5営業日以内に削除手続きを完了します。"})]}),ko:r.jsxs("div",{children:[r.jsx("h1",{children:"데이터 삭제 안내"}),r.jsx("p",{children:"Restarter 앱에 저장된 개인 데이터를 삭제하려면 다음으로 문의해 주세요:"}),r.jsx("p",{children:r.jsx("strong",{children:"rbben521@gmail.com"})}),r.jsx("p",{children:"3~5 영업일 이내에 삭제를 완료해 드립니다."})]}),th:r.jsxs("div",{children:[r.jsx("h1",{children:"นโยบายการลบข้อมูล"}),r.jsx("p",{children:"หากคุณต้องการลบข้อมูลส่วนบุคคลที่จัดเก็บในแอป Restarter กรุณาติดต่อ:"}),r.jsx("p",{children:r.jsx("strong",{children:"rbben521@gmail.com"})}),r.jsx("p",{children:"เราจะดำเนินการลบข้อมูลภายใน 3-5 วันทำการ"})]}),vi:r.jsxs("div",{children:[r.jsx("h1",{children:"Chính sách xóa dữ liệu"}),r.jsx("p",{children:"Nếu bạn muốn xóa dữ liệu cá nhân được lưu trữ trong ứng dụng Restarter, vui lòng liên hệ:"}),r.jsx("p",{children:r.jsx("strong",{children:"rbben521@gmail.com"})}),r.jsx("p",{children:"Chúng tôi sẽ hoàn tất việc xóa dữ liệu trong vòng 3-5 ngày làm việc."})]}),ms:r.jsxs("div",{children:[r.jsx("h1",{children:"Dasar Pemadaman Data"}),r.jsx("p",{children:"Jika anda ingin memadam data peribadi yang disimpan dalam Aplikasi Restarter, sila hubungi:"}),r.jsx("p",{children:r.jsx("strong",{children:"rbben521@gmail.com"})}),r.jsx("p",{children:"Kami akan menyelesaikan proses pemadaman dalam masa 3-5 hari bekerja."})]}),la:r.jsxs("div",{children:[r.jsx("h1",{children:"Norma Deletionis Datae"}),r.jsx("p",{children:"Si vis delere data personalia in Restarter App reposita, quaeso contactum:"}),r.jsx("p",{children:r.jsx("strong",{children:"rbben521@gmail.com"})}),r.jsx("p",{children:"Processum deletionis intra 3-5 dies negotiales perficimus."})]})},S5={"zh-TW":"返回","zh-CN":"返回",en:"Back",ja:"戻る",ko:"뒤로",th:"กลับ",vi:"Quay lại",ms:"Kembali",la:"Revertere"};function T5(){const n=localStorage.getItem("lang")||"zh-TW",e=$e();return r.jsxs("div",{style:{minHeight:"100vh",background:"#111827",color:"white",padding:"2rem",display:"flex",flexDirection:"column"},children:[r.jsxs("button",{onClick:()=>e("/",{replace:!0}),style:{position:"absolute",top:32,left:36,zIndex:10,backgroundColor:"#374151",color:"white",fontWeight:"bold",padding:"0.5rem 1rem",borderRadius:"0.375rem",border:"none",cursor:"pointer",fontSize:16},children:["← ",S5[n]||"返回"]}),r.jsx("div",{style:{flex:"1 0 auto"},children:r.jsxs("div",{style:{maxWidth:800,margin:"0 auto",background:"#fff",color:"#111",borderRadius:16,padding:32,position:"relative"},children:[By[n]||By["zh-TW"],r.jsx("div",{style:{textAlign:"center",marginTop:48,color:"#888",fontSize:16},children:"CTX Goodlife Copyright 2025"})]})}),r.jsx("div",{style:{width:"100%",margin:"0 auto",marginTop:24,background:"rgba(255,255,255,0.95)",borderRadius:16,padding:"16px",boxShadow:"0 2px 12px #6B5BFF22"},children:r.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:20,flexWrap:"wrap"},children:[r.jsx("span",{onClick:()=>e("/privacy-policy"),style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12,cursor:"pointer"},children:"隱私權政策"}),r.jsx("span",{onClick:()=>e("/terms"),style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12,cursor:"pointer"},children:"條款/聲明"}),r.jsx("span",{onClick:()=>e("/data-deletion"),style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12,cursor:"pointer"},children:"資料刪除說明"}),r.jsx("span",{onClick:()=>e("/about"),style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12,cursor:"pointer"},children:"🧬 Restarter™｜我們是誰"}),r.jsx("span",{onClick:()=>e("/feedback"),style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12,cursor:"pointer"},children:"💬 意見箱｜我們想聽你說"})]})})]})}const bt={"zh-TW":{title:"互相幫助&合作實驗室",provide:"提供幫助",supply:"供應圈",need:"需要幫助",room:"互助房",intro:"在重啟的路上，我們都需要彼此的支持。請選擇你想要參與的方式：",introNeed:"如果你正在經歷困難，請告訴我們，社群夥伴會主動協助你。",needBtn:"我需要幫助",rule:"※ 所有資訊僅供社群內部交流使用，請尊重彼此隱私",msgTo:"留言給：",msgPlaceholder:"請輸入留言...",msgSent:"留言發送成功！",backToHome:"返回首頁",sections:{provide:{title:"我可提供幫助 & 合作室",desc:"分享你的專長、資源或想合作的領域，讓更多人找到你。",btn:"我要提供"},need:{title:"我需要幫助 or 合作屋",desc:"說出你目前遇到的困難或想找合作夥伴，讓社群支援你。",btn:"我需要幫助"},supply:{title:"幫助 & 合作供應圈",desc:"瀏覽大家能提供的幫助與合作資源，主動聯繫彼此。",btn:"探索供應圈"},room:{title:"進入互助房",desc:"即時交流，互助成長",btn:"進入互助房"}},modals:{provide:{title:"我可以提供幫助 & 合作",subtitle:"在重啟路上，我的經歷和優勢也許可以幫上忙！",experience:"我的經歷（可複選）：",current:"我的現狀(可複選)：",target:"我想優先幫助的對象（可複選）：",helpType:"我可以提供幫助形式：",statement:"我的特別聲明（50字內）：",frequency:"我可幫助的頻率：",cancel:"取消",submit:"送出",other:"其他...",enterPlaceholder:"請輸入...",messageTo:"留言給：",messagePlaceholder:"請輸入留言...",sendMessage:"送出留言",messageSent:"需求已成功送出！"},need:{title:"我需要幫助",subtitle:"請描述你遇到的困難或需要協助的地方，讓社群夥伴能更好幫助你！",experience:"我的經歷（可複選）：",current:"我的現狀(可複選)：",target:"我想優先幫助的對象（可複選）：",helpType:"我可以提供幫助形式：",statement:"我的特別聲明（50字內）：",frequency:"我可幫助的頻率：",cancel:"取消",submit:"送出",other:"其他...",enterPlaceholder:"請輸入...",messageTo:"留言給：",messagePlaceholder:"請輸入留言...",sendMessage:"送出留言",messageSent:"需求已成功送出！"}},options:{experience:["成功創業","家庭重建","就業輔導","法律協助","戒癮經驗","志工","社區服務","其他"],advantage:["經濟困難","無固定工作","缺乏家庭支持","健康問題","法律糾紛","心理壓力","缺乏居住地","人際關係困難","正在創業中","其他"],target:["找工作/就業協助","經濟急難救助","心理諮詢/陪伴","法律協助","醫療協助","住宿協助","家庭修復","戒癮支持","人際關係協助","生活重建","商業輔導","其他"],helpType:["線上","線下"],frequency:["每天","每週","每月","依需要者而定","其他"]},messages:{messageSent:"留言發送成功！",messageFailed:"留言發送失敗，請稍後再試",noMessages:"暫無留言",markRead:"標記已讀",delete:"刪除",confirmDelete:"你確定要刪除這條留言嗎？（一旦刪除將無法復原）",inboxTitle:"站內訊息",messageFrom:"給你的留言：",contactUser:"聯絡對方"},date:"日期",avatar:"頭像",name:"名稱",gender:"性別",age:"年齡",country:"國家"},"zh-CN":{sections:{provide:{title:"我可提供帮助 & 合作室",desc:"分享你的专长、资源或想合作的领域，让更多人找到你。",btn:"我要提供"},need:{title:"我需要帮助 or 合作屋",desc:"说出你目前遇到的困难或想找合作伙伴，让社群支援你。",btn:"我需要帮助"},supply:{title:"帮助 & 合作供应圈",desc:"浏览大家能提供的帮助与合作资源，主动联系彼此。",btn:"探索供应圈"},room:{title:"进入互助房",desc:"即时交流，互助成长",btn:"进入互助房"}},modals:{provide:{title:"我可以提供帮助 & 合作",subtitle:"在重启路上，我的经历和优势也许可以帮上忙！",experience:"我的经历（可复选）：",current:"我的现状(可复选)：",target:"我想优先帮助的对象（可复选）：",helpType:"我可以提供帮助形式：",statement:"我的特别声明（50字内）：",frequency:"我可帮助的频率：",cancel:"取消",submit:"送出",other:"其他...",enterPlaceholder:"请输入...",messageTo:"留言给：",messagePlaceholder:"请输入留言...",sendMessage:"送出留言",messageSent:"需求已成功送出！"},need:{title:"我需要帮助",subtitle:"请描述你遇到的困难或需要协助的地方，让社群伙伴能更好帮助你！",experience:"我的经历（可复选）：",current:"我的现状(可复选)：",target:"我遇到的困难/需求（可复选）：",helpType:"希望获得协助形式：",statement:"补充说明（50字内）：",frequency:"希望获得协助频率：",cancel:"取消",submit:"送出",other:"其他...",enterPlaceholder:"请输入...",messageTo:"留言给：",messagePlaceholder:"请输入留言...",sendMessage:"送出留言",messageSent:"需求已成功送出！"}},options:{experience:["成功创业","家庭重建","就业辅导","法律协助","戒瘾经验","志工","社区服务","其他"],advantage:["经济困难","无固定工作","缺乏家庭支持","健康问题","法律纠纷","心理压力","缺乏居住地","人际关系困难","正在创业中","其他"],target:["找工作/就业协助","经济急难救助","心理咨询/陪伴","法律协助","医疗协助","住宿协助","家庭修复","戒瘾支持","人际关系协助","生活重建","商业辅导","其他"],helpType:["线上","线下"],frequency:["每天","每周","每月","依需要者而定","其他"]},messages:{messageSent:"留言发送成功！",messageFailed:"留言发送失败，请稍后再试",noMessages:"暂无留言",markRead:"标记已读",delete:"删除",confirmDelete:"你确定要删除这条留言吗？（一旦删除将无法复原）",inboxTitle:"站内消息",messageFrom:"给你的留言：",contactUser:"联络对方"},date:"日期",avatar:"头像",name:"名称",gender:"性别",age:"年龄",country:"国家"},en:{sections:{provide:{title:"I can provide help & cooperation room",desc:"Share your expertise, resources or areas you want to collaborate on, so more people can find you.",btn:"I want to provide"},need:{title:"I need help or cooperation house",desc:"Tell us about the difficulties you're currently facing or partners you want to find, so the community can support you.",btn:"I need help"},supply:{title:"Help & cooperation supply circle",desc:"Browse the help and cooperation resources everyone can provide, actively contact each other.",btn:"Explore supply circle"},room:{title:"Enter mutual aid room",desc:"Real-time communication, mutual growth",btn:"Enter mutual aid room"}},modals:{provide:{title:"I can provide help & cooperation",subtitle:"On the restart journey, my experience and advantages might be helpful!",experience:"My experience (multiple choice):",current:"My current situation (multiple choice):",target:"People I want to help first (multiple choice):",helpType:"I can provide help in the form of:",statement:"My special statement (within 50 characters):",frequency:"My help frequency:",cancel:"Cancel",submit:"Submit",other:"Other...",enterPlaceholder:"Please enter...",messageTo:"Message to:",messagePlaceholder:"Please enter message...",sendMessage:"Send message",messageSent:"Request sent successfully!",backToHome:"Back to Home"},need:{title:"I need help",subtitle:"Please describe the difficulties you're facing or areas where you need assistance, so community partners can better help you!",experience:"My experience (multiple choice):",current:"My current situation (multiple choice):",target:"People I want to help first (multiple choice):",helpType:"I can provide help in the form of:",statement:"My special statement (within 50 characters):",frequency:"My help frequency:",cancel:"Cancel",submit:"Submit",other:"Other...",enterPlaceholder:"Please enter...",messageTo:"Message to:",messagePlaceholder:"Please enter message...",sendMessage:"Send message",messageSent:"Request sent successfully!",backToHome:"Back to Home"}},options:{experience:["Successful entrepreneurship","Family reconstruction","Employment guidance","Legal assistance","Addiction recovery experience","Volunteer","Community service","Other"],advantage:["Financial difficulties","No fixed job","Lack of family support","Health problems","Legal disputes","Psychological pressure","Lack of housing","Interpersonal difficulties","Currently starting a business","Other"],target:["Job search/employment assistance","Emergency financial assistance","Psychological counseling/companionship","Legal assistance","Medical assistance","Housing assistance","Family repair","Addiction support","Interpersonal assistance","Life reconstruction","Business guidance","Other"],helpType:["Online","Offline"],frequency:["Daily","Weekly","Monthly","As needed","Other"]},messages:{messageSent:"Message sent successfully!",messageFailed:"Message sending failed, please try again later",noMessages:"No messages yet",markRead:"Mark as read",delete:"Delete",confirmDelete:"Are you sure you want to delete this message? (Once deleted, it cannot be restored)",inboxTitle:"Inbox Messages",messageFrom:" sent you a message:",contactUser:"Contact User"},date:"Date",avatar:"Avatar",name:"Name",gender:"Gender",age:"Age",country:"Country"},ja:{sections:{provide:{title:"私は助けと協力の部屋を提供できます",desc:"あなたの専門知識、リソース、または協力したい分野を共有して、より多くの人にあなたを見つけてもらいましょう。",btn:"提供したい"},need:{title:"私は助けまたは協力の家が必要です",desc:"現在直面している困難や見つけたいパートナーについて教えてください。コミュニティがあなたをサポートできるようにします。",btn:"助けが必要です"},supply:{title:"助けと協力の供給サークル",desc:"みんなが提供できる助けと協力のリソースを閲覧し、積極的にお互いに連絡を取り合いましょう。",btn:"供給サークルを探索"},room:{title:"相互扶助の部屋に入る",desc:"リアルタイムコミュニケーション、相互成長",btn:"相互扶助の部屋に入る"}},modals:{provide:{title:"私は助けと協力を提供できます",subtitle:"再出発の道のりで、私の経験と強みがお役に立てるかもしれません！",experience:"私の経験（複数選択可）：",current:"私の現状（複数選択可）：",target:"私が優先的に助けたい人（複数選択可）：",helpType:"私が提供できる助けの形式：",statement:"私の特別な声明（50文字以内）：",frequency:"私が助けられる頻度：",cancel:"キャンセル",submit:"送信",other:"その他...",enterPlaceholder:"入力してください...",messageTo:"メッセージを送る：",messagePlaceholder:"メッセージを入力してください...",sendMessage:"メッセージを送信",messageSent:"リクエストが正常に送信されました！",backToHome:"ホームへ戻る"},need:{title:"助けが必要です",subtitle:"直面している困難や支援が必要な領域を説明してください。コミュニティのパートナーがより良くあなたを助けられるようにします！",experience:"私の経験（複数選択可）：",current:"私の現状（複数選択可）：",target:"私が優先的に助けたい人（複数選択可）：",helpType:"私が提供できる助けの形式：",statement:"私の特別な声明（50文字以内）：",frequency:"私が助けられる頻度：",cancel:"キャンセル",submit:"送信",other:"その他...",enterPlaceholder:"入力してください...",messageTo:"メッセージを送る：",messagePlaceholder:"メッセージを入力してください...",sendMessage:"メッセージを送信",messageSent:"リクエストが正常に送信されました！",backToHome:"ホームへ戻る"}},options:{experience:["成功した起業","家族の再構築","就職支援","法的支援","依存症回復経験","ボランティア","コミュニティサービス","その他"],advantage:["経済的困難","固定職なし","家族のサポート不足","健康問題","法的紛争","心理的プレッシャー","住居不足","人間関係の困難","現在起業中","その他"],target:["仕事探し/就職支援","緊急経済支援","心理カウンセリング/同伴","法的支援","医療支援","住居支援","家族修復","依存症支援","人間関係支援","生活再建","ビジネス指導","その他"],helpType:["オンライン","オフライン"],frequency:["毎日","毎週","毎月","必要に応じて","その他"]},messages:{messageSent:"メッセージが正常に送信されました！",messageFailed:"メッセージの送信に失敗しました。後でもう一度お試しください",noMessages:"まだメッセージがありません",markRead:"既読にする",delete:"削除",confirmDelete:"このメッセージを削除してもよろしいですか？（削除すると復元できません）",inboxTitle:"受信メッセージ",messageFrom:"からメッセージ：",contactUser:"ユーザーに連絡",backToHome:"ホームへ戻る"},date:"日付",avatar:"アイコン",name:"名前",gender:"性別",age:"年齢",country:"国"},ko:{sections:{provide:{title:"나는 도움과 협력 방을 제공할 수 있습니다",desc:"당신의 전문 지식, 자원 또는 협력하고 싶은 분야를 공유하여 더 많은 사람들이 당신을 찾을 수 있도록 하세요.",btn:"제공하고 싶습니다"},need:{title:"나는 도움이나 협력 집이 필요합니다",desc:"현재 직면한 어려움이나 찾고 싶은 파트너에 대해 말씀해 주세요. 커뮤니티가 당신을 지원할 수 있도록 합니다.",btn:"도움이 필요합니다"},supply:{title:"도움과 협력 공급 서클",desc:"모든 사람이 제공할 수 있는 도움과 협력 자원을 둘러보고, 적극적으로 서로 연락하세요.",btn:"공급 서클 탐색"},room:{title:"상호 원조 방에 들어가기",desc:"실시간 소통, 상호 성장",btn:"상호 원조 방에 들어가기"}},modals:{provide:{title:"나는 도움과 협력을 제공할 수 있습니다",subtitle:"재시작 여정에서 제 경험과 장점이 도움이 될 수 있습니다!",experience:"제 경험 (복수 선택 가능):",current:"제 현재 상황 (복수 선택 가능):",target:"제가 우선적으로 도우고 싶은 사람 (복수 선택 가능):",helpType:"제가 제공할 수 있는 도움의 형태:",statement:"제 특별한 선언 (50자 이내):",frequency:"제가 도울 수 있는 빈도:",cancel:"취소",submit:"제출",other:"기타...",enterPlaceholder:"입력하세요...",messageTo:"메시지 보내기:",messagePlaceholder:"메시지를 입력하세요...",sendMessage:"메시지 보내기",messageSent:"요청이 성공적으로 전송되었습니다!",backToHome:"홈으로 돌아가기"},need:{title:"도움이 필요합니다",subtitle:"당신이 직면한 어려움이나 도움이 필요한 분야를 설명해 주세요. 커뮤니티 파트너가 더 잘 당신을 도울 수 있도록 합니다!",experience:"제 경험 (복수 선택 가능):",current:"제 현재 상황 (복수 선택 가능):",target:"제가 우선적으로 도우고 싶은 사람 (복수 선택 가능):",helpType:"제가 제공할 수 있는 도움의 형태:",statement:"제 특별한 선언 (50자 이내):",frequency:"제가 도울 수 있는 빈도:",cancel:"취소",submit:"제출",other:"기타...",enterPlaceholder:"입력하세요...",messageTo:"메시지 보내기:",messagePlaceholder:"메시지를 입력하세요...",sendMessage:"메시지 보내기",messageSent:"요청이 성공적으로 전송되었습니다!",backToHome:"홈으로 돌아가기"}},options:{experience:["성공한 창업","가족 재건","취업 지도","법적 지원","중독 회복 경험","자원봉사","커뮤니티 서비스","기타"],advantage:["경제적 어려움","고정 직업 없음","가족 지원 부족","건강 문제","법적 분쟁","심리적 압박","주거지 부족","인간관계 어려움","현재 창업 중","기타"],target:["일자리 찾기/취업 지원","긴급 경제 지원","심리 상담/동반","법적 지원","의료 지원","주거 지원","가족 회복","중독 지원","인간관계 지원","생활 재건","비즈니스 지도","기타"],helpType:["온라인","오프라인"],frequency:["매일","매주","매월","필요에 따라","기타"]},messages:{messageSent:"메시지가 성공적으로 전송되었습니다!",messageFailed:"메시지 전송에 실패했습니다. 나중에 다시 시도해 주세요",noMessages:"아직 메시지가 없습니다",markRead:"읽음 표시",delete:"삭제",confirmDelete:"이 메시지를 삭제하시겠습니까? (삭제하면 복원할 수 없습니다)",inboxTitle:"받은 메시지",messageFrom:"님이 보낸 메시지:",contactUser:"사용자에게 연락",backToHome:"홈으로 돌아가기"},date:"날짜",avatar:"아바타",name:"이름",gender:"성별",age:"나이",country:"국가"},vi:{sections:{provide:{title:"Tôi có thể cung cấp phòng trợ giúp & hợp tác",desc:"Chia sẻ chuyên môn, tài nguyên hoặc lĩnh vực bạn muốn hợp tác, để nhiều người có thể tìm thấy bạn.",btn:"Tôi muốn cung cấp"},need:{title:"Tôi cần trợ giúp hoặc nhà hợp tác",desc:"Hãy nói về những khó khăn bạn đang gặp phải hoặc đối tác bạn muốn tìm, để cộng đồng có thể hỗ trợ bạn.",btn:"Tôi cần trợ giúp"},supply:{title:"Vòng tròn cung cấp trợ giúp & hợp tác",desc:"Duyệt qua các tài nguyên trợ giúp và hợp tác mà mọi người có thể cung cấp, chủ động liên lạc với nhau.",btn:"Khám phá vòng tròn cung cấp"},room:{title:"Vào phòng hỗ trợ lẫn nhau",desc:"Giao tiếp thời gian thực, cùng nhau phát triển",btn:"Vào phòng hỗ trợ lẫn nhau"}},modals:{provide:{title:"Tôi có thể cung cấp trợ giúp & hợp tác",subtitle:"Trên hành trình khởi động lại, kinh nghiệm và lợi thế của tôi có thể hữu ích!",experience:"Kinh nghiệm của tôi (chọn nhiều):",current:"Tình trạng hiện tại của tôi (chọn nhiều):",target:"Những người tôi muốn ưu tiên giúp đỡ (chọn nhiều):",helpType:"Tôi có thể cung cấp trợ giúp dưới hình thức:",statement:"Tuyên bố đặc biệt của tôi (trong vòng 50 ký tự):",frequency:"Tần suất tôi có thể giúp:",cancel:"Hủy",submit:"Gửi",other:"Khác...",enterPlaceholder:"Vui lòng nhập...",messageTo:"Nhắn tin cho:",messagePlaceholder:"Vui lòng nhập tin nhắn...",sendMessage:"Gửi tin nhắn",messageSent:"Yêu cầu đã được gửi thành công!",backToHome:"Về trang chủ"},need:{title:"Tôi cần trợ giúp",subtitle:"Vui lòng mô tả những khó khăn bạn đang gặp phải hoặc những lĩnh vực cần hỗ trợ, để các đối tác cộng đồng có thể giúp bạn tốt hơn!",experience:"Kinh nghiệm của tôi (chọn nhiều):",current:"Tình trạng hiện tại của tôi (chọn nhiều):",target:"Những người tôi muốn ưu tiên giúp đỡ (chọn nhiều):",helpType:"Tôi có thể cung cấp trợ giúp dưới hình thức:",statement:"Tuyên bố đặc biệt của tôi (trong vòng 50 ký tự):",frequency:"Tần suất tôi có thể giúp:",cancel:"Hủy",submit:"Gửi",other:"Khác...",enterPlaceholder:"Vui lòng nhập...",messageTo:"Nhắn tin cho:",messagePlaceholder:"Vui lòng nhập tin nhắn...",sendMessage:"Gửi tin nhắn",messageSent:"Yêu cầu đã được gửi thành công!",backToHome:"Về trang chủ"}},options:{experience:["Khởi nghiệp thành công","Tái thiết gia đình","Hướng dẫn việc làm","Hỗ trợ pháp lý","Kinh nghiệm cai nghiện","Tình nguyện viên","Dịch vụ cộng đồng","Khác"],advantage:["Khó khăn tài chính","Không có việc làm cố định","Thiếu hỗ trợ gia đình","Vấn đề sức khỏe","Tranh chấp pháp lý","Áp lực tâm lý","Thiếu nơi ở","Khó khăn trong mối quan hệ","Đang khởi nghiệp","Khác"],target:["Tìm việc/hỗ trợ việc làm","Hỗ trợ tài chính khẩn cấp","Tư vấn tâm lý/đồng hành","Hỗ trợ pháp lý","Hỗ trợ y tế","Hỗ trợ nhà ở","Sửa chữa gia đình","Hỗ trợ cai nghiện","Hỗ trợ mối quan hệ","Tái thiết cuộc sống","Hướng dẫn kinh doanh","Khác"],helpType:["Trực tuyến","Ngoại tuyến"],frequency:["Hàng ngày","Hàng tuần","Hàng tháng","Theo nhu cầu","Khác"]},messages:{messageSent:"Tin nhắn đã được gửi thành công!",messageFailed:"Gửi tin nhắn thất bại, vui lòng thử lại sau",noMessages:"Chưa có tin nhắn",markRead:"Đánh dấu đã đọc",delete:"Xóa",confirmDelete:"Bạn có chắc chắn muốn xóa tin nhắn này không? (Một khi xóa sẽ không thể khôi phục)",inboxTitle:"Tin nhắn đến",messageFrom:" đã gửi tin nhắn cho bạn:",contactUser:"Liên hệ người dùng",backToHome:"Về trang chủ"},date:"Ngày",avatar:"Ảnh đại diện",name:"Tên",gender:"Giới tính",age:"Tuổi",country:"Quốc gia"},th:{sections:{provide:{title:"ฉันสามารถให้ความช่วยเหลือและห้องความร่วมมือ",desc:"แบ่งปันความเชี่ยวชาญ ทรัพยากร หรือพื้นที่ที่คุณต้องการร่วมมือ เพื่อให้คนอื่นๆ หาคุณเจอ",btn:"ฉันต้องการให้"},need:{title:"ฉันต้องการความช่วยเหลือหรือบ้านความร่วมมือ",desc:"บอกเราเกี่ยวกับความยากลำบากที่คุณกำลังเผชิญหรือคู่ค้าที่คุณต้องการหา เพื่อให้ชุมชนสามารถสนับสนุนคุณได้",btn:"ฉันต้องการความช่วยเหลือ"},supply:{title:"วงกลมอุปทานความช่วยเหลือและความร่วมมือ",desc:"เรียกดูทรัพยากรความช่วยเหลือและความร่วมมือที่ทุกคนสามารถให้ได้ ติดต่อกันอย่างกระตือรือร้น",btn:"สำรวจวงกลมอุปทาน"},room:{title:"เข้าห้องช่วยเหลือซึ่งกันและกัน",desc:"การสื่อสารแบบเรียลไทม์ การเติบโตร่วมกัน",btn:"เข้าห้องช่วยเหลือซึ่งกันและกัน"}},modals:{provide:{title:"ฉันสามารถให้ความช่วยเหลือและความร่วมมือ",subtitle:"ในการเดินทางเริ่มต้นใหม่ ประสบการณ์และข้อได้เปรียบของฉันอาจเป็นประโยชน์!",experience:"ประสบการณ์ของฉัน (เลือกได้หลายข้อ):",current:"สถานการณ์ปัจจุบันของฉัน (เลือกได้หลายข้อ):",target:"คนที่ฉันต้องการช่วยเป็นอันดับแรก (เลือกได้หลายข้อ):",helpType:"ฉันสามารถให้ความช่วยเหลือในรูปแบบ:",statement:"คำแถลงพิเศษของฉัน (ไม่เกิน 50 ตัวอักษร):",frequency:"ความถี่ที่ฉันสามารถช่วยได้:",cancel:"ยกเลิก",submit:"ส่ง",other:"อื่นๆ...",enterPlaceholder:"กรุณาป้อน...",messageTo:"ส่งข้อความถึง:",messagePlaceholder:"กรุณาป้อนข้อความ...",sendMessage:"ส่งข้อความ",messageSent:"ส่งคำขอสำเร็จแล้ว!",backToHome:"กลับหน้าหลัก"},need:{title:"ฉันต้องการความช่วยเหลือ",subtitle:"กรุณาอธิบายความยากลำบากที่คุณกำลังเผชิญหรือพื้นที่ที่ต้องการความช่วยเหลือ เพื่อให้คู่ค้าชุมชนสามารถช่วยคุณได้ดีขึ้น!",experience:"ประสบการณ์ของฉัน (เลือกได้หลายข้อ):",current:"สถานการณ์ปัจจุบันของฉัน (เลือกได้หลายข้อ):",target:"คนที่ฉันต้องการช่วยเป็นอันดับแรก (เลือกได้หลายข้อ):",helpType:"ฉันสามารถให้ความช่วยเหลือในรูปแบบ:",statement:"คำแถลงพิเศษของฉัน (ไม่เกิน 50 ตัวอักษร):",frequency:"ความถี่ที่ฉันสามารถช่วยได้:",cancel:"ยกเลิก",submit:"ส่ง",other:"อื่นๆ...",enterPlaceholder:"กรุณาป้อน...",messageTo:"ส่งข้อความถึง:",messagePlaceholder:"กรุณาป้อนข้อความ...",sendMessage:"ส่งข้อความ",messageSent:"ส่งคำขอสำเร็จแล้ว!",backToHome:"กลับหน้าหลัก"}},options:{experience:["การเริ่มต้นธุรกิจที่ประสบความสำเร็จ","การสร้างครอบครัวใหม่","การแนะแนวการจ้างงาน","การช่วยเหลือทางกฎหมาย","ประสบการณ์การเลิกเสพติด","อาสาสมัคร","บริการชุมชน","อื่นๆ"],advantage:["ความยากลำบากทางการเงิน","ไม่มีงานประจำ","ขาดการสนับสนุนจากครอบครัว","ปัญหาสุขภาพ","ข้อพิพาททางกฎหมาย","ความกดดันทางจิตใจ","ขาดที่อยู่อาศัย","ความยากลำบากในความสัมพันธ์","กำลังเริ่มต้นธุรกิจ","อื่นๆ"],target:["การหางาน/ความช่วยเหลือการจ้างงาน","ความช่วยเหลือทางการเงินฉุกเฉิน","การให้คำปรึกษาทางจิตวิทยา/การเป็นเพื่อน","การช่วยเหลือทางกฎหมาย","ความช่วยเหลือทางการแพทย์","ความช่วยเหลือที่อยู่อาศัย","การซ่อมแซมครอบครัว","การสนับสนุนการเลิกเสพติด","ความช่วยเหลือความสัมพันธ์","การสร้างชีวิตใหม่","การแนะแนวธุรกิจ","อื่นๆ"],helpType:["ออนไลน์","ออฟไลน์"],frequency:["ทุกวัน","ทุกสัปดาห์","ทุกเดือน","ตามความต้องการ","อื่นๆ"]},messages:{messageSent:"ส่งข้อความสำเร็จแล้ว!",messageFailed:"การส่งข้อความล้มเหลว กรุณาลองใหม่อีกครั้ง",noMessages:"ยังไม่มีข้อความ",markRead:"ทำเครื่องหมายว่าอ่านแล้ว",delete:"ลบ",confirmDelete:"คุณแน่ใจหรือไม่ที่จะลบข้อความนี้? (เมื่อลบแล้วจะไม่สามารถกู้คืนได้)",inboxTitle:"受信メッセージ",messageFrom:"からメッセージ：",contactUser:"ユーザーに連絡",backToHome:"ホームへ戻る"},date:"วันที่",avatar:"รูปภาพ",name:"ชื่อ",gender:"เพศ",age:"อายุ",country:"ประเทศ"},ms:{sections:{provide:{title:"Saya boleh menyediakan bilik bantuan & kerjasama",desc:"Kongsi kepakaran, sumber atau bidang yang anda ingin bekerjasama, supaya lebih ramai orang dapat mencari anda.",btn:"Saya ingin menyediakan"},need:{title:"Saya memerlukan bantuan atau rumah kerjasama",desc:"Beritahu kami tentang kesukaran yang anda hadapi atau rakan kongsi yang anda ingin cari, supaya komuniti dapat menyokong anda.",btn:"Saya memerlukan bantuan"},supply:{title:"Bulatan bekalan bantuan & kerjasama",desc:"Semak imbas sumber bantuan dan kerjasama yang semua orang boleh sediakan, hubungi antara satu sama lain secara aktif.",btn:"Jelajah bulatan bekalan"},room:{title:"Masuk bilik bantuan bersama",desc:"Komunikasi masa nyata, pertumbuhan bersama",btn:"Masuk bilik bantuan bersama"}},modals:{provide:{title:"Saya boleh menyediakan bantuan & kerjasama",subtitle:"Dalam perjalanan memulakan semula, pengalaman dan kelebihan saya mungkin boleh membantu!",experience:"Pengalaman saya (pilihan berganda):",current:"Keadaan semasa saya (pilihan berganda):",target:"Orang yang saya ingin bantu terlebih dahulu (pilihan berganda):",helpType:"Saya boleh menyediakan bantuan dalam bentuk:",statement:"Pernyataan khas saya (dalam 50 aksara):",frequency:"Kekerapan saya boleh membantu:",cancel:"Batal",submit:"Hantar",other:"Lain-lain...",enterPlaceholder:"Sila masukkan...",messageTo:"Mesej kepada:",messagePlaceholder:"Sila masukkan mesej...",sendMessage:"Hantar mesej",messageSent:"Permintaan berjaya dihantar!",backToHome:"Kembali ke Laman Utama"},need:{title:"Saya memerlukan bantuan",subtitle:"Sila terangkan kesukaran yang anda hadapi atau bidang yang memerlukan bantuan, supaya rakan kongsi komuniti dapat membantu anda dengan lebih baik!",experience:"Pengalaman saya (pilihan berganda):",current:"Keadaan semasa saya (pilihan berganda):",target:"Orang yang saya ingin bantu terlebih dahulu (pilihan berganda):",helpType:"Saya boleh menyediakan bantuan dalam bentuk:",statement:"Pernyataan khas saya (dalam 50 aksara):",frequency:"Kekerapan saya boleh membantu:",cancel:"Batal",submit:"Hantar",other:"Lain-lain...",enterPlaceholder:"Sila masukkan...",messageTo:"Mesej kepada:",messagePlaceholder:"Sila masukkan mesej...",sendMessage:"Hantar mesej",messageSent:"Permintaan berjaya dihantar!",backToHome:"Kembali ke Laman Utama"}},options:{experience:["Keusahawanan berjaya","Pembinaan semula keluarga","Bimbingan pekerjaan","Bantuan undang-undang","Pengalaman pemulihan ketagihan","Sukarelawan","Perkhidmatan komuniti","Lain-lain"],advantage:["Kesukaran kewangan","Tiada pekerjaan tetap","Kekurangan sokongan keluarga","Masalah kesihatan","Pertikaian undang-undang","Tekanan psikologi","Kekurangan tempat tinggal","Kesukaran hubungan interpersonal","Sedang memulakan perniagaan","Lain-lain"],target:["Mencari kerja/bantuan pekerjaan","Bantuan kewangan kecemasan","Kaunseling psikologi/teman","Bantuan undang-undang","Bantuan perubatan","Bantuan tempat tinggal","Pembaikan keluarga","Sokongan ketagihan","Bantuan hubungan interpersonal","Pembinaan semula kehidupan","Bimbingan perniagaan","Lain-lain"],helpType:["Dalam talian","Luar talian"],frequency:["Setiap hari","Setiap minggu","Setiap bulan","Mengikut keperluan","Lain-lain"]},messages:{messageSent:"Mesej berjaya dihantar!",messageFailed:"Penghantaran mesej gagal, sila cuba lagi kemudian",noMessages:"Tiada mesej lagi",markRead:"Tandakan sebagai dibaca",delete:"Padam",confirmDelete:"Adakah anda pasti mahu memadamkan mesej ini? (Sebaik sahaja dipadamkan, ia tidak dapat dipulihkan)",inboxTitle:"受信メッセージ",messageFrom:"からメッセージ：",contactUser:"ユーザーに連絡",backToHome:"ホームへ戻る"},date:"Tarikh",avatar:"Avatar",name:"Nama",gender:"Jantina",age:"Umur",country:"Negara"},la:{sections:{provide:{title:"Possum praebere auxilium & cooperationis cubiculum",desc:"Partiri peritiam, opes vel regiones quas cooperari vis, ut plures te invenire possint.",btn:"Volo praebere"},need:{title:"Egeo auxilii vel cooperationis domus",desc:"Dic nobis de difficultatibus quas nunc patieris vel sociis quos quaeris, ut communitas te sustentare possit.",btn:"Egeo auxilii"},supply:{title:"Auxilii & cooperationis copiae circulus",desc:"Perlustra auxilii et cooperationis opes quas omnes praebere possunt, active inter se communicare.",btn:"Explora copiae circulum"},room:{title:"Intra mutuum auxilium cubiculum",desc:"Temporis realis communicatio, mutuus incrementum",btn:"Intra mutuum auxilium cubiculum"}},modals:{provide:{title:"Possum praebere auxilium & cooperationem",subtitle:"In itinere redintegrationis, mea experientia et commoda forsitan prodesse possunt!",experience:"Mea experientia (multiplex electio):",current:"Mea praesens condicio (multiplex electio):",target:"Homines quos primum adiuvare volo (multiplex electio):",helpType:"Possum praebere auxilium in forma:",statement:"Mea specialis declaratio (intra 50 characteres):",frequency:"Mea auxilii frequentia:",cancel:"Cancella",submit:"Submitte",other:"Alia...",enterPlaceholder:"Quaeso intra...",messageTo:"Nuntius ad:",messagePlaceholder:"Quaeso intra nuntium...",sendMessage:"Mitte nuntium",messageSent:"Petitio feliciter missa est!",backToHome:"Ad domum redire"},need:{title:"Egeo auxilii",subtitle:"Quaeso describe difficultates quas patieris vel regiones quae auxilio indigent, ut socii communitatis te melius adiuvare possint!",experience:"Mea experientia (multiplex electio):",current:"Mea praesens condicio (multiplex electio):",target:"Homines quos primum adiuvare volo (multiplex electio):",helpType:"Possum praebere auxilium in forma:",statement:"Mea specialis declaratio (intra 50 characteres):",frequency:"Mea auxilii frequentia:",cancel:"Cancella",submit:"Submitte",other:"Alia...",enterPlaceholder:"Quaeso intra...",messageTo:"Nuntius ad:",messagePlaceholder:"Quaeso intra nuntium...",sendMessage:"Mitte nuntium",messageSent:"Petitio feliciter missa est!",backToHome:"Ad domum redire"}},options:{experience:["Felix initium negotii","Familiae reconstructio","Orientatio laboris","Auxilium legale","Experientia liberationis ab addictione","Voluntarius","Servitium communitatis","Alia"],advantage:["Difficultates oeconomicae","Nullus labor fixus","Defectus sustentationis familiae","Problema sanitatis","Controversia legalis","Pressura psychologica","Defectus habitationis","Difficultates relationum","Nunc initium negotii faciens","Alia"],target:["Quaerere laborem/auxilium laboris","Auxilium oeconomicum urgentis","Consilium psychologicum/societas","Auxilium legale","Auxilium medicum","Auxilium habitationis","Reparatio familiae","Sustentatio liberationis","Auxilium relationum","Reconstructio vitae","Orientatio negotii","Alia"],helpType:["Online","Offline"],frequency:["Quotidie","Quot hebdomadis","Quot mensibus","Secundum necessitatem","Alia"]},messages:{messageSent:"Nuntius feliciter missus est!",messageFailed:"Missio nuntii defecit, quaeso postea denuo tenta",noMessages:"Nondum nuntii",markRead:"Nota ut lectum",delete:"Dele",confirmDelete:"Esne certus hunc nuntium delere velle? (Semel deletus, restitui non potest)",inboxTitle:"Inbox Messages",messageFrom:" sent you a message:",contactUser:"Contact User",backToHome:"Back to Home"},date:"Dies",avatar:"Imago",name:"Nomen",gender:"Genus",age:"Aetas",country:"Patria"}},j5=n=>{const e=bt[n]||bt["zh-TW"];return[{emoji:"🤝",title:e.sections.provide.title,desc:e.sections.provide.desc,btn:e.sections.provide.btn,color:"#e0f7fa"},{emoji:"🆘",title:e.sections.need.title,desc:e.sections.need.desc,btn:e.sections.need.btn,color:"#fff3e0"},{emoji:"🌐",title:e.sections.supply.title,desc:e.sections.supply.desc,btn:e.sections.supply.btn,color:"#e8f5e9"},{emoji:"🏠",title:e.sections.room.title,desc:e.sections.room.desc,btn:e.sections.room.btn,color:"#f3e5f5"}]},uk=n=>{const e={"zh-TW":{experience:["成功創業","家庭重建","就業輔導","法律協助","戒癮經驗","志工","社區服務","其他"],advantage:["經濟困難","無固定工作","缺乏家庭支持","健康問題","法律糾紛","心理壓力","缺乏居住地","人際關係困難","正在創業中","其他"],target:["找工作/就業協助","經濟急難救助","心理諮詢/陪伴","法律協助","醫療協助","住宿協助","家庭修復","戒癮支持","人際關係協助","生活重建","商業輔導","其他"],helpType:["線上","線下"],frequency:["每天","每週","每月","依需要者而定","其他"]},"zh-CN":{experience:["成功创业","家庭重建","就业辅导","法律协助","戒瘾经验","志工","社区服务","其他"],advantage:["经济困难","无固定工作","缺乏家庭支持","健康问题","法律纠纷","心理压力","缺乏居住地","人际关系困难","正在创业中","其他"],target:["找工作/就业协助","经济急难救助","心理咨询/陪伴","法律协助","医疗协助","住宿协助","家庭修复","戒瘾支持","人际关系协助","生活重建","商业辅导","其他"],helpType:["线上","线下"],frequency:["每天","每周","每月","依需要者而定","其他"]},en:{experience:["Successful entrepreneurship","Family reconstruction","Employment guidance","Legal assistance","Addiction recovery experience","Volunteer","Community service","Other"],advantage:["Financial difficulties","No fixed job","Lack of family support","Health problems","Legal disputes","Psychological pressure","Lack of housing","Interpersonal difficulties","Currently starting a business","Other"],target:["Job search/employment assistance","Emergency financial assistance","Psychological counseling/companionship","Legal assistance","Medical assistance","Housing assistance","Family repair","Addiction support","Interpersonal assistance","Life reconstruction","Business guidance","Other"],helpType:["Online","Offline"],frequency:["Daily","Weekly","Monthly","As needed","Other"]},ja:{experience:["成功した起業","家族の再構築","就職支援","法的支援","依存症回復経験","ボランティア","コミュニティサービス","その他"],advantage:["経済的困難","固定職なし","家族のサポート不足","健康問題","法的紛争","心理的プレッシャー","住居不足","人間関係の困難","現在起業中","その他"],target:["仕事探し/就職支援","緊急経済支援","心理カウンセリング/同伴","法的支援","医療支援","住居支援","家族修復","依存症支援","人間関係支援","生活再建","ビジネス指導","その他"],helpType:["オンライン","オフライン"],frequency:["毎日","毎週","毎月","必要に応じて","その他"]},ko:{experience:["성공한 창업","가족 재건","취업 지도","법적 지원","중독 회복 경험","자원봉사","커뮤니티 서비스","기타"],advantage:["경제적 어려움","고정 직업 없음","가족 지원 부족","건강 문제","법적 분쟁","심리적 압박","주거지 부족","인간관계 어려움","현재 창업 중","기타"],target:["일자리 찾기/취업 지원","긴급 경제 지원","심리 상담/동반","법적 지원","의료 지원","주거 지원","가족 회복","중독 지원","인간관계 지원","생활 재건","비즈니스 지도","기타"],helpType:["온라인","오프라인"],frequency:["매일","매주","매월","필요에 따라","기타"]},vi:{experience:["Khởi nghiệp thành công","Tái thiết gia đình","Hướng dẫn việc làm","Hỗ trợ pháp lý","Kinh nghiệm cai nghiện","Tình nguyện viên","Dịch vụ cộng đồng","Khác"],advantage:["Khó khăn tài chính","Không có việc làm cố định","Thiếu hỗ trợ gia đình","Vấn đề sức khỏe","Tranh chấp pháp lý","Áp lực tâm lý","Thiếu nơi ở","Khó khăn trong mối quan hệ","Đang khởi nghiệp","Khác"],target:["Tìm việc/hỗ trợ việc làm","Hỗ trợ tài chính khẩn cấp","Tư vấn tâm lý/đồng hành","Hỗ trợ pháp lý","Hỗ trợ y tế","Hỗ trợ nhà ở","Sửa chữa gia đình","Hỗ trợ cai nghiện","Hỗ trợ mối quan hệ","Tái thiết cuộc sống","Hướng dẫn kinh doanh","Khác"],helpType:["Trực tuyến","Ngoại tuyến"],frequency:["Hàng ngày","Hàng tuần","Hàng tháng","Theo nhu cầu","Khác"]},th:{experience:["การเริ่มต้นธุรกิจที่ประสบความสำเร็จ","การสร้างครอบครัวใหม่","การแนะแนวการจ้างงาน","การช่วยเหลือทางกฎหมาย","ประสบการณ์การเลิกเสพติด","อาสาสมัคร","บริการชุมชน","อื่นๆ"],advantage:["ความยากลำบากทางการเงิน","ไม่มีงานประจำ","ขาดการสนับสนุนจากครอบครัว","ปัญหาสุขภาพ","ข้อพิพาททางกฎหมาย","ความกดดันทางจิตใจ","ขาดที่อยู่อาศัย","ความยากลำบากในความสัมพันธ์","กำลังเริ่มต้นธุรกิจ","อื่นๆ"],target:["การหางาน/ความช่วยเหลือการจ้างงาน","ความช่วยเหลือทางการเงินฉุกเฉิน","การให้คำปรึกษาทางจิตวิทยา/การเป็นเพื่อน","การช่วยเหลือทางกฎหมาย","ความช่วยเหลือทางการแพทย์","ความช่วยเหลือที่อยู่อาศัย","การซ่อมแซมครอบครัว","การสนับสนุนการเลิกเสพติด","ความช่วยเหลือความสัมพันธ์","การสร้างชีวิตใหม่","การแนะแนวธุรกิจ","อื่นๆ"],helpType:["ออนไลน์","ออฟไลน์"],frequency:["ทุกวัน","ทุกสัปดาห์","ทุกเดือน","ตามความต้องการ","อื่นๆ"]},ms:{experience:["Keusahawanan berjaya","Pembinaan semula keluarga","Bimbingan pekerjaan","Bantuan undang-undang","Pengalaman pemulihan ketagihan","Sukarelawan","Perkhidmatan komuniti","Lain-lain"],advantage:["Kesukaran kewangan","Tiada pekerjaan tetap","Kekurangan sokongan keluarga","Masalah kesihatan","Pertikaian undang-undang","Tekanan psikologi","Kekurangan tempat tinggal","Kesukaran hubungan interpersonal","Sedang memulakan perniagaan","Lain-lain"],target:["Mencari kerja/bantuan pekerjaan","Bantuan kewangan kecemasan","Kaunseling psikologi/teman","Bantuan undang-undang","Bantuan perubatan","Bantuan tempat tinggal","Pembaikan keluarga","Sokongan ketagihan","Bantuan hubungan interpersonal","Pembinaan semula kehidupan","Bimbingan perniagaan","Lain-lain"],helpType:["Dalam talian","Luar talian"],frequency:["Setiap hari","Setiap minggu","Setiap bulan","Mengikut keperluan","Lain-lain"]},la:{experience:["Felix initium negotii","Familiae reconstructio","Orientatio laboris","Auxilium legale","Experientia liberationis ab addictione","Voluntarius","Servitium communitatis","Alia"],advantage:["Difficultates oeconomicae","Nullus labor fixus","Defectus sustentationis familiae","Problema sanitatis","Controversia legalis","Pressura psychologica","Defectus habitationis","Difficultates relationum","Nunc initium negotii faciens","Alia"],target:["Quaerere laborem/auxilium laboris","Auxilium oeconomicum urgentis","Consilium psychologicum/societas","Auxilium legale","Auxilium medicum","Auxilium habitationis","Reparatio familiae","Sustentatio liberationis","Auxilium relationum","Reconstructio vitae","Orientatio negotii","Alia"],helpType:["Online","Offline"],frequency:["Quotidie","Quot hebdomadis","Quot mensibus","Secundum necessitatem","Alia"]}};return e[n]||e["zh-TW"]};function _5({open:n,onClose:e,userInfo:t,onSubmit:i}){var ge,oe,Ie,Re,te,W,Y,X,le,be,ve,Me,Ve,ie,$,We,_e,ye,J,pe,ce,me,xe,M,q,F,we,Ne,Fe,Ue,Ct,ae,Be,ct,et,ot,ne,G,U,N,V,he,fe,ze,Ce,Ee,Ye,Xe,dt,tn,In,zn,Nt,Rt,_i,Ii,Qa;const{lang:s}=Qe(),o=uk(s),[a,l]=g.useState([]),[c,u]=g.useState(""),[h,p]=g.useState([]),[f,b]=g.useState(""),[x,S]=g.useState([]),[w,I]=g.useState(""),[j,A]=g.useState(o.helpType[0]),[D,O]=g.useState(""),[P,B]=g.useState(o.frequency[0]),[k,T]=g.useState(""),[R,E]=g.useState(!1),[_,v]=g.useState(!1),[z,H]=g.useState("");if(!n)return null;const L=(He,Dn,yo)=>{Dn(He.includes(yo)?He.filter(hd=>hd!==yo):[...He,yo])},ee=async He=>{He.preventDefault();try{console.log("ProvideModal 開始提交數據"),await i({exp:a,expOther:c,adv:h,advOther:f,target:x,targetOther:w,helpType:j,statement:D,freq:P,freqOther:k}),console.log("ProvideModal 數據提交成功")}catch(Dn){console.error("ProvideModal 數據提交失敗:",Dn)}};return r.jsx("div",{style:{position:"fixed",zIndex:9999,left:0,top:0,width:"100vw",height:"100vh",background:"rgba(40,40,80,0.18)",display:"flex",alignItems:"center",justifyContent:"center",padding:"16px"},children:r.jsxs("form",{onSubmit:ee,style:{background:"#fff",borderRadius:24,boxShadow:"0 8px 40px #6B5BFF33",padding:24,minWidth:360,width:"100%",maxWidth:"500px",position:"relative",display:"flex",flexDirection:"column",gap:18,maxHeight:"calc(100vh - 32px)"},children:[r.jsx("button",{type:"button",onClick:e,style:{position:"absolute",top:18,right:18,background:"none",border:"none",fontSize:26,color:"#888",cursor:"pointer",fontWeight:700,zIndex:1},children:"×"}),r.jsxs("div",{style:{overflow:"auto",flex:1,paddingRight:"8px",paddingBottom:"8px",maxHeight:"calc(100vh - 120px)"},children:[r.jsx("div",{style:{fontWeight:900,fontSize:22,color:"#6B5BFF",textAlign:"center",marginBottom:2},children:((Ie=(oe=(ge=bt[s])==null?void 0:ge.modals)==null?void 0:oe.provide)==null?void 0:Ie.title)||"我可以提供幫助 & 合作"}),r.jsx("div",{style:{color:"#888",fontSize:15,textAlign:"center",marginBottom:8},children:((W=(te=(Re=bt[s])==null?void 0:Re.modals)==null?void 0:te.provide)==null?void 0:W.subtitle)||"在重啟路上，我的經歷和優勢也許可以幫上忙！"}),r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:14,marginBottom:6},children:[r.jsx("img",{src:t.avatarUrl,alt:"avatar",style:{width:54,height:54,borderRadius:"50%",border:"2px solid #e0e7ff",objectFit:"cover"}}),r.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:2},children:[r.jsx("span",{style:{color:"#1976d2",fontWeight:700,cursor:"pointer",textDecoration:"underline"},onClick:()=>E(!0),children:t.nickname}),r.jsx("span",{style:{color:"#1976d2",fontWeight:500,cursor:"pointer",textDecoration:"underline"},onClick:()=>window.open(`mailto:${t.email}`),children:t.email}),r.jsxs("span",{style:{color:"#555",fontSize:14},children:[t.country,"｜",t.gender,"｜",t.age]})]})]}),r.jsx("div",{style:{fontWeight:700,marginTop:8,fontSize:15},children:((le=(X=(Y=bt[s])==null?void 0:Y.modals)==null?void 0:X.provide)==null?void 0:le.experience)||"我的經歷（可複選）："}),r.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:8,fontSize:14},children:[o.experience.map(He=>r.jsxs("label",{style:{display:"flex",alignItems:"center",gap:4,fontWeight:500},children:[r.jsx("input",{type:"checkbox",checked:a.includes(He),onChange:()=>L(a,l,He)}),He]},He)),r.jsx("input",{placeholder:((Me=(ve=(be=bt[s])==null?void 0:be.modals)==null?void 0:ve.provide)==null?void 0:Me.other)||"其他...",value:c,onChange:He=>u(He.target.value),style:{border:"1px solid #e0e7ff",borderRadius:8,padding:"2px 8px",minWidth:60,fontSize:14}})]}),r.jsx("div",{style:{fontWeight:700,marginTop:8,fontSize:15},children:(($=(ie=(Ve=bt[s])==null?void 0:Ve.modals)==null?void 0:ie.provide)==null?void 0:$.current)||"我的現狀(可複選)："}),r.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:8,fontSize:14},children:[o.advantage.map(He=>r.jsxs("label",{style:{display:"flex",alignItems:"center",gap:4,fontWeight:500},children:[r.jsx("input",{type:"checkbox",checked:h.includes(He),onChange:()=>L(h,p,He)}),He]},He)),r.jsx("input",{placeholder:((ye=(_e=(We=bt[s])==null?void 0:We.modals)==null?void 0:_e.provide)==null?void 0:ye.other)||"其他...",value:f,onChange:He=>b(He.target.value),style:{border:"1px solid #e0e7ff",borderRadius:8,padding:"2px 8px",minWidth:60,fontSize:14}})]}),r.jsx("div",{style:{fontWeight:700,marginTop:8,fontSize:15},children:((ce=(pe=(J=bt[s])==null?void 0:J.modals)==null?void 0:pe.provide)==null?void 0:ce.target)||"我想優先幫助的對象（可複選）："}),r.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:8,fontSize:14},children:[o.target.map(He=>r.jsxs("label",{style:{display:"flex",alignItems:"center",gap:4,fontWeight:500},children:[r.jsx("input",{type:"checkbox",checked:x.includes(He),onChange:()=>L(x,S,He)}),He]},He)),r.jsx("input",{placeholder:((M=(xe=(me=bt[s])==null?void 0:me.modals)==null?void 0:xe.provide)==null?void 0:M.other)||"其他...",value:w,onChange:He=>I(He.target.value),style:{border:"1px solid #e0e7ff",borderRadius:8,padding:"2px 8px",minWidth:60,fontSize:14}})]}),r.jsx("div",{style:{fontWeight:700,marginTop:8,fontSize:15},children:((we=(F=(q=bt[s])==null?void 0:q.modals)==null?void 0:F.provide)==null?void 0:we.helpType)||"我可以提供幫助形式："}),r.jsx("div",{style:{display:"flex",gap:16,fontSize:14},children:o.helpType.map(He=>r.jsxs("label",{style:{display:"flex",alignItems:"center",gap:4,fontWeight:500},children:[r.jsx("input",{type:"radio",name:"helptype",checked:j===He,onChange:()=>A(He)}),He]},He))}),r.jsx("div",{style:{fontWeight:700,marginTop:8,fontSize:15},children:((Ue=(Fe=(Ne=bt[s])==null?void 0:Ne.modals)==null?void 0:Fe.provide)==null?void 0:Ue.statement)||"我的特別聲明（50字內）："}),r.jsx("input",{maxLength:50,value:D,onChange:He=>O(He.target.value),placeholder:((Be=(ae=(Ct=bt[s])==null?void 0:Ct.modals)==null?void 0:ae.provide)==null?void 0:Be.enterPlaceholder)||"請輸入...",style:{border:"1px solid #e0e7ff",borderRadius:8,padding:"4px 10px",fontSize:14}}),r.jsxs("div",{style:{color:"#888",fontSize:13,textAlign:"right",marginTop:-8},children:[D.length,"/50"]}),r.jsx("div",{style:{fontWeight:700,marginTop:8,fontSize:15},children:((ot=(et=(ct=bt[s])==null?void 0:ct.modals)==null?void 0:et.provide)==null?void 0:ot.frequency)||"我可幫助的頻率："}),r.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:16,fontSize:14},children:[o.frequency.map(He=>r.jsxs("label",{style:{display:"flex",alignItems:"center",gap:4,fontWeight:500,marginRight:12},children:[r.jsx("input",{type:"radio",name:"freq",checked:P===He,onChange:()=>B(He)}),He]},He)),r.jsx("input",{placeholder:((U=(G=(ne=bt[s])==null?void 0:ne.modals)==null?void 0:G.provide)==null?void 0:U.other)||"其他...",value:k,onChange:He=>T(He.target.value),style:{border:"1px solid #e0e7ff",borderRadius:8,padding:"2px 8px",minWidth:60,fontSize:14}})]}),r.jsxs("div",{style:{display:"flex",gap:18,marginTop:18,justifyContent:"center",padding:"8px 0",minHeight:"44px",background:"#fff",zIndex:10,borderTop:"1px solid #f0f0f0"},children:[r.jsx("button",{type:"button",onClick:e,style:{background:"#eee",color:"#555",border:"none",borderRadius:18,padding:"8px 28px",fontWeight:700,fontSize:16,cursor:"pointer",minHeight:"44px",touchAction:"manipulation",flex:1,maxWidth:"120px"},children:((he=(V=(N=bt[s])==null?void 0:N.modals)==null?void 0:V.provide)==null?void 0:he.cancel)||"取消"}),r.jsx("button",{type:"submit",style:{background:"linear-gradient(90deg, #6e8efb, #a777e3)",color:"#fff",border:"none",borderRadius:18,padding:"8px 28px",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:"0 2px 8px #a777e355",minHeight:"44px",touchAction:"manipulation",flex:1,maxWidth:"120px"},children:((Ce=(ze=(fe=bt[s])==null?void 0:fe.modals)==null?void 0:ze.provide)==null?void 0:Ce.submit)||"送出"})]})]}),R&&r.jsx("div",{style:{position:"fixed",left:0,top:0,width:"100vw",height:"100vh",background:"rgba(40,40,80,0.18)",zIndex:1e4,display:"flex",alignItems:"center",justifyContent:"center"},children:r.jsxs("div",{style:{background:"#fff",borderRadius:18,boxShadow:"0 4px 24px #6B5BFF33",padding:28,minWidth:280,maxWidth:340,width:"90vw",position:"relative",display:"flex",flexDirection:"column",gap:12},children:[r.jsx("button",{type:"button",onClick:()=>E(!1),style:{position:"absolute",top:10,right:12,background:"none",border:"none",fontSize:22,color:"#888",cursor:"pointer",fontWeight:700},children:"×"}),r.jsxs("div",{style:{fontWeight:800,fontSize:18,color:"#6B5BFF",textAlign:"center",marginBottom:2},children:[((Xe=(Ye=(Ee=bt[s])==null?void 0:Ee.modals)==null?void 0:Ye.provide)==null?void 0:Xe.messageTo)||"留言給：",t.nickname]}),r.jsx("textarea",{value:z,onChange:He=>H(He.target.value),rows:3,maxLength:100,placeholder:((In=(tn=(dt=bt[s])==null?void 0:dt.modals)==null?void 0:tn.provide)==null?void 0:In.messagePlaceholder)||"請輸入留言...",style:{border:"1px solid #e0e7ff",borderRadius:8,padding:"6px 10px",fontSize:15,resize:"none"}}),r.jsx("button",{onClick:async()=>{E(!1);try{await fetch("/api/send-message",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:z,toUid:t.uid,toEmail:t.email,toNickname:t.nickname,fromUid:window.currentUserUid||"",fromEmail:window.currentUserEmail||"",fromNickname:window.currentUserNickname||""})}),v(!0),setTimeout(()=>v(!1),1500)}catch{alert("留言發送失敗，請稍後再試")}},style:{background:"linear-gradient(90deg, #6e8efb, #a777e3)",color:"#fff",border:"none",borderRadius:14,padding:"6px 18px",fontWeight:700,fontSize:15,cursor:"pointer",alignSelf:"center"},children:((Rt=(Nt=(zn=bt[s])==null?void 0:zn.modals)==null?void 0:Nt.provide)==null?void 0:Rt.sendMessage)||"送出留言"})]})}),_&&r.jsx("div",{style:{position:"fixed",left:0,top:0,width:"100vw",height:"100vh",background:"rgba(40,40,80,0.08)",zIndex:10001,display:"flex",alignItems:"center",justifyContent:"center"},children:r.jsx("div",{style:{background:"#fff",borderRadius:14,boxShadow:"0 2px 12px #ffb74d55",padding:"18px 32px",fontWeight:700,color:"#ff4d4f",fontSize:18},children:((Qa=(Ii=(_i=bt[s])==null?void 0:_i.modals)==null?void 0:Ii.provide)==null?void 0:Qa.messageSent)||"需求已成功送出！"})})]})})}function I5({open:n,onClose:e,userInfo:t,onSubmit:i,showMsgSent:s}){const{lang:o}=Qe(),a=uk(o),[l,c]=g.useState([]),[u,h]=g.useState(""),[p,f]=g.useState([]),[b,x]=g.useState(""),[S,w]=g.useState([]),[I,j]=g.useState(""),[A,D]=g.useState(a.helpType[0]),[O,P]=g.useState(""),[B,k]=g.useState(a.frequency[0]),[T,R]=g.useState(""),[E,_]=g.useState(!1),[v,z]=g.useState(""),[H,L]=g.useState(!1);if(!n)return null;const ee=(oe,Ie,Re)=>{Ie(oe.includes(Re)?oe.filter(te=>te!==Re):[...oe,Re])},ge=async oe=>{oe.preventDefault();try{console.log("NeedHelpModal 開始提交數據"),await i({exp:l,expOther:u,adv:p,advOther:b,target:S,targetOther:I,helpType:A,statement:O,freq:B,freqOther:T}),console.log("NeedHelpModal 數據提交成功")}catch(Ie){console.error("NeedHelpModal 數據提交失敗:",Ie)}};return r.jsx("div",{style:{position:"fixed",zIndex:9999,left:0,top:0,width:"100vw",height:"100vh",background:"rgba(40,40,80,0.18)",display:"flex",alignItems:"center",justifyContent:"center",padding:"16px"},children:r.jsxs("form",{onSubmit:ge,style:{background:"#fff",borderRadius:24,boxShadow:"0 8px 40px #6B5BFF33",padding:24,minWidth:360,width:"100%",maxWidth:"500px",position:"relative",display:"flex",flexDirection:"column",gap:18,maxHeight:"calc(100vh - 32px)"},children:[r.jsx("button",{type:"button",onClick:e,style:{position:"absolute",top:18,right:18,background:"none",border:"none",fontSize:26,color:"#888",cursor:"pointer",fontWeight:700,zIndex:1},children:"×"}),r.jsxs("div",{style:{overflow:"auto",flex:1,paddingRight:"8px",paddingBottom:"8px",maxHeight:"calc(100vh - 120px)"},children:[r.jsx("div",{style:{fontWeight:900,fontSize:22,color:"#ff4d4f",textAlign:"center",marginBottom:2},children:"我需要幫助"}),r.jsx("div",{style:{color:"#888",fontSize:15,textAlign:"center",marginBottom:8},children:"請描述你遇到的困難或需要協助的地方，讓社群夥伴能更好幫助你！"}),r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:14,marginBottom:6},children:[r.jsx("img",{src:t.avatarUrl,alt:"avatar",style:{width:54,height:54,borderRadius:"50%",border:"2px solid #e0e7ff",objectFit:"cover"}}),r.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:2},children:[r.jsx("span",{style:{color:"#1976d2",fontWeight:700,cursor:"pointer",textDecoration:"underline"},onClick:()=>_(!0),children:t.nickname}),r.jsx("span",{style:{color:"#1976d2",fontWeight:500,cursor:"pointer",textDecoration:"underline"},onClick:()=>window.open(`mailto:${t.email}`),children:t.email}),r.jsxs("span",{style:{color:"#555",fontSize:14},children:[t.country,"｜",t.gender,"｜",t.age]})]})]}),r.jsx("div",{style:{fontWeight:700,marginTop:8,fontSize:15},children:"我的經歷（可複選）："}),r.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:8,fontSize:14},children:[a.experience.map(oe=>r.jsxs("label",{style:{display:"flex",alignItems:"center",gap:4,fontWeight:500},children:[r.jsx("input",{type:"checkbox",checked:l.includes(oe),onChange:()=>ee(l,c,oe)}),oe]},oe)),r.jsx("input",{placeholder:"其他...",value:u,onChange:oe=>h(oe.target.value),style:{border:"1px solid #e0e7ff",borderRadius:8,padding:"2px 8px",minWidth:60,fontSize:14}})]}),r.jsx("div",{style:{fontWeight:700,marginTop:8,fontSize:15},children:"我的現狀(可複選)："}),r.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:8,fontSize:14},children:[a.advantage.map(oe=>r.jsxs("label",{style:{display:"flex",alignItems:"center",gap:4,fontWeight:500},children:[r.jsx("input",{type:"checkbox",checked:p.includes(oe),onChange:()=>ee(p,f,oe)}),oe]},oe)),r.jsx("input",{placeholder:"其他...",value:b,onChange:oe=>x(oe.target.value),style:{border:"1px solid #e0e7ff",borderRadius:8,padding:"2px 8px",minWidth:60,fontSize:14}})]}),r.jsx("div",{style:{fontWeight:700,marginTop:8,fontSize:15},children:"我遇到的困難/需求（可複選）："}),r.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:8,fontSize:14},children:[a.target.map(oe=>r.jsxs("label",{style:{display:"flex",alignItems:"center",gap:4,fontWeight:500},children:[r.jsx("input",{type:"checkbox",checked:S.includes(oe),onChange:()=>ee(S,w,oe)}),oe]},oe)),r.jsx("input",{placeholder:"其他...",value:I,onChange:oe=>j(oe.target.value),style:{border:"1px solid #e0e7ff",borderRadius:8,padding:"2px 8px",minWidth:60,fontSize:14}})]}),r.jsx("div",{style:{fontWeight:700,marginTop:8,fontSize:15},children:"希望獲得協助形式："}),r.jsx("div",{style:{display:"flex",gap:16,fontSize:14},children:a.helpType.map(oe=>r.jsxs("label",{style:{display:"flex",alignItems:"center",gap:4,fontWeight:500},children:[r.jsx("input",{type:"radio",name:"helptype",checked:A===oe,onChange:()=>D(oe)}),oe]},oe))}),r.jsx("div",{style:{fontWeight:700,marginTop:8,fontSize:15},children:"補充說明（50字內）："}),r.jsx("input",{maxLength:50,value:O,onChange:oe=>P(oe.target.value),placeholder:"請輸入...",style:{border:"1px solid #e0e7ff",borderRadius:8,padding:"4px 10px",fontSize:14}}),r.jsxs("div",{style:{color:"#888",fontSize:13,textAlign:"right",marginTop:-8},children:[O.length,"/50"]}),r.jsx("div",{style:{fontWeight:700,marginTop:8,fontSize:15},children:"希望獲得協助頻率："}),r.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:16,fontSize:14},children:[a.frequency.map(oe=>r.jsxs("label",{style:{display:"flex",alignItems:"center",gap:4,fontWeight:500,marginRight:12},children:[r.jsx("input",{type:"radio",name:"freq",checked:B===oe,onChange:()=>k(oe)}),oe]},oe)),r.jsx("input",{placeholder:"其他...",value:T,onChange:oe=>R(oe.target.value),style:{border:"1px solid #e0e7ff",borderRadius:8,padding:"2px 8px",minWidth:60,fontSize:14}})]}),r.jsxs("div",{style:{display:"flex",gap:18,marginTop:18,justifyContent:"center",padding:"8px 0",minHeight:"44px",background:"#fff",zIndex:10,borderTop:"1px solid #f0f0f0"},children:[r.jsx("button",{type:"button",onClick:e,style:{background:"#eee",color:"#555",border:"none",borderRadius:18,padding:"8px 28px",fontWeight:700,fontSize:16,cursor:"pointer",minHeight:"44px",touchAction:"manipulation",flex:1,maxWidth:"120px"},children:"取消"}),r.jsx("button",{type:"submit",style:{background:"linear-gradient(90deg, #6e8efb, #a777e3)",color:"#fff",border:"none",borderRadius:18,padding:"8px 28px",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:"0 2px 8px #a777e355",minHeight:"44px",touchAction:"manipulation",flex:1,maxWidth:"120px"},children:"送出"})]})]}),E&&r.jsx("div",{style:{position:"fixed",left:0,top:0,width:"100vw",height:"100vh",background:"rgba(40,40,80,0.18)",zIndex:1e4,display:"flex",alignItems:"center",justifyContent:"center"},children:r.jsxs("div",{style:{background:"#fff",borderRadius:18,boxShadow:"0 4px 24px #6B5BFF33",padding:28,minWidth:280,maxWidth:340,width:"90vw",position:"relative",display:"flex",flexDirection:"column",gap:12},children:[r.jsx("button",{type:"button",onClick:()=>_(!1),style:{position:"absolute",top:10,right:12,background:"none",border:"none",fontSize:22,color:"#888",cursor:"pointer",fontWeight:700},children:"×"}),r.jsxs("div",{style:{fontWeight:800,fontSize:18,color:"#6B5BFF",textAlign:"center",marginBottom:2},children:["留言給：",t.nickname]}),r.jsx("textarea",{value:v,onChange:oe=>z(oe.target.value),rows:3,maxLength:100,placeholder:"請輸入留言...",style:{border:"1px solid #e0e7ff",borderRadius:8,padding:"6px 10px",fontSize:15,resize:"none"}}),r.jsx("button",{onClick:async()=>{_(!1);try{await fetch("/api/send-message",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:v,toUid:t.uid,toEmail:t.email,toNickname:t.nickname,fromUid:window.currentUserUid||"",fromEmail:window.currentUserEmail||"",fromNickname:window.currentUserNickname||""})}),L(!0),setTimeout(()=>L(!1),1500)}catch{alert("留言發送失敗，請稍後再試")}},style:{background:"linear-gradient(90deg, #6e8efb, #a777e3)",color:"#fff",border:"none",borderRadius:14,padding:"6px 18px",fontWeight:700,fontSize:15,cursor:"pointer",alignSelf:"center"},children:"送出留言"})]})}),H&&r.jsx("div",{style:{position:"fixed",left:0,top:0,width:"100vw",height:"100vh",background:"rgba(40,40,80,0.08)",zIndex:10001,display:"flex",alignItems:"center",justifyContent:"center"},children:r.jsx("div",{style:{background:"#fff",borderRadius:14,boxShadow:"0 2px 12px #ffb74d55",padding:"18px 32px",fontWeight:700,color:"#ff4d4f",fontSize:18},children:"需求已成功送出！"})})]})})}function C5(){var $,We,_e,ye;const{lang:n}=Qe(),e=j5(n),t=J=>{var ce;const pe={"zh-TW":{title:"互相幫助&合作實驗室",provide:"提供幫助",supply:"供應圈",need:"需要幫助",room:"互助房",intro:"在重啟的路上，我們都需要彼此的支持。請選擇你想要參與的方式：",introNeed:"如果你正在經歷困難，請告訴我們，社群夥伴會主動協助你。",needBtn:"我需要幫助",rule:"※ 所有資訊僅供社群內部交流使用，請尊重彼此隱私",msgTo:"留言給：",msgPlaceholder:"請輸入留言...",msgSent:"留言發送成功！",backToHome:"返回首頁",back:"返回",date:"日期",avatar:"頭像",name:"名稱",gender:"性別",age:"年齡",country:"國家"},"zh-CN":{title:"互相帮助&合作实验室",provide:"提供帮助",supply:"供应圈",need:"需要帮助",room:"互助房",intro:"在重启的路上，我们都需要彼此的支持。请选择你想要参与的方式：",introNeed:"如果你正在经历困难，请告诉我们，社群伙伴会主动协助你。",needBtn:"我需要帮助",rule:"※ 所有信息仅供社群内部交流使用，请尊重彼此隐私",msgTo:"留言给：",msgPlaceholder:"请输入留言...",msgSent:"留言发送成功！",backToHome:"返回首页",back:"返回",date:"日期",avatar:"头像",name:"名称",gender:"性别",age:"年龄",country:"国家"},en:{title:"Mutual Help & Cooperation Laboratory",provide:"Provide Help",supply:"Supply Circle",need:"Need Help",room:"Mutual Aid Room",intro:"On the restart journey, we all need each other's support. Please choose how you want to participate:",introNeed:"If you are experiencing difficulties, please tell us, and community partners will actively assist you.",needBtn:"I Need Help",rule:"※ All information is for internal community communication only, please respect each other's privacy",msgTo:"Message to:",msgPlaceholder:"Please enter message...",msgSent:"Message sent successfully!",backToHome:"Back to Home",back:"Back",date:"Date",avatar:"Avatar",name:"Name",gender:"Gender",age:"Age",country:"Country"},ja:{title:"相互支援&協力実験室",provide:"支援を提供",supply:"供給サークル",need:"支援が必要",room:"相互扶助の部屋",intro:"再出発の道のりで、私たちは皆お互いのサポートが必要です。参加したい方法を選択してください：",introNeed:"困難を経験している場合は、お知らせください。コミュニティのパートナーが積極的にサポートします。",needBtn:"支援が必要です",rule:"※ すべての情報はコミュニティ内の交流のみに使用され、お互いのプライバシーを尊重してください",msgTo:"メッセージを送る：",msgPlaceholder:"メッセージを入力してください...",msgSent:"メッセージが正常に送信されました！",backToHome:"ホームへ戻る",back:"戻る",date:"日付",avatar:"アバター",name:"名前",gender:"性別",age:"年齢",country:"国"},ko:{title:"상호 도움&협력 실험실",provide:"도움 제공",supply:"공급 서클",need:"도움 필요",room:"상호 원조 방",intro:"재시작 여정에서 우리 모두는 서로의 지원이 필요합니다. 참여하고 싶은 방법을 선택하세요:",introNeed:"어려움을 겪고 있다면 알려주세요. 커뮤니티 파트너가 적극적으로 도와드릴 것입니다.",needBtn:"도움이 필요합니다",rule:"※ 모든 정보는 커뮤니티 내부 교류용으로만 사용되며, 서로의 개인정보를 존중해 주세요",msgTo:"메시지 보내기:",msgPlaceholder:"메시지를 입력하세요...",msgSent:"메시지가 성공적으로 전송되었습니다!",backToHome:"홈으로 돌아가기",back:"돌아가기",date:"날짜",avatar:"아바타",name:"이름",gender:"성별",age:"나이",country:"국가"},vi:{title:"Phòng thí nghiệm trợ giúp",provide:"Cung cấp trợ giúp",supply:"Vòng tròn cung cấp",need:"Cần trợ giúp",room:"Phòng hỗ trợ lẫn nhau",intro:"Trên hành trình khởi động lại, tất cả chúng ta đều cần sự hỗ trợ của nhau. Vui lòng chọn cách bạn muốn tham gia:",introNeed:"Nếu bạn đang gặp khó khăn, hãy cho chúng tôi biết, các đối tác cộng đồng sẽ tích cực hỗ trợ bạn.",needBtn:"Tôi cần trợ giúp",rule:"※ Tất cả thông tin chỉ dành cho giao tiếp nội bộ cộng đồng, vui lòng tôn trọng quyền riêng tư của nhau",msgTo:"Nhắn tin cho:",msgPlaceholder:"Vui lòng nhập tin nhắn...",msgSent:"Tin nhắn đã được gửi thành công!",backToHome:"Về trang chủ",back:"Quay lại",date:"Ngày",avatar:"Ảnh đại diện",name:"Tên",gender:"Giới tính",age:"Tuổi",country:"Quốc gia"},th:{title:"ห้องทดลองช่วยเหลือ",provide:"ให้ความช่วยเหลือ",supply:"วงกลมอุปทาน",need:"ต้องการความช่วยเหลือ",room:"ห้องช่วยเหลือซึ่งกันและกัน",intro:"ในการเดินทางเริ่มต้นใหม่ เราทุกคนต้องการการสนับสนุนจากกันและกัน กรุณาเลือกวิธีที่คุณต้องการมีส่วนร่วม:",introNeed:"หากคุณกำลังประสบความยากลำบาก กรุณาบอกเรา คู่ค้าชุมชนจะช่วยเหลือคุณอย่างกระตือรือร้น",needBtn:"ฉันต้องการความช่วยเหลือ",rule:"※ ข้อมูลทั้งหมดใช้สำหรับการสื่อสารภายในชุมชนเท่านั้น กรุณาเคารพความเป็นส่วนตัวของกันและกัน",msgTo:"ส่งข้อความถึง:",msgPlaceholder:"กรุณาป้อนข้อความ...",msgSent:"ส่งข้อความสำเร็จแล้ว!",backToHome:"กลับหน้าหลัก",back:"กลับ",date:"วันที่",avatar:"รูปโปรไฟล์",name:"ชื่อ",gender:"เพศ",age:"อายุ",country:"ประเทศ"},ms:{title:"Makmal Bantuan & Kerjasama Bersama",provide:"Sediakan Bantuan",supply:"Bulatan Bekalan",need:"Memerlukan Bantuan",room:"Bilik Bantuan Bersama",intro:"Dalam perjalanan memulakan semula, kita semua memerlukan sokongan antara satu sama lain. Sila pilih cara anda ingin mengambil bahagian:",introNeed:"Jika anda menghadapi kesukaran, sila beritahu kami, rakan kongsi komuniti akan membantu anda secara aktif.",needBtn:"Saya Memerlukan Bantuan",rule:"※ Semua maklumat adalah untuk komunikasi dalaman komuniti sahaja, sila hormati privasi antara satu sama lain",msgTo:"Mesej kepada:",msgPlaceholder:"Sila masukkan mesej...",msgSent:"Mesej berjaya dihantar!",backToHome:"Kembali ke Laman Utama",back:"Kembali",date:"Tarikh",avatar:"Avatar",name:"Nama",gender:"Jantina",age:"Umur",country:"Negara"},la:{title:"Laboratorium Auxilii",provide:"Praebere Auxilium",supply:"Copiae Circulus",need:"Egere Auxilii",room:"Mutuum Auxilium Cubiculum",intro:"In itinere redintegrationis, omnes indigemus sustentatione mutua. Quaeso elige quomodo participare vis:",introNeed:"Si difficultates patieris, quaeso nobis dic, socii communitatis te active adiuvabunt.",needBtn:"Egeo Auxilii",rule:"※ Omnia notitia ad communicationem internam communitatis tantum sunt, quaeso honora privaciam inter se",msgTo:"Nuntius ad:",msgPlaceholder:"Quaeso intra nuntium...",msgSent:"Nuntius feliciter missus est!",backToHome:"Ad domum redire",back:"Redire",date:"Dies",avatar:"Imago",name:"Nomen",gender:"Sexus",age:"Aetas",country:"Patria"}};return((ce=pe[n])==null?void 0:ce[J])||pe["zh-TW"][J]||J},[i,s]=g.useState(!1),[o,a]=g.useState({avatarUrl:"/ctx-logo.png",nickname:"",email:"",country:"",gender:"",age:""}),[l,c]=g.useState("provide"),[u,h]=g.useState([]),[p,f]=g.useState(null),x=Je(Ti).currentUser,[S,w]=g.useState(""),[I,j]=g.useState(!1),[A,D]=g.useState(null),[O,P]=g.useState(""),[B,k]=g.useState(!1),[T,R]=g.useState(!1),[E,_]=g.useState([]),[v,z]=g.useState(""),[H,L]=g.useState(!1),[ee,ge]=g.useState(!1),[oe,Ie]=g.useState([]),[Re,te]=g.useState(!1),[W,Y]=g.useState({});g.useEffect(()=>{if(!x)return;(async()=>{try{const pe=await fi(Ot(ht,"profiles",x.uid)),ce=pe.exists()?pe.data():{};let me=!1;const xe={};if(ce.country||(xe.country="台灣",me=!0),ce.gender||(xe.gender="男",me=!0),ce.age||(xe.age="30",me=!0),me){const{setDoc:M}=await Ys(async()=>{const{setDoc:we}=await Promise.resolve().then(()=>uc);return{setDoc:we}},void 0);await M(Ot(ht,"profiles",x.uid),{...ce,...xe},{merge:!0});const q=await fi(Ot(ht,"profiles",x.uid)),F=q.exists()?q.data():{};a({avatarUrl:F.avatar||x.photoURL||"/ctx-logo.png",nickname:F.nickname||x.displayName||"Restarter",email:F.email||x.email||"",country:F.country||"",gender:F.gender||"",age:F.age||""});return}a({avatarUrl:ce.avatar||x.photoURL||"/ctx-logo.png",nickname:ce.nickname||x.displayName||"Restarter",email:ce.email||x.email||"",country:ce.country||"",gender:ce.gender||"",age:ce.age||""})}catch{a({avatarUrl:x.photoURL||"/ctx-logo.png",nickname:x.displayName||"Restarter",email:x.email||"",country:"",gender:"",age:""})}})()},[x]);async function X(J){try{if(console.log("開始保存提供幫助數據:",J),console.log("用戶信息:",o),console.log("當前用戶:",x),!x){console.error("用戶未登入"),w("❌ 請先登入後再送出"),setTimeout(()=>w(""),3e3);return}const pe=await $i(Wt(ht,"helpSupplies"),{...J,type:"provide",avatarUrl:o.avatarUrl,nickname:o.nickname,email:o.email,country:o.country,gender:o.gender,age:o.age,createdAt:xt.now(),uid:(x==null?void 0:x.uid)||""});console.log("數據保存成功，文檔ID:",pe.id),s(!1),w("🎉 已成功送出，感謝你的溫暖分享！"),setTimeout(()=>w(""),3e3),le()}catch(pe){console.error("保存提供幫助數據失敗:",pe),w("❌ 保存失敗，請稍後再試"),setTimeout(()=>w(""),3e3)}}async function le(){try{console.log("開始獲取供應圈列表");const J=un(Wt(ht,"helpSupplies"),Lt("type","==","provide")),me=(await kn(J)).docs.map(xe=>({id:xe.id,...xe.data()})).sort((xe,M)=>{var we,Ne,Fe,Ue;const q=((Ne=(we=xe.createdAt)==null?void 0:we.toDate)==null?void 0:Ne.call(we))||new Date(xe.createdAt);return(((Ue=(Fe=M.createdAt)==null?void 0:Fe.toDate)==null?void 0:Ue.call(Fe))||new Date(M.createdAt))-q});console.log("獲取到的供應圈數據:",me),h(me)}catch(J){console.error("獲取供應圈列表失敗:",J),w("❌ 獲取數據失敗，請稍後再試"),setTimeout(()=>w(""),3e3)}}g.useEffect(()=>{l==="supply"&&le()},[l]);async function be(J,pe){if(console.log("留言送出偵錯：",{user:x,fromUid:x==null?void 0:x.uid,toUid:J==null?void 0:J.uid,fromEmail:x==null?void 0:x.email,toEmail:J==null?void 0:J.email,content:pe}),!x){z("偵錯：user 為 null，請確認已登入");return}if(!x.uid){z("偵錯：user.uid 為空");return}if(!(J!=null&&J.uid)){z("偵錯：toUser.uid 為空");return}if(!pe.trim()){z("請輸入留言內容");return}L(!0),z("");try{await $i(Wt(ht,"messages"),{toUid:J.uid,toEmail:J.email,toNickname:J.nickname,fromUid:x.uid,fromEmail:x.email,fromNickname:o.nickname,content:pe,timestamp:xt.now(),read:!1}),k(!0),setTimeout(()=>{j(!1),k(!1),P("")},1500)}catch(ce){z("留言發送失敗，請稍後再試 (偵錯: "+((ce==null?void 0:ce.message)||ce)+")")}finally{L(!1)}}async function ve(){if(!x)return;const J=un(Wt(ht,"messages"),Lt("toUid","==",x.uid),Lt("read","==",!1)),pe=await kn(J);_(pe.docs.map(ce=>({id:ce.id,...ce.data()})))}g.useEffect(()=>{ve()},[x,T]);async function Me(J){await cc(Ot(ht,"messages",J),{read:!0}),ve()}async function Ve(J){try{if(console.log("開始保存需要幫助數據:",J),console.log("用戶信息:",o),console.log("當前用戶:",x),!x){console.error("用戶未登入"),w("❌ 請先登入後再送出"),setTimeout(()=>w(""),3e3);return}const pe=await $i(Wt(ht,"helpSupplies"),{...J,type:"need",avatarUrl:o.avatarUrl,nickname:o.nickname,email:o.email,country:o.country,gender:o.gender,age:o.age,createdAt:xt.now(),uid:(x==null?void 0:x.uid)||""});console.log("數據保存成功，文檔ID:",pe.id),te(!0),setTimeout(()=>{te(!1),ge(!1)},1800),w("🎉 你的需求已送出，社群夥伴會看到！"),setTimeout(()=>w(""),3e3),ie()}catch(pe){console.error("保存需要幫助數據失敗:",pe),w("❌ 保存失敗，請稍後再試"),setTimeout(()=>w(""),3e3)}}async function ie(){try{console.log("開始獲取需要幫助列表");const J=un(Wt(ht,"helpSupplies"),Lt("type","==","need")),me=(await kn(J)).docs.map(xe=>({id:xe.id,...xe.data()})).sort((xe,M)=>{var we,Ne,Fe,Ue;const q=((Ne=(we=xe.createdAt)==null?void 0:we.toDate)==null?void 0:Ne.call(we))||new Date(xe.createdAt);return(((Ue=(Fe=M.createdAt)==null?void 0:Fe.toDate)==null?void 0:Ue.call(Fe))||new Date(M.createdAt))-q});console.log("獲取到的需要幫助數據:",me),Ie(me)}catch(J){console.error("獲取需要幫助列表失敗:",J),w("❌ 獲取數據失敗，請稍後再試"),setTimeout(()=>w(""),3e3)}}return g.useEffect(()=>{l==="room"&&ie()},[l]),r.jsxs("div",{style:{minHeight:"100vh",background:"linear-gradient(135deg, #f8fafc 0%, #e0e7ff 100%)",padding:"0 0 48px 0",position:"relative"},children:[T&&r.jsxs(r.Fragment,{children:[r.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.3)",zIndex:1e4},onClick:()=>R(!1)}),r.jsxs("div",{style:{position:"fixed",top:70,right:36,background:"#fff",borderRadius:18,boxShadow:"0 4px 24px #6B5BFF33",padding:24,minWidth:320,zIndex:10001},children:[r.jsx("div",{style:{fontWeight:900,fontSize:20,color:"#6B5BFF",marginBottom:12},children:((We=($=bt[n])==null?void 0:$.messages)==null?void 0:We.inboxTitle)||"站內訊息"}),E.length===0&&r.jsx("div",{style:{color:"#888",fontSize:15},children:((ye=(_e=bt[n])==null?void 0:_e.messages)==null?void 0:ye.noMessages)||"目前沒有新訊息"}),E.map(J=>{var pe,ce,me,xe,M,q,F,we,Ne,Fe;return r.jsxs("div",{style:{background:"#f7f7ff",borderRadius:12,padding:12,marginBottom:12,boxShadow:"0 2px 8px #6B5BFF11",cursor:"pointer"},onClick:()=>{Y(Ue=>({...Ue,[J.id]:!Ue[J.id]}))},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[r.jsxs("div",{style:{fontWeight:700,color:"#1976d2"},children:[J.fromNickname," ",((ce=(pe=bt[n])==null?void 0:pe.messages)==null?void 0:ce.messageFrom)||"給你的留言："]}),r.jsx("span",{style:{fontSize:12,color:"#888"},children:W[J.id]?"收起":"展開"})]}),W[J.id]&&r.jsxs("div",{style:{background:"rgba(255,255,255,0.8)",borderRadius:8,padding:12,marginBottom:8,border:"1px solid #e0e7ff"},children:[r.jsx("div",{style:{color:"#232946",marginBottom:8,lineHeight:"1.5"},children:J.content}),r.jsx("div",{style:{color:"#888",fontSize:13,marginBottom:8},children:(q=(xe=(me=J.timestamp)==null?void 0:me.toDate)==null?void 0:(M=xe.call(me)).toLocaleString)==null?void 0:q.call(M)}),r.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:[r.jsx("span",{href:`mailto:${J.fromEmail}`,style:{color:"#6B5BFF",fontWeight:700,textDecoration:"underline",fontSize:13},children:((we=(F=bt[n])==null?void 0:F.messages)==null?void 0:we.contactUser)||"聯絡對方"}),r.jsx("button",{onClick:Ue=>{Ue.stopPropagation(),Me(J.id)},style:{background:"#eee",color:"#6B5BFF",border:"none",borderRadius:6,padding:"4px 12px",fontWeight:700,fontSize:13,cursor:"pointer"},children:((Fe=(Ne=bt[n])==null?void 0:Ne.messages)==null?void 0:Fe.markRead)||"標記已讀"})]})]}),!W[J.id]&&r.jsx("div",{style:{color:"#666",fontSize:14,fontStyle:"italic"},children:J.content.length>30?`${J.content.substring(0,30)}...`:J.content})]},J.id)})]})]}),S&&r.jsx("div",{style:{position:"fixed",top:40,left:"50%",transform:"translateX(-50%)",background:"#fff",color:"#6B5BFF",fontWeight:700,fontSize:18,borderRadius:16,boxShadow:"0 4px 24px #6B5BFF22",padding:"18px 36px",zIndex:99999,textAlign:"center",letterSpacing:1},children:S}),r.jsx("button",{onClick:()=>window.location.href="/",style:{position:"absolute",top:"20px",left:"20px",zIndex:1e3,fontWeight:700,fontSize:16,padding:"8px 16px",borderRadius:8,border:"1.5px solid #6B5BFF",background:"#fff",color:"#6B5BFF",cursor:"pointer",minWidth:80,boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:t("back")}),r.jsx("div",{style:{width:"100%",maxWidth:700,margin:"20px auto 20px auto",padding:"16px 24px",background:"rgba(255,255,255,0.95)",borderRadius:16,boxShadow:"0 4px 20px rgba(0,0,0,0.1)",display:"flex",alignItems:"center",justifyContent:"center",position:"relative"},children:r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,justifyContent:"center"},children:[r.jsxs("h1",{style:{fontWeight:900,fontSize:18,color:"#6B5BFF",margin:0,lineHeight:1,textShadow:"0 2px 8px #6B5BFF88",textAlign:"center"},children:[r.jsx("span",{role:"img","aria-label":"helplab",children:"🧪"})," ",t("title")]}),r.jsxs("button",{onClick:()=>R(J=>!J),style:{background:"none",border:"none",cursor:"pointer",position:"relative",padding:"8px",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",marginLeft:8},children:[r.jsx("span",{style:{fontSize:24,color:"#6B5BFF"},children:"🔔"}),E.length>0&&r.jsx("span",{style:{position:"absolute",top:0,right:0,minWidth:18,height:18,background:"#ff4d4f",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",border:"2px solid #fff",color:"#fff",fontWeight:900,fontSize:13,padding:"0 5px",boxShadow:"0 2px 8px #ff4d4f88",zIndex:1},children:E.length})]})]})}),r.jsxs("div",{style:{maxWidth:600,margin:"0 auto",padding:"20px 16px 0 16px",background:"#fff",borderRadius:32,boxShadow:"0 8px 40px #b6b6f633, 0 1.5px 8px #6B5BFF22",border:"1.5px solid #e0e7ff"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:24,marginBottom:24},children:[r.jsx("button",{onClick:()=>c("provide"),style:{fontWeight:900,fontSize:18,color:l==="provide"?"#6B5BFF":"#888",background:"#fff",border:l==="provide"?"3px solid #6B5BFF":"2px solid #e0e7ff",borderRadius:16,boxShadow:"0 2px 8px #b6b6f633",padding:"8px 24px",cursor:"pointer",marginBottom:2},children:t("provide")}),r.jsx("button",{onClick:()=>c("supply"),style:{fontWeight:900,fontSize:18,color:l==="supply"?"#6B5BFF":"#888",background:"#fff",border:l==="supply"?"3px solid #6B5BFF":"2px solid #e0e7ff",borderRadius:16,boxShadow:"0 2px 8px #b6b6f633",padding:"8px 24px",cursor:"pointer",marginBottom:2},children:t("supply")}),r.jsx("button",{onClick:()=>c("need"),style:{fontWeight:900,fontSize:18,color:l==="need"?"#ff4d4f":"#888",background:"#fff",border:l==="need"?"3px solid #ff4d4f":"2px solid #e0e7ff",borderRadius:16,boxShadow:"0 2px 8px #ffb74d55",padding:"8px 24px",cursor:"pointer",marginBottom:2},children:t("need")}),r.jsx("button",{onClick:()=>c("room"),style:{fontWeight:900,fontSize:18,color:l==="room"?"#ff4d4f":"#888",background:"#fff",border:l==="room"?"3px solid #ff4d4f":"2px solid #e0e7ff",borderRadius:16,boxShadow:"0 2px 8px #ffb74d55",padding:"8px 24px",cursor:"pointer",marginBottom:2},children:t("room")})]}),l==="provide"&&r.jsxs(r.Fragment,{children:[r.jsx("p",{style:{textAlign:"center",color:"#555",fontSize:18,marginBottom:36},children:t("intro")}),r.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:32,justifyContent:"center"},children:e.map((J,pe)=>r.jsxs("div",{style:{background:J.color,borderRadius:20,boxShadow:"0 4px 24px #0001",padding:"32px 28px",minWidth:260,maxWidth:320,flex:"1 1 260px",display:"flex",flexDirection:"column",alignItems:"center",marginBottom:12},children:[r.jsx("div",{style:{fontSize:48,marginBottom:12},children:J.emoji}),r.jsx("div",{style:{fontWeight:800,fontSize:22,marginBottom:8,color:"#333",letterSpacing:1},children:J.title}),r.jsx("div",{style:{color:"#666",fontSize:15,marginBottom:18,textAlign:"center",minHeight:44},children:J.desc}),pe===0?r.jsx("button",{onClick:()=>{c("provide"),s(!0)},style:{background:"linear-gradient(90deg, #6e8efb, #a777e3)",color:"#fff",border:"none",borderRadius:24,padding:"10px 28px",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:"0 2px 8px #a777e355",marginTop:"auto",transition:"background 0.2s"},children:J.btn}):pe===1?r.jsx("button",{onClick:()=>{c("need"),ge(!0)},style:{background:"linear-gradient(90deg, #ff4d4f, #ffb74d)",color:"#fff",border:"none",borderRadius:24,padding:"10px 28px",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:"0 2px 8px #ffb74d55",marginTop:"auto",transition:"background 0.2s"},children:J.btn}):pe===2?r.jsx("button",{onClick:()=>c("supply"),style:{background:"linear-gradient(90deg, #6e8efb, #a777e3)",color:"#fff",border:"none",borderRadius:24,padding:"10px 28px",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:"0 2px 8px #a777e355",marginTop:"auto",transition:"background 0.2s"},children:J.btn}):r.jsx("button",{onClick:()=>c("room"),style:{background:"linear-gradient(90deg, #ff4d4f, #ffb74d)",color:"#fff",border:"none",borderRadius:24,padding:"10px 28px",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:"0 2px 8px #ffb74d55",marginTop:"auto",transition:"background 0.2s"},children:J.btn})]},pe))}),r.jsx("div",{style:{textAlign:"center",color:"#888",fontSize:15,marginTop:40},children:t("rule")}),r.jsx(_5,{open:i,onClose:()=>s(!1),userInfo:o,onSubmit:X})]}),l==="supply"&&r.jsx("div",{style:{marginTop:24},children:r.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:15,tableLayout:"fixed"},children:[r.jsxs("colgroup",{children:[r.jsx("col",{style:{width:"28%"}}),r.jsx("col",{style:{width:"14%"}}),r.jsx("col",{style:{width:"22%"}}),r.jsx("col",{style:{width:"12%"}}),r.jsx("col",{style:{width:"12%"}}),r.jsx("col",{style:{width:"12%"}})]}),r.jsx("thead",{children:r.jsxs("tr",{style:{background:"#f3f3ff",color:"#6B5BFF"},children:[r.jsx("th",{style:{padding:"8px 4px",textAlign:"left"},children:t("date")}),r.jsx("th",{style:{textAlign:"center"},children:t("avatar")}),r.jsx("th",{style:{textAlign:"left"},children:t("name")}),r.jsx("th",{style:{textAlign:"center"},children:t("gender")}),r.jsx("th",{style:{textAlign:"center"},children:t("age")}),r.jsx("th",{style:{textAlign:"center"},children:t("country")})]})}),r.jsx("tbody",{children:u.map((J,pe)=>{var ce,me,xe,M;return r.jsxs(Kt.Fragment,{children:[r.jsxs("tr",{style:{cursor:"pointer",borderBottom:"1px solid #eee"},onClick:()=>f(p===pe?null:pe),children:[r.jsx("td",{children:((M=(xe=(me=(ce=J.createdAt)==null?void 0:ce.toDate)==null?void 0:me.call(ce))==null?void 0:xe.toLocaleString)==null?void 0:M.call(xe))||""}),r.jsx("td",{children:r.jsx("img",{src:J.avatarUrl||"/ctx-logo.png",alt:"avatar",style:{width:36,height:36,borderRadius:"50%"}})}),r.jsx("td",{style:{color:"#1976d2",fontWeight:700,textDecoration:"underline",cursor:"pointer"},onClick:()=>{D(J),j(!0)},children:J.nickname}),r.jsx("td",{children:J.gender}),r.jsx("td",{children:J.age}),r.jsx("td",{children:J.country})]}),p===pe&&r.jsx("tr",{children:r.jsxs("td",{colSpan:6,style:{background:"#f8f8ff",padding:18},children:[r.jsx("div",{style:{fontWeight:700,color:"#6B5BFF",marginBottom:8},children:"【你的困難也是我們的困難，讓我們一起面對並解決】"}),r.jsxs("div",{style:{marginBottom:8},children:[r.jsx("b",{children:"經歷："}),(J.exp||[]).join("、"),J.expOther?`、${J.expOther}`:""]}),r.jsxs("div",{style:{marginBottom:8},children:[r.jsx("b",{children:"優勢："}),(J.adv||[]).join("、"),J.advOther?`、${J.advOther}`:""]}),r.jsxs("div",{style:{marginBottom:8},children:[r.jsx("b",{children:"優先幫助對象："}),(J.target||[]).join("、"),J.targetOther?`、${J.targetOther}`:""]}),r.jsxs("div",{style:{marginBottom:8},children:[r.jsx("b",{children:"幫助形式："}),J.helpType]}),r.jsxs("div",{style:{marginBottom:8},children:[r.jsx("b",{children:"特別聲明："}),J.statement]}),r.jsxs("div",{style:{marginBottom:8},children:[r.jsx("b",{children:"幫助頻率："}),J.freq,J.freqOther?`、${J.freqOther}`:""]}),r.jsx("div",{style:{marginTop:12},children:r.jsx("span",{href:`mailto:${J.email}`,style:{color:"#6B5BFF",textDecoration:"underline",marginLeft:12},children:J.email})})]})})]},J.id)})})]})}),l==="need"&&r.jsxs(r.Fragment,{children:[r.jsx("p",{style:{textAlign:"center",color:"#555",fontSize:18,marginBottom:36},children:t("introNeed")}),r.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:32,justifyContent:"center"},children:r.jsx("button",{onClick:()=>ge(!0),style:{background:"linear-gradient(90deg, #ff4d4f, #ffb74d)",color:"#fff",border:"none",borderRadius:24,padding:"10px 28px",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:"0 2px 8px #ffb74d55",marginTop:"auto",transition:"background 0.2s"},children:t("needBtn")})}),r.jsx(I5,{open:ee,onClose:()=>ge(!1),userInfo:o,onSubmit:Ve,showMsgSent:Re})]}),l==="room"&&r.jsx("div",{style:{marginTop:24},children:r.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:15},children:[r.jsx("thead",{children:r.jsxs("tr",{style:{background:"#fff3e0",color:"#ff4d4f"},children:[r.jsx("th",{style:{padding:"8px 4px",textAlign:"left"},children:t("date")}),r.jsx("th",{style:{textAlign:"center"},children:t("avatar")}),r.jsx("th",{style:{textAlign:"left"},children:t("name")}),r.jsx("th",{style:{textAlign:"center"},children:t("gender")}),r.jsx("th",{style:{textAlign:"center"},children:t("age")}),r.jsx("th",{style:{textAlign:"center"},children:t("country")})]})}),r.jsx("tbody",{children:oe.map((J,pe)=>{var ce,me,xe,M;return r.jsxs(Kt.Fragment,{children:[r.jsxs("tr",{style:{cursor:"pointer",borderBottom:"1px solid #eee"},onClick:()=>f(p===pe?null:pe),children:[r.jsx("td",{children:((M=(xe=(me=(ce=J.createdAt)==null?void 0:ce.toDate)==null?void 0:me.call(ce))==null?void 0:xe.toLocaleString)==null?void 0:M.call(xe))||""}),r.jsx("td",{children:r.jsx("img",{src:J.avatarUrl||"/ctx-logo.png",alt:"avatar",style:{width:36,height:36,borderRadius:"50%"}})}),r.jsx("td",{style:{color:"#ff4d4f",fontWeight:700,textDecoration:"underline",cursor:"pointer"},onClick:()=>{D(J),j(!0)},children:J.nickname}),r.jsx("td",{children:J.gender}),r.jsx("td",{children:J.age}),r.jsx("td",{children:J.country})]}),p===pe&&r.jsx("tr",{children:r.jsxs("td",{colSpan:6,style:{background:"#fff8f0",padding:18},children:[r.jsx("div",{style:{fontWeight:700,color:"#ff4d4f",marginBottom:8},children:"【你的困難我們一起面對，社群夥伴會主動協助你】"}),r.jsxs("div",{style:{marginBottom:8},children:[r.jsx("b",{children:"經歷："}),(J.exp||[]).join("、"),J.expOther?`、${J.expOther}`:""]}),r.jsxs("div",{style:{marginBottom:8},children:[r.jsx("b",{children:"優勢："}),(J.adv||[]).join("、"),J.advOther?`、${J.advOther}`:""]}),r.jsxs("div",{style:{marginBottom:8},children:[r.jsx("b",{children:"困難/需求："}),(J.target||[]).join("、"),J.targetOther?`、${J.targetOther}`:""]}),r.jsxs("div",{style:{marginBottom:8},children:[r.jsx("b",{children:"協助形式："}),J.helpType]}),r.jsxs("div",{style:{marginBottom:8},children:[r.jsx("b",{children:"補充說明："}),J.statement]}),r.jsxs("div",{style:{marginBottom:8},children:[r.jsx("b",{children:"協助頻率："}),J.freq,J.freqOther?`、${J.freqOther}`:""]}),r.jsx("div",{style:{marginTop:12},children:r.jsx("span",{href:`mailto:${J.email}`,style:{color:"#ff4d4f",textDecoration:"underline",marginLeft:12},children:J.email})})]})})]},J.id)})})]})})]}),I&&A&&r.jsx("div",{style:{position:"fixed",left:0,top:0,width:"100vw",height:"100vh",background:"rgba(40,40,80,0.18)",zIndex:1e4,display:"flex",alignItems:"center",justifyContent:"center"},children:r.jsxs("div",{style:{background:"#fff",borderRadius:18,boxShadow:"0 4px 24px #6B5BFF33",padding:28,minWidth:280,maxWidth:340,width:"90vw",position:"relative",display:"flex",flexDirection:"column",gap:12},children:[r.jsx("button",{type:"button",onClick:()=>j(!1),style:{position:"absolute",top:10,right:12,background:"none",border:"none",fontSize:22,color:"#888",cursor:"pointer",fontWeight:700},children:"×"}),r.jsxs("div",{style:{fontWeight:800,fontSize:18,color:"#6B5BFF",textAlign:"center",marginBottom:2},children:[t("msgTo"),A.nickname]}),r.jsx("textarea",{value:O,onChange:J=>P(J.target.value),rows:3,maxLength:100,placeholder:t("msgPlaceholder"),style:{border:"1px solid #e0e7ff",borderRadius:8,padding:"6px 10px",fontSize:15,resize:"none"}}),v&&r.jsx("div",{style:{color:"#ff4d4f",fontWeight:700,textAlign:"center",marginTop:4},children:v}),r.jsx("button",{onClick:()=>be(A,O),disabled:!O.trim()||H,style:{background:"linear-gradient(90deg, #6e8efb, #a777e3)",color:"#fff",border:"none",borderRadius:14,padding:"6px 18px",fontWeight:700,fontSize:15,cursor:!O.trim()||H?"not-allowed":"pointer",alignSelf:"center",opacity:!O.trim()||H?.6:1},children:H?"送出中...":"送出留言"}),B&&r.jsx("div",{style:{color:"#6B5BFF",fontWeight:700,textAlign:"center",marginTop:8},children:t("msgSent")})]})}),r.jsx("div",{style:{width:"100%",margin:"0 auto",marginTop:24,background:"rgba(255,255,255,0.95)",borderRadius:16,padding:"16px",boxShadow:"0 2px 12px #6B5BFF22"},children:r.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:20,flexWrap:"wrap"},children:[r.jsx("span",{onClick:()=>navigate("/about"),style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12,cursor:"pointer"},children:n==="zh-TW"?"🧬 Restarter™｜我們是誰":n==="zh-CN"?"🧬 Restarter™｜我们是谁":n==="en"?"🧬 Restarter™｜Who We Are":n==="ja"?"🧬 Restarter™｜私たちについて":n==="ko"?"🧬 Restarter™｜우리는 누구인가":n==="th"?"🧬 Restarter™｜เราเป็นใคร":n==="vi"?"🧬 Restarter™｜Chúng tôi là ai":n==="ms"?"🧬 Restarter™｜Siapa Kami":"🧬 Restarter™｜Quis sumus"}),r.jsx("span",{onClick:()=>navigate("/privacy-policy"),style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12,cursor:"pointer"},children:n==="zh-TW"?"隱私權政策":n==="zh-CN"?"隐私政策":n==="en"?"Privacy Policy":n==="ja"?"プライバシーポリシー":n==="ko"?"개인정보 처리방침":n==="th"?"นโยบายความเป็นส่วนตัว":n==="vi"?"Chính sách bảo mật":n==="ms"?"Dasar Privasi":"Consilium de Privata"}),r.jsx("span",{onClick:()=>navigate("/terms"),style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12,cursor:"pointer"},children:n==="zh-TW"?"條款/聲明":n==="zh-CN"?"条款/声明":n==="en"?"Terms/Statement":n==="ja"?"規約/声明":n==="ko"?"약관/성명":n==="th"?"ข้อกำหนด/แถลงการณ์":n==="vi"?"Điều khoản/Tuyên bố":n==="ms"?"Terma/Pernyataan":"Termini/Declaratio"}),r.jsx("span",{onClick:()=>navigate("/data-deletion"),style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12,cursor:"pointer"},children:n==="zh-TW"?"資料刪除說明":n==="zh-CN"?"数据删除说明":n==="en"?"Data Deletion":n==="ja"?"データ削除について":n==="ko"?"데이터 삭제 안내":n==="th"?"คำอธิบายการลบข้อมูล":n==="vi"?"Giải thích xóa dữ liệu":n==="ms"?"Penjelasan Penghapusan Data":"Explicatio Deletionis Datae"}),r.jsx("span",{onClick:()=>navigate("/feedback"),style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12,cursor:"pointer"},children:n==="zh-TW"?"💬 意見箱｜我們想聽你說":n==="zh-CN"?"💬 意见箱｜我们想听你说":n==="en"?"💬 Feedback Box｜We Want to Hear From You":n==="ja"?"💬 ご意見箱｜私たちはあなたの声を聞きたい":n==="ko"?"💬 피드백｜우리는 당신의 말을 듣고 싶습니다":n==="th"?"💬 กล่องความคิดเห็น｜เราอยากได้ยินจากคุณ":n==="vi"?"💬 Hộp góp ý｜Chúng tôi muốn nghe từ bạn":n==="ms"?"💬 Kotak Maklum Balas｜Kami Ingin Mendengar Dari Anda":"💬 Arca Consilii｜Volumus Audire a Te"})]})})]})}const Ga=(n,e)=>{try{localStorage.setItem(`emotionRelease_${n}`,JSON.stringify(e))}catch{console.log("無法保存遊戲進度到本地存儲")}},Ka=n=>{try{const e=localStorage.getItem(`emotionRelease_${n}`);return e?JSON.parse(e):null}catch{return console.log("無法從本地存儲載入遊戲進度"),null}};function R5(){const{lang:n}=Qe(),[e,t]=g.useState(null),[i,s]=g.useState(!1);g.useEffect(()=>{const c=new Image;c.onload=()=>s(!0),c.onerror=()=>s(!0);const u=setTimeout(()=>{s(!0)},3e3);return c.src="/stress.png",()=>clearTimeout(u)},[]);const o=c=>{var h;const u={"zh-TW":{title:"情緒發洩區",subtitle:"選擇適合的遊戲來釋放你的情緒",farm:"生活農場",farmDesc:"點擊種植，感受成長的喜悅",whackAMole:"打地鼠",whackAMoleDesc:"快速點擊，釋放壓力",fruitPicking:"採水果",fruitPickingDesc:"點擊收集，享受豐收",targetShooting:"情緒泡泡爆破",targetShootingDesc:"戳破情緒泡泡，釋放內心壓力",racing:"極速賽車",racingDesc:"駕駛賽車，體驗速度與激情",rhythm:"音樂節奏",rhythmDesc:"跟隨節奏，釋放音樂能量",rules:"遊戲規則",back:"返回",start:"開始遊戲",close:"關閉"},"zh-CN":{title:"情绪发泄区",subtitle:"选择适合的游戏来释放你的情绪",farm:"生活农场",farmDesc:"点击种植，感受成长的喜悦",whackAMole:"打地鼠",whackAMoleDesc:"快速点击，释放压力",fruitPicking:"采水果",fruitPickingDesc:"点击收集，享受丰收",targetShooting:"飞靶射击",targetShootingDesc:"瞄准射击，提升专注力",racing:"极速赛车",racingDesc:"驾驶赛车，体验速度与激情",rhythm:"音乐节奏",rhythmDesc:"跟随节奏，释放音乐能量",rules:"游戏规则",back:"返回",start:"开始游戏",close:"关闭"},en:{title:"Emotion Release Zone",subtitle:"Choose a game to release your emotions",farm:"Life Farm",farmDesc:"Click to plant, feel the joy of growth",whackAMole:"Whack-a-Mole",whackAMoleDesc:"Quick clicks to release stress",fruitPicking:"Fruit Picking",fruitPickingDesc:"Click to collect, enjoy the harvest",targetShooting:"Target Shooting",targetShootingDesc:"Aim and shoot, improve focus",racing:"Speed Racing",racingDesc:"Drive racing cars, experience speed and excitement",rhythm:"Music Rhythm",rhythmDesc:"Follow the rhythm, release musical energy",rules:"Game Rules",back:"Back",start:"Start Game",close:"Close"},ja:{title:"感情発散エリア",subtitle:"感情を解放するゲームを選択してください",farm:"ライフファーム",farmDesc:"クリックして植える、成長の喜びを感じる",whackAMole:"モグラたたき",whackAMoleDesc:"素早くクリックしてストレスを解放",fruitPicking:"フルーツ収穫",fruitPickingDesc:"クリックして収穫、収穫を楽しむ",targetShooting:"ターゲット射撃",targetShootingDesc:"狙って撃つ、集中力を向上",racing:"スピードレーシング",racingDesc:"レーシングカーを運転、スピードと興奮を体験",rhythm:"音楽リズム",rhythmDesc:"リズムに合わせて、音楽エネルギーを解放",rules:"ゲームルール",back:"戻る",start:"ゲーム開始",close:"閉じる"},ko:{title:"감정 발산 구역",subtitle:"감정을 해방할 게임을 선택하세요",farm:"라이프 팜",farmDesc:"클릭하여 심고, 성장의 기쁨을 느끼세요",whackAMole:"두더지 잡기",whackAMoleDesc:"빠르게 클릭하여 스트레스를 해방하세요",fruitPicking:"과일 수확",fruitPickingDesc:"클릭하여 수확하고, 수확의 기쁨을 누리세요",targetShooting:"타겟 사격",targetShootingDesc:"조준하고 쏘기, 집중력 향상",racing:"스피드 레이싱",racingDesc:"레이싱카 운전, 속도와 흥분을 경험",rhythm:"음악 리듬",rhythmDesc:"리듬에 맞춰 음악 에너지를 해방",rules:"게임 규칙",back:"돌아가기",start:"게임 시작",close:"닫기"},vi:{title:"Khu Vực Giải Tỏa Cảm Xúc",subtitle:"Chọn trò chơi để giải tỏa cảm xúc của bạn",farm:"Nông Trại Cuộc Sống",farmDesc:"Nhấp để trồng, cảm nhận niềm vui của sự phát triển",whackAMole:"Đập Chuột",whackAMoleDesc:"Nhấp nhanh để giải tỏa căng thẳng",fruitPicking:"Hái Trái Cây",fruitPickingDesc:"Nhấp để thu hoạch, tận hưởng mùa màng",targetShooting:"Bắn Bia",targetShootingDesc:"Nhắm và bắn, cải thiện sự tập trung",racing:"Đua Xe Tốc Độ",racingDesc:"Lái xe đua, trải nghiệm tốc độ và sự phấn khích",rhythm:"Nhịp Điệu Âm Nhạc",rhythmDesc:"Theo nhịp điệu, giải phóng năng lượng âm nhạc",rules:"Luật Chơi",back:"Quay Lại",start:"Bắt Đầu Trò Chơi",close:"Đóng"},th:{title:"พื้นที่ระบายอารมณ์",subtitle:"เลือกเกมเพื่อระบายอารมณ์ของคุณ",farm:"ฟาร์มชีวิต",farmDesc:"คลิกเพื่อปลูก รู้สึกถึงความสุขของการเติบโต",whackAMole:"ตีตุ่น",whackAMoleDesc:"คลิกเร็วเพื่อระบายความเครียด",fruitPicking:"เก็บผลไม้",fruitPickingDesc:"คลิกเพื่อเก็บเกี่ยว สนุกกับการเก็บเกี่ยว",targetShooting:"ยิงเป้า",targetShootingDesc:"เล็งและยิง ปรับปรุงสมาธิ",racing:"แข่งรถความเร็ว",racingDesc:"ขับรถแข่ง ประสบการณ์ความเร็วและความตื่นเต้น",rhythm:"จังหวะดนตรี",rhythmDesc:"ตามจังหวะ ปลดปล่อยพลังงานดนตรี",rules:"กฎเกม",back:"กลับ",start:"เริ่มเกม",close:"ปิด"},la:{title:"Zona Emotio Liberationis",subtitle:"Elige ludum ad liberationem emotionum tuarum",farm:"Villa Vitae",farmDesc:"Clicca ad plantandum, senti gaudium incrementi",whackAMole:"Talpa Percutere",whackAMoleDesc:"Clicca celeriter ad liberationem tensionis",fruitPicking:"Fructus Colligere",fruitPickingDesc:"Clicca ad colligendum, fruere messe",targetShooting:"Scopum Iaculare",targetShootingDesc:"Intende et iacula, meliora attentionem",racing:"Cursus Velocitatis",racingDesc:"Guberna currus cursus, experire velocitatem et excitationem",rhythm:"Rhythmus Musicae",rhythmDesc:"Sequere rhythmum, libera energiam musicam",rules:"Regulae Ludi",back:"Regredi",start:"Ludum Incipere",close:"Claudere"},ms:{title:"Zon Pelepasan Emosi",subtitle:"Pilih permainan untuk melepaskan emosi anda",farm:"Ladang Kehidupan",farmDesc:"Klik untuk menanam, rasakan kegembiraan pertumbuhan",whackAMole:"Pukul Tikus",whackAMoleDesc:"Klik pantas untuk melepaskan tekanan",fruitPicking:"Kutip Buah",fruitPickingDesc:"Klik untuk mengutip, nikmati hasil tuaian",targetShooting:"Tembak Sasaran",targetShootingDesc:"Arah dan tembak, tingkatkan fokus",racing:"Lumba Kereta Laju",racingDesc:"Pandu kereta lumba, alami kelajuan dan keseronokan",rhythm:"Irama Muzik",rhythmDesc:"Ikut irama, lepaskan tenaga muzik",rules:"Peraturan Permainan",back:"Kembali",start:"Mulakan Permainan",close:"Tutup"}};return((h=u[n])==null?void 0:h[c])||u["zh-TW"][c]||c},a=[{id:"farm",title:o("farm"),description:o("farmDesc"),icon:"🌱",color:"#4CAF50"},{id:"whackAMole",title:o("whackAMole"),description:o("whackAMoleDesc"),icon:"🔨",color:"#FF5722"},{id:"fruitPicking",title:o("fruitPicking"),description:o("fruitPickingDesc"),icon:"🍎",color:"#FF9800"},{id:"targetShooting",title:o("targetShooting"),description:o("targetShootingDesc"),icon:"🫧",color:"#9C27B0"},{id:"racing",title:o("racing"),description:o("racingDesc"),icon:"🏎️",color:"#E91E63"},{id:"rhythm",title:o("rhythm"),description:o("rhythmDesc"),icon:"🎵",color:"#00BCD4"}],l=()=>{switch(e){case"farm":return r.jsx(A5,{onClose:()=>t(null)});case"whackAMole":return r.jsx(E5,{onClose:()=>t(null)});case"fruitPicking":return r.jsx(B5,{onClose:()=>t(null)});case"targetShooting":return r.jsx(P5,{onClose:()=>t(null)});case"racing":return r.jsx(F5,{onClose:()=>t(null)});case"rhythm":return r.jsx(z5,{onClose:()=>t(null)});default:return null}};return r.jsxs("div",{style:{minHeight:"100vh",background:i?"linear-gradient(135deg, rgba(102, 126, 234, 0.8) 0%, rgba(118, 75, 162, 0.8) 100%), url('/stress.png')":"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat",padding:"clamp(10px, 2vw, 20px)",fontFamily:"Arial, sans-serif",boxSizing:"border-box",position:"relative"},children:[!i&&r.jsxs("div",{style:{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",background:"rgba(255,255,255,0.9)",padding:"20px",borderRadius:"10px",zIndex:2e3,textAlign:"center"},children:[r.jsx("div",{style:{fontSize:"18px",marginBottom:"10px"},children:"載入中..."}),r.jsx("div",{style:{width:"40px",height:"40px",border:"4px solid #f3f3f3",borderTop:"4px solid #667eea",borderRadius:"50%",margin:"0 auto",animation:"spin 1s linear infinite"}}),r.jsx("style",{children:`
            @keyframes spin {
              0% { transform: rotate(0deg); }
              100% { transform: rotate(360deg); }
            }
          `})]}),!e&&r.jsxs("button",{onClick:()=>{console.log("返回按鈕被點擊"),window.history.back()},style:{position:"absolute",top:"clamp(20px, 4vw, 40px)",left:"clamp(20px, 4vw, 40px)",zIndex:9999,background:"rgba(255,255,255,0.9)",border:"none",borderRadius:"25px",padding:"clamp(8px, 2vw, 12px) clamp(16px, 3vw, 24px)",fontSize:"clamp(14px, 2.5vw, 18px)",fontWeight:"bold",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",color:"#667eea",transition:"all 0.3s ease",boxShadow:"0 4px 12px rgba(0,0,0,0.15)",pointerEvents:"auto"},onMouseEnter:c=>{c.currentTarget.style.background="#667eea",c.currentTarget.style.color="#fff",c.currentTarget.style.transform="translateY(-2px)"},onMouseLeave:c=>{c.currentTarget.style.background="rgba(255,255,255,0.9)",c.currentTarget.style.color="#667eea",c.currentTarget.style.transform="translateY(0)"},children:["← ",o("back")]}),e?r.jsx("div",{style:{position:"relative",height:"100vh"},children:l()}):r.jsxs("div",{style:{maxWidth:"1200px",margin:"0 auto"},children:[r.jsxs("div",{style:{textAlign:"center",marginBottom:"clamp(20px, 4vw, 40px)",marginTop:"clamp(60px, 8vw, 80px)"},children:[r.jsx("h1",{style:{color:"#fff",fontSize:"clamp(1.5rem, 4vw, 2.5rem)",fontWeight:"bold",marginBottom:"10px",textShadow:"2px 2px 4px rgba(0,0,0,0.3)"},children:o("title")}),r.jsx("p",{style:{color:"#fff",fontSize:"clamp(1rem, 2.5vw, 1.2rem)",opacity:.9,textShadow:"1px 1px 2px rgba(0,0,0,0.3)"},children:o("subtitle")})]}),r.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(280px, 1fr))",gap:"clamp(15px, 3vw, 30px)",padding:"clamp(10px, 2vw, 20px)"},children:a.map(c=>r.jsxs("div",{onClick:()=>t(c.id),style:{background:"rgba(255,255,255,0.95)",borderRadius:"20px",padding:"clamp(20px, 4vw, 30px)",textAlign:"center",cursor:"pointer",transition:"all 0.3s ease",boxShadow:"0 8px 32px rgba(0,0,0,0.1)",border:`3px solid ${c.color}`,position:"relative",overflow:"hidden"},onMouseEnter:u=>{u.currentTarget.style.transform="translateY(-5px)",u.currentTarget.style.boxShadow="0 12px 40px rgba(0,0,0,0.2)"},onMouseLeave:u=>{u.currentTarget.style.transform="translateY(0)",u.currentTarget.style.boxShadow="0 8px 32px rgba(0,0,0,0.1)"},children:[r.jsx("div",{style:{fontSize:"clamp(3rem, 8vw, 4rem)",marginBottom:"20px",filter:"drop-shadow(2px 2px 4px rgba(0,0,0,0.2))"},children:c.icon}),r.jsx("h3",{style:{color:c.color,fontSize:"clamp(1.2rem, 3vw, 1.5rem)",fontWeight:"bold",marginBottom:"15px"},children:c.title}),r.jsx("p",{style:{color:"#666",fontSize:"clamp(0.9rem, 2vw, 1rem)",lineHeight:"1.5"},children:c.description}),r.jsx("button",{style:{background:c.color,color:"#fff",border:"none",borderRadius:"25px",padding:"clamp(8px, 2vw, 12px) clamp(20px, 4vw, 30px)",fontSize:"clamp(0.9rem, 2vw, 1rem)",fontWeight:"bold",marginTop:"20px",cursor:"pointer",transition:"all 0.3s ease"},children:o("start")})]},c.id))})]}),e===null&&r.jsx(r.Fragment,{children:window.innerWidth<=768?r.jsx("div",{style:{width:"100%",margin:"0 auto",marginTop:24,background:"rgba(255,255,255,0.95)",borderRadius:16,padding:"16px",boxShadow:"0 2px 12px #6B5BFF22"},children:r.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:8},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:20,flexWrap:"wrap"},children:[r.jsx("span",{onClick:()=>navigate("/about"),style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12,cursor:"pointer"},children:"🧬 Restarter™｜我們是誰"}),r.jsx("span",{onClick:()=>navigate("/privacy-policy"),style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12,cursor:"pointer"},children:"隱私權政策"}),r.jsx("span",{onClick:()=>navigate("/terms"),style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12,cursor:"pointer"},children:"條款/聲明"})]}),r.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:20,flexWrap:"wrap"},children:[r.jsx("span",{onClick:()=>navigate("/data-deletion"),style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12,cursor:"pointer"},children:"資料刪除說明"}),r.jsx("span",{onClick:()=>navigate("/feedback"),style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12,cursor:"pointer"},children:"💬 意見箱｜我們想聽你說"})]})]})}):r.jsx("div",{style:{width:"100%",margin:"0 auto",marginTop:24,background:"rgba(255,255,255,0.95)",borderRadius:16,padding:"16px",boxShadow:"0 2px 12px #6B5BFF22"},children:r.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:20,flexWrap:"wrap"},children:[r.jsx("span",{onClick:()=>navigate("/about"),style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12,cursor:"pointer"},children:n==="zh-TW"?"🧬 Restarter™｜我們是誰":n==="zh-CN"?"🧬 Restarter™｜我们是谁":n==="en"?"🧬 Restarter™｜Who We Are":n==="ja"?"🧬 Restarter™｜私たちについて":n==="ko"?"🧬 Restarter™｜우리는 누구인가":n==="th"?"🧬 Restarter™｜เราเป็นใคร":n==="vi"?"🧬 Restarter™｜Chúng tôi là ai":n==="ms"?"🧬 Restarter™｜Siapa Kami":"🧬 Restarter™｜Quis sumus"}),r.jsx("span",{onClick:()=>navigate("/privacy-policy"),style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12,cursor:"pointer"},children:n==="zh-TW"?"隱私權政策":n==="zh-CN"?"隐私政策":n==="en"?"Privacy Policy":n==="ja"?"プライバシーポリシー":n==="ko"?"개인정보 처리방침":n==="th"?"นโยบายความเป็นส่วนตัว":n==="vi"?"Chính sách bảo mật":n==="ms"?"Dasar Privasi":"Consilium de Privata"}),r.jsx("span",{onClick:()=>navigate("/terms"),style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12,cursor:"pointer"},children:n==="zh-TW"?"條款/聲明":n==="zh-CN"?"条款/声明":n==="en"?"Terms/Statement":n==="ja"?"規約/声明":n==="ko"?"약관/성명":n==="th"?"ข้อกำหนด/แถลงการณ์":n==="vi"?"Điều khoản/Tuyên bố":n==="ms"?"Terma/Pernyataan":"Termini/Declaratio"}),r.jsx("span",{onClick:()=>navigate("/data-deletion"),style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12,cursor:"pointer"},children:n==="zh-TW"?"資料刪除說明":n==="zh-CN"?"数据删除说明":n==="en"?"Data Deletion":n==="ja"?"データ削除について":n==="ko"?"데이터 삭제 안내":n==="th"?"คำอธิบายการลบข้อมูล":n==="vi"?"Giải thích xóa dữ liệu":n==="ms"?"Penjelasan Penghapusan Data":"Explicatio Deletionis Datae"}),r.jsx("span",{onClick:()=>navigate("/feedback"),style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12,cursor:"pointer"},children:n==="zh-TW"?"💬 意見箱｜我們想聽你說":n==="zh-CN"?"💬 意见箱｜我们想听你说":n==="en"?"💬 Feedback Box｜We Want to Hear From You":n==="ja"?"💬 ご意見箱｜私たちはあなたの声を聞きたい":n==="ko"?"💬 피드백｜우리는 당신의 말을 듣고 싶습니다":n==="th"?"💬 กล่องความคิดเห็น｜เราอยากได้ยินจากคุณ":n==="vi"?"💬 Hộp góp ý｜Chúng tôi muốn nghe từ bạn":n==="ms"?"💬 Kotak Maklum Balas｜Kami Ingin Mendengar Dari Anda":"💬 Arca Consilii｜Volumus Audire a Te"})]})})})]})}function A5({onClose:n}){const{lang:e}=Qe(),[t,i]=g.useState([]),[s,o]=g.useState(0),[a,l]=g.useState("carrot"),[c,u]=g.useState(!1),h=S=>{var I;const w={"zh-TW":{title:"生活農場",rules:"遊戲規則",hideRules:"隱藏規則",seedSelection:"種子選擇：",score:"分數",gameRules:"遊戲規則",plantStage:"種植階段：",harvestStage:"收穫階段：",plantStep1:"1. 選擇種子（6種作物可選）",plantStep2:"2. 點擊空地種植 → 獲得種植分數",plantStep3:"3. 作物會自動生長（幼苗→成熟）",harvestStep1:"1. 點擊成熟的作物進行收穫",harvestStep2:"2. 收穫後獲得更高分數",harvestStep3:"3. 空地可以重新種植",scoring:"計分系統：",scoring1:"• 種植分數：10-25分（根據作物類型）",scoring2:"• 收穫分數：50-125分（根據作物類型）",scoring3:"• 作物生長時間：3-8秒",plant:"種植",harvest:"收穫",growthTime:"生長時間",seconds:"秒",carrot:"胡蘿蔔",tomato:"番茄",corn:"玉米",potato:"馬鈴薯",strawberry:"草莓",watermelon:"西瓜"},"zh-CN":{title:"生活农场",rules:"游戏规则",hideRules:"隐藏规则",seedSelection:"种子选择：",score:"分数",gameRules:"游戏规则",plantStage:"种植阶段：",harvestStage:"收获阶段：",plantStep1:"1. 选择种子（6种作物可选）",plantStep2:"2. 点击空地种植 → 获得种植分数",plantStep3:"3. 作物会自动生长（幼苗→成熟）",harvestStep1:"1. 点击成熟的作物进行收获",harvestStep2:"2. 收获后获得更高分数",harvestStep3:"3. 空地可以重新种植",scoring:"计分系统：",scoring1:"• 种植分数：10-25分（根据作物类型）",scoring2:"• 收获分数：50-125分（根据作物类型）",scoring3:"• 作物生长时间：3-8秒",plant:"种植",harvest:"收获",growthTime:"生长时间",seconds:"秒",carrot:"胡萝卜",tomato:"番茄",corn:"玉米",potato:"马铃薯",strawberry:"草莓",watermelon:"西瓜"},en:{title:"Life Farm",rules:"Game Rules",hideRules:"Hide Rules",seedSelection:"Seed Selection:",score:"Score",gameRules:"Game Rules",plantStage:"Planting Stage:",harvestStage:"Harvest Stage:",plantStep1:"1. Select seeds (6 crop types available)",plantStep2:"2. Click empty plots to plant → Get planting score",plantStep3:"3. Crops grow automatically (seedling→mature)",harvestStep1:"1. Click mature crops to harvest",harvestStep2:"2. Get higher score after harvest",harvestStep3:"3. Empty plots can be replanted",scoring:"Scoring System:",scoring1:"• Planting score: 10-25 points (by crop type)",scoring2:"• Harvest score: 50-125 points (by crop type)",scoring3:"• Growth time: 3-8 seconds",plant:"Plant",harvest:"Harvest",growthTime:"Growth Time",seconds:"seconds",carrot:"Carrot",tomato:"Tomato",corn:"Corn",potato:"Potato",strawberry:"Strawberry",watermelon:"Watermelon"},ja:{title:"ライフファーム",rules:"ゲームルール",hideRules:"ルールを隠す",seedSelection:"種子選択：",score:"スコア",gameRules:"ゲームルール",plantStage:"植栽段階：",harvestStage:"収穫段階：",plantStep1:"1. 種子を選択（6種類の作物）",plantStep2:"2. 空き地をクリックして植栽 → 植栽スコア獲得",plantStep3:"3. 作物は自動で成長（苗→成熟）",harvestStep1:"1. 成熟した作物をクリックして収穫",harvestStep2:"2. 収穫後により高いスコア獲得",harvestStep3:"3. 空き地は再植栽可能",scoring:"スコアシステム：",scoring1:"• 植栽スコア：10-25ポイント（作物タイプ別）",scoring2:"• 収穫スコア：50-125ポイント（作物タイプ別）",scoring3:"• 成長時間：3-8秒",plant:"植栽",harvest:"収穫",growthTime:"成長時間",seconds:"秒",carrot:"ニンジン",tomato:"トマト",corn:"トウモロコシ",potato:"ジャガイモ",strawberry:"イチゴ",watermelon:"スイカ"},ko:{title:"라이프 팜",rules:"게임 규칙",hideRules:"규칙 숨기기",seedSelection:"씨앗 선택:",score:"점수",gameRules:"게임 규칙",plantStage:"심기 단계:",harvestStage:"수확 단계:",plantStep1:"1. 씨앗 선택 (6가지 작물)",plantStep2:"2. 빈 땅 클릭하여 심기 → 심기 점수 획득",plantStep3:"3. 작물 자동 성장 (묘목→성숙)",harvestStep1:"1. 성숙한 작물 클릭하여 수확",harvestStep2:"2. 수확 후 더 높은 점수 획득",harvestStep3:"3. 빈 땅 재심기 가능",scoring:"점수 시스템:",scoring1:"• 심기 점수: 10-25점 (작물 타입별)",scoring2:"• 수확 점수: 50-125점 (작물 타입별)",scoring3:"• 성장 시간: 3-8초",plant:"심기",harvest:"수확",growthTime:"성장 시간",seconds:"초",carrot:"당근",tomato:"토마토",corn:"옥수수",potato:"감자",strawberry:"딸기",watermelon:"수박"},vi:{title:"Nông Trại Cuộc Sống",rules:"Luật Chơi",hideRules:"Ẩn Luật",seedSelection:"Chọn Hạt Giống:",score:"Điểm",gameRules:"Luật Chơi",plantStage:"Giai Đoạn Trồng:",harvestStage:"Giai Đoạn Thu Hoạch:",plantStep1:"1. Chọn hạt giống (6 loại cây trồng)",plantStep2:"2. Nhấp vào ô trống để trồng → Nhận điểm trồng",plantStep3:"3. Cây trồng tự động phát triển (mầm→trưởng thành)",harvestStep1:"1. Nhấp vào cây trưởng thành để thu hoạch",harvestStep2:"2. Nhận điểm cao hơn sau thu hoạch",harvestStep3:"3. Ô trống có thể trồng lại",scoring:"Hệ Thống Điểm:",scoring1:"• Điểm trồng: 10-25 điểm (theo loại cây)",scoring2:"• Điểm thu hoạch: 50-125 điểm (theo loại cây)",scoring3:"• Thời gian phát triển: 3-8 giây",plant:"Trồng",harvest:"Thu hoạch",growthTime:"Thời gian phát triển",seconds:"giây",carrot:"Cà Rốt",tomato:"Cà Chua",corn:"Ngô",potato:"Khoai Tây",strawberry:"Dâu Tây",watermelon:"Dưa Hấu"},th:{title:"ฟาร์มชีวิต",rules:"กฎเกม",hideRules:"ซ่อนกฎ",seedSelection:"เลือกเมล็ด:",score:"คะแนน",gameRules:"กฎเกม",plantStage:"ขั้นตอนปลูก:",harvestStage:"ขั้นตอนเก็บเกี่ยว:",plantStep1:"1. เลือกเมล็ด (6 ชนิดพืช)",plantStep2:"2. คลิกที่แปลงว่างเพื่อปลูก → ได้คะแนนปลูก",plantStep3:"3. พืชเติบโตอัตโนมัติ (ต้นกล้า→สุก)",harvestStep1:"1. คลิกพืชที่สุกแล้วเพื่อเก็บเกี่ยว",harvestStep2:"2. ได้คะแนนสูงขึ้นหลังเก็บเกี่ยว",harvestStep3:"3. แปลงว่างสามารถปลูกใหม่ได้",scoring:"ระบบคะแนน:",scoring1:"• คะแนนปลูก: 10-25 คะแนน (ตามชนิดพืช)",scoring2:"• คะแนนเก็บเกี่ยว: 50-125 คะแนน (ตามชนิดพืช)",scoring3:"• เวลาเติบโต: 3-8 วินาที",plant:"ปลูก",harvest:"เก็บเกี่ยว",growthTime:"เวลาเติบโต",seconds:"วินาที",carrot:"แครอท",tomato:"มะเขือเทศ",corn:"ข้าวโพด",potato:"มันฝรั่ง",strawberry:"สตรอเบอร์รี่",watermelon:"แตงโม"},la:{title:"Villa Vitae",rules:"Regulae Ludi",hideRules:"Occulta Regulas",seedSelection:"Selectio Seminis:",score:"Puncta",gameRules:"Regulae Ludi",plantStage:"Stadium Plantandi:",harvestStage:"Stadium Messis:",plantStep1:"1. Elige semina (6 genera culturarum)",plantStep2:"2. Clicca in agros vacuos ad plantandum → Accipe puncta",plantStep3:"3. Culturae crescunt automatice (plantula→maturus)",harvestStep1:"1. Clicca culturas maturas ad messem",harvestStep2:"2. Accipe puncta altiora post messem",harvestStep3:"3. Agri vacui possunt replantari",scoring:"Systema Punctorum:",scoring1:"• Puncta plantandi: 10-25 (secundum genus)",scoring2:"• Puncta messis: 50-125 (secundum genus)",scoring3:"• Tempus crescendi: 3-8 secundis",plant:"Planta",harvest:"Messis",growthTime:"Tempus Crescendi",seconds:"secundis",carrot:"Daucus",tomato:"Lycopersicum",corn:"Zea",potato:"Solanum",strawberry:"Fragaria",watermelon:"Citrullus"},ms:{title:"Ladang Kehidupan",rules:"Peraturan Permainan",hideRules:"Sembunyikan Peraturan",seedSelection:"Pilihan Benih:",score:"Markah",gameRules:"Peraturan Permainan",plantStage:"Peringkat Menanam:",harvestStage:"Peringkat Menuai:",plantStep1:"1. Pilih benih (6 jenis tanaman)",plantStep2:"2. Klik plot kosong untuk menanam → Dapat markah menanam",plantStep3:"3. Tanaman tumbuh secara automatik (anak benih→matang)",harvestStep1:"1. Klik tanaman matang untuk menuai",harvestStep2:"2. Dapat markah lebih tinggi selepas menuai",harvestStep3:"3. Plot kosong boleh ditanam semula",scoring:"Sistem Markah:",scoring1:"• Markah menanam: 10-25 mata (mengikut jenis tanaman)",scoring2:"• Markah menuai: 50-125 mata (mengikut jenis tanaman)",scoring3:"• Masa tumbuh: 3-8 saat",plant:"Tanam",harvest:"Tuai",growthTime:"Masa Tumbuh",seconds:"saat",carrot:"Lobak Merah",tomato:"Tomato",corn:"Jagung",potato:"Kentang",strawberry:"Strawberi",watermelon:"Tembikai"}};return((I=w[e])==null?void 0:I[S])||w["zh-TW"][S]||S};g.useEffect(()=>{const S=Ka("farm");S&&(i(S.plants||[]),o(S.score||0))},[]),g.useEffect(()=>{Ga("farm",{plants:t,score:s})},[t,s]);const p=[{id:"carrot",name:"胡蘿蔔",emoji:"🥕",growthTime:3e3,color:"#FF6B35",plantScore:10,harvestScore:50},{id:"tomato",name:"番茄",emoji:"🍅",growthTime:5e3,color:"#FF4444",plantScore:15,harvestScore:75},{id:"corn",name:"玉米",emoji:"🌽",growthTime:7e3,color:"#FFD700",plantScore:20,harvestScore:100},{id:"potato",name:"馬鈴薯",emoji:"🥔",growthTime:4e3,color:"#8B4513",plantScore:12,harvestScore:60},{id:"strawberry",name:"草莓",emoji:"🍓",growthTime:6e3,color:"#FF69B4",plantScore:18,harvestScore:90},{id:"watermelon",name:"西瓜",emoji:"🍉",growthTime:8e3,color:"#FF6347",plantScore:25,harvestScore:125}],f=(S,w)=>{if(t.find(D=>D.x===S&&D.y===w))return;const j=p.find(D=>D.id===a);if(!j)return;const A={id:Date.now(),type:a,growth:0,planted:Date.now(),x:S,y:w};i(D=>[...D,A]),o(D=>D+j.plantScore),setTimeout(()=>{i(D=>D.map(O=>O.id===A.id?{...O,growth:50}:O))},j.growthTime/2),setTimeout(()=>{i(D=>D.map(O=>O.id===A.id?{...O,growth:100}:O))},j.growthTime)},b=S=>{const w=t.find(I=>I.id===S);if(w&&w.growth>=100){const I=p.find(j=>j.id===w.type);i(j=>j.filter(A=>A.id!==S)),o(j=>j+((I==null?void 0:I.harvestScore)||50))}},x=(S,w)=>t.find(I=>I.x===S&&I.y===w);return r.jsx("div",{style:{height:"100vh",background:"linear-gradient(180deg, #87CEEB 0%, #90EE90 100%)",padding:"clamp(10px, 2vw, 20px)",position:"relative",display:"flex",flexDirection:"column",overflow:"hidden"},children:r.jsxs("div",{style:{display:"grid",gridTemplateColumns:window.innerWidth<=768?"1fr":"clamp(200px, 25vw, 250px) 1fr",gap:"clamp(10px, 2vw, 20px)",height:"calc(100% - 60px)",marginTop:"60px",overflow:"visible",minHeight:"0",width:"100%"},children:[r.jsxs("div",{style:{background:"rgba(255,255,255,0.95)",borderRadius:"15px",padding:"clamp(15px, 3vw, 20px)",height:"fit-content",maxHeight:window.innerWidth<=768?"200px":"100%",overflow:"auto",boxShadow:"0 4px 20px rgba(0,0,0,0.1)",alignSelf:"start",display:window.innerWidth<=768?"none":"block"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",fontSize:"clamp(1.2rem, 3vw, 1.5rem)",fontWeight:"bold",color:"#333"},children:["🌱 ",h("title")]}),r.jsx("button",{onClick:()=>u(!c),style:{background:"#4CAF50",color:"#fff",border:"none",borderRadius:"15px",padding:"4px 12px",fontSize:"clamp(0.7rem, 1.8vw, 0.8rem)",cursor:"pointer"},children:h(c?"hideRules":"rules")})]}),r.jsxs("div",{style:{marginBottom:"20px"},children:[r.jsx("h4",{style:{marginBottom:"10px",fontSize:"clamp(1rem, 2.5vw, 1.2rem)",color:"#333",fontWeight:"bold"},children:h("seedSelection")}),p.map(S=>r.jsxs("div",{onClick:()=>l(S.id),style:{padding:"clamp(8px, 2vw, 10px)",margin:"5px 0",borderRadius:"8px",cursor:"pointer",background:a===S.id?"#e8f5e8":"#f5f5f5",border:a===S.id?"2px solid #4CAF50":"2px solid transparent",fontSize:"clamp(0.9rem, 2vw, 1rem)",display:"flex",alignItems:"center",gap:"8px",transition:"all 0.3s ease"},children:[r.jsx("span",{style:{fontSize:"1.2em"},children:S.emoji}),r.jsx("span",{children:h(S.id)})]},S.id))]}),r.jsx("div",{style:{marginBottom:"20px"},children:r.jsxs("h4",{style:{fontSize:"clamp(1rem, 2.5vw, 1.2rem)",color:"#333",fontWeight:"bold"},children:[h("score"),"：",s]})}),c&&r.jsxs("div",{style:{background:"rgba(255,255,255,0.8)",borderRadius:"10px",padding:"12px",marginBottom:"15px",textAlign:"left",fontSize:"clamp(0.7rem, 1.8vw, 0.8rem)",lineHeight:"1.3"},children:[r.jsxs("h4",{style:{marginBottom:"8px",color:"#333"},children:["🎯 ",h("gameRules"),"："]}),r.jsx("p",{style:{marginBottom:"6px"},children:r.jsx("strong",{children:h("plantStage")})}),r.jsx("p",{style:{marginBottom:"6px"},children:h("plantStep1")}),r.jsx("p",{style:{marginBottom:"6px"},children:h("plantStep2")}),r.jsx("p",{style:{marginBottom:"6px"},children:h("plantStep3")}),r.jsx("p",{style:{marginBottom:"6px",marginTop:"8px"},children:r.jsx("strong",{children:h("harvestStage")})}),r.jsx("p",{style:{marginBottom:"6px"},children:h("harvestStep1")}),r.jsx("p",{style:{marginBottom:"6px"},children:h("harvestStep2")}),r.jsx("p",{style:{marginBottom:"6px"},children:h("harvestStep3")}),r.jsx("p",{style:{marginBottom:"6px",marginTop:"8px"},children:r.jsx("strong",{children:h("scoring")})}),r.jsxs("p",{style:{marginBottom:"4px"},children:["🥕 ",h("carrot"),"：",h("plant"),"+10 ",h("harvest"),"+50"]}),r.jsxs("p",{style:{marginBottom:"4px"},children:["🍅 ",h("tomato"),"：",h("plant"),"+15 ",h("harvest"),"+75"]}),r.jsxs("p",{style:{marginBottom:"4px"},children:["🌽 ",h("corn"),"：",h("plant"),"+20 ",h("harvest"),"+100"]}),r.jsxs("p",{style:{marginBottom:"4px"},children:["🥔 ",h("potato"),"：",h("plant"),"+12 ",h("harvest"),"+60"]}),r.jsxs("p",{style:{marginBottom:"4px"},children:["🍓 ",h("strawberry"),"：",h("plant"),"+18 ",h("harvest"),"+90"]}),r.jsxs("p",{style:{marginBottom:"4px"},children:["🍉 ",h("watermelon"),"：",h("plant"),"+25 ",h("harvest"),"+125"]}),r.jsx("p",{style:{marginBottom:"6px",marginTop:"8px"},children:r.jsxs("strong",{children:[h("growthTime"),"："]})}),r.jsxs("p",{style:{marginBottom:"4px"},children:["🥕 ",h("carrot"),"：3",h("seconds")]}),r.jsxs("p",{style:{marginBottom:"4px"},children:["🍅 ",h("tomato"),"：5",h("seconds")]}),r.jsxs("p",{style:{marginBottom:"4px"},children:["🌽 ",h("corn"),"：7",h("seconds")]}),r.jsxs("p",{style:{marginBottom:"4px"},children:["🥔 ",h("potato"),"：4",h("seconds")]}),r.jsxs("p",{style:{marginBottom:"4px"},children:["🍓 ",h("strawberry"),"：6",h("seconds")]}),r.jsxs("p",{style:{marginBottom:"4px"},children:["🍉 ",h("watermelon"),"：8",h("seconds")]})]})]}),r.jsxs("div",{style:{background:"rgba(255,255,255,0.9)",borderRadius:"15px",padding:window.innerWidth<=768?"clamp(5px, 1vw, 10px)":"clamp(10px, 2vw, 20px)",position:"relative",overflow:"visible",boxShadow:"0 4px 20px rgba(0,0,0,0.1)",display:"flex",flexDirection:"column",zIndex:1,minHeight:"0",width:"100%"},children:[window.innerWidth<=768&&r.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"10px",marginBottom:"15px"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"10px",background:"rgba(255,255,255,0.8)",borderRadius:"10px",fontSize:"14px",position:"relative",zIndex:1},children:[r.jsxs("div",{style:{fontWeight:"bold"},children:[h("score"),"：",s]}),r.jsx("div",{style:{display:"flex",gap:"8px"},children:p.map(S=>r.jsx("button",{onClick:()=>l(S.id),style:{padding:"4px 8px",borderRadius:"6px",border:a===S.id?"2px solid #4CAF50":"1px solid #ddd",background:a===S.id?"#e8f5e8":"#fff",cursor:"pointer",fontSize:"12px"},children:S.emoji},S.id))})]}),r.jsx("div",{style:{display:"flex",justifyContent:"center"},children:r.jsx("button",{onClick:()=>u(!c),style:{background:"#4CAF50",color:"#fff",border:"none",borderRadius:"15px",padding:"6px 16px",fontSize:"12px",cursor:"pointer"},children:h(c?"hideRules":"rules")})}),c&&r.jsxs("div",{style:{background:"rgba(255,255,255,0.9)",borderRadius:"10px",padding:"12px",fontSize:"11px",lineHeight:"1.3",textAlign:"left"},children:[r.jsxs("h4",{style:{marginBottom:"6px",color:"#333"},children:["🎯 ",h("gameRules"),"："]}),r.jsxs("p",{style:{marginBottom:"4px"},children:[r.jsx("strong",{children:"種植："}),"選擇種子 → 點擊空地種植"]}),r.jsxs("p",{style:{marginBottom:"4px"},children:[r.jsx("strong",{children:"收穫："}),"點擊成熟作物收穫"]}),r.jsxs("p",{style:{marginBottom:"4px"},children:[r.jsx("strong",{children:"分數："}),"種植+10~25分，收穫+50~125分"]}),r.jsxs("p",{style:{marginBottom:"4px"},children:[r.jsx("strong",{children:"時間："}),"3~8秒成熟"]})]})]}),r.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(10, 1fr)",gridTemplateRows:"repeat(7, 1fr)",gap:"clamp(5px, 1vw, 10px)",width:"100%",height:"fit-content",minHeight:"0",overflow:"visible"},children:Array.from({length:70},(S,w)=>{const I=w%10,j=Math.floor(w/10),A=x(I,j),D=A?p.find(P=>P.id===A.type):null,O=A&&A.growth>=100;return r.jsx("div",{onClick:()=>{A&&O?b(A.id):A||f(I,j)},style:{background:A?O?"#4CAF50":"#8BC34A":"#DEB887",border:"2px solid #A0522D",borderRadius:"8px",display:"flex",alignItems:"center",justifyContent:"center",cursor:A&&!O?"not-allowed":"pointer",fontSize:A?"clamp(1.5rem, 4vw, 2rem)":"clamp(0.8rem, 2vw, 1rem)",transition:"all 0.3s ease",position:"relative",aspectRatio:"1",boxShadow:A?"0 2px 8px rgba(0,0,0,0.2)":"none",opacity:A&&!O?.7:1},children:A?r.jsx("div",{style:{fontSize:O?"clamp(1.5rem, 4vw, 2rem)":"clamp(0.8rem, 2vw, 1rem)",opacity:A.growth/100},children:D==null?void 0:D.emoji}):r.jsx("span",{style:{color:"#8B4513",fontSize:"1.5em"},children:"+"})},w)})})]})]})})}function E5({onClose:n}){const{lang:e}=Qe(),[t,i]=g.useState(0),[s,o]=g.useState(30),[a,l]=g.useState(!1),[c,u]=g.useState(null),h=g.useRef({}),p=H=>{var ee;const L={"zh-TW":{start:"開始遊戲",restart:"重新開始",score:"分數",time:"時間",level:"等級",hits:"擊中",accuracy:"準確率",combo:"連擊",highScore:"最高分",highCombo:"最高連擊",title:"打地鼠",rules:"遊戲規則",close:"關閉",gameOver:"遊戲結束",finalScore:"最終分數",basicGameplay:"基本玩法",scoreSystem:"分數系統",levelSystem:"等級系統",clickMole:"點擊出現的地鼠",getScore:"獲得分數",gameTime:"遊戲時間",seconds:"秒",moleSpeed:"地鼠出現時間會隨等級縮短",baseScore:"基礎分數",points:"分",levelBonus:"等級獎勵",perLevel:"每級",comboBonus:"連擊獎勵",per3Combo:"每3連擊",level1:"1級",level2:"2級",level3:"3級",level4:"4級",molesFaster:"地鼠更快",moreFrequent:"更頻繁",extremeSpeed:"極限速度"},"zh-CN":{start:"开始游戏",restart:"重新开始",score:"分数",time:"时间",level:"等级",hits:"击中",accuracy:"准确率",combo:"连击",highScore:"最高分",highCombo:"最高连击",title:"打地鼠",rules:"游戏规则",close:"关闭",basicGameplay:"基本玩法",scoreSystem:"分数系统",levelSystem:"等级系统",clickMole:"点击出现的地鼠",getScore:"获得分数",gameTime:"游戏时间",seconds:"秒",moleSpeed:"地鼠出现时间会随等级缩短",baseScore:"基础分数",points:"分",levelBonus:"等级奖励",perLevel:"每级",comboBonus:"连击奖励",per3Combo:"每3连击",level1:"1级",level2:"2级",level3:"3级",level4:"4级",molesFaster:"地鼠更快",moreFrequent:"更频繁",extremeSpeed:"极限速度"},en:{start:"Start Game",restart:"Restart",score:"Score",time:"Time",level:"Level",hits:"Hits",accuracy:"Accuracy",combo:"Combo",highScore:"High Score",highCombo:"High Combo",title:"Whack-a-Mole",rules:"Game Rules",close:"Close",basicGameplay:"Basic Gameplay",scoreSystem:"Score System",levelSystem:"Level System",clickMole:"Click appearing moles",getScore:"to get points",gameTime:"Game Time",seconds:"seconds",moleSpeed:"Mole appearance time shortens with level",baseScore:"Base Score",points:"points",levelBonus:"Level Bonus",perLevel:"per level",comboBonus:"Combo Bonus",per3Combo:"per 3 combos",level1:"Level 1",level2:"Level 2",level3:"Level 3",level4:"Level 4",molesFaster:"moles faster",moreFrequent:"more frequent",extremeSpeed:"extreme speed"},ja:{start:"ゲーム開始",restart:"再開",score:"スコア",time:"時間",level:"レベル",hits:"ヒット",accuracy:"精度",combo:"コンボ",highScore:"ハイスコア",highCombo:"ハイコンボ",title:"モグラたたき",rules:"ゲームルール",close:"閉じる",basicGameplay:"基本プレイ",scoreSystem:"スコアシステム",levelSystem:"レベルシステム",clickMole:"現れるモグラをクリック",getScore:"してポイントを獲得",gameTime:"ゲーム時間",seconds:"秒",moleSpeed:"モグラの出現時間はレベルに応じて短縮",baseScore:"ベーススコア",points:"ポイント",levelBonus:"レベルボーナス",perLevel:"レベルごと",comboBonus:"コンボボーナス",per3Combo:"3コンボごと",level1:"レベル1",level2:"レベル2",level3:"レベル3",level4:"レベル4",molesFaster:"モグラがより速く",moreFrequent:"より頻繁に",extremeSpeed:"極限速度"},ko:{start:"게임 시작",restart:"다시 시작",score:"점수",time:"시간",level:"레벨",hits:"타격",accuracy:"정확도",combo:"콤보",highScore:"최고 점수",highCombo:"최고 콤보",title:"두더지 잡기",rules:"게임 규칙",close:"닫기",basicGameplay:"기본 플레이",scoreSystem:"점수 시스템",levelSystem:"레벨 시스템",clickMole:"나타나는 두더지를 클릭",getScore:"하여 점수 획득",gameTime:"게임 시간",seconds:"초",moleSpeed:"두더지 출현 시간은 레벨에 따라 단축",baseScore:"기본 점수",points:"점",levelBonus:"레벨 보너스",perLevel:"레벨당",comboBonus:"콤보 보너스",per3Combo:"3콤보당",level1:"레벨 1",level2:"레벨 2",level3:"레벨 3",level4:"레벨 4",molesFaster:"두더지가 더 빠르게",moreFrequent:"더 자주",extremeSpeed:"극한 속도"},vi:{start:"Bắt Đầu Trò Chơi",restart:"Chơi Lại",score:"Điểm",time:"Thời Gian",level:"Cấp Độ",hits:"Trúng",accuracy:"Độ Chính Xác",combo:"Combo",highScore:"Điểm Cao Nhất",highCombo:"Combo Cao Nhất",title:"Đập Chuột",rules:"Luật Chơi",close:"Đóng",basicGameplay:"Cách Chơi Cơ Bản",scoreSystem:"Hệ Thống Điểm",levelSystem:"Hệ Thống Cấp Độ",clickMole:"Nhấp vào chuột xuất hiện",getScore:"để nhận điểm",gameTime:"Thời Gian Chơi",seconds:"giây",moleSpeed:"Thời gian xuất hiện chuột rút ngắn theo cấp độ",baseScore:"Điểm Cơ Bản",points:"điểm",levelBonus:"Thưởng Cấp Độ",perLevel:"mỗi cấp",comboBonus:"Thưởng Combo",per3Combo:"mỗi 3 combo",level1:"Cấp 1",level2:"Cấp 2",level3:"Cấp 3",level4:"Cấp 4",molesFaster:"chuột nhanh hơn",moreFrequent:"thường xuyên hơn",extremeSpeed:"tốc độ cực hạn"},th:{start:"เริ่มเกม",restart:"เริ่มใหม่",score:"คะแนน",time:"เวลา",level:"ระดับ",hits:"ตีถูก",accuracy:"ความแม่นยำ",combo:"คอมโบ",highScore:"คะแนนสูงสุด",highCombo:"คอมโบสูงสุด",title:"ตีตุ่น",rules:"กฎเกม",close:"ปิด",basicGameplay:"วิธีเล่นพื้นฐาน",scoreSystem:"ระบบคะแนน",levelSystem:"ระบบระดับ",clickMole:"คลิกตุ่นที่ปรากฏ",getScore:"เพื่อได้คะแนน",gameTime:"เวลาเกม",seconds:"วินาที",moleSpeed:"เวลาปรากฏของตุ่นจะสั้นลงตามระดับ",baseScore:"คะแนนพื้นฐาน",points:"คะแนน",levelBonus:"โบนัสระดับ",perLevel:"ต่อระดับ",comboBonus:"โบนัสคอมโบ",per3Combo:"ต่อ 3 คอมโบ",level1:"ระดับ 1",level2:"ระดับ 2",level3:"ระดับ 3",level4:"ระดับ 4",molesFaster:"ตุ่นเร็วขึ้น",moreFrequent:"บ่อยขึ้น",extremeSpeed:"ความเร็วสุดขีด"},la:{start:"Ludum Incipere",restart:"Iterum Incipere",score:"Puncta",time:"Tempus",level:"Gradus",hits:"Ictus",accuracy:"Accuratio",combo:"Combo",highScore:"Puncta Maxima",highCombo:"Combo Maxima",title:"Talpa Percutere",rules:"Regulae Ludi",close:"Claudere",basicGameplay:"Ludus Basicus",scoreSystem:"Systema Punctorum",levelSystem:"Systema Gradus",clickMole:"Clicca talpam apparentem",getScore:"ut puncta accipias",gameTime:"Tempus Ludi",seconds:"secundis",moleSpeed:"Tempus apparentiae talpae cum gradu brevior fit",baseScore:"Puncta Basica",points:"puncta",levelBonus:"Bonus Gradus",perLevel:"per gradum",comboBonus:"Bonus Combo",per3Combo:"per 3 combos",level1:"Gradus 1",level2:"Gradus 2",level3:"Gradus 3",level4:"Gradus 4",molesFaster:"talpae velociores",moreFrequent:"frequentiores",extremeSpeed:"velocitas extrema"},ms:{start:"Mulakan Permainan",restart:"Mulakan Semula",score:"Markah",time:"Masa",level:"Tahap",hits:"Pukulan",accuracy:"Ketepatan",combo:"Combo",highScore:"Markah Tertinggi",highCombo:"Combo Tertinggi",title:"Pukul Tikus",rules:"Peraturan Permainan",close:"Tutup",basicGameplay:"Cara Bermain Asas",scoreSystem:"Sistem Markah",levelSystem:"Sistem Tahap",clickMole:"Klik tikus yang muncul",getScore:"untuk dapat markah",gameTime:"Masa Permainan",seconds:"saat",moleSpeed:"Masa kemunculan tikus memendek dengan tahap",baseScore:"Markah Asas",points:"markah",levelBonus:"Bonus Tahap",perLevel:"setiap tahap",comboBonus:"Bonus Combo",per3Combo:"setiap 3 combo",level1:"Tahap 1",level2:"Tahap 2",level3:"Tahap 3",level4:"Tahap 4",molesFaster:"tikus lebih cepat",moreFrequent:"lebih kerap",extremeSpeed:"kelajuan melampau"}};return((ee=L[e])==null?void 0:ee[H])||L["zh-TW"][H]||H},[f,b]=g.useState(0),[x,S]=g.useState(1),[w,I]=g.useState(0),[j,A]=g.useState(0),[D,O]=g.useState(!1),[P,B]=g.useState(0),[k,T]=g.useState(0),[R,E]=g.useState(0);g.useEffect(()=>{const H=Ka("whackAMole");H&&b(H.highScore||0)},[]),g.useEffect(()=>{t>f&&(b(t),Ga("whackAMole",{highScore:t}))},[t,f]),g.useEffect(()=>{const H=w+j;if(H>0){const L=w/H;x===1&&L>=.7?S(2):x===2&&L>=.6?S(3):x===3&&L>=.5&&S(4)}},[w,j,x]);const _=()=>t<0?"😅 負分？地鼠在笑你！":t<50?"🐹 新手地鼠獵人！":t<100?"🎯 有點手感了！":t<200?"⚡ 地鼠殺手！":t<300?"🔥 地鼠剋星！":t<500?"💪 地鼠終結者！":"👑 地鼠之王！";g.useEffect(()=>{},[x]),g.useEffect(()=>{const H=w+j;H>0&&E(Math.round(w/H*100))},[w,j]);const v=()=>{l(!0),i(0),o(30),S(1),I(0),A(0),B(0),T(0),E(0),u(null);let H,L;H=setInterval(()=>{o(ee=>ee<=1?(clearInterval(H),clearInterval(L),l(!1),0):ee-1)},1e3),setTimeout(()=>{const ee=Math.floor(Math.random()*9);u(ee);const oe=setTimeout(()=>{u(null),A(Ie=>Ie+1),i(Ie=>Ie-1),B(0)},x===1?900:x===2?700:x===3?500:350);h.current[ee]=oe},300),L=setInterval(()=>{const ee=Math.floor(Math.random()*9);u(ee);const oe=setTimeout(()=>{u(null),A(Ie=>Ie+1),i(Ie=>Ie-1),B(0)},x===1?900:x===2?700:x===3?500:350);h.current[ee]=oe},x===1?1100:x===2?900:x===3?700:500)},z=H=>{c===H?(i(L=>L+1),I(L=>L+1),B(L=>{const ee=L+1;return ee>k&&T(ee),ee}),u(null),h.current[H]&&(clearTimeout(h.current[H]),h.current[H]=null)):(i(L=>L-1),B(0))};return r.jsxs("div",{style:{height:"100vh",background:"linear-gradient(180deg, #8B4513 0%, #A0522D 100%)",padding:"clamp(10px, 2vw, 20px)",display:"flex",flexDirection:"column",alignItems:"center",position:"relative"},children:[r.jsx("button",{onClick:n,style:{position:"absolute",top:"clamp(20px, 4vw, 40px)",left:"clamp(20px, 4vw, 40px)",background:"#fff",border:"2px solid #6B5BFF",borderRadius:"50%",width:"clamp(40px, 8vw, 50px)",height:"clamp(40px, 8vw, 50px)",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",zIndex:20,fontSize:"clamp(1.2rem, 3vw, 1.5rem)",color:"#6B5BFF"},children:"←"}),r.jsxs("div",{style:{background:"rgba(255,255,255,0.9)",borderRadius:"15px",padding:"clamp(10px, 2vw, 15px)",marginTop:"clamp(60px, 12vw, 80px)",marginBottom:"clamp(8px, 1.5vw, 15px)",textAlign:"center",width:"100%",maxWidth:"300px"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"10px"},children:[r.jsxs("h2",{style:{fontSize:"clamp(1.5rem, 4vw, 2rem)",margin:0},children:["🔨 ",p("title")]}),r.jsx("button",{onClick:()=>O(!D),style:{background:"#4CAF50",color:"#fff",border:"none",borderRadius:"20px",padding:"5px 15px",fontSize:"clamp(0.8rem, 2vw, 1rem)",cursor:"pointer"},children:p(D?"close":"rules")})]}),D&&r.jsxs("div",{style:{background:"rgba(255,255,255,0.8)",borderRadius:"10px",padding:"10px",marginBottom:"10px",textAlign:"left",fontSize:"clamp(0.7rem, 1.8vw, 0.8rem)",lineHeight:"1.3"},children:[r.jsxs("h4",{style:{marginBottom:"8px",color:"#333"},children:["🎯 ",p("rules"),"："]}),r.jsx("p",{style:{marginBottom:"6px"},children:r.jsxs("strong",{children:[p("basicGameplay"),"："]})}),r.jsxs("p",{style:{marginBottom:"6px"},children:["• ",p("clickMole")," 🐹 ",p("getScore")]}),r.jsxs("p",{style:{marginBottom:"6px"},children:["• ",p("gameTime"),"：30",p("seconds")]}),r.jsxs("p",{style:{marginBottom:"6px"},children:["• ",p("moleSpeed")]}),r.jsx("p",{style:{marginBottom:"6px",marginTop:"8px"},children:r.jsxs("strong",{children:[p("scoreSystem"),"："]})}),r.jsx("p",{style:{marginBottom:"6px"},children:"• 點擊到地鼠身上 → +1分"}),r.jsx("p",{style:{marginBottom:"6px"},children:"• 地鼠消失時沒有點擊 → -1分"}),r.jsx("p",{style:{marginBottom:"6px"},children:"• 地鼠消失後才點擊 → -1分"}),r.jsx("p",{style:{marginBottom:"6px"},children:"• 點擊地鼠坑但沒點擊到地鼠 → -1分"}),r.jsx("p",{style:{marginBottom:"6px"},children:"• 從0分開始，無正負限制"}),r.jsx("p",{style:{marginBottom:"6px",marginTop:"8px"},children:r.jsxs("strong",{children:[p("levelSystem"),"："]})}),r.jsx("p",{style:{marginBottom:"6px"},children:"• 1級：70%成功 → 2級（地鼠更快）"}),r.jsx("p",{style:{marginBottom:"6px"},children:"• 2級：60%成功 → 3級（更頻繁）"}),r.jsx("p",{style:{marginBottom:"6px"},children:"• 3級：50%成功 → 4級（極限速度）"}),r.jsx("p",{style:{marginBottom:"6px"},children:"• 成功率基於30秒內的成功比率計算"})]}),!D&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{style:{display:"flex",gap:"clamp(6px, 1.5vw, 12px)",justifyContent:"center",flexWrap:"wrap",marginBottom:"8px"},children:[r.jsxs("div",{style:{fontSize:"clamp(0.8rem, 2.2vw, 1rem)"},children:[p("score"),"：",t]}),r.jsxs("div",{style:{fontSize:"clamp(0.8rem, 2.2vw, 1rem)"},children:[p("time"),"：",s,"秒"]}),r.jsxs("div",{style:{fontSize:"clamp(0.8rem, 2.2vw, 1rem)"},children:[p("level"),"：",x]})]}),r.jsxs("div",{style:{display:"flex",gap:"clamp(6px, 1.5vw, 12px)",justifyContent:"center",flexWrap:"wrap",marginBottom:"8px"},children:[r.jsxs("div",{style:{fontSize:"clamp(0.7rem, 1.8vw, 0.9rem)"},children:[p("hits"),"：",w]}),r.jsxs("div",{style:{fontSize:"clamp(0.7rem, 1.8vw, 0.9rem)"},children:[p("accuracy"),"：",R,"%"]}),r.jsxs("div",{style:{fontSize:"clamp(0.7rem, 1.8vw, 0.9rem)"},children:[p("combo"),"：",P]})]}),r.jsxs("div",{style:{display:"flex",gap:"clamp(6px, 1.5vw, 12px)",justifyContent:"center",flexWrap:"wrap"},children:[r.jsxs("div",{style:{fontSize:"clamp(0.7rem, 1.8vw, 0.9rem)"},children:[p("highScore"),"：",f]}),r.jsxs("div",{style:{fontSize:"clamp(0.7rem, 1.8vw, 0.9rem)"},children:[p("highCombo"),"：",k]})]}),r.jsx("div",{style:{fontSize:"clamp(0.8rem, 2vw, 1rem)",color:"#FF5722",fontWeight:"bold",marginTop:"8px",textAlign:"center"},children:_()}),!a&&r.jsx("button",{onClick:v,style:{background:"#FF5722",color:"#fff",border:"none",borderRadius:"25px",padding:"clamp(6px, 1.5vw, 8px) clamp(16px, 3vw, 24px)",fontSize:"clamp(0.9rem, 2.2vw, 1rem)",fontWeight:"bold",marginTop:"10px",cursor:"pointer",transition:"all 0.3s ease"},children:p(s===30?"start":"restart")})]})]}),!D&&r.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"clamp(8px, 1.5vw, 15px)",maxWidth:"300px",width:"100%",marginTop:"10px",padding:"clamp(10px, 2vw, 15px)",background:"rgba(255,255,255,0.9)",borderRadius:"15px",boxSizing:"border-box"},children:Array.from({length:9},(H,L)=>r.jsx("div",{onClick:()=>z(L),style:{width:"clamp(60px, 10vw, 80px)",height:"clamp(60px, 10vw, 80px)",background:"#654321",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",border:"3px solid #8B4513",position:"relative",overflow:"hidden"},children:c===L&&r.jsx("div",{style:{position:"absolute",bottom:"0",width:"100%",height:"60%",background:"#8B4513",borderRadius:"50% 50% 0 0",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"clamp(1.5rem, 4vw, 2rem)",animation:"molePop 0.3s ease-out",cursor:"pointer"},children:"🐹"})},L))}),r.jsx("style",{children:`
        @keyframes molePop {
          0% { transform: translateY(100%); }
          100% { transform: translateY(0); }
        }
        
        @keyframes whack {
          0% { transform: scale(1); }
          50% { transform: scale(0.8); }
          100% { transform: scale(1); }
        }
        
        @keyframes scorePop {
          0% { opacity: 0; transform: translateY(0); }
          50% { opacity: 1; transform: translateY(-20px); }
          100% { opacity: 0; transform: translateY(-40px); }
        }
      `})]})}function B5({onClose:n}){const{lang:e}=Qe(),[t,i]=g.useState(0),[s,o]=g.useState([]),a=z=>{var L;const H={"zh-TW":{title:"採水果",start:"開始遊戲",restart:"重新開始",score:"分數",time:"時間",level:"等級",collected:"收集",highScore:"最高分",rules:"遊戲規則",close:"關閉",hideRules:"隱藏規則",basicGameplay:"基本玩法",scoreSystem:"分數系統",levelSystem:"等級系統",tips:"技巧提示",newFeatures:"新增功能",gameOver:"遊戲結束",clickFruit:"點擊掉落的水果收集分數",putFruitInBasket:"把採到的水果裝進下面的水果籃裡",gameTime:"遊戲時間",seconds:"秒",fruitSpeed:"水果會不定向掉落且速度加快",apple:"蘋果",orange:"橘子",banana:"香蕉",strawberry:"草莓",grape:"葡萄",peach:"桃子",points:"分",level1:"1級",level2:"2級",level3:"3級",level4:"4級",fruitFaster:"水果更快",moreFrequent:"更頻繁",extremeSpeed:"極限速度",prioritizeHighScore:"優先收集高分水果",stayFocused:"保持專注，快速反應",buildHighScore:"建立高分記錄",fruitFromFourDirections:"水果會從四個方向隨機出現",curvedTrajectory:"水果掉落時會呈現彎曲動線",realTimeFeedback:"遊戲中會顯示即時收集反饋",detailedStats:"遊戲結束時顯示詳細統計",fixedBasketPosition:"籃子位置完全固定不震動",increasedFrequency:"水果出現頻率大幅提升"},"zh-CN":{title:"采水果",start:"开始游戏",restart:"重新开始",score:"分数",time:"时间",level:"等级",collected:"收集",highScore:"最高分",rules:"游戏规则",close:"关闭",hideRules:"隐藏规则",basicGameplay:"基本玩法",scoreSystem:"分数系统",levelSystem:"等级系统",tips:"技巧提示",newFeatures:"新增功能",clickFruit:"点击掉落的水果收集分数",putFruitInBasket:"把采到的水果装进下面的水果篮里",gameTime:"游戏时间",seconds:"秒",fruitSpeed:"水果会不定向掉落且速度加快",apple:"苹果",orange:"橘子",banana:"香蕉",strawberry:"草莓",grape:"葡萄",peach:"桃子",points:"分",level1:"1级",level2:"2级",level3:"3级",level4:"4级",fruitFaster:"水果更快",moreFrequent:"更频繁",extremeSpeed:"极限速度",prioritizeHighScore:"优先收集高分水果",stayFocused:"保持专注，快速反应",buildHighScore:"建立高分记录",fruitFromFourDirections:"水果会从四个方向随机出现",curvedTrajectory:"水果掉落时会呈现弯曲动线",realTimeFeedback:"游戏中会显示即时收集反馈",detailedStats:"游戏结束时显示详细统计",fixedBasketPosition:"篮子位置完全固定不震动",increasedFrequency:"水果出现频率大幅提升"},en:{title:"Fruit Picking",start:"Start Game",restart:"Restart",score:"Score",time:"Time",level:"Level",collected:"Collected",highScore:"High Score",rules:"Game Rules",close:"Close",hideRules:"Hide Rules",basicGameplay:"Basic Gameplay",scoreSystem:"Score System",levelSystem:"Level System",tips:"Tips",newFeatures:"New Features",clickFruit:"Click falling fruit to collect points",putFruitInBasket:"Put collected fruit into the basket below",gameTime:"Game Time",seconds:"seconds",fruitSpeed:"Fruit will fall randomly and speed up",apple:"Apple",orange:"Orange",banana:"Banana",strawberry:"Strawberry",grape:"Grape",peach:"Peach",points:"points",level1:"Level 1",level2:"Level 2",level3:"Level 3",level4:"Level 4",fruitFaster:"fruit faster",moreFrequent:"more frequent",extremeSpeed:"extreme speed",prioritizeHighScore:"Prioritize high-score fruits",stayFocused:"Stay focused, react quickly",buildHighScore:"Build high score records",fruitFromFourDirections:"Fruit appears from four directions randomly",curvedTrajectory:"Fruit falls with curved trajectories",realTimeFeedback:"Real-time collection feedback during game",detailedStats:"Detailed statistics when game ends",fixedBasketPosition:"Basket position completely fixed without vibration",increasedFrequency:"Significantly increased fruit appearance frequency"},ja:{title:"フルーツ収穫",start:"ゲーム開始",restart:"再開",score:"スコア",time:"時間",level:"レベル",collected:"収穫",highScore:"ハイスコア",rules:"ゲームルール",close:"閉じる",hideRules:"ルール非表示",basicGameplay:"基本ゲームプレイ",scoreSystem:"スコアシステム",levelSystem:"レベルシステム",tips:"ヒント",newFeatures:"新機能",clickFruit:"落ちる果物をクリックしてポイントを獲得",putFruitInBasket:"収穫した果物を下のバスケットに入れる",gameTime:"ゲーム時間",seconds:"秒",fruitSpeed:"果物はランダムに落ちて速度が上がる",apple:"りんご",orange:"みかん",banana:"バナナ",strawberry:"いちご",grape:"ぶどう",peach:"もも",points:"ポイント",level1:"レベル1",level2:"レベル2",level3:"レベル3",level4:"レベル4",fruitFaster:"果物がより速く",moreFrequent:"より頻繁に",extremeSpeed:"極限速度",prioritizeHighScore:"高得点の果物を優先",stayFocused:"集中して素早く反応",buildHighScore:"高得点記録を築く",fruitFromFourDirections:"果物は4方向からランダムに出現",curvedTrajectory:"果物は曲線軌道で落下",realTimeFeedback:"ゲーム中のリアルタイム収穫フィードバック",detailedStats:"ゲーム終了時の詳細統計",fixedBasketPosition:"バスケット位置は完全固定で震動なし",increasedFrequency:"果物出現頻度が大幅に向上"},ko:{title:"과일 수확",start:"게임 시작",restart:"다시 시작",score:"점수",time:"시간",level:"레벨",collected:"수확",highScore:"최고 점수",rules:"게임 규칙",close:"닫기",hideRules:"규칙 숨기기",basicGameplay:"기본 게임플레이",scoreSystem:"점수 시스템",levelSystem:"레벨 시스템",tips:"팁",newFeatures:"새 기능",clickFruit:"떨어지는 과일을 클릭하여 점수 획득",putFruitInBasket:"수확한 과일을 아래 바구니에 넣기",gameTime:"게임 시간",seconds:"초",fruitSpeed:"과일이 무작위로 떨어지고 속도가 빨라짐",apple:"사과",orange:"귤",banana:"바나나",strawberry:"딸기",grape:"포도",peach:"복숭아",points:"점",level1:"레벨 1",level2:"레벨 2",level3:"레벨 3",level4:"레벨 4",fruitFaster:"과일이 더 빠르게",moreFrequent:"더 자주",extremeSpeed:"극한 속도",prioritizeHighScore:"고점수 과일 우선 수집",stayFocused:"집중하고 빠르게 반응",buildHighScore:"고점수 기록 구축",fruitFromFourDirections:"과일이 네 방향에서 무작위로 나타남",curvedTrajectory:"과일이 곡선 궤적으로 떨어짐",realTimeFeedback:"게임 중 실시간 수확 피드백",detailedStats:"게임 종료 시 상세 통계",fixedBasketPosition:"바구니 위치 완전 고정으로 진동 없음",increasedFrequency:"과일 출현 빈도 대폭 증가"},vi:{title:"Hái Trái Cây",start:"Bắt Đầu Trò Chơi",restart:"Chơi Lại",score:"Điểm",time:"Thời Gian",level:"Cấp Độ",collected:"Thu Hoạch",highScore:"Điểm Cao Nhất",rules:"Luật Chơi",close:"Đóng",hideRules:"Ẩn Luật",basicGameplay:"Cách Chơi Cơ Bản",scoreSystem:"Hệ Thống Điểm",levelSystem:"Hệ Thống Cấp Độ",tips:"Mẹo",newFeatures:"Tính Năng Mới",clickFruit:"Nhấp vào trái cây rơi để nhận điểm",putFruitInBasket:"Đặt trái cây thu hoạch vào giỏ bên dưới",gameTime:"Thời Gian Chơi",seconds:"giây",fruitSpeed:"Trái cây sẽ rơi ngẫu nhiên và tăng tốc",apple:"Táo",orange:"Cam",banana:"Chuối",strawberry:"Dâu tây",grape:"Nho",peach:"Đào",points:"điểm",level1:"Cấp 1",level2:"Cấp 2",level3:"Cấp 3",level4:"Cấp 4",fruitFaster:"trái cây nhanh hơn",moreFrequent:"thường xuyên hơn",extremeSpeed:"tốc độ cực hạn",prioritizeHighScore:"Ưu tiên trái cây điểm cao",stayFocused:"Tập trung, phản ứng nhanh",buildHighScore:"Xây dựng kỷ lục điểm cao",fruitFromFourDirections:"Trái cây xuất hiện từ bốn hướng ngẫu nhiên",curvedTrajectory:"Trái cây rơi theo quỹ đạo cong",realTimeFeedback:"Phản hồi thu hoạch thời gian thực trong game",detailedStats:"Thống kê chi tiết khi kết thúc game",fixedBasketPosition:"Vị trí giỏ hoàn toàn cố định không rung",increasedFrequency:"Tần suất xuất hiện trái cây tăng đáng kể"},th:{title:"เก็บผลไม้",start:"เริ่มเกม",restart:"เริ่มใหม่",score:"คะแนน",time:"เวลา",level:"ระดับ",collected:"เก็บ",highScore:"คะแนนสูงสุด",rules:"กฎเกม",close:"ปิด",hideRules:"ซ่อนกฎ",basicGameplay:"การเล่นพื้นฐาน",scoreSystem:"ระบบคะแนน",levelSystem:"ระบบระดับ",tips:"เคล็ดลับ",newFeatures:"คุณสมบัติใหม่",clickFruit:"คลิกผลไม้ที่ตกลงมาเพื่อได้คะแนน",putFruitInBasket:"ใส่ผลไม้ที่เก็บได้ลงในตะกร้าข้างล่าง",gameTime:"เวลาเกม",seconds:"วินาที",fruitSpeed:"ผลไม้จะตกลงมาแบบสุ่มและเร็วขึ้น",apple:"แอปเปิ้ล",orange:"ส้ม",banana:"กล้วย",strawberry:"สตรอเบอร์รี่",grape:"องุ่น",peach:"พีช",points:"คะแนน",level1:"ระดับ 1",level2:"ระดับ 2",level3:"ระดับ 3",level4:"ระดับ 4",fruitFaster:"ผลไม้เร็วขึ้น",moreFrequent:"บ่อยขึ้น",extremeSpeed:"ความเร็วสุดขีด",prioritizeHighScore:"ให้ความสำคัญกับผลไม้คะแนนสูง",stayFocused:"มีสมาธิและตอบสนองเร็ว",buildHighScore:"สร้างสถิติคะแนนสูง",fruitFromFourDirections:"ผลไม้ปรากฏจากสี่ทิศทางแบบสุ่ม",curvedTrajectory:"ผลไม้ตกลงมาด้วยวิถีโค้ง",realTimeFeedback:"การตอบสนองการเก็บเกี่ยวแบบเรียลไทม์ในเกม",detailedStats:"สถิติรายละเอียดเมื่อเกมจบ",fixedBasketPosition:"ตำแหน่งตะกร้าคงที่โดยไม่สั่น",increasedFrequency:"ความถี่การปรากฏของผลไม้เพิ่มขึ้นอย่างมาก"},la:{title:"Fructus Colligere",start:"Ludum Incipere",restart:"Iterum Incipere",score:"Puncta",time:"Tempus",level:"Gradus",collected:"Collecta",highScore:"Puncta Maxima",rules:"Regulae Ludi",close:"Claudere",hideRules:"Regulae Occultare",basicGameplay:"Ludus Basicus",scoreSystem:"Systema Punctorum",levelSystem:"Systema Graduum",tips:"Consilia",newFeatures:"Facultates Novae",clickFruit:"Clicca fructus cadentes ut puncta accipias",putFruitInBasket:"Pone fructus collectos in corbem infra",gameTime:"Tempus Ludi",seconds:"secundis",fruitSpeed:"Fructus cadent temere et velocitate crescente",apple:"Malum",orange:"Aurantium",banana:"Musa",strawberry:"Fragum",grape:"Uva",peach:"Persicum",points:"puncta",level1:"Gradus 1",level2:"Gradus 2",level3:"Gradus 3",level4:"Gradus 4",fruitFaster:"fructus velociores",moreFrequent:"frequentiores",extremeSpeed:"velocitas extrema",prioritizeHighScore:"Prioritiza fructus punctis altis",stayFocused:"Mane attentus, reage celeriter",buildHighScore:"Aedifica puncta alta",fruitFromFourDirections:"Fructus apparent ex quattuor directionibus temere",curvedTrajectory:"Fructus cadunt cum trajectoriis curvis",realTimeFeedback:"Feedback collectionis tempore reali in ludo",detailedStats:"Statisticae detaillatae cum ludus finitur",fixedBasketPosition:"Positio corbis omnino fixa sine vibratione",increasedFrequency:"Frequentia fructuum apparendi multum aucta"},ms:{title:"Kutip Buah",start:"Mulakan Permainan",restart:"Mulakan Semula",score:"Markah",time:"Masa",level:"Tahap",collected:"Kutip",highScore:"Markah Tertinggi",rules:"Peraturan Permainan",close:"Tutup",hideRules:"Sembunyikan Peraturan",basicGameplay:"Permainan Asas",scoreSystem:"Sistem Markah",levelSystem:"Sistem Tahap",tips:"Petua",newFeatures:"Ciri Baharu",clickFruit:"Klik buah yang jatuh untuk dapat markah",putFruitInBasket:"Letakkan buah yang dikutip ke dalam bakul di bawah",gameTime:"Masa Permainan",seconds:"saat",fruitSpeed:"Buah akan jatuh secara rawak dan laju bertambah",apple:"Epal",orange:"Oren",banana:"Pisang",strawberry:"Strawberi",grape:"Anggur",peach:"Pic",points:"markah",level1:"Tahap 1",level2:"Tahap 2",level3:"Tahap 3",level4:"Tahap 4",fruitFaster:"buah lebih cepat",moreFrequent:"lebih kerap",extremeSpeed:"kelajuan melampau",prioritizeHighScore:"Utamakan buah markah tinggi",stayFocused:"Kekal fokus, bertindak pantas",buildHighScore:"Bina rekod markah tinggi",fruitFromFourDirections:"Buah muncul dari empat arah secara rawak",curvedTrajectory:"Buah jatuh dengan trajektori melengkung",realTimeFeedback:"Maklum balas kutipan masa nyata semasa permainan",detailedStats:"Statistik terperinci apabila permainan tamat",fixedBasketPosition:"Kedudukan bakul tetap sepenuhnya tanpa getaran",increasedFrequency:"Kekerapan kemunculan buah meningkat dengan ketara"}};return((L=H[e])==null?void 0:L[z])||H["zh-TW"][z]||z},[l,c]=g.useState([]),[u,h]=g.useState({}),[p,f]=g.useState([]),[b,x]=g.useState(0),[S,w]=g.useState(!1),[I,j]=g.useState(30),[A,D]=g.useState(!1),[O,P]=g.useState(1),[B,k]=g.useState(0);g.useEffect(()=>{const z=Ka("fruitPicking");z&&x(z.highScore||0)},[]),g.useEffect(()=>{if(!A||s.length===0)return;const z=setInterval(()=>{o(H=>H.map(ee=>{const ge=ee.curveOffset||0,oe=ee.curveSpeed||.05,Ie=Date.now()*.001,Re=Math.sin(Ie*oe+ge)*4,te=Math.cos(Ie*oe+ge)*2,W=Math.sin(Ie*oe*2+ge)*2,Y=Math.cos(Ie*oe*1.5+ge)*1,X=Math.sin(Ie*oe*.5+ge)*3,le=Re+W+X,be=te+Y;return{...ee,y:ee.y+(ee.directionY||ee.speed||1)+be,x:ee.x+(ee.directionX||ee.direction||0)+le}}).filter(ee=>ee.y>-20&&ee.y<120&&ee.x>-20&&ee.x<120))},100);return()=>clearInterval(z)},[A,s.length]),g.useEffect(()=>{t>b&&(x(t),Ga("fruitPicking",{highScore:t}))},[t,b]),g.useEffect(()=>{t>=100&&O===1?P(2):t>=250&&O===2?P(3):t>=500&&O===3&&P(4)},[t,O]);const T=[{type:"apple",emoji:"🍎",points:10},{type:"orange",emoji:"🍊",points:15},{type:"banana",emoji:"🍌",points:20},{type:"strawberry",emoji:"🍓",points:25},{type:"grape",emoji:"🍇",points:30},{type:"peach",emoji:"🍑",points:35}],R=()=>{D(!0),i(0),j(30),P(1),k(0),c([]),o([]),h({}),f([]);let z,H;z=setInterval(()=>{j(L=>L<=1?(clearInterval(z),clearInterval(H),D(!1),0):L-1)},1e3),setTimeout(()=>{E(),H=setInterval(()=>{E(),O>=3&&setTimeout(()=>E(),200),O>=4&&setTimeout(()=>E(),400)},O===1?1200:O===2?800:O===3?600:400)},100)},E=()=>{const z=T[Math.floor(Math.random()*T.length)],H=O===1?1:O===2?1.5:O===3?2:2.5,L=Math.floor(Math.random()*4),ee=Math.random()<.3;let ge,oe,Ie,Re;switch(L){case 0:ge=Math.random()*80+10,oe=-10,Ie=(Math.random()-.5)*.3,Re=H;break;case 1:ge=Math.random()*80+10,oe=110,Ie=(Math.random()-.5)*.3,Re=-H;break;case 2:ge=-10,oe=Math.random()*80+10,Ie=H,Re=(Math.random()-.5)*.3;break;case 3:ge=110,oe=Math.random()*80+10,Ie=-H,Re=(Math.random()-.5)*.3;break;default:ge=Math.random()*80+10,oe=-10,Ie=(Math.random()-.5)*.3,Re=H}const te={id:Date.now()+Math.random(),x:ge,y:oe,type:z.type,emoji:z.emoji,speed:H,direction:0,directionX:Ie,directionY:Re,curveOffset:Math.random()*Math.PI*2,curveSpeed:Math.random()*.15+.08};if(o(W=>[...W,te]),ee){const W=T[Math.floor(Math.random()*T.length)],Y=Math.random()*80+10,le={id:Date.now()+Math.random()+1,x:Y,y:-10,type:W.type,emoji:W.emoji,speed:H,direction:0,directionX:(Math.random()-.5)*.3,directionY:H,curveOffset:Math.random()*Math.PI*2,curveSpeed:Math.random()*.15+.08};o(be=>[...be,le])}},_=z=>{const H=s.find(L=>L.id===z);if(H){const L=T.find(ee=>ee.type===H.type);o(ee=>ee.filter(ge=>ge.id!==z)),i(ee=>{const ge=ee+((L==null?void 0:L.points)||10);return ge>b&&x(ge),ge}),k(ee=>ee+1),c(ee=>[...ee,{type:H.type,emoji:H.emoji}]),h(ee=>{const ge={...ee};return ge[H.type]=(ge[H.type]||0)+1,ge}),f(ee=>ee.find(oe=>oe.type===H.type)?ee.map(oe=>oe.type===H.type?{...oe,count:oe.count+1}:oe):[...ee,{type:H.type,emoji:H.emoji,count:1}])}},v=()=>B<5?"😅 新手採果者！":B<10?"🍎 有點手感了！":B<15?"🍊 水果獵人！":B<20?"🍌 採果高手！":B<25?"🍓 水果大師！":"👑 採果之王！";return g.useEffect(()=>{if(p.length>0&&A){const z=setTimeout(()=>{f([])},3e3);return()=>clearTimeout(z)}},[p,A]),r.jsxs("div",{style:{height:"100vh",background:"linear-gradient(180deg, #87CEEB 0%, #98FB98 100%)",padding:"clamp(10px, 2vw, 20px)",position:"relative",overflow:"hidden",isolation:"isolate"},children:[r.jsx("button",{onClick:n,style:{position:"absolute",top:"clamp(20px, 4vw, 40px)",left:window.innerWidth>=768?"clamp(10px, 2vw, 15px)":"clamp(20px, 4vw, 40px)",background:"#fff",border:"2px solid #6B5BFF",borderRadius:"50%",width:"clamp(40px, 8vw, 50px)",height:"clamp(40px, 8vw, 50px)",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",zIndex:20,fontSize:"clamp(1.2rem, 3vw, 1.5rem)",color:"#6B5BFF"},children:"←"}),r.jsxs("div",{style:{position:"absolute",top:"clamp(20px, 4vw, 40px)",left:"clamp(60px, 12vw, 70px)",background:"rgba(255,255,255,0.9)",borderRadius:"15px",padding:"clamp(12px, 2.5vw, 16px)",zIndex:10,maxWidth:"180px"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"8px"},children:[r.jsxs("h3",{style:{fontSize:"clamp(1rem, 2.5vw, 1.2rem)",margin:0,lineHeight:"1.2"},children:["🍎 ",a("title")]}),r.jsx("button",{onClick:()=>w(!S),style:{background:"#4CAF50",color:"#fff",border:"none",borderRadius:"12px",padding:"2px 8px",fontSize:"clamp(0.6rem, 1.5vw, 0.7rem)",cursor:"pointer"},children:a(S?"hideRules":"rules")})]}),S&&r.jsxs("div",{style:{background:"rgba(255,255,255,0.8)",borderRadius:"10px",padding:"10px",marginBottom:"10px",textAlign:"left",fontSize:"clamp(0.7rem, 1.8vw, 0.8rem)",lineHeight:"1.3",maxHeight:"clamp(200px, 40vh, 300px)",overflowY:"auto",overflowX:"hidden",scrollbarWidth:"thin",scrollbarColor:"#4CAF50 #f0f0f0"},children:[r.jsxs("h4",{style:{marginBottom:"8px",color:"#333"},children:["🍎 ",a("rules"),"："]}),r.jsx("p",{style:{marginBottom:"6px"},children:r.jsxs("strong",{children:[a("basicGameplay"),"："]})}),r.jsxs("p",{style:{marginBottom:"6px"},children:["• ",a("clickFruit")]}),r.jsxs("p",{style:{marginBottom:"6px"},children:["• ",a("putFruitInBasket")]}),r.jsxs("p",{style:{marginBottom:"6px"},children:["• ",a("gameTime"),"：30",a("seconds")]}),r.jsxs("p",{style:{marginBottom:"6px"},children:["• ",a("fruitSpeed")]}),r.jsx("p",{style:{marginBottom:"6px",marginTop:"8px"},children:r.jsxs("strong",{children:[a("scoreSystem"),"："]})}),r.jsxs("p",{style:{marginBottom:"6px"},children:["• 🍎 ",a("apple"),"：10",a("points")]}),r.jsxs("p",{style:{marginBottom:"6px"},children:["• 🍊 ",a("orange"),"：15",a("points")]}),r.jsxs("p",{style:{marginBottom:"6px"},children:["• 🍌 ",a("banana"),"：20",a("points")]}),r.jsxs("p",{style:{marginBottom:"6px"},children:["• 🍓 ",a("strawberry"),"：25",a("points")]}),r.jsxs("p",{style:{marginBottom:"6px"},children:["• 🍇 ",a("grape"),"：30",a("points")]}),r.jsxs("p",{style:{marginBottom:"6px"},children:["• 🍑 ",a("peach"),"：35",a("points")]}),r.jsx("p",{style:{marginBottom:"6px",marginTop:"8px"},children:r.jsxs("strong",{children:[a("levelSystem"),"："]})}),r.jsxs("p",{style:{marginBottom:"6px"},children:["• ",a("level1"),"：100",a("points")," → ",a("level2"),"（",a("fruitFaster"),"）"]}),r.jsxs("p",{style:{marginBottom:"6px"},children:["• ",a("level2"),"：250",a("points")," → ",a("level3"),"（",a("moreFrequent"),"）"]}),r.jsxs("p",{style:{marginBottom:"6px"},children:["• ",a("level3"),"：500",a("points")," → ",a("level4"),"（",a("extremeSpeed"),"）"]}),r.jsx("p",{style:{marginBottom:"6px",marginTop:"8px"},children:r.jsxs("strong",{children:[a("tips"),"："]})}),r.jsxs("p",{style:{marginBottom:"6px"},children:["• ",a("prioritizeHighScore")]}),r.jsxs("p",{style:{marginBottom:"6px"},children:["• ",a("stayFocused")]}),r.jsxs("p",{style:{marginBottom:"6px"},children:["• ",a("buildHighScore")]}),r.jsx("p",{style:{marginBottom:"6px",marginTop:"8px"},children:r.jsxs("strong",{children:[a("newFeatures"),"："]})}),r.jsxs("p",{style:{marginBottom:"6px"},children:["• ",a("fruitFromFourDirections")]}),r.jsxs("p",{style:{marginBottom:"6px"},children:["• ",a("curvedTrajectory")]}),r.jsxs("p",{style:{marginBottom:"6px"},children:["• ",a("realTimeFeedback")]}),r.jsxs("p",{style:{marginBottom:"6px"},children:["• ",a("detailedStats")]}),r.jsxs("p",{style:{marginBottom:"6px"},children:["• ",a("fixedBasketPosition")]}),r.jsxs("p",{style:{marginBottom:"6px"},children:["• ",a("increasedFrequency")]})]}),!S&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{style:{display:"flex",gap:"clamp(4px, 1vw, 8px)",justifyContent:"center",flexWrap:"wrap",marginBottom:"6px"},children:[r.jsxs("div",{style:{fontSize:"clamp(0.7rem, 1.8vw, 0.85rem)"},children:[a("score"),"：",t]}),r.jsxs("div",{style:{fontSize:"clamp(0.7rem, 1.8vw, 0.85rem)"},children:[a("time"),"：",I,"秒"]}),r.jsxs("div",{style:{fontSize:"clamp(0.7rem, 1.8vw, 0.85rem)"},children:[a("level"),"：",O]})]}),r.jsxs("div",{style:{display:"flex",gap:"clamp(4px, 1vw, 8px)",justifyContent:"center",flexWrap:"wrap"},children:[r.jsxs("div",{style:{fontSize:"clamp(0.6rem, 1.5vw, 0.75rem)"},children:[a("collected"),"：",B,"個"]}),r.jsxs("div",{style:{fontSize:"clamp(0.6rem, 1.5vw, 0.75rem)"},children:[a("highScore"),"：",b]})]}),r.jsx("div",{style:{fontSize:"clamp(0.7rem, 1.8vw, 0.85rem)",color:"#FF5722",fontWeight:"bold",marginTop:"6px",textAlign:"center"},children:v()}),!A&&r.jsx("button",{onClick:R,style:{background:"#FF9800",color:"#fff",border:"none",borderRadius:"20px",padding:"clamp(5px, 1.2vw, 6px) clamp(12px, 2.5vw, 18px)",fontSize:"clamp(0.8rem, 2vw, 0.9rem)",fontWeight:"bold",marginTop:"8px",cursor:"pointer",transition:"all 0.3s ease"},children:a(I===30?"start":"restart")})]})]}),!A&&I===0&&r.jsx("div",{style:{position:"absolute",bottom:"clamp(120px, 20vw, 140px)",left:"50%",transform:"translateX(-50%)",display:"flex",gap:"15px",flexWrap:"wrap",justifyContent:"center",zIndex:10},children:Object.entries(u).map(([z,H])=>{const L=T.find(ee=>ee.type===z);return r.jsxs("div",{style:{position:"relative",display:"flex",flexDirection:"column",alignItems:"center",gap:"2px"},children:[r.jsx("span",{style:{fontSize:"clamp(2rem, 5vw, 3rem)",filter:"drop-shadow(0 2px 4px rgba(0,0,0,0.3))"},children:L==null?void 0:L.emoji}),r.jsx("span",{style:{position:"absolute",top:"-5px",right:"-5px",background:"#FF5722",color:"white",borderRadius:"50%",width:"clamp(20px, 4vw, 25px)",height:"clamp(20px, 4vw, 25px)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"clamp(0.6rem, 1.5vw, 0.8rem)",fontWeight:"bold",boxShadow:"0 2px 4px rgba(0,0,0,0.3)"},children:H})]},z)})}),r.jsx("div",{style:{position:"fixed",bottom:"clamp(10px, 2vw, 20px)",left:"50%",transform:"translateX(-50%)",display:"flex",alignItems:"flex-end",justifyContent:"center",zIndex:5,width:"clamp(200px, 30vw, 250px)",pointerEvents:"none",userSelect:"none",touchAction:"none",willChange:"auto",backfaceVisibility:"hidden",contain:"layout style paint",isolation:"isolate"},children:r.jsx("div",{style:{background:"#8B4513",width:"clamp(150px, 25vw, 200px)",height:"clamp(75px, 12vw, 100px)",borderRadius:"50% 50% 0 0",border:"4px solid #654321",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"clamp(1.5rem, 4vw, 2rem)",overflow:"hidden",position:"relative",zIndex:6,pointerEvents:"none",transform:"translateZ(0)",willChange:"auto",userSelect:"none",touchAction:"none",backfaceVisibility:"hidden",perspective:"none",transformStyle:"flat",contain:"layout style paint",isolation:"isolate"},children:l.length>0?r.jsxs("div",{style:{display:"flex",flexWrap:"wrap",justifyContent:"center",alignItems:"center",gap:"2px",maxWidth:"90%",maxHeight:"90%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",pointerEvents:"none",userSelect:"none",touchAction:"none",willChange:"auto",backfaceVisibility:"hidden"},children:[p.slice(-4).map((z,H)=>r.jsxs("span",{style:{fontSize:"clamp(0.8rem, 2vw, 1rem)",position:"relative"},children:[z.emoji,r.jsx("span",{style:{position:"absolute",top:"-8px",right:"-8px",background:"#FF5722",color:"white",borderRadius:"50%",width:"clamp(12px, 2.5vw, 16px)",height:"clamp(12px, 2.5vw, 16px)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"clamp(0.5rem, 1.2vw, 0.7rem)",fontWeight:"bold"},children:z.count})]},H)),p.length===0&&l.slice(-6).map((z,H)=>r.jsx("span",{style:{fontSize:"clamp(0.8rem, 2vw, 1rem)"},children:z.emoji},H)),l.length>6&&p.length===0&&r.jsxs("span",{style:{fontSize:"clamp(0.6rem, 1.5vw, 0.8rem)",color:"#fff"},children:["+",l.length-6]})]}):r.jsx("span",{style:{color:"#654321"},children:"🧺"})})}),s.map(z=>r.jsx("div",{onClick:H=>{H.stopPropagation(),H.preventDefault(),_(z.id)},onTouchStart:H=>{H.stopPropagation(),H.preventDefault(),_(z.id)},style:{position:"absolute",left:`${z.x}%`,top:`${z.y}%`,fontSize:"clamp(1.5rem, 4vw, 2rem)",cursor:"pointer",userSelect:"none",transition:"all 0.1s ease",zIndex:20,touchAction:"manipulation",willChange:"transform",WebkitUserSelect:"none",MozUserSelect:"none",msUserSelect:"none"},children:z.emoji},z.id))]})}function P5({onClose:n}){const{lang:e}=Qe(),[t,i]=g.useState(!1),[s,o]=g.useState(0),a=ie=>{var We;const $={"zh-TW":{title:"情緒泡泡爆破",start:"開始遊戲",restart:"重新開始",score:"分數",time:"時間",combo:"連擊",accuracy:"準確率",highScore:"最高分",rules:"遊戲規則",close:"關閉",hideRules:"隱藏規則",gameOver:"遊戲結束",soundOn:"音效開",soundOff:"音效關",rhythmGame:"音樂節奏",gameplay:"遊戲玩法",clickStartButton:"點擊「開始遊戲」按鈕",preciseBubblePop:"精準戳破泡泡",computer:"電腦",preciseClickCenter:"精準點擊泡泡中心戳破",mobile:"手機",preciseTouchCenter:"精準觸摸泡泡中心戳破",highAccuracyRequired:"需要高精準度，點擊泡泡邊緣無效",fastBubbles:"快速泡泡",harderToPop:"更難戳破，需要更高精準度",slowBubbles:"慢速泡泡",easierToPop:"相對容易戳破",emotionBubbleScore:"情緒泡泡分數",angryBubble:"憤怒泡泡",anxiousBubble:"焦慮泡泡",depressedBubble:"憂鬱泡泡",stressedBubble:"壓力泡泡",irritatedBubble:"暴躁泡泡",frustratedBubble:"沮喪泡泡",points:"分",specialBubbles:"特殊泡泡",bombBubble:"炸彈泡泡",clearAllNearby:"清除周圍所有泡泡",goldenBubble:"金色泡泡",doubleScore:"雙倍分數",ghostBubble:"幽靈泡泡",clickTwice:"需要點擊兩次",chainBubble:"連鎖泡泡",clearSameType:"清除同類型泡泡",timeBubble:"時間泡泡",add5Seconds:"增加5秒時間",accuracySystem:"精準度系統",above:"以上",triggerPowerMode:"觸發能量模式",goodAccuracy:"良好精準度",below:"以下",needImproveAccuracy:"需要提高精準度",powerMode:"能量模式",autoTrigger:"自動觸發",powerModeEasier:"能量模式下更容易戳破泡泡",last10Seconds:"持續10秒後自動結束",comboSystem:"連擊系統",continuousPopExtraScore:"連續戳破泡泡可獲得額外分數",timeLimit:"時間限制",sixtySecondsHighestScore:"60秒內獲得最高分數",gameGoal:"遊戲目標",precisePopEmotionBubbles:"精準戳破情緒泡泡，釋放內心壓力",accuracyChallenge:"精準度挑戰",onlyClickCenterToPop:"只有點擊泡泡中心才能戳破",fastBubblesNeedHigherAccuracy:"快速泡泡需要更高精準度"},"zh-CN":{title:"情绪泡泡爆破",start:"开始游戏",restart:"重新开始",score:"分数",time:"时间",combo:"连击",accuracy:"准确率",highScore:"最高分",rules:"游戏规则",close:"关闭",hideRules:"隐藏规则",gameplay:"游戏玩法",clickStartButton:"点击「开始游戏」按钮",preciseBubblePop:"精准戳破泡泡",computer:"电脑",preciseClickCenter:"精准点击泡泡中心戳破",mobile:"手机",preciseTouchCenter:"精准触摸泡泡中心戳破",highAccuracyRequired:"需要高精准度，点击泡泡边缘无效",fastBubbles:"快速泡泡",harderToPop:"更难戳破，需要更高精准度",slowBubbles:"慢速泡泡",easierToPop:"相对容易戳破",emotionBubbleScore:"情绪泡泡分数",angryBubble:"愤怒泡泡",anxiousBubble:"焦虑泡泡",depressedBubble:"忧郁泡泡",stressedBubble:"压力泡泡",irritatedBubble:"暴躁泡泡",frustratedBubble:"沮丧泡泡",points:"分",specialBubbles:"特殊泡泡",bombBubble:"炸弹泡泡",clearAllNearby:"清除周围所有泡泡",goldenBubble:"金色泡泡",doubleScore:"双倍分数",ghostBubble:"幽灵泡泡",clickTwice:"需要点击两次",chainBubble:"连锁泡泡",clearSameType:"清除同类型泡泡",timeBubble:"时间泡泡",add5Seconds:"增加5秒时间",accuracySystem:"精准度系统",above:"以上",triggerPowerMode:"触发能量模式",goodAccuracy:"良好精准度",below:"以下",needImproveAccuracy:"需要提高精准度",powerMode:"能量模式",autoTrigger:"自动触发",powerModeEasier:"能量模式下更容易戳破泡泡",last10Seconds:"持续10秒后自动结束",comboSystem:"连击系统",continuousPopExtraScore:"连续戳破泡泡可获得额外分数",timeLimit:"时间限制",sixtySecondsHighestScore:"60秒内获得最高分数",gameGoal:"游戏目标",precisePopEmotionBubbles:"精准戳破情绪泡泡，释放内心压力",accuracyChallenge:"精准度挑战",onlyClickCenterToPop:"只有点击泡泡中心才能戳破",fastBubblesNeedHigherAccuracy:"快速泡泡需要更高精准度"},en:{title:"Bubble Pop",start:"Start Game",restart:"Restart",score:"Score",time:"Time",combo:"Combo",accuracy:"Accuracy",highScore:"High Score",rules:"Game Rules",close:"Close",hideRules:"Hide Rules",gameplay:"Gameplay",clickStartButton:'Click "Start Game" button',preciseBubblePop:"Precise Bubble Pop",computer:"Computer",preciseClickCenter:"Precisely click bubble center to pop",mobile:"Mobile",preciseTouchCenter:"Precisely touch bubble center to pop",highAccuracyRequired:"High accuracy required, clicking bubble edge is invalid",fastBubbles:"Fast bubbles",harderToPop:"Harder to pop, requires higher accuracy",slowBubbles:"Slow bubbles",easierToPop:"Relatively easier to pop",emotionBubbleScore:"Emotion Bubble Score",angryBubble:"Angry bubble",anxiousBubble:"Anxious bubble",depressedBubble:"Depressed bubble",stressedBubble:"Stressed bubble",irritatedBubble:"Irritated bubble",frustratedBubble:"Frustrated bubble",points:"points",specialBubbles:"Special Bubbles",bombBubble:"Bomb bubble",clearAllNearby:"Clear all nearby bubbles",goldenBubble:"Golden bubble",doubleScore:"Double score",ghostBubble:"Ghost bubble",clickTwice:"Need to click twice",chainBubble:"Chain bubble",clearSameType:"Clear same type bubbles",timeBubble:"Time bubble",add5Seconds:"Add 5 seconds",accuracySystem:"Accuracy System",above:"above",triggerPowerMode:"Trigger power mode",goodAccuracy:"Good accuracy",below:"below",needImproveAccuracy:"Need to improve accuracy",powerMode:"Power Mode",autoTrigger:"Auto trigger",powerModeEasier:"Easier to pop bubbles in power mode",last10Seconds:"Last 10 seconds then auto end",comboSystem:"Combo System",continuousPopExtraScore:"Continuous pop for extra score",timeLimit:"Time Limit",sixtySecondsHighestScore:"60 seconds to get highest score",gameGoal:"Game Goal",precisePopEmotionBubbles:"Precisely pop emotion bubbles, release inner pressure",accuracyChallenge:"Accuracy Challenge",onlyClickCenterToPop:"Only by clicking the center of the bubble can you pop it",fastBubblesNeedHigherAccuracy:"Fast bubbles require higher accuracy"},ja:{title:"バブルポップ",start:"ゲーム開始",restart:"再開",score:"スコア",time:"時間",combo:"コンボ",accuracy:"精度",highScore:"ハイスコア",rules:"ゲームルール",close:"閉じる",hideRules:"ルール非表示",gameplay:"ゲームプレイ",clickStartButton:"「ゲーム開始」ボタンをクリック",preciseBubblePop:"精密バブルポップ",computer:"パソコン",preciseClickCenter:"バブルの中心を精密にクリックしてポップ",mobile:"モバイル",preciseTouchCenter:"バブルの中心を精密にタッチしてポップ",highAccuracyRequired:"高精度が必要、バブルの端をクリックは無効",fastBubbles:"高速バブル",harderToPop:"ポップしにくい、より高い精度が必要",slowBubbles:"低速バブル",easierToPop:"比較的ポップしやすい",emotionBubbleScore:"感情バブルスコア",angryBubble:"怒りバブル",anxiousBubble:"不安バブル",depressedBubble:"憂鬱バブル",stressedBubble:"ストレスバブル",irritatedBubble:"イライラバブル",frustratedBubble:"フラストレーションバブル",points:"ポイント",specialBubbles:"特殊バブル",bombBubble:"爆弾バブル",clearAllNearby:"周辺のすべてのバブルをクリア",goldenBubble:"ゴールデンバブル",doubleScore:"ダブルスコア",ghostBubble:"ゴーストバブル",clickTwice:"2回クリックが必要",chainBubble:"チェーンバブル",clearSameType:"同じタイプのバブルをクリア",timeBubble:"タイムバブル",add5Seconds:"5秒追加",accuracySystem:"精度システム",above:"以上",triggerPowerMode:"パワーモード発動",goodAccuracy:"良好な精度",below:"以下",needImproveAccuracy:"精度向上が必要",powerMode:"パワーモード",autoTrigger:"自動発動",powerModeEasier:"パワーモードでバブルがポップしやすい",last10Seconds:"10秒間続いて自動終了",comboSystem:"コンボシステム",continuousPopExtraScore:"連続ポップでボーナススコア",timeLimit:"時間制限",sixtySecondsHighestScore:"60秒で最高スコアを獲得",gameGoal:"ゲーム目標",precisePopEmotionBubbles:"感情バブルを精密にポップして、内なる圧力を解放",accuracyChallenge:"精度チャレンジ",onlyClickCenterToPop:"バブルの中心をクリックするだけでポップできる",fastBubblesNeedHigherAccuracy:"高速バブルはより高い精度が必要"},ko:{title:"버블 팝",start:"게임 시작",restart:"다시 시작",score:"점수",time:"시간",combo:"콤보",accuracy:"정확도",highScore:"최고 점수",rules:"게임 규칙",close:"닫기",hideRules:"규칙 숨기기",gameplay:"게임 플레이",clickStartButton:"「게임 시작」버튼 클릭",preciseBubblePop:"정밀 버블 팝",computer:"컴퓨터",preciseClickCenter:"버블 중심을 정밀하게 클릭하여 팝",mobile:"모바일",preciseTouchCenter:"버블 중심을 정밀하게 터치하여 팝",highAccuracyRequired:"높은 정확도 필요, 버블 가장자리 클릭은 무효",fastBubbles:"빠른 버블",harderToPop:"팝하기 어려움, 더 높은 정확도 필요",slowBubbles:"느린 버블",easierToPop:"상대적으로 팝하기 쉬움",emotionBubbleScore:"감정 버블 점수",angryBubble:"분노 버블",anxiousBubble:"불안 버블",depressedBubble:"우울 버블",stressedBubble:"스트레스 버블",irritatedBubble:"짜증 버블",frustratedBubble:"좌절 버블",points:"점",specialBubbles:"특수 버블",bombBubble:"폭탄 버블",clearAllNearby:"주변 모든 버블 제거",goldenBubble:"골든 버블",doubleScore:"더블 점수",ghostBubble:"고스트 버블",clickTwice:"두 번 클릭 필요",chainBubble:"체인 버블",clearSameType:"같은 타입 버블 제거",timeBubble:"타임 버블",add5Seconds:"5초 추가",accuracySystem:"정확도 시스템",above:"이상",triggerPowerMode:"파워 모드 발동",goodAccuracy:"좋은 정확도",below:"이하",needImproveAccuracy:"정확도 향상 필요",powerMode:"파워 모드",autoTrigger:"자동 발동",powerModeEasier:"파워 모드에서 버블이 팝하기 쉬움",last10Seconds:"10초간 지속 후 자동 종료",comboSystem:"콤보 시스템",continuousPopExtraScore:"연속 팝으로 보너스 점수",timeLimit:"시간 제한",sixtySecondsHighestScore:"60초 내 최고 점수 획득",gameGoal:"게임 목표",precisePopEmotionBubbles:"감정 버블을 정밀하게 팝하여 내면의 압력을 해방",accuracyChallenge:"정확도 챌린지",onlyClickCenterToPop:"버블의 중심을 클릭해야만 팝할 수 있다",fastBubblesNeedHigherAccuracy:"빠른 버블은 더 높은 정확도가 필요하다"},vi:{title:"Bong Bóng Nổ",start:"Bắt Đầu Trò Chơi",restart:"Chơi Lại",score:"Điểm",time:"Thời Gian",combo:"Combo",accuracy:"Độ Chính Xác",highScore:"Điểm Cao Nhất",rules:"Luật Chơi",close:"Đóng",hideRules:"Ẩn Luật",gameplay:"Cách Chơi",clickStartButton:'Nhấp vào nút "Bắt Đầu Trò Chơi"',preciseBubblePop:"Bong Bóng Nổ Chính Xác",computer:"Máy tính",preciseClickCenter:"Nhấp chính xác vào trung tâm bong bóng để nổ",mobile:"Điện thoại",preciseTouchCenter:"Chạm chính xác vào trung tâm bong bóng để nổ",highAccuracyRequired:"Cần độ chính xác cao, nhấp vào cạnh bong bóng không hiệu quả",fastBubbles:"Bong bóng nhanh",harderToPop:"Khó nổ hơn, cần độ chính xác cao hơn",slowBubbles:"Bong bóng chậm",easierToPop:"Tương đối dễ nổ",emotionBubbleScore:"Điểm Bong Bóng Cảm Xúc",angryBubble:"Bong bóng giận dữ",anxiousBubble:"Bong bóng lo lắng",depressedBubble:"Bong bóng trầm cảm",stressedBubble:"Bong bóng căng thẳng",irritatedBubble:"Bong bóng khó chịu",frustratedBubble:"Bong bóng thất vọng",points:"điểm",specialBubbles:"Bong Bóng Đặc Biệt",bombBubble:"Bong bóng bom",clearAllNearby:"Xóa tất cả bong bóng gần đó",goldenBubble:"Bong bóng vàng",doubleScore:"Điểm gấp đôi",ghostBubble:"Bong bóng ma",clickTwice:"Cần nhấp hai lần",chainBubble:"Bong bóng chuỗi",clearSameType:"Xóa bong bóng cùng loại",timeBubble:"Bong bóng thời gian",add5Seconds:"Thêm 5 giây",accuracySystem:"Hệ Thống Chính Xác",above:"trên",triggerPowerMode:"Kích hoạt chế độ năng lượng",goodAccuracy:"Độ chính xác tốt",below:"dưới",needImproveAccuracy:"Cần cải thiện độ chính xác",powerMode:"Chế Độ Năng Lượng",autoTrigger:"Tự động kích hoạt",powerModeEasier:"Dễ nổ bong bóng hơn trong chế độ năng lượng",last10Seconds:"Kéo dài 10 giây rồi tự động kết thúc",comboSystem:"Hệ Thống Combo",continuousPopExtraScore:"Nổ liên tục để có điểm thêm",timeLimit:"Giới Hạn Thời Gian",sixtySecondsHighestScore:"60 giây để đạt điểm cao nhất",gameGoal:"Mục Tiêu Trò Chơi",precisePopEmotionBubbles:"Nổ chính xác bong bóng cảm xúc, giải phóng áp lực bên trong",accuracyChallenge:"Thử Thách Độ Chính Xác",onlyClickCenterToPop:"Chỉ bằng cách nhấp vào trung tâm bong bóng mới có thể nổ",fastBubblesNeedHigherAccuracy:"Bong bóng nhanh cần độ chính xác cao hơn"},th:{title:"ป๊อปบับเบิล",start:"เริ่มเกม",restart:"เริ่มใหม่",score:"คะแนน",time:"เวลา",combo:"คอมโบ",accuracy:"ความแม่นยำ",highScore:"คะแนนสูงสุด",rules:"กฎเกม",close:"ปิด",hideRules:"ซ่อนกฎ",gameplay:"วิธีเล่น",clickStartButton:'คลิกปุ่ม "เริ่มเกม"',preciseBubblePop:"ป๊อปบับเบิลอย่างแม่นยำ",computer:"คอมพิวเตอร์",preciseClickCenter:"คลิกตรงกลางบับเบิลอย่างแม่นยำเพื่อป๊อป",mobile:"มือถือ",preciseTouchCenter:"แตะตรงกลางบับเบิลอย่างแม่นยำเพื่อป๊อป",highAccuracyRequired:"ต้องการความแม่นยำสูง การคลิกขอบบับเบิลไม่นับ",fastBubbles:"บับเบิลเร็ว",harderToPop:"ป๊อปยากขึ้น ต้องการความแม่นยำสูงขึ้น",slowBubbles:"บับเบิลช้า",easierToPop:"ค่อนข้างป๊อปง่าย",emotionBubbleScore:"คะแนนบับเบิลอารมณ์",angryBubble:"บับเบิลโกรธ",anxiousBubble:"บับเบิลกังวล",depressedBubble:"บับเบิลเศร้า",stressedBubble:"บับเบิลเครียด",irritatedBubble:"บับเบิลหงุดหงิด",frustratedBubble:"บับเบิลหงุดหงิด",points:"คะแนน",specialBubbles:"บับเบิลพิเศษ",bombBubble:"บับเบิลระเบิด",clearAllNearby:"ลบบับเบิลใกล้เคียงทั้งหมด",goldenBubble:"บับเบิลทอง",doubleScore:"คะแนนสองเท่า",ghostBubble:"บับเบิลผี",clickTwice:"ต้องคลิกสองครั้ง",chainBubble:"บับเบิลโซ่",clearSameType:"ลบบับเบิลประเภทเดียวกัน",timeBubble:"บับเบิลเวลา",add5Seconds:"เพิ่ม 5 วินาที",accuracySystem:"ระบบความแม่นยำ",above:"ขึ้นไป",triggerPowerMode:"เปิดโหมดพลัง",goodAccuracy:"ความแม่นยำดี",below:"ลงมา",needImproveAccuracy:"ต้องปรับปรุงความแม่นยำ",powerMode:"โหมดพลัง",autoTrigger:"เปิดอัตโนมัติ",powerModeEasier:"ป๊อปบับเบิลง่ายขึ้นในโหมดพลัง",last10Seconds:"คงอยู่ 10 วินาทีแล้วปิดอัตโนมัติ",comboSystem:"ระบบคอมโบ",continuousPopExtraScore:"ป๊อปต่อเนื่องเพื่อคะแนนเพิ่ม",timeLimit:"จำกัดเวลา",sixtySecondsHighestScore:"60 วินาทีเพื่อคะแนนสูงสุด",gameGoal:"เป้าหมายเกม",precisePopEmotionBubbles:"ป๊อปบับเบิลอารมณ์อย่างแม่นยำ ปลดปล่อยแรงกดดันภายใน",accuracyChallenge:"ความท้าทายความแม่นยำ",onlyClickCenterToPop:"เฉพาะการคลิกตรงกลางบับเบิลเท่านั้นที่สามารถป๊อปได้",fastBubblesNeedHigherAccuracy:"บับเบิลเร็วต้องการความแม่นยำสูงขึ้น"},la:{title:"Bulla Explodere",start:"Ludum Incipere",restart:"Iterum Incipere",score:"Puncta",time:"Tempus",combo:"Combo",accuracy:"Accuratio",highScore:"Puncta Maxima",rules:"Regulae Ludi",close:"Claudere",hideRules:"Regulae Occultare",gameplay:"Ludus",clickStartButton:'Clicca "Ludum Incipere" pugnum',preciseBubblePop:"Bulla Accurata Explodere",computer:"Computatrum",preciseClickCenter:"Clicca accurate centrum bullae ut explodat",mobile:"Mobile",preciseTouchCenter:"Tange accurate centrum bullae ut explodat",highAccuracyRequired:"Accuratio alta requiritur, cliccare marginem bullae invalidum est",fastBubbles:"Bullae veloces",harderToPop:"Difficilius explodere, accuratio altior requiritur",slowBubbles:"Bullae tardae",easierToPop:"Relativiter facilius explodere",emotionBubbleScore:"Puncta Bullae Emotionis",angryBubble:"Bulla irata",anxiousBubble:"Bulla anxia",depressedBubble:"Bulla depressa",stressedBubble:"Bulla pressa",irritatedBubble:"Bulla irritata",frustratedBubble:"Bulla frustrata",points:"puncta",specialBubbles:"Bullae Speciales",bombBubble:"Bulla bomba",clearAllNearby:"Clara omnes bullas proximas",goldenBubble:"Bulla aurea",doubleScore:"Puncta dupla",ghostBubble:"Bulla phantasma",clickTwice:"Opus est bis cliccare",chainBubble:"Bulla catena",clearSameType:"Clara bullas eiusdem generis",timeBubble:"Bulla temporis",add5Seconds:"Adde 5 secundis",accuracySystem:"Systema Accurationis",above:"supra",triggerPowerMode:"Activa modum potentiae",goodAccuracy:"Accuratio bona",below:"infra",needImproveAccuracy:"Opus est accuratio meliorare",powerMode:"Modus Potentiae",autoTrigger:"Auto activa",powerModeEasier:"Facilius explodere bullas in modo potentiae",last10Seconds:"Dura 10 secundis deinde auto finis",comboSystem:"Systema Combo",continuousPopExtraScore:"Explodere continuum pro punctis extra",timeLimit:"Finis Temporis",sixtySecondsHighestScore:"60 secundis pro punctis maximis",gameGoal:"Finis Ludi",precisePopEmotionBubbles:"Explodere accurate bullas emotionis, libera pressionem internam",accuracyChallenge:"Provocatio Accurationis",onlyClickCenterToPop:"Solum cliccare centrum bullae potest explodere",fastBubblesNeedHigherAccuracy:"Bullae veloces accuratio altior requiritur"},ms:{title:"Letup Buih",start:"Mulakan Permainan",restart:"Mulakan Semula",score:"Markah",time:"Masa",combo:"Combo",accuracy:"Ketepatan",highScore:"Markah Tertinggi",rules:"Peraturan Permainan",close:"Tutup",hideRules:"Sembunyikan Peraturan",gameplay:"Cara Bermain",clickStartButton:'Klik butang "Mulakan Permainan"',preciseBubblePop:"Letup Buih Tepat",computer:"Komputer",preciseClickCenter:"Klik tepat di tengah buih untuk meletup",mobile:"Mudah alih",preciseTouchCenter:"Sentuh tepat di tengah buih untuk meletup",highAccuracyRequired:"Ketepatan tinggi diperlukan, mengklik tepi buih tidak sah",fastBubbles:"Buih pantas",harderToPop:"Lebih sukar untuk meletup, memerlukan ketepatan lebih tinggi",slowBubbles:"Buih perlahan",easierToPop:"Relatif lebih mudah untuk meletup",emotionBubbleScore:"Markah Buih Emosi",angryBubble:"Buih marah",anxiousBubble:"Buih cemas",depressedBubble:"Buih tertekan",stressedBubble:"Buih tertekan",irritatedBubble:"Buih jengkel",frustratedBubble:"Buih kecewa",points:"markah",specialBubbles:"Buih Khas",bombBubble:"Buih bom",clearAllNearby:"Kosongkan semua buih berdekatan",goldenBubble:"Buih emas",doubleScore:"Markah berganda",ghostBubble:"Buih hantu",clickTwice:"Perlu klik dua kali",chainBubble:"Buih rantai",clearSameType:"Kosongkan buih jenis sama",timeBubble:"Buih masa",add5Seconds:"Tambah 5 saat",accuracySystem:"Sistem Ketepatan",above:"ke atas",triggerPowerMode:"Pencetus mod kuasa",goodAccuracy:"Ketepatan baik",below:"ke bawah",needImproveAccuracy:"Perlu tingkatkan ketepatan",powerMode:"Mod Kuasa",autoTrigger:"Pencetus automatik",powerModeEasier:"Lebih mudah meletup buih dalam mod kuasa",last10Seconds:"Bertahan 10 saat kemudian tamat automatik",comboSystem:"Sistem Combo",continuousPopExtraScore:"Letup berterusan untuk markah tambahan",timeLimit:"Had Masa",sixtySecondsHighestScore:"60 saat untuk markah tertinggi",gameGoal:"Matlamat Permainan",precisePopEmotionBubbles:"Letup tepat buih emosi, lepaskan tekanan dalaman",accuracyChallenge:"Cabaran Ketepatan",onlyClickCenterToPop:"Hanya dengan mengklik pusat buih boleh meletup",fastBubblesNeedHigherAccuracy:"Buih pantas memerlukan ketepatan lebih tinggi"}};return((We=$[e])==null?void 0:We[ie])||$["zh-TW"][ie]||ie},[l,c]=g.useState(60),[u,h]=g.useState(0),[p,f]=g.useState(0),[b,x]=g.useState(!1),[S,w]=g.useState(0),[I,j]=g.useState(!1),[A,D]=g.useState(0),[O,P]=g.useState(0),[B,k]=g.useState(0),[T,R]=g.useState(!1),[E,_]=g.useState(0),[v,z]=g.useState([]),[H,L]=g.useState([]);g.useEffect(()=>{const ie=localStorage.getItem("bubblePopHighScore");ie&&f(parseInt(ie))},[]);const ee=[{color:"#ff6b6b",emotion:"😠",points:10,name:"憤怒"},{color:"#4ecdc4",emotion:"😰",points:15,name:"焦慮"},{color:"#ffe66d",emotion:"😔",points:20,name:"憂鬱"},{color:"#a8e6cf",emotion:"😤",points:25,name:"壓力"},{color:"#ff8a80",emotion:"😡",points:30,name:"暴躁"},{color:"#9575cd",emotion:"😞",points:35,name:"沮喪"}],ge=()=>{const ie=["戳破煩惱，釋放心情！","泡泡爆破，壓力全消！","情緒泡泡，一戳就爆！","連擊模式，心情舒暢！","泡泡療法，治癒心靈！"];return ie[Math.floor(Math.random()*ie.length)]},[oe]=g.useState(ge()),Ie=()=>{i(!0),o(0),c(60),h(0),z([]),L([]),D(0),P(0),k(0),R(!1),_(0)},Re=()=>{if(!t)return;const ie=ee[Math.floor(Math.random()*ee.length)],$=Math.random()*80+10,We=Math.random()*80+10,_e=Math.random();let ye;_e<.3?ye=Math.random()*10+15:_e<.6?ye=Math.random()*15+25:_e<.85?ye=Math.random()*20+40:ye=Math.random()*25+60;const J=Math.random();let pe="normal",ce=ie.points,me=ie.color,xe=ie.emotion;if(J<.05)pe="bomb",ce=50,me="#ff4757",xe="💣",ye=Math.random()*15+45;else if(J<.1)pe="golden",ce=100,me="#ffa502",xe="⭐",ye=Math.random()*20+50;else{if(J<.15)return pe="ghost",ce=30,me="#a4b0be",xe="👻",ye=Math.random()*10+20,{id:Date.now(),x:$,y:We,size:ye,color:me,emotion:xe,points:ce,speed:Math.random()*3+2,opacity:.8+Math.random()*.2,type:pe,health:2};J<.2?(pe="chain",ce=40,me="#2ed573",xe="🔗",ye=Math.random()*15+35):J<.25&&(pe="time",ce=25,me="#3742fa",xe="⏰",ye=Math.random()*12+25)}const M={id:Date.now(),x:$,y:We,size:ye,color:me,emotion:xe,points:ce,speed:Math.random()*3+1.5,opacity:.8+Math.random()*.2,type:pe,chainId:pe==="chain"?Math.floor(Math.random()*1e3):void 0,timeBonus:pe==="time"?5:void 0};z(q=>[...q,M])},te=ie=>{const $=v.find(pe=>pe.id===ie);if(!$)return;const We=Math.floor(u/5)*5;let _e=$.points+We;if($.type==="bomb"){const pe=v.filter(ce=>ce.id!==ie&&Math.sqrt((ce.x-$.x)**2+(ce.y-$.y)**2)<15);pe.forEach(ce=>{_e+=ce.points,h(me=>me+1)}),z(ce=>ce.filter(me=>me.id!==ie&&!pe.find(xe=>xe.id===me.id)))}else if($.type==="golden")_e*=2,z(pe=>pe.filter(ce=>ce.id!==ie));else if($.type==="ghost"){if($.health&&$.health>1){z(pe=>pe.map(ce=>ce.id===ie?{...ce,health:ce.health-1}:ce));return}z(pe=>pe.filter(ce=>ce.id!==ie))}else if($.type==="chain"){const pe=v.filter(ce=>ce.id!==ie&&ce.chainId===$.chainId);pe.forEach(ce=>{_e+=ce.points,h(me=>me+1)}),z(ce=>ce.filter(me=>me.id!==ie&&!pe.find(xe=>xe.id===me.id)))}else $.type==="time"?(c(pe=>pe+($.timeBonus||5)),z(pe=>pe.filter(ce=>ce.id!==ie))):z(pe=>pe.filter(ce=>ce.id!==ie));o(pe=>pe+_e),h(pe=>pe+1),w(3),u>=4&&(j(!0),Me(),setTimeout(()=>j(!1),1e3));const ye=$.type==="bomb"?15:8,J=[];for(let pe=0;pe<ye;pe++){const ce=pe/ye*Math.PI*2,me=2+Math.random()*3;J.push({id:Date.now()+pe,x:$.x,y:$.y,vx:Math.cos(ce)*me,vy:Math.sin(ce)*me,color:$.color,life:1})}L(pe=>[...pe,...J])},W=()=>{i(!1),s>p&&(f(s),localStorage.setItem("bubblePopHighScore",s.toString()))};g.useEffect(()=>{if(!t)return;const ie=setInterval(()=>{const $=.03+(60-l)*.001,We=Math.min(.15,$*1.8);Math.random()<We&&Re(),z(_e=>_e.map(ye=>({...ye,y:ye.y-ye.speed*1.2,opacity:ye.opacity-.003,x:ye.x+(Math.random()-.5)*.4})).filter(ye=>ye.y>-10&&ye.opacity>.1)),L(_e=>_e.map(ye=>({...ye,x:ye.x+ye.vx,y:ye.y+ye.vy,vy:ye.vy+.1,life:ye.life-.02})).filter(ye=>ye.life>0)),S>0?w(_e=>_e-.05):u>0&&h(0),E>0?_(_e=>_e-.05):T&&R(!1)},30);return()=>clearInterval(ie)},[t]),g.useEffect(()=>{if(!t||l<=0)return;const ie=setInterval(()=>{c($=>$<=1?(W(),0):$-1)},1e3);return()=>clearInterval(ie)},[t,l]),g.useEffect(()=>{},[t,v]);const[Y,X]=g.useState(null),[le,be]=g.useState(!0);g.useEffect(()=>{if(typeof window<"u"&&window.AudioContext){const ie=new AudioContext;X(ie)}},[]);const ve=()=>{if(!(!Y||!le))try{const ie=Y.createOscillator(),$=Y.createGain();ie.connect($),$.connect(Y.destination),ie.type="sine",ie.frequency.setValueAtTime(800,Y.currentTime),ie.frequency.exponentialRampToValueAtTime(200,Y.currentTime+.1),$.gain.setValueAtTime(.3,Y.currentTime),$.gain.exponentialRampToValueAtTime(.01,Y.currentTime+.1),ie.start(Y.currentTime),ie.stop(Y.currentTime+.1)}catch(ie){console.log("音效播放失敗:",ie)}},Me=()=>{if(!(!Y||!le))try{const ie=Y.createOscillator(),$=Y.createGain();ie.connect($),$.connect(Y.destination),ie.type="square",ie.frequency.setValueAtTime(1e3,Y.currentTime),ie.frequency.exponentialRampToValueAtTime(400,Y.currentTime+.2),$.gain.setValueAtTime(.2,Y.currentTime),$.gain.exponentialRampToValueAtTime(.01,Y.currentTime+.2),ie.start(Y.currentTime),ie.stop(Y.currentTime+.2)}catch(ie){console.log("連擊音效播放失敗:",ie)}},Ve=()=>{if(!(!Y||!le))try{const ie=Y.createOscillator(),$=Y.createGain();ie.connect($),$.connect(Y.destination),ie.type="sawtooth",ie.frequency.setValueAtTime(600,Y.currentTime),ie.frequency.exponentialRampToValueAtTime(1200,Y.currentTime+.3),$.gain.setValueAtTime(.15,Y.currentTime),$.gain.exponentialRampToValueAtTime(.01,Y.currentTime+.3),ie.start(Y.currentTime),ie.stop(Y.currentTime+.3)}catch(ie){console.log("能量模式音效播放失敗:",ie)}};return r.jsxs("div",{style:{width:"100vw",height:"100vh",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",position:"relative",overflow:"auto",cursor:t?"pointer":"default",touchAction:"pan-y",userSelect:"none",WebkitUserSelect:"none",WebkitTouchCallout:"none"},onClick:ie=>{ie.preventDefault(),ie.stopPropagation()},onMouseDown:ie=>{ie.preventDefault(),ie.stopPropagation()},children:[r.jsx("style",{children:`
          @keyframes float {
            0%, 100% { transform: translate(-50%, -50%) translateY(0px); }
            50% { transform: translate(-50%, -50%) translateY(-10px); }
          }
          @keyframes comboEffect {
            0% { 
              transform: translate(-50%, -50%) scale(0.5);
              opacity: 0;
            }
            50% { 
              transform: translate(-50%, -50%) scale(1.2);
              opacity: 1;
            }
            100% { 
              transform: translate(-50%, -50%) scale(1);
              opacity: 0;
            }
          }
          @keyframes powerMode {
            0% { 
              opacity: 0.7;
              textShadow: 0 0 5px #FF5722;
            }
            100% { 
              opacity: 1;
              textShadow: 0 0 15px #FF5722, 0 0 25px #FF5722;
            }
          }
          @keyframes popEffect {
            0% { 
              transform: translate(-50%, -50%) scale(1);
              opacity: 1;
            }
            50% { 
              transform: translate(-50%, -50%) scale(1.3);
              opacity: 0.8;
            }
            100% { 
              transform: translate(-50%, -50%) scale(0);
              opacity: 0;
            }
          }
        `}),r.jsx("button",{onClick:n,style:{position:"absolute",top:"clamp(20px, 4vw, 40px)",left:"clamp(20px, 4vw, 40px)",background:"#fff",border:"2px solid #9C27B0",borderRadius:"50%",width:"clamp(40px, 8vw, 50px)",height:"clamp(40px, 8vw, 50px)",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",fontSize:"clamp(1.2rem, 3vw, 1.5rem)",zIndex:10,boxShadow:"0 2px 8px rgba(0,0,0,0.2)"},children:"←"}),r.jsxs("div",{style:{position:"absolute",top:"clamp(20px, 4vw, 40px)",left:"clamp(80px, 16vw, 100px)",background:"rgba(255,255,255,0.9)",borderRadius:"15px",padding:"clamp(12px, 2.5vw, 16px)",zIndex:5,maxWidth:"180px"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"8px"},children:[r.jsxs("h3",{style:{fontSize:"clamp(1rem, 2.5vw, 1.2rem)",margin:0,lineHeight:"1.2"},children:["🫧 ",a("title")]}),r.jsx("button",{onClick:()=>x(!b),style:{background:"#9C27B0",color:"#fff",border:"none",borderRadius:"12px",padding:"2px 8px",fontSize:"clamp(0.6rem, 1.5vw, 0.7rem)",cursor:"pointer"},children:a(b?"hideRules":"rules")})]}),!b&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{style:{display:"flex",gap:"clamp(4px, 1vw, 8px)",justifyContent:"center",flexWrap:"wrap",marginBottom:"6px"},children:[r.jsxs("div",{style:{fontSize:"clamp(0.7rem, 1.8vw, 0.85rem)"},children:[a("score"),"：",s]}),r.jsxs("div",{style:{fontSize:"clamp(0.7rem, 1.8vw, 0.85rem)"},children:[a("time"),"：",l,"秒"]}),r.jsxs("div",{style:{fontSize:"clamp(0.7rem, 1.8vw, 0.85rem)",color:u>=5?"#ff6b6b":u>=3?"#ffa502":"#333",fontWeight:u>=3?"bold":"normal"},children:[a("combo"),"：",u]})]}),r.jsxs("div",{style:{display:"flex",gap:"clamp(4px, 1vw, 8px)",justifyContent:"center",flexWrap:"wrap",marginBottom:"6px"},children:[r.jsxs("div",{style:{fontSize:"clamp(0.7rem, 1.8vw, 0.85rem)",color:A>=80?"#4CAF50":A>=60?"#FF9800":"#F44336"},children:[a("accuracy"),"：",A.toFixed(1),"%"]}),T&&r.jsx("div",{style:{fontSize:"clamp(0.7rem, 1.8vw, 0.85rem)",color:"#FF5722",fontWeight:"bold",animation:"powerMode 0.5s ease-in-out infinite alternate"},children:"⚡能量模式"})]}),r.jsxs("div",{style:{display:"flex",gap:"clamp(4px, 1vw, 8px)",justifyContent:"center",flexWrap:"wrap"},children:[r.jsxs("div",{style:{fontSize:"clamp(0.6rem, 1.5vw, 0.75rem)"},children:["泡泡：",v.length]}),r.jsxs("div",{style:{fontSize:"clamp(0.6rem, 1.5vw, 0.75rem)"},children:[a("highScore"),"：",p]}),r.jsx("div",{style:{fontSize:"clamp(0.6rem, 1.5vw, 0.75rem)",color:v.some(ie=>ie.speed>=3)?"#ff6b6b":v.some(ie=>ie.speed>=2)?"#ffa502":"#4CAF50"},children:v.some(ie=>ie.speed>=3)?"🚀 快速":v.some(ie=>ie.speed>=2)?"⚡ 中速":"🐌 慢速"})]}),r.jsx("div",{style:{display:"flex",justifyContent:"center",marginTop:"clamp(4px, 1vw, 8px)",gap:"clamp(4px, 1vw, 8px)"},children:r.jsxs("button",{onClick:()=>be(!le),style:{background:le?"#4CAF50":"#f44336",color:"white",border:"none",borderRadius:"8px",padding:"clamp(2px, 0.5vw, 4px) clamp(6px, 1.5vw, 8px)",fontSize:"clamp(0.5rem, 1.2vw, 0.6rem)",cursor:"pointer",display:"flex",alignItems:"center",gap:"2px"},children:[le?"🔊":"🔇"," ",a(le?"soundOn":"soundOff")]})}),r.jsx("div",{style:{fontSize:"clamp(0.7rem, 1.8vw, 0.85rem)",color:"#9C27B0",fontWeight:"bold",marginTop:"6px",textAlign:"center"},children:oe}),!t&&r.jsx("button",{onClick:Ie,style:{background:"#9C27B0",color:"#fff",border:"none",borderRadius:"20px",padding:"clamp(5px, 1.2vw, 6px) clamp(12px, 2.5vw, 18px)",fontSize:"clamp(0.8rem, 2vw, 0.9rem)",fontWeight:"bold",marginTop:"8px",cursor:"pointer",transition:"all 0.3s ease"},children:a("start")})]}),b&&r.jsxs("div",{style:{maxHeight:"200px",overflowY:"auto",fontSize:"clamp(0.7rem, 1.8vw, 0.85rem)",lineHeight:"1.4"},children:[r.jsxs("h4",{style:{margin:"0 0 8px 0",color:"#9C27B0"},children:[a("gameplay"),"："]}),r.jsxs("ul",{style:{margin:"0",paddingLeft:"15px"},children:[r.jsxs("li",{children:[r.jsx("strong",{children:a("start")}),"：",a("clickStartButton")]}),r.jsxs("li",{children:[r.jsx("strong",{children:a("preciseBubblePop")}),"：",r.jsx("br",{}),a("computer"),"：",a("preciseClickCenter"),r.jsx("br",{}),a("mobile"),"：",a("preciseTouchCenter"),r.jsx("br",{}),"⚠️ ",a("highAccuracyRequired"),r.jsx("br",{}),"🚀 ",a("fastBubbles"),"：",a("harderToPop"),r.jsx("br",{}),"🐌 ",a("slowBubbles"),"：",a("easierToPop")]}),r.jsxs("li",{children:[r.jsx("strong",{children:a("emotionBubbleScore")}),"：",r.jsx("br",{}),"😠 ",a("angryBubble"),"：10",a("points"),r.jsx("br",{}),"😰 ",a("anxiousBubble"),"：15",a("points"),r.jsx("br",{}),"😔 ",a("depressedBubble"),"：20",a("points"),r.jsx("br",{}),"😤 ",a("stressedBubble"),"：25",a("points"),r.jsx("br",{}),"😡 ",a("irritatedBubble"),"：30",a("points"),r.jsx("br",{}),"😞 ",a("frustratedBubble"),"：35",a("points")]}),r.jsxs("li",{children:[r.jsx("strong",{children:a("specialBubbles")}),"：",r.jsx("br",{}),"💣 ",a("bombBubble"),"：50",a("points"),"，",a("clearAllNearby"),r.jsx("br",{}),"⭐ ",a("goldenBubble"),"：100",a("points"),"，",a("doubleScore"),r.jsx("br",{}),"👻 ",a("ghostBubble"),"：30",a("points"),"，",a("clickTwice"),r.jsx("br",{}),"🔗 ",a("chainBubble"),"：40",a("points"),"，",a("clearSameType"),r.jsx("br",{}),"⏰ ",a("timeBubble"),"：25",a("points"),"，",a("add5Seconds")]}),r.jsxs("li",{children:[r.jsx("strong",{children:a("accuracySystem")}),"：",r.jsx("br",{}),"🟢 80%",a("above"),"：",a("triggerPowerMode"),r.jsx("br",{}),"🟡 60-79%：",a("goodAccuracy"),r.jsx("br",{}),"🔴 60%",a("below"),"：",a("needImproveAccuracy")]}),r.jsxs("li",{children:[r.jsx("strong",{children:a("powerMode")}),"：",r.jsx("br",{}),"⚡ 80%",a("above"),a("autoTrigger"),r.jsx("br",{}),"🎯 ",a("powerModeEasier"),r.jsx("br",{}),"⏱️ ",a("last10Seconds")]}),r.jsxs("li",{children:[r.jsx("strong",{children:a("comboSystem")}),"：",a("continuousPopExtraScore")]}),r.jsxs("li",{children:[r.jsx("strong",{children:a("timeLimit")}),"：",a("60SecondsHighestScore")]}),r.jsxs("li",{children:[r.jsx("strong",{children:a("gameGoal")}),"：",a("precisePopEmotionBubbles"),"！"]})]})]})]}),v.map(ie=>{const $=ie.type==="bomb"?{animation:"float 2s ease-in-out infinite",boxShadow:"0 0 20px #ff4757"}:ie.type==="golden"?{animation:"float 1.5s ease-in-out infinite",boxShadow:"0 0 25px #ffa502"}:ie.type==="ghost"?{animation:"float 1s ease-in-out infinite",opacity:.6}:ie.type==="chain"?{animation:"float 1.8s ease-in-out infinite",boxShadow:"0 0 15px #2ed573"}:ie.type==="time"?{animation:"float 1.2s ease-in-out infinite",boxShadow:"0 0 18px #3742fa"}:{};return r.jsx("div",{style:{position:"absolute",left:`${ie.x}%`,top:`${ie.y}%`,transform:"translate(-50%, -50%)",width:`${ie.size*1.8}px`,height:`${ie.size*1.8}px`,background:`radial-gradient(circle at 30% 30%, ${ie.color}40, ${ie.color})`,borderRadius:"50%",border:`2px solid ${ie.color}80`,display:"flex",alignItems:"center",justifyContent:"center",fontSize:`${Math.max(12,ie.size*.4)}px`,opacity:ie.opacity,cursor:"pointer",transition:"all 0.2s ease",zIndex:20,...$},onMouseEnter:We=>{We.currentTarget.style.transform="translate(-50%, -50%) scale(1.1)"},onMouseLeave:We=>{We.currentTarget.style.transform="translate(-50%, -50%) scale(1)"},onClick:We=>{if(We.preventDefault(),We.stopPropagation(),console.log("泡泡被點擊:",ie.id),t){const _e=We.currentTarget;_e.style.animation="popEffect 0.4s ease-out forwards";const ye=_e.getBoundingClientRect(),J=ye.left+ye.width/2,pe=ye.top+ye.height/2;for(let ce=0;ce<12;ce++){const me=document.createElement("div");me.style.position="fixed",me.style.left=J+"px",me.style.top=pe+"px",me.style.width="6px",me.style.height="6px",me.style.background=ie.color,me.style.borderRadius="50%",me.style.pointerEvents="none",me.style.zIndex="1000",me.style.boxShadow=`0 0 8px ${ie.color}`,me.style.transition="all 0.6s ease",document.body.appendChild(me);const xe=ce*30*Math.PI/180,M=60+Math.random()*40,q=J+Math.cos(xe)*M,F=pe+Math.sin(xe)*M;setTimeout(()=>{me.style.left=q+"px",me.style.top=F+"px",me.style.opacity="0",me.style.transform="scale(0)"},10),setTimeout(()=>{document.body.contains(me)&&document.body.removeChild(me)},600)}P(ce=>ce+1),k(ce=>ce+1),te(ie.id),ve(),A>=80&&!T&&(R(!0),_(10),Ve()),D(O>0?B/O*100:0)}},onTouchStart:We=>{We.preventDefault(),We.stopPropagation(),console.log("泡泡被觸摸:",ie.id);const _e=We.currentTarget;if(_e.style.transform="translate(-50%, -50%) scale(1.2)",_e.style.transition="transform 0.1s ease",setTimeout(()=>{_e.style.transform="translate(-50%, -50%) scale(1)"},100),t){console.log("手機版直接爆破泡泡:",ie.id);const ye=We.currentTarget;ye.style.animation="popEffect 0.4s ease-out forwards";const J=ye.getBoundingClientRect(),pe=J.left+J.width/2,ce=J.top+J.height/2;for(let me=0;me<12;me++){const xe=document.createElement("div");xe.style.position="fixed",xe.style.left=pe+"px",xe.style.top=ce+"px",xe.style.width="6px",xe.style.height="6px",xe.style.background=ie.color,xe.style.borderRadius="50%",xe.style.pointerEvents="none",xe.style.zIndex="1000",xe.style.boxShadow=`0 0 8px ${ie.color}`,xe.style.transition="all 0.6s ease",document.body.appendChild(xe);const M=me*30*Math.PI/180,q=60+Math.random()*40,F=pe+Math.cos(M)*q,we=ce+Math.sin(M)*q;setTimeout(()=>{xe.style.left=F+"px",xe.style.top=we+"px",xe.style.opacity="0",xe.style.transform="scale(0)"},10),setTimeout(()=>{document.body.contains(xe)&&document.body.removeChild(xe)},600)}P(me=>me+1),k(me=>me+1),te(ie.id),ve(),A>=80&&!T&&(R(!0),_(10),Ve()),D(O>0?B/O*100:0)}},children:ie.emotion},ie.id)}),H.map(ie=>r.jsx("div",{style:{position:"absolute",left:`${ie.x}%`,top:`${ie.y}%`,transform:"translate(-50%, -50%)",width:"4px",height:"4px",background:ie.color,borderRadius:"50%",opacity:ie.life,pointerEvents:"none"}},ie.id)),I&&r.jsxs("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",fontSize:"clamp(2rem, 5vw, 3rem)",fontWeight:"bold",color:"#ff6b6b",textShadow:"0 0 20px #ff6b6b",animation:"comboEffect 1s ease-out forwards",pointerEvents:"none",zIndex:1e3},children:["COMBO x",u,"!"]}),!t&&r.jsxs("div",{style:{position:"absolute",bottom:"clamp(20px, 4vw, 40px)",left:"50%",transform:"translateX(-50%)",background:"rgba(0,0,0,0.7)",color:"#fff",padding:"clamp(8px, 2vw, 12px)",borderRadius:"10px",fontSize:"clamp(0.7rem, 1.8vw, 0.85rem)",textAlign:"center",zIndex:100},children:["🎯 ",a("accuracyChallenge"),"：",a("onlyClickCenterToPop"),"！",r.jsx("br",{}),"🚀 ",a("fastBubblesNeedHigherAccuracy"),"！"]}),!t&&s>0&&r.jsxs("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",background:"rgba(255,255,255,0.95)",borderRadius:"20px",padding:"clamp(20px, 4vw, 30px)",textAlign:"center",zIndex:1001,minWidth:"clamp(250px, 50vw, 350px)"},children:[r.jsx("h2",{style:{fontSize:"clamp(1.5rem, 3.5vw, 2rem)",margin:"0 0 15px 0",color:"#9C27B0"},children:"遊戲結束！"}),r.jsxs("div",{style:{fontSize:"clamp(1rem, 2.5vw, 1.2rem)",marginBottom:"10px"},children:["最終分數：",s]}),r.jsxs("div",{style:{fontSize:"clamp(0.9rem, 2vw, 1rem)",marginBottom:"20px",color:"#666"},children:["最高分數：",p]}),r.jsxs("div",{style:{display:"flex",gap:"10px",justifyContent:"center"},children:[r.jsx("button",{onClick:Ie,style:{background:"#9C27B0",color:"#fff",border:"none",borderRadius:"15px",padding:"clamp(8px, 1.5vw, 12px) clamp(16px, 3vw, 24px)",fontSize:"clamp(0.9rem, 2vw, 1rem)",cursor:"pointer"},children:"再玩一次"}),r.jsx("button",{onClick:n,style:{background:"#666",color:"#fff",border:"none",borderRadius:"15px",padding:"clamp(8px, 1.5vw, 12px) clamp(16px, 3vw, 24px)",fontSize:"clamp(0.9rem, 2vw, 1rem)",cursor:"pointer"},children:"返回"})]})]})]})}function F5({onClose:n}){const{lang:e}=Qe(),[t,i]=g.useState(0),[s,o]=g.useState(0),[a,l]=g.useState(!1),[c,u]=g.useState(60),[h,p]=g.useState(50),[f,b]=g.useState([]),[x,S]=g.useState(3),[w,I]=g.useState(1),[j,A]=g.useState(0),[D,O]=g.useState(!1),[P,B]=g.useState(!1),[k,T]=g.useState(!1),[R,E]=g.useState(!1),[_,v]=g.useState(!1),[z,H]=g.useState({x:0,y:0}),L=Y=>{var le;const X={"zh-TW":{score:"分數",time:"時間",level:"等級",combo:"連擊",title:"極速賽車",rules:"遊戲規則",close:"關閉",gameOver:"遊戲結束",controlMethod:"控制方式",useArrowKeysOrButtons:"使用方向鍵 ← → 或螢幕按鈕控制賽車",moveLeftRightToAvoid:"左右移動避開障礙物",gameObjective:"遊戲目標",avoidAllObstacles:"避開所有障礙物（石頭、汽車、卡車）",successfulAvoidance:"成功避開獲得5分 + 連擊獎勵",collisionPenalty:"碰撞障礙物扣10分並重置連擊",scoringSystem:"計分系統",baseScore:"基礎分數：避開障礙物 +5分",comboBonus:"連擊獎勵：每次連擊額外 +1分",levelUp:"等級提升：每100分提升一個等級",speedIncrease:"速度增加：等級越高，障礙物移動越快",gameTime:"遊戲時間",sixtySecondsPerGame:"每局遊戲60秒",autoScoreWhenTimeUp:"時間結束自動結算分數"},"zh-CN":{score:"分数",time:"时间",level:"等级",combo:"连击",title:"极速赛车",rules:"游戏规则",close:"关闭",controlMethod:"控制方式",useArrowKeysOrButtons:"使用方向键 ← → 或屏幕按钮控制赛车",moveLeftRightToAvoid:"左右移动避开障碍物",gameObjective:"游戏目标",avoidAllObstacles:"避开所有障碍物（石头、汽车、卡车）",successfulAvoidance:"成功避开获得5分 + 连击奖励",collisionPenalty:"碰撞障碍物扣10分并重置连击",scoringSystem:"计分系统",baseScore:"基础分数：避开障碍物 +5分",comboBonus:"连击奖励：每次连击额外 +1分",levelUp:"等级提升：每100分提升一个等级",speedIncrease:"速度增加：等级越高，障碍物移动越快",gameTime:"游戏时间",sixtySecondsPerGame:"每局游戏60秒",autoScoreWhenTimeUp:"时间结束自动结算分数"},en:{score:"Score",time:"Time",level:"Level",combo:"Combo",title:"Speed Racing",rules:"Game Rules",close:"Close",controlMethod:"Control Method",useArrowKeysOrButtons:"Use arrow keys ← → or screen buttons to control the race car",moveLeftRightToAvoid:"Move left and right to avoid obstacles",gameObjective:"Game Objective",avoidAllObstacles:"Avoid all obstacles (stones, cars, trucks)",successfulAvoidance:"Successfully avoid to get 5 points + combo bonus",collisionPenalty:"Colliding with obstacles deducts 10 points and resets combo",scoringSystem:"Scoring System",baseScore:"Base score: avoid obstacles +5 points",comboBonus:"Combo bonus: +1 point for each combo",levelUp:"Level up: gain one level every 100 points",speedIncrease:"Speed increase: the higher the level, the faster obstacles move",gameTime:"Game Time",sixtySecondsPerGame:"60 seconds per game",autoScoreWhenTimeUp:"Auto score when time is up"},ja:{score:"スコア",time:"時間",level:"レベル",combo:"コンボ",title:"スピードレーシング",rules:"ゲームルール",close:"閉じる",controlMethod:"操作方法",useArrowKeysOrButtons:"矢印キー ← → または画面ボタンでレーシングカーを操作",moveLeftRightToAvoid:"左右に移動して障害物を避ける",gameObjective:"ゲーム目標",avoidAllObstacles:"すべての障害物（石、車、トラック）を避ける",successfulAvoidance:"成功して避けると5ポイント + コンボボーナス",collisionPenalty:"障害物に衝突すると10ポイント減点しコンボリセット",scoringSystem:"スコアシステム",baseScore:"基本スコア：障害物を避けると +5ポイント",comboBonus:"コンボボーナス：各コンボで +1ポイント",levelUp:"レベルアップ：100ポイントごとに1レベルアップ",speedIncrease:"速度増加：レベルが高いほど障害物が速く動く",gameTime:"ゲーム時間",sixtySecondsPerGame:"ゲームあたり60秒",autoScoreWhenTimeUp:"時間切れで自動スコア"},ko:{score:"점수",time:"시간",level:"레벨",combo:"콤보",title:"스피드 레이싱",rules:"게임 규칙",close:"닫기",controlMethod:"조작 방법",useArrowKeysOrButtons:"화살표 키 ← → 또는 화면 버튼으로 레이싱카 조작",moveLeftRightToAvoid:"좌우로 이동하여 장애물 피하기",gameObjective:"게임 목표",avoidAllObstacles:"모든 장애물（돌、자동차、트럭）피하기",successfulAvoidance:"성공적으로 피하면 5점 + 콤보 보너스",collisionPenalty:"장애물과 충돌하면 10점 감점하고 콤보 리셋",scoringSystem:"점수 시스템",baseScore:"기본 점수：장애물 피하기 +5점",comboBonus:"콤보 보너스：각 콤보마다 +1점",levelUp:"레벨 업：100점마다 1레벨 상승",speedIncrease:"속도 증가：레벨이 높을수록 장애물이 빨리 움직임",gameTime:"게임 시간",sixtySecondsPerGame:"게임당 60초",autoScoreWhenTimeUp:"시간 종료 시 자동 점수"},vi:{score:"Điểm",time:"Thời Gian",level:"Cấp Độ",combo:"Combo",title:"Đua Xe Tốc Độ",rules:"Luật Chơi",close:"Đóng",controlMethod:"Phương Pháp Điều Khiển",useArrowKeysOrButtons:"Sử dụng phím mũi tên ← → hoặc nút màn hình để điều khiển xe đua",moveLeftRightToAvoid:"Di chuyển trái phải để tránh chướng ngại vật",gameObjective:"Mục Tiêu Trò Chơi",avoidAllObstacles:"Tránh tất cả chướng ngại vật (đá, xe hơi, xe tải)",successfulAvoidance:"Tránh thành công được 5 điểm + phần thưởng combo",collisionPenalty:"Va chạm với chướng ngại vật trừ 10 điểm và reset combo",scoringSystem:"Hệ Thống Điểm",baseScore:"Điểm cơ bản: tránh chướng ngại vật +5 điểm",comboBonus:"Phần thưởng combo: +1 điểm cho mỗi combo",levelUp:"Tăng cấp: tăng 1 cấp mỗi 100 điểm",speedIncrease:"Tăng tốc độ: cấp càng cao, chướng ngại vật di chuyển càng nhanh",gameTime:"Thời Gian Trò Chơi",sixtySecondsPerGame:"60 giây mỗi trò chơi",autoScoreWhenTimeUp:"Tự động tính điểm khi hết thời gian"},th:{score:"คะแนน",time:"เวลา",level:"ระดับ",combo:"คอมโบ",title:"แข่งรถความเร็ว",rules:"กฎเกม",close:"ปิด",controlMethod:"วิธีการควบคุม",useArrowKeysOrButtons:"ใช้ปุ่มลูกศร ← → หรือปุ่มหน้าจอควบคุมรถแข่ง",moveLeftRightToAvoid:"เคลื่อนที่ซ้ายขวาเพื่อหลบหลีกสิ่งกีดขวาง",gameObjective:"เป้าหมายเกม",avoidAllObstacles:"หลบหลีกสิ่งกีดขวางทั้งหมด（หิน、รถยนต์、รถบรรทุก）",successfulAvoidance:"หลบหลีกสำเร็จได้ 5 คะแนน + โบนัสคอมโบ",collisionPenalty:"ชนสิ่งกีดขวางหัก 10 คะแนนและรีเซ็ตคอมโบ",scoringSystem:"ระบบคะแนน",baseScore:"คะแนนพื้นฐาน：หลบหลีกสิ่งกีดขวาง +5 คะแนน",comboBonus:"โบนัสคอมโบ：+1 คะแนนสำหรับแต่ละคอมโบ",levelUp:"เลเวลอัพ：เพิ่ม 1 เลเวลทุก 100 คะแนน",speedIncrease:"เพิ่มความเร็ว：เลเวลสูงขึ้นสิ่งกีดขวางเคลื่อนที่เร็วขึ้น",gameTime:"เวลาเกม",sixtySecondsPerGame:"60 วินาทีต่อเกม",autoScoreWhenTimeUp:"คะแนนอัตโนมัติเมื่อหมดเวลา"},la:{score:"Puncta",time:"Tempus",level:"Gradus",combo:"Combo",title:"Cursus Velocitatis",rules:"Regulae Ludi",close:"Claudere",controlMethod:"Methodus Controllandi",useArrowKeysOrButtons:"Utere clavis sagittarum ← → vel pugnis scaenae ad currum regendum",moveLeftRightToAvoid:"Move sinistra dextraque ad impedimenta vitanda",gameObjective:"Finis Ludi",avoidAllObstacles:"Vita omnia impedimenta (lapides, currus, plaustra)",successfulAvoidance:"Vitando feliciter accipe 5 puncta + praemium combo",collisionPenalty:"Collidendo cum impedimentis minus 10 puncta et reset combo",scoringSystem:"Systema Punctandi",baseScore:"Puncta fundamentalia: vitando impedimenta +5 puncta",comboBonus:"Praemium combo: +1 punctum pro quaque combo",levelUp:"Gradus sursum: accipe unum gradum pro quaque 100 punctis",speedIncrease:"Auctio velocitatis: altior gradus, velocius impedimenta moventur",gameTime:"Tempus Ludi",sixtySecondsPerGame:"60 secundis pro quaque ludo",autoScoreWhenTimeUp:"Auto puncta quando tempus finitum est"},ms:{score:"Markah",time:"Masa",level:"Tahap",combo:"Combo",title:"Lumba Kereta Laju",rules:"Peraturan Permainan",close:"Tutup",controlMethod:"Kaedah Kawalan",useArrowKeysOrButtons:"Gunakan kekunci anak panah ← → atau butang skrin untuk mengawal kereta lumba",moveLeftRightToAvoid:"Gerakkan kiri kanan untuk mengelakkan halangan",gameObjective:"Objektif Permainan",avoidAllObstacles:"Elakkan semua halangan (batu, kereta, lori)",successfulAvoidance:"Berjaya elakkan dapat 5 markah + bonus combo",collisionPenalty:"Berlanggar dengan halangan tolak 10 markah dan reset combo",scoringSystem:"Sistem Markah",baseScore:"Markah asas: elakkan halangan +5 markah",comboBonus:"Bonus combo: +1 markah untuk setiap combo",levelUp:"Naik tahap: dapat 1 tahap setiap 100 markah",speedIncrease:"Tambah kelajuan: tahap lebih tinggi, halangan bergerak lebih pantas",gameTime:"Masa Permainan",sixtySecondsPerGame:"60 saat setiap permainan",autoScoreWhenTimeUp:"Markah automatik apabila masa habis"}};return((le=X[e])==null?void 0:le[Y])||X["zh-TW"][Y]||Y};g.useEffect(()=>{const Y=Ka("racing");Y&&o(Y.highScore||0)},[]),g.useEffect(()=>{s>0&&Ga("racing",{highScore:s})},[s]);const ee=()=>{i(0),u(60),p(50),b([]),S(3),I(1),A(0),l(!0)},ge=()=>{l(!1),t>s&&o(t)},oe=Y=>{a&&p(X=>{const le=Y==="left"?X-8:X+8;return Math.max(10,Math.min(90,le))})},Ie=()=>{if(!a)return;const Y=["rock","car","truck"],X=Y[Math.floor(Math.random()*Y.length)],le=[15,50,85],ve=le[Math.floor(Math.random()*le.length)]+(Math.random()-.5)*20;b(Me=>[...Me,{id:Date.now(),x:ve,y:0,type:X}])},Re=(Y,X)=>Math.abs(Y-X)<20/2;g.useEffect(()=>{if(!a)return;const Y=setInterval(()=>{u(X=>X<=.1?(ge(),0):X-.1),Math.random()<.9+w*.15&&Ie(),b(X=>{const le=X.map(Me=>({...Me,y:Me.y+x})).filter(Me=>Me.y<100);let be=!1;return le.filter(Me=>{if(Me.y>70&&Me.y<85){if(Re(h,Me.x))return be||(A(0),i(Ve=>Math.max(0,Ve-10)),E(!0),T(!0),H({x:h,y:75}),v(!0),setTimeout(()=>{E(!1),T(!1),v(!1)},800),be=!0),!1;A(Ve=>Ve+1),i(Ve=>Ve+5+j),j>=5&&(O(!0),setTimeout(()=>O(!1),1e3))}return!0})}),t>w*100&&(I(X=>X+1),S(X=>Math.min(8,X+.5)))},100);return()=>clearInterval(Y)},[a,x,w,h,j]),g.useEffect(()=>{const Y=X=>{a&&(X.key==="ArrowLeft"||X.key==="a"?oe("left"):(X.key==="ArrowRight"||X.key==="d")&&oe("right"))};return window.addEventListener("keydown",Y),()=>window.removeEventListener("keydown",Y)},[a]);const te=Y=>{const X={rock:{background:"#8B4513",borderRadius:"50%"},car:{background:"#FF4444",borderRadius:"5px"},truck:{background:"#FF8800",borderRadius:"8px"}};return X[Y]||X.rock},W=Y=>{if(!a)return;Y.preventDefault();const X=Y.touches[0],le=window.innerWidth;X.clientX<le/2?oe("left"):oe("right")};return r.jsxs("div",{style:{width:"100vw",height:"100vh",background:"linear-gradient(180deg, #87CEEB 0%, #98FB98 100%)",position:"relative",overflow:"auto",fontFamily:"Arial, sans-serif",touchAction:"pan-y"},onTouchStart:W,children:[r.jsx("button",{onClick:n,style:{position:"absolute",top:"clamp(20px, 4vw, 40px)",left:"clamp(20px, 4vw, 40px)",background:"#fff",border:"2px solid #9C27B0",borderRadius:"50%",width:"clamp(40px, 8vw, 50px)",height:"clamp(40px, 8vw, 50px)",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",fontSize:"clamp(1.2rem, 3vw, 1.5rem)",zIndex:1e3,boxShadow:"0 2px 8px rgba(0,0,0,0.2)"},children:"←"}),r.jsxs("div",{style:{position:"absolute",top:"clamp(20px, 4vw, 40px)",left:"clamp(80px, 16vw, 100px)",background:"rgba(255,255,255,0.9)",padding:"clamp(8px, 1.5vw, 12px)",borderRadius:"10px",fontSize:"clamp(0.8rem, 2vw, 1rem)",zIndex:100},children:[r.jsxs("div",{children:[L("score"),": ",t]}),r.jsxs("div",{children:[L("time"),": ",c,"s"]}),r.jsxs("div",{children:[L("level"),": ",w]}),r.jsxs("div",{children:[L("combo"),": ",j]})]}),r.jsx("div",{style:{position:"absolute",bottom:"20%",left:"0",right:"0",height:"60%",background:"linear-gradient(90deg, #696969 0%, #A9A9A9 20%, #696969 40%, #A9A9A9 60%, #696969 80%, #A9A9A9 100%)",borderTop:"4px solid #FFD700",borderBottom:"4px solid #FFD700"}}),r.jsx("div",{style:{position:"absolute",bottom:"25%",left:`${h}%`,transform:"translateX(-50%)",width:"clamp(40px, 8vw, 60px)",height:"clamp(20px, 4vw, 30px)",background:R?"linear-gradient(45deg, #FF0000, #FF4444)":"linear-gradient(45deg, #FF4444, #FF6666)",borderRadius:"8px",border:R?"3px solid #FF0000":"2px solid #CC0000",zIndex:10,transition:"left 0.1s ease",animation:R?"collisionShake 0.5s ease-in-out":"none"},children:r.jsx("div",{style:{position:"absolute",top:"-8px",left:"50%",transform:"translateX(-50%)",width:"clamp(20px, 4vw, 30px)",height:"clamp(8px, 1.5vw, 12px)",background:"#444",borderRadius:"4px"}})}),f.map(Y=>r.jsx("div",{style:{position:"absolute",top:`${Y.y}%`,left:`${Y.x}%`,transform:"translateX(-50%)",width:"clamp(30px, 6vw, 45px)",height:"clamp(15px, 3vw, 22px)",...te(Y.type),zIndex:5}},Y.id)),D&&r.jsxs("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",fontSize:"clamp(2rem, 5vw, 3rem)",fontWeight:"bold",color:"#FFD700",textShadow:"0 0 20px #FFD700",animation:"comboEffect 1s ease-out forwards",pointerEvents:"none",zIndex:1e3},children:["COMBO x",j,"!"]}),k&&r.jsx("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",fontSize:"clamp(2rem, 5vw, 3rem)",fontWeight:"bold",color:"#FF0000",textShadow:"0 0 20px #FF0000",animation:"collisionEffect 0.5s ease-out forwards",pointerEvents:"none",zIndex:1e3},children:"BOOM!"}),_&&r.jsx("div",{style:{position:"absolute",left:`${z.x}%`,top:`${z.y}%`,transform:"translate(-50%, -50%)",width:"clamp(60px, 12vw, 80px)",height:"clamp(60px, 12vw, 80px)",animation:"explosionEffect 0.8s ease-out forwards",pointerEvents:"none",zIndex:999},children:r.jsx("div",{style:{width:"100%",height:"100%",background:"radial-gradient(circle, #FFD700 0%, #FF8800 30%, #FF4444 60%, #FF0000 100%)",borderRadius:"50%",boxShadow:"0 0 30px #FFD700, 0 0 60px #FF8800, 0 0 90px #FF4444"}})}),r.jsx("style",{children:`
          @keyframes collisionShake {
            0%, 100% { transform: translateX(-50%) translateY(0px); }
            25% { transform: translateX(-50%) translateY(-5px) translateX(-3px); }
            50% { transform: translateX(-50%) translateY(0px) translateX(3px); }
            75% { transform: translateX(-50%) translateY(-5px) translateX(-3px); }
          }
          @keyframes collisionEffect {
            0% { 
              transform: translate(-50%, -50%) scale(0.5);
              opacity: 0;
            }
            50% { 
              transform: translate(-50%, -50%) scale(1.2);
              opacity: 1;
            }
            100% { 
              transform: translate(-50%, -50%) scale(1);
              opacity: 0;
            }
          }
          @keyframes explosionEffect {
            0% { 
              transform: translate(-50%, -50%) scale(0.1);
              opacity: 1;
            }
            50% { 
              transform: translate(-50%, -50%) scale(1.5);
              opacity: 1;
            }
            100% { 
              transform: translate(-50%, -50%) scale(2);
              opacity: 0;
            }
          }
        `}),r.jsxs("div",{style:{position:"absolute",bottom:"clamp(10px, 2vw, 20px)",left:"50%",transform:"translateX(-50%)",display:"flex",gap:"clamp(10px, 2vw, 20px)",zIndex:100},children:[r.jsx("button",{onClick:()=>oe("left"),style:{background:"#FF4444",color:"#fff",border:"none",borderRadius:"50%",width:"clamp(50px, 10vw, 70px)",height:"clamp(50px, 10vw, 70px)",fontSize:"clamp(1.5rem, 3vw, 2rem)",cursor:"pointer",fontWeight:"bold"},children:"←"}),r.jsx("button",{onClick:()=>oe("right"),style:{background:"#FF4444",color:"#fff",border:"none",borderRadius:"50%",width:"clamp(50px, 10vw, 70px)",height:"clamp(50px, 10vw, 70px)",fontSize:"clamp(1.5rem, 3vw, 2rem)",cursor:"pointer",fontWeight:"bold"},children:"→"})]}),!a&&r.jsxs("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",background:"rgba(255,255,255,0.95)",borderRadius:"20px",padding:"clamp(20px, 4vw, 30px)",textAlign:"center",zIndex:1001},children:[r.jsx("h2",{style:{fontSize:"clamp(1.5rem, 3.5vw, 2rem)",margin:"0 0 15px 0",color:"#E91E63"},children:L("title")}),r.jsx("p",{style:{fontSize:"clamp(0.9rem, 2vw, 1rem)",marginBottom:"20px",color:"#666"},children:"使用方向鍵或按鈕控制賽車，避開障礙物！"}),r.jsxs("div",{style:{display:"flex",gap:"10px",justifyContent:"center"},children:[r.jsx("button",{onClick:ee,style:{background:"#E91E63",color:"#fff",border:"none",borderRadius:"15px",padding:"clamp(10px, 2vw, 15px) clamp(20px, 4vw, 30px)",fontSize:"clamp(1rem, 2.5vw, 1.2rem)",cursor:"pointer",fontWeight:"bold"},children:L("start")}),r.jsx("button",{onClick:()=>B(!0),style:{background:"#666",color:"#fff",border:"none",borderRadius:"15px",padding:"clamp(10px, 2vw, 15px) clamp(20px, 4vw, 30px)",fontSize:"clamp(1rem, 2.5vw, 1.2rem)",cursor:"pointer"},children:L("rules")})]})]}),P&&r.jsx("div",{style:{position:"absolute",top:"0",left:"0",right:"0",bottom:"0",background:"rgba(0,0,0,0.8)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1002},children:r.jsxs("div",{style:{background:"rgba(255,255,255,0.95)",borderRadius:"20px",padding:"clamp(20px, 4vw, 30px)",maxWidth:"clamp(300px, 80vw, 500px)",maxHeight:"clamp(400px, 80vh, 600px)",overflow:"auto"},children:[r.jsxs("h3",{style:{fontSize:"clamp(1.2rem, 3vw, 1.5rem)",margin:"0 0 15px 0",color:"#E91E63",textAlign:"center"},children:[L("title")," - ",L("rules")]}),r.jsxs("div",{style:{fontSize:"clamp(0.9rem, 2vw, 1rem)",lineHeight:"1.6"},children:[r.jsx("p",{children:r.jsxs("strong",{children:["🎮 ",L("controlMethod"),"："]})}),r.jsxs("ul",{children:[r.jsx("li",{children:L("useArrowKeysOrButtons")}),r.jsx("li",{children:L("moveLeftRightToAvoid")})]}),r.jsx("p",{children:r.jsxs("strong",{children:["🎯 ",L("gameObjective"),"："]})}),r.jsxs("ul",{children:[r.jsx("li",{children:L("avoidAllObstacles")}),r.jsx("li",{children:L("successfulAvoidance")}),r.jsx("li",{children:L("collisionPenalty")})]}),r.jsx("p",{children:r.jsxs("strong",{children:["🏆 ",L("scoringSystem"),"："]})}),r.jsxs("ul",{children:[r.jsx("li",{children:L("baseScore")}),r.jsx("li",{children:L("comboBonus")}),r.jsx("li",{children:L("levelUp")}),r.jsx("li",{children:L("speedIncrease")})]}),r.jsx("p",{children:r.jsxs("strong",{children:["⏰ ",L("gameTime"),"："]})}),r.jsxs("ul",{children:[r.jsx("li",{children:L("sixtySecondsPerGame")}),r.jsx("li",{children:L("autoScoreWhenTimeUp")})]})]}),r.jsx("button",{onClick:()=>B(!1),style:{background:"#E91E63",color:"#fff",border:"none",borderRadius:"15px",padding:"clamp(8px, 1.5vw, 12px) clamp(16px, 3vw, 24px)",fontSize:"clamp(0.9rem, 2vw, 1rem)",cursor:"pointer",marginTop:"20px",width:"100%"},children:L("close")})]})}),!a&&t>0&&r.jsxs("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",background:"rgba(255,255,255,0.95)",borderRadius:"20px",padding:"clamp(20px, 4vw, 30px)",textAlign:"center",zIndex:1001},children:[r.jsxs("h2",{style:{fontSize:"clamp(1.5rem, 3.5vw, 2rem)",margin:"0 0 15px 0",color:"#E91E63"},children:[L("gameOver"),"！"]}),r.jsxs("div",{style:{fontSize:"clamp(1rem, 2.5vw, 1.2rem)",marginBottom:"10px"},children:[L("finalScore"),"：",t]}),r.jsxs("div",{style:{fontSize:"clamp(0.9rem, 2vw, 1rem)",marginBottom:"20px",color:"#666"},children:[L("highScore"),"：",s]}),r.jsxs("div",{style:{display:"flex",gap:"10px",justifyContent:"center"},children:[r.jsx("button",{onClick:ee,style:{background:"#E91E63",color:"#fff",border:"none",borderRadius:"15px",padding:"clamp(8px, 1.5vw, 12px) clamp(16px, 3vw, 24px)",fontSize:"clamp(0.9rem, 2vw, 1rem)",cursor:"pointer"},children:L("restart")}),r.jsx("button",{onClick:n,style:{background:"#666",color:"#fff",border:"none",borderRadius:"15px",padding:"clamp(8px, 1.5vw, 12px) clamp(16px, 3vw, 24px)",fontSize:"clamp(0.9rem, 2vw, 1rem)",cursor:"pointer"},children:L("back")})]})]})]})}function z5({onClose:n}){const{lang:e}=Qe(),[t,i]=g.useState(0),[s,o]=g.useState(0),[a,l]=g.useState(!1),[c,u]=g.useState(60),[h,p]=g.useState([]),[f,b]=g.useState(0),[x,S]=g.useState(!1),[w,I]=g.useState(null),[j,A]=g.useState(!0),[D,O]=g.useState(!1),P=_=>{var z;const v={"zh-TW":{score:"分數",time:"時間",combo:"連擊",title:"音樂節奏",rules:"遊戲規則",close:"關閉",gameOver:"遊戲結束",gameplay:"遊戲玩法",clickMovingRhythmPoints:"點擊從上往下移動的節奏點",fourColorsCorrespondToDifferentAudio:"四種顏色的節奏點對應不同音頻",redBlueGreenYellowFrequencies:"紅色(440Hz)、藍色(523Hz)、綠色(659Hz)、黃色(784Hz)",accuracyScoring:"精準度計分",perfect100ms:"Perfect (100ms內)：+10分",good200ms:"Good (200ms內)：+5分",ok300ms:"OK (300ms內)：+2分",missOver300ms:"Miss (超過300ms)：0分",scoring:"計分",eachSuccessfulClickIncreasesCombo:"每次成功點擊增加連擊數",combo5TimesTriggersEffect:"連擊5次以上觸發特效",missingRhythmPointResetsCombo:"錯過節奏點重置連擊",soundControl:"音效控制",soundSwitchInTopRight:"右上角音效開關控制",clickRhythmPointPlaysAudio:"點擊節奏點會播放對應音頻",canTurnSoundOnOffAnytime:"可隨時開啟/關閉音效",gameTime:"遊戲時間",sixtySecondsPerGame:"每局遊戲60秒",autoScoreWhenTimeUp:"時間結束自動結算分數",clickRhythmPointsFollowMusic:"點擊節奏點，跟隨音樂節奏！"},"zh-CN":{score:"分数",time:"时间",combo:"连击",title:"音乐节奏",rules:"游戏规则",close:"关闭",gameplay:"游戏玩法",clickMovingRhythmPoints:"点击从上往下移动的节奏点",fourColorsCorrespondToDifferentAudio:"四种颜色的节奏点对应不同音频",redBlueGreenYellowFrequencies:"红色(440Hz)、蓝色(523Hz)、绿色(659Hz)、黄色(784Hz)",accuracyScoring:"精准度计分",perfect100ms:"Perfect (100ms内)：+10分",good200ms:"Good (200ms内)：+5分",ok300ms:"OK (300ms内)：+2分",missOver300ms:"Miss (超过300ms)：0分",scoring:"计分",eachSuccessfulClickIncreasesCombo:"每次成功点击增加连击数",combo5TimesTriggersEffect:"连击5次以上触发特效",missingRhythmPointResetsCombo:"错过节奏点重置连击",soundControl:"音效控制",soundSwitchInTopRight:"右上角音效开关控制",clickRhythmPointPlaysAudio:"点击节奏点会播放对应音频",canTurnSoundOnOffAnytime:"可随时开启/关闭音效",gameTime:"游戏时间",sixtySecondsPerGame:"每局游戏60秒",autoScoreWhenTimeUp:"时间结束自动结算分数",clickRhythmPointsFollowMusic:"点击节奏点，跟随音乐节奏！"},en:{score:"Score",time:"Time",combo:"Combo",title:"Music Rhythm",rules:"Game Rules",close:"Close",gameplay:"Gameplay",clickMovingRhythmPoints:"Click rhythm points moving from top to bottom",fourColorsCorrespondToDifferentAudio:"Four colors of rhythm points correspond to different audio",redBlueGreenYellowFrequencies:"Red (440Hz), Blue (523Hz), Green (659Hz), Yellow (784Hz)",accuracyScoring:"Accuracy Scoring",perfect100ms:"Perfect (within 100ms): +10 points",good200ms:"Good (within 200ms): +5 points",ok300ms:"OK (within 300ms): +2 points",missOver300ms:"Miss (over 300ms): 0 points",scoring:"Scoring",eachSuccessfulClickIncreasesCombo:"Each successful click increases combo count",combo5TimesTriggersEffect:"Combo 5 times or more triggers special effects",missingRhythmPointResetsCombo:"Missing rhythm point resets combo",soundControl:"Sound Control",soundSwitchInTopRight:"Sound switch control in top right corner",clickRhythmPointPlaysAudio:"Clicking rhythm points plays corresponding audio",canTurnSoundOnOffAnytime:"Can turn sound on/off anytime",gameTime:"Game Time",sixtySecondsPerGame:"60 seconds per game",autoScoreWhenTimeUp:"Auto score when time is up",clickRhythmPointsFollowMusic:"Click rhythm points, follow the music rhythm!"},ja:{score:"スコア",time:"時間",combo:"コンボ",title:"音楽リズム",rules:"ゲームルール",close:"閉じる",gameplay:"ゲームプレイ",clickMovingRhythmPoints:"上から下に移動するリズムポイントをクリック",fourColorsCorrespondToDifferentAudio:"4色のリズムポイントが異なる音声に対応",redBlueGreenYellowFrequencies:"赤(440Hz)、青(523Hz)、緑(659Hz)、黄(784Hz)",accuracyScoring:"精度スコアリング",perfect100ms:"Perfect (100ms以内)：+10ポイント",good200ms:"Good (200ms以内)：+5ポイント",ok300ms:"OK (300ms以内)：+2ポイント",missOver300ms:"Miss (300ms超過)：0ポイント",scoring:"スコアリング",eachSuccessfulClickIncreasesCombo:"各成功クリックでコンボ数増加",combo5TimesTriggersEffect:"コンボ5回以上でエフェクト発動",missingRhythmPointResetsCombo:"リズムポイントを逃すとコンボリセット",soundControl:"サウンドコントロール",soundSwitchInTopRight:"右上のサウンドスイッチ制御",clickRhythmPointPlaysAudio:"リズムポイントクリックで対応音声再生",canTurnSoundOnOffAnytime:"いつでもサウンドオン/オフ可能",gameTime:"ゲーム時間",sixtySecondsPerGame:"ゲームあたり60秒",autoScoreWhenTimeUp:"時間切れで自動スコア",clickRhythmPointsFollowMusic:"リズムポイントをクリックして、音楽のリズムに従ってください！"},ko:{score:"점수",time:"시간",combo:"콤보",title:"음악 리듬",rules:"게임 규칙",close:"닫기",gameplay:"게임 플레이",clickMovingRhythmPoints:"위에서 아래로 이동하는 리듬 포인트 클릭",fourColorsCorrespondToDifferentAudio:"4가지 색상의 리듬 포인트가 다른 오디오에 대응",redBlueGreenYellowFrequencies:"빨강(440Hz)、파랑(523Hz)、초록(659Hz)、노랑(784Hz)",accuracyScoring:"정확도 점수",perfect100ms:"Perfect (100ms 이내)：+10점",good200ms:"Good (200ms 이내)：+5점",ok300ms:"OK (300ms 이내)：+2점",missOver300ms:"Miss (300ms 초과)：0점",scoring:"점수",eachSuccessfulClickIncreasesCombo:"각 성공 클릭마다 콤보 수 증가",combo5TimesTriggersEffect:"콤보 5회 이상 시 특수 효과 발동",missingRhythmPointResetsCombo:"리듬 포인트 놓치면 콤보 리셋",soundControl:"사운드 제어",soundSwitchInTopRight:"우상단 사운드 스위치 제어",clickRhythmPointPlaysAudio:"리듬 포인트 클릭 시 해당 오디오 재생",canTurnSoundOnOffAnytime:"언제든지 사운드 켜기/끄기 가능",gameTime:"게임 시간",sixtySecondsPerGame:"게임당 60초",autoScoreWhenTimeUp:"시간 종료 시 자동 점수",clickRhythmPointsFollowMusic:"리듬 포인트를 클릭하고 음악 리듬을 따라가세요!"},vi:{score:"Điểm",time:"Thời Gian",combo:"Combo",title:"Nhịp Điệu Âm Nhạc",rules:"Luật Chơi",close:"Đóng",gameplay:"Cách Chơi",clickMovingRhythmPoints:"Nhấp vào các điểm nhịp điệu di chuyển từ trên xuống dưới",fourColorsCorrespondToDifferentAudio:"Bốn màu của điểm nhịp điệu tương ứng với âm thanh khác nhau",redBlueGreenYellowFrequencies:"Đỏ (440Hz), Xanh dương (523Hz), Xanh lá (659Hz), Vàng (784Hz)",accuracyScoring:"Điểm Độ Chính Xác",perfect100ms:"Perfect (trong 100ms): +10 điểm",good200ms:"Good (trong 200ms): +5 điểm",ok300ms:"OK (trong 300ms): +2 điểm",missOver300ms:"Miss (trên 300ms): 0 điểm",scoring:"Điểm Số",eachSuccessfulClickIncreasesCombo:"Mỗi lần nhấp thành công tăng số combo",combo5TimesTriggersEffect:"Combo 5 lần trở lên kích hoạt hiệu ứng đặc biệt",missingRhythmPointResetsCombo:"Bỏ lỡ điểm nhịp điệu reset combo",soundControl:"Điều Khiển Âm Thanh",soundSwitchInTopRight:"Công tắc âm thanh ở góc trên bên phải",clickRhythmPointPlaysAudio:"Nhấp điểm nhịp điệu phát âm thanh tương ứng",canTurnSoundOnOffAnytime:"Có thể bật/tắt âm thanh bất cứ lúc nào",gameTime:"Thời Gian Trò Chơi",sixtySecondsPerGame:"60 giây mỗi trò chơi",autoScoreWhenTimeUp:"Tự động tính điểm khi hết thời gian",clickRhythmPointsFollowMusic:"Nhấp vào điểm nhịp điệu, theo nhịp điệu âm nhạc!"},th:{score:"คะแนน",time:"เวลา",combo:"คอมโบ",title:"จังหวะดนตรี",rules:"กฎเกม",close:"ปิด",gameplay:"วิธีเล่น",clickMovingRhythmPoints:"คลิกจุดจังหวะที่เคลื่อนที่จากบนลงล่าง",fourColorsCorrespondToDifferentAudio:"สี่สีของจุดจังหวะสอดคล้องกับเสียงที่แตกต่างกัน",redBlueGreenYellowFrequencies:"แดง (440Hz)、น้ำเงิน (523Hz)、เขียว (659Hz)、เหลือง (784Hz)",accuracyScoring:"คะแนนความแม่นยำ",perfect100ms:"Perfect (ภายใน 100ms)：+10 คะแนน",good200ms:"Good (ภายใน 200ms)：+5 คะแนน",ok300ms:"OK (ภายใน 300ms)：+2 คะแนน",missOver300ms:"Miss (เกิน 300ms)：0 คะแนน",scoring:"คะแนน",eachSuccessfulClickIncreasesCombo:"แต่ละการคลิกที่สำเร็จเพิ่มจำนวนคอมโบ",combo5TimesTriggersEffect:"คอมโบ 5 ครั้งขึ้นไปกระตุ้นเอฟเฟกต์พิเศษ",missingRhythmPointResetsCombo:"พลาดจุดจังหวะรีเซ็ตคอมโบ",soundControl:"ควบคุมเสียง",soundSwitchInTopRight:"สวิตช์เสียงควบคุมที่มุมขวาบน",clickRhythmPointPlaysAudio:"คลิกจุดจังหวะเล่นเสียงที่สอดคล้องกัน",canTurnSoundOnOffAnytime:"สามารถเปิด/ปิดเสียงได้ทุกเมื่อ",gameTime:"เวลาเกม",sixtySecondsPerGame:"60 วินาทีต่อเกม",autoScoreWhenTimeUp:"คะแนนอัตโนมัติเมื่อหมดเวลา",clickRhythmPointsFollowMusic:"คลิกจุดจังหวะและตามจังหวะดนตรี!"},la:{score:"Puncta",time:"Tempus",combo:"Combo",title:"Rhythmus Musicae",rules:"Regulae Ludi",close:"Claudere",gameplay:"Ludus",clickMovingRhythmPoints:"Clicca puncta rhythmi moventia de superiore ad inferiorem",fourColorsCorrespondToDifferentAudio:"Quattuor colores punctorum rhythmi correspondent diversis auditis",redBlueGreenYellowFrequencies:"Rubrum (440Hz), Caeruleum (523Hz), Viride (659Hz), Flavum (784Hz)",accuracyScoring:"Punctatio Accurationis",perfect100ms:"Perfect (intra 100ms): +10 puncta",good200ms:"Good (intra 200ms): +5 puncta",ok300ms:"OK (intra 300ms): +2 puncta",missOver300ms:"Miss (super 300ms): 0 puncta",scoring:"Punctatio",eachSuccessfulClickIncreasesCombo:"Quaelibet felix cliccatio auget numerum combo",combo5TimesTriggersEffect:"Combo 5 vicibus vel plus activat effectus speciales",missingRhythmPointResetsCombo:"Amittendo punctum rhythmi reset combo",soundControl:"Controllatio Sonorum",soundSwitchInTopRight:"Sonorum commutator in angulo superiore dextro",clickRhythmPointPlaysAudio:"Cliccando puncta rhythmi ludit auditum correspondentem",canTurnSoundOnOffAnytime:"Potest sonos aperire/claudere quandocumque",gameTime:"Tempus Ludi",sixtySecondsPerGame:"60 secundis pro quaque ludo",autoScoreWhenTimeUp:"Auto puncta quando tempus finitum est",clickRhythmPointsFollowMusic:"Puncta rhythmi preme et musicam sequere!"},ms:{score:"Markah",time:"Masa",combo:"Combo",title:"Irama Muzik",rules:"Peraturan Permainan",close:"Tutup",gameplay:"Cara Bermain",clickMovingRhythmPoints:"Klik titik irama yang bergerak dari atas ke bawah",fourColorsCorrespondToDifferentAudio:"Empat warna titik irama sepadan dengan audio berbeza",redBlueGreenYellowFrequencies:"Merah (440Hz), Biru (523Hz), Hijau (659Hz), Kuning (784Hz)",accuracyScoring:"Penilaian Ketepatan",perfect100ms:"Perfect (dalam 100ms): +10 markah",good200ms:"Good (dalam 200ms): +5 markah",ok300ms:"OK (dalam 300ms): +2 markah",missOver300ms:"Miss (melebihi 300ms): 0 markah",scoring:"Penilaian",eachSuccessfulClickIncreasesCombo:"Setiap klik berjaya menambah bilangan combo",combo5TimesTriggersEffect:"Combo 5 kali atau lebih mencetuskan kesan khas",missingRhythmPointResetsCombo:"Terlepas titik irama reset combo",soundControl:"Kawalan Bunyi",soundSwitchInTopRight:"Suis bunyi kawalan di sudut kanan atas",clickRhythmPointPlaysAudio:"Klik titik irama memainkan audio sepadan",canTurnSoundOnOffAnytime:"Boleh hidupkan/matikan bunyi bila-bila masa",gameTime:"Masa Permainan",sixtySecondsPerGame:"60 saat setiap permainan",autoScoreWhenTimeUp:"Markah automatik apabila masa habis",clickRhythmPointsFollowMusic:"Klik titik irama, ikut rentak muzik!"}};return((z=v[e])==null?void 0:z[_])||v["zh-TW"][_]||_};g.useEffect(()=>{const _=Ka("rhythm");_&&o(_.highScore||0)},[]),g.useEffect(()=>{s>0&&Ga("rhythm",{highScore:s})},[s]),g.useEffect(()=>{typeof window<"u"&&window.AudioContext&&I(new AudioContext)},[]);const B=()=>{i(0),u(60),p([]),b(0),l(!0)},k=()=>{l(!1),t>s&&o(t)},T=()=>{if(!a)return;const _=["red","blue","green","yellow"],v=_[Math.floor(Math.random()*_.length)],z=Math.random()*80+10;p(H=>[...H,{id:Date.now(),x:z,y:-10,type:v,timing:Date.now()}])},R=_=>{const v=h.find(L=>L.id===_);if(!v)return;const z=Date.now()-v.timing;let H=0;if(z<100?H=10:z<200?H=5:z<300?H=2:H=0,i(L=>L+H),b(L=>L+1),f>=5&&(S(!0),setTimeout(()=>S(!1),1e3)),w&&j){const L=w.createOscillator(),ee=w.createGain();L.connect(ee),ee.connect(w.destination);const ge={red:440,blue:523,green:659,yellow:784};L.frequency.setValueAtTime(ge[v.type],w.currentTime),L.type="sine",ee.gain.setValueAtTime(.3,w.currentTime),ee.gain.exponentialRampToValueAtTime(.01,w.currentTime+.1),L.start(w.currentTime),L.stop(w.currentTime+.1)}p(L=>L.filter(ee=>ee.id!==_))};g.useEffect(()=>{if(!a)return;const _=setInterval(()=>{u(v=>v<=1?(k(),0):v-1),Math.random()<.03&&T(),p(v=>{const z=v.map(H=>({...H,y:H.y+2})).filter(H=>H.y<110);return z.forEach(H=>{H.y>90&&(b(0),p(L=>L.filter(ee=>ee.id!==H.id)))}),z})},50);return()=>clearInterval(_)},[a]);const E=_=>({red:"#FF4444",blue:"#4444FF",green:"#44FF44",yellow:"#FFFF44"})[_]||"#FF4444";return r.jsxs("div",{style:{width:"100vw",height:"100vh",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",position:"relative",overflow:"hidden",fontFamily:"Arial, sans-serif"},children:[r.jsxs("div",{style:{position:"absolute",top:"clamp(20px, 4vw, 40px)",left:"clamp(80px, 16vw, 100px)",background:"rgba(255,255,255,0.9)",padding:"clamp(8px, 1.5vw, 12px)",borderRadius:"10px",fontSize:"clamp(0.8rem, 2vw, 1rem)",zIndex:100},children:[r.jsxs("div",{children:[P("score"),": ",t]}),r.jsxs("div",{children:[P("time"),": ",c,"s"]}),r.jsxs("div",{children:[P("combo"),": ",f]})]}),r.jsx("button",{onClick:()=>A(!j),style:{position:"absolute",top:"clamp(10px, 2vw, 20px)",right:"clamp(10px, 2vw, 20px)",background:j?"#4CAF50":"#f44336",color:"#fff",border:"none",borderRadius:"25px",padding:"clamp(8px, 1.5vw, 12px) clamp(16px, 3vw, 24px)",fontSize:"clamp(0.8rem, 2vw, 1rem)",cursor:"pointer",zIndex:100},children:j?"🔊":"🔇"}),r.jsx("div",{style:{position:"absolute",bottom:"20%",left:"10%",right:"10%",height:"60%",background:"rgba(0,0,0,0.3)",borderRadius:"20px",border:"2px solid rgba(255,255,255,0.3)"}}),h.map(_=>r.jsx("div",{onClick:()=>R(_.id),style:{position:"absolute",bottom:`${_.y}%`,left:`${_.x}%`,transform:"translateX(-50%)",width:"clamp(40px, 8vw, 60px)",height:"clamp(40px, 8vw, 60px)",background:E(_.type),borderRadius:"50%",cursor:"pointer",zIndex:10,boxShadow:`0 0 20px ${E(_.type)}`,animation:"pulse 0.5s ease-in-out infinite alternate"}},_.id)),x&&r.jsxs("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",fontSize:"clamp(2rem, 5vw, 3rem)",fontWeight:"bold",color:"#00BCD4",textShadow:"0 0 20px #00BCD4",animation:"comboEffect 1s ease-out forwards",pointerEvents:"none",zIndex:1e3},children:["COMBO x",f,"!"]}),!a&&r.jsxs("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",background:"rgba(255,255,255,0.95)",borderRadius:"20px",padding:"clamp(20px, 4vw, 30px)",textAlign:"center",zIndex:1001},children:[r.jsx("h2",{style:{fontSize:"clamp(1.5rem, 3.5vw, 2rem)",margin:"0 0 15px 0",color:"#00BCD4"},children:P("title")}),r.jsx("p",{style:{fontSize:"clamp(0.9rem, 2vw, 1rem)",marginBottom:"20px",color:"#666"},children:P("clickRhythmPointsFollowMusic")}),r.jsxs("div",{style:{display:"flex",gap:"10px",justifyContent:"center"},children:[r.jsx("button",{onClick:B,style:{background:"#00BCD4",color:"#fff",border:"none",borderRadius:"15px",padding:"clamp(10px, 2vw, 15px) clamp(20px, 4vw, 30px)",fontSize:"clamp(1rem, 2.5vw, 1.2rem)",cursor:"pointer",fontWeight:"bold"},children:P("start")}),r.jsx("button",{onClick:()=>O(!0),style:{background:"#666",color:"#fff",border:"none",borderRadius:"15px",padding:"clamp(10px, 2vw, 15px) clamp(20px, 4vw, 30px)",fontSize:"clamp(1rem, 2.5vw, 1.2rem)",cursor:"pointer"},children:P("rules")})]})]}),D&&r.jsx("div",{style:{position:"absolute",top:"0",left:"0",right:"0",bottom:"0",background:"rgba(0,0,0,0.8)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1002},children:r.jsxs("div",{style:{background:"rgba(255,255,255,0.95)",borderRadius:"20px",padding:"clamp(20px, 4vw, 30px)",maxWidth:"clamp(300px, 80vw, 500px)",maxHeight:"clamp(400px, 80vh, 600px)",overflow:"auto"},children:[r.jsxs("h3",{style:{fontSize:"clamp(1.2rem, 3vw, 1.5rem)",margin:"0 0 15px 0",color:"#00BCD4",textAlign:"center"},children:[P("rhythmGame")," - ",P("rules")]}),r.jsxs("div",{style:{fontSize:"clamp(0.9rem, 2vw, 1rem)",lineHeight:"1.6"},children:[r.jsx("p",{children:r.jsxs("strong",{children:["🎵 ",P("gameplay"),"："]})}),r.jsxs("ul",{children:[r.jsx("li",{children:P("clickMovingRhythmPoints")}),r.jsx("li",{children:P("fourColorsCorrespondToDifferentAudio")}),r.jsx("li",{children:P("redBlueGreenYellowFrequencies")})]}),r.jsx("p",{children:r.jsxs("strong",{children:["🎯 ",P("accuracyScoring"),"："]})}),r.jsxs("ul",{children:[r.jsx("li",{children:P("perfect100ms")}),r.jsx("li",{children:P("good200ms")}),r.jsx("li",{children:P("ok300ms")}),r.jsx("li",{children:P("missOver300ms")})]}),r.jsx("p",{children:r.jsxs("strong",{children:["🏆 ",P("scoring"),"："]})}),r.jsxs("ul",{children:[r.jsx("li",{children:P("eachSuccessfulClickIncreasesCombo")}),r.jsx("li",{children:P("combo5TimesTriggersEffect")}),r.jsx("li",{children:P("missingRhythmPointResetsCombo")})]}),r.jsx("p",{children:r.jsxs("strong",{children:["🔊 ",P("soundControl"),"："]})}),r.jsxs("ul",{children:[r.jsx("li",{children:P("soundSwitchInTopRight")}),r.jsx("li",{children:P("clickRhythmPointPlaysAudio")}),r.jsx("li",{children:P("canTurnSoundOnOffAnytime")})]}),r.jsx("p",{children:r.jsxs("strong",{children:["⏰ ",P("gameTime"),"："]})}),r.jsxs("ul",{children:[r.jsx("li",{children:P("sixtySecondsPerGame")}),r.jsx("li",{children:P("autoScoreWhenTimeUp")})]})]}),r.jsx("button",{onClick:()=>O(!1),style:{background:"#00BCD4",color:"#fff",border:"none",borderRadius:"15px",padding:"clamp(8px, 1.5vw, 12px) clamp(16px, 3vw, 24px)",fontSize:"clamp(0.9rem, 2vw, 1rem)",cursor:"pointer",marginTop:"20px",width:"100%"},children:P("close")})]})}),!a&&t>0&&r.jsxs("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",background:"rgba(255,255,255,0.95)",borderRadius:"20px",padding:"clamp(20px, 4vw, 30px)",textAlign:"center",zIndex:1001},children:[r.jsxs("h2",{style:{fontSize:"clamp(1.5rem, 3.5vw, 2rem)",margin:"0 0 15px 0",color:"#00BCD4"},children:[P("gameOver"),"！"]}),r.jsxs("div",{style:{fontSize:"clamp(1rem, 2.5vw, 1.2rem)",marginBottom:"10px"},children:[P("finalScore"),"：",t]}),r.jsxs("div",{style:{fontSize:"clamp(0.9rem, 2vw, 1rem)",marginBottom:"20px",color:"#666"},children:[P("highScore"),"：",s]}),r.jsxs("div",{style:{display:"flex",gap:"10px",justifyContent:"center"},children:[r.jsx("button",{onClick:B,style:{background:"#00BCD4",color:"#fff",border:"none",borderRadius:"15px",padding:"clamp(8px, 1.5vw, 12px) clamp(16px, 3vw, 24px)",fontSize:"clamp(0.9rem, 2vw, 1rem)",cursor:"pointer"},children:P("restart")}),r.jsx("button",{onClick:n,style:{background:"#666",color:"#fff",border:"none",borderRadius:"15px",padding:"clamp(8px, 1.5vw, 12px) clamp(16px, 3vw, 24px)",fontSize:"clamp(0.9rem, 2vw, 1rem)",cursor:"pointer"},children:P("back")})]})]}),r.jsx("style",{children:`
        @keyframes pulse {
          0% { transform: translateX(-50%) scale(1); }
          100% { transform: translateX(-50%) scale(1.1); }
        }
        @keyframes comboEffect {
          0% { opacity: 0; transform: translate(-50%, -50%) scale(0.5); }
          50% { opacity: 1; transform: translate(-50%, -50%) scale(1.2); }
          100% { opacity: 0; transform: translate(-50%, -50%) scale(1); }
        }
      `})]})}const Py={"zh-TW":{title:"社會融入度評估",subtitle:"評估您的社會融入度，獲得專業建議",subtitle2:"勇敢面對並定期檢測自身社會融入程度進步狀況，每一次評估都是成長的機會",backToHome:"返回",startAssessment:"開始評估",submitAssessment:"提交評估",cancelAssessment:"取消",closeAssessment:"關閉",assessmentComplete:"評估完成",viewReport:"查看報告",closeReport:"關閉報告",q1Title:"人際關係",q1Desc:"最近3個月，您與他人的互動和社交能力如何？包括與同事、朋友、鄰居的日常交流，以及在新環境中建立關係的能力。您是否能夠主動與他人溝通，建立信任關係，並在社交場合中感到自在？",q2Title:"就業狀況",q2Desc:"最近1年，您的工作穩定性和發展前景如何？包括工作滿意度、薪資待遇、職業發展機會、工作環境適應性，以及對未來職業規劃的清晰度。您是否對當前工作感到滿意，並有明確的職業發展目標？",q3Title:"家庭關係",q3Desc:"最近6個月，您與家人的相處和溝通狀況如何？包括與配偶、子女、父母或其他家庭成員的關係質量，溝通頻率和效果，以及家庭氛圍的和諧程度。您是否能夠有效處理家庭衝突，並為家庭成員提供情感支持？",q4Title:"未來信心",q4Desc:"您對未來1年的樂觀程度和規劃如何？包括對個人發展的信心，對生活目標的清晰度，以及面對挑戰時的積極態度。您是否對未來有明確的規劃，並相信自己能夠實現目標？",q5Title:"社會接納",q5Desc:"最近6個月，您感覺被社會接受和認可的程度如何？包括在社區中的融入度，社會地位的認同感，以及對社會規範的適應能力。您是否感到被社會接納，並對自己的社會角色感到滿意？",q6Title:"情緒管理",q6Desc:"最近3個月，您處理壓力和負面情緒的能力如何？包括面對挫折時的情緒反應，壓力調節方法，以及心理健康維護的意識。您是否能夠有效管理負面情緒，並在壓力下保持冷靜？",q7Title:"生活規律",q7Desc:"最近6個月，您的生活作息和規律性如何？包括日常作息時間，飲食習慣，運動頻率，以及生活節奏的穩定性。您是否能夠維持健康的生活習慣，並建立規律的日常生活？",q8Title:"學習成長",q8Desc:"最近1年，您在技能學習和個人成長方面的投入如何？包括新技能學習，知識更新，自我提升的積極性，以及對個人發展的投資。您是否持續學習新知識，並主動尋求個人成長機會？",q9Title:"財務管理",q9Desc:"最近1年，您的財務規劃和理財能力如何？包括收入支出管理，儲蓄習慣，投資理財意識，以及對未來財務安全的規劃。您是否能夠有效管理個人財務，並為未來做好財務準備？",q10Title:"健康狀況",q10Desc:"最近6個月，您的身體和心理健康狀況如何？包括身體健康狀況，心理健康狀態，醫療保健意識，以及對健康問題的預防和處理能力。您是否重視健康管理，並採取積極的健康維護措施？",q11Title:"社交網絡",q11Desc:"最近3個月，您建立和維護社交關係的能力如何？包括朋友數量，社交活動參與度，人際關係質量，以及社交網絡的廣度和深度。您是否擁有穩定的社交圈，並能夠與他人建立有意義的關係？",q12Title:"目標設定",q12Desc:"最近1年，您設定和追求個人目標的能力如何？包括目標的明確性，計劃的可行性，執行力，以及對目標達成度的評估。您是否能夠設定清晰的目標，並有效執行計劃？",q13Title:"適應能力",q13Desc:"最近6個月，您適應環境變化和挑戰的能力如何？包括面對新環境的適應速度，應對變化的靈活性，以及從挫折中恢復的能力。您是否能夠快速適應新環境，並在變化中保持穩定？",q14Title:"責任感",q14Desc:"最近1年，您對自己和他人負責的態度如何？包括對個人行為的責任感，對他人承諾的履行，以及對社會責任的認知。您是否能夠承擔個人責任，並對他人和社會負責？",q15Title:"自我認同",q15Desc:"最近6個月，您對自我價值和身份的認同感如何？包括對個人價值的認知，自我接納程度，以及對個人身份的滿意度。您是否對自己有清晰的認知，並能夠接納自己的優缺點？",q16Title:"社區參與",q16Desc:"最近1年，您參與社區活動和公益服務的情況如何？包括志願服務參與度，社區活動貢獻，以及對社會公益的關注和參與。您是否積極參與社區活動，並為社會做出貢獻？",q17Title:"職業發展",q17Desc:"最近1年，您在職業技能提升和職涯規劃方面的表現如何？包括專業技能發展，職業規劃清晰度，以及對職業發展機會的把握。您是否持續提升職業技能，並有明確的職業發展路徑？",q18Title:"人際衝突處理",q18Desc:"最近3個月，您處理人際衝突和分歧的能力如何？包括衝突解決技巧，溝通協調能力，以及維護關係的智慧。您是否能夠有效處理人際衝突，並在分歧中尋求共識？",q19Title:"時間管理",q19Desc:"最近1年，您合理安排時間和優先級的能力如何？包括時間規劃效率，任務優先級設定，以及工作生活平衡的維持。您是否能夠有效管理時間，並在多重任務中保持效率？",q20Title:"整體滿意度",q20Desc:"最近6個月，您對整體生活狀況的滿意度如何？包括對生活質量的整體評價，對個人成就的滿意度，以及對未來生活前景的樂觀程度。您是否對當前的生活狀況感到滿意，並對未來充滿希望？",excellent:"非常好",good:"良好",fair:"一般",poor:"需要改善",terrible:"非常糟糕",scoreLabel:"評估分數",resultLabel:"評估結果",descriptionLabel:"詳細分析",recommendationsLabel:"改善建議",analysisLabel:"專業分析",privacyPolicy:"隱私權政策",terms:"條款/聲明",dataDeletion:"資料刪除說明",about:"🧬 Restarter™｜我們是誰",feedback:"💬 意見箱｜我們想聽你說"},"zh-CN":{title:"社会融入度评估",subtitle:"评估您的社会融入度，获得专业建议",subtitle2:"勇敢面对并定期检测自身社会融入程度进步状况，每一次评估都是成长的机会",backToHome:"返回",startAssessment:"开始评估",submitAssessment:"提交评估",cancelAssessment:"取消",closeAssessment:"关闭",assessmentComplete:"评估完成",viewReport:"查看报告",closeReport:"关闭报告",q1Title:"人际关系",q1Desc:"最近3个月，您与他人的互动和社交能力如何？包括与同事、朋友、邻居的日常交流，以及在新环境中建立关系的能力。您是否能够主动与他人沟通，建立信任关系，并在社交场合中感到自在？",q2Title:"就业状况",q2Desc:"最近1年，您的工作稳定性和发展前景如何？包括工作满意度、薪资待遇、职业发展机会、工作环境适应性，以及对未来职业规划的清晰度。您是否对当前工作感到满意，并有明确的职业发展目标？",q3Title:"家庭关系",q3Desc:"最近6个月，您与家人的相处和沟通状况如何？包括与配偶、子女、父母或其他家庭成员的关系质量，沟通频率和效果，以及家庭氛围的和谐程度。您是否能够有效处理家庭冲突，并为家庭成员提供情感支持？",q4Title:"未来信心",q4Desc:"您对未来1年的乐观程度和规划如何？包括对个人发展的信心，对生活目标的清晰度，以及面对挑战时的积极态度。您是否对未来有明确的规划，并相信自己能够实现目标？",q5Title:"社会接纳",q5Desc:"最近6个月，您感觉被社会接受和认可的程度如何？包括在社区中的融入度，社会地位的认同感，以及对社会规范的适应能力。您是否感到被社会接纳，并对自己的社会角色感到满意？",q6Title:"情绪管理",q6Desc:"最近3个月，您处理压力和负面情绪的能力如何？包括面对挫折时的情绪反应，压力调节方法，以及心理健康维护的意识。您是否能够有效管理负面情绪，并在压力下保持冷静？",q7Title:"生活规律",q7Desc:"最近6个月，您的生活作息和规律性如何？包括日常作息时间，饮食习惯，运动频率，以及生活节奏的稳定性。您是否能够维持健康的生活习惯，并建立规律的日常生活？",q8Title:"学习成长",q8Desc:"最近1年，您在技能学习和个人成长方面的投入如何？包括新技能学习，知识更新，自我提升的积极性，以及对个人发展的投资。您是否持续学习新知识，并主动寻求个人成长机会？",q9Title:"财务管理",q9Desc:"最近1年，您的财务规划和理财能力如何？包括收入支出管理，储蓄习惯，投资理财意识，以及对未来财务安全的规划。您是否能够有效管理个人财务，并为未来做好财务准备？",q10Title:"健康状况",q10Desc:"最近6个月，您的身体和心理健康状况如何？包括身体健康状况，心理健康状态，医疗保健意识，以及对健康问题的预防和处理能力。您是否重视健康管理，并采取积极的健康维护措施？",q11Title:"社交网络",q11Desc:"最近3个月，您建立和维护社交关系的能力如何？包括朋友数量，社交活动参与度，人际关系质量，以及社交网络的广度和深度。您是否拥有稳定的社交圈，并能够与他人建立有意义的关系？",q12Title:"目标设定",q12Desc:"最近1年，您设定和追求个人目标的能力如何？包括目标的明确性，计划的可行性，执行力，以及对目标达成度的评估。您是否能够设定清晰的目标，并有效执行计划？",q13Title:"适应能力",q13Desc:"最近6个月，您适应环境变化和挑战的能力如何？包括面对新环境的适应速度，应对变化的灵活性，以及从挫折中恢复的能力。您是否能够快速适应新环境，并在变化中保持稳定？",q14Title:"责任感",q14Desc:"最近1年，您对自己和他人负责的态度如何？包括对个人行为的责任感，对他人承诺的履行，以及对社会责任的认识。您是否能够承担个人责任，并对他人和社会负责？",q15Title:"自我认同",q15Desc:"最近6个月，您对自我价值和身份的认同感如何？包括对个人价值的认知，自我接纳程度，以及对个人身份的满意度。您是否对自己有清晰的认知，并能够接纳自己的优缺点？",q16Title:"社区参与",q16Desc:"最近1年，您参与社区活动和公益服务的情况如何？包括志愿服务参与度，社区活动贡献，以及对社会公益的关注和参与。您是否积极参与社区活动，并为社会做出贡献？",q17Title:"职业发展",q17Desc:"最近1年，您在职业技能提升和职涯规划方面的表现如何？包括专业技能发展，职业规划清晰度，以及对职业发展机会的把握。您是否持续提升职业技能，并有明确的职业发展路径？",q18Title:"人际冲突处理",q18Desc:"最近3个月，您处理人际冲突和分歧的能力如何？包括冲突解决技巧，沟通协调能力，以及维护关系的智慧。您是否能够有效处理人际冲突，并在分歧中寻求共识？",q19Title:"时间管理",q19Desc:"最近1年，您合理安排时间和优先级的能力如何？包括时间规划效率，任务优先级设定，以及工作生活平衡的维持。您是否能够有效管理时间，并在多重任务中保持效率？",q20Title:"整体满意度",q20Desc:"最近6个月，您对整体生活状况的满意度如何？包括对生活质量的整体评价，对个人成就的满意度，以及对未来生活前景的乐观程度。您是否对当前的生活状况感到满意，并对未来充满希望？",excellent:"非常好",good:"良好",fair:"一般",poor:"需要改善",terrible:"非常糟糕",scoreLabel:"评估分数",resultLabel:"评估结果",descriptionLabel:"详细分析",recommendationsLabel:"改善建议",analysisLabel:"专业分析",privacyPolicy:"隐私权政策",terms:"条款/声明",dataDeletion:"资料删除说明",about:"🧬 Restarter™｜我们是谁",feedback:"💬 意见箱｜我们想听你说"},en:{title:"Social Integration Assessment",subtitle:"Assess your social integration and get professional advice",subtitle2:"Face challenges bravely and regularly monitor your social integration progress, every assessment is an opportunity for growth",backToHome:"Back",startAssessment:"Start Assessment",submitAssessment:"Submit Assessment",cancelAssessment:"Cancel",closeAssessment:"Close",assessmentComplete:"Assessment Complete",viewReport:"View Report",closeReport:"Close Report",q1Title:"Interpersonal Relationships",q1Desc:"In the past 3 months, how is your interaction and social ability with others? Including daily communication with colleagues, friends, and neighbors, as well as the ability to build relationships in new environments. Are you able to actively communicate with others, build trust relationships, and feel comfortable in social situations?",q2Title:"Employment Status",q2Desc:"In the past year, how is your job stability and development prospects? Including job satisfaction, salary benefits, career development opportunities, work environment adaptability, and clarity of future career planning. Are you satisfied with your current job and have clear career development goals?",q3Title:"Family Relationships",q3Desc:"In the past 6 months, how is your relationship and communication with family? Including relationship quality with spouse, children, parents or other family members, communication frequency and effectiveness, and family atmosphere harmony. Are you able to effectively handle family conflicts and provide emotional support to family members?",q4Title:"Future Confidence",q4Desc:"In the past year, how optimistic are you about the future and your planning? Including confidence in personal development, clarity of life goals, and positive attitude when facing challenges. Do you have clear plans for the future and believe you can achieve your goals?",q5Title:"Social Acceptance",q5Desc:"In the past 6 months, how accepted and recognized do you feel by society? Including community integration, social status recognition, and adaptation to social norms. Do you feel accepted by society and satisfied with your social role?",q6Title:"Emotional Management",q6Desc:"In the past 3 months, how well do you handle stress and negative emotions? Including emotional responses when facing setbacks, stress regulation methods, and awareness of mental health maintenance. Are you able to effectively manage negative emotions and stay calm under pressure?",q7Title:"Life Routine",q7Desc:"In the past year, how regular is your daily routine and lifestyle? Including daily schedule, eating habits, exercise frequency, and stability of life rhythm. Are you able to maintain healthy living habits and establish regular daily life?",q8Title:"Learning & Growth",q8Desc:"In the past year, how much have you invested in skill learning and personal growth? Including new skill learning, knowledge updates, self-improvement initiative, and investment in personal development. Do you continuously learn new knowledge and actively seek personal growth opportunities?",q9Title:"Financial Management",q9Desc:"In the past year, how is your financial planning and money management? Including income and expense management, saving habits, investment awareness, and planning for future financial security. Are you able to effectively manage personal finances and prepare for the future?",q10Title:"Health Status",q10Desc:"In the past 6 months, how is your physical and mental health? Including physical health condition, mental health status, healthcare awareness, and ability to prevent and handle health issues. Do you value health management and take active health maintenance measures?",q11Title:"Social Network",q11Desc:"In the past 3 months, how well do you build and maintain social relationships? Including number of friends, social activity participation, relationship quality, and breadth and depth of social network. Do you have a stable social circle and can build meaningful relationships with others?",q12Title:"Goal Setting",q12Desc:"In the past year, how well do you set and pursue personal goals? Including goal clarity, plan feasibility, execution ability, and assessment of goal achievement. Are you able to set clear goals and effectively execute plans?",q13Title:"Adaptability",q13Desc:"In the past 6 months, how well do you adapt to environmental changes and challenges? Including adaptation speed to new environments, flexibility in coping with changes, and ability to recover from setbacks. Are you able to quickly adapt to new environments and maintain stability in changes?",q14Title:"Responsibility",q14Desc:"In the past year, how responsible are you towards yourself and others? Including personal behavior responsibility, fulfillment of commitments to others, and awareness of social responsibility. Are you able to take personal responsibility and be responsible for others and society?",q15Title:"Self-Identity",q15Desc:"In the past 6 months, how strong is your sense of self-worth and identity? Including awareness of personal value, self-acceptance level, and satisfaction with personal identity. Do you have a clear understanding of yourself and can accept your strengths and weaknesses?",q16Title:"Community Participation",q16Desc:"In the past 3 years, how involved are you in community activities and public service? Including volunteer service participation, community activity contribution, and attention and participation in social welfare. Do you actively participate in community activities and contribute to society?",q17Title:"Career Development",q17Desc:"In the past year, how well have you performed in skill enhancement and career planning? Including professional skill development, career planning clarity, and grasp of career development opportunities. Do you continuously improve professional skills and have clear career development paths?",q18Title:"Conflict Resolution",q18Desc:"In the past 3 months, how well do you handle interpersonal conflicts and disagreements? Including conflict resolution skills, communication coordination ability, and wisdom in maintaining relationships. Are you able to effectively handle interpersonal conflicts and seek consensus in disagreements?",q19Title:"Time Management",q19Desc:"In the past year, how well do you manage time and prioritize tasks? Including time planning efficiency, task priority setting, and maintenance of work-life balance. Are you able to effectively manage time and maintain efficiency in multiple tasks?",q20Title:"Overall Satisfaction",q20Desc:"In the past 6 months, how satisfied are you with your overall life situation? Including overall evaluation of life quality, satisfaction with personal achievements, and optimism about future life prospects. Are you satisfied with your current life situation and hopeful about the future?",excellent:"Excellent",good:"Good",fair:"Fair",poor:"Needs Improvement",terrible:"Very Poor",scoreLabel:"Assessment Score",resultLabel:"Assessment Result",descriptionLabel:"Detailed Analysis",recommendationsLabel:"Improvement Suggestions",analysisLabel:"Professional Analysis",privacyPolicy:"Privacy Policy",terms:"Terms/Statement",dataDeletion:"Data Deletion Guide",about:"🧬 Restarter™｜Who We Are",feedback:"💬 Feedback｜We Want to Hear You"},ko:{title:"사회 통합도 평가",subtitle:"사회 통합도를 평가하고 전문적인 조언을 받으세요",subtitle2:"용감하게 직면하고 정기적으로 자신의 사회 통합도 진전 상황을 점검하세요. 모든 평가는 성장의 기회입니다",backToHome:"돌아가기",startAssessment:"평가 시작",submitAssessment:"평가 제출",cancelAssessment:"취소",closeAssessment:"닫기",assessmentComplete:"평가 완료",viewReport:"보고서 보기",closeReport:"보고서 닫기",q1Title:"인간관계",q1Desc:"최근 3개월간 타인과의 상호작용과 사회적 능력은 어떠한가요? 동료, 친구, 이웃과의 일상적 교류와 새로운 환경에서 관계를 구축하는 능력을 포함합니다. 적극적으로 타인과 소통하고 신뢰 관계를 구축하며 사회적 상황에서 편안함을 느낄 수 있나요?",q2Title:"고용 상황",q2Desc:"최근 1년간 직업의 안정성과 발전 전망은 어떠한가요? 직업 만족도, 급여 대우, 직업 발전 기회, 직장 환경 적응성, 그리고 미래 직업 계획의 명확성을 포함합니다. 현재 직업에 만족하며 명확한 직업 발전 목표가 있나요?",q3Title:"가족 관계",q3Desc:"최근 6개월간 가족과의 생활과 소통 상황은 어떠한가요? 배우자, 자녀, 부모 또는 다른 가족 구성원과의 관계 품질, 소통 빈도와 효과, 그리고 가족 분위기의 조화를 포함합니다. 가족 갈등을 효과적으로 처리하고 가족 구성원에게 감정적 지원을 제공할 수 있나요?",q4Title:"미래에 대한 신뢰",q4Desc:"미래 1년에 대한 낙관적 정도와 계획은 어떠한가요? 개인 발전에 대한 신뢰, 삶의 목표에 대한 명확성, 그리고 도전에 직면할 때의 적극적 태도를 포함합니다. 미래에 대한 명확한 계획이 있으며 목표를 달성할 수 있다고 믿나요?",q5Title:"사회적 수용",q5Desc:"최근 6개월간 사회로부터 받아들여지고 인정받는다고 느끼는 정도는 어떠한가요? 지역사회에서의 통합도, 사회적 지위에 대한 동일시, 그리고 사회적 규범에 대한 적응 능력을 포함합니다. 사회로부터 받아들여진다고 느끼며 자신의 사회적 역할에 만족하나요?",q6Title:"감정 관리",q6Desc:"최근 3개월간 스트레스와 부정적 감정을 처리하는 능력은 어떠한가요? 좌절에 직면할 때의 감정적 반응, 스트레스 조절 방법, 그리고 정신 건강 유지에 대한 의식을 포함합니다. 부정적 감정을 효과적으로 관리하고 스트레스 하에서도 침착함을 유지할 수 있나요?",q7Title:"생활 규칙",q7Desc:"최근 6개월간 생활 습관과 규칙성은 어떠한가요? 일상 생활 시간, 식습관, 운동 빈도, 그리고 생활 리듬의 안정성을 포함합니다. 건강한 생활 습관을 유지하고 규칙적인 일상 생활을 구축할 수 있나요?",q8Title:"학습 성장",q8Desc:"최근 1년간 기술 학습과 개인 성장에 대한 투자는 어떠한가요? 새로운 기술 학습, 지식 업데이트, 자기 향상에 대한 적극성, 그리고 개인 발전에 대한 투자를 포함합니다. 새로운 지식을 지속적으로 학습하고 개인 성장 기회를 적극적으로 찾나요?",q9Title:"재정 관리",q9Desc:"최근 1년간 재정 계획과 재정 관리 능력은 어떠한가요? 수입 지출 관리, 저축 습관, 투자 재정 의식, 그리고 미래 재정 안전에 대한 계획을 포함합니다. 개인 재정을 효과적으로 관리하고 미래를 위한 재정 준비를 할 수 있나요?",q10Title:"건강 상태",q10Desc:"최근 6개월간 신체적, 정신적 건강 상태는 어떠한가요? 신체 건강 상태, 정신 건강 상태, 의료 보건 의식, 그리고 건강 문제에 대한 예방과 처리 능력을 포함합니다. 건강 관리에 중점을 두고 적극적인 건강 유지 조치를 취하나요?",q11Title:"사회적 네트워크",q11Desc:"최근 3개월간 사회적 관계를 구축하고 유지하는 능력은 어떠한가요? 친구 수, 사회적 활동 참여도, 인간관계 품질, 그리고 사회적 네트워크의 폭과 깊이를 포함합니다. 안정적인 사회적 서클을 가지고 타인과 의미 있는 관계를 구축할 수 있나요?",q12Title:"목표 설정",q12Desc:"최근 1년간 개인 목표를 설정하고 추구하는 능력은 어떠한가요? 목표의 명확성, 계획의 실현 가능성, 실행력, 그리고 목표 달성도에 대한 평가를 포함합니다. 명확한 목표를 설정하고 계획을 효과적으로 실행할 수 있나요?",q13Title:"적응 능력",q13Desc:"최근 6개월간 환경 변화와 도전에 적응하는 능력은 어떠한가요? 새로운 환경에 대한 적응 속도, 변화에 대응하는 유연성, 그리고 좌절에서 회복하는 능력을 포함합니다. 새로운 환경에 빠르게 적응하고 변화 속에서도 안정을 유지할 수 있나요?",q14Title:"책임감",q14Desc:"최근 1년간 자신과 타인에 대한 책임감 있는 태도는 어떠한가요? 개인 행동에 대한 책임감, 타인에 대한 약속 이행, 그리고 사회적 책임에 대한 인식을 포함합니다. 개인적 책임을 질 수 있고 타인과 사회에 대해 책임을 질 수 있나요?",q15Title:"자아 정체성",q15Desc:"최근 6개월간 자아 가치와 정체성에 대한 동일시는 어떠한가요? 개인 가치에 대한 인식, 자기 수용 정도, 그리고 개인 정체성에 대한 만족도를 포함합니다. 자신에 대한 명확한 인식이 있으며 자신의 장단점을 받아들일 수 있나요?",q16Title:"지역사회 참여",q16Desc:"최근 1년간 지역사회 활동과 공익 서비스 참여 상황은 어떠한가요? 자원봉사 참여도, 지역사회 활동 기여, 그리고 사회 복지에 대한 관심과 참여를 포함합니다. 지역사회 활동에 적극적으로 참여하고 사회에 기여하나요?",q17Title:"직업 발전",q17Desc:"최근 1년간 직업 기술 향상과 경력 계획 측면에서의 성과는 어떠한가요? 전문 기술 발전, 경력 계획 명확성, 그리고 경력 발전 기회에 대한 파악을 포함합니다. 직업 기술을 지속적으로 향상시키고 명확한 경력 발전 경로가 있나요?",q18Title:"인간관계 갈등 처리",q18Desc:"최근 3개월간 인간관계 갈등과 의견 차이를 처리하는 능력은 어떠한가요? 갈등 해결 기술, 소통 조정 능력, 그리고 관계 유지의 지혜를 포함합니다. 인간관계 갈등을 효과적으로 처리하고 의견 차이에서 합의를 찾을 수 있나요?",q19Title:"시간 관리",q19Desc:"최근 1년간 시간을 합리적으로 배치하고 우선순위를 설정하는 능력은 어떠한가요? 시간 계획 효율성, 작업 우선순위 설정, 그리고 업무와 생활의 균형 유지를 포함합니다. 시간을 효과적으로 관리하고 다중 작업에서도 효율성을 유지할 수 있나요?",q20Title:"전체 만족도",q20Desc:"최근 6개월간 전체적인 생활 상황에 대한 만족도는 어떠한가요? 생활 품질에 대한 전체적 평가, 개인 성취에 대한 만족도, 그리고 미래 생활 전망에 대한 낙관적 정도를 포함합니다. 현재의 생활 상황에 만족하며 미래에 대한 희망을 가지고 있나요?",excellent:"매우 좋음",good:"좋음",fair:"보통",poor:"개선 필요",terrible:"매우 나쁨",scoreLabel:"평가 점수",resultLabel:"평가 결과",descriptionLabel:"상세 분석",recommendationsLabel:"개선 제안",analysisLabel:"전문 분석",privacyPolicy:"개인정보 보호정책",terms:"약관/성명",dataDeletion:"데이터 삭제 안내",about:"🧬 Restarter™｜우리는 누구인가",feedback:"💬 의견함｜우리는 당신의 말을 듣고 싶습니다"}};function D5(){const{lang:n}=Qe(),e=$e(),{isTestMode:t}=ji(),[i,s]=g.useState(0),o=Py[n]||Py["zh-TW"];g.useEffect(()=>{console.log("Language changed to:",n),s(j=>j+1)},[n]);const[a,l]=g.useState(!1),[c,u]=g.useState(!1),[h,p]=g.useState({q1:"",q2:"",q3:"",q4:"",q5:"",q6:"",q7:"",q8:"",q9:"",q10:"",q11:"",q12:"",q13:"",q14:"",q15:"",q16:"",q17:"",q18:"",q19:"",q20:""}),[f,b]=g.useState(null),x=j=>{const A={excellent:5,good:4,fair:3,poor:2,terrible:1},D=[A[j.q1]||3,A[j.q2]||3,A[j.q3]||3,A[j.q4]||3,A[j.q5]||3,A[j.q6]||3,A[j.q7]||3,A[j.q8]||3,A[j.q9]||3,A[j.q10]||3,A[j.q11]||3,A[j.q12]||3,A[j.q13]||3,A[j.q14]||3,A[j.q15]||3,A[j.q16]||3,A[j.q17]||3,A[j.q18]||3,A[j.q19]||3,A[j.q20]||3],P=D.reduce((R,E)=>R+E,0)/20,B={interpersonal:(D[0]+D[10]+D[17])/3,career:(D[1]+D[16])/2,family:D[2],emotional:(D[5]+D[14])/2,lifestyle:(D[6]+D[9]+D[18])/3,learning:(D[7]+D[11]+D[12])/3,financial:D[8],responsibility:D[13],community:D[15],satisfaction:D[19]},k=Object.entries(B).filter(([R,E])=>E>=4).map(([R,E])=>R),T=Object.entries(B).filter(([R,E])=>E<=2).map(([R,E])=>R);if(P>=4.5){const E=[{condition:k.includes("interpersonal")&&k.includes("career"),description:"你的社會融入度表現卓越！在人際關係和職業發展方面表現特別突出，顯示出優秀的社交能力和職業素養。",recommendations:["繼續保持優秀的人際交往能力","可以考慮擔任職場導師幫助其他更生人","分享你的職業成功經驗","參與專業社群擴大影響力"],analysis:"你在人際關係和職業發展方面的優秀表現，表明你已經完全融入社會。建議繼續發揮這些優勢，並幫助其他需要支持的人。"},{condition:k.includes("emotional")&&k.includes("family"),description:"你的社會融入度表現優秀！在情緒管理和家庭關係方面表現特別突出，顯示出良好的心理素質和家庭和諧。",recommendations:["繼續保持穩定的情緒狀態","可以擔任家庭關係諮詢志工","分享你的家庭和諧經驗","參與心理健康推廣活動"],analysis:"你在情緒管理和家庭關係方面的優秀表現，表明你具備良好的心理素質和家庭責任感。建議繼續保持這種狀態。"},{condition:k.includes("lifestyle")&&k.includes("learning"),description:"你的社會融入度表現優秀！在生活規律和學習成長方面表現特別突出，顯示出良好的自律能力和進取精神。",recommendations:["繼續保持規律的生活習慣","可以擔任學習輔導志工","分享你的學習方法和經驗","參與教育推廣活動"],analysis:"你在生活規律和學習成長方面的優秀表現，表明你具備良好的自律能力和進取精神。建議繼續發揮這些優勢。"},{condition:k.includes("financial")&&k.includes("responsibility"),description:"你的社會融入度表現優秀！在財務管理和責任感方面表現特別突出，顯示出良好的理財能力和社會責任感。",recommendations:["繼續保持穩健的財務管理","可以擔任財務規劃志工","分享你的理財經驗","參與社會責任活動"],analysis:"你在財務管理和責任感方面的優秀表現，表明你具備良好的理財能力和社會責任感。建議繼續發揮這些優勢。"},{condition:k.includes("community")&&k.includes("satisfaction"),description:"你的社會融入度表現優秀！在社區參與和整體滿意度方面表現特別突出，顯示出良好的社會參與度和生活滿意度。",recommendations:["繼續積極參與社區活動","可以擔任社區志工領袖","分享你的社區參與經驗","參與更多公益活動"],analysis:"你在社區參與和整體滿意度方面的優秀表現，表明你已經完全融入社會並對生活感到滿意。建議繼續保持這種狀態。"}].find(_=>_.condition)||{description:`恭喜您！您的社會融入度評估結果顯示您已經達到了優秀水平。在${k.length>0?k.map(_=>({interpersonal:"人際關係",career:"職業發展",family:"家庭關係",emotional:"情緒管理",lifestyle:"生活規律",learning:"學習成長",financial:"財務管理",responsibility:"責任感",community:"社區參與",satisfaction:"整體滿意度"})[_]||_).join("、"):"多個重要維度"}方面，您展現出了卓越的能力和積極的態度。這表明您已經成功建立了穩定的社會支持網絡，具備了良好的生活技能和職業素養，並且對未來充滿信心。您的表現不僅為自己創造了美好的生活，也為其他更生人樹立了積極的榜樣。`,recommendations:["繼續保持現有的優秀表現，定期進行自我評估以維持高水準","考慮擔任更生人互助團體的導師或志工，分享您的成功經驗","參與專業社群和行業交流，進一步提升職業技能和社會影響力","建立個人品牌，成為更生人融入社會的典範","定期參與公益活動，回饋社會並擴大正面影響力","考慮擔任職場導師，幫助其他更生人提升就業競爭力","建立個人發展檔案，記錄成長歷程並分享給需要支持的人"],analysis:`基於您完成的20項詳細評估，我們發現您在${k.length>0?k.map(_=>({interpersonal:"人際關係",career:"職業發展",family:"家庭關係",emotional:"情緒管理",lifestyle:"生活規律",learning:"學習成長",financial:"財務管理",responsibility:"責任感",community:"社區參與",satisfaction:"整體滿意度"})[_]||_).join("、"):"各個關鍵維度"}都表現出色。這表明您已經完全融入了社會，具備了優秀的社會適應能力、職業素養和生活技能。您的成功不僅體現在個人成就上，更重要的是您展現出了積極的生活態度和對未來的清晰規劃。建議您繼續保持這種優秀狀態，並考慮將您的經驗分享給其他需要支持的人，成為更生人融入社會的典範。您的表現證明了更生人完全有能力重新融入社會並創造美好生活。`};return{score:P,result:"優秀",description:E.description,recommendations:E.recommendations,analysis:E.analysis}}else if(P>=3.5){const E=[{condition:T.includes("interpersonal")&&k.includes("career"),description:"你的社會融入度良好，在職業發展方面表現不錯，但人際關係需要改善。",recommendations:["參加人際溝通技巧培訓","主動參與社交活動","尋求人際關係諮詢","繼續保持職業發展優勢"],analysis:"你在職業發展方面表現良好，但人際關係需要改善。建議重點提升社交能力，同時保持職業優勢。"},{condition:T.includes("emotional")&&k.includes("family"),description:"你的社會融入度良好，在家庭關係方面表現不錯，但情緒管理需要改善。",recommendations:["參加情緒管理課程","尋求心理諮商服務","學習壓力調節技巧","繼續維護良好的家庭關係"],analysis:"你在家庭關係方面表現良好，但情緒管理需要改善。建議重點提升情緒管理能力。"},{condition:T.includes("lifestyle")&&k.includes("learning"),description:"你的社會融入度良好，在學習成長方面表現不錯，但生活規律需要改善。",recommendations:["制定規律的作息時間表","建立健康的生活習慣","參加時間管理課程","繼續保持學習熱情"],analysis:"你在學習成長方面表現良好，但生活規律需要改善。建議重點建立規律的生活習慣。"},{condition:T.includes("financial")&&k.includes("responsibility"),description:"你的社會融入度良好，在責任感方面表現不錯，但財務管理需要改善。",recommendations:["參加財務規劃課程","制定個人預算計劃","學習理財知識","繼續保持責任感"],analysis:"你在責任感方面表現良好，但財務管理需要改善。建議重點提升財務管理能力。"},{condition:T.includes("community")&&k.includes("satisfaction"),description:"你的社會融入度良好，對生活滿意度不錯，但社區參與需要改善。",recommendations:["主動參與社區活動","加入志願服務團體","參與公益活動","繼續保持積極的生活態度"],analysis:"你對生活滿意度不錯，但社區參與需要改善。建議重點提升社會參與度。"}].find(_=>_.condition)||{description:`您的社會融入度評估結果顯示您達到了良好水平。在${k.length>0?k.map(_=>({interpersonal:"人際關係",career:"職業發展",family:"家庭關係",emotional:"情緒管理",lifestyle:"生活規律",learning:"學習成長",financial:"財務管理",responsibility:"責任感",community:"社區參與",satisfaction:"整體滿意度"})[_]||_).join("、"):"多個重要維度"}方面，您展現出了穩定的能力和積極的態度。這表明您已經建立了基本的社會支持網絡，具備了良好的生活技能和職業素養，並且對未來有一定的規劃。雖然在某些方面還有提升空間，但您的整體表現已經為進一步發展奠定了堅實的基礎。`,recommendations:["繼續保持現有的良好狀態，建立定期自我評估機制",T.length>0?`制定${T.join("、")}方面的具體改善計劃，設定明確的目標和時間表`:"進一步提升各方面能力，設定更具挑戰性的目標","參加專業技能培訓和認證課程，提升職業競爭力","加強與社區的互動和參與，擴大社交網絡","尋求導師指導，學習成功人士的經驗和方法","建立個人發展檔案，記錄進步歷程和成就","參與更生人互助團體，與同路人分享經驗和互相支持"],analysis:`基於您完成的20項詳細評估，我們發現您在${k.length>0?k.map(_=>({interpersonal:"人際關係",career:"職業發展",family:"家庭關係",emotional:"情緒管理",lifestyle:"生活規律",learning:"學習成長",financial:"財務管理",responsibility:"責任感",community:"社區參與",satisfaction:"整體滿意度"})[_]||_).join("、"):"多個關鍵維度"}表現良好，具備了基本的社會適應能力和生活技能。${T.length>0?`特別是在${T.map(_=>({interpersonal:"人際關係",career:"職業發展",family:"家庭關係",emotional:"情緒管理",lifestyle:"生活規律",learning:"學習成長",financial:"財務管理",responsibility:"責任感",community:"社區參與",satisfaction:"整體滿意度"})[_]||_).join("、")}方面，建議您制定具體的改善計劃，尋求專業指導和支持。`:""}您的整體表現表明您已經成功融入了社會，並且具備了進一步發展的潛力。建議您繼續保持積極的態度，設定更具挑戰性的目標，並尋求更多學習和成長的機會。您的進步證明了更生人完全有能力重新融入社會並創造美好生活。`};return{score:P,result:"良好",description:E.description,recommendations:E.recommendations,analysis:E.analysis}}else if(P>=2.5){const E=[{condition:T.includes("interpersonal")&&T.includes("career"),description:"你的社會融入度一般，在人際關係和職業發展方面都需要改善。",recommendations:["參加人際溝通技巧培訓","尋求職業技能培訓","參加更生人互助團體","建立職業發展計劃","尋求專業輔導師幫助"],analysis:"你在人際關係和職業發展方面都需要改善。建議同時提升社交能力和職業技能，尋求專業支持。"},{condition:T.includes("emotional")&&T.includes("family"),description:"你的社會融入度一般，在情緒管理和家庭關係方面都需要改善。",recommendations:["尋求心理諮商服務","參加情緒管理課程","改善家庭溝通方式","建立家庭支持系統","尋求專業輔導師幫助"],analysis:"你在情緒管理和家庭關係方面都需要改善。建議重點提升心理健康和家庭關係。"},{condition:T.includes("lifestyle")&&T.includes("learning"),description:"你的社會融入度一般，在生活規律和學習成長方面都需要改善。",recommendations:["制定規律的作息時間表","參加時間管理課程","建立學習計劃","尋找學習夥伴","尋求專業輔導師幫助"],analysis:"你在生活規律和學習成長方面都需要改善。建議重點建立規律的生活習慣和學習計劃。"},{condition:T.includes("financial")&&T.includes("responsibility"),description:"你的社會融入度一般，在財務管理和責任感方面都需要改善。",recommendations:["參加財務規劃課程","制定個人預算計劃","提升責任感意識","建立財務目標","尋求專業輔導師幫助"],analysis:"你在財務管理和責任感方面都需要改善。建議重點提升理財能力和責任感。"},{condition:T.includes("community")&&T.includes("satisfaction"),description:"你的社會融入度一般，在社區參與和整體滿意度方面都需要改善。",recommendations:["主動參與社區活動","加入志願服務團體","提升生活滿意度","建立社交網絡","尋求專業輔導師幫助"],analysis:"你在社區參與和整體滿意度方面都需要改善。建議重點提升社會參與度和生活滿意度。"}].find(_=>_.condition)||{description:`您的社會融入度評估結果顯示您目前處於一般水平。在${T.length>0?T.map(_=>({interpersonal:"人際關係",career:"職業發展",family:"家庭關係",emotional:"情緒管理",lifestyle:"生活規律",learning:"學習成長",financial:"財務管理",responsibility:"責任感",community:"社區參與",satisfaction:"整體滿意度"})[_]||_).join("、"):"某些重要維度"}方面，您需要更多的支持和改善。這表明您在社會融入過程中遇到了一些挑戰，但這並不意味著失敗，而是需要更多專業指導和支持的表現。${k.length>0?`同時，您在${k.map(_=>({interpersonal:"人際關係",career:"職業發展",family:"家庭關係",emotional:"情緒管理",lifestyle:"生活規律",learning:"學習成長",financial:"財務管理",responsibility:"責任感",community:"社區參與",satisfaction:"整體滿意度"})[_]||_).join("、")}方面的表現值得肯定，這些優勢將成為您改善其他方面的基礎。`:""}建議您積極尋求專業支持，制定系統性的改善計劃。`,recommendations:["立即聯繫專業輔導師，制定個人化的改善計劃","參加更生人支持計劃和互助團體，獲得同路人支持","建立穩定的生活規律，包括作息時間、飲食習慣和運動計劃","加強人際關係建設，學習有效的溝通技巧",k.length>0?`充分發揮${k.map(_=>({interpersonal:"人際關係",career:"職業發展",family:"家庭關係",emotional:"情緒管理",lifestyle:"生活規律",learning:"學習成長",financial:"財務管理",responsibility:"責任感",community:"社區參與",satisfaction:"整體滿意度"})[_]||_).join("、")}方面的優勢，建立自信心`:"尋找個人優勢並加以發揮，建立自信心","參加職業技能培訓，提升就業競爭力","建立支持網絡，包括家人、朋友和專業人士","制定短期和長期目標，逐步改善各方面能力","定期進行自我評估，追蹤改善進度"],analysis:`基於您完成的20項詳細評估，我們發現您在${T.length>0?T.map(_=>({interpersonal:"人際關係",career:"職業發展",family:"家庭關係",emotional:"情緒管理",lifestyle:"生活規律",learning:"學習成長",financial:"財務管理",responsibility:"責任感",community:"社區參與",satisfaction:"整體滿意度"})[_]||_).join("、"):"某些關鍵維度"}需要更多支持。${T.length>0?`特別是在${T.map(_=>({interpersonal:"人際關係",career:"職業發展",family:"家庭關係",emotional:"情緒管理",lifestyle:"生活規律",learning:"學習成長",financial:"財務管理",responsibility:"責任感",community:"社區參與",satisfaction:"整體滿意度"})[_]||_).join("、")}方面，建議您制定具體的改善計劃，尋求專業指導和支持。`:""}${k.length>0?`同時，您在${k.map(_=>({interpersonal:"人際關係",career:"職業發展",family:"家庭關係",emotional:"情緒管理",lifestyle:"生活規律",learning:"學習成長",financial:"財務管理",responsibility:"責任感",community:"社區參與",satisfaction:"整體滿意度"})[_]||_).join("、")}方面的表現值得肯定，這些優勢將成為您改善其他方面的基礎。`:""}您的評估結果表明您在社會融入過程中遇到了一些挑戰，但這並不意味著失敗。每個人的改善路徑都是不同的，重要的是您願意正視這些挑戰並尋求幫助。建議您積極尋求專業支持，制定系統性的改善計劃，並相信通過持續的努力，您一定能夠取得進步。`};return{score:P,result:"一般",description:E.description,recommendations:E.recommendations,analysis:E.analysis}}else{const E=[{condition:T.includes("interpersonal")&&T.includes("emotional"),description:"你的社會融入度需要改善，在人際關係和情緒管理方面都需要專業支持。",recommendations:["立即聯繫專業輔導師","尋求心理諮商服務","參加人際溝通技巧培訓","參加情緒管理課程","建立支持網絡"],analysis:"你在人際關係和情緒管理方面都需要專業支持。建議立即尋求專業幫助，逐步改善這些方面。"},{condition:T.includes("career")&&T.includes("financial"),description:"你的社會融入度需要改善，在職業發展和財務管理方面都需要專業支持。",recommendations:["立即聯繫專業輔導師","參加職業技能培訓","參加財務規劃課程","制定職業發展計劃","建立財務目標"],analysis:"你在職業發展和財務管理方面都需要專業支持。建議立即尋求專業幫助，制定改善計劃。"},{condition:T.includes("family")&&T.includes("lifestyle"),description:"你的社會融入度需要改善，在家庭關係和生活規律方面都需要專業支持。",recommendations:["立即聯繫專業輔導師","改善家庭溝通方式","制定規律的作息時間表","建立家庭支持系統","參加家庭關係諮詢"],analysis:"你在家庭關係和生活規律方面都需要專業支持。建議立即尋求專業幫助，改善這些方面。"},{condition:T.includes("learning")&&T.includes("responsibility"),description:"你的社會融入度需要改善，在學習成長和責任感方面都需要專業支持。",recommendations:["立即聯繫專業輔導師","制定學習計劃","提升責任感意識","尋找學習夥伴","建立目標管理系統"],analysis:"你在學習成長和責任感方面都需要專業支持。建議立即尋求專業幫助，制定改善計劃。"},{condition:T.includes("community")&&T.includes("satisfaction"),description:"你的社會融入度需要改善，在社區參與和整體滿意度方面都需要專業支持。",recommendations:["立即聯繫專業輔導師","主動參與社區活動","提升生活滿意度","加入志願服務團體","建立社交網絡"],analysis:"你在社區參與和整體滿意度方面都需要專業支持。建議立即尋求專業幫助，改善這些方面。"}].find(_=>_.condition)||{description:`您的社會融入度評估結果顯示您目前面臨較大的挑戰，在${T.length>0?T.map(_=>({interpersonal:"人際關係",career:"職業發展",family:"家庭關係",emotional:"情緒管理",lifestyle:"生活規律",learning:"學習成長",financial:"財務管理",responsibility:"責任感",community:"社區參與",satisfaction:"整體滿意度"})[_]||_).join("、"):"多個重要維度"}都需要專業支持和改善。這表明您在社會融入過程中遇到了較多的困難，但這絕對不是失敗，而是需要更多專業幫助的表現。每個人的改善路徑都是不同的，重要的是您願意正視這些挑戰並積極尋求幫助。建議您立即聯繫專業輔導師，制定系統性的改善計劃，並相信通過持續的努力和專業支持，您一定能夠逐步改善並重新融入社會。`,recommendations:["立即聯繫專業輔導師，制定個人化的改善計劃和時間表","參加更生人支持計劃和互助團體，獲得同路人支持和理解","尋求專業心理諮商服務，處理可能的情緒和心理問題","建立穩定的生活規律，包括規律的作息、健康的飲食和適度的運動","尋求家人和朋友的支持，建立穩定的支持網絡","參加職業技能培訓和就業輔導，提升就業競爭力","建立短期和長期目標，逐步改善各方面能力","定期進行自我評估，追蹤改善進度並調整計劃","學習有效的壓力管理和情緒調節技巧","參與社區活動，逐步建立社交網絡"],analysis:`基於您完成的20項詳細評估，我們發現您在${T.length>0?T.map(_=>({interpersonal:"人際關係",career:"職業發展",family:"家庭關係",emotional:"情緒管理",lifestyle:"生活規律",learning:"學習成長",financial:"財務管理",responsibility:"責任感",community:"社區參與",satisfaction:"整體滿意度"})[_]||_).join("、"):"多個關鍵維度"}需要專業支持。您的評估結果表明您目前在社會融入過程中遇到了較多的挑戰，但這絕對不是失敗。每個人的改善路徑都是不同的，重要的是您願意正視這些挑戰並積極尋求幫助。專業輔導師可以幫助您制定適合的改善計劃，提供系統性的支持和指導。建議您立即聯繫專業輔導師，制定個人化的改善計劃，並相信通過持續的努力和專業支持，您一定能夠逐步改善並重新融入社會。記住，尋求幫助是勇敢的表現，也是成功改善的第一步。`};return{score:P,result:"需要改善",description:E.description,recommendations:E.recommendations,analysis:E.analysis}}},S=()=>{if(!Object.values(h).every(O=>O!=="")){alert("請回答所有問題");return}const A=x(h),D={score:A.score,result:A.result,description:A.description,recommendations:A.recommendations,analysis:A.analysis,details:{relationships:h.q1,employment:h.q2,family:h.q3,confidence:h.q4,acceptance:h.q5,emotional:h.q6,routine:h.q7,learning:h.q8,financial:h.q9,health:h.q10,social:h.q11,goals:h.q12,adaptability:h.q13,responsibility:h.q14,identity:h.q15,community:h.q16,career:h.q17,conflict:h.q18,time:h.q19,satisfaction:h.q20}};b(D),l(!1),u(!0)},w=[{key:"q1",title:o.q1Title,desc:o.q1Desc},{key:"q2",title:o.q2Title,desc:o.q2Desc},{key:"q3",title:o.q3Title,desc:o.q3Desc},{key:"q4",title:o.q4Title,desc:o.q4Desc},{key:"q5",title:o.q5Title,desc:o.q5Desc},{key:"q6",title:o.q6Title,desc:o.q6Desc},{key:"q7",title:o.q7Title,desc:o.q7Desc},{key:"q8",title:o.q8Title,desc:o.q8Desc},{key:"q9",title:o.q9Title,desc:o.q9Desc},{key:"q10",title:o.q10Title,desc:o.q10Desc},{key:"q11",title:o.q11Title,desc:o.q11Desc},{key:"q12",title:o.q12Title,desc:o.q12Desc},{key:"q13",title:o.q13Title,desc:o.q13Desc},{key:"q14",title:o.q14Title,desc:o.q14Desc},{key:"q15",title:o.q15Title,desc:o.q15Desc},{key:"q16",title:o.q16Title,desc:o.q16Desc},{key:"q17",title:o.q17Title,desc:o.q17Desc},{key:"q18",title:o.q18Title,desc:o.q18Desc},{key:"q19",title:o.q19Title,desc:o.q19Desc},{key:"q20",title:o.q20Title,desc:o.q20Desc}],I=[{value:"excellent",label:o.excellent},{value:"good",label:o.good},{value:"fair",label:o.fair},{value:"poor",label:o.poor},{value:"terrible",label:o.terrible}];return r.jsxs("div",{style:{minHeight:"100vh",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",padding:"20px",display:"flex",flexDirection:"column"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"30px"},children:[r.jsx("button",{onClick:()=>e("/"),style:{background:"rgba(255,255,255,0.9)",border:"none",borderRadius:"12px",padding:"12px 20px",fontSize:"16px",fontWeight:"600",cursor:"pointer",display:"flex",alignItems:"center",gap:"8px",boxShadow:"0 4px 12px rgba(0,0,0,0.1)"},children:o.backToHome}),r.jsxs("h1",{style:{color:"white",fontSize:"24px",fontWeight:"700",margin:0,textAlign:"center",position:"absolute",top:"24px",left:"50%",transform:"translateX(-50%)",zIndex:1e3},children:["📊 ",o.title]})]}),r.jsx("div",{style:{flex:1,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:"30px"},children:r.jsxs("div",{style:{background:"rgba(255,255,255,0.95)",borderRadius:"20px",padding:"40px",maxWidth:"600px",width:"100%",textAlign:"center",boxShadow:"0 8px 32px rgba(0,0,0,0.1)"},children:[r.jsx("div",{style:{fontSize:"64px",marginBottom:"20px"},children:"📊"}),r.jsx("h2",{style:{fontSize:"28px",fontWeight:"700",color:"#333",marginBottom:"16px"},children:o.title}),r.jsx("p",{style:{fontSize:"16px",color:"#666",lineHeight:"1.6",marginBottom:"20px"},children:o.subtitle}),r.jsx("p",{style:{fontSize:"14px",color:"#888",lineHeight:"1.5",marginBottom:"30px",fontStyle:"italic"},children:o.subtitle2}),r.jsx("button",{onClick:()=>l(!0),style:{background:"linear-gradient(135deg, #6B5BFF, #5A4FCF)",color:"white",border:"none",borderRadius:"16px",padding:"16px 32px",fontSize:"18px",fontWeight:"600",cursor:"pointer",boxShadow:"0 4px 16px rgba(107, 91, 255, 0.3)",transition:"all 0.3s ease"},onMouseEnter:j=>{j.currentTarget.style.transform="translateY(-2px)",j.currentTarget.style.boxShadow="0 6px 20px rgba(107, 91, 255, 0.4)"},onMouseLeave:j=>{j.currentTarget.style.transform="translateY(0)",j.currentTarget.style.boxShadow="0 4px 16px rgba(107, 91, 255, 0.3)"},children:o.startAssessment})]})}),a&&r.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,padding:"20px"},children:r.jsxs("div",{style:{background:"white",borderRadius:"20px",padding:"30px",maxWidth:"600px",width:"100%",maxHeight:"80vh",overflowY:"auto",position:"relative"},children:[r.jsx("button",{onClick:()=>l(!1),style:{position:"absolute",top:"15px",right:"20px",background:"none",border:"none",fontSize:"24px",color:"#666",cursor:"pointer",width:"30px",height:"30px",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"50%",transition:"all 0.2s ease"},onMouseEnter:j=>{j.currentTarget.style.background="#f0f0f0",j.currentTarget.style.color="#333"},onMouseLeave:j=>{j.currentTarget.style.background="none",j.currentTarget.style.color="#666"},children:"×"}),r.jsx("h3",{style:{fontSize:"24px",fontWeight:"700",color:"#333",marginBottom:"20px",textAlign:"center",paddingRight:"40px"},children:o.title}),r.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"24px"},children:w.map((j,A)=>r.jsxs("div",{style:{border:"2px solid #f0f0f0",borderRadius:"16px",padding:"20px",background:"#fafafa"},children:[r.jsxs("h4",{style:{fontSize:"18px",fontWeight:"600",color:"#333",marginBottom:"8px"},children:[A+1,". ",j.title]}),r.jsx("p",{style:{fontSize:"14px",color:"#666",marginBottom:"16px"},children:j.desc}),r.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:I.map(D=>r.jsxs("label",{style:{display:"flex",alignItems:"center",padding:"10px",borderRadius:"8px",cursor:"pointer",background:h[j.key]===D.value?"#6B5BFF":"white",color:h[j.key]===D.value?"white":"#333",border:`2px solid ${h[j.key]===D.value?"#6B5BFF":"#ddd"}`,transition:"all 0.2s ease",fontSize:"13px"},children:[r.jsx("input",{type:"radio",name:j.key,value:D.value,checked:h[j.key]===D.value,onChange:O=>p({...h,[j.key]:O.target.value}),style:{marginRight:"10px"}}),D.label]},D.value))})]},j.key))}),r.jsxs("div",{style:{display:"flex",gap:"12px",marginTop:"30px",justifyContent:"center"},children:[r.jsx("button",{onClick:()=>l(!1),style:{background:"#f0f0f0",color:"#666",border:"none",borderRadius:"12px",padding:"12px 24px",fontSize:"16px",fontWeight:"600",cursor:"pointer"},children:o.cancelAssessment}),r.jsx("button",{onClick:S,style:{background:"linear-gradient(135deg, #6B5BFF, #5A4FCF)",color:"white",border:"none",borderRadius:"12px",padding:"12px 24px",fontSize:"16px",fontWeight:"600",cursor:"pointer"},children:o.submitAssessment})]})]})}),c&&f&&r.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,padding:"20px"},children:r.jsxs("div",{style:{background:"white",borderRadius:"20px",padding:"30px",maxWidth:"600px",width:"100%",maxHeight:"80vh",overflowY:"auto"},children:[r.jsxs("div",{style:{textAlign:"center",marginBottom:"30px"},children:[r.jsx("div",{style:{fontSize:"48px",marginBottom:"16px"},children:"📊"}),r.jsx("h3",{style:{fontSize:"24px",fontWeight:"700",color:"#333",marginBottom:"8px"},children:o.assessmentComplete})]}),r.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"20px"},children:[r.jsxs("div",{style:{background:"linear-gradient(135deg, #6B5BFF, #5A4FCF)",color:"white",borderRadius:"16px",padding:"24px",textAlign:"center"},children:[r.jsxs("div",{style:{fontSize:"36px",fontWeight:"700",marginBottom:"8px"},children:[f.score.toFixed(1),"/5.0"]}),r.jsx("div",{style:{fontSize:"20px",fontWeight:"600"},children:f.result})]}),r.jsxs("div",{style:{border:"2px solid #f0f0f0",borderRadius:"16px",padding:"20px",background:"#fafafa"},children:[r.jsx("h4",{style:{fontSize:"18px",fontWeight:"600",color:"#333",marginBottom:"12px"},children:o.descriptionLabel}),r.jsx("p",{style:{fontSize:"16px",color:"#666",lineHeight:"1.6"},children:f.description})]}),r.jsxs("div",{style:{border:"2px solid #f0f0f0",borderRadius:"16px",padding:"20px",background:"#fafafa"},children:[r.jsx("h4",{style:{fontSize:"18px",fontWeight:"600",color:"#333",marginBottom:"12px"},children:o.analysisLabel}),r.jsx("p",{style:{fontSize:"16px",color:"#666",lineHeight:"1.6"},children:f.analysis})]}),r.jsxs("div",{style:{border:"2px solid #FFE4E1",borderRadius:"16px",padding:"20px",background:"linear-gradient(135deg, #FFF5F5, #FFE4E1)",boxShadow:"0 4px 12px rgba(255, 182, 193, 0.2)"},children:[r.jsxs("h4",{style:{fontSize:"18px",fontWeight:"600",color:"#D63384",marginBottom:"12px",display:"flex",alignItems:"center",gap:"8px"},children:["💡 ",o.recommendationsLabel]}),r.jsx("ul",{style:{fontSize:"16px",color:"#666",lineHeight:"1.6",paddingLeft:"20px"},children:f.recommendations.map((j,A)=>r.jsx("li",{style:{marginBottom:"8px"},children:j},A))})]})]}),r.jsx("div",{style:{display:"flex",justifyContent:"center",marginTop:"30px"},children:r.jsx("button",{onClick:()=>u(!1),style:{background:"linear-gradient(135deg, #6B5BFF, #5A4FCF)",color:"white",border:"none",borderRadius:"12px",padding:"12px 24px",fontSize:"16px",fontWeight:"600",cursor:"pointer"},children:o.closeReport})})]})}),r.jsx("div",{style:{width:"100%",margin:"0 auto",marginTop:24,background:"rgba(255,255,255,0.95)",borderRadius:16,padding:"16px",boxShadow:"0 2px 12px #6B5BFF22"},children:r.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:20,flexWrap:"wrap"},children:[r.jsx("span",{onClick:()=>e("/about"),style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12,cursor:"pointer"},children:o.about}),r.jsx("span",{onClick:()=>e("/privacy-policy"),style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12,cursor:"pointer"},children:o.privacyPolicy}),r.jsx("span",{onClick:()=>e("/terms"),style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12,cursor:"pointer"},children:o.terms}),r.jsx("span",{onClick:()=>e("/data-deletion"),style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px",fontSize:12,cursor:"pointer"},children:o.dataDeletion}),r.jsx("span",{onClick:()=>e("/feedback"),style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px",fontSize:12,cursor:"pointer"},children:o.feedback})]})})]})}const N5=Je(Ti),Fy={"zh-TW":{title:"確認註冊",confirming:"正在確認註冊...",success:"註冊成功！",error:"確認失敗",invalidToken:"確認連結無效或已過期",networkError:"網路連線失敗，請稍後再試",redirecting:"正在跳轉到首頁..."},"zh-CN":{title:"确认注册",confirming:"正在确认注册...",success:"注册成功！",error:"确认失败",invalidToken:"确认链接无效或已过期",networkError:"网络连接失败，请稍后再试",redirecting:"正在跳转到首页..."},en:{title:"Confirm Registration",confirming:"Confirming registration...",success:"Registration successful!",error:"Confirmation failed",invalidToken:"Confirmation link is invalid or expired",networkError:"Network connection failed, please try again later",redirecting:"Redirecting to homepage..."}};function M5(){const n=$e(),[e]=nx(),{lang:t}=Qe(),i=Fy[t]||Fy["zh-TW"],[s,o]=g.useState("confirming"),[a,l]=g.useState("");return g.useEffect(()=>{const c=e.get("token");if(!c){o("error"),l(i.invalidToken);return}(async()=>{var h,p;try{const b=await(await fetch(ea("/email-verification/confirm-registration"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:c})})).json();if(b.success){const{email:x,registrationData:S}=b,w=await kp(N5,x,S.password);await yc(w.user,{displayName:S.nickname}),await Ma(Ot(ht,"profiles",w.user.uid),{nickname:S.nickname,email:x,avatar:"",gender:S.gender,country:S.country,region:S.region,age:S.age,interest:S.interest,eventType:S.eventType,improvement:S.improvement,createdAt:new Date,updatedAt:new Date}),o("success"),l(i.success),setTimeout(()=>{n("/")},3e3)}else o("error"),l(b.error||i.error)}catch(f){console.error("確認註冊錯誤:",f),o("error"),(h=f==null?void 0:f.message)!=null&&h.includes("Failed to fetch")||(p=f==null?void 0:f.message)!=null&&p.includes("NetworkError")?l(i.networkError):l((f==null?void 0:f.message)||i.error)}})()},[e,n,i]),r.jsx("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},children:r.jsxs("div",{style:{background:"white",borderRadius:"16px",padding:"40px",boxShadow:"0 20px 40px rgba(0, 0, 0, 0.1)",textAlign:"center",maxWidth:"400px",width:"90%"},children:[r.jsxs("div",{style:{marginBottom:"24px"},children:[s==="confirming"&&r.jsx("div",{style:{fontSize:"48px",marginBottom:"16px"},children:"⏳"}),s==="success"&&r.jsx("div",{style:{fontSize:"48px",marginBottom:"16px"},children:"✅"}),s==="error"&&r.jsx("div",{style:{fontSize:"48px",marginBottom:"16px"},children:"❌"}),r.jsxs("h1",{style:{color:s==="success"?"#10b981":s==="error"?"#ef4444":"#6B5BFF",fontSize:"24px",fontWeight:"bold",marginBottom:"8px"},children:[s==="confirming"&&i.confirming,s==="success"&&i.success,s==="error"&&i.error]}),r.jsx("p",{style:{color:"#666",fontSize:"16px",lineHeight:"1.5"},children:a})]}),s==="success"&&r.jsx("div",{style:{background:"#f0f9ff",padding:"16px",borderRadius:"8px",border:"1px solid #0ea5e9",marginTop:"16px"},children:r.jsx("p",{style:{color:"#0c4a6e",fontSize:"14px"},children:i.redirecting})}),s==="error"&&r.jsx("button",{onClick:()=>n("/register"),style:{background:"linear-gradient(90deg, #6e8efb, #a777e3)",color:"white",border:"none",padding:"12px 24px",borderRadius:"8px",fontSize:"16px",fontWeight:"bold",cursor:"pointer",marginTop:"16px"},children:"返回註冊頁面"})]})})}const zy={"zh-TW":{title:"AI使用聲明",subtitle:"關於Restarter™中AI功能的使用說明",back:"返回",logout:"登出",sections:{intro:{title:"引言",content:"Restarter™使用人工智能技術來提供個性化的心理健康支援服務。本聲明旨在向您說明我們如何使用AI技術，以及您在使用這些功能時的權利和責任。"},aiFeatures:{title:"AI功能說明",content:"我們的AI功能包括：智能對話、情緒分析、個性化建議、內容生成等。這些功能旨在提供輔助性的心理健康支援，而非替代專業醫療服務。"},dataUsage:{title:"數據使用",content:"為了提供更好的AI服務，我們可能會收集和分析您與AI的互動數據。所有數據都經過加密處理，並嚴格遵守隱私保護規定。"},limitations:{title:"使用限制",content:"AI功能僅供輔助使用，不應作為專業醫療建議的替代。在緊急情況下，請立即聯繫專業醫療人員或撥打緊急求助電話。"},accuracy:{title:"準確性聲明",content:"雖然我們致力於提供準確的AI回應，但AI技術仍存在局限性。我們建議您對AI提供的建議保持批判性思考。"},userRights:{title:"用戶權利",content:"您有權了解AI如何處理您的數據，有權要求更正或刪除相關數據，也有權選擇不使用AI功能。"},updates:{title:"更新通知",content:"我們會定期更新AI功能和相關政策。重要更新會通過應用程式內通知或電子郵件告知用戶。"},contact:{title:"聯繫我們",content:"如果您對AI功能有任何疑問或建議，請通過應用程式內的意見箱或客服系統與我們聯繫。"}}},"zh-CN":{title:"AI使用声明",subtitle:"关于Restarter™中AI功能的使用说明",back:"返回",logout:"登出",sections:{intro:{title:"引言",content:"Restarter™使用人工智能技术来提供个性化的心理健康支持服务。本声明旨在向您说明我们如何使用AI技术，以及您在使用这些功能时的权利和责任。"},aiFeatures:{title:"AI功能说明",content:"我们的AI功能包括：智能对话、情绪分析、个性化建议、内容生成等。这些功能旨在提供辅助性的心理健康支持，而非替代专业医疗服务。"},dataUsage:{title:"数据使用",content:"为了提供更好的AI服务，我们可能会收集和分析您与AI的互动数据。所有数据都经过加密处理，并严格遵守隐私保护规定。"},limitations:{title:"使用限制",content:"AI功能仅供辅助使用，不应作为专业医疗建议的替代。在紧急情况下，请立即联系专业医疗人员或拨打紧急求助电话。"},accuracy:{title:"准确性声明",content:"虽然我们致力于提供准确的AI回应，但AI技术仍存在局限性。我们建议您对AI提供的建议保持批判性思考。"},userRights:{title:"用户权利",content:"您有权了解AI如何处理您的数据，有权要求更正或删除相关数据，也有权选择不使用AI功能。"},updates:{title:"更新通知",content:"我们会定期更新AI功能和相关政策。重要更新会通过应用程序内通知或电子邮件告知用户。"},contact:{title:"联系我们",content:"如果您对AI功能有任何疑问或建议，请通过应用程序内的意见箱或客服系统与我们联系。"}}},en:{title:"AI Usage Statement",subtitle:"Information about AI features in Restarter™",back:"Back",logout:"Logout",sections:{intro:{title:"Introduction",content:"Restarter™ uses artificial intelligence technology to provide personalized mental health support services. This statement aims to explain how we use AI technology and your rights and responsibilities when using these features."},aiFeatures:{title:"AI Features",content:"Our AI features include: intelligent conversations, emotion analysis, personalized recommendations, content generation, etc. These features are designed to provide辅助mental health support, not as a substitute for professional medical services."},dataUsage:{title:"Data Usage",content:"To provide better AI services, we may collect and analyze your interaction data with AI. All data is encrypted and strictly complies with privacy protection regulations."},limitations:{title:"Usage Limitations",content:"AI features are for辅助use only and should not be used as a substitute for professional medical advice. In emergency situations, please contact professional medical personnel or call emergency numbers immediately."},accuracy:{title:"Accuracy Statement",content:"While we strive to provide accurate AI responses, AI technology still has limitations. We recommend maintaining critical thinking about AI-provided suggestions."},userRights:{title:"User Rights",content:"You have the right to understand how AI processes your data, request correction or deletion of related data, and choose not to use AI features."},updates:{title:"Update Notifications",content:"We regularly update AI features and related policies. Important updates will be notified to users through in-app notifications or email."},contact:{title:"Contact Us",content:"If you have any questions or suggestions about AI features, please contact us through the feedback box or customer service system in the app."}}},ja:{title:"AI利用声明",subtitle:"Restarter™におけるAI機能の利用に関する説明",back:"戻る",logout:"ログアウト",sections:{intro:{title:"はじめに",content:"Restarter™は人工知能技術を使用して、パーソナライズされたメンタルヘルスサポートサービスを提供しています。この声明は、AI技術の使用方法と、これらの機能を使用する際の権利と責任について説明することを目的としています。"},aiFeatures:{title:"AI機能",content:"当社のAI機能には、インテリジェントな会話、感情分析、パーソナライズされた推奨事項、コンテンツ生成などが含まれます。これらの機能は、専門的な医療サービスの代替ではなく、補助的なメンタルヘルスサポートを提供することを目的としています。"},dataUsage:{title:"データ使用",content:"より良いAIサービスを提供するために、AIとの対話データを収集・分析する場合があります。すべてのデータは暗号化され、プライバシー保護規定を厳格に遵守しています。"},limitations:{title:"利用制限",content:"AI機能は補助的な使用のみを目的としており、専門的な医療アドバイスの代替として使用すべきではありません。緊急時には、専門医療従事者に連絡するか、緊急電話番号に電話してください。"},accuracy:{title:"正確性声明",content:"正確なAI応答を提供することに努めていますが、AI技術にはまだ限界があります。AIが提供する提案について批判的思考を保つことをお勧めします。"},userRights:{title:"ユーザー権利",content:"AIがデータをどのように処理するかを理解する権利、関連データの修正や削除を要求する権利、AI機能を使用しないことを選択する権利があります。"},updates:{title:"更新通知",content:"AI機能と関連ポリシーを定期的に更新します。重要な更新は、アプリ内通知またはメールでユーザーに通知されます。"},contact:{title:"お問い合わせ",content:"AI機能についてご質問やご提案がございましたら、アプリ内のフィードバックボックスまたはカスタマーサービスシステムを通じてお問い合わせください。"}}},ko:{title:"AI 사용 성명",subtitle:"Restarter™의 AI 기능 사용에 대한 설명",back:"뒤로",logout:"로그아웃",sections:{intro:{title:"소개",content:"Restarter™는 개인화된 정신 건강 지원 서비스를 제공하기 위해 인공지능 기술을 사용합니다. 이 성명은 AI 기술을 어떻게 사용하는지, 그리고 이러한 기능을 사용할 때의 권리와 책임에 대해 설명하는 것을 목적으로 합니다."},aiFeatures:{title:"AI 기능",content:"우리의 AI 기능에는 지능형 대화, 감정 분석, 개인화된 추천, 콘텐츠 생성 등이 포함됩니다. 이러한 기능은 전문 의료 서비스의 대체가 아닌 보조적인 정신 건강 지원을 제공하기 위해 설계되었습니다."},dataUsage:{title:"데이터 사용",content:"더 나은 AI 서비스를 제공하기 위해 AI와의 상호작용 데이터를 수집하고 분석할 수 있습니다. 모든 데이터는 암호화되며 개인정보 보호 규정을 엄격히 준수합니다."},limitations:{title:"사용 제한",content:"AI 기능은 보조적 사용만을 목적으로 하며 전문 의료 조언의 대체로 사용되어서는 안 됩니다. 긴급 상황에서는 즉시 전문 의료진에 연락하거나 긴급 전화번호로 전화하세요."},accuracy:{title:"정확성 성명",content:"정확한 AI 응답을 제공하기 위해 노력하고 있지만, AI 기술에는 여전히 한계가 있습니다. AI가 제공하는 제안에 대해 비판적 사고를 유지하는 것을 권장합니다."},userRights:{title:"사용자 권리",content:"AI가 데이터를 어떻게 처리하는지 이해할 권리, 관련 데이터의 수정이나 삭제를 요청할 권리, AI 기능을 사용하지 않을 권리가 있습니다."},updates:{title:"업데이트 알림",content:"AI 기능과 관련 정책을 정기적으로 업데이트합니다. 중요한 업데이트는 앱 내 알림이나 이메일로 사용자에게 알려집니다."},contact:{title:"연락처",content:"AI 기능에 대한 질문이나 제안이 있으시면 앱 내 피드백 상자나 고객 서비스 시스템을 통해 문의해 주세요."}}},th:{title:"คำแถลงการใช้ AI",subtitle:"ข้อมูลเกี่ยวกับฟีเจอร์ AI ใน Restarter™",back:"กลับ",logout:"ออกจากระบบ",sections:{intro:{title:"บทนำ",content:"Restarter™ ใช้เทคโนโลยีปัญญาประดิษฐ์เพื่อให้บริการสนับสนุนสุขภาพจิตส่วนบุคคล คำแถลงนี้มีวัตถุประสงค์เพื่ออธิบายวิธีที่เราใช้เทคโนโลยี AI และสิทธิ์และความรับผิดชอบของคุณเมื่อใช้ฟีเจอร์เหล่านี้"},aiFeatures:{title:"ฟีเจอร์ AI",content:"ฟีเจอร์ AI ของเรารวมถึง: การสนทนาอัจฉริยะ การวิเคราะห์อารมณ์ คำแนะนำส่วนบุคคล การสร้างเนื้อหา เป็นต้น ฟีเจอร์เหล่านี้ได้รับการออกแบบมาเพื่อให้การสนับสนุนสุขภาพจิตแบบเสริม ไม่ใช่เป็นทางเลือกแทนบริการทางการแพทย์มืออาชีพ"},dataUsage:{title:"การใช้ข้อมูล",content:"เพื่อให้บริการ AI ที่ดีขึ้น เราอาจเก็บรวบรวมและวิเคราะห์ข้อมูลการโต้ตอบของคุณกับ AI ข้อมูลทั้งหมดได้รับการเข้ารหัสและปฏิบัติตามระเบียบการคุ้มครองความเป็นส่วนตัวอย่างเคร่งครัด"},limitations:{title:"ข้อจำกัดการใช้งาน",content:"ฟีเจอร์ AI มีไว้สำหรับการใช้งานเสริมเท่านั้นและไม่ควรใช้เป็นทางเลือกแทนคำแนะนำทางการแพทย์มืออาชีพ ในสถานการณ์ฉุกเฉิน กรุณาติดต่อบุคลากรทางการแพทย์มืออาชีพหรือโทรหาหมายเลขฉุกเฉินทันที"},accuracy:{title:"คำแถลงความถูกต้อง",content:"ในขณะที่เราพยายามให้การตอบสนอง AI ที่ถูกต้อง แต่เทคโนโลยี AI ยังมีข้อจำกัด เราขอแนะนำให้รักษาการคิดเชิงวิพากษ์เกี่ยวกับข้อเสนอแนะที่ AI ให้"},userRights:{title:"สิทธิ์ผู้ใช้",content:"คุณมีสิทธิ์ที่จะเข้าใจว่า AI ประมวลผลข้อมูลของคุณอย่างไร ขอให้แก้ไขหรือลบข้อมูลที่เกี่ยวข้อง และเลือกที่จะไม่ใช้ฟีเจอร์ AI"},updates:{title:"การแจ้งเตือนการอัปเดต",content:"เราอัปเดตฟีเจอร์ AI และนโยบายที่เกี่ยวข้องเป็นประจำ การอัปเดตที่สำคัญจะแจ้งให้ผู้ใช้ทราบผ่านการแจ้งเตือนในแอปหรืออีเมล"},contact:{title:"ติดต่อเรา",content:"หากคุณมีคำถามหรือข้อเสนอแนะเกี่ยวกับฟีเจอร์ AI กรุณาติดต่อเราผ่านกล่องข้อเสนอแนะหรือระบบบริการลูกค้าในแอป"}}},vi:{title:"Tuyên bố sử dụng AI",subtitle:"Thông tin về tính năng AI trong Restarter™",back:"Quay lại",logout:"Đăng xuất",sections:{intro:{title:"Giới thiệu",content:"Restarter™ sử dụng công nghệ trí tuệ nhân tạo để cung cấp dịch vụ hỗ trợ sức khỏe tâm thần cá nhân hóa. Tuyên bố này nhằm giải thích cách chúng tôi sử dụng công nghệ AI và quyền lợi cũng như trách nhiệm của bạn khi sử dụng các tính năng này."},aiFeatures:{title:"Tính năng AI",content:"Các tính năng AI của chúng tôi bao gồm: hội thoại thông minh, phân tích cảm xúc, đề xuất cá nhân hóa, tạo nội dung, v.v. Những tính năng này được thiết kế để cung cấp hỗ trợ sức khỏe tâm thần bổ sung, không phải là thay thế cho dịch vụ y tế chuyên nghiệp."},dataUsage:{title:"Sử dụng dữ liệu",content:"Để cung cấp dịch vụ AI tốt hơn, chúng tôi có thể thu thập và phân tích dữ liệu tương tác của bạn với AI. Tất cả dữ liệu đều được mã hóa và tuân thủ nghiêm ngặt các quy định bảo vệ quyền riêng tư."},limitations:{title:"Hạn chế sử dụng",content:"Tính năng AI chỉ dành cho mục đích sử dụng bổ sung và không nên được sử dụng như một thay thế cho lời khuyên y tế chuyên nghiệp. Trong tình huống khẩn cấp, vui lòng liên hệ nhân viên y tế chuyên nghiệp hoặc gọi số điện thoại khẩn cấp ngay lập tức."},accuracy:{title:"Tuyên bố về độ chính xác",content:"Mặc dù chúng tôi cố gắng cung cấp phản hồi AI chính xác, nhưng công nghệ AI vẫn có những hạn chế. Chúng tôi khuyến nghị duy trì tư duy phản biện về các đề xuất do AI cung cấp."},userRights:{title:"Quyền của người dùng",content:"Bạn có quyền hiểu cách AI xử lý dữ liệu của mình, yêu cầu sửa đổi hoặc xóa dữ liệu liên quan, và chọn không sử dụng các tính năng AI."},updates:{title:"Thông báo cập nhật",content:"Chúng tôi thường xuyên cập nhật các tính năng AI và chính sách liên quan. Những cập nhật quan trọng sẽ được thông báo cho người dùng thông qua thông báo trong ứng dụng hoặc email."},contact:{title:"Liên hệ chúng tôi",content:"Nếu bạn có bất kỳ câu hỏi hoặc đề xuất nào về tính năng AI, vui lòng liên hệ với chúng tôi thông qua hộp phản hồi hoặc hệ thống dịch vụ khách hàng trong ứng dụng."}}},ms:{title:"Penyata Penggunaan AI",subtitle:"Maklumat tentang ciri AI dalam Restarter™",back:"Kembali",logout:"Log keluar",sections:{intro:{title:"Pengenalan",content:"Restarter™ menggunakan teknologi kecerdasan buatan untuk menyediakan perkhidmatan sokongan kesihatan mental yang diperibadikan. Penyata ini bertujuan untuk menjelaskan bagaimana kami menggunakan teknologi AI dan hak serta tanggungjawab anda semasa menggunakan ciri-ciri ini."},aiFeatures:{title:"Ciri AI",content:"Ciri AI kami termasuk: perbualan pintar, analisis emosi, cadangan diperibadikan, penjanaan kandungan, dll. Ciri-ciri ini direka untuk menyediakan sokongan kesihatan mental tambahan, bukan sebagai pengganti untuk perkhidmatan perubatan profesional."},dataUsage:{title:"Penggunaan Data",content:"Untuk menyediakan perkhidmatan AI yang lebih baik, kami mungkin mengumpul dan menganalisis data interaksi anda dengan AI. Semua data disulitkan dan mematuhi peraturan perlindungan privasi dengan ketat."},limitations:{title:"Batasan Penggunaan",content:"Ciri AI adalah untuk kegunaan tambahan sahaja dan tidak sepatutnya digunakan sebagai pengganti untuk nasihat perubatan profesional. Dalam situasi kecemasan, sila hubungi kakitangan perubatan profesional atau panggil nombor kecemasan dengan segera."},accuracy:{title:"Penyata Ketepatan",content:"Walaupun kami berusaha untuk menyediakan respons AI yang tepat, teknologi AI masih mempunyai batasan. Kami mengesyorkan mengekalkan pemikiran kritikal tentang cadangan yang disediakan oleh AI."},userRights:{title:"Hak Pengguna",content:"Anda mempunyai hak untuk memahami bagaimana AI memproses data anda, meminta pembetulan atau penghapusan data berkaitan, dan memilih untuk tidak menggunakan ciri AI."},updates:{title:"Pemberitahuan Kemas Kini",content:"Kami kerap mengemas kini ciri AI dan polisi berkaitan. Kemas kini penting akan diberitahu kepada pengguna melalui pemberitahuan dalam aplikasi atau e-mel."},contact:{title:"Hubungi Kami",content:"Jika anda mempunyai sebarang soalan atau cadangan tentang ciri AI, sila hubungi kami melalui kotak maklum balas atau sistem perkhidmatan pelanggan dalam aplikasi."}}},la:{title:"Declaratio Usus AI",subtitle:"Informatio de functionibus AI in Restarter™",back:"Redire",logout:"Exire",sections:{intro:{title:"Introductio",content:"Restarter™ technologia intelligentiae artificialis utitur ad praebendum servitium auxilii sanitatis mentalis personalizatum. Haec declaratio intendit explicare quomodo technologiam AI utamur et iura tua ac responsabilitates cum his functionibus utaris."},aiFeatures:{title:"Functiones AI",content:"Functiones AI nostrae includunt: colloquia intelligentes, analysis emotionum, commendationes personalizatae, generatio contenti, etc. Hae functiones designatae sunt ad praebendum auxilium sanitatis mentalis supplementarium, non substitutum pro servitiis medicis professionalibus."},dataUsage:{title:"Usus Datorum",content:"Ad praebendum servitia AI meliora, possumus colligere et analysare data interactionis tuae cum AI. Omnia data encryptata sunt et stricte observant regulas protectionis privatae."},limitations:{title:"Limitationes Usus",content:"Functiones AI sunt ad usum supplementarium tantum et non debent uti ut substitutum pro consilio medico professionale. In circumstantiis urgentibus, quaeso contacta personalem medicum professionalem vel voca numerum urgentem statim."},accuracy:{title:"Declaratio Accuratiae",content:"Etsi conamur praebere responsiones AI accuratas, technologia AI adhuc habet limitationes. Commendamus conservare cogitationem criticam de commendationibus ab AI praebitis."},userRights:{title:"Iura Usuarii",content:"Habet ius intelligere quomodo AI processat data tua, petere correctionem vel deletionem datorum relatorum, et eligere non uti functionibus AI."},updates:{title:"Notificationes Renovationis",content:"Regulariter renovamus functiones AI et politicas relatas. Renovationes importantes notificabuntur usuariis per notificationes in app vel email."},contact:{title:"Contacta Nos",content:"Si habes quaestiones vel commendationes de functionibus AI, quaeso contacta nos per cistam feedback vel systema servitii clientis in app."}}}};function W5(){const n=$e(),{lang:e}=Qe(),t=zy[e]||zy["zh-TW"];return r.jsxs("div",{style:{minHeight:"100vh",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",padding:"20px"},children:[r.jsxs("div",{style:{maxWidth:800,margin:"0 auto",background:"rgba(255,255,255,0.95)",borderRadius:16,padding:"24px",boxShadow:"0 4px 20px rgba(0,0,0,0.1)"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:24},children:[r.jsx("button",{onClick:()=>n("/"),style:{background:"#6B5BFF",color:"#fff",border:"none",borderRadius:8,padding:"8px 16px",cursor:"pointer",fontWeight:600},children:t.back}),r.jsx("h1",{style:{margin:0,color:"#6B5BFF",fontSize:24,fontWeight:700},children:t.title}),r.jsx("div",{style:{width:80}})]}),r.jsx("p",{style:{color:"#666",fontSize:16,marginBottom:32,textAlign:"center",fontStyle:"italic"},children:t.subtitle}),r.jsx("div",{style:{lineHeight:1.6},children:Object.entries(t.sections).map(([i,s])=>r.jsxs("div",{style:{marginBottom:32},children:[r.jsx("h2",{style:{color:"#6B5BFF",fontSize:20,marginBottom:12,borderBottom:"2px solid #6B5BFF",paddingBottom:8},children:s.title}),r.jsx("p",{style:{color:"#333",fontSize:16,textAlign:"justify"},children:s.content})]},i))})]}),r.jsx($a,{})]})}const Dy={"zh-TW":{title:"心理健康免責聲明",subtitle:"關於Restarter™心理健康支援服務的重要聲明",back:"返回",logout:"登出",sections:{intro:{title:"重要聲明",content:"Restarter™提供的是輔助性的心理健康支援服務，並非專業的心理治療或醫療服務。本平台旨在幫助用戶進行自我探索和情緒管理，但不能替代專業的心理健康治療。"},serviceScope:{title:"服務範圍",content:"我們的服務包括：情緒記錄、AI對話輔助、社群支援、自我反思工具等。這些功能設計用於日常的情緒管理和心理健康維護，而非處理嚴重的心理健康問題。"},limitations:{title:"服務限制",content:"Restarter™不提供緊急心理危機干預、專業診斷或治療服務。如果您正在經歷嚴重的心理健康問題，請立即尋求專業醫療幫助。"},emergency:{title:"緊急情況",content:"如果您有自殺念頭、嚴重抑鬱、急性焦慮或其他緊急心理健康問題，請立即：1) 撥打緊急求助電話 2) 聯繫專業心理醫生 3) 前往最近的急診室。"},professionalHelp:{title:"專業幫助",content:"我們強烈建議在以下情況尋求專業心理健康服務：持續的抑鬱或焦慮、創傷後應激障礙、人格障礙、物質濫用問題等。"},userResponsibility:{title:"用戶責任",content:"使用本平台時，您需要對自己的心理健康狀況負責。如果您發現症狀惡化或出現新的問題，請立即停止使用並尋求專業幫助。"},privacy:{title:"隱私保護",content:"我們嚴格保護您的隱私，但請注意：在緊急情況下，我們可能會根據法律要求分享必要信息以保護您的安全。"},contact:{title:"聯繫我們",content:"如果您對我們的服務有任何疑問或建議，請通過應用程式內的意見箱與我們聯繫。我們會盡快回覆您的問題。"}}},"zh-CN":{title:"心理健康免责声明",subtitle:"关于Restarter™心理健康支持服务的重要声明",back:"返回",logout:"登出",sections:{intro:{title:"重要声明",content:"Restarter™提供的是辅助性的心理健康支持服务，并非专业的心理治疗或医疗服务。本平台旨在帮助用户进行自我探索和情绪管理，但不能替代专业的心理健康治疗。"},serviceScope:{title:"服务范围",content:"我们的服务包括：情绪记录、AI对话辅助、社群支持、自我反思工具等。这些功能设计用于日常的情绪管理和心理健康维护，而非处理严重的心理健康问题。"},limitations:{title:"服务限制",content:"Restarter™不提供紧急心理危机干预、专业诊断或治疗服务。如果您正在经历严重的心理健康问题，请立即寻求专业医疗帮助。"},emergency:{title:"紧急情况",content:"如果您有自杀念头、严重抑郁、急性焦虑或其他紧急心理健康问题，请立即：1) 拨打紧急求助电话 2) 联系专业心理医生 3) 前往最近的急诊室。"},professionalHelp:{title:"专业帮助",content:"我们强烈建议在以下情况寻求专业心理健康服务：持续的抑郁或焦虑、创伤后应激障碍、人格障碍、物质滥用问题等。"},userResponsibility:{title:"用户责任",content:"使用本平台时，您需要对自己的心理健康状况负责。如果您发现症状恶化或出现新的问题，请立即停止使用并寻求专业帮助。"},privacy:{title:"隐私保护",content:"我们严格保护您的隐私，但请注意：在紧急情况下，我们可能会根据法律要求分享必要信息以保护您的安全。"},contact:{title:"联系我们",content:"如果您对我们的服务有任何疑问或建议，请通过应用程序内的意见箱与我们联系。我们会尽快回复您的问题。"}}},en:{title:"Mental Health Disclaimer",subtitle:"Important statement about Restarter™ mental health support services",back:"Back",logout:"Logout",sections:{intro:{title:"Important Statement",content:"Restarter™ provides辅助mental health support services, not professional psychological therapy or medical services. This platform is designed to help users with self-exploration and emotion management, but cannot replace professional mental health treatment."},serviceScope:{title:"Service Scope",content:"Our services include: emotion recording, AI conversation assistance, community support, self-reflection tools, etc. These features are designed for daily emotion management and mental health maintenance, not for handling serious mental health issues."},limitations:{title:"Service Limitations",content:"Restarter™ does not provide emergency psychological crisis intervention, professional diagnosis, or treatment services. If you are experiencing serious mental health issues, please seek professional medical help immediately."},emergency:{title:"Emergency Situations",content:"If you have suicidal thoughts, severe depression, acute anxiety, or other emergency mental health issues, please immediately: 1) Call emergency hotlines 2) Contact professional psychologists 3) Go to the nearest emergency room."},professionalHelp:{title:"Professional Help",content:"We strongly recommend seeking professional mental health services in the following situations: persistent depression or anxiety, post-traumatic stress disorder, personality disorders, substance abuse issues, etc."},userResponsibility:{title:"User Responsibility",content:"When using this platform, you are responsible for your own mental health condition. If you find symptoms worsening or new problems arising, please stop using immediately and seek professional help."},privacy:{title:"Privacy Protection",content:"We strictly protect your privacy, but please note: in emergency situations, we may share necessary information according to legal requirements to protect your safety."},contact:{title:"Contact Us",content:"If you have any questions or suggestions about our services, please contact us through the feedback box in the app. We will respond to your questions as soon as possible."}}},ja:{title:"メンタルヘルス免責事項",subtitle:"Restarter™メンタルヘルスサポートサービスに関する重要な声明",back:"戻る",logout:"ログアウト",sections:{intro:{title:"重要な声明",content:"Restarter™は補助的なメンタルヘルスサポートサービスを提供しており、専門的な心理療法や医療サービスではありません。このプラットフォームは自己探求と感情管理を支援することを目的としていますが、専門的なメンタルヘルス治療の代替とはなりません。"},serviceScope:{title:"サービス範囲",content:"当社のサービスには、感情記録、AI会話支援、コミュニティサポート、自己反省ツールなどが含まれます。これらの機能は日常的な感情管理とメンタルヘルス維持のために設計されており、深刻なメンタルヘルス問題の処理のためではありません。"},limitations:{title:"サービス制限",content:"Restarter™は緊急心理危機介入、専門診断、または治療サービスを提供しません。深刻なメンタルヘルス問題を経験している場合は、すぐに専門医療の助けを求めてください。"},emergency:{title:"緊急事態",content:"自殺念慮、重度のうつ病、急性不安、またはその他の緊急メンタルヘルス問題がある場合は、すぐに：1) 緊急ホットラインに電話 2) 専門心理学者に連絡 3) 最寄りの救急室に行ってください。"},professionalHelp:{title:"専門的支援",content:"以下の状況では専門メンタルヘルスサービスを求めることを強く推奨します：持続的なうつ病や不安、心的外傷後ストレス障害、人格障害、物質乱用問題など。"},userResponsibility:{title:"ユーザーの責任",content:"このプラットフォームを使用する際は、自分のメンタルヘルス状態に責任を持つ必要があります。症状が悪化したり新しい問題が発生した場合は、すぐに使用を停止し専門的支援を求めてください。"},privacy:{title:"プライバシー保護",content:"プライバシーを厳格に保護していますが、緊急事態では、あなたの安全を守るために法的要件に従って必要な情報を共有する場合があることにご注意ください。"},contact:{title:"お問い合わせ",content:"当社のサービスについてご質問やご提案がございましたら、アプリ内のフィードバックボックスを通じてお問い合わせください。できるだけ早くご返信いたします。"}}},ko:{title:"정신건강 면책조항",subtitle:"Restarter™ 정신건강 지원 서비스에 대한 중요한 성명",back:"뒤로",logout:"로그아웃",sections:{intro:{title:"중요한 성명",content:"Restarter™는 보조적인 정신건강 지원 서비스를 제공하며, 전문적인 심리 치료나 의료 서비스가 아닙니다. 이 플랫폼은 사용자의 자기 탐구와 감정 관리를 돕기 위해 설계되었지만, 전문적인 정신건강 치료의 대체가 될 수 없습니다."},serviceScope:{title:"서비스 범위",content:"우리의 서비스에는 감정 기록, AI 대화 지원, 커뮤니티 지원, 자기 성찰 도구 등이 포함됩니다. 이러한 기능들은 일상적인 감정 관리와 정신건강 유지를 위해 설계되었으며, 심각한 정신건강 문제를 처리하기 위한 것이 아닙니다."},limitations:{title:"서비스 제한",content:"Restarter™는 긴급 심리 위기 개입, 전문 진단 또는 치료 서비스를 제공하지 않습니다. 심각한 정신건강 문제를 경험하고 있다면 즉시 전문 의료 도움을 구하세요."},emergency:{title:"긴급 상황",content:"자살 생각, 심각한 우울증, 급성 불안 또는 기타 긴급 정신건강 문제가 있다면 즉시: 1) 긴급 도움 전화 2) 전문 심리학자 연락 3) 가장 가까운 응급실로 이동하세요."},professionalHelp:{title:"전문적 도움",content:"다음과 같은 상황에서는 전문 정신건강 서비스를 구하는 것을 강력히 권장합니다: 지속적인 우울증이나 불안, 외상 후 스트레스 장애, 인격 장애, 물질 남용 문제 등."},userResponsibility:{title:"사용자 책임",content:"이 플랫폼을 사용할 때는 자신의 정신건강 상태에 책임을 져야 합니다. 증상이 악화되거나 새로운 문제가 발생한다면 즉시 사용을 중단하고 전문적 도움을 구하세요."},privacy:{title:"개인정보 보호",content:"개인정보를 엄격히 보호하지만, 긴급 상황에서는 안전을 보호하기 위해 법적 요구사항에 따라 필요한 정보를 공유할 수 있다는 점에 유의하세요."},contact:{title:"연락처",content:"서비스에 대한 질문이나 제안이 있으시면 앱 내 피드백 상자를 통해 문의해 주세요. 가능한 한 빨리 답변드리겠습니다."}}},th:{title:"ข้อจำกัดความรับผิดชอบด้านสุขภาพจิต",subtitle:"คำแถลงสำคัญเกี่ยวกับบริการสนับสนุนสุขภาพจิตของ Restarter™",back:"กลับ",logout:"ออกจากระบบ",sections:{intro:{title:"คำแถลงสำคัญ",content:"Restarter™ ให้บริการสนับสนุนสุขภาพจิตแบบเสริม ไม่ใช่การบำบัดทางจิตวิทยาหรือบริการทางการแพทย์แบบมืออาชีพ แพลตฟอร์มนี้ได้รับการออกแบบมาเพื่อช่วยผู้ใช้ในการสำรวจตนเองและการจัดการอารมณ์ แต่ไม่สามารถแทนที่การรักษาสุขภาพจิตแบบมืออาชีพได้"},serviceScope:{title:"ขอบเขตบริการ",content:"บริการของเรารวมถึง: การบันทึกอารมณ์ การสนทนา AI แบบเสริม การสนับสนุนชุมชน เครื่องมือการสะท้อนตนเอง เป็นต้น ฟีเจอร์เหล่านี้ได้รับการออกแบบมาเพื่อการจัดการอารมณ์ประจำวันและการบำรุงรักษาสุขภาพจิต ไม่ใช่สำหรับการจัดการปัญหาสุขภาพจิตที่ร้ายแรง"},limitations:{title:"ข้อจำกัดบริการ",content:"Restarter™ ไม่ให้บริการการแทรกแซงวิกฤตทางจิตวิทยาแบบฉุกเฉิน การวินิจฉัยแบบมืออาชีพ หรือบริการการรักษา หากคุณกำลังประสบปัญหาสุขภาพจิตที่ร้ายแรง กรุณาแสวงหาความช่วยเหลือทางการแพทย์แบบมืออาชีพทันที"},emergency:{title:"สถานการณ์ฉุกเฉิน",content:"หากคุณมีความคิดฆ่าตัวตาย ภาวะซึมเศร้าอย่างร้ายแรง ความวิตกกังวลแบบเฉียบพลัน หรือปัญหาสุขภาพจิตฉุกเฉินอื่นๆ กรุณาทันที: 1) โทรสายด่วนฉุกเฉิน 2) ติดต่อนักจิตวิทยามืออาชีพ 3) ไปห้องฉุกเฉินที่ใกล้ที่สุด"},professionalHelp:{title:"ความช่วยเหลือแบบมืออาชีพ",content:"เราแนะนำอย่างยิ่งให้แสวงหาบริการสุขภาพจิตแบบมืออาชีพในสถานการณ์ต่อไปนี้: ภาวะซึมเศร้าหรือความวิตกกังวลที่ต่อเนื่อง โรคเครียดหลังเหตุการณ์สะเทือนขวัญ โรคบุคลิกภาพ การใช้สารเสพติด เป็นต้น"},userResponsibility:{title:"ความรับผิดชอบของผู้ใช้",content:"เมื่อใช้แพลตฟอร์มนี้ คุณต้องรับผิดชอบต่อสภาพสุขภาพจิตของตนเอง หากคุณพบว่าอาการแย่ลงหรือเกิดปัญหาต่างๆ ใหม่ กรุณาหยุดใช้ทันทีและแสวงหาความช่วยเหลือแบบมืออาชีพ"},privacy:{title:"การคุ้มครองความเป็นส่วนตัว",content:"เราให้ความคุ้มครองความเป็นส่วนตัวอย่างเข้มงวด แต่โปรดทราบ: ในสถานการณ์ฉุกเฉิน เราอาจแบ่งปันข้อมูลที่จำเป็นตามข้อกำหนดทางกฎหมายเพื่อปกป้องความปลอดภัยของคุณ"},contact:{title:"ติดต่อเรา",content:"หากคุณมีคำถามหรือข้อเสนอแนะเกี่ยวกับบริการของเรา กรุณาติดต่อเราผ่านกล่องข้อเสนอแนะในแอป เราจะตอบกลับคำถามของคุณโดยเร็วที่สุด"}}},vi:{title:"Tuyên bố miễn trừ sức khỏe tâm thần",subtitle:"Tuyên bố quan trọng về dịch vụ hỗ trợ sức khỏe tâm thần của Restarter™",back:"Quay lại",logout:"Đăng xuất",sections:{intro:{title:"Tuyên bố quan trọng",content:"Restarter™ cung cấp dịch vụ hỗ trợ sức khỏe tâm thần bổ sung, không phải là liệu pháp tâm lý chuyên nghiệp hoặc dịch vụ y tế. Nền tảng này được thiết kế để giúp người dùng tự khám phá và quản lý cảm xúc, nhưng không thể thay thế điều trị sức khỏe tâm thần chuyên nghiệp."},serviceScope:{title:"Phạm vi dịch vụ",content:"Dịch vụ của chúng tôi bao gồm: ghi lại cảm xúc, hỗ trợ hội thoại AI, hỗ trợ cộng đồng, công cụ tự phản ánh, v.v. Những tính năng này được thiết kế để quản lý cảm xúc hàng ngày và duy trì sức khỏe tâm thần, không phải để xử lý các vấn đề sức khỏe tâm thần nghiêm trọng."},limitations:{title:"Hạn chế dịch vụ",content:"Restarter™ không cung cấp can thiệp khủng hoảng tâm lý khẩn cấp, chẩn đoán chuyên nghiệp hoặc dịch vụ điều trị. Nếu bạn đang gặp các vấn đề sức khỏe tâm thần nghiêm trọng, vui lòng tìm kiếm sự giúp đỡ y tế chuyên nghiệp ngay lập tức."},emergency:{title:"Tình huống khẩn cấp",content:"Nếu bạn có ý nghĩ tự tử, trầm cảm nghiêm trọng, lo lắng cấp tính hoặc các vấn đề sức khỏe tâm thần khẩn cấp khác, vui lòng ngay lập tức: 1) Gọi đường dây nóng khẩn cấp 2) Liên hệ nhà tâm lý học chuyên nghiệp 3) Đến phòng cấp cứu gần nhất."},professionalHelp:{title:"Sự giúp đỡ chuyên nghiệp",content:"Chúng tôi khuyến nghị mạnh mẽ tìm kiếm dịch vụ sức khỏe tâm thần chuyên nghiệp trong các tình huống sau: trầm cảm hoặc lo lắng dai dẳng, rối loạn căng thẳng sau chấn thương, rối loạn nhân cách, vấn đề lạm dụng chất, v.v."},userResponsibility:{title:"Trách nhiệm của người dùng",content:"Khi sử dụng nền tảng này, bạn cần chịu trách nhiệm về tình trạng sức khỏe tâm thần của mình. Nếu bạn thấy các triệu chứng xấu đi hoặc xuất hiện vấn đề mới, vui lòng ngừng sử dụng ngay lập tức và tìm kiếm sự giúp đỡ chuyên nghiệp."},privacy:{title:"Bảo vệ quyền riêng tư",content:"Chúng tôi bảo vệ quyền riêng tư của bạn một cách nghiêm ngặt, nhưng vui lòng lưu ý: trong tình huống khẩn cấp, chúng tôi có thể chia sẻ thông tin cần thiết theo yêu cầu pháp lý để bảo vệ sự an toàn của bạn."},contact:{title:"Liên hệ chúng tôi",content:"Nếu bạn có bất kỳ câu hỏi hoặc đề xuất nào về dịch vụ của chúng tôi, vui lòng liên hệ với chúng tôi thông qua hộp phản hồi trong ứng dụng. Chúng tôi sẽ trả lời câu hỏi của bạn càng sớm càng tốt."}}},ms:{title:"Penafian Kesihatan Mental",subtitle:"Penyata penting tentang perkhidmatan sokongan kesihatan mental Restarter™",back:"Kembali",logout:"Log keluar",sections:{intro:{title:"Penyata Penting",content:"Restarter™ menyediakan perkhidmatan sokongan kesihatan mental tambahan, bukan terapi psikologi profesional atau perkhidmatan perubatan. Platform ini direka untuk membantu pengguna dengan penerokaan diri dan pengurusan emosi, tetapi tidak boleh menggantikan rawatan kesihatan mental profesional."},serviceScope:{title:"Skop Perkhidmatan",content:"Perkhidmatan kami termasuk: rakaman emosi, bantuan perbualan AI, sokongan komuniti, alat refleksi diri, dll. Ciri-ciri ini direka untuk pengurusan emosi harian dan penyelenggaraan kesihatan mental, bukan untuk menangani isu kesihatan mental yang serius."},limitations:{title:"Batasan Perkhidmatan",content:"Restarter™ tidak menyediakan campur tangan krisis psikologi kecemasan, diagnosis profesional, atau perkhidmatan rawatan. Jika anda mengalami isu kesihatan mental yang serius, sila dapatkan bantuan perubatan profesional dengan segera."},emergency:{title:"Situasi Kecemasan",content:"Jika anda mempunyai pemikiran membunuh diri, kemurungan teruk, kebimbangan akut, atau isu kesihatan mental kecemasan lain, sila segera: 1) Panggil talian panas kecemasan 2) Hubungi ahli psikologi profesional 3) Pergi ke bilik kecemasan terdekat."},professionalHelp:{title:"Bantuan Profesional",content:"Kami sangat mengesyorkan mendapatkan perkhidmatan kesihatan mental profesional dalam situasi berikut: kemurungan atau kebimbangan berterusan, gangguan tekanan pasca trauma, gangguan personaliti, isu penyalahgunaan bahan, dll."},userResponsibility:{title:"Tanggungjawab Pengguna",content:"Apabila menggunakan platform ini, anda bertanggungjawab untuk keadaan kesihatan mental anda sendiri. Jika anda mendapati simptom bertambah teruk atau masalah baru timbul, sila berhenti menggunakan dengan segera dan dapatkan bantuan profesional."},privacy:{title:"Perlindungan Privasi",content:"Kami melindungi privasi anda dengan ketat, tetapi sila ambil perhatian: dalam situasi kecemasan, kami mungkin berkongsi maklumat yang diperlukan mengikut keperluan undang-undang untuk melindungi keselamatan anda."},contact:{title:"Hubungi Kami",content:"Jika anda mempunyai sebarang soalan atau cadangan tentang perkhidmatan kami, sila hubungi kami melalui kotak maklum balas dalam aplikasi. Kami akan menjawab soalan anda secepat mungkin."}}},la:{title:"Renuntiatio Salutis Mentalis",subtitle:"Declaratio magna de servitiis auxilii salutis mentalis Restarter™",back:"Redire",logout:"Exire",sections:{intro:{title:"Declaratio Magna",content:"Restarter™ praebet servitia auxilii salutis mentalis supplementaria, non therapiam psychologicam professionalem vel servitia medica. Haec platforma designata est ad iuvandum usuarios cum exploratione sui et administratione emotionum, sed non potest substituere curationem salutis mentalis professionalem."},serviceScope:{title:"Scopus Servitii",content:"Servitia nostra includunt: recordationem emotionum, auxilium colloquii AI, sustentationem communitatis, instrumenta reflexionis sui, etc. Hae functiones designatae sunt ad administrationem emotionum quotidianam et sustentationem salutis mentalis, non ad tractandas quaestiones salutis mentalis graves."},limitations:{title:"Limitationes Servitii",content:"Restarter™ non praebet interventionem crisis psychologicae urgentis, diagnosis professionalem, vel servitia curationis. Si experiris quaestiones salutis mentalis graves, quaeso pete auxilium medicum professionalem statim."},emergency:{title:"Circumstantiae Urgentes",content:"Si habes cogitationes suicidales, depressionem gravem, anxietatem acutam, vel alias quaestiones salutis mentalis urgentes, quaeso statim: 1) Voca lineas calidas urgentes 2) Contacta psychologos professionales 3) I ad cubiculum urgentium proximum."},professionalHelp:{title:"Auxilium Professionale",content:"Valde commendamus petere servitia salutis mentalis professionalia in circumstantiis sequentibus: depressio vel anxietas persistens, perturbatio post-traumatica, perturbationes personalitatis, quaestiones abusus substantiarum, etc."},userResponsibility:{title:"Responsabilitas Usuarii",content:"Cum utaris hac platforma, es responsabilis pro conditione salutis mentalis tuae. Si invenis symptomata deteriorantia vel problemata nova oriuntur, quaeso desine uti statim et pete auxilium professionale."},privacy:{title:"Protectio Privatae",content:"Stricte protegitur privata tua, sed quaeso nota: in circumstantiis urgentibus, possumus communicare informationem necessariam secundum requisita legalia ad protegendum securitatem tuam."},contact:{title:"Contacta Nos",content:"Si habes quaestiones vel commendationes de servitiis nostris, quaeso contacta nos per cistam feedback in app. Respondebimus quaestionibus tuis quam celerrime."}}}};function L5(){const n=$e(),{lang:e}=Qe(),t=Dy[e]||Dy["zh-TW"];return r.jsxs("div",{style:{minHeight:"100vh",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",padding:"20px"},children:[r.jsxs("div",{style:{maxWidth:800,margin:"0 auto",background:"rgba(255,255,255,0.95)",borderRadius:16,padding:"24px",boxShadow:"0 4px 20px rgba(0,0,0,0.1)"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:24},children:[r.jsx("button",{onClick:()=>n("/"),style:{background:"#6B5BFF",color:"#fff",border:"none",borderRadius:8,padding:"8px 16px",cursor:"pointer",fontWeight:600},children:t.back}),r.jsx("h1",{style:{margin:0,color:"#6B5BFF",fontSize:24,fontWeight:700},children:t.title}),r.jsx("div",{style:{width:80}})]}),r.jsx("p",{style:{color:"#666",fontSize:16,marginBottom:32,textAlign:"center",fontStyle:"italic"},children:t.subtitle}),r.jsx("div",{style:{lineHeight:1.6},children:Object.entries(t.sections).map(([i,s])=>r.jsxs("div",{style:{marginBottom:32},children:[r.jsx("h2",{style:{color:"#6B5BFF",fontSize:20,marginBottom:12,borderBottom:"2px solid #6B5BFF",paddingBottom:8},children:s.title}),r.jsx("p",{style:{color:"#333",fontSize:16,textAlign:"justify"},children:s.content})]},i))})]}),r.jsx($a,{})]})}const Ny={"zh-TW":{title:"Cookie政策",subtitle:"關於Restarter™使用Cookie的說明",back:"返回",sections:{intro:{title:"什麼是Cookie",content:"Cookie是存儲在您設備上的小型文本文件，用於改善您的瀏覽體驗。當您訪問我們的網站時，我們可能會在您的設備上放置Cookie。"},purpose:{title:"Cookie的用途",content:"我們使用Cookie來：記住您的偏好設置、分析網站使用情況、提供個性化內容、改善網站性能、確保安全性。"},types:{title:"Cookie類型",content:"我們使用以下類型的Cookie：必要Cookie（網站基本功能）、性能Cookie（分析使用情況）、功能Cookie（記住偏好）、廣告Cookie（個性化內容）。"},control:{title:"控制Cookie",content:"您可以通過瀏覽器設置控制Cookie。大多數瀏覽器允許您阻止或刪除Cookie，但這可能影響網站功能。"},thirdParty:{title:"第三方Cookie",content:"我們可能使用第三方服務，如分析工具，這些服務可能會設置自己的Cookie。我們無法控制這些第三方Cookie。"},updates:{title:"政策更新",content:"我們可能會更新此Cookie政策。重要變更會通過網站通知或電子郵件告知用戶。"}}},"zh-CN":{title:"Cookie政策",subtitle:"关于Restarter™使用Cookie的说明",back:"返回",sections:{intro:{title:"什么是Cookie",content:"Cookie是存储在您设备上的小型文本文件，用于改善您的浏览体验。当您访问我们的网站时，我们可能会在您的设备上放置Cookie。"},purpose:{title:"Cookie的用途",content:"我们使用Cookie来：记住您的偏好设置、分析网站使用情况、提供个性化内容、改善网站性能、确保安全性。"},types:{title:"Cookie类型",content:"我们使用以下类型的Cookie：必要Cookie（网站基本功能）、性能Cookie（分析使用情况）、功能Cookie（记住偏好）、广告Cookie（个性化内容）。"},control:{title:"控制Cookie",content:"您可以通过浏览器设置控制Cookie。大多数浏览器允许您阻止或删除Cookie，但这可能影响网站功能。"},thirdParty:{title:"第三方Cookie",content:"我们可能使用第三方服务，如分析工具，这些服务可能会设置自己的Cookie。我们无法控制这些第三方Cookie。"},updates:{title:"政策更新",content:"我们可能会更新此Cookie政策。重要变更会通过网站通知或电子邮件告知用户。"}}},en:{title:"Cookie Policy",subtitle:"Information about Cookie usage in Restarter™",back:"Back",sections:{intro:{title:"What are Cookies",content:"Cookies are small text files stored on your device to improve your browsing experience. When you visit our website, we may place cookies on your device."},purpose:{title:"Purpose of Cookies",content:"We use cookies to: remember your preferences, analyze website usage, provide personalized content, improve website performance, ensure security."},types:{title:"Types of Cookies",content:"We use the following types of cookies: essential cookies (basic website functions), performance cookies (usage analytics), functional cookies (preference memory), advertising cookies (personalized content)."},control:{title:"Controlling Cookies",content:"You can control cookies through browser settings. Most browsers allow you to block or delete cookies, but this may affect website functionality."},thirdParty:{title:"Third-party Cookies",content:"We may use third-party services such as analytics tools that may set their own cookies. We cannot control these third-party cookies."},updates:{title:"Policy Updates",content:"We may update this Cookie Policy. Important changes will be notified to users through website notifications or email."}}},ja:{title:"Cookieポリシー",subtitle:"Restarter™でのCookie使用に関する説明",back:"戻る",sections:{intro:{title:"Cookieとは",content:"Cookieは、ブラウジング体験を向上させるためにデバイスに保存される小さなテキストファイルです。当サイトを訪問する際、デバイスにCookieを配置する場合があります。"},purpose:{title:"Cookieの目的",content:"Cookieは以下の目的で使用されます：設定の記憶、ウェブサイト使用状況の分析、パーソナライズされたコンテンツの提供、ウェブサイトパフォーマンスの向上、セキュリティの確保。"},types:{title:"Cookieの種類",content:"以下の種類のCookieを使用します：必須Cookie（基本的なウェブサイト機能）、パフォーマンスCookie（使用状況分析）、機能Cookie（設定の記憶）、広告Cookie（パーソナライズされたコンテンツ）。"},control:{title:"Cookieの制御",content:"ブラウザ設定でCookieを制御できます。ほとんどのブラウザでCookieのブロックや削除が可能ですが、ウェブサイトの機能に影響する場合があります。"},thirdParty:{title:"第三者Cookie",content:"分析ツールなどの第三者サービスを使用する場合があり、それらが独自のCookieを設定する可能性があります。これらの第三者Cookieは制御できません。"},updates:{title:"ポリシーの更新",content:"このCookieポリシーを更新する場合があります。重要な変更はウェブサイト通知またはメールでユーザーに通知されます。"}}},ko:{title:"쿠키 정책",subtitle:"Restarter™에서 쿠키 사용에 대한 설명",back:"뒤로",sections:{intro:{title:"쿠키란",content:"쿠키는 브라우징 경험을 향상시키기 위해 기기에 저장되는 작은 텍스트 파일입니다. 당사 웹사이트를 방문할 때 기기에 쿠키를 배치할 수 있습니다."},purpose:{title:"쿠키의 목적",content:"쿠키는 다음 목적으로 사용됩니다: 설정 기억, 웹사이트 사용 분석, 개인화된 콘텐츠 제공, 웹사이트 성능 향상, 보안 보장."},types:{title:"쿠키 유형",content:"다음 유형의 쿠키를 사용합니다: 필수 쿠키(기본 웹사이트 기능), 성능 쿠키(사용 분석), 기능 쿠키(설정 기억), 광고 쿠키(개인화된 콘텐츠)."},control:{title:"쿠키 제어",content:"브라우저 설정을 통해 쿠키를 제어할 수 있습니다. 대부분의 브라우저에서 쿠키를 차단하거나 삭제할 수 있지만 웹사이트 기능에 영향을 줄 수 있습니다."},thirdParty:{title:"제3자 쿠키",content:"분석 도구와 같은 제3자 서비스를 사용할 수 있으며, 이들이 자체 쿠키를 설정할 수 있습니다. 이러한 제3자 쿠키는 제어할 수 없습니다."},updates:{title:"정책 업데이트",content:"이 쿠키 정책을 업데이트할 수 있습니다. 중요한 변경사항은 웹사이트 알림 또는 이메일로 사용자에게 알려집니다."}}},th:{title:"นโยบายคุกกี้",subtitle:"ข้อมูลเกี่ยวกับการใช้คุกกี้ใน Restarter™",back:"กลับ",sections:{intro:{title:"คุกกี้คืออะไร",content:"คุกกี้เป็นไฟล์ข้อความขนาดเล็กที่เก็บไว้ในอุปกรณ์ของคุณเพื่อปรับปรุงประสบการณ์การท่องเว็บ เมื่อคุณเยี่ยมชมเว็บไซต์ของเรา เราอาจวางคุกกี้ในอุปกรณ์ของคุณ"},purpose:{title:"วัตถุประสงค์ของคุกกี้",content:"เราใช้คุกกี้เพื่อ: จำการตั้งค่าของคุณ วิเคราะห์การใช้เว็บไซต์ ให้เนื้อหาส่วนบุคคล ปรับปรุงประสิทธิภาพเว็บไซต์ รับประกันความปลอดภัย"},types:{title:"ประเภทของคุกกี้",content:"เราใช้คุกกี้ประเภทต่อไปนี้: คุกกี้ที่จำเป็น (ฟังก์ชันพื้นฐานของเว็บไซต์) คุกกี้ประสิทธิภาพ (การวิเคราะห์การใช้งาน) คุกกี้ฟังก์ชัน (จำการตั้งค่า) คุกกี้โฆษณา (เนื้อหาส่วนบุคคล)"},control:{title:"การควบคุมคุกกี้",content:"คุณสามารถควบคุมคุกกี้ผ่านการตั้งค่าเบราว์เซอร์ เบราว์เซอร์ส่วนใหญ่อนุญาตให้คุณบล็อกหรือลบคุกกี้ได้ แต่อาจส่งผลต่อฟังก์ชันของเว็บไซต์"},thirdParty:{title:"คุกกี้ของบุคคลที่สาม",content:"เราอาจใช้บริการของบุคคลที่สาม เช่น เครื่องมือวิเคราะห์ ที่อาจตั้งค่าคุกกี้ของตัวเอง เราไม่สามารถควบคุมคุกกี้ของบุคคลที่สามเหล่านี้ได้"},updates:{title:"การอัปเดตนโยบาย",content:"เราอาจอัปเดตนโยบายคุกกี้นี้ การเปลี่ยนแปลงที่สำคัญจะแจ้งให้ผู้ใช้ทราบผ่านการแจ้งเตือนเว็บไซต์หรืออีเมล"}}},vi:{title:"Chính sách Cookie",subtitle:"Thông tin về việc sử dụng Cookie trong Restarter™",back:"Quay lại",sections:{intro:{title:"Cookie là gì",content:"Cookie là các tệp văn bản nhỏ được lưu trữ trên thiết bị của bạn để cải thiện trải nghiệm duyệt web. Khi bạn truy cập trang web của chúng tôi, chúng tôi có thể đặt cookie trên thiết bị của bạn."},purpose:{title:"Mục đích của Cookie",content:"Chúng tôi sử dụng cookie để: ghi nhớ tùy chọn của bạn, phân tích việc sử dụng trang web, cung cấp nội dung cá nhân hóa, cải thiện hiệu suất trang web, đảm bảo bảo mật."},types:{title:"Các loại Cookie",content:"Chúng tôi sử dụng các loại cookie sau: cookie cần thiết (chức năng cơ bản của trang web), cookie hiệu suất (phân tích sử dụng), cookie chức năng (ghi nhớ tùy chọn), cookie quảng cáo (nội dung cá nhân hóa)."},control:{title:"Kiểm soát Cookie",content:"Bạn có thể kiểm soát cookie thông qua cài đặt trình duyệt. Hầu hết các trình duyệt cho phép bạn chặn hoặc xóa cookie, nhưng điều này có thể ảnh hưởng đến chức năng trang web."},thirdParty:{title:"Cookie của bên thứ ba",content:"Chúng tôi có thể sử dụng các dịch vụ bên thứ ba như công cụ phân tích có thể đặt cookie riêng của họ. Chúng tôi không thể kiểm soát các cookie bên thứ ba này."},updates:{title:"Cập nhật chính sách",content:"Chúng tôi có thể cập nhật chính sách Cookie này. Những thay đổi quan trọng sẽ được thông báo cho người dùng thông qua thông báo trang web hoặc email."}}},ms:{title:"Dasar Cookie",subtitle:"Maklumat tentang penggunaan Cookie dalam Restarter™",back:"Kembali",sections:{intro:{title:"Apa itu Cookie",content:"Cookie adalah fail teks kecil yang disimpan pada peranti anda untuk meningkatkan pengalaman melayari. Apabila anda melawat laman web kami, kami mungkin meletakkan cookie pada peranti anda."},purpose:{title:"Tujuan Cookie",content:"Kami menggunakan cookie untuk: mengingati pilihan anda, menganalisis penggunaan laman web, menyediakan kandungan peribadi, meningkatkan prestasi laman web, memastikan keselamatan."},types:{title:"Jenis Cookie",content:"Kami menggunakan jenis cookie berikut: cookie penting (fungsi asas laman web), cookie prestasi (analisis penggunaan), cookie fungsi (ingatan pilihan), cookie iklan (kandungan peribadi)."},control:{title:"Mengawal Cookie",content:"Anda boleh mengawal cookie melalui tetapan pelayar. Kebanyakan pelayar membolehkan anda menyekat atau memadamkan cookie, tetapi ini mungkin menjejaskan fungsi laman web."},thirdParty:{title:"Cookie Pihak Ketiga",content:"Kami mungkin menggunakan perkhidmatan pihak ketiga seperti alat analisis yang mungkin menetapkan cookie sendiri. Kami tidak boleh mengawal cookie pihak ketiga ini."},updates:{title:"Kemas Kini Dasar",content:"Kami mungkin mengemas kini Dasar Cookie ini. Perubahan penting akan diberitahu kepada pengguna melalui pemberitahuan laman web atau e-mel."}}},la:{title:"Politica Cookie",subtitle:"Informatio de usu Cookie in Restarter™",back:"Redire",sections:{intro:{title:"Quid sunt Cookie",content:"Cookie sunt parva texta documenta in tuo apparatu reposita ad meliorandum navigationis experientiam. Cum nostrum situm visitas, possumus cookie in tuo apparatu ponere."},purpose:{title:"Propositum Cookie",content:"Utimur cookie ad: meminisse electiones tuas, analysare usum situs, praebere contentum personalizatum, meliorare efficacitatem situs, securitatem praestare."},types:{title:"Typi Cookie",content:"Utimur sequentibus typis cookie: cookie essentiales (functiones basici situs), cookie efficacitatis (analysis usus), cookie functionales (memoria electionum), cookie publicitatis (contentum personalizatum)."},control:{title:"Controllare Cookie",content:"Potes controllare cookie per configurationes navigatoris. Plurimi navigatores permittunt te prohibere vel delere cookie, sed hoc potest afficere functiones situs."},thirdParty:{title:"Cookie Tertii Partis",content:"Possumus uti servitiis tertii partis sicut instrumenta analysi quae possunt ponere sua propria cookie. Non possumus controllare haec cookie tertii partis."},updates:{title:"Renovationes Politicae",content:"Possumus renovare hanc Politicam Cookie. Mutationes importantes notificabuntur usuariis per notificationes situs vel email."}}}};function O5(){const n=$e(),{lang:e}=Qe(),t=Ny[e]||Ny["zh-TW"];return r.jsxs("div",{style:{minHeight:"100vh",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",padding:"20px"},children:[r.jsxs("div",{style:{maxWidth:800,margin:"0 auto",background:"rgba(255,255,255,0.95)",borderRadius:16,padding:"24px",boxShadow:"0 4px 20px rgba(0,0,0,0.1)"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:24},children:[r.jsx("button",{onClick:()=>n("/"),style:{background:"#6B5BFF",color:"#fff",border:"none",borderRadius:8,padding:"8px 16px",cursor:"pointer",fontWeight:600},children:t.back}),r.jsx("h1",{style:{margin:0,color:"#6B5BFF",fontSize:24,fontWeight:700},children:t.title}),r.jsx("div",{style:{width:80}})]}),r.jsx("p",{style:{color:"#666",fontSize:16,marginBottom:32,textAlign:"center",fontStyle:"italic"},children:t.subtitle}),r.jsx("div",{style:{lineHeight:1.6},children:Object.entries(t.sections).map(([i,s])=>r.jsxs("div",{style:{marginBottom:32},children:[r.jsx("h2",{style:{color:"#6B5BFF",fontSize:20,marginBottom:12,borderBottom:"2px solid #6B5BFF",paddingBottom:8},children:s.title}),r.jsx("p",{style:{color:"#333",fontSize:16,textAlign:"justify"},children:s.content})]},i))})]}),r.jsx($a,{})]})}const My={"zh-TW":{title:"兒童隱私保護",subtitle:"關於Restarter™對兒童隱私的保護措施",back:"返回",sections:{intro:{title:"兒童隱私保護聲明",content:"Restarter™重視兒童隱私保護，嚴格遵守相關法律法規。我們不會故意收集13歲以下兒童的個人信息，除非獲得家長或監護人的明確同意。"},ageLimit:{title:"年齡限制",content:"我們的服務主要面向13歲以上的用戶。13歲以下兒童如需使用服務，必須在家長或監護人的監督下進行。"},parentalConsent:{title:"家長同意",content:"如果我們發現收集了13歲以下兒童的信息，會立即刪除相關數據並通知家長。家長有權要求查看、修改或刪除子女的個人信息。"},dataProtection:{title:"數據保護",content:"我們對兒童數據實施額外的保護措施，包括加密存儲、訪問限制、定期審查等，確保兒童隱私安全。"},contact:{title:"聯繫我們",content:"如果您對兒童隱私保護有任何疑問，請通過應用程式內的意見箱與我們聯繫。我們會認真處理每一項相關請求。"}}},"zh-CN":{title:"儿童隐私保护",subtitle:"关于Restarter™对儿童隐私的保护措施",back:"返回",sections:{intro:{title:"儿童隐私保护声明",content:"Restarter™重视儿童隐私保护，严格遵守相关法律法规。我们不会故意收集13岁以下儿童的个人信息，除非获得家长或监护人的明确同意。"},ageLimit:{title:"年龄限制",content:"我们的服务主要面向13岁以上的用户。13岁以下儿童如需使用服务，必须在家长或监护人的监督下进行。"},parentalConsent:{title:"家长同意",content:"如果我们发现收集了13岁以下儿童的信息，会立即删除相关数据并通知家长。家长有权要求查看、修改或删除子女的个人信息。"},dataProtection:{title:"数据保护",content:"我们对儿童数据实施额外的保护措施，包括加密存储、访问限制、定期审查等，确保儿童隐私安全。"},contact:{title:"联系我们",content:"如果您对儿童隐私保护有任何疑问，请通过应用程序内的意见箱与我们联系。我们会认真处理每一项相关请求。"}}},en:{title:"Children's Privacy",subtitle:"Restarter™ protection measures for children's privacy",back:"Back",sections:{intro:{title:"Children's Privacy Statement",content:"Restarter™ values children's privacy protection and strictly complies with relevant laws and regulations. We do not knowingly collect personal information from children under 13 unless we obtain explicit consent from parents or guardians."},ageLimit:{title:"Age Restrictions",content:"Our services are primarily intended for users aged 13 and above. Children under 13 must use our services under parental or guardian supervision."},parentalConsent:{title:"Parental Consent",content:"If we discover that we have collected information from children under 13, we will immediately delete the relevant data and notify parents. Parents have the right to request to view, modify, or delete their children's personal information."},dataProtection:{title:"Data Protection",content:"We implement additional protection measures for children's data, including encrypted storage, access restrictions, regular reviews, etc., to ensure children's privacy security."},contact:{title:"Contact Us",content:"If you have any questions about children's privacy protection, please contact us through the feedback box in the app. We will seriously handle every related request."}}},ja:{title:"児童プライバシー保護",subtitle:"Restarter™の児童プライバシー保護措置について",back:"戻る",sections:{intro:{title:"児童プライバシー保護声明",content:"Restarter™は児童のプライバシー保護を重視し、関連する法律・規制を厳格に遵守しています。保護者または後見人の明確な同意がない限り、13歳未満の児童の個人情報を故意に収集することはありません。"},ageLimit:{title:"年齢制限",content:"当社のサービスは主に13歳以上のユーザーを対象としています。13歳未満の児童がサービスを使用する場合は、保護者または後見人の監督下で行う必要があります。"},parentalConsent:{title:"保護者の同意",content:"13歳未満の児童からの情報収集を発見した場合、関連データを即座に削除し保護者に通知します。保護者は子供の個人情報の閲覧、修正、削除を要求する権利があります。"},dataProtection:{title:"データ保護",content:"児童データに対して暗号化保存、アクセス制限、定期レビューなどの追加保護措置を実施し、児童のプライバシーセキュリティを確保します。"},contact:{title:"お問い合わせ",content:"児童プライバシー保護についてご質問がございましたら、アプリ内のフィードバックボックスを通じてお問い合わせください。すべての関連リクエストを真摯に処理いたします。"}}},ko:{title:"아동 개인정보 보호",subtitle:"Restarter™의 아동 개인정보 보호 조치에 대해",back:"뒤로",sections:{intro:{title:"아동 개인정보 보호 성명",content:"Restarter™는 아동 개인정보 보호를 중시하며 관련 법률 및 규정을 엄격히 준수합니다. 부모 또는 보호자의 명시적 동의가 없는 한 13세 미만 아동의 개인정보를 고의로 수집하지 않습니다."},ageLimit:{title:"연령 제한",content:"당사의 서비스는 주로 13세 이상 사용자를 대상으로 합니다. 13세 미만 아동이 서비스를 사용하려면 부모 또는 보호자의 감독 하에 이루어져야 합니다."},parentalConsent:{title:"부모 동의",content:"13세 미만 아동으로부터 정보 수집을 발견한 경우 관련 데이터를 즉시 삭제하고 부모에게 알립니다. 부모는 자녀의 개인정보 조회, 수정, 삭제를 요청할 권리가 있습니다."},dataProtection:{title:"데이터 보호",content:"아동 데이터에 대해 암호화 저장, 접근 제한, 정기 검토 등의 추가 보호 조치를 시행하여 아동의 개인정보 보안을 보장합니다."},contact:{title:"연락처",content:"아동 개인정보 보호에 대한 질문이 있으시면 앱 내 피드백 상자를 통해 문의해 주세요. 모든 관련 요청을 진지하게 처리하겠습니다."}}},th:{title:"การคุ้มครองความเป็นส่วนตัวของเด็ก",subtitle:"มาตรการคุ้มครองความเป็นส่วนตัวของเด็กของ Restarter™",back:"กลับ",sections:{intro:{title:"คำแถลงการคุ้มครองความเป็นส่วนตัวของเด็ก",content:"Restarter™ ให้ความสำคัญกับการคุ้มครองความเป็นส่วนตัวของเด็กและปฏิบัติตามกฎหมายและระเบียบที่เกี่ยวข้องอย่างเคร่งครัด เราไม่เก็บรวบรวมข้อมูลส่วนบุคคลของเด็กอายุต่ำกว่า 13 ปีโดยเจตนา เว้นแต่จะได้รับความยินยอมอย่างชัดเจนจากผู้ปกครองหรือผู้ดูแล"},ageLimit:{title:"ข้อจำกัดอายุ",content:"บริการของเรามุ่งเน้นไปที่ผู้ใช้อายุ 13 ปีขึ้นไป เด็กอายุต่ำกว่า 13 ปีต้องใช้บริการภายใต้การดูแลของผู้ปกครองหรือผู้ดูแล"},parentalConsent:{title:"ความยินยอมของผู้ปกครอง",content:"หากเราพบว่าเราได้เก็บรวบรวมข้อมูลจากเด็กอายุต่ำกว่า 13 ปี เราจะลบข้อมูลที่เกี่ยวข้องทันทีและแจ้งให้ผู้ปกครองทราบ ผู้ปกครองมีสิทธิ์ขอดู แก้ไข หรือลบข้อมูลส่วนบุคคลของบุตรหลาน"},dataProtection:{title:"การคุ้มครองข้อมูล",content:"เราใช้มาตรการคุ้มครองเพิ่มเติมสำหรับข้อมูลของเด็ก รวมถึงการเข้ารหัสการจัดเก็บ การจำกัดการเข้าถึง การตรวจสอบเป็นประจำ เป็นต้น เพื่อรับประกันความปลอดภัยของความเป็นส่วนตัวของเด็ก"},contact:{title:"ติดต่อเรา",content:"หากคุณมีคำถามเกี่ยวกับการคุ้มครองความเป็นส่วนตัวของเด็ก กรุณาติดต่อเราผ่านกล่องข้อเสนอแนะในแอป เราจะจัดการทุกคำขอที่เกี่ยวข้องอย่างจริงจัง"}}},vi:{title:"Bảo vệ quyền riêng tư trẻ em",subtitle:"Các biện pháp bảo vệ quyền riêng tư trẻ em của Restarter™",back:"Quay lại",sections:{intro:{title:"Tuyên bố bảo vệ quyền riêng tư trẻ em",content:"Restarter™ coi trọng việc bảo vệ quyền riêng tư trẻ em và tuân thủ nghiêm ngặt các luật pháp và quy định liên quan. Chúng tôi không cố ý thu thập thông tin cá nhân của trẻ em dưới 13 tuổi trừ khi có sự đồng ý rõ ràng từ cha mẹ hoặc người giám hộ."},ageLimit:{title:"Hạn chế độ tuổi",content:"Dịch vụ của chúng tôi chủ yếu dành cho người dùng từ 13 tuổi trở lên. Trẻ em dưới 13 tuổi phải sử dụng dịch vụ dưới sự giám sát của cha mẹ hoặc người giám hộ."},parentalConsent:{title:"Sự đồng ý của cha mẹ",content:"Nếu chúng tôi phát hiện đã thu thập thông tin từ trẻ em dưới 13 tuổi, chúng tôi sẽ ngay lập tức xóa dữ liệu liên quan và thông báo cho cha mẹ. Cha mẹ có quyền yêu cầu xem, sửa đổi hoặc xóa thông tin cá nhân của con cái."},dataProtection:{title:"Bảo vệ dữ liệu",content:"Chúng tôi thực hiện các biện pháp bảo vệ bổ sung cho dữ liệu trẻ em, bao gồm lưu trữ mã hóa, hạn chế truy cập, đánh giá định kỳ, v.v., để đảm bảo an toàn quyền riêng tư trẻ em."},contact:{title:"Liên hệ chúng tôi",content:"Nếu bạn có bất kỳ câu hỏi nào về bảo vệ quyền riêng tư trẻ em, vui lòng liên hệ với chúng tôi thông qua hộp phản hồi trong ứng dụng. Chúng tôi sẽ xử lý nghiêm túc mọi yêu cầu liên quan."}}},ms:{title:"Privasi Kanak-kanak",subtitle:"Langkah-langkah perlindungan privasi kanak-kanak Restarter™",back:"Kembali",sections:{intro:{title:"Penyata Privasi Kanak-kanak",content:"Restarter™ menghargai perlindungan privasi kanak-kanak dan mematuhi undang-undang dan peraturan yang berkaitan dengan ketat. Kami tidak sengaja mengumpul maklumat peribadi kanak-kanak di bawah umur 13 tahun melainkan kami memperoleh persetujuan yang jelas daripada ibu bapa atau penjaga."},ageLimit:{title:"Sekatan Umur",content:"Perkhidmatan kami terutamanya bertujuan untuk pengguna berumur 13 tahun ke atas. Kanak-kanak di bawah umur 13 tahun mesti menggunakan perkhidmatan kami di bawah penyeliaan ibu bapa atau penjaga."},parentalConsent:{title:"Persetujuan Ibu Bapa",content:"Jika kami mendapati bahawa kami telah mengumpul maklumat daripada kanak-kanak di bawah umur 13 tahun, kami akan segera memadamkan data yang berkaitan dan memberitahu ibu bapa. Ibu bapa mempunyai hak untuk meminta melihat, mengubah suai, atau memadamkan maklumat peribadi anak-anak mereka."},dataProtection:{title:"Perlindungan Data",content:"Kami melaksanakan langkah-langkah perlindungan tambahan untuk data kanak-kanak, termasuk penyimpanan terenkripsi, sekatan akses, ulasan berkala, dll., untuk memastikan keselamatan privasi kanak-kanak."},contact:{title:"Hubungi Kami",content:"Jika anda mempunyai sebarang soalan tentang perlindungan privasi kanak-kanak, sila hubungi kami melalui kotak maklum balas dalam aplikasi. Kami akan menangani setiap permintaan yang berkaitan dengan serius."}}},la:{title:"Privata Puerorum",subtitle:"Restarter™ mensurae protectionis privatae puerorum",back:"Redire",sections:{intro:{title:"Declaratio Privatae Puerorum",content:"Restarter™ aestimat protectionem privatae puerorum et stricte observat leges et regulas pertinentes. Non scienter colligimus informationem personalem puerorum sub annis 13 nisi obtinemus consensum explicitum a parentibus vel tutoribus."},ageLimit:{title:"Limitationes Aetatis",content:"Servitia nostra principaliter intenduntur pro usuariis annorum 13 et supra. Pueri sub annis 13 debent uti servitiis nostris sub supervisione parentum vel tutorum."},parentalConsent:{title:"Consensus Parentum",content:"Si invenimus nos collegisse informationem a pueris sub annis 13, statim delere data relata et notificare parentes. Parentes habent ius petendi videre, mutare, vel delere informationem personalem filiorum suorum."},dataProtection:{title:"Protectio Datorum",content:"Implementamus mensuras protectionis additas pro datis puerorum, includentes repositorium encryptatum, limitationes accessus, revisiones regulares, etc., ad praestandum securitatem privatae puerorum."},contact:{title:"Contacta Nos",content:"Si habes quaestiones de protectione privatae puerorum, quaeso contacta nos per cistam feedback in app. Tractabimus omnem petitionem relatum serio."}}}};function V5(){const n=$e(),{lang:e}=Qe(),t=My[e]||My["zh-TW"];return r.jsxs("div",{style:{minHeight:"100vh",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",padding:"20px"},children:[r.jsxs("div",{style:{maxWidth:800,margin:"0 auto",background:"rgba(255,255,255,0.95)",borderRadius:16,padding:"24px",boxShadow:"0 4px 20px rgba(0,0,0,0.1)"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:24},children:[r.jsx("button",{onClick:()=>n("/"),style:{background:"#6B5BFF",color:"#fff",border:"none",borderRadius:8,padding:"8px 16px",cursor:"pointer",fontWeight:600},children:t.back}),r.jsx("h1",{style:{margin:0,color:"#6B5BFF",fontSize:24,fontWeight:700},children:t.title}),r.jsx("div",{style:{width:80}})]}),r.jsx("p",{style:{color:"#666",fontSize:16,marginBottom:32,textAlign:"center",fontStyle:"italic"},children:t.subtitle}),r.jsx("div",{style:{lineHeight:1.6},children:Object.entries(t.sections).map(([i,s])=>r.jsxs("div",{style:{marginBottom:32},children:[r.jsx("h2",{style:{color:"#6B5BFF",fontSize:20,marginBottom:12,borderBottom:"2px solid #6B5BFF",paddingBottom:8},children:s.title}),r.jsx("p",{style:{color:"#333",fontSize:16,textAlign:"justify"},children:s.content})]},i))})]}),r.jsx($a,{})]})}const Wy={"zh-TW":{title:"國際用戶法律聲明",back:"返回",sections:{scope:{title:"1. 適用範圍",content:"本聲明適用於所有使用Restarter服務的國際用戶，無論您位於哪個國家或地區。"},crossBorder:{title:"2. 數據跨境傳輸",content:"由於我們的服務可能涉及數據跨境傳輸，我們承諾：",items:["遵守相關國家的數據保護法律","實施適當的安全措施保護您的數據","在必要時獲得必要的法律授權"]},compliance:{title:"3. 當地法律合規",content:"我們努力確保服務符合您所在地區的適用法律，包括但不限於：",items:["數據保護法規（如GDPR、CCPA等）","消費者保護法律","內容監管要求"]},dispute:{title:"4. 爭議解決",content:"如發生爭議，我們將優先通過友好協商解決。如協商不成，將根據相關法律和我們的服務條款進行處理。"},contact:{title:"5. 聯繫信息",content:"如果您對本聲明有任何疑問，或需要了解特定地區的法律適用情況，請通過以下方式聯繫我們：",email:"郵箱：legal@restarter.com"},updates:{title:"6. 更新通知",content:"我們可能會根據法律變化或業務需要更新本聲明。重要更新將通過應用內通知或郵件方式告知用戶。"}},footer:{lastUpdate:"最後更新時間：2024年12月",version:"版本：1.0"}},"zh-CN":{title:"国际用户法律声明",back:"返回",sections:{scope:{title:"1. 适用范围",content:"本声明适用于所有使用Restarter服务的国际用户，无论您位于哪个国家或地区。"},crossBorder:{title:"2. 数据跨境传输",content:"由于我们的服务可能涉及数据跨境传输，我们承诺：",items:["遵守相关国家的数据保护法律","实施适当的安全措施保护您的数据","在必要时获得必要的法律授权"]},compliance:{title:"3. 当地法律合规",content:"我们努力确保服务符合您所在地区的适用法律，包括但不限于：",items:["数据保护法规（如GDPR、CCPA等）","消费者保护法律","内容监管要求"]},dispute:{title:"4. 争议解决",content:"如发生争议，我们将优先通过友好协商解决。如协商不成，将根据相关法律和我们的服务条款进行处理。"},contact:{title:"5. 联系信息",content:"如果您对本声明有任何疑问，或需要了解特定地区的法律适用情况，请通过以下方式联系我们：",email:"邮箱：legal@restarter.com"},updates:{title:"6. 更新通知",content:"我们可能会根据法律变化或业务需要更新本声明。重要更新将通过应用内通知或邮件方式告知用户。"}},footer:{lastUpdate:"最后更新时间：2024年12月",version:"版本：1.0"}},en:{title:"International Users Legal Statement",back:"Back",sections:{scope:{title:"1. Scope of Application",content:"This statement applies to all international users of Restarter services, regardless of which country or region you are located in."},crossBorder:{title:"2. Cross-Border Data Transfer",content:"As our services may involve cross-border data transfer, we commit to:",items:["Comply with data protection laws in relevant countries","Implement appropriate security measures to protect your data","Obtain necessary legal authorization when required"]},compliance:{title:"3. Local Legal Compliance",content:"We strive to ensure that our services comply with applicable laws in your region, including but not limited to:",items:["Data protection regulations (such as GDPR, CCPA, etc.)","Consumer protection laws","Content regulation requirements"]},dispute:{title:"4. Dispute Resolution",content:"In the event of disputes, we will prioritize resolution through friendly negotiation. If negotiation fails, we will handle the matter according to relevant laws and our service terms."},contact:{title:"5. Contact Information",content:"If you have any questions about this statement, or need to understand the legal applicability in specific regions, please contact us through:",email:"Email: legal@restarter.com"},updates:{title:"6. Update Notifications",content:"We may update this statement based on legal changes or business needs. Important updates will be notified to users through in-app notifications or email."}},footer:{lastUpdate:"Last updated: December 2024",version:"Version: 1.0"}}},q5=()=>{const n=$e(),{lang:e}=Qe(),t=Wy[e]||Wy["zh-TW"];return r.jsx("div",{className:"legal-page",children:r.jsxs("div",{className:"legal-container",children:[r.jsxs("div",{className:"legal-header",children:[r.jsxs("button",{onClick:()=>n(-1),className:"back-button",children:["← ",t.back]}),r.jsx("h1",{children:t.title})]}),r.jsxs("div",{className:"legal-content",children:[r.jsxs("section",{children:[r.jsx("h2",{children:t.sections.scope.title}),r.jsx("p",{children:t.sections.scope.content})]}),r.jsxs("section",{children:[r.jsx("h2",{children:t.sections.crossBorder.title}),r.jsx("p",{children:t.sections.crossBorder.content}),r.jsx("ul",{children:t.sections.crossBorder.items.map((i,s)=>r.jsx("li",{children:i},s))})]}),r.jsxs("section",{children:[r.jsx("h2",{children:t.sections.compliance.title}),r.jsx("p",{children:t.sections.compliance.content}),r.jsx("ul",{children:t.sections.compliance.items.map((i,s)=>r.jsx("li",{children:i},s))})]}),r.jsxs("section",{children:[r.jsx("h2",{children:t.sections.dispute.title}),r.jsx("p",{children:t.sections.dispute.content})]}),r.jsxs("section",{children:[r.jsx("h2",{children:t.sections.contact.title}),r.jsx("p",{children:t.sections.contact.content}),r.jsx("p",{children:t.sections.contact.email})]}),r.jsxs("section",{children:[r.jsx("h2",{children:t.sections.updates.title}),r.jsx("p",{children:t.sections.updates.content})]}),r.jsxs("div",{className:"legal-footer",children:[r.jsx("p",{children:t.footer.lastUpdate}),r.jsx("p",{children:t.footer.version})]})]})]})})},Ly={"zh-TW":{title:"安全聲明",back:"返回",sections:{commitment:{title:"1. 數據安全承諾",content:"Restarter致力於保護您的個人信息和數據安全。我們採用行業標準的安全措施來保護您的數據。"},encryption:{title:"2. 數據加密",content:"我們使用以下加密技術保護您的數據：",items:["傳輸層安全協議（TLS）加密所有數據傳輸","數據庫級別的加密存儲","端到端加密保護敏感信息"]},accessControl:{title:"3. 訪問控制",content:"我們實施嚴格的數據訪問控制：",items:["基於角色的訪問控制（RBAC）","多因素認證（MFA）","定期安全審計和監控","最小權限原則"]},infrastructure:{title:"4. 安全基礎設施",content:"我們的基礎設施安全措施包括：",items:["雲服務提供商的安全認證","定期安全漏洞掃描","入侵檢測和防護系統","災難恢復和業務連續性計劃"]},employees:{title:"5. 員工安全",content:"我們確保所有員工：",items:["接受定期安全培訓","簽署保密協議","遵循數據保護最佳實踐"]},incidentResponse:{title:"6. 安全事件響應",content:"如發生安全事件，我們將：",items:["立即啟動應急響應程序","評估事件影響範圍","及時通知受影響的用戶","採取補救措施防止類似事件"]},thirdParty:{title:"7. 第三方安全",content:"我們嚴格審查第三方服務提供商的安全標準，確保他們符合我們的安全要求。"},reporting:{title:"8. 安全報告",content:"如果您發現安全漏洞或有安全相關問題，請立即聯繫我們：",email:"安全郵箱：security@restarter.com"}},footer:{lastUpdate:"最後更新時間：2024年12月",version:"版本：1.0"}},"zh-CN":{title:"安全声明",back:"返回",sections:{commitment:{title:"1. 数据安全承诺",content:"Restarter致力于保护您的个人信息和数据安全。我们采用行业标准的安全措施来保护您的数据。"},encryption:{title:"2. 数据加密",content:"我们使用以下加密技术保护您的数据：",items:["传输层安全协议（TLS）加密所有数据传输","数据库级别的加密存储","端到端加密保护敏感信息"]},accessControl:{title:"3. 访问控制",content:"我们实施严格的数据访问控制：",items:["基于角色的访问控制（RBAC）","多因素认证（MFA）","定期安全审计和监控","最小权限原则"]},infrastructure:{title:"4. 安全基础设施",content:"我们的基础设施安全措施包括：",items:["云服务提供商的安全认证","定期安全漏洞扫描","入侵检测和防护系统","灾难恢复和业务连续性计划"]},employees:{title:"5. 员工安全",content:"我们确保所有员工：",items:["接受定期安全培训","签署保密协议","遵循数据保护最佳实践"]},incidentResponse:{title:"6. 安全事件响应",content:"如发生安全事件，我们将：",items:["立即启动应急响应程序","评估事件影响范围","及时通知受影响的用户","采取补救措施防止类似事件"]},thirdParty:{title:"7. 第三方安全",content:"我们严格审查第三方服务提供商的安全标准，确保他们符合我们的安全要求。"},reporting:{title:"8. 安全报告",content:"如果您发现安全漏洞或有安全相关问题，请立即联系我们：",email:"安全邮箱：security@restarter.com"}},footer:{lastUpdate:"最后更新时间：2024年12月",version:"版本：1.0"}},en:{title:"Security Statement",back:"Back",sections:{commitment:{title:"1. Data Security Commitment",content:"Restarter is committed to protecting your personal information and data security. We adopt industry-standard security measures to protect your data."},encryption:{title:"2. Data Encryption",content:"We use the following encryption technologies to protect your data:",items:["Transport Layer Security (TLS) encryption for all data transmission","Database-level encrypted storage","End-to-end encryption for sensitive information"]},accessControl:{title:"3. Access Control",content:"We implement strict data access controls:",items:["Role-based access control (RBAC)","Multi-factor authentication (MFA)","Regular security audits and monitoring","Principle of least privilege"]},infrastructure:{title:"4. Security Infrastructure",content:"Our infrastructure security measures include:",items:["Cloud service provider security certifications","Regular security vulnerability scanning","Intrusion detection and prevention systems","Disaster recovery and business continuity plans"]},employees:{title:"5. Employee Security",content:"We ensure all employees:",items:["Receive regular security training","Sign confidentiality agreements","Follow data protection best practices"]},incidentResponse:{title:"6. Security Incident Response",content:"In the event of a security incident, we will:",items:["Immediately activate emergency response procedures","Assess the scope of the incident","Notify affected users promptly","Take remedial measures to prevent similar incidents"]},thirdParty:{title:"7. Third-Party Security",content:"We strictly review the security standards of third-party service providers to ensure they meet our security requirements."},reporting:{title:"8. Security Reporting",content:"If you discover security vulnerabilities or have security-related questions, please contact us immediately:",email:"Security email: security@restarter.com"}},footer:{lastUpdate:"Last updated: December 2024",version:"Version: 1.0"}}},U5=()=>{const n=$e(),{lang:e}=Qe(),t=Ly[e]||Ly["zh-TW"];return r.jsx("div",{className:"legal-page",children:r.jsxs("div",{className:"legal-container",children:[r.jsxs("div",{className:"legal-header",children:[r.jsxs("button",{onClick:()=>n(-1),className:"back-button",children:["← ",t.back]}),r.jsx("h1",{children:t.title})]}),r.jsxs("div",{className:"legal-content",children:[r.jsxs("section",{children:[r.jsx("h2",{children:t.sections.commitment.title}),r.jsx("p",{children:t.sections.commitment.content})]}),r.jsxs("section",{children:[r.jsx("h2",{children:t.sections.encryption.title}),r.jsx("p",{children:t.sections.encryption.content}),r.jsx("ul",{children:t.sections.encryption.items.map((i,s)=>r.jsx("li",{children:i},s))})]}),r.jsxs("section",{children:[r.jsx("h2",{children:t.sections.accessControl.title}),r.jsx("p",{children:t.sections.accessControl.content}),r.jsx("ul",{children:t.sections.accessControl.items.map((i,s)=>r.jsx("li",{children:i},s))})]}),r.jsxs("section",{children:[r.jsx("h2",{children:t.sections.infrastructure.title}),r.jsx("p",{children:t.sections.infrastructure.content}),r.jsx("ul",{children:t.sections.infrastructure.items.map((i,s)=>r.jsx("li",{children:i},s))})]}),r.jsxs("section",{children:[r.jsx("h2",{children:t.sections.employees.title}),r.jsx("p",{children:t.sections.employees.content}),r.jsx("ul",{children:t.sections.employees.items.map((i,s)=>r.jsx("li",{children:i},s))})]}),r.jsxs("section",{children:[r.jsx("h2",{children:t.sections.incidentResponse.title}),r.jsx("p",{children:t.sections.incidentResponse.content}),r.jsx("ul",{children:t.sections.incidentResponse.items.map((i,s)=>r.jsx("li",{children:i},s))})]}),r.jsxs("section",{children:[r.jsx("h2",{children:t.sections.thirdParty.title}),r.jsx("p",{children:t.sections.thirdParty.content})]}),r.jsxs("section",{children:[r.jsx("h2",{children:t.sections.reporting.title}),r.jsx("p",{children:t.sections.reporting.content}),r.jsx("p",{children:t.sections.reporting.email})]}),r.jsxs("div",{className:"legal-footer",children:[r.jsx("p",{children:t.footer.lastUpdate}),r.jsx("p",{children:t.footer.version})]})]})]})})},Oy={"zh-TW":{title:"更新通知政策",back:"返回",sections:{overview:{title:"1. 政策概述",content:"本政策說明Restarter如何通知用戶關於服務條款、隱私政策和其他重要法律文件的更新。"},types:{title:"2. 更新類型",content:"我們可能會更新以下類型的文件：",items:["服務條款","隱私政策","Cookie政策","兒童隱私政策","其他法律聲明"]},methods:{title:"3. 通知方式",content:"我們將通過以下方式通知您重要更新：",items:["應用內推送通知","電子郵件通知","應用內橫幅或彈窗","網站公告"]},frequency:{title:"4. 更新頻率",content:"我們可能會在以下情況下更新法律文件：",items:["法律要求變化","服務功能更新","數據處理方式改變","安全措施改進","用戶反饋和建議"]},effectiveTime:{title:"5. 生效時間",content:"更新通常在以下時間生效：",items:["重大變更：提前30天通知","一般更新：提前7天通知","緊急安全更新：立即生效"]},userRights:{title:"6. 用戶權利",content:"在更新生效前，您有權：",items:["查看更新的詳細內容","提出疑問或建議","選擇是否繼續使用服務","刪除賬戶和數據"]},history:{title:"7. 歷史版本",content:"我們保留法律文件的历史版本，您可以在需要時查看之前的版本。"},contact:{title:"8. 聯繫信息",content:"如果您對更新通知有任何疑問，請通過以下方式聯繫我們：",email:"郵箱：legal@restarter.com",phone:"客服熱線：400-xxx-xxxx"}},footer:{lastUpdate:"最後更新時間：2024年12月",version:"版本：1.0"}},"zh-CN":{title:"更新通知政策",back:"返回",sections:{overview:{title:"1. 政策概述",content:"本政策说明Restarter如何通知用户关于服务条款、隐私政策和其他重要法律文件的更新。"},types:{title:"2. 更新类型",content:"我们可能会更新以下类型的文件：",items:["服务条款","隐私政策","Cookie政策","儿童隐私政策","其他法律声明"]},methods:{title:"3. 通知方式",content:"我们将通过以下方式通知您重要更新：",items:["应用内推送通知","电子邮件通知","应用内横幅或弹窗","网站公告"]},frequency:{title:"4. 更新频率",content:"我们可能会在以下情况下更新法律文件：",items:["法律要求变化","服务功能更新","数据处理方式改变","安全措施改进","用户反馈和建议"]},effectiveTime:{title:"5. 生效时间",content:"更新通常在以下时间生效：",items:["重大变更：提前30天通知","一般更新：提前7天通知","紧急安全更新：立即生效"]},userRights:{title:"6. 用户权利",content:"在更新生效前，您有权：",items:["查看更新的详细内容","提出疑问或建议","选择是否继续使用服务","删除账户和数据"]},history:{title:"7. 历史版本",content:"我们保留法律文件的历史版本，您可以在需要时查看之前的版本。"},contact:{title:"8. 联系信息",content:"如果您对更新通知有任何疑问，请通过以下方式联系我们：",email:"邮箱：legal@restarter.com",phone:"客服热线：400-xxx-xxxx"}},footer:{lastUpdate:"最后更新时间：2024年12月",version:"版本：1.0"}},en:{title:"Update Notification Policy",back:"Back",sections:{overview:{title:"1. Policy Overview",content:"This policy explains how Restarter notifies users about updates to terms of service, privacy policies, and other important legal documents."},types:{title:"2. Types of Updates",content:"We may update the following types of documents:",items:["Terms of Service","Privacy Policy","Cookie Policy","Children's Privacy Policy","Other Legal Statements"]},methods:{title:"3. Notification Methods",content:"We will notify you of important updates through:",items:["In-app push notifications","Email notifications","In-app banners or popups","Website announcements"]},frequency:{title:"4. Update Frequency",content:"We may update legal documents in the following circumstances:",items:["Changes in legal requirements","Service feature updates","Changes in data processing methods","Security measure improvements","User feedback and suggestions"]},effectiveTime:{title:"5. Effective Time",content:"Updates typically take effect at the following times:",items:["Major changes: 30 days advance notice","General updates: 7 days advance notice","Emergency security updates: Immediate effect"]},userRights:{title:"6. User Rights",content:"Before updates take effect, you have the right to:",items:["Review detailed content of updates","Raise questions or suggestions","Choose whether to continue using the service","Delete account and data"]},history:{title:"7. Historical Versions",content:"We retain historical versions of legal documents, which you can view when needed."},contact:{title:"8. Contact Information",content:"If you have any questions about update notifications, please contact us through:",email:"Email: legal@restarter.com",phone:"Customer service: 400-xxx-xxxx"}},footer:{lastUpdate:"Last updated: December 2024",version:"Version: 1.0"}}},H5=()=>{const n=$e(),{lang:e}=Qe(),t=Oy[e]||Oy["zh-TW"];return r.jsx("div",{className:"legal-page",children:r.jsxs("div",{className:"legal-container",children:[r.jsxs("div",{className:"legal-header",children:[r.jsxs("button",{onClick:()=>n(-1),className:"back-button",children:["← ",t.back]}),r.jsx("h1",{children:t.title})]}),r.jsxs("div",{className:"legal-content",children:[r.jsxs("section",{children:[r.jsx("h2",{children:t.sections.overview.title}),r.jsx("p",{children:t.sections.overview.content})]}),r.jsxs("section",{children:[r.jsx("h2",{children:t.sections.types.title}),r.jsx("p",{children:t.sections.types.content}),r.jsx("ul",{children:t.sections.types.items.map((i,s)=>r.jsx("li",{children:i},s))})]}),r.jsxs("section",{children:[r.jsx("h2",{children:t.sections.methods.title}),r.jsx("p",{children:t.sections.methods.content}),r.jsx("ul",{children:t.sections.methods.items.map((i,s)=>r.jsx("li",{children:i},s))})]}),r.jsxs("section",{children:[r.jsx("h2",{children:t.sections.frequency.title}),r.jsx("p",{children:t.sections.frequency.content}),r.jsx("ul",{children:t.sections.frequency.items.map((i,s)=>r.jsx("li",{children:i},s))})]}),r.jsxs("section",{children:[r.jsx("h2",{children:t.sections.effectiveTime.title}),r.jsx("p",{children:t.sections.effectiveTime.content}),r.jsx("ul",{children:t.sections.effectiveTime.items.map((i,s)=>r.jsx("li",{children:i},s))})]}),r.jsxs("section",{children:[r.jsx("h2",{children:t.sections.userRights.title}),r.jsx("p",{children:t.sections.userRights.content}),r.jsx("ul",{children:t.sections.userRights.items.map((i,s)=>r.jsx("li",{children:i},s))})]}),r.jsxs("section",{children:[r.jsx("h2",{children:t.sections.history.title}),r.jsx("p",{children:t.sections.history.content})]}),r.jsxs("section",{children:[r.jsx("h2",{children:t.sections.contact.title}),r.jsx("p",{children:t.sections.contact.content}),r.jsx("p",{children:t.sections.contact.email}),r.jsx("p",{children:t.sections.contact.phone})]}),r.jsxs("div",{className:"legal-footer",children:[r.jsx("p",{children:t.footer.lastUpdate}),r.jsx("p",{children:t.footer.version})]})]})]})})},$5=[{name:"免費版",price:"NT$0",period:"永久免費",features:["❌ 無語音功能權限","❌ 無權限使用OpenAI API功能","❌ 無法與其他使用者互動","✅ 基礎功能使用15次/月","💰 成本限制: NT$0/月"],highlight:!1,buttonText:"立即註冊",buttonAction:"register"},{name:"基礎版",price:"NT$149",period:"/月 或 NT$1490/年",features:["🤖 AI Token 限制: 50K tokens/月","👥 用戶互動: 100次/月","💬 留言/里程碑/AI聊天: 各30次/月","🎯 基礎功能: 300次/月","⚡ Token 用完僅暫停語音功能"],highlight:!0,buttonText:"選擇基礎版",buttonAction:"basic"},{name:"進階版",price:"NT$249",period:"/月 或 NT$2490/年",features:["🤖 AI Token 限制: 100K tokens/月","👥 用戶互動: 300次/月","💬 留言/里程碑/AI聊天: 各80次/月","🎯 基礎功能: 600次/月","⚡ Token 用完僅暫停語音功能"],highlight:!1,buttonText:"選擇進階版",buttonAction:"advanced"},{name:"專業版",price:"NT$349",period:"/月 或 NT$3490/年",features:["🤖 AI Token 限制: 200K tokens/月","👥 用戶互動: 800次/月","💬 留言/里程碑/AI聊天: 各150次/月","🎯 基礎功能: 1000次/月","⚡ Token 用完僅暫停語音功能"],highlight:!1,buttonText:"選擇專業版",buttonAction:"professional"},{name:"無限版",price:"NT$499",period:"/月 或 NT$4990/年",features:["🤖 AI Token 限制: 500K tokens/月","♾️ 用戶互動: 無限制","♾️ 留言/里程碑/AI聊天: 無限制","♾️ 基礎功能: 無限制","⚡ 僅受 Token 上限限制"],highlight:!1,buttonText:"選擇無限版",buttonAction:"unlimited"}],G5=["選擇適合您的訂閱方案","完成付款（支援信用卡/Apple Pay/Google Pay）","付款成功後自動升級，立即享有所有訂閱權益"],K5=[{q:"升級後可以隨時取消嗎？",a:"可以，訂閱會員可隨時取消，權益將保留至本期結束。"},{q:"付款方式有哪些？",a:"支援信用卡、Apple Pay、Google Pay 等多種方式。"},{q:"各版本的AI功能限制是什麼？",a:"Token 用完僅暫停語音功能，文字功能可繼續使用至各自限制。各功能獨立檢查使用次數。"},{q:"Token 用完可以續購嗎？",a:"可以！Token 用完但未滿一個月時，可以續購並從今天重新計算使用期，更划算。"},{q:"無限版真的無限制嗎？",a:"無限版除了AI Token上限外，其他功能都無限制使用。"},{q:"可以中途升級或降級嗎？",a:"可以，升級立即生效，降級將在當前週期結束後生效。"}];function Q5(){const n=$e(),t=Je().currentUser;localStorage.getItem("lang");const[i,s]=g.useState(!1),[o,a]=g.useState(null),l=c=>{if(!t){s(!0);return}a(c),n(`/payment?plan=${c.buttonAction}`)};return r.jsxs("div",{style:{fontFamily:"-apple-system,BlinkMacSystemFont,sans-serif",background:"#f7f8fc",minHeight:"100vh",padding:"32px 0"},children:[r.jsx("button",{onClick:()=>n("/"),style:{position:"absolute",top:24,left:24,zIndex:10,background:"#fff",border:"1.5px solid #6B5BFF",color:"#6B5BFF",borderRadius:8,padding:"6px 18px",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:"0 2px 8px #0001"},children:"← 返回"}),r.jsxs("div",{style:{maxWidth:1200,margin:"0 auto",background:"#fff",borderRadius:18,boxShadow:"0 4px 24px #6B5BFF22",padding:32},children:[r.jsx("h1",{style:{fontSize:36,fontWeight:900,letterSpacing:2,background:"linear-gradient(90deg,#6B5BFF,#00CFFF)",WebkitBackgroundClip:"text",color:"transparent",marginBottom:24,textAlign:"center"},children:"Restarter 訂閱方案"}),r.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(280px, 1fr))",gap:24,marginBottom:32},children:$5.map((c,u)=>r.jsxs("div",{style:{background:c.highlight?"linear-gradient(135deg, #f3f7ff 0%, #e8f4ff 100%)":"#fff",border:c.highlight?"2px solid #6B5BFF":"1px solid #e0e0e0",borderRadius:16,padding:24,position:"relative",boxShadow:c.highlight?"0 8px 32px #6B5BFF22":"0 4px 16px #0001",transition:"all 0.3s ease",cursor:"pointer"},onClick:()=>l(c),children:[c.highlight&&r.jsx("div",{style:{position:"absolute",top:-12,left:"50%",transform:"translateX(-50%)",background:"#6B5BFF",color:"#fff",padding:"4px 16px",borderRadius:12,fontSize:14,fontWeight:700},children:"推薦方案"}),r.jsx("h3",{style:{fontSize:24,fontWeight:800,color:c.highlight?"#6B5BFF":"#333",marginBottom:8,textAlign:"center"},children:c.name}),r.jsxs("div",{style:{textAlign:"center",marginBottom:20},children:[r.jsx("span",{style:{fontSize:32,fontWeight:900,color:c.highlight?"#6B5BFF":"#333"},children:c.price}),r.jsx("span",{style:{fontSize:16,color:"#666"},children:c.period})]}),r.jsx("ul",{style:{margin:0,padding:0,listStyle:"none"},children:c.features.map((h,p)=>r.jsx("li",{style:{marginBottom:12,fontSize:14,lineHeight:1.5,color:"#555",display:"flex",alignItems:"flex-start",gap:8},children:r.jsx("span",{style:{fontSize:16,marginTop:1},children:h})},p))}),r.jsx("button",{style:{width:"100%",background:c.highlight?"linear-gradient(90deg, #6B5BFF, #00CFFF)":"#f0f0f0",color:c.highlight?"#fff":"#666",border:"none",borderRadius:8,padding:"12px 0",fontSize:16,fontWeight:700,cursor:"pointer",marginTop:20,transition:"all 0.2s ease"},children:c.buttonText})]},c.name))}),r.jsx("h2",{style:{fontSize:24,fontWeight:800,margin:"32px 0 12px",color:"#6B5BFF"},children:"升級流程"}),r.jsx("ol",{style:{fontSize:18,lineHeight:1.8,marginBottom:32,paddingLeft:24},children:G5.map((c,u)=>r.jsx("li",{children:c},u))}),r.jsx("h2",{style:{fontSize:24,fontWeight:800,margin:"32px 0 12px",color:"#6B5BFF"},children:"常見問題"}),r.jsx("div",{style:{marginBottom:32},children:K5.map((c,u)=>r.jsxs("div",{style:{marginBottom:18},children:[r.jsx("div",{style:{fontWeight:700,fontSize:18,color:"#6B5BFF"},children:c.q}),r.jsx("div",{style:{fontSize:17,color:"#444",marginLeft:8,marginTop:2},children:c.a})]},u))}),r.jsx("div",{style:{display:"flex",justifyContent:"center",marginTop:32},children:r.jsx("button",{onClick:()=>n("/register"),style:{background:"#00CFFF",color:"#fff",fontWeight:700,fontSize:20,padding:"14px 38px",borderRadius:10,boxShadow:"0 2px 8px #00CFFF33",border:"none",cursor:"pointer",transition:"0.2s",position:"relative",zIndex:1e3,minHeight:"48px",minWidth:"200px",touchAction:"manipulation"},children:"立即註冊免費版"})}),i&&r.jsx("div",{style:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",background:"rgba(0,0,0,0.5)",zIndex:9999,display:"flex",alignItems:"center",justifyContent:"center"},children:r.jsxs("div",{style:{background:"#fff",borderRadius:20,padding:32,boxShadow:"0 8px 32px rgba(0,0,0,0.2)",minWidth:380,textAlign:"center"},children:[r.jsx("div",{style:{fontSize:48,marginBottom:16,color:"#6B5BFF"},children:"🎯"}),r.jsx("div",{style:{fontSize:22,fontWeight:700,color:"#6B5BFF",marginBottom:12},children:"歡迎加入 Restarter！"}),r.jsx("div",{style:{fontSize:16,color:"#666",marginBottom:20,lineHeight:1.5},children:"註冊後即可選擇適合您的訂閱方案，開始您的重啟之旅"}),r.jsxs("div",{style:{background:"linear-gradient(135deg, #f8f9ff 0%, #e8f4ff 100%)",borderRadius:12,padding:16,marginBottom:24,border:"1px solid #e0e8ff"},children:[r.jsx("div",{style:{fontSize:14,color:"#6B5BFF",fontWeight:600,marginBottom:8},children:"💡 註冊好處"}),r.jsxs("div",{style:{fontSize:13,color:"#666",lineHeight:1.4},children:["• 免費體驗基礎功能",r.jsx("br",{}),"• 個人化使用記錄",r.jsx("br",{}),"• 安全可靠的服務"]})]}),r.jsxs("div",{style:{display:"flex",gap:12,justifyContent:"center"},children:[r.jsx("button",{onClick:()=>{s(!1),n("/register")},style:{background:"linear-gradient(135deg, #6B5BFF 0%, #00CFFF 100%)",color:"#fff",border:"none",borderRadius:12,padding:"12px 28px",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:"0 4px 12px #6B5BFF33",transition:"all 0.3s ease"},onMouseEnter:c=>{c.currentTarget.style.transform="translateY(-2px)",c.currentTarget.style.boxShadow="0 6px 16px #6B5BFF44"},onMouseLeave:c=>{c.currentTarget.style.transform="translateY(0)",c.currentTarget.style.boxShadow="0 4px 12px #6B5BFF33"},children:"🚀 立即註冊"}),r.jsx("button",{onClick:()=>s(!1),style:{background:"#f8f9ff",color:"#6B5BFF",border:"2px solid #6B5BFF",borderRadius:12,padding:"12px 28px",fontWeight:600,fontSize:16,cursor:"pointer",transition:"all 0.3s ease"},onMouseEnter:c=>{c.currentTarget.style.background="#6B5BFF",c.currentTarget.style.color="#fff"},onMouseLeave:c=>{c.currentTarget.style.background="#f8f9ff",c.currentTarget.style.color="#6B5BFF"},children:"💭 稍後再說"})]})]})})]})]})}const Vy={basic:{name:"基礎版",price:"NT$149",period:"/月",features:["🤖 AI Token 限制: 50K tokens/月","👥 用戶互動: 100次/月","💬 留言/里程碑/AI聊天: 各30次/月","🎯 基礎功能: 300次/月"],buttonAction:"basic"},advanced:{name:"進階版",price:"NT$249",period:"/月",features:["🤖 AI Token 限制: 100K tokens/月","👥 用戶互動: 300次/月","💬 留言/里程碑/AI聊天: 各80次/月","🎯 基礎功能: 600次/月"],buttonAction:"advanced"},professional:{name:"專業版",price:"NT$349",period:"/月",features:["🤖 AI Token 限制: 200K tokens/月","👥 用戶互動: 800次/月","💬 留言/里程碑/AI聊天: 各150次/月","🎯 基礎功能: 1000次/月"],buttonAction:"professional"},unlimited:{name:"無限版",price:"NT$499",period:"/月",features:["🤖 AI Token 限制: 500K tokens/月","♾️ 用戶互動: 無限制","♾️ 留言/里程碑/AI聊天: 無限制","♾️ 基礎功能: 無限制"],buttonAction:"unlimited"}};function Y5(){const n=$e(),[e]=nx(),i=Je().currentUser,[s,o]=g.useState(null),[a,l]=g.useState("credit"),[c,u]=g.useState(!1),[h,p]=g.useState(!1);g.useEffect(()=>{const b=e.get("plan");b&&Vy[b]?o(Vy[b]):n("/plans")},[e,n]);const f=async()=>{if(!i){n("/login");return}u(!0);try{const x=await(await fetch("/api/subscription/payment-success",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:i.uid,plan:s.buttonAction,paymentMethod:a,transactionId:`txn_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,amount:parseInt(s.price.replace("NT$","")),currency:"TWD"})})).json();if(x.success)u(!1),p(!0),setTimeout(()=>{n("/")},3e3);else throw new Error(x.error||"支付失敗")}catch(b){console.error("支付錯誤:",b),u(!1),alert("支付失敗，請重試")}};return s?r.jsxs("div",{style:{fontFamily:"-apple-system,BlinkMacSystemFont,sans-serif",background:"#f7f8fc",minHeight:"100vh",padding:"32px 0"},children:[r.jsx("button",{onClick:()=>n("/plans"),style:{position:"absolute",top:24,left:24,zIndex:10,background:"#fff",border:"1.5px solid #6B5BFF",color:"#6B5BFF",borderRadius:8,padding:"6px 18px",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:"0 2px 8px #0001"},children:"← 返回"}),r.jsxs("div",{style:{maxWidth:600,margin:"0 auto",background:"#fff",borderRadius:18,boxShadow:"0 4px 24px #6B5BFF22",padding:32},children:[r.jsx("h1",{style:{fontSize:32,fontWeight:900,letterSpacing:2,background:"linear-gradient(90deg,#6B5BFF,#00CFFF)",WebkitBackgroundClip:"text",color:"transparent",marginBottom:24,textAlign:"center"},children:"完成訂閱"}),r.jsxs("div",{style:{background:"#f8f9ff",borderRadius:12,padding:24,marginBottom:32},children:[r.jsx("h2",{style:{fontSize:20,fontWeight:700,color:"#6B5BFF",marginBottom:16},children:"選擇的方案"}),r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[r.jsx("span",{style:{fontSize:18,fontWeight:600},children:s.name}),r.jsxs("span",{style:{fontSize:24,fontWeight:900,color:"#6B5BFF"},children:[s.price,s.period]})]}),r.jsx("ul",{style:{margin:0,padding:0,listStyle:"none"},children:s.features.map((b,x)=>r.jsxs("li",{style:{marginBottom:8,fontSize:14,color:"#666"},children:["• ",b]},x))})]}),r.jsxs("div",{style:{marginBottom:32},children:[r.jsx("h2",{style:{fontSize:20,fontWeight:700,color:"#6B5BFF",marginBottom:16},children:"付款方式"}),r.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:12},children:[r.jsxs("label",{style:{display:"flex",alignItems:"center",gap:12,cursor:"pointer"},children:[r.jsx("input",{type:"radio",name:"payment",value:"credit",checked:a==="credit",onChange:b=>l(b.target.value),style:{width:18,height:18}}),r.jsx("span",{style:{fontSize:16},children:"💳 信用卡"})]}),r.jsxs("label",{style:{display:"flex",alignItems:"center",gap:12,cursor:"pointer"},children:[r.jsx("input",{type:"radio",name:"payment",value:"apple",checked:a==="apple",onChange:b=>l(b.target.value),style:{width:18,height:18}}),r.jsx("span",{style:{fontSize:16},children:"🍎 Apple Pay"})]}),r.jsxs("label",{style:{display:"flex",alignItems:"center",gap:12,cursor:"pointer"},children:[r.jsx("input",{type:"radio",name:"payment",value:"google",checked:a==="google",onChange:b=>l(b.target.value),style:{width:18,height:18}}),r.jsx("span",{style:{fontSize:16},children:"🤖 Google Pay"})]})]})]}),r.jsx("button",{onClick:f,disabled:c,style:{width:"100%",background:c?"#ccc":"linear-gradient(90deg,#6B5BFF,#00CFFF)",color:"#fff",border:"none",borderRadius:12,padding:"16px 0",fontSize:18,fontWeight:700,cursor:c?"not-allowed":"pointer",transition:"all 0.2s ease"},children:c?"處理中...":`立即付款 ${s.price}`}),h&&r.jsx("div",{style:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",background:"#0008",zIndex:9999,display:"flex",alignItems:"center",justifyContent:"center"},children:r.jsxs("div",{style:{background:"#fff",borderRadius:16,padding:32,boxShadow:"0 4px 24px #0002",minWidth:320,textAlign:"center"},children:[r.jsx("div",{style:{fontSize:48,marginBottom:16},children:"✅"}),r.jsx("div",{style:{fontSize:20,fontWeight:700,color:"#6B5BFF",marginBottom:8},children:"付款成功！"}),r.jsx("div",{style:{fontSize:16,color:"#666",marginBottom:16},children:"您的訂閱已生效，即將跳轉到首頁..."})]})})]})]}):r.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"},children:r.jsx("div",{children:"載入中..."})})}const iu={basic:{name:"基礎版",price:"NT$ 149",period:"/月",features:["🤖 AI Token 限制: 50K tokens/月","👥 用戶互動: 100次/月","💬 留言/里程碑/AI聊天: 各30次/月","🎯 基礎功能: 300次/月","⚡ Token 用完僅暫停語音功能"],stripeLink:"https://buy.stripe.com/your_basic_monthly_link",paypalLink:"https://www.paypal.com/your_basic_monthly_link",ecpayLink:"https://payment.ecpay.com.tw/your_basic_monthly_link",newebpayLink:"https://ccore.newebpay.com/your_basic_monthly_link"},advanced:{name:"進階版",price:"NT$ 249",period:"/月",features:["🤖 AI Token 限制: 100K tokens/月","👥 用戶互動: 300次/月","💬 留言/里程碑/AI聊天: 各80次/月","🎯 基礎功能: 600次/月","⚡ Token 用完僅暫停語音功能"],stripeLink:"https://buy.stripe.com/your_advanced_monthly_link",paypalLink:"https://www.paypal.com/your_advanced_monthly_link",ecpayLink:"https://payment.ecpay.com.tw/your_advanced_monthly_link",newebpayLink:"https://ccore.newebpay.com/your_advanced_monthly_link"},professional:{name:"專業版",price:"NT$ 349",period:"/月",features:["🤖 AI Token 限制: 200K tokens/月","👥 用戶互動: 800次/月","💬 留言/里程碑/AI聊天: 各150次/月","🎯 基礎功能: 1000次/月","⚡ Token 用完僅暫停語音功能"],stripeLink:"https://buy.stripe.com/your_professional_monthly_link",paypalLink:"https://www.paypal.com/your_professional_monthly_link",ecpayLink:"https://payment.ecpay.com.tw/your_professional_monthly_link",newebpayLink:"https://ccore.newebpay.com/your_professional_monthly_link"},unlimited:{name:"無限版",price:"NT$ 499",period:"/月",features:["🤖 AI Token 限制: 500K tokens/月","♾️ 用戶互動: 無限制","♾️ 留言/里程碑/AI聊天: 無限制","♾️ 基礎功能: 無限制","⚡ 僅受 Token 上限限制"],stripeLink:"https://buy.stripe.com/your_unlimited_monthly_link",paypalLink:"https://www.paypal.com/your_unlimited_monthly_link",ecpayLink:"https://payment.ecpay.com.tw/your_unlimited_monthly_link",newebpayLink:"https://ccore.newebpay.com/your_unlimited_monthly_link"}};function X5(){const n=$e(),t=Je().currentUser,[i,s]=g.useState(!1),[o,a]=g.useState("basic"),[l,c]=g.useState("stripe"),[u,h]=g.useState(!1),[p,f]=g.useState(null);localStorage.getItem("lang");const b=()=>{if(!t){s(!0);return}const I=iu[o],j=I[`${l}Link`];j&&!j.includes("your_")?x():alert(`請聯絡客服完成付款設定

選擇方案：${I.name}
付款方式：${l==="stripe"?"Stripe":l==="paypal"?"PayPal":l==="ecpay"?"綠界":"藍新"}

客服 Email：support@restarter.com`)},x=async()=>{if(t)try{const I=`TXN_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,j=await fetch("/api/subscription/payment-success",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:t.uid,plan:o,paymentMethod:l,transactionId:I,amount:S(o),currency:"TWD"})});if(j.ok){const A=await j.json();f(A),h(!0),setTimeout(()=>{n("/home")},3e3)}else alert("付款處理失敗，請聯絡客服")}catch(I){console.error("付款處理錯誤:",I),alert("付款處理失敗，請聯絡客服")}},S=I=>({basic:149,advanced:249,professional:349,unlimited:499})[I]||0,w=I=>({basic:"基礎版",advanced:"進階版",professional:"專業版",unlimited:"無限版"})[I]||I;return r.jsxs("div",{style:{minHeight:"100vh",background:"#f7faff",padding:0,overflowY:"auto"},children:[r.jsx("button",{onClick:()=>n("/plans"),style:{position:"absolute",top:24,left:24,zIndex:10,background:"#fff",border:"1.5px solid #6B5BFF",color:"#6B5BFF",borderRadius:8,padding:"6px 18px",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:"0 2px 8px #0001"},children:"← 返回"}),r.jsx("div",{style:{maxWidth:900,margin:"0 auto",padding:"80px 24px 32px"},children:r.jsxs("div",{style:{background:"#fff",borderRadius:18,boxShadow:"0 4px 24px #6B5BFF11",padding:"32px 24px"},children:[r.jsx("h2",{style:{color:"#4B5BFF",fontWeight:900,fontSize:32,marginBottom:8,letterSpacing:2,textAlign:"center"},children:"升級訂閱"}),r.jsx("p",{style:{color:"#666",fontSize:18,textAlign:"center",marginBottom:32},children:"選擇最適合您的訂閱方案，立即享有完整功能"}),r.jsx("div",{style:{display:"flex",gap:24,marginBottom:32,justifyContent:"center"},children:Object.entries(iu).map(([I,j])=>r.jsxs("div",{onClick:()=>a(I),style:{background:o===I?"#6B5BFF":"#fff",color:o===I?"#fff":"#333",border:`2px solid ${o===I?"#6B5BFF":"#ddd"}`,borderRadius:12,padding:"24px",cursor:"pointer",minWidth:200,textAlign:"center",transition:"all 0.3s ease"},children:[r.jsx("div",{style:{fontWeight:700,fontSize:20,marginBottom:8},children:j.name}),r.jsxs("div",{style:{fontSize:32,fontWeight:900,marginBottom:4},children:[j.price,r.jsx("span",{style:{fontSize:16,fontWeight:400},children:j.period})]}),j.originalPrice&&r.jsx("div",{style:{fontSize:14,textDecoration:"line-through",opacity:.7,marginBottom:4},children:j.originalPrice}),j.discount&&r.jsx("div",{style:{fontSize:14,color:"#ff6b6b",fontWeight:700},children:j.discount})]},I))}),r.jsxs("div",{style:{marginBottom:32},children:[r.jsx("h3",{style:{color:"#333",fontWeight:700,fontSize:20,marginBottom:16},children:"選擇付款方式"}),r.jsx("div",{style:{display:"flex",gap:16,flexWrap:"wrap"},children:[{key:"stripe",name:"Stripe",icon:"💳"},{key:"paypal",name:"PayPal",icon:"🔵"},{key:"ecpay",name:"綠界",icon:"🟢"},{key:"newebpay",name:"藍新",icon:"🔵"}].map(I=>r.jsxs("button",{onClick:()=>c(I.key),style:{background:l===I.key?"#6B5BFF":"#fff",color:l===I.key?"#fff":"#333",border:`2px solid ${l===I.key?"#6B5BFF":"#ddd"}`,borderRadius:8,padding:"12px 20px",cursor:"pointer",fontSize:16,fontWeight:600,transition:"all 0.3s ease"},children:[I.icon," ",I.name]},I.key))})]}),r.jsxs("div",{style:{marginBottom:32},children:[r.jsx("h3",{style:{color:"#333",fontWeight:700,fontSize:20,marginBottom:16},children:"訂閱權益"}),r.jsx("div",{style:{display:"grid",gap:12},children:iu[o].features.map((I,j)=>r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[r.jsx("span",{style:{color:"#6B5BFF",fontSize:18},children:"✓"}),r.jsx("span",{style:{color:"#333",fontSize:16},children:I})]},j))})]}),r.jsx("div",{style:{textAlign:"center",marginTop:24},children:r.jsx("button",{onClick:b,style:{background:"linear-gradient(90deg,#6B5BFF 60%,#23c6e6 100%)",color:"#fff",border:"none",borderRadius:12,fontWeight:900,fontSize:20,padding:"12px 48px",boxShadow:"0 2px 12px #6B5BFF33",letterSpacing:2,cursor:"pointer"},children:"立即升級"})}),r.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:24,marginTop:32},children:[r.jsx("button",{onClick:()=>n("/payment-info"),style:{background:"#fff",color:"#6B5BFF",border:"1.5px solid #6B5BFF",borderRadius:8,padding:"10px 32px",fontWeight:600,cursor:"pointer"},children:"付款說明"}),r.jsx("button",{onClick:()=>n("/contact"),style:{background:"#fff",color:"#6B5BFF",border:"1.5px solid #6B5BFF",borderRadius:8,padding:"10px 32px",fontWeight:600,cursor:"pointer"},children:"聯絡客服"})]})]})}),i&&r.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:r.jsxs("div",{style:{background:"#fff",borderRadius:20,padding:32,maxWidth:450,textAlign:"center",boxShadow:"0 8px 32px rgba(0,0,0,0.2)"},children:[r.jsx("div",{style:{fontSize:48,marginBottom:16,color:"#6B5BFF"},children:"🎯"}),r.jsx("h3",{style:{color:"#6B5BFF",fontWeight:700,fontSize:22,marginBottom:12},children:"歡迎加入 Restarter！"}),r.jsx("p",{style:{color:"#666",marginBottom:20,lineHeight:1.5,fontSize:16},children:"註冊後即可選擇適合您的訂閱方案，開始您的重啟之旅"}),r.jsxs("div",{style:{background:"linear-gradient(135deg, #f8f9ff 0%, #e8f4ff 100%)",borderRadius:12,padding:16,marginBottom:24,border:"1px solid #e0e8ff"},children:[r.jsx("div",{style:{fontSize:14,color:"#6B5BFF",fontWeight:600,marginBottom:8},children:"💡 註冊好處"}),r.jsxs("div",{style:{fontSize:13,color:"#666",lineHeight:1.4},children:["• 免費體驗基礎功能",r.jsx("br",{}),"• 個人化使用記錄",r.jsx("br",{}),"• 安全可靠的服務"]})]}),r.jsxs("div",{style:{display:"flex",gap:12,justifyContent:"center"},children:[r.jsx("button",{onClick:()=>n("/register"),style:{background:"linear-gradient(135deg, #6B5BFF 0%, #00CFFF 100%)",color:"#fff",border:"none",borderRadius:12,padding:"12px 28px",fontWeight:700,cursor:"pointer",fontSize:16,boxShadow:"0 4px 12px #6B5BFF33",transition:"all 0.3s ease"},onMouseEnter:I=>{I.currentTarget.style.transform="translateY(-2px)",I.currentTarget.style.boxShadow="0 6px 16px #6B5BFF44"},onMouseLeave:I=>{I.currentTarget.style.transform="translateY(0)",I.currentTarget.style.boxShadow="0 4px 12px #6B5BFF33"},children:"🚀 立即註冊"}),r.jsx("button",{onClick:()=>s(!1),style:{background:"#f8f9ff",color:"#6B5BFF",border:"2px solid #6B5BFF",borderRadius:12,padding:"12px 28px",fontWeight:600,cursor:"pointer",fontSize:16,transition:"all 0.3s ease"},onMouseEnter:I=>{I.currentTarget.style.background="#6B5BFF",I.currentTarget.style.color="#fff"},onMouseLeave:I=>{I.currentTarget.style.background="#f8f9ff",I.currentTarget.style.color="#6B5BFF"},children:"💭 稍後再說"})]})]})}),u&&p&&r.jsx("div",{style:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",background:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e4},children:r.jsxs("div",{style:{background:"#fff",borderRadius:20,padding:32,maxWidth:480,width:"90%",textAlign:"center",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.2)"},children:[r.jsx("div",{style:{fontSize:64,marginBottom:16,color:"#52c41a"},children:"✅"}),r.jsx("h2",{style:{fontSize:24,fontWeight:700,color:"#333",marginBottom:12},children:"付款成功！"}),r.jsx("p",{style:{fontSize:16,color:"#666",marginBottom:20,lineHeight:1.6},children:p.message}),r.jsxs("div",{style:{background:"linear-gradient(135deg, #f6ffed 0%, #d9f7be 100%)",borderRadius:12,padding:16,marginBottom:24,border:"1px solid #b7eb8f"},children:[r.jsx("div",{style:{fontSize:14,color:"#52c41a",fontWeight:600,marginBottom:8},children:"🎉 訂閱詳情"}),r.jsxs("div",{style:{fontSize:13,color:"#666",lineHeight:1.4},children:["• 方案：",w(o),r.jsx("br",{}),"• 剩餘天數：",p.remainingDays," 天",r.jsx("br",{}),"• AI Token：",p.plan.limits.aiCostLimit,"K tokens",r.jsx("br",{}),"• 立即生效，可開始使用所有 AI 功能"]})]}),r.jsx("div",{style:{display:"flex",gap:12,justifyContent:"center"},children:r.jsx("button",{onClick:()=>n("/home"),style:{background:"linear-gradient(135deg, #52c41a 0%, #73d13d 100%)",color:"#fff",border:"none",borderRadius:12,padding:"14px 28px",fontSize:16,fontWeight:700,cursor:"pointer",flex:1,boxShadow:"0 4px 12px #52c41a33",transition:"all 0.3s ease"},onMouseEnter:I=>{I.currentTarget.style.transform="translateY(-2px)",I.currentTarget.style.boxShadow="0 6px 16px #52c41a44"},onMouseLeave:I=>{I.currentTarget.style.transform="translateY(0)",I.currentTarget.style.boxShadow="0 4px 12px #52c41a33"},children:"🚀 立即開始使用"})}),r.jsx("div",{style:{marginTop:16,fontSize:14,color:"#888"},children:"3秒後自動跳轉到首頁..."})]})})]})}function J5(){const n=$e(),t=Je().currentUser;return localStorage.getItem("lang"),t?r.jsxs("div",{style:{minHeight:"100vh",background:"#f7faff",padding:0},children:[r.jsx("button",{onClick:()=>n("/"),style:{position:"absolute",top:24,left:24,zIndex:10,background:"#fff",border:"1.5px solid #6B5BFF",color:"#6B5BFF",borderRadius:8,padding:"6px 18px",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:"0 2px 8px #0001"},children:"← 返回首頁"}),r.jsxs("div",{style:{maxWidth:500,margin:"0 auto",background:"#fff",borderRadius:18,boxShadow:"0 4px 24px #6B5BFF11",padding:"32px 24px",marginTop:64,textAlign:"center"},children:[r.jsx("img",{src:t.photoURL||"/avatars/Derxl.png",alt:"avatar",style:{width:88,height:88,borderRadius:"50%",objectFit:"cover",border:"2px solid #ececff",background:"#eee",marginBottom:18}}),r.jsx("div",{style:{fontSize:24,fontWeight:900,color:"#6B5BFF",marginBottom:8},children:t.displayName||t.email||"用戶"}),r.jsx("div",{style:{fontSize:16,color:"#888",marginBottom:18},children:t.email}),r.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:18,marginTop:24},children:[r.jsx("button",{onClick:()=>n("/CompleteProfile"),style:{background:"#00CFFF",color:"#fff",fontWeight:700,fontSize:18,padding:"10px 32px",borderRadius:10,boxShadow:"0 2px 8px #00CFFF33",border:"none",cursor:"pointer"},children:"編輯個人資料"}),r.jsx("button",{onClick:()=>n("/upgrade"),style:{background:"#6B5BFF",color:"#fff",fontWeight:700,fontSize:18,padding:"10px 32px",borderRadius:10,boxShadow:"0 2px 8px #6B5BFF33",border:"none",cursor:"pointer"},children:"升級訂閱"})]})]})]}):r.jsx("div",{style:{minHeight:"100vh",background:"#f7faff",display:"flex",alignItems:"center",justifyContent:"center"},children:r.jsxs("div",{style:{background:"#fff",borderRadius:16,padding:32,boxShadow:"0 4px 24px #0002",minWidth:320,textAlign:"center"},children:[r.jsx("div",{style:{fontSize:20,fontWeight:700,color:"#6B5BFF",marginBottom:18},children:"請先註冊/登入才能進入個人中心"}),r.jsx("button",{onClick:()=>n("/register"),style:{background:"#6B5BFF",color:"#fff",border:"none",borderRadius:8,padding:"8px 32px",fontWeight:700,fontSize:18,cursor:"pointer",marginTop:8},children:"前往註冊/登入"})]})})}function Z5(){const n=$e();return r.jsxs("div",{style:{minHeight:"100vh",background:"#f7faff",padding:0},children:[r.jsx("button",{onClick:()=>n("/upgrade"),style:{position:"absolute",top:24,left:24,zIndex:10,background:"#fff",border:"1.5px solid #6B5BFF",color:"#6B5BFF",borderRadius:8,padding:"6px 18px",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:"0 2px 8px #0001"},children:"← 返回"}),r.jsx("div",{style:{maxWidth:900,margin:"0 auto",padding:"80px 24px 32px"},children:r.jsxs("div",{style:{background:"#fff",borderRadius:18,boxShadow:"0 4px 24px #6B5BFF11",padding:"32px 24px"},children:[r.jsx("h2",{style:{color:"#4B5BFF",fontWeight:900,fontSize:32,marginBottom:8,letterSpacing:2,textAlign:"center"},children:"付款設定說明"}),r.jsx("p",{style:{color:"#666",fontSize:18,textAlign:"center",marginBottom:32},children:"了解如何設定付款方式與完成訂閱"}),r.jsxs("div",{style:{marginBottom:32},children:[r.jsx("h3",{style:{color:"#333",fontWeight:700,fontSize:20,marginBottom:16},children:"支援的付款方式"}),r.jsxs("div",{style:{display:"grid",gap:16},children:[r.jsxs("div",{style:{border:"1px solid #e0e7ff",borderRadius:12,padding:20},children:[r.jsx("h4",{style:{color:"#6B5BFF",fontWeight:700,fontSize:18,marginBottom:8},children:"💳 Stripe"}),r.jsx("p",{style:{color:"#666",fontSize:16,lineHeight:1.6},children:"國際信用卡支付，支援 Visa、Mastercard、American Express 等主要信用卡。"})]}),r.jsxs("div",{style:{border:"1px solid #e0e7ff",borderRadius:12,padding:20},children:[r.jsx("h4",{style:{color:"#6B5BFF",fontWeight:700,fontSize:18,marginBottom:8},children:"🔵 PayPal"}),r.jsx("p",{style:{color:"#666",fontSize:16,lineHeight:1.6},children:"國際電子錢包，支援 PayPal 帳戶或信用卡付款。"})]}),r.jsxs("div",{style:{border:"1px solid #e0e7ff",borderRadius:12,padding:20},children:[r.jsx("h4",{style:{color:"#6B5BFF",fontWeight:700,fontSize:18,marginBottom:8},children:"🟢 綠界"}),r.jsx("p",{style:{color:"#666",fontSize:16,lineHeight:1.6},children:"台灣本地支付，支援信用卡、ATM 轉帳、超商付款等。"})]}),r.jsxs("div",{style:{border:"1px solid #e0e7ff",borderRadius:12,padding:20},children:[r.jsx("h4",{style:{color:"#6B5BFF",fontWeight:700,fontSize:18,marginBottom:8},children:"🔵 藍新"}),r.jsx("p",{style:{color:"#666",fontSize:16,lineHeight:1.6},children:"台灣本地支付，支援信用卡、ATM 轉帳、超商付款等。"})]})]})]}),r.jsxs("div",{style:{marginBottom:32},children:[r.jsx("h3",{style:{color:"#333",fontWeight:700,fontSize:20,marginBottom:16},children:"付款設定步驟"}),r.jsxs("ol",{style:{fontSize:16,lineHeight:1.8,paddingLeft:24},children:[r.jsx("li",{children:"選擇您想要的訂閱方案（月費或年費）"}),r.jsx("li",{children:"選擇付款方式（Stripe、PayPal、綠界、藍新）"}),r.jsx("li",{children:"點擊「立即升級」按鈕"}),r.jsx("li",{children:"系統會導向對應的付款頁面"}),r.jsx("li",{children:"完成付款後自動升級會員權益"})]})]}),r.jsxs("div",{style:{marginBottom:32},children:[r.jsx("h3",{style:{color:"#333",fontWeight:700,fontSize:20,marginBottom:16},children:"注意事項"}),r.jsxs("ul",{style:{fontSize:16,lineHeight:1.8,paddingLeft:24},children:[r.jsx("li",{children:"付款成功後，會員權益會立即生效"}),r.jsx("li",{children:"月費方案每月自動續費，年費方案每年自動續費"}),r.jsx("li",{children:"可隨時在會員中心取消自動續費"}),r.jsx("li",{children:"如有付款問題，請聯絡客服：support@restarter.com"})]})]}),r.jsx("div",{style:{textAlign:"center",marginTop:32},children:r.jsx("button",{onClick:()=>n("/upgrade"),style:{background:"linear-gradient(90deg,#6B5BFF 60%,#23c6e6 100%)",color:"#fff",border:"none",borderRadius:12,fontWeight:900,fontSize:20,padding:"12px 48px",boxShadow:"0 2px 12px #6B5BFF33",letterSpacing:2,cursor:"pointer"},children:"返回升級頁面"})})]})})]})}function eP(){const n=$e();return r.jsxs("div",{style:{minHeight:"100vh",background:"#f7faff",padding:0},children:[r.jsx("button",{onClick:()=>n("/plans"),style:{position:"absolute",top:24,left:24,zIndex:10,background:"#fff",border:"1.5px solid #6B5BFF",color:"#6B5BFF",borderRadius:8,padding:"6px 18px",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:"0 2px 8px #0001"},children:"← 返回"}),r.jsxs("div",{style:{maxWidth:600,margin:"0 auto",background:"#fff",borderRadius:18,boxShadow:"0 4px 24px #6B5BFF11",padding:"32px 24px",marginTop:64},children:[r.jsx("h2",{style:{color:"#4B5BFF",fontWeight:900,fontSize:32,marginBottom:24,letterSpacing:1},children:"聯絡客服"}),r.jsx("div",{style:{fontSize:18,color:"#333",marginBottom:24,lineHeight:1.8},children:"如有任何問題、付款疑問、升級需求，歡迎透過以下方式聯絡我們："}),r.jsxs("ul",{style:{fontSize:17,color:"#666",marginBottom:32,marginLeft:24},children:[r.jsxs("li",{children:["Email：",r.jsx("span",{href:"mailto:support@restarter.app",style:{color:"#6B5BFF",textDecoration:"underline"},children:"support@restarter.app"})]}),r.jsxs("li",{children:["LINE 客服：",r.jsx("span",{href:"https://line.me/R/ti/p/@restarter",target:"_blank",rel:"noopener noreferrer",style:{color:"#6B5BFF",textDecoration:"underline"},children:"@restarter"})]}),r.jsxs("li",{children:["Messenger：",r.jsx("span",{href:"https://m.me/restarterapp",target:"_blank",rel:"noopener noreferrer",style:{color:"#6B5BFF",textDecoration:"underline"},children:"Restarter 粉專"})]}),r.jsxs("li",{children:["線上表單：",r.jsx("span",{href:"https://forms.gle/xxxxxx",target:"_blank",rel:"noopener noreferrer",style:{color:"#6B5BFF",textDecoration:"underline"},children:"填寫表單"})]})]}),r.jsx("div",{style:{fontSize:16,color:"#888",marginTop:24},children:"客服回覆時間：週一至週五 10:00-18:00"})]})]})}const tP=({onTestModeChange:n})=>{const[e,t]=g.useState(!1);g.useEffect(()=>{const s=localStorage.getItem("testMode")==="true";t(s),n(s)},[n]);const i=()=>{const s=!e;t(s),localStorage.setItem("testMode",s.toString()),n(s)};return r.jsxs("div",{style:{position:"fixed",top:"20px",right:"20px",zIndex:1e4,display:"flex",flexDirection:"column",alignItems:"center",gap:"8px"},children:[r.jsx("button",{onClick:i,style:{background:e?"#ff6b6b":"#4ecdc4",color:"white",border:"none",borderRadius:"8px",padding:"8px 12px",fontSize:"12px",fontWeight:"bold",cursor:"pointer",boxShadow:"0 2px 8px rgba(0,0,0,0.2)",transition:"all 0.3s ease",minWidth:"80px"},onMouseEnter:s=>{s.currentTarget.style.transform="scale(1.05)"},onMouseLeave:s=>{s.currentTarget.style.transform="scale(1)"},children:e?"測試模式 ON":"測試模式 OFF"}),e&&r.jsx("div",{style:{background:"rgba(255, 107, 107, 0.9)",color:"white",padding:"6px 10px",borderRadius:"6px",fontSize:"10px",textAlign:"center",maxWidth:"120px",lineHeight:"1.2"},children:"語音功能已解鎖"})]})},hk=Kt.createContext({isTestMode:!1,setIsTestMode:()=>{}}),ji=()=>Kt.useContext(hk);function nP(){const{isMicOn:n}=ok();return n?r.jsx("div",{style:{position:"fixed",top:"12px",left:"50%",transform:"translateX(-50%)",zIndex:9999,background:"#ff6347",borderRadius:"50%",padding:"12px",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"0 4px 20px rgba(0,0,0,0.35)",border:"2px solid white"},children:r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"30",height:"30",viewBox:"0 0 24 24",fill:"white",children:r.jsx("path",{d:"M12 14c1.66 0 3-1.34 3-3V5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3zm5.3-3c0 3-2.54 5.1-5.3 5.1S6.7 14 6.7 11H5c0 3.41 2.72 6.23 6 6.72V21h2v-3.28c3.28-.49 6-3.31 6-6.72h-1.7z"})})}):null}function iP(){const[n,e]=g.useState(null),[t,i]=g.useState(!0),[s,o]=g.useState(!1),a=Je(Ti);return g.useEffect(()=>{const l=ur(a,c=>{e(c),i(!1)});return()=>l()},[a]),t?r.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh",fontSize:"2rem"},children:"Loading..."}):r.jsx(fE,{children:r.jsx(zB,{children:r.jsx(u5,{children:r.jsx(IB,{children:r.jsx(z1,{children:r.jsxs(hk.Provider,{value:{isTestMode:s,setIsTestMode:o},children:[r.jsx(tP,{onTestModeChange:o}),r.jsx(nP,{}),r.jsx(c5,{children:r.jsxs(E1,{children:[r.jsx(qe,{path:"/splash",element:r.jsx(D1,{})}),r.jsx(qe,{path:"/terms",element:r.jsx(FB,{})}),r.jsx(qe,{path:"/",element:r.jsx(Of,{})}),r.jsx(qe,{path:"/home",element:r.jsx(Of,{})}),r.jsx(qe,{path:"/register",element:r.jsx(yB,{})}),r.jsx(qe,{path:"/confirm-registration",element:r.jsx(M5,{})}),n&&r.jsx(qe,{path:"/wall",element:r.jsx(wE,{})}),n&&r.jsx(qe,{path:"/echo-box",element:r.jsx(kE,{})}),n&&r.jsx(qe,{path:"/my-story",element:r.jsx(SE,{})}),n&&r.jsx(qe,{path:"/chat",element:r.jsx(sB,{})}),n&&r.jsx(qe,{path:"/friend",element:r.jsx(bB,{})}),n&&r.jsx(qe,{path:"/inbox",element:r.jsx(wB,{})}),n&&r.jsx(qe,{path:"/ai",element:r.jsx(kB,{})}),n&&r.jsx(qe,{path:"/tts",element:r.jsx(hy,{})}),n&&r.jsx(qe,{path:"/journal",element:r.jsx(h5,{})}),n&&r.jsx(qe,{path:"/missions",element:r.jsx(my,{})}),n&&r.jsx(qe,{path:"/restart-missions",element:r.jsx(my,{})}),n&&r.jsx(qe,{path:"/pairtalk",element:r.jsx(AB,{})}),n&&r.jsx(qe,{path:"/skillbox",element:r.jsx(EB,{})}),n&&r.jsx(qe,{path:"/skillbox/:scenarioId",element:r.jsx(by,{})}),n&&r.jsx(qe,{path:"/practice",element:r.jsx(by,{})}),n&&r.jsx(qe,{path:"/realistic-tts",element:r.jsx(hy,{})}),n&&r.jsx(qe,{path:"/storywall",element:r.jsx(s5,{})}),n&&r.jsx(qe,{path:"/chatroom",element:r.jsx(m5,{})}),n&&r.jsx(qe,{path:"/invites",element:r.jsx(Xu,{})}),n&&r.jsx(qe,{path:"/mylinks",element:r.jsx(Yu,{})}),r.jsx(qe,{path:"/about",element:r.jsx(f5,{})}),r.jsx(qe,{path:"/feedback",element:r.jsx(y5,{})}),r.jsx(qe,{path:"/admin/feedback",element:r.jsx(x5,{})}),r.jsx(qe,{path:"/CompleteProfile",element:r.jsx(v5,{})}),r.jsx(qe,{path:"/privacy-policy",element:r.jsx(k5,{})}),r.jsx(qe,{path:"/data-deletion",element:r.jsx(T5,{})}),r.jsx(qe,{path:"/HelpLab",element:r.jsx(C5,{})}),r.jsx(qe,{path:"/emotion-release",element:r.jsx(R5,{})}),n&&r.jsx(qe,{path:"/social-integration",element:r.jsx(D5,{})}),r.jsx(qe,{path:"/ai-statement",element:r.jsx(W5,{})}),r.jsx(qe,{path:"/mental-health-disclaimer",element:r.jsx(L5,{})}),r.jsx(qe,{path:"/cookie-policy",element:r.jsx(O5,{})}),r.jsx(qe,{path:"/children-privacy",element:r.jsx(V5,{})}),r.jsx(qe,{path:"/international-users",element:r.jsx(q5,{})}),r.jsx(qe,{path:"/security-statement",element:r.jsx(U5,{})}),r.jsx(qe,{path:"/update-notification",element:r.jsx(H5,{})}),r.jsx(qe,{path:"/plans",element:r.jsx(Q5,{})}),r.jsx(qe,{path:"/payment",element:r.jsx(Y5,{})}),r.jsx(qe,{path:"/upgrade",element:r.jsx(X5,{})}),r.jsx(qe,{path:"/profile",element:r.jsx(J5,{})}),r.jsx(qe,{path:"/payment-info",element:r.jsx(Z5,{})}),r.jsx(qe,{path:"/contact",element:r.jsx(eP,{})}),!1]})})]})})})})})})}const rP=Nk.createRoot(document.getElementById("root"));rP.render(r.jsx(iP,{}));
