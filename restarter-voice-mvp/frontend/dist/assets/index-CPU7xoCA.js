function FE(n,e){for(var t=0;t<e.length;t++){const r=e[t];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in n)){const a=Object.getOwnPropertyDescriptor(r,s);a&&Object.defineProperty(n,s,a.get?a:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const c of a.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&r(c)}).observe(document,{childList:!0,subtree:!0});function t(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(s){if(s.ep)return;s.ep=!0;const a=t(s);fetch(s.href,a)}})();function NE(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var jg={exports:{}},xu={},Ig={exports:{}},ft={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var qv;function zE(){if(qv)return ft;qv=1;var n=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),c=Symbol.for("react.context"),d=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),m=Symbol.for("react.memo"),g=Symbol.for("react.lazy"),x=Symbol.iterator;function S(W){return W===null||typeof W!="object"?null:(W=x&&W[x]||W["@@iterator"],typeof W=="function"?W:null)}var I={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},_=Object.assign,R={};function T(W,$,ee){this.props=W,this.context=$,this.refs=R,this.updater=ee||I}T.prototype.isReactComponent={},T.prototype.setState=function(W,$){if(typeof W!="object"&&typeof W!="function"&&W!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,W,$,"setState")},T.prototype.forceUpdate=function(W){this.updater.enqueueForceUpdate(this,W,"forceUpdate")};function A(){}A.prototype=T.prototype;function D(W,$,ee){this.props=W,this.context=$,this.refs=R,this.updater=ee||I}var F=D.prototype=new A;F.constructor=D,_(F,T.prototype),F.isPureReactComponent=!0;var X=Array.isArray,ie=Object.prototype.hasOwnProperty,G={current:null},N={key:!0,ref:!0,__self:!0,__source:!0};function E(W,$,ee){var he,_e={},ve=null,Le=null;if($!=null)for(he in $.ref!==void 0&&(Le=$.ref),$.key!==void 0&&(ve=""+$.key),$)ie.call($,he)&&!N.hasOwnProperty(he)&&(_e[he]=$[he]);var Ne=arguments.length-2;if(Ne===1)_e.children=ee;else if(1<Ne){for(var nt=Array(Ne),Je=0;Je<Ne;Je++)nt[Je]=arguments[Je+2];_e.children=nt}if(W&&W.defaultProps)for(he in Ne=W.defaultProps,Ne)_e[he]===void 0&&(_e[he]=Ne[he]);return{$$typeof:n,type:W,key:ve,ref:Le,props:_e,_owner:G.current}}function P(W,$){return{$$typeof:n,type:W.type,key:$,ref:W.ref,props:W.props,_owner:W._owner}}function M(W){return typeof W=="object"&&W!==null&&W.$$typeof===n}function O(W){var $={"=":"=0",":":"=2"};return"$"+W.replace(/[=:]/g,function(ee){return $[ee]})}var z=/\/+/g;function j(W,$){return typeof W=="object"&&W!==null&&W.key!=null?O(""+W.key):$.toString(36)}function K(W,$,ee,he,_e){var ve=typeof W;(ve==="undefined"||ve==="boolean")&&(W=null);var Le=!1;if(W===null)Le=!0;else switch(ve){case"string":case"number":Le=!0;break;case"object":switch(W.$$typeof){case n:case e:Le=!0}}if(Le)return Le=W,_e=_e(Le),W=he===""?"."+j(Le,0):he,X(_e)?(ee="",W!=null&&(ee=W.replace(z,"$&/")+"/"),K(_e,$,ee,"",function(Je){return Je})):_e!=null&&(M(_e)&&(_e=P(_e,ee+(!_e.key||Le&&Le.key===_e.key?"":(""+_e.key).replace(z,"$&/")+"/")+W)),$.push(_e)),1;if(Le=0,he=he===""?".":he+":",X(W))for(var Ne=0;Ne<W.length;Ne++){ve=W[Ne];var nt=he+j(ve,Ne);Le+=K(ve,$,ee,nt,_e)}else if(nt=S(W),typeof nt=="function")for(W=nt.call(W),Ne=0;!(ve=W.next()).done;)ve=ve.value,nt=he+j(ve,Ne++),Le+=K(ve,$,ee,nt,_e);else if(ve==="object")throw $=String(W),Error("Objects are not valid as a React child (found: "+($==="[object Object]"?"object with keys {"+Object.keys(W).join(", ")+"}":$)+"). If you meant to render a collection of children, use an array instead.");return Le}function Z(W,$,ee){if(W==null)return W;var he=[],_e=0;return K(W,he,"","",function(ve){return $.call(ee,ve,_e++)}),he}function Y(W){if(W._status===-1){var $=W._result;$=$(),$.then(function(ee){(W._status===0||W._status===-1)&&(W._status=1,W._result=ee)},function(ee){(W._status===0||W._status===-1)&&(W._status=2,W._result=ee)}),W._status===-1&&(W._status=0,W._result=$)}if(W._status===1)return W._result.default;throw W._result}var ae={current:null},se={transition:null},re={ReactCurrentDispatcher:ae,ReactCurrentBatchConfig:se,ReactCurrentOwner:G};function ne(){throw Error("act(...) is not supported in production builds of React.")}return ft.Children={map:Z,forEach:function(W,$,ee){Z(W,function(){$.apply(this,arguments)},ee)},count:function(W){var $=0;return Z(W,function(){$++}),$},toArray:function(W){return Z(W,function($){return $})||[]},only:function(W){if(!M(W))throw Error("React.Children.only expected to receive a single React element child.");return W}},ft.Component=T,ft.Fragment=t,ft.Profiler=s,ft.PureComponent=D,ft.StrictMode=r,ft.Suspense=h,ft.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=re,ft.act=ne,ft.cloneElement=function(W,$,ee){if(W==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+W+".");var he=_({},W.props),_e=W.key,ve=W.ref,Le=W._owner;if($!=null){if($.ref!==void 0&&(ve=$.ref,Le=G.current),$.key!==void 0&&(_e=""+$.key),W.type&&W.type.defaultProps)var Ne=W.type.defaultProps;for(nt in $)ie.call($,nt)&&!N.hasOwnProperty(nt)&&(he[nt]=$[nt]===void 0&&Ne!==void 0?Ne[nt]:$[nt])}var nt=arguments.length-2;if(nt===1)he.children=ee;else if(1<nt){Ne=Array(nt);for(var Je=0;Je<nt;Je++)Ne[Je]=arguments[Je+2];he.children=Ne}return{$$typeof:n,type:W.type,key:_e,ref:ve,props:he,_owner:Le}},ft.createContext=function(W){return W={$$typeof:c,_currentValue:W,_currentValue2:W,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},W.Provider={$$typeof:a,_context:W},W.Consumer=W},ft.createElement=E,ft.createFactory=function(W){var $=E.bind(null,W);return $.type=W,$},ft.createRef=function(){return{current:null}},ft.forwardRef=function(W){return{$$typeof:d,render:W}},ft.isValidElement=M,ft.lazy=function(W){return{$$typeof:g,_payload:{_status:-1,_result:W},_init:Y}},ft.memo=function(W,$){return{$$typeof:m,type:W,compare:$===void 0?null:$}},ft.startTransition=function(W){var $=se.transition;se.transition={};try{W()}finally{se.transition=$}},ft.unstable_act=ne,ft.useCallback=function(W,$){return ae.current.useCallback(W,$)},ft.useContext=function(W){return ae.current.useContext(W)},ft.useDebugValue=function(){},ft.useDeferredValue=function(W){return ae.current.useDeferredValue(W)},ft.useEffect=function(W,$){return ae.current.useEffect(W,$)},ft.useId=function(){return ae.current.useId()},ft.useImperativeHandle=function(W,$,ee){return ae.current.useImperativeHandle(W,$,ee)},ft.useInsertionEffect=function(W,$){return ae.current.useInsertionEffect(W,$)},ft.useLayoutEffect=function(W,$){return ae.current.useLayoutEffect(W,$)},ft.useMemo=function(W,$){return ae.current.useMemo(W,$)},ft.useReducer=function(W,$,ee){return ae.current.useReducer(W,$,ee)},ft.useRef=function(W){return ae.current.useRef(W)},ft.useState=function(W){return ae.current.useState(W)},ft.useSyncExternalStore=function(W,$,ee){return ae.current.useSyncExternalStore(W,$,ee)},ft.useTransition=function(){return ae.current.useTransition()},ft.version="18.3.1",ft}var Hv;function ix(){return Hv||(Hv=1,Ig.exports=zE()),Ig.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $v;function DE(){if($v)return xu;$v=1;var n=ix(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,s=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,a={key:!0,ref:!0,__self:!0,__source:!0};function c(d,h,m){var g,x={},S=null,I=null;m!==void 0&&(S=""+m),h.key!==void 0&&(S=""+h.key),h.ref!==void 0&&(I=h.ref);for(g in h)r.call(h,g)&&!a.hasOwnProperty(g)&&(x[g]=h[g]);if(d&&d.defaultProps)for(g in h=d.defaultProps,h)x[g]===void 0&&(x[g]=h[g]);return{$$typeof:e,type:d,key:S,ref:I,props:x,_owner:s.current}}return xu.Fragment=t,xu.jsx=c,xu.jsxs=c,xu}var Gv;function ME(){return Gv||(Gv=1,jg.exports=DE()),jg.exports}var i=ME(),Jh={},Eg={exports:{}},xr={},Cg={exports:{}},Rg={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Kv;function LE(){return Kv||(Kv=1,function(n){function e(se,re){var ne=se.length;se.push(re);e:for(;0<ne;){var W=ne-1>>>1,$=se[W];if(0<s($,re))se[W]=re,se[ne]=$,ne=W;else break e}}function t(se){return se.length===0?null:se[0]}function r(se){if(se.length===0)return null;var re=se[0],ne=se.pop();if(ne!==re){se[0]=ne;e:for(var W=0,$=se.length,ee=$>>>1;W<ee;){var he=2*(W+1)-1,_e=se[he],ve=he+1,Le=se[ve];if(0>s(_e,ne))ve<$&&0>s(Le,_e)?(se[W]=Le,se[ve]=ne,W=ve):(se[W]=_e,se[he]=ne,W=he);else if(ve<$&&0>s(Le,ne))se[W]=Le,se[ve]=ne,W=ve;else break e}}return re}function s(se,re){var ne=se.sortIndex-re.sortIndex;return ne!==0?ne:se.id-re.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;n.unstable_now=function(){return a.now()}}else{var c=Date,d=c.now();n.unstable_now=function(){return c.now()-d}}var h=[],m=[],g=1,x=null,S=3,I=!1,_=!1,R=!1,T=typeof setTimeout=="function"?setTimeout:null,A=typeof clearTimeout=="function"?clearTimeout:null,D=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function F(se){for(var re=t(m);re!==null;){if(re.callback===null)r(m);else if(re.startTime<=se)r(m),re.sortIndex=re.expirationTime,e(h,re);else break;re=t(m)}}function X(se){if(R=!1,F(se),!_)if(t(h)!==null)_=!0,Y(ie);else{var re=t(m);re!==null&&ae(X,re.startTime-se)}}function ie(se,re){_=!1,R&&(R=!1,A(E),E=-1),I=!0;var ne=S;try{for(F(re),x=t(h);x!==null&&(!(x.expirationTime>re)||se&&!O());){var W=x.callback;if(typeof W=="function"){x.callback=null,S=x.priorityLevel;var $=W(x.expirationTime<=re);re=n.unstable_now(),typeof $=="function"?x.callback=$:x===t(h)&&r(h),F(re)}else r(h);x=t(h)}if(x!==null)var ee=!0;else{var he=t(m);he!==null&&ae(X,he.startTime-re),ee=!1}return ee}finally{x=null,S=ne,I=!1}}var G=!1,N=null,E=-1,P=5,M=-1;function O(){return!(n.unstable_now()-M<P)}function z(){if(N!==null){var se=n.unstable_now();M=se;var re=!0;try{re=N(!0,se)}finally{re?j():(G=!1,N=null)}}else G=!1}var j;if(typeof D=="function")j=function(){D(z)};else if(typeof MessageChannel<"u"){var K=new MessageChannel,Z=K.port2;K.port1.onmessage=z,j=function(){Z.postMessage(null)}}else j=function(){T(z,0)};function Y(se){N=se,G||(G=!0,j())}function ae(se,re){E=T(function(){se(n.unstable_now())},re)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(se){se.callback=null},n.unstable_continueExecution=function(){_||I||(_=!0,Y(ie))},n.unstable_forceFrameRate=function(se){0>se||125<se?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):P=0<se?Math.floor(1e3/se):5},n.unstable_getCurrentPriorityLevel=function(){return S},n.unstable_getFirstCallbackNode=function(){return t(h)},n.unstable_next=function(se){switch(S){case 1:case 2:case 3:var re=3;break;default:re=S}var ne=S;S=re;try{return se()}finally{S=ne}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(se,re){switch(se){case 1:case 2:case 3:case 4:case 5:break;default:se=3}var ne=S;S=se;try{return re()}finally{S=ne}},n.unstable_scheduleCallback=function(se,re,ne){var W=n.unstable_now();switch(typeof ne=="object"&&ne!==null?(ne=ne.delay,ne=typeof ne=="number"&&0<ne?W+ne:W):ne=W,se){case 1:var $=-1;break;case 2:$=250;break;case 5:$=1073741823;break;case 4:$=1e4;break;default:$=5e3}return $=ne+$,se={id:g++,callback:re,priorityLevel:se,startTime:ne,expirationTime:$,sortIndex:-1},ne>W?(se.sortIndex=ne,e(m,se),t(h)===null&&se===t(m)&&(R?(A(E),E=-1):R=!0,ae(X,ne-W))):(se.sortIndex=$,e(h,se),_||I||(_=!0,Y(ie))),se},n.unstable_shouldYield=O,n.unstable_wrapCallback=function(se){var re=S;return function(){var ne=S;S=re;try{return se.apply(this,arguments)}finally{S=ne}}}}(Rg)),Rg}var Qv;function OE(){return Qv||(Qv=1,Cg.exports=LE()),Cg.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Yv;function VE(){if(Yv)return xr;Yv=1;var n=ix(),e=OE();function t(o){for(var l="https://reactjs.org/docs/error-decoder.html?invariant="+o,u=1;u<arguments.length;u++)l+="&args[]="+encodeURIComponent(arguments[u]);return"Minified React error #"+o+"; visit "+l+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var r=new Set,s={};function a(o,l){c(o,l),c(o+"Capture",l)}function c(o,l){for(s[o]=l,o=0;o<l.length;o++)r.add(l[o])}var d=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),h=Object.prototype.hasOwnProperty,m=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,g={},x={};function S(o){return h.call(x,o)?!0:h.call(g,o)?!1:m.test(o)?x[o]=!0:(g[o]=!0,!1)}function I(o,l,u,f){if(u!==null&&u.type===0)return!1;switch(typeof l){case"function":case"symbol":return!0;case"boolean":return f?!1:u!==null?!u.acceptsBooleans:(o=o.toLowerCase().slice(0,5),o!=="data-"&&o!=="aria-");default:return!1}}function _(o,l,u,f){if(l===null||typeof l>"u"||I(o,l,u,f))return!0;if(f)return!1;if(u!==null)switch(u.type){case 3:return!l;case 4:return l===!1;case 5:return isNaN(l);case 6:return isNaN(l)||1>l}return!1}function R(o,l,u,f,y,v,C){this.acceptsBooleans=l===2||l===3||l===4,this.attributeName=f,this.attributeNamespace=y,this.mustUseProperty=u,this.propertyName=o,this.type=l,this.sanitizeURL=v,this.removeEmptyString=C}var T={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(o){T[o]=new R(o,0,!1,o,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(o){var l=o[0];T[l]=new R(l,1,!1,o[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(o){T[o]=new R(o,2,!1,o.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(o){T[o]=new R(o,2,!1,o,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(o){T[o]=new R(o,3,!1,o.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(o){T[o]=new R(o,3,!0,o,null,!1,!1)}),["capture","download"].forEach(function(o){T[o]=new R(o,4,!1,o,null,!1,!1)}),["cols","rows","size","span"].forEach(function(o){T[o]=new R(o,6,!1,o,null,!1,!1)}),["rowSpan","start"].forEach(function(o){T[o]=new R(o,5,!1,o.toLowerCase(),null,!1,!1)});var A=/[\-:]([a-z])/g;function D(o){return o[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(o){var l=o.replace(A,D);T[l]=new R(l,1,!1,o,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(o){var l=o.replace(A,D);T[l]=new R(l,1,!1,o,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(o){var l=o.replace(A,D);T[l]=new R(l,1,!1,o,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(o){T[o]=new R(o,1,!1,o.toLowerCase(),null,!1,!1)}),T.xlinkHref=new R("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(o){T[o]=new R(o,1,!1,o.toLowerCase(),null,!0,!0)});function F(o,l,u,f){var y=T.hasOwnProperty(l)?T[l]:null;(y!==null?y.type!==0:f||!(2<l.length)||l[0]!=="o"&&l[0]!=="O"||l[1]!=="n"&&l[1]!=="N")&&(_(l,u,y,f)&&(u=null),f||y===null?S(l)&&(u===null?o.removeAttribute(l):o.setAttribute(l,""+u)):y.mustUseProperty?o[y.propertyName]=u===null?y.type===3?!1:"":u:(l=y.attributeName,f=y.attributeNamespace,u===null?o.removeAttribute(l):(y=y.type,u=y===3||y===4&&u===!0?"":""+u,f?o.setAttributeNS(f,l,u):o.setAttribute(l,u))))}var X=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,ie=Symbol.for("react.element"),G=Symbol.for("react.portal"),N=Symbol.for("react.fragment"),E=Symbol.for("react.strict_mode"),P=Symbol.for("react.profiler"),M=Symbol.for("react.provider"),O=Symbol.for("react.context"),z=Symbol.for("react.forward_ref"),j=Symbol.for("react.suspense"),K=Symbol.for("react.suspense_list"),Z=Symbol.for("react.memo"),Y=Symbol.for("react.lazy"),ae=Symbol.for("react.offscreen"),se=Symbol.iterator;function re(o){return o===null||typeof o!="object"?null:(o=se&&o[se]||o["@@iterator"],typeof o=="function"?o:null)}var ne=Object.assign,W;function $(o){if(W===void 0)try{throw Error()}catch(u){var l=u.stack.trim().match(/\n( *(at )?)/);W=l&&l[1]||""}return`
`+W+o}var ee=!1;function he(o,l){if(!o||ee)return"";ee=!0;var u=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(l)if(l=function(){throw Error()},Object.defineProperty(l.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(l,[])}catch(fe){var f=fe}Reflect.construct(o,[],l)}else{try{l.call()}catch(fe){f=fe}o.call(l.prototype)}else{try{throw Error()}catch(fe){f=fe}o()}}catch(fe){if(fe&&f&&typeof fe.stack=="string"){for(var y=fe.stack.split(`
`),v=f.stack.split(`
`),C=y.length-1,q=v.length-1;1<=C&&0<=q&&y[C]!==v[q];)q--;for(;1<=C&&0<=q;C--,q--)if(y[C]!==v[q]){if(C!==1||q!==1)do if(C--,q--,0>q||y[C]!==v[q]){var Q=`
`+y[C].replace(" at new "," at ");return o.displayName&&Q.includes("<anonymous>")&&(Q=Q.replace("<anonymous>",o.displayName)),Q}while(1<=C&&0<=q);break}}}finally{ee=!1,Error.prepareStackTrace=u}return(o=o?o.displayName||o.name:"")?$(o):""}function _e(o){switch(o.tag){case 5:return $(o.type);case 16:return $("Lazy");case 13:return $("Suspense");case 19:return $("SuspenseList");case 0:case 2:case 15:return o=he(o.type,!1),o;case 11:return o=he(o.type.render,!1),o;case 1:return o=he(o.type,!0),o;default:return""}}function ve(o){if(o==null)return null;if(typeof o=="function")return o.displayName||o.name||null;if(typeof o=="string")return o;switch(o){case N:return"Fragment";case G:return"Portal";case P:return"Profiler";case E:return"StrictMode";case j:return"Suspense";case K:return"SuspenseList"}if(typeof o=="object")switch(o.$$typeof){case O:return(o.displayName||"Context")+".Consumer";case M:return(o._context.displayName||"Context")+".Provider";case z:var l=o.render;return o=o.displayName,o||(o=l.displayName||l.name||"",o=o!==""?"ForwardRef("+o+")":"ForwardRef"),o;case Z:return l=o.displayName||null,l!==null?l:ve(o.type)||"Memo";case Y:l=o._payload,o=o._init;try{return ve(o(l))}catch{}}return null}function Le(o){var l=o.type;switch(o.tag){case 24:return"Cache";case 9:return(l.displayName||"Context")+".Consumer";case 10:return(l._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return o=l.render,o=o.displayName||o.name||"",l.displayName||(o!==""?"ForwardRef("+o+")":"ForwardRef");case 7:return"Fragment";case 5:return l;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return ve(l);case 8:return l===E?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof l=="function")return l.displayName||l.name||null;if(typeof l=="string")return l}return null}function Ne(o){switch(typeof o){case"boolean":case"number":case"string":case"undefined":return o;case"object":return o;default:return""}}function nt(o){var l=o.type;return(o=o.nodeName)&&o.toLowerCase()==="input"&&(l==="checkbox"||l==="radio")}function Je(o){var l=nt(o)?"checked":"value",u=Object.getOwnPropertyDescriptor(o.constructor.prototype,l),f=""+o[l];if(!o.hasOwnProperty(l)&&typeof u<"u"&&typeof u.get=="function"&&typeof u.set=="function"){var y=u.get,v=u.set;return Object.defineProperty(o,l,{configurable:!0,get:function(){return y.call(this)},set:function(C){f=""+C,v.call(this,C)}}),Object.defineProperty(o,l,{enumerable:u.enumerable}),{getValue:function(){return f},setValue:function(C){f=""+C},stopTracking:function(){o._valueTracker=null,delete o[l]}}}}function ge(o){o._valueTracker||(o._valueTracker=Je(o))}function De(o){if(!o)return!1;var l=o._valueTracker;if(!l)return!0;var u=l.getValue(),f="";return o&&(f=nt(o)?o.checked?"true":"false":o.value),o=f,o!==u?(l.setValue(o),!0):!1}function tt(o){if(o=o||(typeof document<"u"?document:void 0),typeof o>"u")return null;try{return o.activeElement||o.body}catch{return o.body}}function Ye(o,l){var u=l.checked;return ne({},l,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:u??o._wrapperState.initialChecked})}function We(o,l){var u=l.defaultValue==null?"":l.defaultValue,f=l.checked!=null?l.checked:l.defaultChecked;u=Ne(l.value!=null?l.value:u),o._wrapperState={initialChecked:f,initialValue:u,controlled:l.type==="checkbox"||l.type==="radio"?l.checked!=null:l.value!=null}}function pe(o,l){l=l.checked,l!=null&&F(o,"checked",l,!1)}function Se(o,l){pe(o,l);var u=Ne(l.value),f=l.type;if(u!=null)f==="number"?(u===0&&o.value===""||o.value!=u)&&(o.value=""+u):o.value!==""+u&&(o.value=""+u);else if(f==="submit"||f==="reset"){o.removeAttribute("value");return}l.hasOwnProperty("value")?Re(o,l.type,u):l.hasOwnProperty("defaultValue")&&Re(o,l.type,Ne(l.defaultValue)),l.checked==null&&l.defaultChecked!=null&&(o.defaultChecked=!!l.defaultChecked)}function we(o,l,u){if(l.hasOwnProperty("value")||l.hasOwnProperty("defaultValue")){var f=l.type;if(!(f!=="submit"&&f!=="reset"||l.value!==void 0&&l.value!==null))return;l=""+o._wrapperState.initialValue,u||l===o.value||(o.value=l),o.defaultValue=l}u=o.name,u!==""&&(o.name=""),o.defaultChecked=!!o._wrapperState.initialChecked,u!==""&&(o.name=u)}function Re(o,l,u){(l!=="number"||tt(o.ownerDocument)!==o)&&(u==null?o.defaultValue=""+o._wrapperState.initialValue:o.defaultValue!==""+u&&(o.defaultValue=""+u))}var Ce=Array.isArray;function U(o,l,u,f){if(o=o.options,l){l={};for(var y=0;y<u.length;y++)l["$"+u[y]]=!0;for(u=0;u<o.length;u++)y=l.hasOwnProperty("$"+o[u].value),o[u].selected!==y&&(o[u].selected=y),y&&f&&(o[u].defaultSelected=!0)}else{for(u=""+Ne(u),l=null,y=0;y<o.length;y++){if(o[y].value===u){o[y].selected=!0,f&&(o[y].defaultSelected=!0);return}l!==null||o[y].disabled||(l=o[y])}l!==null&&(l.selected=!0)}}function V(o,l){if(l.dangerouslySetInnerHTML!=null)throw Error(t(91));return ne({},l,{value:void 0,defaultValue:void 0,children:""+o._wrapperState.initialValue})}function L(o,l){var u=l.value;if(u==null){if(u=l.children,l=l.defaultValue,u!=null){if(l!=null)throw Error(t(92));if(Ce(u)){if(1<u.length)throw Error(t(93));u=u[0]}l=u}l==null&&(l=""),u=l}o._wrapperState={initialValue:Ne(u)}}function oe(o,l){var u=Ne(l.value),f=Ne(l.defaultValue);u!=null&&(u=""+u,u!==o.value&&(o.value=u),l.defaultValue==null&&o.defaultValue!==u&&(o.defaultValue=u)),f!=null&&(o.defaultValue=""+f)}function H(o){var l=o.textContent;l===o._wrapperState.initialValue&&l!==""&&l!==null&&(o.value=l)}function J(o){switch(o){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function be(o,l){return o==null||o==="http://www.w3.org/1999/xhtml"?J(l):o==="http://www.w3.org/2000/svg"&&l==="foreignObject"?"http://www.w3.org/1999/xhtml":o}var Me,$e=function(o){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(l,u,f,y){MSApp.execUnsafeLocalFunction(function(){return o(l,u,f,y)})}:o}(function(o,l){if(o.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in o)o.innerHTML=l;else{for(Me=Me||document.createElement("div"),Me.innerHTML="<svg>"+l.valueOf().toString()+"</svg>",l=Me.firstChild;o.firstChild;)o.removeChild(o.firstChild);for(;l.firstChild;)o.appendChild(l.firstChild)}});function Ze(o,l){if(l){var u=o.firstChild;if(u&&u===o.lastChild&&u.nodeType===3){u.nodeValue=l;return}}o.textContent=l}var Ke={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Et=["Webkit","ms","Moz","O"];Object.keys(Ke).forEach(function(o){Et.forEach(function(l){l=l+o.charAt(0).toUpperCase()+o.substring(1),Ke[l]=Ke[o]})});function Ot(o,l,u){return l==null||typeof l=="boolean"||l===""?"":u||typeof l!="number"||l===0||Ke.hasOwnProperty(o)&&Ke[o]?(""+l).trim():l+"px"}function Gt(o,l){o=o.style;for(var u in l)if(l.hasOwnProperty(u)){var f=u.indexOf("--")===0,y=Ot(u,l[u],f);u==="float"&&(u="cssFloat"),f?o.setProperty(u,y):o[u]=y}}var et=ne({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ht(o,l){if(l){if(et[o]&&(l.children!=null||l.dangerouslySetInnerHTML!=null))throw Error(t(137,o));if(l.dangerouslySetInnerHTML!=null){if(l.children!=null)throw Error(t(60));if(typeof l.dangerouslySetInnerHTML!="object"||!("__html"in l.dangerouslySetInnerHTML))throw Error(t(61))}if(l.style!=null&&typeof l.style!="object")throw Error(t(62))}}function Vt(o,l){if(o.indexOf("-")===-1)return typeof l.is=="string";switch(o){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ct=null;function zt(o){return o=o.target||o.srcElement||window,o.correspondingUseElement&&(o=o.correspondingUseElement),o.nodeType===3?o.parentNode:o}var On=null,Wt=null,bn=null;function Ir(o){if(o=ru(o)){if(typeof On!="function")throw Error(t(280));var l=o.stateNode;l&&(l=ph(l),On(o.stateNode,o.type,l))}}function Er(o){Wt?bn?bn.push(o):bn=[o]:Wt=o}function Es(){if(Wt){var o=Wt,l=bn;if(bn=Wt=null,Ir(o),l)for(o=0;o<l.length;o++)Ir(l[o])}}function yi(o,l){return o(l)}function Cs(){}var Vr=!1;function Rs(o,l,u){if(Vr)return o(l,u);Vr=!0;try{return yi(o,l,u)}finally{Vr=!1,(Wt!==null||bn!==null)&&(Cs(),Es())}}function Zt(o,l){var u=o.stateNode;if(u===null)return null;var f=ph(u);if(f===null)return null;u=f[l];e:switch(l){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(f=!f.disabled)||(o=o.type,f=!(o==="button"||o==="input"||o==="select"||o==="textarea")),o=!f;break e;default:o=!1}if(o)return null;if(u&&typeof u!="function")throw Error(t(231,l,typeof u));return u}var Hi=!1;if(d)try{var ur={};Object.defineProperty(ur,"passive",{get:function(){Hi=!0}}),window.addEventListener("test",ur,ur),window.removeEventListener("test",ur,ur)}catch{Hi=!1}function xi(o,l,u,f,y,v,C,q,Q){var fe=Array.prototype.slice.call(arguments,3);try{l.apply(u,fe)}catch(Ie){this.onError(Ie)}}var bi=!1,at=null,rr=!1,$i=null,Dc={onError:function(o){bi=!0,at=o}};function Ha(o,l,u,f,y,v,C,q,Q){bi=!1,at=null,xi.apply(Dc,arguments)}function Md(o,l,u,f,y,v,C,q,Q){if(Ha.apply(this,arguments),bi){if(bi){var fe=at;bi=!1,at=null}else throw Error(t(198));rr||(rr=!0,$i=fe)}}function Jr(o){var l=o,u=o;if(o.alternate)for(;l.return;)l=l.return;else{o=l;do l=o,(l.flags&4098)!==0&&(u=l.return),o=l.return;while(o)}return l.tag===3?u:null}function Oo(o){if(o.tag===13){var l=o.memoizedState;if(l===null&&(o=o.alternate,o!==null&&(l=o.memoizedState)),l!==null)return l.dehydrated}return null}function Zr(o){if(Jr(o)!==o)throw Error(t(188))}function Ld(o){var l=o.alternate;if(!l){if(l=Jr(o),l===null)throw Error(t(188));return l!==o?null:o}for(var u=o,f=l;;){var y=u.return;if(y===null)break;var v=y.alternate;if(v===null){if(f=y.return,f!==null){u=f;continue}break}if(y.child===v.child){for(v=y.child;v;){if(v===u)return Zr(y),o;if(v===f)return Zr(y),l;v=v.sibling}throw Error(t(188))}if(u.return!==f.return)u=y,f=v;else{for(var C=!1,q=y.child;q;){if(q===u){C=!0,u=y,f=v;break}if(q===f){C=!0,f=y,u=v;break}q=q.sibling}if(!C){for(q=v.child;q;){if(q===u){C=!0,u=v,f=y;break}if(q===f){C=!0,f=v,u=y;break}q=q.sibling}if(!C)throw Error(t(189))}}if(u.alternate!==f)throw Error(t(190))}if(u.tag!==3)throw Error(t(188));return u.stateNode.current===u?o:l}function Mc(o){return o=Ld(o),o!==null?$a(o):null}function $a(o){if(o.tag===5||o.tag===6)return o;for(o=o.child;o!==null;){var l=$a(o);if(l!==null)return l;o=o.sibling}return null}var Ga=e.unstable_scheduleCallback,Lc=e.unstable_cancelCallback,Od=e.unstable_shouldYield,tm=e.unstable_requestPaint,Ut=e.unstable_now,Vd=e.unstable_getCurrentPriorityLevel,Vo=e.unstable_ImmediatePriority,As=e.unstable_UserBlockingPriority,Wr=e.unstable_NormalPriority,Oc=e.unstable_LowPriority,Wd=e.unstable_IdlePriority,Wo=null,Cr=null;function Ud(o){if(Cr&&typeof Cr.onCommitFiberRoot=="function")try{Cr.onCommitFiberRoot(Wo,o,void 0,(o.current.flags&128)===128)}catch{}}var ir=Math.clz32?Math.clz32:Hd,Vc=Math.log,qd=Math.LN2;function Hd(o){return o>>>=0,o===0?32:31-(Vc(o)/qd|0)|0}var Ka=64,Qa=4194304;function Ps(o){switch(o&-o){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return o&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return o}}function Uo(o,l){var u=o.pendingLanes;if(u===0)return 0;var f=0,y=o.suspendedLanes,v=o.pingedLanes,C=u&268435455;if(C!==0){var q=C&~y;q!==0?f=Ps(q):(v&=C,v!==0&&(f=Ps(v)))}else C=u&~y,C!==0?f=Ps(C):v!==0&&(f=Ps(v));if(f===0)return 0;if(l!==0&&l!==f&&(l&y)===0&&(y=f&-f,v=l&-l,y>=v||y===16&&(v&4194240)!==0))return l;if((f&4)!==0&&(f|=u&16),l=o.entangledLanes,l!==0)for(o=o.entanglements,l&=f;0<l;)u=31-ir(l),y=1<<u,f|=o[u],l&=~y;return f}function nm(o,l){switch(o){case 1:case 2:case 4:return l+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return l+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Gi(o,l){for(var u=o.suspendedLanes,f=o.pingedLanes,y=o.expirationTimes,v=o.pendingLanes;0<v;){var C=31-ir(v),q=1<<C,Q=y[C];Q===-1?((q&u)===0||(q&f)!==0)&&(y[C]=nm(q,l)):Q<=l&&(o.expiredLanes|=q),v&=~q}}function Rr(o){return o=o.pendingLanes&-1073741825,o!==0?o:o&1073741824?1073741824:0}function qo(){var o=Ka;return Ka<<=1,(Ka&4194240)===0&&(Ka=64),o}function Bs(o){for(var l=[],u=0;31>u;u++)l.push(o);return l}function Fs(o,l,u){o.pendingLanes|=l,l!==536870912&&(o.suspendedLanes=0,o.pingedLanes=0),o=o.eventTimes,l=31-ir(l),o[l]=u}function Dt(o,l){var u=o.pendingLanes&~l;o.pendingLanes=l,o.suspendedLanes=0,o.pingedLanes=0,o.expiredLanes&=l,o.mutableReadLanes&=l,o.entangledLanes&=l,l=o.entanglements;var f=o.eventTimes;for(o=o.expirationTimes;0<u;){var y=31-ir(u),v=1<<y;l[y]=0,f[y]=-1,o[y]=-1,u&=~v}}function Ns(o,l){var u=o.entangledLanes|=l;for(o=o.entanglements;u;){var f=31-ir(u),y=1<<f;y&l|o[f]&l&&(o[f]|=l),u&=~y}}var vt=0;function zs(o){return o&=-o,1<o?4<o?(o&268435455)!==0?16:536870912:4:1}var $d,Ya,Gd,Kd,Qd,Wc=!1,vi=[],Vn=null,ei=null,ti=null,Ds=new Map,Ur=new Map,wi=[],rm="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Yd(o,l){switch(o){case"focusin":case"focusout":Vn=null;break;case"dragenter":case"dragleave":ei=null;break;case"mouseover":case"mouseout":ti=null;break;case"pointerover":case"pointerout":Ds.delete(l.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ur.delete(l.pointerId)}}function dr(o,l,u,f,y,v){return o===null||o.nativeEvent!==v?(o={blockedOn:l,domEventName:u,eventSystemFlags:f,nativeEvent:v,targetContainers:[y]},l!==null&&(l=ru(l),l!==null&&Ya(l)),o):(o.eventSystemFlags|=f,l=o.targetContainers,y!==null&&l.indexOf(y)===-1&&l.push(y),o)}function im(o,l,u,f,y){switch(l){case"focusin":return Vn=dr(Vn,o,l,u,f,y),!0;case"dragenter":return ei=dr(ei,o,l,u,f,y),!0;case"mouseover":return ti=dr(ti,o,l,u,f,y),!0;case"pointerover":var v=y.pointerId;return Ds.set(v,dr(Ds.get(v)||null,o,l,u,f,y)),!0;case"gotpointercapture":return v=y.pointerId,Ur.set(v,dr(Ur.get(v)||null,o,l,u,f,y)),!0}return!1}function Xd(o){var l=Qo(o.target);if(l!==null){var u=Jr(l);if(u!==null){if(l=u.tag,l===13){if(l=Oo(u),l!==null){o.blockedOn=l,Qd(o.priority,function(){Gd(u)});return}}else if(l===3&&u.stateNode.current.memoizedState.isDehydrated){o.blockedOn=u.tag===3?u.stateNode.containerInfo:null;return}}}o.blockedOn=null}function Ki(o){if(o.blockedOn!==null)return!1;for(var l=o.targetContainers;0<l.length;){var u=Xa(o.domEventName,o.eventSystemFlags,l[0],o.nativeEvent);if(u===null){u=o.nativeEvent;var f=new u.constructor(u.type,u);ct=f,u.target.dispatchEvent(f),ct=null}else return l=ru(u),l!==null&&Ya(l),o.blockedOn=u,!1;l.shift()}return!0}function Ho(o,l,u){Ki(o)&&u.delete(l)}function Jd(){Wc=!1,Vn!==null&&Ki(Vn)&&(Vn=null),ei!==null&&Ki(ei)&&(ei=null),ti!==null&&Ki(ti)&&(ti=null),Ds.forEach(Ho),Ur.forEach(Ho)}function ni(o,l){o.blockedOn===l&&(o.blockedOn=null,Wc||(Wc=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,Jd)))}function ri(o){function l(y){return ni(y,o)}if(0<vi.length){ni(vi[0],o);for(var u=1;u<vi.length;u++){var f=vi[u];f.blockedOn===o&&(f.blockedOn=null)}}for(Vn!==null&&ni(Vn,o),ei!==null&&ni(ei,o),ti!==null&&ni(ti,o),Ds.forEach(l),Ur.forEach(l),u=0;u<wi.length;u++)f=wi[u],f.blockedOn===o&&(f.blockedOn=null);for(;0<wi.length&&(u=wi[0],u.blockedOn===null);)Xd(u),u.blockedOn===null&&wi.shift()}var Qi=X.ReactCurrentBatchConfig,Ms=!0;function en(o,l,u,f){var y=vt,v=Qi.transition;Qi.transition=null;try{vt=1,Uc(o,l,u,f)}finally{vt=y,Qi.transition=v}}function sm(o,l,u,f){var y=vt,v=Qi.transition;Qi.transition=null;try{vt=4,Uc(o,l,u,f)}finally{vt=y,Qi.transition=v}}function Uc(o,l,u,f){if(Ms){var y=Xa(o,l,u,f);if(y===null)gm(o,l,f,$o,u),Yd(o,f);else if(im(y,o,l,u,f))f.stopPropagation();else if(Yd(o,f),l&4&&-1<rm.indexOf(o)){for(;y!==null;){var v=ru(y);if(v!==null&&$d(v),v=Xa(o,l,u,f),v===null&&gm(o,l,f,$o,u),v===y)break;y=v}y!==null&&f.stopPropagation()}else gm(o,l,f,null,u)}}var $o=null;function Xa(o,l,u,f){if($o=null,o=zt(f),o=Qo(o),o!==null)if(l=Jr(o),l===null)o=null;else if(u=l.tag,u===13){if(o=Oo(l),o!==null)return o;o=null}else if(u===3){if(l.stateNode.current.memoizedState.isDehydrated)return l.tag===3?l.stateNode.containerInfo:null;o=null}else l!==o&&(o=null);return $o=o,null}function qc(o){switch(o){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Vd()){case Vo:return 1;case As:return 4;case Wr:case Oc:return 16;case Wd:return 536870912;default:return 16}default:return 16}}var Ar=null,Ja=null,hr=null;function Hc(){if(hr)return hr;var o,l=Ja,u=l.length,f,y="value"in Ar?Ar.value:Ar.textContent,v=y.length;for(o=0;o<u&&l[o]===y[o];o++);var C=u-o;for(f=1;f<=C&&l[u-f]===y[v-f];f++);return hr=y.slice(o,1<f?1-f:void 0)}function Za(o){var l=o.keyCode;return"charCode"in o?(o=o.charCode,o===0&&l===13&&(o=13)):o=l,o===10&&(o=13),32<=o||o===13?o:0}function Si(){return!0}function $c(){return!1}function Wn(o){function l(u,f,y,v,C){this._reactName=u,this._targetInst=y,this.type=f,this.nativeEvent=v,this.target=C,this.currentTarget=null;for(var q in o)o.hasOwnProperty(q)&&(u=o[q],this[q]=u?u(v):v[q]);return this.isDefaultPrevented=(v.defaultPrevented!=null?v.defaultPrevented:v.returnValue===!1)?Si:$c,this.isPropagationStopped=$c,this}return ne(l.prototype,{preventDefault:function(){this.defaultPrevented=!0;var u=this.nativeEvent;u&&(u.preventDefault?u.preventDefault():typeof u.returnValue!="unknown"&&(u.returnValue=!1),this.isDefaultPrevented=Si)},stopPropagation:function(){var u=this.nativeEvent;u&&(u.stopPropagation?u.stopPropagation():typeof u.cancelBubble!="unknown"&&(u.cancelBubble=!0),this.isPropagationStopped=Si)},persist:function(){},isPersistent:Si}),l}var ii={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(o){return o.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},el=Wn(ii),ki=ne({},ii,{view:0,detail:0}),om=Wn(ki),tl,Yi,Ls,Go=ne({},ki,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ti,button:0,buttons:0,relatedTarget:function(o){return o.relatedTarget===void 0?o.fromElement===o.srcElement?o.toElement:o.fromElement:o.relatedTarget},movementX:function(o){return"movementX"in o?o.movementX:(o!==Ls&&(Ls&&o.type==="mousemove"?(tl=o.screenX-Ls.screenX,Yi=o.screenY-Ls.screenY):Yi=tl=0,Ls=o),tl)},movementY:function(o){return"movementY"in o?o.movementY:Yi}}),nl=Wn(Go),Gc=ne({},Go,{dataTransfer:0}),Zd=Wn(Gc),rl=ne({},ki,{relatedTarget:0}),il=Wn(rl),eh=ne({},ii,{animationName:0,elapsedTime:0,pseudoElement:0}),Xi=Wn(eh),th=ne({},ii,{clipboardData:function(o){return"clipboardData"in o?o.clipboardData:window.clipboardData}}),nh=Wn(th),rh=ne({},ii,{data:0}),Kc=Wn(rh),sl={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},sr={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ih={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function sh(o){var l=this.nativeEvent;return l.getModifierState?l.getModifierState(o):(o=ih[o])?!!l[o]:!1}function Ti(){return sh}var p=ne({},ki,{key:function(o){if(o.key){var l=sl[o.key]||o.key;if(l!=="Unidentified")return l}return o.type==="keypress"?(o=Za(o),o===13?"Enter":String.fromCharCode(o)):o.type==="keydown"||o.type==="keyup"?sr[o.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ti,charCode:function(o){return o.type==="keypress"?Za(o):0},keyCode:function(o){return o.type==="keydown"||o.type==="keyup"?o.keyCode:0},which:function(o){return o.type==="keypress"?Za(o):o.type==="keydown"||o.type==="keyup"?o.keyCode:0}}),b=Wn(p),k=ne({},Go,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),B=Wn(k),ce=ne({},ki,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ti}),ye=Wn(ce),Pe=ne({},ii,{propertyName:0,elapsedTime:0,pseudoElement:0}),Rt=Wn(Pe),vn=ne({},Go,{deltaX:function(o){return"deltaX"in o?o.deltaX:"wheelDeltaX"in o?-o.wheelDeltaX:0},deltaY:function(o){return"deltaY"in o?o.deltaY:"wheelDeltaY"in o?-o.wheelDeltaY:"wheelDelta"in o?-o.wheelDelta:0},deltaZ:0,deltaMode:0}),St=Wn(vn),Cn=[9,13,27,32],gn=d&&"CompositionEvent"in window,qr=null;d&&"documentMode"in document&&(qr=document.documentMode);var Pr=d&&"TextEvent"in window&&!qr,Ko=d&&(!gn||qr&&8<qr&&11>=qr),ol=" ",M0=!1;function L0(o,l){switch(o){case"keyup":return Cn.indexOf(l.keyCode)!==-1;case"keydown":return l.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function O0(o){return o=o.detail,typeof o=="object"&&"data"in o?o.data:null}var al=!1;function AI(o,l){switch(o){case"compositionend":return O0(l);case"keypress":return l.which!==32?null:(M0=!0,ol);case"textInput":return o=l.data,o===ol&&M0?null:o;default:return null}}function PI(o,l){if(al)return o==="compositionend"||!gn&&L0(o,l)?(o=Hc(),hr=Ja=Ar=null,al=!1,o):null;switch(o){case"paste":return null;case"keypress":if(!(l.ctrlKey||l.altKey||l.metaKey)||l.ctrlKey&&l.altKey){if(l.char&&1<l.char.length)return l.char;if(l.which)return String.fromCharCode(l.which)}return null;case"compositionend":return Ko&&l.locale!=="ko"?null:l.data;default:return null}}var BI={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function V0(o){var l=o&&o.nodeName&&o.nodeName.toLowerCase();return l==="input"?!!BI[o.type]:l==="textarea"}function W0(o,l,u,f){Er(f),l=uh(l,"onChange"),0<l.length&&(u=new el("onChange","change",null,u,f),o.push({event:u,listeners:l}))}var Qc=null,Yc=null;function FI(o){ob(o,0)}function oh(o){var l=hl(o);if(De(l))return o}function NI(o,l){if(o==="change")return l}var U0=!1;if(d){var am;if(d){var lm="oninput"in document;if(!lm){var q0=document.createElement("div");q0.setAttribute("oninput","return;"),lm=typeof q0.oninput=="function"}am=lm}else am=!1;U0=am&&(!document.documentMode||9<document.documentMode)}function H0(){Qc&&(Qc.detachEvent("onpropertychange",$0),Yc=Qc=null)}function $0(o){if(o.propertyName==="value"&&oh(Yc)){var l=[];W0(l,Yc,o,zt(o)),Rs(FI,l)}}function zI(o,l,u){o==="focusin"?(H0(),Qc=l,Yc=u,Qc.attachEvent("onpropertychange",$0)):o==="focusout"&&H0()}function DI(o){if(o==="selectionchange"||o==="keyup"||o==="keydown")return oh(Yc)}function MI(o,l){if(o==="click")return oh(l)}function LI(o,l){if(o==="input"||o==="change")return oh(l)}function OI(o,l){return o===l&&(o!==0||1/o===1/l)||o!==o&&l!==l}var si=typeof Object.is=="function"?Object.is:OI;function Xc(o,l){if(si(o,l))return!0;if(typeof o!="object"||o===null||typeof l!="object"||l===null)return!1;var u=Object.keys(o),f=Object.keys(l);if(u.length!==f.length)return!1;for(f=0;f<u.length;f++){var y=u[f];if(!h.call(l,y)||!si(o[y],l[y]))return!1}return!0}function G0(o){for(;o&&o.firstChild;)o=o.firstChild;return o}function K0(o,l){var u=G0(o);o=0;for(var f;u;){if(u.nodeType===3){if(f=o+u.textContent.length,o<=l&&f>=l)return{node:u,offset:l-o};o=f}e:{for(;u;){if(u.nextSibling){u=u.nextSibling;break e}u=u.parentNode}u=void 0}u=G0(u)}}function Q0(o,l){return o&&l?o===l?!0:o&&o.nodeType===3?!1:l&&l.nodeType===3?Q0(o,l.parentNode):"contains"in o?o.contains(l):o.compareDocumentPosition?!!(o.compareDocumentPosition(l)&16):!1:!1}function Y0(){for(var o=window,l=tt();l instanceof o.HTMLIFrameElement;){try{var u=typeof l.contentWindow.location.href=="string"}catch{u=!1}if(u)o=l.contentWindow;else break;l=tt(o.document)}return l}function cm(o){var l=o&&o.nodeName&&o.nodeName.toLowerCase();return l&&(l==="input"&&(o.type==="text"||o.type==="search"||o.type==="tel"||o.type==="url"||o.type==="password")||l==="textarea"||o.contentEditable==="true")}function VI(o){var l=Y0(),u=o.focusedElem,f=o.selectionRange;if(l!==u&&u&&u.ownerDocument&&Q0(u.ownerDocument.documentElement,u)){if(f!==null&&cm(u)){if(l=f.start,o=f.end,o===void 0&&(o=l),"selectionStart"in u)u.selectionStart=l,u.selectionEnd=Math.min(o,u.value.length);else if(o=(l=u.ownerDocument||document)&&l.defaultView||window,o.getSelection){o=o.getSelection();var y=u.textContent.length,v=Math.min(f.start,y);f=f.end===void 0?v:Math.min(f.end,y),!o.extend&&v>f&&(y=f,f=v,v=y),y=K0(u,v);var C=K0(u,f);y&&C&&(o.rangeCount!==1||o.anchorNode!==y.node||o.anchorOffset!==y.offset||o.focusNode!==C.node||o.focusOffset!==C.offset)&&(l=l.createRange(),l.setStart(y.node,y.offset),o.removeAllRanges(),v>f?(o.addRange(l),o.extend(C.node,C.offset)):(l.setEnd(C.node,C.offset),o.addRange(l)))}}for(l=[],o=u;o=o.parentNode;)o.nodeType===1&&l.push({element:o,left:o.scrollLeft,top:o.scrollTop});for(typeof u.focus=="function"&&u.focus(),u=0;u<l.length;u++)o=l[u],o.element.scrollLeft=o.left,o.element.scrollTop=o.top}}var WI=d&&"documentMode"in document&&11>=document.documentMode,ll=null,um=null,Jc=null,dm=!1;function X0(o,l,u){var f=u.window===u?u.document:u.nodeType===9?u:u.ownerDocument;dm||ll==null||ll!==tt(f)||(f=ll,"selectionStart"in f&&cm(f)?f={start:f.selectionStart,end:f.selectionEnd}:(f=(f.ownerDocument&&f.ownerDocument.defaultView||window).getSelection(),f={anchorNode:f.anchorNode,anchorOffset:f.anchorOffset,focusNode:f.focusNode,focusOffset:f.focusOffset}),Jc&&Xc(Jc,f)||(Jc=f,f=uh(um,"onSelect"),0<f.length&&(l=new el("onSelect","select",null,l,u),o.push({event:l,listeners:f}),l.target=ll)))}function ah(o,l){var u={};return u[o.toLowerCase()]=l.toLowerCase(),u["Webkit"+o]="webkit"+l,u["Moz"+o]="moz"+l,u}var cl={animationend:ah("Animation","AnimationEnd"),animationiteration:ah("Animation","AnimationIteration"),animationstart:ah("Animation","AnimationStart"),transitionend:ah("Transition","TransitionEnd")},hm={},J0={};d&&(J0=document.createElement("div").style,"AnimationEvent"in window||(delete cl.animationend.animation,delete cl.animationiteration.animation,delete cl.animationstart.animation),"TransitionEvent"in window||delete cl.transitionend.transition);function lh(o){if(hm[o])return hm[o];if(!cl[o])return o;var l=cl[o],u;for(u in l)if(l.hasOwnProperty(u)&&u in J0)return hm[o]=l[u];return o}var Z0=lh("animationend"),eb=lh("animationiteration"),tb=lh("animationstart"),nb=lh("transitionend"),rb=new Map,ib="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Os(o,l){rb.set(o,l),a(l,[o])}for(var pm=0;pm<ib.length;pm++){var fm=ib[pm],UI=fm.toLowerCase(),qI=fm[0].toUpperCase()+fm.slice(1);Os(UI,"on"+qI)}Os(Z0,"onAnimationEnd"),Os(eb,"onAnimationIteration"),Os(tb,"onAnimationStart"),Os("dblclick","onDoubleClick"),Os("focusin","onFocus"),Os("focusout","onBlur"),Os(nb,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),a("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),a("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),a("onBeforeInput",["compositionend","keypress","textInput","paste"]),a("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Zc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),HI=new Set("cancel close invalid load scroll toggle".split(" ").concat(Zc));function sb(o,l,u){var f=o.type||"unknown-event";o.currentTarget=u,Md(f,l,void 0,o),o.currentTarget=null}function ob(o,l){l=(l&4)!==0;for(var u=0;u<o.length;u++){var f=o[u],y=f.event;f=f.listeners;e:{var v=void 0;if(l)for(var C=f.length-1;0<=C;C--){var q=f[C],Q=q.instance,fe=q.currentTarget;if(q=q.listener,Q!==v&&y.isPropagationStopped())break e;sb(y,q,fe),v=Q}else for(C=0;C<f.length;C++){if(q=f[C],Q=q.instance,fe=q.currentTarget,q=q.listener,Q!==v&&y.isPropagationStopped())break e;sb(y,q,fe),v=Q}}}if(rr)throw o=$i,rr=!1,$i=null,o}function Kt(o,l){var u=l[Sm];u===void 0&&(u=l[Sm]=new Set);var f=o+"__bubble";u.has(f)||(ab(l,o,2,!1),u.add(f))}function mm(o,l,u){var f=0;l&&(f|=4),ab(u,o,f,l)}var ch="_reactListening"+Math.random().toString(36).slice(2);function eu(o){if(!o[ch]){o[ch]=!0,r.forEach(function(u){u!=="selectionchange"&&(HI.has(u)||mm(u,!1,o),mm(u,!0,o))});var l=o.nodeType===9?o:o.ownerDocument;l===null||l[ch]||(l[ch]=!0,mm("selectionchange",!1,l))}}function ab(o,l,u,f){switch(qc(l)){case 1:var y=en;break;case 4:y=sm;break;default:y=Uc}u=y.bind(null,l,u,o),y=void 0,!Hi||l!=="touchstart"&&l!=="touchmove"&&l!=="wheel"||(y=!0),f?y!==void 0?o.addEventListener(l,u,{capture:!0,passive:y}):o.addEventListener(l,u,!0):y!==void 0?o.addEventListener(l,u,{passive:y}):o.addEventListener(l,u,!1)}function gm(o,l,u,f,y){var v=f;if((l&1)===0&&(l&2)===0&&f!==null)e:for(;;){if(f===null)return;var C=f.tag;if(C===3||C===4){var q=f.stateNode.containerInfo;if(q===y||q.nodeType===8&&q.parentNode===y)break;if(C===4)for(C=f.return;C!==null;){var Q=C.tag;if((Q===3||Q===4)&&(Q=C.stateNode.containerInfo,Q===y||Q.nodeType===8&&Q.parentNode===y))return;C=C.return}for(;q!==null;){if(C=Qo(q),C===null)return;if(Q=C.tag,Q===5||Q===6){f=v=C;continue e}q=q.parentNode}}f=f.return}Rs(function(){var fe=v,Ie=zt(u),Ee=[];e:{var je=rb.get(o);if(je!==void 0){var Ve=el,qe=o;switch(o){case"keypress":if(Za(u)===0)break e;case"keydown":case"keyup":Ve=b;break;case"focusin":qe="focus",Ve=il;break;case"focusout":qe="blur",Ve=il;break;case"beforeblur":case"afterblur":Ve=il;break;case"click":if(u.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Ve=nl;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Ve=Zd;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Ve=ye;break;case Z0:case eb:case tb:Ve=Xi;break;case nb:Ve=Rt;break;case"scroll":Ve=om;break;case"wheel":Ve=St;break;case"copy":case"cut":case"paste":Ve=nh;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Ve=B}var Ge=(l&4)!==0,hn=!Ge&&o==="scroll",ue=Ge?je!==null?je+"Capture":null:je;Ge=[];for(var te=fe,de;te!==null;){de=te;var Ae=de.stateNode;if(de.tag===5&&Ae!==null&&(de=Ae,ue!==null&&(Ae=Zt(te,ue),Ae!=null&&Ge.push(tu(te,Ae,de)))),hn)break;te=te.return}0<Ge.length&&(je=new Ve(je,qe,null,u,Ie),Ee.push({event:je,listeners:Ge}))}}if((l&7)===0){e:{if(je=o==="mouseover"||o==="pointerover",Ve=o==="mouseout"||o==="pointerout",je&&u!==ct&&(qe=u.relatedTarget||u.fromElement)&&(Qo(qe)||qe[Ji]))break e;if((Ve||je)&&(je=Ie.window===Ie?Ie:(je=Ie.ownerDocument)?je.defaultView||je.parentWindow:window,Ve?(qe=u.relatedTarget||u.toElement,Ve=fe,qe=qe?Qo(qe):null,qe!==null&&(hn=Jr(qe),qe!==hn||qe.tag!==5&&qe.tag!==6)&&(qe=null)):(Ve=null,qe=fe),Ve!==qe)){if(Ge=nl,Ae="onMouseLeave",ue="onMouseEnter",te="mouse",(o==="pointerout"||o==="pointerover")&&(Ge=B,Ae="onPointerLeave",ue="onPointerEnter",te="pointer"),hn=Ve==null?je:hl(Ve),de=qe==null?je:hl(qe),je=new Ge(Ae,te+"leave",Ve,u,Ie),je.target=hn,je.relatedTarget=de,Ae=null,Qo(Ie)===fe&&(Ge=new Ge(ue,te+"enter",qe,u,Ie),Ge.target=de,Ge.relatedTarget=hn,Ae=Ge),hn=Ae,Ve&&qe)t:{for(Ge=Ve,ue=qe,te=0,de=Ge;de;de=ul(de))te++;for(de=0,Ae=ue;Ae;Ae=ul(Ae))de++;for(;0<te-de;)Ge=ul(Ge),te--;for(;0<de-te;)ue=ul(ue),de--;for(;te--;){if(Ge===ue||ue!==null&&Ge===ue.alternate)break t;Ge=ul(Ge),ue=ul(ue)}Ge=null}else Ge=null;Ve!==null&&lb(Ee,je,Ve,Ge,!1),qe!==null&&hn!==null&&lb(Ee,hn,qe,Ge,!0)}}e:{if(je=fe?hl(fe):window,Ve=je.nodeName&&je.nodeName.toLowerCase(),Ve==="select"||Ve==="input"&&je.type==="file")var Qe=NI;else if(V0(je))if(U0)Qe=LI;else{Qe=DI;var rt=zI}else(Ve=je.nodeName)&&Ve.toLowerCase()==="input"&&(je.type==="checkbox"||je.type==="radio")&&(Qe=MI);if(Qe&&(Qe=Qe(o,fe))){W0(Ee,Qe,u,Ie);break e}rt&&rt(o,je,fe),o==="focusout"&&(rt=je._wrapperState)&&rt.controlled&&je.type==="number"&&Re(je,"number",je.value)}switch(rt=fe?hl(fe):window,o){case"focusin":(V0(rt)||rt.contentEditable==="true")&&(ll=rt,um=fe,Jc=null);break;case"focusout":Jc=um=ll=null;break;case"mousedown":dm=!0;break;case"contextmenu":case"mouseup":case"dragend":dm=!1,X0(Ee,u,Ie);break;case"selectionchange":if(WI)break;case"keydown":case"keyup":X0(Ee,u,Ie)}var it;if(gn)e:{switch(o){case"compositionstart":var lt="onCompositionStart";break e;case"compositionend":lt="onCompositionEnd";break e;case"compositionupdate":lt="onCompositionUpdate";break e}lt=void 0}else al?L0(o,u)&&(lt="onCompositionEnd"):o==="keydown"&&u.keyCode===229&&(lt="onCompositionStart");lt&&(Ko&&u.locale!=="ko"&&(al||lt!=="onCompositionStart"?lt==="onCompositionEnd"&&al&&(it=Hc()):(Ar=Ie,Ja="value"in Ar?Ar.value:Ar.textContent,al=!0)),rt=uh(fe,lt),0<rt.length&&(lt=new Kc(lt,o,null,u,Ie),Ee.push({event:lt,listeners:rt}),it?lt.data=it:(it=O0(u),it!==null&&(lt.data=it)))),(it=Pr?AI(o,u):PI(o,u))&&(fe=uh(fe,"onBeforeInput"),0<fe.length&&(Ie=new Kc("onBeforeInput","beforeinput",null,u,Ie),Ee.push({event:Ie,listeners:fe}),Ie.data=it))}ob(Ee,l)})}function tu(o,l,u){return{instance:o,listener:l,currentTarget:u}}function uh(o,l){for(var u=l+"Capture",f=[];o!==null;){var y=o,v=y.stateNode;y.tag===5&&v!==null&&(y=v,v=Zt(o,u),v!=null&&f.unshift(tu(o,v,y)),v=Zt(o,l),v!=null&&f.push(tu(o,v,y))),o=o.return}return f}function ul(o){if(o===null)return null;do o=o.return;while(o&&o.tag!==5);return o||null}function lb(o,l,u,f,y){for(var v=l._reactName,C=[];u!==null&&u!==f;){var q=u,Q=q.alternate,fe=q.stateNode;if(Q!==null&&Q===f)break;q.tag===5&&fe!==null&&(q=fe,y?(Q=Zt(u,v),Q!=null&&C.unshift(tu(u,Q,q))):y||(Q=Zt(u,v),Q!=null&&C.push(tu(u,Q,q)))),u=u.return}C.length!==0&&o.push({event:l,listeners:C})}var $I=/\r\n?/g,GI=/\u0000|\uFFFD/g;function cb(o){return(typeof o=="string"?o:""+o).replace($I,`
`).replace(GI,"")}function dh(o,l,u){if(l=cb(l),cb(o)!==l&&u)throw Error(t(425))}function hh(){}var ym=null,xm=null;function bm(o,l){return o==="textarea"||o==="noscript"||typeof l.children=="string"||typeof l.children=="number"||typeof l.dangerouslySetInnerHTML=="object"&&l.dangerouslySetInnerHTML!==null&&l.dangerouslySetInnerHTML.__html!=null}var vm=typeof setTimeout=="function"?setTimeout:void 0,KI=typeof clearTimeout=="function"?clearTimeout:void 0,ub=typeof Promise=="function"?Promise:void 0,QI=typeof queueMicrotask=="function"?queueMicrotask:typeof ub<"u"?function(o){return ub.resolve(null).then(o).catch(YI)}:vm;function YI(o){setTimeout(function(){throw o})}function wm(o,l){var u=l,f=0;do{var y=u.nextSibling;if(o.removeChild(u),y&&y.nodeType===8)if(u=y.data,u==="/$"){if(f===0){o.removeChild(y),ri(l);return}f--}else u!=="$"&&u!=="$?"&&u!=="$!"||f++;u=y}while(u);ri(l)}function Vs(o){for(;o!=null;o=o.nextSibling){var l=o.nodeType;if(l===1||l===3)break;if(l===8){if(l=o.data,l==="$"||l==="$!"||l==="$?")break;if(l==="/$")return null}}return o}function db(o){o=o.previousSibling;for(var l=0;o;){if(o.nodeType===8){var u=o.data;if(u==="$"||u==="$!"||u==="$?"){if(l===0)return o;l--}else u==="/$"&&l++}o=o.previousSibling}return null}var dl=Math.random().toString(36).slice(2),_i="__reactFiber$"+dl,nu="__reactProps$"+dl,Ji="__reactContainer$"+dl,Sm="__reactEvents$"+dl,XI="__reactListeners$"+dl,JI="__reactHandles$"+dl;function Qo(o){var l=o[_i];if(l)return l;for(var u=o.parentNode;u;){if(l=u[Ji]||u[_i]){if(u=l.alternate,l.child!==null||u!==null&&u.child!==null)for(o=db(o);o!==null;){if(u=o[_i])return u;o=db(o)}return l}o=u,u=o.parentNode}return null}function ru(o){return o=o[_i]||o[Ji],!o||o.tag!==5&&o.tag!==6&&o.tag!==13&&o.tag!==3?null:o}function hl(o){if(o.tag===5||o.tag===6)return o.stateNode;throw Error(t(33))}function ph(o){return o[nu]||null}var km=[],pl=-1;function Ws(o){return{current:o}}function Qt(o){0>pl||(o.current=km[pl],km[pl]=null,pl--)}function qt(o,l){pl++,km[pl]=o.current,o.current=l}var Us={},Kn=Ws(Us),pr=Ws(!1),Yo=Us;function fl(o,l){var u=o.type.contextTypes;if(!u)return Us;var f=o.stateNode;if(f&&f.__reactInternalMemoizedUnmaskedChildContext===l)return f.__reactInternalMemoizedMaskedChildContext;var y={},v;for(v in u)y[v]=l[v];return f&&(o=o.stateNode,o.__reactInternalMemoizedUnmaskedChildContext=l,o.__reactInternalMemoizedMaskedChildContext=y),y}function fr(o){return o=o.childContextTypes,o!=null}function fh(){Qt(pr),Qt(Kn)}function hb(o,l,u){if(Kn.current!==Us)throw Error(t(168));qt(Kn,l),qt(pr,u)}function pb(o,l,u){var f=o.stateNode;if(l=l.childContextTypes,typeof f.getChildContext!="function")return u;f=f.getChildContext();for(var y in f)if(!(y in l))throw Error(t(108,Le(o)||"Unknown",y));return ne({},u,f)}function mh(o){return o=(o=o.stateNode)&&o.__reactInternalMemoizedMergedChildContext||Us,Yo=Kn.current,qt(Kn,o),qt(pr,pr.current),!0}function fb(o,l,u){var f=o.stateNode;if(!f)throw Error(t(169));u?(o=pb(o,l,Yo),f.__reactInternalMemoizedMergedChildContext=o,Qt(pr),Qt(Kn),qt(Kn,o)):Qt(pr),qt(pr,u)}var Zi=null,gh=!1,Tm=!1;function mb(o){Zi===null?Zi=[o]:Zi.push(o)}function ZI(o){gh=!0,mb(o)}function qs(){if(!Tm&&Zi!==null){Tm=!0;var o=0,l=vt;try{var u=Zi;for(vt=1;o<u.length;o++){var f=u[o];do f=f(!0);while(f!==null)}Zi=null,gh=!1}catch(y){throw Zi!==null&&(Zi=Zi.slice(o+1)),Ga(Vo,qs),y}finally{vt=l,Tm=!1}}return null}var ml=[],gl=0,yh=null,xh=0,Hr=[],$r=0,Xo=null,es=1,ts="";function Jo(o,l){ml[gl++]=xh,ml[gl++]=yh,yh=o,xh=l}function gb(o,l,u){Hr[$r++]=es,Hr[$r++]=ts,Hr[$r++]=Xo,Xo=o;var f=es;o=ts;var y=32-ir(f)-1;f&=~(1<<y),u+=1;var v=32-ir(l)+y;if(30<v){var C=y-y%5;v=(f&(1<<C)-1).toString(32),f>>=C,y-=C,es=1<<32-ir(l)+y|u<<y|f,ts=v+o}else es=1<<v|u<<y|f,ts=o}function _m(o){o.return!==null&&(Jo(o,1),gb(o,1,0))}function jm(o){for(;o===yh;)yh=ml[--gl],ml[gl]=null,xh=ml[--gl],ml[gl]=null;for(;o===Xo;)Xo=Hr[--$r],Hr[$r]=null,ts=Hr[--$r],Hr[$r]=null,es=Hr[--$r],Hr[$r]=null}var Br=null,Fr=null,tn=!1,oi=null;function yb(o,l){var u=Yr(5,null,null,0);u.elementType="DELETED",u.stateNode=l,u.return=o,l=o.deletions,l===null?(o.deletions=[u],o.flags|=16):l.push(u)}function xb(o,l){switch(o.tag){case 5:var u=o.type;return l=l.nodeType!==1||u.toLowerCase()!==l.nodeName.toLowerCase()?null:l,l!==null?(o.stateNode=l,Br=o,Fr=Vs(l.firstChild),!0):!1;case 6:return l=o.pendingProps===""||l.nodeType!==3?null:l,l!==null?(o.stateNode=l,Br=o,Fr=null,!0):!1;case 13:return l=l.nodeType!==8?null:l,l!==null?(u=Xo!==null?{id:es,overflow:ts}:null,o.memoizedState={dehydrated:l,treeContext:u,retryLane:1073741824},u=Yr(18,null,null,0),u.stateNode=l,u.return=o,o.child=u,Br=o,Fr=null,!0):!1;default:return!1}}function Im(o){return(o.mode&1)!==0&&(o.flags&128)===0}function Em(o){if(tn){var l=Fr;if(l){var u=l;if(!xb(o,l)){if(Im(o))throw Error(t(418));l=Vs(u.nextSibling);var f=Br;l&&xb(o,l)?yb(f,u):(o.flags=o.flags&-4097|2,tn=!1,Br=o)}}else{if(Im(o))throw Error(t(418));o.flags=o.flags&-4097|2,tn=!1,Br=o}}}function bb(o){for(o=o.return;o!==null&&o.tag!==5&&o.tag!==3&&o.tag!==13;)o=o.return;Br=o}function bh(o){if(o!==Br)return!1;if(!tn)return bb(o),tn=!0,!1;var l;if((l=o.tag!==3)&&!(l=o.tag!==5)&&(l=o.type,l=l!=="head"&&l!=="body"&&!bm(o.type,o.memoizedProps)),l&&(l=Fr)){if(Im(o))throw vb(),Error(t(418));for(;l;)yb(o,l),l=Vs(l.nextSibling)}if(bb(o),o.tag===13){if(o=o.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(t(317));e:{for(o=o.nextSibling,l=0;o;){if(o.nodeType===8){var u=o.data;if(u==="/$"){if(l===0){Fr=Vs(o.nextSibling);break e}l--}else u!=="$"&&u!=="$!"&&u!=="$?"||l++}o=o.nextSibling}Fr=null}}else Fr=Br?Vs(o.stateNode.nextSibling):null;return!0}function vb(){for(var o=Fr;o;)o=Vs(o.nextSibling)}function yl(){Fr=Br=null,tn=!1}function Cm(o){oi===null?oi=[o]:oi.push(o)}var eE=X.ReactCurrentBatchConfig;function iu(o,l,u){if(o=u.ref,o!==null&&typeof o!="function"&&typeof o!="object"){if(u._owner){if(u=u._owner,u){if(u.tag!==1)throw Error(t(309));var f=u.stateNode}if(!f)throw Error(t(147,o));var y=f,v=""+o;return l!==null&&l.ref!==null&&typeof l.ref=="function"&&l.ref._stringRef===v?l.ref:(l=function(C){var q=y.refs;C===null?delete q[v]:q[v]=C},l._stringRef=v,l)}if(typeof o!="string")throw Error(t(284));if(!u._owner)throw Error(t(290,o))}return o}function vh(o,l){throw o=Object.prototype.toString.call(l),Error(t(31,o==="[object Object]"?"object with keys {"+Object.keys(l).join(", ")+"}":o))}function wb(o){var l=o._init;return l(o._payload)}function Sb(o){function l(ue,te){if(o){var de=ue.deletions;de===null?(ue.deletions=[te],ue.flags|=16):de.push(te)}}function u(ue,te){if(!o)return null;for(;te!==null;)l(ue,te),te=te.sibling;return null}function f(ue,te){for(ue=new Map;te!==null;)te.key!==null?ue.set(te.key,te):ue.set(te.index,te),te=te.sibling;return ue}function y(ue,te){return ue=Js(ue,te),ue.index=0,ue.sibling=null,ue}function v(ue,te,de){return ue.index=de,o?(de=ue.alternate,de!==null?(de=de.index,de<te?(ue.flags|=2,te):de):(ue.flags|=2,te)):(ue.flags|=1048576,te)}function C(ue){return o&&ue.alternate===null&&(ue.flags|=2),ue}function q(ue,te,de,Ae){return te===null||te.tag!==6?(te=vg(de,ue.mode,Ae),te.return=ue,te):(te=y(te,de),te.return=ue,te)}function Q(ue,te,de,Ae){var Qe=de.type;return Qe===N?Ie(ue,te,de.props.children,Ae,de.key):te!==null&&(te.elementType===Qe||typeof Qe=="object"&&Qe!==null&&Qe.$$typeof===Y&&wb(Qe)===te.type)?(Ae=y(te,de.props),Ae.ref=iu(ue,te,de),Ae.return=ue,Ae):(Ae=qh(de.type,de.key,de.props,null,ue.mode,Ae),Ae.ref=iu(ue,te,de),Ae.return=ue,Ae)}function fe(ue,te,de,Ae){return te===null||te.tag!==4||te.stateNode.containerInfo!==de.containerInfo||te.stateNode.implementation!==de.implementation?(te=wg(de,ue.mode,Ae),te.return=ue,te):(te=y(te,de.children||[]),te.return=ue,te)}function Ie(ue,te,de,Ae,Qe){return te===null||te.tag!==7?(te=oa(de,ue.mode,Ae,Qe),te.return=ue,te):(te=y(te,de),te.return=ue,te)}function Ee(ue,te,de){if(typeof te=="string"&&te!==""||typeof te=="number")return te=vg(""+te,ue.mode,de),te.return=ue,te;if(typeof te=="object"&&te!==null){switch(te.$$typeof){case ie:return de=qh(te.type,te.key,te.props,null,ue.mode,de),de.ref=iu(ue,null,te),de.return=ue,de;case G:return te=wg(te,ue.mode,de),te.return=ue,te;case Y:var Ae=te._init;return Ee(ue,Ae(te._payload),de)}if(Ce(te)||re(te))return te=oa(te,ue.mode,de,null),te.return=ue,te;vh(ue,te)}return null}function je(ue,te,de,Ae){var Qe=te!==null?te.key:null;if(typeof de=="string"&&de!==""||typeof de=="number")return Qe!==null?null:q(ue,te,""+de,Ae);if(typeof de=="object"&&de!==null){switch(de.$$typeof){case ie:return de.key===Qe?Q(ue,te,de,Ae):null;case G:return de.key===Qe?fe(ue,te,de,Ae):null;case Y:return Qe=de._init,je(ue,te,Qe(de._payload),Ae)}if(Ce(de)||re(de))return Qe!==null?null:Ie(ue,te,de,Ae,null);vh(ue,de)}return null}function Ve(ue,te,de,Ae,Qe){if(typeof Ae=="string"&&Ae!==""||typeof Ae=="number")return ue=ue.get(de)||null,q(te,ue,""+Ae,Qe);if(typeof Ae=="object"&&Ae!==null){switch(Ae.$$typeof){case ie:return ue=ue.get(Ae.key===null?de:Ae.key)||null,Q(te,ue,Ae,Qe);case G:return ue=ue.get(Ae.key===null?de:Ae.key)||null,fe(te,ue,Ae,Qe);case Y:var rt=Ae._init;return Ve(ue,te,de,rt(Ae._payload),Qe)}if(Ce(Ae)||re(Ae))return ue=ue.get(de)||null,Ie(te,ue,Ae,Qe,null);vh(te,Ae)}return null}function qe(ue,te,de,Ae){for(var Qe=null,rt=null,it=te,lt=te=0,Pn=null;it!==null&&lt<de.length;lt++){it.index>lt?(Pn=it,it=null):Pn=it.sibling;var jt=je(ue,it,de[lt],Ae);if(jt===null){it===null&&(it=Pn);break}o&&it&&jt.alternate===null&&l(ue,it),te=v(jt,te,lt),rt===null?Qe=jt:rt.sibling=jt,rt=jt,it=Pn}if(lt===de.length)return u(ue,it),tn&&Jo(ue,lt),Qe;if(it===null){for(;lt<de.length;lt++)it=Ee(ue,de[lt],Ae),it!==null&&(te=v(it,te,lt),rt===null?Qe=it:rt.sibling=it,rt=it);return tn&&Jo(ue,lt),Qe}for(it=f(ue,it);lt<de.length;lt++)Pn=Ve(it,ue,lt,de[lt],Ae),Pn!==null&&(o&&Pn.alternate!==null&&it.delete(Pn.key===null?lt:Pn.key),te=v(Pn,te,lt),rt===null?Qe=Pn:rt.sibling=Pn,rt=Pn);return o&&it.forEach(function(Zs){return l(ue,Zs)}),tn&&Jo(ue,lt),Qe}function Ge(ue,te,de,Ae){var Qe=re(de);if(typeof Qe!="function")throw Error(t(150));if(de=Qe.call(de),de==null)throw Error(t(151));for(var rt=Qe=null,it=te,lt=te=0,Pn=null,jt=de.next();it!==null&&!jt.done;lt++,jt=de.next()){it.index>lt?(Pn=it,it=null):Pn=it.sibling;var Zs=je(ue,it,jt.value,Ae);if(Zs===null){it===null&&(it=Pn);break}o&&it&&Zs.alternate===null&&l(ue,it),te=v(Zs,te,lt),rt===null?Qe=Zs:rt.sibling=Zs,rt=Zs,it=Pn}if(jt.done)return u(ue,it),tn&&Jo(ue,lt),Qe;if(it===null){for(;!jt.done;lt++,jt=de.next())jt=Ee(ue,jt.value,Ae),jt!==null&&(te=v(jt,te,lt),rt===null?Qe=jt:rt.sibling=jt,rt=jt);return tn&&Jo(ue,lt),Qe}for(it=f(ue,it);!jt.done;lt++,jt=de.next())jt=Ve(it,ue,lt,jt.value,Ae),jt!==null&&(o&&jt.alternate!==null&&it.delete(jt.key===null?lt:jt.key),te=v(jt,te,lt),rt===null?Qe=jt:rt.sibling=jt,rt=jt);return o&&it.forEach(function(BE){return l(ue,BE)}),tn&&Jo(ue,lt),Qe}function hn(ue,te,de,Ae){if(typeof de=="object"&&de!==null&&de.type===N&&de.key===null&&(de=de.props.children),typeof de=="object"&&de!==null){switch(de.$$typeof){case ie:e:{for(var Qe=de.key,rt=te;rt!==null;){if(rt.key===Qe){if(Qe=de.type,Qe===N){if(rt.tag===7){u(ue,rt.sibling),te=y(rt,de.props.children),te.return=ue,ue=te;break e}}else if(rt.elementType===Qe||typeof Qe=="object"&&Qe!==null&&Qe.$$typeof===Y&&wb(Qe)===rt.type){u(ue,rt.sibling),te=y(rt,de.props),te.ref=iu(ue,rt,de),te.return=ue,ue=te;break e}u(ue,rt);break}else l(ue,rt);rt=rt.sibling}de.type===N?(te=oa(de.props.children,ue.mode,Ae,de.key),te.return=ue,ue=te):(Ae=qh(de.type,de.key,de.props,null,ue.mode,Ae),Ae.ref=iu(ue,te,de),Ae.return=ue,ue=Ae)}return C(ue);case G:e:{for(rt=de.key;te!==null;){if(te.key===rt)if(te.tag===4&&te.stateNode.containerInfo===de.containerInfo&&te.stateNode.implementation===de.implementation){u(ue,te.sibling),te=y(te,de.children||[]),te.return=ue,ue=te;break e}else{u(ue,te);break}else l(ue,te);te=te.sibling}te=wg(de,ue.mode,Ae),te.return=ue,ue=te}return C(ue);case Y:return rt=de._init,hn(ue,te,rt(de._payload),Ae)}if(Ce(de))return qe(ue,te,de,Ae);if(re(de))return Ge(ue,te,de,Ae);vh(ue,de)}return typeof de=="string"&&de!==""||typeof de=="number"?(de=""+de,te!==null&&te.tag===6?(u(ue,te.sibling),te=y(te,de),te.return=ue,ue=te):(u(ue,te),te=vg(de,ue.mode,Ae),te.return=ue,ue=te),C(ue)):u(ue,te)}return hn}var xl=Sb(!0),kb=Sb(!1),wh=Ws(null),Sh=null,bl=null,Rm=null;function Am(){Rm=bl=Sh=null}function Pm(o){var l=wh.current;Qt(wh),o._currentValue=l}function Bm(o,l,u){for(;o!==null;){var f=o.alternate;if((o.childLanes&l)!==l?(o.childLanes|=l,f!==null&&(f.childLanes|=l)):f!==null&&(f.childLanes&l)!==l&&(f.childLanes|=l),o===u)break;o=o.return}}function vl(o,l){Sh=o,Rm=bl=null,o=o.dependencies,o!==null&&o.firstContext!==null&&((o.lanes&l)!==0&&(mr=!0),o.firstContext=null)}function Gr(o){var l=o._currentValue;if(Rm!==o)if(o={context:o,memoizedValue:l,next:null},bl===null){if(Sh===null)throw Error(t(308));bl=o,Sh.dependencies={lanes:0,firstContext:o}}else bl=bl.next=o;return l}var Zo=null;function Fm(o){Zo===null?Zo=[o]:Zo.push(o)}function Tb(o,l,u,f){var y=l.interleaved;return y===null?(u.next=u,Fm(l)):(u.next=y.next,y.next=u),l.interleaved=u,ns(o,f)}function ns(o,l){o.lanes|=l;var u=o.alternate;for(u!==null&&(u.lanes|=l),u=o,o=o.return;o!==null;)o.childLanes|=l,u=o.alternate,u!==null&&(u.childLanes|=l),u=o,o=o.return;return u.tag===3?u.stateNode:null}var Hs=!1;function Nm(o){o.updateQueue={baseState:o.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function _b(o,l){o=o.updateQueue,l.updateQueue===o&&(l.updateQueue={baseState:o.baseState,firstBaseUpdate:o.firstBaseUpdate,lastBaseUpdate:o.lastBaseUpdate,shared:o.shared,effects:o.effects})}function rs(o,l){return{eventTime:o,lane:l,tag:0,payload:null,callback:null,next:null}}function $s(o,l,u){var f=o.updateQueue;if(f===null)return null;if(f=f.shared,(Tt&2)!==0){var y=f.pending;return y===null?l.next=l:(l.next=y.next,y.next=l),f.pending=l,ns(o,u)}return y=f.interleaved,y===null?(l.next=l,Fm(f)):(l.next=y.next,y.next=l),f.interleaved=l,ns(o,u)}function kh(o,l,u){if(l=l.updateQueue,l!==null&&(l=l.shared,(u&4194240)!==0)){var f=l.lanes;f&=o.pendingLanes,u|=f,l.lanes=u,Ns(o,u)}}function jb(o,l){var u=o.updateQueue,f=o.alternate;if(f!==null&&(f=f.updateQueue,u===f)){var y=null,v=null;if(u=u.firstBaseUpdate,u!==null){do{var C={eventTime:u.eventTime,lane:u.lane,tag:u.tag,payload:u.payload,callback:u.callback,next:null};v===null?y=v=C:v=v.next=C,u=u.next}while(u!==null);v===null?y=v=l:v=v.next=l}else y=v=l;u={baseState:f.baseState,firstBaseUpdate:y,lastBaseUpdate:v,shared:f.shared,effects:f.effects},o.updateQueue=u;return}o=u.lastBaseUpdate,o===null?u.firstBaseUpdate=l:o.next=l,u.lastBaseUpdate=l}function Th(o,l,u,f){var y=o.updateQueue;Hs=!1;var v=y.firstBaseUpdate,C=y.lastBaseUpdate,q=y.shared.pending;if(q!==null){y.shared.pending=null;var Q=q,fe=Q.next;Q.next=null,C===null?v=fe:C.next=fe,C=Q;var Ie=o.alternate;Ie!==null&&(Ie=Ie.updateQueue,q=Ie.lastBaseUpdate,q!==C&&(q===null?Ie.firstBaseUpdate=fe:q.next=fe,Ie.lastBaseUpdate=Q))}if(v!==null){var Ee=y.baseState;C=0,Ie=fe=Q=null,q=v;do{var je=q.lane,Ve=q.eventTime;if((f&je)===je){Ie!==null&&(Ie=Ie.next={eventTime:Ve,lane:0,tag:q.tag,payload:q.payload,callback:q.callback,next:null});e:{var qe=o,Ge=q;switch(je=l,Ve=u,Ge.tag){case 1:if(qe=Ge.payload,typeof qe=="function"){Ee=qe.call(Ve,Ee,je);break e}Ee=qe;break e;case 3:qe.flags=qe.flags&-65537|128;case 0:if(qe=Ge.payload,je=typeof qe=="function"?qe.call(Ve,Ee,je):qe,je==null)break e;Ee=ne({},Ee,je);break e;case 2:Hs=!0}}q.callback!==null&&q.lane!==0&&(o.flags|=64,je=y.effects,je===null?y.effects=[q]:je.push(q))}else Ve={eventTime:Ve,lane:je,tag:q.tag,payload:q.payload,callback:q.callback,next:null},Ie===null?(fe=Ie=Ve,Q=Ee):Ie=Ie.next=Ve,C|=je;if(q=q.next,q===null){if(q=y.shared.pending,q===null)break;je=q,q=je.next,je.next=null,y.lastBaseUpdate=je,y.shared.pending=null}}while(!0);if(Ie===null&&(Q=Ee),y.baseState=Q,y.firstBaseUpdate=fe,y.lastBaseUpdate=Ie,l=y.shared.interleaved,l!==null){y=l;do C|=y.lane,y=y.next;while(y!==l)}else v===null&&(y.shared.lanes=0);na|=C,o.lanes=C,o.memoizedState=Ee}}function Ib(o,l,u){if(o=l.effects,l.effects=null,o!==null)for(l=0;l<o.length;l++){var f=o[l],y=f.callback;if(y!==null){if(f.callback=null,f=u,typeof y!="function")throw Error(t(191,y));y.call(f)}}}var su={},ji=Ws(su),ou=Ws(su),au=Ws(su);function ea(o){if(o===su)throw Error(t(174));return o}function zm(o,l){switch(qt(au,l),qt(ou,o),qt(ji,su),o=l.nodeType,o){case 9:case 11:l=(l=l.documentElement)?l.namespaceURI:be(null,"");break;default:o=o===8?l.parentNode:l,l=o.namespaceURI||null,o=o.tagName,l=be(l,o)}Qt(ji),qt(ji,l)}function wl(){Qt(ji),Qt(ou),Qt(au)}function Eb(o){ea(au.current);var l=ea(ji.current),u=be(l,o.type);l!==u&&(qt(ou,o),qt(ji,u))}function Dm(o){ou.current===o&&(Qt(ji),Qt(ou))}var on=Ws(0);function _h(o){for(var l=o;l!==null;){if(l.tag===13){var u=l.memoizedState;if(u!==null&&(u=u.dehydrated,u===null||u.data==="$?"||u.data==="$!"))return l}else if(l.tag===19&&l.memoizedProps.revealOrder!==void 0){if((l.flags&128)!==0)return l}else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===o)break;for(;l.sibling===null;){if(l.return===null||l.return===o)return null;l=l.return}l.sibling.return=l.return,l=l.sibling}return null}var Mm=[];function Lm(){for(var o=0;o<Mm.length;o++)Mm[o]._workInProgressVersionPrimary=null;Mm.length=0}var jh=X.ReactCurrentDispatcher,Om=X.ReactCurrentBatchConfig,ta=0,an=null,wn=null,Rn=null,Ih=!1,lu=!1,cu=0,tE=0;function Qn(){throw Error(t(321))}function Vm(o,l){if(l===null)return!1;for(var u=0;u<l.length&&u<o.length;u++)if(!si(o[u],l[u]))return!1;return!0}function Wm(o,l,u,f,y,v){if(ta=v,an=l,l.memoizedState=null,l.updateQueue=null,l.lanes=0,jh.current=o===null||o.memoizedState===null?sE:oE,o=u(f,y),lu){v=0;do{if(lu=!1,cu=0,25<=v)throw Error(t(301));v+=1,Rn=wn=null,l.updateQueue=null,jh.current=aE,o=u(f,y)}while(lu)}if(jh.current=Rh,l=wn!==null&&wn.next!==null,ta=0,Rn=wn=an=null,Ih=!1,l)throw Error(t(300));return o}function Um(){var o=cu!==0;return cu=0,o}function Ii(){var o={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Rn===null?an.memoizedState=Rn=o:Rn=Rn.next=o,Rn}function Kr(){if(wn===null){var o=an.alternate;o=o!==null?o.memoizedState:null}else o=wn.next;var l=Rn===null?an.memoizedState:Rn.next;if(l!==null)Rn=l,wn=o;else{if(o===null)throw Error(t(310));wn=o,o={memoizedState:wn.memoizedState,baseState:wn.baseState,baseQueue:wn.baseQueue,queue:wn.queue,next:null},Rn===null?an.memoizedState=Rn=o:Rn=Rn.next=o}return Rn}function uu(o,l){return typeof l=="function"?l(o):l}function qm(o){var l=Kr(),u=l.queue;if(u===null)throw Error(t(311));u.lastRenderedReducer=o;var f=wn,y=f.baseQueue,v=u.pending;if(v!==null){if(y!==null){var C=y.next;y.next=v.next,v.next=C}f.baseQueue=y=v,u.pending=null}if(y!==null){v=y.next,f=f.baseState;var q=C=null,Q=null,fe=v;do{var Ie=fe.lane;if((ta&Ie)===Ie)Q!==null&&(Q=Q.next={lane:0,action:fe.action,hasEagerState:fe.hasEagerState,eagerState:fe.eagerState,next:null}),f=fe.hasEagerState?fe.eagerState:o(f,fe.action);else{var Ee={lane:Ie,action:fe.action,hasEagerState:fe.hasEagerState,eagerState:fe.eagerState,next:null};Q===null?(q=Q=Ee,C=f):Q=Q.next=Ee,an.lanes|=Ie,na|=Ie}fe=fe.next}while(fe!==null&&fe!==v);Q===null?C=f:Q.next=q,si(f,l.memoizedState)||(mr=!0),l.memoizedState=f,l.baseState=C,l.baseQueue=Q,u.lastRenderedState=f}if(o=u.interleaved,o!==null){y=o;do v=y.lane,an.lanes|=v,na|=v,y=y.next;while(y!==o)}else y===null&&(u.lanes=0);return[l.memoizedState,u.dispatch]}function Hm(o){var l=Kr(),u=l.queue;if(u===null)throw Error(t(311));u.lastRenderedReducer=o;var f=u.dispatch,y=u.pending,v=l.memoizedState;if(y!==null){u.pending=null;var C=y=y.next;do v=o(v,C.action),C=C.next;while(C!==y);si(v,l.memoizedState)||(mr=!0),l.memoizedState=v,l.baseQueue===null&&(l.baseState=v),u.lastRenderedState=v}return[v,f]}function Cb(){}function Rb(o,l){var u=an,f=Kr(),y=l(),v=!si(f.memoizedState,y);if(v&&(f.memoizedState=y,mr=!0),f=f.queue,$m(Bb.bind(null,u,f,o),[o]),f.getSnapshot!==l||v||Rn!==null&&Rn.memoizedState.tag&1){if(u.flags|=2048,du(9,Pb.bind(null,u,f,y,l),void 0,null),An===null)throw Error(t(349));(ta&30)!==0||Ab(u,l,y)}return y}function Ab(o,l,u){o.flags|=16384,o={getSnapshot:l,value:u},l=an.updateQueue,l===null?(l={lastEffect:null,stores:null},an.updateQueue=l,l.stores=[o]):(u=l.stores,u===null?l.stores=[o]:u.push(o))}function Pb(o,l,u,f){l.value=u,l.getSnapshot=f,Fb(l)&&Nb(o)}function Bb(o,l,u){return u(function(){Fb(l)&&Nb(o)})}function Fb(o){var l=o.getSnapshot;o=o.value;try{var u=l();return!si(o,u)}catch{return!0}}function Nb(o){var l=ns(o,1);l!==null&&ui(l,o,1,-1)}function zb(o){var l=Ii();return typeof o=="function"&&(o=o()),l.memoizedState=l.baseState=o,o={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:uu,lastRenderedState:o},l.queue=o,o=o.dispatch=iE.bind(null,an,o),[l.memoizedState,o]}function du(o,l,u,f){return o={tag:o,create:l,destroy:u,deps:f,next:null},l=an.updateQueue,l===null?(l={lastEffect:null,stores:null},an.updateQueue=l,l.lastEffect=o.next=o):(u=l.lastEffect,u===null?l.lastEffect=o.next=o:(f=u.next,u.next=o,o.next=f,l.lastEffect=o)),o}function Db(){return Kr().memoizedState}function Eh(o,l,u,f){var y=Ii();an.flags|=o,y.memoizedState=du(1|l,u,void 0,f===void 0?null:f)}function Ch(o,l,u,f){var y=Kr();f=f===void 0?null:f;var v=void 0;if(wn!==null){var C=wn.memoizedState;if(v=C.destroy,f!==null&&Vm(f,C.deps)){y.memoizedState=du(l,u,v,f);return}}an.flags|=o,y.memoizedState=du(1|l,u,v,f)}function Mb(o,l){return Eh(8390656,8,o,l)}function $m(o,l){return Ch(2048,8,o,l)}function Lb(o,l){return Ch(4,2,o,l)}function Ob(o,l){return Ch(4,4,o,l)}function Vb(o,l){if(typeof l=="function")return o=o(),l(o),function(){l(null)};if(l!=null)return o=o(),l.current=o,function(){l.current=null}}function Wb(o,l,u){return u=u!=null?u.concat([o]):null,Ch(4,4,Vb.bind(null,l,o),u)}function Gm(){}function Ub(o,l){var u=Kr();l=l===void 0?null:l;var f=u.memoizedState;return f!==null&&l!==null&&Vm(l,f[1])?f[0]:(u.memoizedState=[o,l],o)}function qb(o,l){var u=Kr();l=l===void 0?null:l;var f=u.memoizedState;return f!==null&&l!==null&&Vm(l,f[1])?f[0]:(o=o(),u.memoizedState=[o,l],o)}function Hb(o,l,u){return(ta&21)===0?(o.baseState&&(o.baseState=!1,mr=!0),o.memoizedState=u):(si(u,l)||(u=qo(),an.lanes|=u,na|=u,o.baseState=!0),l)}function nE(o,l){var u=vt;vt=u!==0&&4>u?u:4,o(!0);var f=Om.transition;Om.transition={};try{o(!1),l()}finally{vt=u,Om.transition=f}}function $b(){return Kr().memoizedState}function rE(o,l,u){var f=Ys(o);if(u={lane:f,action:u,hasEagerState:!1,eagerState:null,next:null},Gb(o))Kb(l,u);else if(u=Tb(o,l,u,f),u!==null){var y=ar();ui(u,o,f,y),Qb(u,l,f)}}function iE(o,l,u){var f=Ys(o),y={lane:f,action:u,hasEagerState:!1,eagerState:null,next:null};if(Gb(o))Kb(l,y);else{var v=o.alternate;if(o.lanes===0&&(v===null||v.lanes===0)&&(v=l.lastRenderedReducer,v!==null))try{var C=l.lastRenderedState,q=v(C,u);if(y.hasEagerState=!0,y.eagerState=q,si(q,C)){var Q=l.interleaved;Q===null?(y.next=y,Fm(l)):(y.next=Q.next,Q.next=y),l.interleaved=y;return}}catch{}finally{}u=Tb(o,l,y,f),u!==null&&(y=ar(),ui(u,o,f,y),Qb(u,l,f))}}function Gb(o){var l=o.alternate;return o===an||l!==null&&l===an}function Kb(o,l){lu=Ih=!0;var u=o.pending;u===null?l.next=l:(l.next=u.next,u.next=l),o.pending=l}function Qb(o,l,u){if((u&4194240)!==0){var f=l.lanes;f&=o.pendingLanes,u|=f,l.lanes=u,Ns(o,u)}}var Rh={readContext:Gr,useCallback:Qn,useContext:Qn,useEffect:Qn,useImperativeHandle:Qn,useInsertionEffect:Qn,useLayoutEffect:Qn,useMemo:Qn,useReducer:Qn,useRef:Qn,useState:Qn,useDebugValue:Qn,useDeferredValue:Qn,useTransition:Qn,useMutableSource:Qn,useSyncExternalStore:Qn,useId:Qn,unstable_isNewReconciler:!1},sE={readContext:Gr,useCallback:function(o,l){return Ii().memoizedState=[o,l===void 0?null:l],o},useContext:Gr,useEffect:Mb,useImperativeHandle:function(o,l,u){return u=u!=null?u.concat([o]):null,Eh(4194308,4,Vb.bind(null,l,o),u)},useLayoutEffect:function(o,l){return Eh(4194308,4,o,l)},useInsertionEffect:function(o,l){return Eh(4,2,o,l)},useMemo:function(o,l){var u=Ii();return l=l===void 0?null:l,o=o(),u.memoizedState=[o,l],o},useReducer:function(o,l,u){var f=Ii();return l=u!==void 0?u(l):l,f.memoizedState=f.baseState=l,o={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:o,lastRenderedState:l},f.queue=o,o=o.dispatch=rE.bind(null,an,o),[f.memoizedState,o]},useRef:function(o){var l=Ii();return o={current:o},l.memoizedState=o},useState:zb,useDebugValue:Gm,useDeferredValue:function(o){return Ii().memoizedState=o},useTransition:function(){var o=zb(!1),l=o[0];return o=nE.bind(null,o[1]),Ii().memoizedState=o,[l,o]},useMutableSource:function(){},useSyncExternalStore:function(o,l,u){var f=an,y=Ii();if(tn){if(u===void 0)throw Error(t(407));u=u()}else{if(u=l(),An===null)throw Error(t(349));(ta&30)!==0||Ab(f,l,u)}y.memoizedState=u;var v={value:u,getSnapshot:l};return y.queue=v,Mb(Bb.bind(null,f,v,o),[o]),f.flags|=2048,du(9,Pb.bind(null,f,v,u,l),void 0,null),u},useId:function(){var o=Ii(),l=An.identifierPrefix;if(tn){var u=ts,f=es;u=(f&~(1<<32-ir(f)-1)).toString(32)+u,l=":"+l+"R"+u,u=cu++,0<u&&(l+="H"+u.toString(32)),l+=":"}else u=tE++,l=":"+l+"r"+u.toString(32)+":";return o.memoizedState=l},unstable_isNewReconciler:!1},oE={readContext:Gr,useCallback:Ub,useContext:Gr,useEffect:$m,useImperativeHandle:Wb,useInsertionEffect:Lb,useLayoutEffect:Ob,useMemo:qb,useReducer:qm,useRef:Db,useState:function(){return qm(uu)},useDebugValue:Gm,useDeferredValue:function(o){var l=Kr();return Hb(l,wn.memoizedState,o)},useTransition:function(){var o=qm(uu)[0],l=Kr().memoizedState;return[o,l]},useMutableSource:Cb,useSyncExternalStore:Rb,useId:$b,unstable_isNewReconciler:!1},aE={readContext:Gr,useCallback:Ub,useContext:Gr,useEffect:$m,useImperativeHandle:Wb,useInsertionEffect:Lb,useLayoutEffect:Ob,useMemo:qb,useReducer:Hm,useRef:Db,useState:function(){return Hm(uu)},useDebugValue:Gm,useDeferredValue:function(o){var l=Kr();return wn===null?l.memoizedState=o:Hb(l,wn.memoizedState,o)},useTransition:function(){var o=Hm(uu)[0],l=Kr().memoizedState;return[o,l]},useMutableSource:Cb,useSyncExternalStore:Rb,useId:$b,unstable_isNewReconciler:!1};function ai(o,l){if(o&&o.defaultProps){l=ne({},l),o=o.defaultProps;for(var u in o)l[u]===void 0&&(l[u]=o[u]);return l}return l}function Km(o,l,u,f){l=o.memoizedState,u=u(f,l),u=u==null?l:ne({},l,u),o.memoizedState=u,o.lanes===0&&(o.updateQueue.baseState=u)}var Ah={isMounted:function(o){return(o=o._reactInternals)?Jr(o)===o:!1},enqueueSetState:function(o,l,u){o=o._reactInternals;var f=ar(),y=Ys(o),v=rs(f,y);v.payload=l,u!=null&&(v.callback=u),l=$s(o,v,y),l!==null&&(ui(l,o,y,f),kh(l,o,y))},enqueueReplaceState:function(o,l,u){o=o._reactInternals;var f=ar(),y=Ys(o),v=rs(f,y);v.tag=1,v.payload=l,u!=null&&(v.callback=u),l=$s(o,v,y),l!==null&&(ui(l,o,y,f),kh(l,o,y))},enqueueForceUpdate:function(o,l){o=o._reactInternals;var u=ar(),f=Ys(o),y=rs(u,f);y.tag=2,l!=null&&(y.callback=l),l=$s(o,y,f),l!==null&&(ui(l,o,f,u),kh(l,o,f))}};function Yb(o,l,u,f,y,v,C){return o=o.stateNode,typeof o.shouldComponentUpdate=="function"?o.shouldComponentUpdate(f,v,C):l.prototype&&l.prototype.isPureReactComponent?!Xc(u,f)||!Xc(y,v):!0}function Xb(o,l,u){var f=!1,y=Us,v=l.contextType;return typeof v=="object"&&v!==null?v=Gr(v):(y=fr(l)?Yo:Kn.current,f=l.contextTypes,v=(f=f!=null)?fl(o,y):Us),l=new l(u,v),o.memoizedState=l.state!==null&&l.state!==void 0?l.state:null,l.updater=Ah,o.stateNode=l,l._reactInternals=o,f&&(o=o.stateNode,o.__reactInternalMemoizedUnmaskedChildContext=y,o.__reactInternalMemoizedMaskedChildContext=v),l}function Jb(o,l,u,f){o=l.state,typeof l.componentWillReceiveProps=="function"&&l.componentWillReceiveProps(u,f),typeof l.UNSAFE_componentWillReceiveProps=="function"&&l.UNSAFE_componentWillReceiveProps(u,f),l.state!==o&&Ah.enqueueReplaceState(l,l.state,null)}function Qm(o,l,u,f){var y=o.stateNode;y.props=u,y.state=o.memoizedState,y.refs={},Nm(o);var v=l.contextType;typeof v=="object"&&v!==null?y.context=Gr(v):(v=fr(l)?Yo:Kn.current,y.context=fl(o,v)),y.state=o.memoizedState,v=l.getDerivedStateFromProps,typeof v=="function"&&(Km(o,l,v,u),y.state=o.memoizedState),typeof l.getDerivedStateFromProps=="function"||typeof y.getSnapshotBeforeUpdate=="function"||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(l=y.state,typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount(),l!==y.state&&Ah.enqueueReplaceState(y,y.state,null),Th(o,u,y,f),y.state=o.memoizedState),typeof y.componentDidMount=="function"&&(o.flags|=4194308)}function Sl(o,l){try{var u="",f=l;do u+=_e(f),f=f.return;while(f);var y=u}catch(v){y=`
Error generating stack: `+v.message+`
`+v.stack}return{value:o,source:l,stack:y,digest:null}}function Ym(o,l,u){return{value:o,source:null,stack:u??null,digest:l??null}}function Xm(o,l){try{console.error(l.value)}catch(u){setTimeout(function(){throw u})}}var lE=typeof WeakMap=="function"?WeakMap:Map;function Zb(o,l,u){u=rs(-1,u),u.tag=3,u.payload={element:null};var f=l.value;return u.callback=function(){Mh||(Mh=!0,hg=f),Xm(o,l)},u}function ev(o,l,u){u=rs(-1,u),u.tag=3;var f=o.type.getDerivedStateFromError;if(typeof f=="function"){var y=l.value;u.payload=function(){return f(y)},u.callback=function(){Xm(o,l)}}var v=o.stateNode;return v!==null&&typeof v.componentDidCatch=="function"&&(u.callback=function(){Xm(o,l),typeof f!="function"&&(Ks===null?Ks=new Set([this]):Ks.add(this));var C=l.stack;this.componentDidCatch(l.value,{componentStack:C!==null?C:""})}),u}function tv(o,l,u){var f=o.pingCache;if(f===null){f=o.pingCache=new lE;var y=new Set;f.set(l,y)}else y=f.get(l),y===void 0&&(y=new Set,f.set(l,y));y.has(u)||(y.add(u),o=SE.bind(null,o,l,u),l.then(o,o))}function nv(o){do{var l;if((l=o.tag===13)&&(l=o.memoizedState,l=l!==null?l.dehydrated!==null:!0),l)return o;o=o.return}while(o!==null);return null}function rv(o,l,u,f,y){return(o.mode&1)===0?(o===l?o.flags|=65536:(o.flags|=128,u.flags|=131072,u.flags&=-52805,u.tag===1&&(u.alternate===null?u.tag=17:(l=rs(-1,1),l.tag=2,$s(u,l,1))),u.lanes|=1),o):(o.flags|=65536,o.lanes=y,o)}var cE=X.ReactCurrentOwner,mr=!1;function or(o,l,u,f){l.child=o===null?kb(l,null,u,f):xl(l,o.child,u,f)}function iv(o,l,u,f,y){u=u.render;var v=l.ref;return vl(l,y),f=Wm(o,l,u,f,v,y),u=Um(),o!==null&&!mr?(l.updateQueue=o.updateQueue,l.flags&=-2053,o.lanes&=~y,is(o,l,y)):(tn&&u&&_m(l),l.flags|=1,or(o,l,f,y),l.child)}function sv(o,l,u,f,y){if(o===null){var v=u.type;return typeof v=="function"&&!bg(v)&&v.defaultProps===void 0&&u.compare===null&&u.defaultProps===void 0?(l.tag=15,l.type=v,ov(o,l,v,f,y)):(o=qh(u.type,null,f,l,l.mode,y),o.ref=l.ref,o.return=l,l.child=o)}if(v=o.child,(o.lanes&y)===0){var C=v.memoizedProps;if(u=u.compare,u=u!==null?u:Xc,u(C,f)&&o.ref===l.ref)return is(o,l,y)}return l.flags|=1,o=Js(v,f),o.ref=l.ref,o.return=l,l.child=o}function ov(o,l,u,f,y){if(o!==null){var v=o.memoizedProps;if(Xc(v,f)&&o.ref===l.ref)if(mr=!1,l.pendingProps=f=v,(o.lanes&y)!==0)(o.flags&131072)!==0&&(mr=!0);else return l.lanes=o.lanes,is(o,l,y)}return Jm(o,l,u,f,y)}function av(o,l,u){var f=l.pendingProps,y=f.children,v=o!==null?o.memoizedState:null;if(f.mode==="hidden")if((l.mode&1)===0)l.memoizedState={baseLanes:0,cachePool:null,transitions:null},qt(Tl,Nr),Nr|=u;else{if((u&1073741824)===0)return o=v!==null?v.baseLanes|u:u,l.lanes=l.childLanes=1073741824,l.memoizedState={baseLanes:o,cachePool:null,transitions:null},l.updateQueue=null,qt(Tl,Nr),Nr|=o,null;l.memoizedState={baseLanes:0,cachePool:null,transitions:null},f=v!==null?v.baseLanes:u,qt(Tl,Nr),Nr|=f}else v!==null?(f=v.baseLanes|u,l.memoizedState=null):f=u,qt(Tl,Nr),Nr|=f;return or(o,l,y,u),l.child}function lv(o,l){var u=l.ref;(o===null&&u!==null||o!==null&&o.ref!==u)&&(l.flags|=512,l.flags|=2097152)}function Jm(o,l,u,f,y){var v=fr(u)?Yo:Kn.current;return v=fl(l,v),vl(l,y),u=Wm(o,l,u,f,v,y),f=Um(),o!==null&&!mr?(l.updateQueue=o.updateQueue,l.flags&=-2053,o.lanes&=~y,is(o,l,y)):(tn&&f&&_m(l),l.flags|=1,or(o,l,u,y),l.child)}function cv(o,l,u,f,y){if(fr(u)){var v=!0;mh(l)}else v=!1;if(vl(l,y),l.stateNode===null)Bh(o,l),Xb(l,u,f),Qm(l,u,f,y),f=!0;else if(o===null){var C=l.stateNode,q=l.memoizedProps;C.props=q;var Q=C.context,fe=u.contextType;typeof fe=="object"&&fe!==null?fe=Gr(fe):(fe=fr(u)?Yo:Kn.current,fe=fl(l,fe));var Ie=u.getDerivedStateFromProps,Ee=typeof Ie=="function"||typeof C.getSnapshotBeforeUpdate=="function";Ee||typeof C.UNSAFE_componentWillReceiveProps!="function"&&typeof C.componentWillReceiveProps!="function"||(q!==f||Q!==fe)&&Jb(l,C,f,fe),Hs=!1;var je=l.memoizedState;C.state=je,Th(l,f,C,y),Q=l.memoizedState,q!==f||je!==Q||pr.current||Hs?(typeof Ie=="function"&&(Km(l,u,Ie,f),Q=l.memoizedState),(q=Hs||Yb(l,u,q,f,je,Q,fe))?(Ee||typeof C.UNSAFE_componentWillMount!="function"&&typeof C.componentWillMount!="function"||(typeof C.componentWillMount=="function"&&C.componentWillMount(),typeof C.UNSAFE_componentWillMount=="function"&&C.UNSAFE_componentWillMount()),typeof C.componentDidMount=="function"&&(l.flags|=4194308)):(typeof C.componentDidMount=="function"&&(l.flags|=4194308),l.memoizedProps=f,l.memoizedState=Q),C.props=f,C.state=Q,C.context=fe,f=q):(typeof C.componentDidMount=="function"&&(l.flags|=4194308),f=!1)}else{C=l.stateNode,_b(o,l),q=l.memoizedProps,fe=l.type===l.elementType?q:ai(l.type,q),C.props=fe,Ee=l.pendingProps,je=C.context,Q=u.contextType,typeof Q=="object"&&Q!==null?Q=Gr(Q):(Q=fr(u)?Yo:Kn.current,Q=fl(l,Q));var Ve=u.getDerivedStateFromProps;(Ie=typeof Ve=="function"||typeof C.getSnapshotBeforeUpdate=="function")||typeof C.UNSAFE_componentWillReceiveProps!="function"&&typeof C.componentWillReceiveProps!="function"||(q!==Ee||je!==Q)&&Jb(l,C,f,Q),Hs=!1,je=l.memoizedState,C.state=je,Th(l,f,C,y);var qe=l.memoizedState;q!==Ee||je!==qe||pr.current||Hs?(typeof Ve=="function"&&(Km(l,u,Ve,f),qe=l.memoizedState),(fe=Hs||Yb(l,u,fe,f,je,qe,Q)||!1)?(Ie||typeof C.UNSAFE_componentWillUpdate!="function"&&typeof C.componentWillUpdate!="function"||(typeof C.componentWillUpdate=="function"&&C.componentWillUpdate(f,qe,Q),typeof C.UNSAFE_componentWillUpdate=="function"&&C.UNSAFE_componentWillUpdate(f,qe,Q)),typeof C.componentDidUpdate=="function"&&(l.flags|=4),typeof C.getSnapshotBeforeUpdate=="function"&&(l.flags|=1024)):(typeof C.componentDidUpdate!="function"||q===o.memoizedProps&&je===o.memoizedState||(l.flags|=4),typeof C.getSnapshotBeforeUpdate!="function"||q===o.memoizedProps&&je===o.memoizedState||(l.flags|=1024),l.memoizedProps=f,l.memoizedState=qe),C.props=f,C.state=qe,C.context=Q,f=fe):(typeof C.componentDidUpdate!="function"||q===o.memoizedProps&&je===o.memoizedState||(l.flags|=4),typeof C.getSnapshotBeforeUpdate!="function"||q===o.memoizedProps&&je===o.memoizedState||(l.flags|=1024),f=!1)}return Zm(o,l,u,f,v,y)}function Zm(o,l,u,f,y,v){lv(o,l);var C=(l.flags&128)!==0;if(!f&&!C)return y&&fb(l,u,!1),is(o,l,v);f=l.stateNode,cE.current=l;var q=C&&typeof u.getDerivedStateFromError!="function"?null:f.render();return l.flags|=1,o!==null&&C?(l.child=xl(l,o.child,null,v),l.child=xl(l,null,q,v)):or(o,l,q,v),l.memoizedState=f.state,y&&fb(l,u,!0),l.child}function uv(o){var l=o.stateNode;l.pendingContext?hb(o,l.pendingContext,l.pendingContext!==l.context):l.context&&hb(o,l.context,!1),zm(o,l.containerInfo)}function dv(o,l,u,f,y){return yl(),Cm(y),l.flags|=256,or(o,l,u,f),l.child}var eg={dehydrated:null,treeContext:null,retryLane:0};function tg(o){return{baseLanes:o,cachePool:null,transitions:null}}function hv(o,l,u){var f=l.pendingProps,y=on.current,v=!1,C=(l.flags&128)!==0,q;if((q=C)||(q=o!==null&&o.memoizedState===null?!1:(y&2)!==0),q?(v=!0,l.flags&=-129):(o===null||o.memoizedState!==null)&&(y|=1),qt(on,y&1),o===null)return Em(l),o=l.memoizedState,o!==null&&(o=o.dehydrated,o!==null)?((l.mode&1)===0?l.lanes=1:o.data==="$!"?l.lanes=8:l.lanes=1073741824,null):(C=f.children,o=f.fallback,v?(f=l.mode,v=l.child,C={mode:"hidden",children:C},(f&1)===0&&v!==null?(v.childLanes=0,v.pendingProps=C):v=Hh(C,f,0,null),o=oa(o,f,u,null),v.return=l,o.return=l,v.sibling=o,l.child=v,l.child.memoizedState=tg(u),l.memoizedState=eg,o):ng(l,C));if(y=o.memoizedState,y!==null&&(q=y.dehydrated,q!==null))return uE(o,l,C,f,q,y,u);if(v){v=f.fallback,C=l.mode,y=o.child,q=y.sibling;var Q={mode:"hidden",children:f.children};return(C&1)===0&&l.child!==y?(f=l.child,f.childLanes=0,f.pendingProps=Q,l.deletions=null):(f=Js(y,Q),f.subtreeFlags=y.subtreeFlags&14680064),q!==null?v=Js(q,v):(v=oa(v,C,u,null),v.flags|=2),v.return=l,f.return=l,f.sibling=v,l.child=f,f=v,v=l.child,C=o.child.memoizedState,C=C===null?tg(u):{baseLanes:C.baseLanes|u,cachePool:null,transitions:C.transitions},v.memoizedState=C,v.childLanes=o.childLanes&~u,l.memoizedState=eg,f}return v=o.child,o=v.sibling,f=Js(v,{mode:"visible",children:f.children}),(l.mode&1)===0&&(f.lanes=u),f.return=l,f.sibling=null,o!==null&&(u=l.deletions,u===null?(l.deletions=[o],l.flags|=16):u.push(o)),l.child=f,l.memoizedState=null,f}function ng(o,l){return l=Hh({mode:"visible",children:l},o.mode,0,null),l.return=o,o.child=l}function Ph(o,l,u,f){return f!==null&&Cm(f),xl(l,o.child,null,u),o=ng(l,l.pendingProps.children),o.flags|=2,l.memoizedState=null,o}function uE(o,l,u,f,y,v,C){if(u)return l.flags&256?(l.flags&=-257,f=Ym(Error(t(422))),Ph(o,l,C,f)):l.memoizedState!==null?(l.child=o.child,l.flags|=128,null):(v=f.fallback,y=l.mode,f=Hh({mode:"visible",children:f.children},y,0,null),v=oa(v,y,C,null),v.flags|=2,f.return=l,v.return=l,f.sibling=v,l.child=f,(l.mode&1)!==0&&xl(l,o.child,null,C),l.child.memoizedState=tg(C),l.memoizedState=eg,v);if((l.mode&1)===0)return Ph(o,l,C,null);if(y.data==="$!"){if(f=y.nextSibling&&y.nextSibling.dataset,f)var q=f.dgst;return f=q,v=Error(t(419)),f=Ym(v,f,void 0),Ph(o,l,C,f)}if(q=(C&o.childLanes)!==0,mr||q){if(f=An,f!==null){switch(C&-C){case 4:y=2;break;case 16:y=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:y=32;break;case 536870912:y=268435456;break;default:y=0}y=(y&(f.suspendedLanes|C))!==0?0:y,y!==0&&y!==v.retryLane&&(v.retryLane=y,ns(o,y),ui(f,o,y,-1))}return xg(),f=Ym(Error(t(421))),Ph(o,l,C,f)}return y.data==="$?"?(l.flags|=128,l.child=o.child,l=kE.bind(null,o),y._reactRetry=l,null):(o=v.treeContext,Fr=Vs(y.nextSibling),Br=l,tn=!0,oi=null,o!==null&&(Hr[$r++]=es,Hr[$r++]=ts,Hr[$r++]=Xo,es=o.id,ts=o.overflow,Xo=l),l=ng(l,f.children),l.flags|=4096,l)}function pv(o,l,u){o.lanes|=l;var f=o.alternate;f!==null&&(f.lanes|=l),Bm(o.return,l,u)}function rg(o,l,u,f,y){var v=o.memoizedState;v===null?o.memoizedState={isBackwards:l,rendering:null,renderingStartTime:0,last:f,tail:u,tailMode:y}:(v.isBackwards=l,v.rendering=null,v.renderingStartTime=0,v.last=f,v.tail=u,v.tailMode=y)}function fv(o,l,u){var f=l.pendingProps,y=f.revealOrder,v=f.tail;if(or(o,l,f.children,u),f=on.current,(f&2)!==0)f=f&1|2,l.flags|=128;else{if(o!==null&&(o.flags&128)!==0)e:for(o=l.child;o!==null;){if(o.tag===13)o.memoizedState!==null&&pv(o,u,l);else if(o.tag===19)pv(o,u,l);else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===l)break e;for(;o.sibling===null;){if(o.return===null||o.return===l)break e;o=o.return}o.sibling.return=o.return,o=o.sibling}f&=1}if(qt(on,f),(l.mode&1)===0)l.memoizedState=null;else switch(y){case"forwards":for(u=l.child,y=null;u!==null;)o=u.alternate,o!==null&&_h(o)===null&&(y=u),u=u.sibling;u=y,u===null?(y=l.child,l.child=null):(y=u.sibling,u.sibling=null),rg(l,!1,y,u,v);break;case"backwards":for(u=null,y=l.child,l.child=null;y!==null;){if(o=y.alternate,o!==null&&_h(o)===null){l.child=y;break}o=y.sibling,y.sibling=u,u=y,y=o}rg(l,!0,u,null,v);break;case"together":rg(l,!1,null,null,void 0);break;default:l.memoizedState=null}return l.child}function Bh(o,l){(l.mode&1)===0&&o!==null&&(o.alternate=null,l.alternate=null,l.flags|=2)}function is(o,l,u){if(o!==null&&(l.dependencies=o.dependencies),na|=l.lanes,(u&l.childLanes)===0)return null;if(o!==null&&l.child!==o.child)throw Error(t(153));if(l.child!==null){for(o=l.child,u=Js(o,o.pendingProps),l.child=u,u.return=l;o.sibling!==null;)o=o.sibling,u=u.sibling=Js(o,o.pendingProps),u.return=l;u.sibling=null}return l.child}function dE(o,l,u){switch(l.tag){case 3:uv(l),yl();break;case 5:Eb(l);break;case 1:fr(l.type)&&mh(l);break;case 4:zm(l,l.stateNode.containerInfo);break;case 10:var f=l.type._context,y=l.memoizedProps.value;qt(wh,f._currentValue),f._currentValue=y;break;case 13:if(f=l.memoizedState,f!==null)return f.dehydrated!==null?(qt(on,on.current&1),l.flags|=128,null):(u&l.child.childLanes)!==0?hv(o,l,u):(qt(on,on.current&1),o=is(o,l,u),o!==null?o.sibling:null);qt(on,on.current&1);break;case 19:if(f=(u&l.childLanes)!==0,(o.flags&128)!==0){if(f)return fv(o,l,u);l.flags|=128}if(y=l.memoizedState,y!==null&&(y.rendering=null,y.tail=null,y.lastEffect=null),qt(on,on.current),f)break;return null;case 22:case 23:return l.lanes=0,av(o,l,u)}return is(o,l,u)}var mv,ig,gv,yv;mv=function(o,l){for(var u=l.child;u!==null;){if(u.tag===5||u.tag===6)o.appendChild(u.stateNode);else if(u.tag!==4&&u.child!==null){u.child.return=u,u=u.child;continue}if(u===l)break;for(;u.sibling===null;){if(u.return===null||u.return===l)return;u=u.return}u.sibling.return=u.return,u=u.sibling}},ig=function(){},gv=function(o,l,u,f){var y=o.memoizedProps;if(y!==f){o=l.stateNode,ea(ji.current);var v=null;switch(u){case"input":y=Ye(o,y),f=Ye(o,f),v=[];break;case"select":y=ne({},y,{value:void 0}),f=ne({},f,{value:void 0}),v=[];break;case"textarea":y=V(o,y),f=V(o,f),v=[];break;default:typeof y.onClick!="function"&&typeof f.onClick=="function"&&(o.onclick=hh)}ht(u,f);var C;u=null;for(fe in y)if(!f.hasOwnProperty(fe)&&y.hasOwnProperty(fe)&&y[fe]!=null)if(fe==="style"){var q=y[fe];for(C in q)q.hasOwnProperty(C)&&(u||(u={}),u[C]="")}else fe!=="dangerouslySetInnerHTML"&&fe!=="children"&&fe!=="suppressContentEditableWarning"&&fe!=="suppressHydrationWarning"&&fe!=="autoFocus"&&(s.hasOwnProperty(fe)?v||(v=[]):(v=v||[]).push(fe,null));for(fe in f){var Q=f[fe];if(q=y!=null?y[fe]:void 0,f.hasOwnProperty(fe)&&Q!==q&&(Q!=null||q!=null))if(fe==="style")if(q){for(C in q)!q.hasOwnProperty(C)||Q&&Q.hasOwnProperty(C)||(u||(u={}),u[C]="");for(C in Q)Q.hasOwnProperty(C)&&q[C]!==Q[C]&&(u||(u={}),u[C]=Q[C])}else u||(v||(v=[]),v.push(fe,u)),u=Q;else fe==="dangerouslySetInnerHTML"?(Q=Q?Q.__html:void 0,q=q?q.__html:void 0,Q!=null&&q!==Q&&(v=v||[]).push(fe,Q)):fe==="children"?typeof Q!="string"&&typeof Q!="number"||(v=v||[]).push(fe,""+Q):fe!=="suppressContentEditableWarning"&&fe!=="suppressHydrationWarning"&&(s.hasOwnProperty(fe)?(Q!=null&&fe==="onScroll"&&Kt("scroll",o),v||q===Q||(v=[])):(v=v||[]).push(fe,Q))}u&&(v=v||[]).push("style",u);var fe=v;(l.updateQueue=fe)&&(l.flags|=4)}},yv=function(o,l,u,f){u!==f&&(l.flags|=4)};function hu(o,l){if(!tn)switch(o.tailMode){case"hidden":l=o.tail;for(var u=null;l!==null;)l.alternate!==null&&(u=l),l=l.sibling;u===null?o.tail=null:u.sibling=null;break;case"collapsed":u=o.tail;for(var f=null;u!==null;)u.alternate!==null&&(f=u),u=u.sibling;f===null?l||o.tail===null?o.tail=null:o.tail.sibling=null:f.sibling=null}}function Yn(o){var l=o.alternate!==null&&o.alternate.child===o.child,u=0,f=0;if(l)for(var y=o.child;y!==null;)u|=y.lanes|y.childLanes,f|=y.subtreeFlags&14680064,f|=y.flags&14680064,y.return=o,y=y.sibling;else for(y=o.child;y!==null;)u|=y.lanes|y.childLanes,f|=y.subtreeFlags,f|=y.flags,y.return=o,y=y.sibling;return o.subtreeFlags|=f,o.childLanes=u,l}function hE(o,l,u){var f=l.pendingProps;switch(jm(l),l.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Yn(l),null;case 1:return fr(l.type)&&fh(),Yn(l),null;case 3:return f=l.stateNode,wl(),Qt(pr),Qt(Kn),Lm(),f.pendingContext&&(f.context=f.pendingContext,f.pendingContext=null),(o===null||o.child===null)&&(bh(l)?l.flags|=4:o===null||o.memoizedState.isDehydrated&&(l.flags&256)===0||(l.flags|=1024,oi!==null&&(mg(oi),oi=null))),ig(o,l),Yn(l),null;case 5:Dm(l);var y=ea(au.current);if(u=l.type,o!==null&&l.stateNode!=null)gv(o,l,u,f,y),o.ref!==l.ref&&(l.flags|=512,l.flags|=2097152);else{if(!f){if(l.stateNode===null)throw Error(t(166));return Yn(l),null}if(o=ea(ji.current),bh(l)){f=l.stateNode,u=l.type;var v=l.memoizedProps;switch(f[_i]=l,f[nu]=v,o=(l.mode&1)!==0,u){case"dialog":Kt("cancel",f),Kt("close",f);break;case"iframe":case"object":case"embed":Kt("load",f);break;case"video":case"audio":for(y=0;y<Zc.length;y++)Kt(Zc[y],f);break;case"source":Kt("error",f);break;case"img":case"image":case"link":Kt("error",f),Kt("load",f);break;case"details":Kt("toggle",f);break;case"input":We(f,v),Kt("invalid",f);break;case"select":f._wrapperState={wasMultiple:!!v.multiple},Kt("invalid",f);break;case"textarea":L(f,v),Kt("invalid",f)}ht(u,v),y=null;for(var C in v)if(v.hasOwnProperty(C)){var q=v[C];C==="children"?typeof q=="string"?f.textContent!==q&&(v.suppressHydrationWarning!==!0&&dh(f.textContent,q,o),y=["children",q]):typeof q=="number"&&f.textContent!==""+q&&(v.suppressHydrationWarning!==!0&&dh(f.textContent,q,o),y=["children",""+q]):s.hasOwnProperty(C)&&q!=null&&C==="onScroll"&&Kt("scroll",f)}switch(u){case"input":ge(f),we(f,v,!0);break;case"textarea":ge(f),H(f);break;case"select":case"option":break;default:typeof v.onClick=="function"&&(f.onclick=hh)}f=y,l.updateQueue=f,f!==null&&(l.flags|=4)}else{C=y.nodeType===9?y:y.ownerDocument,o==="http://www.w3.org/1999/xhtml"&&(o=J(u)),o==="http://www.w3.org/1999/xhtml"?u==="script"?(o=C.createElement("div"),o.innerHTML="<script><\/script>",o=o.removeChild(o.firstChild)):typeof f.is=="string"?o=C.createElement(u,{is:f.is}):(o=C.createElement(u),u==="select"&&(C=o,f.multiple?C.multiple=!0:f.size&&(C.size=f.size))):o=C.createElementNS(o,u),o[_i]=l,o[nu]=f,mv(o,l,!1,!1),l.stateNode=o;e:{switch(C=Vt(u,f),u){case"dialog":Kt("cancel",o),Kt("close",o),y=f;break;case"iframe":case"object":case"embed":Kt("load",o),y=f;break;case"video":case"audio":for(y=0;y<Zc.length;y++)Kt(Zc[y],o);y=f;break;case"source":Kt("error",o),y=f;break;case"img":case"image":case"link":Kt("error",o),Kt("load",o),y=f;break;case"details":Kt("toggle",o),y=f;break;case"input":We(o,f),y=Ye(o,f),Kt("invalid",o);break;case"option":y=f;break;case"select":o._wrapperState={wasMultiple:!!f.multiple},y=ne({},f,{value:void 0}),Kt("invalid",o);break;case"textarea":L(o,f),y=V(o,f),Kt("invalid",o);break;default:y=f}ht(u,y),q=y;for(v in q)if(q.hasOwnProperty(v)){var Q=q[v];v==="style"?Gt(o,Q):v==="dangerouslySetInnerHTML"?(Q=Q?Q.__html:void 0,Q!=null&&$e(o,Q)):v==="children"?typeof Q=="string"?(u!=="textarea"||Q!=="")&&Ze(o,Q):typeof Q=="number"&&Ze(o,""+Q):v!=="suppressContentEditableWarning"&&v!=="suppressHydrationWarning"&&v!=="autoFocus"&&(s.hasOwnProperty(v)?Q!=null&&v==="onScroll"&&Kt("scroll",o):Q!=null&&F(o,v,Q,C))}switch(u){case"input":ge(o),we(o,f,!1);break;case"textarea":ge(o),H(o);break;case"option":f.value!=null&&o.setAttribute("value",""+Ne(f.value));break;case"select":o.multiple=!!f.multiple,v=f.value,v!=null?U(o,!!f.multiple,v,!1):f.defaultValue!=null&&U(o,!!f.multiple,f.defaultValue,!0);break;default:typeof y.onClick=="function"&&(o.onclick=hh)}switch(u){case"button":case"input":case"select":case"textarea":f=!!f.autoFocus;break e;case"img":f=!0;break e;default:f=!1}}f&&(l.flags|=4)}l.ref!==null&&(l.flags|=512,l.flags|=2097152)}return Yn(l),null;case 6:if(o&&l.stateNode!=null)yv(o,l,o.memoizedProps,f);else{if(typeof f!="string"&&l.stateNode===null)throw Error(t(166));if(u=ea(au.current),ea(ji.current),bh(l)){if(f=l.stateNode,u=l.memoizedProps,f[_i]=l,(v=f.nodeValue!==u)&&(o=Br,o!==null))switch(o.tag){case 3:dh(f.nodeValue,u,(o.mode&1)!==0);break;case 5:o.memoizedProps.suppressHydrationWarning!==!0&&dh(f.nodeValue,u,(o.mode&1)!==0)}v&&(l.flags|=4)}else f=(u.nodeType===9?u:u.ownerDocument).createTextNode(f),f[_i]=l,l.stateNode=f}return Yn(l),null;case 13:if(Qt(on),f=l.memoizedState,o===null||o.memoizedState!==null&&o.memoizedState.dehydrated!==null){if(tn&&Fr!==null&&(l.mode&1)!==0&&(l.flags&128)===0)vb(),yl(),l.flags|=98560,v=!1;else if(v=bh(l),f!==null&&f.dehydrated!==null){if(o===null){if(!v)throw Error(t(318));if(v=l.memoizedState,v=v!==null?v.dehydrated:null,!v)throw Error(t(317));v[_i]=l}else yl(),(l.flags&128)===0&&(l.memoizedState=null),l.flags|=4;Yn(l),v=!1}else oi!==null&&(mg(oi),oi=null),v=!0;if(!v)return l.flags&65536?l:null}return(l.flags&128)!==0?(l.lanes=u,l):(f=f!==null,f!==(o!==null&&o.memoizedState!==null)&&f&&(l.child.flags|=8192,(l.mode&1)!==0&&(o===null||(on.current&1)!==0?Sn===0&&(Sn=3):xg())),l.updateQueue!==null&&(l.flags|=4),Yn(l),null);case 4:return wl(),ig(o,l),o===null&&eu(l.stateNode.containerInfo),Yn(l),null;case 10:return Pm(l.type._context),Yn(l),null;case 17:return fr(l.type)&&fh(),Yn(l),null;case 19:if(Qt(on),v=l.memoizedState,v===null)return Yn(l),null;if(f=(l.flags&128)!==0,C=v.rendering,C===null)if(f)hu(v,!1);else{if(Sn!==0||o!==null&&(o.flags&128)!==0)for(o=l.child;o!==null;){if(C=_h(o),C!==null){for(l.flags|=128,hu(v,!1),f=C.updateQueue,f!==null&&(l.updateQueue=f,l.flags|=4),l.subtreeFlags=0,f=u,u=l.child;u!==null;)v=u,o=f,v.flags&=14680066,C=v.alternate,C===null?(v.childLanes=0,v.lanes=o,v.child=null,v.subtreeFlags=0,v.memoizedProps=null,v.memoizedState=null,v.updateQueue=null,v.dependencies=null,v.stateNode=null):(v.childLanes=C.childLanes,v.lanes=C.lanes,v.child=C.child,v.subtreeFlags=0,v.deletions=null,v.memoizedProps=C.memoizedProps,v.memoizedState=C.memoizedState,v.updateQueue=C.updateQueue,v.type=C.type,o=C.dependencies,v.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext}),u=u.sibling;return qt(on,on.current&1|2),l.child}o=o.sibling}v.tail!==null&&Ut()>_l&&(l.flags|=128,f=!0,hu(v,!1),l.lanes=4194304)}else{if(!f)if(o=_h(C),o!==null){if(l.flags|=128,f=!0,u=o.updateQueue,u!==null&&(l.updateQueue=u,l.flags|=4),hu(v,!0),v.tail===null&&v.tailMode==="hidden"&&!C.alternate&&!tn)return Yn(l),null}else 2*Ut()-v.renderingStartTime>_l&&u!==1073741824&&(l.flags|=128,f=!0,hu(v,!1),l.lanes=4194304);v.isBackwards?(C.sibling=l.child,l.child=C):(u=v.last,u!==null?u.sibling=C:l.child=C,v.last=C)}return v.tail!==null?(l=v.tail,v.rendering=l,v.tail=l.sibling,v.renderingStartTime=Ut(),l.sibling=null,u=on.current,qt(on,f?u&1|2:u&1),l):(Yn(l),null);case 22:case 23:return yg(),f=l.memoizedState!==null,o!==null&&o.memoizedState!==null!==f&&(l.flags|=8192),f&&(l.mode&1)!==0?(Nr&1073741824)!==0&&(Yn(l),l.subtreeFlags&6&&(l.flags|=8192)):Yn(l),null;case 24:return null;case 25:return null}throw Error(t(156,l.tag))}function pE(o,l){switch(jm(l),l.tag){case 1:return fr(l.type)&&fh(),o=l.flags,o&65536?(l.flags=o&-65537|128,l):null;case 3:return wl(),Qt(pr),Qt(Kn),Lm(),o=l.flags,(o&65536)!==0&&(o&128)===0?(l.flags=o&-65537|128,l):null;case 5:return Dm(l),null;case 13:if(Qt(on),o=l.memoizedState,o!==null&&o.dehydrated!==null){if(l.alternate===null)throw Error(t(340));yl()}return o=l.flags,o&65536?(l.flags=o&-65537|128,l):null;case 19:return Qt(on),null;case 4:return wl(),null;case 10:return Pm(l.type._context),null;case 22:case 23:return yg(),null;case 24:return null;default:return null}}var Fh=!1,Xn=!1,fE=typeof WeakSet=="function"?WeakSet:Set,Ue=null;function kl(o,l){var u=o.ref;if(u!==null)if(typeof u=="function")try{u(null)}catch(f){un(o,l,f)}else u.current=null}function sg(o,l,u){try{u()}catch(f){un(o,l,f)}}var xv=!1;function mE(o,l){if(ym=Ms,o=Y0(),cm(o)){if("selectionStart"in o)var u={start:o.selectionStart,end:o.selectionEnd};else e:{u=(u=o.ownerDocument)&&u.defaultView||window;var f=u.getSelection&&u.getSelection();if(f&&f.rangeCount!==0){u=f.anchorNode;var y=f.anchorOffset,v=f.focusNode;f=f.focusOffset;try{u.nodeType,v.nodeType}catch{u=null;break e}var C=0,q=-1,Q=-1,fe=0,Ie=0,Ee=o,je=null;t:for(;;){for(var Ve;Ee!==u||y!==0&&Ee.nodeType!==3||(q=C+y),Ee!==v||f!==0&&Ee.nodeType!==3||(Q=C+f),Ee.nodeType===3&&(C+=Ee.nodeValue.length),(Ve=Ee.firstChild)!==null;)je=Ee,Ee=Ve;for(;;){if(Ee===o)break t;if(je===u&&++fe===y&&(q=C),je===v&&++Ie===f&&(Q=C),(Ve=Ee.nextSibling)!==null)break;Ee=je,je=Ee.parentNode}Ee=Ve}u=q===-1||Q===-1?null:{start:q,end:Q}}else u=null}u=u||{start:0,end:0}}else u=null;for(xm={focusedElem:o,selectionRange:u},Ms=!1,Ue=l;Ue!==null;)if(l=Ue,o=l.child,(l.subtreeFlags&1028)!==0&&o!==null)o.return=l,Ue=o;else for(;Ue!==null;){l=Ue;try{var qe=l.alternate;if((l.flags&1024)!==0)switch(l.tag){case 0:case 11:case 15:break;case 1:if(qe!==null){var Ge=qe.memoizedProps,hn=qe.memoizedState,ue=l.stateNode,te=ue.getSnapshotBeforeUpdate(l.elementType===l.type?Ge:ai(l.type,Ge),hn);ue.__reactInternalSnapshotBeforeUpdate=te}break;case 3:var de=l.stateNode.containerInfo;de.nodeType===1?de.textContent="":de.nodeType===9&&de.documentElement&&de.removeChild(de.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(Ae){un(l,l.return,Ae)}if(o=l.sibling,o!==null){o.return=l.return,Ue=o;break}Ue=l.return}return qe=xv,xv=!1,qe}function pu(o,l,u){var f=l.updateQueue;if(f=f!==null?f.lastEffect:null,f!==null){var y=f=f.next;do{if((y.tag&o)===o){var v=y.destroy;y.destroy=void 0,v!==void 0&&sg(l,u,v)}y=y.next}while(y!==f)}}function Nh(o,l){if(l=l.updateQueue,l=l!==null?l.lastEffect:null,l!==null){var u=l=l.next;do{if((u.tag&o)===o){var f=u.create;u.destroy=f()}u=u.next}while(u!==l)}}function og(o){var l=o.ref;if(l!==null){var u=o.stateNode;switch(o.tag){case 5:o=u;break;default:o=u}typeof l=="function"?l(o):l.current=o}}function bv(o){var l=o.alternate;l!==null&&(o.alternate=null,bv(l)),o.child=null,o.deletions=null,o.sibling=null,o.tag===5&&(l=o.stateNode,l!==null&&(delete l[_i],delete l[nu],delete l[Sm],delete l[XI],delete l[JI])),o.stateNode=null,o.return=null,o.dependencies=null,o.memoizedProps=null,o.memoizedState=null,o.pendingProps=null,o.stateNode=null,o.updateQueue=null}function vv(o){return o.tag===5||o.tag===3||o.tag===4}function wv(o){e:for(;;){for(;o.sibling===null;){if(o.return===null||vv(o.return))return null;o=o.return}for(o.sibling.return=o.return,o=o.sibling;o.tag!==5&&o.tag!==6&&o.tag!==18;){if(o.flags&2||o.child===null||o.tag===4)continue e;o.child.return=o,o=o.child}if(!(o.flags&2))return o.stateNode}}function ag(o,l,u){var f=o.tag;if(f===5||f===6)o=o.stateNode,l?u.nodeType===8?u.parentNode.insertBefore(o,l):u.insertBefore(o,l):(u.nodeType===8?(l=u.parentNode,l.insertBefore(o,u)):(l=u,l.appendChild(o)),u=u._reactRootContainer,u!=null||l.onclick!==null||(l.onclick=hh));else if(f!==4&&(o=o.child,o!==null))for(ag(o,l,u),o=o.sibling;o!==null;)ag(o,l,u),o=o.sibling}function lg(o,l,u){var f=o.tag;if(f===5||f===6)o=o.stateNode,l?u.insertBefore(o,l):u.appendChild(o);else if(f!==4&&(o=o.child,o!==null))for(lg(o,l,u),o=o.sibling;o!==null;)lg(o,l,u),o=o.sibling}var Un=null,li=!1;function Gs(o,l,u){for(u=u.child;u!==null;)Sv(o,l,u),u=u.sibling}function Sv(o,l,u){if(Cr&&typeof Cr.onCommitFiberUnmount=="function")try{Cr.onCommitFiberUnmount(Wo,u)}catch{}switch(u.tag){case 5:Xn||kl(u,l);case 6:var f=Un,y=li;Un=null,Gs(o,l,u),Un=f,li=y,Un!==null&&(li?(o=Un,u=u.stateNode,o.nodeType===8?o.parentNode.removeChild(u):o.removeChild(u)):Un.removeChild(u.stateNode));break;case 18:Un!==null&&(li?(o=Un,u=u.stateNode,o.nodeType===8?wm(o.parentNode,u):o.nodeType===1&&wm(o,u),ri(o)):wm(Un,u.stateNode));break;case 4:f=Un,y=li,Un=u.stateNode.containerInfo,li=!0,Gs(o,l,u),Un=f,li=y;break;case 0:case 11:case 14:case 15:if(!Xn&&(f=u.updateQueue,f!==null&&(f=f.lastEffect,f!==null))){y=f=f.next;do{var v=y,C=v.destroy;v=v.tag,C!==void 0&&((v&2)!==0||(v&4)!==0)&&sg(u,l,C),y=y.next}while(y!==f)}Gs(o,l,u);break;case 1:if(!Xn&&(kl(u,l),f=u.stateNode,typeof f.componentWillUnmount=="function"))try{f.props=u.memoizedProps,f.state=u.memoizedState,f.componentWillUnmount()}catch(q){un(u,l,q)}Gs(o,l,u);break;case 21:Gs(o,l,u);break;case 22:u.mode&1?(Xn=(f=Xn)||u.memoizedState!==null,Gs(o,l,u),Xn=f):Gs(o,l,u);break;default:Gs(o,l,u)}}function kv(o){var l=o.updateQueue;if(l!==null){o.updateQueue=null;var u=o.stateNode;u===null&&(u=o.stateNode=new fE),l.forEach(function(f){var y=TE.bind(null,o,f);u.has(f)||(u.add(f),f.then(y,y))})}}function ci(o,l){var u=l.deletions;if(u!==null)for(var f=0;f<u.length;f++){var y=u[f];try{var v=o,C=l,q=C;e:for(;q!==null;){switch(q.tag){case 5:Un=q.stateNode,li=!1;break e;case 3:Un=q.stateNode.containerInfo,li=!0;break e;case 4:Un=q.stateNode.containerInfo,li=!0;break e}q=q.return}if(Un===null)throw Error(t(160));Sv(v,C,y),Un=null,li=!1;var Q=y.alternate;Q!==null&&(Q.return=null),y.return=null}catch(fe){un(y,l,fe)}}if(l.subtreeFlags&12854)for(l=l.child;l!==null;)Tv(l,o),l=l.sibling}function Tv(o,l){var u=o.alternate,f=o.flags;switch(o.tag){case 0:case 11:case 14:case 15:if(ci(l,o),Ei(o),f&4){try{pu(3,o,o.return),Nh(3,o)}catch(Ge){un(o,o.return,Ge)}try{pu(5,o,o.return)}catch(Ge){un(o,o.return,Ge)}}break;case 1:ci(l,o),Ei(o),f&512&&u!==null&&kl(u,u.return);break;case 5:if(ci(l,o),Ei(o),f&512&&u!==null&&kl(u,u.return),o.flags&32){var y=o.stateNode;try{Ze(y,"")}catch(Ge){un(o,o.return,Ge)}}if(f&4&&(y=o.stateNode,y!=null)){var v=o.memoizedProps,C=u!==null?u.memoizedProps:v,q=o.type,Q=o.updateQueue;if(o.updateQueue=null,Q!==null)try{q==="input"&&v.type==="radio"&&v.name!=null&&pe(y,v),Vt(q,C);var fe=Vt(q,v);for(C=0;C<Q.length;C+=2){var Ie=Q[C],Ee=Q[C+1];Ie==="style"?Gt(y,Ee):Ie==="dangerouslySetInnerHTML"?$e(y,Ee):Ie==="children"?Ze(y,Ee):F(y,Ie,Ee,fe)}switch(q){case"input":Se(y,v);break;case"textarea":oe(y,v);break;case"select":var je=y._wrapperState.wasMultiple;y._wrapperState.wasMultiple=!!v.multiple;var Ve=v.value;Ve!=null?U(y,!!v.multiple,Ve,!1):je!==!!v.multiple&&(v.defaultValue!=null?U(y,!!v.multiple,v.defaultValue,!0):U(y,!!v.multiple,v.multiple?[]:"",!1))}y[nu]=v}catch(Ge){un(o,o.return,Ge)}}break;case 6:if(ci(l,o),Ei(o),f&4){if(o.stateNode===null)throw Error(t(162));y=o.stateNode,v=o.memoizedProps;try{y.nodeValue=v}catch(Ge){un(o,o.return,Ge)}}break;case 3:if(ci(l,o),Ei(o),f&4&&u!==null&&u.memoizedState.isDehydrated)try{ri(l.containerInfo)}catch(Ge){un(o,o.return,Ge)}break;case 4:ci(l,o),Ei(o);break;case 13:ci(l,o),Ei(o),y=o.child,y.flags&8192&&(v=y.memoizedState!==null,y.stateNode.isHidden=v,!v||y.alternate!==null&&y.alternate.memoizedState!==null||(dg=Ut())),f&4&&kv(o);break;case 22:if(Ie=u!==null&&u.memoizedState!==null,o.mode&1?(Xn=(fe=Xn)||Ie,ci(l,o),Xn=fe):ci(l,o),Ei(o),f&8192){if(fe=o.memoizedState!==null,(o.stateNode.isHidden=fe)&&!Ie&&(o.mode&1)!==0)for(Ue=o,Ie=o.child;Ie!==null;){for(Ee=Ue=Ie;Ue!==null;){switch(je=Ue,Ve=je.child,je.tag){case 0:case 11:case 14:case 15:pu(4,je,je.return);break;case 1:kl(je,je.return);var qe=je.stateNode;if(typeof qe.componentWillUnmount=="function"){f=je,u=je.return;try{l=f,qe.props=l.memoizedProps,qe.state=l.memoizedState,qe.componentWillUnmount()}catch(Ge){un(f,u,Ge)}}break;case 5:kl(je,je.return);break;case 22:if(je.memoizedState!==null){Iv(Ee);continue}}Ve!==null?(Ve.return=je,Ue=Ve):Iv(Ee)}Ie=Ie.sibling}e:for(Ie=null,Ee=o;;){if(Ee.tag===5){if(Ie===null){Ie=Ee;try{y=Ee.stateNode,fe?(v=y.style,typeof v.setProperty=="function"?v.setProperty("display","none","important"):v.display="none"):(q=Ee.stateNode,Q=Ee.memoizedProps.style,C=Q!=null&&Q.hasOwnProperty("display")?Q.display:null,q.style.display=Ot("display",C))}catch(Ge){un(o,o.return,Ge)}}}else if(Ee.tag===6){if(Ie===null)try{Ee.stateNode.nodeValue=fe?"":Ee.memoizedProps}catch(Ge){un(o,o.return,Ge)}}else if((Ee.tag!==22&&Ee.tag!==23||Ee.memoizedState===null||Ee===o)&&Ee.child!==null){Ee.child.return=Ee,Ee=Ee.child;continue}if(Ee===o)break e;for(;Ee.sibling===null;){if(Ee.return===null||Ee.return===o)break e;Ie===Ee&&(Ie=null),Ee=Ee.return}Ie===Ee&&(Ie=null),Ee.sibling.return=Ee.return,Ee=Ee.sibling}}break;case 19:ci(l,o),Ei(o),f&4&&kv(o);break;case 21:break;default:ci(l,o),Ei(o)}}function Ei(o){var l=o.flags;if(l&2){try{e:{for(var u=o.return;u!==null;){if(vv(u)){var f=u;break e}u=u.return}throw Error(t(160))}switch(f.tag){case 5:var y=f.stateNode;f.flags&32&&(Ze(y,""),f.flags&=-33);var v=wv(o);lg(o,v,y);break;case 3:case 4:var C=f.stateNode.containerInfo,q=wv(o);ag(o,q,C);break;default:throw Error(t(161))}}catch(Q){un(o,o.return,Q)}o.flags&=-3}l&4096&&(o.flags&=-4097)}function gE(o,l,u){Ue=o,_v(o)}function _v(o,l,u){for(var f=(o.mode&1)!==0;Ue!==null;){var y=Ue,v=y.child;if(y.tag===22&&f){var C=y.memoizedState!==null||Fh;if(!C){var q=y.alternate,Q=q!==null&&q.memoizedState!==null||Xn;q=Fh;var fe=Xn;if(Fh=C,(Xn=Q)&&!fe)for(Ue=y;Ue!==null;)C=Ue,Q=C.child,C.tag===22&&C.memoizedState!==null?Ev(y):Q!==null?(Q.return=C,Ue=Q):Ev(y);for(;v!==null;)Ue=v,_v(v),v=v.sibling;Ue=y,Fh=q,Xn=fe}jv(o)}else(y.subtreeFlags&8772)!==0&&v!==null?(v.return=y,Ue=v):jv(o)}}function jv(o){for(;Ue!==null;){var l=Ue;if((l.flags&8772)!==0){var u=l.alternate;try{if((l.flags&8772)!==0)switch(l.tag){case 0:case 11:case 15:Xn||Nh(5,l);break;case 1:var f=l.stateNode;if(l.flags&4&&!Xn)if(u===null)f.componentDidMount();else{var y=l.elementType===l.type?u.memoizedProps:ai(l.type,u.memoizedProps);f.componentDidUpdate(y,u.memoizedState,f.__reactInternalSnapshotBeforeUpdate)}var v=l.updateQueue;v!==null&&Ib(l,v,f);break;case 3:var C=l.updateQueue;if(C!==null){if(u=null,l.child!==null)switch(l.child.tag){case 5:u=l.child.stateNode;break;case 1:u=l.child.stateNode}Ib(l,C,u)}break;case 5:var q=l.stateNode;if(u===null&&l.flags&4){u=q;var Q=l.memoizedProps;switch(l.type){case"button":case"input":case"select":case"textarea":Q.autoFocus&&u.focus();break;case"img":Q.src&&(u.src=Q.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(l.memoizedState===null){var fe=l.alternate;if(fe!==null){var Ie=fe.memoizedState;if(Ie!==null){var Ee=Ie.dehydrated;Ee!==null&&ri(Ee)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}Xn||l.flags&512&&og(l)}catch(je){un(l,l.return,je)}}if(l===o){Ue=null;break}if(u=l.sibling,u!==null){u.return=l.return,Ue=u;break}Ue=l.return}}function Iv(o){for(;Ue!==null;){var l=Ue;if(l===o){Ue=null;break}var u=l.sibling;if(u!==null){u.return=l.return,Ue=u;break}Ue=l.return}}function Ev(o){for(;Ue!==null;){var l=Ue;try{switch(l.tag){case 0:case 11:case 15:var u=l.return;try{Nh(4,l)}catch(Q){un(l,u,Q)}break;case 1:var f=l.stateNode;if(typeof f.componentDidMount=="function"){var y=l.return;try{f.componentDidMount()}catch(Q){un(l,y,Q)}}var v=l.return;try{og(l)}catch(Q){un(l,v,Q)}break;case 5:var C=l.return;try{og(l)}catch(Q){un(l,C,Q)}}}catch(Q){un(l,l.return,Q)}if(l===o){Ue=null;break}var q=l.sibling;if(q!==null){q.return=l.return,Ue=q;break}Ue=l.return}}var yE=Math.ceil,zh=X.ReactCurrentDispatcher,cg=X.ReactCurrentOwner,Qr=X.ReactCurrentBatchConfig,Tt=0,An=null,yn=null,qn=0,Nr=0,Tl=Ws(0),Sn=0,fu=null,na=0,Dh=0,ug=0,mu=null,gr=null,dg=0,_l=1/0,ss=null,Mh=!1,hg=null,Ks=null,Lh=!1,Qs=null,Oh=0,gu=0,pg=null,Vh=-1,Wh=0;function ar(){return(Tt&6)!==0?Ut():Vh!==-1?Vh:Vh=Ut()}function Ys(o){return(o.mode&1)===0?1:(Tt&2)!==0&&qn!==0?qn&-qn:eE.transition!==null?(Wh===0&&(Wh=qo()),Wh):(o=vt,o!==0||(o=window.event,o=o===void 0?16:qc(o.type)),o)}function ui(o,l,u,f){if(50<gu)throw gu=0,pg=null,Error(t(185));Fs(o,u,f),((Tt&2)===0||o!==An)&&(o===An&&((Tt&2)===0&&(Dh|=u),Sn===4&&Xs(o,qn)),yr(o,f),u===1&&Tt===0&&(l.mode&1)===0&&(_l=Ut()+500,gh&&qs()))}function yr(o,l){var u=o.callbackNode;Gi(o,l);var f=Uo(o,o===An?qn:0);if(f===0)u!==null&&Lc(u),o.callbackNode=null,o.callbackPriority=0;else if(l=f&-f,o.callbackPriority!==l){if(u!=null&&Lc(u),l===1)o.tag===0?ZI(Rv.bind(null,o)):mb(Rv.bind(null,o)),QI(function(){(Tt&6)===0&&qs()}),u=null;else{switch(zs(f)){case 1:u=Vo;break;case 4:u=As;break;case 16:u=Wr;break;case 536870912:u=Wd;break;default:u=Wr}u=Mv(u,Cv.bind(null,o))}o.callbackPriority=l,o.callbackNode=u}}function Cv(o,l){if(Vh=-1,Wh=0,(Tt&6)!==0)throw Error(t(327));var u=o.callbackNode;if(jl()&&o.callbackNode!==u)return null;var f=Uo(o,o===An?qn:0);if(f===0)return null;if((f&30)!==0||(f&o.expiredLanes)!==0||l)l=Uh(o,f);else{l=f;var y=Tt;Tt|=2;var v=Pv();(An!==o||qn!==l)&&(ss=null,_l=Ut()+500,ia(o,l));do try{vE();break}catch(q){Av(o,q)}while(!0);Am(),zh.current=v,Tt=y,yn!==null?l=0:(An=null,qn=0,l=Sn)}if(l!==0){if(l===2&&(y=Rr(o),y!==0&&(f=y,l=fg(o,y))),l===1)throw u=fu,ia(o,0),Xs(o,f),yr(o,Ut()),u;if(l===6)Xs(o,f);else{if(y=o.current.alternate,(f&30)===0&&!xE(y)&&(l=Uh(o,f),l===2&&(v=Rr(o),v!==0&&(f=v,l=fg(o,v))),l===1))throw u=fu,ia(o,0),Xs(o,f),yr(o,Ut()),u;switch(o.finishedWork=y,o.finishedLanes=f,l){case 0:case 1:throw Error(t(345));case 2:sa(o,gr,ss);break;case 3:if(Xs(o,f),(f&130023424)===f&&(l=dg+500-Ut(),10<l)){if(Uo(o,0)!==0)break;if(y=o.suspendedLanes,(y&f)!==f){ar(),o.pingedLanes|=o.suspendedLanes&y;break}o.timeoutHandle=vm(sa.bind(null,o,gr,ss),l);break}sa(o,gr,ss);break;case 4:if(Xs(o,f),(f&4194240)===f)break;for(l=o.eventTimes,y=-1;0<f;){var C=31-ir(f);v=1<<C,C=l[C],C>y&&(y=C),f&=~v}if(f=y,f=Ut()-f,f=(120>f?120:480>f?480:1080>f?1080:1920>f?1920:3e3>f?3e3:4320>f?4320:1960*yE(f/1960))-f,10<f){o.timeoutHandle=vm(sa.bind(null,o,gr,ss),f);break}sa(o,gr,ss);break;case 5:sa(o,gr,ss);break;default:throw Error(t(329))}}}return yr(o,Ut()),o.callbackNode===u?Cv.bind(null,o):null}function fg(o,l){var u=mu;return o.current.memoizedState.isDehydrated&&(ia(o,l).flags|=256),o=Uh(o,l),o!==2&&(l=gr,gr=u,l!==null&&mg(l)),o}function mg(o){gr===null?gr=o:gr.push.apply(gr,o)}function xE(o){for(var l=o;;){if(l.flags&16384){var u=l.updateQueue;if(u!==null&&(u=u.stores,u!==null))for(var f=0;f<u.length;f++){var y=u[f],v=y.getSnapshot;y=y.value;try{if(!si(v(),y))return!1}catch{return!1}}}if(u=l.child,l.subtreeFlags&16384&&u!==null)u.return=l,l=u;else{if(l===o)break;for(;l.sibling===null;){if(l.return===null||l.return===o)return!0;l=l.return}l.sibling.return=l.return,l=l.sibling}}return!0}function Xs(o,l){for(l&=~ug,l&=~Dh,o.suspendedLanes|=l,o.pingedLanes&=~l,o=o.expirationTimes;0<l;){var u=31-ir(l),f=1<<u;o[u]=-1,l&=~f}}function Rv(o){if((Tt&6)!==0)throw Error(t(327));jl();var l=Uo(o,0);if((l&1)===0)return yr(o,Ut()),null;var u=Uh(o,l);if(o.tag!==0&&u===2){var f=Rr(o);f!==0&&(l=f,u=fg(o,f))}if(u===1)throw u=fu,ia(o,0),Xs(o,l),yr(o,Ut()),u;if(u===6)throw Error(t(345));return o.finishedWork=o.current.alternate,o.finishedLanes=l,sa(o,gr,ss),yr(o,Ut()),null}function gg(o,l){var u=Tt;Tt|=1;try{return o(l)}finally{Tt=u,Tt===0&&(_l=Ut()+500,gh&&qs())}}function ra(o){Qs!==null&&Qs.tag===0&&(Tt&6)===0&&jl();var l=Tt;Tt|=1;var u=Qr.transition,f=vt;try{if(Qr.transition=null,vt=1,o)return o()}finally{vt=f,Qr.transition=u,Tt=l,(Tt&6)===0&&qs()}}function yg(){Nr=Tl.current,Qt(Tl)}function ia(o,l){o.finishedWork=null,o.finishedLanes=0;var u=o.timeoutHandle;if(u!==-1&&(o.timeoutHandle=-1,KI(u)),yn!==null)for(u=yn.return;u!==null;){var f=u;switch(jm(f),f.tag){case 1:f=f.type.childContextTypes,f!=null&&fh();break;case 3:wl(),Qt(pr),Qt(Kn),Lm();break;case 5:Dm(f);break;case 4:wl();break;case 13:Qt(on);break;case 19:Qt(on);break;case 10:Pm(f.type._context);break;case 22:case 23:yg()}u=u.return}if(An=o,yn=o=Js(o.current,null),qn=Nr=l,Sn=0,fu=null,ug=Dh=na=0,gr=mu=null,Zo!==null){for(l=0;l<Zo.length;l++)if(u=Zo[l],f=u.interleaved,f!==null){u.interleaved=null;var y=f.next,v=u.pending;if(v!==null){var C=v.next;v.next=y,f.next=C}u.pending=f}Zo=null}return o}function Av(o,l){do{var u=yn;try{if(Am(),jh.current=Rh,Ih){for(var f=an.memoizedState;f!==null;){var y=f.queue;y!==null&&(y.pending=null),f=f.next}Ih=!1}if(ta=0,Rn=wn=an=null,lu=!1,cu=0,cg.current=null,u===null||u.return===null){Sn=1,fu=l,yn=null;break}e:{var v=o,C=u.return,q=u,Q=l;if(l=qn,q.flags|=32768,Q!==null&&typeof Q=="object"&&typeof Q.then=="function"){var fe=Q,Ie=q,Ee=Ie.tag;if((Ie.mode&1)===0&&(Ee===0||Ee===11||Ee===15)){var je=Ie.alternate;je?(Ie.updateQueue=je.updateQueue,Ie.memoizedState=je.memoizedState,Ie.lanes=je.lanes):(Ie.updateQueue=null,Ie.memoizedState=null)}var Ve=nv(C);if(Ve!==null){Ve.flags&=-257,rv(Ve,C,q,v,l),Ve.mode&1&&tv(v,fe,l),l=Ve,Q=fe;var qe=l.updateQueue;if(qe===null){var Ge=new Set;Ge.add(Q),l.updateQueue=Ge}else qe.add(Q);break e}else{if((l&1)===0){tv(v,fe,l),xg();break e}Q=Error(t(426))}}else if(tn&&q.mode&1){var hn=nv(C);if(hn!==null){(hn.flags&65536)===0&&(hn.flags|=256),rv(hn,C,q,v,l),Cm(Sl(Q,q));break e}}v=Q=Sl(Q,q),Sn!==4&&(Sn=2),mu===null?mu=[v]:mu.push(v),v=C;do{switch(v.tag){case 3:v.flags|=65536,l&=-l,v.lanes|=l;var ue=Zb(v,Q,l);jb(v,ue);break e;case 1:q=Q;var te=v.type,de=v.stateNode;if((v.flags&128)===0&&(typeof te.getDerivedStateFromError=="function"||de!==null&&typeof de.componentDidCatch=="function"&&(Ks===null||!Ks.has(de)))){v.flags|=65536,l&=-l,v.lanes|=l;var Ae=ev(v,q,l);jb(v,Ae);break e}}v=v.return}while(v!==null)}Fv(u)}catch(Qe){l=Qe,yn===u&&u!==null&&(yn=u=u.return);continue}break}while(!0)}function Pv(){var o=zh.current;return zh.current=Rh,o===null?Rh:o}function xg(){(Sn===0||Sn===3||Sn===2)&&(Sn=4),An===null||(na&268435455)===0&&(Dh&268435455)===0||Xs(An,qn)}function Uh(o,l){var u=Tt;Tt|=2;var f=Pv();(An!==o||qn!==l)&&(ss=null,ia(o,l));do try{bE();break}catch(y){Av(o,y)}while(!0);if(Am(),Tt=u,zh.current=f,yn!==null)throw Error(t(261));return An=null,qn=0,Sn}function bE(){for(;yn!==null;)Bv(yn)}function vE(){for(;yn!==null&&!Od();)Bv(yn)}function Bv(o){var l=Dv(o.alternate,o,Nr);o.memoizedProps=o.pendingProps,l===null?Fv(o):yn=l,cg.current=null}function Fv(o){var l=o;do{var u=l.alternate;if(o=l.return,(l.flags&32768)===0){if(u=hE(u,l,Nr),u!==null){yn=u;return}}else{if(u=pE(u,l),u!==null){u.flags&=32767,yn=u;return}if(o!==null)o.flags|=32768,o.subtreeFlags=0,o.deletions=null;else{Sn=6,yn=null;return}}if(l=l.sibling,l!==null){yn=l;return}yn=l=o}while(l!==null);Sn===0&&(Sn=5)}function sa(o,l,u){var f=vt,y=Qr.transition;try{Qr.transition=null,vt=1,wE(o,l,u,f)}finally{Qr.transition=y,vt=f}return null}function wE(o,l,u,f){do jl();while(Qs!==null);if((Tt&6)!==0)throw Error(t(327));u=o.finishedWork;var y=o.finishedLanes;if(u===null)return null;if(o.finishedWork=null,o.finishedLanes=0,u===o.current)throw Error(t(177));o.callbackNode=null,o.callbackPriority=0;var v=u.lanes|u.childLanes;if(Dt(o,v),o===An&&(yn=An=null,qn=0),(u.subtreeFlags&2064)===0&&(u.flags&2064)===0||Lh||(Lh=!0,Mv(Wr,function(){return jl(),null})),v=(u.flags&15990)!==0,(u.subtreeFlags&15990)!==0||v){v=Qr.transition,Qr.transition=null;var C=vt;vt=1;var q=Tt;Tt|=4,cg.current=null,mE(o,u),Tv(u,o),VI(xm),Ms=!!ym,xm=ym=null,o.current=u,gE(u),tm(),Tt=q,vt=C,Qr.transition=v}else o.current=u;if(Lh&&(Lh=!1,Qs=o,Oh=y),v=o.pendingLanes,v===0&&(Ks=null),Ud(u.stateNode),yr(o,Ut()),l!==null)for(f=o.onRecoverableError,u=0;u<l.length;u++)y=l[u],f(y.value,{componentStack:y.stack,digest:y.digest});if(Mh)throw Mh=!1,o=hg,hg=null,o;return(Oh&1)!==0&&o.tag!==0&&jl(),v=o.pendingLanes,(v&1)!==0?o===pg?gu++:(gu=0,pg=o):gu=0,qs(),null}function jl(){if(Qs!==null){var o=zs(Oh),l=Qr.transition,u=vt;try{if(Qr.transition=null,vt=16>o?16:o,Qs===null)var f=!1;else{if(o=Qs,Qs=null,Oh=0,(Tt&6)!==0)throw Error(t(331));var y=Tt;for(Tt|=4,Ue=o.current;Ue!==null;){var v=Ue,C=v.child;if((Ue.flags&16)!==0){var q=v.deletions;if(q!==null){for(var Q=0;Q<q.length;Q++){var fe=q[Q];for(Ue=fe;Ue!==null;){var Ie=Ue;switch(Ie.tag){case 0:case 11:case 15:pu(8,Ie,v)}var Ee=Ie.child;if(Ee!==null)Ee.return=Ie,Ue=Ee;else for(;Ue!==null;){Ie=Ue;var je=Ie.sibling,Ve=Ie.return;if(bv(Ie),Ie===fe){Ue=null;break}if(je!==null){je.return=Ve,Ue=je;break}Ue=Ve}}}var qe=v.alternate;if(qe!==null){var Ge=qe.child;if(Ge!==null){qe.child=null;do{var hn=Ge.sibling;Ge.sibling=null,Ge=hn}while(Ge!==null)}}Ue=v}}if((v.subtreeFlags&2064)!==0&&C!==null)C.return=v,Ue=C;else e:for(;Ue!==null;){if(v=Ue,(v.flags&2048)!==0)switch(v.tag){case 0:case 11:case 15:pu(9,v,v.return)}var ue=v.sibling;if(ue!==null){ue.return=v.return,Ue=ue;break e}Ue=v.return}}var te=o.current;for(Ue=te;Ue!==null;){C=Ue;var de=C.child;if((C.subtreeFlags&2064)!==0&&de!==null)de.return=C,Ue=de;else e:for(C=te;Ue!==null;){if(q=Ue,(q.flags&2048)!==0)try{switch(q.tag){case 0:case 11:case 15:Nh(9,q)}}catch(Qe){un(q,q.return,Qe)}if(q===C){Ue=null;break e}var Ae=q.sibling;if(Ae!==null){Ae.return=q.return,Ue=Ae;break e}Ue=q.return}}if(Tt=y,qs(),Cr&&typeof Cr.onPostCommitFiberRoot=="function")try{Cr.onPostCommitFiberRoot(Wo,o)}catch{}f=!0}return f}finally{vt=u,Qr.transition=l}}return!1}function Nv(o,l,u){l=Sl(u,l),l=Zb(o,l,1),o=$s(o,l,1),l=ar(),o!==null&&(Fs(o,1,l),yr(o,l))}function un(o,l,u){if(o.tag===3)Nv(o,o,u);else for(;l!==null;){if(l.tag===3){Nv(l,o,u);break}else if(l.tag===1){var f=l.stateNode;if(typeof l.type.getDerivedStateFromError=="function"||typeof f.componentDidCatch=="function"&&(Ks===null||!Ks.has(f))){o=Sl(u,o),o=ev(l,o,1),l=$s(l,o,1),o=ar(),l!==null&&(Fs(l,1,o),yr(l,o));break}}l=l.return}}function SE(o,l,u){var f=o.pingCache;f!==null&&f.delete(l),l=ar(),o.pingedLanes|=o.suspendedLanes&u,An===o&&(qn&u)===u&&(Sn===4||Sn===3&&(qn&130023424)===qn&&500>Ut()-dg?ia(o,0):ug|=u),yr(o,l)}function zv(o,l){l===0&&((o.mode&1)===0?l=1:(l=Qa,Qa<<=1,(Qa&130023424)===0&&(Qa=4194304)));var u=ar();o=ns(o,l),o!==null&&(Fs(o,l,u),yr(o,u))}function kE(o){var l=o.memoizedState,u=0;l!==null&&(u=l.retryLane),zv(o,u)}function TE(o,l){var u=0;switch(o.tag){case 13:var f=o.stateNode,y=o.memoizedState;y!==null&&(u=y.retryLane);break;case 19:f=o.stateNode;break;default:throw Error(t(314))}f!==null&&f.delete(l),zv(o,u)}var Dv;Dv=function(o,l,u){if(o!==null)if(o.memoizedProps!==l.pendingProps||pr.current)mr=!0;else{if((o.lanes&u)===0&&(l.flags&128)===0)return mr=!1,dE(o,l,u);mr=(o.flags&131072)!==0}else mr=!1,tn&&(l.flags&1048576)!==0&&gb(l,xh,l.index);switch(l.lanes=0,l.tag){case 2:var f=l.type;Bh(o,l),o=l.pendingProps;var y=fl(l,Kn.current);vl(l,u),y=Wm(null,l,f,o,y,u);var v=Um();return l.flags|=1,typeof y=="object"&&y!==null&&typeof y.render=="function"&&y.$$typeof===void 0?(l.tag=1,l.memoizedState=null,l.updateQueue=null,fr(f)?(v=!0,mh(l)):v=!1,l.memoizedState=y.state!==null&&y.state!==void 0?y.state:null,Nm(l),y.updater=Ah,l.stateNode=y,y._reactInternals=l,Qm(l,f,o,u),l=Zm(null,l,f,!0,v,u)):(l.tag=0,tn&&v&&_m(l),or(null,l,y,u),l=l.child),l;case 16:f=l.elementType;e:{switch(Bh(o,l),o=l.pendingProps,y=f._init,f=y(f._payload),l.type=f,y=l.tag=jE(f),o=ai(f,o),y){case 0:l=Jm(null,l,f,o,u);break e;case 1:l=cv(null,l,f,o,u);break e;case 11:l=iv(null,l,f,o,u);break e;case 14:l=sv(null,l,f,ai(f.type,o),u);break e}throw Error(t(306,f,""))}return l;case 0:return f=l.type,y=l.pendingProps,y=l.elementType===f?y:ai(f,y),Jm(o,l,f,y,u);case 1:return f=l.type,y=l.pendingProps,y=l.elementType===f?y:ai(f,y),cv(o,l,f,y,u);case 3:e:{if(uv(l),o===null)throw Error(t(387));f=l.pendingProps,v=l.memoizedState,y=v.element,_b(o,l),Th(l,f,null,u);var C=l.memoizedState;if(f=C.element,v.isDehydrated)if(v={element:f,isDehydrated:!1,cache:C.cache,pendingSuspenseBoundaries:C.pendingSuspenseBoundaries,transitions:C.transitions},l.updateQueue.baseState=v,l.memoizedState=v,l.flags&256){y=Sl(Error(t(423)),l),l=dv(o,l,f,u,y);break e}else if(f!==y){y=Sl(Error(t(424)),l),l=dv(o,l,f,u,y);break e}else for(Fr=Vs(l.stateNode.containerInfo.firstChild),Br=l,tn=!0,oi=null,u=kb(l,null,f,u),l.child=u;u;)u.flags=u.flags&-3|4096,u=u.sibling;else{if(yl(),f===y){l=is(o,l,u);break e}or(o,l,f,u)}l=l.child}return l;case 5:return Eb(l),o===null&&Em(l),f=l.type,y=l.pendingProps,v=o!==null?o.memoizedProps:null,C=y.children,bm(f,y)?C=null:v!==null&&bm(f,v)&&(l.flags|=32),lv(o,l),or(o,l,C,u),l.child;case 6:return o===null&&Em(l),null;case 13:return hv(o,l,u);case 4:return zm(l,l.stateNode.containerInfo),f=l.pendingProps,o===null?l.child=xl(l,null,f,u):or(o,l,f,u),l.child;case 11:return f=l.type,y=l.pendingProps,y=l.elementType===f?y:ai(f,y),iv(o,l,f,y,u);case 7:return or(o,l,l.pendingProps,u),l.child;case 8:return or(o,l,l.pendingProps.children,u),l.child;case 12:return or(o,l,l.pendingProps.children,u),l.child;case 10:e:{if(f=l.type._context,y=l.pendingProps,v=l.memoizedProps,C=y.value,qt(wh,f._currentValue),f._currentValue=C,v!==null)if(si(v.value,C)){if(v.children===y.children&&!pr.current){l=is(o,l,u);break e}}else for(v=l.child,v!==null&&(v.return=l);v!==null;){var q=v.dependencies;if(q!==null){C=v.child;for(var Q=q.firstContext;Q!==null;){if(Q.context===f){if(v.tag===1){Q=rs(-1,u&-u),Q.tag=2;var fe=v.updateQueue;if(fe!==null){fe=fe.shared;var Ie=fe.pending;Ie===null?Q.next=Q:(Q.next=Ie.next,Ie.next=Q),fe.pending=Q}}v.lanes|=u,Q=v.alternate,Q!==null&&(Q.lanes|=u),Bm(v.return,u,l),q.lanes|=u;break}Q=Q.next}}else if(v.tag===10)C=v.type===l.type?null:v.child;else if(v.tag===18){if(C=v.return,C===null)throw Error(t(341));C.lanes|=u,q=C.alternate,q!==null&&(q.lanes|=u),Bm(C,u,l),C=v.sibling}else C=v.child;if(C!==null)C.return=v;else for(C=v;C!==null;){if(C===l){C=null;break}if(v=C.sibling,v!==null){v.return=C.return,C=v;break}C=C.return}v=C}or(o,l,y.children,u),l=l.child}return l;case 9:return y=l.type,f=l.pendingProps.children,vl(l,u),y=Gr(y),f=f(y),l.flags|=1,or(o,l,f,u),l.child;case 14:return f=l.type,y=ai(f,l.pendingProps),y=ai(f.type,y),sv(o,l,f,y,u);case 15:return ov(o,l,l.type,l.pendingProps,u);case 17:return f=l.type,y=l.pendingProps,y=l.elementType===f?y:ai(f,y),Bh(o,l),l.tag=1,fr(f)?(o=!0,mh(l)):o=!1,vl(l,u),Xb(l,f,y),Qm(l,f,y,u),Zm(null,l,f,!0,o,u);case 19:return fv(o,l,u);case 22:return av(o,l,u)}throw Error(t(156,l.tag))};function Mv(o,l){return Ga(o,l)}function _E(o,l,u,f){this.tag=o,this.key=u,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=l,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=f,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Yr(o,l,u,f){return new _E(o,l,u,f)}function bg(o){return o=o.prototype,!(!o||!o.isReactComponent)}function jE(o){if(typeof o=="function")return bg(o)?1:0;if(o!=null){if(o=o.$$typeof,o===z)return 11;if(o===Z)return 14}return 2}function Js(o,l){var u=o.alternate;return u===null?(u=Yr(o.tag,l,o.key,o.mode),u.elementType=o.elementType,u.type=o.type,u.stateNode=o.stateNode,u.alternate=o,o.alternate=u):(u.pendingProps=l,u.type=o.type,u.flags=0,u.subtreeFlags=0,u.deletions=null),u.flags=o.flags&14680064,u.childLanes=o.childLanes,u.lanes=o.lanes,u.child=o.child,u.memoizedProps=o.memoizedProps,u.memoizedState=o.memoizedState,u.updateQueue=o.updateQueue,l=o.dependencies,u.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext},u.sibling=o.sibling,u.index=o.index,u.ref=o.ref,u}function qh(o,l,u,f,y,v){var C=2;if(f=o,typeof o=="function")bg(o)&&(C=1);else if(typeof o=="string")C=5;else e:switch(o){case N:return oa(u.children,y,v,l);case E:C=8,y|=8;break;case P:return o=Yr(12,u,l,y|2),o.elementType=P,o.lanes=v,o;case j:return o=Yr(13,u,l,y),o.elementType=j,o.lanes=v,o;case K:return o=Yr(19,u,l,y),o.elementType=K,o.lanes=v,o;case ae:return Hh(u,y,v,l);default:if(typeof o=="object"&&o!==null)switch(o.$$typeof){case M:C=10;break e;case O:C=9;break e;case z:C=11;break e;case Z:C=14;break e;case Y:C=16,f=null;break e}throw Error(t(130,o==null?o:typeof o,""))}return l=Yr(C,u,l,y),l.elementType=o,l.type=f,l.lanes=v,l}function oa(o,l,u,f){return o=Yr(7,o,f,l),o.lanes=u,o}function Hh(o,l,u,f){return o=Yr(22,o,f,l),o.elementType=ae,o.lanes=u,o.stateNode={isHidden:!1},o}function vg(o,l,u){return o=Yr(6,o,null,l),o.lanes=u,o}function wg(o,l,u){return l=Yr(4,o.children!==null?o.children:[],o.key,l),l.lanes=u,l.stateNode={containerInfo:o.containerInfo,pendingChildren:null,implementation:o.implementation},l}function IE(o,l,u,f,y){this.tag=l,this.containerInfo=o,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Bs(0),this.expirationTimes=Bs(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Bs(0),this.identifierPrefix=f,this.onRecoverableError=y,this.mutableSourceEagerHydrationData=null}function Sg(o,l,u,f,y,v,C,q,Q){return o=new IE(o,l,u,q,Q),l===1?(l=1,v===!0&&(l|=8)):l=0,v=Yr(3,null,null,l),o.current=v,v.stateNode=o,v.memoizedState={element:f,isDehydrated:u,cache:null,transitions:null,pendingSuspenseBoundaries:null},Nm(v),o}function EE(o,l,u){var f=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:G,key:f==null?null:""+f,children:o,containerInfo:l,implementation:u}}function Lv(o){if(!o)return Us;o=o._reactInternals;e:{if(Jr(o)!==o||o.tag!==1)throw Error(t(170));var l=o;do{switch(l.tag){case 3:l=l.stateNode.context;break e;case 1:if(fr(l.type)){l=l.stateNode.__reactInternalMemoizedMergedChildContext;break e}}l=l.return}while(l!==null);throw Error(t(171))}if(o.tag===1){var u=o.type;if(fr(u))return pb(o,u,l)}return l}function Ov(o,l,u,f,y,v,C,q,Q){return o=Sg(u,f,!0,o,y,v,C,q,Q),o.context=Lv(null),u=o.current,f=ar(),y=Ys(u),v=rs(f,y),v.callback=l??null,$s(u,v,y),o.current.lanes=y,Fs(o,y,f),yr(o,f),o}function $h(o,l,u,f){var y=l.current,v=ar(),C=Ys(y);return u=Lv(u),l.context===null?l.context=u:l.pendingContext=u,l=rs(v,C),l.payload={element:o},f=f===void 0?null:f,f!==null&&(l.callback=f),o=$s(y,l,C),o!==null&&(ui(o,y,C,v),kh(o,y,C)),C}function Gh(o){if(o=o.current,!o.child)return null;switch(o.child.tag){case 5:return o.child.stateNode;default:return o.child.stateNode}}function Vv(o,l){if(o=o.memoizedState,o!==null&&o.dehydrated!==null){var u=o.retryLane;o.retryLane=u!==0&&u<l?u:l}}function kg(o,l){Vv(o,l),(o=o.alternate)&&Vv(o,l)}function CE(){return null}var Wv=typeof reportError=="function"?reportError:function(o){console.error(o)};function Tg(o){this._internalRoot=o}Kh.prototype.render=Tg.prototype.render=function(o){var l=this._internalRoot;if(l===null)throw Error(t(409));$h(o,l,null,null)},Kh.prototype.unmount=Tg.prototype.unmount=function(){var o=this._internalRoot;if(o!==null){this._internalRoot=null;var l=o.containerInfo;ra(function(){$h(null,o,null,null)}),l[Ji]=null}};function Kh(o){this._internalRoot=o}Kh.prototype.unstable_scheduleHydration=function(o){if(o){var l=Kd();o={blockedOn:null,target:o,priority:l};for(var u=0;u<wi.length&&l!==0&&l<wi[u].priority;u++);wi.splice(u,0,o),u===0&&Xd(o)}};function _g(o){return!(!o||o.nodeType!==1&&o.nodeType!==9&&o.nodeType!==11)}function Qh(o){return!(!o||o.nodeType!==1&&o.nodeType!==9&&o.nodeType!==11&&(o.nodeType!==8||o.nodeValue!==" react-mount-point-unstable "))}function Uv(){}function RE(o,l,u,f,y){if(y){if(typeof f=="function"){var v=f;f=function(){var fe=Gh(C);v.call(fe)}}var C=Ov(l,f,o,0,null,!1,!1,"",Uv);return o._reactRootContainer=C,o[Ji]=C.current,eu(o.nodeType===8?o.parentNode:o),ra(),C}for(;y=o.lastChild;)o.removeChild(y);if(typeof f=="function"){var q=f;f=function(){var fe=Gh(Q);q.call(fe)}}var Q=Sg(o,0,!1,null,null,!1,!1,"",Uv);return o._reactRootContainer=Q,o[Ji]=Q.current,eu(o.nodeType===8?o.parentNode:o),ra(function(){$h(l,Q,u,f)}),Q}function Yh(o,l,u,f,y){var v=u._reactRootContainer;if(v){var C=v;if(typeof y=="function"){var q=y;y=function(){var Q=Gh(C);q.call(Q)}}$h(l,C,o,y)}else C=RE(u,l,o,y,f);return Gh(C)}$d=function(o){switch(o.tag){case 3:var l=o.stateNode;if(l.current.memoizedState.isDehydrated){var u=Ps(l.pendingLanes);u!==0&&(Ns(l,u|1),yr(l,Ut()),(Tt&6)===0&&(_l=Ut()+500,qs()))}break;case 13:ra(function(){var f=ns(o,1);if(f!==null){var y=ar();ui(f,o,1,y)}}),kg(o,1)}},Ya=function(o){if(o.tag===13){var l=ns(o,134217728);if(l!==null){var u=ar();ui(l,o,134217728,u)}kg(o,134217728)}},Gd=function(o){if(o.tag===13){var l=Ys(o),u=ns(o,l);if(u!==null){var f=ar();ui(u,o,l,f)}kg(o,l)}},Kd=function(){return vt},Qd=function(o,l){var u=vt;try{return vt=o,l()}finally{vt=u}},On=function(o,l,u){switch(l){case"input":if(Se(o,u),l=u.name,u.type==="radio"&&l!=null){for(u=o;u.parentNode;)u=u.parentNode;for(u=u.querySelectorAll("input[name="+JSON.stringify(""+l)+'][type="radio"]'),l=0;l<u.length;l++){var f=u[l];if(f!==o&&f.form===o.form){var y=ph(f);if(!y)throw Error(t(90));De(f),Se(f,y)}}}break;case"textarea":oe(o,u);break;case"select":l=u.value,l!=null&&U(o,!!u.multiple,l,!1)}},yi=gg,Cs=ra;var AE={usingClientEntryPoint:!1,Events:[ru,hl,ph,Er,Es,gg]},yu={findFiberByHostInstance:Qo,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},PE={bundleType:yu.bundleType,version:yu.version,rendererPackageName:yu.rendererPackageName,rendererConfig:yu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:X.ReactCurrentDispatcher,findHostInstanceByFiber:function(o){return o=Mc(o),o===null?null:o.stateNode},findFiberByHostInstance:yu.findFiberByHostInstance||CE,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Xh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Xh.isDisabled&&Xh.supportsFiber)try{Wo=Xh.inject(PE),Cr=Xh}catch{}}return xr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=AE,xr.createPortal=function(o,l){var u=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!_g(l))throw Error(t(200));return EE(o,l,null,u)},xr.createRoot=function(o,l){if(!_g(o))throw Error(t(299));var u=!1,f="",y=Wv;return l!=null&&(l.unstable_strictMode===!0&&(u=!0),l.identifierPrefix!==void 0&&(f=l.identifierPrefix),l.onRecoverableError!==void 0&&(y=l.onRecoverableError)),l=Sg(o,1,!1,null,null,u,!1,f,y),o[Ji]=l.current,eu(o.nodeType===8?o.parentNode:o),new Tg(l)},xr.findDOMNode=function(o){if(o==null)return null;if(o.nodeType===1)return o;var l=o._reactInternals;if(l===void 0)throw typeof o.render=="function"?Error(t(188)):(o=Object.keys(o).join(","),Error(t(268,o)));return o=Mc(l),o=o===null?null:o.stateNode,o},xr.flushSync=function(o){return ra(o)},xr.hydrate=function(o,l,u){if(!Qh(l))throw Error(t(200));return Yh(null,o,l,!0,u)},xr.hydrateRoot=function(o,l,u){if(!_g(o))throw Error(t(405));var f=u!=null&&u.hydratedSources||null,y=!1,v="",C=Wv;if(u!=null&&(u.unstable_strictMode===!0&&(y=!0),u.identifierPrefix!==void 0&&(v=u.identifierPrefix),u.onRecoverableError!==void 0&&(C=u.onRecoverableError)),l=Ov(l,null,o,1,u??null,y,!1,v,C),o[Ji]=l.current,eu(o),f)for(o=0;o<f.length;o++)u=f[o],y=u._getVersion,y=y(u._source),l.mutableSourceEagerHydrationData==null?l.mutableSourceEagerHydrationData=[u,y]:l.mutableSourceEagerHydrationData.push(u,y);return new Kh(l)},xr.render=function(o,l,u){if(!Qh(l))throw Error(t(200));return Yh(null,o,l,!1,u)},xr.unmountComponentAtNode=function(o){if(!Qh(o))throw Error(t(40));return o._reactRootContainer?(ra(function(){Yh(null,null,o,!1,function(){o._reactRootContainer=null,o[Ji]=null})}),!0):!1},xr.unstable_batchedUpdates=gg,xr.unstable_renderSubtreeIntoContainer=function(o,l,u,f){if(!Qh(u))throw Error(t(200));if(o==null||o._reactInternals===void 0)throw Error(t(38));return Yh(o,l,u,!1,f)},xr.version="18.3.1-next-f1338f8080-20240426",xr}var Xv;function uk(){if(Xv)return Eg.exports;Xv=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),Eg.exports=VE(),Eg.exports}var Jv;function WE(){if(Jv)return Jh;Jv=1;var n=uk();return Jh.createRoot=n.createRoot,Jh.hydrateRoot=n.hydrateRoot,Jh}var UE=WE(),w=ix();const _n=NE(w),qE=FE({__proto__:null,default:_n},[w]);uk();/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function $u(){return $u=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},$u.apply(this,arguments)}var ao;(function(n){n.Pop="POP",n.Push="PUSH",n.Replace="REPLACE"})(ao||(ao={}));const Zv="popstate";function HE(n){n===void 0&&(n={});function e(r,s){let{pathname:a,search:c,hash:d}=r.location;return oy("",{pathname:a,search:c,hash:d},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function t(r,s){return typeof s=="string"?s:hk(s)}return GE(e,t,null,n)}function jn(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function dk(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function $E(){return Math.random().toString(36).substr(2,8)}function ew(n,e){return{usr:n.state,key:n.key,idx:e}}function oy(n,e,t,r){return t===void 0&&(t=null),$u({pathname:typeof n=="string"?n:n.pathname,search:"",hash:""},typeof e=="string"?bc(e):e,{state:t,key:e&&e.key||r||$E()})}function hk(n){let{pathname:e="/",search:t="",hash:r=""}=n;return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function bc(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substr(t),n=n.substr(0,t));let r=n.indexOf("?");r>=0&&(e.search=n.substr(r),n=n.substr(0,r)),n&&(e.pathname=n)}return e}function GE(n,e,t,r){r===void 0&&(r={});let{window:s=document.defaultView,v5Compat:a=!1}=r,c=s.history,d=ao.Pop,h=null,m=g();m==null&&(m=0,c.replaceState($u({},c.state,{idx:m}),""));function g(){return(c.state||{idx:null}).idx}function x(){d=ao.Pop;let T=g(),A=T==null?null:T-m;m=T,h&&h({action:d,location:R.location,delta:A})}function S(T,A){d=ao.Push;let D=oy(R.location,T,A);m=g()+1;let F=ew(D,m),X=R.createHref(D);try{c.pushState(F,"",X)}catch(ie){if(ie instanceof DOMException&&ie.name==="DataCloneError")throw ie;s.location.assign(X)}a&&h&&h({action:d,location:R.location,delta:1})}function I(T,A){d=ao.Replace;let D=oy(R.location,T,A);m=g();let F=ew(D,m),X=R.createHref(D);c.replaceState(F,"",X),a&&h&&h({action:d,location:R.location,delta:0})}function _(T){let A=s.location.origin!=="null"?s.location.origin:s.location.href,D=typeof T=="string"?T:hk(T);return D=D.replace(/ $/,"%20"),jn(A,"No window.location.(origin|href) available to create URL for href: "+D),new URL(D,A)}let R={get action(){return d},get location(){return n(s,c)},listen(T){if(h)throw new Error("A history only accepts one active listener");return s.addEventListener(Zv,x),h=T,()=>{s.removeEventListener(Zv,x),h=null}},createHref(T){return e(s,T)},createURL:_,encodeLocation(T){let A=_(T);return{pathname:A.pathname,search:A.search,hash:A.hash}},push:S,replace:I,go(T){return c.go(T)}};return R}var tw;(function(n){n.data="data",n.deferred="deferred",n.redirect="redirect",n.error="error"})(tw||(tw={}));function KE(n,e,t){return t===void 0&&(t="/"),QE(n,e,t)}function QE(n,e,t,r){let s=typeof e=="string"?bc(e):e,a=mk(s.pathname||"/",t);if(a==null)return null;let c=pk(n);YE(c);let d=null;for(let h=0;d==null&&h<c.length;++h){let m=lC(a);d=sC(c[h],m)}return d}function pk(n,e,t,r){e===void 0&&(e=[]),t===void 0&&(t=[]),r===void 0&&(r="");let s=(a,c,d)=>{let h={relativePath:d===void 0?a.path||"":d,caseSensitive:a.caseSensitive===!0,childrenIndex:c,route:a};h.relativePath.startsWith("/")&&(jn(h.relativePath.startsWith(r),'Absolute route path "'+h.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),h.relativePath=h.relativePath.slice(r.length));let m=ba([r,h.relativePath]),g=t.concat(h);a.children&&a.children.length>0&&(jn(a.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+m+'".')),pk(a.children,e,g,m)),!(a.path==null&&!a.index)&&e.push({path:m,score:rC(m,a.index),routesMeta:g})};return n.forEach((a,c)=>{var d;if(a.path===""||!((d=a.path)!=null&&d.includes("?")))s(a,c);else for(let h of fk(a.path))s(a,c,h)}),e}function fk(n){let e=n.split("/");if(e.length===0)return[];let[t,...r]=e,s=t.endsWith("?"),a=t.replace(/\?$/,"");if(r.length===0)return s?[a,""]:[a];let c=fk(r.join("/")),d=[];return d.push(...c.map(h=>h===""?a:[a,h].join("/"))),s&&d.push(...c),d.map(h=>n.startsWith("/")&&h===""?"/":h)}function YE(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:iC(e.routesMeta.map(r=>r.childrenIndex),t.routesMeta.map(r=>r.childrenIndex)))}const XE=/^:[\w-]+$/,JE=3,ZE=2,eC=1,tC=10,nC=-2,nw=n=>n==="*";function rC(n,e){let t=n.split("/"),r=t.length;return t.some(nw)&&(r+=nC),e&&(r+=ZE),t.filter(s=>!nw(s)).reduce((s,a)=>s+(XE.test(a)?JE:a===""?eC:tC),r)}function iC(n,e){return n.length===e.length&&n.slice(0,-1).every((r,s)=>r===e[s])?n[n.length-1]-e[e.length-1]:0}function sC(n,e,t){let{routesMeta:r}=n,s={},a="/",c=[];for(let d=0;d<r.length;++d){let h=r[d],m=d===r.length-1,g=a==="/"?e:e.slice(a.length)||"/",x=oC({path:h.relativePath,caseSensitive:h.caseSensitive,end:m},g),S=h.route;if(!x)return null;Object.assign(s,x.params),c.push({params:s,pathname:ba([a,x.pathname]),pathnameBase:fC(ba([a,x.pathnameBase])),route:S}),x.pathnameBase!=="/"&&(a=ba([a,x.pathnameBase]))}return c}function oC(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,r]=aC(n.path,n.caseSensitive,n.end),s=e.match(t);if(!s)return null;let a=s[0],c=a.replace(/(.)\/+$/,"$1"),d=s.slice(1);return{params:r.reduce((m,g,x)=>{let{paramName:S,isOptional:I}=g;if(S==="*"){let R=d[x]||"";c=a.slice(0,a.length-R.length).replace(/(.)\/+$/,"$1")}const _=d[x];return I&&!_?m[S]=void 0:m[S]=(_||"").replace(/%2F/g,"/"),m},{}),pathname:a,pathnameBase:c,pattern:n}}function aC(n,e,t){e===void 0&&(e=!1),t===void 0&&(t=!0),dk(n==="*"||!n.endsWith("*")||n.endsWith("/*"),'Route path "'+n+'" will be treated as if it were '+('"'+n.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+n.replace(/\*$/,"/*")+'".'));let r=[],s="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(c,d,h)=>(r.push({paramName:d,isOptional:h!=null}),h?"/?([^\\/]+)?":"/([^\\/]+)"));return n.endsWith("*")?(r.push({paramName:"*"}),s+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?s+="\\/*$":n!==""&&n!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),r]}function lC(n){try{return n.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return dk(!1,'The URL path "'+n+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),n}}function mk(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,r=n.charAt(t);return r&&r!=="/"?null:n.slice(t)||"/"}function cC(n,e){e===void 0&&(e="/");let{pathname:t,search:r="",hash:s=""}=typeof n=="string"?bc(n):n;return{pathname:t?t.startsWith("/")?t:uC(t,e):e,search:mC(r),hash:gC(s)}}function uC(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(s=>{s===".."?t.length>1&&t.pop():s!=="."&&t.push(s)}),t.length>1?t.join("/"):"/"}function Ag(n,e,t,r){return"Cannot include a '"+n+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+t+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function dC(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function hC(n,e){let t=dC(n);return e?t.map((r,s)=>s===t.length-1?r.pathname:r.pathnameBase):t.map(r=>r.pathnameBase)}function pC(n,e,t,r){r===void 0&&(r=!1);let s;typeof n=="string"?s=bc(n):(s=$u({},n),jn(!s.pathname||!s.pathname.includes("?"),Ag("?","pathname","search",s)),jn(!s.pathname||!s.pathname.includes("#"),Ag("#","pathname","hash",s)),jn(!s.search||!s.search.includes("#"),Ag("#","search","hash",s)));let a=n===""||s.pathname==="",c=a?"/":s.pathname,d;if(c==null)d=t;else{let x=e.length-1;if(!r&&c.startsWith("..")){let S=c.split("/");for(;S[0]==="..";)S.shift(),x-=1;s.pathname=S.join("/")}d=x>=0?e[x]:"/"}let h=cC(s,d),m=c&&c!=="/"&&c.endsWith("/"),g=(a||c===".")&&t.endsWith("/");return!h.pathname.endsWith("/")&&(m||g)&&(h.pathname+="/"),h}const ba=n=>n.join("/").replace(/\/\/+/g,"/"),fC=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),mC=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,gC=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n;function yC(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}const gk=["post","put","patch","delete"];new Set(gk);const xC=["get",...gk];new Set(xC);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Gu(){return Gu=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},Gu.apply(this,arguments)}const sx=w.createContext(null),bC=w.createContext(null),uf=w.createContext(null),df=w.createContext(null),La=w.createContext({outlet:null,matches:[],isDataRoute:!1}),yk=w.createContext(null);function hf(){return w.useContext(df)!=null}function pf(){return hf()||jn(!1),w.useContext(df).location}function xk(n){w.useContext(uf).static||w.useLayoutEffect(n)}function wt(){let{isDataRoute:n}=w.useContext(La);return n?BC():vC()}function vC(){hf()||jn(!1);let n=w.useContext(sx),{basename:e,future:t,navigator:r}=w.useContext(uf),{matches:s}=w.useContext(La),{pathname:a}=pf(),c=JSON.stringify(hC(s,t.v7_relativeSplatPath)),d=w.useRef(!1);return xk(()=>{d.current=!0}),w.useCallback(function(m,g){if(g===void 0&&(g={}),!d.current)return;if(typeof m=="number"){r.go(m);return}let x=pC(m,JSON.parse(c),a,g.relative==="path");n==null&&e!=="/"&&(x.pathname=x.pathname==="/"?e:ba([e,x.pathname])),(g.replace?r.replace:r.push)(x,g.state,g)},[e,r,c,a,n])}function wC(){let{matches:n}=w.useContext(La),e=n[n.length-1];return e?e.params:{}}function SC(n,e){return kC(n,e)}function kC(n,e,t,r){hf()||jn(!1);let{navigator:s}=w.useContext(uf),{matches:a}=w.useContext(La),c=a[a.length-1],d=c?c.params:{};c&&c.pathname;let h=c?c.pathnameBase:"/";c&&c.route;let m=pf(),g;if(e){var x;let T=typeof e=="string"?bc(e):e;h==="/"||(x=T.pathname)!=null&&x.startsWith(h)||jn(!1),g=T}else g=m;let S=g.pathname||"/",I=S;if(h!=="/"){let T=h.replace(/^\//,"").split("/");I="/"+S.replace(/^\//,"").split("/").slice(T.length).join("/")}let _=KE(n,{pathname:I}),R=EC(_&&_.map(T=>Object.assign({},T,{params:Object.assign({},d,T.params),pathname:ba([h,s.encodeLocation?s.encodeLocation(T.pathname).pathname:T.pathname]),pathnameBase:T.pathnameBase==="/"?h:ba([h,s.encodeLocation?s.encodeLocation(T.pathnameBase).pathname:T.pathnameBase])})),a,t,r);return e&&R?w.createElement(df.Provider,{value:{location:Gu({pathname:"/",search:"",hash:"",state:null,key:"default"},g),navigationType:ao.Pop}},R):R}function TC(){let n=PC(),e=yC(n)?n.status+" "+n.statusText:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return w.createElement(w.Fragment,null,w.createElement("h2",null,"Unexpected Application Error!"),w.createElement("h3",{style:{fontStyle:"italic"}},e),t?w.createElement("pre",{style:s},t):null,null)}const _C=w.createElement(TC,null);class jC extends w.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return this.state.error!==void 0?w.createElement(La.Provider,{value:this.props.routeContext},w.createElement(yk.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function IC(n){let{routeContext:e,match:t,children:r}=n,s=w.useContext(sx);return s&&s.static&&s.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=t.route.id),w.createElement(La.Provider,{value:e},r)}function EC(n,e,t,r){var s;if(e===void 0&&(e=[]),t===void 0&&(t=null),r===void 0&&(r=null),n==null){var a;if(!t)return null;if(t.errors)n=t.matches;else if((a=r)!=null&&a.v7_partialHydration&&e.length===0&&!t.initialized&&t.matches.length>0)n=t.matches;else return null}let c=n,d=(s=t)==null?void 0:s.errors;if(d!=null){let g=c.findIndex(x=>x.route.id&&(d==null?void 0:d[x.route.id])!==void 0);g>=0||jn(!1),c=c.slice(0,Math.min(c.length,g+1))}let h=!1,m=-1;if(t&&r&&r.v7_partialHydration)for(let g=0;g<c.length;g++){let x=c[g];if((x.route.HydrateFallback||x.route.hydrateFallbackElement)&&(m=g),x.route.id){let{loaderData:S,errors:I}=t,_=x.route.loader&&S[x.route.id]===void 0&&(!I||I[x.route.id]===void 0);if(x.route.lazy||_){h=!0,m>=0?c=c.slice(0,m+1):c=[c[0]];break}}}return c.reduceRight((g,x,S)=>{let I,_=!1,R=null,T=null;t&&(I=d&&x.route.id?d[x.route.id]:void 0,R=x.route.errorElement||_C,h&&(m<0&&S===0?(FC("route-fallback"),_=!0,T=null):m===S&&(_=!0,T=x.route.hydrateFallbackElement||null)));let A=e.concat(c.slice(0,S+1)),D=()=>{let F;return I?F=R:_?F=T:x.route.Component?F=w.createElement(x.route.Component,null):x.route.element?F=x.route.element:F=g,w.createElement(IC,{match:x,routeContext:{outlet:g,matches:A,isDataRoute:t!=null},children:F})};return t&&(x.route.ErrorBoundary||x.route.errorElement||S===0)?w.createElement(jC,{location:t.location,revalidation:t.revalidation,component:R,error:I,children:D(),routeContext:{outlet:null,matches:A,isDataRoute:!0}}):D()},null)}var bk=function(n){return n.UseBlocker="useBlocker",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n}(bk||{}),vk=function(n){return n.UseBlocker="useBlocker",n.UseLoaderData="useLoaderData",n.UseActionData="useActionData",n.UseRouteError="useRouteError",n.UseNavigation="useNavigation",n.UseRouteLoaderData="useRouteLoaderData",n.UseMatches="useMatches",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n.UseRouteId="useRouteId",n}(vk||{});function CC(n){let e=w.useContext(sx);return e||jn(!1),e}function RC(n){let e=w.useContext(bC);return e||jn(!1),e}function AC(n){let e=w.useContext(La);return e||jn(!1),e}function wk(n){let e=AC(),t=e.matches[e.matches.length-1];return t.route.id||jn(!1),t.route.id}function PC(){var n;let e=w.useContext(yk),t=RC(),r=wk();return e!==void 0?e:(n=t.errors)==null?void 0:n[r]}function BC(){let{router:n}=CC(bk.UseNavigateStable),e=wk(vk.UseNavigateStable),t=w.useRef(!1);return xk(()=>{t.current=!0}),w.useCallback(function(s,a){a===void 0&&(a={}),t.current&&(typeof s=="number"?n.navigate(s):n.navigate(s,Gu({fromRouteId:e},a)))},[n,e])}const rw={};function FC(n,e,t){rw[n]||(rw[n]=!0)}function NC(n,e){n==null||n.v7_startTransition,n==null||n.v7_relativeSplatPath}function pt(n){jn(!1)}function zC(n){let{basename:e="/",children:t=null,location:r,navigationType:s=ao.Pop,navigator:a,static:c=!1,future:d}=n;hf()&&jn(!1);let h=e.replace(/^\/*/,"/"),m=w.useMemo(()=>({basename:h,navigator:a,static:c,future:Gu({v7_relativeSplatPath:!1},d)}),[h,d,a,c]);typeof r=="string"&&(r=bc(r));let{pathname:g="/",search:x="",hash:S="",state:I=null,key:_="default"}=r,R=w.useMemo(()=>{let T=mk(g,h);return T==null?null:{location:{pathname:T,search:x,hash:S,state:I,key:_},navigationType:s}},[h,g,x,S,I,_,s]);return R==null?null:w.createElement(uf.Provider,{value:m},w.createElement(df.Provider,{children:t,value:R}))}function DC(n){let{children:e,location:t}=n;return SC(ay(e),t)}new Promise(()=>{});function ay(n,e){e===void 0&&(e=[]);let t=[];return w.Children.forEach(n,(r,s)=>{if(!w.isValidElement(r))return;let a=[...e,s];if(r.type===w.Fragment){t.push.apply(t,ay(r.props.children,a));return}r.type!==pt&&jn(!1),!r.props.index||!r.props.children||jn(!1);let c={id:r.props.id||a.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(c.children=ay(r.props.children,a)),t.push(c)}),t}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function ly(n){return n===void 0&&(n=""),new URLSearchParams(typeof n=="string"||Array.isArray(n)||n instanceof URLSearchParams?n:Object.keys(n).reduce((e,t)=>{let r=n[t];return e.concat(Array.isArray(r)?r.map(s=>[t,s]):[[t,r]])},[]))}function MC(n,e){let t=ly(n);return e&&e.forEach((r,s)=>{t.has(s)||e.getAll(s).forEach(a=>{t.append(s,a)})}),t}const LC="6";try{window.__reactRouterVersion=LC}catch{}const OC="startTransition",iw=qE[OC];function VC(n){let{basename:e,children:t,future:r,window:s}=n,a=w.useRef();a.current==null&&(a.current=HE({window:s,v5Compat:!0}));let c=a.current,[d,h]=w.useState({action:c.action,location:c.location}),{v7_startTransition:m}=r||{},g=w.useCallback(x=>{m&&iw?iw(()=>h(x)):h(x)},[h,m]);return w.useLayoutEffect(()=>c.listen(g),[c,g]),w.useEffect(()=>NC(r),[r]),w.createElement(zC,{basename:e,children:t,location:d.location,navigationType:d.action,navigator:c,future:r})}var sw;(function(n){n.UseScrollRestoration="useScrollRestoration",n.UseSubmit="useSubmit",n.UseSubmitFetcher="useSubmitFetcher",n.UseFetcher="useFetcher",n.useViewTransitionState="useViewTransitionState"})(sw||(sw={}));var ow;(function(n){n.UseFetcher="useFetcher",n.UseFetchers="useFetchers",n.UseScrollRestoration="useScrollRestoration"})(ow||(ow={}));function WC(n){let e=w.useRef(ly(n)),t=w.useRef(!1),r=pf(),s=w.useMemo(()=>MC(r.search,t.current?null:e.current),[r.search]),a=wt(),c=w.useCallback((d,h)=>{const m=ly(typeof d=="function"?d(s):d);t.current=!0,a("?"+m,h)},[a,s]);return[s,c]}const aw=()=>{const[n,e]=w.useState(!0),[t,r]=w.useState(0),[s,a]=w.useState(!1),[c,d]=w.useState(!1),h=wt();return w.useEffect(()=>{(async()=>{r(1),a(!0),d(!0),await new Promise(g=>setTimeout(g,2e3)),await new Promise(g=>setTimeout(g,500)),r(0),await new Promise(g=>setTimeout(g,400)),h("/home")})()},[h]),i.jsxs("div",{style:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",background:"radial-gradient(ellipse 80% 60% at 50% 50%, #fff 0%, #e3eafc 70%, #b3c6f7 100%)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1e4,opacity:n?1:0,transition:"opacity 0.5s ease-in-out",overflow:"hidden"},children:[i.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",opacity:t,transition:"opacity 0.7s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative"},children:[i.jsx("div",{style:{position:"absolute",width:320,height:220,borderRadius:"50% / 40%",top:"50%",left:"50%",transform:"translate(-50%, -50%)",zIndex:1,pointerEvents:"none",animation:s?"halo-rotate 2.5s linear forwards":"none",opacity:.85,background:"conic-gradient(from 0deg, #fff 0deg, #ffd700 60deg, #b3c6f7 180deg, #fff 300deg, #fff 360deg)",filter:"blur(2px)"}}),i.jsx("div",{style:{position:"absolute",width:260,height:260,borderRadius:"50%",background:"radial-gradient(circle, #fff 0%, rgba(255,255,255,0.7) 50%, transparent 80%)",zIndex:2,top:"50%",left:"50%",transform:"translate(-50%, -50%)",pointerEvents:"none"}}),i.jsx("img",{src:"/ctx-logo.png",alt:"CTX Logo",style:{width:"200px",height:"200px",filter:"drop-shadow(0 8px 32px rgba(40, 40, 40, 0.35)) drop-shadow(0 2px 8px #fff)",zIndex:3,animation:c?"logo-scale-rotate 2.5s cubic-bezier(0.4,0,0.2,1) forwards":"none",transformOrigin:"50% 50%",transform:c?void 0:"scale(1) rotate(0deg)",opacity:c?void 0:1}}),i.jsx("div",{style:{marginTop:"20px",color:"#232946",fontSize:"24px",fontWeight:"bold",textAlign:"center",textShadow:"0 2px 8px rgba(255,255,255,0.5)",zIndex:3},children:"Restarter™"}),i.jsx("div",{style:{marginTop:"8px",color:"#ffd700",fontSize:"16px",textAlign:"center",textShadow:"0 2px 8px rgba(0, 0, 0, 0.1)",zIndex:3},children:"重啟人生的平台"})]}),i.jsx("style",{children:`
        @keyframes halo-rotate {
          0% { transform: translate(-50%, -50%) rotate(0deg); }
          100% { transform: translate(-50%, -50%) rotate(360deg); }
        }
        @keyframes logo-scale-rotate {
          0% { transform: scale(0.1) rotate(-180deg); opacity: 0.2; }
          20% { opacity: 1; }
          100% { transform: scale(1) rotate(0deg); opacity: 1; }
        }
      `})]})},UC=()=>{};var lw={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sk=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let s=n.charCodeAt(r);s<128?e[t++]=s:s<2048?(e[t++]=s>>6|192,e[t++]=s&63|128):(s&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=s>>18|240,e[t++]=s>>12&63|128,e[t++]=s>>6&63|128,e[t++]=s&63|128):(e[t++]=s>>12|224,e[t++]=s>>6&63|128,e[t++]=s&63|128)}return e},qC=function(n){const e=[];let t=0,r=0;for(;t<n.length;){const s=n[t++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const a=n[t++];e[r++]=String.fromCharCode((s&31)<<6|a&63)}else if(s>239&&s<365){const a=n[t++],c=n[t++],d=n[t++],h=((s&7)<<18|(a&63)<<12|(c&63)<<6|d&63)-65536;e[r++]=String.fromCharCode(55296+(h>>10)),e[r++]=String.fromCharCode(56320+(h&1023))}else{const a=n[t++],c=n[t++];e[r++]=String.fromCharCode((s&15)<<12|(a&63)<<6|c&63)}}return e.join("")},kk={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<n.length;s+=3){const a=n[s],c=s+1<n.length,d=c?n[s+1]:0,h=s+2<n.length,m=h?n[s+2]:0,g=a>>2,x=(a&3)<<4|d>>4;let S=(d&15)<<2|m>>6,I=m&63;h||(I=64,c||(S=64)),r.push(t[g],t[x],t[S],t[I])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(Sk(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):qC(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<n.length;){const a=t[n.charAt(s++)],d=s<n.length?t[n.charAt(s)]:0;++s;const m=s<n.length?t[n.charAt(s)]:64;++s;const x=s<n.length?t[n.charAt(s)]:64;if(++s,a==null||d==null||m==null||x==null)throw new HC;const S=a<<2|d>>4;if(r.push(S),m!==64){const I=d<<4&240|m>>2;if(r.push(I),x!==64){const _=m<<6&192|x;r.push(_)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class HC extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const $C=function(n){const e=Sk(n);return kk.encodeByteArray(e,!0)},Rp=function(n){return $C(n).replace(/\./g,"")},Tk=function(n){try{return kk.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _k(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GC=()=>_k().__FIREBASE_DEFAULTS__,KC=()=>{if(typeof process>"u"||typeof lw>"u")return;const n=lw.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},QC=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&Tk(n[1]);return e&&JSON.parse(e)},ff=()=>{try{return UC()||GC()||KC()||QC()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},jk=n=>{var e,t;return(t=(e=ff())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},Ik=n=>{const e=jk(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},Ek=()=>{var n;return(n=ff())===null||n===void 0?void 0:n.config},Ck=n=>{var e;return(e=ff())===null||e===void 0?void 0:e[`_${n}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YC{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ws(n){return n.endsWith(".cloudworkstations.dev")}async function mf(n){return(await fetch(n,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rk(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},r=e||"demo-project",s=n.iat||0,a=n.sub||n.user_id;if(!a)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const c=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:a,user_id:a,firebase:{sign_in_provider:"custom",identities:{}}},n);return[Rp(JSON.stringify(t)),Rp(JSON.stringify(c)),""].join(".")}const Fu={};function XC(){const n={prod:[],emulator:[]};for(const e of Object.keys(Fu))Fu[e]?n.emulator.push(e):n.prod.push(e);return n}function JC(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let cw=!1;function ox(n,e){if(typeof window>"u"||typeof document>"u"||!ws(window.location.host)||Fu[n]===e||Fu[n]||cw)return;Fu[n]=e;function t(S){return`__firebase__banner__${S}`}const r="__firebase__banner",a=XC().prod.length>0;function c(){const S=document.getElementById(r);S&&S.remove()}function d(S){S.style.display="flex",S.style.background="#7faaf0",S.style.position="fixed",S.style.bottom="5px",S.style.left="5px",S.style.padding=".5em",S.style.borderRadius="5px",S.style.alignItems="center"}function h(S,I){S.setAttribute("width","24"),S.setAttribute("id",I),S.setAttribute("height","24"),S.setAttribute("viewBox","0 0 24 24"),S.setAttribute("fill","none"),S.style.marginLeft="-6px"}function m(){const S=document.createElement("span");return S.style.cursor="pointer",S.style.marginLeft="16px",S.style.fontSize="24px",S.innerHTML=" &times;",S.onclick=()=>{cw=!0,c()},S}function g(S,I){S.setAttribute("id",I),S.innerText="Learn more",S.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",S.setAttribute("target","__blank"),S.style.paddingLeft="5px",S.style.textDecoration="underline"}function x(){const S=JC(r),I=t("text"),_=document.getElementById(I)||document.createElement("span"),R=t("learnmore"),T=document.getElementById(R)||document.createElement("a"),A=t("preprendIcon"),D=document.getElementById(A)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(S.created){const F=S.element;d(F),g(T,R);const X=m();h(D,A),F.append(D,_,T,X),document.body.appendChild(F)}a?(_.innerText="Preview backend disconnected.",D.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(D.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,_.innerText="Preview backend running in this workspace."),_.setAttribute("id",I)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",x):x()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function In(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function ZC(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(In())}function Ak(){var n;const e=(n=ff())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function eR(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function tR(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function nR(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function rR(){const n=In();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function Pk(){return!Ak()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Bk(){return!Ak()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function Fk(){try{return typeof indexedDB=="object"}catch{return!1}}function iR(){return new Promise((n,e)=>{try{let t=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},s.onupgradeneeded=()=>{t=!1},s.onerror=()=>{var a;e(((a=s.error)===null||a===void 0?void 0:a.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sR="FirebaseError";class Ui extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=sR,Object.setPrototypeOf(this,Ui.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ud.prototype.create)}}class ud{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){const r=t[0]||{},s=`${this.service}/${e}`,a=this.errors[e],c=a?oR(a,r):"Error",d=`${this.serviceName}: ${c} (${s}).`;return new Ui(s,d,r)}}function oR(n,e){return n.replace(aR,(t,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const aR=/\{\$([^}]+)}/g;function lR(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function mi(n,e){if(n===e)return!0;const t=Object.keys(n),r=Object.keys(e);for(const s of t){if(!r.includes(s))return!1;const a=n[s],c=e[s];if(uw(a)&&uw(c)){if(!mi(a,c))return!1}else if(a!==c)return!1}for(const s of r)if(!t.includes(s))return!1;return!0}function uw(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dd(n){const e=[];for(const[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function Iu(n){const e={};return n.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[s,a]=r.split("=");e[decodeURIComponent(s)]=decodeURIComponent(a)}}),e}function Eu(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function cR(n,e){const t=new uR(n,e);return t.subscribe.bind(t)}class uR{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let s;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");dR(e,["next","error","complete"])?s=e:s={next:e,error:t,complete:r},s.next===void 0&&(s.next=Pg),s.error===void 0&&(s.error=Pg),s.complete===void 0&&(s.complete=Pg);const a=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),a}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function dR(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Pg(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function It(n){return n&&n._delegate?n._delegate:n}class yo{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const la="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hR{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const r=new YC;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:t});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(t=e==null?void 0:e.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(a){if(s)return null;throw a}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(fR(e))try{this.getOrInitializeService({instanceIdentifier:la})}catch{}for(const[t,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(t);try{const a=this.getOrInitializeService({instanceIdentifier:s});r.resolve(a)}catch{}}}}clearInstance(e=la){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=la){return this.instances.has(e)}getOptions(e=la){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[a,c]of this.instancesDeferred.entries()){const d=this.normalizeInstanceIdentifier(a);r===d&&c.resolve(s)}return s}onInit(e,t){var r;const s=this.normalizeInstanceIdentifier(t),a=(r=this.onInitCallbacks.get(s))!==null&&r!==void 0?r:new Set;a.add(e),this.onInitCallbacks.set(s,a);const c=this.instances.get(s);return c&&e(c,s),()=>{a.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const s of r)try{s(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:pR(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=la){return this.component?this.component.multipleInstances?e:la:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function pR(n){return n===la?void 0:n}function fR(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mR{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new hR(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var yt;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(yt||(yt={}));const gR={debug:yt.DEBUG,verbose:yt.VERBOSE,info:yt.INFO,warn:yt.WARN,error:yt.ERROR,silent:yt.SILENT},yR=yt.INFO,xR={[yt.DEBUG]:"log",[yt.VERBOSE]:"log",[yt.INFO]:"info",[yt.WARN]:"warn",[yt.ERROR]:"error"},bR=(n,e,...t)=>{if(e<n.logLevel)return;const r=new Date().toISOString(),s=xR[e];if(s)console[s](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class ax{constructor(e){this.name=e,this._logLevel=yR,this._logHandler=bR,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in yt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?gR[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,yt.DEBUG,...e),this._logHandler(this,yt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,yt.VERBOSE,...e),this._logHandler(this,yt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,yt.INFO,...e),this._logHandler(this,yt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,yt.WARN,...e),this._logHandler(this,yt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,yt.ERROR,...e),this._logHandler(this,yt.ERROR,...e)}}const vR=(n,e)=>e.some(t=>n instanceof t);let dw,hw;function wR(){return dw||(dw=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function SR(){return hw||(hw=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Nk=new WeakMap,cy=new WeakMap,zk=new WeakMap,Bg=new WeakMap,lx=new WeakMap;function kR(n){const e=new Promise((t,r)=>{const s=()=>{n.removeEventListener("success",a),n.removeEventListener("error",c)},a=()=>{t(ho(n.result)),s()},c=()=>{r(n.error),s()};n.addEventListener("success",a),n.addEventListener("error",c)});return e.then(t=>{t instanceof IDBCursor&&Nk.set(t,n)}).catch(()=>{}),lx.set(e,n),e}function TR(n){if(cy.has(n))return;const e=new Promise((t,r)=>{const s=()=>{n.removeEventListener("complete",a),n.removeEventListener("error",c),n.removeEventListener("abort",c)},a=()=>{t(),s()},c=()=>{r(n.error||new DOMException("AbortError","AbortError")),s()};n.addEventListener("complete",a),n.addEventListener("error",c),n.addEventListener("abort",c)});cy.set(n,e)}let uy={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return cy.get(n);if(e==="objectStoreNames")return n.objectStoreNames||zk.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return ho(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function _R(n){uy=n(uy)}function jR(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const r=n.call(Fg(this),e,...t);return zk.set(r,e.sort?e.sort():[e]),ho(r)}:SR().includes(n)?function(...e){return n.apply(Fg(this),e),ho(Nk.get(this))}:function(...e){return ho(n.apply(Fg(this),e))}}function IR(n){return typeof n=="function"?jR(n):(n instanceof IDBTransaction&&TR(n),vR(n,wR())?new Proxy(n,uy):n)}function ho(n){if(n instanceof IDBRequest)return kR(n);if(Bg.has(n))return Bg.get(n);const e=IR(n);return e!==n&&(Bg.set(n,e),lx.set(e,n)),e}const Fg=n=>lx.get(n);function ER(n,e,{blocked:t,upgrade:r,blocking:s,terminated:a}={}){const c=indexedDB.open(n,e),d=ho(c);return r&&c.addEventListener("upgradeneeded",h=>{r(ho(c.result),h.oldVersion,h.newVersion,ho(c.transaction),h)}),t&&c.addEventListener("blocked",h=>t(h.oldVersion,h.newVersion,h)),d.then(h=>{a&&h.addEventListener("close",()=>a()),s&&h.addEventListener("versionchange",m=>s(m.oldVersion,m.newVersion,m))}).catch(()=>{}),d}const CR=["get","getKey","getAll","getAllKeys","count"],RR=["put","add","delete","clear"],Ng=new Map;function pw(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Ng.get(e))return Ng.get(e);const t=e.replace(/FromIndex$/,""),r=e!==t,s=RR.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(s||CR.includes(t)))return;const a=async function(c,...d){const h=this.transaction(c,s?"readwrite":"readonly");let m=h.store;return r&&(m=m.index(d.shift())),(await Promise.all([m[t](...d),s&&h.done]))[0]};return Ng.set(e,a),a}_R(n=>({...n,get:(e,t,r)=>pw(e,t)||n.get(e,t,r),has:(e,t)=>!!pw(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AR{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(PR(t)){const r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}}function PR(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const dy="@firebase/app",fw="0.13.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ys=new ax("@firebase/app"),BR="@firebase/app-compat",FR="@firebase/analytics-compat",NR="@firebase/analytics",zR="@firebase/app-check-compat",DR="@firebase/app-check",MR="@firebase/auth",LR="@firebase/auth-compat",OR="@firebase/database",VR="@firebase/data-connect",WR="@firebase/database-compat",UR="@firebase/functions",qR="@firebase/functions-compat",HR="@firebase/installations",$R="@firebase/installations-compat",GR="@firebase/messaging",KR="@firebase/messaging-compat",QR="@firebase/performance",YR="@firebase/performance-compat",XR="@firebase/remote-config",JR="@firebase/remote-config-compat",ZR="@firebase/storage",eA="@firebase/storage-compat",tA="@firebase/firestore",nA="@firebase/ai",rA="@firebase/firestore-compat",iA="firebase",sA="11.9.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ap="[DEFAULT]",oA={[dy]:"fire-core",[BR]:"fire-core-compat",[NR]:"fire-analytics",[FR]:"fire-analytics-compat",[DR]:"fire-app-check",[zR]:"fire-app-check-compat",[MR]:"fire-auth",[LR]:"fire-auth-compat",[OR]:"fire-rtdb",[VR]:"fire-data-connect",[WR]:"fire-rtdb-compat",[UR]:"fire-fn",[qR]:"fire-fn-compat",[HR]:"fire-iid",[$R]:"fire-iid-compat",[GR]:"fire-fcm",[KR]:"fire-fcm-compat",[QR]:"fire-perf",[YR]:"fire-perf-compat",[XR]:"fire-rc",[JR]:"fire-rc-compat",[ZR]:"fire-gcs",[eA]:"fire-gcs-compat",[tA]:"fire-fst",[rA]:"fire-fst-compat",[nA]:"fire-vertex","fire-js":"fire-js",[iA]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pp=new Map,aA=new Map,hy=new Map;function mw(n,e){try{n.container.addComponent(e)}catch(t){ys.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function _a(n){const e=n.name;if(hy.has(e))return ys.debug(`There were multiple attempts to register component ${e}.`),!1;hy.set(e,n);for(const t of Pp.values())mw(t,n);for(const t of aA.values())mw(t,n);return!0}function vc(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function lA(n,e,t=Ap){vc(n,e).clearInstance(t)}function vr(n){return n==null?!1:n.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cA={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},po=new ud("app","Firebase",cA);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uA{constructor(e,t,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new yo("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw po.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Oa=sA;function Dk(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const r=Object.assign({name:Ap,automaticDataCollectionEnabled:!0},e),s=r.name;if(typeof s!="string"||!s)throw po.create("bad-app-name",{appName:String(s)});if(t||(t=Ek()),!t)throw po.create("no-options");const a=Pp.get(s);if(a){if(mi(t,a.options)&&mi(r,a.config))return a;throw po.create("duplicate-app",{appName:s})}const c=new mR(s);for(const h of hy.values())c.addComponent(h);const d=new uA(t,r,c);return Pp.set(s,d),d}function cx(n=Ap){const e=Pp.get(n);if(!e&&n===Ap&&Ek())return Dk();if(!e)throw po.create("no-app",{appName:n});return e}function Di(n,e,t){var r;let s=(r=oA[n])!==null&&r!==void 0?r:n;t&&(s+=`-${t}`);const a=s.match(/\s|\//),c=e.match(/\s|\//);if(a||c){const d=[`Unable to register library "${s}" with version "${e}":`];a&&d.push(`library name "${s}" contains illegal characters (whitespace or "/")`),a&&c&&d.push("and"),c&&d.push(`version name "${e}" contains illegal characters (whitespace or "/")`),ys.warn(d.join(" "));return}_a(new yo(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dA="firebase-heartbeat-database",hA=1,Ku="firebase-heartbeat-store";let zg=null;function Mk(){return zg||(zg=ER(dA,hA,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Ku)}catch(t){console.warn(t)}}}}).catch(n=>{throw po.create("idb-open",{originalErrorMessage:n.message})})),zg}async function pA(n){try{const t=(await Mk()).transaction(Ku),r=await t.objectStore(Ku).get(Lk(n));return await t.done,r}catch(e){if(e instanceof Ui)ys.warn(e.message);else{const t=po.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});ys.warn(t.message)}}}async function gw(n,e){try{const r=(await Mk()).transaction(Ku,"readwrite");await r.objectStore(Ku).put(e,Lk(n)),await r.done}catch(t){if(t instanceof Ui)ys.warn(t.message);else{const r=po.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});ys.warn(r.message)}}}function Lk(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fA=1024,mA=30;class gA{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new xA(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,t;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),a=yw();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===a||this._heartbeatsCache.heartbeats.some(c=>c.date===a))return;if(this._heartbeatsCache.heartbeats.push({date:a,agent:s}),this._heartbeatsCache.heartbeats.length>mA){const c=bA(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(c,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){ys.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=yw(),{heartbeatsToSend:r,unsentEntries:s}=yA(this._heartbeatsCache.heartbeats),a=Rp(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),a}catch(t){return ys.warn(t),""}}}function yw(){return new Date().toISOString().substring(0,10)}function yA(n,e=fA){const t=[];let r=n.slice();for(const s of n){const a=t.find(c=>c.agent===s.agent);if(a){if(a.dates.push(s.date),xw(t)>e){a.dates.pop();break}}else if(t.push({agent:s.agent,dates:[s.date]}),xw(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}class xA{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Fk()?iR().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await pA(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const s=await this.read();return gw(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const s=await this.read();return gw(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function xw(n){return Rp(JSON.stringify({version:2,heartbeats:n})).length}function bA(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let r=1;r<n.length;r++)n[r].date<t&&(t=n[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vA(n){_a(new yo("platform-logger",e=>new AR(e),"PRIVATE")),_a(new yo("heartbeat",e=>new gA(e),"PRIVATE")),Di(dy,fw,n),Di(dy,fw,"esm2017"),Di("fire-js","")}vA("");var wA="firebase",SA="11.9.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Di(wA,SA,"app");var bw=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var fo,Ok;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(N,E){function P(){}P.prototype=E.prototype,N.D=E.prototype,N.prototype=new P,N.prototype.constructor=N,N.C=function(M,O,z){for(var j=Array(arguments.length-2),K=2;K<arguments.length;K++)j[K-2]=arguments[K];return E.prototype[O].apply(M,j)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,t),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(N,E,P){P||(P=0);var M=Array(16);if(typeof E=="string")for(var O=0;16>O;++O)M[O]=E.charCodeAt(P++)|E.charCodeAt(P++)<<8|E.charCodeAt(P++)<<16|E.charCodeAt(P++)<<24;else for(O=0;16>O;++O)M[O]=E[P++]|E[P++]<<8|E[P++]<<16|E[P++]<<24;E=N.g[0],P=N.g[1],O=N.g[2];var z=N.g[3],j=E+(z^P&(O^z))+M[0]+3614090360&4294967295;E=P+(j<<7&4294967295|j>>>25),j=z+(O^E&(P^O))+M[1]+3905402710&4294967295,z=E+(j<<12&4294967295|j>>>20),j=O+(P^z&(E^P))+M[2]+606105819&4294967295,O=z+(j<<17&4294967295|j>>>15),j=P+(E^O&(z^E))+M[3]+3250441966&4294967295,P=O+(j<<22&4294967295|j>>>10),j=E+(z^P&(O^z))+M[4]+4118548399&4294967295,E=P+(j<<7&4294967295|j>>>25),j=z+(O^E&(P^O))+M[5]+1200080426&4294967295,z=E+(j<<12&4294967295|j>>>20),j=O+(P^z&(E^P))+M[6]+2821735955&4294967295,O=z+(j<<17&4294967295|j>>>15),j=P+(E^O&(z^E))+M[7]+4249261313&4294967295,P=O+(j<<22&4294967295|j>>>10),j=E+(z^P&(O^z))+M[8]+1770035416&4294967295,E=P+(j<<7&4294967295|j>>>25),j=z+(O^E&(P^O))+M[9]+2336552879&4294967295,z=E+(j<<12&4294967295|j>>>20),j=O+(P^z&(E^P))+M[10]+4294925233&4294967295,O=z+(j<<17&4294967295|j>>>15),j=P+(E^O&(z^E))+M[11]+2304563134&4294967295,P=O+(j<<22&4294967295|j>>>10),j=E+(z^P&(O^z))+M[12]+1804603682&4294967295,E=P+(j<<7&4294967295|j>>>25),j=z+(O^E&(P^O))+M[13]+4254626195&4294967295,z=E+(j<<12&4294967295|j>>>20),j=O+(P^z&(E^P))+M[14]+2792965006&4294967295,O=z+(j<<17&4294967295|j>>>15),j=P+(E^O&(z^E))+M[15]+1236535329&4294967295,P=O+(j<<22&4294967295|j>>>10),j=E+(O^z&(P^O))+M[1]+4129170786&4294967295,E=P+(j<<5&4294967295|j>>>27),j=z+(P^O&(E^P))+M[6]+3225465664&4294967295,z=E+(j<<9&4294967295|j>>>23),j=O+(E^P&(z^E))+M[11]+643717713&4294967295,O=z+(j<<14&4294967295|j>>>18),j=P+(z^E&(O^z))+M[0]+3921069994&4294967295,P=O+(j<<20&4294967295|j>>>12),j=E+(O^z&(P^O))+M[5]+3593408605&4294967295,E=P+(j<<5&4294967295|j>>>27),j=z+(P^O&(E^P))+M[10]+38016083&4294967295,z=E+(j<<9&4294967295|j>>>23),j=O+(E^P&(z^E))+M[15]+3634488961&4294967295,O=z+(j<<14&4294967295|j>>>18),j=P+(z^E&(O^z))+M[4]+3889429448&4294967295,P=O+(j<<20&4294967295|j>>>12),j=E+(O^z&(P^O))+M[9]+568446438&4294967295,E=P+(j<<5&4294967295|j>>>27),j=z+(P^O&(E^P))+M[14]+3275163606&4294967295,z=E+(j<<9&4294967295|j>>>23),j=O+(E^P&(z^E))+M[3]+4107603335&4294967295,O=z+(j<<14&4294967295|j>>>18),j=P+(z^E&(O^z))+M[8]+1163531501&4294967295,P=O+(j<<20&4294967295|j>>>12),j=E+(O^z&(P^O))+M[13]+2850285829&4294967295,E=P+(j<<5&4294967295|j>>>27),j=z+(P^O&(E^P))+M[2]+4243563512&4294967295,z=E+(j<<9&4294967295|j>>>23),j=O+(E^P&(z^E))+M[7]+1735328473&4294967295,O=z+(j<<14&4294967295|j>>>18),j=P+(z^E&(O^z))+M[12]+2368359562&4294967295,P=O+(j<<20&4294967295|j>>>12),j=E+(P^O^z)+M[5]+4294588738&4294967295,E=P+(j<<4&4294967295|j>>>28),j=z+(E^P^O)+M[8]+2272392833&4294967295,z=E+(j<<11&4294967295|j>>>21),j=O+(z^E^P)+M[11]+1839030562&4294967295,O=z+(j<<16&4294967295|j>>>16),j=P+(O^z^E)+M[14]+4259657740&4294967295,P=O+(j<<23&4294967295|j>>>9),j=E+(P^O^z)+M[1]+2763975236&4294967295,E=P+(j<<4&4294967295|j>>>28),j=z+(E^P^O)+M[4]+1272893353&4294967295,z=E+(j<<11&4294967295|j>>>21),j=O+(z^E^P)+M[7]+4139469664&4294967295,O=z+(j<<16&4294967295|j>>>16),j=P+(O^z^E)+M[10]+3200236656&4294967295,P=O+(j<<23&4294967295|j>>>9),j=E+(P^O^z)+M[13]+681279174&4294967295,E=P+(j<<4&4294967295|j>>>28),j=z+(E^P^O)+M[0]+3936430074&4294967295,z=E+(j<<11&4294967295|j>>>21),j=O+(z^E^P)+M[3]+3572445317&4294967295,O=z+(j<<16&4294967295|j>>>16),j=P+(O^z^E)+M[6]+76029189&4294967295,P=O+(j<<23&4294967295|j>>>9),j=E+(P^O^z)+M[9]+3654602809&4294967295,E=P+(j<<4&4294967295|j>>>28),j=z+(E^P^O)+M[12]+3873151461&4294967295,z=E+(j<<11&4294967295|j>>>21),j=O+(z^E^P)+M[15]+530742520&4294967295,O=z+(j<<16&4294967295|j>>>16),j=P+(O^z^E)+M[2]+3299628645&4294967295,P=O+(j<<23&4294967295|j>>>9),j=E+(O^(P|~z))+M[0]+4096336452&4294967295,E=P+(j<<6&4294967295|j>>>26),j=z+(P^(E|~O))+M[7]+1126891415&4294967295,z=E+(j<<10&4294967295|j>>>22),j=O+(E^(z|~P))+M[14]+2878612391&4294967295,O=z+(j<<15&4294967295|j>>>17),j=P+(z^(O|~E))+M[5]+4237533241&4294967295,P=O+(j<<21&4294967295|j>>>11),j=E+(O^(P|~z))+M[12]+1700485571&4294967295,E=P+(j<<6&4294967295|j>>>26),j=z+(P^(E|~O))+M[3]+2399980690&4294967295,z=E+(j<<10&4294967295|j>>>22),j=O+(E^(z|~P))+M[10]+4293915773&4294967295,O=z+(j<<15&4294967295|j>>>17),j=P+(z^(O|~E))+M[1]+2240044497&4294967295,P=O+(j<<21&4294967295|j>>>11),j=E+(O^(P|~z))+M[8]+1873313359&4294967295,E=P+(j<<6&4294967295|j>>>26),j=z+(P^(E|~O))+M[15]+4264355552&4294967295,z=E+(j<<10&4294967295|j>>>22),j=O+(E^(z|~P))+M[6]+2734768916&4294967295,O=z+(j<<15&4294967295|j>>>17),j=P+(z^(O|~E))+M[13]+1309151649&4294967295,P=O+(j<<21&4294967295|j>>>11),j=E+(O^(P|~z))+M[4]+4149444226&4294967295,E=P+(j<<6&4294967295|j>>>26),j=z+(P^(E|~O))+M[11]+3174756917&4294967295,z=E+(j<<10&4294967295|j>>>22),j=O+(E^(z|~P))+M[2]+718787259&4294967295,O=z+(j<<15&4294967295|j>>>17),j=P+(z^(O|~E))+M[9]+3951481745&4294967295,N.g[0]=N.g[0]+E&4294967295,N.g[1]=N.g[1]+(O+(j<<21&4294967295|j>>>11))&4294967295,N.g[2]=N.g[2]+O&4294967295,N.g[3]=N.g[3]+z&4294967295}r.prototype.u=function(N,E){E===void 0&&(E=N.length);for(var P=E-this.blockSize,M=this.B,O=this.h,z=0;z<E;){if(O==0)for(;z<=P;)s(this,N,z),z+=this.blockSize;if(typeof N=="string"){for(;z<E;)if(M[O++]=N.charCodeAt(z++),O==this.blockSize){s(this,M),O=0;break}}else for(;z<E;)if(M[O++]=N[z++],O==this.blockSize){s(this,M),O=0;break}}this.h=O,this.o+=E},r.prototype.v=function(){var N=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);N[0]=128;for(var E=1;E<N.length-8;++E)N[E]=0;var P=8*this.o;for(E=N.length-8;E<N.length;++E)N[E]=P&255,P/=256;for(this.u(N),N=Array(16),E=P=0;4>E;++E)for(var M=0;32>M;M+=8)N[P++]=this.g[E]>>>M&255;return N};function a(N,E){var P=d;return Object.prototype.hasOwnProperty.call(P,N)?P[N]:P[N]=E(N)}function c(N,E){this.h=E;for(var P=[],M=!0,O=N.length-1;0<=O;O--){var z=N[O]|0;M&&z==E||(P[O]=z,M=!1)}this.g=P}var d={};function h(N){return-128<=N&&128>N?a(N,function(E){return new c([E|0],0>E?-1:0)}):new c([N|0],0>N?-1:0)}function m(N){if(isNaN(N)||!isFinite(N))return x;if(0>N)return T(m(-N));for(var E=[],P=1,M=0;N>=P;M++)E[M]=N/P|0,P*=4294967296;return new c(E,0)}function g(N,E){if(N.length==0)throw Error("number format error: empty string");if(E=E||10,2>E||36<E)throw Error("radix out of range: "+E);if(N.charAt(0)=="-")return T(g(N.substring(1),E));if(0<=N.indexOf("-"))throw Error('number format error: interior "-" character');for(var P=m(Math.pow(E,8)),M=x,O=0;O<N.length;O+=8){var z=Math.min(8,N.length-O),j=parseInt(N.substring(O,O+z),E);8>z?(z=m(Math.pow(E,z)),M=M.j(z).add(m(j))):(M=M.j(P),M=M.add(m(j)))}return M}var x=h(0),S=h(1),I=h(16777216);n=c.prototype,n.m=function(){if(R(this))return-T(this).m();for(var N=0,E=1,P=0;P<this.g.length;P++){var M=this.i(P);N+=(0<=M?M:4294967296+M)*E,E*=4294967296}return N},n.toString=function(N){if(N=N||10,2>N||36<N)throw Error("radix out of range: "+N);if(_(this))return"0";if(R(this))return"-"+T(this).toString(N);for(var E=m(Math.pow(N,6)),P=this,M="";;){var O=X(P,E).g;P=A(P,O.j(E));var z=((0<P.g.length?P.g[0]:P.h)>>>0).toString(N);if(P=O,_(P))return z+M;for(;6>z.length;)z="0"+z;M=z+M}},n.i=function(N){return 0>N?0:N<this.g.length?this.g[N]:this.h};function _(N){if(N.h!=0)return!1;for(var E=0;E<N.g.length;E++)if(N.g[E]!=0)return!1;return!0}function R(N){return N.h==-1}n.l=function(N){return N=A(this,N),R(N)?-1:_(N)?0:1};function T(N){for(var E=N.g.length,P=[],M=0;M<E;M++)P[M]=~N.g[M];return new c(P,~N.h).add(S)}n.abs=function(){return R(this)?T(this):this},n.add=function(N){for(var E=Math.max(this.g.length,N.g.length),P=[],M=0,O=0;O<=E;O++){var z=M+(this.i(O)&65535)+(N.i(O)&65535),j=(z>>>16)+(this.i(O)>>>16)+(N.i(O)>>>16);M=j>>>16,z&=65535,j&=65535,P[O]=j<<16|z}return new c(P,P[P.length-1]&-2147483648?-1:0)};function A(N,E){return N.add(T(E))}n.j=function(N){if(_(this)||_(N))return x;if(R(this))return R(N)?T(this).j(T(N)):T(T(this).j(N));if(R(N))return T(this.j(T(N)));if(0>this.l(I)&&0>N.l(I))return m(this.m()*N.m());for(var E=this.g.length+N.g.length,P=[],M=0;M<2*E;M++)P[M]=0;for(M=0;M<this.g.length;M++)for(var O=0;O<N.g.length;O++){var z=this.i(M)>>>16,j=this.i(M)&65535,K=N.i(O)>>>16,Z=N.i(O)&65535;P[2*M+2*O]+=j*Z,D(P,2*M+2*O),P[2*M+2*O+1]+=z*Z,D(P,2*M+2*O+1),P[2*M+2*O+1]+=j*K,D(P,2*M+2*O+1),P[2*M+2*O+2]+=z*K,D(P,2*M+2*O+2)}for(M=0;M<E;M++)P[M]=P[2*M+1]<<16|P[2*M];for(M=E;M<2*E;M++)P[M]=0;return new c(P,0)};function D(N,E){for(;(N[E]&65535)!=N[E];)N[E+1]+=N[E]>>>16,N[E]&=65535,E++}function F(N,E){this.g=N,this.h=E}function X(N,E){if(_(E))throw Error("division by zero");if(_(N))return new F(x,x);if(R(N))return E=X(T(N),E),new F(T(E.g),T(E.h));if(R(E))return E=X(N,T(E)),new F(T(E.g),E.h);if(30<N.g.length){if(R(N)||R(E))throw Error("slowDivide_ only works with positive integers.");for(var P=S,M=E;0>=M.l(N);)P=ie(P),M=ie(M);var O=G(P,1),z=G(M,1);for(M=G(M,2),P=G(P,2);!_(M);){var j=z.add(M);0>=j.l(N)&&(O=O.add(P),z=j),M=G(M,1),P=G(P,1)}return E=A(N,O.j(E)),new F(O,E)}for(O=x;0<=N.l(E);){for(P=Math.max(1,Math.floor(N.m()/E.m())),M=Math.ceil(Math.log(P)/Math.LN2),M=48>=M?1:Math.pow(2,M-48),z=m(P),j=z.j(E);R(j)||0<j.l(N);)P-=M,z=m(P),j=z.j(E);_(z)&&(z=S),O=O.add(z),N=A(N,j)}return new F(O,N)}n.A=function(N){return X(this,N).h},n.and=function(N){for(var E=Math.max(this.g.length,N.g.length),P=[],M=0;M<E;M++)P[M]=this.i(M)&N.i(M);return new c(P,this.h&N.h)},n.or=function(N){for(var E=Math.max(this.g.length,N.g.length),P=[],M=0;M<E;M++)P[M]=this.i(M)|N.i(M);return new c(P,this.h|N.h)},n.xor=function(N){for(var E=Math.max(this.g.length,N.g.length),P=[],M=0;M<E;M++)P[M]=this.i(M)^N.i(M);return new c(P,this.h^N.h)};function ie(N){for(var E=N.g.length+1,P=[],M=0;M<E;M++)P[M]=N.i(M)<<1|N.i(M-1)>>>31;return new c(P,N.h)}function G(N,E){var P=E>>5;E%=32;for(var M=N.g.length-P,O=[],z=0;z<M;z++)O[z]=0<E?N.i(z+P)>>>E|N.i(z+P+1)<<32-E:N.i(z+P);return new c(O,N.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,Ok=r,c.prototype.add=c.prototype.add,c.prototype.multiply=c.prototype.j,c.prototype.modulo=c.prototype.A,c.prototype.compare=c.prototype.l,c.prototype.toNumber=c.prototype.m,c.prototype.toString=c.prototype.toString,c.prototype.getBits=c.prototype.i,c.fromNumber=m,c.fromString=g,fo=c}).apply(typeof bw<"u"?bw:typeof self<"u"?self:typeof window<"u"?window:{});var Zh=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Vk,Cu,Wk,pp,py,Uk,qk,Hk;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(p,b,k){return p==Array.prototype||p==Object.prototype||(p[b]=k.value),p};function t(p){p=[typeof globalThis=="object"&&globalThis,p,typeof window=="object"&&window,typeof self=="object"&&self,typeof Zh=="object"&&Zh];for(var b=0;b<p.length;++b){var k=p[b];if(k&&k.Math==Math)return k}throw Error("Cannot find global object")}var r=t(this);function s(p,b){if(b)e:{var k=r;p=p.split(".");for(var B=0;B<p.length-1;B++){var ce=p[B];if(!(ce in k))break e;k=k[ce]}p=p[p.length-1],B=k[p],b=b(B),b!=B&&b!=null&&e(k,p,{configurable:!0,writable:!0,value:b})}}function a(p,b){p instanceof String&&(p+="");var k=0,B=!1,ce={next:function(){if(!B&&k<p.length){var ye=k++;return{value:b(ye,p[ye]),done:!1}}return B=!0,{done:!0,value:void 0}}};return ce[Symbol.iterator]=function(){return ce},ce}s("Array.prototype.values",function(p){return p||function(){return a(this,function(b,k){return k})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var c=c||{},d=this||self;function h(p){var b=typeof p;return b=b!="object"?b:p?Array.isArray(p)?"array":b:"null",b=="array"||b=="object"&&typeof p.length=="number"}function m(p){var b=typeof p;return b=="object"&&p!=null||b=="function"}function g(p,b,k){return p.call.apply(p.bind,arguments)}function x(p,b,k){if(!p)throw Error();if(2<arguments.length){var B=Array.prototype.slice.call(arguments,2);return function(){var ce=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(ce,B),p.apply(b,ce)}}return function(){return p.apply(b,arguments)}}function S(p,b,k){return S=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?g:x,S.apply(null,arguments)}function I(p,b){var k=Array.prototype.slice.call(arguments,1);return function(){var B=k.slice();return B.push.apply(B,arguments),p.apply(this,B)}}function _(p,b){function k(){}k.prototype=b.prototype,p.aa=b.prototype,p.prototype=new k,p.prototype.constructor=p,p.Qb=function(B,ce,ye){for(var Pe=Array(arguments.length-2),Rt=2;Rt<arguments.length;Rt++)Pe[Rt-2]=arguments[Rt];return b.prototype[ce].apply(B,Pe)}}function R(p){const b=p.length;if(0<b){const k=Array(b);for(let B=0;B<b;B++)k[B]=p[B];return k}return[]}function T(p,b){for(let k=1;k<arguments.length;k++){const B=arguments[k];if(h(B)){const ce=p.length||0,ye=B.length||0;p.length=ce+ye;for(let Pe=0;Pe<ye;Pe++)p[ce+Pe]=B[Pe]}else p.push(B)}}class A{constructor(b,k){this.i=b,this.j=k,this.h=0,this.g=null}get(){let b;return 0<this.h?(this.h--,b=this.g,this.g=b.next,b.next=null):b=this.i(),b}}function D(p){return/^[\s\xa0]*$/.test(p)}function F(){var p=d.navigator;return p&&(p=p.userAgent)?p:""}function X(p){return X[" "](p),p}X[" "]=function(){};var ie=F().indexOf("Gecko")!=-1&&!(F().toLowerCase().indexOf("webkit")!=-1&&F().indexOf("Edge")==-1)&&!(F().indexOf("Trident")!=-1||F().indexOf("MSIE")!=-1)&&F().indexOf("Edge")==-1;function G(p,b,k){for(const B in p)b.call(k,p[B],B,p)}function N(p,b){for(const k in p)b.call(void 0,p[k],k,p)}function E(p){const b={};for(const k in p)b[k]=p[k];return b}const P="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function M(p,b){let k,B;for(let ce=1;ce<arguments.length;ce++){B=arguments[ce];for(k in B)p[k]=B[k];for(let ye=0;ye<P.length;ye++)k=P[ye],Object.prototype.hasOwnProperty.call(B,k)&&(p[k]=B[k])}}function O(p){var b=1;p=p.split(":");const k=[];for(;0<b&&p.length;)k.push(p.shift()),b--;return p.length&&k.push(p.join(":")),k}function z(p){d.setTimeout(()=>{throw p},0)}function j(){var p=re;let b=null;return p.g&&(b=p.g,p.g=p.g.next,p.g||(p.h=null),b.next=null),b}class K{constructor(){this.h=this.g=null}add(b,k){const B=Z.get();B.set(b,k),this.h?this.h.next=B:this.g=B,this.h=B}}var Z=new A(()=>new Y,p=>p.reset());class Y{constructor(){this.next=this.g=this.h=null}set(b,k){this.h=b,this.g=k,this.next=null}reset(){this.next=this.g=this.h=null}}let ae,se=!1,re=new K,ne=()=>{const p=d.Promise.resolve(void 0);ae=()=>{p.then(W)}};var W=()=>{for(var p;p=j();){try{p.h.call(p.g)}catch(k){z(k)}var b=Z;b.j(p),100>b.h&&(b.h++,p.next=b.g,b.g=p)}se=!1};function $(){this.s=this.s,this.C=this.C}$.prototype.s=!1,$.prototype.ma=function(){this.s||(this.s=!0,this.N())},$.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function ee(p,b){this.type=p,this.g=this.target=b,this.defaultPrevented=!1}ee.prototype.h=function(){this.defaultPrevented=!0};var he=function(){if(!d.addEventListener||!Object.defineProperty)return!1;var p=!1,b=Object.defineProperty({},"passive",{get:function(){p=!0}});try{const k=()=>{};d.addEventListener("test",k,b),d.removeEventListener("test",k,b)}catch{}return p}();function _e(p,b){if(ee.call(this,p?p.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,p){var k=this.type=p.type,B=p.changedTouches&&p.changedTouches.length?p.changedTouches[0]:null;if(this.target=p.target||p.srcElement,this.g=b,b=p.relatedTarget){if(ie){e:{try{X(b.nodeName);var ce=!0;break e}catch{}ce=!1}ce||(b=null)}}else k=="mouseover"?b=p.fromElement:k=="mouseout"&&(b=p.toElement);this.relatedTarget=b,B?(this.clientX=B.clientX!==void 0?B.clientX:B.pageX,this.clientY=B.clientY!==void 0?B.clientY:B.pageY,this.screenX=B.screenX||0,this.screenY=B.screenY||0):(this.clientX=p.clientX!==void 0?p.clientX:p.pageX,this.clientY=p.clientY!==void 0?p.clientY:p.pageY,this.screenX=p.screenX||0,this.screenY=p.screenY||0),this.button=p.button,this.key=p.key||"",this.ctrlKey=p.ctrlKey,this.altKey=p.altKey,this.shiftKey=p.shiftKey,this.metaKey=p.metaKey,this.pointerId=p.pointerId||0,this.pointerType=typeof p.pointerType=="string"?p.pointerType:ve[p.pointerType]||"",this.state=p.state,this.i=p,p.defaultPrevented&&_e.aa.h.call(this)}}_(_e,ee);var ve={2:"touch",3:"pen",4:"mouse"};_e.prototype.h=function(){_e.aa.h.call(this);var p=this.i;p.preventDefault?p.preventDefault():p.returnValue=!1};var Le="closure_listenable_"+(1e6*Math.random()|0),Ne=0;function nt(p,b,k,B,ce){this.listener=p,this.proxy=null,this.src=b,this.type=k,this.capture=!!B,this.ha=ce,this.key=++Ne,this.da=this.fa=!1}function Je(p){p.da=!0,p.listener=null,p.proxy=null,p.src=null,p.ha=null}function ge(p){this.src=p,this.g={},this.h=0}ge.prototype.add=function(p,b,k,B,ce){var ye=p.toString();p=this.g[ye],p||(p=this.g[ye]=[],this.h++);var Pe=tt(p,b,B,ce);return-1<Pe?(b=p[Pe],k||(b.fa=!1)):(b=new nt(b,this.src,ye,!!B,ce),b.fa=k,p.push(b)),b};function De(p,b){var k=b.type;if(k in p.g){var B=p.g[k],ce=Array.prototype.indexOf.call(B,b,void 0),ye;(ye=0<=ce)&&Array.prototype.splice.call(B,ce,1),ye&&(Je(b),p.g[k].length==0&&(delete p.g[k],p.h--))}}function tt(p,b,k,B){for(var ce=0;ce<p.length;++ce){var ye=p[ce];if(!ye.da&&ye.listener==b&&ye.capture==!!k&&ye.ha==B)return ce}return-1}var Ye="closure_lm_"+(1e6*Math.random()|0),We={};function pe(p,b,k,B,ce){if(Array.isArray(b)){for(var ye=0;ye<b.length;ye++)pe(p,b[ye],k,B,ce);return null}return k=H(k),p&&p[Le]?p.K(b,k,m(B)?!!B.capture:!1,ce):Se(p,b,k,!1,B,ce)}function Se(p,b,k,B,ce,ye){if(!b)throw Error("Invalid event type");var Pe=m(ce)?!!ce.capture:!!ce,Rt=L(p);if(Rt||(p[Ye]=Rt=new ge(p)),k=Rt.add(b,k,B,Pe,ye),k.proxy)return k;if(B=we(),k.proxy=B,B.src=p,B.listener=k,p.addEventListener)he||(ce=Pe),ce===void 0&&(ce=!1),p.addEventListener(b.toString(),B,ce);else if(p.attachEvent)p.attachEvent(U(b.toString()),B);else if(p.addListener&&p.removeListener)p.addListener(B);else throw Error("addEventListener and attachEvent are unavailable.");return k}function we(){function p(k){return b.call(p.src,p.listener,k)}const b=V;return p}function Re(p,b,k,B,ce){if(Array.isArray(b))for(var ye=0;ye<b.length;ye++)Re(p,b[ye],k,B,ce);else B=m(B)?!!B.capture:!!B,k=H(k),p&&p[Le]?(p=p.i,b=String(b).toString(),b in p.g&&(ye=p.g[b],k=tt(ye,k,B,ce),-1<k&&(Je(ye[k]),Array.prototype.splice.call(ye,k,1),ye.length==0&&(delete p.g[b],p.h--)))):p&&(p=L(p))&&(b=p.g[b.toString()],p=-1,b&&(p=tt(b,k,B,ce)),(k=-1<p?b[p]:null)&&Ce(k))}function Ce(p){if(typeof p!="number"&&p&&!p.da){var b=p.src;if(b&&b[Le])De(b.i,p);else{var k=p.type,B=p.proxy;b.removeEventListener?b.removeEventListener(k,B,p.capture):b.detachEvent?b.detachEvent(U(k),B):b.addListener&&b.removeListener&&b.removeListener(B),(k=L(b))?(De(k,p),k.h==0&&(k.src=null,b[Ye]=null)):Je(p)}}}function U(p){return p in We?We[p]:We[p]="on"+p}function V(p,b){if(p.da)p=!0;else{b=new _e(b,this);var k=p.listener,B=p.ha||p.src;p.fa&&Ce(p),p=k.call(B,b)}return p}function L(p){return p=p[Ye],p instanceof ge?p:null}var oe="__closure_events_fn_"+(1e9*Math.random()>>>0);function H(p){return typeof p=="function"?p:(p[oe]||(p[oe]=function(b){return p.handleEvent(b)}),p[oe])}function J(){$.call(this),this.i=new ge(this),this.M=this,this.F=null}_(J,$),J.prototype[Le]=!0,J.prototype.removeEventListener=function(p,b,k,B){Re(this,p,b,k,B)};function be(p,b){var k,B=p.F;if(B)for(k=[];B;B=B.F)k.push(B);if(p=p.M,B=b.type||b,typeof b=="string")b=new ee(b,p);else if(b instanceof ee)b.target=b.target||p;else{var ce=b;b=new ee(B,p),M(b,ce)}if(ce=!0,k)for(var ye=k.length-1;0<=ye;ye--){var Pe=b.g=k[ye];ce=Me(Pe,B,!0,b)&&ce}if(Pe=b.g=p,ce=Me(Pe,B,!0,b)&&ce,ce=Me(Pe,B,!1,b)&&ce,k)for(ye=0;ye<k.length;ye++)Pe=b.g=k[ye],ce=Me(Pe,B,!1,b)&&ce}J.prototype.N=function(){if(J.aa.N.call(this),this.i){var p=this.i,b;for(b in p.g){for(var k=p.g[b],B=0;B<k.length;B++)Je(k[B]);delete p.g[b],p.h--}}this.F=null},J.prototype.K=function(p,b,k,B){return this.i.add(String(p),b,!1,k,B)},J.prototype.L=function(p,b,k,B){return this.i.add(String(p),b,!0,k,B)};function Me(p,b,k,B){if(b=p.i.g[String(b)],!b)return!0;b=b.concat();for(var ce=!0,ye=0;ye<b.length;++ye){var Pe=b[ye];if(Pe&&!Pe.da&&Pe.capture==k){var Rt=Pe.listener,vn=Pe.ha||Pe.src;Pe.fa&&De(p.i,Pe),ce=Rt.call(vn,B)!==!1&&ce}}return ce&&!B.defaultPrevented}function $e(p,b,k){if(typeof p=="function")k&&(p=S(p,k));else if(p&&typeof p.handleEvent=="function")p=S(p.handleEvent,p);else throw Error("Invalid listener argument");return 2147483647<Number(b)?-1:d.setTimeout(p,b||0)}function Ze(p){p.g=$e(()=>{p.g=null,p.i&&(p.i=!1,Ze(p))},p.l);const b=p.h;p.h=null,p.m.apply(null,b)}class Ke extends ${constructor(b,k){super(),this.m=b,this.l=k,this.h=null,this.i=!1,this.g=null}j(b){this.h=arguments,this.g?this.i=!0:Ze(this)}N(){super.N(),this.g&&(d.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Et(p){$.call(this),this.h=p,this.g={}}_(Et,$);var Ot=[];function Gt(p){G(p.g,function(b,k){this.g.hasOwnProperty(k)&&Ce(b)},p),p.g={}}Et.prototype.N=function(){Et.aa.N.call(this),Gt(this)},Et.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var et=d.JSON.stringify,ht=d.JSON.parse,Vt=class{stringify(p){return d.JSON.stringify(p,void 0)}parse(p){return d.JSON.parse(p,void 0)}};function ct(){}ct.prototype.h=null;function zt(p){return p.h||(p.h=p.i())}function On(){}var Wt={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function bn(){ee.call(this,"d")}_(bn,ee);function Ir(){ee.call(this,"c")}_(Ir,ee);var Er={},Es=null;function yi(){return Es=Es||new J}Er.La="serverreachability";function Cs(p){ee.call(this,Er.La,p)}_(Cs,ee);function Vr(p){const b=yi();be(b,new Cs(b))}Er.STAT_EVENT="statevent";function Rs(p,b){ee.call(this,Er.STAT_EVENT,p),this.stat=b}_(Rs,ee);function Zt(p){const b=yi();be(b,new Rs(b,p))}Er.Ma="timingevent";function Hi(p,b){ee.call(this,Er.Ma,p),this.size=b}_(Hi,ee);function ur(p,b){if(typeof p!="function")throw Error("Fn must not be null and must be a function");return d.setTimeout(function(){p()},b)}function xi(){this.g=!0}xi.prototype.xa=function(){this.g=!1};function bi(p,b,k,B,ce,ye){p.info(function(){if(p.g)if(ye)for(var Pe="",Rt=ye.split("&"),vn=0;vn<Rt.length;vn++){var St=Rt[vn].split("=");if(1<St.length){var Cn=St[0];St=St[1];var gn=Cn.split("_");Pe=2<=gn.length&&gn[1]=="type"?Pe+(Cn+"="+St+"&"):Pe+(Cn+"=redacted&")}}else Pe=null;else Pe=ye;return"XMLHTTP REQ ("+B+") [attempt "+ce+"]: "+b+`
`+k+`
`+Pe})}function at(p,b,k,B,ce,ye,Pe){p.info(function(){return"XMLHTTP RESP ("+B+") [ attempt "+ce+"]: "+b+`
`+k+`
`+ye+" "+Pe})}function rr(p,b,k,B){p.info(function(){return"XMLHTTP TEXT ("+b+"): "+Dc(p,k)+(B?" "+B:"")})}function $i(p,b){p.info(function(){return"TIMEOUT: "+b})}xi.prototype.info=function(){};function Dc(p,b){if(!p.g)return b;if(!b)return null;try{var k=JSON.parse(b);if(k){for(p=0;p<k.length;p++)if(Array.isArray(k[p])){var B=k[p];if(!(2>B.length)){var ce=B[1];if(Array.isArray(ce)&&!(1>ce.length)){var ye=ce[0];if(ye!="noop"&&ye!="stop"&&ye!="close")for(var Pe=1;Pe<ce.length;Pe++)ce[Pe]=""}}}}return et(k)}catch{return b}}var Ha={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Md={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Jr;function Oo(){}_(Oo,ct),Oo.prototype.g=function(){return new XMLHttpRequest},Oo.prototype.i=function(){return{}},Jr=new Oo;function Zr(p,b,k,B){this.j=p,this.i=b,this.l=k,this.R=B||1,this.U=new Et(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Ld}function Ld(){this.i=null,this.g="",this.h=!1}var Mc={},$a={};function Ga(p,b,k){p.L=1,p.v=Ns(Rr(b)),p.m=k,p.P=!0,Lc(p,null)}function Lc(p,b){p.F=Date.now(),Ut(p),p.A=Rr(p.v);var k=p.A,B=p.R;Array.isArray(B)||(B=[String(B)]),Ds(k.i,"t",B),p.C=0,k=p.j.J,p.h=new Ld,p.g=rh(p.j,k?b:null,!p.m),0<p.O&&(p.M=new Ke(S(p.Y,p,p.g),p.O)),b=p.U,k=p.g,B=p.ca;var ce="readystatechange";Array.isArray(ce)||(ce&&(Ot[0]=ce.toString()),ce=Ot);for(var ye=0;ye<ce.length;ye++){var Pe=pe(k,ce[ye],B||b.handleEvent,!1,b.h||b);if(!Pe)break;b.g[Pe.key]=Pe}b=p.H?E(p.H):{},p.m?(p.u||(p.u="POST"),b["Content-Type"]="application/x-www-form-urlencoded",p.g.ea(p.A,p.u,p.m,b)):(p.u="GET",p.g.ea(p.A,p.u,null,b)),Vr(),bi(p.i,p.u,p.A,p.l,p.R,p.m)}Zr.prototype.ca=function(p){p=p.target;const b=this.M;b&&hr(p)==3?b.j():this.Y(p)},Zr.prototype.Y=function(p){try{if(p==this.g)e:{const gn=hr(this.g);var b=this.g.Ba();const qr=this.g.Z();if(!(3>gn)&&(gn!=3||this.g&&(this.h.h||this.g.oa()||Hc(this.g)))){this.J||gn!=4||b==7||(b==8||0>=qr?Vr(3):Vr(2)),Vo(this);var k=this.g.Z();this.X=k;t:if(Od(this)){var B=Hc(this.g);p="";var ce=B.length,ye=hr(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Wr(this),As(this);var Pe="";break t}this.h.i=new d.TextDecoder}for(b=0;b<ce;b++)this.h.h=!0,p+=this.h.i.decode(B[b],{stream:!(ye&&b==ce-1)});B.length=0,this.h.g+=p,this.C=0,Pe=this.h.g}else Pe=this.g.oa();if(this.o=k==200,at(this.i,this.u,this.A,this.l,this.R,gn,k),this.o){if(this.T&&!this.K){t:{if(this.g){var Rt,vn=this.g;if((Rt=vn.g?vn.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!D(Rt)){var St=Rt;break t}}St=null}if(k=St)rr(this.i,this.l,k,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Oc(this,k);else{this.o=!1,this.s=3,Zt(12),Wr(this),As(this);break e}}if(this.P){k=!0;let Pr;for(;!this.J&&this.C<Pe.length;)if(Pr=tm(this,Pe),Pr==$a){gn==4&&(this.s=4,Zt(14),k=!1),rr(this.i,this.l,null,"[Incomplete Response]");break}else if(Pr==Mc){this.s=4,Zt(15),rr(this.i,this.l,Pe,"[Invalid Chunk]"),k=!1;break}else rr(this.i,this.l,Pr,null),Oc(this,Pr);if(Od(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),gn!=4||Pe.length!=0||this.h.h||(this.s=1,Zt(16),k=!1),this.o=this.o&&k,!k)rr(this.i,this.l,Pe,"[Invalid Chunked Response]"),Wr(this),As(this);else if(0<Pe.length&&!this.W){this.W=!0;var Cn=this.j;Cn.g==this&&Cn.ba&&!Cn.M&&(Cn.j.info("Great, no buffering proxy detected. Bytes received: "+Pe.length),Gc(Cn),Cn.M=!0,Zt(11))}}else rr(this.i,this.l,Pe,null),Oc(this,Pe);gn==4&&Wr(this),this.o&&!this.J&&(gn==4?il(this.j,this):(this.o=!1,Ut(this)))}else Za(this.g),k==400&&0<Pe.indexOf("Unknown SID")?(this.s=3,Zt(12)):(this.s=0,Zt(13)),Wr(this),As(this)}}}catch{}finally{}};function Od(p){return p.g?p.u=="GET"&&p.L!=2&&p.j.Ca:!1}function tm(p,b){var k=p.C,B=b.indexOf(`
`,k);return B==-1?$a:(k=Number(b.substring(k,B)),isNaN(k)?Mc:(B+=1,B+k>b.length?$a:(b=b.slice(B,B+k),p.C=B+k,b)))}Zr.prototype.cancel=function(){this.J=!0,Wr(this)};function Ut(p){p.S=Date.now()+p.I,Vd(p,p.I)}function Vd(p,b){if(p.B!=null)throw Error("WatchDog timer not null");p.B=ur(S(p.ba,p),b)}function Vo(p){p.B&&(d.clearTimeout(p.B),p.B=null)}Zr.prototype.ba=function(){this.B=null;const p=Date.now();0<=p-this.S?($i(this.i,this.A),this.L!=2&&(Vr(),Zt(17)),Wr(this),this.s=2,As(this)):Vd(this,this.S-p)};function As(p){p.j.G==0||p.J||il(p.j,p)}function Wr(p){Vo(p);var b=p.M;b&&typeof b.ma=="function"&&b.ma(),p.M=null,Gt(p.U),p.g&&(b=p.g,p.g=null,b.abort(),b.ma())}function Oc(p,b){try{var k=p.j;if(k.G!=0&&(k.g==p||ir(k.h,p))){if(!p.K&&ir(k.h,p)&&k.G==3){try{var B=k.Da.g.parse(b)}catch{B=null}if(Array.isArray(B)&&B.length==3){var ce=B;if(ce[0]==0){e:if(!k.u){if(k.g)if(k.g.F+3e3<p.F)rl(k),ii(k);else break e;nl(k),Zt(18)}}else k.za=ce[1],0<k.za-k.T&&37500>ce[2]&&k.F&&k.v==0&&!k.C&&(k.C=ur(S(k.Za,k),6e3));if(1>=Ud(k.h)&&k.ca){try{k.ca()}catch{}k.ca=void 0}}else Xi(k,11)}else if((p.K||k.g==p)&&rl(k),!D(b))for(ce=k.Da.g.parse(b),b=0;b<ce.length;b++){let St=ce[b];if(k.T=St[0],St=St[1],k.G==2)if(St[0]=="c"){k.K=St[1],k.ia=St[2];const Cn=St[3];Cn!=null&&(k.la=Cn,k.j.info("VER="+k.la));const gn=St[4];gn!=null&&(k.Aa=gn,k.j.info("SVER="+k.Aa));const qr=St[5];qr!=null&&typeof qr=="number"&&0<qr&&(B=1.5*qr,k.L=B,k.j.info("backChannelRequestTimeoutMs_="+B)),B=k;const Pr=p.g;if(Pr){const Ko=Pr.g?Pr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Ko){var ye=B.h;ye.g||Ko.indexOf("spdy")==-1&&Ko.indexOf("quic")==-1&&Ko.indexOf("h2")==-1||(ye.j=ye.l,ye.g=new Set,ye.h&&(Vc(ye,ye.h),ye.h=null))}if(B.D){const ol=Pr.g?Pr.g.getResponseHeader("X-HTTP-Session-Id"):null;ol&&(B.ya=ol,Dt(B.I,B.D,ol))}}k.G=3,k.l&&k.l.ua(),k.ba&&(k.R=Date.now()-p.F,k.j.info("Handshake RTT: "+k.R+"ms")),B=k;var Pe=p;if(B.qa=nh(B,B.J?B.ia:null,B.W),Pe.K){qd(B.h,Pe);var Rt=Pe,vn=B.L;vn&&(Rt.I=vn),Rt.B&&(Vo(Rt),Ut(Rt)),B.g=Pe}else Go(B);0<k.i.length&&ki(k)}else St[0]!="stop"&&St[0]!="close"||Xi(k,7);else k.G==3&&(St[0]=="stop"||St[0]=="close"?St[0]=="stop"?Xi(k,7):Wn(k):St[0]!="noop"&&k.l&&k.l.ta(St),k.v=0)}}Vr(4)}catch{}}var Wd=class{constructor(p,b){this.g=p,this.map=b}};function Wo(p){this.l=p||10,d.PerformanceNavigationTiming?(p=d.performance.getEntriesByType("navigation"),p=0<p.length&&(p[0].nextHopProtocol=="hq"||p[0].nextHopProtocol=="h2")):p=!!(d.chrome&&d.chrome.loadTimes&&d.chrome.loadTimes()&&d.chrome.loadTimes().wasFetchedViaSpdy),this.j=p?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Cr(p){return p.h?!0:p.g?p.g.size>=p.j:!1}function Ud(p){return p.h?1:p.g?p.g.size:0}function ir(p,b){return p.h?p.h==b:p.g?p.g.has(b):!1}function Vc(p,b){p.g?p.g.add(b):p.h=b}function qd(p,b){p.h&&p.h==b?p.h=null:p.g&&p.g.has(b)&&p.g.delete(b)}Wo.prototype.cancel=function(){if(this.i=Hd(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const p of this.g.values())p.cancel();this.g.clear()}};function Hd(p){if(p.h!=null)return p.i.concat(p.h.D);if(p.g!=null&&p.g.size!==0){let b=p.i;for(const k of p.g.values())b=b.concat(k.D);return b}return R(p.i)}function Ka(p){if(p.V&&typeof p.V=="function")return p.V();if(typeof Map<"u"&&p instanceof Map||typeof Set<"u"&&p instanceof Set)return Array.from(p.values());if(typeof p=="string")return p.split("");if(h(p)){for(var b=[],k=p.length,B=0;B<k;B++)b.push(p[B]);return b}b=[],k=0;for(B in p)b[k++]=p[B];return b}function Qa(p){if(p.na&&typeof p.na=="function")return p.na();if(!p.V||typeof p.V!="function"){if(typeof Map<"u"&&p instanceof Map)return Array.from(p.keys());if(!(typeof Set<"u"&&p instanceof Set)){if(h(p)||typeof p=="string"){var b=[];p=p.length;for(var k=0;k<p;k++)b.push(k);return b}b=[],k=0;for(const B in p)b[k++]=B;return b}}}function Ps(p,b){if(p.forEach&&typeof p.forEach=="function")p.forEach(b,void 0);else if(h(p)||typeof p=="string")Array.prototype.forEach.call(p,b,void 0);else for(var k=Qa(p),B=Ka(p),ce=B.length,ye=0;ye<ce;ye++)b.call(void 0,B[ye],k&&k[ye],p)}var Uo=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function nm(p,b){if(p){p=p.split("&");for(var k=0;k<p.length;k++){var B=p[k].indexOf("="),ce=null;if(0<=B){var ye=p[k].substring(0,B);ce=p[k].substring(B+1)}else ye=p[k];b(ye,ce?decodeURIComponent(ce.replace(/\+/g," ")):"")}}}function Gi(p){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,p instanceof Gi){this.h=p.h,qo(this,p.j),this.o=p.o,this.g=p.g,Bs(this,p.s),this.l=p.l;var b=p.i,k=new vi;k.i=b.i,b.g&&(k.g=new Map(b.g),k.h=b.h),Fs(this,k),this.m=p.m}else p&&(b=String(p).match(Uo))?(this.h=!1,qo(this,b[1]||"",!0),this.o=vt(b[2]||""),this.g=vt(b[3]||"",!0),Bs(this,b[4]),this.l=vt(b[5]||"",!0),Fs(this,b[6]||"",!0),this.m=vt(b[7]||"")):(this.h=!1,this.i=new vi(null,this.h))}Gi.prototype.toString=function(){var p=[],b=this.j;b&&p.push(zs(b,Ya,!0),":");var k=this.g;return(k||b=="file")&&(p.push("//"),(b=this.o)&&p.push(zs(b,Ya,!0),"@"),p.push(encodeURIComponent(String(k)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),k=this.s,k!=null&&p.push(":",String(k))),(k=this.l)&&(this.g&&k.charAt(0)!="/"&&p.push("/"),p.push(zs(k,k.charAt(0)=="/"?Kd:Gd,!0))),(k=this.i.toString())&&p.push("?",k),(k=this.m)&&p.push("#",zs(k,Wc)),p.join("")};function Rr(p){return new Gi(p)}function qo(p,b,k){p.j=k?vt(b,!0):b,p.j&&(p.j=p.j.replace(/:$/,""))}function Bs(p,b){if(b){if(b=Number(b),isNaN(b)||0>b)throw Error("Bad port number "+b);p.s=b}else p.s=null}function Fs(p,b,k){b instanceof vi?(p.i=b,wi(p.i,p.h)):(k||(b=zs(b,Qd)),p.i=new vi(b,p.h))}function Dt(p,b,k){p.i.set(b,k)}function Ns(p){return Dt(p,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),p}function vt(p,b){return p?b?decodeURI(p.replace(/%25/g,"%2525")):decodeURIComponent(p):""}function zs(p,b,k){return typeof p=="string"?(p=encodeURI(p).replace(b,$d),k&&(p=p.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),p):null}function $d(p){return p=p.charCodeAt(0),"%"+(p>>4&15).toString(16)+(p&15).toString(16)}var Ya=/[#\/\?@]/g,Gd=/[#\?:]/g,Kd=/[#\?]/g,Qd=/[#\?@]/g,Wc=/#/g;function vi(p,b){this.h=this.g=null,this.i=p||null,this.j=!!b}function Vn(p){p.g||(p.g=new Map,p.h=0,p.i&&nm(p.i,function(b,k){p.add(decodeURIComponent(b.replace(/\+/g," ")),k)}))}n=vi.prototype,n.add=function(p,b){Vn(this),this.i=null,p=Ur(this,p);var k=this.g.get(p);return k||this.g.set(p,k=[]),k.push(b),this.h+=1,this};function ei(p,b){Vn(p),b=Ur(p,b),p.g.has(b)&&(p.i=null,p.h-=p.g.get(b).length,p.g.delete(b))}function ti(p,b){return Vn(p),b=Ur(p,b),p.g.has(b)}n.forEach=function(p,b){Vn(this),this.g.forEach(function(k,B){k.forEach(function(ce){p.call(b,ce,B,this)},this)},this)},n.na=function(){Vn(this);const p=Array.from(this.g.values()),b=Array.from(this.g.keys()),k=[];for(let B=0;B<b.length;B++){const ce=p[B];for(let ye=0;ye<ce.length;ye++)k.push(b[B])}return k},n.V=function(p){Vn(this);let b=[];if(typeof p=="string")ti(this,p)&&(b=b.concat(this.g.get(Ur(this,p))));else{p=Array.from(this.g.values());for(let k=0;k<p.length;k++)b=b.concat(p[k])}return b},n.set=function(p,b){return Vn(this),this.i=null,p=Ur(this,p),ti(this,p)&&(this.h-=this.g.get(p).length),this.g.set(p,[b]),this.h+=1,this},n.get=function(p,b){return p?(p=this.V(p),0<p.length?String(p[0]):b):b};function Ds(p,b,k){ei(p,b),0<k.length&&(p.i=null,p.g.set(Ur(p,b),R(k)),p.h+=k.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const p=[],b=Array.from(this.g.keys());for(var k=0;k<b.length;k++){var B=b[k];const ye=encodeURIComponent(String(B)),Pe=this.V(B);for(B=0;B<Pe.length;B++){var ce=ye;Pe[B]!==""&&(ce+="="+encodeURIComponent(String(Pe[B]))),p.push(ce)}}return this.i=p.join("&")};function Ur(p,b){return b=String(b),p.j&&(b=b.toLowerCase()),b}function wi(p,b){b&&!p.j&&(Vn(p),p.i=null,p.g.forEach(function(k,B){var ce=B.toLowerCase();B!=ce&&(ei(this,B),Ds(this,ce,k))},p)),p.j=b}function rm(p,b){const k=new xi;if(d.Image){const B=new Image;B.onload=I(dr,k,"TestLoadImage: loaded",!0,b,B),B.onerror=I(dr,k,"TestLoadImage: error",!1,b,B),B.onabort=I(dr,k,"TestLoadImage: abort",!1,b,B),B.ontimeout=I(dr,k,"TestLoadImage: timeout",!1,b,B),d.setTimeout(function(){B.ontimeout&&B.ontimeout()},1e4),B.src=p}else b(!1)}function Yd(p,b){const k=new xi,B=new AbortController,ce=setTimeout(()=>{B.abort(),dr(k,"TestPingServer: timeout",!1,b)},1e4);fetch(p,{signal:B.signal}).then(ye=>{clearTimeout(ce),ye.ok?dr(k,"TestPingServer: ok",!0,b):dr(k,"TestPingServer: server error",!1,b)}).catch(()=>{clearTimeout(ce),dr(k,"TestPingServer: error",!1,b)})}function dr(p,b,k,B,ce){try{ce&&(ce.onload=null,ce.onerror=null,ce.onabort=null,ce.ontimeout=null),B(k)}catch{}}function im(){this.g=new Vt}function Xd(p,b,k){const B=k||"";try{Ps(p,function(ce,ye){let Pe=ce;m(ce)&&(Pe=et(ce)),b.push(B+ye+"="+encodeURIComponent(Pe))})}catch(ce){throw b.push(B+"type="+encodeURIComponent("_badmap")),ce}}function Ki(p){this.l=p.Ub||null,this.j=p.eb||!1}_(Ki,ct),Ki.prototype.g=function(){return new Ho(this.l,this.j)},Ki.prototype.i=function(p){return function(){return p}}({});function Ho(p,b){J.call(this),this.D=p,this.o=b,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}_(Ho,J),n=Ho.prototype,n.open=function(p,b){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=p,this.A=b,this.readyState=1,ri(this)},n.send=function(p){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const b={headers:this.u,method:this.B,credentials:this.m,cache:void 0};p&&(b.body=p),(this.D||d).fetch(new Request(this.A,b)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,ni(this)),this.readyState=0},n.Sa=function(p){if(this.g&&(this.l=p,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=p.headers,this.readyState=2,ri(this)),this.g&&(this.readyState=3,ri(this),this.g)))if(this.responseType==="arraybuffer")p.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof d.ReadableStream<"u"&&"body"in p){if(this.j=p.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Jd(this)}else p.text().then(this.Ra.bind(this),this.ga.bind(this))};function Jd(p){p.j.read().then(p.Pa.bind(p)).catch(p.ga.bind(p))}n.Pa=function(p){if(this.g){if(this.o&&p.value)this.response.push(p.value);else if(!this.o){var b=p.value?p.value:new Uint8Array(0);(b=this.v.decode(b,{stream:!p.done}))&&(this.response=this.responseText+=b)}p.done?ni(this):ri(this),this.readyState==3&&Jd(this)}},n.Ra=function(p){this.g&&(this.response=this.responseText=p,ni(this))},n.Qa=function(p){this.g&&(this.response=p,ni(this))},n.ga=function(){this.g&&ni(this)};function ni(p){p.readyState=4,p.l=null,p.j=null,p.v=null,ri(p)}n.setRequestHeader=function(p,b){this.u.append(p,b)},n.getResponseHeader=function(p){return this.h&&this.h.get(p.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const p=[],b=this.h.entries();for(var k=b.next();!k.done;)k=k.value,p.push(k[0]+": "+k[1]),k=b.next();return p.join(`\r
`)};function ri(p){p.onreadystatechange&&p.onreadystatechange.call(p)}Object.defineProperty(Ho.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(p){this.m=p?"include":"same-origin"}});function Qi(p){let b="";return G(p,function(k,B){b+=B,b+=":",b+=k,b+=`\r
`}),b}function Ms(p,b,k){e:{for(B in k){var B=!1;break e}B=!0}B||(k=Qi(k),typeof p=="string"?k!=null&&encodeURIComponent(String(k)):Dt(p,b,k))}function en(p){J.call(this),this.headers=new Map,this.o=p||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}_(en,J);var sm=/^https?$/i,Uc=["POST","PUT"];n=en.prototype,n.Ha=function(p){this.J=p},n.ea=function(p,b,k,B){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+p);b=b?b.toUpperCase():"GET",this.D=p,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Jr.g(),this.v=this.o?zt(this.o):zt(Jr),this.g.onreadystatechange=S(this.Ea,this);try{this.B=!0,this.g.open(b,String(p),!0),this.B=!1}catch(ye){$o(this,ye);return}if(p=k||"",k=new Map(this.headers),B)if(Object.getPrototypeOf(B)===Object.prototype)for(var ce in B)k.set(ce,B[ce]);else if(typeof B.keys=="function"&&typeof B.get=="function")for(const ye of B.keys())k.set(ye,B.get(ye));else throw Error("Unknown input type for opt_headers: "+String(B));B=Array.from(k.keys()).find(ye=>ye.toLowerCase()=="content-type"),ce=d.FormData&&p instanceof d.FormData,!(0<=Array.prototype.indexOf.call(Uc,b,void 0))||B||ce||k.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[ye,Pe]of k)this.g.setRequestHeader(ye,Pe);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Ja(this),this.u=!0,this.g.send(p),this.u=!1}catch(ye){$o(this,ye)}};function $o(p,b){p.h=!1,p.g&&(p.j=!0,p.g.abort(),p.j=!1),p.l=b,p.m=5,Xa(p),Ar(p)}function Xa(p){p.A||(p.A=!0,be(p,"complete"),be(p,"error"))}n.abort=function(p){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=p||7,be(this,"complete"),be(this,"abort"),Ar(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Ar(this,!0)),en.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?qc(this):this.bb())},n.bb=function(){qc(this)};function qc(p){if(p.h&&typeof c<"u"&&(!p.v[1]||hr(p)!=4||p.Z()!=2)){if(p.u&&hr(p)==4)$e(p.Ea,0,p);else if(be(p,"readystatechange"),hr(p)==4){p.h=!1;try{const Pe=p.Z();e:switch(Pe){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var b=!0;break e;default:b=!1}var k;if(!(k=b)){var B;if(B=Pe===0){var ce=String(p.D).match(Uo)[1]||null;!ce&&d.self&&d.self.location&&(ce=d.self.location.protocol.slice(0,-1)),B=!sm.test(ce?ce.toLowerCase():"")}k=B}if(k)be(p,"complete"),be(p,"success");else{p.m=6;try{var ye=2<hr(p)?p.g.statusText:""}catch{ye=""}p.l=ye+" ["+p.Z()+"]",Xa(p)}}finally{Ar(p)}}}}function Ar(p,b){if(p.g){Ja(p);const k=p.g,B=p.v[0]?()=>{}:null;p.g=null,p.v=null,b||be(p,"ready");try{k.onreadystatechange=B}catch{}}}function Ja(p){p.I&&(d.clearTimeout(p.I),p.I=null)}n.isActive=function(){return!!this.g};function hr(p){return p.g?p.g.readyState:0}n.Z=function(){try{return 2<hr(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(p){if(this.g){var b=this.g.responseText;return p&&b.indexOf(p)==0&&(b=b.substring(p.length)),ht(b)}};function Hc(p){try{if(!p.g)return null;if("response"in p.g)return p.g.response;switch(p.H){case"":case"text":return p.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in p.g)return p.g.mozResponseArrayBuffer}return null}catch{return null}}function Za(p){const b={};p=(p.g&&2<=hr(p)&&p.g.getAllResponseHeaders()||"").split(`\r
`);for(let B=0;B<p.length;B++){if(D(p[B]))continue;var k=O(p[B]);const ce=k[0];if(k=k[1],typeof k!="string")continue;k=k.trim();const ye=b[ce]||[];b[ce]=ye,ye.push(k)}N(b,function(B){return B.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Si(p,b,k){return k&&k.internalChannelParams&&k.internalChannelParams[p]||b}function $c(p){this.Aa=0,this.i=[],this.j=new xi,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Si("failFast",!1,p),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Si("baseRetryDelayMs",5e3,p),this.cb=Si("retryDelaySeedMs",1e4,p),this.Wa=Si("forwardChannelMaxRetries",2,p),this.wa=Si("forwardChannelRequestTimeoutMs",2e4,p),this.pa=p&&p.xmlHttpFactory||void 0,this.Xa=p&&p.Tb||void 0,this.Ca=p&&p.useFetchStreams||!1,this.L=void 0,this.J=p&&p.supportsCrossDomainXhr||!1,this.K="",this.h=new Wo(p&&p.concurrentRequestLimit),this.Da=new im,this.P=p&&p.fastHandshake||!1,this.O=p&&p.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=p&&p.Rb||!1,p&&p.xa&&this.j.xa(),p&&p.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&p&&p.detectBufferingProxy||!1,this.ja=void 0,p&&p.longPollingTimeout&&0<p.longPollingTimeout&&(this.ja=p.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=$c.prototype,n.la=8,n.G=1,n.connect=function(p,b,k,B){Zt(0),this.W=p,this.H=b||{},k&&B!==void 0&&(this.H.OSID=k,this.H.OAID=B),this.F=this.X,this.I=nh(this,null,this.W),ki(this)};function Wn(p){if(el(p),p.G==3){var b=p.U++,k=Rr(p.I);if(Dt(k,"SID",p.K),Dt(k,"RID",b),Dt(k,"TYPE","terminate"),Yi(p,k),b=new Zr(p,p.j,b),b.L=2,b.v=Ns(Rr(k)),k=!1,d.navigator&&d.navigator.sendBeacon)try{k=d.navigator.sendBeacon(b.v.toString(),"")}catch{}!k&&d.Image&&(new Image().src=b.v,k=!0),k||(b.g=rh(b.j,null),b.g.ea(b.v)),b.F=Date.now(),Ut(b)}th(p)}function ii(p){p.g&&(Gc(p),p.g.cancel(),p.g=null)}function el(p){ii(p),p.u&&(d.clearTimeout(p.u),p.u=null),rl(p),p.h.cancel(),p.s&&(typeof p.s=="number"&&d.clearTimeout(p.s),p.s=null)}function ki(p){if(!Cr(p.h)&&!p.s){p.s=!0;var b=p.Ga;ae||ne(),se||(ae(),se=!0),re.add(b,p),p.B=0}}function om(p,b){return Ud(p.h)>=p.h.j-(p.s?1:0)?!1:p.s?(p.i=b.D.concat(p.i),!0):p.G==1||p.G==2||p.B>=(p.Va?0:p.Wa)?!1:(p.s=ur(S(p.Ga,p,b),eh(p,p.B)),p.B++,!0)}n.Ga=function(p){if(this.s)if(this.s=null,this.G==1){if(!p){this.U=Math.floor(1e5*Math.random()),p=this.U++;const ce=new Zr(this,this.j,p);let ye=this.o;if(this.S&&(ye?(ye=E(ye),M(ye,this.S)):ye=this.S),this.m!==null||this.O||(ce.H=ye,ye=null),this.P)e:{for(var b=0,k=0;k<this.i.length;k++){t:{var B=this.i[k];if("__data__"in B.map&&(B=B.map.__data__,typeof B=="string")){B=B.length;break t}B=void 0}if(B===void 0)break;if(b+=B,4096<b){b=k;break e}if(b===4096||k===this.i.length-1){b=k+1;break e}}b=1e3}else b=1e3;b=Ls(this,ce,b),k=Rr(this.I),Dt(k,"RID",p),Dt(k,"CVER",22),this.D&&Dt(k,"X-HTTP-Session-Id",this.D),Yi(this,k),ye&&(this.O?b="headers="+encodeURIComponent(String(Qi(ye)))+"&"+b:this.m&&Ms(k,this.m,ye)),Vc(this.h,ce),this.Ua&&Dt(k,"TYPE","init"),this.P?(Dt(k,"$req",b),Dt(k,"SID","null"),ce.T=!0,Ga(ce,k,null)):Ga(ce,k,b),this.G=2}}else this.G==3&&(p?tl(this,p):this.i.length==0||Cr(this.h)||tl(this))};function tl(p,b){var k;b?k=b.l:k=p.U++;const B=Rr(p.I);Dt(B,"SID",p.K),Dt(B,"RID",k),Dt(B,"AID",p.T),Yi(p,B),p.m&&p.o&&Ms(B,p.m,p.o),k=new Zr(p,p.j,k,p.B+1),p.m===null&&(k.H=p.o),b&&(p.i=b.D.concat(p.i)),b=Ls(p,k,1e3),k.I=Math.round(.5*p.wa)+Math.round(.5*p.wa*Math.random()),Vc(p.h,k),Ga(k,B,b)}function Yi(p,b){p.H&&G(p.H,function(k,B){Dt(b,B,k)}),p.l&&Ps({},function(k,B){Dt(b,B,k)})}function Ls(p,b,k){k=Math.min(p.i.length,k);var B=p.l?S(p.l.Na,p.l,p):null;e:{var ce=p.i;let ye=-1;for(;;){const Pe=["count="+k];ye==-1?0<k?(ye=ce[0].g,Pe.push("ofs="+ye)):ye=0:Pe.push("ofs="+ye);let Rt=!0;for(let vn=0;vn<k;vn++){let St=ce[vn].g;const Cn=ce[vn].map;if(St-=ye,0>St)ye=Math.max(0,ce[vn].g-100),Rt=!1;else try{Xd(Cn,Pe,"req"+St+"_")}catch{B&&B(Cn)}}if(Rt){B=Pe.join("&");break e}}}return p=p.i.splice(0,k),b.D=p,B}function Go(p){if(!p.g&&!p.u){p.Y=1;var b=p.Fa;ae||ne(),se||(ae(),se=!0),re.add(b,p),p.v=0}}function nl(p){return p.g||p.u||3<=p.v?!1:(p.Y++,p.u=ur(S(p.Fa,p),eh(p,p.v)),p.v++,!0)}n.Fa=function(){if(this.u=null,Zd(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var p=2*this.R;this.j.info("BP detection timer enabled: "+p),this.A=ur(S(this.ab,this),p)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Zt(10),ii(this),Zd(this))};function Gc(p){p.A!=null&&(d.clearTimeout(p.A),p.A=null)}function Zd(p){p.g=new Zr(p,p.j,"rpc",p.Y),p.m===null&&(p.g.H=p.o),p.g.O=0;var b=Rr(p.qa);Dt(b,"RID","rpc"),Dt(b,"SID",p.K),Dt(b,"AID",p.T),Dt(b,"CI",p.F?"0":"1"),!p.F&&p.ja&&Dt(b,"TO",p.ja),Dt(b,"TYPE","xmlhttp"),Yi(p,b),p.m&&p.o&&Ms(b,p.m,p.o),p.L&&(p.g.I=p.L);var k=p.g;p=p.ia,k.L=1,k.v=Ns(Rr(b)),k.m=null,k.P=!0,Lc(k,p)}n.Za=function(){this.C!=null&&(this.C=null,ii(this),nl(this),Zt(19))};function rl(p){p.C!=null&&(d.clearTimeout(p.C),p.C=null)}function il(p,b){var k=null;if(p.g==b){rl(p),Gc(p),p.g=null;var B=2}else if(ir(p.h,b))k=b.D,qd(p.h,b),B=1;else return;if(p.G!=0){if(b.o)if(B==1){k=b.m?b.m.length:0,b=Date.now()-b.F;var ce=p.B;B=yi(),be(B,new Hi(B,k)),ki(p)}else Go(p);else if(ce=b.s,ce==3||ce==0&&0<b.X||!(B==1&&om(p,b)||B==2&&nl(p)))switch(k&&0<k.length&&(b=p.h,b.i=b.i.concat(k)),ce){case 1:Xi(p,5);break;case 4:Xi(p,10);break;case 3:Xi(p,6);break;default:Xi(p,2)}}}function eh(p,b){let k=p.Ta+Math.floor(Math.random()*p.cb);return p.isActive()||(k*=2),k*b}function Xi(p,b){if(p.j.info("Error code "+b),b==2){var k=S(p.fb,p),B=p.Xa;const ce=!B;B=new Gi(B||"//www.google.com/images/cleardot.gif"),d.location&&d.location.protocol=="http"||qo(B,"https"),Ns(B),ce?rm(B.toString(),k):Yd(B.toString(),k)}else Zt(2);p.G=0,p.l&&p.l.sa(b),th(p),el(p)}n.fb=function(p){p?(this.j.info("Successfully pinged google.com"),Zt(2)):(this.j.info("Failed to ping google.com"),Zt(1))};function th(p){if(p.G=0,p.ka=[],p.l){const b=Hd(p.h);(b.length!=0||p.i.length!=0)&&(T(p.ka,b),T(p.ka,p.i),p.h.i.length=0,R(p.i),p.i.length=0),p.l.ra()}}function nh(p,b,k){var B=k instanceof Gi?Rr(k):new Gi(k);if(B.g!="")b&&(B.g=b+"."+B.g),Bs(B,B.s);else{var ce=d.location;B=ce.protocol,b=b?b+"."+ce.hostname:ce.hostname,ce=+ce.port;var ye=new Gi(null);B&&qo(ye,B),b&&(ye.g=b),ce&&Bs(ye,ce),k&&(ye.l=k),B=ye}return k=p.D,b=p.ya,k&&b&&Dt(B,k,b),Dt(B,"VER",p.la),Yi(p,B),B}function rh(p,b,k){if(b&&!p.J)throw Error("Can't create secondary domain capable XhrIo object.");return b=p.Ca&&!p.pa?new en(new Ki({eb:k})):new en(p.pa),b.Ha(p.J),b}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Kc(){}n=Kc.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function sl(){}sl.prototype.g=function(p,b){return new sr(p,b)};function sr(p,b){J.call(this),this.g=new $c(b),this.l=p,this.h=b&&b.messageUrlParams||null,p=b&&b.messageHeaders||null,b&&b.clientProtocolHeaderRequired&&(p?p["X-Client-Protocol"]="webchannel":p={"X-Client-Protocol":"webchannel"}),this.g.o=p,p=b&&b.initMessageHeaders||null,b&&b.messageContentType&&(p?p["X-WebChannel-Content-Type"]=b.messageContentType:p={"X-WebChannel-Content-Type":b.messageContentType}),b&&b.va&&(p?p["X-WebChannel-Client-Profile"]=b.va:p={"X-WebChannel-Client-Profile":b.va}),this.g.S=p,(p=b&&b.Sb)&&!D(p)&&(this.g.m=p),this.v=b&&b.supportsCrossDomainXhr||!1,this.u=b&&b.sendRawJson||!1,(b=b&&b.httpSessionIdParam)&&!D(b)&&(this.g.D=b,p=this.h,p!==null&&b in p&&(p=this.h,b in p&&delete p[b])),this.j=new Ti(this)}_(sr,J),sr.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},sr.prototype.close=function(){Wn(this.g)},sr.prototype.o=function(p){var b=this.g;if(typeof p=="string"){var k={};k.__data__=p,p=k}else this.u&&(k={},k.__data__=et(p),p=k);b.i.push(new Wd(b.Ya++,p)),b.G==3&&ki(b)},sr.prototype.N=function(){this.g.l=null,delete this.j,Wn(this.g),delete this.g,sr.aa.N.call(this)};function ih(p){bn.call(this),p.__headers__&&(this.headers=p.__headers__,this.statusCode=p.__status__,delete p.__headers__,delete p.__status__);var b=p.__sm__;if(b){e:{for(const k in b){p=k;break e}p=void 0}(this.i=p)&&(p=this.i,b=b!==null&&p in b?b[p]:void 0),this.data=b}else this.data=p}_(ih,bn);function sh(){Ir.call(this),this.status=1}_(sh,Ir);function Ti(p){this.g=p}_(Ti,Kc),Ti.prototype.ua=function(){be(this.g,"a")},Ti.prototype.ta=function(p){be(this.g,new ih(p))},Ti.prototype.sa=function(p){be(this.g,new sh)},Ti.prototype.ra=function(){be(this.g,"b")},sl.prototype.createWebChannel=sl.prototype.g,sr.prototype.send=sr.prototype.o,sr.prototype.open=sr.prototype.m,sr.prototype.close=sr.prototype.close,Hk=function(){return new sl},qk=function(){return yi()},Uk=Er,py={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Ha.NO_ERROR=0,Ha.TIMEOUT=8,Ha.HTTP_ERROR=6,pp=Ha,Md.COMPLETE="complete",Wk=Md,On.EventType=Wt,Wt.OPEN="a",Wt.CLOSE="b",Wt.ERROR="c",Wt.MESSAGE="d",J.prototype.listen=J.prototype.K,Cu=On,en.prototype.listenOnce=en.prototype.L,en.prototype.getLastError=en.prototype.Ka,en.prototype.getLastErrorCode=en.prototype.Ba,en.prototype.getStatus=en.prototype.Z,en.prototype.getResponseJson=en.prototype.Oa,en.prototype.getResponseText=en.prototype.oa,en.prototype.send=en.prototype.ea,en.prototype.setWithCredentials=en.prototype.Ha,Vk=en}).apply(typeof Zh<"u"?Zh:typeof self<"u"?self:typeof window<"u"?window:{});const vw="@firebase/firestore",ww="4.7.17";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nn{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Nn.UNAUTHENTICATED=new Nn(null),Nn.GOOGLE_CREDENTIALS=new Nn("google-credentials-uid"),Nn.FIRST_PARTY=new Nn("first-party-uid"),Nn.MOCK_USER=new Nn("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let wc="11.9.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xo=new ax("@firebase/firestore");function Ml(){return xo.logLevel}function kA(n){xo.setLogLevel(n)}function Te(n,...e){if(xo.logLevel<=yt.DEBUG){const t=e.map(ux);xo.debug(`Firestore (${wc}): ${n}`,...t)}}function pn(n,...e){if(xo.logLevel<=yt.ERROR){const t=e.map(ux);xo.error(`Firestore (${wc}): ${n}`,...t)}}function Lr(n,...e){if(xo.logLevel<=yt.WARN){const t=e.map(ux);xo.warn(`Firestore (${wc}): ${n}`,...t)}}function ux(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(t){return JSON.stringify(t)}(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Oe(n,e,t){let r="Unexpected state";typeof e=="string"?r=e:t=e,$k(n,r,t)}function $k(n,e,t){let r=`FIRESTORE (${wc}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{r+=" CONTEXT: "+JSON.stringify(t)}catch{r+=" CONTEXT: "+t}throw pn(r),new Error(r)}function He(n,e,t,r){let s="Unexpected state";typeof t=="string"?s=t:r=t,n||$k(e,s,r)}function TA(n,e){n||Oe(57014,e)}function Be(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const me={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class ke extends Ui{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zn{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gk{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class Kk{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(Nn.UNAUTHENTICATED))}shutdown(){}}class _A{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class jA{constructor(e){this.t=e,this.currentUser=Nn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){He(this.o===void 0,42304);let r=this.i;const s=h=>this.i!==r?(r=this.i,t(h)):Promise.resolve();let a=new zn;this.o=()=>{this.i++,this.currentUser=this.u(),a.resolve(),a=new zn,e.enqueueRetryable(()=>s(this.currentUser))};const c=()=>{const h=a;e.enqueueRetryable(async()=>{await h.promise,await s(this.currentUser)})},d=h=>{Te("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=h,this.o&&(this.auth.addAuthTokenListener(this.o),c())};this.t.onInit(h=>d(h)),setTimeout(()=>{if(!this.auth){const h=this.t.getImmediate({optional:!0});h?d(h):(Te("FirebaseAuthCredentialsProvider","Auth not yet detected"),a.resolve(),a=new zn)}},0),c()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(Te("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(He(typeof r.accessToken=="string",31837,{l:r}),new Gk(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return He(e===null||typeof e=="string",2055,{h:e}),new Nn(e)}}class IA{constructor(e,t,r){this.P=e,this.T=t,this.I=r,this.type="FirstParty",this.user=Nn.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class EA{constructor(e,t,r){this.P=e,this.T=t,this.I=r}getToken(){return Promise.resolve(new IA(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t(Nn.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class fy{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class CA{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,vr(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){He(this.o===void 0,3512);const r=a=>{a.error!=null&&Te("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${a.error.message}`);const c=a.token!==this.m;return this.m=a.token,Te("FirebaseAppCheckTokenProvider",`Received ${c?"new":"existing"} token.`),c?t(a.token):Promise.resolve()};this.o=a=>{e.enqueueRetryable(()=>r(a))};const s=a=>{Te("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=a,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(a=>s(a)),setTimeout(()=>{if(!this.appCheck){const a=this.V.getImmediate({optional:!0});a?s(a):Te("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new fy(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(He(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new fy(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}class RA{getToken(){return Promise.resolve(new fy(""))}invalidateToken(){}start(e,t){}shutdown(){}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AA(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dx(){return new TextEncoder}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hx{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const s=AA(40);for(let a=0;a<s.length;++a)r.length<20&&s[a]<t&&(r+=e.charAt(s[a]%62))}return r}}function st(n,e){return n<e?-1:n>e?1:0}function my(n,e){let t=0;for(;t<n.length&&t<e.length;){const r=n.codePointAt(t),s=e.codePointAt(t);if(r!==s){if(r<128&&s<128)return st(r,s);{const a=dx(),c=PA(a.encode(Sw(n,t)),a.encode(Sw(e,t)));return c!==0?c:st(r,s)}}t+=r>65535?2:1}return st(n.length,e.length)}function Sw(n,e){return n.codePointAt(e)>65535?n.substring(e,e+2):n.substring(e,e+1)}function PA(n,e){for(let t=0;t<n.length&&t<e.length;++t)if(n[t]!==e[t])return st(n[t],e[t]);return st(n.length,e.length)}function Ql(n,e,t){return n.length===e.length&&n.every((r,s)=>t(r,e[s]))}function Qk(n){return n+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kw=-62135596800,Tw=1e6;class Lt{static now(){return Lt.fromMillis(Date.now())}static fromDate(e){return Lt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor((e-1e3*t)*Tw);return new Lt(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new ke(me.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new ke(me.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<kw)throw new ke(me.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new ke(me.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/Tw}_compareTo(e){return this.seconds===e.seconds?st(this.nanoseconds,e.nanoseconds):st(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds-kw;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xe{static fromTimestamp(e){return new Xe(e)}static min(){return new Xe(new Lt(0,0))}static max(){return new Xe(new Lt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gy="__name__";class Ai{constructor(e,t,r){t===void 0?t=0:t>e.length&&Oe(637,{offset:t,range:e.length}),r===void 0?r=e.length-t:r>e.length-t&&Oe(1746,{length:r,range:e.length-t}),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return Ai.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Ai?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let s=0;s<r;s++){const a=Ai.compareSegments(e.get(s),t.get(s));if(a!==0)return a}return st(e.length,t.length)}static compareSegments(e,t){const r=Ai.isNumericId(e),s=Ai.isNumericId(t);return r&&!s?-1:!r&&s?1:r&&s?Ai.extractNumericId(e).compare(Ai.extractNumericId(t)):my(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return fo.fromString(e.substring(4,e.length-2))}}class xt extends Ai{construct(e,t,r){return new xt(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new ke(me.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(s=>s.length>0))}return new xt(t)}static emptyPath(){return new xt([])}}const BA=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Xt extends Ai{construct(e,t,r){return new Xt(e,t,r)}static isValidIdentifier(e){return BA.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Xt.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===gy}static keyField(){return new Xt([gy])}static fromServerFormat(e){const t=[];let r="",s=0;const a=()=>{if(r.length===0)throw new ke(me.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let c=!1;for(;s<e.length;){const d=e[s];if(d==="\\"){if(s+1===e.length)throw new ke(me.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const h=e[s+1];if(h!=="\\"&&h!=="."&&h!=="`")throw new ke(me.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=h,s+=2}else d==="`"?(c=!c,s++):d!=="."||c?(r+=d,s++):(a(),s++)}if(a(),c)throw new ke(me.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Xt(t)}static emptyPath(){return new Xt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fe{constructor(e){this.path=e}static fromPath(e){return new Fe(xt.fromString(e))}static fromName(e){return new Fe(xt.fromString(e).popFirst(5))}static empty(){return new Fe(xt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&xt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return xt.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Fe(new xt(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yl=-1;class Xl{constructor(e,t,r,s){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=s}}function yy(n){return n.fields.find(e=>e.kind===2)}function ca(n){return n.fields.filter(e=>e.kind!==2)}function FA(n,e){let t=st(n.collectionGroup,e.collectionGroup);if(t!==0)return t;for(let r=0;r<Math.min(n.fields.length,e.fields.length);++r)if(t=NA(n.fields[r],e.fields[r]),t!==0)return t;return st(n.fields.length,e.fields.length)}Xl.UNKNOWN_ID=-1;class va{constructor(e,t){this.fieldPath=e,this.kind=t}}function NA(n,e){const t=Xt.comparator(n.fieldPath,e.fieldPath);return t!==0?t:st(n.kind,e.kind)}class Jl{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new Jl(0,Or.min())}}function Yk(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,s=Xe.fromTimestamp(r===1e9?new Lt(t+1,0):new Lt(t,r));return new Or(s,Fe.empty(),e)}function Xk(n){return new Or(n.readTime,n.key,Yl)}class Or{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new Or(Xe.min(),Fe.empty(),Yl)}static max(){return new Or(Xe.max(),Fe.empty(),Yl)}}function px(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=Fe.comparator(n.documentKey,e.documentKey),t!==0?t:st(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jk="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Zk{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Eo(n){if(n.code!==me.FAILED_PRECONDITION||n.message!==Jk)throw n;Te("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class le{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Oe(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new le((r,s)=>{this.nextCallback=a=>{this.wrapSuccess(e,a).next(r,s)},this.catchCallback=a=>{this.wrapFailure(t,a).next(r,s)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof le?t:le.resolve(t)}catch(t){return le.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):le.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):le.reject(t)}static resolve(e){return new le((t,r)=>{t(e)})}static reject(e){return new le((t,r)=>{r(e)})}static waitFor(e){return new le((t,r)=>{let s=0,a=0,c=!1;e.forEach(d=>{++s,d.next(()=>{++a,c&&a===s&&t()},h=>r(h))}),c=!0,a===s&&t()})}static or(e){let t=le.resolve(!1);for(const r of e)t=t.next(s=>s?le.resolve(s):r());return t}static forEach(e,t){const r=[];return e.forEach((s,a)=>{r.push(t.call(this,s,a))}),this.waitFor(r)}static mapArray(e,t){return new le((r,s)=>{const a=e.length,c=new Array(a);let d=0;for(let h=0;h<a;h++){const m=h;t(e[m]).next(g=>{c[m]=g,++d,d===a&&r(c)},g=>s(g))}})}static doWhile(e,t){return new le((r,s)=>{const a=()=>{e()===!0?t().next(()=>{a()},s):r()};a()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zr="SimpleDb";class gf{static open(e,t,r,s){try{return new gf(t,e.transaction(s,r))}catch(a){throw new Nu(t,a)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.S=new zn,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{t.error?this.S.reject(new Nu(e,t.error)):this.S.resolve()},this.transaction.onerror=r=>{const s=fx(r.target.error);this.S.reject(new Nu(e,s))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(Te(zr,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}v(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new DA(t)}}class Mi{static delete(e){return Te(zr,"Removing database:",e),da(_k().indexedDB.deleteDatabase(e)).toPromise()}static C(){if(!Fk())return!1;if(Mi.F())return!0;const e=In(),t=Mi.M(e),r=0<t&&t<10,s=eT(e),a=0<s&&s<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||a)}static F(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.O)==="YES"}static N(e,t){return e.store(t)}static M(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)}constructor(e,t,r){this.name=e,this.version=t,this.B=r,this.L=null,Mi.M(In())===12.2&&pn("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async k(e){return this.db||(Te(zr,"Opening database:",this.name),this.db=await new Promise((t,r)=>{const s=indexedDB.open(this.name,this.version);s.onsuccess=a=>{const c=a.target.result;t(c)},s.onblocked=()=>{r(new Nu(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},s.onerror=a=>{const c=a.target.error;c.name==="VersionError"?r(new ke(me.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):c.name==="InvalidStateError"?r(new ke(me.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+c)):r(new Nu(e,c))},s.onupgradeneeded=a=>{Te(zr,'Database "'+this.name+'" requires upgrade from version:',a.oldVersion);const c=a.target.result;if(this.L!==null&&this.L!==a.oldVersion)throw new Error(`refusing to open IndexedDB database due to potential corruption of the IndexedDB database data; this corruption could be caused by clicking the "clear site data" button in a web browser; try reloading the web page to re-initialize the IndexedDB database: lastClosedDbVersion=${this.L}, event.oldVersion=${a.oldVersion}, event.newVersion=${a.newVersion}, db.version=${c.version}`);this.B.q(c,s.transaction,a.oldVersion,this.version).next(()=>{Te(zr,"Database upgrade to version "+this.version+" complete")})}}),this.db.addEventListener("close",t=>{const r=t.target;this.L=r.version},{passive:!0})),this.$&&(this.db.onversionchange=t=>this.$(t)),this.db}U(e){this.$=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,r,s){const a=t==="readonly";let c=0;for(;;){++c;try{this.db=await this.k(e);const d=gf.open(this.db,e,a?"readonly":"readwrite",r),h=s(d).next(m=>(d.v(),m)).catch(m=>(d.abort(m),le.reject(m))).toPromise();return h.catch(()=>{}),await d.D,h}catch(d){const h=d,m=h.name!=="FirebaseError"&&c<3;if(Te(zr,"Transaction failed with error:",h.message,"Retrying:",m),this.close(),!m)return Promise.reject(h)}}}close(){this.db&&this.db.close(),this.db=void 0}}function eT(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class zA{constructor(e){this.K=e,this.W=!1,this.G=null}get isDone(){return this.W}get j(){return this.G}set cursor(e){this.K=e}done(){this.W=!0}H(e){this.G=e}delete(){return da(this.K.delete())}}class Nu extends ke{constructor(e,t){super(me.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function Co(n){return n.name==="IndexedDbTransactionError"}class DA{constructor(e){this.store=e}put(e,t){let r;return t!==void 0?(Te(zr,"PUT",this.store.name,e,t),r=this.store.put(t,e)):(Te(zr,"PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),da(r)}add(e){return Te(zr,"ADD",this.store.name,e,e),da(this.store.add(e))}get(e){return da(this.store.get(e)).next(t=>(t===void 0&&(t=null),Te(zr,"GET",this.store.name,e,t),t))}delete(e){return Te(zr,"DELETE",this.store.name,e),da(this.store.delete(e))}count(){return Te(zr,"COUNT",this.store.name),da(this.store.count())}J(e,t){const r=this.options(e,t),s=r.index?this.store.index(r.index):this.store;if(typeof s.getAll=="function"){const a=s.getAll(r.range);return new le((c,d)=>{a.onerror=h=>{d(h.target.error)},a.onsuccess=h=>{c(h.target.result)}})}{const a=this.cursor(r),c=[];return this.Y(a,(d,h)=>{c.push(h)}).next(()=>c)}}Z(e,t){const r=this.store.getAll(e,t===null?void 0:t);return new le((s,a)=>{r.onerror=c=>{a(c.target.error)},r.onsuccess=c=>{s(c.target.result)}})}X(e,t){Te(zr,"DELETE ALL",this.store.name);const r=this.options(e,t);r.ee=!1;const s=this.cursor(r);return this.Y(s,(a,c,d)=>d.delete())}te(e,t){let r;t?r=e:(r={},t=e);const s=this.cursor(r);return this.Y(s,t)}ne(e){const t=this.cursor({});return new le((r,s)=>{t.onerror=a=>{const c=fx(a.target.error);s(c)},t.onsuccess=a=>{const c=a.target.result;c?e(c.primaryKey,c.value).next(d=>{d?c.continue():r()}):r()}})}Y(e,t){const r=[];return new le((s,a)=>{e.onerror=c=>{a(c.target.error)},e.onsuccess=c=>{const d=c.target.result;if(!d)return void s();const h=new zA(d),m=t(d.primaryKey,d.value,h);if(m instanceof le){const g=m.catch(x=>(h.done(),le.reject(x)));r.push(g)}h.isDone?s():h.j===null?d.continue():d.continue(h.j)}}).next(()=>le.waitFor(r))}options(e,t){let r;return e!==void 0&&(typeof e=="string"?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const r=this.store.index(e.index);return e.ee?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function da(n){return new le((e,t)=>{n.onsuccess=r=>{const s=r.target.result;e(s)},n.onerror=r=>{const s=fx(r.target.error);t(s)}})}let _w=!1;function fx(n){const e=Mi.M(In());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const r=new ke("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return _w||(_w=!0,setTimeout(()=>{throw r},0)),r}}return n}const zu="IndexBackfiller";class MA{constructor(e,t){this.asyncQueue=e,this.re=t,this.task=null}start(){this.ie(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}ie(e){Te(zu,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{const t=await this.re.se();Te(zu,`Documents written: ${t}`)}catch(t){Co(t)?Te(zu,"Ignoring IndexedDB error during index backfill: ",t):await Eo(t)}await this.ie(6e4)})}}class LA{constructor(e,t){this.localStore=e,this.persistence=t}async se(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",t=>this.oe(t,e))}oe(e,t){const r=new Set;let s=t,a=!0;return le.doWhile(()=>a===!0&&s>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(c=>{if(c!==null&&!r.has(c))return Te(zu,`Processing collection: ${c}`),this._e(e,c,s).next(d=>{s-=d,r.add(c)});a=!1})).next(()=>t-s)}_e(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(s=>this.localStore.localDocuments.getNextDocuments(e,t,s,r).next(a=>{const c=a.changes;return this.localStore.indexManager.updateIndexEntries(e,c).next(()=>this.ae(s,a)).next(d=>(Te(zu,`Updating offset: ${d}`),this.localStore.indexManager.updateCollectionGroup(e,t,d))).next(()=>c.size)}))}ae(e,t){let r=e;return t.changes.forEach((s,a)=>{const c=Xk(a);px(c,r)>0&&(r=c)}),new Or(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wr{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this.ue(r),this.ce=r=>t.writeSequenceNumber(r))}ue(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ce&&this.ce(e),e}}wr.le=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mo=-1;function hd(n){return n==null}function Qu(n){return n===0&&1/n==-1/0}function tT(n){return typeof n=="number"&&Number.isInteger(n)&&!Qu(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bp="";function tr(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=jw(e)),e=OA(n.get(t),e);return jw(e)}function OA(n,e){let t=e;const r=n.length;for(let s=0;s<r;s++){const a=n.charAt(s);switch(a){case"\0":t+="";break;case Bp:t+="";break;default:t+=a}}return t}function jw(n){return n+Bp+""}function Fi(n){const e=n.length;if(He(e>=2,64408,{path:n}),e===2)return He(n.charAt(0)===Bp&&n.charAt(1)==="",56145,{path:n}),xt.emptyPath();const t=e-2,r=[];let s="";for(let a=0;a<e;){const c=n.indexOf(Bp,a);switch((c<0||c>t)&&Oe(50515,{path:n}),n.charAt(c+1)){case"":const d=n.substring(a,c);let h;s.length===0?h=d:(s+=d,h=s,s=""),r.push(h);break;case"":s+=n.substring(a,c),s+="\0";break;case"":s+=n.substring(a,c+1);break;default:Oe(61167,{path:n})}a=c+2}return new xt(r)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ua="remoteDocuments",pd="owner",Il="owner",Yu="mutationQueues",VA="userId",di="mutations",Iw="batchId",ma="userMutationsIndex",Ew=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fp(n,e){return[n,tr(e)]}function nT(n,e,t){return[n,tr(e),t]}const WA={},Zl="documentMutations",Fp="remoteDocumentsV14",UA=["prefixPath","collectionGroup","readTime","documentId"],mp="documentKeyIndex",qA=["prefixPath","collectionGroup","documentId"],rT="collectionGroupIndex",HA=["collectionGroup","readTime","prefixPath","documentId"],Xu="remoteDocumentGlobal",xy="remoteDocumentGlobalKey",ec="targets",iT="queryTargetsIndex",$A=["canonicalId","targetId"],tc="targetDocuments",GA=["targetId","path"],mx="documentTargetsIndex",KA=["path","targetId"],Np="targetGlobalKey",wa="targetGlobal",Ju="collectionParents",QA=["collectionId","parent"],nc="clientMetadata",YA="clientId",yf="bundles",XA="bundleId",xf="namedQueries",JA="name",gx="indexConfiguration",ZA="indexId",by="collectionGroupIndex",eP="collectionGroup",Du="indexState",tP=["indexId","uid"],sT="sequenceNumberIndex",nP=["uid","sequenceNumber"],Mu="indexEntries",rP=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],oT="documentKeyIndex",iP=["indexId","uid","orderedDocumentKey"],bf="documentOverlays",sP=["userId","collectionPath","documentId"],vy="collectionPathOverlayIndex",oP=["userId","collectionPath","largestBatchId"],aT="collectionGroupOverlayIndex",aP=["userId","collectionGroup","largestBatchId"],yx="globals",lP="name",lT=[Yu,di,Zl,ua,ec,pd,wa,tc,nc,Xu,Ju,yf,xf],cP=[...lT,bf],cT=[Yu,di,Zl,Fp,ec,pd,wa,tc,nc,Xu,Ju,yf,xf,bf],uT=cT,xx=[...uT,gx,Du,Mu],uP=xx,dT=[...xx,yx],dP=dT;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wy extends Zk{constructor(e,t){super(),this.he=e,this.currentSequenceNumber=t}}function En(n,e){const t=Be(n);return Mi.N(t.he,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cw(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Ro(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function hT(n,e){const t=[];for(const r in n)Object.prototype.hasOwnProperty.call(n,r)&&t.push(e(n[r],r,n));return t}function pT(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $t{constructor(e,t){this.comparator=e,this.root=t||Hn.EMPTY}insert(e,t){return new $t(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Hn.BLACK,null,null))}remove(e){return new $t(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Hn.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return t+r.left.size;s<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){const e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new ep(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new ep(this.root,e,this.comparator,!1)}getReverseIterator(){return new ep(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new ep(this.root,e,this.comparator,!0)}}class ep{constructor(e,t,r,s){this.isReverse=s,this.nodeStack=[];let a=1;for(;!e.isEmpty();)if(a=t?r(e.key,t):1,t&&s&&(a*=-1),a<0)e=this.isReverse?e.left:e.right;else{if(a===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Hn{constructor(e,t,r,s,a){this.key=e,this.value=t,this.color=r??Hn.RED,this.left=s??Hn.EMPTY,this.right=a??Hn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,s,a){return new Hn(e??this.key,t??this.value,r??this.color,s??this.left,a??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let s=this;const a=r(e,s.key);return s=a<0?s.copy(null,null,null,s.left.insert(e,t,r),null):a===0?s.copy(null,t,null,null,null):s.copy(null,null,null,null,s.right.insert(e,t,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return Hn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,s=this;if(t(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,t),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),t(e,s.key)===0){if(s.right.isEmpty())return Hn.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,t))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Hn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Hn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Oe(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Oe(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Oe(27949);return e+(this.isRed()?0:1)}}Hn.EMPTY=null,Hn.RED=!0,Hn.BLACK=!1;Hn.EMPTY=new class{constructor(){this.size=0}get key(){throw Oe(57766)}get value(){throw Oe(16141)}get color(){throw Oe(16727)}get left(){throw Oe(29726)}get right(){throw Oe(36894)}copy(e,t,r,s,a){return this}insert(e,t,r){return new Hn(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pt{constructor(e){this.comparator=e,this.data=new $t(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;t(s.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Rw(this.data.getIterator())}getIteratorFrom(e){return new Rw(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof Pt)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const s=t.getNext().key,a=r.getNext().key;if(this.comparator(s,a)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new Pt(this.comparator);return t.data=e,t}}class Rw{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function El(n){return n.hasNext()?n.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sr{constructor(e){this.fields=e,e.sort(Xt.comparator)}static empty(){return new Sr([])}unionWith(e){let t=new Pt(Xt.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new Sr(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Ql(this.fields,e.fields,(t,r)=>t.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fT extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hP(){return typeof atob<"u"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ln{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(s){try{return atob(s)}catch(a){throw typeof DOMException<"u"&&a instanceof DOMException?new fT("Invalid base64 string: "+a):a}}(e);return new ln(t)}static fromUint8Array(e){const t=function(s){let a="";for(let c=0;c<s.length;++c)a+=String.fromCharCode(s[c]);return a}(e);return new ln(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){const r=new Uint8Array(t.length);for(let s=0;s<t.length;s++)r[s]=t.charCodeAt(s);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return st(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}ln.EMPTY_BYTE_STRING=new ln("");const pP=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function xs(n){if(He(!!n,39018),typeof n=="string"){let e=0;const t=pP.exec(n);if(He(!!t,46558,{timestamp:n}),t[1]){let s=t[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:nn(n.seconds),nanos:nn(n.nanos)}}function nn(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function bs(n){return typeof n=="string"?ln.fromBase64String(n):ln.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mT="server_timestamp",gT="__type__",yT="__previous_value__",xT="__local_write_time__";function vf(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{})[gT])===null||t===void 0?void 0:t.stringValue)===mT}function wf(n){const e=n.mapValue.fields[yT];return vf(e)?wf(e):e}function Zu(n){const e=xs(n.mapValue.fields[xT].timestampValue);return new Lt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fP{constructor(e,t,r,s,a,c,d,h,m,g){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=s,this.ssl=a,this.forceLongPolling=c,this.autoDetectLongPolling=d,this.longPollingOptions=h,this.useFetchStreams=m,this.isUsingEmulator=g}}const ed="(default)";class bo{constructor(e,t){this.projectId=e,this.database=t||ed}static empty(){return new bo("","")}get isDefaultDatabase(){return this.database===ed}isEqual(e){return e instanceof bo&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bx="__type__",bT="__max__",lo={mapValue:{fields:{__type__:{stringValue:bT}}}},vx="__vector__",rc="value",gp={nullValue:"NULL_VALUE"};function vo(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?vf(n)?4:vT(n)?9007199254740991:Sf(n)?10:11:Oe(28295,{value:n})}function Vi(n,e){if(n===e)return!0;const t=vo(n);if(t!==vo(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Zu(n).isEqual(Zu(e));case 3:return function(s,a){if(typeof s.timestampValue=="string"&&typeof a.timestampValue=="string"&&s.timestampValue.length===a.timestampValue.length)return s.timestampValue===a.timestampValue;const c=xs(s.timestampValue),d=xs(a.timestampValue);return c.seconds===d.seconds&&c.nanos===d.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(s,a){return bs(s.bytesValue).isEqual(bs(a.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(s,a){return nn(s.geoPointValue.latitude)===nn(a.geoPointValue.latitude)&&nn(s.geoPointValue.longitude)===nn(a.geoPointValue.longitude)}(n,e);case 2:return function(s,a){if("integerValue"in s&&"integerValue"in a)return nn(s.integerValue)===nn(a.integerValue);if("doubleValue"in s&&"doubleValue"in a){const c=nn(s.doubleValue),d=nn(a.doubleValue);return c===d?Qu(c)===Qu(d):isNaN(c)&&isNaN(d)}return!1}(n,e);case 9:return Ql(n.arrayValue.values||[],e.arrayValue.values||[],Vi);case 10:case 11:return function(s,a){const c=s.mapValue.fields||{},d=a.mapValue.fields||{};if(Cw(c)!==Cw(d))return!1;for(const h in c)if(c.hasOwnProperty(h)&&(d[h]===void 0||!Vi(c[h],d[h])))return!1;return!0}(n,e);default:return Oe(52216,{left:n})}}function td(n,e){return(n.values||[]).find(t=>Vi(t,e))!==void 0}function wo(n,e){if(n===e)return 0;const t=vo(n),r=vo(e);if(t!==r)return st(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return st(n.booleanValue,e.booleanValue);case 2:return function(a,c){const d=nn(a.integerValue||a.doubleValue),h=nn(c.integerValue||c.doubleValue);return d<h?-1:d>h?1:d===h?0:isNaN(d)?isNaN(h)?0:-1:1}(n,e);case 3:return Aw(n.timestampValue,e.timestampValue);case 4:return Aw(Zu(n),Zu(e));case 5:return my(n.stringValue,e.stringValue);case 6:return function(a,c){const d=bs(a),h=bs(c);return d.compareTo(h)}(n.bytesValue,e.bytesValue);case 7:return function(a,c){const d=a.split("/"),h=c.split("/");for(let m=0;m<d.length&&m<h.length;m++){const g=st(d[m],h[m]);if(g!==0)return g}return st(d.length,h.length)}(n.referenceValue,e.referenceValue);case 8:return function(a,c){const d=st(nn(a.latitude),nn(c.latitude));return d!==0?d:st(nn(a.longitude),nn(c.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return Pw(n.arrayValue,e.arrayValue);case 10:return function(a,c){var d,h,m,g;const x=a.fields||{},S=c.fields||{},I=(d=x[rc])===null||d===void 0?void 0:d.arrayValue,_=(h=S[rc])===null||h===void 0?void 0:h.arrayValue,R=st(((m=I==null?void 0:I.values)===null||m===void 0?void 0:m.length)||0,((g=_==null?void 0:_.values)===null||g===void 0?void 0:g.length)||0);return R!==0?R:Pw(I,_)}(n.mapValue,e.mapValue);case 11:return function(a,c){if(a===lo.mapValue&&c===lo.mapValue)return 0;if(a===lo.mapValue)return 1;if(c===lo.mapValue)return-1;const d=a.fields||{},h=Object.keys(d),m=c.fields||{},g=Object.keys(m);h.sort(),g.sort();for(let x=0;x<h.length&&x<g.length;++x){const S=my(h[x],g[x]);if(S!==0)return S;const I=wo(d[h[x]],m[g[x]]);if(I!==0)return I}return st(h.length,g.length)}(n.mapValue,e.mapValue);default:throw Oe(23264,{Pe:t})}}function Aw(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return st(n,e);const t=xs(n),r=xs(e),s=st(t.seconds,r.seconds);return s!==0?s:st(t.nanos,r.nanos)}function Pw(n,e){const t=n.values||[],r=e.values||[];for(let s=0;s<t.length&&s<r.length;++s){const a=wo(t[s],r[s]);if(a)return a}return st(t.length,r.length)}function ic(n){return Sy(n)}function Sy(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){const r=xs(t);return`time(${r.seconds},${r.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return bs(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return Fe.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let r="[",s=!0;for(const a of t.values||[])s?s=!1:r+=",",r+=Sy(a);return r+"]"}(n.arrayValue):"mapValue"in n?function(t){const r=Object.keys(t.fields||{}).sort();let s="{",a=!0;for(const c of r)a?a=!1:s+=",",s+=`${c}:${Sy(t.fields[c])}`;return s+"}"}(n.mapValue):Oe(61005,{value:n})}function yp(n){switch(vo(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=wf(n);return e?16+yp(e):16;case 5:return 2*n.stringValue.length;case 6:return bs(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((s,a)=>s+yp(a),0)}(n.arrayValue);case 10:case 11:return function(r){let s=0;return Ro(r.fields,(a,c)=>{s+=a.length+yp(c)}),s}(n.mapValue);default:throw Oe(13486,{value:n})}}function ja(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function ky(n){return!!n&&"integerValue"in n}function nd(n){return!!n&&"arrayValue"in n}function Bw(n){return!!n&&"nullValue"in n}function Fw(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function xp(n){return!!n&&"mapValue"in n}function Sf(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{})[bx])===null||t===void 0?void 0:t.stringValue)===vx}function Lu(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return Ro(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=Lu(r)),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Lu(n.arrayValue.values[t]);return e}return Object.assign({},n)}function vT(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===bT}const wT={mapValue:{fields:{[bx]:{stringValue:vx},[rc]:{arrayValue:{}}}}};function mP(n){return"nullValue"in n?gp:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?ja(bo.empty(),Fe.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?Sf(n)?wT:{mapValue:{}}:Oe(35942,{value:n})}function gP(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?ja(bo.empty(),Fe.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?wT:"mapValue"in n?Sf(n)?{mapValue:{}}:lo:Oe(61959,{value:n})}function Nw(n,e){const t=wo(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function zw(n,e){const t=wo(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $n{constructor(e){this.value=e}static empty(){return new $n({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!xp(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Lu(t)}setAll(e){let t=Xt.emptyPath(),r={},s=[];e.forEach((c,d)=>{if(!t.isImmediateParentOf(d)){const h=this.getFieldsMap(t);this.applyChanges(h,r,s),r={},s=[],t=d.popLast()}c?r[d.lastSegment()]=Lu(c):s.push(d.lastSegment())});const a=this.getFieldsMap(t);this.applyChanges(a,r,s)}delete(e){const t=this.field(e.popLast());xp(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Vi(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=t.mapValue.fields[e.get(r)];xp(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=s),t=s}return t.mapValue.fields}applyChanges(e,t,r){Ro(t,(s,a)=>e[s]=a);for(const s of r)delete e[s]}clone(){return new $n(Lu(this.value))}}function ST(n){const e=[];return Ro(n.fields,(t,r)=>{const s=new Xt([t]);if(xp(r)){const a=ST(r.mapValue).fields;if(a.length===0)e.push(s);else for(const c of a)e.push(s.child(c))}else e.push(s)}),new Sr(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yt{constructor(e,t,r,s,a,c,d){this.key=e,this.documentType=t,this.version=r,this.readTime=s,this.createTime=a,this.data=c,this.documentState=d}static newInvalidDocument(e){return new Yt(e,0,Xe.min(),Xe.min(),Xe.min(),$n.empty(),0)}static newFoundDocument(e,t,r,s){return new Yt(e,1,t,Xe.min(),r,s,0)}static newNoDocument(e,t){return new Yt(e,2,t,Xe.min(),Xe.min(),$n.empty(),0)}static newUnknownDocument(e,t){return new Yt(e,3,t,Xe.min(),Xe.min(),$n.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Xe.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=$n.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=$n.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Xe.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Yt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Yt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class So{constructor(e,t){this.position=e,this.inclusive=t}}function Dw(n,e,t){let r=0;for(let s=0;s<n.position.length;s++){const a=e[s],c=n.position[s];if(a.field.isKeyField()?r=Fe.comparator(Fe.fromName(c.referenceValue),t.key):r=wo(c,t.data.field(a.field)),a.dir==="desc"&&(r*=-1),r!==0)break}return r}function Mw(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Vi(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rd{constructor(e,t="asc"){this.field=e,this.dir=t}}function yP(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kT{}class bt extends kT{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new xP(e,t,r):t==="array-contains"?new wP(e,r):t==="in"?new CT(e,r):t==="not-in"?new SP(e,r):t==="array-contains-any"?new kP(e,r):new bt(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new bP(e,r):new vP(e,r)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(wo(t,this.value)):t!==null&&vo(this.value)===vo(t)&&this.matchesComparison(wo(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Oe(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class At extends kT{constructor(e,t){super(),this.filters=e,this.op=t,this.Te=null}static create(e,t){return new At(e,t)}matches(e){return sc(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.Te!==null||(this.Te=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.Te}getFilters(){return Object.assign([],this.filters)}}function sc(n){return n.op==="and"}function Ty(n){return n.op==="or"}function wx(n){return TT(n)&&sc(n)}function TT(n){for(const e of n.filters)if(e instanceof At)return!1;return!0}function _y(n){if(n instanceof bt)return n.field.canonicalString()+n.op.toString()+ic(n.value);if(wx(n))return n.filters.map(e=>_y(e)).join(",");{const e=n.filters.map(t=>_y(t)).join(",");return`${n.op}(${e})`}}function _T(n,e){return n instanceof bt?function(r,s){return s instanceof bt&&r.op===s.op&&r.field.isEqual(s.field)&&Vi(r.value,s.value)}(n,e):n instanceof At?function(r,s){return s instanceof At&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce((a,c,d)=>a&&_T(c,s.filters[d]),!0):!1}(n,e):void Oe(19439)}function jT(n,e){const t=n.filters.concat(e);return At.create(t,n.op)}function IT(n){return n instanceof bt?function(t){return`${t.field.canonicalString()} ${t.op} ${ic(t.value)}`}(n):n instanceof At?function(t){return t.op.toString()+" {"+t.getFilters().map(IT).join(" ,")+"}"}(n):"Filter"}class xP extends bt{constructor(e,t,r){super(e,t,r),this.key=Fe.fromName(r.referenceValue)}matches(e){const t=Fe.comparator(e.key,this.key);return this.matchesComparison(t)}}class bP extends bt{constructor(e,t){super(e,"in",t),this.keys=ET("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class vP extends bt{constructor(e,t){super(e,"not-in",t),this.keys=ET("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function ET(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(r=>Fe.fromName(r.referenceValue))}class wP extends bt{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return nd(t)&&td(t.arrayValue,this.value)}}class CT extends bt{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&td(this.value.arrayValue,t)}}class SP extends bt{constructor(e,t){super(e,"not-in",t)}matches(e){if(td(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!td(this.value.arrayValue,t)}}class kP extends bt{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!nd(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>td(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TP{constructor(e,t=null,r=[],s=[],a=null,c=null,d=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=s,this.limit=a,this.startAt=c,this.endAt=d,this.Ie=null}}function jy(n,e=null,t=[],r=[],s=null,a=null,c=null){return new TP(n,e,t,r,s,a,c)}function Ia(n){const e=Be(n);if(e.Ie===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>_y(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>function(a){return a.field.canonicalString()+a.dir}(r)).join(","),hd(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>ic(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>ic(r)).join(",")),e.Ie=t}return e.Ie}function fd(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!yP(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!_T(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!Mw(n.startAt,e.startAt)&&Mw(n.endAt,e.endAt)}function zp(n){return Fe.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function Dp(n,e){return n.filters.filter(t=>t instanceof bt&&t.field.isEqual(e))}function Lw(n,e,t){let r=gp,s=!0;for(const a of Dp(n,e)){let c=gp,d=!0;switch(a.op){case"<":case"<=":c=mP(a.value);break;case"==":case"in":case">=":c=a.value;break;case">":c=a.value,d=!1;break;case"!=":case"not-in":c=gp}Nw({value:r,inclusive:s},{value:c,inclusive:d})<0&&(r=c,s=d)}if(t!==null){for(let a=0;a<n.orderBy.length;++a)if(n.orderBy[a].field.isEqual(e)){const c=t.position[a];Nw({value:r,inclusive:s},{value:c,inclusive:t.inclusive})<0&&(r=c,s=t.inclusive);break}}return{value:r,inclusive:s}}function Ow(n,e,t){let r=lo,s=!0;for(const a of Dp(n,e)){let c=lo,d=!0;switch(a.op){case">=":case">":c=gP(a.value),d=!1;break;case"==":case"in":case"<=":c=a.value;break;case"<":c=a.value,d=!1;break;case"!=":case"not-in":c=lo}zw({value:r,inclusive:s},{value:c,inclusive:d})>0&&(r=c,s=d)}if(t!==null){for(let a=0;a<n.orderBy.length;++a)if(n.orderBy[a].field.isEqual(e)){const c=t.position[a];zw({value:r,inclusive:s},{value:c,inclusive:t.inclusive})>0&&(r=c,s=t.inclusive);break}}return{value:r,inclusive:s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ss{constructor(e,t=null,r=[],s=[],a=null,c="F",d=null,h=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=s,this.limit=a,this.limitType=c,this.startAt=d,this.endAt=h,this.Ee=null,this.de=null,this.Ae=null,this.startAt,this.endAt}}function RT(n,e,t,r,s,a,c,d){return new Ss(n,e,t,r,s,a,c,d)}function Sc(n){return new Ss(n)}function Vw(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function Sx(n){return n.collectionGroup!==null}function Ul(n){const e=Be(n);if(e.Ee===null){e.Ee=[];const t=new Set;for(const a of e.explicitOrderBy)e.Ee.push(a),t.add(a.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(c){let d=new Pt(Xt.comparator);return c.filters.forEach(h=>{h.getFlattenedFilters().forEach(m=>{m.isInequality()&&(d=d.add(m.field))})}),d})(e).forEach(a=>{t.has(a.canonicalString())||a.isKeyField()||e.Ee.push(new rd(a,r))}),t.has(Xt.keyField().canonicalString())||e.Ee.push(new rd(Xt.keyField(),r))}return e.Ee}function nr(n){const e=Be(n);return e.de||(e.de=PT(e,Ul(n))),e.de}function AT(n){const e=Be(n);return e.Ae||(e.Ae=PT(e,n.explicitOrderBy)),e.Ae}function PT(n,e){if(n.limitType==="F")return jy(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(s=>{const a=s.dir==="desc"?"asc":"desc";return new rd(s.field,a)});const t=n.endAt?new So(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new So(n.startAt.position,n.startAt.inclusive):null;return jy(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function Iy(n,e){const t=n.filters.concat([e]);return new Ss(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function Mp(n,e,t){return new Ss(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function md(n,e){return fd(nr(n),nr(e))&&n.limitType===e.limitType}function BT(n){return`${Ia(nr(n))}|lt:${n.limitType}`}function Ll(n){return`Query(target=${function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(s=>IT(s)).join(", ")}]`),hd(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(s=>function(c){return`${c.field.canonicalString()} (${c.dir})`}(s)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(s=>ic(s)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(s=>ic(s)).join(",")),`Target(${r})`}(nr(n))}; limitType=${n.limitType})`}function gd(n,e){return e.isFoundDocument()&&function(r,s){const a=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(a):Fe.isDocumentKey(r.path)?r.path.isEqual(a):r.path.isImmediateParentOf(a)}(n,e)&&function(r,s){for(const a of Ul(r))if(!a.field.isKeyField()&&s.data.field(a.field)===null)return!1;return!0}(n,e)&&function(r,s){for(const a of r.filters)if(!a.matches(s))return!1;return!0}(n,e)&&function(r,s){return!(r.startAt&&!function(c,d,h){const m=Dw(c,d,h);return c.inclusive?m<=0:m<0}(r.startAt,Ul(r),s)||r.endAt&&!function(c,d,h){const m=Dw(c,d,h);return c.inclusive?m>=0:m>0}(r.endAt,Ul(r),s))}(n,e)}function FT(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function NT(n){return(e,t)=>{let r=!1;for(const s of Ul(n)){const a=_P(s,e,t);if(a!==0)return a;r=r||s.field.isKeyField()}return 0}}function _P(n,e,t){const r=n.field.isKeyField()?Fe.comparator(e.key,t.key):function(a,c,d){const h=c.data.field(a),m=d.data.field(a);return h!==null&&m!==null?wo(h,m):Oe(42886)}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return Oe(19790,{direction:n.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ks{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(const[s,a]of r)if(this.equalsFn(s,e))return a}}has(e){return this.get(e)!==void 0}set(e,t){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let a=0;a<s.length;a++)if(this.equalsFn(s[a][0],e))return void(s[a]=[e,t]);s.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[t]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){Ro(this.inner,(t,r)=>{for(const[s,a]of r)e(s,a)})}isEmpty(){return pT(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jP=new $t(Fe.comparator);function kr(){return jP}const zT=new $t(Fe.comparator);function Ru(...n){let e=zT;for(const t of n)e=e.insert(t.key,t);return e}function DT(n){let e=zT;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function Ni(){return Ou()}function MT(){return Ou()}function Ou(){return new ks(n=>n.toString(),(n,e)=>n.isEqual(e))}const IP=new $t(Fe.comparator),EP=new Pt(Fe.comparator);function dt(...n){let e=EP;for(const t of n)e=e.add(t);return e}const CP=new Pt(st);function kx(){return CP}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tx(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Qu(e)?"-0":e}}function LT(n){return{integerValue:""+n}}function OT(n,e){return tT(e)?LT(e):Tx(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kf{constructor(){this._=void 0}}function RP(n,e,t){return n instanceof oc?function(s,a){const c={fields:{[gT]:{stringValue:mT},[xT]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return a&&vf(a)&&(a=wf(a)),a&&(c.fields[yT]=a),{mapValue:c}}(t,e):n instanceof Ea?WT(n,e):n instanceof Ca?UT(n,e):function(s,a){const c=VT(s,a),d=Ww(c)+Ww(s.Re);return ky(c)&&ky(s.Re)?LT(d):Tx(s.serializer,d)}(n,e)}function AP(n,e,t){return n instanceof Ea?WT(n,e):n instanceof Ca?UT(n,e):t}function VT(n,e){return n instanceof ac?function(r){return ky(r)||function(a){return!!a&&"doubleValue"in a}(r)}(e)?e:{integerValue:0}:null}class oc extends kf{}class Ea extends kf{constructor(e){super(),this.elements=e}}function WT(n,e){const t=qT(e);for(const r of n.elements)t.some(s=>Vi(s,r))||t.push(r);return{arrayValue:{values:t}}}class Ca extends kf{constructor(e){super(),this.elements=e}}function UT(n,e){let t=qT(e);for(const r of n.elements)t=t.filter(s=>!Vi(s,r));return{arrayValue:{values:t}}}class ac extends kf{constructor(e,t){super(),this.serializer=e,this.Re=t}}function Ww(n){return nn(n.integerValue||n.doubleValue)}function qT(n){return nd(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yd{constructor(e,t){this.field=e,this.transform=t}}function PP(n,e){return n.field.isEqual(e.field)&&function(r,s){return r instanceof Ea&&s instanceof Ea||r instanceof Ca&&s instanceof Ca?Ql(r.elements,s.elements,Vi):r instanceof ac&&s instanceof ac?Vi(r.Re,s.Re):r instanceof oc&&s instanceof oc}(n.transform,e.transform)}class BP{constructor(e,t){this.version=e,this.transformResults=t}}class rn{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new rn}static exists(e){return new rn(void 0,e)}static updateTime(e){return new rn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function bp(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class Tf{}function HT(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Tc(n.key,rn.none()):new kc(n.key,n.data,rn.none());{const t=n.data,r=$n.empty();let s=new Pt(Xt.comparator);for(let a of e.fields)if(!s.has(a)){let c=t.field(a);c===null&&a.length>1&&(a=a.popLast(),c=t.field(a)),c===null?r.delete(a):r.set(a,c),s=s.add(a)}return new Ts(n.key,r,new Sr(s.toArray()),rn.none())}}function FP(n,e,t){n instanceof kc?function(s,a,c){const d=s.value.clone(),h=qw(s.fieldTransforms,a,c.transformResults);d.setAll(h),a.convertToFoundDocument(c.version,d).setHasCommittedMutations()}(n,e,t):n instanceof Ts?function(s,a,c){if(!bp(s.precondition,a))return void a.convertToUnknownDocument(c.version);const d=qw(s.fieldTransforms,a,c.transformResults),h=a.data;h.setAll($T(s)),h.setAll(d),a.convertToFoundDocument(c.version,h).setHasCommittedMutations()}(n,e,t):function(s,a,c){a.convertToNoDocument(c.version).setHasCommittedMutations()}(0,e,t)}function Vu(n,e,t,r){return n instanceof kc?function(a,c,d,h){if(!bp(a.precondition,c))return d;const m=a.value.clone(),g=Hw(a.fieldTransforms,h,c);return m.setAll(g),c.convertToFoundDocument(c.version,m).setHasLocalMutations(),null}(n,e,t,r):n instanceof Ts?function(a,c,d,h){if(!bp(a.precondition,c))return d;const m=Hw(a.fieldTransforms,h,c),g=c.data;return g.setAll($T(a)),g.setAll(m),c.convertToFoundDocument(c.version,g).setHasLocalMutations(),d===null?null:d.unionWith(a.fieldMask.fields).unionWith(a.fieldTransforms.map(x=>x.field))}(n,e,t,r):function(a,c,d){return bp(a.precondition,c)?(c.convertToNoDocument(c.version).setHasLocalMutations(),null):d}(n,e,t)}function NP(n,e){let t=null;for(const r of n.fieldTransforms){const s=e.data.field(r.field),a=VT(r.transform,s||null);a!=null&&(t===null&&(t=$n.empty()),t.set(r.field,a))}return t||null}function Uw(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&Ql(r,s,(a,c)=>PP(a,c))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class kc extends Tf{constructor(e,t,r,s=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class Ts extends Tf{constructor(e,t,r,s,a=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=s,this.fieldTransforms=a,this.type=1}getFieldMask(){return this.fieldMask}}function $T(n){const e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}}),e}function qw(n,e,t){const r=new Map;He(n.length===t.length,32656,{Ve:t.length,me:n.length});for(let s=0;s<t.length;s++){const a=n[s],c=a.transform,d=e.data.field(a.field);r.set(a.field,AP(c,d,t[s]))}return r}function Hw(n,e,t){const r=new Map;for(const s of n){const a=s.transform,c=t.data.field(s.field);r.set(s.field,RP(a,c,e))}return r}class Tc extends Tf{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class _x extends Tf{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jx{constructor(e,t,r,s){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let s=0;s<this.mutations.length;s++){const a=this.mutations[s];a.key.isEqual(e.key)&&FP(a,e,r[s])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=Vu(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=Vu(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=MT();return this.mutations.forEach(s=>{const a=e.get(s.key),c=a.overlayedDocument;let d=this.applyToLocalView(c,a.mutatedFields);d=t.has(s.key)?null:d;const h=HT(c,d);h!==null&&r.set(s.key,h),c.isValidDocument()||c.convertToNoDocument(Xe.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),dt())}isEqual(e){return this.batchId===e.batchId&&Ql(this.mutations,e.mutations,(t,r)=>Uw(t,r))&&Ql(this.baseMutations,e.baseMutations,(t,r)=>Uw(t,r))}}class Ix{constructor(e,t,r,s){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=s}static from(e,t,r){He(e.mutations.length===r.length,58842,{fe:e.mutations.length,ge:r.length});let s=function(){return IP}();const a=e.mutations;for(let c=0;c<a.length;c++)s=s.insert(a[c].key,r[c].version);return new Ix(e,t,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ex{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GT{constructor(e,t,r){this.alias=e,this.aggregateType=t,this.fieldPath=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zP{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var xn,kt;function KT(n){switch(n){case me.OK:return Oe(64938);case me.CANCELLED:case me.UNKNOWN:case me.DEADLINE_EXCEEDED:case me.RESOURCE_EXHAUSTED:case me.INTERNAL:case me.UNAVAILABLE:case me.UNAUTHENTICATED:return!1;case me.INVALID_ARGUMENT:case me.NOT_FOUND:case me.ALREADY_EXISTS:case me.PERMISSION_DENIED:case me.FAILED_PRECONDITION:case me.ABORTED:case me.OUT_OF_RANGE:case me.UNIMPLEMENTED:case me.DATA_LOSS:return!0;default:return Oe(15467,{code:n})}}function QT(n){if(n===void 0)return pn("GRPC error has no .code"),me.UNKNOWN;switch(n){case xn.OK:return me.OK;case xn.CANCELLED:return me.CANCELLED;case xn.UNKNOWN:return me.UNKNOWN;case xn.DEADLINE_EXCEEDED:return me.DEADLINE_EXCEEDED;case xn.RESOURCE_EXHAUSTED:return me.RESOURCE_EXHAUSTED;case xn.INTERNAL:return me.INTERNAL;case xn.UNAVAILABLE:return me.UNAVAILABLE;case xn.UNAUTHENTICATED:return me.UNAUTHENTICATED;case xn.INVALID_ARGUMENT:return me.INVALID_ARGUMENT;case xn.NOT_FOUND:return me.NOT_FOUND;case xn.ALREADY_EXISTS:return me.ALREADY_EXISTS;case xn.PERMISSION_DENIED:return me.PERMISSION_DENIED;case xn.FAILED_PRECONDITION:return me.FAILED_PRECONDITION;case xn.ABORTED:return me.ABORTED;case xn.OUT_OF_RANGE:return me.OUT_OF_RANGE;case xn.UNIMPLEMENTED:return me.UNIMPLEMENTED;case xn.DATA_LOSS:return me.DATA_LOSS;default:return Oe(39323,{code:n})}}(kt=xn||(xn={}))[kt.OK=0]="OK",kt[kt.CANCELLED=1]="CANCELLED",kt[kt.UNKNOWN=2]="UNKNOWN",kt[kt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",kt[kt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",kt[kt.NOT_FOUND=5]="NOT_FOUND",kt[kt.ALREADY_EXISTS=6]="ALREADY_EXISTS",kt[kt.PERMISSION_DENIED=7]="PERMISSION_DENIED",kt[kt.UNAUTHENTICATED=16]="UNAUTHENTICATED",kt[kt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",kt[kt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",kt[kt.ABORTED=10]="ABORTED",kt[kt.OUT_OF_RANGE=11]="OUT_OF_RANGE",kt[kt.UNIMPLEMENTED=12]="UNIMPLEMENTED",kt[kt.INTERNAL=13]="INTERNAL",kt[kt.UNAVAILABLE=14]="UNAVAILABLE",kt[kt.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Lp=null;/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DP=new fo([4294967295,4294967295],0);function $w(n){const e=dx().encode(n),t=new Ok;return t.update(e),new Uint8Array(t.digest())}function Gw(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),a=e.getUint32(12,!0);return[new fo([t,r],0),new fo([s,a],0)]}class Cx{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new Au(`Invalid padding: ${t}`);if(r<0)throw new Au(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Au(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new Au(`Invalid padding when bitmap length is 0: ${t}`);this.pe=8*e.length-t,this.ye=fo.fromNumber(this.pe)}we(e,t,r){let s=e.add(t.multiply(fo.fromNumber(r)));return s.compare(DP)===1&&(s=new fo([s.getBits(0),s.getBits(1)],0)),s.modulo(this.ye).toNumber()}be(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.pe===0)return!1;const t=$w(e),[r,s]=Gw(t);for(let a=0;a<this.hashCount;a++){const c=this.we(r,s,a);if(!this.be(c))return!1}return!0}static create(e,t,r){const s=e%8==0?0:8-e%8,a=new Uint8Array(Math.ceil(e/8)),c=new Cx(a,s,t);return r.forEach(d=>c.insert(d)),c}insert(e){if(this.pe===0)return;const t=$w(e),[r,s]=Gw(t);for(let a=0;a<this.hashCount;a++){const c=this.we(r,s,a);this.Se(c)}}Se(e){const t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}}class Au extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xd{constructor(e,t,r,s,a){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=a}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const s=new Map;return s.set(e,bd.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new xd(Xe.min(),s,new $t(st),kr(),dt())}}class bd{constructor(e,t,r,s,a){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=a}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new bd(r,t,dt(),dt(),dt())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vp{constructor(e,t,r,s){this.De=e,this.removedTargetIds=t,this.key=r,this.ve=s}}class YT{constructor(e,t){this.targetId=e,this.Ce=t}}class XT{constructor(e,t,r=ln.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=s}}class Kw{constructor(){this.Fe=0,this.Me=Qw(),this.xe=ln.EMPTY_BYTE_STRING,this.Oe=!1,this.Ne=!0}get current(){return this.Oe}get resumeToken(){return this.xe}get Be(){return this.Fe!==0}get Le(){return this.Ne}ke(e){e.approximateByteSize()>0&&(this.Ne=!0,this.xe=e)}qe(){let e=dt(),t=dt(),r=dt();return this.Me.forEach((s,a)=>{switch(a){case 0:e=e.add(s);break;case 2:t=t.add(s);break;case 1:r=r.add(s);break;default:Oe(38017,{changeType:a})}}),new bd(this.xe,this.Oe,e,t,r)}Qe(){this.Ne=!1,this.Me=Qw()}$e(e,t){this.Ne=!0,this.Me=this.Me.insert(e,t)}Ue(e){this.Ne=!0,this.Me=this.Me.remove(e)}Ke(){this.Fe+=1}We(){this.Fe-=1,He(this.Fe>=0,3241,{Fe:this.Fe})}Ge(){this.Ne=!0,this.Oe=!0}}class MP{constructor(e){this.ze=e,this.je=new Map,this.He=kr(),this.Je=tp(),this.Ye=tp(),this.Ze=new $t(st)}Xe(e){for(const t of e.De)e.ve&&e.ve.isFoundDocument()?this.et(t,e.ve):this.tt(t,e.key,e.ve);for(const t of e.removedTargetIds)this.tt(t,e.key,e.ve)}nt(e){this.forEachTarget(e,t=>{const r=this.rt(t);switch(e.state){case 0:this.it(t)&&r.ke(e.resumeToken);break;case 1:r.We(),r.Be||r.Qe(),r.ke(e.resumeToken);break;case 2:r.We(),r.Be||this.removeTarget(t);break;case 3:this.it(t)&&(r.Ge(),r.ke(e.resumeToken));break;case 4:this.it(t)&&(this.st(t),r.ke(e.resumeToken));break;default:Oe(56790,{state:e.state})}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.je.forEach((r,s)=>{this.it(s)&&t(s)})}ot(e){const t=e.targetId,r=e.Ce.count,s=this._t(t);if(s){const a=s.target;if(zp(a))if(r===0){const c=new Fe(a.path);this.tt(t,c,Yt.newNoDocument(c,Xe.min()))}else He(r===1,20013,{expectedCount:r});else{const c=this.ut(t);if(c!==r){const d=this.ct(e),h=d?this.lt(d,e,c):1;if(h!==0){this.st(t);const m=h===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(t,m)}Lp==null||Lp.ht(function(g,x,S,I,_){var R,T,A,D,F,X;const ie={localCacheCount:g,existenceFilterCount:x.count,databaseId:S.database,projectId:S.projectId},G=x.unchangedNames;return G&&(ie.bloomFilter={applied:_===0,hashCount:(R=G==null?void 0:G.hashCount)!==null&&R!==void 0?R:0,bitmapLength:(D=(A=(T=G==null?void 0:G.bits)===null||T===void 0?void 0:T.bitmap)===null||A===void 0?void 0:A.length)!==null&&D!==void 0?D:0,padding:(X=(F=G==null?void 0:G.bits)===null||F===void 0?void 0:F.padding)!==null&&X!==void 0?X:0,mightContain:N=>{var E;return(E=I==null?void 0:I.mightContain(N))!==null&&E!==void 0&&E}}),ie}(c,e.Ce,this.ze.Pt(),d,h))}}}}ct(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:a=0}=t;let c,d;try{c=bs(r).toUint8Array()}catch(h){if(h instanceof fT)return Lr("Decoding the base64 bloom filter in existence filter failed ("+h.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw h}try{d=new Cx(c,s,a)}catch(h){return Lr(h instanceof Au?"BloomFilter error: ":"Applying bloom filter failed: ",h),null}return d.pe===0?null:d}lt(e,t,r){return t.Ce.count===r-this.Tt(e,t.targetId)?0:2}Tt(e,t){const r=this.ze.getRemoteKeysForTarget(t);let s=0;return r.forEach(a=>{const c=this.ze.Pt(),d=`projects/${c.projectId}/databases/${c.database}/documents/${a.path.canonicalString()}`;e.mightContain(d)||(this.tt(t,a,null),s++)}),s}It(e){const t=new Map;this.je.forEach((a,c)=>{const d=this._t(c);if(d){if(a.current&&zp(d.target)){const h=new Fe(d.target.path);this.Et(h).has(c)||this.dt(c,h)||this.tt(c,h,Yt.newNoDocument(h,e))}a.Le&&(t.set(c,a.qe()),a.Qe())}});let r=dt();this.Ye.forEach((a,c)=>{let d=!0;c.forEachWhile(h=>{const m=this._t(h);return!m||m.purpose==="TargetPurposeLimboResolution"||(d=!1,!1)}),d&&(r=r.add(a))}),this.He.forEach((a,c)=>c.setReadTime(e));const s=new xd(e,t,this.Ze,this.He,r);return this.He=kr(),this.Je=tp(),this.Ye=tp(),this.Ze=new $t(st),s}et(e,t){if(!this.it(e))return;const r=this.dt(e,t.key)?2:0;this.rt(e).$e(t.key,r),this.He=this.He.insert(t.key,t),this.Je=this.Je.insert(t.key,this.Et(t.key).add(e)),this.Ye=this.Ye.insert(t.key,this.At(t.key).add(e))}tt(e,t,r){if(!this.it(e))return;const s=this.rt(e);this.dt(e,t)?s.$e(t,1):s.Ue(t),this.Ye=this.Ye.insert(t,this.At(t).delete(e)),this.Ye=this.Ye.insert(t,this.At(t).add(e)),r&&(this.He=this.He.insert(t,r))}removeTarget(e){this.je.delete(e)}ut(e){const t=this.rt(e).qe();return this.ze.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ke(e){this.rt(e).Ke()}rt(e){let t=this.je.get(e);return t||(t=new Kw,this.je.set(e,t)),t}At(e){let t=this.Ye.get(e);return t||(t=new Pt(st),this.Ye=this.Ye.insert(e,t)),t}Et(e){let t=this.Je.get(e);return t||(t=new Pt(st),this.Je=this.Je.insert(e,t)),t}it(e){const t=this._t(e)!==null;return t||Te("WatchChangeAggregator","Detected inactive target",e),t}_t(e){const t=this.je.get(e);return t&&t.Be?null:this.ze.Rt(e)}st(e){this.je.set(e,new Kw),this.ze.getRemoteKeysForTarget(e).forEach(t=>{this.tt(e,t,null)})}dt(e,t){return this.ze.getRemoteKeysForTarget(e).has(t)}}function tp(){return new $t(Fe.comparator)}function Qw(){return new $t(Fe.comparator)}const LP={asc:"ASCENDING",desc:"DESCENDING"},OP={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},VP={and:"AND",or:"OR"};class WP{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Ey(n,e){return n.useProto3Json||hd(e)?e:{value:e}}function lc(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function JT(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function UP(n,e){return lc(n,e.toTimestamp())}function fn(n){return He(!!n,49232),Xe.fromTimestamp(function(t){const r=xs(t);return new Lt(r.seconds,r.nanos)}(n))}function Rx(n,e){return Cy(n,e).canonicalString()}function Cy(n,e){const t=function(s){return new xt(["projects",s.projectId,"databases",s.database])}(n).child("documents");return e===void 0?t:t.child(e)}function ZT(n){const e=xt.fromString(n);return He(c_(e),10190,{key:e.toString()}),e}function id(n,e){return Rx(n.databaseId,e.path)}function Li(n,e){const t=ZT(e);if(t.get(1)!==n.databaseId.projectId)throw new ke(me.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new ke(me.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new Fe(n_(t))}function e_(n,e){return Rx(n.databaseId,e)}function t_(n){const e=ZT(n);return e.length===4?xt.emptyPath():n_(e)}function Ry(n){return new xt(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function n_(n){return He(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function Yw(n,e,t){return{name:id(n,e),fields:t.value.mapValue.fields}}function r_(n,e,t){const r=Li(n,e.name),s=fn(e.updateTime),a=e.createTime?fn(e.createTime):Xe.min(),c=new $n({mapValue:{fields:e.fields}}),d=Yt.newFoundDocument(r,s,a,c);return t&&d.setHasCommittedMutations(),t?d.setHasCommittedMutations():d}function qP(n,e){return"found"in e?function(r,s){He(!!s.found,43571),s.found.name,s.found.updateTime;const a=Li(r,s.found.name),c=fn(s.found.updateTime),d=s.found.createTime?fn(s.found.createTime):Xe.min(),h=new $n({mapValue:{fields:s.found.fields}});return Yt.newFoundDocument(a,c,d,h)}(n,e):"missing"in e?function(r,s){He(!!s.missing,3894),He(!!s.readTime,22933);const a=Li(r,s.missing),c=fn(s.readTime);return Yt.newNoDocument(a,c)}(n,e):Oe(7234,{result:e})}function HP(n,e){let t;if("targetChange"in e){e.targetChange;const r=function(m){return m==="NO_CHANGE"?0:m==="ADD"?1:m==="REMOVE"?2:m==="CURRENT"?3:m==="RESET"?4:Oe(39313,{state:m})}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],a=function(m,g){return m.useProto3Json?(He(g===void 0||typeof g=="string",58123),ln.fromBase64String(g||"")):(He(g===void 0||g instanceof Buffer||g instanceof Uint8Array,16193),ln.fromUint8Array(g||new Uint8Array))}(n,e.targetChange.resumeToken),c=e.targetChange.cause,d=c&&function(m){const g=m.code===void 0?me.UNKNOWN:QT(m.code);return new ke(g,m.message||"")}(c);t=new XT(r,s,a,d||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=Li(n,r.document.name),a=fn(r.document.updateTime),c=r.document.createTime?fn(r.document.createTime):Xe.min(),d=new $n({mapValue:{fields:r.document.fields}}),h=Yt.newFoundDocument(s,a,c,d),m=r.targetIds||[],g=r.removedTargetIds||[];t=new vp(m,g,h.key,h)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=Li(n,r.document),a=r.readTime?fn(r.readTime):Xe.min(),c=Yt.newNoDocument(s,a),d=r.removedTargetIds||[];t=new vp([],d,c.key,c)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=Li(n,r.document),a=r.removedTargetIds||[];t=new vp([],a,s,null)}else{if(!("filter"in e))return Oe(11601,{Vt:e});{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:a}=r,c=new zP(s,a),d=r.targetId;t=new YT(d,c)}}return t}function sd(n,e){let t;if(e instanceof kc)t={update:Yw(n,e.key,e.value)};else if(e instanceof Tc)t={delete:id(n,e.key)};else if(e instanceof Ts)t={update:Yw(n,e.key,e.data),updateMask:XP(e.fieldMask)};else{if(!(e instanceof _x))return Oe(16599,{ft:e.type});t={verify:id(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(a,c){const d=c.transform;if(d instanceof oc)return{fieldPath:c.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(d instanceof Ea)return{fieldPath:c.field.canonicalString(),appendMissingElements:{values:d.elements}};if(d instanceof Ca)return{fieldPath:c.field.canonicalString(),removeAllFromArray:{values:d.elements}};if(d instanceof ac)return{fieldPath:c.field.canonicalString(),increment:d.Re};throw Oe(20930,{transform:c.transform})}(0,r))),e.precondition.isNone||(t.currentDocument=function(s,a){return a.updateTime!==void 0?{updateTime:UP(s,a.updateTime)}:a.exists!==void 0?{exists:a.exists}:Oe(27497)}(n,e.precondition)),t}function Ay(n,e){const t=e.currentDocument?function(a){return a.updateTime!==void 0?rn.updateTime(fn(a.updateTime)):a.exists!==void 0?rn.exists(a.exists):rn.none()}(e.currentDocument):rn.none(),r=e.updateTransforms?e.updateTransforms.map(s=>function(c,d){let h=null;if("setToServerValue"in d)He(d.setToServerValue==="REQUEST_TIME",16630,{proto:d}),h=new oc;else if("appendMissingElements"in d){const g=d.appendMissingElements.values||[];h=new Ea(g)}else if("removeAllFromArray"in d){const g=d.removeAllFromArray.values||[];h=new Ca(g)}else"increment"in d?h=new ac(c,d.increment):Oe(16584,{proto:d});const m=Xt.fromServerFormat(d.fieldPath);return new yd(m,h)}(n,s)):[];if(e.update){e.update.name;const s=Li(n,e.update.name),a=new $n({mapValue:{fields:e.update.fields}});if(e.updateMask){const c=function(h){const m=h.fieldPaths||[];return new Sr(m.map(g=>Xt.fromServerFormat(g)))}(e.updateMask);return new Ts(s,a,c,t,r)}return new kc(s,a,t,r)}if(e.delete){const s=Li(n,e.delete);return new Tc(s,t)}if(e.verify){const s=Li(n,e.verify);return new _x(s,t)}return Oe(1463,{proto:e})}function $P(n,e){return n&&n.length>0?(He(e!==void 0,14353),n.map(t=>function(s,a){let c=s.updateTime?fn(s.updateTime):fn(a);return c.isEqual(Xe.min())&&(c=fn(a)),new BP(c,s.transformResults||[])}(t,e))):[]}function i_(n,e){return{documents:[e_(n,e.path)]}}function _f(n,e){const t={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=e_(n,s);const a=function(m){if(m.length!==0)return l_(At.create(m,"and"))}(e.filters);a&&(t.structuredQuery.where=a);const c=function(m){if(m.length!==0)return m.map(g=>function(S){return{field:io(S.field),direction:KP(S.dir)}}(g))}(e.orderBy);c&&(t.structuredQuery.orderBy=c);const d=Ey(n,e.limit);return d!==null&&(t.structuredQuery.limit=d),e.startAt&&(t.structuredQuery.startAt=function(m){return{before:m.inclusive,values:m.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(m){return{before:!m.inclusive,values:m.position}}(e.endAt)),{gt:t,parent:s}}function s_(n,e,t,r){const{gt:s,parent:a}=_f(n,e),c={},d=[];let h=0;return t.forEach(m=>{const g=r?m.alias:"aggregate_"+h++;c[g]=m.alias,m.aggregateType==="count"?d.push({alias:g,count:{}}):m.aggregateType==="avg"?d.push({alias:g,avg:{field:io(m.fieldPath)}}):m.aggregateType==="sum"&&d.push({alias:g,sum:{field:io(m.fieldPath)}})}),{request:{structuredAggregationQuery:{aggregations:d,structuredQuery:s.structuredQuery},parent:s.parent},yt:c,parent:a}}function o_(n){let e=t_(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let s=null;if(r>0){He(r===1,65062);const g=t.from[0];g.allDescendants?s=g.collectionId:e=e.child(g.collectionId)}let a=[];t.where&&(a=function(x){const S=a_(x);return S instanceof At&&wx(S)?S.getFilters():[S]}(t.where));let c=[];t.orderBy&&(c=function(x){return x.map(S=>function(_){return new rd(Ol(_.field),function(T){switch(T){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(_.direction))}(S))}(t.orderBy));let d=null;t.limit&&(d=function(x){let S;return S=typeof x=="object"?x.value:x,hd(S)?null:S}(t.limit));let h=null;t.startAt&&(h=function(x){const S=!!x.before,I=x.values||[];return new So(I,S)}(t.startAt));let m=null;return t.endAt&&(m=function(x){const S=!x.before,I=x.values||[];return new So(I,S)}(t.endAt)),RT(e,s,c,a,d,"F",h,m)}function GP(n,e){const t=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Oe(28987,{purpose:s})}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function a_(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":const r=Ol(t.unaryFilter.field);return bt.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=Ol(t.unaryFilter.field);return bt.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const a=Ol(t.unaryFilter.field);return bt.create(a,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const c=Ol(t.unaryFilter.field);return bt.create(c,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Oe(61313);default:return Oe(60726)}}(n):n.fieldFilter!==void 0?function(t){return bt.create(Ol(t.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Oe(58110);default:return Oe(50506)}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return At.create(t.compositeFilter.filters.map(r=>a_(r)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return Oe(1026)}}(t.compositeFilter.op))}(n):Oe(30097,{filter:n})}function KP(n){return LP[n]}function QP(n){return OP[n]}function YP(n){return VP[n]}function io(n){return{fieldPath:n.canonicalString()}}function Ol(n){return Xt.fromServerFormat(n.fieldPath)}function l_(n){return n instanceof bt?function(t){if(t.op==="=="){if(Fw(t.value))return{unaryFilter:{field:io(t.field),op:"IS_NAN"}};if(Bw(t.value))return{unaryFilter:{field:io(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(Fw(t.value))return{unaryFilter:{field:io(t.field),op:"IS_NOT_NAN"}};if(Bw(t.value))return{unaryFilter:{field:io(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:io(t.field),op:QP(t.op),value:t.value}}}(n):n instanceof At?function(t){const r=t.getFilters().map(s=>l_(s));return r.length===1?r[0]:{compositeFilter:{op:YP(t.op),filters:r}}}(n):Oe(54877,{filter:n})}function XP(n){const e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function c_(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hs{constructor(e,t,r,s,a=Xe.min(),c=Xe.min(),d=ln.EMPTY_BYTE_STRING,h=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=a,this.lastLimboFreeSnapshotVersion=c,this.resumeToken=d,this.expectedCount=h}withSequenceNumber(e){return new hs(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new hs(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new hs(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new hs(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u_{constructor(e){this.wt=e}}function JP(n,e){let t;if(e.document)t=r_(n.wt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=Fe.fromSegments(e.noDocument.path),s=Aa(e.noDocument.readTime);t=Yt.newNoDocument(r,s),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return Oe(56709);{const r=Fe.fromSegments(e.unknownDocument.path),s=Aa(e.unknownDocument.version);t=Yt.newUnknownDocument(r,s)}}return e.readTime&&t.setReadTime(function(s){const a=new Lt(s[0],s[1]);return Xe.fromTimestamp(a)}(e.readTime)),t}function Xw(n,e){const t=e.key,r={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:Op(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(a,c){return{name:id(a,c.key),fields:c.data.value.mapValue.fields,updateTime:lc(a,c.version.toTimestamp()),createTime:lc(a,c.createTime.toTimestamp())}}(n.wt,e);else if(e.isNoDocument())r.noDocument={path:t.path.toArray(),readTime:Ra(e.version)};else{if(!e.isUnknownDocument())return Oe(57904,{document:e});r.unknownDocument={path:t.path.toArray(),version:Ra(e.version)}}return r}function Op(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function Ra(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Aa(n){const e=new Lt(n.seconds,n.nanoseconds);return Xe.fromTimestamp(e)}function ha(n,e){const t=(e.baseMutations||[]).map(a=>Ay(n.wt,a));for(let a=0;a<e.mutations.length-1;++a){const c=e.mutations[a];if(a+1<e.mutations.length&&e.mutations[a+1].transform!==void 0){const d=e.mutations[a+1];c.updateTransforms=d.transform.fieldTransforms,e.mutations.splice(a+1,1),++a}}const r=e.mutations.map(a=>Ay(n.wt,a)),s=Lt.fromMillis(e.localWriteTimeMs);return new jx(e.batchId,s,t,r)}function Pu(n){const e=Aa(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?Aa(n.lastLimboFreeSnapshotVersion):Xe.min();let r;return r=function(a){return a.documents!==void 0}(n.query)?function(a){const c=a.documents.length;return He(c===1,1966,{count:c}),nr(Sc(t_(a.documents[0])))}(n.query):function(a){return nr(o_(a))}(n.query),new hs(r,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,ln.fromBase64String(n.resumeToken))}function d_(n,e){const t=Ra(e.snapshotVersion),r=Ra(e.lastLimboFreeSnapshotVersion);let s;s=zp(e.target)?i_(n.wt,e.target):_f(n.wt,e.target).gt;const a=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Ia(e.target),readTime:t,resumeToken:a,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:s}}function Ax(n){const e=o_({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Mp(e,e.limit,"L"):e}function Dg(n,e){return new Ex(e.largestBatchId,Ay(n.wt,e.overlayMutation))}function Jw(n,e){const t=e.path.lastSegment();return[n,tr(e.path.popLast()),t]}function Zw(n,e,t,r){return{indexId:n,uid:e,sequenceNumber:t,readTime:Ra(r.readTime),documentKey:tr(r.documentKey.path),largestBatchId:r.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZP{getBundleMetadata(e,t){return e1(e).get(t).next(r=>{if(r)return function(a){return{id:a.bundleId,createTime:Aa(a.createTime),version:a.version}}(r)})}saveBundleMetadata(e,t){return e1(e).put(function(s){return{bundleId:s.id,createTime:Ra(fn(s.createTime)),version:s.version}}(t))}getNamedQuery(e,t){return t1(e).get(t).next(r=>{if(r)return function(a){return{name:a.name,query:Ax(a.bundledQuery),readTime:Aa(a.readTime)}}(r)})}saveNamedQuery(e,t){return t1(e).put(function(s){return{name:s.name,readTime:Ra(fn(s.readTime)),bundledQuery:s.bundledQuery}}(t))}}function e1(n){return En(n,yf)}function t1(n){return En(n,xf)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jf{constructor(e,t){this.serializer=e,this.userId=t}static bt(e,t){const r=t.uid||"";return new jf(e,r)}getOverlay(e,t){return bu(e).get(Jw(this.userId,t)).next(r=>r?Dg(this.serializer,r):null)}getOverlays(e,t){const r=Ni();return le.forEach(t,s=>this.getOverlay(e,s).next(a=>{a!==null&&r.set(s,a)})).next(()=>r)}saveOverlays(e,t,r){const s=[];return r.forEach((a,c)=>{const d=new Ex(t,c);s.push(this.St(e,d))}),le.waitFor(s)}removeOverlaysForBatchId(e,t,r){const s=new Set;t.forEach(c=>s.add(tr(c.getCollectionPath())));const a=[];return s.forEach(c=>{const d=IDBKeyRange.bound([this.userId,c,r],[this.userId,c,r+1],!1,!0);a.push(bu(e).X(vy,d))}),le.waitFor(a)}getOverlaysForCollection(e,t,r){const s=Ni(),a=tr(t),c=IDBKeyRange.bound([this.userId,a,r],[this.userId,a,Number.POSITIVE_INFINITY],!0);return bu(e).J(vy,c).next(d=>{for(const h of d){const m=Dg(this.serializer,h);s.set(m.getKey(),m)}return s})}getOverlaysForCollectionGroup(e,t,r,s){const a=Ni();let c;const d=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,Number.POSITIVE_INFINITY],!0);return bu(e).te({index:aT,range:d},(h,m,g)=>{const x=Dg(this.serializer,m);a.size()<s||x.largestBatchId===c?(a.set(x.getKey(),x),c=x.largestBatchId):g.done()}).next(()=>a)}St(e,t){return bu(e).put(function(s,a,c){const[d,h,m]=Jw(a,c.mutation.key);return{userId:a,collectionPath:h,documentId:m,collectionGroup:c.mutation.key.getCollectionGroup(),largestBatchId:c.largestBatchId,overlayMutation:sd(s.wt,c.mutation)}}(this.serializer,this.userId,t))}}function bu(n){return En(n,bf)}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e6{Dt(e){return En(e,yx)}getSessionToken(e){return this.Dt(e).get("sessionToken").next(t=>{const r=t==null?void 0:t.value;return r?ln.fromUint8Array(r):ln.EMPTY_BYTE_STRING})}setSessionToken(e,t){return this.Dt(e).put({name:"sessionToken",value:t.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pa{constructor(){}vt(e,t){this.Ct(e,t),t.Ft()}Ct(e,t){if("nullValue"in e)this.Mt(t,5);else if("booleanValue"in e)this.Mt(t,10),t.xt(e.booleanValue?1:0);else if("integerValue"in e)this.Mt(t,15),t.xt(nn(e.integerValue));else if("doubleValue"in e){const r=nn(e.doubleValue);isNaN(r)?this.Mt(t,13):(this.Mt(t,15),Qu(r)?t.xt(0):t.xt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Mt(t,20),typeof r=="string"&&(r=xs(r)),t.Ot(`${r.seconds||""}`),t.xt(r.nanos||0)}else if("stringValue"in e)this.Nt(e.stringValue,t),this.Bt(t);else if("bytesValue"in e)this.Mt(t,30),t.Lt(bs(e.bytesValue)),this.Bt(t);else if("referenceValue"in e)this.kt(e.referenceValue,t);else if("geoPointValue"in e){const r=e.geoPointValue;this.Mt(t,45),t.xt(r.latitude||0),t.xt(r.longitude||0)}else"mapValue"in e?vT(e)?this.Mt(t,Number.MAX_SAFE_INTEGER):Sf(e)?this.qt(e.mapValue,t):(this.Qt(e.mapValue,t),this.Bt(t)):"arrayValue"in e?(this.$t(e.arrayValue,t),this.Bt(t)):Oe(19022,{Ut:e})}Nt(e,t){this.Mt(t,25),this.Kt(e,t)}Kt(e,t){t.Ot(e)}Qt(e,t){const r=e.fields||{};this.Mt(t,55);for(const s of Object.keys(r))this.Nt(s,t),this.Ct(r[s],t)}qt(e,t){var r,s;const a=e.fields||{};this.Mt(t,53);const c=rc,d=((s=(r=a[c].arrayValue)===null||r===void 0?void 0:r.values)===null||s===void 0?void 0:s.length)||0;this.Mt(t,15),t.xt(nn(d)),this.Nt(c,t),this.Ct(a[c],t)}$t(e,t){const r=e.values||[];this.Mt(t,50);for(const s of r)this.Ct(s,t)}kt(e,t){this.Mt(t,37),Fe.fromName(e).path.forEach(r=>{this.Mt(t,60),this.Kt(r,t)})}Mt(e,t){e.xt(t)}Bt(e){e.xt(2)}}pa.Wt=new pa;/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law | agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES | CONDITIONS OF ANY KIND, either express | implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cl=255;function t6(n){if(n===0)return 8;let e=0;return n>>4||(e+=4,n<<=4),n>>6||(e+=2,n<<=2),n>>7||(e+=1),e}function n1(n){const e=64-function(r){let s=0;for(let a=0;a<8;++a){const c=t6(255&r[a]);if(s+=c,c!==8)break}return s}(n);return Math.ceil(e/8)}class n6{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Gt(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.zt(r.value),r=t.next();this.jt()}Ht(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Jt(r.value),r=t.next();this.Yt()}Zt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.zt(r);else if(r<2048)this.zt(960|r>>>6),this.zt(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.zt(480|r>>>12),this.zt(128|63&r>>>6),this.zt(128|63&r);else{const s=t.codePointAt(0);this.zt(240|s>>>18),this.zt(128|63&s>>>12),this.zt(128|63&s>>>6),this.zt(128|63&s)}}this.jt()}Xt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Jt(r);else if(r<2048)this.Jt(960|r>>>6),this.Jt(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Jt(480|r>>>12),this.Jt(128|63&r>>>6),this.Jt(128|63&r);else{const s=t.codePointAt(0);this.Jt(240|s>>>18),this.Jt(128|63&s>>>12),this.Jt(128|63&s>>>6),this.Jt(128|63&s)}}this.Yt()}en(e){const t=this.tn(e),r=n1(t);this.nn(1+r),this.buffer[this.position++]=255&r;for(let s=t.length-r;s<t.length;++s)this.buffer[this.position++]=255&t[s]}rn(e){const t=this.tn(e),r=n1(t);this.nn(1+r),this.buffer[this.position++]=~(255&r);for(let s=t.length-r;s<t.length;++s)this.buffer[this.position++]=~(255&t[s])}sn(){this._n(Cl),this._n(255)}an(){this.un(Cl),this.un(255)}reset(){this.position=0}seed(e){this.nn(e.length),this.buffer.set(e,this.position),this.position+=e.length}cn(){return this.buffer.slice(0,this.position)}tn(e){const t=function(a){const c=new DataView(new ArrayBuffer(8));return c.setFloat64(0,a,!1),new Uint8Array(c.buffer)}(e),r=!!(128&t[0]);t[0]^=r?255:128;for(let s=1;s<t.length;++s)t[s]^=r?255:0;return t}zt(e){const t=255&e;t===0?(this._n(0),this._n(255)):t===Cl?(this._n(Cl),this._n(0)):this._n(t)}Jt(e){const t=255&e;t===0?(this.un(0),this.un(255)):t===Cl?(this.un(Cl),this.un(0)):this.un(e)}jt(){this._n(0),this._n(1)}Yt(){this.un(0),this.un(1)}_n(e){this.nn(1),this.buffer[this.position++]=e}un(e){this.nn(1),this.buffer[this.position++]=~e}nn(e){const t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);const s=new Uint8Array(r);s.set(this.buffer),this.buffer=s}}class r6{constructor(e){this.ln=e}Lt(e){this.ln.Gt(e)}Ot(e){this.ln.Zt(e)}xt(e){this.ln.en(e)}Ft(){this.ln.sn()}}class i6{constructor(e){this.ln=e}Lt(e){this.ln.Ht(e)}Ot(e){this.ln.Xt(e)}xt(e){this.ln.rn(e)}Ft(){this.ln.an()}}class vu{constructor(){this.ln=new n6,this.hn=new r6(this.ln),this.Pn=new i6(this.ln)}seed(e){this.ln.seed(e)}Tn(e){return e===0?this.hn:this.Pn}cn(){return this.ln.cn()}reset(){this.ln.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fa{constructor(e,t,r,s){this.In=e,this.En=t,this.dn=r,this.An=s}Rn(){const e=this.An.length,t=e===0||this.An[e-1]===255?e+1:e,r=new Uint8Array(t);return r.set(this.An,0),t!==e?r.set([0],this.An.length):++r[r.length-1],new fa(this.In,this.En,this.dn,r)}Vn(e,t,r){return{indexId:this.In,uid:e,arrayValue:wp(this.dn),directionalValue:wp(this.An),orderedDocumentKey:wp(t),documentKey:r.path.toArray()}}mn(e,t,r){const s=this.Vn(e,t,r);return[s.indexId,s.uid,s.arrayValue,s.directionalValue,s.orderedDocumentKey,s.documentKey]}}function eo(n,e){let t=n.In-e.In;return t!==0?t:(t=r1(n.dn,e.dn),t!==0?t:(t=r1(n.An,e.An),t!==0?t:Fe.comparator(n.En,e.En)))}function r1(n,e){for(let t=0;t<n.length&&t<e.length;++t){const r=n[t]-e[t];if(r!==0)return r}return n.length-e.length}function wp(n){return Bk()?function(t){let r="";for(let s=0;s<t.length;s++)r+=String.fromCharCode(t[s]);return r}(n):n}function i1(n){return typeof n!="string"?n:function(t){const r=new Uint8Array(t.length);for(let s=0;s<t.length;s++)r[s]=t.charCodeAt(s);return r}(n)}class s1{constructor(e){this.fn=new Pt((t,r)=>Xt.comparator(t.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.gn=e.orderBy,this.pn=[];for(const t of e.filters){const r=t;r.isInequality()?this.fn=this.fn.add(r):this.pn.push(r)}}get yn(){return this.fn.size>1}wn(e){if(He(e.collectionGroup===this.collectionId,49279),this.yn)return!1;const t=yy(e);if(t!==void 0&&!this.bn(t))return!1;const r=ca(e);let s=new Set,a=0,c=0;for(;a<r.length&&this.bn(r[a]);++a)s=s.add(r[a].fieldPath.canonicalString());if(a===r.length)return!0;if(this.fn.size>0){const d=this.fn.getIterator().getNext();if(!s.has(d.field.canonicalString())){const h=r[a];if(!this.Sn(d,h)||!this.Dn(this.gn[c++],h))return!1}++a}for(;a<r.length;++a){const d=r[a];if(c>=this.gn.length||!this.Dn(this.gn[c++],d))return!1}return!0}vn(){if(this.yn)return null;let e=new Pt(Xt.comparator);const t=[];for(const r of this.pn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")t.push(new va(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),t.push(new va(r.field,0))}for(const r of this.gn)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),t.push(new va(r.field,r.dir==="asc"?0:1)));return new Xl(Xl.UNKNOWN_ID,this.collectionId,t,Jl.empty())}bn(e){for(const t of this.pn)if(this.Sn(t,e))return!0;return!1}Sn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===r}Dn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function h_(n){var e,t;if(He(n instanceof bt||n instanceof At,20012),n instanceof bt){if(n instanceof CT){const s=((t=(e=n.value.arrayValue)===null||e===void 0?void 0:e.values)===null||t===void 0?void 0:t.map(a=>bt.create(n.field,"==",a)))||[];return At.create(s,"or")}return n}const r=n.filters.map(s=>h_(s));return At.create(r,n.op)}function s6(n){if(n.getFilters().length===0)return[];const e=Fy(h_(n));return He(p_(e),7391),Py(e)||By(e)?[e]:e.getFilters()}function Py(n){return n instanceof bt}function By(n){return n instanceof At&&wx(n)}function p_(n){return Py(n)||By(n)||function(t){if(t instanceof At&&Ty(t)){for(const r of t.getFilters())if(!Py(r)&&!By(r))return!1;return!0}return!1}(n)}function Fy(n){if(He(n instanceof bt||n instanceof At,34018),n instanceof bt)return n;if(n.filters.length===1)return Fy(n.filters[0]);const e=n.filters.map(r=>Fy(r));let t=At.create(e,n.op);return t=Vp(t),p_(t)?t:(He(t instanceof At,64498),He(sc(t),40251),He(t.filters.length>1,57927),t.filters.reduce((r,s)=>Px(r,s)))}function Px(n,e){let t;return He(n instanceof bt||n instanceof At,38388),He(e instanceof bt||e instanceof At,25473),t=n instanceof bt?e instanceof bt?function(s,a){return At.create([s,a],"and")}(n,e):o1(n,e):e instanceof bt?o1(e,n):function(s,a){if(He(s.filters.length>0&&a.filters.length>0,48005),sc(s)&&sc(a))return jT(s,a.getFilters());const c=Ty(s)?s:a,d=Ty(s)?a:s,h=c.filters.map(m=>Px(m,d));return At.create(h,"or")}(n,e),Vp(t)}function o1(n,e){if(sc(e))return jT(e,n.getFilters());{const t=e.filters.map(r=>Px(n,r));return At.create(t,"or")}}function Vp(n){if(He(n instanceof bt||n instanceof At,11850),n instanceof bt)return n;const e=n.getFilters();if(e.length===1)return Vp(e[0]);if(TT(n))return n;const t=e.map(s=>Vp(s)),r=[];return t.forEach(s=>{s instanceof bt?r.push(s):s instanceof At&&(s.op===n.op?r.push(...s.filters):r.push(s))}),r.length===1?r[0]:At.create(r,n.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o6{constructor(){this.Cn=new Bx}addToCollectionParentIndex(e,t){return this.Cn.add(t),le.resolve()}getCollectionParents(e,t){return le.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return le.resolve()}deleteFieldIndex(e,t){return le.resolve()}deleteAllFieldIndexes(e){return le.resolve()}createTargetIndexes(e,t){return le.resolve()}getDocumentsMatchingTarget(e,t){return le.resolve(null)}getIndexType(e,t){return le.resolve(0)}getFieldIndexes(e,t){return le.resolve([])}getNextCollectionGroupToUpdate(e){return le.resolve(null)}getMinOffset(e,t){return le.resolve(Or.min())}getMinOffsetFromCollectionGroup(e,t){return le.resolve(Or.min())}updateCollectionGroup(e,t,r){return le.resolve()}updateIndexEntries(e,t){return le.resolve()}}class Bx{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),s=this.index[t]||new Pt(xt.comparator),a=!s.has(r);return this.index[t]=s.add(r),a}has(e){const t=e.lastSegment(),r=e.popLast(),s=this.index[t];return s&&s.has(r)}getEntries(e){return(this.index[e]||new Pt(xt.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const a1="IndexedDbIndexManager",np=new Uint8Array(0);class a6{constructor(e,t){this.databaseId=t,this.Fn=new Bx,this.Mn=new ks(r=>Ia(r),(r,s)=>fd(r,s)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.Fn.has(t)){const r=t.lastSegment(),s=t.popLast();e.addOnCommittedListener(()=>{this.Fn.add(t)});const a={collectionId:r,parent:tr(s)};return l1(e).put(a)}return le.resolve()}getCollectionParents(e,t){const r=[],s=IDBKeyRange.bound([t,""],[Qk(t),""],!1,!0);return l1(e).J(s).next(a=>{for(const c of a){if(c.collectionId!==t)break;r.push(Fi(c.parent))}return r})}addFieldIndex(e,t){const r=wu(e),s=function(d){return{indexId:d.indexId,collectionGroup:d.collectionGroup,fields:d.fields.map(h=>[h.fieldPath.canonicalString(),h.kind])}}(t);delete s.indexId;const a=r.add(s);if(t.indexState){const c=Al(e);return a.next(d=>{c.put(Zw(d,this.uid,t.indexState.sequenceNumber,t.indexState.offset))})}return a.next()}deleteFieldIndex(e,t){const r=wu(e),s=Al(e),a=Rl(e);return r.delete(t.indexId).next(()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>a.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const t=wu(e),r=Rl(e),s=Al(e);return t.X().next(()=>r.X()).next(()=>s.X())}createTargetIndexes(e,t){return le.forEach(this.xn(t),r=>this.getIndexType(e,r).next(s=>{if(s===0||s===1){const a=new s1(r).vn();if(a!=null)return this.addFieldIndex(e,a)}}))}getDocumentsMatchingTarget(e,t){const r=Rl(e);let s=!0;const a=new Map;return le.forEach(this.xn(t),c=>this.On(e,c).next(d=>{s&&(s=!!d),a.set(c,d)})).next(()=>{if(s){let c=dt();const d=[];return le.forEach(a,(h,m)=>{Te(a1,`Using index ${function(F){return`id=${F.indexId}|cg=${F.collectionGroup}|f=${F.fields.map(X=>`${X.fieldPath}:${X.kind}`).join(",")}`}(h)} to execute ${Ia(t)}`);const g=function(F,X){const ie=yy(X);if(ie===void 0)return null;for(const G of Dp(F,ie.fieldPath))switch(G.op){case"array-contains-any":return G.value.arrayValue.values||[];case"array-contains":return[G.value]}return null}(m,h),x=function(F,X){const ie=new Map;for(const G of ca(X))for(const N of Dp(F,G.fieldPath))switch(N.op){case"==":case"in":ie.set(G.fieldPath.canonicalString(),N.value);break;case"not-in":case"!=":return ie.set(G.fieldPath.canonicalString(),N.value),Array.from(ie.values())}return null}(m,h),S=function(F,X){const ie=[];let G=!0;for(const N of ca(X)){const E=N.kind===0?Lw(F,N.fieldPath,F.startAt):Ow(F,N.fieldPath,F.startAt);ie.push(E.value),G&&(G=E.inclusive)}return new So(ie,G)}(m,h),I=function(F,X){const ie=[];let G=!0;for(const N of ca(X)){const E=N.kind===0?Ow(F,N.fieldPath,F.endAt):Lw(F,N.fieldPath,F.endAt);ie.push(E.value),G&&(G=E.inclusive)}return new So(ie,G)}(m,h),_=this.Nn(h,m,S),R=this.Nn(h,m,I),T=this.Bn(h,m,x),A=this.Ln(h.indexId,g,_,S.inclusive,R,I.inclusive,T);return le.forEach(A,D=>r.Z(D,t.limit).next(F=>{F.forEach(X=>{const ie=Fe.fromSegments(X.documentKey);c.has(ie)||(c=c.add(ie),d.push(ie))})}))}).next(()=>d)}return le.resolve(null)})}xn(e){let t=this.Mn.get(e);return t||(e.filters.length===0?t=[e]:t=s6(At.create(e.filters,"and")).map(r=>jy(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.Mn.set(e,t),t)}Ln(e,t,r,s,a,c,d){const h=(t!=null?t.length:1)*Math.max(r.length,a.length),m=h/(t!=null?t.length:1),g=[];for(let x=0;x<h;++x){const S=t?this.kn(t[x/m]):np,I=this.qn(e,S,r[x%m],s),_=this.Qn(e,S,a[x%m],c),R=d.map(T=>this.qn(e,S,T,!0));g.push(...this.createRange(I,_,R))}return g}qn(e,t,r,s){const a=new fa(e,Fe.empty(),t,r);return s?a:a.Rn()}Qn(e,t,r,s){const a=new fa(e,Fe.empty(),t,r);return s?a.Rn():a}On(e,t){const r=new s1(t),s=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,s).next(a=>{let c=null;for(const d of a)r.wn(d)&&(!c||d.fields.length>c.fields.length)&&(c=d);return c})}getIndexType(e,t){let r=2;const s=this.xn(t);return le.forEach(s,a=>this.On(e,a).next(c=>{c?r!==0&&c.fields.length<function(h){let m=new Pt(Xt.comparator),g=!1;for(const x of h.filters)for(const S of x.getFlattenedFilters())S.field.isKeyField()||(S.op==="array-contains"||S.op==="array-contains-any"?g=!0:m=m.add(S.field));for(const x of h.orderBy)x.field.isKeyField()||(m=m.add(x.field));return m.size+(g?1:0)}(a)&&(r=1):r=0})).next(()=>function(c){return c.limit!==null}(t)&&s.length>1&&r===2?1:r)}$n(e,t){const r=new vu;for(const s of ca(e)){const a=t.data.field(s.fieldPath);if(a==null)return null;const c=r.Tn(s.kind);pa.Wt.vt(a,c)}return r.cn()}kn(e){const t=new vu;return pa.Wt.vt(e,t.Tn(0)),t.cn()}Un(e,t){const r=new vu;return pa.Wt.vt(ja(this.databaseId,t),r.Tn(function(a){const c=ca(a);return c.length===0?0:c[c.length-1].kind}(e))),r.cn()}Bn(e,t,r){if(r===null)return[];let s=[];s.push(new vu);let a=0;for(const c of ca(e)){const d=r[a++];for(const h of s)if(this.Kn(t,c.fieldPath)&&nd(d))s=this.Wn(s,c,d);else{const m=h.Tn(c.kind);pa.Wt.vt(d,m)}}return this.Gn(s)}Nn(e,t,r){return this.Bn(e,t,r.position)}Gn(e){const t=[];for(let r=0;r<e.length;++r)t[r]=e[r].cn();return t}Wn(e,t,r){const s=[...e],a=[];for(const c of r.arrayValue.values||[])for(const d of s){const h=new vu;h.seed(d.cn()),pa.Wt.vt(c,h.Tn(t.kind)),a.push(h)}return a}Kn(e,t){return!!e.filters.find(r=>r instanceof bt&&r.field.isEqual(t)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,t){const r=wu(e),s=Al(e);return(t?r.J(by,IDBKeyRange.bound(t,t)):r.J()).next(a=>{const c=[];return le.forEach(a,d=>s.get([d.indexId,this.uid]).next(h=>{c.push(function(g,x){const S=x?new Jl(x.sequenceNumber,new Or(Aa(x.readTime),new Fe(Fi(x.documentKey)),x.largestBatchId)):Jl.empty(),I=g.fields.map(([_,R])=>new va(Xt.fromServerFormat(_),R));return new Xl(g.indexId,g.collectionGroup,I,S)}(d,h))})).next(()=>c)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(t=>t.length===0?null:(t.sort((r,s)=>{const a=r.indexState.sequenceNumber-s.indexState.sequenceNumber;return a!==0?a:st(r.collectionGroup,s.collectionGroup)}),t[0].collectionGroup))}updateCollectionGroup(e,t,r){const s=wu(e),a=Al(e);return this.zn(e).next(c=>s.J(by,IDBKeyRange.bound(t,t)).next(d=>le.forEach(d,h=>a.put(Zw(h.indexId,this.uid,c,r)))))}updateIndexEntries(e,t){const r=new Map;return le.forEach(t,(s,a)=>{const c=r.get(s.collectionGroup);return(c?le.resolve(c):this.getFieldIndexes(e,s.collectionGroup)).next(d=>(r.set(s.collectionGroup,d),le.forEach(d,h=>this.jn(e,s,h).next(m=>{const g=this.Hn(a,h);return m.isEqual(g)?le.resolve():this.Jn(e,a,h,m,g)}))))})}Yn(e,t,r,s){return Rl(e).put(s.Vn(this.uid,this.Un(r,t.key),t.key))}Zn(e,t,r,s){return Rl(e).delete(s.mn(this.uid,this.Un(r,t.key),t.key))}jn(e,t,r){const s=Rl(e);let a=new Pt(eo);return s.te({index:oT,range:IDBKeyRange.only([r.indexId,this.uid,wp(this.Un(r,t))])},(c,d)=>{a=a.add(new fa(r.indexId,t,i1(d.arrayValue),i1(d.directionalValue)))}).next(()=>a)}Hn(e,t){let r=new Pt(eo);const s=this.$n(t,e);if(s==null)return r;const a=yy(t);if(a!=null){const c=e.data.field(a.fieldPath);if(nd(c))for(const d of c.arrayValue.values||[])r=r.add(new fa(t.indexId,e.key,this.kn(d),s))}else r=r.add(new fa(t.indexId,e.key,np,s));return r}Jn(e,t,r,s,a){Te(a1,"Updating index entries for document '%s'",t.key);const c=[];return function(h,m,g,x,S){const I=h.getIterator(),_=m.getIterator();let R=El(I),T=El(_);for(;R||T;){let A=!1,D=!1;if(R&&T){const F=g(R,T);F<0?D=!0:F>0&&(A=!0)}else R!=null?D=!0:A=!0;A?(x(T),T=El(_)):D?(S(R),R=El(I)):(R=El(I),T=El(_))}}(s,a,eo,d=>{c.push(this.Yn(e,t,r,d))},d=>{c.push(this.Zn(e,t,r,d))}),le.waitFor(c)}zn(e){let t=1;return Al(e).te({index:sT,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,s,a)=>{a.done(),t=s.sequenceNumber+1}).next(()=>t)}createRange(e,t,r){r=r.sort((c,d)=>eo(c,d)).filter((c,d,h)=>!d||eo(c,h[d-1])!==0);const s=[];s.push(e);for(const c of r){const d=eo(c,e),h=eo(c,t);if(d===0)s[0]=e.Rn();else if(d>0&&h<0)s.push(c),s.push(c.Rn());else if(h>0)break}s.push(t);const a=[];for(let c=0;c<s.length;c+=2){if(this.Xn(s[c],s[c+1]))return[];const d=s[c].mn(this.uid,np,Fe.empty()),h=s[c+1].mn(this.uid,np,Fe.empty());a.push(IDBKeyRange.bound(d,h))}return a}Xn(e,t){return eo(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(c1)}getMinOffset(e,t){return le.mapArray(this.xn(t),r=>this.On(e,r).next(s=>s||Oe(44426))).next(c1)}}function l1(n){return En(n,Ju)}function Rl(n){return En(n,Mu)}function wu(n){return En(n,gx)}function Al(n){return En(n,Du)}function c1(n){He(n.length!==0,28825);let e=n[0].indexState.offset,t=e.largestBatchId;for(let r=1;r<n.length;r++){const s=n[r].indexState.offset;px(s,e)<0&&(e=s),t<s.largestBatchId&&(t=s.largestBatchId)}return new Or(e.readTime,e.documentKey,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const u1={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},f_=41943040;class Zn{static withCacheSize(e){return new Zn(e,Zn.DEFAULT_COLLECTION_PERCENTILE,Zn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function m_(n,e,t){const r=n.store(di),s=n.store(Zl),a=[],c=IDBKeyRange.only(t.batchId);let d=0;const h=r.te({range:c},(g,x,S)=>(d++,S.delete()));a.push(h.next(()=>{He(d===1,47070,{batchId:t.batchId})}));const m=[];for(const g of t.mutations){const x=nT(e,g.key.path,t.batchId);a.push(s.delete(x)),m.push(g.key)}return le.waitFor(a).next(()=>m)}function Wp(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw Oe(14731);e=n.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Zn.DEFAULT_COLLECTION_PERCENTILE=10,Zn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Zn.DEFAULT=new Zn(f_,Zn.DEFAULT_COLLECTION_PERCENTILE,Zn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Zn.DISABLED=new Zn(-1,0,0);class If{constructor(e,t,r,s){this.userId=e,this.serializer=t,this.indexManager=r,this.referenceDelegate=s,this.er={}}static bt(e,t,r,s){He(e.uid!=="",64387);const a=e.isAuthenticated()?e.uid:"";return new If(a,t,r,s)}checkEmpty(e){let t=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return to(e).te({index:ma,range:r},(s,a,c)=>{t=!1,c.done()}).next(()=>t)}addMutationBatch(e,t,r,s){const a=Vl(e),c=to(e);return c.add({}).next(d=>{He(typeof d=="number",49019);const h=new jx(d,t,r,s),m=function(I,_,R){const T=R.baseMutations.map(D=>sd(I.wt,D)),A=R.mutations.map(D=>sd(I.wt,D));return{userId:_,batchId:R.batchId,localWriteTimeMs:R.localWriteTime.toMillis(),baseMutations:T,mutations:A}}(this.serializer,this.userId,h),g=[];let x=new Pt((S,I)=>st(S.canonicalString(),I.canonicalString()));for(const S of s){const I=nT(this.userId,S.key.path,d);x=x.add(S.key.path.popLast()),g.push(c.put(m)),g.push(a.put(I,WA))}return x.forEach(S=>{g.push(this.indexManager.addToCollectionParentIndex(e,S))}),e.addOnCommittedListener(()=>{this.er[d]=h.keys()}),le.waitFor(g).next(()=>h)})}lookupMutationBatch(e,t){return to(e).get(t).next(r=>r?(He(r.userId===this.userId,48,"Unexpected user for mutation batch",{userId:r.userId,batchId:t}),ha(this.serializer,r)):null)}tr(e,t){return this.er[t]?le.resolve(this.er[t]):this.lookupMutationBatch(e,t).next(r=>{if(r){const s=r.keys();return this.er[t]=s,s}return null})}getNextMutationBatchAfterBatchId(e,t){const r=t+1,s=IDBKeyRange.lowerBound([this.userId,r]);let a=null;return to(e).te({index:ma,range:s},(c,d,h)=>{d.userId===this.userId&&(He(d.batchId>=r,47524,{nr:r}),a=ha(this.serializer,d)),h.done()}).next(()=>a)}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=mo;return to(e).te({index:ma,range:t,reverse:!0},(s,a,c)=>{r=a.batchId,c.done()}).next(()=>r)}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,mo],[this.userId,Number.POSITIVE_INFINITY]);return to(e).J(ma,t).next(r=>r.map(s=>ha(this.serializer,s)))}getAllMutationBatchesAffectingDocumentKey(e,t){const r=fp(this.userId,t.path),s=IDBKeyRange.lowerBound(r),a=[];return Vl(e).te({range:s},(c,d,h)=>{const[m,g,x]=c,S=Fi(g);if(m===this.userId&&t.path.isEqual(S))return to(e).get(x).next(I=>{if(!I)throw Oe(61480,{rr:c,batchId:x});He(I.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:I.userId,batchId:x}),a.push(ha(this.serializer,I))});h.done()}).next(()=>a)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Pt(st);const s=[];return t.forEach(a=>{const c=fp(this.userId,a.path),d=IDBKeyRange.lowerBound(c),h=Vl(e).te({range:d},(m,g,x)=>{const[S,I,_]=m,R=Fi(I);S===this.userId&&a.path.isEqual(R)?r=r.add(_):x.done()});s.push(h)}),le.waitFor(s).next(()=>this.ir(e,r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,s=r.length+1,a=fp(this.userId,r),c=IDBKeyRange.lowerBound(a);let d=new Pt(st);return Vl(e).te({range:c},(h,m,g)=>{const[x,S,I]=h,_=Fi(S);x===this.userId&&r.isPrefixOf(_)?_.length===s&&(d=d.add(I)):g.done()}).next(()=>this.ir(e,d))}ir(e,t){const r=[],s=[];return t.forEach(a=>{s.push(to(e).get(a).next(c=>{if(c===null)throw Oe(35274,{batchId:a});He(c.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:c.userId,batchId:a}),r.push(ha(this.serializer,c))}))}),le.waitFor(s).next(()=>r)}removeMutationBatch(e,t){return m_(e.he,this.userId,t).next(r=>(e.addOnCommittedListener(()=>{this.sr(t.batchId)}),le.forEach(r,s=>this.referenceDelegate.markPotentiallyOrphaned(e,s))))}sr(e){delete this.er[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return le.resolve();const r=IDBKeyRange.lowerBound(function(c){return[c]}(this.userId)),s=[];return Vl(e).te({range:r},(a,c,d)=>{if(a[0]===this.userId){const h=Fi(a[1]);s.push(h)}else d.done()}).next(()=>{He(s.length===0,56720,{_r:s.map(a=>a.canonicalString())})})})}containsKey(e,t){return g_(e,this.userId,t)}ar(e){return y_(e).get(this.userId).next(t=>t||{userId:this.userId,lastAcknowledgedBatchId:mo,lastStreamToken:""})}}function g_(n,e,t){const r=fp(e,t.path),s=r[1],a=IDBKeyRange.lowerBound(r);let c=!1;return Vl(n).te({range:a,ee:!0},(d,h,m)=>{const[g,x,S]=d;g===e&&x===s&&(c=!0),m.done()}).next(()=>c)}function to(n){return En(n,di)}function Vl(n){return En(n,Zl)}function y_(n){return En(n,Yu)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pa{constructor(e){this.ur=e}next(){return this.ur+=2,this.ur}static cr(){return new Pa(0)}static lr(){return new Pa(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l6{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.hr(e).next(t=>{const r=new Pa(t.highestTargetId);return t.highestTargetId=r.next(),this.Pr(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.hr(e).next(t=>Xe.fromTimestamp(new Lt(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.hr(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,r){return this.hr(e).next(s=>(s.highestListenSequenceNumber=t,r&&(s.lastRemoteSnapshotVersion=r.toTimestamp()),t>s.highestListenSequenceNumber&&(s.highestListenSequenceNumber=t),this.Pr(e,s)))}addTargetData(e,t){return this.Tr(e,t).next(()=>this.hr(e).next(r=>(r.targetCount+=1,this.Ir(t,r),this.Pr(e,r))))}updateTargetData(e,t){return this.Tr(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>Pl(e).delete(t.targetId)).next(()=>this.hr(e)).next(r=>(He(r.targetCount>0,8065),r.targetCount-=1,this.Pr(e,r)))}removeTargets(e,t,r){let s=0;const a=[];return Pl(e).te((c,d)=>{const h=Pu(d);h.sequenceNumber<=t&&r.get(h.targetId)===null&&(s++,a.push(this.removeTargetData(e,h)))}).next(()=>le.waitFor(a)).next(()=>s)}forEachTarget(e,t){return Pl(e).te((r,s)=>{const a=Pu(s);t(a)})}hr(e){return d1(e).get(Np).next(t=>(He(t!==null,2888),t))}Pr(e,t){return d1(e).put(Np,t)}Tr(e,t){return Pl(e).put(d_(this.serializer,t))}Ir(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.hr(e).next(t=>t.targetCount)}getTargetData(e,t){const r=Ia(t),s=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let a=null;return Pl(e).te({range:s,index:iT},(c,d,h)=>{const m=Pu(d);fd(t,m.target)&&(a=m,h.done())}).next(()=>a)}addMatchingKeys(e,t,r){const s=[],a=so(e);return t.forEach(c=>{const d=tr(c.path);s.push(a.put({targetId:r,path:d})),s.push(this.referenceDelegate.addReference(e,r,c))}),le.waitFor(s)}removeMatchingKeys(e,t,r){const s=so(e);return le.forEach(t,a=>{const c=tr(a.path);return le.waitFor([s.delete([r,c]),this.referenceDelegate.removeReference(e,r,a)])})}removeMatchingKeysForTargetId(e,t){const r=so(e),s=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(s)}getMatchingKeysForTargetId(e,t){const r=IDBKeyRange.bound([t],[t+1],!1,!0),s=so(e);let a=dt();return s.te({range:r,ee:!0},(c,d,h)=>{const m=Fi(c[1]),g=new Fe(m);a=a.add(g)}).next(()=>a)}containsKey(e,t){const r=tr(t.path),s=IDBKeyRange.bound([r],[Qk(r)],!1,!0);let a=0;return so(e).te({index:mx,ee:!0,range:s},([c,d],h,m)=>{c!==0&&(a++,m.done())}).next(()=>a>0)}Rt(e,t){return Pl(e).get(t).next(r=>r?Pu(r):null)}}function Pl(n){return En(n,ec)}function d1(n){return En(n,wa)}function so(n){return En(n,tc)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const h1="LruGarbageCollector",x_=1048576;function p1([n,e],[t,r]){const s=st(n,t);return s===0?st(e,r):s}class c6{constructor(e){this.Er=e,this.buffer=new Pt(p1),this.dr=0}Ar(){return++this.dr}Rr(e){const t=[e,this.Ar()];if(this.buffer.size<this.Er)this.buffer=this.buffer.add(t);else{const r=this.buffer.last();p1(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}}class b_{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Vr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.mr(6e4)}stop(){this.Vr&&(this.Vr.cancel(),this.Vr=null)}get started(){return this.Vr!==null}mr(e){Te(h1,`Garbage collection scheduled in ${e}ms`),this.Vr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Vr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Co(t)?Te(h1,"Ignoring IndexedDB error during garbage collection: ",t):await Eo(t)}await this.mr(3e5)})}}class u6{constructor(e,t){this.gr=e,this.params=t}calculateTargetCount(e,t){return this.gr.pr(e).next(r=>Math.floor(t/100*r))}nthSequenceNumber(e,t){if(t===0)return le.resolve(wr.le);const r=new c6(t);return this.gr.forEachTarget(e,s=>r.Rr(s.sequenceNumber)).next(()=>this.gr.yr(e,s=>r.Rr(s))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.gr.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.gr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(Te("LruGarbageCollector","Garbage collection skipped; disabled"),le.resolve(u1)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(Te("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),u1):this.wr(e,t))}getCacheSize(e){return this.gr.getCacheSize(e)}wr(e,t){let r,s,a,c,d,h,m;const g=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(x=>(x>this.params.maximumSequenceNumbersToCollect?(Te("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${x}`),s=this.params.maximumSequenceNumbersToCollect):s=x,c=Date.now(),this.nthSequenceNumber(e,s))).next(x=>(r=x,d=Date.now(),this.removeTargets(e,r,t))).next(x=>(a=x,h=Date.now(),this.removeOrphanedDocuments(e,r))).next(x=>(m=Date.now(),Ml()<=yt.DEBUG&&Te("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${c-g}ms
	Determined least recently used ${s} in `+(d-c)+`ms
	Removed ${a} targets in `+(h-d)+`ms
	Removed ${x} documents in `+(m-h)+`ms
Total Duration: ${m-g}ms`),le.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:a,documentsRemoved:x})))}}function v_(n,e){return new u6(n,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d6{constructor(e,t){this.db=e,this.garbageCollector=v_(this,t)}pr(e){const t=this.br(e);return this.db.getTargetCache().getTargetCount(e).next(r=>t.next(s=>r+s))}br(e){let t=0;return this.yr(e,r=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}yr(e,t){return this.Sr(e,(r,s)=>t(s))}addReference(e,t,r){return rp(e,r)}removeReference(e,t,r){return rp(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return rp(e,t)}Dr(e,t){return function(s,a){let c=!1;return y_(s).ne(d=>g_(s,d,a).next(h=>(h&&(c=!0),le.resolve(!h)))).next(()=>c)}(e,t)}removeOrphanedDocuments(e,t){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),s=[];let a=0;return this.Sr(e,(c,d)=>{if(d<=t){const h=this.Dr(e,c).next(m=>{if(!m)return a++,r.getEntry(e,c).next(()=>(r.removeEntry(c,Xe.min()),so(e).delete(function(x){return[0,tr(x.path)]}(c))))});s.push(h)}}).next(()=>le.waitFor(s)).next(()=>r.apply(e)).next(()=>a)}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return rp(e,t)}Sr(e,t){const r=so(e);let s,a=wr.le;return r.te({index:mx},([c,d],{path:h,sequenceNumber:m})=>{c===0?(a!==wr.le&&t(new Fe(Fi(s)),a),a=m,s=h):a=wr.le}).next(()=>{a!==wr.le&&t(new Fe(Fi(s)),a)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function rp(n,e){return so(n).put(function(r,s){return{targetId:0,path:tr(r.path),sequenceNumber:s}}(e,n.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w_{constructor(){this.changes=new ks(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Yt.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return r!==void 0?le.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h6{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return aa(e).put(r)}removeEntry(e,t,r){return aa(e).delete(function(a,c){const d=a.path.toArray();return[d.slice(0,d.length-2),d[d.length-2],Op(c),d[d.length-1]]}(t,r))}updateMetadata(e,t){return this.getMetadata(e).next(r=>(r.byteSize+=t,this.vr(e,r)))}getEntry(e,t){let r=Yt.newInvalidDocument(t);return aa(e).te({index:mp,range:IDBKeyRange.only(Su(t))},(s,a)=>{r=this.Cr(t,a)}).next(()=>r)}Fr(e,t){let r={size:0,document:Yt.newInvalidDocument(t)};return aa(e).te({index:mp,range:IDBKeyRange.only(Su(t))},(s,a)=>{r={document:this.Cr(t,a),size:Wp(a)}}).next(()=>r)}getEntries(e,t){let r=kr();return this.Mr(e,t,(s,a)=>{const c=this.Cr(s,a);r=r.insert(s,c)}).next(()=>r)}Or(e,t){let r=kr(),s=new $t(Fe.comparator);return this.Mr(e,t,(a,c)=>{const d=this.Cr(a,c);r=r.insert(a,d),s=s.insert(a,Wp(c))}).next(()=>({documents:r,Nr:s}))}Mr(e,t,r){if(t.isEmpty())return le.resolve();let s=new Pt(g1);t.forEach(h=>s=s.add(h));const a=IDBKeyRange.bound(Su(s.first()),Su(s.last())),c=s.getIterator();let d=c.getNext();return aa(e).te({index:mp,range:a},(h,m,g)=>{const x=Fe.fromSegments([...m.prefixPath,m.collectionGroup,m.documentId]);for(;d&&g1(d,x)<0;)r(d,null),d=c.getNext();d&&d.isEqual(x)&&(r(d,m),d=c.hasNext()?c.getNext():null),d?g.H(Su(d)):g.done()}).next(()=>{for(;d;)r(d,null),d=c.hasNext()?c.getNext():null})}getDocumentsMatchingQuery(e,t,r,s,a){const c=t.path,d=[c.popLast().toArray(),c.lastSegment(),Op(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],h=[c.popLast().toArray(),c.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return aa(e).J(IDBKeyRange.bound(d,h,!0)).next(m=>{a==null||a.incrementDocumentReadCount(m.length);let g=kr();for(const x of m){const S=this.Cr(Fe.fromSegments(x.prefixPath.concat(x.collectionGroup,x.documentId)),x);S.isFoundDocument()&&(gd(t,S)||s.has(S.key))&&(g=g.insert(S.key,S))}return g})}getAllFromCollectionGroup(e,t,r,s){let a=kr();const c=m1(t,r),d=m1(t,Or.max());return aa(e).te({index:rT,range:IDBKeyRange.bound(c,d,!0)},(h,m,g)=>{const x=this.Cr(Fe.fromSegments(m.prefixPath.concat(m.collectionGroup,m.documentId)),m);a=a.insert(x.key,x),a.size===s&&g.done()}).next(()=>a)}newChangeBuffer(e){return new p6(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return f1(e).get(xy).next(t=>(He(!!t,20021),t))}vr(e,t){return f1(e).put(xy,t)}Cr(e,t){if(t){const r=JP(this.serializer,t);if(!(r.isNoDocument()&&r.version.isEqual(Xe.min())))return r}return Yt.newInvalidDocument(e)}}function S_(n){return new h6(n)}class p6 extends w_{constructor(e,t){super(),this.Br=e,this.trackRemovals=t,this.Lr=new ks(r=>r.toString(),(r,s)=>r.isEqual(s))}applyChanges(e){const t=[];let r=0,s=new Pt((a,c)=>st(a.canonicalString(),c.canonicalString()));return this.changes.forEach((a,c)=>{const d=this.Lr.get(a);if(t.push(this.Br.removeEntry(e,a,d.readTime)),c.isValidDocument()){const h=Xw(this.Br.serializer,c);s=s.add(a.path.popLast());const m=Wp(h);r+=m-d.size,t.push(this.Br.addEntry(e,a,h))}else if(r-=d.size,this.trackRemovals){const h=Xw(this.Br.serializer,c.convertToNoDocument(Xe.min()));t.push(this.Br.addEntry(e,a,h))}}),s.forEach(a=>{t.push(this.Br.indexManager.addToCollectionParentIndex(e,a))}),t.push(this.Br.updateMetadata(e,r)),le.waitFor(t)}getFromCache(e,t){return this.Br.Fr(e,t).next(r=>(this.Lr.set(t,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,t){return this.Br.Or(e,t).next(({documents:r,Nr:s})=>(s.forEach((a,c)=>{this.Lr.set(a,{size:c,readTime:r.get(a).readTime})}),r))}}function f1(n){return En(n,Xu)}function aa(n){return En(n,Fp)}function Su(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function m1(n,e){const t=e.documentKey.path.toArray();return[n,Op(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function g1(n,e){const t=n.path.toArray(),r=e.path.toArray();let s=0;for(let a=0;a<t.length-2&&a<r.length-2;++a)if(s=st(t[a],r[a]),s)return s;return s=st(t.length,r.length),s||(s=st(t[t.length-2],r[r.length-2]),s||st(t[t.length-1],r[r.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f6{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k_{constructor(e,t,r,s){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,t))).next(s=>(r!==null&&Vu(r.mutation,s,Sr.empty(),Lt.now()),s))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,dt()).next(()=>r))}getLocalViewOfDocuments(e,t,r=dt()){const s=Ni();return this.populateOverlays(e,s,t).next(()=>this.computeViews(e,t,s,r).next(a=>{let c=Ru();return a.forEach((d,h)=>{c=c.insert(d,h.overlayedDocument)}),c}))}getOverlayedDocuments(e,t){const r=Ni();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,dt()))}populateOverlays(e,t,r){const s=[];return r.forEach(a=>{t.has(a)||s.push(a)}),this.documentOverlayCache.getOverlays(e,s).next(a=>{a.forEach((c,d)=>{t.set(c,d)})})}computeViews(e,t,r,s){let a=kr();const c=Ou(),d=function(){return Ou()}();return t.forEach((h,m)=>{const g=r.get(m.key);s.has(m.key)&&(g===void 0||g.mutation instanceof Ts)?a=a.insert(m.key,m):g!==void 0?(c.set(m.key,g.mutation.getFieldMask()),Vu(g.mutation,m,g.mutation.getFieldMask(),Lt.now())):c.set(m.key,Sr.empty())}),this.recalculateAndSaveOverlays(e,a).next(h=>(h.forEach((m,g)=>c.set(m,g)),t.forEach((m,g)=>{var x;return d.set(m,new f6(g,(x=c.get(m))!==null&&x!==void 0?x:null))}),d))}recalculateAndSaveOverlays(e,t){const r=Ou();let s=new $t((c,d)=>c-d),a=dt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(c=>{for(const d of c)d.keys().forEach(h=>{const m=t.get(h);if(m===null)return;let g=r.get(h)||Sr.empty();g=d.applyToLocalView(m,g),r.set(h,g);const x=(s.get(d.batchId)||dt()).add(h);s=s.insert(d.batchId,x)})}).next(()=>{const c=[],d=s.getReverseIterator();for(;d.hasNext();){const h=d.getNext(),m=h.key,g=h.value,x=MT();g.forEach(S=>{if(!a.has(S)){const I=HT(t.get(S),r.get(S));I!==null&&x.set(S,I),a=a.add(S)}}),c.push(this.documentOverlayCache.saveOverlays(e,m,x))}return le.waitFor(c)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,s){return function(c){return Fe.isDocumentKey(c.path)&&c.collectionGroup===null&&c.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Sx(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,s):this.getDocumentsMatchingCollectionQuery(e,t,r,s)}getNextDocuments(e,t,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,s).next(a=>{const c=s-a.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,s-a.size):le.resolve(Ni());let d=Yl,h=a;return c.next(m=>le.forEach(m,(g,x)=>(d<x.largestBatchId&&(d=x.largestBatchId),a.get(g)?le.resolve():this.remoteDocumentCache.getEntry(e,g).next(S=>{h=h.insert(g,S)}))).next(()=>this.populateOverlays(e,m,a)).next(()=>this.computeViews(e,h,m,dt())).next(g=>({batchId:d,changes:DT(g)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Fe(t)).next(r=>{let s=Ru();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,t,r,s){const a=t.collectionGroup;let c=Ru();return this.indexManager.getCollectionParents(e,a).next(d=>le.forEach(d,h=>{const m=function(x,S){return new Ss(S,null,x.explicitOrderBy.slice(),x.filters.slice(),x.limit,x.limitType,x.startAt,x.endAt)}(t,h.child(a));return this.getDocumentsMatchingCollectionQuery(e,m,r,s).next(g=>{g.forEach((x,S)=>{c=c.insert(x,S)})})}).next(()=>c))}getDocumentsMatchingCollectionQuery(e,t,r,s){let a;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(c=>(a=c,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,a,s))).next(c=>{a.forEach((h,m)=>{const g=m.getKey();c.get(g)===null&&(c=c.insert(g,Yt.newInvalidDocument(g)))});let d=Ru();return c.forEach((h,m)=>{const g=a.get(h);g!==void 0&&Vu(g.mutation,m,Sr.empty(),Lt.now()),gd(t,m)&&(d=d.insert(h,m))}),d})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m6{constructor(e){this.serializer=e,this.kr=new Map,this.qr=new Map}getBundleMetadata(e,t){return le.resolve(this.kr.get(t))}saveBundleMetadata(e,t){return this.kr.set(t.id,function(s){return{id:s.id,version:s.version,createTime:fn(s.createTime)}}(t)),le.resolve()}getNamedQuery(e,t){return le.resolve(this.qr.get(t))}saveNamedQuery(e,t){return this.qr.set(t.name,function(s){return{name:s.name,query:Ax(s.bundledQuery),readTime:fn(s.readTime)}}(t)),le.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g6{constructor(){this.overlays=new $t(Fe.comparator),this.Qr=new Map}getOverlay(e,t){return le.resolve(this.overlays.get(t))}getOverlays(e,t){const r=Ni();return le.forEach(t,s=>this.getOverlay(e,s).next(a=>{a!==null&&r.set(s,a)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((s,a)=>{this.St(e,t,a)}),le.resolve()}removeOverlaysForBatchId(e,t,r){const s=this.Qr.get(r);return s!==void 0&&(s.forEach(a=>this.overlays=this.overlays.remove(a)),this.Qr.delete(r)),le.resolve()}getOverlaysForCollection(e,t,r){const s=Ni(),a=t.length+1,c=new Fe(t.child("")),d=this.overlays.getIteratorFrom(c);for(;d.hasNext();){const h=d.getNext().value,m=h.getKey();if(!t.isPrefixOf(m.path))break;m.path.length===a&&h.largestBatchId>r&&s.set(h.getKey(),h)}return le.resolve(s)}getOverlaysForCollectionGroup(e,t,r,s){let a=new $t((m,g)=>m-g);const c=this.overlays.getIterator();for(;c.hasNext();){const m=c.getNext().value;if(m.getKey().getCollectionGroup()===t&&m.largestBatchId>r){let g=a.get(m.largestBatchId);g===null&&(g=Ni(),a=a.insert(m.largestBatchId,g)),g.set(m.getKey(),m)}}const d=Ni(),h=a.getIterator();for(;h.hasNext()&&(h.getNext().value.forEach((m,g)=>d.set(m,g)),!(d.size()>=s)););return le.resolve(d)}St(e,t,r){const s=this.overlays.get(r.key);if(s!==null){const c=this.Qr.get(s.largestBatchId).delete(r.key);this.Qr.set(s.largestBatchId,c)}this.overlays=this.overlays.insert(r.key,new Ex(t,r));let a=this.Qr.get(t);a===void 0&&(a=dt(),this.Qr.set(t,a)),this.Qr.set(t,a.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y6{constructor(){this.sessionToken=ln.EMPTY_BYTE_STRING}getSessionToken(e){return le.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,le.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fx{constructor(){this.$r=new Pt(Fn.Ur),this.Kr=new Pt(Fn.Wr)}isEmpty(){return this.$r.isEmpty()}addReference(e,t){const r=new Fn(e,t);this.$r=this.$r.add(r),this.Kr=this.Kr.add(r)}Gr(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.zr(new Fn(e,t))}jr(e,t){e.forEach(r=>this.removeReference(r,t))}Hr(e){const t=new Fe(new xt([])),r=new Fn(t,e),s=new Fn(t,e+1),a=[];return this.Kr.forEachInRange([r,s],c=>{this.zr(c),a.push(c.key)}),a}Jr(){this.$r.forEach(e=>this.zr(e))}zr(e){this.$r=this.$r.delete(e),this.Kr=this.Kr.delete(e)}Yr(e){const t=new Fe(new xt([])),r=new Fn(t,e),s=new Fn(t,e+1);let a=dt();return this.Kr.forEachInRange([r,s],c=>{a=a.add(c.key)}),a}containsKey(e){const t=new Fn(e,0),r=this.$r.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}}class Fn{constructor(e,t){this.key=e,this.Zr=t}static Ur(e,t){return Fe.comparator(e.key,t.key)||st(e.Zr,t.Zr)}static Wr(e,t){return st(e.Zr,t.Zr)||Fe.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x6{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.nr=1,this.Xr=new Pt(Fn.Ur)}checkEmpty(e){return le.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,s){const a=this.nr;this.nr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const c=new jx(a,t,r,s);this.mutationQueue.push(c);for(const d of s)this.Xr=this.Xr.add(new Fn(d.key,a)),this.indexManager.addToCollectionParentIndex(e,d.key.path.popLast());return le.resolve(c)}lookupMutationBatch(e,t){return le.resolve(this.ei(t))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,s=this.ti(r),a=s<0?0:s;return le.resolve(this.mutationQueue.length>a?this.mutationQueue[a]:null)}getHighestUnacknowledgedBatchId(){return le.resolve(this.mutationQueue.length===0?mo:this.nr-1)}getAllMutationBatches(e){return le.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new Fn(t,0),s=new Fn(t,Number.POSITIVE_INFINITY),a=[];return this.Xr.forEachInRange([r,s],c=>{const d=this.ei(c.Zr);a.push(d)}),le.resolve(a)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Pt(st);return t.forEach(s=>{const a=new Fn(s,0),c=new Fn(s,Number.POSITIVE_INFINITY);this.Xr.forEachInRange([a,c],d=>{r=r.add(d.Zr)})}),le.resolve(this.ni(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,s=r.length+1;let a=r;Fe.isDocumentKey(a)||(a=a.child(""));const c=new Fn(new Fe(a),0);let d=new Pt(st);return this.Xr.forEachWhile(h=>{const m=h.key.path;return!!r.isPrefixOf(m)&&(m.length===s&&(d=d.add(h.Zr)),!0)},c),le.resolve(this.ni(d))}ni(e){const t=[];return e.forEach(r=>{const s=this.ei(r);s!==null&&t.push(s)}),t}removeMutationBatch(e,t){He(this.ri(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Xr;return le.forEach(t.mutations,s=>{const a=new Fn(s.key,t.batchId);return r=r.delete(a),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.Xr=r})}sr(e){}containsKey(e,t){const r=new Fn(t,0),s=this.Xr.firstAfterOrEqual(r);return le.resolve(t.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,le.resolve()}ri(e,t){return this.ti(e)}ti(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}ei(e){const t=this.ti(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b6{constructor(e){this.ii=e,this.docs=function(){return new $t(Fe.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,s=this.docs.get(r),a=s?s.size:0,c=this.ii(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:c}),this.size+=c-a,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return le.resolve(r?r.document.mutableCopy():Yt.newInvalidDocument(t))}getEntries(e,t){let r=kr();return t.forEach(s=>{const a=this.docs.get(s);r=r.insert(s,a?a.document.mutableCopy():Yt.newInvalidDocument(s))}),le.resolve(r)}getDocumentsMatchingQuery(e,t,r,s){let a=kr();const c=t.path,d=new Fe(c.child("__id-9223372036854775808__")),h=this.docs.getIteratorFrom(d);for(;h.hasNext();){const{key:m,value:{document:g}}=h.getNext();if(!c.isPrefixOf(m.path))break;m.path.length>c.length+1||px(Xk(g),r)<=0||(s.has(g.key)||gd(t,g))&&(a=a.insert(g.key,g.mutableCopy()))}return le.resolve(a)}getAllFromCollectionGroup(e,t,r,s){Oe(9500)}si(e,t){return le.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new v6(this)}getSize(e){return le.resolve(this.size)}}class v6 extends w_{constructor(e){super(),this.Br=e}applyChanges(e){const t=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?t.push(this.Br.addEntry(e,s)):this.Br.removeEntry(r)}),le.waitFor(t)}getFromCache(e,t){return this.Br.getEntry(e,t)}getAllFromCache(e,t){return this.Br.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w6{constructor(e){this.persistence=e,this.oi=new ks(t=>Ia(t),fd),this.lastRemoteSnapshotVersion=Xe.min(),this.highestTargetId=0,this._i=0,this.ai=new Fx,this.targetCount=0,this.ui=Pa.cr()}forEachTarget(e,t){return this.oi.forEach((r,s)=>t(s)),le.resolve()}getLastRemoteSnapshotVersion(e){return le.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return le.resolve(this._i)}allocateTargetId(e){return this.highestTargetId=this.ui.next(),le.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this._i&&(this._i=t),le.resolve()}Tr(e){this.oi.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ui=new Pa(t),this.highestTargetId=t),e.sequenceNumber>this._i&&(this._i=e.sequenceNumber)}addTargetData(e,t){return this.Tr(t),this.targetCount+=1,le.resolve()}updateTargetData(e,t){return this.Tr(t),le.resolve()}removeTargetData(e,t){return this.oi.delete(t.target),this.ai.Hr(t.targetId),this.targetCount-=1,le.resolve()}removeTargets(e,t,r){let s=0;const a=[];return this.oi.forEach((c,d)=>{d.sequenceNumber<=t&&r.get(d.targetId)===null&&(this.oi.delete(c),a.push(this.removeMatchingKeysForTargetId(e,d.targetId)),s++)}),le.waitFor(a).next(()=>s)}getTargetCount(e){return le.resolve(this.targetCount)}getTargetData(e,t){const r=this.oi.get(t)||null;return le.resolve(r)}addMatchingKeys(e,t,r){return this.ai.Gr(t,r),le.resolve()}removeMatchingKeys(e,t,r){this.ai.jr(t,r);const s=this.persistence.referenceDelegate,a=[];return s&&t.forEach(c=>{a.push(s.markPotentiallyOrphaned(e,c))}),le.waitFor(a)}removeMatchingKeysForTargetId(e,t){return this.ai.Hr(t),le.resolve()}getMatchingKeysForTargetId(e,t){const r=this.ai.Yr(t);return le.resolve(r)}containsKey(e,t){return le.resolve(this.ai.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nx{constructor(e,t){this.ci={},this.overlays={},this.li=new wr(0),this.hi=!1,this.hi=!0,this.Pi=new y6,this.referenceDelegate=e(this),this.Ti=new w6(this),this.indexManager=new o6,this.remoteDocumentCache=function(s){return new b6(s)}(r=>this.referenceDelegate.Ii(r)),this.serializer=new u_(t),this.Ei=new m6(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.hi=!1,Promise.resolve()}get started(){return this.hi}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new g6,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.ci[e.toKey()];return r||(r=new x6(t,this.referenceDelegate),this.ci[e.toKey()]=r),r}getGlobalsCache(){return this.Pi}getTargetCache(){return this.Ti}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ei}runTransaction(e,t,r){Te("MemoryPersistence","Starting transaction:",e);const s=new S6(this.li.next());return this.referenceDelegate.di(),r(s).next(a=>this.referenceDelegate.Ai(s).next(()=>a)).toPromise().then(a=>(s.raiseOnCommittedEvent(),a))}Ri(e,t){return le.or(Object.values(this.ci).map(r=>()=>r.containsKey(e,t)))}}class S6 extends Zk{constructor(e){super(),this.currentSequenceNumber=e}}class Ef{constructor(e){this.persistence=e,this.Vi=new Fx,this.mi=null}static fi(e){return new Ef(e)}get gi(){if(this.mi)return this.mi;throw Oe(60996)}addReference(e,t,r){return this.Vi.addReference(r,t),this.gi.delete(r.toString()),le.resolve()}removeReference(e,t,r){return this.Vi.removeReference(r,t),this.gi.add(r.toString()),le.resolve()}markPotentiallyOrphaned(e,t){return this.gi.add(t.toString()),le.resolve()}removeTarget(e,t){this.Vi.Hr(t.targetId).forEach(s=>this.gi.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(s=>{s.forEach(a=>this.gi.add(a.toString()))}).next(()=>r.removeTargetData(e,t))}di(){this.mi=new Set}Ai(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return le.forEach(this.gi,r=>{const s=Fe.fromPath(r);return this.pi(e,s).next(a=>{a||t.removeEntry(s,Xe.min())})}).next(()=>(this.mi=null,t.apply(e)))}updateLimboDocument(e,t){return this.pi(e,t).next(r=>{r?this.gi.delete(t.toString()):this.gi.add(t.toString())})}Ii(e){return 0}pi(e,t){return le.or([()=>le.resolve(this.Vi.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ri(e,t)])}}class Up{constructor(e,t){this.persistence=e,this.yi=new ks(r=>tr(r.path),(r,s)=>r.isEqual(s)),this.garbageCollector=v_(this,t)}static fi(e,t){return new Up(e,t)}di(){}Ai(e){return le.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}pr(e){const t=this.br(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>t.next(s=>r+s))}br(e){let t=0;return this.yr(e,r=>{t++}).next(()=>t)}yr(e,t){return le.forEach(this.yi,(r,s)=>this.Dr(e,r,s).next(a=>a?le.resolve():t(s)))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0;const s=this.persistence.getRemoteDocumentCache(),a=s.newChangeBuffer();return s.si(e,c=>this.Dr(e,c,t).next(d=>{d||(r++,a.removeEntry(c,Xe.min()))})).next(()=>a.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,t){return this.yi.set(t,e.currentSequenceNumber),le.resolve()}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.yi.set(r,e.currentSequenceNumber),le.resolve()}removeReference(e,t,r){return this.yi.set(r,e.currentSequenceNumber),le.resolve()}updateLimboDocument(e,t){return this.yi.set(t,e.currentSequenceNumber),le.resolve()}Ii(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=yp(e.data.value)),t}Dr(e,t,r){return le.or([()=>this.persistence.Ri(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const s=this.yi.get(t);return le.resolve(s!==void 0&&s>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k6{constructor(e){this.serializer=e}q(e,t,r,s){const a=new gf("createOrUpgrade",t);r<1&&s>=1&&(function(h){h.createObjectStore(pd)}(e),function(h){h.createObjectStore(Yu,{keyPath:VA}),h.createObjectStore(di,{keyPath:Iw,autoIncrement:!0}).createIndex(ma,Ew,{unique:!0}),h.createObjectStore(Zl)}(e),y1(e),function(h){h.createObjectStore(ua)}(e));let c=le.resolve();return r<3&&s>=3&&(r!==0&&(function(h){h.deleteObjectStore(tc),h.deleteObjectStore(ec),h.deleteObjectStore(wa)}(e),y1(e)),c=c.next(()=>function(h){const m=h.store(wa),g={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Xe.min().toTimestamp(),targetCount:0};return m.put(Np,g)}(a))),r<4&&s>=4&&(r!==0&&(c=c.next(()=>function(h,m){return m.store(di).J().next(x=>{h.deleteObjectStore(di),h.createObjectStore(di,{keyPath:Iw,autoIncrement:!0}).createIndex(ma,Ew,{unique:!0});const S=m.store(di),I=x.map(_=>S.put(_));return le.waitFor(I)})}(e,a))),c=c.next(()=>{(function(h){h.createObjectStore(nc,{keyPath:YA})})(e)})),r<5&&s>=5&&(c=c.next(()=>this.wi(a))),r<6&&s>=6&&(c=c.next(()=>(function(h){h.createObjectStore(Xu)}(e),this.bi(a)))),r<7&&s>=7&&(c=c.next(()=>this.Si(a))),r<8&&s>=8&&(c=c.next(()=>this.Di(e,a))),r<9&&s>=9&&(c=c.next(()=>{(function(h){h.objectStoreNames.contains("remoteDocumentChanges")&&h.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&s>=10&&(c=c.next(()=>this.Ci(a))),r<11&&s>=11&&(c=c.next(()=>{(function(h){h.createObjectStore(yf,{keyPath:XA})})(e),function(h){h.createObjectStore(xf,{keyPath:JA})}(e)})),r<12&&s>=12&&(c=c.next(()=>{(function(h){const m=h.createObjectStore(bf,{keyPath:sP});m.createIndex(vy,oP,{unique:!1}),m.createIndex(aT,aP,{unique:!1})})(e)})),r<13&&s>=13&&(c=c.next(()=>function(h){const m=h.createObjectStore(Fp,{keyPath:UA});m.createIndex(mp,qA),m.createIndex(rT,HA)}(e)).next(()=>this.Fi(e,a)).next(()=>e.deleteObjectStore(ua))),r<14&&s>=14&&(c=c.next(()=>this.Mi(e,a))),r<15&&s>=15&&(c=c.next(()=>function(h){h.createObjectStore(gx,{keyPath:ZA,autoIncrement:!0}).createIndex(by,eP,{unique:!1}),h.createObjectStore(Du,{keyPath:tP}).createIndex(sT,nP,{unique:!1}),h.createObjectStore(Mu,{keyPath:rP}).createIndex(oT,iP,{unique:!1})}(e))),r<16&&s>=16&&(c=c.next(()=>{t.objectStore(Du).clear()}).next(()=>{t.objectStore(Mu).clear()})),r<17&&s>=17&&(c=c.next(()=>{(function(h){h.createObjectStore(yx,{keyPath:lP})})(e)})),r<18&&s>=18&&Bk()&&(c=c.next(()=>{t.objectStore(Du).clear()}).next(()=>{t.objectStore(Mu).clear()})),c}bi(e){let t=0;return e.store(ua).te((r,s)=>{t+=Wp(s)}).next(()=>{const r={byteSize:t};return e.store(Xu).put(xy,r)})}wi(e){const t=e.store(Yu),r=e.store(di);return t.J().next(s=>le.forEach(s,a=>{const c=IDBKeyRange.bound([a.userId,mo],[a.userId,a.lastAcknowledgedBatchId]);return r.J(ma,c).next(d=>le.forEach(d,h=>{He(h.userId===a.userId,18650,"Cannot process batch from unexpected user",{batchId:h.batchId});const m=ha(this.serializer,h);return m_(e,a.userId,m).next(()=>{})}))}))}Si(e){const t=e.store(tc),r=e.store(ua);return e.store(wa).get(Np).next(s=>{const a=[];return r.te((c,d)=>{const h=new xt(c),m=function(x){return[0,tr(x)]}(h);a.push(t.get(m).next(g=>g?le.resolve():(x=>t.put({targetId:0,path:tr(x),sequenceNumber:s.highestListenSequenceNumber}))(h)))}).next(()=>le.waitFor(a))})}Di(e,t){e.createObjectStore(Ju,{keyPath:QA});const r=t.store(Ju),s=new Bx,a=c=>{if(s.add(c)){const d=c.lastSegment(),h=c.popLast();return r.put({collectionId:d,parent:tr(h)})}};return t.store(ua).te({ee:!0},(c,d)=>{const h=new xt(c);return a(h.popLast())}).next(()=>t.store(Zl).te({ee:!0},([c,d,h],m)=>{const g=Fi(d);return a(g.popLast())}))}Ci(e){const t=e.store(ec);return t.te((r,s)=>{const a=Pu(s),c=d_(this.serializer,a);return t.put(c)})}Fi(e,t){const r=t.store(ua),s=[];return r.te((a,c)=>{const d=t.store(Fp),h=function(x){return x.document?new Fe(xt.fromString(x.document.name).popFirst(5)):x.noDocument?Fe.fromSegments(x.noDocument.path):x.unknownDocument?Fe.fromSegments(x.unknownDocument.path):Oe(36783)}(c).path.toArray(),m={prefixPath:h.slice(0,h.length-2),collectionGroup:h[h.length-2],documentId:h[h.length-1],readTime:c.readTime||[0,0],unknownDocument:c.unknownDocument,noDocument:c.noDocument,document:c.document,hasCommittedMutations:!!c.hasCommittedMutations};s.push(d.put(m))}).next(()=>le.waitFor(s))}Mi(e,t){const r=t.store(di),s=S_(this.serializer),a=new Nx(Ef.fi,this.serializer.wt);return r.J().next(c=>{const d=new Map;return c.forEach(h=>{var m;let g=(m=d.get(h.userId))!==null&&m!==void 0?m:dt();ha(this.serializer,h).keys().forEach(x=>g=g.add(x)),d.set(h.userId,g)}),le.forEach(d,(h,m)=>{const g=new Nn(m),x=jf.bt(this.serializer,g),S=a.getIndexManager(g),I=If.bt(g,this.serializer,S,a.referenceDelegate);return new k_(s,I,x,S).recalculateAndSaveOverlaysForDocumentKeys(new wy(t,wr.le),h).next()})})}}function y1(n){n.createObjectStore(tc,{keyPath:GA}).createIndex(mx,KA,{unique:!0}),n.createObjectStore(ec,{keyPath:"targetId"}).createIndex(iT,$A,{unique:!0}),n.createObjectStore(wa)}const no="IndexedDbPersistence",Mg=18e5,Lg=5e3,Og="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",T_="main";class zx{constructor(e,t,r,s,a,c,d,h,m,g,x=18){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.xi=a,this.window=c,this.document=d,this.Oi=m,this.Ni=g,this.Bi=x,this.li=null,this.hi=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Li=null,this.inForeground=!1,this.ki=null,this.qi=null,this.Qi=Number.NEGATIVE_INFINITY,this.$i=S=>Promise.resolve(),!zx.C())throw new ke(me.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new d6(this,s),this.Ui=t+T_,this.serializer=new u_(h),this.Ki=new Mi(this.Ui,this.Bi,new k6(this.serializer)),this.Pi=new e6,this.Ti=new l6(this.referenceDelegate,this.serializer),this.remoteDocumentCache=S_(this.serializer),this.Ei=new ZP,this.window&&this.window.localStorage?this.Wi=this.window.localStorage:(this.Wi=null,g===!1&&pn(no,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Gi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new ke(me.FAILED_PRECONDITION,Og);return this.zi(),this.ji(),this.Hi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Ti.getHighestSequenceNumber(e))}).then(e=>{this.li=new wr(e,this.Oi)}).then(()=>{this.hi=!0}).catch(e=>(this.Ki&&this.Ki.close(),Promise.reject(e)))}Ji(e){return this.$i=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ki.U(async t=>{t.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.xi.enqueueAndForget(async()=>{this.started&&await this.Gi()}))}Gi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>ip(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.Yi(e).next(t=>{t||(this.isPrimary=!1,this.xi.enqueueRetryable(()=>this.$i(!1)))})}).next(()=>this.Zi(e)).next(t=>this.isPrimary&&!t?this.Xi(e).next(()=>!1):!!t&&this.es(e).next(()=>!0))).catch(e=>{if(Co(e))return Te(no,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return Te(no,"Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.xi.enqueueRetryable(()=>this.$i(e)),this.isPrimary=e})}Yi(e){return ku(e).get(Il).next(t=>le.resolve(this.ts(t)))}ns(e){return ip(e).delete(this.clientId)}async rs(){if(this.isPrimary&&!this.ss(this.Qi,Mg)){this.Qi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",t=>{const r=En(t,nc);return r.J().next(s=>{const a=this._s(s,Mg),c=s.filter(d=>a.indexOf(d)===-1);return le.forEach(c,d=>r.delete(d.clientId)).next(()=>c)})}).catch(()=>[]);if(this.Wi)for(const t of e)this.Wi.removeItem(this.us(t.clientId))}}Hi(){this.qi=this.xi.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.Gi().then(()=>this.rs()).then(()=>this.Hi()))}ts(e){return!!e&&e.ownerId===this.clientId}Zi(e){return this.Ni?le.resolve(!0):ku(e).get(Il).next(t=>{if(t!==null&&this.ss(t.leaseTimestampMs,Lg)&&!this.cs(t.ownerId)){if(this.ts(t)&&this.networkEnabled)return!0;if(!this.ts(t)){if(!t.allowTabSynchronization)throw new ke(me.FAILED_PRECONDITION,Og);return!1}}return!(!this.networkEnabled||!this.inForeground)||ip(e).J().next(r=>this._s(r,Lg).find(s=>{if(this.clientId!==s.clientId){const a=!this.networkEnabled&&s.networkEnabled,c=!this.inForeground&&s.inForeground,d=this.networkEnabled===s.networkEnabled;if(a||c&&d)return!0}return!1})===void 0)}).next(t=>(this.isPrimary!==t&&Te(no,`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}async shutdown(){this.hi=!1,this.ls(),this.qi&&(this.qi.cancel(),this.qi=null),this.hs(),this.Ps(),await this.Ki.runTransaction("shutdown","readwrite",[pd,nc],e=>{const t=new wy(e,wr.le);return this.Xi(t).next(()=>this.ns(t))}),this.Ki.close(),this.Ts()}_s(e,t){return e.filter(r=>this.ss(r.updateTimeMs,t)&&!this.cs(r.clientId))}Is(){return this.runTransaction("getActiveClients","readonly",e=>ip(e).J().next(t=>this._s(t,Mg).map(r=>r.clientId)))}get started(){return this.hi}getGlobalsCache(){return this.Pi}getMutationQueue(e,t){return If.bt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Ti}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new a6(e,this.serializer.wt.databaseId)}getDocumentOverlayCache(e){return jf.bt(this.serializer,e)}getBundleCache(){return this.Ei}runTransaction(e,t,r){Te(no,"Starting transaction:",e);const s=t==="readonly"?"readonly":"readwrite",a=function(h){return h===18?dP:h===17?dT:h===16?uP:h===15?xx:h===14?uT:h===13?cT:h===12?cP:h===11?lT:void Oe(60245)}(this.Bi);let c;return this.Ki.runTransaction(e,s,a,d=>(c=new wy(d,this.li?this.li.next():wr.le),t==="readwrite-primary"?this.Yi(c).next(h=>!!h||this.Zi(c)).next(h=>{if(!h)throw pn(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.xi.enqueueRetryable(()=>this.$i(!1)),new ke(me.FAILED_PRECONDITION,Jk);return r(c)}).next(h=>this.es(c).next(()=>h)):this.Es(c).next(()=>r(c)))).then(d=>(c.raiseOnCommittedEvent(),d))}Es(e){return ku(e).get(Il).next(t=>{if(t!==null&&this.ss(t.leaseTimestampMs,Lg)&&!this.cs(t.ownerId)&&!this.ts(t)&&!(this.Ni||this.allowTabSynchronization&&t.allowTabSynchronization))throw new ke(me.FAILED_PRECONDITION,Og)})}es(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return ku(e).put(Il,t)}static C(){return Mi.C()}Xi(e){const t=ku(e);return t.get(Il).next(r=>this.ts(r)?(Te(no,"Releasing primary lease."),t.delete(Il)):le.resolve())}ss(e,t){const r=Date.now();return!(e<r-t)&&(!(e>r)||(pn(`Detected an update time that is in the future: ${e} > ${r}`),!1))}zi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.ki=()=>{this.xi.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.Gi()))},this.document.addEventListener("visibilitychange",this.ki),this.inForeground=this.document.visibilityState==="visible")}hs(){this.ki&&(this.document.removeEventListener("visibilitychange",this.ki),this.ki=null)}ji(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.Li=()=>{this.ls();const t=/(?:Version|Mobile)\/1[456]/;Pk()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.xi.enterRestrictedMode(!0),this.xi.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Li))}Ps(){this.Li&&(this.window.removeEventListener("pagehide",this.Li),this.Li=null)}cs(e){var t;try{const r=((t=this.Wi)===null||t===void 0?void 0:t.getItem(this.us(e)))!==null;return Te(no,`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return pn(no,"Failed to get zombied client id.",r),!1}}ls(){if(this.Wi)try{this.Wi.setItem(this.us(this.clientId),String(Date.now()))}catch(e){pn("Failed to set zombie client id.",e)}}Ts(){if(this.Wi)try{this.Wi.removeItem(this.us(this.clientId))}catch{}}us(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function ku(n){return En(n,pd)}function ip(n){return En(n,nc)}function Dx(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mx{constructor(e,t,r,s){this.targetId=e,this.fromCache=t,this.ds=r,this.As=s}static Rs(e,t){let r=dt(),s=dt();for(const a of t.docChanges)switch(a.type){case 0:r=r.add(a.doc.key);break;case 1:s=s.add(a.doc.key)}return new Mx(e,t.fromCache,r,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T6{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __{constructor(){this.Vs=!1,this.fs=!1,this.gs=100,this.ps=function(){return Pk()?8:eT(In())>0?6:4}()}initialize(e,t){this.ys=e,this.indexManager=t,this.Vs=!0}getDocumentsMatchingQuery(e,t,r,s){const a={result:null};return this.ws(e,t).next(c=>{a.result=c}).next(()=>{if(!a.result)return this.bs(e,t,s,r).next(c=>{a.result=c})}).next(()=>{if(a.result)return;const c=new T6;return this.Ss(e,t,c).next(d=>{if(a.result=d,this.fs)return this.Ds(e,t,c,d.size)})}).next(()=>a.result)}Ds(e,t,r,s){return r.documentReadCount<this.gs?(Ml()<=yt.DEBUG&&Te("QueryEngine","SDK will not create cache indexes for query:",Ll(t),"since it only creates cache indexes for collection contains","more than or equal to",this.gs,"documents"),le.resolve()):(Ml()<=yt.DEBUG&&Te("QueryEngine","Query:",Ll(t),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.ps*s?(Ml()<=yt.DEBUG&&Te("QueryEngine","The SDK decides to create cache indexes for query:",Ll(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,nr(t))):le.resolve())}ws(e,t){if(Vw(t))return le.resolve(null);let r=nr(t);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(t.limit!==null&&s===1&&(t=Mp(t,null,"F"),r=nr(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(a=>{const c=dt(...a);return this.ys.getDocuments(e,c).next(d=>this.indexManager.getMinOffset(e,r).next(h=>{const m=this.vs(t,d);return this.Cs(t,m,c,h.readTime)?this.ws(e,Mp(t,null,"F")):this.Fs(e,m,t,h)}))})))}bs(e,t,r,s){return Vw(t)||s.isEqual(Xe.min())?le.resolve(null):this.ys.getDocuments(e,r).next(a=>{const c=this.vs(t,a);return this.Cs(t,c,r,s)?le.resolve(null):(Ml()<=yt.DEBUG&&Te("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),Ll(t)),this.Fs(e,c,t,Yk(s,Yl)).next(d=>d))})}vs(e,t){let r=new Pt(NT(e));return t.forEach((s,a)=>{gd(e,a)&&(r=r.add(a))}),r}Cs(e,t,r,s){if(e.limit===null)return!1;if(r.size!==t.size)return!0;const a=e.limitType==="F"?t.last():t.first();return!!a&&(a.hasPendingWrites||a.version.compareTo(s)>0)}Ss(e,t,r){return Ml()<=yt.DEBUG&&Te("QueryEngine","Using full collection scan to execute query:",Ll(t)),this.ys.getDocumentsMatchingQuery(e,t,Or.min(),r)}Fs(e,t,r,s){return this.ys.getDocumentsMatchingQuery(e,r,s).next(a=>(t.forEach(c=>{a=a.insert(c.key,c)}),a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lx="LocalStore",_6=3e8;class j6{constructor(e,t,r,s){this.persistence=e,this.Ms=t,this.serializer=s,this.xs=new $t(st),this.Os=new ks(a=>Ia(a),fd),this.Ns=new Map,this.Bs=e.getRemoteDocumentCache(),this.Ti=e.getTargetCache(),this.Ei=e.getBundleCache(),this.Ls(r)}Ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new k_(this.Bs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Bs.setIndexManager(this.indexManager),this.Ms.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.xs))}}function j_(n,e,t,r){return new j6(n,e,t,r)}async function I_(n,e){const t=Be(n);return await t.persistence.runTransaction("Handle user change","readonly",r=>{let s;return t.mutationQueue.getAllMutationBatches(r).next(a=>(s=a,t.Ls(e),t.mutationQueue.getAllMutationBatches(r))).next(a=>{const c=[],d=[];let h=dt();for(const m of s){c.push(m.batchId);for(const g of m.mutations)h=h.add(g.key)}for(const m of a){d.push(m.batchId);for(const g of m.mutations)h=h.add(g.key)}return t.localDocuments.getDocuments(r,h).next(m=>({ks:m,removedBatchIds:c,addedBatchIds:d}))})})}function I6(n,e){const t=Be(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),a=t.Bs.newChangeBuffer({trackRemovals:!0});return function(d,h,m,g){const x=m.batch,S=x.keys();let I=le.resolve();return S.forEach(_=>{I=I.next(()=>g.getEntry(h,_)).next(R=>{const T=m.docVersions.get(_);He(T!==null,48541),R.version.compareTo(T)<0&&(x.applyToRemoteDocument(R,m),R.isValidDocument()&&(R.setReadTime(m.commitVersion),g.addEntry(R)))})}),I.next(()=>d.mutationQueue.removeMutationBatch(h,x))}(t,r,e,a).next(()=>a.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(d){let h=dt();for(let m=0;m<d.mutationResults.length;++m)d.mutationResults[m].transformResults.length>0&&(h=h.add(d.batch.mutations[m].key));return h}(e))).next(()=>t.localDocuments.getDocuments(r,s))})}function E_(n){const e=Be(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Ti.getLastRemoteSnapshotVersion(t))}function E6(n,e){const t=Be(n),r=e.snapshotVersion;let s=t.xs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",a=>{const c=t.Bs.newChangeBuffer({trackRemovals:!0});s=t.xs;const d=[];e.targetChanges.forEach((g,x)=>{const S=s.get(x);if(!S)return;d.push(t.Ti.removeMatchingKeys(a,g.removedDocuments,x).next(()=>t.Ti.addMatchingKeys(a,g.addedDocuments,x)));let I=S.withSequenceNumber(a.currentSequenceNumber);e.targetMismatches.get(x)!==null?I=I.withResumeToken(ln.EMPTY_BYTE_STRING,Xe.min()).withLastLimboFreeSnapshotVersion(Xe.min()):g.resumeToken.approximateByteSize()>0&&(I=I.withResumeToken(g.resumeToken,r)),s=s.insert(x,I),function(R,T,A){return R.resumeToken.approximateByteSize()===0||T.snapshotVersion.toMicroseconds()-R.snapshotVersion.toMicroseconds()>=_6?!0:A.addedDocuments.size+A.modifiedDocuments.size+A.removedDocuments.size>0}(S,I,g)&&d.push(t.Ti.updateTargetData(a,I))});let h=kr(),m=dt();if(e.documentUpdates.forEach(g=>{e.resolvedLimboDocuments.has(g)&&d.push(t.persistence.referenceDelegate.updateLimboDocument(a,g))}),d.push(C_(a,c,e.documentUpdates).next(g=>{h=g.qs,m=g.Qs})),!r.isEqual(Xe.min())){const g=t.Ti.getLastRemoteSnapshotVersion(a).next(x=>t.Ti.setTargetsMetadata(a,a.currentSequenceNumber,r));d.push(g)}return le.waitFor(d).next(()=>c.apply(a)).next(()=>t.localDocuments.getLocalViewOfDocuments(a,h,m)).next(()=>h)}).then(a=>(t.xs=s,a))}function C_(n,e,t){let r=dt(),s=dt();return t.forEach(a=>r=r.add(a)),e.getEntries(n,r).next(a=>{let c=kr();return t.forEach((d,h)=>{const m=a.get(d);h.isFoundDocument()!==m.isFoundDocument()&&(s=s.add(d)),h.isNoDocument()&&h.version.isEqual(Xe.min())?(e.removeEntry(d,h.readTime),c=c.insert(d,h)):!m.isValidDocument()||h.version.compareTo(m.version)>0||h.version.compareTo(m.version)===0&&m.hasPendingWrites?(e.addEntry(h),c=c.insert(d,h)):Te(Lx,"Ignoring outdated watch update for ",d,". Current version:",m.version," Watch version:",h.version)}),{qs:c,Qs:s}})}function C6(n,e){const t=Be(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=mo),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function cc(n,e){const t=Be(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return t.Ti.getTargetData(r,e).next(a=>a?(s=a,le.resolve(s)):t.Ti.allocateTargetId(r).next(c=>(s=new hs(e,c,"TargetPurposeListen",r.currentSequenceNumber),t.Ti.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=t.xs.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(t.xs=t.xs.insert(r.targetId,r),t.Os.set(e,r.targetId)),r})}async function uc(n,e,t){const r=Be(n),s=r.xs.get(e),a=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",a,c=>r.persistence.referenceDelegate.removeTarget(c,s))}catch(c){if(!Co(c))throw c;Te(Lx,`Failed to update sequence numbers for target ${e}: ${c}`)}r.xs=r.xs.remove(e),r.Os.delete(s.target)}function qp(n,e,t){const r=Be(n);let s=Xe.min(),a=dt();return r.persistence.runTransaction("Execute query","readwrite",c=>function(h,m,g){const x=Be(h),S=x.Os.get(g);return S!==void 0?le.resolve(x.xs.get(S)):x.Ti.getTargetData(m,g)}(r,c,nr(e)).next(d=>{if(d)return s=d.lastLimboFreeSnapshotVersion,r.Ti.getMatchingKeysForTargetId(c,d.targetId).next(h=>{a=h})}).next(()=>r.Ms.getDocumentsMatchingQuery(c,e,t?s:Xe.min(),t?a:dt())).next(d=>(P_(r,FT(e),d),{documents:d,$s:a})))}function R_(n,e){const t=Be(n),r=Be(t.Ti),s=t.xs.get(e);return s?Promise.resolve(s.target):t.persistence.runTransaction("Get target data","readonly",a=>r.Rt(a,e).next(c=>c?c.target:null))}function A_(n,e){const t=Be(n),r=t.Ns.get(e)||Xe.min();return t.persistence.runTransaction("Get new document changes","readonly",s=>t.Bs.getAllFromCollectionGroup(s,e,Yk(r,Yl),Number.MAX_SAFE_INTEGER)).then(s=>(P_(t,e,s),s))}function P_(n,e,t){let r=n.Ns.get(e)||Xe.min();t.forEach((s,a)=>{a.readTime.compareTo(r)>0&&(r=a.readTime)}),n.Ns.set(e,r)}async function R6(n,e,t,r){const s=Be(n);let a=dt(),c=kr();for(const m of t){const g=e.Us(m.metadata.name);m.document&&(a=a.add(g));const x=e.Ks(m);x.setReadTime(e.Ws(m.metadata.readTime)),c=c.insert(g,x)}const d=s.Bs.newChangeBuffer({trackRemovals:!0}),h=await cc(s,function(g){return nr(Sc(xt.fromString(`__bundle__/docs/${g}`)))}(r));return s.persistence.runTransaction("Apply bundle documents","readwrite",m=>C_(m,d,c).next(g=>(d.apply(m),g)).next(g=>s.Ti.removeMatchingKeysForTargetId(m,h.targetId).next(()=>s.Ti.addMatchingKeys(m,a,h.targetId)).next(()=>s.localDocuments.getLocalViewOfDocuments(m,g.qs,g.Qs)).next(()=>g.qs)))}async function A6(n,e,t=dt()){const r=await cc(n,nr(Ax(e.bundledQuery))),s=Be(n);return s.persistence.runTransaction("Save named query","readwrite",a=>{const c=fn(e.readTime);if(r.snapshotVersion.compareTo(c)>=0)return s.Ei.saveNamedQuery(a,e);const d=r.withResumeToken(ln.EMPTY_BYTE_STRING,c);return s.xs=s.xs.insert(d.targetId,d),s.Ti.updateTargetData(a,d).next(()=>s.Ti.removeMatchingKeysForTargetId(a,r.targetId)).next(()=>s.Ti.addMatchingKeys(a,t,r.targetId)).next(()=>s.Ei.saveNamedQuery(a,e))})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B_="firestore_clients";function x1(n,e){return`${B_}_${n}_${e}`}const F_="firestore_mutations";function b1(n,e,t){let r=`${F_}_${n}_${t}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}const N_="firestore_targets";function Vg(n,e){return`${N_}_${n}_${e}`}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pi="SharedClientState";class Hp{constructor(e,t,r,s){this.user=e,this.batchId=t,this.state=r,this.error=s}static Gs(e,t,r){const s=JSON.parse(r);let a,c=typeof s=="object"&&["pending","acknowledged","rejected"].indexOf(s.state)!==-1&&(s.error===void 0||typeof s.error=="object");return c&&s.error&&(c=typeof s.error.message=="string"&&typeof s.error.code=="string",c&&(a=new ke(s.error.code,s.error.message))),c?new Hp(e,t,s.state,a):(pn(Pi,`Failed to parse mutation state for ID '${t}': ${r}`),null)}zs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Wu{constructor(e,t,r){this.targetId=e,this.state=t,this.error=r}static Gs(e,t){const r=JSON.parse(t);let s,a=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return a&&r.error&&(a=typeof r.error.message=="string"&&typeof r.error.code=="string",a&&(s=new ke(r.error.code,r.error.message))),a?new Wu(e,r.state,s):(pn(Pi,`Failed to parse target state for ID '${e}': ${t}`),null)}zs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class $p{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Gs(e,t){const r=JSON.parse(t);let s=typeof r=="object"&&r.activeTargetIds instanceof Array,a=kx();for(let c=0;s&&c<r.activeTargetIds.length;++c)s=tT(r.activeTargetIds[c]),a=a.add(r.activeTargetIds[c]);return s?new $p(e,a):(pn(Pi,`Failed to parse client data for instance '${e}': ${t}`),null)}}class Ox{constructor(e,t){this.clientId=e,this.onlineState=t}static Gs(e){const t=JSON.parse(e);return typeof t=="object"&&["Unknown","Online","Offline"].indexOf(t.onlineState)!==-1&&typeof t.clientId=="string"?new Ox(t.clientId,t.onlineState):(pn(Pi,`Failed to parse online state: ${e}`),null)}}class Ny{constructor(){this.activeTargetIds=kx()}js(e){this.activeTargetIds=this.activeTargetIds.add(e)}Hs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}zs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Wg{constructor(e,t,r,s,a){this.window=e,this.xi=t,this.persistenceKey=r,this.Js=s,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.Ys=this.Zs.bind(this),this.Xs=new $t(st),this.started=!1,this.eo=[];const c=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=a,this.no=x1(this.persistenceKey,this.Js),this.ro=function(h){return`firestore_sequence_number_${h}`}(this.persistenceKey),this.Xs=this.Xs.insert(this.Js,new Ny),this.io=new RegExp(`^${B_}_${c}_([^_]*)$`),this.so=new RegExp(`^${F_}_${c}_(\\d+)(?:_(.*))?$`),this.oo=new RegExp(`^${N_}_${c}_(\\d+)$`),this._o=function(h){return`firestore_online_state_${h}`}(this.persistenceKey),this.ao=function(h){return`firestore_bundle_loaded_v2_${h}`}(this.persistenceKey),this.window.addEventListener("storage",this.Ys)}static C(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.Is();for(const r of e){if(r===this.Js)continue;const s=this.getItem(x1(this.persistenceKey,r));if(s){const a=$p.Gs(r,s);a&&(this.Xs=this.Xs.insert(a.clientId,a))}}this.uo();const t=this.storage.getItem(this._o);if(t){const r=this.co(t);r&&this.lo(r)}for(const r of this.eo)this.Zs(r);this.eo=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0}writeSequenceNumber(e){this.setItem(this.ro,JSON.stringify(e))}getAllActiveQueryTargets(){return this.ho(this.Xs)}isActiveQueryTarget(e){let t=!1;return this.Xs.forEach((r,s)=>{s.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this.Po(e,"pending")}updateMutationState(e,t,r){this.Po(e,t,r),this.To(e)}addLocalQueryTarget(e,t=!0){let r="not-current";if(this.isActiveQueryTarget(e)){const s=this.storage.getItem(Vg(this.persistenceKey,e));if(s){const a=Wu.Gs(e,s);a&&(r=a.state)}}return t&&this.Io.js(e),this.uo(),r}removeLocalQueryTarget(e){this.Io.Hs(e),this.uo()}isLocalQueryTarget(e){return this.Io.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(Vg(this.persistenceKey,e))}updateQueryState(e,t,r){this.Eo(e,t,r)}handleUserChange(e,t,r){t.forEach(s=>{this.To(s)}),this.currentUser=e,r.forEach(s=>{this.addPendingMutation(s)})}setOnlineState(e){this.Ao(e)}notifyBundleLoaded(e){this.Ro(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.Ys),this.removeItem(this.no),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return Te(Pi,"READ",e,t),t}setItem(e,t){Te(Pi,"SET",e,t),this.storage.setItem(e,t)}removeItem(e){Te(Pi,"REMOVE",e),this.storage.removeItem(e)}Zs(e){const t=e;if(t.storageArea===this.storage){if(Te(Pi,"EVENT",t.key,t.newValue),t.key===this.no)return void pn("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.xi.enqueueRetryable(async()=>{if(this.started){if(t.key!==null){if(this.io.test(t.key)){if(t.newValue==null){const r=this.Vo(t.key);return this.mo(r,null)}{const r=this.fo(t.key,t.newValue);if(r)return this.mo(r.clientId,r)}}else if(this.so.test(t.key)){if(t.newValue!==null){const r=this.po(t.key,t.newValue);if(r)return this.yo(r)}}else if(this.oo.test(t.key)){if(t.newValue!==null){const r=this.wo(t.key,t.newValue);if(r)return this.bo(r)}}else if(t.key===this._o){if(t.newValue!==null){const r=this.co(t.newValue);if(r)return this.lo(r)}}else if(t.key===this.ro){const r=function(a){let c=wr.le;if(a!=null)try{const d=JSON.parse(a);He(typeof d=="number",30636,{So:a}),c=d}catch(d){pn(Pi,"Failed to read sequence number from WebStorage",d)}return c}(t.newValue);r!==wr.le&&this.sequenceNumberHandler(r)}else if(t.key===this.ao){const r=this.Do(t.newValue);await Promise.all(r.map(s=>this.syncEngine.vo(s)))}}}else this.eo.push(t)})}}get Io(){return this.Xs.get(this.Js)}uo(){this.setItem(this.no,this.Io.zs())}Po(e,t,r){const s=new Hp(this.currentUser,e,t,r),a=b1(this.persistenceKey,this.currentUser,e);this.setItem(a,s.zs())}To(e){const t=b1(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Ao(e){const t={clientId:this.Js,onlineState:e};this.storage.setItem(this._o,JSON.stringify(t))}Eo(e,t,r){const s=Vg(this.persistenceKey,e),a=new Wu(e,t,r);this.setItem(s,a.zs())}Ro(e){const t=JSON.stringify(Array.from(e));this.setItem(this.ao,t)}Vo(e){const t=this.io.exec(e);return t?t[1]:null}fo(e,t){const r=this.Vo(e);return $p.Gs(r,t)}po(e,t){const r=this.so.exec(e),s=Number(r[1]),a=r[2]!==void 0?r[2]:null;return Hp.Gs(new Nn(a),s,t)}wo(e,t){const r=this.oo.exec(e),s=Number(r[1]);return Wu.Gs(s,t)}co(e){return Ox.Gs(e)}Do(e){return JSON.parse(e)}async yo(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.Co(e.batchId,e.state,e.error);Te(Pi,`Ignoring mutation for non-active user ${e.user.uid}`)}bo(e){return this.syncEngine.Fo(e.targetId,e.state,e.error)}mo(e,t){const r=t?this.Xs.insert(e,t):this.Xs.remove(e),s=this.ho(this.Xs),a=this.ho(r),c=[],d=[];return a.forEach(h=>{s.has(h)||c.push(h)}),s.forEach(h=>{a.has(h)||d.push(h)}),this.syncEngine.Mo(c,d).then(()=>{this.Xs=r})}lo(e){this.Xs.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}ho(e){let t=kx();return e.forEach((r,s)=>{t=t.unionWith(s.activeTargetIds)}),t}}class z_{constructor(){this.xo=new Ny,this.Oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.xo.js(e),this.Oo[e]||"not-current"}updateQueryState(e,t,r){this.Oo[e]=t}removeLocalQueryTarget(e){this.xo.Hs(e)}isLocalQueryTarget(e){return this.xo.activeTargetIds.has(e)}clearQueryState(e){delete this.Oo[e]}getAllActiveQueryTargets(){return this.xo.activeTargetIds}isActiveQueryTarget(e){return this.xo.activeTargetIds.has(e)}start(){return this.xo=new Ny,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P6{No(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const v1="ConnectivityMonitor";class w1{constructor(){this.Bo=()=>this.Lo(),this.ko=()=>this.qo(),this.Qo=[],this.$o()}No(e){this.Qo.push(e)}shutdown(){window.removeEventListener("online",this.Bo),window.removeEventListener("offline",this.ko)}$o(){window.addEventListener("online",this.Bo),window.addEventListener("offline",this.ko)}Lo(){Te(v1,"Network connectivity changed: AVAILABLE");for(const e of this.Qo)e(0)}qo(){Te(v1,"Network connectivity changed: UNAVAILABLE");for(const e of this.Qo)e(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let sp=null;function zy(){return sp===null?sp=function(){return 268435456+Math.round(2147483648*Math.random())}():sp++,"0x"+sp.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ug="RestConnection",B6={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class F6{get Uo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Ko=t+"://"+e.host,this.Wo=`projects/${r}/databases/${s}`,this.Go=this.databaseId.database===ed?`project_id=${r}`:`project_id=${r}&database_id=${s}`}zo(e,t,r,s,a){const c=zy(),d=this.jo(e,t.toUriEncodedString());Te(Ug,`Sending RPC '${e}' ${c}:`,d,r);const h={"google-cloud-resource-prefix":this.Wo,"x-goog-request-params":this.Go};this.Ho(h,s,a);const{host:m}=new URL(d),g=ws(m);return this.Jo(e,d,h,r,g).then(x=>(Te(Ug,`Received RPC '${e}' ${c}: `,x),x),x=>{throw Lr(Ug,`RPC '${e}' ${c} failed with error: `,x,"url: ",d,"request:",r),x})}Yo(e,t,r,s,a,c){return this.zo(e,t,r,s,a)}Ho(e,t,r){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+wc}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((s,a)=>e[a]=s),r&&r.headers.forEach((s,a)=>e[a]=s)}jo(e,t){const r=B6[e];return`${this.Ko}/v1/${t}:${r}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N6{constructor(e){this.Zo=e.Zo,this.Xo=e.Xo}e_(e){this.t_=e}n_(e){this.r_=e}i_(e){this.s_=e}onMessage(e){this.o_=e}close(){this.Xo()}send(e){this.Zo(e)}__(){this.t_()}a_(){this.r_()}u_(e){this.s_(e)}c_(e){this.o_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jn="WebChannelConnection";class z6 extends F6{constructor(e){super(e),this.l_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,r,s,a){const c=zy();return new Promise((d,h)=>{const m=new Vk;m.setWithCredentials(!0),m.listenOnce(Wk.COMPLETE,()=>{try{switch(m.getLastErrorCode()){case pp.NO_ERROR:const x=m.getResponseJson();Te(Jn,`XHR for RPC '${e}' ${c} received:`,JSON.stringify(x)),d(x);break;case pp.TIMEOUT:Te(Jn,`RPC '${e}' ${c} timed out`),h(new ke(me.DEADLINE_EXCEEDED,"Request time out"));break;case pp.HTTP_ERROR:const S=m.getStatus();if(Te(Jn,`RPC '${e}' ${c} failed with status:`,S,"response text:",m.getResponseText()),S>0){let I=m.getResponseJson();Array.isArray(I)&&(I=I[0]);const _=I==null?void 0:I.error;if(_&&_.status&&_.message){const R=function(A){const D=A.toLowerCase().replace(/_/g,"-");return Object.values(me).indexOf(D)>=0?D:me.UNKNOWN}(_.status);h(new ke(R,_.message))}else h(new ke(me.UNKNOWN,"Server responded with status "+m.getStatus()))}else h(new ke(me.UNAVAILABLE,"Connection failed."));break;default:Oe(9055,{h_:e,streamId:c,P_:m.getLastErrorCode(),T_:m.getLastError()})}}finally{Te(Jn,`RPC '${e}' ${c} completed.`)}});const g=JSON.stringify(s);Te(Jn,`RPC '${e}' ${c} sending request:`,s),m.send(t,"POST",g,r,15)})}I_(e,t,r){const s=zy(),a=[this.Ko,"/","google.firestore.v1.Firestore","/",e,"/channel"],c=Hk(),d=qk(),h={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},m=this.longPollingOptions.timeoutSeconds;m!==void 0&&(h.longPollingTimeout=Math.round(1e3*m)),this.useFetchStreams&&(h.useFetchStreams=!0),this.Ho(h.initMessageHeaders,t,r),h.encodeInitMessageHeaders=!0;const g=a.join("");Te(Jn,`Creating RPC '${e}' stream ${s}: ${g}`,h);const x=c.createWebChannel(g,h);this.E_(x);let S=!1,I=!1;const _=new N6({Zo:T=>{I?Te(Jn,`Not sending because RPC '${e}' stream ${s} is closed:`,T):(S||(Te(Jn,`Opening RPC '${e}' stream ${s} transport.`),x.open(),S=!0),Te(Jn,`RPC '${e}' stream ${s} sending:`,T),x.send(T))},Xo:()=>x.close()}),R=(T,A,D)=>{T.listen(A,F=>{try{D(F)}catch(X){setTimeout(()=>{throw X},0)}})};return R(x,Cu.EventType.OPEN,()=>{I||(Te(Jn,`RPC '${e}' stream ${s} transport opened.`),_.__())}),R(x,Cu.EventType.CLOSE,()=>{I||(I=!0,Te(Jn,`RPC '${e}' stream ${s} transport closed`),_.u_(),this.d_(x))}),R(x,Cu.EventType.ERROR,T=>{I||(I=!0,Lr(Jn,`RPC '${e}' stream ${s} transport errored. Name:`,T.name,"Message:",T.message),_.u_(new ke(me.UNAVAILABLE,"The operation could not be completed")))}),R(x,Cu.EventType.MESSAGE,T=>{var A;if(!I){const D=T.data[0];He(!!D,16349);const F=D,X=(F==null?void 0:F.error)||((A=F[0])===null||A===void 0?void 0:A.error);if(X){Te(Jn,`RPC '${e}' stream ${s} received error:`,X);const ie=X.status;let G=function(P){const M=xn[P];if(M!==void 0)return QT(M)}(ie),N=X.message;G===void 0&&(G=me.INTERNAL,N="Unknown error status: "+ie+" with message "+X.message),I=!0,_.u_(new ke(G,N)),x.close()}else Te(Jn,`RPC '${e}' stream ${s} received:`,D),_.c_(D)}}),R(d,Uk.STAT_EVENT,T=>{T.stat===py.PROXY?Te(Jn,`RPC '${e}' stream ${s} detected buffering proxy`):T.stat===py.NOPROXY&&Te(Jn,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{_.a_()},0),_}terminate(){this.l_.forEach(e=>e.close()),this.l_=[]}E_(e){this.l_.push(e)}d_(e){this.l_=this.l_.filter(t=>t===e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function D_(){return typeof window<"u"?window:null}function Sp(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vd(n){return new WP(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vx{constructor(e,t,r=1e3,s=1.5,a=6e4){this.xi=e,this.timerId=t,this.A_=r,this.R_=s,this.V_=a,this.m_=0,this.f_=null,this.g_=Date.now(),this.reset()}reset(){this.m_=0}p_(){this.m_=this.V_}y_(e){this.cancel();const t=Math.floor(this.m_+this.w_()),r=Math.max(0,Date.now()-this.g_),s=Math.max(0,t-r);s>0&&Te("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.m_} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.f_=this.xi.enqueueAfterDelay(this.timerId,s,()=>(this.g_=Date.now(),e())),this.m_*=this.R_,this.m_<this.A_&&(this.m_=this.A_),this.m_>this.V_&&(this.m_=this.V_)}b_(){this.f_!==null&&(this.f_.skipDelay(),this.f_=null)}cancel(){this.f_!==null&&(this.f_.cancel(),this.f_=null)}w_(){return(Math.random()-.5)*this.m_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const S1="PersistentStream";class M_{constructor(e,t,r,s,a,c,d,h){this.xi=e,this.S_=r,this.D_=s,this.connection=a,this.authCredentialsProvider=c,this.appCheckCredentialsProvider=d,this.listener=h,this.state=0,this.v_=0,this.C_=null,this.F_=null,this.stream=null,this.M_=0,this.x_=new Vx(e,t)}O_(){return this.state===1||this.state===5||this.N_()}N_(){return this.state===2||this.state===3}start(){this.M_=0,this.state!==4?this.auth():this.B_()}async stop(){this.O_()&&await this.close(0)}L_(){this.state=0,this.x_.reset()}k_(){this.N_()&&this.C_===null&&(this.C_=this.xi.enqueueAfterDelay(this.S_,6e4,()=>this.q_()))}Q_(e){this.U_(),this.stream.send(e)}async q_(){if(this.N_())return this.close(0)}U_(){this.C_&&(this.C_.cancel(),this.C_=null)}K_(){this.F_&&(this.F_.cancel(),this.F_=null)}async close(e,t){this.U_(),this.K_(),this.x_.cancel(),this.v_++,e!==4?this.x_.reset():t&&t.code===me.RESOURCE_EXHAUSTED?(pn(t.toString()),pn("Using maximum backoff delay to prevent overloading the backend."),this.x_.p_()):t&&t.code===me.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.i_(t)}W_(){}auth(){this.state=1;const e=this.G_(this.v_),t=this.v_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.v_===t&&this.z_(r,s)},r=>{e(()=>{const s=new ke(me.UNKNOWN,"Fetching auth token failed: "+r.message);return this.j_(s)})})}z_(e,t){const r=this.G_(this.v_);this.stream=this.H_(e,t),this.stream.e_(()=>{r(()=>this.listener.e_())}),this.stream.n_(()=>{r(()=>(this.state=2,this.F_=this.xi.enqueueAfterDelay(this.D_,1e4,()=>(this.N_()&&(this.state=3),Promise.resolve())),this.listener.n_()))}),this.stream.i_(s=>{r(()=>this.j_(s))}),this.stream.onMessage(s=>{r(()=>++this.M_==1?this.J_(s):this.onNext(s))})}B_(){this.state=5,this.x_.y_(async()=>{this.state=0,this.start()})}j_(e){return Te(S1,`close with error: ${e}`),this.stream=null,this.close(4,e)}G_(e){return t=>{this.xi.enqueueAndForget(()=>this.v_===e?t():(Te(S1,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class D6 extends M_{constructor(e,t,r,s,a,c){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,s,c),this.serializer=a}H_(e,t){return this.connection.I_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.x_.reset();const t=HP(this.serializer,e),r=function(a){if(!("targetChange"in a))return Xe.min();const c=a.targetChange;return c.targetIds&&c.targetIds.length?Xe.min():c.readTime?fn(c.readTime):Xe.min()}(e);return this.listener.Y_(t,r)}Z_(e){const t={};t.database=Ry(this.serializer),t.addTarget=function(a,c){let d;const h=c.target;if(d=zp(h)?{documents:i_(a,h)}:{query:_f(a,h).gt},d.targetId=c.targetId,c.resumeToken.approximateByteSize()>0){d.resumeToken=JT(a,c.resumeToken);const m=Ey(a,c.expectedCount);m!==null&&(d.expectedCount=m)}else if(c.snapshotVersion.compareTo(Xe.min())>0){d.readTime=lc(a,c.snapshotVersion.toTimestamp());const m=Ey(a,c.expectedCount);m!==null&&(d.expectedCount=m)}return d}(this.serializer,e);const r=GP(this.serializer,e);r&&(t.labels=r),this.Q_(t)}X_(e){const t={};t.database=Ry(this.serializer),t.removeTarget=e,this.Q_(t)}}class M6 extends M_{constructor(e,t,r,s,a,c){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,s,c),this.serializer=a}get ea(){return this.M_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.ea&&this.ta([])}H_(e,t){return this.connection.I_("Write",e,t)}J_(e){return He(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,He(!e.writeResults||e.writeResults.length===0,55816),this.listener.na()}onNext(e){He(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.x_.reset();const t=$P(e.writeResults,e.commitTime),r=fn(e.commitTime);return this.listener.ra(r,t)}ia(){const e={};e.database=Ry(this.serializer),this.Q_(e)}ta(e){const t={streamToken:this.lastStreamToken,writes:e.map(r=>sd(this.serializer,r))};this.Q_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L6{}class O6 extends L6{constructor(e,t,r,s){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=s,this.sa=!1}oa(){if(this.sa)throw new ke(me.FAILED_PRECONDITION,"The client has already been terminated.")}zo(e,t,r,s){return this.oa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,c])=>this.connection.zo(e,Cy(t,r),s,a,c)).catch(a=>{throw a.name==="FirebaseError"?(a.code===me.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new ke(me.UNKNOWN,a.toString())})}Yo(e,t,r,s,a){return this.oa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([c,d])=>this.connection.Yo(e,Cy(t,r),s,c,d,a)).catch(c=>{throw c.name==="FirebaseError"?(c.code===me.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),c):new ke(me.UNKNOWN,c.toString())})}terminate(){this.sa=!0,this.connection.terminate()}}class V6{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this._a=0,this.aa=null,this.ua=!0}ca(){this._a===0&&(this.la("Unknown"),this.aa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.aa=null,this.ha("Backend didn't respond within 10 seconds."),this.la("Offline"),Promise.resolve())))}Pa(e){this.state==="Online"?this.la("Unknown"):(this._a++,this._a>=1&&(this.Ta(),this.ha(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.la("Offline")))}set(e){this.Ta(),this._a=0,e==="Online"&&(this.ua=!1),this.la(e)}la(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ha(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.ua?(pn(t),this.ua=!1):Te("OnlineStateTracker",t)}Ta(){this.aa!==null&&(this.aa.cancel(),this.aa=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ba="RemoteStore";class W6{constructor(e,t,r,s,a){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.Ia=[],this.Ea=new Map,this.da=new Set,this.Aa=[],this.Ra=a,this.Ra.No(c=>{r.enqueueAndForget(async()=>{Ao(this)&&(Te(Ba,"Restarting streams for network reachability change."),await async function(h){const m=Be(h);m.da.add(4),await _c(m),m.Va.set("Unknown"),m.da.delete(4),await wd(m)}(this))})}),this.Va=new V6(r,s)}}async function wd(n){if(Ao(n))for(const e of n.Aa)await e(!0)}async function _c(n){for(const e of n.Aa)await e(!1)}function Cf(n,e){const t=Be(n);t.Ea.has(e.targetId)||(t.Ea.set(e.targetId,e),qx(t)?Ux(t):Ic(t).N_()&&Wx(t,e))}function dc(n,e){const t=Be(n),r=Ic(t);t.Ea.delete(e),r.N_()&&L_(t,e),t.Ea.size===0&&(r.N_()?r.k_():Ao(t)&&t.Va.set("Unknown"))}function Wx(n,e){if(n.ma.Ke(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Xe.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Ic(n).Z_(e)}function L_(n,e){n.ma.Ke(e),Ic(n).X_(e)}function Ux(n){n.ma=new MP({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),Rt:e=>n.Ea.get(e)||null,Pt:()=>n.datastore.serializer.databaseId}),Ic(n).start(),n.Va.ca()}function qx(n){return Ao(n)&&!Ic(n).O_()&&n.Ea.size>0}function Ao(n){return Be(n).da.size===0}function O_(n){n.ma=void 0}async function U6(n){n.Va.set("Online")}async function q6(n){n.Ea.forEach((e,t)=>{Wx(n,e)})}async function H6(n,e){O_(n),qx(n)?(n.Va.Pa(e),Ux(n)):n.Va.set("Unknown")}async function $6(n,e,t){if(n.Va.set("Online"),e instanceof XT&&e.state===2&&e.cause)try{await async function(s,a){const c=a.cause;for(const d of a.targetIds)s.Ea.has(d)&&(await s.remoteSyncer.rejectListen(d,c),s.Ea.delete(d),s.ma.removeTarget(d))}(n,e)}catch(r){Te(Ba,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Gp(n,r)}else if(e instanceof vp?n.ma.Xe(e):e instanceof YT?n.ma.ot(e):n.ma.nt(e),!t.isEqual(Xe.min()))try{const r=await E_(n.localStore);t.compareTo(r)>=0&&await function(a,c){const d=a.ma.It(c);return d.targetChanges.forEach((h,m)=>{if(h.resumeToken.approximateByteSize()>0){const g=a.Ea.get(m);g&&a.Ea.set(m,g.withResumeToken(h.resumeToken,c))}}),d.targetMismatches.forEach((h,m)=>{const g=a.Ea.get(h);if(!g)return;a.Ea.set(h,g.withResumeToken(ln.EMPTY_BYTE_STRING,g.snapshotVersion)),L_(a,h);const x=new hs(g.target,h,m,g.sequenceNumber);Wx(a,x)}),a.remoteSyncer.applyRemoteEvent(d)}(n,t)}catch(r){Te(Ba,"Failed to raise snapshot:",r),await Gp(n,r)}}async function Gp(n,e,t){if(!Co(e))throw e;n.da.add(1),await _c(n),n.Va.set("Offline"),t||(t=()=>E_(n.localStore)),n.asyncQueue.enqueueRetryable(async()=>{Te(Ba,"Retrying IndexedDB access"),await t(),n.da.delete(1),await wd(n)})}function V_(n,e){return e().catch(t=>Gp(n,t,e))}async function jc(n){const e=Be(n),t=ko(e);let r=e.Ia.length>0?e.Ia[e.Ia.length-1].batchId:mo;for(;G6(e);)try{const s=await C6(e.localStore,r);if(s===null){e.Ia.length===0&&t.k_();break}r=s.batchId,K6(e,s)}catch(s){await Gp(e,s)}W_(e)&&U_(e)}function G6(n){return Ao(n)&&n.Ia.length<10}function K6(n,e){n.Ia.push(e);const t=ko(n);t.N_()&&t.ea&&t.ta(e.mutations)}function W_(n){return Ao(n)&&!ko(n).O_()&&n.Ia.length>0}function U_(n){ko(n).start()}async function Q6(n){ko(n).ia()}async function Y6(n){const e=ko(n);for(const t of n.Ia)e.ta(t.mutations)}async function X6(n,e,t){const r=n.Ia.shift(),s=Ix.from(r,e,t);await V_(n,()=>n.remoteSyncer.applySuccessfulWrite(s)),await jc(n)}async function J6(n,e){e&&ko(n).ea&&await async function(r,s){if(function(c){return KT(c)&&c!==me.ABORTED}(s.code)){const a=r.Ia.shift();ko(r).L_(),await V_(r,()=>r.remoteSyncer.rejectFailedWrite(a.batchId,s)),await jc(r)}}(n,e),W_(n)&&U_(n)}async function k1(n,e){const t=Be(n);t.asyncQueue.verifyOperationInProgress(),Te(Ba,"RemoteStore received new credentials");const r=Ao(t);t.da.add(3),await _c(t),r&&t.Va.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.da.delete(3),await wd(t)}async function Dy(n,e){const t=Be(n);e?(t.da.delete(2),await wd(t)):e||(t.da.add(2),await _c(t),t.Va.set("Unknown"))}function Ic(n){return n.fa||(n.fa=function(t,r,s){const a=Be(t);return a.oa(),new D6(r,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,s)}(n.datastore,n.asyncQueue,{e_:U6.bind(null,n),n_:q6.bind(null,n),i_:H6.bind(null,n),Y_:$6.bind(null,n)}),n.Aa.push(async e=>{e?(n.fa.L_(),qx(n)?Ux(n):n.Va.set("Unknown")):(await n.fa.stop(),O_(n))})),n.fa}function ko(n){return n.ga||(n.ga=function(t,r,s){const a=Be(t);return a.oa(),new M6(r,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,s)}(n.datastore,n.asyncQueue,{e_:()=>Promise.resolve(),n_:Q6.bind(null,n),i_:J6.bind(null,n),na:Y6.bind(null,n),ra:X6.bind(null,n)}),n.Aa.push(async e=>{e?(n.ga.L_(),await jc(n)):(await n.ga.stop(),n.Ia.length>0&&(Te(Ba,`Stopping write stream with ${n.Ia.length} pending writes`),n.Ia=[]))})),n.ga}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hx{constructor(e,t,r,s,a){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=s,this.removalCallback=a,this.deferred=new zn,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(c=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,s,a){const c=Date.now()+r,d=new Hx(e,t,c,s,a);return d.start(r),d}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new ke(me.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Ec(n,e){if(pn("AsyncQueue",`${e}: ${n}`),Co(n))return new ke(me.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ql{static emptySet(e){return new ql(e.comparator)}constructor(e){this.comparator=e?(t,r)=>e(t,r)||Fe.comparator(t.key,r.key):(t,r)=>Fe.comparator(t.key,r.key),this.keyedMap=Ru(),this.sortedSet=new $t(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof ql)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const s=t.getNext().key,a=r.getNext().key;if(!s.isEqual(a))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const r=new ql;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T1{constructor(){this.pa=new $t(Fe.comparator)}track(e){const t=e.doc.key,r=this.pa.get(t);r?e.type!==0&&r.type===3?this.pa=this.pa.insert(t,e):e.type===3&&r.type!==1?this.pa=this.pa.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.pa=this.pa.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.pa=this.pa.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.pa=this.pa.remove(t):e.type===1&&r.type===2?this.pa=this.pa.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.pa=this.pa.insert(t,{type:2,doc:e.doc}):Oe(63341,{Vt:e,ya:r}):this.pa=this.pa.insert(t,e)}wa(){const e=[];return this.pa.inorderTraversal((t,r)=>{e.push(r)}),e}}class hc{constructor(e,t,r,s,a,c,d,h,m){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=a,this.fromCache=c,this.syncStateChanged=d,this.excludesMetadataChanges=h,this.hasCachedResults=m}static fromInitialDocuments(e,t,r,s,a){const c=[];return t.forEach(d=>{c.push({type:0,doc:d})}),new hc(e,t,ql.emptySet(t),c,r,s,!0,!1,a)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&md(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let s=0;s<t.length;s++)if(t[s].type!==r[s].type||!t[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z6{constructor(){this.ba=void 0,this.Sa=[]}Da(){return this.Sa.some(e=>e.va())}}class eB{constructor(){this.queries=_1(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,r){const s=Be(t),a=s.queries;s.queries=_1(),a.forEach((c,d)=>{for(const h of d.Sa)h.onError(r)})})(this,new ke(me.ABORTED,"Firestore shutting down"))}}function _1(){return new ks(n=>BT(n),md)}async function $x(n,e){const t=Be(n);let r=3;const s=e.query;let a=t.queries.get(s);a?!a.Da()&&e.va()&&(r=2):(a=new Z6,r=e.va()?0:1);try{switch(r){case 0:a.ba=await t.onListen(s,!0);break;case 1:a.ba=await t.onListen(s,!1);break;case 2:await t.onFirstRemoteStoreListen(s)}}catch(c){const d=Ec(c,`Initialization of query '${Ll(e.query)}' failed`);return void e.onError(d)}t.queries.set(s,a),a.Sa.push(e),e.Fa(t.onlineState),a.ba&&e.Ma(a.ba)&&Kx(t)}async function Gx(n,e){const t=Be(n),r=e.query;let s=3;const a=t.queries.get(r);if(a){const c=a.Sa.indexOf(e);c>=0&&(a.Sa.splice(c,1),a.Sa.length===0?s=e.va()?0:1:!a.Da()&&e.va()&&(s=2))}switch(s){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}}function tB(n,e){const t=Be(n);let r=!1;for(const s of e){const a=s.query,c=t.queries.get(a);if(c){for(const d of c.Sa)d.Ma(s)&&(r=!0);c.ba=s}}r&&Kx(t)}function nB(n,e,t){const r=Be(n),s=r.queries.get(e);if(s)for(const a of s.Sa)a.onError(t);r.queries.delete(e)}function Kx(n){n.Ca.forEach(e=>{e.next()})}var My,j1;(j1=My||(My={})).xa="default",j1.Cache="cache";class Qx{constructor(e,t,r){this.query=e,this.Oa=t,this.Na=!1,this.Ba=null,this.onlineState="Unknown",this.options=r||{}}Ma(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new hc(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Na?this.La(e)&&(this.Oa.next(e),t=!0):this.ka(e,this.onlineState)&&(this.qa(e),t=!0),this.Ba=e,t}onError(e){this.Oa.error(e)}Fa(e){this.onlineState=e;let t=!1;return this.Ba&&!this.Na&&this.ka(this.Ba,e)&&(this.qa(this.Ba),t=!0),t}ka(e,t){if(!e.fromCache||!this.va())return!0;const r=t!=="Offline";return(!this.options.Qa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}La(e){if(e.docChanges.length>0)return!0;const t=this.Ba&&this.Ba.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}qa(e){e=hc.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Na=!0,this.Oa.next(e)}va(){return this.options.source!==My.Cache}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rB{constructor(e,t){this.$a=e,this.byteLength=t}Ua(){return"metadata"in this.$a}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I1{constructor(e){this.serializer=e}Us(e){return Li(this.serializer,e)}Ks(e){return e.metadata.exists?r_(this.serializer,e.document,!1):Yt.newNoDocument(this.Us(e.metadata.name),this.Ws(e.metadata.readTime))}Ws(e){return fn(e)}}class iB{constructor(e,t,r){this.Ka=e,this.localStore=t,this.serializer=r,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=q_(e)}Wa(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.$a.namedQuery)this.queries.push(e.$a.namedQuery);else if(e.$a.documentMetadata){this.documents.push({metadata:e.$a.documentMetadata}),e.$a.documentMetadata.exists||++t;const r=xt.fromString(e.$a.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.$a.document&&(this.documents[this.documents.length-1].document=e.$a.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}Ga(e){const t=new Map,r=new I1(this.serializer);for(const s of e)if(s.metadata.queries){const a=r.Us(s.metadata.name);for(const c of s.metadata.queries){const d=(t.get(c)||dt()).add(a);t.set(c,d)}}return t}async complete(){const e=await R6(this.localStore,new I1(this.serializer),this.documents,this.Ka.id),t=this.Ga(this.documents);for(const r of this.queries)await A6(this.localStore,r,t.get(r.name));return this.progress.taskState="Success",{progress:this.progress,za:this.collectionGroups,ja:e}}}function q_(n){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:n.totalDocuments,totalBytes:n.totalBytes}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H_{constructor(e){this.key=e}}class $_{constructor(e){this.key=e}}class G_{constructor(e,t){this.query=e,this.Ha=t,this.Ja=null,this.hasCachedResults=!1,this.current=!1,this.Ya=dt(),this.mutatedKeys=dt(),this.Za=NT(e),this.Xa=new ql(this.Za)}get eu(){return this.Ha}tu(e,t){const r=t?t.nu:new T1,s=t?t.Xa:this.Xa;let a=t?t.mutatedKeys:this.mutatedKeys,c=s,d=!1;const h=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,m=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((g,x)=>{const S=s.get(g),I=gd(this.query,x)?x:null,_=!!S&&this.mutatedKeys.has(S.key),R=!!I&&(I.hasLocalMutations||this.mutatedKeys.has(I.key)&&I.hasCommittedMutations);let T=!1;S&&I?S.data.isEqual(I.data)?_!==R&&(r.track({type:3,doc:I}),T=!0):this.ru(S,I)||(r.track({type:2,doc:I}),T=!0,(h&&this.Za(I,h)>0||m&&this.Za(I,m)<0)&&(d=!0)):!S&&I?(r.track({type:0,doc:I}),T=!0):S&&!I&&(r.track({type:1,doc:S}),T=!0,(h||m)&&(d=!0)),T&&(I?(c=c.add(I),a=R?a.add(g):a.delete(g)):(c=c.delete(g),a=a.delete(g)))}),this.query.limit!==null)for(;c.size>this.query.limit;){const g=this.query.limitType==="F"?c.last():c.first();c=c.delete(g.key),a=a.delete(g.key),r.track({type:1,doc:g})}return{Xa:c,nu:r,Cs:d,mutatedKeys:a}}ru(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,s){const a=this.Xa;this.Xa=e.Xa,this.mutatedKeys=e.mutatedKeys;const c=e.nu.wa();c.sort((g,x)=>function(I,_){const R=T=>{switch(T){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Oe(20277,{Vt:T})}};return R(I)-R(_)}(g.type,x.type)||this.Za(g.doc,x.doc)),this.iu(r),s=s!=null&&s;const d=t&&!s?this.su():[],h=this.Ya.size===0&&this.current&&!s?1:0,m=h!==this.Ja;return this.Ja=h,c.length!==0||m?{snapshot:new hc(this.query,e.Xa,a,c,e.mutatedKeys,h===0,m,!1,!!r&&r.resumeToken.approximateByteSize()>0),ou:d}:{ou:d}}Fa(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Xa:this.Xa,nu:new T1,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{ou:[]}}_u(e){return!this.Ha.has(e)&&!!this.Xa.has(e)&&!this.Xa.get(e).hasLocalMutations}iu(e){e&&(e.addedDocuments.forEach(t=>this.Ha=this.Ha.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ha=this.Ha.delete(t)),this.current=e.current)}su(){if(!this.current)return[];const e=this.Ya;this.Ya=dt(),this.Xa.forEach(r=>{this._u(r.key)&&(this.Ya=this.Ya.add(r.key))});const t=[];return e.forEach(r=>{this.Ya.has(r)||t.push(new $_(r))}),this.Ya.forEach(r=>{e.has(r)||t.push(new H_(r))}),t}au(e){this.Ha=e.$s,this.Ya=dt();const t=this.tu(e.documents);return this.applyChanges(t,!0)}uu(){return hc.fromInitialDocuments(this.query,this.Xa,this.mutatedKeys,this.Ja===0,this.hasCachedResults)}}const Po="SyncEngine";class sB{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class oB{constructor(e){this.key=e,this.cu=!1}}class aB{constructor(e,t,r,s,a,c){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=s,this.currentUser=a,this.maxConcurrentLimboResolutions=c,this.lu={},this.hu=new ks(d=>BT(d),md),this.Pu=new Map,this.Tu=new Set,this.Iu=new $t(Fe.comparator),this.Eu=new Map,this.du=new Fx,this.Au={},this.Ru=new Map,this.Vu=Pa.lr(),this.onlineState="Unknown",this.mu=void 0}get isPrimaryClient(){return this.mu===!0}}async function lB(n,e,t=!0){const r=Rf(n);let s;const a=r.hu.get(e);return a?(r.sharedClientState.addLocalQueryTarget(a.targetId),s=a.view.uu()):s=await K_(r,e,t,!0),s}async function cB(n,e){const t=Rf(n);await K_(t,e,!0,!1)}async function K_(n,e,t,r){const s=await cc(n.localStore,nr(e)),a=s.targetId,c=n.sharedClientState.addLocalQueryTarget(a,t);let d;return r&&(d=await Yx(n,e,a,c==="current",s.resumeToken)),n.isPrimaryClient&&t&&Cf(n.remoteStore,s),d}async function Yx(n,e,t,r,s){n.fu=(x,S,I)=>async function(R,T,A,D){let F=T.view.tu(A);F.Cs&&(F=await qp(R.localStore,T.query,!1).then(({documents:N})=>T.view.tu(N,F)));const X=D&&D.targetChanges.get(T.targetId),ie=D&&D.targetMismatches.get(T.targetId)!=null,G=T.view.applyChanges(F,R.isPrimaryClient,X,ie);return Ly(R,T.targetId,G.ou),G.snapshot}(n,x,S,I);const a=await qp(n.localStore,e,!0),c=new G_(e,a.$s),d=c.tu(a.documents),h=bd.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",s),m=c.applyChanges(d,n.isPrimaryClient,h);Ly(n,t,m.ou);const g=new sB(e,t,c);return n.hu.set(e,g),n.Pu.has(t)?n.Pu.get(t).push(e):n.Pu.set(t,[e]),m.snapshot}async function uB(n,e,t){const r=Be(n),s=r.hu.get(e),a=r.Pu.get(s.targetId);if(a.length>1)return r.Pu.set(s.targetId,a.filter(c=>!md(c,e))),void r.hu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await uc(r.localStore,s.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(s.targetId),t&&dc(r.remoteStore,s.targetId),pc(r,s.targetId)}).catch(Eo)):(pc(r,s.targetId),await uc(r.localStore,s.targetId,!0))}async function dB(n,e){const t=Be(n),r=t.hu.get(e),s=t.Pu.get(r.targetId);t.isPrimaryClient&&s.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),dc(t.remoteStore,r.targetId))}async function hB(n,e,t){const r=e0(n);try{const s=await function(c,d){const h=Be(c),m=Lt.now(),g=d.reduce((I,_)=>I.add(_.key),dt());let x,S;return h.persistence.runTransaction("Locally write mutations","readwrite",I=>{let _=kr(),R=dt();return h.Bs.getEntries(I,g).next(T=>{_=T,_.forEach((A,D)=>{D.isValidDocument()||(R=R.add(A))})}).next(()=>h.localDocuments.getOverlayedDocuments(I,_)).next(T=>{x=T;const A=[];for(const D of d){const F=NP(D,x.get(D.key).overlayedDocument);F!=null&&A.push(new Ts(D.key,F,ST(F.value.mapValue),rn.exists(!0)))}return h.mutationQueue.addMutationBatch(I,m,A,d)}).next(T=>{S=T;const A=T.applyToLocalDocumentSet(x,R);return h.documentOverlayCache.saveOverlays(I,T.batchId,A)})}).then(()=>({batchId:S.batchId,changes:DT(x)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(c,d,h){let m=c.Au[c.currentUser.toKey()];m||(m=new $t(st)),m=m.insert(d,h),c.Au[c.currentUser.toKey()]=m}(r,s.batchId,t),await _s(r,s.changes),await jc(r.remoteStore)}catch(s){const a=Ec(s,"Failed to persist write");t.reject(a)}}async function Q_(n,e){const t=Be(n);try{const r=await E6(t.localStore,e);e.targetChanges.forEach((s,a)=>{const c=t.Eu.get(a);c&&(He(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1,22616),s.addedDocuments.size>0?c.cu=!0:s.modifiedDocuments.size>0?He(c.cu,14607):s.removedDocuments.size>0&&(He(c.cu,42227),c.cu=!1))}),await _s(t,r,e)}catch(r){await Eo(r)}}function E1(n,e,t){const r=Be(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){const s=[];r.hu.forEach((a,c)=>{const d=c.view.Fa(e);d.snapshot&&s.push(d.snapshot)}),function(c,d){const h=Be(c);h.onlineState=d;let m=!1;h.queries.forEach((g,x)=>{for(const S of x.Sa)S.Fa(d)&&(m=!0)}),m&&Kx(h)}(r.eventManager,e),s.length&&r.lu.Y_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function pB(n,e,t){const r=Be(n);r.sharedClientState.updateQueryState(e,"rejected",t);const s=r.Eu.get(e),a=s&&s.key;if(a){let c=new $t(Fe.comparator);c=c.insert(a,Yt.newNoDocument(a,Xe.min()));const d=dt().add(a),h=new xd(Xe.min(),new Map,new $t(st),c,d);await Q_(r,h),r.Iu=r.Iu.remove(a),r.Eu.delete(e),Zx(r)}else await uc(r.localStore,e,!1).then(()=>pc(r,e,t)).catch(Eo)}async function fB(n,e){const t=Be(n),r=e.batch.batchId;try{const s=await I6(t.localStore,e);Jx(t,r,null),Xx(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await _s(t,s)}catch(s){await Eo(s)}}async function mB(n,e,t){const r=Be(n);try{const s=await function(c,d){const h=Be(c);return h.persistence.runTransaction("Reject batch","readwrite-primary",m=>{let g;return h.mutationQueue.lookupMutationBatch(m,d).next(x=>(He(x!==null,37113),g=x.keys(),h.mutationQueue.removeMutationBatch(m,x))).next(()=>h.mutationQueue.performConsistencyCheck(m)).next(()=>h.documentOverlayCache.removeOverlaysForBatchId(m,g,d)).next(()=>h.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(m,g)).next(()=>h.localDocuments.getDocuments(m,g))})}(r.localStore,e);Jx(r,e,t),Xx(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await _s(r,s)}catch(s){await Eo(s)}}async function gB(n,e){const t=Be(n);Ao(t.remoteStore)||Te(Po,"The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const r=await function(c){const d=Be(c);return d.persistence.runTransaction("Get highest unacknowledged batch id","readonly",h=>d.mutationQueue.getHighestUnacknowledgedBatchId(h))}(t.localStore);if(r===mo)return void e.resolve();const s=t.Ru.get(r)||[];s.push(e),t.Ru.set(r,s)}catch(r){const s=Ec(r,"Initialization of waitForPendingWrites() operation failed");e.reject(s)}}function Xx(n,e){(n.Ru.get(e)||[]).forEach(t=>{t.resolve()}),n.Ru.delete(e)}function Jx(n,e,t){const r=Be(n);let s=r.Au[r.currentUser.toKey()];if(s){const a=s.get(e);a&&(t?a.reject(t):a.resolve(),s=s.remove(e)),r.Au[r.currentUser.toKey()]=s}}function pc(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.Pu.get(e))n.hu.delete(r),t&&n.lu.gu(r,t);n.Pu.delete(e),n.isPrimaryClient&&n.du.Hr(e).forEach(r=>{n.du.containsKey(r)||Y_(n,r)})}function Y_(n,e){n.Tu.delete(e.path.canonicalString());const t=n.Iu.get(e);t!==null&&(dc(n.remoteStore,t),n.Iu=n.Iu.remove(e),n.Eu.delete(t),Zx(n))}function Ly(n,e,t){for(const r of t)r instanceof H_?(n.du.addReference(r.key,e),yB(n,r)):r instanceof $_?(Te(Po,"Document no longer in limbo: "+r.key),n.du.removeReference(r.key,e),n.du.containsKey(r.key)||Y_(n,r.key)):Oe(19791,{pu:r})}function yB(n,e){const t=e.key,r=t.path.canonicalString();n.Iu.get(t)||n.Tu.has(r)||(Te(Po,"New document in limbo: "+t),n.Tu.add(r),Zx(n))}function Zx(n){for(;n.Tu.size>0&&n.Iu.size<n.maxConcurrentLimboResolutions;){const e=n.Tu.values().next().value;n.Tu.delete(e);const t=new Fe(xt.fromString(e)),r=n.Vu.next();n.Eu.set(r,new oB(t)),n.Iu=n.Iu.insert(t,r),Cf(n.remoteStore,new hs(nr(Sc(t.path)),r,"TargetPurposeLimboResolution",wr.le))}}async function _s(n,e,t){const r=Be(n),s=[],a=[],c=[];r.hu.isEmpty()||(r.hu.forEach((d,h)=>{c.push(r.fu(h,e,t).then(m=>{var g;if((m||t)&&r.isPrimaryClient){const x=m?!m.fromCache:(g=t==null?void 0:t.targetChanges.get(h.targetId))===null||g===void 0?void 0:g.current;r.sharedClientState.updateQueryState(h.targetId,x?"current":"not-current")}if(m){s.push(m);const x=Mx.Rs(h.targetId,m);a.push(x)}}))}),await Promise.all(c),r.lu.Y_(s),await async function(h,m){const g=Be(h);try{await g.persistence.runTransaction("notifyLocalViewChanges","readwrite",x=>le.forEach(m,S=>le.forEach(S.ds,I=>g.persistence.referenceDelegate.addReference(x,S.targetId,I)).next(()=>le.forEach(S.As,I=>g.persistence.referenceDelegate.removeReference(x,S.targetId,I)))))}catch(x){if(!Co(x))throw x;Te(Lx,"Failed to update sequence numbers: "+x)}for(const x of m){const S=x.targetId;if(!x.fromCache){const I=g.xs.get(S),_=I.snapshotVersion,R=I.withLastLimboFreeSnapshotVersion(_);g.xs=g.xs.insert(S,R)}}}(r.localStore,a))}async function xB(n,e){const t=Be(n);if(!t.currentUser.isEqual(e)){Te(Po,"User change. New user:",e.toKey());const r=await I_(t.localStore,e);t.currentUser=e,function(a,c){a.Ru.forEach(d=>{d.forEach(h=>{h.reject(new ke(me.CANCELLED,c))})}),a.Ru.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await _s(t,r.ks)}}function bB(n,e){const t=Be(n),r=t.Eu.get(e);if(r&&r.cu)return dt().add(r.key);{let s=dt();const a=t.Pu.get(e);if(!a)return s;for(const c of a){const d=t.hu.get(c);s=s.unionWith(d.view.eu)}return s}}async function vB(n,e){const t=Be(n),r=await qp(t.localStore,e.query,!0),s=e.view.au(r);return t.isPrimaryClient&&Ly(t,e.targetId,s.ou),s}async function wB(n,e){const t=Be(n);return A_(t.localStore,e).then(r=>_s(t,r))}async function SB(n,e,t,r){const s=Be(n),a=await function(d,h){const m=Be(d),g=Be(m.mutationQueue);return m.persistence.runTransaction("Lookup mutation documents","readonly",x=>g.tr(x,h).next(S=>S?m.localDocuments.getDocuments(x,S):le.resolve(null)))}(s.localStore,e);a!==null?(t==="pending"?await jc(s.remoteStore):t==="acknowledged"||t==="rejected"?(Jx(s,e,r||null),Xx(s,e),function(d,h){Be(Be(d).mutationQueue).sr(h)}(s.localStore,e)):Oe(6720,"Unknown batchState",{yu:t}),await _s(s,a)):Te(Po,"Cannot apply mutation batch with id: "+e)}async function kB(n,e){const t=Be(n);if(Rf(t),e0(t),e===!0&&t.mu!==!0){const r=t.sharedClientState.getAllActiveQueryTargets(),s=await C1(t,r.toArray());t.mu=!0,await Dy(t.remoteStore,!0);for(const a of s)Cf(t.remoteStore,a)}else if(e===!1&&t.mu!==!1){const r=[];let s=Promise.resolve();t.Pu.forEach((a,c)=>{t.sharedClientState.isLocalQueryTarget(c)?r.push(c):s=s.then(()=>(pc(t,c),uc(t.localStore,c,!0))),dc(t.remoteStore,c)}),await s,await C1(t,r),function(c){const d=Be(c);d.Eu.forEach((h,m)=>{dc(d.remoteStore,m)}),d.du.Jr(),d.Eu=new Map,d.Iu=new $t(Fe.comparator)}(t),t.mu=!1,await Dy(t.remoteStore,!1)}}async function C1(n,e,t){const r=Be(n),s=[],a=[];for(const c of e){let d;const h=r.Pu.get(c);if(h&&h.length!==0){d=await cc(r.localStore,nr(h[0]));for(const m of h){const g=r.hu.get(m),x=await vB(r,g);x.snapshot&&a.push(x.snapshot)}}else{const m=await R_(r.localStore,c);d=await cc(r.localStore,m),await Yx(r,X_(m),c,!1,d.resumeToken)}s.push(d)}return r.lu.Y_(a),s}function X_(n){return RT(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function TB(n){return function(t){return Be(Be(t).persistence).Is()}(Be(n).localStore)}async function _B(n,e,t,r){const s=Be(n);if(s.mu)return void Te(Po,"Ignoring unexpected query state notification.");const a=s.Pu.get(e);if(a&&a.length>0)switch(t){case"current":case"not-current":{const c=await A_(s.localStore,FT(a[0])),d=xd.createSynthesizedRemoteEventForCurrentChange(e,t==="current",ln.EMPTY_BYTE_STRING);await _s(s,c,d);break}case"rejected":await uc(s.localStore,e,!0),pc(s,e,r);break;default:Oe(64155,t)}}async function jB(n,e,t){const r=Rf(n);if(r.mu){for(const s of e){if(r.Pu.has(s)&&r.sharedClientState.isActiveQueryTarget(s)){Te(Po,"Adding an already active target "+s);continue}const a=await R_(r.localStore,s),c=await cc(r.localStore,a);await Yx(r,X_(a),c.targetId,!1,c.resumeToken),Cf(r.remoteStore,c)}for(const s of t)r.Pu.has(s)&&await uc(r.localStore,s,!1).then(()=>{dc(r.remoteStore,s),pc(r,s)}).catch(Eo)}}function Rf(n){const e=Be(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=Q_.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=bB.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=pB.bind(null,e),e.lu.Y_=tB.bind(null,e.eventManager),e.lu.gu=nB.bind(null,e.eventManager),e}function e0(n){const e=Be(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=fB.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=mB.bind(null,e),e}function IB(n,e,t){const r=Be(n);(async function(a,c,d){try{const h=await c.getMetadata();if(await function(I,_){const R=Be(I),T=fn(_.createTime);return R.persistence.runTransaction("hasNewerBundle","readonly",A=>R.Ei.getBundleMetadata(A,_.id)).then(A=>!!A&&A.createTime.compareTo(T)>=0)}(a.localStore,h))return await c.close(),d._completeWith(function(I){return{taskState:"Success",documentsLoaded:I.totalDocuments,bytesLoaded:I.totalBytes,totalDocuments:I.totalDocuments,totalBytes:I.totalBytes}}(h)),Promise.resolve(new Set);d._updateProgress(q_(h));const m=new iB(h,a.localStore,c.serializer);let g=await c.wu();for(;g;){const S=await m.Wa(g);S&&d._updateProgress(S),g=await c.wu()}const x=await m.complete();return await _s(a,x.ja,void 0),await function(I,_){const R=Be(I);return R.persistence.runTransaction("Save bundle","readwrite",T=>R.Ei.saveBundleMetadata(T,_))}(a.localStore,h),d._completeWith(x.progress),Promise.resolve(x.za)}catch(h){return Lr(Po,`Loading bundle failed with ${h}`),d._failWith(h),Promise.resolve(new Set)}})(r,e,t).then(s=>{r.sharedClientState.notifyBundleLoaded(s)})}class fc{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=vd(e.databaseInfo.databaseId),this.sharedClientState=this.bu(e),this.persistence=this.Su(e),await this.persistence.start(),this.localStore=this.Du(e),this.gcScheduler=this.vu(e,this.localStore),this.indexBackfillerScheduler=this.Cu(e,this.localStore)}vu(e,t){return null}Cu(e,t){return null}Du(e){return j_(this.persistence,new __,e.initialUser,this.serializer)}Su(e){return new Nx(Ef.fi,this.serializer)}bu(e){return new z_}async terminate(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}fc.provider={build:()=>new fc};class t0 extends fc{constructor(e){super(),this.cacheSizeBytes=e}vu(e,t){He(this.persistence.referenceDelegate instanceof Up,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new b_(r,e.asyncQueue,t)}Su(e){const t=this.cacheSizeBytes!==void 0?Zn.withCacheSize(this.cacheSizeBytes):Zn.DEFAULT;return new Nx(r=>Up.fi(r,t),this.serializer)}}class n0 extends fc{constructor(e,t,r){super(),this.Fu=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.Fu.initialize(this,e),await e0(this.Fu.syncEngine),await jc(this.Fu.remoteStore),await this.persistence.Ji(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}Du(e){return j_(this.persistence,new __,e.initialUser,this.serializer)}vu(e,t){const r=this.persistence.referenceDelegate.garbageCollector;return new b_(r,e.asyncQueue,t)}Cu(e,t){const r=new LA(t,this.persistence);return new MA(e.asyncQueue,r)}Su(e){const t=Dx(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?Zn.withCacheSize(this.cacheSizeBytes):Zn.DEFAULT;return new zx(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,D_(),Sp(),this.serializer,this.sharedClientState,!!this.forceOwnership)}bu(e){return new z_}}class J_ extends n0{constructor(e,t){super(e,t,!1),this.Fu=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const t=this.Fu.syncEngine;this.sharedClientState instanceof Wg&&(this.sharedClientState.syncEngine={Co:SB.bind(null,t),Fo:_B.bind(null,t),Mo:jB.bind(null,t),Is:TB.bind(null,t),vo:wB.bind(null,t)},await this.sharedClientState.start()),await this.persistence.Ji(async r=>{await kB(this.Fu.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())})}bu(e){const t=D_();if(!Wg.C(t))throw new ke(me.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const r=Dx(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new Wg(t,e.asyncQueue,r,e.clientId,e.initialUser)}}class To{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>E1(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=xB.bind(null,this.syncEngine),await Dy(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new eB}()}createDatastore(e){const t=vd(e.databaseInfo.databaseId),r=function(a){return new z6(a)}(e.databaseInfo);return function(a,c,d,h){return new O6(a,c,d,h)}(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return function(r,s,a,c,d){return new W6(r,s,a,c,d)}(this.localStore,this.datastore,e.asyncQueue,t=>E1(this.syncEngine,t,0),function(){return w1.C()?new w1:new P6}())}createSyncEngine(e,t){return function(s,a,c,d,h,m,g){const x=new aB(s,a,c,d,h,m);return g&&(x.mu=!0),x}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(s){const a=Be(s);Te(Ba,"RemoteStore shutting down."),a.da.add(5),await _c(a),a.Ra.shutdown(),a.Va.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(t=this.eventManager)===null||t===void 0||t.terminate()}}To.provider={build:()=>new To};function R1(n,e=10240){let t=0;return{async read(){if(t<n.byteLength){const r={value:n.slice(t,t+e),done:!1};return t+=e,r}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Af{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Mu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Mu(this.observer.error,e):pn("Uncaught Error in snapshot listener:",e.toString()))}xu(){this.muted=!0}Mu(e,t){setTimeout(()=>{this.muted||e(t)},0)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EB{constructor(e,t){this.Ou=e,this.serializer=t,this.metadata=new zn,this.buffer=new Uint8Array,this.Nu=function(){return new TextDecoder("utf-8")}(),this.Bu().then(r=>{r&&r.Ua()?this.metadata.resolve(r.$a.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(r==null?void 0:r.$a)}`))},r=>this.metadata.reject(r))}close(){return this.Ou.cancel()}async getMetadata(){return this.metadata.promise}async wu(){return await this.getMetadata(),this.Bu()}async Bu(){const e=await this.Lu();if(e===null)return null;const t=this.Nu.decode(e),r=Number(t);isNaN(r)&&this.ku(`length string (${t}) is not valid number`);const s=await this.qu(r);return new rB(JSON.parse(s),e.length+r)}Qu(){return this.buffer.findIndex(e=>e===123)}async Lu(){for(;this.Qu()<0&&!await this.$u(););if(this.buffer.length===0)return null;const e=this.Qu();e<0&&this.ku("Reached the end of bundle when a length string is expected.");const t=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),t}async qu(e){for(;this.buffer.length<e;)await this.$u()&&this.ku("Reached the end of bundle when more is expected.");const t=this.Nu.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),t}ku(e){throw this.Ou.cancel(),new Error(`Invalid bundle format: ${e}`)}async $u(){const e=await this.Ou.read();if(!e.done){const t=new Uint8Array(this.buffer.length+e.value.length);t.set(this.buffer),t.set(e.value,this.buffer.length),this.buffer=t}return e.done}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CB{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new ke(me.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const t=await async function(s,a){const c=Be(s),d={documents:a.map(x=>id(c.serializer,x))},h=await c.Yo("BatchGetDocuments",c.serializer.databaseId,xt.emptyPath(),d,a.length),m=new Map;h.forEach(x=>{const S=qP(c.serializer,x);m.set(S.key.toString(),S)});const g=[];return a.forEach(x=>{const S=m.get(x.toString());He(!!S,55234,{key:x}),g.push(S)}),g}(this.datastore,e);return t.forEach(r=>this.recordVersion(r)),t}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastTransactionError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new Tc(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach(t=>{e.delete(t.key.toString())}),e.forEach((t,r)=>{const s=Fe.fromPath(r);this.mutations.push(new _x(s,this.precondition(s)))}),await async function(r,s){const a=Be(r),c={writes:s.map(d=>sd(a.serializer,d))};await a.zo("Commit",a.serializer.databaseId,xt.emptyPath(),c)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw Oe(50498,{Uu:e.constructor.name});t=Xe.min()}const r=this.readVersions.get(e.key.toString());if(r){if(!t.isEqual(r))throw new ke(me.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(Xe.min())?rn.exists(!1):rn.updateTime(t):rn.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(Xe.min()))throw new ke(me.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return rn.updateTime(t)}return rn.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RB{constructor(e,t,r,s,a){this.asyncQueue=e,this.datastore=t,this.options=r,this.updateFunction=s,this.deferred=a,this.Ku=r.maxAttempts,this.x_=new Vx(this.asyncQueue,"transaction_retry")}Wu(){this.Ku-=1,this.Gu()}Gu(){this.x_.y_(async()=>{const e=new CB(this.datastore),t=this.zu(e);t&&t.then(r=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(r)}).catch(s=>{this.ju(s)}))}).catch(r=>{this.ju(r)})})}zu(e){try{const t=this.updateFunction(e);return!hd(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}ju(e){this.Ku>0&&this.Hu(e)?(this.Ku-=1,this.asyncQueue.enqueueAndForget(()=>(this.Gu(),Promise.resolve()))):this.deferred.reject(e)}Hu(e){if(e.name==="FirebaseError"){const t=e.code;return t==="aborted"||t==="failed-precondition"||t==="already-exists"||!KT(t)}return!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _o="FirestoreClient";class AB{constructor(e,t,r,s,a){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=s,this.user=Nn.UNAUTHENTICATED,this.clientId=hx.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=a,this.authCredentials.start(r,async c=>{Te(_o,"Received user=",c.uid),await this.authCredentialListener(c),this.user=c}),this.appCheckCredentials.start(r,c=>(Te(_o,"Received new app check token=",c),this.appCheckCredentialListener(c,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new zn;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const r=Ec(t,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function qg(n,e){n.asyncQueue.verifyOperationInProgress(),Te(_o,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(async s=>{r.isEqual(s)||(await I_(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e}async function A1(n,e){n.asyncQueue.verifyOperationInProgress();const t=await r0(n);Te(_o,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>k1(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,s)=>k1(e.remoteStore,s)),n._onlineComponents=e}async function r0(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){Te(_o,"Using user provided OfflineComponentProvider");try{await qg(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!function(s){return s.name==="FirebaseError"?s.code===me.FAILED_PRECONDITION||s.code===me.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(t))throw t;Lr("Error using user provided cache. Falling back to memory cache: "+t),await qg(n,new fc)}}else Te(_o,"Using default OfflineComponentProvider"),await qg(n,new t0(void 0));return n._offlineComponents}async function Pf(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(Te(_o,"Using user provided OnlineComponentProvider"),await A1(n,n._uninitializedComponentsProvider._online)):(Te(_o,"Using default OnlineComponentProvider"),await A1(n,new To))),n._onlineComponents}function Z_(n){return r0(n).then(e=>e.persistence)}function Cc(n){return r0(n).then(e=>e.localStore)}function e2(n){return Pf(n).then(e=>e.remoteStore)}function i0(n){return Pf(n).then(e=>e.syncEngine)}function t2(n){return Pf(n).then(e=>e.datastore)}async function mc(n){const e=await Pf(n),t=e.eventManager;return t.onListen=lB.bind(null,e.syncEngine),t.onUnlisten=uB.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=cB.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=dB.bind(null,e.syncEngine),t}function PB(n){return n.asyncQueue.enqueue(async()=>{const e=await Z_(n),t=await e2(n);return e.setNetworkEnabled(!0),function(s){const a=Be(s);return a.da.delete(0),wd(a)}(t)})}function BB(n){return n.asyncQueue.enqueue(async()=>{const e=await Z_(n),t=await e2(n);return e.setNetworkEnabled(!1),async function(s){const a=Be(s);a.da.add(0),await _c(a),a.Va.set("Offline")}(t)})}function FB(n,e){const t=new zn;return n.asyncQueue.enqueueAndForget(async()=>async function(s,a,c){try{const d=await function(m,g){const x=Be(m);return x.persistence.runTransaction("read document","readonly",S=>x.localDocuments.getDocument(S,g))}(s,a);d.isFoundDocument()?c.resolve(d):d.isNoDocument()?c.resolve(null):c.reject(new ke(me.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(d){const h=Ec(d,`Failed to get document '${a} from cache`);c.reject(h)}}(await Cc(n),e,t)),t.promise}function n2(n,e,t={}){const r=new zn;return n.asyncQueue.enqueueAndForget(async()=>function(a,c,d,h,m){const g=new Af({next:S=>{g.xu(),c.enqueueAndForget(()=>Gx(a,x));const I=S.docs.has(d);!I&&S.fromCache?m.reject(new ke(me.UNAVAILABLE,"Failed to get document because the client is offline.")):I&&S.fromCache&&h&&h.source==="server"?m.reject(new ke(me.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):m.resolve(S)},error:S=>m.reject(S)}),x=new Qx(Sc(d.path),g,{includeMetadataChanges:!0,Qa:!0});return $x(a,x)}(await mc(n),n.asyncQueue,e,t,r)),r.promise}function NB(n,e){const t=new zn;return n.asyncQueue.enqueueAndForget(async()=>async function(s,a,c){try{const d=await qp(s,a,!0),h=new G_(a,d.$s),m=h.tu(d.documents),g=h.applyChanges(m,!1);c.resolve(g.snapshot)}catch(d){const h=Ec(d,`Failed to execute query '${a} against cache`);c.reject(h)}}(await Cc(n),e,t)),t.promise}function r2(n,e,t={}){const r=new zn;return n.asyncQueue.enqueueAndForget(async()=>function(a,c,d,h,m){const g=new Af({next:S=>{g.xu(),c.enqueueAndForget(()=>Gx(a,x)),S.fromCache&&h.source==="server"?m.reject(new ke(me.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):m.resolve(S)},error:S=>m.reject(S)}),x=new Qx(d,g,{includeMetadataChanges:!0,Qa:!0});return $x(a,x)}(await mc(n),n.asyncQueue,e,t,r)),r.promise}function zB(n,e,t){const r=new zn;return n.asyncQueue.enqueueAndForget(async()=>{try{const s=await t2(n);r.resolve(async function(c,d,h){var m;const g=Be(c),{request:x,yt:S,parent:I}=s_(g.serializer,AT(d),h);g.connection.Uo||delete x.parent;const _=(await g.Yo("RunAggregationQuery",g.serializer.databaseId,I,x,1)).filter(T=>!!T.result);He(_.length===1,64727);const R=(m=_[0].result)===null||m===void 0?void 0:m.aggregateFields;return Object.keys(R).reduce((T,A)=>(T[S[A]]=R[A],T),{})}(s,e,t))}catch(s){r.reject(s)}}),r.promise}function DB(n,e){const t=new Af(e);return n.asyncQueue.enqueueAndForget(async()=>function(s,a){Be(s).Ca.add(a),a.next()}(await mc(n),t)),()=>{t.xu(),n.asyncQueue.enqueueAndForget(async()=>function(s,a){Be(s).Ca.delete(a)}(await mc(n),t))}}function MB(n,e,t,r){const s=function(c,d){let h;return h=typeof c=="string"?dx().encode(c):c,function(g,x){return new EB(g,x)}(function(g,x){if(g instanceof Uint8Array)return R1(g,x);if(g instanceof ArrayBuffer)return R1(new Uint8Array(g),x);if(g instanceof ReadableStream)return g.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(h),d)}(t,vd(e));n.asyncQueue.enqueueAndForget(async()=>{IB(await i0(n),s,r)})}function LB(n,e){return n.asyncQueue.enqueue(async()=>function(r,s){const a=Be(r);return a.persistence.runTransaction("Get named query","readonly",c=>a.Ei.getNamedQuery(c,s))}(await Cc(n),e))}function OB(n,e){return n.asyncQueue.enqueue(async()=>async function(r,s){const a=Be(r),c=a.indexManager,d=[];return a.persistence.runTransaction("Configure indexes","readwrite",h=>c.getFieldIndexes(h).next(m=>function(x,S,I,_,R){x=[...x],S=[...S],x.sort(I),S.sort(I);const T=x.length,A=S.length;let D=0,F=0;for(;D<A&&F<T;){const X=I(x[F],S[D]);X<0?R(x[F++]):X>0?_(S[D++]):(D++,F++)}for(;D<A;)_(S[D++]);for(;F<T;)R(x[F++])}(m,s,FA,g=>{d.push(c.addFieldIndex(h,g))},g=>{d.push(c.deleteFieldIndex(h,g))})).next(()=>le.waitFor(d)))}(await Cc(n),e))}function VB(n,e){return n.asyncQueue.enqueue(async()=>function(r,s){Be(r).Ms.fs=s}(await Cc(n),e))}function WB(n){return n.asyncQueue.enqueue(async()=>function(t){const r=Be(t),s=r.indexManager;return r.persistence.runTransaction("Delete All Indexes","readwrite",a=>s.deleteAllFieldIndexes(a))}(await Cc(n)))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function i2(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const P1=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function s0(n,e,t){if(!t)throw new ke(me.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function s2(n,e,t,r){if(e===!0&&r===!0)throw new ke(me.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function B1(n){if(!Fe.isDocumentKey(n))throw new ke(me.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function F1(n){if(Fe.isDocumentKey(n))throw new ke(me.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function Bf(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":Oe(12329,{type:typeof n})}function mt(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new ke(me.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=Bf(n);throw new ke(me.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function o2(n,e){if(e<=0)throw new ke(me.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const a2="firestore.googleapis.com",N1=!0;class z1{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new ke(me.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=a2,this.ssl=N1}else this.host=e.host,this.ssl=(t=e.ssl)!==null&&t!==void 0?t:N1;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=f_;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<x_)throw new ke(me.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}s2("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=i2((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(a){if(a.timeoutSeconds!==void 0){if(isNaN(a.timeoutSeconds))throw new ke(me.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (must not be NaN)`);if(a.timeoutSeconds<5)throw new ke(me.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (minimum allowed value is 5)`);if(a.timeoutSeconds>30)throw new ke(me.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,s){return r.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Sd{constructor(e,t,r,s){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new z1({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new ke(me.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new ke(me.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new z1(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new Kk;switch(r.type){case"firstParty":return new EA(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new ke(me.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const r=P1.get(t);r&&(Te("ComponentProvider","Removing Datastore"),P1.delete(t),r.terminate())}(this),Promise.resolve()}}function l2(n,e,t,r={}){var s;n=mt(n,Sd);const a=ws(e),c=n._getSettings(),d=Object.assign(Object.assign({},c),{emulatorOptions:n._getEmulatorOptions()}),h=`${e}:${t}`;a&&(mf(`https://${h}`),ox("Firestore",!0)),c.host!==a2&&c.host!==h&&Lr("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const m=Object.assign(Object.assign({},c),{host:h,ssl:a,emulatorOptions:r});if(!mi(m,d)&&(n._setSettings(m),r.mockUserToken)){let g,x;if(typeof r.mockUserToken=="string")g=r.mockUserToken,x=Nn.MOCK_USER;else{g=Rk(r.mockUserToken,(s=n._app)===null||s===void 0?void 0:s.options.projectId);const S=r.mockUserToken.sub||r.mockUserToken.user_id;if(!S)throw new ke(me.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");x=new Nn(S)}n._authCredentials=new _A(new Gk(g,x))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dn{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Dn(this.firestore,e,this._query)}}class dn{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new pi(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new dn(this.firestore,e,this._key)}}class pi extends Dn{constructor(e,t,r){super(e,t,Sc(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new dn(this.firestore,null,new Fe(e))}withConverter(e){return new pi(this.firestore,e,this._path)}}function kn(n,e,...t){if(n=It(n),s0("collection","path",e),n instanceof Sd){const r=xt.fromString(e,...t);return F1(r),new pi(n,null,r)}{if(!(n instanceof dn||n instanceof pi))throw new ke(me.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(xt.fromString(e,...t));return F1(r),new pi(n.firestore,null,r)}}function UB(n,e){if(n=mt(n,Sd),s0("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new ke(me.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new Dn(n,null,function(r){return new Ss(xt.emptyPath(),r)}(e))}function Gn(n,e,...t){if(n=It(n),arguments.length===1&&(e=hx.newId()),s0("doc","path",e),n instanceof Sd){const r=xt.fromString(e,...t);return B1(r),new dn(n,null,new Fe(r))}{if(!(n instanceof dn||n instanceof pi))throw new ke(me.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(xt.fromString(e,...t));return B1(r),new dn(n.firestore,n instanceof pi?n.converter:null,new Fe(r))}}function qB(n,e){return n=It(n),e=It(e),(n instanceof dn||n instanceof pi)&&(e instanceof dn||e instanceof pi)&&n.firestore===e.firestore&&n.path===e.path&&n.converter===e.converter}function o0(n,e){return n=It(n),e=It(e),n instanceof Dn&&e instanceof Dn&&n.firestore===e.firestore&&md(n._query,e._query)&&n.converter===e.converter}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const D1="AsyncQueue";class M1{constructor(e=Promise.resolve()){this.Ju=[],this.Yu=!1,this.Zu=[],this.Xu=null,this.ec=!1,this.tc=!1,this.nc=[],this.x_=new Vx(this,"async_queue_retry"),this.rc=()=>{const r=Sp();r&&Te(D1,"Visibility state changed to "+r.visibilityState),this.x_.b_()},this.sc=e;const t=Sp();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.rc)}get isShuttingDown(){return this.Yu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.oc(),this._c(e)}enterRestrictedMode(e){if(!this.Yu){this.Yu=!0,this.tc=e||!1;const t=Sp();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.rc)}}enqueue(e){if(this.oc(),this.Yu)return new Promise(()=>{});const t=new zn;return this._c(()=>this.Yu&&this.tc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Ju.push(e),this.ac()))}async ac(){if(this.Ju.length!==0){try{await this.Ju[0](),this.Ju.shift(),this.x_.reset()}catch(e){if(!Co(e))throw e;Te(D1,"Operation failed with retryable error: "+e)}this.Ju.length>0&&this.x_.y_(()=>this.ac())}}_c(e){const t=this.sc.then(()=>(this.ec=!0,e().catch(r=>{throw this.Xu=r,this.ec=!1,pn("INTERNAL UNHANDLED ERROR: ",L1(r)),r}).then(r=>(this.ec=!1,r))));return this.sc=t,t}enqueueAfterDelay(e,t,r){this.oc(),this.nc.indexOf(e)>-1&&(t=0);const s=Hx.createAndSchedule(this,e,t,r,a=>this.uc(a));return this.Zu.push(s),s}oc(){this.Xu&&Oe(47125,{cc:L1(this.Xu)})}verifyOperationInProgress(){}async lc(){let e;do e=this.sc,await e;while(e!==this.sc)}hc(e){for(const t of this.Zu)if(t.timerId===e)return!0;return!1}Pc(e){return this.lc().then(()=>{this.Zu.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(const t of this.Zu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.lc()})}Tc(e){this.nc.push(e)}uc(e){const t=this.Zu.indexOf(e);this.Zu.splice(t,1)}}function L1(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Oy(n){return function(t,r){if(typeof t!="object"||t===null)return!1;const s=t;for(const a of r)if(a in s&&typeof s[a]=="function")return!0;return!1}(n,["next","error","complete"])}class c2{constructor(){this._progressObserver={},this._taskCompletionResolver=new zn,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,r){this._progressObserver={next:e,error:t,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HB=-1;class Nt extends Sd{constructor(e,t,r,s){super(e,t,r,s),this.type="firestore",this._queue=new M1,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new M1(e),this._firestoreClient=void 0,await e}}}function $B(n,e,t){t||(t=ed);const r=vc(n,"firestore");if(r.isInitialized(t)){const s=r.getImmediate({identifier:t}),a=r.getOptions(t);if(mi(a,e))return s;throw new ke(me.FAILED_PRECONDITION,"initializeFirestore() has already been called with different options. To avoid this error, call initializeFirestore() with the same options as when it was originally called, or call getFirestore() to return the already initialized instance.")}if(e.cacheSizeBytes!==void 0&&e.localCache!==void 0)throw new ke(me.INVALID_ARGUMENT,"cache and cacheSizeBytes cannot be specified at the same time as cacheSizeBytes willbe deprecated. Instead, specify the cache size in the cache object");if(e.cacheSizeBytes!==void 0&&e.cacheSizeBytes!==-1&&e.cacheSizeBytes<x_)throw new ke(me.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");return e.host&&ws(e.host)&&mf(e.host),r.initialize({options:e,instanceIdentifier:t})}function kd(n,e){const t=typeof n=="object"?n:cx(),r=typeof n=="string"?n:e||ed,s=vc(t,"firestore").getImmediate({identifier:r});if(!s._initialized){const a=Ik("firestore");a&&l2(s,...a)}return s}function sn(n){if(n._terminated)throw new ke(me.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||u2(n),n._firestoreClient}function u2(n){var e,t,r;const s=n._freezeSettings(),a=function(d,h,m,g){return new fP(d,h,m,g.host,g.ssl,g.experimentalForceLongPolling,g.experimentalAutoDetectLongPolling,i2(g.experimentalLongPollingOptions),g.useFetchStreams,g.isUsingEmulator)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,s);n._componentsProvider||!((t=s.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((r=s.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(n._componentsProvider={_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider}),n._firestoreClient=new AB(n._authCredentials,n._appCheckCredentials,n._queue,a,n._componentsProvider&&function(d){const h=d==null?void 0:d._online.build();return{_offline:d==null?void 0:d._offline.build(h),_online:h}}(n._componentsProvider))}function GB(n,e){Lr("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=n._freezeSettings();return d2(n,To.provider,{build:r=>new n0(r,t.cacheSizeBytes,e==null?void 0:e.forceOwnership)}),Promise.resolve()}async function KB(n){Lr("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const e=n._freezeSettings();d2(n,To.provider,{build:t=>new J_(t,e.cacheSizeBytes)})}function d2(n,e,t){if((n=mt(n,Nt))._firestoreClient||n._terminated)throw new ke(me.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(n._componentsProvider||n._getSettings().localCache)throw new ke(me.FAILED_PRECONDITION,"SDK cache is already specified.");n._componentsProvider={_online:e,_offline:t},u2(n)}function QB(n){if(n._initialized&&!n._terminated)throw new ke(me.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new zn;return n._queue.enqueueAndForgetEvenWhileRestricted(async()=>{try{await async function(r){if(!Mi.C())return Promise.resolve();const s=r+T_;await Mi.delete(s)}(Dx(n._databaseId,n._persistenceKey)),e.resolve()}catch(t){e.reject(t)}}),e.promise}function YB(n){return function(t){const r=new zn;return t.asyncQueue.enqueueAndForget(async()=>gB(await i0(t),r)),r.promise}(sn(n=mt(n,Nt)))}function XB(n){return PB(sn(n=mt(n,Nt)))}function JB(n){return BB(sn(n=mt(n,Nt)))}function ZB(n){return lA(n.app,"firestore",n._databaseId.database),n._delete()}function e5(n,e){const t=sn(n=mt(n,Nt)),r=new c2;return MB(t,n._databaseId,e,r),r}function t5(n,e){return LB(sn(n=mt(n,Nt)),e).then(t=>t?new Dn(n,null,t.query):null)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gc{constructor(e="count",t){this._internalFieldPath=t,this.type="AggregateField",this.aggregateType=e}}class h2{constructor(e,t,r){this._userDataWriter=t,this._data=r,this.type="AggregateQuerySnapshot",this.query=e}data(){return this._userDataWriter.convertObjectMap(this._data)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jo{constructor(e){this._byteString=e}static fromBase64String(e){try{return new jo(ln.fromBase64String(e))}catch(t){throw new ke(me.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new jo(ln.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bo{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new ke(me.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Xt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}function n5(){return new Bo(gy)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fo{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ff{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new ke(me.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new ke(me.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return st(this._lat,e._lat)||st(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Td{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,s){if(r.length!==s.length)return!1;for(let a=0;a<r.length;++a)if(r[a]!==s[a])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const r5=/^__.*__$/;class i5{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new Ts(e,this.data,this.fieldMask,t,this.fieldTransforms):new kc(e,this.data,t,this.fieldTransforms)}}class p2{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new Ts(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function f2(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Oe(40011,{Ic:n})}}class Nf{constructor(e,t,r,s,a,c){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=s,a===void 0&&this.Ec(),this.fieldTransforms=a||[],this.fieldMask=c||[]}get path(){return this.settings.path}get Ic(){return this.settings.Ic}dc(e){return new Nf(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Ac(e){var t;const r=(t=this.path)===null||t===void 0?void 0:t.child(e),s=this.dc({path:r,Rc:!1});return s.Vc(e),s}mc(e){var t;const r=(t=this.path)===null||t===void 0?void 0:t.child(e),s=this.dc({path:r,Rc:!1});return s.Ec(),s}fc(e){return this.dc({path:void 0,Rc:!0})}gc(e){return Kp(e,this.settings.methodName,this.settings.yc||!1,this.path,this.settings.wc)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}Ec(){if(this.path)for(let e=0;e<this.path.length;e++)this.Vc(this.path.get(e))}Vc(e){if(e.length===0)throw this.gc("Document fields must not be empty");if(f2(this.Ic)&&r5.test(e))throw this.gc('Document fields cannot begin and end with "__"')}}class s5{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||vd(e)}bc(e,t,r,s=!1){return new Nf({Ic:e,methodName:t,wc:r,path:Xt.emptyPath(),Rc:!1,yc:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Va(n){const e=n._freezeSettings(),t=vd(n._databaseId);return new s5(n._databaseId,!!e.ignoreUndefinedProperties,t)}function zf(n,e,t,r,s,a={}){const c=n.bc(a.merge||a.mergeFields?2:0,e,t,s);p0("Data must be an object, but it was:",c,r);const d=y2(r,c);let h,m;if(a.merge)h=new Sr(c.fieldMask),m=c.fieldTransforms;else if(a.mergeFields){const g=[];for(const x of a.mergeFields){const S=od(e,x,t);if(!c.contains(S))throw new ke(me.INVALID_ARGUMENT,`Field '${S}' is specified in your field mask but missing from your input data.`);b2(g,S)||g.push(S)}h=new Sr(g),m=c.fieldTransforms.filter(x=>h.covers(x.field))}else h=null,m=c.fieldTransforms;return new i5(new $n(d),h,m)}class _d extends Fo{_toFieldTransform(e){if(e.Ic!==2)throw e.Ic===1?e.gc(`${this._methodName}() can only appear at the top level of your update data`):e.gc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof _d}}function m2(n,e,t){return new Nf({Ic:3,wc:e.settings.wc,methodName:n._methodName,Rc:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class a0 extends Fo{_toFieldTransform(e){return new yd(e.path,new oc)}isEqual(e){return e instanceof a0}}class l0 extends Fo{constructor(e,t){super(e),this.Sc=t}_toFieldTransform(e){const t=m2(this,e,!0),r=this.Sc.map(a=>Wa(a,t)),s=new Ea(r);return new yd(e.path,s)}isEqual(e){return e instanceof l0&&mi(this.Sc,e.Sc)}}class c0 extends Fo{constructor(e,t){super(e),this.Sc=t}_toFieldTransform(e){const t=m2(this,e,!0),r=this.Sc.map(a=>Wa(a,t)),s=new Ca(r);return new yd(e.path,s)}isEqual(e){return e instanceof c0&&mi(this.Sc,e.Sc)}}class u0 extends Fo{constructor(e,t){super(e),this.Dc=t}_toFieldTransform(e){const t=new ac(e.serializer,OT(e.serializer,this.Dc));return new yd(e.path,t)}isEqual(e){return e instanceof u0&&this.Dc===e.Dc}}function d0(n,e,t,r){const s=n.bc(1,e,t);p0("Data must be an object, but it was:",s,r);const a=[],c=$n.empty();Ro(r,(h,m)=>{const g=Df(e,h,t);m=It(m);const x=s.mc(g);if(m instanceof _d)a.push(g);else{const S=Wa(m,x);S!=null&&(a.push(g),c.set(g,S))}});const d=new Sr(a);return new p2(c,d,s.fieldTransforms)}function h0(n,e,t,r,s,a){const c=n.bc(1,e,t),d=[od(e,r,t)],h=[s];if(a.length%2!=0)throw new ke(me.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let S=0;S<a.length;S+=2)d.push(od(e,a[S])),h.push(a[S+1]);const m=[],g=$n.empty();for(let S=d.length-1;S>=0;--S)if(!b2(m,d[S])){const I=d[S];let _=h[S];_=It(_);const R=c.mc(I);if(_ instanceof _d)m.push(I);else{const T=Wa(_,R);T!=null&&(m.push(I),g.set(I,T))}}const x=new Sr(m);return new p2(g,x,c.fieldTransforms)}function g2(n,e,t,r=!1){return Wa(t,n.bc(r?4:3,e))}function Wa(n,e){if(x2(n=It(n)))return p0("Unsupported field value:",e,n),y2(n,e);if(n instanceof Fo)return function(r,s){if(!f2(s.Ic))throw s.gc(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.gc(`${r._methodName}() is not currently supported inside arrays`);const a=r._toFieldTransform(s);a&&s.fieldTransforms.push(a)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.Rc&&e.Ic!==4)throw e.gc("Nested arrays are not supported");return function(r,s){const a=[];let c=0;for(const d of r){let h=Wa(d,s.fc(c));h==null&&(h={nullValue:"NULL_VALUE"}),a.push(h),c++}return{arrayValue:{values:a}}}(n,e)}return function(r,s){if((r=It(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return OT(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const a=Lt.fromDate(r);return{timestampValue:lc(s.serializer,a)}}if(r instanceof Lt){const a=new Lt(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:lc(s.serializer,a)}}if(r instanceof Ff)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof jo)return{bytesValue:JT(s.serializer,r._byteString)};if(r instanceof dn){const a=s.databaseId,c=r.firestore._databaseId;if(!c.isEqual(a))throw s.gc(`Document reference is for database ${c.projectId}/${c.database} but should be for database ${a.projectId}/${a.database}`);return{referenceValue:Rx(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof Td)return function(c,d){return{mapValue:{fields:{[bx]:{stringValue:vx},[rc]:{arrayValue:{values:c.toArray().map(m=>{if(typeof m!="number")throw d.gc("VectorValues must only contain numeric values.");return Tx(d.serializer,m)})}}}}}}(r,s);throw s.gc(`Unsupported field value: ${Bf(r)}`)}(n,e)}function y2(n,e){const t={};return pT(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Ro(n,(r,s)=>{const a=Wa(s,e.Ac(r));a!=null&&(t[r]=a)}),{mapValue:{fields:t}}}function x2(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Lt||n instanceof Ff||n instanceof jo||n instanceof dn||n instanceof Fo||n instanceof Td)}function p0(n,e,t){if(!x2(t)||!function(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}(t)){const r=Bf(t);throw r==="an object"?e.gc(n+" a custom object"):e.gc(n+" "+r)}}function od(n,e,t){if((e=It(e))instanceof Bo)return e._internalPath;if(typeof e=="string")return Df(n,e);throw Kp("Field path arguments must be of type string or ",n,!1,void 0,t)}const o5=new RegExp("[~\\*/\\[\\]]");function Df(n,e,t){if(e.search(o5)>=0)throw Kp(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Bo(...e.split("."))._internalPath}catch{throw Kp(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Kp(n,e,t,r,s){const a=r&&!r.isEmpty(),c=s!==void 0;let d=`Function ${e}() called with invalid data`;t&&(d+=" (via `toFirestore()`)"),d+=". ";let h="";return(a||c)&&(h+=" (found",a&&(h+=` in field ${r}`),c&&(h+=` in document ${s}`),h+=")"),new ke(me.INVALID_ARGUMENT,d+n+h)}function b2(n,e){return n.some(t=>t.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ad{constructor(e,t,r,s,a){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=s,this._converter=a}get id(){return this._key.path.lastSegment()}get ref(){return new dn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new a5(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(Mf("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class a5 extends ad{data(){return super.data()}}function Mf(n,e){return typeof e=="string"?Df(n,e):e instanceof Bo?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function v2(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new ke(me.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class f0{}class Rc extends f0{}function cr(n,e,...t){let r=[];e instanceof f0&&r.push(e),r=r.concat(t),function(a){const c=a.filter(h=>h instanceof Ua).length,d=a.filter(h=>h instanceof Ac).length;if(c>1||c>0&&d>0)throw new ke(me.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const s of r)n=s._apply(n);return n}class Ac extends Rc{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new Ac(e,t,r)}_apply(e){const t=this._parse(e);return S2(e._query,t),new Dn(e.firestore,e.converter,Iy(e._query,t))}_parse(e){const t=Va(e.firestore);return function(a,c,d,h,m,g,x){let S;if(m.isKeyField()){if(g==="array-contains"||g==="array-contains-any")throw new ke(me.INVALID_ARGUMENT,`Invalid Query. You can't perform '${g}' queries on documentId().`);if(g==="in"||g==="not-in"){V1(x,g);const _=[];for(const R of x)_.push(O1(h,a,R));S={arrayValue:{values:_}}}else S=O1(h,a,x)}else g!=="in"&&g!=="not-in"&&g!=="array-contains-any"||V1(x,g),S=g2(d,c,x,g==="in"||g==="not-in");return bt.create(m,g,S)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function Tn(n,e,t){const r=e,s=Mf("where",n);return Ac._create(s,r,t)}class Ua extends f0{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new Ua(e,t)}_parse(e){const t=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return t.length===1?t[0]:At.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:(function(s,a){let c=s;const d=a.getFlattenedFilters();for(const h of d)S2(c,h),c=Iy(c,h)}(e._query,t),new Dn(e.firestore,e.converter,Iy(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function l5(...n){return n.forEach(e=>k2("or",e)),Ua._create("or",n)}function c5(...n){return n.forEach(e=>k2("and",e)),Ua._create("and",n)}class Lf extends Rc{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new Lf(e,t)}_apply(e){const t=function(s,a,c){if(s.startAt!==null)throw new ke(me.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new ke(me.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new rd(a,c)}(e._query,this._field,this._direction);return new Dn(e.firestore,e.converter,function(s,a){const c=s.explicitOrderBy.concat([a]);return new Ss(s.path,s.collectionGroup,c,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)}(e._query,t))}}function Qp(n,e="asc"){const t=e,r=Mf("orderBy",n);return Lf._create(r,t)}class jd extends Rc{constructor(e,t,r){super(),this.type=e,this._limit=t,this._limitType=r}static _create(e,t,r){return new jd(e,t,r)}_apply(e){return new Dn(e.firestore,e.converter,Mp(e._query,this._limit,this._limitType))}}function u5(n){return o2("limit",n),jd._create("limit",n,"F")}function d5(n){return o2("limitToLast",n),jd._create("limitToLast",n,"L")}class Id extends Rc{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new Id(e,t,r)}_apply(e){const t=w2(e,this.type,this._docOrFields,this._inclusive);return new Dn(e.firestore,e.converter,function(s,a){return new Ss(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),s.limit,s.limitType,a,s.endAt)}(e._query,t))}}function h5(...n){return Id._create("startAt",n,!0)}function p5(...n){return Id._create("startAfter",n,!1)}class Ed extends Rc{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new Ed(e,t,r)}_apply(e){const t=w2(e,this.type,this._docOrFields,this._inclusive);return new Dn(e.firestore,e.converter,function(s,a){return new Ss(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),s.limit,s.limitType,s.startAt,a)}(e._query,t))}}function f5(...n){return Ed._create("endBefore",n,!1)}function m5(...n){return Ed._create("endAt",n,!0)}function w2(n,e,t,r){if(t[0]=It(t[0]),t[0]instanceof ad)return function(a,c,d,h,m){if(!h)throw new ke(me.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${d}().`);const g=[];for(const x of Ul(a))if(x.field.isKeyField())g.push(ja(c,h.key));else{const S=h.data.field(x.field);if(vf(S))throw new ke(me.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+x.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(S===null){const I=x.field.canonicalString();throw new ke(me.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${I}' (used as the orderBy) does not exist.`)}g.push(S)}return new So(g,m)}(n._query,n.firestore._databaseId,e,t[0]._document,r);{const s=Va(n.firestore);return function(c,d,h,m,g,x){const S=c.explicitOrderBy;if(g.length>S.length)throw new ke(me.INVALID_ARGUMENT,`Too many arguments provided to ${m}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const I=[];for(let _=0;_<g.length;_++){const R=g[_];if(S[_].field.isKeyField()){if(typeof R!="string")throw new ke(me.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${m}(), but got a ${typeof R}`);if(!Sx(c)&&R.indexOf("/")!==-1)throw new ke(me.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${m}() must be a plain document ID, but '${R}' contains a slash.`);const T=c.path.child(xt.fromString(R));if(!Fe.isDocumentKey(T))throw new ke(me.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${m}() must result in a valid document path, but '${T}' is not because it contains an odd number of segments.`);const A=new Fe(T);I.push(ja(d,A))}else{const T=g2(h,m,R);I.push(T)}}return new So(I,x)}(n._query,n.firestore._databaseId,s,e,t,r)}}function O1(n,e,t){if(typeof(t=It(t))=="string"){if(t==="")throw new ke(me.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Sx(e)&&t.indexOf("/")!==-1)throw new ke(me.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const r=e.path.child(xt.fromString(t));if(!Fe.isDocumentKey(r))throw new ke(me.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return ja(n,new Fe(r))}if(t instanceof dn)return ja(n,t._key);throw new ke(me.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Bf(t)}.`)}function V1(n,e){if(!Array.isArray(n)||n.length===0)throw new ke(me.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function S2(n,e){const t=function(s,a){for(const c of s)for(const d of c.getFlattenedFilters())if(a.indexOf(d.op)>=0)return d.op;return null}(n.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new ke(me.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new ke(me.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}function k2(n,e){if(!(e instanceof Ac||e instanceof Ua))throw new ke(me.INVALID_ARGUMENT,`Function ${n}() requires AppliableConstraints created with a call to 'where(...)', 'or(...)', or 'and(...)'.`)}class m0{convertValue(e,t="none"){switch(vo(e)){case 0:return null;case 1:return e.booleanValue;case 2:return nn(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(bs(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Oe(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const r={};return Ro(e,(s,a)=>{r[s]=this.convertValue(a,t)}),r}convertVectorValue(e){var t,r,s;const a=(s=(r=(t=e.fields)===null||t===void 0?void 0:t[rc].arrayValue)===null||r===void 0?void 0:r.values)===null||s===void 0?void 0:s.map(c=>nn(c.doubleValue));return new Td(a)}convertGeoPoint(e){return new Ff(nn(e.latitude),nn(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":const r=wf(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(Zu(e));default:return null}}convertTimestamp(e){const t=xs(e);return new Lt(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=xt.fromString(e);He(c_(r),9688,{name:e});const s=new bo(r.get(1),r.get(3)),a=new Fe(r.popFirst(5));return s.isEqual(t)||pn(`Document ${a} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),a}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Of(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}class g5 extends m0{constructor(e){super(),this.firestore=e}convertBytes(e){return new jo(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new dn(this.firestore,null,t)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function y5(n){return new gc("sum",od("sum",n))}function x5(n){return new gc("avg",od("average",n))}function T2(){return new gc("count")}function b5(n,e){var t,r;return n instanceof gc&&e instanceof gc&&n.aggregateType===e.aggregateType&&((t=n._internalFieldPath)===null||t===void 0?void 0:t.canonicalString())===((r=e._internalFieldPath)===null||r===void 0?void 0:r.canonicalString())}function v5(n,e){return o0(n.query,e.query)&&mi(n.data(),e.data())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class co{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Fa extends ad{constructor(e,t,r,s,a,c){super(e,t,r,s,c),this._firestore=e,this._firestoreImpl=e,this.metadata=a}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Uu(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(Mf("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}}class Uu extends Fa{data(e={}){return super.data(e)}}class Na{constructor(e,t,r,s){this._firestore=e,this._userDataWriter=t,this._snapshot=s,this.metadata=new co(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new Uu(this._firestore,this._userDataWriter,r.key,r,new co(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new ke(me.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(s,a){if(s._snapshot.oldDocs.isEmpty()){let c=0;return s._snapshot.docChanges.map(d=>{const h=new Uu(s._firestore,s._userDataWriter,d.doc.key,d.doc,new co(s._snapshot.mutatedKeys.has(d.doc.key),s._snapshot.fromCache),s.query.converter);return d.doc,{type:"added",doc:h,oldIndex:-1,newIndex:c++}})}{let c=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(d=>a||d.type!==3).map(d=>{const h=new Uu(s._firestore,s._userDataWriter,d.doc.key,d.doc,new co(s._snapshot.mutatedKeys.has(d.doc.key),s._snapshot.fromCache),s.query.converter);let m=-1,g=-1;return d.type!==0&&(m=c.indexOf(d.doc.key),c=c.delete(d.doc.key)),d.type!==1&&(c=c.add(d.doc),g=c.indexOf(d.doc.key)),{type:w5(d.type),doc:h,oldIndex:m,newIndex:g}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function w5(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Oe(61501,{type:n})}}function S5(n,e){return n instanceof Fa&&e instanceof Fa?n._firestore===e._firestore&&n._key.isEqual(e._key)&&(n._document===null?e._document===null:n._document.isEqual(e._document))&&n._converter===e._converter:n instanceof Na&&e instanceof Na&&n._firestore===e._firestore&&o0(n.query,e.query)&&n.metadata.isEqual(e.metadata)&&n._snapshot.isEqual(e._snapshot)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Io(n){n=mt(n,dn);const e=mt(n.firestore,Nt);return n2(sn(e),n._key).then(t=>y0(e,n,t))}class No extends m0{constructor(e){super(),this.firestore=e}convertBytes(e){return new jo(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new dn(this.firestore,null,t)}}function k5(n){n=mt(n,dn);const e=mt(n.firestore,Nt),t=sn(e),r=new No(e);return FB(t,n._key).then(s=>new Fa(e,r,n._key,s,new co(s!==null&&s.hasLocalMutations,!0),n.converter))}function T5(n){n=mt(n,dn);const e=mt(n.firestore,Nt);return n2(sn(e),n._key,{source:"server"}).then(t=>y0(e,n,t))}function Dr(n){n=mt(n,Dn);const e=mt(n.firestore,Nt),t=sn(e),r=new No(e);return v2(n._query),r2(t,n._query).then(s=>new Na(e,r,n,s))}function _5(n){n=mt(n,Dn);const e=mt(n.firestore,Nt),t=sn(e),r=new No(e);return NB(t,n._query).then(s=>new Na(e,r,n,s))}function j5(n){n=mt(n,Dn);const e=mt(n.firestore,Nt),t=sn(e),r=new No(e);return r2(t,n._query,{source:"server"}).then(s=>new Na(e,r,n,s))}function Vf(n,e,t){n=mt(n,dn);const r=mt(n.firestore,Nt),s=Of(n.converter,e,t);return Pc(r,[zf(Va(r),"setDoc",n._key,s,n.converter!==null,t).toMutation(n._key,rn.none())])}function Yp(n,e,t,...r){n=mt(n,dn);const s=mt(n.firestore,Nt),a=Va(s);let c;return c=typeof(e=It(e))=="string"||e instanceof Bo?h0(a,"updateDoc",n._key,e,t,r):d0(a,"updateDoc",n._key,e),Pc(s,[c.toMutation(n._key,rn.exists(!0))])}function Xp(n){return Pc(mt(n.firestore,Nt),[new Tc(n._key,rn.none())])}function go(n,e){const t=mt(n.firestore,Nt),r=Gn(n),s=Of(n.converter,e);return Pc(t,[zf(Va(n.firestore),"addDoc",r._key,s,n.converter!==null,{}).toMutation(r._key,rn.exists(!1))]).then(()=>r)}function g0(n,...e){var t,r,s;n=It(n);let a={includeMetadataChanges:!1,source:"default"},c=0;typeof e[c]!="object"||Oy(e[c])||(a=e[c],c++);const d={includeMetadataChanges:a.includeMetadataChanges,source:a.source};if(Oy(e[c])){const x=e[c];e[c]=(t=x.next)===null||t===void 0?void 0:t.bind(x),e[c+1]=(r=x.error)===null||r===void 0?void 0:r.bind(x),e[c+2]=(s=x.complete)===null||s===void 0?void 0:s.bind(x)}let h,m,g;if(n instanceof dn)m=mt(n.firestore,Nt),g=Sc(n._key.path),h={next:x=>{e[c]&&e[c](y0(m,n,x))},error:e[c+1],complete:e[c+2]};else{const x=mt(n,Dn);m=mt(x.firestore,Nt),g=x._query;const S=new No(m);h={next:I=>{e[c]&&e[c](new Na(m,S,x,I))},error:e[c+1],complete:e[c+2]},v2(n._query)}return function(S,I,_,R){const T=new Af(R),A=new Qx(I,T,_);return S.asyncQueue.enqueueAndForget(async()=>$x(await mc(S),A)),()=>{T.xu(),S.asyncQueue.enqueueAndForget(async()=>Gx(await mc(S),A))}}(sn(m),g,d,h)}function I5(n,e){return DB(sn(n=mt(n,Nt)),Oy(e)?e:{next:e})}function Pc(n,e){return function(r,s){const a=new zn;return r.asyncQueue.enqueueAndForget(async()=>hB(await i0(r),s,a)),a.promise}(sn(n),e)}function y0(n,e,t){const r=t.docs.get(e._key),s=new No(n);return new Fa(n,s,e._key,r,new co(t.hasPendingWrites,t.fromCache),e.converter)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function E5(n){return _2(n,{count:T2()})}function _2(n,e){const t=mt(n.firestore,Nt),r=sn(t),s=hT(e,(a,c)=>new GT(c,a.aggregateType,a._internalFieldPath));return zB(r,n._query,s).then(a=>function(d,h,m){const g=new No(d);return new h2(h,g,m)}(t,n,a))}class C5{constructor(e){this.kind="memory",this._onlineComponentProvider=To.provider,e!=null&&e.garbageCollector?this._offlineComponentProvider=e.garbageCollector._offlineComponentProvider:this._offlineComponentProvider={build:()=>new t0(void 0)}}toJSON(){return{kind:this.kind}}}class R5{constructor(e){let t;this.kind="persistent",e!=null&&e.tabManager?(e.tabManager._initialize(e),t=e.tabManager):(t=j2(void 0),t._initialize(e)),this._onlineComponentProvider=t._onlineComponentProvider,this._offlineComponentProvider=t._offlineComponentProvider}toJSON(){return{kind:this.kind}}}class A5{constructor(){this.kind="memoryEager",this._offlineComponentProvider=fc.provider}toJSON(){return{kind:this.kind}}}class P5{constructor(e){this.kind="memoryLru",this._offlineComponentProvider={build:()=>new t0(e)}}toJSON(){return{kind:this.kind}}}function B5(){return new A5}function F5(n){return new P5(n==null?void 0:n.cacheSizeBytes)}function N5(n){return new C5(n)}function z5(n){return new R5(n)}class D5{constructor(e){this.forceOwnership=e,this.kind="persistentSingleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=To.provider,this._offlineComponentProvider={build:t=>new n0(t,e==null?void 0:e.cacheSizeBytes,this.forceOwnership)}}}class M5{constructor(){this.kind="PersistentMultipleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=To.provider,this._offlineComponentProvider={build:t=>new J_(t,e==null?void 0:e.cacheSizeBytes)}}}function j2(n){return new D5(n==null?void 0:n.forceOwnership)}function L5(){return new M5}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const O5={maxAttempts:5};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I2{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=Va(e)}set(e,t,r){this._verifyNotCommitted();const s=uo(e,this._firestore),a=Of(s.converter,t,r),c=zf(this._dataReader,"WriteBatch.set",s._key,a,s.converter!==null,r);return this._mutations.push(c.toMutation(s._key,rn.none())),this}update(e,t,r,...s){this._verifyNotCommitted();const a=uo(e,this._firestore);let c;return c=typeof(t=It(t))=="string"||t instanceof Bo?h0(this._dataReader,"WriteBatch.update",a._key,t,r,s):d0(this._dataReader,"WriteBatch.update",a._key,t),this._mutations.push(c.toMutation(a._key,rn.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=uo(e,this._firestore);return this._mutations=this._mutations.concat(new Tc(t._key,rn.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new ke(me.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function uo(n,e){if((n=It(n)).firestore!==e)throw new ke(me.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V5{constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=Va(e)}get(e){const t=uo(e,this._firestore),r=new g5(this._firestore);return this._transaction.lookup([t._key]).then(s=>{if(!s||s.length!==1)return Oe(24041);const a=s[0];if(a.isFoundDocument())return new ad(this._firestore,r,a.key,a,t.converter);if(a.isNoDocument())return new ad(this._firestore,r,t._key,null,t.converter);throw Oe(18433,{doc:a})})}set(e,t,r){const s=uo(e,this._firestore),a=Of(s.converter,t,r),c=zf(this._dataReader,"Transaction.set",s._key,a,s.converter!==null,r);return this._transaction.set(s._key,c),this}update(e,t,r,...s){const a=uo(e,this._firestore);let c;return c=typeof(t=It(t))=="string"||t instanceof Bo?h0(this._dataReader,"Transaction.update",a._key,t,r,s):d0(this._dataReader,"Transaction.update",a._key,t),this._transaction.update(a._key,c),this}delete(e){const t=uo(e,this._firestore);return this._transaction.delete(t._key),this}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E2 extends V5{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=uo(e,this._firestore),r=new No(this._firestore);return super.get(e).then(s=>new Fa(this._firestore,r,t._key,s._document,new co(!1,!1),t.converter))}}function W5(n,e,t){n=mt(n,Nt);const r=Object.assign(Object.assign({},O5),t);return function(a){if(a.maxAttempts<1)throw new ke(me.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(a,c,d){const h=new zn;return a.asyncQueue.enqueueAndForget(async()=>{const m=await t2(a);new RB(a.asyncQueue,m,d,c,h).Wu()}),h.promise}(sn(n),s=>e(new E2(n,s)),r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function U5(){return new _d("deleteField")}function x0(){return new a0("serverTimestamp")}function q5(...n){return new l0("arrayUnion",n)}function H5(...n){return new c0("arrayRemove",n)}function $5(n){return new u0("increment",n)}function G5(n){return new Td(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function K5(n){return sn(n=mt(n,Nt)),new I2(n,e=>Pc(n,e))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Q5(n,e){const t=sn(n=mt(n,Nt));if(!t._uninitializedComponentsProvider||t._uninitializedComponentsProvider._offline.kind==="memory")return Lr("Cannot enable indexes when persistence is disabled"),Promise.resolve();const r=function(a){const c=typeof a=="string"?function(m){try{return JSON.parse(m)}catch(g){throw new ke(me.INVALID_ARGUMENT,"Failed to parse JSON: "+(g==null?void 0:g.message))}}(a):a,d=[];if(Array.isArray(c.indexes))for(const h of c.indexes){const m=W1(h,"collectionGroup"),g=[];if(Array.isArray(h.fields))for(const x of h.fields){const S=Df("setIndexConfiguration",W1(x,"fieldPath"));x.arrayConfig==="CONTAINS"?g.push(new va(S,2)):x.order==="ASCENDING"?g.push(new va(S,0)):x.order==="DESCENDING"&&g.push(new va(S,1))}d.push(new Xl(Xl.UNKNOWN_ID,m,g,Jl.empty()))}return d}(e);return OB(t,r)}function W1(n,e){if(typeof n[e]!="string")throw new ke(me.INVALID_ARGUMENT,"Missing string value for: "+e);return n[e]}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C2{constructor(e){this._firestore=e,this.type="PersistentCacheIndexManager"}}function Y5(n){var e;n=mt(n,Nt);const t=U1.get(n);if(t)return t;if(((e=sn(n)._uninitializedComponentsProvider)===null||e===void 0?void 0:e._offline.kind)!=="persistent")return null;const r=new C2(n);return U1.set(n,r),r}function X5(n){R2(n,!0)}function J5(n){R2(n,!1)}function Z5(n){WB(sn(n._firestore)).then(e=>Te("deleting all persistent cache indexes succeeded")).catch(e=>Lr("deleting all persistent cache indexes failed",e))}function R2(n,e){VB(sn(n._firestore),e).then(t=>Te(`setting persistent cache index auto creation isEnabled=${e} succeeded`)).catch(t=>Lr(`setting persistent cache index auto creation isEnabled=${e} failed`,t))}const U1=new WeakMap;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eF(n){var e;const t=(e=sn(mt(n.firestore,Nt))._onlineComponents)===null||e===void 0?void 0:e.datastore.serializer;return t===void 0?null:_f(t,nr(n._query)).gt}function tF(n,e){var t;const r=hT(e,(a,c)=>new GT(c,a.aggregateType,a._internalFieldPath)),s=(t=sn(mt(n.firestore,Nt))._onlineComponents)===null||t===void 0?void 0:t.datastore.serializer;return s===void 0?null:s_(s,AT(n._query),r,!0).request}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nF{constructor(){throw new Error("instances of this class should not be created")}static onExistenceFilterMismatch(e){return b0.instance.onExistenceFilterMismatch(e)}}class b0{constructor(){this.vc=new Map}static get instance(){return op||(op=new b0,function(t){if(Lp)throw new Error("a TestingHooksSpi instance is already set");Lp=t}(op)),op}ht(e){this.vc.forEach(t=>t(e))}onExistenceFilterMismatch(e){const t=Symbol(),r=this.vc;return r.set(t,e),()=>r.delete(t)}}let op=null;(function(e,t=!0){(function(s){wc=s})(Oa),_a(new yo("firestore",(r,{instanceIdentifier:s,options:a})=>{const c=r.getProvider("app").getImmediate(),d=new Nt(new jA(r.getProvider("auth-internal")),new CA(c,r.getProvider("app-check-internal")),function(m,g){if(!Object.prototype.hasOwnProperty.apply(m.options,["projectId"]))throw new ke(me.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new bo(m.options.projectId,g)}(c,s),c);return a=Object.assign({useFetchStreams:t},a),d._setSettings(a),d},"PUBLIC").setMultipleInstances(!0)),Di(vw,ww,e),Di(vw,ww,"esm2017")})();const Jp=Object.freeze(Object.defineProperty({__proto__:null,AbstractUserDataWriter:m0,AggregateField:gc,AggregateQuerySnapshot:h2,Bytes:jo,CACHE_SIZE_UNLIMITED:HB,CollectionReference:pi,DocumentReference:dn,DocumentSnapshot:Fa,FieldPath:Bo,FieldValue:Fo,Firestore:Nt,FirestoreError:ke,GeoPoint:Ff,LoadBundleTask:c2,PersistentCacheIndexManager:C2,Query:Dn,QueryCompositeFilterConstraint:Ua,QueryConstraint:Rc,QueryDocumentSnapshot:Uu,QueryEndAtConstraint:Ed,QueryFieldFilterConstraint:Ac,QueryLimitConstraint:jd,QueryOrderByConstraint:Lf,QuerySnapshot:Na,QueryStartAtConstraint:Id,SnapshotMetadata:co,Timestamp:Lt,Transaction:E2,VectorValue:Td,WriteBatch:I2,_AutoId:hx,_ByteString:ln,_DatabaseId:bo,_DocumentKey:Fe,_EmptyAppCheckTokenProvider:RA,_EmptyAuthCredentialsProvider:Kk,_FieldPath:Xt,_TestingHooks:nF,_cast:mt,_debugAssert:TA,_internalAggregationQueryToProtoRunAggregationQueryRequest:tF,_internalQueryToProtoQueryTarget:eF,_isBase64Available:hP,_logWarn:Lr,_validateIsNotUsedTogether:s2,addDoc:go,aggregateFieldEqual:b5,aggregateQuerySnapshotEqual:v5,and:c5,arrayRemove:H5,arrayUnion:q5,average:x5,clearIndexedDbPersistence:QB,collection:kn,collectionGroup:UB,connectFirestoreEmulator:l2,count:T2,deleteAllPersistentCacheIndexes:Z5,deleteDoc:Xp,deleteField:U5,disableNetwork:JB,disablePersistentCacheIndexAutoCreation:J5,doc:Gn,documentId:n5,enableIndexedDbPersistence:GB,enableMultiTabIndexedDbPersistence:KB,enableNetwork:XB,enablePersistentCacheIndexAutoCreation:X5,endAt:m5,endBefore:f5,ensureFirestoreConfigured:sn,executeWrite:Pc,getAggregateFromServer:_2,getCountFromServer:E5,getDoc:Io,getDocFromCache:k5,getDocFromServer:T5,getDocs:Dr,getDocsFromCache:_5,getDocsFromServer:j5,getFirestore:kd,getPersistentCacheIndexManager:Y5,increment:$5,initializeFirestore:$B,limit:u5,limitToLast:d5,loadBundle:e5,memoryEagerGarbageCollector:B5,memoryLocalCache:N5,memoryLruGarbageCollector:F5,namedQuery:t5,onSnapshot:g0,onSnapshotsInSync:I5,or:l5,orderBy:Qp,persistentLocalCache:z5,persistentMultipleTabManager:L5,persistentSingleTabManager:j2,query:cr,queryEqual:o0,refEqual:qB,runTransaction:W5,serverTimestamp:x0,setDoc:Vf,setIndexConfiguration:Q5,setLogLevel:kA,snapshotEqual:S5,startAfter:p5,startAt:h5,sum:y5,terminate:ZB,updateDoc:Yp,vector:G5,waitForPendingWrites:YB,where:Tn,writeBatch:K5},Symbol.toStringTag,{value:"Module"}));function v0(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(n);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(n,r[s])&&(t[r[s]]=n[r[s]]);return t}function A2(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const P2=A2,B2=new ud("auth","Firebase",A2());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zp=new ax("@firebase/auth");function rF(n,...e){Zp.logLevel<=yt.WARN&&Zp.warn(`Auth (${Oa}): ${n}`,...e)}function kp(n,...e){Zp.logLevel<=yt.ERROR&&Zp.error(`Auth (${Oa}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xr(n,...e){throw S0(n,...e)}function fi(n,...e){return S0(n,...e)}function w0(n,e,t){const r=Object.assign(Object.assign({},P2()),{[e]:t});return new ud("auth","Firebase",r).create(e,{appName:n.name})}function ms(n){return w0(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function iF(n,e,t){const r=t;if(!(e instanceof r))throw r.name!==e.constructor.name&&Xr(n,"argument-error"),w0(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function S0(n,...e){if(typeof n!="string"){const t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return B2.create(n,...e)}function ot(n,e,...t){if(!n)throw S0(e,...t)}function ps(n){const e="INTERNAL ASSERTION FAILED: "+n;throw kp(e),new Error(e)}function vs(n,e){n||ps(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vy(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function sF(){return q1()==="http:"||q1()==="https:"}function q1(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oF(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(sF()||tR()||"connection"in navigator)?navigator.onLine:!0}function aF(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cd{constructor(e,t){this.shortDelay=e,this.longDelay=t,vs(t>e,"Short delay should be less than long delay!"),this.isMobile=ZC()||nR()}get(){return oF()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function k0(n,e){vs(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F2{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;ps("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;ps("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;ps("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lF={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cF=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],uF=new Cd(3e4,6e4);function js(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}async function qi(n,e,t,r,s={}){return N2(n,s,async()=>{let a={},c={};r&&(e==="GET"?c=r:a={body:JSON.stringify(r)});const d=dd(Object.assign({key:n.config.apiKey},c)).slice(1),h=await n._getAdditionalHeaders();h["Content-Type"]="application/json",n.languageCode&&(h["X-Firebase-Locale"]=n.languageCode);const m=Object.assign({method:e,headers:h},a);return eR()||(m.referrerPolicy="no-referrer"),n.emulatorConfig&&ws(n.emulatorConfig.host)&&(m.credentials="include"),F2.fetch()(await z2(n,n.config.apiHost,t,d),m)})}async function N2(n,e,t){n._canInitEmulator=!1;const r=Object.assign(Object.assign({},lF),e);try{const s=new hF(n),a=await Promise.race([t(),s.promise]);s.clearNetworkTimeout();const c=await a.json();if("needConfirmation"in c)throw ap(n,"account-exists-with-different-credential",c);if(a.ok&&!("errorMessage"in c))return c;{const d=a.ok?c.errorMessage:c.error.message,[h,m]=d.split(" : ");if(h==="FEDERATED_USER_ID_ALREADY_LINKED")throw ap(n,"credential-already-in-use",c);if(h==="EMAIL_EXISTS")throw ap(n,"email-already-in-use",c);if(h==="USER_DISABLED")throw ap(n,"user-disabled",c);const g=r[h]||h.toLowerCase().replace(/[_\s]+/g,"-");if(m)throw w0(n,g,m);Xr(n,g)}}catch(s){if(s instanceof Ui)throw s;Xr(n,"network-request-failed",{message:String(s)})}}async function Rd(n,e,t,r,s={}){const a=await qi(n,e,t,r,s);return"mfaPendingCredential"in a&&Xr(n,"multi-factor-auth-required",{_serverResponse:a}),a}async function z2(n,e,t,r){const s=`${e}${t}?${r}`,a=n,c=a.config.emulator?k0(n.config,s):`${n.config.apiScheme}://${s}`;return cF.includes(t)&&(await a._persistenceManagerAvailable,a._getPersistenceType()==="COOKIE")?a._getPersistence()._getFinalTarget(c).toString():c}function dF(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class hF{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(fi(this.auth,"network-request-failed")),uF.get())})}}function ap(n,e,t){const r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);const s=fi(n,e,r);return s.customData._tokenResponse=t,s}function H1(n){return n!==void 0&&n.enterprise!==void 0}class pF{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return dF(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function fF(n,e){return qi(n,"GET","/v2/recaptchaConfig",js(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function mF(n,e){return qi(n,"POST","/v1/accounts:delete",e)}async function ef(n,e){return qi(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qu(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function D2(n,e=!1){const t=It(n),r=await t.getIdToken(e),s=T0(r);ot(s&&s.exp&&s.auth_time&&s.iat,t.auth,"internal-error");const a=typeof s.firebase=="object"?s.firebase:void 0,c=a==null?void 0:a.sign_in_provider;return{claims:s,token:r,authTime:qu(Hg(s.auth_time)),issuedAtTime:qu(Hg(s.iat)),expirationTime:qu(Hg(s.exp)),signInProvider:c||null,signInSecondFactor:(a==null?void 0:a.sign_in_second_factor)||null}}function Hg(n){return Number(n)*1e3}function T0(n){const[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return kp("JWT malformed, contained fewer than 3 sections"),null;try{const s=Tk(t);return s?JSON.parse(s):(kp("Failed to decode base64 JWT payload"),null)}catch(s){return kp("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function $1(n){const e=T0(n);return ot(e,"internal-error"),ot(typeof e.exp<"u","internal-error"),ot(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function yc(n,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof Ui&&gF(r)&&n.auth.currentUser===n&&await n.auth.signOut(),r}}function gF({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yF{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const s=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wy{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=qu(this.lastLoginAt),this.creationTime=qu(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function tf(n){var e;const t=n.auth,r=await n.getIdToken(),s=await yc(n,ef(t,{idToken:r}));ot(s==null?void 0:s.users.length,t,"internal-error");const a=s.users[0];n._notifyReloadListener(a);const c=!((e=a.providerUserInfo)===null||e===void 0)&&e.length?L2(a.providerUserInfo):[],d=xF(n.providerData,c),h=n.isAnonymous,m=!(n.email&&a.passwordHash)&&!(d!=null&&d.length),g=h?m:!1,x={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:d,metadata:new Wy(a.createdAt,a.lastLoginAt),isAnonymous:g};Object.assign(n,x)}async function M2(n){const e=It(n);await tf(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function xF(n,e){return[...n.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function L2(n){return n.map(e=>{var{providerId:t}=e,r=v0(e,["providerId"]);return{providerId:t,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function bF(n,e){const t=await N2(n,{},async()=>{const r=dd({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:a}=n.config,c=await z2(n,s,"/v1/token",`key=${a}`),d=await n._getAdditionalHeaders();d["Content-Type"]="application/x-www-form-urlencoded";const h={method:"POST",headers:d,body:r};return n.emulatorConfig&&ws(n.emulatorConfig.host)&&(h.credentials="include"),F2.fetch()(c,h)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function vF(n,e){return qi(n,"POST","/v2/accounts:revokeToken",js(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hl{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){ot(e.idToken,"internal-error"),ot(typeof e.idToken<"u","internal-error"),ot(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):$1(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){ot(e.length!==0,"internal-error");const t=$1(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(ot(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:r,refreshToken:s,expiresIn:a}=await bF(e,t);this.updateTokensAndExpiration(r,s,Number(a))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){const{refreshToken:r,accessToken:s,expirationTime:a}=t,c=new Hl;return r&&(ot(typeof r=="string","internal-error",{appName:e}),c.refreshToken=r),s&&(ot(typeof s=="string","internal-error",{appName:e}),c.accessToken=s),a&&(ot(typeof a=="number","internal-error",{appName:e}),c.expirationTime=a),c}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Hl,this.toJSON())}_performRefresh(){return ps("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ro(n,e){ot(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class hi{constructor(e){var{uid:t,auth:r,stsTokenManager:s}=e,a=v0(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new yF(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=r,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=a.displayName||null,this.email=a.email||null,this.emailVerified=a.emailVerified||!1,this.phoneNumber=a.phoneNumber||null,this.photoURL=a.photoURL||null,this.isAnonymous=a.isAnonymous||!1,this.tenantId=a.tenantId||null,this.providerData=a.providerData?[...a.providerData]:[],this.metadata=new Wy(a.createdAt||void 0,a.lastLoginAt||void 0)}async getIdToken(e){const t=await yc(this,this.stsTokenManager.getToken(this.auth,e));return ot(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return D2(this,e)}reload(){return M2(this)}_assign(e){this!==e&&(ot(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new hi(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){ot(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await tf(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(vr(this.auth.app))return Promise.reject(ms(this.auth));const e=await this.getIdToken();return await yc(this,mF(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var r,s,a,c,d,h,m,g;const x=(r=t.displayName)!==null&&r!==void 0?r:void 0,S=(s=t.email)!==null&&s!==void 0?s:void 0,I=(a=t.phoneNumber)!==null&&a!==void 0?a:void 0,_=(c=t.photoURL)!==null&&c!==void 0?c:void 0,R=(d=t.tenantId)!==null&&d!==void 0?d:void 0,T=(h=t._redirectEventId)!==null&&h!==void 0?h:void 0,A=(m=t.createdAt)!==null&&m!==void 0?m:void 0,D=(g=t.lastLoginAt)!==null&&g!==void 0?g:void 0,{uid:F,emailVerified:X,isAnonymous:ie,providerData:G,stsTokenManager:N}=t;ot(F&&N,e,"internal-error");const E=Hl.fromJSON(this.name,N);ot(typeof F=="string",e,"internal-error"),ro(x,e.name),ro(S,e.name),ot(typeof X=="boolean",e,"internal-error"),ot(typeof ie=="boolean",e,"internal-error"),ro(I,e.name),ro(_,e.name),ro(R,e.name),ro(T,e.name),ro(A,e.name),ro(D,e.name);const P=new hi({uid:F,auth:e,email:S,emailVerified:X,displayName:x,isAnonymous:ie,photoURL:_,phoneNumber:I,tenantId:R,stsTokenManager:E,createdAt:A,lastLoginAt:D});return G&&Array.isArray(G)&&(P.providerData=G.map(M=>Object.assign({},M))),T&&(P._redirectEventId=T),P}static async _fromIdTokenResponse(e,t,r=!1){const s=new Hl;s.updateFromServerResponse(t);const a=new hi({uid:t.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await tf(a),a}static async _fromGetAccountInfoResponse(e,t,r){const s=t.users[0];ot(s.localId!==void 0,"internal-error");const a=s.providerUserInfo!==void 0?L2(s.providerUserInfo):[],c=!(s.email&&s.passwordHash)&&!(a!=null&&a.length),d=new Hl;d.updateFromIdToken(r);const h=new hi({uid:s.localId,auth:e,stsTokenManager:d,isAnonymous:c}),m={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new Wy(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(a!=null&&a.length)};return Object.assign(h,m),h}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const G1=new Map;function fs(n){vs(n instanceof Function,"Expected a class definition");let e=G1.get(n);return e?(vs(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,G1.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O2{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}O2.type="NONE";const Uy=O2;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tp(n,e,t){return`firebase:${n}:${e}:${t}`}class $l{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;const{config:s,name:a}=this.auth;this.fullUserKey=Tp(this.userKey,s.apiKey,a),this.fullPersistenceKey=Tp("persistence",s.apiKey,a),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await ef(this.auth,{idToken:e}).catch(()=>{});return t?hi._fromGetAccountInfoResponse(this.auth,t,e):null}return hi._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new $l(fs(Uy),e,r);const s=(await Promise.all(t.map(async m=>{if(await m._isAvailable())return m}))).filter(m=>m);let a=s[0]||fs(Uy);const c=Tp(r,e.config.apiKey,e.name);let d=null;for(const m of t)try{const g=await m._get(c);if(g){let x;if(typeof g=="string"){const S=await ef(e,{idToken:g}).catch(()=>{});if(!S)break;x=await hi._fromGetAccountInfoResponse(e,S,g)}else x=hi._fromJSON(e,g);m!==a&&(d=x),a=m;break}}catch{}const h=s.filter(m=>m._shouldAllowMigration);return!a._shouldAllowMigration||!h.length?new $l(a,e,r):(a=h[0],d&&await a._set(c,d.toJSON()),await Promise.all(t.map(async m=>{if(m!==a)try{await m._remove(c)}catch{}})),new $l(a,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function K1(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(q2(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(V2(e))return"Firefox";if(e.includes("silk/"))return"Silk";if($2(e))return"Blackberry";if(G2(e))return"Webos";if(W2(e))return"Safari";if((e.includes("chrome/")||U2(e))&&!e.includes("edge/"))return"Chrome";if(H2(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function V2(n=In()){return/firefox\//i.test(n)}function W2(n=In()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function U2(n=In()){return/crios\//i.test(n)}function q2(n=In()){return/iemobile/i.test(n)}function H2(n=In()){return/android/i.test(n)}function $2(n=In()){return/blackberry/i.test(n)}function G2(n=In()){return/webos/i.test(n)}function _0(n=In()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function wF(n=In()){var e;return _0(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function SF(){return rR()&&document.documentMode===10}function K2(n=In()){return _0(n)||H2(n)||G2(n)||$2(n)||/windows phone/i.test(n)||q2(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Q2(n,e=[]){let t;switch(n){case"Browser":t=K1(In());break;case"Worker":t=`${K1(In())}-${n}`;break;default:t=n}const r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Oa}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kF{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const r=a=>new Promise((c,d)=>{try{const h=e(a);c(h)}catch(h){d(h)}});r.onAbort=t,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(const s of t)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function TF(n,e={}){return qi(n,"GET","/v2/passwordPolicy",js(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _F=6;class jF{constructor(e){var t,r,s,a;const c=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=c.minPasswordLength)!==null&&t!==void 0?t:_F,c.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=c.maxPasswordLength),c.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=c.containsLowercaseCharacter),c.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=c.containsUppercaseCharacter),c.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=c.containsNumericCharacter),c.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=c.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(s=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&s!==void 0?s:"",this.forceUpgradeOnSignin=(a=e.forceUpgradeOnSignin)!==null&&a!==void 0?a:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,r,s,a,c,d;const h={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,h),this.validatePasswordCharacterOptions(e,h),h.isValid&&(h.isValid=(t=h.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),h.isValid&&(h.isValid=(r=h.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),h.isValid&&(h.isValid=(s=h.containsLowercaseLetter)!==null&&s!==void 0?s:!0),h.isValid&&(h.isValid=(a=h.containsUppercaseLetter)!==null&&a!==void 0?a:!0),h.isValid&&(h.isValid=(c=h.containsNumericCharacter)!==null&&c!==void 0?c:!0),h.isValid&&(h.isValid=(d=h.containsNonAlphanumericCharacter)!==null&&d!==void 0?d:!0),h}validatePasswordLengthOptions(e,t){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),s&&(t.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,s,a){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IF{constructor(e,t,r,s){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Q1(this),this.idTokenSubscription=new Q1(this),this.beforeStateQueue=new kF(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=B2,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(a=>this._resolvePersistenceManagerAvailable=a)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=fs(t)),this._initializationPromise=this.queue(async()=>{var r,s,a;if(!this._deleted&&(this.persistenceManager=await $l.create(this,e),(r=this._resolvePersistenceManagerAvailable)===null||r===void 0||r.call(this),!this._deleted)){if(!((s=this._popupRedirectResolver)===null||s===void 0)&&s._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((a=this.currentUser)===null||a===void 0?void 0:a.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await ef(this,{idToken:e}),r=await hi._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(vr(this.app)){const c=this.app.settings.authIdToken;return c?new Promise(d=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(c).then(d,d))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let s=r,a=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const c=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,d=s==null?void 0:s._redirectEventId,h=await this.tryRedirectSignIn(e);(!c||c===d)&&(h!=null&&h.user)&&(s=h.user,a=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(a)try{await this.beforeStateQueue.runMiddleware(s)}catch(c){s=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(c))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return ot(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await tf(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=aF()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(vr(this.app))return Promise.reject(ms(this));const t=e?It(e):null;return t&&ot(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&ot(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return vr(this.app)?Promise.reject(ms(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return vr(this.app)?Promise.reject(ms(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(fs(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await TF(this),t=new jF(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new ud("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),await vF(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,t){const r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&fs(e)||this._popupRedirectResolver;ot(t,this,"argument-error"),this.redirectPersistenceManager=await $l.create(this,[fs(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,r;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,s){if(this._deleted)return()=>{};const a=typeof t=="function"?t:t.next.bind(t);let c=!1;const d=this._isInitialized?Promise.resolve():this._initializationPromise;if(ot(d,this,"internal-error"),d.then(()=>{c||a(this.currentUser)}),typeof t=="function"){const h=e.addObserver(t,r,s);return()=>{c=!0,h()}}else{const h=e.addObserver(t);return()=>{c=!0,h()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return ot(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Q2(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(t["X-Firebase-Client"]=r);const s=await this._getAppCheckToken();return s&&(t["X-Firebase-AppCheck"]=s),t}async _getAppCheckToken(){var e;if(vr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const t=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return t!=null&&t.error&&rF(`Error while retrieving App Check token: ${t.error}`),t==null?void 0:t.token}}function Is(n){return It(n)}class Q1{constructor(e){this.auth=e,this.observer=null,this.addObserver=cR(t=>this.observer=t)}get next(){return ot(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Wf={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function EF(n){Wf=n}function Y2(n){return Wf.loadJS(n)}function CF(){return Wf.recaptchaEnterpriseScript}function RF(){return Wf.gapiScript}function AF(n){return`__${n}${Math.floor(Math.random()*1e6)}`}class PF{constructor(){this.enterprise=new BF}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class BF{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const FF="recaptcha-enterprise",X2="NO_RECAPTCHA";class NF{constructor(e){this.type=FF,this.auth=Is(e)}async verify(e="verify",t=!1){async function r(a){if(!t){if(a.tenantId==null&&a._agentRecaptchaConfig!=null)return a._agentRecaptchaConfig.siteKey;if(a.tenantId!=null&&a._tenantRecaptchaConfigs[a.tenantId]!==void 0)return a._tenantRecaptchaConfigs[a.tenantId].siteKey}return new Promise(async(c,d)=>{fF(a,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(h=>{if(h.recaptchaKey===void 0)d(new Error("recaptcha Enterprise site key undefined"));else{const m=new pF(h);return a.tenantId==null?a._agentRecaptchaConfig=m:a._tenantRecaptchaConfigs[a.tenantId]=m,c(m.siteKey)}}).catch(h=>{d(h)})})}function s(a,c,d){const h=window.grecaptcha;H1(h)?h.enterprise.ready(()=>{h.enterprise.execute(a,{action:e}).then(m=>{c(m)}).catch(()=>{c(X2)})}):d(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new PF().execute("siteKey",{action:"verify"}):new Promise((a,c)=>{r(this.auth).then(d=>{if(!t&&H1(window.grecaptcha))s(d,a,c);else{if(typeof window>"u"){c(new Error("RecaptchaVerifier is only supported in browser"));return}let h=CF();h.length!==0&&(h+=d),Y2(h).then(()=>{s(d,a,c)}).catch(m=>{c(m)})}}).catch(d=>{c(d)})})}}async function Y1(n,e,t,r=!1,s=!1){const a=new NF(n);let c;if(s)c=X2;else try{c=await a.verify(t)}catch{c=await a.verify(t,!0)}const d=Object.assign({},e);if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in d){const h=d.phoneEnrollmentInfo.phoneNumber,m=d.phoneEnrollmentInfo.recaptchaToken;Object.assign(d,{phoneEnrollmentInfo:{phoneNumber:h,recaptchaToken:m,captchaResponse:c,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in d){const h=d.phoneSignInInfo.recaptchaToken;Object.assign(d,{phoneSignInInfo:{recaptchaToken:h,captchaResponse:c,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return d}return r?Object.assign(d,{captchaResp:c}):Object.assign(d,{captchaResponse:c}),Object.assign(d,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(d,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),d}async function nf(n,e,t,r,s){var a;if(!((a=n._getRecaptchaConfig())===null||a===void 0)&&a.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const c=await Y1(n,e,t,t==="getOobCode");return r(n,c)}else return r(n,e).catch(async c=>{if(c.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const d=await Y1(n,e,t,t==="getOobCode");return r(n,d)}else return Promise.reject(c)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function J2(n,e){const t=vc(n,"auth");if(t.isInitialized()){const s=t.getImmediate(),a=t.getOptions();if(mi(a,e??{}))return s;Xr(s,"already-initialized")}return t.initialize({options:e})}function zF(n,e){const t=(e==null?void 0:e.persistence)||[],r=(Array.isArray(t)?t:[t]).map(fs);e!=null&&e.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function Z2(n,e,t){const r=Is(n);ot(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!1,a=ej(e),{host:c,port:d}=DF(e),h=d===null?"":`:${d}`,m={url:`${a}//${c}${h}/`},g=Object.freeze({host:c,port:d,protocol:a.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!r._canInitEmulator){ot(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),ot(mi(m,r.config.emulator)&&mi(g,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=m,r.emulatorConfig=g,r.settings.appVerificationDisabledForTesting=!0,ws(c)?(mf(`${a}//${c}${h}`),ox("Auth",!0)):MF()}function ej(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function DF(n){const e=ej(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const r=t[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const a=s[1];return{host:a,port:X1(r.substr(a.length+1))}}else{const[a,c]=r.split(":");return{host:a,port:X1(c)}}}function X1(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function MF(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uf{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return ps("not implemented")}_getIdTokenResponse(e){return ps("not implemented")}_linkToIdToken(e,t){return ps("not implemented")}_getReauthenticationResolver(e){return ps("not implemented")}}async function LF(n,e){return qi(n,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function OF(n,e){return Rd(n,"POST","/v1/accounts:signInWithPassword",js(n,e))}async function VF(n,e){return qi(n,"POST","/v1/accounts:sendOobCode",js(n,e))}async function WF(n,e){return VF(n,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function UF(n,e){return Rd(n,"POST","/v1/accounts:signInWithEmailLink",js(n,e))}async function qF(n,e){return Rd(n,"POST","/v1/accounts:signInWithEmailLink",js(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xc extends Uf{constructor(e,t,r,s=null){super("password",r),this._email=e,this._password=t,this._tenantId=s}static _fromEmailAndPassword(e,t){return new xc(e,t,"password")}static _fromEmailAndCode(e,t,r=null){return new xc(e,t,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t!=null&&t.email&&(t!=null&&t.password)){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return nf(e,t,"signInWithPassword",OF);case"emailLink":return UF(e,{email:this._email,oobCode:this._password});default:Xr(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const r={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return nf(e,r,"signUpPassword",LF);case"emailLink":return qF(e,{idToken:t,email:this._email,oobCode:this._password});default:Xr(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Gl(n,e){return Rd(n,"POST","/v1/accounts:signInWithIdp",js(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HF="http://localhost";class Wi extends Uf{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Wi(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Xr("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s}=t,a=v0(t,["providerId","signInMethod"]);if(!r||!s)return null;const c=new Wi(r,s);return c.idToken=a.idToken||void 0,c.accessToken=a.accessToken||void 0,c.secret=a.secret,c.nonce=a.nonce,c.pendingToken=a.pendingToken||null,c}_getIdTokenResponse(e){const t=this.buildRequest();return Gl(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,Gl(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Gl(e,t)}buildRequest(){const e={requestUri:HF,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=dd(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $F(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function GF(n){const e=Iu(Eu(n)).link,t=e?Iu(Eu(e)).deep_link_id:null,r=Iu(Eu(n)).deep_link_id;return(r?Iu(Eu(r)).link:null)||r||t||e||n}class qf{constructor(e){var t,r,s,a,c,d;const h=Iu(Eu(e)),m=(t=h.apiKey)!==null&&t!==void 0?t:null,g=(r=h.oobCode)!==null&&r!==void 0?r:null,x=$F((s=h.mode)!==null&&s!==void 0?s:null);ot(m&&g&&x,"argument-error"),this.apiKey=m,this.operation=x,this.code=g,this.continueUrl=(a=h.continueUrl)!==null&&a!==void 0?a:null,this.languageCode=(c=h.lang)!==null&&c!==void 0?c:null,this.tenantId=(d=h.tenantId)!==null&&d!==void 0?d:null}static parseLink(e){const t=GF(e);try{return new qf(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qa{constructor(){this.providerId=qa.PROVIDER_ID}static credential(e,t){return xc._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const r=qf.parseLink(t);return ot(r,"argument-error"),xc._fromEmailAndCode(e,r.code,r.tenantId)}}qa.PROVIDER_ID="password";qa.EMAIL_PASSWORD_SIGN_IN_METHOD="password";qa.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j0{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bc extends j0{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Kl extends Bc{static credentialFromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;return ot("providerId"in t&&"signInMethod"in t,"argument-error"),Wi._fromParams(t)}credential(e){return this._credential(Object.assign(Object.assign({},e),{nonce:e.rawNonce}))}_credential(e){return ot(e.idToken||e.accessToken,"argument-error"),Wi._fromParams(Object.assign(Object.assign({},e),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(e){return Kl.oauthCredentialFromTaggedObject(e)}static credentialFromError(e){return Kl.oauthCredentialFromTaggedObject(e.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r,oauthTokenSecret:s,pendingToken:a,nonce:c,providerId:d}=e;if(!r&&!s&&!t&&!a||!d)return null;try{return new Kl(d)._credential({idToken:t,accessToken:r,nonce:c,pendingToken:a})}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cs extends Bc{constructor(){super("facebook.com")}static credential(e){return Wi._fromParams({providerId:cs.PROVIDER_ID,signInMethod:cs.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return cs.credentialFromTaggedObject(e)}static credentialFromError(e){return cs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return cs.credential(e.oauthAccessToken)}catch{return null}}}cs.FACEBOOK_SIGN_IN_METHOD="facebook.com";cs.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bi extends Bc{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Wi._fromParams({providerId:Bi.PROVIDER_ID,signInMethod:Bi.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Bi.credentialFromTaggedObject(e)}static credentialFromError(e){return Bi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r}=e;if(!t&&!r)return null;try{return Bi.credential(t,r)}catch{return null}}}Bi.GOOGLE_SIGN_IN_METHOD="google.com";Bi.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class us extends Bc{constructor(){super("github.com")}static credential(e){return Wi._fromParams({providerId:us.PROVIDER_ID,signInMethod:us.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return us.credentialFromTaggedObject(e)}static credentialFromError(e){return us.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return us.credential(e.oauthAccessToken)}catch{return null}}}us.GITHUB_SIGN_IN_METHOD="github.com";us.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ds extends Bc{constructor(){super("twitter.com")}static credential(e,t){return Wi._fromParams({providerId:ds.PROVIDER_ID,signInMethod:ds.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return ds.credentialFromTaggedObject(e)}static credentialFromError(e){return ds.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:r}=e;if(!t||!r)return null;try{return ds.credential(t,r)}catch{return null}}}ds.TWITTER_SIGN_IN_METHOD="twitter.com";ds.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function KF(n,e){return Rd(n,"POST","/v1/accounts:signUp",js(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class za{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,s=!1){const a=await hi._fromIdTokenResponse(e,r,s),c=J1(r);return new za({user:a,providerId:c,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);const s=J1(r);return new za({user:e,providerId:s,_tokenResponse:r,operationType:t})}}function J1(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rf extends Ui{constructor(e,t,r,s){var a;super(t.code,t.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,rf.prototype),this.customData={appName:e.name,tenantId:(a=e.tenantId)!==null&&a!==void 0?a:void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,s){return new rf(e,t,r,s)}}function tj(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(a=>{throw a.code==="auth/multi-factor-auth-required"?rf._fromErrorAndOperation(n,a,e,r):a})}async function QF(n,e,t=!1){const r=await yc(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return za._forOperation(n,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function YF(n,e,t=!1){const{auth:r}=n;if(vr(r.app))return Promise.reject(ms(r));const s="reauthenticate";try{const a=await yc(n,tj(r,s,e,n),t);ot(a.idToken,r,"internal-error");const c=T0(a.idToken);ot(c,r,"internal-error");const{sub:d}=c;return ot(n.uid===d,r,"user-mismatch"),za._forOperation(n,s,a)}catch(a){throw(a==null?void 0:a.code)==="auth/user-not-found"&&Xr(r,"user-mismatch"),a}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function nj(n,e,t=!1){if(vr(n.app))return Promise.reject(ms(n));const r="signIn",s=await tj(n,r,e),a=await za._fromIdTokenResponse(n,r,s);return t||await n._updateCurrentUser(a.user),a}async function rj(n,e){return nj(Is(n),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ij(n){const e=Is(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function sj(n,e,t){const r=Is(n);await nf(r,{requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"},"getOobCode",WF)}async function oj(n,e,t){if(vr(n.app))return Promise.reject(ms(n));const r=Is(n),c=await nf(r,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",KF).catch(h=>{throw h.code==="auth/password-does-not-meet-requirements"&&ij(n),h}),d=await za._fromIdTokenResponse(r,"signIn",c);return await r._updateCurrentUser(d.user),d}function aj(n,e,t){return vr(n.app)?Promise.reject(ms(n)):rj(It(n),qa.credential(e,t)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&ij(n),r})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function XF(n,e){return qi(n,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function qy(n,{displayName:e,photoURL:t}){if(e===void 0&&t===void 0)return;const r=It(n),a={idToken:await r.getIdToken(),displayName:e,photoUrl:t,returnSecureToken:!0},c=await yc(r,XF(r.auth,a));r.displayName=c.displayName||null,r.photoURL=c.photoUrl||null;const d=r.providerData.find(({providerId:h})=>h==="password");d&&(d.displayName=r.displayName,d.photoURL=r.photoURL),await r._updateTokensIfNecessary(c)}function lj(n,e,t,r){return It(n).onIdTokenChanged(e,t,r)}function cj(n,e,t){return It(n).beforeAuthStateChanged(e,t)}function zo(n,e,t,r){return It(n).onAuthStateChanged(e,t,r)}function Tr(n){return It(n).signOut()}const sf="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uj{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(sf,"1"),this.storage.removeItem(sf),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JF=1e3,ZF=10;class dj extends uj{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=K2(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const r=this.storage.getItem(t),s=this.localCache[t];r!==s&&e(t,s,r)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((c,d,h)=>{this.notifyListeners(c,h)});return}const r=e.key;t?this.detachListener():this.stopPolling();const s=()=>{const c=this.storage.getItem(r);!t&&this.localCache[r]===c||this.notifyListeners(r,c)},a=this.storage.getItem(r);SF()&&a!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,ZF):s()}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:r}),!0)})},JF)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}dj.type="LOCAL";const hj=dj;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pj extends uj{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}pj.type="SESSION";const I0=pj;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function e4(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hf{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(s=>s.isListeningto(e));if(t)return t;const r=new Hf(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:r,eventType:s,data:a}=t.data,c=this.handlersMap[s];if(!(c!=null&&c.size))return;t.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const d=Array.from(c).map(async m=>m(t.origin,a)),h=await e4(d);t.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:h})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Hf.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function E0(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t4{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let a,c;return new Promise((d,h)=>{const m=E0("",20);s.port1.start();const g=setTimeout(()=>{h(new Error("unsupported_event"))},r);c={messageChannel:s,onMessage(x){const S=x;if(S.data.eventId===m)switch(S.data.status){case"ack":clearTimeout(g),a=setTimeout(()=>{h(new Error("timeout"))},3e3);break;case"done":clearTimeout(a),d(S.data.response);break;default:clearTimeout(g),clearTimeout(a),h(new Error("invalid_response"));break}}},this.handlers.add(c),s.port1.addEventListener("message",c.onMessage),this.target.postMessage({eventType:e,eventId:m,data:t},[s.port2])}).finally(()=>{c&&this.removeMessageHandler(c)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Oi(){return window}function n4(n){Oi().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fj(){return typeof Oi().WorkerGlobalScope<"u"&&typeof Oi().importScripts=="function"}async function r4(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function i4(){var n;return((n=navigator==null?void 0:navigator.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function s4(){return fj()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mj="firebaseLocalStorageDb",o4=1,of="firebaseLocalStorage",gj="fbase_key";class Ad{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function $f(n,e){return n.transaction([of],e?"readwrite":"readonly").objectStore(of)}function a4(){const n=indexedDB.deleteDatabase(mj);return new Ad(n).toPromise()}function Hy(){const n=indexedDB.open(mj,o4);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const r=n.result;try{r.createObjectStore(of,{keyPath:gj})}catch(s){t(s)}}),n.addEventListener("success",async()=>{const r=n.result;r.objectStoreNames.contains(of)?e(r):(r.close(),await a4(),e(await Hy()))})})}async function Z1(n,e,t){const r=$f(n,!0).put({[gj]:e,value:t});return new Ad(r).toPromise()}async function l4(n,e){const t=$f(n,!1).get(e),r=await new Ad(t).toPromise();return r===void 0?null:r.value}function eS(n,e){const t=$f(n,!0).delete(e);return new Ad(t).toPromise()}const c4=800,u4=3;class yj{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Hy(),this.db)}async _withRetries(e){let t=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(t++>u4)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return fj()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Hf._getInstance(s4()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await r4(),!this.activeServiceWorker)return;this.sender=new t4(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((t=r[0])===null||t===void 0)&&t.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||i4()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Hy();return await Z1(e,sf,"1"),await eS(e,sf),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(r=>Z1(r,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(r=>l4(r,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>eS(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const a=$f(s,!1).getAll();return new Ad(a).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:a}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(a)&&(this.notifyListeners(s,a),t.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),t.push(s));return t}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),c4)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}yj.type="LOCAL";const xj=yj;new Cd(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bj(n,e){return e?fs(e):(ot(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C0 extends Uf{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Gl(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Gl(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Gl(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function d4(n){return nj(n.auth,new C0(n),n.bypassAuthState)}function h4(n){const{auth:e,user:t}=n;return ot(t,e,"internal-error"),YF(t,new C0(n),n.bypassAuthState)}async function p4(n){const{auth:e,user:t}=n;return ot(t,e,"internal-error"),QF(t,new C0(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vj{constructor(e,t,r,s,a=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=a,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:r,postBody:s,tenantId:a,error:c,type:d}=e;if(c){this.reject(c);return}const h={auth:this.auth,requestUri:t,sessionId:r,tenantId:a||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(d)(h))}catch(m){this.reject(m)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return d4;case"linkViaPopup":case"linkViaRedirect":return p4;case"reauthViaPopup":case"reauthViaRedirect":return h4;default:Xr(this.auth,"internal-error")}}resolve(e){vs(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){vs(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const f4=new Cd(2e3,1e4);async function $y(n,e,t){if(vr(n.app))return Promise.reject(fi(n,"operation-not-supported-in-this-environment"));const r=Is(n);iF(n,e,j0);const s=bj(r,t);return new ga(r,"signInViaPopup",e,s).executeNotNull()}class ga extends vj{constructor(e,t,r,s,a){super(e,t,s,a),this.provider=r,this.authWindow=null,this.pollId=null,ga.currentPopupAction&&ga.currentPopupAction.cancel(),ga.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return ot(e,this.auth,"internal-error"),e}async onExecution(){vs(this.filter.length===1,"Popup operations only handle one event");const e=E0();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(fi(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(fi(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,ga.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,r;if(!((r=(t=this.authWindow)===null||t===void 0?void 0:t.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(fi(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,f4.get())};e()}}ga.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m4="pendingRedirect",_p=new Map;class g4 extends vj{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=_p.get(this.auth._key());if(!e){try{const r=await y4(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}_p.set(this.auth._key(),e)}return this.bypassAuthState||_p.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function y4(n,e){const t=v4(e),r=b4(n);if(!await r._isAvailable())return!1;const s=await r._get(t)==="true";return await r._remove(t),s}function x4(n,e){_p.set(n._key(),e)}function b4(n){return fs(n._redirectPersistence)}function v4(n){return Tp(m4,n.config.apiKey,n.name)}async function w4(n,e,t=!1){if(vr(n.app))return Promise.reject(ms(n));const r=Is(n),s=bj(r,e),c=await new g4(r,s,t).execute();return c&&!t&&(delete c.user._redirectEventId,await r._persistUserIfCurrent(c.user),await r._setRedirectUser(null,e)),c}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const S4=10*60*1e3;class k4{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!T4(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var r;if(e.error&&!wj(e)){const s=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";t.onError(fi(this.auth,s))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=S4&&this.cachedEventUids.clear(),this.cachedEventUids.has(tS(e))}saveEventToCache(e){this.cachedEventUids.add(tS(e)),this.lastProcessedEventTime=Date.now()}}function tS(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function wj({type:n,error:e}){return n==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function T4(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return wj(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _4(n,e={}){return qi(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const j4=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,I4=/^https?/;async function E4(n){if(n.config.emulator)return;const{authorizedDomains:e}=await _4(n);for(const t of e)try{if(C4(t))return}catch{}Xr(n,"unauthorized-domain")}function C4(n){const e=Vy(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){const c=new URL(n);return c.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&c.hostname===r}if(!I4.test(t))return!1;if(j4.test(n))return r===n;const s=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const R4=new Cd(3e4,6e4);function nS(){const n=Oi().___jsl;if(n!=null&&n.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function A4(n){return new Promise((e,t)=>{var r,s,a;function c(){nS(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{nS(),t(fi(n,"network-request-failed"))},timeout:R4.get()})}if(!((s=(r=Oi().gapi)===null||r===void 0?void 0:r.iframes)===null||s===void 0)&&s.Iframe)e(gapi.iframes.getContext());else if(!((a=Oi().gapi)===null||a===void 0)&&a.load)c();else{const d=AF("iframefcb");return Oi()[d]=()=>{gapi.load?c():t(fi(n,"network-request-failed"))},Y2(`${RF()}?onload=${d}`).catch(h=>t(h))}}).catch(e=>{throw jp=null,e})}let jp=null;function P4(n){return jp=jp||A4(n),jp}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B4=new Cd(5e3,15e3),F4="__/auth/iframe",N4="emulator/auth/iframe",z4={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},D4=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function M4(n){const e=n.config;ot(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?k0(e,N4):`https://${n.config.authDomain}/${F4}`,r={apiKey:e.apiKey,appName:n.name,v:Oa},s=D4.get(n.config.apiHost);s&&(r.eid=s);const a=n._getFrameworks();return a.length&&(r.fw=a.join(",")),`${t}?${dd(r).slice(1)}`}async function L4(n){const e=await P4(n),t=Oi().gapi;return ot(t,n,"internal-error"),e.open({where:document.body,url:M4(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:z4,dontclear:!0},r=>new Promise(async(s,a)=>{await r.restyle({setHideOnLeave:!1});const c=fi(n,"network-request-failed"),d=Oi().setTimeout(()=>{a(c)},B4.get());function h(){Oi().clearTimeout(d),s(r)}r.ping(h).then(h,()=>{a(c)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const O4={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},V4=500,W4=600,U4="_blank",q4="http://localhost";class rS{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function H4(n,e,t,r=V4,s=W4){const a=Math.max((window.screen.availHeight-s)/2,0).toString(),c=Math.max((window.screen.availWidth-r)/2,0).toString();let d="";const h=Object.assign(Object.assign({},O4),{width:r.toString(),height:s.toString(),top:a,left:c}),m=In().toLowerCase();t&&(d=U2(m)?U4:t),V2(m)&&(e=e||q4,h.scrollbars="yes");const g=Object.entries(h).reduce((S,[I,_])=>`${S}${I}=${_},`,"");if(wF(m)&&d!=="_self")return $4(e||"",d),new rS(null);const x=window.open(e||"",d,g);ot(x,n,"popup-blocked");try{x.focus()}catch{}return new rS(x)}function $4(n,e){const t=document.createElement("a");t.href=n,t.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const G4="__/auth/handler",K4="emulator/auth/handler",Q4=encodeURIComponent("fac");async function iS(n,e,t,r,s,a){ot(n.config.authDomain,n,"auth-domain-config-required"),ot(n.config.apiKey,n,"invalid-api-key");const c={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:Oa,eventId:s};if(e instanceof j0){e.setDefaultLanguage(n.languageCode),c.providerId=e.providerId||"",lR(e.getCustomParameters())||(c.customParameters=JSON.stringify(e.getCustomParameters()));for(const[g,x]of Object.entries({}))c[g]=x}if(e instanceof Bc){const g=e.getScopes().filter(x=>x!=="");g.length>0&&(c.scopes=g.join(","))}n.tenantId&&(c.tid=n.tenantId);const d=c;for(const g of Object.keys(d))d[g]===void 0&&delete d[g];const h=await n._getAppCheckToken(),m=h?`#${Q4}=${encodeURIComponent(h)}`:"";return`${Y4(n)}?${dd(d).slice(1)}${m}`}function Y4({config:n}){return n.emulator?k0(n,K4):`https://${n.authDomain}/${G4}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $g="webStorageSupport";class X4{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=I0,this._completeRedirectFn=w4,this._overrideRedirectResult=x4}async _openPopup(e,t,r,s){var a;vs((a=this.eventManagers[e._key()])===null||a===void 0?void 0:a.manager,"_initialize() not called before _openPopup()");const c=await iS(e,t,r,Vy(),s);return H4(e,c,E0())}async _openRedirect(e,t,r,s){await this._originValidation(e);const a=await iS(e,t,r,Vy(),s);return n4(a),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:s,promise:a}=this.eventManagers[t];return s?Promise.resolve(s):(vs(a,"If manager is not set, promise should be"),a)}const r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}async initAndGetManager(e){const t=await L4(e),r=new k4(e);return t.register("authEvent",s=>(ot(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send($g,{type:$g},s=>{var a;const c=(a=s==null?void 0:s[0])===null||a===void 0?void 0:a[$g];c!==void 0&&t(!!c),Xr(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=E4(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return K2()||W2()||_0()}}const Sj=X4;var sS="@firebase/auth",oS="1.10.7";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J4{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){ot(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Z4(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function eN(n){_a(new yo("auth",(e,{options:t})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),a=e.getProvider("app-check-internal"),{apiKey:c,authDomain:d}=r.options;ot(c&&!c.includes(":"),"invalid-api-key",{appName:r.name});const h={apiKey:c,authDomain:d,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Q2(n)},m=new IF(r,s,a,h);return zF(m,t),m},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),_a(new yo("auth-internal",e=>{const t=Is(e.getProvider("auth").getImmediate());return(r=>new J4(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Di(sS,oS,Z4(n)),Di(sS,oS,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tN=5*60,nN=Ck("authIdTokenMaxAge")||tN;let aS=null;const rN=n=>async e=>{const t=e&&await e.getIdTokenResult(),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>nN)return;const s=t==null?void 0:t.token;aS!==s&&(aS=s,await fetch(n,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function gt(n=cx()){const e=vc(n,"auth");if(e.isInitialized())return e.getImmediate();const t=J2(n,{popupRedirectResolver:Sj,persistence:[xj,hj,I0]}),r=Ck("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const a=new URL(r,location.origin);if(location.origin===a.origin){const c=rN(a.toString());cj(t,c,()=>c(t.currentUser)),lj(t,d=>c(d))}}const s=jk("auth");return s&&Z2(t,`http://${s}`),t}function iN(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}EF({loadJS(n){return new Promise((e,t)=>{const r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=s=>{const a=fi("internal-error");a.customData=s,t(a)},r.type="text/javascript",r.charset="UTF-8",iN().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});eN("Browser");const sN=Object.freeze(Object.defineProperty({__proto__:null,ActionCodeURL:qf,AuthCredential:Uf,EmailAuthCredential:xc,EmailAuthProvider:qa,FacebookAuthProvider:cs,GithubAuthProvider:us,GoogleAuthProvider:Bi,OAuthCredential:Wi,OAuthProvider:Kl,TwitterAuthProvider:ds,beforeAuthStateChanged:cj,browserLocalPersistence:hj,browserPopupRedirectResolver:Sj,browserSessionPersistence:I0,connectAuthEmulator:Z2,createUserWithEmailAndPassword:oj,getAuth:gt,getIdTokenResult:D2,inMemoryPersistence:Uy,indexedDBLocalPersistence:xj,initializeAuth:J2,onAuthStateChanged:zo,onIdTokenChanged:lj,prodErrorMap:P2,reload:M2,sendPasswordResetEmail:sj,signInWithCredential:rj,signInWithEmailAndPassword:aj,signInWithPopup:$y,signOut:Tr,updateProfile:qy},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kj="firebasestorage.googleapis.com",Tj="storageBucket",oN=2*60*1e3,aN=10*60*1e3,lN=1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cn extends Ui{constructor(e,t,r=0){super(Gg(e),`Firebase Storage: ${t} (${Gg(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,cn.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Gg(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Jt;(function(n){n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Jt||(Jt={}));function Gg(n){return"storage/"+n}function R0(){const n="An unknown error occurred, please check the error payload for server response.";return new cn(Jt.UNKNOWN,n)}function cN(n){return new cn(Jt.OBJECT_NOT_FOUND,"Object '"+n+"' does not exist.")}function uN(n){return new cn(Jt.QUOTA_EXCEEDED,"Quota for bucket '"+n+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function dN(){const n="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new cn(Jt.UNAUTHENTICATED,n)}function hN(){return new cn(Jt.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function pN(n){return new cn(Jt.UNAUTHORIZED,"User does not have permission to access '"+n+"'.")}function _j(){return new cn(Jt.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function jj(){return new cn(Jt.CANCELED,"User canceled the upload/download.")}function fN(n){return new cn(Jt.INVALID_URL,"Invalid URL '"+n+"'.")}function mN(n){return new cn(Jt.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function gN(){return new cn(Jt.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+Tj+"' property when initializing the app?")}function Ij(){return new cn(Jt.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function yN(){return new cn(Jt.SERVER_FILE_WRONG_SIZE,"Server recorded incorrect upload file size, please retry the upload.")}function xN(){return new cn(Jt.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function bN(n){return new cn(Jt.UNSUPPORTED_ENVIRONMENT,`${n} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function Gy(n){return new cn(Jt.INVALID_ARGUMENT,n)}function Ej(){return new cn(Jt.APP_DELETED,"The Firebase app was deleted.")}function vN(n){return new cn(Jt.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function Hu(n,e){return new cn(Jt.INVALID_FORMAT,"String does not match format '"+n+"': "+e)}function Tu(n){throw new cn(Jt.INTERNAL_ERROR,"Internal error: "+n)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mr{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let r;try{r=Mr.makeFromUrl(e,t)}catch{return new Mr(e,"")}if(r.path==="")return r;throw mN(e)}static makeFromUrl(e,t){let r=null;const s="([A-Za-z0-9.\\-_]+)";function a(X){X.path.charAt(X.path.length-1)==="/"&&(X.path_=X.path_.slice(0,-1))}const c="(/(.*))?$",d=new RegExp("^gs://"+s+c,"i"),h={bucket:1,path:3};function m(X){X.path_=decodeURIComponent(X.path)}const g="v[A-Za-z0-9_]+",x=t.replace(/[.]/g,"\\."),S="(/([^?#]*).*)?$",I=new RegExp(`^https?://${x}/${g}/b/${s}/o${S}`,"i"),_={bucket:1,path:3},R=t===kj?"(?:storage.googleapis.com|storage.cloud.google.com)":t,T="([^?#]*)",A=new RegExp(`^https?://${R}/${s}/${T}`,"i"),F=[{regex:d,indices:h,postModify:a},{regex:I,indices:_,postModify:m},{regex:A,indices:{bucket:1,path:2},postModify:m}];for(let X=0;X<F.length;X++){const ie=F[X],G=ie.regex.exec(e);if(G){const N=G[ie.indices.bucket];let E=G[ie.indices.path];E||(E=""),r=new Mr(N,E),ie.postModify(r);break}}if(r==null)throw fN(e);return r}}class wN{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SN(n,e,t){let r=1,s=null,a=null,c=!1,d=0;function h(){return d===2}let m=!1;function g(...T){m||(m=!0,e.apply(null,T))}function x(T){s=setTimeout(()=>{s=null,n(I,h())},T)}function S(){a&&clearTimeout(a)}function I(T,...A){if(m){S();return}if(T){S(),g.call(null,T,...A);return}if(h()||c){S(),g.call(null,T,...A);return}r<64&&(r*=2);let F;d===1?(d=2,F=0):F=(r+Math.random())*1e3,x(F)}let _=!1;function R(T){_||(_=!0,S(),!m&&(s!==null?(T||(d=2),clearTimeout(s),x(0)):T||(d=1)))}return x(0),a=setTimeout(()=>{c=!0,R(!0)},t),R}function kN(n){n(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TN(n){return n!==void 0}function _N(n){return typeof n=="function"}function jN(n){return typeof n=="object"&&!Array.isArray(n)}function Gf(n){return typeof n=="string"||n instanceof String}function lS(n){return A0()&&n instanceof Blob}function A0(){return typeof Blob<"u"}function cS(n,e,t,r){if(r<e)throw Gy(`Invalid value for '${n}'. Expected ${e} or greater.`);if(r>t)throw Gy(`Invalid value for '${n}'. Expected ${t} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pd(n,e,t){let r=e;return t==null&&(r=`https://${e}`),`${t}://${r}/v0${n}`}function Cj(n){const e=encodeURIComponent;let t="?";for(const r in n)if(n.hasOwnProperty(r)){const s=e(r)+"="+e(n[r]);t=t+s+"&"}return t=t.slice(0,-1),t}var Sa;(function(n){n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT"})(Sa||(Sa={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rj(n,e){const t=n>=500&&n<600,s=[408,429].indexOf(n)!==-1,a=e.indexOf(n)!==-1;return t||s||a}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IN{constructor(e,t,r,s,a,c,d,h,m,g,x,S=!0,I=!1){this.url_=e,this.method_=t,this.headers_=r,this.body_=s,this.successCodes_=a,this.additionalRetryCodes_=c,this.callback_=d,this.errorCallback_=h,this.timeout_=m,this.progressCallback_=g,this.connectionFactory_=x,this.retry=S,this.isUsingEmulator=I,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((_,R)=>{this.resolve_=_,this.reject_=R,this.start_()})}start_(){const e=(r,s)=>{if(s){r(!1,new lp(!1,null,!0));return}const a=this.connectionFactory_();this.pendingConnection_=a;const c=d=>{const h=d.loaded,m=d.lengthComputable?d.total:-1;this.progressCallback_!==null&&this.progressCallback_(h,m)};this.progressCallback_!==null&&a.addUploadProgressListener(c),a.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&a.removeUploadProgressListener(c),this.pendingConnection_=null;const d=a.getErrorCode()===Sa.NO_ERROR,h=a.getStatus();if(!d||Rj(h,this.additionalRetryCodes_)&&this.retry){const g=a.getErrorCode()===Sa.ABORT;r(!1,new lp(!1,null,g));return}const m=this.successCodes_.indexOf(h)!==-1;r(!0,new lp(m,a))})},t=(r,s)=>{const a=this.resolve_,c=this.reject_,d=s.connection;if(s.wasSuccessCode)try{const h=this.callback_(d,d.getResponse());TN(h)?a(h):a()}catch(h){c(h)}else if(d!==null){const h=R0();h.serverResponse=d.getErrorText(),this.errorCallback_?c(this.errorCallback_(d,h)):c(h)}else if(s.canceled){const h=this.appDelete_?Ej():jj();c(h)}else{const h=_j();c(h)}};this.canceled_?t(!1,new lp(!1,null,!0)):this.backoffId_=SN(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&kN(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class lp{constructor(e,t,r){this.wasSuccessCode=e,this.connection=t,this.canceled=!!r}}function EN(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function CN(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function RN(n,e){e&&(n["X-Firebase-GMPID"]=e)}function AN(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function PN(n,e,t,r,s,a,c=!0,d=!1){const h=Cj(n.urlParams),m=n.url+h,g=Object.assign({},n.headers);return RN(g,e),EN(g,t),CN(g,a),AN(g,r),new IN(m,n.method,g,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,s,c,d)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BN(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function FN(...n){const e=BN();if(e!==void 0){const t=new e;for(let r=0;r<n.length;r++)t.append(n[r]);return t.getBlob()}else{if(A0())return new Blob(n);throw new cn(Jt.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function NN(n,e,t){return n.webkitSlice?n.webkitSlice(e,t):n.mozSlice?n.mozSlice(e,t):n.slice?n.slice(e,t):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zN(n){if(typeof atob>"u")throw bN("base-64");return atob(n)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zi={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class Kg{constructor(e,t){this.data=e,this.contentType=t||null}}function DN(n,e){switch(n){case zi.RAW:return new Kg(Aj(e));case zi.BASE64:case zi.BASE64URL:return new Kg(Pj(n,e));case zi.DATA_URL:return new Kg(LN(e),ON(e))}throw R0()}function Aj(n){const e=[];for(let t=0;t<n.length;t++){let r=n.charCodeAt(t);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|r&63);else if((r&64512)===55296)if(!(t<n.length-1&&(n.charCodeAt(t+1)&64512)===56320))e.push(239,191,189);else{const a=r,c=n.charCodeAt(++t);r=65536|(a&1023)<<10|c&1023,e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|r&63)}else(r&64512)===56320?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|r&63)}return new Uint8Array(e)}function MN(n){let e;try{e=decodeURIComponent(n)}catch{throw Hu(zi.DATA_URL,"Malformed data URL.")}return Aj(e)}function Pj(n,e){switch(n){case zi.BASE64:{const s=e.indexOf("-")!==-1,a=e.indexOf("_")!==-1;if(s||a)throw Hu(n,"Invalid character '"+(s?"-":"_")+"' found: is it base64url encoded?");break}case zi.BASE64URL:{const s=e.indexOf("+")!==-1,a=e.indexOf("/")!==-1;if(s||a)throw Hu(n,"Invalid character '"+(s?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let t;try{t=zN(e)}catch(s){throw s.message.includes("polyfill")?s:Hu(n,"Invalid character found")}const r=new Uint8Array(t.length);for(let s=0;s<t.length;s++)r[s]=t.charCodeAt(s);return r}class Bj{constructor(e){this.base64=!1,this.contentType=null;const t=e.match(/^data:([^,]+)?,/);if(t===null)throw Hu(zi.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const r=t[1]||null;r!=null&&(this.base64=VN(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}}function LN(n){const e=new Bj(n);return e.base64?Pj(zi.BASE64,e.rest):MN(e.rest)}function ON(n){return new Bj(n).contentType}function VN(n,e){return n.length>=e.length?n.substring(n.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oo{constructor(e,t){let r=0,s="";lS(e)?(this.data_=e,r=e.size,s=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=s}size(){return this.size_}type(){return this.type_}slice(e,t){if(lS(this.data_)){const r=this.data_,s=NN(r,e,t);return s===null?null:new oo(s)}else{const r=new Uint8Array(this.data_.buffer,e,t-e);return new oo(r,!0)}}static getBlob(...e){if(A0()){const t=e.map(r=>r instanceof oo?r.data_:r);return new oo(FN.apply(null,t))}else{const t=e.map(c=>Gf(c)?DN(zi.RAW,c).data:c.data_);let r=0;t.forEach(c=>{r+=c.byteLength});const s=new Uint8Array(r);let a=0;return t.forEach(c=>{for(let d=0;d<c.length;d++)s[a++]=c[d]}),new oo(s,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fj(n){let e;try{e=JSON.parse(n)}catch{return null}return jN(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WN(n){if(n.length===0)return null;const e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function UN(n,e){const t=e.split("/").filter(r=>r.length>0).join("/");return n.length===0?t:n+"/"+t}function Nj(n){const e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qN(n,e){return e}class lr{constructor(e,t,r,s){this.server=e,this.local=t||e,this.writable=!!r,this.xform=s||qN}}let cp=null;function HN(n){return!Gf(n)||n.length<2?n:Nj(n)}function zj(){if(cp)return cp;const n=[];n.push(new lr("bucket")),n.push(new lr("generation")),n.push(new lr("metageneration")),n.push(new lr("name","fullPath",!0));function e(a,c){return HN(c)}const t=new lr("name");t.xform=e,n.push(t);function r(a,c){return c!==void 0?Number(c):c}const s=new lr("size");return s.xform=r,n.push(s),n.push(new lr("timeCreated")),n.push(new lr("updated")),n.push(new lr("md5Hash",null,!0)),n.push(new lr("cacheControl",null,!0)),n.push(new lr("contentDisposition",null,!0)),n.push(new lr("contentEncoding",null,!0)),n.push(new lr("contentLanguage",null,!0)),n.push(new lr("contentType",null,!0)),n.push(new lr("metadata","customMetadata",!0)),cp=n,cp}function $N(n,e){function t(){const r=n.bucket,s=n.fullPath,a=new Mr(r,s);return e._makeStorageReference(a)}Object.defineProperty(n,"ref",{get:t})}function GN(n,e,t){const r={};r.type="file";const s=t.length;for(let a=0;a<s;a++){const c=t[a];r[c.local]=c.xform(r,e[c.server])}return $N(r,n),r}function Dj(n,e,t){const r=Fj(e);return r===null?null:GN(n,r,t)}function KN(n,e,t,r){const s=Fj(e);if(s===null||!Gf(s.downloadTokens))return null;const a=s.downloadTokens;if(a.length===0)return null;const c=encodeURIComponent;return a.split(",").map(m=>{const g=n.bucket,x=n.fullPath,S="/b/"+c(g)+"/o/"+c(x),I=Pd(S,t,r),_=Cj({alt:"media",token:m});return I+_})[0]}function Mj(n,e){const t={},r=e.length;for(let s=0;s<r;s++){const a=e[s];a.writable&&(t[a.server]=n[a.local])}return JSON.stringify(t)}class Fc{constructor(e,t,r,s){this.url=e,this.method=t,this.handler=r,this.timeout=s,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gs(n){if(!n)throw R0()}function P0(n,e){function t(r,s){const a=Dj(n,s,e);return gs(a!==null),a}return t}function QN(n,e){function t(r,s){const a=Dj(n,s,e);return gs(a!==null),KN(a,s,n.host,n._protocol)}return t}function Bd(n){function e(t,r){let s;return t.getStatus()===401?t.getErrorText().includes("Firebase App Check token is invalid")?s=hN():s=dN():t.getStatus()===402?s=uN(n.bucket):t.getStatus()===403?s=pN(n.path):s=r,s.status=t.getStatus(),s.serverResponse=r.serverResponse,s}return e}function Lj(n){const e=Bd(n);function t(r,s){let a=e(r,s);return r.getStatus()===404&&(a=cN(n.path)),a.serverResponse=s.serverResponse,a}return t}function YN(n,e,t){const r=e.fullServerUrl(),s=Pd(r,n.host,n._protocol),a="GET",c=n.maxOperationRetryTime,d=new Fc(s,a,P0(n,t),c);return d.errorHandler=Lj(e),d}function XN(n,e,t){const r=e.fullServerUrl(),s=Pd(r,n.host,n._protocol),a="GET",c=n.maxOperationRetryTime,d=new Fc(s,a,QN(n,t),c);return d.errorHandler=Lj(e),d}function JN(n,e){return n&&n.contentType||e&&e.type()||"application/octet-stream"}function Oj(n,e,t){const r=Object.assign({},t);return r.fullPath=n.path,r.size=e.size(),r.contentType||(r.contentType=JN(null,e)),r}function ZN(n,e,t,r,s){const a=e.bucketOnlyServerUrl(),c={"X-Goog-Upload-Protocol":"multipart"};function d(){let F="";for(let X=0;X<2;X++)F=F+Math.random().toString().slice(2);return F}const h=d();c["Content-Type"]="multipart/related; boundary="+h;const m=Oj(e,r,s),g=Mj(m,t),x="--"+h+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+g+`\r
--`+h+`\r
Content-Type: `+m.contentType+`\r
\r
`,S=`\r
--`+h+"--",I=oo.getBlob(x,r,S);if(I===null)throw Ij();const _={name:m.fullPath},R=Pd(a,n.host,n._protocol),T="POST",A=n.maxUploadRetryTime,D=new Fc(R,T,P0(n,t),A);return D.urlParams=_,D.headers=c,D.body=I.uploadData(),D.errorHandler=Bd(e),D}class af{constructor(e,t,r,s){this.current=e,this.total=t,this.finalized=!!r,this.metadata=s||null}}function B0(n,e){let t=null;try{t=n.getResponseHeader("X-Goog-Upload-Status")}catch{gs(!1)}return gs(!!t&&(e||["active"]).indexOf(t)!==-1),t}function ez(n,e,t,r,s){const a=e.bucketOnlyServerUrl(),c=Oj(e,r,s),d={name:c.fullPath},h=Pd(a,n.host,n._protocol),m="POST",g={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${r.size()}`,"X-Goog-Upload-Header-Content-Type":c.contentType,"Content-Type":"application/json; charset=utf-8"},x=Mj(c,t),S=n.maxUploadRetryTime;function I(R){B0(R);let T;try{T=R.getResponseHeader("X-Goog-Upload-URL")}catch{gs(!1)}return gs(Gf(T)),T}const _=new Fc(h,m,I,S);return _.urlParams=d,_.headers=g,_.body=x,_.errorHandler=Bd(e),_}function tz(n,e,t,r){const s={"X-Goog-Upload-Command":"query"};function a(m){const g=B0(m,["active","final"]);let x=null;try{x=m.getResponseHeader("X-Goog-Upload-Size-Received")}catch{gs(!1)}x||gs(!1);const S=Number(x);return gs(!isNaN(S)),new af(S,r.size(),g==="final")}const c="POST",d=n.maxUploadRetryTime,h=new Fc(t,c,a,d);return h.headers=s,h.errorHandler=Bd(e),h}const uS=256*1024;function nz(n,e,t,r,s,a,c,d){const h=new af(0,0);if(c?(h.current=c.current,h.total=c.total):(h.current=0,h.total=r.size()),r.size()!==h.total)throw yN();const m=h.total-h.current;let g=m;s>0&&(g=Math.min(g,s));const x=h.current,S=x+g;let I="";g===0?I="finalize":m===g?I="upload, finalize":I="upload";const _={"X-Goog-Upload-Command":I,"X-Goog-Upload-Offset":`${h.current}`},R=r.slice(x,S);if(R===null)throw Ij();function T(X,ie){const G=B0(X,["active","final"]),N=h.current+g,E=r.size();let P;return G==="final"?P=P0(e,a)(X,ie):P=null,new af(N,E,G==="final",P)}const A="POST",D=e.maxUploadRetryTime,F=new Fc(t,A,T,D);return F.headers=_,F.body=R.uploadData(),F.progressCallback=d||null,F.errorHandler=Bd(n),F}const br={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function Qg(n){switch(n){case"running":case"pausing":case"canceling":return br.RUNNING;case"paused":return br.PAUSED;case"success":return br.SUCCESS;case"canceled":return br.CANCELED;case"error":return br.ERROR;default:return br.ERROR}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rz{constructor(e,t,r){if(_N(e)||t!=null||r!=null)this.next=e,this.error=t??void 0,this.complete=r??void 0;else{const a=e;this.next=a.next,this.error=a.error,this.complete=a.complete}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bl(n){return(...e)=>{Promise.resolve().then(()=>n(...e))}}class iz{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Sa.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=Sa.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=Sa.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,t,r,s,a){if(this.sent_)throw Tu("cannot .send() more than once");if(ws(e)&&r&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(t,e,!0),a!==void 0)for(const c in a)a.hasOwnProperty(c)&&this.xhr_.setRequestHeader(c,a[c].toString());return s!==void 0?this.xhr_.send(s):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw Tu("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw Tu("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw Tu("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw Tu("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class sz extends iz{initXhr(){this.xhr_.responseType="text"}}function Wl(){return new sz}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oz{isExponentialBackoffExpired(){return this.sleepTime>this.maxSleepTime}constructor(e,t,r=null){this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=e,this._blob=t,this._metadata=r,this._mappings=zj(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=s=>{if(this._request=void 0,this._chunkMultiplier=1,s._codeEquals(Jt.CANCELED))this._needToFetchStatus=!0,this.completeTransitions_();else{const a=this.isExponentialBackoffExpired();if(Rj(s.status,[]))if(a)s=_j();else{this.sleepTime=Math.max(this.sleepTime*2,lN),this._needToFetchStatus=!0,this.completeTransitions_();return}this._error=s,this._transition("error")}},this._metadataErrorHandler=s=>{this._request=void 0,s._codeEquals(Jt.CANCELED)?this.completeTransitions_():(this._error=s,this._transition("error"))},this.sleepTime=0,this.maxSleepTime=this._ref.storage.maxUploadRetryTime,this._promise=new Promise((s,a)=>{this._resolve=s,this._reject=a,this._start()}),this._promise.then(null,()=>{})}_makeProgressCallback(){const e=this._transferred;return t=>this._updateProgress(e+t)}_shouldDoResumable(e){return e.size()>256*1024}_start(){this._state==="running"&&this._request===void 0&&(this._resumable?this._uploadUrl===void 0?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this.pendingTimeout=setTimeout(()=>{this.pendingTimeout=void 0,this._continueUpload()},this.sleepTime):this._oneShotUpload())}_resolveToken(e){Promise.all([this._ref.storage._getAuthToken(),this._ref.storage._getAppCheckToken()]).then(([t,r])=>{switch(this._state){case"running":e(t,r);break;case"canceling":this._transition("canceled");break;case"pausing":this._transition("paused");break}})}_createResumable(){this._resolveToken((e,t)=>{const r=ez(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),s=this._ref.storage._makeRequest(r,Wl,e,t);this._request=s,s.getPromise().then(a=>{this._request=void 0,this._uploadUrl=a,this._needToFetchStatus=!1,this.completeTransitions_()},this._errorHandler)})}_fetchStatus(){const e=this._uploadUrl;this._resolveToken((t,r)=>{const s=tz(this._ref.storage,this._ref._location,e,this._blob),a=this._ref.storage._makeRequest(s,Wl,t,r);this._request=a,a.getPromise().then(c=>{c=c,this._request=void 0,this._updateProgress(c.current),this._needToFetchStatus=!1,c.finalized&&(this._needToFetchMetadata=!0),this.completeTransitions_()},this._errorHandler)})}_continueUpload(){const e=uS*this._chunkMultiplier,t=new af(this._transferred,this._blob.size()),r=this._uploadUrl;this._resolveToken((s,a)=>{let c;try{c=nz(this._ref._location,this._ref.storage,r,this._blob,e,this._mappings,t,this._makeProgressCallback())}catch(h){this._error=h,this._transition("error");return}const d=this._ref.storage._makeRequest(c,Wl,s,a,!1);this._request=d,d.getPromise().then(h=>{this._increaseMultiplier(),this._request=void 0,this._updateProgress(h.current),h.finalized?(this._metadata=h.metadata,this._transition("success")):this.completeTransitions_()},this._errorHandler)})}_increaseMultiplier(){uS*this._chunkMultiplier*2<32*1024*1024&&(this._chunkMultiplier*=2)}_fetchMetadata(){this._resolveToken((e,t)=>{const r=YN(this._ref.storage,this._ref._location,this._mappings),s=this._ref.storage._makeRequest(r,Wl,e,t);this._request=s,s.getPromise().then(a=>{this._request=void 0,this._metadata=a,this._transition("success")},this._metadataErrorHandler)})}_oneShotUpload(){this._resolveToken((e,t)=>{const r=ZN(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),s=this._ref.storage._makeRequest(r,Wl,e,t);this._request=s,s.getPromise().then(a=>{this._request=void 0,this._metadata=a,this._updateProgress(this._blob.size()),this._transition("success")},this._errorHandler)})}_updateProgress(e){const t=this._transferred;this._transferred=e,this._transferred!==t&&this._notifyObservers()}_transition(e){if(this._state!==e)switch(e){case"canceling":case"pausing":this._state=e,this._request!==void 0?this._request.cancel():this.pendingTimeout&&(clearTimeout(this.pendingTimeout),this.pendingTimeout=void 0,this.completeTransitions_());break;case"running":const t=this._state==="paused";this._state=e,t&&(this._notifyObservers(),this._start());break;case"paused":this._state=e,this._notifyObservers();break;case"canceled":this._error=jj(),this._state=e,this._notifyObservers();break;case"error":this._state=e,this._notifyObservers();break;case"success":this._state=e,this._notifyObservers();break}}completeTransitions_(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start();break}}get snapshot(){const e=Qg(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:e,metadata:this._metadata,task:this,ref:this._ref}}on(e,t,r,s){const a=new rz(t||void 0,r||void 0,s||void 0);return this._addObserver(a),()=>{this._removeObserver(a)}}then(e,t){return this._promise.then(e,t)}catch(e){return this.then(null,e)}_addObserver(e){this._observers.push(e),this._notifyObserver(e)}_removeObserver(e){const t=this._observers.indexOf(e);t!==-1&&this._observers.splice(t,1)}_notifyObservers(){this._finishPromise(),this._observers.slice().forEach(t=>{this._notifyObserver(t)})}_finishPromise(){if(this._resolve!==void 0){let e=!0;switch(Qg(this._state)){case br.SUCCESS:Bl(this._resolve.bind(null,this.snapshot))();break;case br.CANCELED:case br.ERROR:const t=this._reject;Bl(t.bind(null,this._error))();break;default:e=!1;break}e&&(this._resolve=void 0,this._reject=void 0)}}_notifyObserver(e){switch(Qg(this._state)){case br.RUNNING:case br.PAUSED:e.next&&Bl(e.next.bind(e,this.snapshot))();break;case br.SUCCESS:e.complete&&Bl(e.complete.bind(e))();break;case br.CANCELED:case br.ERROR:e.error&&Bl(e.error.bind(e,this._error))();break;default:e.error&&Bl(e.error.bind(e,this._error))()}}resume(){const e=this._state==="paused"||this._state==="pausing";return e&&this._transition("running"),e}pause(){const e=this._state==="running";return e&&this._transition("pausing"),e}cancel(){const e=this._state==="running"||this._state==="pausing";return e&&this._transition("canceling"),e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Da{constructor(e,t){this._service=e,t instanceof Mr?this._location=t:this._location=Mr.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new Da(e,t)}get root(){const e=new Mr(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return Nj(this._location.path)}get storage(){return this._service}get parent(){const e=WN(this._location.path);if(e===null)return null;const t=new Mr(this._location.bucket,e);return new Da(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw vN(e)}}function az(n,e,t){return n._throwIfRoot("uploadBytesResumable"),new oz(n,new oo(e),t)}function lz(n){n._throwIfRoot("getDownloadURL");const e=XN(n.storage,n._location,zj());return n.storage.makeRequestWithTokens(e,Wl).then(t=>{if(t===null)throw xN();return t})}function cz(n,e){const t=UN(n._location.path,e),r=new Mr(n._location.bucket,t);return new Da(n.storage,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uz(n){return/^[A-Za-z]+:\/\//.test(n)}function dz(n,e){return new Da(n,e)}function Vj(n,e){if(n instanceof F0){const t=n;if(t._bucket==null)throw gN();const r=new Da(t,t._bucket);return e!=null?Vj(r,e):r}else return e!==void 0?cz(n,e):n}function hz(n,e){if(e&&uz(e)){if(n instanceof F0)return dz(n,e);throw Gy("To use ref(service, url), the first argument must be a Storage instance.")}else return Vj(n,e)}function dS(n,e){const t=e==null?void 0:e[Tj];return t==null?null:Mr.makeFromBucketSpec(t,n)}function pz(n,e,t,r={}){n.host=`${e}:${t}`;const s=ws(e);s&&(mf(`https://${n.host}/b`),ox("Storage",!0)),n._isUsingEmulator=!0,n._protocol=s?"https":"http";const{mockUserToken:a}=r;a&&(n._overrideAuthToken=typeof a=="string"?a:Rk(a,n.app.options.projectId))}class F0{constructor(e,t,r,s,a,c=!1){this.app=e,this._authProvider=t,this._appCheckProvider=r,this._url=s,this._firebaseVersion=a,this._isUsingEmulator=c,this._bucket=null,this._host=kj,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=oN,this._maxUploadRetryTime=aN,this._requests=new Set,s!=null?this._bucket=Mr.makeFromBucketSpec(s,this._host):this._bucket=dS(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Mr.makeFromBucketSpec(this._url,e):this._bucket=dS(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){cS("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){cS("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(vr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Da(this,e)}_makeRequest(e,t,r,s,a=!0){if(this._deleted)return new wN(Ej());{const c=PN(e,this._appId,r,s,t,this._firebaseVersion,a,this._isUsingEmulator);return this._requests.add(c),c.getPromise().then(()=>this._requests.delete(c),()=>this._requests.delete(c)),c}}async makeRequestWithTokens(e,t){const[r,s]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,r,s).getPromise()}}const hS="@firebase/storage",pS="0.13.13";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wj="storage";function fz(n,e,t){return n=It(n),az(n,e,t)}function mz(n){return n=It(n),lz(n)}function gz(n,e){return n=It(n),hz(n,e)}function yz(n=cx(),e){n=It(n);const r=vc(n,Wj).getImmediate({identifier:e}),s=Ik("storage");return s&&xz(r,...s),r}function xz(n,e,t,r={}){pz(n,e,t,r)}function bz(n,{instanceIdentifier:e}){const t=n.getProvider("app").getImmediate(),r=n.getProvider("auth-internal"),s=n.getProvider("app-check-internal");return new F0(t,r,s,e,Oa)}function vz(){_a(new yo(Wj,bz,"PUBLIC").setMultipleInstances(!0)),Di(hS,pS,""),Di(hS,pS,"esm2017")}vz();const wz={apiKey:"AIzaSyDi9hdqloCIg_8sfjjyERqnfAr-pW3BeNY",authDomain:"restarter-app.firebaseapp.com",projectId:"restarter-app",storageBucket:"restarter-app.firebasestorage.app",messagingSenderId:"393816322828",appId:"1:393816322828:web:32a9ed91fe95ab9cdd8f29",measurementId:"G-CX4DYFJ5B4"},Do=Dk(wz),Ft=kd(Do),ya=gt(Do),Sz=yz(Do),Yg=[{code:"zh-TW",label:"繁中"},{code:"zh-CN",label:"简中"},{code:"en",label:"EN"},{code:"ja",label:"日本語"},{code:"ko",label:"한국어"},{code:"th",label:"ภาษาไทย"},{code:"vi",label:"Tiếng Việt"},{code:"ms",label:"Bahasa Melayu"},{code:"la",label:"Latīna"}],Uj=w.createContext(null),Bt=()=>{const n=w.useContext(Uj);if(!n)throw new Error("useLanguage must be used within a LanguageProvider");return n},kz=({children:n})=>{const[e,t]=w.useState(()=>{try{const a=localStorage.getItem("lang");if(a&&Yg.some(c=>c.code===a))return a}catch(a){console.warn("Failed to read language from localStorage:",a)}return"zh-TW"});w.useEffect(()=>{try{const a=localStorage.getItem("lang");if(a&&Yg.some(m=>m.code===a))return;const c={en:"en","en-US":"en","en-GB":"en","zh-TW":"zh-TW","zh-HK":"zh-TW","zh-Hant":"zh-TW","zh-CN":"zh-CN","zh-Hans":"zh-CN",ja:"ja",ko:"ko",vi:"vi",th:"th",ms:"ms",la:"la"},d=navigator.language||navigator.languages&&navigator.languages[0]||"";let h="en";c[d]?h=c[d]:c[d.split("-")[0]]&&(h=c[d.split("-")[0]]),h!==e&&(t(h),localStorage.setItem("lang",h))}catch(a){console.warn("Failed to detect browser language:",a)}},[e]);const s={lang:e,setLang:a=>{try{t(a),localStorage.setItem("lang",a)}catch(c){console.warn("Failed to save language to localStorage:",c)}},LANGS:Yg};return i.jsx(Uj.Provider,{value:s,children:n})},Mn=({className:n="",style:e={}})=>{const{lang:t,setLang:r,LANGS:s}=Bt(),a={padding:"6px 10px",borderRadius:8,fontWeight:600,fontSize:16,border:"1.5px solid #6B5BFF",color:"#6B5BFF",background:"#fff",cursor:"pointer",transition:"background 0.18s, color 0.18s, border 0.18s",maxWidth:70,...e};return i.jsx("select",{value:t,onChange:c=>r(c.target.value),className:n,style:a,children:s.map(c=>i.jsx("option",{value:c.code,children:c.label},c.code))})},Tz=({isOpen:n,onClose:e,title:t,message:r,requiredPlan:s="basic"})=>{const a=wt();if(!n)return null;const c={basic:"基礎版",advanced:"進階版",professional:"專業版",unlimited:"無限版"};return i.jsx("div",{style:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",background:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e4},children:i.jsxs("div",{style:{background:"#fff",borderRadius:16,padding:32,maxWidth:400,width:"90%",textAlign:"center",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.2)"},children:[i.jsx("div",{style:{fontSize:48,marginBottom:16,color:"#6B5BFF"},children:"🚀"}),i.jsx("h2",{style:{fontSize:24,fontWeight:700,color:"#333",marginBottom:12},children:t}),i.jsx("p",{style:{fontSize:16,color:"#666",marginBottom:20,lineHeight:1.6},children:r}),i.jsxs("div",{style:{background:"linear-gradient(135deg, #f8f9ff 0%, #e8f4ff 100%)",borderRadius:12,padding:16,marginBottom:24,border:"1px solid #e0e8ff"},children:[i.jsx("div",{style:{fontSize:14,color:"#6B5BFF",fontWeight:600,marginBottom:8},children:"💡 升級小提醒"}),i.jsxs("div",{style:{fontSize:13,color:"#666",lineHeight:1.4},children:["• 升級後立即生效，無需等待",i.jsx("br",{}),"• 可隨時取消，權益保留至本期結束",i.jsx("br",{}),"• 支援多種付款方式，安全便捷"]})]}),s&&i.jsx("div",{style:{background:"#fff",borderRadius:10,padding:14,marginBottom:24,border:"2px solid #6B5BFF",boxShadow:"0 2px 8px #6B5BFF22"},children:i.jsxs("span",{style:{fontSize:14,color:"#6B5BFF",fontWeight:700},children:["✨ 建議方案：",c[s]," 或更高"]})}),i.jsxs("div",{style:{display:"flex",gap:12,justifyContent:"center"},children:[i.jsx("button",{onClick:()=>{e(),a("/plans")},style:{background:"linear-gradient(135deg, #6B5BFF 0%, #00CFFF 100%)",color:"#fff",border:"none",borderRadius:12,padding:"14px 28px",fontSize:16,fontWeight:700,cursor:"pointer",flex:1,boxShadow:"0 4px 12px #6B5BFF33",transition:"all 0.3s ease"},onMouseEnter:d=>{d.currentTarget.style.transform="translateY(-2px)",d.currentTarget.style.boxShadow="0 6px 16px #6B5BFF44"},onMouseLeave:d=>{d.currentTarget.style.transform="translateY(0)",d.currentTarget.style.boxShadow="0 4px 12px #6B5BFF33"},children:"🚀 立即升級"}),i.jsx("button",{onClick:e,style:{background:"#f8f9ff",color:"#6B5BFF",border:"2px solid #6B5BFF",borderRadius:12,padding:"14px 28px",fontSize:16,fontWeight:600,cursor:"pointer",flex:1,transition:"all 0.3s ease"},onMouseEnter:d=>{d.currentTarget.style.background="#6B5BFF",d.currentTarget.style.color="#fff"},onMouseLeave:d=>{d.currentTarget.style.background="#f8f9ff",d.currentTarget.style.color="#6B5BFF"},children:"💭 稍後再說"})]})]})})},Mo=({isOpen:n,onClose:e,currentPlan:t,remainingDays:r,usedTokens:s,totalTokens:a})=>{const c=wt();if(!n)return null;const d={basic:"基礎版",advanced:"進階版",professional:"專業版",unlimited:"無限版"},h={basic:"50K",advanced:"100K",professional:"200K",unlimited:"500K"},m={basic:"NT$ 149",advanced:"NT$ 249",professional:"NT$ 349",unlimited:"NT$ 499"},g=()=>{e(),c("/plans")};return i.jsx("div",{style:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",background:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e4},children:i.jsxs("div",{style:{background:"#fff",borderRadius:20,padding:32,maxWidth:480,width:"90%",textAlign:"center",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.2)"},children:[i.jsx("div",{style:{fontSize:48,marginBottom:16,color:"#6B5BFF"},children:"⚡"}),i.jsx("h2",{style:{fontSize:24,fontWeight:700,color:"#333",marginBottom:12},children:"Token 已用完，需要續購嗎？"}),i.jsxs("p",{style:{fontSize:16,color:"#666",marginBottom:20,lineHeight:1.6},children:["您的 ",d[t]," 方案 Token 已用完，但還有 ",r," 天到期。"]}),i.jsxs("div",{style:{background:"linear-gradient(135deg, #f8f9ff 0%, #e8f4ff 100%)",borderRadius:12,padding:16,marginBottom:24,border:"1px solid #e0e8ff"},children:[i.jsx("div",{style:{fontSize:14,color:"#6B5BFF",fontWeight:600,marginBottom:8},children:"📊 本月使用狀況"}),i.jsxs("div",{style:{fontSize:13,color:"#666",lineHeight:1.4},children:["• 已使用：",Math.round(s/1e3),"K / ",Math.round(a/1e3),"K tokens",i.jsx("br",{}),"• 剩餘天數：",r," 天",i.jsx("br",{}),"• 當前方案：",d[t]]})]}),i.jsxs("div",{style:{background:"#fff",borderRadius:12,padding:20,marginBottom:24,border:"2px solid #6B5BFF",boxShadow:"0 2px 8px #6B5BFF22"},children:[i.jsx("div",{style:{fontSize:16,color:"#6B5BFF",fontWeight:700,marginBottom:12},children:"💡 續購方案"}),i.jsxs("div",{style:{fontSize:14,color:"#666",lineHeight:1.5,marginBottom:16},children:[i.jsx("strong",{children:"立即續購："}),"重新獲得 ",h[t]," tokens，",i.jsx("br",{}),"並從今天開始重新計算 ",r," 天使用期"]}),i.jsx("div",{style:{fontSize:18,fontWeight:700,color:"#6B5BFF"},children:m[t]})]}),i.jsxs("div",{style:{background:"linear-gradient(135deg, #fff3cd 0%, #ffeaa7 100%)",borderRadius:12,padding:16,marginBottom:24,border:"1px solid #ffeaa7"},children:[i.jsx("div",{style:{fontSize:14,color:"#856404",fontWeight:600,marginBottom:8},children:"✨ 續購好處"}),i.jsxs("div",{style:{fontSize:13,color:"#856404",lineHeight:1.4},children:["• 立即恢復語音功能使用",i.jsx("br",{}),"• 時間從今天重新計算，更划算",i.jsx("br",{}),"• 文字功能不受影響，可繼續使用"]})]}),i.jsxs("div",{style:{display:"flex",gap:12,justifyContent:"center"},children:[i.jsx("button",{onClick:g,style:{background:"linear-gradient(135deg, #6B5BFF 0%, #00CFFF 100%)",color:"#fff",border:"none",borderRadius:12,padding:"14px 28px",fontSize:16,fontWeight:700,cursor:"pointer",flex:1,boxShadow:"0 4px 12px #6B5BFF33",transition:"all 0.3s ease"},onMouseEnter:x=>{x.currentTarget.style.transform="translateY(-2px)",x.currentTarget.style.boxShadow="0 6px 16px #6B5BFF44"},onMouseLeave:x=>{x.currentTarget.style.transform="translateY(0)",x.currentTarget.style.boxShadow="0 4px 12px #6B5BFF33"},children:"⚡ 立即續購"}),i.jsx("button",{onClick:e,style:{background:"#f8f9ff",color:"#6B5BFF",border:"2px solid #6B5BFF",borderRadius:12,padding:"14px 28px",fontSize:16,fontWeight:600,cursor:"pointer",flex:1,transition:"all 0.3s ease"},onMouseEnter:x=>{x.currentTarget.style.background="#6B5BFF",x.currentTarget.style.color="#fff"},onMouseLeave:x=>{x.currentTarget.style.background="#f8f9ff",x.currentTarget.style.color="#6B5BFF"},children:"💫 稍後再說"})]}),i.jsx("div",{style:{marginTop:16},children:i.jsx("button",{onClick:e,style:{background:"none",border:"none",color:"#888",fontSize:14,cursor:"pointer",textDecoration:"underline"},children:"稍後再說"})})]})})},_z={"zh-TW":{slogan:["找回信任的起點，重新出發不孤單！"],desc:"Restarter™ 重啟人生的平台，在這裡你絕不會被標籤，只被理解與支持。讓AI陪你對話、練習挑戰、交朋友，找到信任與改變的力量。你可以放心說出自己的故事與心情，這裡有理解與同行。",wall:"你可以放心說出自己的故事與心情，這裡有理解與同行。",friend:"交友區",voice:"即時語音輸入",ai:"AI 風格回覆",tts:"擬真語音輸出",chat:"來聊天吧！",emotion:"情緒圖像實驗室",welcomeRegister:"歡迎註冊"},"zh-CN":{slogan:["找回信任的起点，重新出发不孤单！"],desc:"Restarter™ 重启人生的平台，在这里你绝不会被标签，只被理解与支持。让AI陪你对话、练习挑战、交朋友，找到信任与改变的力量。你可以放心说出自己的故事与心情，这里有理解与同行。",wall:"你可以放心说出自己的故事与心情，这里有理解与同行。",friend:"交友区",voice:"即时语音输入",ai:"AI 风格回复",tts:"拟真语音输出",chat:"来聊天吧！",emotion:"情绪图像实验室",welcomeRegister:"欢迎注册"},en:{slogan:["Regain trust and start anew, you are never alone!"],desc:"Restarter™ is a platform for restarting your life. Here, you will never be labeled, only understood and supported. Let AI accompany you in conversations, practice challenges, make friends, and find the power of trust and change. You can safely share your stories and feelings—here, you are understood and never alone.",wall:"You can safely share your story and feelings here, where you will find understanding and companionship.",friend:"Friend Match",voice:"Voice Input",ai:"AI Style Reply",tts:"Realistic TTS",chat:"Let's Chat!",emotion:"Emotion Visual Lab",welcomeRegister:"Welcome Register"},ja:{slogan:["信頼を取り戻し、新たな一歩を踏み出そう！"],desc:"Restarter™は人生を再出発するためのプラットフォームです。ここでは決してラベルを貼られることはなく、理解とサポートだけがあります。AIと一緒に対話し、挑戦を練習し、友達を作り、信頼と変化の力を見つけましょう。自分のストーリーや気持ちを安心して話せる場所、それがここです。",wall:"ここでは安心して自分のストーリーや気持ちを話せます。理解と共感がここにあります。",friend:"友達マッチ",voice:"音声入力",ai:"AIスタイル返信",tts:"リアルTTS",chat:"話しましょう！",emotion:"感情ビジュアルラボ",welcomeRegister:"登録へようこそ"},ko:{slogan:["신뢰를 되찾고, 새롭게 시작하세요. 당신은 결코 혼자가 아닙니다!"],desc:"Restarter™는 인생을 재시작하는 플랫폼입니다. 이곳에서는 결코 낙인찍히지 않고, 오직 이해와 지지만이 있습니다. AI와 함께 대화하고, 도전을 연습하며, 친구를 사귀고, 신뢰와 변화의 힘을 찾아보세요. 자신의 이야기와 감정을 안심하고 말할 수 있는 곳, 바로 여기입니다.",wall:"여기서는 자신의 이야기와 감정을 안심하고 말할 수 있습니다. 이곳에는 이해와 동행이 있습니다.",friend:"친구 매칭",voice:"음성 입력",ai:"AI 스타일 답장",tts:"현실적인 TTS",chat:"채팅하자!",emotion:"감정 비주얼 랩",welcomeRegister:"가입 환영"},th:{slogan:["เริ่มต้นใหม่ด้วยความไว้วางใจ คุณไม่ได้อยู่คนเดียว!"],desc:"Restarter™ คือแพลตฟอร์มสำหรับเริ่มต้นชีวิตใหม่ ที่นี่คุณจะไม่ถูกตัดสิน มีแต่ความเข้าใจและการสนับสนุน ให้ AI อยู่เป็นเพื่อนคุย ฝึกฝนความท้าทาย หาเพื่อนใหม่ และค้นพบพลังแห่งความไว้วางใจและการเปลี่ยนแปลง คุณสามารถพูดเรื่องราวและความรู้สึกของตัวเองได้อย่างสบายใจ ที่นี่มีแต่ความเข้าใจและเพื่อนร่วมทาง",wall:"คุณสามารถพูดเรื่องราวและความรู้สึกของคุณได้อย่างสบายใจ ที่นี่มีความเข้าใจและเพื่อนร่วมทาง",friend:"จับคู่เพื่อน",voice:"ป้อนข้อมูลด้วยเสียง",ai:"ตอบกลับสไตล์ AI",tts:"TTS ที่สมจริง",chat:"มาคุยกันเถอะ!",emotion:"ห้องทดลองภาพอารมณ์",welcomeRegister:"ยินดีต้อนรับการลงทะเบียน"},vi:{slogan:["Tìm lại niềm tin, bắt đầu lại, bạn không bao giờ đơn độc!"],desc:"Restarter™ là nền tảng để làm lại cuộc đời. Ở đây bạn sẽ không bao giờ bị gán nhãn, chỉ có sự thấu hiểu và hỗ trợ. Hãy để AI đồng hành cùng bạn trò chuyện, luyện tập, kết bạn và tìm thấy sức mạnh của niềm tin và sự thay đổi. Bạn có thể yên tâm chia sẻ câu chuyện và cảm xúc của mình, ở đây luôn có sự thấu hiểu và đồng hành.",wall:"Bạn có thể yên tâm chia sẻ câu chuyện và cảm xúc của mình tại đây, nơi có sự thấu hiểu và đồng hành.",friend:"Ghép bạn bè",voice:"Nhập liệu bằng giọng nói",ai:"Trả lời theo phong cách AI",tts:"TTS thực tế",chat:"Hãy trò chuyện!",emotion:"Phòng thí nghiệm hình ảnh cảm xúc",welcomeRegister:"Chào mừng đăng ký"},ms:{slogan:["Temui semula kepercayaan, mulakan semula, anda tidak pernah keseorangan!"],desc:"Restarter™ ialah platform untuk memulakan semula kehidupan. Di sini anda tidak akan pernah dilabel, hanya difahami dan disokong. Biarkan AI menemani anda berbual, berlatih, berkawan dan temui kekuatan kepercayaan dan perubahan. Anda boleh berkongsi kisah dan perasaan anda dengan tenang, di sini ada pemahaman dan teman seperjalanan.",wall:"Anda boleh berkongsi kisah dan perasaan anda dengan tenang di sini, di mana ada pemahaman dan teman seperjalanan.",friend:"Padanan Rakan",voice:"Input Suara",ai:"Balasan Gaya AI",tts:"TTS Realistik",chat:"Jom Sembang!",emotion:"Makmal Visual Emosi",welcomeRegister:"Selamat Datang Daftar"},la:{slogan:["Fidem recupera et iterum incipe, numquam solus es!"],desc:"Restarter™ est suggestum ad vitam iterum incipiendam. Hic numquam notaberis, sed tantum intelligetur et sustineberis. Sinite AI tecum colloqui, exercere, amicos facere, vim fiduciae et mutationis invenire.",wall:"Hic tuto fabulas tuas et sensus tuos narrare potes: hic intellectus et comitatus invenies.",friend:"Par Amicus",voice:"Vox Input",ai:"AI Stylus Responsio",tts:"Verus TTS",chat:"Loquamur!",emotion:"Emotion Visual Lab",welcomeRegister:"Benevenite Registrare"}},fS={"zh-TW":"🧑‍🤝‍🧑","zh-CN":"🧑‍🤝‍🧑",en:"🧑‍🤝‍🧑",ja:"🧑‍🤝‍🧑",ko:"🧑‍🤝‍🧑",th:"🧑‍🤝‍🧑",vi:"🧑‍🤝‍🧑",ms:"🧑‍🤝‍🧑",la:"🧑‍🤝‍🧑"},mS={"zh-TW":"個人管理中心","zh-CN":"个人管理中心",en:"Profile Management",ja:"プロフィール管理",ko:"프로필 관리",th:"จัดการโปรไฟล์",vi:"Quản lý hồ sơ",ms:"Pengurusan Profil",la:"Administratio Profili"},gS={"zh-TW":"會員權益","zh-CN":"会员权益",en:"Member Benefits",ja:"会員特典",ko:"회원 혜택",th:"สิทธิ์สมาชิก",vi:"Quyền lợi thành viên",ms:"Faedah Ahli",la:"Beneficia Sodalis"};function jz(){const n=wt(),{lang:e,setLang:t}=Bt(),r=_z[e],s=w.useRef(null),a=w.useRef(null),[c,d]=w.useState(0),h=gt(Do),[m,g]=w.useState(h.currentUser),[x,S]=w.useState(!1),[I,_]=w.useState(!1),[R,T]=w.useState(!1),[A,D]=w.useState(!1),[F,X]=w.useState({title:"",message:"",requiredPlan:"basic"}),{isTestMode:ie}=RI(),[G,N]=w.useState(!1),[E,P]=w.useState({currentPlan:"basic",remainingDays:0,usedTokens:0,totalTokens:0}),[M,O]=w.useState(()=>typeof window<"u"?window.innerWidth<=768:!1);w.useEffect(()=>{const ne=()=>O(window.innerWidth<=768);return ne(),window.addEventListener("resize",ne),()=>window.removeEventListener("resize",ne)},[]);const z=[{key:"echo-box",icon:"🎤",title:{"zh-TW":"心聲釋放","zh-CN":"心声释放",ja:"心の声を解放",en:"Voice Release",ko:"마음의 소리 해방",th:"ปลดปล่อยเสียงในใจ",vi:"Giải Phóng Tiếng Lòng",ms:"Pelepasan Suara Hati",la:"Vox Liberatio"},desc:{"zh-TW":"你可盡情說出心裡對某些人事物的不滿，釋放後或許有解方，天下沒有不能解決的難題","zh-CN":"你可尽情说出心里对某些人事物的不满，释放后或许有解方，天下没有不能解决的难题",ja:"心の中の特定の人や物事への不満を自由に言い、解放後には解決策があるかもしれない、解決できない問題はない",en:"You can freely speak out your dissatisfaction with certain people or things, after release there may be a solution, there is no problem that cannot be solved",ko:"마음속 특정 사람이나 사물에 대한 불만을 자유롭게 말하고, 해방 후에는 해결책이 있을지도 모르며, 해결할 수 없는 문제는 없다",th:"คุณสามารถพูดความไม่พอใจต่อคนหรือสิ่งต่างๆ ได้อย่างอิสระ หลังปลดปล่อยแล้วอาจมีวิธีแก้ไข ไม่มีปัญหาที่แก้ไขไม่ได้",vi:"Bạn có thể tự do nói ra sự bất mãn với những người hoặc sự việc cụ thể, sau khi giải phóng có thể có giải pháp, không có vấn đề nào không thể giải quyết",ms:"Anda boleh bebas mengucapkan ketidakpuasan terhadap orang atau perkara tertentu, selepas melepaskan mungkin ada penyelesaian, tiada masalah yang tidak dapat diselesaikan",la:"Libere dissatisfactionem cum hominibus vel rebus certis profer, post liberationem fortasse solutio est, nulla quaestio insolubilis est"},path:"/echo-box"},{key:"restart-wall",icon:"🧱",title:{"zh-TW":"情緒重啟牆","zh-CN":"情绪重启墙",ja:"感情リスタートウォール",en:"Emotional Restart Wall",ko:"감정 재시작 벽",th:"กำแพงรีสตาร์ทอารมณ์",vi:"Tường Khởi Động Lại Cảm Xúc",ms:"Dinding Restart Emosi",la:"Murus Restart Affectus"},desc:{"zh-TW":"舒暢分享心情，獲得支持與理解","zh-CN":"舒畅分享心情，获得支持与理解",ja:"気持ちを快く共有し、サポートと理解を得る",en:"Share feelings comfortably, get support and understanding",ko:"편안하게 감정을 공유하고 지원과 이해를 받으세요",th:"แบ่งปันความรู้สึกอย่างสบายใจ รับการสนับสนุนและความเข้าใจ",vi:"Chia sẻ cảm xúc thoải mái, nhận được hỗ trợ và thấu hiểu",ms:"Kongsi perasaan dengan selesa, dapatkan sokongan dan pemahaman",la:"Sensus libere partiri, auxilium et intelligentiam accipe"},path:"/wall"},{key:"my-story",icon:"📖",title:{"zh-TW":"我的里程碑","zh-CN":"我的里程碑",ja:"私のマイルストーン",en:"My Milestones",ko:"내 이정표",th:"เหตุการณ์สำคัญของฉัน",vi:"Cột Mốc Của Tôi",ms:"Pencapaian Saya",la:"Mea Milestones"},desc:{"zh-TW":"記錄個人成長里程碑，見證改變歷程","zh-CN":"记录个人成长里程碑，见证改变历程",ja:"個人の成長マイルストーンを記録し、変化の過程を目撃",en:"Record personal growth milestones, witness the journey of change",ko:"개인 성장의 이정표를 기록하고 변화의 여정을 목격하세요",th:"บันทึกเหตุการณ์สำคัญของการเติบโตส่วนบุคคล เป็นพยานในการเดินทางแห่งการเปลี่ยนแปลง",vi:"Ghi lại các cột mốc phát triển cá nhân, chứng kiến hành trình thay đổi",ms:"Rekod pencapaian pertumbuhan peribadi, saksikan perjalanan perubahan",la:"Milestones crescendi personalis inscribe, iter mutationis testare"},path:"/my-story"},{key:"journal",icon:"🌳",title:{"zh-TW":"心情解鎖盒","zh-CN":"心情解锁盒",ja:"気持ちアンロックボックス",en:"Mood Unlock Box",ko:"감정 언락 박스",th:"กล่องปลดล็อกอารมณ์",vi:"Hộp Mở Khóa Cảm Xúc",ms:"Kotak Buka Kunci Emosi",la:"Arca Unlock Affectus"},desc:{"zh-TW":"每天記錄心情，解鎖拼圖碎片，拼出完整的自己！","zh-CN":"每天记录心情，解锁拼图碎片，拼出完整的自己！",ja:"毎日気持ちを記録して、パズルのピースをアンロックし、完全な自分を完成させよう！",en:"Record your mood daily, unlock puzzle pieces, and piece together your complete self!",ko:"매일 기분을 기록하고 퍼즐 조각을 열어 완전한 자신을 완성하세요!",th:"บันทึกอารมณ์ทุกวัน ปลดล็อกชิ้นส่วนจิ๊กซอว์ และต่อภาพตัวเองที่สมบูรณ์!",vi:"Ghi lại tâm trạng mỗi ngày, mở khóa các mảnh ghép, và ghép thành hình ảnh hoàn chỉnh của chính mình!",ms:"Catat perasaan setiap hari, buka kepingan teka-teki, dan lengkapkan diri anda yang sempurna!",la:"Cotidie animum inscribe, fragmenta aenigmatis solve, et te ipsum perfectum compone!"},path:"/journal"},{key:"missions",icon:"🎯",title:{"zh-TW":"挑戰任務","zh-CN":"挑战任务",en:"Challenge Missions",ja:"ミッションに挑戦",ko:"임무 도전",th:"ท้าทายภารกิจ",vi:"Thử thách nhiệm vụ",ms:"Cabaran Misi",la:"Provocatio Missionum"},desc:{"zh-TW":"五站重啟路，讓你更堅強","zh-CN":"五站重启路，让你更坚强",en:"Five-Station Restart Journey, Make You Stronger",ja:"五つのステーション再起動の道、あなたをより強くする",ko:"다섯 단계 재시작 여정, 당신을 더 강하게 만들어요",th:"เส้นทางรีสตาร์ทห้าสถานี ทำให้คุณแข็งแกร่งขึ้น",vi:"Hành trình khởi động lại năm trạm, làm cho bạn mạnh mẽ hơn",ms:"Perjalanan Restart Lima Stesen, Membuat Anda Lebih Kuat",la:"Iter Restart Quinque Stationum, Te Fortiorem Facit"},path:"/restart-missions"},{key:"storywall",icon:"📖",title:{"zh-TW":"我是誰故事鏈","zh-CN":"我是誰故事鏈",ja:"ストーリーウォール",en:"Story Wall",ko:"스토리 월",th:"กำแพงเรื่องราว",vi:"Tường Truyện",ms:"Dinding Cerita",la:"Murus Fabularum"},desc:{"zh-TW":"分享故事，建立連結","zh-CN":"分享故事，建立连接",ja:"ストーリーを共有し、つながりを築く",en:"Share Stories, Build Connections",ko:"이야기를 공유하고 연결을 구축",th:"แบ่งปันเรื่องราว สร้างการเชื่อมต่อ",vi:"Chia sẻ câu chuyện, xây dựng kết nối",ms:"Kongsi cerita, bina hubungan",la:"Fabulas partiri, nexus construere"},path:"/storywall"},{key:"skillbox",icon:"🛠️",title:{"zh-TW":"社會模擬所","zh-CN":"技能方块",ja:"スキルボックス",en:"Skill Box",ko:"스킬 박스",th:"กล่องทักษะ",vi:"Hộp Kỹ Năng",ms:"Kotak Kemahiran",la:"Arca Peritiae"},desc:{"zh-TW":"練習社會互動，解鎖成就","zh-CN":"练习社会互动，解锁成就",en:"Practice social skills, unlock achievements",ja:"社会スキル練習で実績解除",ko:"사회적 기술 연습, 업적 잠금 해제",th:"ฝึกฝนทักษะทางสังคม, ปลดล็อกความสำเร็จ",vi:"Thực hành kỹ năng xã hội, mở khóa thành tích",ms:"Latih kemahiran sosial, buka pencapaian",la:"Practice social skills, unlock achievements"},path:"/skillbox"},{key:"emotionRelease",icon:"🎮",title:{"zh-TW":"情緒發洩區","zh-CN":"情绪发泄区",ja:"感情発散エリア",en:"Emotion Release Zone",ko:"감정 발산 구역",th:"พื้นที่ระบายอารมณ์",vi:"Khu Vực Giải Tỏa Cảm Xúc",ms:"Zon Pelepasan Emosi",la:"Zona Emotio Liberationis"},desc:{"zh-TW":"透過遊戲釋放壓力，找回平靜","zh-CN":"通过游戏释放压力，找回平静",en:"Release stress through games, find peace",ja:"ゲームでストレスを発散し、平静を取り戻す",ko:"게임으로 스트레스를 해소하고 평온을 찾으세요",th:"ปลดปล่อยความเครียดผ่านเกม หาความสงบ",vi:"Giải tỏa căng thẳng qua trò chơi, tìm lại bình yên",ms:"Lepaskan tekanan melalui permainan, temui ketenangan",la:"Libera tensionem per ludos, inveni pacem"},path:"/emotion-release"}];w.useLayoutEffect(()=>{if(s.current&&a.current){const ne=s.current.getBoundingClientRect().top,W=a.current.getBoundingClientRect().top,$=s.current.getBoundingClientRect().height,ee=a.current.getBoundingClientRect().height;d(ne+$-(W+ee))}},[e]),w.useEffect(()=>{const ne=zo(h,W=>{g(W),S(!0)});return()=>ne()},[h]);const j=w.useRef(null);w.useEffect(()=>{if(!I)return;const ne=W=>{j.current&&!j.current.contains(W.target)&&_(!1)};return document.addEventListener("mousedown",ne),()=>document.removeEventListener("mousedown",ne)},[I]);const K=ne=>{n("/chat")},Z={"zh-TW":"登出","zh-CN":"登出",en:"Logout",ja:"ログアウト",ko:"로그아웃",th:"ออกจากระบบ",vi:"Đăng xuất",ms:"Keluar",la:"Exire"},Y={"zh-TW":"互相幫助&合作實驗室","zh-CN":"互相帮助&合作实验室",en:"Mutual Help & Collaboration Lab",ja:"相互支援＆協力ラボ",ko:"상호도움&협력실험실",th:"ห้องทดลองช่วยเหลือและร่วมมือ",vi:"Phòng thí nghiệm Hỗ trợ & Hợp tác",ms:"Makmal Bantuan & Kerjasama",la:"Laboratorium Auxilii Mutui et Cooperationis"},se={"zh-TW":{title:"請先註冊/登入才能使用此功能",btn:"前往註冊/登入",close:"關閉"},"zh-CN":{title:"请先注册/登录才能使用此功能",btn:"前往注册/登录",close:"关闭"},en:{title:"Please register/login to use this feature",btn:"Go to Register/Login",close:"Close"},ja:{title:"ご利用には登録/ログインが必要です",btn:"登録/ログインへ",close:"閉じる"},ko:{title:"이 기능을 사용하려면 가입/로그인 해주세요",btn:"가입/로그인으로 이동",close:"닫기"},th:{title:"กรุณาสมัคร/เข้าสู่ระบบก่อนใช้ฟีเจอร์นี้",btn:"ไปที่สมัคร/เข้าสู่ระบบ",close:"ปิด"},vi:{title:"Vui lòng đăng ký/đăng nhập để sử dụng chức năng này",btn:"Đến đăng ký/đăng nhập",close:"Đóng"},ms:{title:"Sila daftar/log masuk untuk menggunakan ciri ini",btn:"Pergi ke Daftar/Log Masuk",close:"Tutup"},la:{title:"Quaeso registra/aperi ut hoc munus utaris",btn:"Ad registra/login",close:"Claude"}}[e],re=async(ne,W)=>{if(!m){T(!0);return}if(ie){ne();return}if(W)try{const $=await fetch("/api/subscription/check-permission",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:m.uid,feature:W})});if(!$.ok)throw new Error("權限檢查失敗");const ee=await $.json();if(!ee.allowed){ee.canRenew?(P({currentPlan:ee.currentPlan,remainingDays:ee.remainingDays,usedTokens:ee.usedTokens,totalTokens:ee.totalTokens}),N(!0)):(X({title:"功能需要升級",message:ee.reason||"此功能需要升級訂閱才能使用",requiredPlan:ee.requiredPlan||"basic"}),D(!0));return}}catch($){console.error("權限檢查錯誤:",$)}ne()};return x?i.jsxs("div",{style:{position:"relative",minHeight:"100vh"},children:[M?i.jsxs("div",{style:{position:"fixed",top:0,left:0,right:0,zIndex:100,background:"rgba(255,255,255,0.95)",padding:"8px 16px",display:"flex",justifyContent:"space-between",alignItems:"center",boxShadow:"0 2px 8px #0001"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[i.jsx("img",{src:"/ctx-logo.png",alt:"logo",style:{width:72,height:72,cursor:"pointer"},onClick:()=>n("/")}),i.jsx("span",{style:{fontSize:14,fontWeight:700,color:"#6B5BFF"},children:"Restarter™"})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[m?i.jsxs(i.Fragment,{children:[i.jsx("img",{src:m.photoURL||"/ctx-logo.png",alt:"avatar",style:{width:28,height:28,borderRadius:"50%",objectFit:"cover",border:"2px solid #6B5BFF"}}),i.jsx("span",{style:{color:"#6B5BFF",fontWeight:600,fontSize:12,maxWidth:60,overflow:"hidden",textOverflow:"ellipsis"},children:m.displayName||m.email||"用戶"}),i.jsx("button",{className:"topbar-btn",onClick:async()=>{await Tr(h)},style:{background:"#fff",color:"#ff6347",border:"1px solid #ff6347",borderRadius:6,fontWeight:600,fontSize:12,padding:"4px 8px"},children:Z[e]})]}):i.jsx("button",{className:"topbar-btn",onClick:()=>n("/register"),style:{background:"#fff",color:"#1976d2",border:"1px solid #1976d2",borderRadius:6,fontWeight:600,fontSize:12,padding:"4px 8px"},children:e==="zh-TW"?"註冊":e==="zh-CN"?"注册":e==="en"?"Register":e==="ja"?"登録":e==="ko"?"가입":e==="th"?"สมัคร":e==="vi"?"Đăng ký":e==="ms"?"Daftar":"Registrare"}),i.jsx(Mn,{style:{width:"80px",fontSize:14,padding:"6px 10px"}})]})]}):i.jsxs("div",{style:{position:"fixed",top:24,right:36,zIndex:9999,display:"flex",flexDirection:"row",alignItems:"center",gap:18,pointerEvents:"auto",width:"100%",justifyContent:"flex-end"},children:[i.jsxs("div",{style:{display:"flex",flexDirection:"row",gap:18,marginRight:24},children:[i.jsx("button",{className:"topbar-btn",onClick:()=>n("/about"),style:{background:"#fff",color:"#6B5BFF",border:"2px solid #6B5BFF",borderRadius:8,fontWeight:700,fontSize:16,padding:"8px 14px",minWidth:120},"aria-label":e==="zh-TW"||e==="zh-CN"?"了解 Restarter 平台":e==="en"?"Learn about Restarter platform":e==="ja"?"Restarter プラットフォームについて":e==="ko"?"Restarter 플랫폼에 대해 알아보기":e==="th"?"เรียนรู้เกี่ยวกับแพลตฟอร์ม Restarter":e==="vi"?"Tìm hiểu về nền tảng Restarter":e==="ms"?"Ketahui tentang platform Restarter":"Cognosce de suggestum Restarter",role:"button",children:e==="zh-TW"?"🧬 Restarter™｜我們是誰":e==="zh-CN"?"🧬 Restarter™｜我们是谁":e==="en"?"🧬 Restarter™｜Who We Are":e==="ja"?"🧬 Restarter™｜私たちについて":e==="ko"?"🧬 Restarter™｜우리는 누구인가":e==="th"?"🧬 Restarter™｜เราเป็นใคร":e==="vi"?"🧬 Restarter™｜Chúng tôi là ai":e==="ms"?"🧬 Restarter™｜Siapa Kami":"🧬 Restarter™｜Quis sumus"}),i.jsx("button",{className:"topbar-btn",onClick:()=>n("/feedback"),style:{background:"#fff",color:"#6B5BFF",border:"2px solid #6B5BFF",borderRadius:8,fontWeight:700,fontSize:16,padding:"8px 14px",minWidth:140},"aria-label":e==="zh-TW"?"提供意見和建議":e==="zh-CN"?"提供意见和建议":e==="en"?"Provide feedback and suggestions":e==="ja"?"ご意見やご提案を提供":e==="ko"?"의견과 제안 제공":e==="th"?"ให้ข้อเสนอแนะและคำแนะนำ":e==="vi"?"Cung cấp phản hồi và đề xuất":e==="ms"?"Berikan maklum balas dan cadangan":"Praebe consilia et suggestiones",role:"button",children:e==="zh-TW"?"💬 意見箱｜我們想聽你說":e==="zh-CN"?"💬 意见箱｜我们想听你说":e==="en"?"💬 Feedback｜We Want to Hear You":e==="ja"?"💬 ご意見箱｜あなたの声を聞かせて":e==="ko"?"💬 피드백｜여러분의 의견을 듣고 싶어요":e==="th"?"💬 กล่องความคิดเห็น｜เราอยากฟังคุณ":e==="vi"?"💬 Hộp góp ý｜Chúng tôi muốn lắng nghe bạn":e==="ms"?"💬 Kotak Maklum Balas｜Kami ingin mendengar anda":"💬 Arca Consilii｜Te audire volumus"}),i.jsx("button",{className:"topbar-btn",onClick:()=>n("/token-test"),style:{background:"#fff",color:"#ff6b6b",border:"2px solid #ff6b6b",borderRadius:8,fontWeight:700,fontSize:16,padding:"8px 14px",minWidth:120},"aria-label":"Token 消耗測試",role:"button",children:"🧪 Token 測試"}),m?i.jsx(i.Fragment,{children:i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[i.jsx("img",{src:m.photoURL||"/ctx-logo.png",alt:"avatar",style:{width:36,height:36,borderRadius:"50%",objectFit:"cover",border:"2px solid #90caf9"}}),i.jsx("span",{style:{color:"#1976d2",fontWeight:700,fontSize:16},children:m.displayName||m.email||"用戶"}),i.jsx("button",{className:"topbar-btn",onClick:async()=>{await Tr(h)},style:{background:"#fff",color:"#ff6347",border:"2px solid #ffb4a2",borderRadius:8,fontWeight:700,fontSize:16,padding:"8px 14px",marginLeft:6},children:Z[e]})]})}):i.jsx("button",{className:"topbar-btn",onClick:()=>n("/register"),style:{background:"#fff",color:"#1976d2",border:"2px solid #90caf9",borderRadius:8,fontWeight:700,fontSize:16,padding:"8px 10px",minWidth:90},children:e==="zh-TW"?"註冊/登入":e==="zh-CN"?"注册/登录":e==="en"?"Register / Login":e==="ja"?"登録/ログイン":e==="ko"?"가입/로그인":e==="th"?"สมัคร/เข้าสู่ระบบ":e==="vi"?"Đăng ký/Đăng nhập":e==="ms"?"Daftar / Log Masuk":"Registrare / Login"})]}),i.jsxs("div",{style:{position:"relative",display:"inline-block"},ref:j,children:[i.jsxs("button",{className:"topbar-btn",style:{background:"#6B5BFF",color:"#fff",border:"2px solid #6B5BFF",borderRadius:8,fontWeight:700,fontSize:16,padding:"8px 10px",minWidth:90,maxWidth:120,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},onClick:()=>_(ne=>!ne),children:[e==="zh-TW"?"繁中":e==="zh-CN"?"简中":e==="en"?"English":e==="ja"?"日本語":e==="ko"?"한국어":e==="th"?"ไทย":e==="vi"?"Tiếng Việt":e==="ms"?"Bahasa Melayu":"Latin",i.jsx("span",{style:{marginLeft:6},children:"▼"})]}),I&&i.jsx("div",{style:{position:"absolute",right:0,top:"110%",background:"#fff",border:"1.5px solid #6B5BFF",borderRadius:8,boxShadow:"0 4px 16px #0002",zIndex:9999,minWidth:120},children:["zh-TW","zh-CN","en","ja","ko","th","vi","ms","la"].map(ne=>i.jsx("div",{style:{padding:"10px 18px",cursor:"pointer",color:ne===e?"#6B5BFF":"#232946",fontWeight:ne===e?700:500,background:ne===e?"#f3f0ff":"#fff"},onClick:()=>{t(ne),_(!1)},children:ne==="zh-TW"?"繁中":ne==="zh-CN"?"简中":ne==="en"?"English":ne==="ja"?"日本語":ne==="ko"?"한국어":ne==="th"?"ไทย":ne==="vi"?"Tiếng Việt":"Latin"},ne))})]})]}),M?i.jsxs("div",{style:{width:"100vw",minHeight:"100vh",background:"url('/plains.png') center center/cover no-repeat",display:"flex",flexDirection:"column",alignItems:"center",paddingTop:100},children:[i.jsxs("div",{style:{width:"100%",padding:"20px 16px",textAlign:"center"},children:[i.jsx("div",{style:{marginBottom:16},children:i.jsx("span",{style:{fontWeight:900,color:"#232946",fontSize:16,lineHeight:1.2,letterSpacing:.3,textShadow:"1px 2px 8px #fff",whiteSpace:"nowrap"},children:e==="zh-TW"?"找回信任的起點，重新出發不孤單！":e==="zh-CN"?"找回信任的起点，重新出发不孤单！":e==="en"?"Regain trust and start anew, you are never alone!":e==="ja"?"信頼を取り戻し、新たな一歩を踏み出そう！":e==="ko"?"신뢰를 되찾고, 새롭게 시작하세요. 당신은 결코 혼자가 아닙니다!":e==="th"?"เริ่มต้นใหม่ด้วยความไว้วางใจ คุณไม่ได้อยู่คนเดียว!":e==="vi"?"Tìm lại niềm tin, bắt đầu lại, bạn không bao giờ đơn độc!":e==="ms"?"Temui semula kepercayaan, mulakan semula, anda tidak pernah keseorangan!":"Fidem recupera et iterum incipe, numquam solus es!"})}),i.jsxs("h1",{style:{fontSize:24,fontWeight:900,color:"#fff",marginBottom:12,textShadow:"0 2px 8px #232946"},children:[i.jsx("span",{style:{color:"#6B5BFF"},children:"Restarter™"})," Global Platform"]}),i.jsx("div",{style:{marginBottom:20},children:i.jsx("span",{style:{color:"#232946",fontWeight:500,fontSize:14,lineHeight:1.6},children:e==="zh-TW"?"Restarter™ 重啟人生的平台，在這裡你絕不會被標籤，只被理解與支持。讓AI陪你對話、練習挑戰、交朋友，找到信任與改變的力量。":e==="zh-CN"?"Restarter™ 重启人生的平台，在这里你绝不会被标签，只被理解与支持。让AI陪你对话、练习挑战、交朋友，找到信任与改变的力量。":e==="en"?"Restarter™ is a platform for restarting your life. Here, you will never be labeled, only understood and supported.":e==="ja"?"Restarter™ は人生を再起動するためのプラットフォームです。ここでは決してレッテルを貼られることはなく、理解とサポートだけが得られます。":e==="ko"?"Restarter™는 인생을 재시작하는 플랫폼입니다. 이곳에서는 결코 낙인찍히지 않고, 오직 이해와 지지를 받습니다.":e==="th"?"Restarter™ คือแพลตฟอร์มสำหรับเริ่มต้นชีวิตใหม่ ที่นี่คุณจะไม่ถูกตัดสิน มีแต่ความเข้าใจและการสนับสนุน":"Restarter™ suggestum ad vitam iterum incipiendam est. Hic numquam notaberis, sed tantum intelligetur et sustineberis."})})]}),i.jsxs("div",{style:{width:"100%",padding:"0 16px",display:"flex",flexDirection:"column",gap:12},children:[i.jsxs("div",{style:{display:"flex",flexDirection:"row",gap:8,flexWrap:"wrap"},children:[i.jsxs("button",{className:"feature-btn",style:{flex:1,minWidth:"calc(50% - 4px)",padding:"16px 8px",borderRadius:12,border:"2px solid #6B5BFF",background:"#fff",color:"#6B5BFF",fontWeight:700,fontSize:14,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:4},onClick:()=>re(()=>n("/friend")),children:[i.jsx("span",{style:{fontSize:20},children:fS[e]}),i.jsx("span",{style:{fontSize:12,textAlign:"center"},children:r.friend})]}),i.jsxs("button",{className:"feature-btn",style:{flex:1,minWidth:"calc(50% - 4px)",padding:"16px 8px",borderRadius:12,border:"2px solid #6B5BFF",background:"#fff",color:"#6B5BFF",fontWeight:700,fontSize:14,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:4},onClick:()=>re(()=>K(),"aiChat"),children:[i.jsx("span",{style:{fontSize:20},children:"💬"}),i.jsx("span",{style:{fontSize:12,textAlign:"center"},children:r.chat})]})]}),i.jsx("div",{style:{display:"flex",flexDirection:"row",gap:8,flexWrap:"wrap"},children:z.slice(0,2).map(ne=>i.jsxs("button",{className:"feature-btn",style:{flex:1,minWidth:"calc(50% - 4px)",padding:"16px 8px",borderRadius:12,border:"2px solid #6B5BFF",background:"#fff",color:"#6B5BFF",fontWeight:700,fontSize:14,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:4},onClick:()=>re(()=>n(ne.path)),children:[i.jsx("span",{style:{fontSize:20},children:ne.icon}),i.jsx("span",{style:{fontSize:12,textAlign:"center"},children:ne.title[e]})]},ne.key))}),i.jsx("div",{style:{display:"flex",flexDirection:"row",gap:8,flexWrap:"wrap"},children:z.slice(2,4).map(ne=>i.jsxs("button",{className:"feature-btn",style:{flex:1,minWidth:"calc(50% - 4px)",padding:"16px 8px",borderRadius:12,border:"2px solid #6B5BFF",background:"#fff",color:"#6B5BFF",fontWeight:700,fontSize:14,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:4},onClick:()=>re(()=>n(ne.path)),children:[i.jsx("span",{style:{fontSize:20},children:ne.icon}),i.jsx("span",{style:{fontSize:12,textAlign:"center"},children:ne.title[e]})]},ne.key))}),i.jsxs("div",{style:{display:"flex",flexDirection:"row",gap:8,flexWrap:"wrap"},children:[z.slice(4).map(ne=>i.jsxs("button",{className:"feature-btn",style:{flex:1,minWidth:"calc(50% - 4px)",padding:"16px 8px",borderRadius:12,border:"2px solid #6B5BFF",background:"#fff",color:"#6B5BFF",fontWeight:700,fontSize:14,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:4},onClick:()=>re(()=>n(ne.path)),children:[i.jsx("span",{style:{fontSize:20},children:ne.icon}),i.jsx("span",{style:{fontSize:12,textAlign:"center"},children:ne.title[e]})]},ne.key)),i.jsxs("button",{className:"feature-btn",style:{flex:1,minWidth:"calc(50% - 4px)",padding:"16px 8px",borderRadius:12,background:"linear-gradient(90deg, #ffe0b2 0%, #ffb74d 100%)",color:"#b85c00",border:"2px solid #ffb74d",fontWeight:900,fontSize:14,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:4},onClick:()=>re(()=>n("/HelpLab")),children:[i.jsx("span",{style:{fontSize:20},children:"🧪"}),i.jsx("span",{style:{fontSize:12,textAlign:"center"},children:Y[e]})]})]})]}),i.jsxs("div",{style:{width:"100%",padding:"20px 16px",display:"flex",flexDirection:"column",gap:12,boxSizing:"border-box"},children:[i.jsx("button",{onClick:()=>n("/profile"),style:{width:"100%",padding:"12px",borderRadius:10,border:"2px solid #6B5BFF",background:"#fff",color:"#6B5BFF",fontWeight:700,fontSize:14,cursor:"pointer",boxSizing:"border-box"},children:mS[e]}),i.jsx("a",{href:"/plans",style:{width:"100%",padding:"12px",borderRadius:10,background:"#6B5BFF",color:"#fff",fontWeight:700,fontSize:14,textDecoration:"none",border:"2px solid #6B5BFF",cursor:"pointer",textAlign:"center",display:"block",boxSizing:"border-box"},children:gS[e]})]})]}):i.jsxs("div",{style:{width:"100vw",minHeight:"100vh",background:"url('/plains.png') center center/cover no-repeat",display:"flex",flexDirection:"row",alignItems:"flex-start",justifyContent:"center"},children:[i.jsxs("div",{className:"home-left-col left-relative",style:{flex:1,minWidth:320,maxWidth:600,display:"flex",flexDirection:"column",alignItems:"flex-start",justifyContent:"flex-start",padding:"48px 0 0 0",zIndex:2},children:[i.jsx("div",{className:"fixed-logo-box",style:{position:"fixed",top:16,left:42,display:"flex",flexDirection:"row",alignItems:"center",gap:12,zIndex:1e4,paddingTop:0,marginTop:0},children:i.jsx("img",{src:"/ctx-logo.png",className:"fixed-logo-img",style:{marginBottom:0,width:182,height:182,cursor:"pointer",marginTop:"-40px"},onClick:()=>n("/")})}),i.jsxs("div",{className:"column-content",style:{justifyContent:"center",alignItems:"center",height:"100%",paddingTop:48},children:[i.jsx("div",{style:{width:"100%",maxWidth:900,margin:"0 auto 12px auto",textAlign:"center",wordBreak:"break-word",whiteSpace:"normal"},children:i.jsx("span",{style:{fontWeight:900,color:"#232946",fontSize:20,lineHeight:1.2,letterSpacing:.5,textShadow:"2px 4px 12px #fff, 0 2px 8px #23294688",display:"inline-block",whiteSpace:"nowrap"},children:e==="zh-TW"?"找回信任的起點，重新出發不孤單！":e==="zh-CN"?"找回信任的起点，重新出发不孤单！":e==="en"?"Regain trust and start anew, you are never alone!":e==="ja"?"信頼を取り戻し、新たな一歩を踏み出そう！":e==="ko"?"신뢰를 되찾고, 새롭게 시작하세요. 당신은 결코 혼자가 아닙니다!":e==="th"?"เริ่มต้นใหม่ด้วยความไว้วางใจ คุณไม่ได้อยู่คนเดียว!":e==="vi"?"Tìm lại niềm tin, bắt đầu lại, bạn không bao giờ đơn độc!":e==="ms"?"Temui semula kepercayaan, mulakan semula, anda tidak pernah keseorangan!":"Fidem recupera et iterum incipe, numquam solus es!"})}),i.jsxs("h1",{className:"main-title",style:{position:"relative",left:"0px",fontSize:36,fontWeight:900,color:"#fff",marginBottom:18,textShadow:"0 2px 12px #232946, 0 4px 24px #0008"},children:[i.jsx("span",{style:{color:"#6B5BFF"},children:"Restarter™"})," Global Platform"]}),i.jsx("div",{style:{width:"100%",textAlign:"center",margin:"0 auto",marginBottom:24},children:i.jsx("span",{style:{color:"#232946",fontWeight:500,fontSize:16,lineHeight:1.7,letterSpacing:.5},children:e==="zh-TW"?"Restarter™ 重啟人生的平台，在這裡你絕不會被標籤，只被理解與支持。讓AI陪你對話、練習挑戰、交朋友，找到信任與改變的力量。你可以放心說出自己的故事與心情，釋放不滿有解方，天下沒有解決不了的難題。":e==="zh-CN"?"Restarter™ 重启人生的平台，在这里你绝不会被标签，只被理解与支持。让AI陪你对话、练习挑战、交朋友，找到信任与改变的力量。你可以放心说出自己的故事与心情，释放不满有解方，天下没有解决不了的难题。":e==="en"?"Restarter™ is a platform for restarting your life. Here, you will never be labeled, only understood and supported. Let AI accompany you in conversations, practice challenges, make friends, and find the power of trust and change. You can safely share your stories and feelings—here, you are understood and never alone.":e==="ja"?"Restarter™ は人生を再起動するためのプラットフォームです。ここでは決してレッテルを貼られることはなく、理解とサポートだけが得られます。AIと一緒に会話したり、チャレンジを練習したり、友達を作ったりして、信頼と変化の力を見つけましょう。自分のストーリーや気持ちを安心して話せる場所、それがここです。":e==="ko"?"Restarter™는 인생을 재시작하는 플랫폼입니다. 이곳에서는 결코 낙인찍히지 않고, 오직 이해와 지지를 받습니다. AI와 대화하고, 도전을 연습하고, 친구를 사귀며 신뢰와 변화의 힘을 찾아보세요. 자신의 이야기와 감정을 안심하고 말할 수 있는 곳, 바로 여기입니다.":e==="th"?"Restarter™ คือแพลตฟอร์มสำหรับเริ่มต้นชีวิตใหม่ ที่นี่คุณจะไม่ถูกตัดสิน มีแต่ความเข้าใจและการสนับสนุน ให้ AI อยู่เป็นเพื่อนคุย ฝึกฝนความท้าทาย หาเพื่อนใหม่ และค้นพบพลังแห่งความไว้วางใจและการเปลี่ยนแปลง คุณสามารถพูดเรื่องราวและความรู้สึกของตัวเองได้อย่างสบายใจ ที่นี่มีแต่ความเข้าใจและเพื่อนร่วมทาง":"Restarter™ suggestum ad vitam iterum incipiendam est. Hic numquam notaberis, sed tantum intelligetur et sustineberis. Sine AI tecum colloquere, provocationes exerce, amicos invenias, fidem et mutationis vim reperias. Historias et sensus tuos tuto narrare potes, hic est intelligentia et comitatus."})}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:18,marginBottom:18,justifyContent:"center",width:"100%"},children:[i.jsxs("div",{style:{display:"flex",flexDirection:"row",gap:18,justifyContent:"center"},children:[i.jsxs("button",{className:"feature-btn",style:{fontSize:18,padding:"24px 24px",minWidth:160,minHeight:120,display:"flex",flexDirection:"column",alignItems:"center",gap:8,justifyContent:"center"},onClick:()=>re(()=>n("/friend"),"userInteraction"),"aria-label":e==="zh-TW"?"進入交友區，尋找新朋友，建立支持圈":e==="zh-CN"?"进入交友区，寻找新朋友，建立支持圈":e==="en"?"Enter friend matching area to find new friends and build support circle":e==="ja"?"友達マッチングエリアに入って新しい友達を見つけ、サポートサークルを築く":e==="ko"?"친구 매칭 영역으로 이동하여 새로운 친구를 찾고 지원 서클을 구축":e==="th"?"เข้าสู่พื้นที่จับคู่เพื่อนเพื่อหาเพื่อนใหม่และสร้างวงกลมสนับสนุน":e==="vi"?"Vào khu vực ghép bạn bè để tìm bạn mới và xây dựng vòng tròn hỗ trợ":e==="ms"?"Masuk ke kawasan padanan rakan untuk mencari rakan baru dan membina bulatan sokongan":"Intra in area par amicus ad inveniendos novos amicos et construendam circulum auxilii",role:"button",children:[i.jsx("span",{style:{fontSize:32},children:fS[e]}),i.jsx("span",{style:{fontWeight:700,textAlign:"center",lineHeight:1.2},children:r.friend})]}),z.slice(0,2).map(ne=>i.jsxs("button",{className:"feature-btn",style:{fontSize:18,padding:"24px 24px",minWidth:160,minHeight:120,display:"flex",flexDirection:"column",alignItems:"center",gap:8,justifyContent:"center"},onClick:()=>re(()=>n(ne.path)),"aria-label":ne.desc[e],role:"button",children:[i.jsx("span",{style:{fontSize:32,transform:ne.icon==="🎤"?"translateY(8px)":"none"},children:ne.icon}),i.jsx("span",{style:{fontWeight:700,textAlign:"center",lineHeight:1.2},children:ne.title[e]})]},ne.key))]}),i.jsx("div",{style:{display:"flex",flexDirection:"row",gap:18,justifyContent:"center"},children:z.slice(2,5).map(ne=>i.jsxs("button",{className:"feature-btn",style:{fontSize:18,padding:"24px 24px",minWidth:160,minHeight:120,display:"flex",flexDirection:"column",alignItems:"center",gap:8,justifyContent:"center"},onClick:()=>re(()=>n(ne.path)),"aria-label":ne.desc[e],role:"button",children:[i.jsx("span",{style:{fontSize:32},children:ne.icon}),i.jsx("span",{style:{fontWeight:700,textAlign:"center",lineHeight:1.2},children:ne.title[e]})]},ne.key))}),i.jsxs("div",{style:{display:"flex",flexDirection:"row",gap:18,justifyContent:"center",marginTop:10},children:[i.jsxs("button",{className:"feature-btn",style:{fontSize:18,padding:"24px 24px",minWidth:160,minHeight:120,display:"flex",flexDirection:"column",alignItems:"center",gap:8,justifyContent:"center"},onClick:()=>re(()=>n("/storywall")),"aria-label":e==="zh-TW"?"分享故事，建立連結":e==="zh-CN"?"分享故事，建立连接":e==="en"?"Share Stories, Build Connections":e==="ja"?"ストーリーを共有し、つながりを築く":e==="ko"?"이야기를 공유하고 연결을 구축":e==="th"?"แบ่งปันเรื่องราว สร้างการเชื่อมต่อ":e==="vi"?"Chia sẻ câu chuyện, xây dựng kết nối":e==="ms"?"Kongsi cerita, bina hubungan":"Fabulas partiri, nexus construere",role:"button",children:[i.jsx("span",{style:{fontSize:32},children:"📖"}),i.jsx("span",{style:{fontWeight:700,textAlign:"center",lineHeight:1.2},children:e==="zh-TW"||e==="zh-CN"?"我是誰故事鏈":e==="ja"?"ストーリーウォール":e==="en"?"Story Wall":e==="ko"?"스토리 월":e==="th"?"กำแพงเรื่องราว":e==="vi"?"Tường Truyện":e==="ms"?"Dinding Cerita":"Murus Fabularum"})]}),i.jsxs("button",{className:"feature-btn mutual-help-btn",style:{fontSize:18,padding:"24px 24px",minWidth:180,maxWidth:240,minHeight:120,display:"flex",flexDirection:"column",alignItems:"center",gap:8,justifyContent:"center",background:"linear-gradient(90deg, #ffe0b2 0%, #ffb74d 100%)",color:"#b85c00",border:"2px solid #ffb74d",fontWeight:900,boxShadow:"0 2px 12px #ffb74d55"},onClick:()=>re(()=>n("/HelpLab")),"aria-label":e==="zh-TW"?"提供與獲得幫助，一樣重要":e==="zh-CN"?"提供与获得帮助，一样重要":e==="en"?"Providing and receiving help are equally important":e==="ja"?"助けを提供することと受けることは同じように重要":e==="ko"?"도움을 제공하고 받는 것은 똑같이 중요합니다":e==="th"?"การให้และรับความช่วยเหลือมีความสำคัญเท่ากัน":e==="vi"?"Cung cấp và nhận sự giúp đỡ đều quan trọng như nhau":e==="ms"?"Memberi dan menerima bantuan sama penting":"Auxilium praebere et accipere aequo modo magni momenti sunt",role:"button",children:[i.jsx("span",{style:{fontSize:32},children:"🧪"}),i.jsx("span",{style:{fontWeight:900,color:"#1976d2",textAlign:"center",lineHeight:1.2},children:Y[e]})]}),i.jsxs("button",{className:"feature-btn",style:{fontSize:18,padding:"24px 24px",minWidth:160,minHeight:120,display:"flex",flexDirection:"column",alignItems:"center",gap:8,justifyContent:"center"},onClick:()=>re(()=>n("/emotion-release")),"aria-label":e==="zh-TW"?"透過遊戲釋放壓力，找回平靜":e==="zh-CN"?"通过游戏释放压力，找回平静":e==="en"?"Release stress through games, find peace":e==="ja"?"ゲームでストレスを発散し、平静を取り戻す":e==="ko"?"게임으로 스트레스를 해소하고 평온을 찾으세요":e==="th"?"ปลดปล่อยความเครียดผ่านเกม หาความสงบ":e==="vi"?"Giải tỏa căng thẳng qua trò chơi, tìm lại bình yên":e==="ms"?"Lepaskan tekanan melalui permainan, temui ketenangan":"Libera tensionem per ludos, inveni pacem",role:"button",children:[i.jsx("span",{style:{fontSize:32},children:"🎮"}),i.jsx("span",{style:{fontWeight:700,textAlign:"center",lineHeight:1.2},children:e==="zh-TW"?"情緒發洩區":e==="zh-CN"?"情绪发泄区":e==="ja"?"感情発散エリア":e==="en"?"Emotion Release Zone":e==="ko"?"감정 발산 구역":e==="th"?"พื้นที่ระบายอารมณ์":e==="vi"?"Khu Vực Giải Tỏa Cảm Xúc":e==="ms"?"Zon Pelepasan Emosi":"Zona Emotio Liberationis"})]})]})]})]})]}),i.jsxs("div",{className:"home-right-col",style:{flex:1,minWidth:320,maxWidth:520,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"flex-start",paddingTop:120,zIndex:2},children:[i.jsxs("div",{style:{display:"flex",gap:18,marginBottom:18,justifyContent:"center",width:"100%"},children:[i.jsx("button",{onClick:()=>n("/profile"),style:{background:"#fff",color:"#6B5BFF",border:"2px solid #6B5BFF",borderRadius:10,fontWeight:700,fontSize:18,padding:"10px 28px",boxShadow:"0 2px 8px #6B5BFF22",cursor:"pointer"},children:mS[e]}),i.jsx("a",{href:"/plans",style:{background:"#6B5BFF",color:"#fff",fontWeight:700,fontSize:18,padding:"10px 28px",borderRadius:10,boxShadow:"0 2px 8px #6B5BFF33",textDecoration:"none",border:"2px solid #6B5BFF",cursor:"pointer"},children:gS[e]})]}),i.jsx("img",{src:"/hero-mic.jpg",className:"home-mic-img",style:{marginBottom:0,height:"calc(100vh - 180px)",maxHeight:520,minHeight:320,width:"100%",objectFit:"contain",background:"#232946"}}),i.jsxs("button",{ref:a,className:"feature-btn home-chat-btn",style:{height:120,marginTop:0,marginBottom:0,position:"relative",top:"-60px",gap:8,padding:"24px 24px",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},onClick:()=>re(()=>K(),"aiChat"),"aria-label":e==="zh-TW"?"開始與 AI 聊天對話":e==="zh-CN"?"开始与 AI 聊天对话":e==="en"?"Start chatting with AI":e==="ja"?"AIとのチャットを開始":e==="ko"?"AI와 채팅 시작":e==="th"?"เริ่มแชทกับ AI":e==="vi"?"Bắt đầu trò chuyệnกับ AI":e==="ms"?"Mula berbual dengan AI":"Incipe colloquium cum AI",role:"button",children:[i.jsx("span",{role:"img","aria-label":"chat",style:{fontSize:32},children:"💬"}),i.jsx("span",{className:"home-chat-btn-text",style:{fontWeight:700,textAlign:"center",lineHeight:1.2},children:r.chat})]})]})]}),M?i.jsx("footer",{style:{textAlign:"center",fontSize:12,color:"#888",marginTop:20,padding:12,background:"rgba(255,255,255,0.95)",borderTop:"1px solid #eee",display:"flex",flexDirection:"column",gap:8},children:i.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:16,flexWrap:"wrap"},children:[i.jsx("a",{href:"/about",style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:600,fontSize:11},children:e==="zh-TW"?"🧬 我們是誰":e==="zh-CN"?"🧬 我们是谁":e==="en"?"🧬 Who We Are":e==="ja"?"🧬 私たちについて":e==="ko"?"🧬 우리는 누구인가":e==="th"?"🧬 เราเป็นใคร":e==="vi"?"🧬 Chúng tôi là ai":e==="ms"?"🧬 Siapa Kami":"🧬 Quis sumus"}),i.jsx("a",{href:"/privacy-policy",style:{color:"#6B5BFF",textDecoration:"underline",fontSize:11},children:e==="zh-TW"?"隱私權政策":e==="zh-CN"?"隐私政策":e==="en"?"Privacy Policy":e==="ja"?"プライバシーポリシー":e==="ko"?"개인정보 처리방침":e==="th"?"นโยบายความเป็นส่วนตัว":e==="vi"?"Chính sách bảo mật":e==="ms"?"Dasar Privasi":"Consilium de Privata"}),i.jsx("a",{href:"/terms",style:{color:"#6B5BFF",textDecoration:"underline",fontSize:11},children:e==="zh-TW"?"條款/聲明":e==="zh-CN"?"条款/声明":e==="en"?"Terms/Statement":e==="ja"?"規約/声明":e==="ko"?"약관/성명":e==="th"?"ข้อกำหนด/แถลงการณ์":e==="vi"?"Điều khoản/Tuyên bố":e==="ms"?"Terma/Pernyataan":"Termini/Declaratio"}),i.jsx("a",{href:"/data-deletion",style:{color:"#6B5BFF",textDecoration:"underline",fontSize:11},children:e==="zh-TW"?"資料刪除說明":e==="zh-CN"?"数据删除说明":e==="en"?"Data Deletion":e==="ja"?"データ削除について":e==="ko"?"데이터 삭제 안내":e==="th"?"คำอธิบายการลบข้อมูล":e==="vi"?"Giải thích xóa dữ liệu":e==="ms"?"Penjelasan Penghapusan Data":"Explicatio Deletionis Datae"}),i.jsx("a",{href:"/feedback",style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:600,fontSize:11},children:e==="zh-TW"?"💬 意見箱":e==="zh-CN"?"💬 意见箱":e==="en"?"💬 Feedback":e==="ja"?"💬 ご意見箱":e==="ko"?"💬 피드백":e==="th"?"💬 กล่องความคิดเห็น":e==="vi"?"💬 Hộp góp ý":e==="ms"?"💬 Kotak Maklum Balas":"💬 Arca Consilii"})]})}):i.jsx("footer",{style:{textAlign:"center",fontSize:14,color:"#888",marginTop:0,padding:16,background:"rgba(255,255,255,0.92)",borderTop:"1px solid #eee",display:"flex",justifyContent:"center",alignItems:"center",boxShadow:"0 -2px 8px #0001",position:"relative",top:"-20px"},children:i.jsxs("div",{style:{width:"100%",maxWidth:700,display:"flex",justifyContent:"center",alignItems:"center"},children:[i.jsx("a",{href:"/about",style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,minWidth:120,marginRight:32},children:e==="zh-TW"?"🧬 Restarter™｜我們是誰":e==="zh-CN"?"🧬 Restarter™｜我们是谁":e==="en"?"🧬 Restarter™｜Who We Are":e==="ja"?"🧬 Restarter™｜私たちについて":e==="ko"?"🧬 Restarter™｜우리는 누구인가":e==="th"?"🧬 Restarter™｜เราเป็นใคร":e==="vi"?"🧬 Restarter™｜Chúng tôi là ai":e==="ms"?"🧬 Restarter™｜Siapa Kami":"🧬 Restarter™｜Quis sumus"}),i.jsxs("div",{style:{display:"flex",gap:32,justifyContent:"center",alignItems:"center"},children:[i.jsx("a",{href:"/privacy-policy",style:{color:"#6B5BFF",textDecoration:"underline"},children:e==="zh-TW"?"隱私權政策":e==="zh-CN"?"隐私政策":e==="en"?"Privacy Policy":e==="ja"?"プライバシーポリシー":e==="ko"?"개인정보 처리방침":e==="th"?"นโยบายความเป็นส่วนตัว":e==="vi"?"Chính sách bảo mật":e==="ms"?"Dasar Privasi":"Consilium de Privata"}),i.jsx("a",{href:"/terms",style:{color:"#6B5BFF",textDecoration:"underline"},children:e==="zh-TW"?"條款/聲明":e==="zh-CN"?"条款/声明":e==="en"?"Terms/Statement":e==="ja"?"規約/声明":e==="ko"?"약관/성명":e==="th"?"ข้อกำหนด/แถลงการณ์":e==="vi"?"Điều khoản/Tuyên bố":e==="ms"?"Terma/Pernyataan":"Termini/Declaratio"}),i.jsx("a",{href:"/data-deletion",style:{color:"#6B5BFF",textDecoration:"underline"},children:e==="zh-TW"?"資料刪除說明":e==="zh-CN"?"数据删除说明":e==="en"?"Data Deletion":e==="ja"?"データ削除について":e==="ko"?"데이터 삭제 안내":e==="th"?"คำอธิบายการลบข้อมูล":e==="vi"?"Giải thích xóa dữ liệu":e==="ms"?"Penjelasan Penghapusan Data":"Explicatio Deletionis Datae"})]}),i.jsx("a",{href:"/feedback",style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,minWidth:140,textAlign:"right",marginLeft:32},children:e==="zh-TW"?"💬 意見箱｜我們想聽你說":e==="zh-CN"?"💬 意见箱｜我们想听你说":e==="en"?"💬 Feedback｜We Want to Hear You":e==="ja"?"💬 ご意見箱｜あなたの声を聞かせて":e==="ko"?"💬 피드백｜여러분의 의견을 듣고 싶어요":e==="th"?"💬 กล่องความคิดเห็น｜เราอยากฟังคุณ":e==="vi"?"💬 Hộp góp ý｜Chúng tôi muốn lắng nghe bạn":e==="ms"?"💬 Kotak Maklum Balas｜Kami ingin mendengar anda":"💬 Arca Consilii｜Te audire volumus"})]})}),R&&i.jsx("div",{style:{position:"fixed",left:0,top:0,width:"100vw",height:"100vh",background:"rgba(40,40,80,0.18)",zIndex:1e4,display:"flex",alignItems:"center",justifyContent:"center"},children:i.jsxs("div",{style:{background:"#fff",borderRadius:18,boxShadow:"0 4px 24px #6B5BFF33",padding:28,minWidth:280,maxWidth:340,width:"90vw",position:"relative",display:"flex",flexDirection:"column",gap:12},children:[i.jsx("button",{type:"button",onClick:()=>T(!1),style:{position:"absolute",top:10,right:12,background:"none",border:"none",fontSize:22,color:"#888",cursor:"pointer",fontWeight:700},children:"×"}),i.jsx("div",{style:{fontWeight:800,fontSize:18,color:"#6B5BFF",textAlign:"center",marginBottom:2},children:se.title}),i.jsx("button",{onClick:()=>n("/register"),style:{background:"linear-gradient(90deg, #6e8efb, #a777e3)",color:"#fff",border:"none",borderRadius:14,padding:"12px 0",fontWeight:700,fontSize:17,cursor:"pointer",margin:"12px 0"},children:se.btn}),i.jsx("button",{onClick:()=>T(!1),style:{background:"#eee",color:"#666",border:"none",borderRadius:14,padding:"10px 0",fontWeight:700,fontSize:16,cursor:"pointer"},children:se.close})]})}),i.jsx(Tz,{isOpen:A,onClose:()=>D(!1),title:F.title,message:F.message,requiredPlan:F.requiredPlan}),i.jsx(Mo,{isOpen:G,onClose:()=>N(!1),currentPlan:E.currentPlan,remainingDays:E.remainingDays,usedTokens:E.usedTokens,totalTokens:E.totalTokens}),i.jsx("style",{children:`
        .feature-btn, .home-chat-btn, .topbar-btn {
          transition: background 0.18s, color 0.18s, box-shadow 0.18s;
          cursor: pointer;
        }
        /* 移除懸停效果以避免畫面停滯和耗電 */
        .feature-btn, .home-chat-btn {
          background: #fff;
          border-radius: 12px;
          border: 2px solid #6B5BFF;
          color: #6B5BFF;
          font-weight: 700;
          font-size: 16px;
          padding: 8px 16px;
        }
        .home-chat-btn-text {
          font-size: 18px;
          margin-left: 2px;
        }
        .topbar-btn {
          background: #6c63ff;
          border-radius: 8px;
          border: none;
          color: #fff;
          font-weight: 700;
          font-size: 16px;
          padding: 8px 18px;
        }
        .fixed-logo-box {
          position: fixed;
          top: 16px;
          left: 42px;
          display: flex;
          align-items: center;
          gap: 12px;
          z-index: 10000;
        }
        .fixed-logo-img {
          width: 54px;
          height: 54px;
        }
        .fixed-logo-slogan {
          font-size: 20px;
          font-weight: 700;
          color: #fff;
          text-shadow: 0 2px 8px #232946, 0 4px 18px #0008;
        }
      `})]}):i.jsx("div",{style:{textAlign:"center",marginTop:"30vh",fontSize:24},children:"載入中..."})}function Lo(){const[n,e]=w.useState(null),[t,r]=w.useState(!1),s=gt(),a=async()=>{const h=s.currentUser;if(!h)return null;try{r(!0);const m=await fetch(`/api/subscription/status/${h.uid}`);if(m.ok){const g=await m.json();return e(g),g}}catch(m){console.error("獲取訂閱狀態失敗:",m)}finally{r(!1)}return null},c=async h=>{const m=s.currentUser;let g=m==null?void 0:m.uid;if(!g){const x=localStorage.getItem("testUser");if(x)g=JSON.parse(x).uid;else return{allowed:!1,reason:"請先登入"}}try{const x=await fetch(`/api/subscription/details/${g}`);let S=null;if(x.ok&&(S=await x.json()),localStorage.getItem("testMode")==="true")return{allowed:!0,reason:void 0,featureName:{aiChat:"AI 聊天功能",voiceInput:"語音輸入功能",voiceOutput:"語音輸出功能",videoChat:"視訊通話功能",voiceRecording:"語音錄製功能"}[h]||h,isFreeUser:!0,isTestMode:!0,currentPlan:"test"};const _=await fetch("/api/subscription/check-permission",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:g,feature:h})});if(_.ok){const R=await _.json(),T={aiChat:"AI 聊天功能",voiceInput:"語音輸入功能",voiceOutput:"語音輸出功能",videoChat:"視訊通話功能",voiceRecording:"語音錄製功能"},A=S&&S.isActive&&S.startDate&&new Date(S.startDate).getTime()>Date.now()-24*60*60*1e3;return{...R,featureName:T[h]||h,isFreeUser:R.currentPlan==="free"||!R.currentPlan,isNewSubscription:A,subscriptionData:S}}else return{allowed:!1,reason:"權限檢查失敗",featureName:h,isFreeUser:!0}}catch(x){return console.error("權限檢查錯誤:",x),{allowed:!1,reason:"網路錯誤",featureName:h,isFreeUser:!0}}},d=async(h,m=0)=>{const g=s.currentUser;let x=g==null?void 0:g.uid;if(!x){const S=localStorage.getItem("testUser");if(S)x=JSON.parse(S).uid;else return}try{await fetch("/api/subscription/record-usage",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:x,feature:h,cost:m})})}catch(S){console.error("記錄使用量失敗:",S)}};return w.useEffect(()=>{s.currentUser&&a()},[s.currentUser]),{subscriptionStatus:n,loading:t,checkPermission:c,recordUsage:d,fetchSubscriptionStatus:a}}const yS={"zh-TW":{privacy:"隱私權政策",terms:"條款/聲明",deletion:"資料刪除說明"},"zh-CN":{privacy:"隐私政策",terms:"条款/声明",deletion:"数据删除说明"},en:{privacy:"Privacy Policy",terms:"Terms/Statement",deletion:"Data Deletion"},ja:{privacy:"プライバシーポリシー",terms:"規約/声明",deletion:"データ削除について"},ko:{privacy:"개인정보 처리방침",terms:"약관/성명",deletion:"데이터 삭제 안내"},th:{privacy:"นโยบายความเป็นส่วนตัว",terms:"ข้อกำหนด/แถลงการณ์",deletion:"คำอธิบายการลบข้อมูล"},vi:{privacy:"Chính sách bảo mật",terms:"Điều khoản/Tuyên bố",deletion:"Giải thích xóa dữ liệu"},ms:{privacy:"Dasar Privasi",terms:"Terma/Pernyataan",deletion:"Penjelasan Penghapusan Data"},la:{privacy:"Consilium de Privata",terms:"Termini/Declaratio",deletion:"Explicatio Deletionis Datae"}},xS={"zh-TW":"🧬 Restarter™｜我們是誰","zh-CN":"🧬 Restarter™｜我们是谁",en:"🧬 Restarter™｜Who We Are",ja:"🧬 Restarter™｜私たちについて",ko:"🧬 Restarter™｜우리는 누구인가",th:"🧬 Restarter™｜เราเป็นใคร",vi:"🧬 Restarter™｜Chúng tôi là ai",ms:"🧬 Restarter™｜Siapa Kami",la:"🧬 Restarter™｜Quis sumus"},bS={"zh-TW":"💬 意見箱｜我們想聽你說","zh-CN":"💬 意见箱｜我们想听你说",en:"💬 Feedback｜We Want to Hear You",ja:"💬 ご意見箱｜あなたの声を聞かせて",ko:"💬 피드백｜여러분의 의견을 듣고 싶어요",th:"💬 กล่องความคิดเห็น｜เราอยากฟังคุณ",vi:"💬 Hộp góp ý｜Chúng tôi muốn lắng nghe bạn",ms:"💬 Kotak Maklum Balas｜Kami ingin mendengar anda",la:"💬 Arca Consilii｜Te audire volumus"},Ln=()=>{const{lang:n}=Bt(),e=yS[n]||yS["zh-TW"];return i.jsxs("footer",{style:{width:"100%",textAlign:"center",fontSize:14,color:"#888",marginTop:0,padding:"16px 0",background:"rgba(255,255,255,0.92)",borderTop:"1px solid #eee",boxShadow:"0 -2px 8px #0001"},children:[i.jsxs("div",{style:{width:"100%",maxWidth:800,margin:"0 auto",display:"flex",justifyContent:"space-between",alignItems:"center",gap:40,flexWrap:"wrap",padding:"0 20px"},children:[i.jsx("a",{href:"/privacy-policy",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px"},children:e.privacy}),i.jsx("a",{href:"/terms",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px"},children:e.terms}),i.jsx("a",{href:"/data-deletion",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px"},children:e.deletion}),i.jsx("a",{href:"/about",style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px"},children:xS[n]||xS["zh-TW"]}),i.jsx("a",{href:"/feedback",style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px"},children:bS[n]||bS["zh-TW"]})]}),i.jsx("style",{children:`
        @media (max-width: 768px) {
          footer {
            padding: 8px 16px 40px 16px !important;
            marginTop: 0 !important;
          }
          footer > div {
            gap: 16px !important;
            justify-content: space-around !important;
          }
          footer > div > a {
            padding: 4px 6px !important;
            fontSize: 12px !important;
          }
        }
        @media (min-width: 700px) {
          footer {
            padding: 16px !important;
          }
          footer > div {
            flex-direction: row !important;
            gap: 40px !important;
            justify-content: space-between !important;
          }
          footer > div > a {
            padding: 4px 8px !important;
          }
        }
      `})]})},Iz=[{code:"zh-TW",label:"繁中"},{code:"zh-CN",label:"简中"},{code:"en",label:"EN"},{code:"ja",label:"日本語"},{code:"ko",label:"한국어"},{code:"vi",label:"Tiếng Việt"},{code:"th",label:"ไทย"},{code:"la",label:"Latina"},{code:"ms",label:"Bahasa Melayu"}],vS={"zh-TW":{back:"返回",logout:"登出",title:"🧱 情緒牆 Restart Wall",subtitle:"社交情感支援平台",subtitleDesc:"在這裡，每個人都能找到情感上的歸屬感和支援。分享你的心情，或為他人提供溫暖的支援留言，讓我們一起建立溫暖的社群。",inbox:"💌 我的留言箱",placeholder:"說出你的心聲...(200字內)",send:"發送",sending:"發送中...",noMessages:"還沒有留言，快來發表你的心聲吧！",commentsTitle:"支援留言：",noComments:"還沒有人留言支援",modalTitle:"這是他的心情貼文：",modalAction:"給他支援留言：",nicknamePlaceholder:"你的暱稱",commentPlaceholder:"支援內容...",submitComment:"送出支援",supportMessage:"💝 給予支援",supportDesc:"看到別人的情感分享，給予溫暖的支援和鼓勵",recording:"錄音中",pressToStop:"按下停止",readyToRecord:"準備開始錄音",recordInstruction:"點擊「開始錄音」後，系統將開始錄製您的語音留言。",recordTimeLimit:"錄音時間限制為1分鐘",cancel:"取消",startRecording:"開始錄音",voice:"語音"},"zh-CN":{back:"返回",logout:"登出",title:"🧱 情绪墙 Restart Wall",subtitle:"社交情感支援平台",subtitleDesc:"在这里，每个人都能找到情感上的归属感和支援。分享你的心情，或为他人提供温暖的支援留言，让我们一起建立温暖的社群。",inbox:"💌 我的留言箱",placeholder:"说出你的心声...",send:"发送",sending:"发送中...",noMessages:"还没有留言，快来发表你的心声吧！",commentsTitle:"支援留言：",noComments:"还没有人留言支援",modalTitle:"这是他的心情贴文：",modalAction:"给他支援留言：",nicknamePlaceholder:"你的昵称",commentPlaceholder:"支援内容...",submitComment:"送出支援",supportMessage:"💝 给予支援",supportDesc:"看到别人的情感分享，给予温暖的支援和鼓励",recording:"录音中",pressToStop:"按下停止",readyToRecord:"准备开始录音",recordInstruction:"点击「开始录音」后，系统将开始录制您的语音留言。",recordTimeLimit:"录音时间限制为1分钟",cancel:"取消",startRecording:"开始录音",voice:"语音"},en:{back:"Back",logout:"Logout",title:"🧱 Emotion Wall Restart Wall",subtitle:"Social Emotional Support Platform",subtitleDesc:"Here, everyone can find emotional belonging and support. Share your feelings, or provide warm support messages to others. Let's build a caring community together.",inbox:"💌 My Inbox",placeholder:"Say what you feel...",send:"Send",sending:"Sending...",noMessages:"No messages yet. Come and share your feelings!",commentsTitle:"Support Messages:",noComments:"No support messages yet",modalTitle:"Here's their post:",modalAction:"Leave support message:",nicknamePlaceholder:"Your Nickname",commentPlaceholder:"Support content...",submitComment:"Send Support",supportMessage:"💝 Give Support",supportDesc:"See others' emotional sharing and give warm support and encouragement",recording:"Recording",pressToStop:"Press to Stop",readyToRecord:"Ready to Start Recording",recordInstruction:'After clicking "Start Recording", the system will begin recording your voice message.',recordTimeLimit:"Recording time limit is 1 minute",cancel:"Cancel",startRecording:"Start Recording",voice:"Voice"},ja:{back:"戻る",logout:"ログアウト",title:"🧱 感情の壁 Restart Wall",subtitle:"ソーシャル感情サポートプラットフォーム",subtitleDesc:"ここでは、誰もが感情的な帰属意識とサポートを見つけることができます。あなたの気持ちを共有したり、他の人に温かい支援メッセージを提供したりして、一緒に思いやりのあるコミュニティを築きましょう。",inbox:"💌 私の受信箱",placeholder:"あなたの気持ちを話して...",send:"送信",sending:"送信中...",noMessages:"まだメッセージはありません。あなたの気持ちを投稿しに来てください！",commentsTitle:"支援メッセージ：",noComments:"まだ支援メッセージはありません",modalTitle:"彼の投稿です：",modalAction:"彼に支援メッセージを送る：",nicknamePlaceholder:"あなたのニックネーム",commentPlaceholder:"支援内容...",submitComment:"支援を送信",supportMessage:"💝 支援を送る",supportDesc:"他の人の感情的な共有を見て、温かい支援と励ましを提供する",recording:"録音中",pressToStop:"押して停止",readyToRecord:"録音の準備",recordInstruction:"「録音開始」をクリックすると、システムが音声メッセージの録音を開始します。",recordTimeLimit:"録音時間は1分に制限されています",cancel:"キャンセル",startRecording:"録音開始",voice:"音声"},ko:{back:"돌아가기",logout:"로그아웃",title:"🧱 감정의 벽 Restart Wall",subtitle:"소셜 감정 지원 플랫폼",subtitleDesc:"여기서 모든 사람이 감정적 소속감과 지원을 찾을 수 있습니다. 당신의 감정을 공유하거나 다른 사람에게 따뜻한 지원 메시지를 제공하여 함께 돌봄의 커뮤니티를 만들어봅시다.",inbox:"💌 내 메시지함",placeholder:"당신의 마음을 말해보세요...",send:"전송",sending:"전송 중...",noMessages:"아직 메시지가 없습니다. 와서 당신의 마음을 표현하세요!",commentsTitle:"지원 메시지:",noComments:"아직 지원 메시지가 없습니다",modalTitle:"그의 게시물입니다:",modalAction:"그에게 지원 메시지 남기기:",nicknamePlaceholder:"닉네임",commentPlaceholder:"지원 내용...",submitComment:"지원 보내기",supportMessage:"💝 지원하기",supportDesc:"다른 사람의 감정적 공유를 보고 따뜻한 지원과 격려를 제공",recording:"녹음 중",pressToStop:"누르면 중지",readyToRecord:"녹음 준비",recordInstruction:"「녹음 시작」을 클릭하면 시스템이 음성 메시지 녹음을 시작합니다.",recordTimeLimit:"녹음 시간은 1분으로 제한됩니다",cancel:"취소",startRecording:"녹음 시작",voice:"음성"},vi:{back:"Quay lại",logout:"Đăng xuất",title:"🧱 Bức tường Cảm xúc Restart Wall",subtitle:"Nền tảng Hỗ trợ Cảm xúc Xã hội",subtitleDesc:"Ở đây, mọi người đều có thể tìm thấy sự thuộc về và hỗ trợ về mặt cảm xúc. Chia sẻ cảm xúc của bạn, hoặc cung cấp tin nhắn hỗ trợ ấm áp cho người khác. Hãy cùng nhau xây dựng một cộng đồng quan tâm.",inbox:"💌 Hộp thư của tôi",placeholder:"Nói ra cảm xúc của bạn...",send:"Gửi",sending:"Đang gửi...",noMessages:"Chưa có tin nhắn nào. Hãy đến và chia sẻ cảm xúc của bạn!",commentsTitle:"Tin nhắn hỗ trợ:",noComments:"Chưa có tin nhắn hỗ trợ nào",modalTitle:"Đây là bài đăng của họ:",modalAction:"Để lại tin nhắn hỗ trợ:",nicknamePlaceholder:"Biệt danh của bạn",commentPlaceholder:"Nội dung hỗ trợ...",submitComment:"Gửi hỗ trợ",supportMessage:"💝 Gửi hỗ trợ",supportDesc:"Xem chia sẻ cảm xúc của người khác và đưa ra hỗ trợ và khích lệ ấm áp",recording:"Đang ghi âm",pressToStop:"Nhấn để dừng",readyToRecord:"Sẵn sàng ghi âm",recordInstruction:'Sau khi nhấp vào "Bắt đầu ghi âm", hệ thống sẽ bắt đầu ghi âm tin nhắn giọng nói của bạn.',recordTimeLimit:"Thời gian ghi âm giới hạn 1 phút",cancel:"Hủy",startRecording:"Bắt đầu ghi âm",voice:"Giọng nói"},th:{back:"กลับ",logout:"ออกจากระบบ",title:"🧱 กำแพงอารมณ์ Restart Wall",subtitle:"แพลตฟอร์มสนับสนุนอารมณ์ทางสังคม",subtitleDesc:"ที่นี่ ทุกคนสามารถหาความเป็นเจ้าของและความสนับสนุนทางอารมณ์ได้ แบ่งปันความรู้สึกของคุณ หรือให้ข้อความสนับสนุนที่อบอุ่นแก่ผู้อื่น มาเริ่มสร้างชุมชนที่ห่วงใยกันเถอะ",inbox:"💌 กล่องข้อความของฉัน",placeholder:"บอกความรู้สึกของคุณ...",send:"ส่ง",sending:"กำลังส่ง...",noMessages:"ยังไม่มีข้อความ มาแบ่งปันความรู้สึกของคุณสิ!",commentsTitle:"ข้อความสนับสนุน:",noComments:"ยังไม่มีข้อความสนับสนุน",modalTitle:"นี่คือโพสต์ของพวกเขา:",modalAction:"แสดงข้อความสนับสนุน:",nicknamePlaceholder:"ชื่อเล่นของคุณ",commentPlaceholder:"เนื้อหาสนับสนุน...",submitComment:"ส่งการสนับสนุน",supportMessage:"💝 ให้การสนับสนุน",supportDesc:"ดูการแบ่งปันอารมณ์ของผู้อื่นและให้การสนับสนุนและกำลังใจที่อบอุ่น",recording:"กำลังบันทึก",pressToStop:"กดเพื่อหยุด",readyToRecord:"พร้อมบันทึกเสียง",recordInstruction:'หลังจากคลิก "เริ่มบันทึก" ระบบจะเริ่มบันทึกข้อความเสียงของคุณ',recordTimeLimit:"เวลาบันทึกเสียงจำกัด 1 นาที",cancel:"ยกเลิก",startRecording:"เริ่มบันทึก",voice:"เสียง"},la:{back:"Redire",logout:"Exire",title:"🧱 Murus Emotionum Restart Wall",subtitle:"Platea Socialis Sustentationis Emotionalis",subtitleDesc:"Hic, omnes possunt invenire pertinere emotionalem et sustentationem. Communica sensus tuos, vel praebe calidas sustentationis epistulas aliis. Simul aedificemus communitatem curantem.",inbox:"💌 Cista Mea",placeholder:"Dic quod sentis...",send:"Mittere",sending:"Mittens...",noMessages:"Nullae epistulae adhuc. Veni et communica sensus tuos!",commentsTitle:"Epistulae Sustentationis:",noComments:"Nullae epistulae sustentationis adhuc",modalTitle:"Ecce nuntius eorum:",modalAction:"Mitte epistulam sustentationis:",nicknamePlaceholder:"Tuum agnomen",commentPlaceholder:"Contentum sustentationis...",submitComment:"Mitte Sustentationem",supportMessage:"💝 Da Sustentationem",supportDesc:"Vide communicationem emotionalem aliorum et praebe calidam sustentationem et cohortationem",recording:"Recordans",pressToStop:"Preme ad Desinere",readyToRecord:"Paratus ad Recordandum",recordInstruction:'Postquam "Incipe Recordandum" cliccas, systema incipiet recordare nuntium vocis tuae.',recordTimeLimit:"Tempus recordandi limitatur ad 1 minuta",cancel:"Cancella",startRecording:"Incipe Recordandum",voice:"Vox"},ms:{back:"Kembali",logout:"Log Keluar",title:"🧱 Tembok Emosi Restart Wall",subtitle:"Platform Sokongan Emosi Sosial",subtitleDesc:"Di sini, semua orang dapat mencari rasa kepunyaan dan sokongan emosi. Kongsi perasaan anda, atau berikan mesej sokongan yang hangat kepada orang lain. Mari kita bina komuniti yang prihatin bersama.",inbox:"💌 Kotak Mesej Saya",placeholder:"Katakan perasaan anda...",send:"Hantar",sending:"Menghantar...",noMessages:"Belum ada mesej lagi. Datang dan kongsi perasaan anda!",commentsTitle:"Mesej Sokongan:",noComments:"Belum ada mesej sokongan",modalTitle:"Ini adalah siaran mereka:",modalAction:"Tinggalkan mesej sokongan:",nicknamePlaceholder:"Nama samaran anda",commentPlaceholder:"Kandungan sokongan...",submitComment:"Hantar Sokongan",supportMessage:"💝 Beri Sokongan",supportDesc:"Lihat perkongsian emosi orang lain dan berikan sokongan dan galakan yang hangat",recording:"Merakam",pressToStop:"Tekan untuk Berhenti",readyToRecord:"Sedia untuk Merakam",recordInstruction:'Selepas mengklik "Mula Merakam", sistem akan mula merakam mesej suara anda.',recordTimeLimit:"Masa rakaman terhad kepada 1 minit",cancel:"Batal",startRecording:"Mula Merakam",voice:"Suara"}};function Ez(){const n=wt(),e=gt(),t=kd(),[r,s]=w.useState([]),[a,c]=w.useState(""),[d,h]=w.useState(!1),[m,g]=w.useState(null),[x,S]=w.useState(""),[I,_]=w.useState(!1),[R,T]=w.useState(null),[A,D]=w.useState(!1),[F,X]=w.useState(!1),[ie,G]=w.useState(0),[N,E]=w.useState(null),[P,M]=w.useState([]),[O,z]=w.useState(!1),[j,K]=w.useState(""),[Z,Y]=w.useState(0),[ae,se]=w.useState(!1),re=w.useRef(null),ne=w.useRef([]),{lang:W,setLang:$}=Bt(),ee=vS[W]||vS["zh-TW"],{checkPermission:he,recordUsage:_e}=Lo(),[ve,Le]=w.useState(!1),[Ne,nt]=w.useState(null),Je=async H=>{var J,be,Me;try{const $e=Gn(t,"profiles",H),Ze=await Io($e);if(Ze.exists()){const Ke=Ze.data();return{name:Ke.nickname||Ke.name||"用戶",avatar:Ke.avatar||"/avatars/Derxl.png",country:Ke.country||"台灣",gender:Ke.gender||"未知",age:Ke.age||25,email:((J=e.currentUser)==null?void 0:J.email)||"unknown@example.com"}}else{const Ke=e.currentUser;return{name:(Ke==null?void 0:Ke.displayName)||((be=Ke==null?void 0:Ke.email)==null?void 0:be.split("@")[0])||"用戶",avatar:(Ke==null?void 0:Ke.photoURL)||"/avatars/Derxl.png",country:"台灣",gender:"未知",age:25,email:(Ke==null?void 0:Ke.email)||"unknown@example.com"}}}catch($e){console.error("獲取用戶資料失敗:",$e);const Ze=e.currentUser;return{name:(Ze==null?void 0:Ze.displayName)||((Me=Ze==null?void 0:Ze.email)==null?void 0:Me.split("@")[0])||"用戶",avatar:(Ze==null?void 0:Ze.photoURL)||"/avatars/Derxl.png",country:"台灣",gender:"未知",age:25,email:(Ze==null?void 0:Ze.email)||"unknown@example.com"}}};w.useEffect(()=>{const H=localStorage.getItem("messages");if(H)try{const J=JSON.parse(H),be=gt(),Me=be.currentUser,$e=J.filter(Et=>!Me||Et.user.id!=="user123"&&Et.user.id!=="user456"&&Et.user.id!=="user789"),Ze=$e.sort((Et,Ot)=>new Date(Ot.createdAt).getTime()-new Date(Et.createdAt).getTime());s(Ze),console.log("已加載localStorage中的消息:",Ze.length,"條"),console.log("消息內容:",Ze),$e.length!==J.length&&(localStorage.setItem("messages",JSON.stringify($e)),console.log("已清理假數據"));const Ke=be.currentUser;Ke&&(async()=>{try{let Ot=!1;const Gt=await Je(Ke.uid),et=$e.map(ht=>{if(ht.comments){const Vt=ht.comments.map(ct=>((ct.nickname==="lkjh123"||ct.commenterEmail==="as0@gmail.com"||!ct.commenterId||ct.commenterAge===0||ct.commenterAge===35||ct.commenterAge===39)&&(ct.commenterId=Ke.uid,ct.nickname=Gt.name,ct.commenterEmail=Gt.email,ct.commenterAvatar=Gt.avatar,ct.commenterCountry=Gt.country,ct.commenterGender=Gt.gender,ct.commenterAge=Gt.age,ct.createdAt=ct.createdAt||new Date().toISOString(),Ot=!0,console.log("強制修復支援留言:",ct)),ct));return{...ht,comments:Vt}}return ht});Ot&&(s(et),localStorage.setItem("messages",JSON.stringify(et)),console.log("已修復舊的支援留言數據"))}catch(Ot){console.error("修復支援留言數據失敗:",Ot)}})()}catch(J){console.error("解析localStorage消息失敗:",J)}else console.log("localStorage中沒有保存的消息")},[]);const ge=H=>{const be=gt().currentUser;return be&&H.user.id===be.uid},De=H=>{const be=gt().currentUser;return be&&H.commenterId===be.uid},tt=()=>{const J=gt().currentUser;return J?r.filter(be=>be.user.id===J.uid):[]},Ye=()=>{const J=gt().currentUser,be=[];return J?(console.log("當前用戶UID:",J.uid),console.log("所有留言:",r),r.forEach(Me=>{var $e,Ze;console.log("檢查留言:",Me.id,"支援留言數量:",(($e=Me.comments)==null?void 0:$e.length)||0),(Ze=Me.comments)==null||Ze.forEach(Ke=>{var Et;if(!Ke.commenterId){const Ot=J.displayName||((Et=J.email)==null?void 0:Et.split("@")[0])||"用戶",Gt=J.email;(Ke.nickname===Ot||Ke.commenterEmail===Gt)&&(Ke.commenterId=J.uid,console.log("為舊支援留言添加commenterId:",Ke))}console.log("支援留言:",Ke.nickname,"commenterId:",Ke.commenterId,"當前用戶UID:",J.uid),Ke.commenterId===J.uid&&(console.log("找到我的支援留言:",Ke),be.push({message:Me,comment:Ke}))})}),console.log("我的支援留言總數:",be.length),be):(console.log("沒有登入用戶"),be)},We=async()=>{if(F){re.current&&re.current.state==="recording"&&re.current.stop(),N&&(clearInterval(N),E(null)),X(!1),D(!1),G(0);return}const H=await he("aiChat");if(!H.allowed){H.canRenew,nt(H),Le(!0);return}se(!0)},pe=async()=>{se(!1);try{const H=await navigator.mediaDevices.getUserMedia({audio:!0}),J=new MediaRecorder(H,{mimeType:"audio/webm;codecs=opus"});M([]),ne.current=[],G(0),J.ondataavailable=Me=>{console.log("收到音頻數據，大小:",Me.data.size),Me.data.size>0&&(ne.current.push(Me.data),M($e=>{const Ze=[...$e,Me.data];return console.log("更新音頻塊，當前數量:",Ze.length),Ze}))},J.onstop=()=>{const Me=[...ne.current];console.log("錄音停止，音頻塊數量:",Me.length);const $e=Me.length>0?new Blob(Me,{type:"audio/webm"}):new Blob([""],{type:"audio/webm"}),Ze=Math.max(1,Math.floor(Me.length*.1));console.log("創建音頻blob，大小:",$e.size,"估算錄音時長:",Ze);const Ke=URL.createObjectURL($e);K(Ke),Y(Ze),z(!0),H.getTracks().forEach(Et=>Et.stop())},J.start(100),re.current=J,X(!0),D(!0);const be=setInterval(()=>{G(Me=>{const $e=Me+1;return $e>=60&&(re.current&&re.current.state==="recording"&&re.current.stop(),be&&(clearInterval(be),E(null)),X(!1),D(!1),alert("錄音時間已達1分鐘限制，已自動停止錄音")),$e})},1e3);E(be),console.log("開始錄音...")}catch(H){console.error("錄音失敗:",H),alert("無法訪問麥克風，請檢查權限設置")}},Se=()=>{se(!1)},we=async()=>{if(j){const H=`[語音留言 - ${Math.floor(Z/60)}:${(Z%60).toString().padStart(2,"0")}]`;console.log("發送語音留言:",{voiceText:H}),h(!0);const J=e.currentUser;if(!J){alert("請先登入"),h(!1);return}const be=await Je(J.uid),Me={id:Date.now().toString(),text:H,aiReply:"",toneId:"",createdAt:new Date().toISOString(),audioUrl:j,duration:Z,user:{id:J.uid,name:be.name,avatar:be.avatar,country:be.country,region:be.country,email:be.email},comments:[]};console.log("創建的語音留言對象:",Me);const $e=[Me,...r];s($e),localStorage.setItem("messages",JSON.stringify($e)),console.log("語音留言已保存到localStorage"),await _e("aiChat",1),K(""),Y(0),z(!1),h(!1)}},Re=()=>{z(!1),K(""),Y(0)},Ce=H=>{if(H.audioUrl){const J=new Audio(H.audioUrl);J.onerror=be=>{console.error("音頻加載失敗:",be),U(H.text)},J.play().then(()=>{console.log("正在播放原音...")}).catch(be=>{console.error("播放失敗:",be),U(H.text)})}else U(H.text)},U=H=>{if("speechSynthesis"in window){const J=new SpeechSynthesisUtterance(H);J.lang="zh-TW",J.rate=.9,J.pitch=1,window.speechSynthesis.cancel(),window.speechSynthesis.speak(J),console.log("正在播放留言內容（文字轉語音）...")}else alert("瀏覽器不支援語音播放功能")},V=async()=>{if(!a.trim()){console.log("沒有輸入內容，無法發送");return}console.log("發送消息:",{input:a}),h(!0);const H=e.currentUser;if(!H){alert("請先登入"),h(!1);return}const J=await Je(H.uid),be={id:Date.now().toString(),text:a,aiReply:"",toneId:"",createdAt:new Date().toISOString(),user:{id:H.uid,name:J.name,avatar:J.avatar,country:J.country,region:J.country,email:J.email},comments:[]};console.log("創建的消息對象:",be);const Me=[be,...r];s(Me),localStorage.setItem("messages",JSON.stringify(Me)),console.log("消息已保存到localStorage"),c(""),h(!1)},L=async H=>{if(!x.trim())return;const J=e.currentUser;if(!J){alert("請先登入");return}const be=await Je(J.uid);s(Me=>{const $e=Me.map(Ze=>Ze.id===H.id?{...Ze,comments:[...Ze.comments||[],{nickname:be.name,content:x,toUserId:H.user.id,commenterId:J.uid,commenterEmail:be.email,commenterCountry:be.country,commenterGender:be.gender,commenterAge:be.age,createdAt:new Date().toISOString(),commenterAvatar:be.avatar}]}:Ze);return localStorage.setItem("messages",JSON.stringify($e)),$e}),S(""),g(null)},oe=()=>{Le(!1),nt(null)};return i.jsxs("div",{className:"modern-bg",style:{background:"#8a8a8a",minHeight:"100vh",display:"flex",flexDirection:"column"},children:[i.jsxs("div",{style:{position:"absolute",top:0,left:0,width:"100%",zIndex:100,display:"flex",justifyContent:"space-between",alignItems:"center",padding:"18px 32px 0 32px",boxSizing:"border-box",background:"transparent"},children:[i.jsx("button",{onClick:()=>n("/"),style:{background:"#fff",border:"2px solid #6B5BFF",borderRadius:8,color:"#6B5BFF",fontWeight:700,fontSize:16,cursor:"pointer",padding:"6px 18px",transition:"background 0.2s, color 0.2s, box-shadow 0.2s"},children:ee.back}),i.jsxs("div",{style:{display:"flex",gap:12,marginRight:8},children:[i.jsx("button",{className:"topbar-btn",onClick:async()=>{await gt().signOut(),localStorage.clear(),window.location.href="/"},onMouseOver:H=>{H.currentTarget.style.background="#6B5BFF",H.currentTarget.style.color="#fff"},onMouseOut:H=>{H.currentTarget.style.background="",H.currentTarget.style.color=""},children:ee.logout}),i.jsx("select",{className:"topbar-select",value:W,onChange:H=>{const J=H.target.value;$(J),localStorage.setItem("lang",J)},style:{padding:"6px 8px",borderRadius:8,fontWeight:600,cursor:"pointer",minWidth:"50px",width:"50px"},onMouseOver:H=>{H.currentTarget.style.background="#6B5BFF",H.currentTarget.style.color="#fff"},onMouseOut:H=>{H.currentTarget.style.background="",H.currentTarget.style.color=""},children:Iz.map(H=>i.jsx("option",{value:H.code,children:H.label},H.code))})]})]}),i.jsxs("div",{className:"modern-container",style:{maxWidth:600,width:"100%",margin:"0 auto",flex:1,display:"flex",flexDirection:"column",justifyContent:"center"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:24},children:[i.jsx("h2",{className:"modern-title",style:{fontSize:"2.2rem",margin:0,flex:1,textAlign:"center",color:"#6B5BFF",textShadow:"0 2px 12px #6B5BFF88, 0 4px 24px #0008",letterSpacing:1,display:"flex",alignItems:"center",gap:8},children:ee.title}),i.jsx("button",{onClick:()=>_(!I),style:{background:I?"linear-gradient(135deg, #23c6e6 60%, #6B5BFF 100%)":"linear-gradient(135deg, #6B5BFF 60%, #23c6e6 100%)",color:"#fff",border:"none",borderRadius:12,fontWeight:900,fontSize:17,padding:"10px 28px",marginLeft:18,boxShadow:"0 2px 12px #6B5BFF33",letterSpacing:2,transition:"all 0.3s ease"},children:I?W==="zh-TW"||W==="zh-CN"?"← 返回":W==="en"?"← Back":W==="ja"?"← 戻る":W==="ko"?"← 돌아가기":W==="vi"?"← Quay lại":W==="th"?"← กลับ":W==="la"?"← Atgriezties":W==="ms"?"← Kembali":"← 返回":W==="zh-TW"||W==="zh-CN"?"💌 我的留言":W==="en"?"💌 My Messages":W==="ja"?"💌 私のメッセージ":W==="ko"?"💌 내 메시지":W==="vi"?"💌 Tin nhắn của tôi":W==="th"?"💌 ข้อความของฉัน":W==="la"?"💌 Mani ziņojumi":W==="ms"?"💌 Mesej saya":"💌 我的留言"})]}),i.jsxs("div",{style:{background:"linear-gradient(135deg, rgba(107, 91, 255, 0.1) 0%, rgba(35, 198, 230, 0.1) 100%)",borderRadius:"20px",padding:"24px",marginBottom:"18px",border:"2px solid rgba(107, 91, 255, 0.2)",boxShadow:"0 8px 32px rgba(107, 91, 255, 0.15)",backdropFilter:"blur(10px)",textAlign:"center"},children:[i.jsx("h3",{style:{color:"#fff",fontSize:"1.5rem",fontWeight:"700",margin:"0 0 12px 0",textShadow:"0 2px 8px rgba(107, 91, 255, 0.3)"},children:ee.subtitle}),i.jsx("p",{style:{color:"#fff",fontSize:"1rem",lineHeight:"1.6",margin:"0",opacity:"0.9"},children:ee.subtitleDesc})]}),i.jsx("div",{className:"tone-list",style:{marginBottom:18}}),i.jsxs("div",{style:{display:"flex",gap:12,marginBottom:18},children:[i.jsx("input",{className:"quote-card",style:{flex:1,fontSize:18,padding:"12px 16px",border:"none",outline:"none",background:"#232946",color:"#fff",borderRadius:"12px"},maxLength:200,placeholder:ee.placeholder,value:a,onChange:H=>c(H.target.value),onKeyDown:H=>H.key==="Enter"&&V(),disabled:d}),i.jsx("button",{className:"tone-card selected",style:{fontSize:16,padding:"10px 16px",minWidth:"70px",whiteSpace:"nowrap",flexShrink:0,borderRadius:"8px"},onClick:()=>{console.log("發送按鈕被點擊"),console.log("當前狀態:",{input:a,loading:d}),V()},disabled:d,children:d?ee.sending:ee.send}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"},children:[i.jsxs("button",{onClick:We,style:{background:A?"linear-gradient(135deg, #f44336 0%, #d32f2f 100%)":"linear-gradient(135deg, #2196F3 0%, #1976D2 100%)",border:"none",borderRadius:"12px",padding:"10px 16px",color:"white",cursor:"pointer",fontSize:"16px",fontWeight:"600",boxShadow:A?"0 4px 16px rgba(244, 67, 54, 0.3)":"0 4px 16px rgba(33, 150, 243, 0.3)",transition:"all 0.3s ease",display:"flex",alignItems:"center",gap:"8px",animation:A?"pulse 1.5s infinite":"none",minWidth:"70px",whiteSpace:"nowrap",flexShrink:0},onMouseOver:H=>{A||(H.currentTarget.style.transform="translateY(-2px)",H.currentTarget.style.boxShadow="0 6px 20px rgba(33, 150, 243, 0.4)")},onMouseOut:H=>{A||(H.currentTarget.style.transform="translateY(0)",H.currentTarget.style.boxShadow="0 4px 16px rgba(33, 150, 243, 0.3)")},children:[i.jsx("span",{style:{fontSize:"18px"},children:"🎤"}),A?`${ee.recording} ${Math.floor(ie/60)}:${(ie%60).toString().padStart(2,"0")}`:ee.voice]}),A&&i.jsx("div",{style:{fontSize:"12px",color:"#f44336",marginTop:"4px",fontWeight:"500"},children:ee.pressToStop})]})]}),i.jsx("div",{className:"quote-list",children:I?i.jsxs("div",{children:[i.jsxs("h3",{style:{color:"#6B5BFF",fontSize:"1.5rem",marginBottom:"20px",textAlign:"center",fontWeight:"700"},children:["💌 ",W==="zh-TW"||W==="zh-CN"?"我的留言":W==="en"?"My Messages":W==="ja"?"私のメッセージ":W==="ko"?"내 메시지":W==="vi"?"Tin nhắn của tôi":W==="th"?"ข้อความของฉัน":W==="la"?"Mani ziņojumi":W==="ms"?"Mesej saya":"我的留言"]}),i.jsxs("div",{style:{marginBottom:"24px"},children:[i.jsx("h3",{style:{color:"#6B5BFF",fontSize:"1.2rem",marginBottom:"12px",textAlign:"center"},children:"📝 我發表的留言"}),tt().length===0?i.jsx("div",{style:{color:"#000",textAlign:"center",padding:"20px"},children:"您還沒有發表過留言"}):tt().map(H=>i.jsxs("div",{className:"quote-card",style:{position:"relative",paddingLeft:64,marginBottom:"12px"},children:[i.jsx("img",{src:H.user.avatar,alt:"avatar",style:{width:48,height:48,borderRadius:"50%",objectFit:"cover",position:"absolute",left:8,top:16,cursor:"pointer",border:"2px solid #6B5BFF"},onClick:()=>g(H)}),i.jsx("div",{className:"quote-text",children:H.text}),i.jsx("div",{style:{fontSize:12,color:"#fff",marginTop:6},children:new Date(H.createdAt).toLocaleString()}),i.jsx("div",{style:{marginTop:12,display:"flex",justifyContent:"center"},children:i.jsx("button",{onClick:()=>g(H),style:{background:"linear-gradient(135deg, #6B5BFF 60%, #23c6e6 100%)",color:"#fff",border:"none",borderRadius:"20px",padding:"8px 20px",fontSize:"14px",fontWeight:"600",cursor:"pointer",boxShadow:"0 2px 8px rgba(107, 91, 255, 0.3)"},children:ee.supportMessage})}),i.jsxs("div",{style:{marginTop:14,background:"#f7f7ff",borderRadius:10,padding:"10px 14px",boxShadow:"0 1px 6px #6B5BFF11"},children:[i.jsx("b",{style:{color:"#6B5BFF",fontSize:16},children:ee.commentsTitle}),(H.comments||[]).length===0&&i.jsx("span",{style:{color:"#bbb",marginLeft:8},children:ee.noComments}),i.jsx("div",{style:{display:"flex",flexDirection:"column",gap:6,marginTop:6},children:(H.comments||[]).sort((J,be)=>{const Me=J.createdAt?new Date(J.createdAt).getTime():new Date(H.createdAt).getTime();return(be.createdAt?new Date(be.createdAt).getTime():new Date(H.createdAt).getTime())-Me}).map((J,be)=>i.jsxs("div",{style:{background:"#fff",borderRadius:8,padding:"8px 12px",color:"#232946",fontSize:15,border:"1px solid #eee",boxShadow:"0 1px 4px #6B5BFF08",position:"relative",paddingLeft:"60px"},children:[i.jsx("img",{src:J.commenterAvatar||"https://via.placeholder.com/40x40/6B7280/FFFFFF?text=?",alt:"commenter avatar",style:{width:40,height:40,borderRadius:"50%",objectFit:"cover",position:"absolute",left:8,top:8,border:"2px solid #6B5BFF"}}),i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"4px"},children:[i.jsx("b",{style:{color:"#6B5BFF"},children:J.nickname}),(ge(H)||De(J))&&i.jsxs("div",{style:{fontSize:"12px",color:"#666"},children:[i.jsxs("div",{children:["📧 ",J.commenterEmail]}),i.jsxs("div",{children:["🌍 ",J.commenterCountry]}),i.jsxs("div",{children:["👤 ",J.commenterGender,"・",J.commenterAge,"歲"]})]}),!ge(H)&&!De(J)&&i.jsx("div",{style:{fontSize:"12px",color:"#666"},children:i.jsxs("div",{children:["🌍 ",J.commenterCountry]})})]}),i.jsx("div",{children:J.content}),i.jsx("div",{style:{fontSize:10,color:"#999",marginTop:4},children:J.createdAt?new Date(J.createdAt).toLocaleString():new Date(H.createdAt).toLocaleString()}),ge(H)&&!De(J)&&i.jsx("button",{onClick:()=>alert(`聯繫 ${J.nickname}：
郵箱：${J.commenterEmail}
國家：${J.commenterCountry}
性別：${J.commenterGender}
年齡：${J.commenterAge}`),style:{position:"absolute",top:"8px",right:"8px",background:"linear-gradient(135deg, #6B5BFF 60%, #23c6e6 100%)",color:"#fff",border:"none",borderRadius:"12px",padding:"4px 8px",fontSize:"10px",cursor:"pointer",fontWeight:"600"},children:"📞 聯繫"})]},be))})]})]},H.id))]})]}):i.jsxs(i.Fragment,{children:[i.jsxs("h3",{style:{color:"#6B5BFF",fontSize:"1.5rem",marginBottom:"20px",textAlign:"center",fontWeight:"700"},children:["🌍 ",W==="zh-TW"||W==="zh-CN"?"全部留言":W==="en"?"All Messages":W==="ja"?"すべてのメッセージ":W==="ko"?"모든 메시지":W==="vi"?"Tất cả tin nhắn":W==="th"?"ข้อความทั้งหมด":W==="la"?"Visi ziņojumi":W==="ms"?"Semua mesej":"全部留言"]}),r.length===0&&i.jsx("div",{style:{color:"#000",textAlign:"center",marginTop:32},children:ee.noMessages}),i.jsxs("div",{style:{marginTop:"40px",marginBottom:"40px"},children:[i.jsx("h3",{style:{color:"#6B5BFF",fontSize:"1.2rem",marginBottom:"12px",textAlign:"center"},children:"💝 我給別人的支援留言"}),(()=>{const H=Ye();return console.log("我的支援留言數量:",H.length),console.log("我的支援留言:",H),H.length===0?i.jsx("div",{style:{color:"#000",textAlign:"center",padding:"20px"},children:"您還沒有給別人留過支援留言"}):H.map(({message:J,comment:be},Me)=>i.jsxs("div",{className:"quote-card",style:{position:"relative",paddingLeft:64,marginBottom:"12px"},children:[i.jsx("img",{src:J.user.avatar,alt:"avatar",style:{width:48,height:48,borderRadius:"50%",objectFit:"cover",position:"absolute",left:8,top:16,border:"2px solid #6B5BFF"}}),i.jsxs("div",{style:{fontSize:"12px",color:"#666",marginBottom:"4px"},children:["給 ",i.jsx("b",{style:{color:"#6B5BFF"},children:J.user.name})," 的支援留言："]}),i.jsx("div",{className:"quote-text",style:{background:"#f0f8ff",padding:"8px 12px",borderRadius:"8px",border:"1px solid #e6f3ff"},children:be.content}),i.jsx("div",{style:{fontSize:12,color:"#614425",marginTop:6},children:be.createdAt?new Date(be.createdAt).toLocaleString():new Date(J.createdAt).toLocaleString()})]},Me))})()]}),r.map(H=>i.jsxs("div",{className:"quote-card",style:{position:"relative",paddingLeft:64},children:[i.jsx("img",{src:H.user.avatar,alt:"avatar",style:{width:48,height:48,borderRadius:"50%",objectFit:"cover",position:"absolute",left:8,top:16,cursor:"pointer",border:"2px solid #6B5BFF"},onClick:()=>g(H)}),i.jsx("div",{className:"quote-text",children:H.text}),H.audioUrl&&i.jsxs("div",{style:{marginTop:"8px",display:"flex",alignItems:"center",gap:"8px"},children:[i.jsxs("button",{onClick:()=>Ce(H),style:{background:"linear-gradient(135deg, #4CAF50 0%, #45a049 100%)",border:"none",borderRadius:"6px",padding:"4px 8px",color:"white",cursor:"pointer",fontSize:"12px",display:"flex",alignItems:"center",gap:"4px"},children:[i.jsx("span",{children:"▶️"}),"播放原音"]}),i.jsxs("span",{style:{fontSize:"12px",color:"#ccc"},children:["錄音時長: ",H.duration?`${Math.floor(H.duration/60)}:${(H.duration%60).toString().padStart(2,"0")}`:"未知"]})]}),i.jsx("div",{style:{fontSize:12,color:"#fff",marginTop:6},children:new Date(H.createdAt).toLocaleString()}),i.jsx("div",{style:{marginTop:12,display:"flex",justifyContent:"center"},children:i.jsx("button",{onClick:()=>g(H),style:{background:"linear-gradient(135deg, #6B5BFF 60%, #23c6e6 100%)",color:"#fff",border:"none",borderRadius:"20px",padding:"8px 20px",fontSize:"14px",fontWeight:"600",cursor:"pointer",boxShadow:"0 2px 8px rgba(107, 91, 255, 0.3)"},children:ee.supportMessage})}),i.jsxs("div",{style:{marginTop:14,background:"#f7f7ff",borderRadius:10,padding:"10px 14px",boxShadow:"0 1px 6px #6B5BFF11"},children:[i.jsx("b",{style:{color:"#6B5BFF",fontSize:16},children:ee.commentsTitle}),(H.comments||[]).length===0&&i.jsx("span",{style:{color:"#bbb",marginLeft:8},children:ee.noComments}),i.jsx("div",{style:{display:"flex",flexDirection:"column",gap:6,marginTop:6},children:(H.comments||[]).sort((J,be)=>{const Me=J.createdAt?new Date(J.createdAt).getTime():new Date(H.createdAt).getTime();return(be.createdAt?new Date(be.createdAt).getTime():new Date(H.createdAt).getTime())-Me}).map((J,be)=>i.jsxs("div",{style:{background:"#fff",borderRadius:8,padding:"8px 12px",color:"#232946",fontSize:15,border:"1px solid #eee",boxShadow:"0 1px 4px #6B5BFF08",position:"relative",paddingLeft:"60px"},children:[i.jsx("img",{src:J.commenterAvatar||"https://via.placeholder.com/40x40/6B7280/FFFFFF?text=?",alt:"commenter avatar",style:{width:40,height:40,borderRadius:"50%",objectFit:"cover",position:"absolute",left:8,top:8,border:"2px solid #6B5BFF"}}),i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"4px"},children:[i.jsx("b",{style:{color:"#6B5BFF"},children:J.nickname}),(ge(H)||De(J))&&i.jsxs("div",{style:{fontSize:"12px",color:"#666"},children:[i.jsxs("div",{children:["📧 ",J.commenterEmail]}),i.jsxs("div",{children:["🌍 ",J.commenterCountry]}),i.jsxs("div",{children:["👤 ",J.commenterGender,"・",J.commenterAge,"歲"]})]}),!ge(H)&&!De(J)&&i.jsx("div",{style:{fontSize:"12px",color:"#666"},children:i.jsxs("div",{children:["🌍 ",J.commenterCountry]})})]}),i.jsx("div",{children:J.content}),i.jsx("div",{style:{fontSize:10,color:"#999",marginTop:4},children:J.createdAt?new Date(J.createdAt).toLocaleString():new Date(H.createdAt).toLocaleString()}),ge(H)&&!De(J)&&i.jsx("button",{onClick:()=>alert(`聯繫 ${J.nickname}：
郵箱：${J.commenterEmail}
國家：${J.commenterCountry}
性別：${J.commenterGender}
年齡：${J.commenterAge}`),style:{position:"absolute",top:"8px",right:"8px",background:"linear-gradient(135deg, #6B5BFF 60%, #23c6e6 100%)",color:"#fff",border:"none",borderRadius:"12px",padding:"4px 8px",fontSize:"10px",cursor:"pointer",fontWeight:"600"},children:"📞 聯繫"})]},be))})]})]},H.id)),i.jsxs("div",{style:{marginTop:"32px",padding:"20px",background:"linear-gradient(135deg, rgba(107, 91, 255, 0.1) 0%, rgba(35, 198, 230, 0.1) 100%)",borderRadius:"16px",border:"2px solid rgba(107, 91, 255, 0.2)"},children:[i.jsx("h3",{style:{color:"#6B5BFF",fontSize:"1.2rem",marginBottom:"12px",textAlign:"center"},children:"💝 我給別人的支援留言"}),(()=>{const H=Ye();return console.log("我的支援留言數量:",H.length),console.log("我的支援留言:",H),H.length===0?i.jsx("div",{style:{color:"#000",textAlign:"center",padding:"20px"},children:"您還沒有給別人留過支援留言"}):H.map(({message:J,comment:be},Me)=>i.jsxs("div",{className:"quote-card",style:{position:"relative",paddingLeft:64,marginBottom:"12px"},children:[i.jsx("img",{src:J.user.avatar,alt:"avatar",style:{width:48,height:48,borderRadius:"50%",objectFit:"cover",position:"absolute",left:8,top:16,border:"2px solid #6B5BFF"}}),i.jsxs("div",{style:{fontSize:"12px",color:"#666",marginBottom:"4px"},children:["給 ",i.jsx("b",{style:{color:"#6B5BFF"},children:J.user.name})," 的支援留言："]}),i.jsx("div",{className:"quote-text",style:{background:"#f0f8ff",padding:"8px 12px",borderRadius:"8px",border:"1px solid #e6f3ff"},children:be.content}),i.jsx("div",{style:{fontSize:12,color:"#614425",marginTop:6},children:be.createdAt?new Date(be.createdAt).toLocaleString():new Date(J.createdAt).toLocaleString()})]},Me))})()]})]})}),m&&i.jsx("div",{style:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",background:"rgba(0,0,0,0.18)",zIndex:2e3,display:"flex",alignItems:"center",justifyContent:"center"},children:i.jsxs("div",{style:{background:"#fff",borderRadius:28,padding:36,minWidth:340,maxWidth:440,boxShadow:"0 6px 32px #6B5BFF22",textAlign:"center",position:"relative",border:"2px solid #6B5BFF22"},children:[i.jsx("button",{onClick:()=>g(null),style:{position:"absolute",top:12,right:12,background:"none",border:"none",fontSize:22,color:"#6B4F27",cursor:"pointer"},children:"×"}),i.jsx("img",{src:m.user.avatar,alt:"avatar",style:{width:90,height:90,borderRadius:"50%",objectFit:"cover",marginBottom:14,border:"2.5px solid #6B5BFF"}}),i.jsx("div",{style:{fontWeight:900,color:"#6B5BFF",fontSize:22,marginBottom:8},children:m.user.name}),i.jsxs("div",{style:{color:"#6B4F27",fontSize:17,marginBottom:8},children:[m.user.country,"・",m.user.region]}),i.jsxs("div",{style:{color:"#232946",fontSize:16,marginBottom:18},children:[ee.modalTitle,i.jsx("br",{}),m.text]}),i.jsx("div",{style:{color:"#6B5BFF",fontWeight:700,marginBottom:8,fontSize:16},children:ee.modalAction}),i.jsx("div",{style:{color:"#614425",fontSize:14,marginBottom:16,fontStyle:"italic"},children:ee.supportDesc}),i.jsx("div",{style:{color:"#666",fontSize:12,marginBottom:12,padding:"8px",background:"#f0f0f0",borderRadius:"6px"},children:"💡 系統將自動抓取您的個人信息，只有原貼文作者可以看到完整聯絡資訊"}),i.jsx("textarea",{placeholder:ee.commentPlaceholder,value:x,onChange:H=>S(H.target.value),style:{width:"92%",padding:10,borderRadius:8,border:"1px solid #ddd",minHeight:54,fontSize:16}}),i.jsx("button",{onClick:()=>L(m),style:{marginTop:12,padding:"10px 22px",background:"linear-gradient(135deg, #6B5BFF 60%, #23c6e6 100%)",color:"#fff",border:"none",borderRadius:10,fontWeight:900,fontSize:16,letterSpacing:1},children:ee.submitComment})]})})]}),ae&&i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.5)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1e3},children:i.jsxs("div",{style:{background:"white",borderRadius:"16px",padding:"24px",maxWidth:"400px",width:"90%",textAlign:"center",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.3)"},children:[i.jsx("div",{style:{fontSize:"48px",marginBottom:"16px"},children:"🎤"}),i.jsx("h3",{style:{margin:"0 0 16px 0",color:"#333",fontSize:"20px"},children:ee.readyToRecord}),i.jsxs("p",{style:{margin:"0 0 20px 0",color:"#666",lineHeight:"1.5"},children:[ee.recordInstruction,i.jsx("br",{}),i.jsxs("strong",{style:{color:"#ff6b6b"},children:["⚠️ ",ee.recordTimeLimit]})]}),i.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"center"},children:[i.jsx("button",{onClick:Se,style:{background:"#f44336",border:"none",borderRadius:"8px",padding:"12px 24px",color:"white",cursor:"pointer",fontSize:"16px",fontWeight:"600",minWidth:"120px"},children:ee.cancel}),i.jsx("button",{onClick:pe,style:{background:"linear-gradient(135deg, #2196F3 0%, #1976D2 100%)",border:"none",borderRadius:"8px",padding:"12px 24px",color:"white",cursor:"pointer",fontSize:"16px",fontWeight:"600",minWidth:"120px"},children:ee.startRecording})]})]})}),O&&i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.5)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1e3},children:i.jsxs("div",{style:{background:"white",borderRadius:"16px",padding:"24px",maxWidth:"400px",width:"90%",textAlign:"center",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.3)"},children:[i.jsx("h3",{style:{margin:"0 0 16px 0",color:"#333"},children:"語音錄製完成"}),i.jsxs("p",{style:{margin:"0 0 20px 0",color:"#666"},children:["錄音時長: ",Math.floor(Z/60),":",(Z%60).toString().padStart(2,"0")]}),i.jsxs("button",{onClick:()=>{j&&new Audio(j).play()},style:{background:"linear-gradient(135deg, #4CAF50 0%, #45a049 100%)",border:"none",borderRadius:"8px",padding:"8px 16px",color:"white",cursor:"pointer",fontSize:"14px",marginBottom:"16px",display:"flex",alignItems:"center",gap:"6px",margin:"0 auto 16px auto"},children:[i.jsx("span",{children:"▶️"}),"播放錄音"]}),i.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"center"},children:[i.jsx("button",{onClick:we,style:{background:"linear-gradient(135deg, #2196F3 0%, #1976D2 100%)",border:"none",borderRadius:"8px",padding:"10px 20px",color:"white",cursor:"pointer",fontSize:"14px",fontWeight:"600"},children:"發送語音"}),i.jsx("button",{onClick:Re,style:{background:"#f44336",border:"none",borderRadius:"8px",padding:"10px 20px",color:"white",cursor:"pointer",fontSize:"14px",fontWeight:"600"},children:"取消"})]})]})}),ve&&Ne&&i.jsx(Mo,{isOpen:ve,onClose:oe,currentPlan:Ne.currentPlan,remainingDays:Ne.remainingDays,usedTokens:Ne.usedTokens,totalTokens:Ne.totalTokens}),i.jsx(Ln,{})]})}const wS={"zh-TW":{title:"心聲釋放 Voice Release",subtitle:"無需放在心裡...對哪些人事物不滿你可盡情說出，天下沒有不能解決的難題",holdToRecord:"按住錄音",webSimulation:"(網頁版使用模擬錄音)",recording:"錄音中...",stopRecording:"停止錄音",todayMood:"今天的心情",reflectionMoment:"反思時刻",addDiary:"添加心聲",editDiary:"編輯心聲",deleteDiary:"刪除心聲",save:"保存",cancel:"取消",backToHome:"← 返回首頁",logout:"登出",noDiaries:"還沒有心聲日記，開始錄音吧！",startSpeaking:"開始說話",submit:"送出",submitVoice:"送出心聲",recordingComplete:"錄音完成",submitToSave:"點擊送出保存心聲",emotion:{happy:"開心",sad:"難過",angry:"生氣",neutral:"平靜",excited:"興奮",calm:"放鬆"}},"zh-CN":{title:"心声释放 Voice Release",subtitle:"无需放在心里...对哪些人事物不满你可尽情说出，天下没有不能解决的难题",holdToRecord:"按住录音",webSimulation:"(网页版使用模拟录音)",recording:"录音中...",stopRecording:"停止录音",todayMood:"今天的心情",reflectionMoment:"反思时刻",addDiary:"添加心声",editDiary:"编辑心声",deleteDiary:"删除心声",save:"保存",cancel:"取消",backToHome:"← 返回首页",logout:"登出",noDiaries:"还没有心声日记，开始录音吧！",startSpeaking:"开始说话",submit:"送出",submitVoice:"送出心声",recordingComplete:"录音完成",submitToSave:"点击送出保存心声",emotion:{happy:"开心",sad:"难过",angry:"生气",neutral:"平静",excited:"兴奋",calm:"放松"}},ja:{title:"心の声を解放 Voice Release",subtitle:"心に留めておく必要はない...どの人や物事への不満も自由に言い、解決できない問題はない",holdToRecord:"録音を押し続ける",webSimulation:"(Web版は模擬録音を使用)",recording:"録音中...",stopRecording:"録音停止",todayMood:"今日の気分",reflectionMoment:"反省の瞬間",addDiary:"心の声を追加",editDiary:"心の声を編集",deleteDiary:"心の声を削除",save:"保存",cancel:"キャンセル",backToHome:"← ホームに戻る",logout:"ログアウト",noDiaries:"まだ心の声の日記がありません。録音を始めましょう！",startSpeaking:"話し始める",submit:"送信",submitVoice:"心の声を送信",recordingComplete:"録音完了",submitToSave:"送信して心の声を保存",emotion:{happy:"嬉しい",sad:"悲しい",angry:"怒り",neutral:"平静",excited:"興奮",calm:"リラックス"}},ko:{title:"마음의 소리 해방 Voice Release",subtitle:"마음속에 담아둘 필요 없이...어떤 사람이나 사물에 대한 불만을 자유롭게 말하고, 해결할 수 없는 문제는 없다",holdToRecord:"녹음하려면 길게 누르세요",webSimulation:"(웹 버전은 시뮬레이션 녹음 사용)",recording:"녹음 중...",stopRecording:"녹음 중지",todayMood:"오늘의 기분",reflectionMoment:"성찰의 순간",addDiary:"마음의 소리 추가",editDiary:"마음의 소리 편집",deleteDiary:"마음의 소리 삭제",save:"저장",cancel:"취소",backToHome:"← 홈으로 돌아가기",logout:"로그아웃",noDiaries:"아직 마음의 소리 일기가 없습니다. 녹음을 시작해보세요!",startSpeaking:"말하기 시작",submit:"제출",submitVoice:"마음의 소리 제출",recordingComplete:"녹음 완료",submitToSave:"제출하여 마음의 소리 저장",emotion:{happy:"행복",sad:"슬픔",angry:"분노",neutral:"평온",excited:"흥분",calm:"차분"}},th:{title:"ปลดปล่อยเสียงในใจ Voice Release",subtitle:"ไม่จำเป็นต้องเก็บไว้ในใจ...คุณสามารถพูดความไม่พอใจต่อคนหรือสิ่งต่างๆ ได้อย่างอิสระ ไม่มีปัญหาที่แก้ไขไม่ได้",holdToRecord:"กดค้างเพื่อบันทึก",webSimulation:"(เวอร์ชันเว็บใช้การบันทึกจำลอง)",recording:"กำลังบันทึก...",stopRecording:"หยุดบันทึก",todayMood:"อารมณ์วันนี้",reflectionMoment:"ช่วงเวลาสะท้อนคิด",addDiary:"เพิ่มเสียงในใจ",editDiary:"แก้ไขเสียงในใจ",deleteDiary:"ลบเสียงในใจ",save:"บันทึก",cancel:"ยกเลิก",backToHome:"← กลับหน้าหลัก",logout:"ออกจากระบบ",noDiaries:"ยังไม่มีไดอารี่เสียงในใจ เริ่มบันทึกกันเลย!",startSpeaking:"เริ่มพูด",submit:"ส่ง",submitVoice:"ส่งเสียงในใจ",recordingComplete:"บันทึกเสร็จสิ้น",submitToSave:"คลิกส่งเพื่อบันทึกเสียงในใจ",emotion:{happy:"มีความสุข",sad:"เศร้า",angry:"โกรธ",neutral:"สงบ",excited:"ตื่นเต้น",calm:"ผ่อนคลาย"}},vi:{title:"Giải Phóng Tiếng Lòng Voice Release",subtitle:"Không cần giữ trong lòng...bạn có thể tự do nói ra sự bất mãn với những người hoặc sự việc nào đó, không có vấn đề nào không thể giải quyết",holdToRecord:"Giữ để ghi âm",webSimulation:"(Phiên bản web sử dụng ghi âm mô phỏng)",recording:"Đang ghi âm...",stopRecording:"Dừng ghi âm",todayMood:"Tâm trạng hôm nay",reflectionMoment:"Khoảnh khắc suy ngẫm",addDiary:"Thêm tiếng lòng",editDiary:"Chỉnh sửa tiếng lòng",deleteDiary:"Xóa tiếng lòng",save:"Lưu",cancel:"Hủy",backToHome:"← Về trang chủ",logout:"Đăng xuất",noDiaries:"Chưa có nhật ký tiếng lòng, hãy bắt đầu ghi âm!",startSpeaking:"Bắt đầu nói",submit:"Gửi",submitVoice:"Gửi tiếng lòng",recordingComplete:"Ghi âm hoàn thành",submitToSave:"Nhấp để gửi và lưu tiếng lòng",emotion:{happy:"Vui vẻ",sad:"Buồn",angry:"Tức giận",neutral:"Bình tĩnh",excited:"Hưng phấn",calm:"Thư giãn"}},ms:{title:"Pelepasan Suara Hati Voice Release",subtitle:"Tidak perlu disimpan dalam hati...anda boleh bebas mengucapkan ketidakpuasan terhadap orang atau perkara tertentu, tiada masalah yang tidak dapat diselesaikan",holdToRecord:"Tahan untuk Rakam",webSimulation:"(Versi web menggunakan rakaman simulasi)",recording:"Merakam...",stopRecording:"Hentikan Rakaman",todayMood:"Mood Hari Ini",reflectionMoment:"Saat Refleksi",addDiary:"Tambah Suara Hati",editDiary:"Sunting Suara Hati",deleteDiary:"Padam Suara Hati",save:"Simpan",cancel:"Batal",backToHome:"← Kembali ke Rumah",logout:"Log Keluar",noDiaries:"Belum ada diari suara hati, mulakan rakaman!",startSpeaking:"Mula Bercakap",submit:"Hantar",submitVoice:"Hantar Suara Hati",recordingComplete:"Rakaman Selesai",submitToSave:"Klik untuk hantar dan simpan suara hati",emotion:{happy:"Gembira",sad:"Sedih",angry:"Marah",neutral:"Tenang",excited:"Teruja",calm:"Selesa"}},la:{title:"Vox Liberatio Voice Release",subtitle:"Non necesse est in corde servare...liberam dissatisfactionem cum hominibus vel rebus quibusdam profer, nulla quaestio insolubilis est",holdToRecord:"Tene ad Recordandum",webSimulation:"(Versio interretialis simulatione utitur)",recording:"Recordans...",stopRecording:"Recordationem Cessa",todayMood:"Affectus Hodiernus",reflectionMoment:"Momentum Cogitationis",addDiary:"Vox Adde",editDiary:"Vox Edita",deleteDiary:"Vox Dele",save:"Serva",cancel:"Cancella",backToHome:"← Ad Domum Reverte",logout:"Exi",noDiaries:"Nondum diaria vocis cordis, incipiamus recordare!",startSpeaking:"Incipe Loqui",submit:"Submitte",submitVoice:"Vox Submitte",recordingComplete:"Recordatio Perfecta",submitToSave:"Click ut submitte et serva vocem",emotion:{happy:"Laetus",sad:"Tristis",angry:"Iratus",neutral:"Tranquillus",excited:"Excitatus",calm:"Placidus"}},en:{title:"Voice Release",subtitle:"No need to keep it in your heart...you can freely speak out your dissatisfaction with which people or things, there is no problem that cannot be solved",holdToRecord:"Hold to Record",webSimulation:"(Web version uses simulated recording)",recording:"Recording...",stopRecording:"Stop Recording",todayMood:"Today's Mood",reflectionMoment:"Reflection Moment",addDiary:"Add Voice",editDiary:"Edit Voice",deleteDiary:"Delete Voice",save:"Save",cancel:"Cancel",backToHome:"← Back to Home",logout:"Logout",noDiaries:"No heart voice diaries yet, start recording!",startSpeaking:"Start Speaking",submit:"Submit",submitVoice:"Submit Voice",recordingComplete:"Recording Complete",submitToSave:"Click to submit and save voice",emotion:{happy:"Happy",sad:"Sad",angry:"Angry",neutral:"Neutral",excited:"Excited",calm:"Calm"}}};function Cz(){const n=wt(),{lang:e,setLang:t}=Bt(),r=wS[e]||wS["zh-TW"],[s,a]=w.useState(!1),[c,d]=w.useState(null),[h,m]=w.useState([]),g=w.useRef([]),[x,S]=w.useState(()=>{const V=localStorage.getItem("voiceDiaries");return V?JSON.parse(V):[{id:1,title:"今天的心情",content:"今天感覺很棒，完成了所有計劃的任務。",date:new Date().toISOString(),emotion:"happy",expanded:!1},{id:2,title:"反思時刻",content:"需要學會更好地管理時間，提高效率。",date:new Date(Date.now()-24*60*60*1e3).toISOString(),emotion:"neutral",expanded:!1}]}),[I,_]=w.useState(!1),[R,T]=w.useState(!1),[A,D]=w.useState(null),[F,X]=w.useState({title:"",content:"",emotion:"neutral"}),[ie,G]=w.useState(0),[N,E]=w.useState(null),[P,M]=w.useState(null),[O,z]=w.useState(!1),[j,K]=w.useState(!1),{checkPermission:Z,recordUsage:Y}=Lo(),[ae,se]=w.useState(!1),[re,ne]=w.useState(null),[W,$]=w.useState(null),[ee,he]=w.useState(null),_e=async()=>{if(s){c&&c.state==="recording"&&c.stop(),N&&(clearInterval(N),E(null)),a(!1),_(!1),G(0);return}const V=await Z("aiChat");if(!V.allowed){V.canRenew,ne(V),se(!0);return}K(!0)},ve=async()=>{K(!1);try{const V=await navigator.mediaDevices.getUserMedia({audio:!0}),L=new MediaRecorder(V,{mimeType:"audio/webm;codecs=opus"});m([]),g.current=[],G(0),L.ondataavailable=H=>{console.log("收到音頻數據，大小:",H.data.size),H.data.size>0&&(g.current.push(H.data),m(J=>{const be=[...J,H.data];return console.log("更新音頻塊，當前數量:",be.length),be}))},L.onstop=()=>{const H=[...g.current];console.log("錄音停止，音頻塊數量:",H.length);const J=H.length>0?new Blob(H,{type:"audio/webm"}):new Blob([""],{type:"audio/webm"}),be=Math.max(1,Math.floor(H.length*.1));console.log("創建音頻blob，大小:",J.size,"估算錄音時長:",be),M({blob:J,duration:be}),z(!0),m([]),g.current=[],console.log("設置送出對話框狀態"),V.getTracks().forEach(Me=>Me.stop())},L.start(100),d(L),a(!0),_(!0);const oe=setInterval(()=>{G(H=>{const J=H+1;return J>=60&&(c&&c.state==="recording"&&c.stop(),oe&&(clearInterval(oe),E(null)),a(!1),_(!1),alert("錄音時間已達1分鐘限制，已自動停止錄音")),J})},1e3);E(oe)}catch(V){console.error("錄音錯誤:",V),alert("無法啟動麥克風，請檢查權限設置")}},Le=()=>{K(!1)},Ne=(V,L)=>{const oe=URL.createObjectURL(V),H=["今天心情很好，完成了所有工作。","遇到了一些挑戰，但都克服了。","學會了新的技能，感覺很有成就感。","和朋友聊天很開心，分享了很多想法。","反思今天的行為，發現還有改進空間。"],J=H[Math.floor(Math.random()*H.length)],be=["happy","neutral","calm"][Math.floor(Math.random()*3)],$e=[{id:Date.now(),title:"心聲日記",content:J,date:new Date().toISOString(),emotion:be,expanded:!1,audioUrl:oe,duration:L},...x];S($e),Je($e),_(!1)},nt=()=>{P&&(Ne(P.blob,P.duration),M(null),z(!1),Y("aiChat",1))},Je=V=>{localStorage.setItem("voiceDiaries",JSON.stringify(V))},ge=()=>{M(null),z(!1)},De=()=>{if(F.title.trim()&&F.content.trim()){const L=[{id:Date.now(),title:F.title,content:F.content,date:new Date().toISOString(),emotion:F.emotion,expanded:!1,duration:0},...x];S(L),Je(L),X({title:"",content:"",emotion:"neutral"}),T(!1)}},tt=V=>{D(V),X({title:V.title,content:V.content,emotion:V.emotion})},Ye=()=>{if(A&&F.title.trim()&&F.content.trim()){const V=x.map(L=>L.id===A.id?{...L,title:F.title,content:F.content,emotion:F.emotion}:L);S(V),Je(V),D(null),X({title:"",content:"",emotion:"neutral"})}},We=V=>{if(window.confirm("確定要刪除這個心聲日記嗎？")){const L=x.filter(oe=>oe.id!==V);S(L),Je(L)}},pe=V=>{const L=x.map(oe=>oe.id===V?{...oe,expanded:!oe.expanded}:{...oe,expanded:!1});S(L),Je(L)},Se=V=>{if(W===V.id){ee&&(ee.pause(),ee.currentTime=0),window.speechSynthesis.speaking&&window.speechSynthesis.cancel(),$(null),he(null);return}if(ee&&(ee.pause(),ee.currentTime=0),window.speechSynthesis.speaking&&window.speechSynthesis.cancel(),V.audioUrl){const L=new Audio(V.audioUrl);L.onended=()=>{$(null),he(null)},L.onerror=oe=>{console.error("音頻加載失敗:",oe),$(null),he(null),we(V.content)},L.play().then(()=>{console.log("正在播放原音..."),$(V.id),he(L)}).catch(oe=>{console.error("播放失敗:",oe),$(null),he(null),we(V.content)})}else $(V.id),we(V.content)},we=V=>{if("speechSynthesis"in window){if(window.speechSynthesis.speaking){window.speechSynthesis.cancel(),$(null),he(null);return}const L=new SpeechSynthesisUtterance(V);L.lang="zh-TW",L.rate=.9,L.pitch=1,L.onend=()=>{$(null),he(null)},L.onerror=()=>{$(null),he(null)},window.speechSynthesis.speak(L),console.log("正在播放心聲日記內容（文字轉語音）...")}else alert("瀏覽器不支援語音播放功能"),$(null),he(null)},Re=V=>({happy:"#4CAF50",sad:"#2196F3",angry:"#F44336",neutral:"#9E9E9E",excited:"#FF9800",calm:"#8BC34A"})[V]||"#9E9E9E",Ce=V=>new Date(V).toLocaleString("zh-TW",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"});w.useEffect(()=>()=>{N&&clearInterval(N)},[N]);const U=()=>{se(!1),ne(null)};return i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{minHeight:"100vh",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",padding:"20px"},children:[i.jsx("style",{children:`
            @keyframes pulse {
              0% { transform: scale(1); }
              50% { transform: scale(1.05); }
              100% { transform: scale(1); }
            }
            @keyframes bounce {
              0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
              40% { transform: translateY(-3px); }
              60% { transform: translateY(-2px); }
            }
          `}),i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"30px"},children:[i.jsx("button",{onClick:()=>n("/home"),style:{background:"#fff",border:"1.5px solid #6B5BFF",borderRadius:"8px",padding:"6px 10px",color:"#6B5BFF",cursor:"pointer",fontSize:"16px",fontWeight:"600",transition:"background 0.18s, color 0.18s, border 0.18s"},children:"返回"}),i.jsx("h1",{style:{color:"white",fontSize:"24px",fontWeight:"bold",margin:0},children:r.title}),i.jsxs("div",{style:{display:"flex",gap:"10px"},children:[i.jsx(Mn,{}),i.jsx("button",{onClick:()=>n("/logout"),style:{background:"rgba(255,255,255,0.2)",border:"none",borderRadius:"8px",padding:"8px 16px",color:"white",cursor:"pointer",fontSize:"14px"},children:r.logout})]})]}),i.jsxs("div",{style:{maxWidth:"800px",margin:"0 auto"},children:[i.jsxs("div",{style:{background:"rgba(255,255,255,0.95)",borderRadius:"20px",padding:"40px",textAlign:"center",marginBottom:"30px",boxShadow:"0 8px 32px rgba(0,0,0,0.1)"},children:[i.jsxs("div",{style:{marginBottom:"20px"},children:[i.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",marginBottom:"15px"},children:i.jsx("button",{onClick:_e,style:{width:"80px",height:"80px",borderRadius:"50%",background:s?"linear-gradient(45deg, #ff5722, #ff9800)":"linear-gradient(45deg, #ff9800, #ff5722)",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:s?"0 0 0 4px #ffe0b2, 0 0 20px rgba(255, 87, 34, 0.5)":"0 4px 16px rgba(255, 152, 0, 0.3)",cursor:"pointer",transition:"all 0.3s ease",border:"none",animation:s?"pulse 1.5s infinite":"none"},onMouseEnter:V=>{s||(V.currentTarget.style.transform="scale(1.1)")},onMouseLeave:V=>{s||(V.currentTarget.style.transform="scale(1)")},children:i.jsx("span",{style:{fontSize:"32px",color:"white",filter:s?"drop-shadow(0 0 6px #ff9800)":""},children:s?"⏹️":"🎤"})})}),i.jsx("div",{style:{color:s?"#ff5722":"#ff9800",fontSize:"16px",fontWeight:"700",marginBottom:"10px",textAlign:"center"},children:s?r.stopRecording:r.startSpeaking}),s&&i.jsxs("div",{style:{color:"#ff5722",fontSize:"14px",fontWeight:"600",textAlign:"center",marginBottom:"10px"},children:["錄音中... ",Math.floor(ie/60),":",(ie%60).toString().padStart(2,"0")]})]}),i.jsx("p",{style:{color:"#666",fontSize:"14px",marginBottom:"20px"},children:r.holdToRecord}),i.jsx("p",{style:{color:"#999",fontSize:"12px",fontStyle:"italic"},children:r.webSimulation}),i.jsxs("button",{onClick:()=>T(!0),style:{background:"linear-gradient(45deg, #667eea, #764ba2)",border:"none",borderRadius:"12px",padding:"12px 24px",color:"white",cursor:"pointer",fontSize:"16px",fontWeight:"600",marginTop:"20px"},children:["+ ",r.addDiary]})]}),i.jsxs("div",{style:{marginBottom:"30px"},children:[i.jsxs("h3",{style:{color:"white",fontSize:"20px",marginBottom:"20px",fontWeight:"600"},children:["心聲日記 (",x.length,")"]}),x.length===0?i.jsx("div",{style:{background:"rgba(255,255,255,0.95)",borderRadius:"16px",padding:"40px",textAlign:"center",color:"#666"},children:r.noDiaries}):i.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:x.map(V=>i.jsx("div",{style:{background:"rgba(255,255,255,0.95)",borderRadius:"16px",padding:"20px",boxShadow:"0 4px 16px rgba(0,0,0,0.1)"},children:i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"12px"},children:[i.jsxs("div",{style:{flex:1},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",marginBottom:"8px"},children:[i.jsx("button",{onClick:()=>pe(V.id),style:{background:"none",border:"none",cursor:"pointer",fontSize:"16px",fontWeight:"600",color:"#333",textAlign:"left",flex:1},children:V.title}),i.jsx("button",{onClick:()=>Se(V),style:{background:W===V.id?"linear-gradient(45deg, #ff5722, #ff9800)":"linear-gradient(45deg, #4CAF50, #45a049)",border:"none",borderRadius:"50%",width:"36px",height:"36px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",transition:"transform 0.2s"},onMouseEnter:L=>{L.currentTarget.style.transform="scale(1.1)"},onMouseLeave:L=>{L.currentTarget.style.transform="scale(1)"},children:i.jsx("span",{style:{fontSize:"16px",color:"white"},children:W===V.id?"⏹️":"▶️"})}),i.jsx("span",{style:{background:Re(V.emotion),color:"white",padding:"4px 8px",borderRadius:"12px",fontSize:"12px",fontWeight:"600"},children:r.emotion[V.emotion]})]}),V.expanded&&i.jsxs("div",{style:{marginTop:"12px",padding:"12px",background:"rgba(0,0,0,0.05)",borderRadius:"8px"},children:[i.jsx("p",{style:{color:"#666",fontSize:"14px",lineHeight:"1.5",marginBottom:"8px"},children:V.content}),i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:"8px"},children:[i.jsx("p",{style:{color:"#999",fontSize:"12px"},children:Ce(V.date)}),V.duration&&i.jsxs("span",{style:{color:"#667eea",fontSize:"12px",fontWeight:"500",background:"rgba(102, 126, 234, 0.1)",padding:"2px 6px",borderRadius:"4px"},children:["⏱️ ",Math.floor(V.duration/60),":",(V.duration%60).toString().padStart(2,"0")]})]})]})]}),i.jsxs("div",{style:{display:"flex",gap:"8px"},children:[i.jsxs("button",{onClick:()=>tt(V),style:{background:"#4CAF50",border:"none",borderRadius:"6px",padding:"6px 12px",color:"white",cursor:"pointer",fontSize:"12px"},children:["✏️ ",r.editDiary]}),i.jsxs("button",{onClick:()=>We(V.id),style:{background:"#F44336",border:"none",borderRadius:"6px",padding:"6px 12px",color:"white",cursor:"pointer",fontSize:"12px"},children:["🗑️ ",r.deleteDiary]})]})]})},V.id))})]})]}),R&&i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:i.jsxs("div",{style:{background:"white",borderRadius:"16px",padding:"30px",width:"90%",maxWidth:"500px"},children:[i.jsx("h3",{style:{marginBottom:"20px",color:"#333"},children:r.addDiary}),i.jsxs("div",{style:{marginBottom:"16px"},children:[i.jsx("label",{style:{display:"block",marginBottom:"8px",color:"#666"},children:"標題"}),i.jsx("input",{type:"text",value:F.title,onChange:V=>X(L=>({...L,title:V.target.value})),style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid #ddd",fontSize:"14px"},placeholder:"輸入日記標題"})]}),i.jsxs("div",{style:{marginBottom:"16px"},children:[i.jsx("label",{style:{display:"block",marginBottom:"8px",color:"#666"},children:"內容"}),i.jsx("textarea",{value:F.content,onChange:V=>X(L=>({...L,content:V.target.value})),style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid #ddd",fontSize:"14px",minHeight:"100px",resize:"vertical"},placeholder:"輸入日記內容"})]}),i.jsxs("div",{style:{marginBottom:"20px"},children:[i.jsx("label",{style:{display:"block",marginBottom:"8px",color:"#666"},children:"情緒"}),i.jsxs("select",{value:F.emotion,onChange:V=>X(L=>({...L,emotion:V.target.value})),style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid #ddd",fontSize:"14px"},children:[i.jsx("option",{value:"happy",children:r.emotion.happy}),i.jsx("option",{value:"sad",children:r.emotion.sad}),i.jsx("option",{value:"angry",children:r.emotion.angry}),i.jsx("option",{value:"neutral",children:r.emotion.neutral}),i.jsx("option",{value:"excited",children:r.emotion.excited}),i.jsx("option",{value:"calm",children:r.emotion.calm})]})]}),i.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"flex-end"},children:[i.jsx("button",{onClick:()=>T(!1),style:{background:"#f5f5f5",border:"none",borderRadius:"8px",padding:"12px 24px",color:"#666",cursor:"pointer",fontSize:"14px"},children:r.cancel}),i.jsx("button",{onClick:De,style:{background:"linear-gradient(45deg, #667eea, #764ba2)",border:"none",borderRadius:"8px",padding:"12px 24px",color:"white",cursor:"pointer",fontSize:"14px",fontWeight:"600"},children:r.save})]})]})}),A&&i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:i.jsxs("div",{style:{background:"white",borderRadius:"16px",padding:"30px",width:"90%",maxWidth:"500px"},children:[i.jsx("h3",{style:{marginBottom:"20px",color:"#333"},children:r.editDiary}),i.jsxs("div",{style:{marginBottom:"16px"},children:[i.jsx("label",{style:{display:"block",marginBottom:"8px",color:"#666"},children:"標題"}),i.jsx("input",{type:"text",value:F.title,onChange:V=>X(L=>({...L,title:V.target.value})),style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid #ddd",fontSize:"14px"}})]}),i.jsxs("div",{style:{marginBottom:"16px"},children:[i.jsx("label",{style:{display:"block",marginBottom:"8px",color:"#666"},children:"內容"}),i.jsx("textarea",{value:F.content,onChange:V=>X(L=>({...L,content:V.target.value})),style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid #ddd",fontSize:"14px",minHeight:"100px",resize:"vertical"}})]}),i.jsxs("div",{style:{marginBottom:"20px"},children:[i.jsx("label",{style:{display:"block",marginBottom:"8px",color:"#666"},children:"情緒"}),i.jsxs("select",{value:F.emotion,onChange:V=>X(L=>({...L,emotion:V.target.value})),style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid #ddd",fontSize:"14px"},children:[i.jsx("option",{value:"happy",children:r.emotion.happy}),i.jsx("option",{value:"sad",children:r.emotion.sad}),i.jsx("option",{value:"angry",children:r.emotion.angry}),i.jsx("option",{value:"neutral",children:r.emotion.neutral}),i.jsx("option",{value:"excited",children:r.emotion.excited}),i.jsx("option",{value:"calm",children:r.emotion.calm})]})]}),i.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"flex-end"},children:[i.jsx("button",{onClick:()=>D(null),style:{background:"#f5f5f5",border:"none",borderRadius:"8px",padding:"12px 24px",color:"#666",cursor:"pointer",fontSize:"14px"},children:r.cancel}),i.jsx("button",{onClick:Ye,style:{background:"linear-gradient(45deg, #667eea, #764ba2)",border:"none",borderRadius:"8px",padding:"12px 24px",color:"white",cursor:"pointer",fontSize:"14px",fontWeight:"600"},children:r.save})]})]})}),j&&i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:i.jsxs("div",{style:{background:"white",borderRadius:"16px",padding:"30px",width:"90%",maxWidth:"500px",textAlign:"center"},children:[i.jsx("div",{style:{fontSize:"48px",marginBottom:"20px"},children:"🎤"}),i.jsx("h3",{style:{marginBottom:"16px",color:"#333",fontSize:"20px",fontWeight:"600"},children:"準備開始錄音"}),i.jsxs("p",{style:{marginBottom:"20px",color:"#666",fontSize:"16px",lineHeight:"1.5"},children:["點擊「開始錄音」後，系統將開始錄製您的語音日記。",i.jsx("br",{}),i.jsx("strong",{style:{color:"#ff6b6b"},children:"⚠️ 錄音時間限制為1分鐘"})]}),i.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"center"},children:[i.jsx("button",{onClick:Le,style:{background:"#f5f5f5",border:"none",borderRadius:"8px",padding:"12px 24px",color:"#666",cursor:"pointer",fontSize:"14px",fontWeight:"500"},children:"取消"}),i.jsx("button",{onClick:ve,style:{background:"linear-gradient(45deg, #667eea, #764ba2)",border:"none",borderRadius:"8px",padding:"12px 24px",color:"white",cursor:"pointer",fontSize:"14px",fontWeight:"600",boxShadow:"0 4px 12px rgba(102, 126, 234, 0.3)"},children:"開始錄音"})]})]})}),O&&P&&(console.log("渲染送出對話框，pendingAudio:",P),!0)&&i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:i.jsxs("div",{style:{background:"white",borderRadius:"16px",padding:"30px",width:"90%",maxWidth:"500px",textAlign:"center"},children:[i.jsx("div",{style:{fontSize:"48px",marginBottom:"20px",animation:"bounce 0.6s infinite"},children:"🎤"}),i.jsx("h3",{style:{marginBottom:"10px",color:"#333",fontSize:"20px",fontWeight:"600"},children:r.recordingComplete}),i.jsx("p",{style:{marginBottom:"20px",color:"#666",fontSize:"16px"},children:r.submitToSave}),i.jsx("div",{style:{marginBottom:"20px",padding:"15px",background:"#f8f9fa",borderRadius:"8px",border:"1px solid #e9ecef"},children:i.jsxs("div",{style:{color:"#495057",fontSize:"14px",fontWeight:"500"},children:["錄音時長: ",Math.floor(P.duration/60),":",(P.duration%60).toString().padStart(2,"0")]})}),i.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"center"},children:[i.jsx("button",{onClick:ge,style:{background:"#f5f5f5",border:"none",borderRadius:"8px",padding:"12px 24px",color:"#666",cursor:"pointer",fontSize:"14px",fontWeight:"500"},children:r.cancel}),i.jsx("button",{onClick:nt,style:{background:"linear-gradient(45deg, #667eea, #764ba2)",border:"none",borderRadius:"8px",padding:"12px 24px",color:"white",cursor:"pointer",fontSize:"14px",fontWeight:"600",boxShadow:"0 4px 12px rgba(102, 126, 234, 0.3)"},children:r.submit})]})]})})]}),ae&&re&&i.jsx(Mo,{isOpen:ae,onClose:U,currentPlan:re.currentPlan,remainingDays:re.remainingDays,usedTokens:re.usedTokens,totalTokens:re.totalTokens}),i.jsx(Ln,{})]})}const qj=({isOpen:n,onClose:e,featureName:t})=>{const r=wt();if(!n)return null;const s={basic:{price:"NT$ 149",tokens:"50K",features:["語音功能","AI 聊天","語音轉文字","文字轉語音"]}},a=()=>{e(),r("/plans")};return i.jsx("div",{style:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",background:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e4},children:i.jsxs("div",{style:{background:"#fff",borderRadius:20,padding:32,maxWidth:480,width:"90%",textAlign:"center",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.2)"},children:[i.jsx("div",{style:{fontSize:48,marginBottom:16,color:"#6B5BFF"},children:"🚀"}),i.jsxs("h2",{style:{fontSize:24,fontWeight:700,color:"#333",marginBottom:12},children:["升級方案，解鎖 ",t]}),i.jsxs("p",{style:{fontSize:16,color:"#666",marginBottom:20,lineHeight:1.6},children:["您目前使用的是免費方案，",t," 需要升級才能使用。"]}),i.jsxs("div",{style:{background:"linear-gradient(135deg, #f8f9ff 0%, #e8f4ff 100%)",borderRadius:12,padding:16,marginBottom:24,border:"1px solid #e0e8ff"},children:[i.jsx("div",{style:{fontSize:14,color:"#6B5BFF",fontWeight:600,marginBottom:8},children:"📊 方案對比"}),i.jsxs("div",{style:{fontSize:13,color:"#666",lineHeight:1.4},children:["• 免費方案：僅限文字功能",i.jsx("br",{}),"• 付費方案：解鎖語音、AI 聊天等進階功能",i.jsx("br",{}),"• 立即升級：享受完整功能體驗"]})]}),i.jsxs("div",{style:{background:"#fff",borderRadius:12,padding:20,marginBottom:24,border:"2px solid #6B5BFF",boxShadow:"0 2px 8px #6B5BFF22"},children:[i.jsx("div",{style:{fontSize:16,color:"#6B5BFF",fontWeight:700,marginBottom:12},children:"💡 推薦方案"}),i.jsxs("div",{style:{fontSize:14,color:"#666",lineHeight:1.5,marginBottom:16},children:[i.jsx("strong",{children:"基礎版："}),"最受歡迎的入門方案",i.jsx("br",{}),"包含 ",s.basic.tokens," tokens，",s.basic.features.join("、")]}),i.jsx("div",{style:{fontSize:18,fontWeight:700,color:"#6B5BFF"},children:s.basic.price})]}),i.jsxs("div",{style:{background:"linear-gradient(135deg, #fff3cd 0%, #ffeaa7 100%)",borderRadius:12,padding:16,marginBottom:24,border:"1px solid #ffeaa7"},children:[i.jsx("div",{style:{fontSize:14,color:"#856404",fontWeight:600,marginBottom:8},children:"✨ 升級好處"}),i.jsxs("div",{style:{fontSize:13,color:"#856404",lineHeight:1.4},children:["• 立即解鎖 ",t,i.jsx("br",{}),"• 享受完整的 AI 體驗",i.jsx("br",{}),"• 無限制使用語音功能",i.jsx("br",{}),"• 優先技術支援"]})]}),i.jsxs("div",{style:{display:"flex",gap:12,justifyContent:"center"},children:[i.jsx("button",{onClick:a,style:{background:"linear-gradient(135deg, #6B5BFF 0%, #00CFFF 100%)",color:"#fff",border:"none",borderRadius:12,padding:"14px 28px",fontSize:16,fontWeight:700,cursor:"pointer",flex:1,boxShadow:"0 4px 12px #6B5BFF33",transition:"all 0.3s ease"},onMouseEnter:c=>{c.currentTarget.style.transform="translateY(-2px)",c.currentTarget.style.boxShadow="0 6px 16px #6B5BFF44"},onMouseLeave:c=>{c.currentTarget.style.transform="translateY(0)",c.currentTarget.style.boxShadow="0 4px 12px #6B5BFF33"},children:"🚀 立即升級"}),i.jsx("button",{onClick:e,style:{background:"#f8f9ff",color:"#6B5BFF",border:"2px solid #6B5BFF",borderRadius:12,padding:"14px 28px",fontSize:16,fontWeight:600,cursor:"pointer",flex:1,transition:"all 0.3s ease"},onMouseEnter:c=>{c.currentTarget.style.background="#6B5BFF",c.currentTarget.style.color="#fff"},onMouseLeave:c=>{c.currentTarget.style.background="#f8f9ff",c.currentTarget.style.color="#6B5BFF"},children:"💫 稍後再說"})]}),i.jsx("div",{style:{marginTop:16},children:i.jsx("button",{onClick:e,style:{background:"none",border:"none",color:"#888",fontSize:14,cursor:"pointer",textDecoration:"underline"},children:"稍後再說"})})]})})},SS={"zh-TW":{title:"我的故事 My Story",subtitle:"記錄你的成長歷程，見證改變的每一步",backToHome:"← 返回首頁",logout:"登出",addMilestone:"添加里程碑",editMilestone:"編輯里程碑",deleteMilestone:"刪除里程碑",save:"保存",cancel:"取消",totalDays:"總天數",achievements:"成就",currentStreak:"連續",days:"天",myMilestones:"我的里程碑",noMilestones:"還沒有里程碑，開始記錄你的故事吧！",milestoneTypes:{start:"開始",achievement:"成就",growth:"成長",habit:"習慣",help:"幫助",goal:"目標"}},"zh-CN":{title:"我的故事 My Story",subtitle:"记录你的成长历程，见证改变的每一步",backToHome:"← 返回首页",logout:"登出",addMilestone:"添加里程碑",editMilestone:"编辑里程碑",deleteMilestone:"删除里程碑",save:"保存",cancel:"取消",totalDays:"总天数",achievements:"成就",currentStreak:"连续",days:"天",myMilestones:"我的里程碑",noMilestones:"还没有里程碑，开始记录你的故事吧！",milestoneTypes:{start:"开始",achievement:"成就",growth:"成长",habit:"习惯",help:"帮助",goal:"目标"}},en:{title:"My Story",subtitle:"Record your growth journey, witness every step of change",backToHome:"← Back to Home",logout:"Logout",addMilestone:"Add Milestone",editMilestone:"Edit Milestone",deleteMilestone:"Delete Milestone",save:"Save",cancel:"Cancel",totalDays:"Total Days",achievements:"Achievements",currentStreak:"Current Streak",days:"days",myMilestones:"My Milestones",noMilestones:"No milestones yet, start recording your story!",milestoneTypes:{start:"Start",achievement:"Achievement",growth:"Growth",habit:"Habit",help:"Help",goal:"Goal"}}};function Rz(){const n=wt(),{lang:e,setLang:t}=Bt(),r=SS[e]||SS["zh-TW"],s=async()=>{try{const H=gt().currentUser;if(H){const J=kd(),be=Gn(J,"profiles",H.uid),Me=await Io(be);if(Me.exists()){const $e=Me.data();$e.avatar&&Z($e.avatar)}}}catch(oe){console.error("獲取用戶頭像失敗:",oe)}},[a,c]=w.useState(()=>{const oe=localStorage.getItem("userMilestones");return oe?JSON.parse(oe):[{id:1,title:"開始新的旅程",description:"決定重新開始，為自己設定新的目標",date:new Date(Date.now()-30*24*60*60*1e3).toISOString(),type:"start",completed:!0},{id:2,title:"完成第一個小目標",description:"成功完成了一項小任務，感覺很棒",date:new Date(Date.now()-25*24*60*60*1e3).toISOString(),type:"achievement",completed:!0},{id:3,title:"學會控制情緒",description:"在困難時刻保持冷靜，學會了情緒管理",date:new Date(Date.now()-20*24*60*60*1e3).toISOString(),type:"growth",completed:!0},{id:4,title:"建立新的習慣",description:"每天堅持做一些小事情，建立正向習慣",date:new Date(Date.now()-15*24*60*60*1e3).toISOString(),type:"habit",completed:!0},{id:5,title:"幫助他人",description:"第一次主動幫助別人，感受到付出的快樂",date:new Date(Date.now()-10*24*60*60*1e3).toISOString(),type:"help",completed:!0},{id:6,title:"設定更大的目標",description:"為自己設定更具挑戰性的目標",date:new Date(Date.now()+5*24*60*60*1e3).toISOString(),type:"goal",completed:!1}]}),[d]=w.useState({name:"我的故事",startDate:new Date(Date.now()-30*24*60*60*1e3),totalDays:30,achievements:5,currentStreak:7}),[h,m]=w.useState(!1),[g,x]=w.useState(null),[S,I]=w.useState({title:"",description:"",type:"achievement"}),[_,R]=w.useState(!1),[T,A]=w.useState(!1),[D,F]=w.useState(0),[X,ie]=w.useState(null),[G,N]=w.useState(!1),[E,P]=w.useState(!1),[M,O]=w.useState(null),[z,j]=w.useState(null),[K,Z]=w.useState("/avatars/Derxl.png"),[Y,ae]=w.useState([]),se=w.useRef([]),{checkPermission:re,recordUsage:ne}=Lo(),[W,$]=w.useState(!1),[ee,he]=w.useState(!1),[_e,ve]=w.useState(null);w.useEffect(()=>{s()},[]);const Le=oe=>{localStorage.setItem("userMilestones",JSON.stringify(oe))},Ne=()=>{if(S.title.trim()&&S.description.trim()){const H=[{id:Date.now(),title:S.title,description:S.description,date:new Date().toISOString(),type:S.type,completed:!1},...a];c(H),Le(H),I({title:"",description:"",type:"achievement"}),m(!1)}},nt=oe=>{x(oe),I({title:oe.title,description:oe.description,type:oe.type})},Je=()=>{if(g&&S.title.trim()&&S.description.trim()){const oe=a.map(H=>H.id===g.id?{...H,title:S.title,description:S.description,type:S.type}:H);c(oe),Le(oe),x(null),I({title:"",description:"",type:"achievement"})}},ge=oe=>{if(window.confirm("確定要刪除這個里程碑嗎？")){const H=a.filter(J=>J.id!==oe);c(H),Le(H)}},De=async()=>{if(T){M&&M.state==="recording"&&M.stop(),z&&(clearInterval(z),j(null)),A(!1),R(!1),F(0);return}const oe=await re("aiChat");if(!oe.allowed){oe.isFreeUser?he(!0):(oe.canRenew,ve(oe),$(!0));return}P(!0)},tt=async()=>{P(!1);try{const oe=await navigator.mediaDevices.getUserMedia({audio:!0}),H=new MediaRecorder(oe,{mimeType:"audio/webm;codecs=opus"});ae([]),se.current=[],F(0),H.ondataavailable=be=>{console.log("收到音頻數據，大小:",be.data.size),be.data.size>0&&(se.current.push(be.data),ae(Me=>{const $e=[...Me,be.data];return console.log("更新音頻塊，當前數量:",$e.length),$e}))},H.onstop=()=>{const be=[...se.current];console.log("錄音停止，音頻塊數量:",be.length);const Me=be.length>0?new Blob(be,{type:"audio/webm"}):new Blob([""],{type:"audio/webm"}),$e=Math.max(1,Math.floor(be.length*.1));console.log("創建音頻blob，大小:",Me.size,"估算錄音時長:",$e),ie({blob:Me,duration:$e}),N(!0),ae([]),se.current=[],console.log("設置送出對話框狀態"),oe.getTracks().forEach(Ze=>Ze.stop())},H.start(100),O(H),A(!0),R(!0);const J=setInterval(()=>{F(be=>{const Me=be+1;return Me>=60&&(M&&M.state==="recording"&&M.stop(),J&&(clearInterval(J),j(null)),A(!1),R(!1),alert("錄音時間已達1分鐘限制，已自動停止錄音")),Me})},1e3);j(J)}catch(oe){console.error("錄音錯誤:",oe),alert("無法啟動麥克風，請檢查權限設置")}},Ye=()=>{P(!1)},We=()=>{X&&(Se(X.blob,X.duration),ie(null),N(!1),ne("aiChat",1))},pe=()=>{ie(null),N(!1)},Se=(oe,H)=>{const J=URL.createObjectURL(oe),be=["今天完成了一個重要目標，感覺很有成就感。","學會了新的技能，為自己的成長感到驕傲。","克服了困難，證明了自己的能力。","幫助了別人，感受到付出的快樂。","建立了新的習慣，為未來打下基礎。"],Me=be[Math.floor(Math.random()*be.length)],$e=["achievement","growth","habit","help","goal"][Math.floor(Math.random()*5)],Ke=[{id:Date.now(),title:"語音里程碑",description:Me,date:new Date().toISOString(),type:$e,completed:!0,audioUrl:J,duration:H},...a];c(Ke),Le(Ke)},we=oe=>({start:"#2196F3",achievement:"#4CAF50",growth:"#9C27B0",habit:"#FF9800",help:"#E91E63",goal:"#F44336"})[oe]||"#9E9E9E",Re=oe=>new Date(oe).toLocaleString("zh-TW",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}),Ce=oe=>{if(oe.audioUrl){const H=new Audio(oe.audioUrl);H.onerror=J=>{console.error("音頻加載失敗:",J),U(oe.description)},H.play().then(()=>{console.log("正在播放原音...")}).catch(J=>{console.error("播放失敗:",J),U(oe.description)})}else U(oe.description)},U=oe=>{if("speechSynthesis"in window){const H=new SpeechSynthesisUtterance(oe);H.lang="zh-TW",H.rate=.9,H.pitch=1,window.speechSynthesis.cancel(),window.speechSynthesis.speak(H),console.log("正在播放里程碑內容（文字轉語音）...")}else alert("瀏覽器不支援語音播放功能")},V=a.filter(oe=>oe.completed).length,L=()=>{$(!1),ve(null)};return i.jsxs("div",{style:{minHeight:"100vh",background:"linear-gradient(135deg, #4CAF50 0%, #8BC34A 100%)",padding:"20px"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"30px"},children:[i.jsx("button",{onClick:()=>n("/home"),style:{background:"#fff",border:"1.5px solid #6B5BFF",borderRadius:"8px",padding:"6px 10px",color:"#6B5BFF",cursor:"pointer",fontSize:"16px",fontWeight:"600",transition:"all 0.3s ease"},children:"返回"}),i.jsx("h1",{style:{color:"white",fontSize:"24px",fontWeight:"bold",margin:0,marginBottom:"8px"},children:"我的里程碑"}),i.jsx("p",{style:{color:"rgba(255,255,255,0.8)",fontSize:"14px",fontWeight:400,margin:0,textAlign:"center",lineHeight:1.4},children:"記錄每個成長時刻，見證自我蛻變的旅程 ✨ 讓每個里程碑都成為你人生故事中的閃亮篇章"}),i.jsxs("div",{style:{display:"flex",gap:"10px"},children:[i.jsx("button",{onClick:()=>n("/logout"),style:{background:"#fff",border:"1.5px solid #6B5BFF",borderRadius:"8px",padding:"6px 10px",color:"#6B5BFF",cursor:"pointer",fontSize:"16px",fontWeight:"600",transition:"all 0.3s ease"},children:r.logout}),i.jsx(Mn,{})]})]}),i.jsxs("div",{style:{maxWidth:"800px",margin:"0 auto"},children:[i.jsxs("div",{style:{background:"rgba(255,255,255,0.95)",borderRadius:"20px",padding:"24px",marginBottom:"24px",boxShadow:"0 8px 32px rgba(0,0,0,0.1)"},children:[i.jsxs("div",{style:{textAlign:"center",marginBottom:"20px"},children:[i.jsxs("div",{style:{width:"70px",height:"70px",borderRadius:"50%",background:"white",display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto 12px",boxShadow:"0 4px 16px rgba(0,0,0,0.1)",overflow:"hidden"},children:[i.jsx("img",{src:K,alt:"用戶頭像",style:{width:"100%",height:"100%",objectFit:"cover",borderRadius:"50%"},onError:oe=>{const H=oe.currentTarget;H.style.display="none";const J=H.nextElementSibling;J&&(J.style.display="flex")}}),i.jsx("span",{style:{fontSize:"35px",color:"#4CAF50",display:"none",position:"absolute"},children:"👤"})]}),i.jsx("h2",{style:{color:"#333",fontSize:"22px",fontWeight:"bold",marginBottom:"6px"},children:"里程碑"}),i.jsxs("p",{style:{color:"#666",fontSize:"13px",marginBottom:"20px"},children:["開始於 ",d.startDate.toLocaleDateString("zh-TW")]})]}),i.jsxs("div",{style:{display:"flex",justifyContent:"space-around"},children:[i.jsxs("div",{style:{textAlign:"center"},children:[i.jsx("div",{style:{fontSize:"22px",fontWeight:"bold",color:"#4CAF50",marginBottom:"3px"},children:d.totalDays}),i.jsx("div",{style:{fontSize:"11px",color:"#666"},children:r.totalDays})]}),i.jsxs("div",{style:{textAlign:"center"},children:[i.jsx("div",{style:{fontSize:"22px",fontWeight:"bold",color:"#FF9800",marginBottom:"3px"},children:V}),i.jsx("div",{style:{fontSize:"11px",color:"#666"},children:r.achievements})]}),i.jsxs("div",{style:{textAlign:"center"},children:[i.jsx("div",{style:{fontSize:"22px",fontWeight:"bold",color:"#2196F3",marginBottom:"3px"},children:d.currentStreak}),i.jsxs("div",{style:{fontSize:"11px",color:"#666"},children:[r.currentStreak," ",r.days]})]})]})]}),i.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:"16px",marginBottom:"24px"},children:[i.jsxs("button",{onClick:()=>m(!0),style:{background:"linear-gradient(135deg, #2196F3 0%, #1976D2 100%)",border:"none",borderRadius:"16px",padding:"12px 24px",color:"white",cursor:"pointer",fontSize:"16px",fontWeight:"600",boxShadow:"0 4px 16px rgba(33, 150, 243, 0.3)",transition:"all 0.3s ease",display:"flex",alignItems:"center",gap:"8px"},onMouseOver:oe=>{oe.currentTarget.style.transform="translateY(-2px)",oe.currentTarget.style.boxShadow="0 6px 20px rgba(33, 150, 243, 0.4)"},onMouseOut:oe=>{oe.currentTarget.style.transform="translateY(0)",oe.currentTarget.style.boxShadow="0 4px 16px rgba(33, 150, 243, 0.3)"},children:[i.jsx("span",{style:{fontSize:"18px"},children:"+"}),r.addMilestone]}),i.jsxs("button",{onClick:De,style:{background:_?"linear-gradient(135deg, #f44336 0%, #d32f2f 100%)":"linear-gradient(135deg, #2196F3 0%, #1976D2 100%)",border:"none",borderRadius:"16px",padding:"12px 24px",color:"white",cursor:"pointer",fontSize:"16px",fontWeight:"600",boxShadow:_?"0 4px 16px rgba(244, 67, 54, 0.3)":"0 4px 16px rgba(33, 150, 243, 0.3)",transition:"all 0.3s ease",display:"flex",alignItems:"center",gap:"8px",animation:_?"pulse 1.5s infinite":"none"},onMouseOver:oe=>{_||(oe.currentTarget.style.transform="translateY(-2px)",oe.currentTarget.style.boxShadow="0 6px 20px rgba(33, 150, 243, 0.4)")},onMouseOut:oe=>{_||(oe.currentTarget.style.transform="translateY(0)",oe.currentTarget.style.boxShadow="0 4px 16px rgba(33, 150, 243, 0.3)")},children:[i.jsx("span",{style:{fontSize:"18px"},children:"🎤"}),_?`錄音中 ${Math.floor(D/60)}:${(D%60).toString().padStart(2,"0")}`:"語音輸入"]})]}),i.jsx("div",{style:{marginBottom:"30px"},children:a.length===0?i.jsx("div",{style:{background:"rgba(255,255,255,0.95)",borderRadius:"16px",padding:"40px",textAlign:"center",color:"#666"},children:r.noMilestones}):i.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:a.map((oe,H)=>i.jsx("div",{style:{background:"rgba(255,255,255,0.95)",borderRadius:"16px",padding:"20px",boxShadow:"0 4px 16px rgba(0,0,0,0.1)",position:"relative"},children:i.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:"16px"},children:[i.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",minWidth:"40px"},children:[i.jsx("div",{style:{width:"20px",height:"20px",borderRadius:"50%",background:oe.completed?we(oe.type):"#ddd",display:"flex",alignItems:"center",justifyContent:"center",marginBottom:"8px"},children:oe.completed&&i.jsx("span",{style:{color:"white",fontSize:"12px"},children:"✓"})}),H<a.length-1&&i.jsx("div",{style:{width:"2px",height:"40px",background:"#ddd"}})]}),i.jsxs("div",{style:{flex:1},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"8px"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[i.jsx("span",{style:{background:we(oe.type),color:"white",padding:"4px 8px",borderRadius:"12px",fontSize:"12px",fontWeight:"600"},children:r.milestoneTypes[oe.type]}),i.jsx("span",{style:{color:"#999",fontSize:"12px"},children:Re(oe.date)})]}),i.jsxs("div",{style:{display:"flex",gap:"8px"},children:[oe.title!=="語音里程碑"&&i.jsx("button",{onClick:()=>nt(oe),style:{background:"#4CAF50",border:"none",borderRadius:"6px",padding:"4px 8px",color:"white",cursor:"pointer",fontSize:"12px"},children:"✏️"}),i.jsx("button",{onClick:()=>ge(oe.id),style:{background:"#F44336",border:"none",borderRadius:"6px",padding:"4px 8px",color:"white",cursor:"pointer",fontSize:"12px"},children:"🗑️"})]})]}),i.jsx("h4",{style:{margin:"0 0 8px 0",fontSize:"16px",fontWeight:"600",color:oe.completed?"#333":"#666"},children:oe.title}),i.jsx("p",{style:{color:"#666",fontSize:"14px",lineHeight:"1.5",margin:0,marginBottom:"8px"},children:oe.description}),oe.audioUrl&&i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",marginTop:"8px"},children:[i.jsxs("button",{onClick:()=>Ce(oe),style:{background:"linear-gradient(135deg, #4CAF50 0%, #8BC34A 100%)",border:"none",borderRadius:"8px",padding:"6px 12px",color:"white",cursor:"pointer",fontSize:"12px",fontWeight:"600",display:"flex",alignItems:"center",gap:"4px"},children:[i.jsx("span",{style:{fontSize:"14px"},children:"▶️"}),"播放原音"]}),oe.duration&&i.jsxs("span",{style:{color:"#666",fontSize:"12px",background:"#f5f5f5",padding:"4px 8px",borderRadius:"6px"},children:["錄音時長: ",Math.floor(oe.duration/60),":",(oe.duration%60).toString().padStart(2,"0")]})]})]})]})},oe.id))})})]}),h&&i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:i.jsxs("div",{style:{background:"white",borderRadius:"16px",padding:"30px",width:"90%",maxWidth:"500px"},children:[i.jsx("h3",{style:{marginBottom:"20px",color:"#333"},children:r.addMilestone}),i.jsxs("div",{style:{marginBottom:"16px"},children:[i.jsx("label",{style:{display:"block",marginBottom:"8px",color:"#666"},children:"標題"}),i.jsx("input",{type:"text",value:S.title,onChange:oe=>I(H=>({...H,title:oe.target.value})),style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid #ddd",fontSize:"14px"},placeholder:"輸入里程碑標題"})]}),i.jsxs("div",{style:{marginBottom:"16px"},children:[i.jsx("label",{style:{display:"block",marginBottom:"8px",color:"#666"},children:"描述"}),i.jsx("textarea",{value:S.description,onChange:oe=>I(H=>({...H,description:oe.target.value})),style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid #ddd",fontSize:"14px",minHeight:"100px",resize:"vertical"},placeholder:"輸入里程碑描述"})]}),i.jsxs("div",{style:{marginBottom:"20px"},children:[i.jsx("label",{style:{display:"block",marginBottom:"8px",color:"#666"},children:"類型"}),i.jsxs("select",{value:S.type,onChange:oe=>I(H=>({...H,type:oe.target.value})),style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid #ddd",fontSize:"14px"},children:[i.jsx("option",{value:"start",children:r.milestoneTypes.start}),i.jsx("option",{value:"achievement",children:r.milestoneTypes.achievement}),i.jsx("option",{value:"growth",children:r.milestoneTypes.growth}),i.jsx("option",{value:"habit",children:r.milestoneTypes.habit}),i.jsx("option",{value:"help",children:r.milestoneTypes.help}),i.jsx("option",{value:"goal",children:r.milestoneTypes.goal})]})]}),i.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"flex-end"},children:[i.jsx("button",{onClick:()=>m(!1),style:{background:"#f5f5f5",border:"none",borderRadius:"8px",padding:"12px 24px",color:"#666",cursor:"pointer",fontSize:"14px"},children:r.cancel}),i.jsx("button",{onClick:Ne,style:{background:"linear-gradient(45deg, #4CAF50, #8BC34A)",border:"none",borderRadius:"8px",padding:"12px 24px",color:"white",cursor:"pointer",fontSize:"14px",fontWeight:"600"},children:r.save})]})]})}),G&&X&&i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:i.jsxs("div",{style:{background:"white",borderRadius:"16px",padding:"30px",width:"90%",maxWidth:"500px",textAlign:"center"},children:[i.jsx("h3",{style:{marginBottom:"20px",color:"#333"},children:"語音里程碑"}),i.jsxs("div",{style:{marginBottom:"20px"},children:[i.jsxs("p",{style:{color:"#666",marginBottom:"10px"},children:["錄音時長: ",Math.floor(X.duration/60),":",(X.duration%60).toString().padStart(2,"0")]}),i.jsx("audio",{controls:!0,style:{width:"100%",marginBottom:"20px"},src:URL.createObjectURL(X.blob)})]}),i.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"center"},children:[i.jsx("button",{onClick:pe,style:{background:"#f5f5f5",border:"none",borderRadius:"8px",padding:"12px 24px",color:"#666",cursor:"pointer",fontSize:"14px",fontWeight:"600"},children:"取消"}),i.jsx("button",{onClick:We,style:{background:"linear-gradient(45deg, #4CAF50, #8BC34A)",border:"none",borderRadius:"8px",padding:"12px 24px",color:"white",cursor:"pointer",fontSize:"14px",fontWeight:"600"},children:"送出"})]})]})}),E&&i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:i.jsxs("div",{style:{background:"white",borderRadius:"16px",padding:"30px",width:"90%",maxWidth:"500px",textAlign:"center"},children:[i.jsx("div",{style:{fontSize:"48px",marginBottom:"20px"},children:"🎤"}),i.jsx("h3",{style:{marginBottom:"16px",color:"#333",fontSize:"20px",fontWeight:"600"},children:"準備開始錄音"}),i.jsxs("p",{style:{marginBottom:"20px",color:"#666",fontSize:"16px",lineHeight:"1.5"},children:["點擊「開始錄音」後，系統將開始錄製您的語音里程碑。",i.jsx("br",{}),i.jsx("strong",{style:{color:"#ff6b6b"},children:"⚠️ 錄音時間限制為1分鐘"})]}),i.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"center"},children:[i.jsx("button",{onClick:Ye,style:{background:"#f5f5f5",border:"none",borderRadius:"8px",padding:"12px 24px",color:"#666",cursor:"pointer",fontSize:"14px",fontWeight:"500"},children:"取消"}),i.jsx("button",{onClick:tt,style:{background:"linear-gradient(45deg, #4CAF50, #8BC34A)",border:"none",borderRadius:"8px",padding:"12px 24px",color:"white",cursor:"pointer",fontSize:"14px",fontWeight:"600",boxShadow:"0 4px 12px rgba(76, 175, 80, 0.3)"},children:"開始錄音"})]})]})}),g&&i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:i.jsxs("div",{style:{background:"white",borderRadius:"16px",padding:"30px",width:"90%",maxWidth:"500px"},children:[i.jsx("h3",{style:{marginBottom:"20px",color:"#333"},children:r.editMilestone}),i.jsxs("div",{style:{marginBottom:"16px"},children:[i.jsx("label",{style:{display:"block",marginBottom:"8px",color:"#666"},children:"標題"}),i.jsx("input",{type:"text",value:S.title,onChange:oe=>I(H=>({...H,title:oe.target.value})),style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid #ddd",fontSize:"14px"}})]}),i.jsxs("div",{style:{marginBottom:"16px"},children:[i.jsx("label",{style:{display:"block",marginBottom:"8px",color:"#666"},children:"描述"}),i.jsx("textarea",{value:S.description,onChange:oe=>I(H=>({...H,description:oe.target.value})),style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid #ddd",fontSize:"14px",minHeight:"100px",resize:"vertical"}})]}),i.jsxs("div",{style:{marginBottom:"20px"},children:[i.jsx("label",{style:{display:"block",marginBottom:"8px",color:"#666"},children:"類型"}),i.jsxs("select",{value:S.type,onChange:oe=>I(H=>({...H,type:oe.target.value})),style:{width:"100%",padding:"12px",borderRadius:"8px",border:"1px solid #ddd",fontSize:"14px"},children:[i.jsx("option",{value:"start",children:r.milestoneTypes.start}),i.jsx("option",{value:"achievement",children:r.milestoneTypes.achievement}),i.jsx("option",{value:"growth",children:r.milestoneTypes.growth}),i.jsx("option",{value:"habit",children:r.milestoneTypes.habit}),i.jsx("option",{value:"help",children:r.milestoneTypes.help}),i.jsx("option",{value:"goal",children:r.milestoneTypes.goal})]})]}),i.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"flex-end"},children:[i.jsx("button",{onClick:()=>x(null),style:{background:"#f5f5f5",border:"none",borderRadius:"8px",padding:"12px 24px",color:"#666",cursor:"pointer",fontSize:"14px"},children:r.cancel}),i.jsx("button",{onClick:Je,style:{background:"linear-gradient(45deg, #4CAF50, #8BC34A)",border:"none",borderRadius:"8px",padding:"12px 24px",color:"white",cursor:"pointer",fontSize:"14px",fontWeight:"600"},children:r.save})]})]})}),W&&_e&&i.jsx(Mo,{isOpen:W,onClose:L,currentPlan:_e.currentPlan,remainingDays:_e.remainingDays,usedTokens:_e.usedTokens,totalTokens:_e.totalTokens}),ee&&i.jsx(qj,{isOpen:ee,onClose:()=>he(!1),featureName:"語音錄製功能"}),i.jsxs("footer",{style:{width:"100%",textAlign:"center",fontSize:14,color:"#888",marginTop:40,padding:"16px 0",background:"rgba(255,255,255,0.92)",borderTop:"1px solid #eee",boxShadow:"0 -2px 8px #0001"},children:[i.jsxs("div",{style:{width:"100%",maxWidth:800,margin:"0 auto",display:"flex",justifyContent:"space-between",alignItems:"center",gap:40,flexWrap:"wrap",padding:"0 20px"},children:[i.jsx("a",{href:"/privacy-policy",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px"},children:"隱私權政策"}),i.jsx("a",{href:"/terms",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px"},children:"條款/聲明"}),i.jsx("a",{href:"/data-deletion",style:{color:"#6B5BFF",textDecoration:"underline",padding:"4px 8px"},children:"資料刪除說明"}),i.jsx("a",{href:"/about",style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px"},children:"🧬 Restarter™｜我們是誰"}),i.jsx("a",{href:"/feedback",style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,padding:"4px 8px"},children:"💬 意見箱｜我們想聽你說"})]}),i.jsx("style",{children:`
          @media (max-width: 768px) {
            footer {
              padding: 8px 16px 40px 16px !important;
              marginTop: 20px !important;
            }
            footer > div {
              gap: 16px !important;
              justify-content: space-around !important;
            }
            footer > div > a {
              padding: 4px 6px !important;
              fontSize: 12px !important;
            }
          }
          @media (min-width: 700px) {
            footer {
              padding: 16px !important;
            }
            footer > div {
              flex-direction: row !important;
              gap: 40px !important;
              justify-content: space-between !important;
            }
            footer > div > a {
              padding: 4px 8px !important;
            }
          }
        `})]})]})}const Az={male:"/avatars/male.png",female:"/avatars/female.png"};function Pz({avatar:n,videoUrl:e,audioUrl:t,isSpeaking:r,onAvatarChange:s,size:a=160}){const c=w.useRef(null),[d,h]=w.useState(!1),m=()=>{c.current&&(c.current.currentTime=0,c.current.play(),h(!0))},g=()=>h(!1),x=()=>n==="male"||n==="female"?Az[n]:n;return i.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",marginBottom:24},children:[i.jsxs("div",{style:{position:"relative",width:a,height:a,marginBottom:8},children:[e?i.jsx("video",{src:e,width:a,height:a,autoPlay:!0,muted:!0,loop:!0,style:{borderRadius:"50%",objectFit:"cover"}}):i.jsx("img",{src:x(),width:a,height:a,style:{borderRadius:"50%",objectFit:"cover",filter:r?"brightness(1.1)":"none"},alt:"avatar"}),s&&(n==="male"||n==="female")&&i.jsx("button",{onClick:()=>s(n==="male"?"female":"male"),style:{position:"absolute",right:8,bottom:8,background:"#fff",borderRadius:"50%",border:"none",width:36,height:36,cursor:"pointer",fontSize:18},children:"切換"})]}),t&&i.jsx("audio",{ref:c,src:t,onEnded:g}),t&&i.jsx("button",{onClick:m,style:{padding:"6px 18px",borderRadius:8,background:"#6c63ff",color:"#fff",border:"none",fontWeight:700,fontSize:16,marginTop:8},disabled:d,children:d?"播放中...":"播放語音"})]})}function Hj(n,e){return function(){return n.apply(e,arguments)}}const{toString:Bz}=Object.prototype,{getPrototypeOf:N0}=Object,{iterator:Kf,toStringTag:$j}=Symbol,Qf=(n=>e=>{const t=Bz.call(e);return n[t]||(n[t]=t.slice(8,-1).toLowerCase())})(Object.create(null)),gi=n=>(n=n.toLowerCase(),e=>Qf(e)===n),Yf=n=>e=>typeof e===n,{isArray:Nc}=Array,ld=Yf("undefined");function Fz(n){return n!==null&&!ld(n)&&n.constructor!==null&&!ld(n.constructor)&&_r(n.constructor.isBuffer)&&n.constructor.isBuffer(n)}const Gj=gi("ArrayBuffer");function Nz(n){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(n):e=n&&n.buffer&&Gj(n.buffer),e}const zz=Yf("string"),_r=Yf("function"),Kj=Yf("number"),Xf=n=>n!==null&&typeof n=="object",Dz=n=>n===!0||n===!1,Ip=n=>{if(Qf(n)!=="object")return!1;const e=N0(n);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!($j in n)&&!(Kf in n)},Mz=gi("Date"),Lz=gi("File"),Oz=gi("Blob"),Vz=gi("FileList"),Wz=n=>Xf(n)&&_r(n.pipe),Uz=n=>{let e;return n&&(typeof FormData=="function"&&n instanceof FormData||_r(n.append)&&((e=Qf(n))==="formdata"||e==="object"&&_r(n.toString)&&n.toString()==="[object FormData]"))},qz=gi("URLSearchParams"),[Hz,$z,Gz,Kz]=["ReadableStream","Request","Response","Headers"].map(gi),Qz=n=>n.trim?n.trim():n.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Fd(n,e,{allOwnKeys:t=!1}={}){if(n===null||typeof n>"u")return;let r,s;if(typeof n!="object"&&(n=[n]),Nc(n))for(r=0,s=n.length;r<s;r++)e.call(null,n[r],r,n);else{const a=t?Object.getOwnPropertyNames(n):Object.keys(n),c=a.length;let d;for(r=0;r<c;r++)d=a[r],e.call(null,n[d],d,n)}}function Qj(n,e){e=e.toLowerCase();const t=Object.keys(n);let r=t.length,s;for(;r-- >0;)if(s=t[r],e===s.toLowerCase())return s;return null}const xa=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,Yj=n=>!ld(n)&&n!==xa;function Ky(){const{caseless:n}=Yj(this)&&this||{},e={},t=(r,s)=>{const a=n&&Qj(e,s)||s;Ip(e[a])&&Ip(r)?e[a]=Ky(e[a],r):Ip(r)?e[a]=Ky({},r):Nc(r)?e[a]=r.slice():e[a]=r};for(let r=0,s=arguments.length;r<s;r++)arguments[r]&&Fd(arguments[r],t);return e}const Yz=(n,e,t,{allOwnKeys:r}={})=>(Fd(e,(s,a)=>{t&&_r(s)?n[a]=Hj(s,t):n[a]=s},{allOwnKeys:r}),n),Xz=n=>(n.charCodeAt(0)===65279&&(n=n.slice(1)),n),Jz=(n,e,t,r)=>{n.prototype=Object.create(e.prototype,r),n.prototype.constructor=n,Object.defineProperty(n,"super",{value:e.prototype}),t&&Object.assign(n.prototype,t)},Zz=(n,e,t,r)=>{let s,a,c;const d={};if(e=e||{},n==null)return e;do{for(s=Object.getOwnPropertyNames(n),a=s.length;a-- >0;)c=s[a],(!r||r(c,n,e))&&!d[c]&&(e[c]=n[c],d[c]=!0);n=t!==!1&&N0(n)}while(n&&(!t||t(n,e))&&n!==Object.prototype);return e},e8=(n,e,t)=>{n=String(n),(t===void 0||t>n.length)&&(t=n.length),t-=e.length;const r=n.indexOf(e,t);return r!==-1&&r===t},t8=n=>{if(!n)return null;if(Nc(n))return n;let e=n.length;if(!Kj(e))return null;const t=new Array(e);for(;e-- >0;)t[e]=n[e];return t},n8=(n=>e=>n&&e instanceof n)(typeof Uint8Array<"u"&&N0(Uint8Array)),r8=(n,e)=>{const r=(n&&n[Kf]).call(n);let s;for(;(s=r.next())&&!s.done;){const a=s.value;e.call(n,a[0],a[1])}},i8=(n,e)=>{let t;const r=[];for(;(t=n.exec(e))!==null;)r.push(t);return r},s8=gi("HTMLFormElement"),o8=n=>n.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(t,r,s){return r.toUpperCase()+s}),kS=(({hasOwnProperty:n})=>(e,t)=>n.call(e,t))(Object.prototype),a8=gi("RegExp"),Xj=(n,e)=>{const t=Object.getOwnPropertyDescriptors(n),r={};Fd(t,(s,a)=>{let c;(c=e(s,a,n))!==!1&&(r[a]=c||s)}),Object.defineProperties(n,r)},l8=n=>{Xj(n,(e,t)=>{if(_r(n)&&["arguments","caller","callee"].indexOf(t)!==-1)return!1;const r=n[t];if(_r(r)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+t+"'")})}})},c8=(n,e)=>{const t={},r=s=>{s.forEach(a=>{t[a]=!0})};return Nc(n)?r(n):r(String(n).split(e)),t},u8=()=>{},d8=(n,e)=>n!=null&&Number.isFinite(n=+n)?n:e;function h8(n){return!!(n&&_r(n.append)&&n[$j]==="FormData"&&n[Kf])}const p8=n=>{const e=new Array(10),t=(r,s)=>{if(Xf(r)){if(e.indexOf(r)>=0)return;if(!("toJSON"in r)){e[s]=r;const a=Nc(r)?[]:{};return Fd(r,(c,d)=>{const h=t(c,s+1);!ld(h)&&(a[d]=h)}),e[s]=void 0,a}}return r};return t(n,0)},f8=gi("AsyncFunction"),m8=n=>n&&(Xf(n)||_r(n))&&_r(n.then)&&_r(n.catch),Jj=((n,e)=>n?setImmediate:e?((t,r)=>(xa.addEventListener("message",({source:s,data:a})=>{s===xa&&a===t&&r.length&&r.shift()()},!1),s=>{r.push(s),xa.postMessage(t,"*")}))(`axios@${Math.random()}`,[]):t=>setTimeout(t))(typeof setImmediate=="function",_r(xa.postMessage)),g8=typeof queueMicrotask<"u"?queueMicrotask.bind(xa):typeof process<"u"&&process.nextTick||Jj,y8=n=>n!=null&&_r(n[Kf]),xe={isArray:Nc,isArrayBuffer:Gj,isBuffer:Fz,isFormData:Uz,isArrayBufferView:Nz,isString:zz,isNumber:Kj,isBoolean:Dz,isObject:Xf,isPlainObject:Ip,isReadableStream:Hz,isRequest:$z,isResponse:Gz,isHeaders:Kz,isUndefined:ld,isDate:Mz,isFile:Lz,isBlob:Oz,isRegExp:a8,isFunction:_r,isStream:Wz,isURLSearchParams:qz,isTypedArray:n8,isFileList:Vz,forEach:Fd,merge:Ky,extend:Yz,trim:Qz,stripBOM:Xz,inherits:Jz,toFlatObject:Zz,kindOf:Qf,kindOfTest:gi,endsWith:e8,toArray:t8,forEachEntry:r8,matchAll:i8,isHTMLForm:s8,hasOwnProperty:kS,hasOwnProp:kS,reduceDescriptors:Xj,freezeMethods:l8,toObjectSet:c8,toCamelCase:o8,noop:u8,toFiniteNumber:d8,findKey:Qj,global:xa,isContextDefined:Yj,isSpecCompliantForm:h8,toJSONObject:p8,isAsyncFn:f8,isThenable:m8,setImmediate:Jj,asap:g8,isIterable:y8};function ut(n,e,t,r,s){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=n,this.name="AxiosError",e&&(this.code=e),t&&(this.config=t),r&&(this.request=r),s&&(this.response=s,this.status=s.status?s.status:null)}xe.inherits(ut,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:xe.toJSONObject(this.config),code:this.code,status:this.status}}});const Zj=ut.prototype,eI={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(n=>{eI[n]={value:n}});Object.defineProperties(ut,eI);Object.defineProperty(Zj,"isAxiosError",{value:!0});ut.from=(n,e,t,r,s,a)=>{const c=Object.create(Zj);return xe.toFlatObject(n,c,function(h){return h!==Error.prototype},d=>d!=="isAxiosError"),ut.call(c,n.message,e,t,r,s),c.cause=n,c.name=n.name,a&&Object.assign(c,a),c};const x8=null;function Qy(n){return xe.isPlainObject(n)||xe.isArray(n)}function tI(n){return xe.endsWith(n,"[]")?n.slice(0,-2):n}function TS(n,e,t){return n?n.concat(e).map(function(s,a){return s=tI(s),!t&&a?"["+s+"]":s}).join(t?".":""):e}function b8(n){return xe.isArray(n)&&!n.some(Qy)}const v8=xe.toFlatObject(xe,{},null,function(e){return/^is[A-Z]/.test(e)});function Jf(n,e,t){if(!xe.isObject(n))throw new TypeError("target must be an object");e=e||new FormData,t=xe.toFlatObject(t,{metaTokens:!0,dots:!1,indexes:!1},!1,function(R,T){return!xe.isUndefined(T[R])});const r=t.metaTokens,s=t.visitor||g,a=t.dots,c=t.indexes,h=(t.Blob||typeof Blob<"u"&&Blob)&&xe.isSpecCompliantForm(e);if(!xe.isFunction(s))throw new TypeError("visitor must be a function");function m(_){if(_===null)return"";if(xe.isDate(_))return _.toISOString();if(xe.isBoolean(_))return _.toString();if(!h&&xe.isBlob(_))throw new ut("Blob is not supported. Use a Buffer instead.");return xe.isArrayBuffer(_)||xe.isTypedArray(_)?h&&typeof Blob=="function"?new Blob([_]):Buffer.from(_):_}function g(_,R,T){let A=_;if(_&&!T&&typeof _=="object"){if(xe.endsWith(R,"{}"))R=r?R:R.slice(0,-2),_=JSON.stringify(_);else if(xe.isArray(_)&&b8(_)||(xe.isFileList(_)||xe.endsWith(R,"[]"))&&(A=xe.toArray(_)))return R=tI(R),A.forEach(function(F,X){!(xe.isUndefined(F)||F===null)&&e.append(c===!0?TS([R],X,a):c===null?R:R+"[]",m(F))}),!1}return Qy(_)?!0:(e.append(TS(T,R,a),m(_)),!1)}const x=[],S=Object.assign(v8,{defaultVisitor:g,convertValue:m,isVisitable:Qy});function I(_,R){if(!xe.isUndefined(_)){if(x.indexOf(_)!==-1)throw Error("Circular reference detected in "+R.join("."));x.push(_),xe.forEach(_,function(A,D){(!(xe.isUndefined(A)||A===null)&&s.call(e,A,xe.isString(D)?D.trim():D,R,S))===!0&&I(A,R?R.concat(D):[D])}),x.pop()}}if(!xe.isObject(n))throw new TypeError("data must be an object");return I(n),e}function _S(n){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(n).replace(/[!'()~]|%20|%00/g,function(r){return e[r]})}function z0(n,e){this._pairs=[],n&&Jf(n,this,e)}const nI=z0.prototype;nI.append=function(e,t){this._pairs.push([e,t])};nI.toString=function(e){const t=e?function(r){return e.call(this,r,_S)}:_S;return this._pairs.map(function(s){return t(s[0])+"="+t(s[1])},"").join("&")};function w8(n){return encodeURIComponent(n).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function rI(n,e,t){if(!e)return n;const r=t&&t.encode||w8;xe.isFunction(t)&&(t={serialize:t});const s=t&&t.serialize;let a;if(s?a=s(e,t):a=xe.isURLSearchParams(e)?e.toString():new z0(e,t).toString(r),a){const c=n.indexOf("#");c!==-1&&(n=n.slice(0,c)),n+=(n.indexOf("?")===-1?"?":"&")+a}return n}class jS{constructor(){this.handlers=[]}use(e,t,r){return this.handlers.push({fulfilled:e,rejected:t,synchronous:r?r.synchronous:!1,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){xe.forEach(this.handlers,function(r){r!==null&&e(r)})}}const iI={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},S8=typeof URLSearchParams<"u"?URLSearchParams:z0,k8=typeof FormData<"u"?FormData:null,T8=typeof Blob<"u"?Blob:null,_8={isBrowser:!0,classes:{URLSearchParams:S8,FormData:k8,Blob:T8},protocols:["http","https","file","blob","url","data"]},D0=typeof window<"u"&&typeof document<"u",Yy=typeof navigator=="object"&&navigator||void 0,j8=D0&&(!Yy||["ReactNative","NativeScript","NS"].indexOf(Yy.product)<0),I8=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",E8=D0&&window.location.href||"http://localhost",C8=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:D0,hasStandardBrowserEnv:j8,hasStandardBrowserWebWorkerEnv:I8,navigator:Yy,origin:E8},Symbol.toStringTag,{value:"Module"})),er={...C8,..._8};function R8(n,e){return Jf(n,new er.classes.URLSearchParams,Object.assign({visitor:function(t,r,s,a){return er.isNode&&xe.isBuffer(t)?(this.append(r,t.toString("base64")),!1):a.defaultVisitor.apply(this,arguments)}},e))}function A8(n){return xe.matchAll(/\w+|\[(\w*)]/g,n).map(e=>e[0]==="[]"?"":e[1]||e[0])}function P8(n){const e={},t=Object.keys(n);let r;const s=t.length;let a;for(r=0;r<s;r++)a=t[r],e[a]=n[a];return e}function sI(n){function e(t,r,s,a){let c=t[a++];if(c==="__proto__")return!0;const d=Number.isFinite(+c),h=a>=t.length;return c=!c&&xe.isArray(s)?s.length:c,h?(xe.hasOwnProp(s,c)?s[c]=[s[c],r]:s[c]=r,!d):((!s[c]||!xe.isObject(s[c]))&&(s[c]=[]),e(t,r,s[c],a)&&xe.isArray(s[c])&&(s[c]=P8(s[c])),!d)}if(xe.isFormData(n)&&xe.isFunction(n.entries)){const t={};return xe.forEachEntry(n,(r,s)=>{e(A8(r),s,t,0)}),t}return null}function B8(n,e,t){if(xe.isString(n))try{return(e||JSON.parse)(n),xe.trim(n)}catch(r){if(r.name!=="SyntaxError")throw r}return(t||JSON.stringify)(n)}const Nd={transitional:iI,adapter:["xhr","http","fetch"],transformRequest:[function(e,t){const r=t.getContentType()||"",s=r.indexOf("application/json")>-1,a=xe.isObject(e);if(a&&xe.isHTMLForm(e)&&(e=new FormData(e)),xe.isFormData(e))return s?JSON.stringify(sI(e)):e;if(xe.isArrayBuffer(e)||xe.isBuffer(e)||xe.isStream(e)||xe.isFile(e)||xe.isBlob(e)||xe.isReadableStream(e))return e;if(xe.isArrayBufferView(e))return e.buffer;if(xe.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let d;if(a){if(r.indexOf("application/x-www-form-urlencoded")>-1)return R8(e,this.formSerializer).toString();if((d=xe.isFileList(e))||r.indexOf("multipart/form-data")>-1){const h=this.env&&this.env.FormData;return Jf(d?{"files[]":e}:e,h&&new h,this.formSerializer)}}return a||s?(t.setContentType("application/json",!1),B8(e)):e}],transformResponse:[function(e){const t=this.transitional||Nd.transitional,r=t&&t.forcedJSONParsing,s=this.responseType==="json";if(xe.isResponse(e)||xe.isReadableStream(e))return e;if(e&&xe.isString(e)&&(r&&!this.responseType||s)){const c=!(t&&t.silentJSONParsing)&&s;try{return JSON.parse(e)}catch(d){if(c)throw d.name==="SyntaxError"?ut.from(d,ut.ERR_BAD_RESPONSE,this,null,this.response):d}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:er.classes.FormData,Blob:er.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};xe.forEach(["delete","get","head","post","put","patch"],n=>{Nd.headers[n]={}});const F8=xe.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),N8=n=>{const e={};let t,r,s;return n&&n.split(`
`).forEach(function(c){s=c.indexOf(":"),t=c.substring(0,s).trim().toLowerCase(),r=c.substring(s+1).trim(),!(!t||e[t]&&F8[t])&&(t==="set-cookie"?e[t]?e[t].push(r):e[t]=[r]:e[t]=e[t]?e[t]+", "+r:r)}),e},IS=Symbol("internals");function _u(n){return n&&String(n).trim().toLowerCase()}function Ep(n){return n===!1||n==null?n:xe.isArray(n)?n.map(Ep):String(n)}function z8(n){const e=Object.create(null),t=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=t.exec(n);)e[r[1]]=r[2];return e}const D8=n=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(n.trim());function Xg(n,e,t,r,s){if(xe.isFunction(r))return r.call(this,e,t);if(s&&(e=t),!!xe.isString(e)){if(xe.isString(r))return e.indexOf(r)!==-1;if(xe.isRegExp(r))return r.test(e)}}function M8(n){return n.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,t,r)=>t.toUpperCase()+r)}function L8(n,e){const t=xe.toCamelCase(" "+e);["get","set","has"].forEach(r=>{Object.defineProperty(n,r+t,{value:function(s,a,c){return this[r].call(this,e,s,a,c)},configurable:!0})})}let jr=class{constructor(e){e&&this.set(e)}set(e,t,r){const s=this;function a(d,h,m){const g=_u(h);if(!g)throw new Error("header name must be a non-empty string");const x=xe.findKey(s,g);(!x||s[x]===void 0||m===!0||m===void 0&&s[x]!==!1)&&(s[x||h]=Ep(d))}const c=(d,h)=>xe.forEach(d,(m,g)=>a(m,g,h));if(xe.isPlainObject(e)||e instanceof this.constructor)c(e,t);else if(xe.isString(e)&&(e=e.trim())&&!D8(e))c(N8(e),t);else if(xe.isObject(e)&&xe.isIterable(e)){let d={},h,m;for(const g of e){if(!xe.isArray(g))throw TypeError("Object iterator must return a key-value pair");d[m=g[0]]=(h=d[m])?xe.isArray(h)?[...h,g[1]]:[h,g[1]]:g[1]}c(d,t)}else e!=null&&a(t,e,r);return this}get(e,t){if(e=_u(e),e){const r=xe.findKey(this,e);if(r){const s=this[r];if(!t)return s;if(t===!0)return z8(s);if(xe.isFunction(t))return t.call(this,s,r);if(xe.isRegExp(t))return t.exec(s);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,t){if(e=_u(e),e){const r=xe.findKey(this,e);return!!(r&&this[r]!==void 0&&(!t||Xg(this,this[r],r,t)))}return!1}delete(e,t){const r=this;let s=!1;function a(c){if(c=_u(c),c){const d=xe.findKey(r,c);d&&(!t||Xg(r,r[d],d,t))&&(delete r[d],s=!0)}}return xe.isArray(e)?e.forEach(a):a(e),s}clear(e){const t=Object.keys(this);let r=t.length,s=!1;for(;r--;){const a=t[r];(!e||Xg(this,this[a],a,e,!0))&&(delete this[a],s=!0)}return s}normalize(e){const t=this,r={};return xe.forEach(this,(s,a)=>{const c=xe.findKey(r,a);if(c){t[c]=Ep(s),delete t[a];return}const d=e?M8(a):String(a).trim();d!==a&&delete t[a],t[d]=Ep(s),r[d]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const t=Object.create(null);return xe.forEach(this,(r,s)=>{r!=null&&r!==!1&&(t[s]=e&&xe.isArray(r)?r.join(", "):r)}),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,t])=>e+": "+t).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...t){const r=new this(e);return t.forEach(s=>r.set(s)),r}static accessor(e){const r=(this[IS]=this[IS]={accessors:{}}).accessors,s=this.prototype;function a(c){const d=_u(c);r[d]||(L8(s,c),r[d]=!0)}return xe.isArray(e)?e.forEach(a):a(e),this}};jr.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);xe.reduceDescriptors(jr.prototype,({value:n},e)=>{let t=e[0].toUpperCase()+e.slice(1);return{get:()=>n,set(r){this[t]=r}}});xe.freezeMethods(jr);function Jg(n,e){const t=this||Nd,r=e||t,s=jr.from(r.headers);let a=r.data;return xe.forEach(n,function(d){a=d.call(t,a,s.normalize(),e?e.status:void 0)}),s.normalize(),a}function oI(n){return!!(n&&n.__CANCEL__)}function zc(n,e,t){ut.call(this,n??"canceled",ut.ERR_CANCELED,e,t),this.name="CanceledError"}xe.inherits(zc,ut,{__CANCEL__:!0});function aI(n,e,t){const r=t.config.validateStatus;!t.status||!r||r(t.status)?n(t):e(new ut("Request failed with status code "+t.status,[ut.ERR_BAD_REQUEST,ut.ERR_BAD_RESPONSE][Math.floor(t.status/100)-4],t.config,t.request,t))}function O8(n){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(n);return e&&e[1]||""}function V8(n,e){n=n||10;const t=new Array(n),r=new Array(n);let s=0,a=0,c;return e=e!==void 0?e:1e3,function(h){const m=Date.now(),g=r[a];c||(c=m),t[s]=h,r[s]=m;let x=a,S=0;for(;x!==s;)S+=t[x++],x=x%n;if(s=(s+1)%n,s===a&&(a=(a+1)%n),m-c<e)return;const I=g&&m-g;return I?Math.round(S*1e3/I):void 0}}function W8(n,e){let t=0,r=1e3/e,s,a;const c=(m,g=Date.now())=>{t=g,s=null,a&&(clearTimeout(a),a=null),n.apply(null,m)};return[(...m)=>{const g=Date.now(),x=g-t;x>=r?c(m,g):(s=m,a||(a=setTimeout(()=>{a=null,c(s)},r-x)))},()=>s&&c(s)]}const lf=(n,e,t=3)=>{let r=0;const s=V8(50,250);return W8(a=>{const c=a.loaded,d=a.lengthComputable?a.total:void 0,h=c-r,m=s(h),g=c<=d;r=c;const x={loaded:c,total:d,progress:d?c/d:void 0,bytes:h,rate:m||void 0,estimated:m&&d&&g?(d-c)/m:void 0,event:a,lengthComputable:d!=null,[e?"download":"upload"]:!0};n(x)},t)},ES=(n,e)=>{const t=n!=null;return[r=>e[0]({lengthComputable:t,total:n,loaded:r}),e[1]]},CS=n=>(...e)=>xe.asap(()=>n(...e)),U8=er.hasStandardBrowserEnv?((n,e)=>t=>(t=new URL(t,er.origin),n.protocol===t.protocol&&n.host===t.host&&(e||n.port===t.port)))(new URL(er.origin),er.navigator&&/(msie|trident)/i.test(er.navigator.userAgent)):()=>!0,q8=er.hasStandardBrowserEnv?{write(n,e,t,r,s,a){const c=[n+"="+encodeURIComponent(e)];xe.isNumber(t)&&c.push("expires="+new Date(t).toGMTString()),xe.isString(r)&&c.push("path="+r),xe.isString(s)&&c.push("domain="+s),a===!0&&c.push("secure"),document.cookie=c.join("; ")},read(n){const e=document.cookie.match(new RegExp("(^|;\\s*)("+n+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove(n){this.write(n,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function H8(n){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(n)}function $8(n,e){return e?n.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):n}function lI(n,e,t){let r=!H8(e);return n&&(r||t==!1)?$8(n,e):e}const RS=n=>n instanceof jr?{...n}:n;function Ma(n,e){e=e||{};const t={};function r(m,g,x,S){return xe.isPlainObject(m)&&xe.isPlainObject(g)?xe.merge.call({caseless:S},m,g):xe.isPlainObject(g)?xe.merge({},g):xe.isArray(g)?g.slice():g}function s(m,g,x,S){if(xe.isUndefined(g)){if(!xe.isUndefined(m))return r(void 0,m,x,S)}else return r(m,g,x,S)}function a(m,g){if(!xe.isUndefined(g))return r(void 0,g)}function c(m,g){if(xe.isUndefined(g)){if(!xe.isUndefined(m))return r(void 0,m)}else return r(void 0,g)}function d(m,g,x){if(x in e)return r(m,g);if(x in n)return r(void 0,m)}const h={url:a,method:a,data:a,baseURL:c,transformRequest:c,transformResponse:c,paramsSerializer:c,timeout:c,timeoutMessage:c,withCredentials:c,withXSRFToken:c,adapter:c,responseType:c,xsrfCookieName:c,xsrfHeaderName:c,onUploadProgress:c,onDownloadProgress:c,decompress:c,maxContentLength:c,maxBodyLength:c,beforeRedirect:c,transport:c,httpAgent:c,httpsAgent:c,cancelToken:c,socketPath:c,responseEncoding:c,validateStatus:d,headers:(m,g,x)=>s(RS(m),RS(g),x,!0)};return xe.forEach(Object.keys(Object.assign({},n,e)),function(g){const x=h[g]||s,S=x(n[g],e[g],g);xe.isUndefined(S)&&x!==d||(t[g]=S)}),t}const cI=n=>{const e=Ma({},n);let{data:t,withXSRFToken:r,xsrfHeaderName:s,xsrfCookieName:a,headers:c,auth:d}=e;e.headers=c=jr.from(c),e.url=rI(lI(e.baseURL,e.url,e.allowAbsoluteUrls),n.params,n.paramsSerializer),d&&c.set("Authorization","Basic "+btoa((d.username||"")+":"+(d.password?unescape(encodeURIComponent(d.password)):"")));let h;if(xe.isFormData(t)){if(er.hasStandardBrowserEnv||er.hasStandardBrowserWebWorkerEnv)c.setContentType(void 0);else if((h=c.getContentType())!==!1){const[m,...g]=h?h.split(";").map(x=>x.trim()).filter(Boolean):[];c.setContentType([m||"multipart/form-data",...g].join("; "))}}if(er.hasStandardBrowserEnv&&(r&&xe.isFunction(r)&&(r=r(e)),r||r!==!1&&U8(e.url))){const m=s&&a&&q8.read(a);m&&c.set(s,m)}return e},G8=typeof XMLHttpRequest<"u",K8=G8&&function(n){return new Promise(function(t,r){const s=cI(n);let a=s.data;const c=jr.from(s.headers).normalize();let{responseType:d,onUploadProgress:h,onDownloadProgress:m}=s,g,x,S,I,_;function R(){I&&I(),_&&_(),s.cancelToken&&s.cancelToken.unsubscribe(g),s.signal&&s.signal.removeEventListener("abort",g)}let T=new XMLHttpRequest;T.open(s.method.toUpperCase(),s.url,!0),T.timeout=s.timeout;function A(){if(!T)return;const F=jr.from("getAllResponseHeaders"in T&&T.getAllResponseHeaders()),ie={data:!d||d==="text"||d==="json"?T.responseText:T.response,status:T.status,statusText:T.statusText,headers:F,config:n,request:T};aI(function(N){t(N),R()},function(N){r(N),R()},ie),T=null}"onloadend"in T?T.onloadend=A:T.onreadystatechange=function(){!T||T.readyState!==4||T.status===0&&!(T.responseURL&&T.responseURL.indexOf("file:")===0)||setTimeout(A)},T.onabort=function(){T&&(r(new ut("Request aborted",ut.ECONNABORTED,n,T)),T=null)},T.onerror=function(){r(new ut("Network Error",ut.ERR_NETWORK,n,T)),T=null},T.ontimeout=function(){let X=s.timeout?"timeout of "+s.timeout+"ms exceeded":"timeout exceeded";const ie=s.transitional||iI;s.timeoutErrorMessage&&(X=s.timeoutErrorMessage),r(new ut(X,ie.clarifyTimeoutError?ut.ETIMEDOUT:ut.ECONNABORTED,n,T)),T=null},a===void 0&&c.setContentType(null),"setRequestHeader"in T&&xe.forEach(c.toJSON(),function(X,ie){T.setRequestHeader(ie,X)}),xe.isUndefined(s.withCredentials)||(T.withCredentials=!!s.withCredentials),d&&d!=="json"&&(T.responseType=s.responseType),m&&([S,_]=lf(m,!0),T.addEventListener("progress",S)),h&&T.upload&&([x,I]=lf(h),T.upload.addEventListener("progress",x),T.upload.addEventListener("loadend",I)),(s.cancelToken||s.signal)&&(g=F=>{T&&(r(!F||F.type?new zc(null,n,T):F),T.abort(),T=null)},s.cancelToken&&s.cancelToken.subscribe(g),s.signal&&(s.signal.aborted?g():s.signal.addEventListener("abort",g)));const D=O8(s.url);if(D&&er.protocols.indexOf(D)===-1){r(new ut("Unsupported protocol "+D+":",ut.ERR_BAD_REQUEST,n));return}T.send(a||null)})},Q8=(n,e)=>{const{length:t}=n=n?n.filter(Boolean):[];if(e||t){let r=new AbortController,s;const a=function(m){if(!s){s=!0,d();const g=m instanceof Error?m:this.reason;r.abort(g instanceof ut?g:new zc(g instanceof Error?g.message:g))}};let c=e&&setTimeout(()=>{c=null,a(new ut(`timeout ${e} of ms exceeded`,ut.ETIMEDOUT))},e);const d=()=>{n&&(c&&clearTimeout(c),c=null,n.forEach(m=>{m.unsubscribe?m.unsubscribe(a):m.removeEventListener("abort",a)}),n=null)};n.forEach(m=>m.addEventListener("abort",a));const{signal:h}=r;return h.unsubscribe=()=>xe.asap(d),h}},Y8=function*(n,e){let t=n.byteLength;if(t<e){yield n;return}let r=0,s;for(;r<t;)s=r+e,yield n.slice(r,s),r=s},X8=async function*(n,e){for await(const t of J8(n))yield*Y8(t,e)},J8=async function*(n){if(n[Symbol.asyncIterator]){yield*n;return}const e=n.getReader();try{for(;;){const{done:t,value:r}=await e.read();if(t)break;yield r}}finally{await e.cancel()}},AS=(n,e,t,r)=>{const s=X8(n,e);let a=0,c,d=h=>{c||(c=!0,r&&r(h))};return new ReadableStream({async pull(h){try{const{done:m,value:g}=await s.next();if(m){d(),h.close();return}let x=g.byteLength;if(t){let S=a+=x;t(S)}h.enqueue(new Uint8Array(g))}catch(m){throw d(m),m}},cancel(h){return d(h),s.return()}},{highWaterMark:2})},Zf=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",uI=Zf&&typeof ReadableStream=="function",Z8=Zf&&(typeof TextEncoder=="function"?(n=>e=>n.encode(e))(new TextEncoder):async n=>new Uint8Array(await new Response(n).arrayBuffer())),dI=(n,...e)=>{try{return!!n(...e)}catch{return!1}},eD=uI&&dI(()=>{let n=!1;const e=new Request(er.origin,{body:new ReadableStream,method:"POST",get duplex(){return n=!0,"half"}}).headers.has("Content-Type");return n&&!e}),PS=64*1024,Xy=uI&&dI(()=>xe.isReadableStream(new Response("").body)),cf={stream:Xy&&(n=>n.body)};Zf&&(n=>{["text","arrayBuffer","blob","formData","stream"].forEach(e=>{!cf[e]&&(cf[e]=xe.isFunction(n[e])?t=>t[e]():(t,r)=>{throw new ut(`Response type '${e}' is not supported`,ut.ERR_NOT_SUPPORT,r)})})})(new Response);const tD=async n=>{if(n==null)return 0;if(xe.isBlob(n))return n.size;if(xe.isSpecCompliantForm(n))return(await new Request(er.origin,{method:"POST",body:n}).arrayBuffer()).byteLength;if(xe.isArrayBufferView(n)||xe.isArrayBuffer(n))return n.byteLength;if(xe.isURLSearchParams(n)&&(n=n+""),xe.isString(n))return(await Z8(n)).byteLength},nD=async(n,e)=>{const t=xe.toFiniteNumber(n.getContentLength());return t??tD(e)},rD=Zf&&(async n=>{let{url:e,method:t,data:r,signal:s,cancelToken:a,timeout:c,onDownloadProgress:d,onUploadProgress:h,responseType:m,headers:g,withCredentials:x="same-origin",fetchOptions:S}=cI(n);m=m?(m+"").toLowerCase():"text";let I=Q8([s,a&&a.toAbortSignal()],c),_;const R=I&&I.unsubscribe&&(()=>{I.unsubscribe()});let T;try{if(h&&eD&&t!=="get"&&t!=="head"&&(T=await nD(g,r))!==0){let ie=new Request(e,{method:"POST",body:r,duplex:"half"}),G;if(xe.isFormData(r)&&(G=ie.headers.get("content-type"))&&g.setContentType(G),ie.body){const[N,E]=ES(T,lf(CS(h)));r=AS(ie.body,PS,N,E)}}xe.isString(x)||(x=x?"include":"omit");const A="credentials"in Request.prototype;_=new Request(e,{...S,signal:I,method:t.toUpperCase(),headers:g.normalize().toJSON(),body:r,duplex:"half",credentials:A?x:void 0});let D=await fetch(_,S);const F=Xy&&(m==="stream"||m==="response");if(Xy&&(d||F&&R)){const ie={};["status","statusText","headers"].forEach(P=>{ie[P]=D[P]});const G=xe.toFiniteNumber(D.headers.get("content-length")),[N,E]=d&&ES(G,lf(CS(d),!0))||[];D=new Response(AS(D.body,PS,N,()=>{E&&E(),R&&R()}),ie)}m=m||"text";let X=await cf[xe.findKey(cf,m)||"text"](D,n);return!F&&R&&R(),await new Promise((ie,G)=>{aI(ie,G,{data:X,headers:jr.from(D.headers),status:D.status,statusText:D.statusText,config:n,request:_})})}catch(A){throw R&&R(),A&&A.name==="TypeError"&&/Load failed|fetch/i.test(A.message)?Object.assign(new ut("Network Error",ut.ERR_NETWORK,n,_),{cause:A.cause||A}):ut.from(A,A&&A.code,n,_)}}),Jy={http:x8,xhr:K8,fetch:rD};xe.forEach(Jy,(n,e)=>{if(n){try{Object.defineProperty(n,"name",{value:e})}catch{}Object.defineProperty(n,"adapterName",{value:e})}});const BS=n=>`- ${n}`,iD=n=>xe.isFunction(n)||n===null||n===!1,hI={getAdapter:n=>{n=xe.isArray(n)?n:[n];const{length:e}=n;let t,r;const s={};for(let a=0;a<e;a++){t=n[a];let c;if(r=t,!iD(t)&&(r=Jy[(c=String(t)).toLowerCase()],r===void 0))throw new ut(`Unknown adapter '${c}'`);if(r)break;s[c||"#"+a]=r}if(!r){const a=Object.entries(s).map(([d,h])=>`adapter ${d} `+(h===!1?"is not supported by the environment":"is not available in the build"));let c=e?a.length>1?`since :
`+a.map(BS).join(`
`):" "+BS(a[0]):"as no adapter specified";throw new ut("There is no suitable adapter to dispatch the request "+c,"ERR_NOT_SUPPORT")}return r},adapters:Jy};function Zg(n){if(n.cancelToken&&n.cancelToken.throwIfRequested(),n.signal&&n.signal.aborted)throw new zc(null,n)}function FS(n){return Zg(n),n.headers=jr.from(n.headers),n.data=Jg.call(n,n.transformRequest),["post","put","patch"].indexOf(n.method)!==-1&&n.headers.setContentType("application/x-www-form-urlencoded",!1),hI.getAdapter(n.adapter||Nd.adapter)(n).then(function(r){return Zg(n),r.data=Jg.call(n,n.transformResponse,r),r.headers=jr.from(r.headers),r},function(r){return oI(r)||(Zg(n),r&&r.response&&(r.response.data=Jg.call(n,n.transformResponse,r.response),r.response.headers=jr.from(r.response.headers))),Promise.reject(r)})}const pI="1.10.0",em={};["object","boolean","number","function","string","symbol"].forEach((n,e)=>{em[n]=function(r){return typeof r===n||"a"+(e<1?"n ":" ")+n}});const NS={};em.transitional=function(e,t,r){function s(a,c){return"[Axios v"+pI+"] Transitional option '"+a+"'"+c+(r?". "+r:"")}return(a,c,d)=>{if(e===!1)throw new ut(s(c," has been removed"+(t?" in "+t:"")),ut.ERR_DEPRECATED);return t&&!NS[c]&&(NS[c]=!0,console.warn(s(c," has been deprecated since v"+t+" and will be removed in the near future"))),e?e(a,c,d):!0}};em.spelling=function(e){return(t,r)=>(console.warn(`${r} is likely a misspelling of ${e}`),!0)};function sD(n,e,t){if(typeof n!="object")throw new ut("options must be an object",ut.ERR_BAD_OPTION_VALUE);const r=Object.keys(n);let s=r.length;for(;s-- >0;){const a=r[s],c=e[a];if(c){const d=n[a],h=d===void 0||c(d,a,n);if(h!==!0)throw new ut("option "+a+" must be "+h,ut.ERR_BAD_OPTION_VALUE);continue}if(t!==!0)throw new ut("Unknown option "+a,ut.ERR_BAD_OPTION)}}const Cp={assertOptions:sD,validators:em},Ci=Cp.validators;let ka=class{constructor(e){this.defaults=e||{},this.interceptors={request:new jS,response:new jS}}async request(e,t){try{return await this._request(e,t)}catch(r){if(r instanceof Error){let s={};Error.captureStackTrace?Error.captureStackTrace(s):s=new Error;const a=s.stack?s.stack.replace(/^.+\n/,""):"";try{r.stack?a&&!String(r.stack).endsWith(a.replace(/^.+\n.+\n/,""))&&(r.stack+=`
`+a):r.stack=a}catch{}}throw r}}_request(e,t){typeof e=="string"?(t=t||{},t.url=e):t=e||{},t=Ma(this.defaults,t);const{transitional:r,paramsSerializer:s,headers:a}=t;r!==void 0&&Cp.assertOptions(r,{silentJSONParsing:Ci.transitional(Ci.boolean),forcedJSONParsing:Ci.transitional(Ci.boolean),clarifyTimeoutError:Ci.transitional(Ci.boolean)},!1),s!=null&&(xe.isFunction(s)?t.paramsSerializer={serialize:s}:Cp.assertOptions(s,{encode:Ci.function,serialize:Ci.function},!0)),t.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?t.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:t.allowAbsoluteUrls=!0),Cp.assertOptions(t,{baseUrl:Ci.spelling("baseURL"),withXsrfToken:Ci.spelling("withXSRFToken")},!0),t.method=(t.method||this.defaults.method||"get").toLowerCase();let c=a&&xe.merge(a.common,a[t.method]);a&&xe.forEach(["delete","get","head","post","put","patch","common"],_=>{delete a[_]}),t.headers=jr.concat(c,a);const d=[];let h=!0;this.interceptors.request.forEach(function(R){typeof R.runWhen=="function"&&R.runWhen(t)===!1||(h=h&&R.synchronous,d.unshift(R.fulfilled,R.rejected))});const m=[];this.interceptors.response.forEach(function(R){m.push(R.fulfilled,R.rejected)});let g,x=0,S;if(!h){const _=[FS.bind(this),void 0];for(_.unshift.apply(_,d),_.push.apply(_,m),S=_.length,g=Promise.resolve(t);x<S;)g=g.then(_[x++],_[x++]);return g}S=d.length;let I=t;for(x=0;x<S;){const _=d[x++],R=d[x++];try{I=_(I)}catch(T){R.call(this,T);break}}try{g=FS.call(this,I)}catch(_){return Promise.reject(_)}for(x=0,S=m.length;x<S;)g=g.then(m[x++],m[x++]);return g}getUri(e){e=Ma(this.defaults,e);const t=lI(e.baseURL,e.url,e.allowAbsoluteUrls);return rI(t,e.params,e.paramsSerializer)}};xe.forEach(["delete","get","head","options"],function(e){ka.prototype[e]=function(t,r){return this.request(Ma(r||{},{method:e,url:t,data:(r||{}).data}))}});xe.forEach(["post","put","patch"],function(e){function t(r){return function(a,c,d){return this.request(Ma(d||{},{method:e,headers:r?{"Content-Type":"multipart/form-data"}:{},url:a,data:c}))}}ka.prototype[e]=t(),ka.prototype[e+"Form"]=t(!0)});let oD=class fI{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let t;this.promise=new Promise(function(a){t=a});const r=this;this.promise.then(s=>{if(!r._listeners)return;let a=r._listeners.length;for(;a-- >0;)r._listeners[a](s);r._listeners=null}),this.promise.then=s=>{let a;const c=new Promise(d=>{r.subscribe(d),a=d}).then(s);return c.cancel=function(){r.unsubscribe(a)},c},e(function(a,c,d){r.reason||(r.reason=new zc(a,c,d),t(r.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const t=this._listeners.indexOf(e);t!==-1&&this._listeners.splice(t,1)}toAbortSignal(){const e=new AbortController,t=r=>{e.abort(r)};return this.subscribe(t),e.signal.unsubscribe=()=>this.unsubscribe(t),e.signal}static source(){let e;return{token:new fI(function(s){e=s}),cancel:e}}};function aD(n){return function(t){return n.apply(null,t)}}function lD(n){return xe.isObject(n)&&n.isAxiosError===!0}const Zy={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Zy).forEach(([n,e])=>{Zy[e]=n});function mI(n){const e=new ka(n),t=Hj(ka.prototype.request,e);return xe.extend(t,ka.prototype,e,{allOwnKeys:!0}),xe.extend(t,e,null,{allOwnKeys:!0}),t.create=function(s){return mI(Ma(n,s))},t}const mn=mI(Nd);mn.Axios=ka;mn.CanceledError=zc;mn.CancelToken=oD;mn.isCancel=oI;mn.VERSION=pI;mn.toFormData=Jf;mn.AxiosError=ut;mn.Cancel=mn.CanceledError;mn.all=function(e){return Promise.all(e)};mn.spread=aD;mn.isAxiosError=lD;mn.mergeConfig=Ma;mn.AxiosHeaders=jr;mn.formToJSON=n=>sI(xe.isHTMLForm(n)?new FormData(n):n);mn.getAdapter=hI.getAdapter;mn.HttpStatusCode=Zy;mn.default=mn;const{Axios:lM,AxiosError:cM,CanceledError:uM,isCancel:dM,CancelToken:hM,VERSION:pM,all:fM,Cancel:mM,isAxiosError:gM,spread:yM,toFormData:xM,AxiosHeaders:bM,HttpStatusCode:vM,formToJSON:wM,getAdapter:SM,mergeConfig:kM}=mn;async function*cD(n,e,t){try{const s=(await mn.post("/api/gpt",{messages:[{sender:"user",text:n}],system_prompt:t})).data.reply;if(s){const a=s.split("");for(const c of a)yield c,await new Promise(d=>setTimeout(d,50))}}catch(r){console.error("Error calling GPT API:",r),yield"抱歉，我現在無法回應，請稍後再試。"}}const gI=["Annie.png","berlex.png","Bray.png","Cayly.png","Derxl.png","El.png","Fenny.png","Gily.png","Henny.png","Jesy.png","Karl.png","michy.png","Mily.png","Neysher.png","sandy.png","Sherl.png","Shu.png","Shyly.png"],uD=gI.map(n=>`/avatars/${n}`);gI.map(n=>n.replace(/\.png$/i,""));const zS={"zh-TW":{friend:"朋友",avatarTitle:"選我做你的朋友",companionPhrase:["🕊️ 守在海這端，","我都聽著呢。"],changeAvatar:"更換我的頭像",aiReplyTemplate:n=>`AI陪聊：我明白你的意思，「${n}」，讓我再多聽你說說...`,aiSystemPrompt:"你是一個溫暖、善解人意的虛擬人，請用鼓勵、正向語氣回應。",speechErrorBrowser:"此瀏覽器不支援語音辨識，請改用 Chrome/Edge。",speechErrorFail:"語音辨識失敗，請再試一次。",speechErrorNoDetect:"沒有偵測到語音，請再試一次。",logout:"登出",inputPlaceholder:"或者，直接輸入文字... (Enter 送出)",welcome:n=>`嗨，${n}，我是你的 AI 朋友，你可以開始跟我說話囉！`,welcomePickAvatar:n=>`嗨，${n}，先幫我選個頭像後我們再輕鬆自在，天南地北痛快聊...`,welcomeChat:(n,e)=>`${n}說：嗨，${e}，今天想聊點什麼呢？`,whoAmI:"你想我是誰？",tapToTalk:"按一下開始語音聊天...",aiReplying:"AI 正在回覆中，輸入新訊息可立即打斷",recognizing:"正在辨識中..."},"zh-CN":{friend:"朋友",avatarTitle:"选我做你的朋友",companionPhrase:["🕊️ 守在海这端，","我都听着呢。"],changeAvatar:"更换我的头像",aiReplyTemplate:n=>`AI陪聊：我明白你的意思，"${n}"，让我再多听你聊聊...`,aiSystemPrompt:"你是一个温暖、善解人意的虚拟人，请用鼓励、正向语气回应。",speechErrorBrowser:"此浏览器不支持语音识别，请改用 Chrome/Edge。",speechErrorFail:"语音识别失败，请再试一次。",speechErrorNoDetect:"没有检测到语音，请再试一次。",logout:"登出",inputPlaceholder:"或者，直接输入文字... (Enter 发送)",welcome:n=>`嗨，${n}，我是你的 AI 朋友，你可以开始跟我说话啰！`,welcomePickAvatar:n=>`嗨，${n}，先帮我选个头像后我们再轻松自在，天南地北畅快聊...`,welcomeChat:(n,e)=>`${n}说：嗨，${e}，今天想聊点什么呢？`,whoAmI:"你想我是谁？",tapToTalk:"点一下开始语音聊天...",aiReplying:"AI 正在回复中，输入新消息可立即打断",recognizing:"正在识别中..."},en:{friend:"Friend",avatarTitle:"Pick Me as Your Friend",companionPhrase:["🕊️ I'm here by the sea,","I'm listening."],changeAvatar:"Change My Avatar",aiReplyTemplate:n=>`AI Chat: I understand what you mean, "${n}", let me hear more from you...`,aiSystemPrompt:"You are a warm, empathetic virtual person. Please respond in an encouraging and positive tone.",speechErrorBrowser:"This browser does not support speech recognition. Please use Chrome/Edge.",speechErrorFail:"Speech recognition failed, please try again.",speechErrorNoDetect:"No speech detected, please try again.",logout:"Logout",inputPlaceholder:"Or, type text directly... (Enter to send)",welcome:n=>`Hi, ${n}, I'm your AI friend. You can start talking to me now!`,welcomePickAvatar:n=>`Hi, ${n}, pick my avatar and let's chat freely!`,welcomeChat:(n,e)=>`${n}: Hi, ${e}, what do you want to talk about today?`,whoAmI:"Who do you want me to be?",tapToTalk:"Tap to start voice chat...",aiReplying:"AI is replying, type a new message to interrupt.",recognizing:"Recognizing..."},ja:{friend:"友達",avatarTitle:"友達に選んでね",companionPhrase:["🕊️ この海辺で待ってるよ、","ずっと聞いているから。"],changeAvatar:"アバターを変更",aiReplyTemplate:n=>`AIチャット：あなたの言うこと、「${n}」、わかります。もっと聞かせてください...`,aiSystemPrompt:"あなたは温かく、共感的なバーチャルパーソンです。励ましとポジティブなトーンで応答してください。",speechErrorBrowser:"このブラウザは音声認識に対応していません。Chrome/Edgeを使用してください。",speechErrorFail:"音声認識に失敗しました。もう一度お試しください。",speechErrorNoDetect:"音声が検出されませんでした。もう一度お試しください。",logout:"ログアウト",inputPlaceholder:"あるいは、直接テキストを入力... (Enterで送信)",welcome:n=>`こんにちは、${n}さん。あなたのAIの友達です。さあ、話しましょう！`,welcomePickAvatar:n=>`やあ、${n}、まずは私のアバターを選んでから、気軽に何でも話そう！`,welcomeChat:(n,e)=>`${n}：やあ、${e}、今日は何を話そうか？`,whoAmI:"私が誰であってほしいですか？",tapToTalk:"タップして音声チャット開始",aiReplying:"AIが返信中です。新しいメッセージを入力するとすぐに中断できます",recognizing:"認識中..."},ko:{friend:"친구",avatarTitle:"나를 친구로 선택해줘",companionPhrase:["🕊️ 바다 이편에서 지키고 있을게,","다 듣고 있어."],changeAvatar:"내 아바타 변경",aiReplyTemplate:n=>`AI 채팅: 무슨 말인지 알겠어, "${n}", 더 얘기해줘...`,aiSystemPrompt:"당신은 따뜻하고 공감 능력이 뛰어난 가상 인간입니다. 격려하고 긍정적인 톤으로 응답해주세요.",speechErrorBrowser:"이 브라우저는 음성 인식을 지원하지 않습니다. Chrome/Edge를 사용해주세요.",speechErrorFail:"음성 인식이 실패했습니다. 다시 시도해주세요.",speechErrorNoDetect:"음성이 감지되지 않았습니다. 다시 시도해주세요.",logout:"로그아웃",inputPlaceholder:"아니면, 직접 텍스트를 입력하세요... (Enter로 전송)",welcome:n=>`안녕, ${n}. 나는 너의 AI 친구야. 이제 나에게 말을 걸 수 있어!`,welcomePickAvatar:n=>`안녕, ${n}. 먼저 내 아바타를 고르고 자유롭게 얘기하자!`,welcomeChat:(n,e)=>`${n}: 안녕, ${e}, 오늘 무슨 얘기하고 싶어?`,whoAmI:"내가 누구였으면 좋겠어?",tapToTalk:"탭하여 음성 채팅 시작...",aiReplying:"AI가 답장 중입니다. 새 메시지를 입력하여 중단할 수 있습니다.",recognizing:"인식 중..."},vi:{friend:"Bạn bè",avatarTitle:"Chọn tôi làm bạn của bạn",companionPhrase:["🕊️ Em ở đây bên bờ biển,","Em đang lắng nghe đây."],changeAvatar:"Thay đổi Avatar của tôi",aiReplyTemplate:n=>`Trò chuyện AI: Tôi hiểu ý bạn, "${n}", hãy cho tôi nghe thêm...`,aiSystemPrompt:"Bạn là một người ảo ấm áp, đồng cảm. Vui lòng trả lời bằng giọng điệu khích lệ và tích cực.",speechErrorBrowser:"Trình duyệt này không hỗ trợ nhận dạng giọng nói. Vui lòng sử dụng Chrome/Edge.",speechErrorFail:"Nhận dạng giọng nói thất bại, vui lòng thử lại.",speechErrorNoDetect:"Không phát hiện thấy giọng nói, vui lòng thử lại.",logout:"Đăng xuất",inputPlaceholder:"Hoặc, nhập văn bản trực tiếp... (Enter để gửi)",welcome:n=>`Chào, ${n}. Tôi là người bạn AI của bạn. Bây giờ bạn có thể bắt đầu nói chuyện với tôi!`,welcomePickAvatar:n=>`Chào, ${n}, hãy chọn avatar của tôi và chúng ta hãy trò chuyện thoải mái!`,welcomeChat:(n,e)=>`${n}: Chào, ${e}, hôm nay bạn muốn nói về điều gì?`,whoAmI:"Bạn muốn tôi là ai?",tapToTalk:"Nhấn để bắt đầu trò chuyện thoại...",aiReplying:"AI đang trả lời, nhập tin nhắn mới để ngắt.",recognizing:"Đang nhận dạng..."},th:{friend:"เพื่อน",avatarTitle:"เลือกฉันเป็นเพื่อนของคุณ",companionPhrase:["🕊️ ฉันอยู่ที่นี่ริมทะเล,","ฉันกำลังฟังอยู่"],changeAvatar:"เปลี่ยนอวตารของฉัน",aiReplyTemplate:n=>`แชท AI: ฉันเข้าใจที่คุณหมายถึง, "${n}", เล่าให้ฉันฟังอีกสิ...`,aiSystemPrompt:"คุณเป็นบุคคลเสมือนที่อบอุ่นและเข้าอกเข้าใจ โปรดตอบกลับด้วยน้ำเสียงที่ให้กำลังใจและเป็นบวก",speechErrorBrowser:"เบราว์เซอร์นี้ไม่รองรับการจำแนกเสียงพูด กรุณาใช้ Chrome/Edge",speechErrorFail:"การจำแนกเสียงพูดล้มเหลว กรุณาลองอีกครั้ง",speechErrorNoDetect:"ไม่พบเสียงพูด กรุณาลองอีกครั้ง",logout:"ออกจากระบบ",inputPlaceholder:"หรือพิมพ์ข้อความโดยตรง... (Enter เพื่อส่ง)",welcome:n=>`สวัสดี, ${n}. ฉันคือเพื่อน AI ของคุณ คุณสามารถเริ่มคุยกับฉันได้เลย!`,welcomePickAvatar:n=>`สวัสดี, ${n}, เลือกอวตารของฉันแล้วมาคุยกันอย่างอิสระ!`,welcomeChat:(n,e)=>`${n}: สวัสดี, ${e}, วันนี้คุณอยากคุยเรื่องอะไร?`,whoAmI:"คุณอยากให้ฉันเป็นใคร?",tapToTalk:"แตะเพื่อเริ่มแชทด้วยเสียง...",aiReplying:"AI กำลังตอบกลับ, พิมพ์ข้อความใหม่เพื่อขัดจังหวะ",recognizing:"กำลังจดจำ..."},la:{friend:"Amicus",avatarTitle:"Elige Me ut Amicum Tuum",companionPhrase:["🕊️ Hic adsum ad mare,","Audio."],changeAvatar:"Muta Imaginem Meam",aiReplyTemplate:n=>`AI Curabitur: Intellego quid velis, "${n}", sine me plura a te audire...`,aiSystemPrompt:"Tu es persona virtualis calida et empathetica. Quaeso responde sono hortanti et positivo.",speechErrorBrowser:"Hic navigator recognitionem vocis non sustinet. Quaeso utere Chrome/Edge.",speechErrorFail:"Recognitio vocis defecit, quaeso iterum conare.",speechErrorNoDetect:"Nulla oratio detecta, quaeso iterum conare.",logout:"Exire",inputPlaceholder:"Aut, textum directe scribe... (Enter mittere)",welcome:n=>`Salve, ${n}. Amicus tuus AI sum. Iam potes mecum loqui!`,welcomePickAvatar:n=>`Salve, ${n}, elige imaginem meam et libere loquamur!`,welcomeChat:(n,e)=>`${n}: Salve, ${e}, de quo hodie loqui vis?`,whoAmI:"Quis vis me esse?",tapToTalk:"Tange ut colloquium vocale incipias...",aiReplying:"AI respondet, scribe novum nuntium ad interrumpendum.",recognizing:"Agnoscens..."},ms:{friend:"Kawan",avatarTitle:"Pilih Saya sebagai Kawan Anda",companionPhrase:["🕊️ Saya di sini di tepi laut,","Saya sedang mendengar."],changeAvatar:"Tukar Avatar Saya",aiReplyTemplate:n=>`Sembang AI: Saya faham maksud awak, "${n}", beritahu saya lagi...`,aiSystemPrompt:"Anda adalah orang maya yang mesra dan empati. Sila balas dengan nada yang menggalakkan dan positif.",speechErrorBrowser:"Pelayar ini tidak menyokong pengecaman pertuturan. Sila gunakan Chrome/Edge.",speechErrorFail:"Pengecaman pertuturan gagal, sila cuba lagi.",speechErrorNoDetect:"Tiada pertuturan dikesan, sila cuba lagi.",logout:"Log keluar",inputPlaceholder:"Atau, taip teks secara terus... (Enter untuk hantar)",welcome:n=>`Hai, ${n}. Saya kawan AI anda. Anda boleh mula bercakap dengan saya sekarang!`,welcomePickAvatar:n=>`Hai, ${n}, pilih avatar saya dan mari berbual dengan bebas!`,welcomeChat:(n,e)=>`${n}: Hai, ${e}, apa yang anda mahu bualkan hari ini?`,whoAmI:"Awak nak saya jadi siapa?",tapToTalk:"Ketik untuk memulakan sembang suara...",aiReplying:"AI sedang membalas, taip mesej baru untuk mengganggu.",recognizing:"Mengecam..."}},dD={"zh-TW":"返回","zh-CN":"返回",en:"Back",ja:"戻る",ko:"뒤로",th:"ย้อนกลับ",vi:"Quay lại",ms:"Kembali",la:"Redi"},hD={"zh-TW":"更換頭像","zh-CN":"更换头像",en:"Change Avatar",ja:"アバターを変更",ko:"아바타 변경",th:"เปลี่ยนภาพประจำตัว",vi:"Đổi avatar",ms:"Tukar Avatar",la:"Muta Imaginem"};function pD(){var Ze,Ke,Et,Ot,Gt;const n=wt(),[e,t]=w.useState([]),[r,s]=w.useState(""),[a,c]=w.useState(!1),d=w.useRef(null),h=w.useRef(null),m=w.useRef(null),[g,x]=w.useState(!1),[S,I]=w.useState(!1),[_,R]=w.useState(""),[T,A]=w.useState(!1),[D,F]=w.useState(""),[X,ie]=w.useState(""),[G,N]=w.useState(!1),[E,P]=w.useState(!1),[M,O]=w.useState(""),[z,j]=w.useState(""),{lang:K,setLang:Z}=Bt(),Y=zS[K]||zS["zh-TW"],ae=w.useRef(null),[se,re]=w.useState(!1),ne=w.useRef(null),[W,$]=w.useState(!1),{checkPermission:ee,recordUsage:he}=Lo(),[_e,ve]=w.useState(!1),[Le,Ne]=w.useState(!1),[nt,Je]=w.useState(null),ge=()=>{const et=gt().currentUser;return et&&et.displayName||localStorage.getItem("nickname")||Y.friend},[De,tt]=w.useState(ge()),[Ye,We]=w.useState(()=>localStorage.getItem("lastUid")),[pe,Se]=w.useState(()=>!localStorage.getItem("avatarWelcomed")),[we,Re]=w.useState(()=>!localStorage.getItem("aiAvatar")),[Ce,U]=w.useState(""),V=w.useRef(null);w.useEffect(()=>{localStorage.setItem("lang",K),tt(ge());const et=window.SpeechRecognition||window.webkitSpeechRecognition;et?(ae.current=new et,ae.current.continuous=!0,ae.current.interimResults=!0,ae.current.lang=K,ae.current.onresult=ht=>{let Vt="",ct="";for(let zt=ht.resultIndex;zt<ht.results.length;++zt)ht.results[zt].isFinal?ct+=ht.results[zt][0].transcript:Vt+=ht.results[zt][0].transcript;s(z+ct+Vt),ct&&(j(zt=>zt+ct),oe(z+ct),J())},ae.current.onerror=ht=>{console.error("Speech recognition error",ht.error);let Vt="";switch(ht.error){case"no-speech":Vt=Y.speechErrorNoDetect;break;case"audio-capture":case"network":Vt=Y.speechErrorFail;break;default:Vt=""}O(Vt),P(!1),I(!1)},ae.current.onend=()=>{P(!1)}):O(Y.speechErrorBrowser)},[K,Y.speechErrorBrowser,Y.speechErrorFail,Y.speechErrorNoDetect,S,z]),w.useEffect(()=>{ae.current&&(ae.current.onend=()=>{P(!1),se&&S&&!W&&(ne.current=setTimeout(()=>{!S||W||(r.trim()&&(oe(r),s(""),j("")),setTimeout(()=>{S&&se&&!W&&(ae.current.start(),P(!0))},500))},100))})},[se,S,r,W]),w.useEffect(()=>{var Vt,ct;const et=localStorage.getItem("aiAvatar");et?(R(et),A(!1)):A(!0);const ht=(Vt=gt().currentUser)==null?void 0:Vt.uid;ht!==Ye&&(localStorage.removeItem("aiAvatar"),localStorage.removeItem("avatarWelcomed"),R(""),We(ht||null),ht&&localStorage.setItem("lastUid",ht)),gt().currentUser&&tt(((ct=gt().currentUser)==null?void 0:ct.displayName)||Y.friend)},[Ye,Y.friend]),w.useEffect(()=>{m.current&&(m.current.scrollTop=m.current.scrollHeight)},[e]);const L=et=>{R(et),localStorage.setItem("aiAvatar",et),A(!1),pe&&(t([{id:"welcome-1",text:Y.welcomeChat(H(et),De),sender:"ai"}]),localStorage.setItem("avatarWelcomed","true"),Se(!1))},oe=async(et=r)=>{if(!et.trim())return;const ht=await ee("aiChat");if(!ht.allowed){ht.isFreeUser?Ne(!0):(ht.canRenew,Je(ht),ve(!0));return}const Vt={id:`user-${Date.now()}`,text:et,sender:"user"};t(zt=>[...zt,Vt]),s(""),j(""),d.current&&clearTimeout(d.current);const ct=`ai-${Date.now()}`;t(zt=>[...zt,{id:ct,text:"",sender:"ai",status:"streaming"}]),c(!0);try{const zt=await cD(et,K,Y.aiSystemPrompt);let On="";for await(const Wt of zt)On+=Wt,t(bn=>bn.map(Ir=>Ir.id===ct?{...Ir,text:On}:Ir));t(Wt=>Wt.map(bn=>bn.id===ct?{...bn,status:"done"}:bn)),N(!0),await he("aiChat",2)}catch(zt){console.error("Error in AI pipeline: ",zt),t(On=>On.map(Wt=>Wt.id===ct?{...Wt,text:"Oops, something went wrong.",status:"done"}:Wt))}finally{c(!1),N(!1)}},H=et=>{if(!et)return"";const ht=et.split("/");return ht[ht.length-1].replace(/\.png$/i,"")},J=async()=>{if(ae.current)if(S||se||E)ae.current.stop(),I(!1),P(!1),re(!1),ne.current&&clearTimeout(ne.current),$(!0);else{const et=await ee("aiChat");if(!et.allowed){et.isFreeUser?Ne(!0):(et.canRenew,Je(et),ve(!0));return}j(""),s(""),ae.current.start(),I(!0),P(!0),O(""),re(!0),$(!1),await he("aiChat",1)}},be=et=>{var Vt;const ht=(Vt=et.target.files)==null?void 0:Vt[0];if(ht){if(!ht.type.startsWith("image/")){alert("請選擇圖片文件");return}if(ht.size>5*1024*1024){alert("圖片大小不能超過 5MB");return}const ct=new FileReader;ct.onload=zt=>{var Wt;const On=(Wt=zt.target)==null?void 0:Wt.result;U(On),L(On)},ct.readAsDataURL(ht)}},Me=()=>{var et;(et=V.current)==null||et.click()};w.useEffect(()=>{!S&&!se&&$(!1)},[S,se]);const $e=()=>{ve(!1),Je(null)};return i.jsxs("div",{style:{display:"flex",flexDirection:"column",height:"100vh",backgroundColor:"#f0f2f5"},children:[i.jsxs("header",{style:{display:"flex",flexDirection:"column",backgroundColor:"#fff",borderBottom:"1px solid #ddd",position:"relative",padding:0},children:[i.jsxs("div",{style:{width:"100%",display:"flex",alignItems:"center",justifyContent:"center",padding:"10px 20px 0 20px",position:"relative"},children:[i.jsx("button",{onClick:()=>n(-1),style:{position:"absolute",left:20,background:"#6B5BFF",color:"#fff",border:"none",borderRadius:8,padding:"8px 18px",fontWeight:700,fontSize:16,cursor:"pointer"},children:dD[K]}),i.jsx("span",{className:"ai-name-desktop",style:{fontWeight:700,color:"#ff9800",fontSize:18,marginRight:12,minWidth:50,textAlign:"right",maxWidth:70,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:H(_)||Y.whoAmI}),i.jsx("div",{style:{fontSize:20,fontWeight:700,textAlign:"center",flexShrink:0},children:"💬 聊天了吧"}),i.jsx("span",{style:{fontWeight:700,color:"#1976d2",fontSize:18,marginLeft:12,minWidth:50,textAlign:"left",maxWidth:70,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:((Ze=gt().currentUser)==null?void 0:Ze.displayName)||((Ke=gt().currentUser)==null?void 0:Ke.email)||"用戶"})]}),i.jsx("div",{style:{textAlign:"center",marginTop:4},children:i.jsx("div",{style:{fontSize:16,color:"#888"},children:"在這裡你可以盡情,暢快,放開地聊😊"})})]}),T&&i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.8)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:100},children:i.jsxs("div",{style:{background:"#fff",padding:24,borderRadius:12,textAlign:"center",position:"relative"},children:[i.jsx("button",{onClick:()=>A(!1),style:{position:"absolute",top:12,right:12,background:"none",border:"none",fontSize:24,color:"#888",cursor:"pointer",fontWeight:700},children:"×"}),i.jsx("h2",{children:Y.avatarTitle}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(5, 1fr)",gap:16,margin:"24px 0"},children:[uD.slice(0,15).map(et=>i.jsx("img",{src:et,alt:H(et),onClick:()=>L(et),style:{width:80,height:80,borderRadius:"50%",cursor:"pointer",objectFit:"cover"}},et)),i.jsx("div",{style:{width:80,height:80,borderRadius:"50%",border:"2px dashed #6B5BFF",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",background:"#f8f8ff",color:"#6B5BFF",fontSize:12,fontWeight:600},onClick:Me,children:"上傳心儀頭像"})]}),i.jsx("input",{ref:V,type:"file",accept:"image/*",style:{display:"none"},onChange:be})]})}),!_&&!T&&i.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",padding:24,textAlign:"center"},children:[i.jsx("p",{style:{fontSize:18,marginBottom:24},children:Y.welcomePickAvatar(De)}),i.jsx("button",{onClick:()=>A(!0),style:{padding:"10px 20px",borderRadius:8,background:"#1877f2",color:"#fff",border:"none",fontWeight:700,fontSize:16},children:Y.avatarTitle})]}),_&&i.jsx("main",{ref:m,style:{flex:1,overflowY:"auto",padding:"20px",maxHeight:"calc(100vh - 240px)",scrollBehavior:"smooth",boxSizing:"border-box"},children:i.jsxs("div",{style:{maxWidth:800,margin:"0 auto",minHeight:"100%"},children:[e.length===0&&i.jsx("div",{style:{textAlign:"center",color:"#888",marginTop:40},children:i.jsx("p",{style:{fontSize:18},children:Y.welcomeChat(H(_),De)})}),e.map(et=>i.jsx("div",{style:{display:"flex",justifyContent:et.sender==="user"?"flex-end":"flex-start",margin:"10px 0",wordWrap:"break-word"},children:i.jsxs("div",{style:{backgroundColor:et.sender==="user"?"#0084ff":"#e4e6eb",color:et.sender==="user"?"#fff":"#000",padding:"12px 16px",borderRadius:18,maxWidth:"70%",wordBreak:"break-word",whiteSpace:"pre-wrap",lineHeight:"1.4"},children:[et.text,et.status==="streaming"&&"..."]})},et.id)),i.jsx("div",{style:{height:"20px"}})]})}),_&&i.jsxs("footer",{style:{padding:"10px 20px 10px 20px",backgroundColor:"#fff",borderTop:"1px solid #ddd",position:"relative",minHeight:"160px",boxSizing:"border-box"},children:[i.jsx("div",{style:{maxWidth:800,margin:"0 auto",display:"flex",alignItems:"flex-start",justifyContent:"center"},children:i.jsxs("div",{style:{flex:1,marginLeft:0,marginRight:0},children:[i.jsxs("div",{className:"mobile-avatars-row",style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:12,padding:"0 8px"},children:[i.jsxs("div",{className:"mobile-ai-avatar",style:{display:"flex",alignItems:"center",gap:8},children:[i.jsx("div",{style:{width:80,height:80,borderRadius:"50% / 45%",border:"4px solid #2196f3",display:"flex",alignItems:"center",justifyContent:"center",background:"#fff",overflow:"hidden"},children:i.jsx("div",{style:{width:72,height:72,minWidth:72,minHeight:72,borderRadius:"50%",overflow:"hidden",position:"relative"},children:i.jsx("div",{style:{width:"100%",height:"100%",position:"relative",overflow:"hidden"},children:i.jsx(Pz,{avatar:_,videoUrl:D,audioUrl:X,isSpeaking:G,size:72})})})}),i.jsx("button",{onClick:()=>A(!0),style:{background:"#6B5BFF",color:"#fff",border:"none",borderRadius:6,padding:"4px 8px",fontWeight:600,fontSize:10,cursor:"pointer",boxShadow:"0 2px 4px rgba(107, 91, 255, 0.3)",whiteSpace:"nowrap"},children:hD[K]})]}),i.jsx("div",{style:{flex:1,textAlign:"center",padding:"0 12px"},children:i.jsxs("div",{style:{fontSize:14,color:"#666",lineHeight:"1.4"},children:[i.jsx("span",{style:{fontWeight:700,color:"#ff9800"},children:H(_)||"Fenny"}),i.jsx("br",{}),i.jsx("span",{style:{color:"#1976d2"},children:"讓我們來聊天..."}),i.jsx("br",{}),i.jsx("span",{style:{color:"#1976d2"},children:((Et=gt().currentUser)==null?void 0:Et.displayName)||((Ot=gt().currentUser)==null?void 0:Ot.email)||"用戶"}),i.jsx("br",{}),i.jsx("span",{style:{color:"#666"},children:"聊什麼都可以喔 😊"})]})}),i.jsx("div",{style:{width:80,height:80,borderRadius:"50% / 45%",border:"4px solid #2196f3",display:"flex",alignItems:"center",justifyContent:"center",background:"#fff",overflow:"visible"},children:i.jsx("img",{src:((Gt=gt().currentUser)==null?void 0:Gt.photoURL)||"/ctx-logo.png",alt:"user",style:{width:72,height:72,minWidth:72,minHeight:72,borderRadius:"50%",objectFit:"cover",border:"none",verticalAlign:"bottom"}})})]}),i.jsx("div",{style:{display:"flex",alignItems:"flex-end",height:80},children:i.jsx("input",{ref:h,type:"text",value:r,onChange:et=>s(et.target.value),onKeyPress:et=>et.key==="Enter"&&oe(),placeholder:a?Y.aiReplying:Y.inputPlaceholder,style:{width:"100%",padding:12,borderRadius:18,border:"1px solid #ccc"},disabled:a||E})}),i.jsxs("div",{className:"chat-action-row-mobile",style:{width:"100%",display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center",marginTop:12,gap:16},children:[i.jsx("button",{onClick:()=>oe(),disabled:a||!r,style:{padding:"10px 28px",borderRadius:8,border:"none",background:"#1976d2",color:"#fff",fontWeight:700,fontSize:16,cursor:a||!r?"not-allowed":"pointer"},children:"送出"}),i.jsx("button",{onClick:J,disabled:a,style:{padding:16,borderRadius:"50%",border:"none",background:S||se||E?"#ff4d4d":"#1877f2",color:"#fff",cursor:"pointer",fontSize:20},children:S||se||E?"停止":"🎤"})]}),i.jsxs("div",{className:"chat-action-row-desktop",style:{width:"100%",display:"none",flexDirection:"row",alignItems:"center",justifyContent:"center",marginTop:12,gap:16},children:[i.jsx("button",{onClick:()=>oe(),disabled:a||!r,style:{padding:"10px 28px",borderRadius:8,border:"none",background:"#1976d2",color:"#fff",fontWeight:700,fontSize:16,cursor:a||!r?"not-allowed":"pointer"},children:"送出"}),i.jsx("button",{onClick:J,disabled:a,style:{padding:16,borderRadius:"50%",border:"none",background:S||se||E?"#ff4d4d":"#1877f2",color:"#fff",cursor:"pointer",fontSize:20},children:S||se||E?"停止":"🎤"})]}),i.jsxs("div",{style:{height:40,display:"flex",alignItems:"center",justifyContent:"center"},children:[M&&i.jsx("p",{style:{color:"red",margin:0},children:M}),!M&&!r&&!E&&!a&&!S&&!se&&i.jsx("p",{style:{color:"#888",margin:0,cursor:"pointer"},onClick:J,children:Y.tapToTalk}),!M&&E&&i.jsx("p",{style:{color:"#888",margin:0},children:Y.recognizing}),!M&&(r||a||S||se)&&i.jsx("p",{style:{color:"transparent",margin:0},children:"佔位"})]})]})}),i.jsx("div",{style:{textAlign:"center",marginTop:10,fontSize:12,color:"#aaa"},children:i.jsxs("p",{children:[Y.companionPhrase[0],Y.companionPhrase[1]]})})]}),i.jsx(Ln,{}),_e&&nt&&i.jsx(Mo,{isOpen:_e,onClose:$e,currentPlan:nt.currentPlan,remainingDays:nt.remainingDays,usedTokens:nt.usedTokens,totalTokens:nt.totalTokens}),Le&&i.jsx(qj,{isOpen:Le,onClose:()=>Ne(!1),featureName:"AI 聊天"})]})}const fD="modulepreload",mD=function(n){return"/"+n},DS={},cd=function(e,t,r){let s=Promise.resolve();if(t&&t.length>0){let c=function(m){return Promise.all(m.map(g=>Promise.resolve(g).then(x=>({status:"fulfilled",value:x}),x=>({status:"rejected",reason:x}))))};document.getElementsByTagName("link");const d=document.querySelector("meta[property=csp-nonce]"),h=(d==null?void 0:d.nonce)||(d==null?void 0:d.getAttribute("nonce"));s=c(t.map(m=>{if(m=mD(m),m in DS)return;DS[m]=!0;const g=m.endsWith(".css"),x=g?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${m}"]${x}`))return;const S=document.createElement("link");if(S.rel=g?"stylesheet":fD,g||(S.as="script"),S.crossOrigin="",S.href=m,h&&S.setAttribute("nonce",h),document.head.appendChild(S),g)return new Promise((I,_)=>{S.addEventListener("load",I),S.addEventListener("error",()=>_(new Error(`Unable to preload CSS for ${m}`)))})}))}function a(c){const d=new Event("vite:preloadError",{cancelable:!0});if(d.payload=c,window.dispatchEvent(d),!d.defaultPrevented)throw c}return s.then(c=>{for(const d of c||[])d.status==="rejected"&&a(d.reason);return e().catch(a)})},Bu=gt(Do),gD={"zh-TW":{heroLeftTop:"救贖不是罪，",heroLeftMain:"只是走錯太久。",heroLeftSub:"",heroLeftYellow:"野花昂首盡綻放！",heroRightTop:"我要重新開始...",heroRightMain:"每一次的經歷，都是獨一無二的篇章",heroRightSub:"而不是成長的絆腳石。",heroRightYellow:"從灰燼中重生！",title:"Restarter™ 註冊",email:"電子郵件 *必填",password:"密碼 (至少8位，含英文及數字) *必填",nickname:"暱稱 (2-16字) *必填",age:"年齡*選填",selectAge:"請選擇年齡區間*必選",country:"國家(地區)*必選",city:"城市(可選)",interest:"興趣*選填",eventType:"經歷事件**選填",whatToImprove:"想改善什麼*選填",uploadAvatar:"上傳頭像",male:"男",female:"女",genderRequired:"(必選)",register:"🚀 註冊",registering:"註冊中...",errorAvatar:"請上傳頭像",errorGender:"請選擇性別",errorEmailFormat:"電子郵件格式無效",errorPasswordFormat:"密碼必須至少8個字符，且包含字母和數字",errorNicknameFormat:"暱稱必須是2-16個字符",errorAgeFormat:"年齡必須在18到99歲之間",errorCountry:"請選擇國家/地區",errorRegion:"請輸入城市",errorInterest:"請選擇興趣",errorEventType:"請選擇事件類型",errorImprovement:"請選擇想改善的項目",formTopSlogan:"你來了，就值得被歡迎！",login:"登入",terms:"條款/聲明",privacy:"隱私權政策",deletion:"資料刪除說明",googleLogin:"使用 Google 登入",appleLogin:"使用 Apple 登入"},"zh-CN":{heroLeftTop:"救赎不是罪，",heroLeftMain:"只是走错太久。",heroLeftSub:"",heroLeftYellow:"野花昂首尽绽放！",heroRightTop:"我要重新开始...",heroRightMain:"每一次的经历，都是独一无二的篇章",heroRightSub:"而不是成长的绊脚石。",heroRightYellow:"从灰烬中重生！",title:"Restarter™ 注册",email:"电子邮件 *必填",password:"密码 (至少8位，含英文及数字) *必填",nickname:"昵称 (2-16字) *必填",age:"年龄*选填",selectAge:"请选择年龄区间*必选",country:"国家(地区)*必选",city:"城市(可选)",interest:"兴趣*选填",eventType:"经历事件**选填",whatToImprove:"想改善什么*选填",uploadAvatar:"上传头像",male:"男",female:"女",genderRequired:"(必选)",register:"🚀 注册",registering:"注册中...",errorAvatar:"请上传头像",errorGender:"请选择性别",errorEmailFormat:"电子邮件格式无效",errorPasswordFormat:"密码必须至少8个字符，且包含字母和数字",errorNicknameFormat:"昵称必须是2-16个字符",errorAgeFormat:"年龄必须在18到99岁之间",errorCountry:"请选择国家/地区",errorRegion:"请输入城市",errorInterest:"请选择兴趣",errorEventType:"请选择事件类型",errorImprovement:"请选择想改善的项目",formTopSlogan:"你來了，就值得被歡迎！",login:"登录",terms:"条款/声明",privacy:"隐私政策",deletion:"数据删除说明",googleLogin:"使用 Google 登录",appleLogin:"使用 Apple 登录"},en:{heroLeftTop:"Redemption is not a crime,",heroLeftMain:"just went down the wrong path for too long.",heroLeftSub:"",heroLeftYellow:"Wildflowers bloom bravely!",heroRightTop:"I want a new start...",heroRightMain:"Every experience is a unique chapter,",heroRightSub:"not a barrier to growth.",heroRightYellow:"Rise from the ashes!",title:"Restarter™ Registration",email:"Email *required",password:"Password (min 8 chars, letter & number) *required",nickname:"Nickname (2-16 chars) *required",age:"Age*optional",selectAge:"Select age range",country:"Country (Region)*optional",city:"City (optional)",interest:"Interest*optional",eventType:"History Event**optional",whatToImprove:"What to improve*optional",uploadAvatar:"Upload Avatar",male:"Male",female:"Female",genderRequired:"(*required)",register:"🚀 Register",registering:"Registering...",errorAvatar:"Please upload an avatar.",errorGender:"Please select a gender.",errorEmailFormat:"Invalid email format.",errorPasswordFormat:"Password must be at least 8 characters long and contain both letters and numbers.",errorNicknameFormat:"Nickname must be 2-16 characters long.",errorAgeFormat:"Age must be between 18 and 99.",errorCountry:"Please select a country.",errorRegion:"Please enter a city.",errorInterest:"Please select an interest.",errorEventType:"Please select an event type.",errorImprovement:"Please select an item to improve.",formTopSlogan:"It's not wrong to rise up!",login:"Login",terms:"Terms/Statement",privacy:"Privacy Policy",deletion:"Data Deletion",googleLogin:"Sign in with Google",appleLogin:"Sign in with Apple"},ja:{heroLeftTop:"贖いは罪ではない、",heroLeftMain:"ただ道に迷った時間が長すぎただけだ。",heroLeftSub:"",heroLeftYellow:"野の花も堂々と咲く！",heroRightTop:"私は新しく始めたい...",heroRightMain:"一つ一つの経験が、ユニークな章であり、",heroRightSub:"成長の障害ではない。",heroRightYellow:"灰の中から蘇れ！",title:"Restarter™ 登録",email:"メールアドレス *必須",password:"パスワード (8文字以上、英数字を含む) *必須",nickname:"ニックネーム (2-16文字) *必須",age:"年齢*任意",selectAge:"年齢層を選択",country:"国/地域*任意",city:"都市(任意)",interest:"興味*任意",eventType:"経験した出来事**任意",whatToImprove:"改善したいこと*任意",uploadAvatar:"アバターをアップロード",male:"男性",female:"女性",genderRequired:"(*必須)",register:"🚀 登録",registering:"登録中...",errorAvatar:"アバターをアップロードしてください。",errorGender:"性別を選択してください。",errorEmailFormat:"無効なメール形式です。",errorPasswordFormat:"パスワードは8文字以上で、文字と数字の両方を含める必要があります。",errorNicknameFormat:"ニックネームは2～16文字である必要があります。",errorAgeFormat:"年齢は18歳から99歳の間でなければなりません。",errorCountry:"国を選択してください。",errorRegion:"都市を入力してください。",errorInterest:"興味を選択してください。",errorEventType:"イベントタイプを選択してください。",errorImprovement:"改善したい項目を選択してください。",formTopSlogan:"立ち上がることは間違いじゃない！",login:"ログイン",terms:"規約/声明",privacy:"プライバシーポリシー",deletion:"データ削除について",googleLogin:"Googleでログイン",appleLogin:"Appleでログイン"},ko:{heroLeftTop:"구원은 죄가 아니며,",heroLeftMain:"그저 너무 오랫동안 길을 잃었을 뿐이다.",heroLeftSub:"",heroLeftYellow:"들꽃은 용감하게 핀다!",heroRightTop:"새로운 시작을 원해...",heroRightMain:"모든 경험은 독특한 장이며,",heroRightSub:"성장의 장벽이 아니다.",heroRightYellow:"잿더미에서 일어나라!",title:"Restarter™ 회원가입",email:"이메일 *필수",password:"비밀번호 (최소 8자, 영문/숫자 포함) *필수",nickname:"닉네임 (2-16자) *필수",age:"나이*선택",selectAge:"연령대 선택",country:"국가/지역*선택",city:"도시(선택 사항)",interest:"관심사*선택",eventType:"경험한 사건**선택",whatToImprove:"개선하고 싶은 점*선택",uploadAvatar:"아바타 업로드",male:"남성",female:"여성",genderRequired:"(*필수)",register:"🚀 가입하기",registering:"가입 중...",errorAvatar:"아바타를 업로드해주세요.",errorGender:"성별을 선택해주세요.",errorEmailFormat:"유효하지 않은 이메일 형식입니다.",errorPasswordFormat:"비밀번호는 최소 8자 이상이며, 문자와 숫자를 모두 포함해야 합니다.",errorNicknameFormat:"닉네임은 2-16자여야 합니다.",errorAgeFormat:"나이는 18세에서 99세 사이여야 합니다.",errorCountry:"국가를 선택해주세요.",errorRegion:"도시를 입력해주세요.",errorInterest:"관심사를 선택해주세요.",errorEventType:"사건 유형을 선택해주세요.",errorImprovement:"개선할 항목을 선택해주세요.",formTopSlogan:"일어서는 것은 잘못이 아니야!",login:"로그인",terms:"약관/성명서",privacy:"개인정보처리방침",deletion:"데이터 삭제 안내",googleLogin:"Google로 로그인",appleLogin:"Apple로 로그인"},th:{heroLeftTop:"การไถ่บาปไม่ใช่ความผิด",heroLeftMain:"เพียงแค่หลงทางมานานเกินไป",heroLeftSub:"",heroLeftYellow:"ดอกไม้ป่าบานอย่างกล้าหาญ!",heroRightTop:"ฉันต้องการเริ่มต้นใหม่...",heroRightMain:"ทุกประสบการณ์คือบทที่พิเศษ",heroRightSub:"ไม่ใช่อุปสรรคต่อการเติบโต",heroRightYellow:"ลุกขึ้นจากเถ้าถ่าน!",title:"Restarter™ ลงทะเบียน",email:"อีเมล *จำเป็น",password:"รหัสผ่าน (ขั้นต่ำ 8 ตัวอักษร, ประกอบด้วยตัวอักษรและตัวเลข) *จำเป็น",nickname:"ชื่อเล่น (2-16 ตัวอักษร) *จำเป็น",age:"อายุ*ไม่บังคับ",selectAge:"เลือกช่วงอายุ",country:"ประเทศ/ภูมิภาค*ไม่บังคับ",city:"เมือง (ไม่บังคับ)",interest:"ความสนใจ*ไม่บังคับ",eventType:"เหตุการณ์ที่ผ่านมา**ไม่บังคับ",whatToImprove:"สิ่งที่ต้องการปรับปรุง*ไม่บังคับ",uploadAvatar:"อัปโหลดรูปภาพ",male:"ชาย",female:"หญิง",genderRequired:"(*จำเป็น)",register:"🚀 ลงทะเบียน",registering:"กำลังลงทะเบียน...",errorAvatar:"กรุณาอัปโหลดรูปโปรไฟล์",errorGender:"กรุณาเลือกเพศ",errorEmailFormat:"รูปแบบอีเมลไม่ถูกต้อง",errorPasswordFormat:"รหัสผ่านต้องมีความยาวอย่างน้อย 8 ตัวอักษรและมีทั้งตัวอักษรและตัวเลข",errorNicknameFormat:"ชื่อเล่นต้องมีความยาว 2-16 ตัวอักษร",errorAgeFormat:"อายุต้องอยู่ระหว่าง 18 ถึง 99 ปี",errorCountry:"กรุณาเลือกประเทศ",errorRegion:"กรุณากรอกเมือง",errorInterest:"กรุณาเลือกความสนใจ",errorEventType:"กรุณาเลือกประเภทเหตุการณ์",errorImprovement:"กรุณาเลือกรายการที่ต้องการปรับปรุง",formTopSlogan:"การลุกขึ้นสู้ไม่ใช่เรื่องผิด!",login:"เข้าสู่ระบบ",terms:"ข้อกำหนด/คำชี้แจง",privacy:"นโยบายความเป็นส่วนตัว",deletion:"นโยบายการลบข้อมูล",googleLogin:"เข้าสู่ระบบด้วย Google",appleLogin:"เข้าสู่ระบบด้วย Apple"},vi:{heroLeftTop:"Sự chuộc lỗi không phải là tội ác,",heroLeftMain:"chỉ là đi sai đường quá lâu.",heroLeftSub:"",heroLeftYellow:"Hoa dại nở rộ dũng cảm!",heroRightTop:"Tôi muốn một khởi đầu mới...",heroRightMain:"Mỗi trải nghiệm là một chương độc đáo,",heroRightSub:"Không phải là rào cản cho sự phát triển.",heroRightYellow:"Vươn lên từ đống tro tàn!",title:"Đăng ký Restarter™",email:"Email *bắt buộc",password:"Mật khẩu (tối thiểu 8 ký tự, gồm chữ và số) *bắt buộc",nickname:"Biệt danh (2-16 ký tự) *bắt buộc",age:"Tuổi*không bắt buộc",selectAge:"Chọn độ tuổi",country:"Quốc gia/Khu vực*không bắt buộc",city:"Thành phố (tùy chọn)",interest:"Sở thích*không bắt buộc",eventType:"Sự kiện đã trải qua**không bắt buộc",whatToImprove:"Điều muốn cải thiện*không bắt buộc",uploadAvatar:"Tải lên hình đại diện",male:"Nam",female:"Nữ",genderRequired:"(*bắt buộc)",register:"🚀 Đăng ký",registering:"Đang đăng ký...",errorAvatar:"Vui lòng tải lên ảnh đại diện.",errorGender:"Vui lòng chọn giới tính.",errorEmailFormat:"Định dạng email không hợp lệ.",errorPasswordFormat:"Mật khẩu phải dài ít nhất 8 ký tự và chứa cả chữ cái và số.",errorNicknameFormat:"Biệt danh phải dài từ 2-16 ký tự.",errorAgeFormat:"Tuổi phải từ 18 đến 99.",errorCountry:"Vui lòng chọn một quốc gia.",errorRegion:"Vui lòng nhập thành phố.",errorInterest:"Vui lòng chọn một sở thích.",errorEventType:"Vui lòng chọn một loại sự kiện.",errorImprovement:"Vui lòng chọn một mục để cải thiện.",formTopSlogan:"Vươn lên không phải là sai!",login:"Đăng nhập",terms:"Điều khoản/Tuyên bố",privacy:"Chính sách bảo mật",deletion:"Chính sách xóa dữ liệu",googleLogin:"Đăng nhập bằng Google",appleLogin:"Đăng nhập bằng Apple"},ms:{heroLeftTop:"Penebusan bukanlah jenayah,",heroLeftMain:"hanya tersalah jalan terlalu lama.",heroLeftSub:"",heroLeftYellow:"Bunga liar mekar dengan berani!",heroRightTop:"Saya mahu permulaan yang baru...",heroRightMain:"Setiap pengalaman adalah satu bab yang unik,",heroRightSub:"bukan penghalang kepada pertumbuhan.",heroRightYellow:"Bangkit dari abu!",title:"Pendaftaran Restarter™",email:"E-mel *diperlukan",password:"Kata laluan (min 8 aksara, huruf & nombor) *diperlukan",nickname:"Nama samaran (2-16 aksara) *diperlukan",age:"Umur*pilihan",selectAge:"Pilih julat umur",country:"Negara/Wilayah*pilihan",city:"Bandar (pilihan)",interest:"Minat*pilihan",eventType:"Peristiwa Bersejarah**pilihan",whatToImprove:"Apa yang ingin diperbaiki*pilihan",uploadAvatar:"Muat naik gambar profil",male:"Lelaki",female:"Perempuan",genderRequired:"(*diperlukan)",register:"🚀 Daftar",registering:"Mendaftar...",errorAvatar:"Sila muat naik avatar.",errorGender:"Sila pilih jantina.",errorEmailFormat:"Format e-mel tidak sah.",errorPasswordFormat:"Kata laluan mesti sekurang-kurangnya 8 aksara dan mengandungi kedua-dua huruf dan nombor.",errorNicknameFormat:"Nama samaran mestilah 2-16 aksara.",errorAgeFormat:"Umur mestilah antara 18 dan 99.",errorCountry:"Sila pilih negara.",errorRegion:"Sila masukkan bandar.",errorInterest:"Sila pilih minat.",errorEventType:"Sila pilih jenis acara.",errorImprovement:"Sila pilih item untuk diperbaiki.",formTopSlogan:"Bukan salah untuk bangkit!",login:"Log masuk",terms:"Terma/Penyata",privacy:"Dasar Privasi",deletion:"Dasar Pemadaman Data",googleLogin:"Log masuk dengan Google",appleLogin:"Log masuk dengan Apple"},la:{heroLeftTop:"Redemptio non est crimen,",heroLeftMain:"modo errasse diu.",heroLeftSub:"",heroLeftYellow:"Flores feri fortiter efflorescunt!",heroRightTop:"Novum initium volo...",heroRightMain:"Omnis experientia unicum capitulum est,",heroRightSub:"non impedimentum incrementi.",heroRightYellow:"Resurge ex cineribus!",title:"Restarter™ Inscriptio",email:"Email *requiritur",password:"Password (min 8 chars, letter & number) *requiritur",nickname:"Nickname (2-16 chars) *requiritur",age:"Aetas*optio",selectAge:"Selecta aetatis spatium",country:"Patria (Regio)*optio",city:"Urbs (optio)",interest:"Studium*optio",eventType:"Eventus Historiae**optio",whatToImprove:"Quid emendare vis*optio",uploadAvatar:"Upload Avatar",male:"Male",female:"Female",genderRequired:"(*required)",register:"🚀 Register",registering:"Registering...",errorAvatar:"Please upload an avatar.",errorGender:"Please select a gender.",errorEmailFormat:"Invalid email format.",errorPasswordFormat:"Password must be at least 8 characters long and contain both letters and numbers.",errorNicknameFormat:"Nickname must be 2-16 characters long.",errorAgeFormat:"Age must be between 18 and 99.",errorCountry:"Please select a country.",errorRegion:"Please enter a city.",errorInterest:"Please select an interest.",errorEventType:"Please select an event type.",errorImprovement:"Please select an item to improve.",formTopSlogan:"Surgere non est peccatum!",login:"Inire",terms:"Termini/Declaratio",privacy:"Consilium Privacy",deletion:"Norma Deletionis Datae",googleLogin:"Intra cum Google",appleLogin:"Intra cum Apple"}},MS={"zh-TW":"請先補齊個人資料","zh-CN":"请先补齐个人资料",en:"Please complete your profile first",ja:"まずプロフィールを完成させてください",ko:"먼저 프로필을 완성해 주세요",th:"กรุณากรอกข้อมูลส่วนตัวให้ครบก่อน",vi:"Vui lòng hoàn thiện hồ sơ cá nhân trước",ms:"Sila lengkapkan profil anda terlebih dahulu",la:"Quaeso prius profile tuum comple"},LS={"zh-TW":"每一位更生人，都是世界的一員！","zh-CN":"每一位更生人，都是世界的一员！",en:"Every Restarter is still one of us.",ja:"すべての更生者は世界の一員です！",ko:"모든 Restarter는 우리 중 한 명입니다!",th:"ทุกคนที่ถูกกำพฤติกรรมก็ยังเป็นหนึ่งของเรา!",vi:"Mỗi người được định hình đều là một thành viên của chúng tôi!",ms:"Setiap Restarter masih satu di antara kita!",la:"Omnis Restarter adhuc unus ex nobis est."},yD={"zh-TW":"Restarter™ 是更生者的 副駕 / 合作人。","zh-CN":"Restarter™ 是更生者的 副驾 / 合作人。",en:"Restarter™ is a co-pilot/partner for Restarters.",ja:"Restarter™ は更生者の副操縦士・パートナーです。",ko:"Restarter™는 재생자의 부승무 또는 파트너입니다.",th:"Restarter™ เป็นคู่ควบคุมหรือพาร์ทเนอร์สำหรับ Restarters.",vi:"Restarter™ là phi công phụ hoặc đối tác cho Restarters.",ms:"Restarter™ adalah kopilot/pasukan untuk Restarters.",la:"Restarter™ est co-pilotus/socius pro Restarters."},xD={"zh-TW":"Restarter™ 是更生者的情緒管家 / 生產助手","zh-CN":"Restarter™ 是更生者的情绪管家 / 生产助手",en:"Restarter™ is an emotional steward/productivity assistant for Restarters.",ja:"Restarter™ は更生者の感情マネージャー・生産アシスタントです。",ko:"Restarter™는 재생자의 감정 관리자 및 생산 보조자입니다.",th:"Restarter™ เป็นผู้ดูแลอารมณ์และผู้ช่วยในการผลิตสำหรับ Restarters.",vi:"Restarter™ là người quản lý cảm xúc và người trợ giúp sản xuất cho Restarters.",ms:"Restarter™ adalah pengurus emosi / pembantu produktiviti untuk Restarters.",la:"Restarter™ est motus oeconomus/producentis adiutor pro Restarters."},yI={"zh-TW":["經濟","運動","閱讀","電影","旅遊","交友","唱歌","電商","做生意","電腦","AI","寵物","學技能","一個人安靜","其他"],"zh-CN":["经济","运动","阅读","电影","旅游","交友","唱歌","电商","做生意","电脑","AI","宠物","学技能","一个人安静","其他"],en:["Economy","Sports","Reading","Movie","Travel","Friendship","Singing","E-commerce","Business","Computer","AI","Pets","Learning Skills","Quiet time alone","Other"],ja:["経済","スポーツ","読書","映画","旅行","友達","カラオケ","EC","ビジネス","パソコン","AI","ペット","スキル学習","一人で静かに過ごす","その他"],ko:["경제","스포츠","독서","영화","여행","친구 사귀기","노래 부르기","전자상거래","사업","컴퓨터","AI","애완동물","기술 배우기","혼자 조용히 있기","기타"],th:["เศรษฐกิจ","กีฬา","การอ่าน","ภาพยนตร์","การเดินทาง","มิตรภาพ","การร้องเพลง","อีคอมเมิร์ซ","ธุรกิจ","คอมพิวเตอร์","AI","สัตว์เลี้ยง","การเรียนรู้ทักษะ","เวลาเงียบๆคนเดียว","อื่นๆ"],vi:["Kinh tế","Thể thao","Đọc sách","Phim ảnh","Du lịch","Tình bạn","Ca hát","Thương mại điện tử","Kinh doanh","Máy tính","AI","Thú cưng","Học kỹ năng","Ở một mình yên tĩnh","Khác"],ms:["Ekonomi","Sukan","Membaca","Filem","Melancong","Persahabatan","Menyanyi","E-dagang","Perniagaan","Komputer","AI","Haiwan Peliharaan","Belajar Kemahiran","Masa sunyi bersendirian","Lain-lain"],la:["Oeconomia","Ludi","Lectio","Pellicula","Iter","Amicitia","Cantus","E-commercium","Negotium","Computatrum","AI","Animalia Domestica","Discere Artes","Tempus quietum solus","Aliud"]},xI={"zh-TW":["台灣","中國大陸","日本","韓國","馬來西亞","新加坡","印尼","越南","菲律賓","英國","法國","德國","美國","加拿大","非洲","歐洲","南美洲","中東","其他"],"zh-CN":["台湾","中国大陆","日本","韩国","马来西亚","新加坡","印尼","越南","菲律宾","英国","法国","德国","美国","加拿大","非洲","欧洲","南美洲","中东","其他"],en:["Taiwan","China","Japan","Korea","Malaysia","Singapore","Indonesia","Vietnam","Philippines","UK","France","Germany","USA","Canada","Africa","Europe","South America","Middle East","Other"],ja:["台湾","中国","日本","韓国","マレーシア","シンガポール","インドネシア","ベトナム","フィリピン","イギリス","フランス","ドイツ","アメリカ","カナダ","アフリカ","ヨーロッパ","南アメリカ","中東","その他"],ko:["대만","중국","일본","한국","말레이시아","싱가포르","인도네시아","베트남","필리핀","영국","프랑스","독일","미국","캐나다","아프리카","유럽","남아메리카","중동","기타"],th:["ไต้หวัน","จีน","ญี่ปุ่น","เกาหลี","มาเลเซีย","สิงคโปร์","อินโดนีเซีย","เวียดนาม","ฟิลิปปินส์","สหราชอาณาจักร","ฝรั่งเศส","เยอรมนี","สหรัฐอเมริกา","แคนาดา","แอฟริกา","ยุโรป","อเมริกาใต้","ตะวันออกกลาง","อื่นๆ"],vi:["Đài Loan","Trung Quốc","Nhật Bản","Hàn Quốc","Malaysia","Singapore","Indonesia","Việt Nam","Philippines","Anh","Pháp","Đức","Mỹ","Canada","Châu Phi","Châu Âu","Nam Mỹ","Trung Đông","Khác"],ms:["Taiwan","China","Jepun","Korea","Malaysia","Singapura","Indonesia","Vietnam","Filipina","UK","Perancis","Jerman","AS","Kanada","Afrika","Eropah","Amerika Selatan","Timur Tengah","Lain-lain"],la:["Taivania","Sina","Iaponia","Corea","Malaisia","Singapura","Indonesia","Vietnamia","Philippinae","UK","Gallia","Germania","USA","Canada","Africa","Europa","America Meridionalis","Oriens Medius","Aliud"]},bI={"zh-TW":["經濟事件","毒品濫用","暴力事件","家暴加害","家暴受害","幫派背景","詐欺相關","竊盜前科","性別/身體創傷","未成年犯罪","長期失業 / 社會邊緣","其他"],"zh-CN":["经济事件","毒品滥用","暴力事件","家暴加害","家暴受害","帮派背景","诈欺相关","窃盗前科","性别/身体创伤","未成年犯罪","长期失业 / 社会边缘","其他"],en:["Economic Incident","Drug Abuse","Violent Incident","Domestic Violence Perpetrator","Domestic Violence Victim","Gang Affiliation","Fraud-related","Theft Record","Gender/Physical Trauma","Juvenile Delinquency","Long-term Unemployed / Socially Marginalized","Other"],ja:["経済事件","薬物乱用","暴力事件","DV加害","DV被害","ギャング組織所属","詐欺関連","窃盗前科","ジェンダー・身体的トラウマ","未成年犯罪","長期失業・社会的疎外","その他"],ko:["경제 사건","약물 남용","폭력 사건","가정 폭력 가해자","가정 폭력 피해자","조직 폭력배 배경","사기 관련","절도 전과","성별/신체적 트라우마","미성년 범죄","장기 실업/사회적 소외","기타"],th:["เหตุการณ์ทางเศรษฐกิจ","การใช้ยาเสพติด","เหตุการณ์รุนแรง","ผู้กระทำความรุนแรงในครอบครัว","เหยื่อความรุนแรงในครอบครัว","ประวัติแก๊ง","เกี่ยวข้องกับการฉ้อโกง","ประวัติการลักขโมย","การบาดเจ็บทางเพศ/ร่างกาย","การกระทำผิดของเยาวชน","ว่างงานระยะยาว / ถูกกีดกันทางสังคม","อื่นๆ"],vi:["Sự cố kinh tế","Lạm dụng ma túy","Vụ việc bạo lực","Thủ phạm bạo lực gia đình","Nạn nhân bạo lực gia đình","Lý lịch băng đảng","Liên quan đến gian lận","Tiền án trộm cắp","Tổn thương giới tính/thể chất","Phạm pháp vị thành niên","Thất nghiệp dài hạn / Bên lề xã hội","Khác"],ms:["Insiden Ekonomi","Penyalahgunaan Dadah","Insiden Keganasan","Pelaku Keganasan Rumah Tangga","Mangsa Keganasan Rumah Tangga","Latar Belakang Geng","Berkaitan Penipuan","Rekod Curi","Trauma Jantina/Fizikal","Kenakalan Remaja","Pengangguran Jangka Panjang / Terpinggir Sosial","Lain-lain"],la:["Casus Oeconomicus","Abusus Medicamentorum","Casus violentus","Perpetrator Violentiae Domesticae","Victima Violentiae Domesticae","Consociatio Gregis","Ad Fraudem Pertinens","Furtum Record","Trauma Genus/Corporale","Delinquentia Iuvenilis","Longum Tempus Inops / Socialiter Marginatus","Aliud"]},bD={"zh-TW":["人際","鬥志","習慣","工作","情緒","自律","其他"],"zh-CN":["人际","斗志","习惯","工作","情绪","自律","其他"],en:["Interpersonal","Motivation","Habits","Work","Emotions","Self-discipline","Other"],ja:["人間関係","闘志","習慣","仕事","感情","自己規律","その他"],ko:["대인관계","투지","습관","업무","감정","자기관리","기타"],th:["ความสัมพันธ์ระหว่างบุคคล","แรงจูงใจ","นิสัย","การงาน","อารมณ์","การมีวินัยในตนเอง","อื่นๆ"],vi:["Quan hệ giữa các cá nhân","Ý chí chiến đấu","Thói quen","Công việc","Cảm xúc","Kỷ luật tự giác","Khác"],ms:["Antara peribadi","Semangat juang","Tabiat","Kerja","Emosi","Disiplin diri","Lain-lain"],la:["Interpersonalis","Animus","Consuetudines","Opus","Affectus","Disciplina sui","Aliud"]},vI=["18-24","25-29","30-34","35-39","40-44","45-49","50-54","55-59","60-64","65-69","70+"];function vD(n){return/^[^@\s]+@[^@\s]+\.[^@\s]+$/.test(n)}function wD(n){return/^(?=.*[A-Za-z])(?=.*\d)[A-Za-z\d]{8,}$/.test(n)}function OS(n){return!(!/^[A-Za-z0-9_]{6,16}$/.test(n)||!/[A-Za-z]/.test(n)||!/[0-9]/.test(n))}function VS(n){if(!n)return null;const e=n.match(/^(Restarter™)(.*)$/);return e?i.jsxs("span",{children:[i.jsx("span",{style:{color:"#fff",fontWeight:700},children:"Restarter™"}),i.jsx("span",{style:{color:"#ffd700",fontWeight:700},children:e[2]})]}):n}function SD({t:n,setShowLogin:e,navigate:t,setShowReset:r}){const[s,a]=w.useState(""),[c,d]=w.useState(""),[h,m]=w.useState(""),g=async x=>{x.preventDefault(),m("");try{await(await aj(Bu,s,c)).user.reload(),e(!1),t("/")}catch(S){S.code==="auth/user-not-found"||S.code==="auth/wrong-password"||S.code==="auth/invalid-credential"?m("帳號或密碼錯誤，請重新確認"):S.code==="auth/user-disabled"?m("此帳號已被停用，請聯絡客服"):m(S.message||"登入失敗，請稍後再試")}};return i.jsx("div",{style:{position:"fixed",top:0,left:0,width:"100%",height:"100%",background:"rgba(0,0,0,0.6)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:200},children:i.jsxs("div",{style:{background:"white",padding:32,borderRadius:16,width:"90%",maxWidth:400,position:"relative",boxShadow:"0 8px 32px #0000004d"},children:[i.jsx("button",{onClick:()=>e(!1),style:{position:"absolute",top:8,right:12,background:"none",border:"none",fontSize:28,cursor:"pointer",color:"#888"},children:"×"}),i.jsx("h2",{style:{textAlign:"center",color:"#333",marginBottom:24},children:n.login}),h&&i.jsx("p",{style:{color:"red",textAlign:"center",marginBottom:"1rem"},children:h}),i.jsxs("form",{onSubmit:g,children:[i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:16},children:[i.jsx("input",{type:"email",autoComplete:"off",placeholder:n.email,value:s,onChange:x=>a(x.target.value),className:"reg-input",required:!0}),i.jsx("input",{type:"password",autoComplete:"off",placeholder:n.password,value:c,onChange:x=>d(x.target.value),className:"reg-input",required:!0})]}),i.jsx("button",{type:"submit",style:{width:"100%",marginTop:24,background:"linear-gradient(90deg, #6e8efb, #a777e3)",color:"white",border:"none",borderRadius:8,padding:"14px 0",fontSize:18,fontWeight:700,cursor:"pointer"},children:n.login}),i.jsx("div",{style:{textAlign:"right",marginTop:8},children:i.jsx("a",{href:"#",style:{color:"#6B5BFF",fontSize:14,textDecoration:"underline",cursor:"pointer"},onClick:x=>{x.preventDefault(),r(!0)},children:"忘記密碼？"})})]})]})})}const up={border:"none",borderRadius:28,padding:0,fontSize:16,fontWeight:800,cursor:"pointer",boxShadow:"0 2px 12px #a777e355",display:"flex",alignItems:"center",justifyContent:"center",gap:8,width:"100%",height:"40px"},WS={width:18,height:18,marginRight:6,verticalAlign:"middle"};function kD(){const n=wt(),e=pf(),t=new URLSearchParams(e.search),{lang:r,setLang:s}=Bt();w.useEffect(()=>{localStorage.setItem("lang",r)},[r]),w.useEffect(()=>{cd(async()=>{const{getAuth:U}=await Promise.resolve().then(()=>sN);return{getAuth:U}},void 0).then(({getAuth:U})=>{U().currentUser&&n("/")})},[n]);const a=t.get("needProfile")==="1",c=gD[r],[d,h]=w.useState(""),[m,g]=w.useState(""),[x,S]=w.useState(""),[I,_]=w.useState(""),[R,T]=w.useState(""),[A,D]=w.useState(""),[F,X]=w.useState(""),[ie,G]=w.useState(null),[N,E]=w.useState(""),[P,M]=w.useState(""),[O,z]=w.useState(!1),[j,K]=w.useState(""),[Z,Y]=w.useState(""),[ae,se]=w.useState(""),[re,ne]=w.useState(!1),[W,$]=w.useState(0),[ee,he]=w.useState("idle"),[_e,ve]=w.useState(""),Le=w.useRef(null),Ne=w.useRef(null);w.useEffect(()=>{if(!O)return;const U=setInterval(()=>{$(V=>(V+1)%4)},400);return()=>clearInterval(U)},[O]);const[nt,Je]=w.useState(!1),ge=async U=>{var L,oe,H;U.preventDefault(),M(""),Je(!1);let V=setTimeout(()=>Je(!0),1e4);if(!ie){M(c.errorAvatar);return}if(!F){M(c.errorGender);return}if(!vD(d)){M(c.errorEmailFormat);return}if(!wD(m)){M(c.errorPasswordFormat);return}if(!OS(x)){M(c.errorNicknameFormat);return}if(!A){M(c.errorAgeFormat);return}if(!I){M(c.errorCountry);return}z(!0);try{const J=await oj(Bu,d,m);await qy(J.user,{displayName:x});let be="";if(ie){const Me=gz(Sz,`avatars/${J.user.uid}/${ie.name}`),$e=fz(Me,ie);let Ze=null;await Promise.race([new Promise((Ke,Et)=>{$e.on("state_changed",null,Ot=>{Ze=Ot,Et(Ot)},async()=>{be=await mz($e.snapshot.ref),Ke()})}),new Promise((Ke,Et)=>setTimeout(()=>{Ze=new Error("頭像上傳逾時，請檢查網路或稍後再試"),Et(Ze)},2e4))]).catch(Ke=>{throw Ze||Ke}),await qy(J.user,{photoURL:be})}await Vf(Gn(Ft,"profiles",J.user.uid),{nickname:x,email:d,avatar:be,gender:F,country:I,region:R,age:A,interest:j,eventType:Z,improvement:ae,createdAt:new Date,updatedAt:new Date}),localStorage.removeItem("aiAvatar"),localStorage.removeItem("avatarWelcomed"),z(!1),clearTimeout(V),Je(!1),n("/")}catch(J){(L=J==null?void 0:J.message)!=null&&L.includes("Failed to fetch")||(oe=J==null?void 0:J.message)!=null&&oe.includes("NetworkError")||(H=J==null?void 0:J.message)!=null&&H.includes("ECONNREFUSED")?M("伺服器連線失敗，請稍後再試或聯絡管理員"):M((J==null?void 0:J.message)||"註冊失敗，請稍後再試"),z(!1),clearTimeout(V),Je(!1)}},De=async()=>{const U=new Bi;try{z(!0),Je(!1);let V=setTimeout(()=>Je(!0),1e4);const L=await $y(Bu,U);clearTimeout(V),Je(!1),z(!1),n("/")}catch(V){z(!1),Je(!1),alert("Google 登入失敗："+V.message)}},tt=async()=>{var V;const U=new Kl("apple.com");try{console.log("開始 Apple 登入...");const oe=(await $y(Bu,U)).user;console.log("Apple 登入成功，user.uid:",oe.uid),await oe.reload(),console.log("user reload 完成");const H=await Io(Gn(Ft,"users",oe.uid));console.log("Firestore 查詢結果:",{exists:H.exists(),data:H.data(),completed:(V=H.data())==null?void 0:V.completed}),!H.exists()||!H.data()||!H.data().completed?(console.log("導向 /CompleteProfile"),n("/CompleteProfile")):(console.log("導向首頁 /"),n("/"))}catch(L){console.error("Apple 登入錯誤:",L),alert("Apple 登入失敗："+L.message)}};async function Ye(){if(!OS(x)){he("invalid"),ve("❌你的輸入不符合格式，請重新輸入（6-16位，必須有英文和數字）"),setTimeout(()=>{var U;(U=Le.current)==null||U.focus()},100);return}he("checking"),ve("檢查中...");try{(await(await fetch(`/api/check-username?name=${encodeURIComponent(x)}`)).json()).exists?(he("exists"),ve("❌你輸入名稱已有人使用，請重新輸入"),setTimeout(()=>{var L;(L=Le.current)==null||L.focus()},100)):(he("ok"),ve("你的名稱非常好👍"),setTimeout(()=>{var L;(L=Ne.current)==null||L.focus()},200))}catch{he("ok"),ve("無法即時檢查名稱是否重複，請直接送出註冊，若重複會有明確錯誤提示"),setTimeout(()=>{var U;(U=Le.current)==null||U.focus()},100)}}e.pathname;const[We,pe]=w.useState(!1),[Se,we]=w.useState(""),[Re,Ce]=w.useState("");return i.jsxs("div",{style:{minHeight:"100vh",background:"#fff",position:"relative"},children:[a&&i.jsx("div",{style:{position:"absolute",top:"40%",left:"50%",transform:"translate(-50%, -50%)",fontSize:22,color:"#374151",fontWeight:600,textAlign:"center"},children:MS[r]||MS["zh-TW"]}),i.jsx("div",{style:{position:"relative"},children:i.jsxs("div",{style:{minHeight:"100vh",background:"url('/city-blur.jpg') center/cover no-repeat",position:"relative",display:"flex",flexDirection:"column"},children:[window.innerWidth<=768?i.jsxs(i.Fragment,{children:[i.jsxs("button",{onClick:()=>window.history.back(),style:{position:"fixed",top:16,left:16,zIndex:1e3,background:"rgba(255,255,255,0.9)",border:"none",borderRadius:"20px",padding:"8px 16px",fontSize:"14px",fontWeight:"bold",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",color:"#667eea",transition:"all 0.3s ease",boxShadow:"0 2px 8px rgba(0,0,0,0.15)",height:"36px"},onMouseEnter:U=>{U.currentTarget.style.background="#667eea",U.currentTarget.style.color="#fff",U.currentTarget.style.transform="translateY(-1px)"},onMouseLeave:U=>{U.currentTarget.style.background="rgba(255,255,255,0.9)",U.currentTarget.style.color="#667eea",U.currentTarget.style.transform="translateY(0)"},children:["← ",r==="zh-TW"||r==="zh-CN"?"返回":r==="en"?"Back":r==="ja"?"戻る":r==="ko"?"돌아가기":r==="vi"?"Quay Lại":r==="th"?"กลับ":r==="la"?"Regredi":r==="ms"?"Kembali":"Back"]}),i.jsx("div",{style:{position:"fixed",top:16,right:16,zIndex:100},children:i.jsx(Mn,{})}),i.jsx("div",{style:{position:"fixed",top:60,left:"50%",transform:"translateX(-50%)",zIndex:100},children:i.jsx("span",{style:{fontWeight:900,fontSize:18,color:"#ffd700",letterSpacing:1,textShadow:"0 2px 8px #23294688",whiteSpace:"nowrap",textAlign:"left",lineHeight:"1.2",marginLeft:"8px"},children:LS[r]})})]}):i.jsxs(i.Fragment,{children:[i.jsxs("button",{onClick:()=>window.history.back(),style:{position:"fixed",top:24,left:24,zIndex:1e3,background:"rgba(255,255,255,0.9)",border:"none",borderRadius:"25px",padding:"8px 16px",fontSize:"14px",fontWeight:"bold",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",color:"#667eea",transition:"all 0.3s ease",boxShadow:"0 4px 12px rgba(0,0,0,0.15)"},onMouseEnter:U=>{U.currentTarget.style.background="#667eea",U.currentTarget.style.color="#fff",U.currentTarget.style.transform="translateY(-2px)"},onMouseLeave:U=>{U.currentTarget.style.background="rgba(255,255,255,0.9)",U.currentTarget.style.color="#667eea",U.currentTarget.style.transform="translateY(0)"},children:["← ",r==="zh-TW"||r==="zh-CN"?"返回":r==="en"?"Back":r==="ja"?"戻る":r==="ko"?"돌아가기":r==="vi"?"Quay Lại":r==="th"?"กลับ":r==="la"?"Regredi":r==="ms"?"Kembali":"Back"]}),i.jsx("div",{style:{position:"fixed",top:24,left:"50%",transform:"translateX(-50%)",zIndex:100},children:i.jsx("span",{style:{fontWeight:900,fontSize:24,color:"#ffd700",letterSpacing:2,textShadow:"0 2px 8px #23294688",whiteSpace:"nowrap",textAlign:"left",marginLeft:"12px"},children:LS[r]})}),i.jsx("div",{style:{position:"fixed",top:24,right:36,zIndex:100},children:i.jsx(Mn,{})})]}),i.jsxs("div",{style:{display:"flex",flex:1,minHeight:"100vh",alignItems:"stretch",justifyContent:"center",width:"100%",marginTop:60,flexDirection:window.innerWidth<=768?"column":"row"},children:[i.jsxs("div",{style:{flex:1,display:window.innerWidth<=768?"none":"flex",flexDirection:"column",alignItems:"center",background:"rgba(60,40,20,0.18)",padding:"0 12px",minHeight:"calc(100vh - 60px)",boxSizing:"border-box",justifyContent:"space-between"},children:[i.jsx("div",{style:{position:"relative",width:"100%",textAlign:"center",paddingTop:78},children:i.jsx("div",{style:{fontSize:18,fontWeight:700,textShadow:"0 2px 8px #23294688"},children:VS(yD[r])})}),i.jsx("img",{src:"/left-hero.png",alt:"left hero",style:{width:300,maxWidth:"98%",objectFit:"contain"}}),i.jsxs("div",{style:{paddingBottom:80,textAlign:"center"},children:[i.jsxs("div",{style:{color:"#fff",fontWeight:700,fontSize:22,margin:"12px 0 8px"},children:[c.heroLeftTop,i.jsx("br",{}),c.heroLeftMain,i.jsx("br",{}),c.heroLeftSub]}),i.jsx("div",{style:{color:"#ffd700",fontWeight:700,fontSize:18},children:c.heroLeftYellow})]})]}),re&&i.jsx(SD,{t:c,setShowLogin:ne,navigate:n,setShowReset:pe}),i.jsx("div",{style:{flex:window.innerWidth<=768?"1":"0 1 500px",display:"flex",justifyContent:"center",alignItems:"center",padding:window.innerWidth<=768?"10px":"20px 0",width:window.innerWidth<=768?"100%":"auto"},children:i.jsxs("form",{onSubmit:ge,style:{background:"#ffffffcc",borderRadius:20,padding:window.innerWidth<=768?"20px 16px":"24px 32px",width:"100%",maxWidth:window.innerWidth<=768?"100%":500,boxShadow:"0 8px 32px #0000004d",position:"relative",boxSizing:"border-box",margin:window.innerWidth<=768?"0 10px":"0"},children:[i.jsx("img",{src:"/ctx-logo.png",alt:"Logo",style:{width:window.innerWidth<=768?60:100,height:window.innerWidth<=768?60:100,position:"absolute",top:5,left:5,zIndex:0,opacity:1}}),i.jsxs("div",{style:{position:"relative",zIndex:1},children:[i.jsx("div",{style:{width:"100%",textAlign:"center",fontWeight:900,fontSize:window.innerWidth<=768?20:26,color:"#ffd700",marginBottom:8,textShadow:"0 2px 4px #00000055"},children:c.formTopSlogan}),i.jsx("h2",{style:{textAlign:"center",color:"#333",marginBottom:16,fontSize:window.innerWidth<=768?24:28,fontWeight:800},children:c.title}),P&&i.jsx("p",{style:{color:"red",textAlign:"center",marginBottom:"1rem"},children:P}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:window.innerWidth<=768?"1fr":"1fr 1fr",gap:window.innerWidth<=768?"12px":"12px 16px",width:"100%",minWidth:0},children:[i.jsx("input",{type:"email",autoComplete:"off",placeholder:c.email,value:d,onChange:U=>h(U.target.value),style:{gridColumn:"1 / -1",width:"100%",minWidth:0,maxWidth:"100%",boxSizing:"border-box",overflow:"hidden"},className:"reg-input",required:!0}),i.jsx("input",{type:"password",autoComplete:"off",placeholder:c.password,value:m,onChange:U=>g(U.target.value),style:{gridColumn:"1 / -1",width:"100%",minWidth:0,maxWidth:"100%",boxSizing:"border-box",overflow:"hidden"},className:"reg-input",required:!0}),i.jsx("input",{type:"text",autoComplete:"off",placeholder:c.nickname,value:x,onChange:U=>{S(U.target.value),he("idle"),ve("")},onBlur:Ye,className:"reg-input",style:{width:"100%",minWidth:0,maxWidth:"100%",boxSizing:"border-box",overflow:"hidden",color:"#888"},required:!0,ref:Le}),_e&&i.jsx("div",{style:{gridColumn:"1 / -1",color:ee==="ok"?"#1a7f1a":ee==="invalid"||ee==="exists"?"red":"#333",fontSize:14,marginTop:-8,marginBottom:4},children:_e}),i.jsxs("select",{value:A,onChange:U=>D(U.target.value),className:"reg-input",style:{width:"100%",minWidth:0,maxWidth:"100%",boxSizing:"border-box",overflow:"hidden",color:A?"#333":"#888"},required:!0,children:[i.jsx("option",{value:"",style:{color:"#888"},children:c.selectAge}),vI.map(U=>i.jsx("option",{value:U,children:U},U))]}),i.jsxs("select",{value:I,onChange:U=>_(U.target.value),className:"reg-input",style:{width:"100%",minWidth:0,maxWidth:"100%",boxSizing:"border-box",overflow:"hidden",color:I?"#333":"#888"},required:!0,children:[i.jsx("option",{value:"",style:{color:"#888"},children:c.country}),(xI[r]||[]).map(U=>i.jsx("option",{value:U,children:U},U))]}),i.jsx("input",{type:"text",placeholder:c.city,value:R,onChange:U=>T(U.target.value),className:"reg-input",style:{width:"100%",minWidth:0,maxWidth:"100%",boxSizing:"border-box",overflow:"hidden"}}),i.jsxs("select",{value:j,onChange:U=>K(U.target.value),className:"reg-input",style:{width:"100%",minWidth:0,maxWidth:"100%",boxSizing:"border-box",overflow:"hidden",color:j?"#333":"#888"},children:[i.jsx("option",{value:"",style:{color:"#888"},children:c.interest}),(yI[r]||[]).map(U=>i.jsx("option",{value:U,children:U},U))]}),i.jsxs("select",{value:Z,onChange:U=>Y(U.target.value),className:"reg-input",style:{width:"100%",minWidth:0,maxWidth:"100%",boxSizing:"border-box",overflow:"hidden",color:Z?"#333":"#888"},children:[i.jsx("option",{value:"",style:{color:"#888"},children:c.eventType}),(bI[r]||[]).map(U=>i.jsx("option",{value:U,children:U},U))]}),i.jsxs("select",{value:ae,onChange:U=>se(U.target.value),className:"reg-input",style:{gridColumn:"1 / -1",width:"100%",minWidth:0,maxWidth:"100%",boxSizing:"border-box",overflow:"hidden",color:ae?"#333":"#888"},children:[i.jsx("option",{value:"",style:{color:"#888"},children:c.whatToImprove}),(bD[r]||[]).map(U=>i.jsx("option",{value:U,children:U},U))]}),i.jsx("div",{style:{gridColumn:"1 / -1",display:"flex",flexDirection:"column",alignItems:"center",marginBottom:8},children:i.jsxs("label",{htmlFor:"avatar-upload",style:{cursor:"pointer",display:"flex",flexDirection:"column",alignItems:"center",gap:4},children:[i.jsx("div",{style:{width:64,height:64,borderRadius:"50%",overflow:"hidden",background:"#eee",border:"2px solid #b6b6f6",marginBottom:4},children:N?i.jsx("img",{src:N,alt:"avatar",style:{width:"100%",height:"100%",objectFit:"cover"}}):i.jsx("span",{style:{display:"flex",width:"100%",height:"100%",alignItems:"center",justifyContent:"center",color:"#bbb",fontSize:32},children:"+"})}),i.jsx("span",{style:{color:"#6B5BFF",fontWeight:700,fontSize:15},children:c.uploadAvatar}),i.jsx("input",{id:"avatar-upload",type:"file",accept:"image/*",style:{display:"none"},onChange:U=>{if(U.target.files&&U.target.files[0]){G(U.target.files[0]);const V=new FileReader;V.onload=L=>{var oe;return E((oe=L.target)==null?void 0:oe.result)},V.readAsDataURL(U.target.files[0])}}})]})}),i.jsxs("div",{style:{gridColumn:"1 / -1",display:"flex",alignItems:"center",gap:18,justifyContent:"center",marginBottom:8},children:[i.jsx("span",{style:{fontWeight:600,color:"#6B5BFF",fontSize:15},children:c.genderRequired}),i.jsxs("label",{style:{display:"flex",alignItems:"center",gap:4},children:[i.jsx("input",{type:"radio",name:"gender",value:"male",checked:F==="male",onChange:()=>X("male"),required:!0}),i.jsx("span",{children:c.male})]}),i.jsxs("label",{style:{display:"flex",alignItems:"center",gap:4},children:[i.jsx("input",{type:"radio",name:"gender",value:"female",checked:F==="female",onChange:()=>X("female"),required:!0}),i.jsx("span",{children:c.female})]})]})]}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:window.innerWidth<=768?"1fr":"1fr 1fr",gap:8,margin:"16px 0 8px 0"},children:[i.jsxs("button",{type:"submit",disabled:O,style:{...up,background:"linear-gradient(90deg, #6e8efb, #a777e3)",color:"white",opacity:O?.6:1,cursor:O?"not-allowed":"pointer"},children:[O?i.jsxs("span",{style:{display:"flex",alignItems:"center",justifyContent:"center",fontWeight:700,fontSize:18},children:[c.registering,".".repeat(W+1)]}):i.jsx("span",{style:{marginRight:10},children:"🚀"}),!O&&c.register]}),i.jsxs("button",{type:"button",onClick:()=>ne(!0),disabled:O,style:{...up,background:"linear-gradient(90deg, #89f7fe, #66a6ff)",color:"white",opacity:O?.6:1,cursor:O?"not-allowed":"pointer"},children:[i.jsx("span",{style:{marginRight:10},children:"🔑"}),c.login]}),i.jsxs("button",{type:"button",onClick:De,disabled:O,style:{...up,background:"#fff",color:"#333",opacity:O?.6:1,cursor:O?"not-allowed":"pointer"},children:[i.jsx("img",{src:"https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg",alt:"Google",style:WS}),c.googleLogin]}),i.jsxs("button",{type:"button",onClick:tt,disabled:O,style:{...up,background:"#000",color:"#fff",opacity:O?.6:1,cursor:O?"not-allowed":"pointer"},children:[i.jsx("img",{src:"https://upload.wikimedia.org/wikipedia/commons/f/fa/Apple_logo_black.svg",alt:"Apple",style:{...WS,filter:"invert(1)"}}),c.appleLogin]})]}),i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:24,gap:8,flexDirection:"row",textAlign:"center",fontSize:12,flexWrap:"nowrap",overflow:"hidden"},children:[i.jsx("a",{href:"/privacy-policy",style:{color:"#6B5BFF",textDecoration:"underline",fontSize:12,flex:1,textAlign:"center",whiteSpace:"nowrap"},children:c.privacy||"隱私權政策"}),i.jsx("span",{style:{color:"#666",fontSize:12},children:"/"}),i.jsx("button",{type:"button",onClick:()=>n("/terms"),style:{background:"none",border:"none",color:"#666",textDecoration:"underline",cursor:"pointer",fontSize:12,flex:1,textAlign:"center",whiteSpace:"nowrap"},children:c.terms}),i.jsx("span",{style:{color:"#666",fontSize:12},children:"/"}),i.jsx("a",{href:"/data-deletion",style:{color:"#6B5BFF",textDecoration:"underline",fontSize:12,flex:1,textAlign:"center",whiteSpace:"nowrap"},children:c.deletion||"資料刪除說明"})]})]})]})}),i.jsxs("div",{style:{flex:1,display:window.innerWidth<=768?"none":"flex",flexDirection:"column",alignItems:"center",background:"rgba(60,40,20,0.18)",padding:"0 12px",minHeight:"calc(100vh - 60px)",boxSizing:"border-box",justifyContent:"space-between"},children:[i.jsx("div",{style:{position:"relative",width:"100%",textAlign:"center",paddingTop:78},children:i.jsx("div",{style:{fontSize:18,fontWeight:700,textShadow:"0 2px 8px #23294688"},children:VS(xD[r])})}),i.jsx("img",{src:"/right-hero.png",alt:"right hero",style:{width:280,maxWidth:"98%",objectFit:"contain"}}),i.jsxs("div",{style:{paddingBottom:80,textAlign:"center"},children:[i.jsx("div",{style:{color:"#fff",fontWeight:700,fontSize:22,margin:"12px 0 8px"},children:c.heroRightMain}),i.jsx("div",{style:{color:"#ffd700",fontWeight:700,fontSize:18},children:c.heroRightYellow})]})]})]}),i.jsx("div",{style:{position:"fixed",bottom:10,left:36,color:"#fff",textShadow:"0 1px 2px #000",fontSize:14,zIndex:10},children:"CTX Goodlife Copyright 2025"})]})}),We&&i.jsx("div",{style:{position:"fixed",left:0,top:0,width:"100vw",height:"100vh",background:"rgba(40,40,80,0.18)",zIndex:1e4,display:"flex",alignItems:"center",justifyContent:"center"},children:i.jsxs("div",{style:{background:"#fff",borderRadius:18,boxShadow:"0 4px 24px #6B5BFF33",padding:28,minWidth:280,maxWidth:340,width:"90vw",position:"relative",display:"flex",flexDirection:"column",gap:12},children:[i.jsx("button",{type:"button",onClick:()=>pe(!1),style:{position:"absolute",top:10,right:12,background:"none",border:"none",fontSize:22,color:"#888",cursor:"pointer",fontWeight:700},children:"×"}),i.jsx("div",{style:{fontWeight:800,fontSize:18,color:"#6B5BFF",textAlign:"center",marginBottom:2},children:"重設密碼"}),i.jsx("input",{type:"email",value:Se,onChange:U=>we(U.target.value),placeholder:"請輸入註冊時的 email",style:{border:"1px solid #e0e7ff",borderRadius:8,padding:"6px 10px",fontSize:15}}),i.jsx("button",{onClick:async()=>{Ce("");try{await sj(Bu,Se),Ce("已寄出密碼重設信，請到信箱收信！")}catch{Ce("發送失敗，請確認 email 是否正確")}},style:{background:"linear-gradient(90deg, #6e8efb, #a777e3)",color:"#fff",border:"none",borderRadius:14,padding:"6px 18px",fontWeight:700,fontSize:15,cursor:"pointer",alignSelf:"center"},children:"發送重設信"}),Re&&i.jsx("div",{style:{color:"#6B5BFF",fontWeight:700,textAlign:"center",marginTop:8},children:Re})]})}),nt&&i.jsx("div",{style:{color:"#ff9800",textAlign:"center",marginTop:8,fontWeight:600},children:"網路較慢，請耐心等候..."})]})}const ju={"zh-TW":{back:"← 返回上一頁",title:"我的連結",chat:"進入聊天",task:"共修任務",noLink:"目前沒有已建立的連結",goal:"目標："},"zh-CN":{back:"← 返回上一页",title:"我的连接",chat:"进入聊天",task:"共修任务",noLink:"目前没有已建立的连接",goal:"目标："},en:{back:"← Back",title:"My Links",chat:"Chat",task:"Co-Task",noLink:"No links established",goal:"Goal: "},ja:{back:"← 前のページへ",title:"私のリンク",chat:"チャットへ",task:"共修タスク",noLink:"まだリンクがありません",goal:"目標："},ko:{back:"← 이전 페이지",title:"내 링크",chat:"채팅하기",task:"공동 작업",noLink:"아직 연결된 링크가 없습니다",goal:"목표: "},th:{back:"← กลับ",title:"ลิงก์ของฉัน",chat:"แชท",task:"งานร่วมกัน",noLink:"ยังไม่มีลิงก์ที่สร้างขึ้น",goal:"เป้าหมาย: "},vi:{back:"← Quay lại",title:"Liên kết của tôi",chat:"Trò chuyện",task:"Nhiệm vụ chung",noLink:"Chưa có liên kết nào",goal:"Mục tiêu: "},ms:{back:"← Kembali",title:"Pautan Saya",chat:"Sembang",task:"Tugas Bersama",noLink:"Belum ada pautan yang dibuat",goal:"Matlamat: "},la:{back:"← Redire",title:"Nexus Mei",chat:"Colloquium",task:"Munus Commune",noLink:"Nullae nexus constitutae",goal:"Propositum: "}},TD={"zh-TW":{connected:"已配對",pending:"等待對方回覆",rejected:"已拒絕"},"zh-CN":{connected:"已配对",pending:"等待对方回复",rejected:"已拒绝"},en:{connected:"Connected",pending:"Pending",rejected:"Rejected"},ja:{connected:"マッチ済み",pending:"返事待ち",rejected:"拒否されました"},ko:{connected:"연결됨",pending:"대기 중",rejected:"거절됨"},th:{connected:"เชื่อมต่อแล้ว",pending:"รอการตอบกลับ",rejected:"ถูกปฏิเสธ"},vi:{connected:"Đã kết nối",pending:"Đang chờ",rejected:"Đã bị từ chối"},ms:{connected:"Telah dihubungkan",pending:"Menunggu",rejected:"Ditolak"},la:{connected:"Coniunctus",pending:"Exspectans",rejected:"Reiectus"}},dp={"zh-TW":"解除連結","zh-CN":"解除连接",en:"Remove",ja:"リンク解除",ko:"연결 해제",th:"ยกเลิกการเชื่อมต่อ",vi:"Hủy liên kết",ms:"Buang Pautan",la:"Remove"},hp={"zh-TW":"取消邀請","zh-CN":"取消邀请",en:"Cancel Invite",ja:"招待をキャンセル",ko:"초대 취소",th:"ยกเลิกคำเชิญ",vi:"Hủy lời mời",ms:"Batal Jemputan",la:"Invitationem Remove"};function ex(n){const e=wt(),{lang:t,setLang:r}=Bt(),[s,a]=w.useState([]),[c,d]=w.useState(null),[h,m]=w.useState(!0),[g,x]=w.useState(null),[S,I]=w.useState(null),_=t;w.useEffect(()=>{const D=zo(ya,async F=>{F?(d(F),await R(F.uid)):e("/")});return()=>D()},[e]);const R=async D=>{try{m(!0);const F=kn(Ft,"links"),X=cr(F,Tn("user1Id","==",D)),ie=cr(F,Tn("user2Id","==",D)),[G,N]=await Promise.all([Dr(X),Dr(ie)]),E=[];G.forEach(P=>{const M=P.data();E.push({id:P.id,...M})}),N.forEach(P=>{const M=P.data();E.push({id:P.id,user1Id:M.user2Id,user1Name:M.user2Name,user2Id:M.user1Id,user2Name:M.user1Name,role:M.role,goal:M.goal,status:M.status,createdAt:M.createdAt})}),a(E),m(!1)}catch(F){console.error("Error loading links:",F),m(!1)}},T=async D=>{try{await Xp(Gn(Ft,"links",D)),x(null),alert(dp[_]+" 成功！")}catch(F){console.error("Error removing link:",F),alert("操作失敗")}},A=async D=>{try{await Xp(Gn(Ft,"links",D)),I(null),alert(hp[_]+" 成功！")}catch(F){console.error("Error canceling link:",F),alert("操作失敗")}};return h?i.jsx("div",{style:n.embedded?{width:"100%",background:"none",minHeight:"unset",boxShadow:"none",padding:0}:{background:"url('/green_hut.png') center center / cover no-repeat",minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center"},children:i.jsx("div",{style:{color:"#fff",fontSize:18},children:"載入中..."})}):i.jsxs("div",{style:n.embedded?{width:"100%",background:"none",minHeight:"unset",boxShadow:"none",padding:0}:{background:"url('/green_hut.png') center center / cover no-repeat",minHeight:"100vh",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",paddingTop:40},children:[!n.embedded&&i.jsx("button",{onClick:()=>e("/friend"),style:{position:"absolute",top:24,left:24,zIndex:10,background:"#fff",border:"1.5px solid #6B5BFF",color:"#6B5BFF",borderRadius:8,padding:"6px 18px",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:"0 2px 8px #0001"},children:ju[_].back}),!n.embedded&&i.jsx(Mn,{}),i.jsxs("div",{style:{maxWidth:500,margin:n.embedded?"0 auto":"40px auto",background:"#fff",borderRadius:16,boxShadow:n.embedded?"none":"0 2px 8px #0001",padding:32},children:[i.jsx("h2",{style:{fontWeight:700,fontSize:22,marginBottom:24},children:ju[_].title}),s.length===0&&i.jsx("div",{style:{color:"#888"},children:ju[_].noLink}),s.map(D=>i.jsxs("div",{style:{marginBottom:24,borderBottom:"1px solid #eee",paddingBottom:16,opacity:D.status==="rejected"?.5:1},children:[i.jsxs("div",{style:{fontWeight:600},children:[D.user2Name,"（",D.role,"）"]}),i.jsxs("div",{style:{color:"#666",margin:"8px 0"},children:[ju[_].goal,D.goal]}),i.jsx("div",{style:{color:D.status==="connected"?"#23c6e6":D.status==="pending"?"#e6b800":"#e4572e",fontWeight:700,marginBottom:8},children:TD[_][D.status]}),i.jsxs("div",{style:{display:"flex",gap:12},children:[D.status==="connected"&&i.jsx("button",{onClick:()=>e("/chatroom"),style:{background:"#8ec6f7",color:"#fff",border:"none",borderRadius:6,padding:"6px 18px",fontWeight:700,cursor:"pointer"},children:ju[_].chat}),D.status==="connected"&&i.jsx("button",{onClick:()=>x(D.id),style:{background:"#eee",color:"#888",border:"none",borderRadius:6,padding:"6px 18px",fontWeight:700,cursor:"pointer"},children:dp[_]}),D.status==="pending"&&i.jsx("button",{onClick:()=>I(D.id),style:{background:"#eee",color:"#888",border:"none",borderRadius:6,padding:"6px 18px",fontWeight:700,cursor:"pointer"},children:hp[_]})]})]},D.id))]}),g&&i.jsx("div",{style:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",background:"#0006",zIndex:9999,display:"flex",alignItems:"center",justifyContent:"center"},children:i.jsxs("div",{style:{background:"#fff",borderRadius:12,padding:32,boxShadow:"0 2px 16px #0002",minWidth:280},children:[i.jsx("div",{style:{fontWeight:700,fontSize:18,marginBottom:18},children:dp[_]}),i.jsxs("div",{style:{display:"flex",gap:16,justifyContent:"flex-end"},children:[i.jsx("button",{onClick:()=>x(null),style:{background:"#eee",color:"#888",border:"none",borderRadius:6,padding:"6px 18px",fontWeight:700,cursor:"pointer"},children:"取消"}),i.jsx("button",{onClick:()=>T(g),style:{background:"#e4572e",color:"#fff",border:"none",borderRadius:6,padding:"6px 18px",fontWeight:700,cursor:"pointer"},children:dp[_]})]})]})}),S&&i.jsx("div",{style:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",background:"#0006",zIndex:9999,display:"flex",alignItems:"center",justifyContent:"center"},children:i.jsxs("div",{style:{background:"#fff",borderRadius:12,padding:32,boxShadow:"0 2px 16px #0002",minWidth:280},children:[i.jsx("div",{style:{fontWeight:700,fontSize:18,marginBottom:18},children:hp[_]}),i.jsxs("div",{style:{display:"flex",gap:16,justifyContent:"flex-end"},children:[i.jsx("button",{onClick:()=>I(null),style:{background:"#eee",color:"#888",border:"none",borderRadius:6,padding:"6px 18px",fontWeight:700,cursor:"pointer"},children:"取消"}),i.jsx("button",{onClick:()=>A(S),style:{background:"#e4572e",color:"#fff",border:"none",borderRadius:6,padding:"6px 18px",fontWeight:700,cursor:"pointer"},children:hp[_]})]})]})})]})}const Ri={"zh-TW":{back:"← 返回上一頁",title:"邀請通知",accept:"接受",reject:"拒絕",noInvite:"目前沒有新的邀請",goal:"目標："},"zh-CN":{back:"← 返回上一页",title:"邀请通知",accept:"接受",reject:"拒绝",noInvite:"目前没有新的邀请",goal:"目标："},en:{back:"← Back",title:"Invitations",accept:"Accept",reject:"Reject",noInvite:"No new invitations",goal:"Goal: "},ja:{back:"← 前のページへ",title:"招待通知",accept:"承認",reject:"拒否",noInvite:"新しい招待はありません",goal:"目標："},ko:{back:"← 이전 페이지",title:"초대 알림",accept:"수락",reject:"거절",noInvite:"새 초대가 없습니다",goal:"목표: "},th:{back:"← กลับ",title:"การแจ้งเตือนคำเชิญ",accept:"ยอมรับ",reject:"ปฏิเสธ",noInvite:"ไม่มีคำเชิญใหม่",goal:"เป้าหมาย: "},vi:{back:"← Quay lại",title:"Thông báo mời",accept:"Chấp nhận",reject:"Từ chối",noInvite:"Không có lời mời mới",goal:"Mục tiêu: "},ms:{back:"← Kembali",title:"Notis Jemputan",accept:"Terima",reject:"Tolak",noInvite:"Tiada jemputan baru",goal:"Matlamat: "},la:{back:"← Redire",title:"Notitia Invitationis",accept:"Accipe",reject:"Reici",noInvite:"Nullae invitationes novae",goal:"Propositum: "}};function tx(n){const[e,t]=w.useState([]),{lang:r,setLang:s}=Bt(),[a,c]=w.useState(null),[d,h]=w.useState(!0),[m,g]=w.useState(null),x=wt();w.useEffect(()=>{let _;const R=zo(ya,async T=>{T?(c(T),_=await S(T.uid)):x("/")});return()=>{R(),_&&_()}},[x]);const S=async _=>{try{h(!0);const R=kn(Ft,"invites"),T=cr(R,Tn("toUserId","==",_),Tn("status","==","pending"));return g0(T,D=>{const F=[];D.forEach(X=>{F.push({id:X.id,...X.data()})}),t(F),h(!1)})}catch(R){console.error("Error loading invites:",R),h(!1);return}},I=async(_,R)=>{if(a)try{const T=Gn(Ft,"invites",_);if(R){await Yp(T,{status:"accepted"});const A=e.find(D=>D.id===_);A&&await go(kn(Ft,"links"),{user1Id:A.fromUserId,user1Name:A.fromUserName,user2Id:A.toUserId,user2Name:A.toUserName,role:A.role,goal:A.goal,status:"connected",createdAt:new Date}),g(Ri[r].accept+" 成功！"),setTimeout(()=>g(null),2e3)}else await Yp(T,{status:"rejected"}),g(Ri[r].reject+" 成功！"),setTimeout(()=>g(null),2e3)}catch(T){console.error("Error handling invite:",T),alert("操作失敗")}};return d?i.jsx("div",{style:n.embedded?{width:"100%",background:"none",minHeight:"unset",boxShadow:"none",padding:0}:{background:"url('/green_hut.png') center center / cover no-repeat",minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center"},children:i.jsx("div",{style:{color:"#fff",fontSize:18},children:"載入中..."})}):!d&&e.length===0?i.jsxs("div",{style:n.embedded?{width:"100%",background:"none",minHeight:"unset",boxShadow:"none",padding:0}:{background:"url('/green_hut.png') center center / cover no-repeat",minHeight:"100vh",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",paddingTop:40},children:[!n.embedded&&i.jsx("button",{onClick:()=>x("/friend"),style:{position:"absolute",top:24,left:24,zIndex:10,background:"#fff",border:"1.5px solid #6B5BFF",color:"#6B5BFF",borderRadius:8,padding:"6px 18px",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:"0 2px 8px #0001"},children:Ri[r].back}),i.jsx(Mn,{}),i.jsxs("div",{style:{maxWidth:500,margin:n.embedded?"0 auto":"40px auto",background:"#fff",borderRadius:16,boxShadow:n.embedded?"none":"0 2px 8px #0001",padding:32},children:[i.jsx("h2",{style:{fontWeight:700,fontSize:22,marginBottom:24},children:Ri[r].title}),i.jsx("div",{style:{color:"#888",textAlign:"center",fontSize:18},children:Ri[r].noInvite})]})]}):i.jsxs("div",{style:n.embedded?{width:"100%",background:"none",minHeight:"unset",boxShadow:"none",padding:0}:{background:"url('/green_hut.png') center center / cover no-repeat",minHeight:"100vh",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",paddingTop:40},children:[m&&i.jsx("div",{style:{position:"fixed",top:40,left:"50%",transform:"translateX(-50%)",background:"#fff",color:"#6B5BFF",fontWeight:700,fontSize:18,borderRadius:16,boxShadow:"0 4px 24px #6B5BFF22",padding:"18px 36px",zIndex:99999,textAlign:"center",letterSpacing:1},children:m}),!n.embedded&&i.jsx("button",{onClick:()=>x("/friend"),style:{position:"absolute",top:24,left:24,zIndex:10,background:"#fff",border:"1.5px solid #6B5BFF",color:"#6B5BFF",borderRadius:8,padding:"6px 18px",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:"0 2px 8px #0001"},children:Ri[r].back}),i.jsx(Mn,{}),i.jsxs("div",{style:{maxWidth:500,margin:n.embedded?"0 auto":"40px auto",background:"#fff",borderRadius:16,boxShadow:n.embedded?"none":"0 2px 8px #0001",padding:32},children:[i.jsx("h2",{style:{fontWeight:700,fontSize:22,marginBottom:24},children:Ri[r].title}),e.map(_=>i.jsxs("div",{style:{marginBottom:24,borderBottom:"1px solid #eee",paddingBottom:16},children:[i.jsxs("div",{style:{fontWeight:600},children:[_.fromUserName," 邀請你成為 ",_.role]}),i.jsxs("div",{style:{color:"#666",margin:"8px 0"},children:[Ri[r].goal,_.goal]}),i.jsx("button",{onClick:()=>I(_.id,!0),style:{marginRight:12,background:"#8ec6f7",color:"#fff",border:"none",borderRadius:6,padding:"6px 18px",fontWeight:700,cursor:"pointer"},children:Ri[r].accept}),i.jsx("button",{onClick:()=>I(_.id,!1),style:{background:"#eee",color:"#888",border:"none",borderRadius:6,padding:"6px 18px",fontWeight:700,cursor:"pointer"},children:Ri[r].reject})]},_.id))]})]})}const _t={backToHome:{"zh-TW":"← 返回","zh-CN":"← 返回",ja:"← 戻る",en:"← Back",ko:"← 뒤로",th:"← กลับ",vi:"← Quay lại",ms:"← Kembali",la:"← Redire"},logout:{"zh-TW":"登出","zh-CN":"登出",ja:"ログアウト",en:"Logout",ko:"로그아웃",th:"ออกจากระบบ",vi:"Đăng xuất",ms:"Log keluar",la:"Exire"},pageTitle:{"zh-TW":"【破繭重生】夥伴計畫","zh-CN":"【破茧重生】伙伴计划",ja:"【再出発】パートナー計画",en:"Project Butterfly",ko:"【새출발】 파트너 계획",th:"【เกิดใหม่】แผนพันธมิตร",vi:"【Tái sinh】Kế hoạch đối tác",ms:"【Lahir Semula】Rancangan Rakan Kongsi",la:"【Renascitur】Propositum Socius"},editProfile:{"zh-TW":"編輯我的檔案","zh-CN":"编辑我的档案",ja:"プロフィール編集",en:"Edit My Profile",ko:"내 프로필 편집",th:"แก้ไขโปรไฟล์ของฉัน",vi:"Chỉnh sửa hồ sơ của tôi",ms:"Sunting Profil Saya",la:"Meum Profilum Muta"},partnerRoleTitle:{"zh-TW":"我想尋找的夥伴角色","zh-CN":"我想寻找的伙伴角色",ja:"探している仲間",en:"I'm looking for a",ko:"찾고 있는 파트너 역할",th:"บทบาทพันธมิตรที่ฉันมองหา",vi:"Vai trò đối tác tôi đang tìm",ms:"Peranan Rakan Kongsi Yang Saya Cari",la:"Partem Socii Quam Quæro"},peer:{"zh-TW":"同行者","zh-CN":"同行者",ja:"同じ道の仲間",en:"Peer",ko:"동행자",th:"เพื่อนร่วมทาง",vi:"Bạn đồng hành",ms:"Rakan Sebaya",la:"Par"},mentor:{"zh-TW":"生命導師","zh-CN":"生命导师",ja:"人生の師",en:"Mentor",ko:"인생 멘토",th:"ที่ปรึกษาชีวิต",vi:"Người hướng dẫn",ms:"Mentor Kehidupan",la:"Mentor"},skillPartner:{"zh-TW":"技能夥伴","zh-CN":"技能伙伴",ja:"スキル仲間",en:"Skill Partner",ko:"기술 파트너",th:"พันธมิตรด้านทักษะ",vi:"Đối tác kỹ năng",ms:"Rakan Kemahiran",la:"Socius Peritiae"},mainGoalTitle:{"zh-TW":"我的主要目標","zh-CN":"我的主要目标",ja:"私の主な目標",en:"My Main Goal",ko:"나의 주요 목표",th:"เป้าหมายหลักของฉัน",vi:"Mục tiêu chính của tôi",ms:"Matlamat Utama Saya",la:"Meum Propositum Principale"},allGoals:{"zh-TW":"所有目標","zh-CN":"所有目标",ja:"すべての目標",en:"All Goals",ko:"모든 목표",th:"เป้าหมายทั้งหมด",vi:"Tất cả mục tiêu",ms:"Semua Matlamat",la:"Omnia Proposita"},goalLabel:{"zh-TW":"目標","zh-CN":"目标",ja:"目標",en:"Goal",ko:"목표",th:"เป้าหมาย",vi:"Mục tiêu",ms:"Matlamat",la:"Propositum"},goalOptions:{jobSeeking:{"zh-TW":"尋找工作","zh-CN":"寻找工作",en:"Job Seeking",ja:"仕事探し",ko:"구직",th:"หางาน",vi:"Tìm việc",ms:"Mencari Kerja",la:"Quaerere Opus"},learnNewSkills:{"zh-TW":"學習新技能","zh-CN":"学习新技能",en:"Learn New Skills",ja:"新しいスキルを学ぶ",ko:"새로운 기술 배우기",th:"เรียนรู้ทักษะใหม่",vi:"Học kỹ năng mới",ms:"Belajar Kemahiran Baru",la:"Disce Novas Artes"},emotionalSupport:{"zh-TW":"情緒支持","zh-CN":"情绪支持",en:"Emotional Support",ja:"心のサポート",ko:"정서적 지원",th:"การสนับสนุนทางอารมณ์",vi:"Hỗ trợ tinh thần",ms:"Sokongan Emosi",la:"Auxilium Emotionale"},networking:{"zh-TW":"建立人脈","zh-CN":"建立人脉",en:"Networking",ja:"人脈作り",ko:"네트워킹",th:"สร้างเครือข่าย",vi:"Xây dựng mạng lưới",ms:"Rangkaian",la:"Nexus Creare"},startupPrep:{"zh-TW":"創業準備","zh-CN":"创业准备",en:"Startup Prep",ja:"起業準備",ko:"창업 준비",th:"เตรียมตัวเริ่มต้นธุรกิจ",vi:"Chuẩn bị khởi nghiệp",ms:"Persediaan Permulaan",la:"Praeparatio Negotii"}},pass:{"zh-TW":"跳過","zh-CN":"跳过",ja:"スキップ",en:"Pass",ko:"건너뛰기",th:"ข้าม",vi:"Bỏ qua",ms:"Langkau",la:"Transilire"},like:{"zh-TW":"建立連結","zh-CN":"建立连结",ja:"繋がる",en:"Connect",ko:"연결하기",th:"เชื่อมต่อ",vi:"Kết nối",ms:"Berhubung",la:"Coniungere"},noMoreUsers:{"zh-TW":"目前沒有更多夥伴了，請稍後再試。","zh-CN":"目前没有更多伙伴了，请稍后再试。",ja:"現在、他の仲間はいません。後でもう一度お試しください。",en:"No more partners for now. Please try again later.",ko:"지금은 더 이상 파트너가 없습니다. 나중에 다시 시도해주세요.",th:"ไม่มีพันธมิตรเพิ่มเติมในขณะนี้ กรุณาลองใหม่อีกครั้งในภายหลัง",vi:"Hiện tại không có đối tác nào khác. Vui lòng thử lại sau.",ms:"Tiada lagi rakan kongsi buat masa ini. Sila cuba lagi nanti.",la:"Nulli socii nunc. Quaeso, postea iterum conare."},profileModal:{nameLabel:{"zh-TW":"暱稱 / Name","zh-CN":"昵称 / Name",en:"Name",ja:"ニックネーム",ko:"닉네임",th:"ชื่อเล่น",vi:"Biệt danh",ms:"Nama Panggilan",la:"Nomen"},bioLabel:{"zh-TW":"簡介 / Bio","zh-CN":"简介 / Bio",en:"Bio",ja:"自己紹介",ko:"소개",th:"ประวัติ",vi:"Tiểu sử",ms:"Bio",la:"Descriptio"},goalLabel:{"zh-TW":"主要目標 / Main Goal","zh-CN":"主要目标 / Main Goal",en:"Main Goal",ja:"主な目標",ko:"주요 목표",th:"เป้าหมายหลัก",vi:"Mục tiêu chính",ms:"Matlamat Utama",la:"Propositum Principale"},skillsLabel:{"zh-TW":"技能 / Skills","zh-CN":"技能 / Skills",en:"Skills",ja:"スキル",ko:"기술",th:"ทักษะ",vi:"Kỹ năng",ms:"Kemahiran",la:"Artes"},selectDefault:{"zh-TW":"請選擇","zh-CN":"请选择",en:"Please select",ja:"選択してください",ko:"선택하세요",th:"กรุณาเลือก",vi:"Vui lòng chọn",ms:"Sila pilih",la:"Quaeso selige"},cancelButton:{"zh-TW":"取消","zh-CN":"取消",en:"Cancel",ja:"キャンセル",ko:"취소",th:"ยกเลิก",vi:"Hủy bỏ",ms:"Batal",la:"Abrogare"},saveButton:{"zh-TW":"儲存","zh-CN":"保存",en:"Save",ja:"保存",ko:"저장",th:"บันทึก",vi:"Lưu",ms:"Simpan",la:"Servare"},avatarLabel:{"zh-TW":"頭像 / Avatar","zh-CN":"头像 / Avatar",en:"Avatar",ja:"アバター",ko:"아바타",th:"รูปประจำตัว",vi:"Ảnh đại diện",ms:"Avatar",la:"Imago"},uploading:{"zh-TW":"上傳中...","zh-CN":"上传中...",en:"Uploading...",ja:"アップロード中...",ko:"업로드 중...",th:"กำลังอัปโหลด...",vi:"Đang tải lên...",ms:"Memuat naik...",la:"Imponens..."}},chatroom:{"zh-TW":"聊天室","zh-CN":"聊天室",en:"Chat Room",ja:"チャットルーム",ko:"채팅방",th:"ห้องแชท",vi:"Phòng chat",ms:"Bilik Sembang",la:"Cella Colloquii"},invites:{"zh-TW":"邀請通知","zh-CN":"邀请通知",en:"Invitations",ja:"招待通知",ko:"초대 알림",th:"การแจ้งเตือนคำเชิญ",vi:"Thông báo mời",ms:"Notis Jemputan",la:"Notitia Invitationis"},mylinks:{"zh-TW":"我的連結","zh-CN":"我的连接",en:"My Links",ja:"私のリンク",ko:"내 링크",th:"ลิงก์ของฉัน",vi:"Liên kết của tôi",ms:"Pautan Saya",la:"Nexus Mei"},returnFriendStories:{"zh-TW":"返回好友故事","zh-CN":"返回好友故事",en:"Return to Friend Stories",ja:"友達のストーリーに戻る",ko:"친구 이야기로 돌아가기",th:"กลับไปที่เรื่องราวของเพื่อน",vi:"Quay lại câu chuyện bạn bè",ms:"Kembali ke Cerita Rakan",la:"Redi ad Fabulas Amicorum"},hello:{"zh-TW":"你好，","zh-CN":"你好，",ja:"こんにちは、",en:"Hello,",ko:"안녕하세요,",th:"สวัสดี,",vi:"Xin chào,",ms:"Hai,",la:"Salve,"},partnerTitle:{"zh-TW":"尋求夥伴同行","zh-CN":"寻找伙伴同行",ja:"仲間を探す",en:"Find a Partner",ko:"동행자 찾기",th:"ค้นหาคู่หู",vi:"Tìm bạn đồng hành",ms:"Cari Rakan Kongsi",la:"Socius Quaerere"},partnerSubtitle:{"zh-TW":"請選擇你的夥伴目標","zh-CN":"请选择你的伙伴目标",ja:"パートナー目標を選択してください",en:"Please select your partner goal",ko:"파트너 목표를 선택하세요",th:"โปรดเลือกเป้าหมายของคู่หู",vi:"Vui lòng chọn mục tiêu đối tác",ms:"Sila pilih matlamat rakan kongsi anda",la:"Quaeso selige propositum socii tui"},noPartnerYet:{"zh-TW":"🦋你的夥伴很快就會出現喔，請耐心等待...","zh-CN":"🦋你的伙伴很快就會出现哦，请耐心等待...",ja:"🦋あなたのパートナーはすぐに現れます。お待ちください。",en:"🦋 Your partner will appear soon. Please be patient.",ko:"🦋 당신의 파트너가 곧 나타날 것입니다. 조금만 기다려주세요.",th:"🦋พันธมิตรของคุณจะปรากฏในขณะนี้ โปรดอดทนต่อไป",vi:"🦋 Bạn đồng hành của bạn sẽ xuất hiện sớm. Vui lòng đợi để chờ đợi...",ms:"🦋 Rakan kongsi anda akan muncul segera. Sila tunggu dengan sabar...",la:"🦋 Socius tuus apparebit. Quaeso, patientia attendas..."}};function _D(){const n=wt(),[e,t]=w.useState(null),{lang:r,setLang:s}=Bt(),[a,c]=w.useState([]),[d,h]=w.useState([]),[m,g]=w.useState(0),[x,S]=w.useState("peer"),[I,_]=w.useState(""),[R,T]=w.useState(!1),[A,D]=w.useState({name:"",bio:"",goal:"",skills:"",avatar:"",customSkill:"",country:"",gender:""}),[F,X]=w.useState({name:"",bio:"",goal:"",skills:"",avatar:"",customSkill:"",country:"",gender:""}),[ie,G]=w.useState(""),[N,E]=w.useState(null),[P,M]=w.useState(null),[O,z]=w.useState(!0),[j,K]=w.useState("main"),[Z,Y]=w.useState("none"),[ae,se]=w.useState(null);w.useRef(m),w.useEffect(()=>{const $=zo(ya,async ee=>{if(ee){t(ee);const he=Gn(Ft,"profiles",ee.uid),_e=await Io(he);if(_e.exists()){const ve=_e.data();D({name:ve.nickname||ve.name||"新用戶",bio:ve.bio,goal:ve.goal,skills:ve.skills,avatar:ve.avatar,customSkill:ve.customSkill||"",country:ve.country||"",gender:ve.gender||""})}else{const ve={name:ee.displayName||"新用戶",bio:"",goal:"",skills:"",avatar:ee.photoURL||"/avatars/Derxl.png",customSkill:"",country:"",gender:""};D(ve),await Vf(he,ve)}await re(ee.uid)}else n("/")});return()=>$()},[ya,Ft,n]);const re=async $=>{try{z(!0);const ee=kn(Ft,"profiles"),he=cr(ee,Tn("__name__","!=",$)),_e=await Dr(he),ve=[];_e.forEach(Le=>{const Ne=Le.data();ve.push({id:Le.id,name:Ne.name||"Unknown",goal:Ne.goal||"learnNewSkills",role:Ne.role||"peer",bio:Ne.bio||{"zh-TW":"No bio available","zh-CN":"暂无简介",en:"No bio available",ja:"自己紹介なし",ko:"소개 없음",th:"ไม่มีประวัติ",vi:"Không có tiểu sử",ms:"Tiada bio",la:"Nulla descriptio"},avatar:Ne.avatar||"/avatars/Derxl.png",skills:Ne.skills||"",createdAt:Ne.createdAt,country:Ne.country||"",gender:Ne.gender||""})}),c(ve),h(ve)}catch(ee){console.error("Error loading users:",ee)}finally{z(!1)}},ne=async($,ee)=>{if(e)try{const he={fromUserId:e.uid,fromUserName:A.name,fromUserAvatar:A.avatar,fromUserCountry:A.country||"",fromUserGender:A.gender||"",fromUserEmail:e.email||"",fromUserNickname:A.name||"",toUserId:$,toUserName:ee.name,role:ee.role,goal:ee.goal,status:"pending",createdAt:x0()};await go(kn(Ft,"invites"),he),se(_t.like[r]+" 成功！"),setTimeout(()=>se(null),2e3)}catch(he){console.error("Error sending invite:",he),alert("發送邀請失敗")}};w.useMemo(()=>Array(d.length).fill(0).map($=>_n.createRef()),[d.length]),w.useEffect(()=>{if(a.length>0){const $=a.filter(ee=>{const he=ee.role===x,_e=I?ee.goal===I:!0;return he&&_e});h($),g($.length-1)}},[x,I,a]),w.useEffect(()=>{R&&(X(A),G(A.avatar),M(null),E(null))},[R,A]),d[m];const W=["jobSeeking","learnNewSkills","emotionalSupport","networking","startupPrep"];return w.useEffect(()=>{if(!localStorage.getItem("lang")){const $=navigator.language;let ee="zh-TW";$.startsWith("zh-CN")?ee="zh-CN":$.startsWith("zh-TW")?ee="zh-TW":$.startsWith("ja")?ee="ja":$.startsWith("ko")?ee="ko":$.startsWith("th")?ee="th":$.startsWith("vi")?ee="vi":$.startsWith("ms")?ee="ms":$.startsWith("la")?ee="la":$.startsWith("en")&&(ee="en"),s(ee),localStorage.setItem("lang",ee)}},[s]),w.useEffect(()=>{if(Z==="in"){const $=document.getElementById("user-card");$&&$.animate([{transform:"translateX(-120%) scale(0.4)",opacity:0},{transform:"translateX(0) scale(1)",opacity:1}],{duration:400}),setTimeout(()=>Y("none"),400)}},[Z]),i.jsxs("div",{style:{width:"100vw",height:"100vh",overflow:"hidden",position:"relative"},children:[window.innerWidth<=768?i.jsxs("div",{style:{width:"100%",height:"100vh",display:"flex",flexDirection:"column",background:"url('/green_hut.png') center center / cover no-repeat fixed"},children:[i.jsxs("div",{style:{position:"fixed",top:0,left:0,right:0,zIndex:100,background:"rgba(255,255,255,0.95)",padding:"8px 16px",display:"flex",justifyContent:"space-between",alignItems:"center",boxShadow:"0 2px 8px #0001"},children:[i.jsx("button",{className:"topbar-btn",onClick:()=>n("/"),style:{fontWeight:700,fontSize:14,padding:"6px 12px",borderRadius:8,border:"1.5px solid #6B5BFF",background:"#fff",color:"#6B5BFF",cursor:"pointer"},children:_t.backToHome[r]}),i.jsxs("h2",{style:{fontSize:"1.2rem",fontWeight:900,color:"#6B5BFF",margin:0,textAlign:"center"},children:["🦋 ",_t.pageTitle[r]]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[i.jsx("button",{className:"topbar-btn",onClick:async()=>{await Tr(ya),localStorage.clear(),window.location.href="/"},style:{fontWeight:700,fontSize:14,padding:"6px 12px",borderRadius:8,border:"1.5px solid #6B5BFF",background:"#fff",color:"#6B5BFF",cursor:"pointer"},children:_t.logout[r]}),i.jsx(Mn,{style:{width:"80px",fontSize:14,padding:"6px 10px"}})]})]}),i.jsxs("div",{style:{marginTop:60,padding:"16px",flex:1,overflowY:"auto"},children:[i.jsxs("div",{style:{background:"rgba(255,255,255,0.95)",borderRadius:16,padding:"16px",marginBottom:16,boxShadow:"0 2px 12px #6B5BFF22"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,marginBottom:12},children:[i.jsx("div",{style:{fontSize:24},children:"🦋"}),i.jsx("div",{style:{fontWeight:700,fontSize:14,color:"#6B5BFF"},children:_t.hello?_t.hello[r]:"你好，"}),i.jsx("img",{src:A.avatar,alt:"avatar",style:{width:36,height:36,borderRadius:"50%",objectFit:"cover",border:"2px solid #6B5BFF"}}),i.jsx("div",{style:{fontWeight:700,fontSize:14,color:"#333"},children:A.name})]}),i.jsx("div",{style:{fontWeight:700,fontSize:16,color:"#6B5BFF",textAlign:"center",marginBottom:8},children:_t.partnerTitle?_t.partnerTitle[r]:"尋求夥伴同行"}),i.jsx("div",{style:{fontSize:12,color:"#888",textAlign:"center",marginBottom:12},children:_t.partnerSubtitle?_t.partnerSubtitle[r]:"請選擇你的夥伴目標"}),i.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:8,marginBottom:16},children:W.map($=>i.jsx("button",{onClick:()=>{_($),K("main")},style:{flex:"1 1 calc(50% - 4px)",padding:"8px 4px",borderRadius:8,border:I===$?"2px solid #23c6e6":"1px solid #eee",background:I===$?"#e6f7ff":"#fff",color:I===$?"#23c6e6":"#333",fontWeight:600,fontSize:12,cursor:"pointer",boxShadow:I===$?"0 2px 8px #23c6e622":"0 1px 4px #0001"},children:_t.goalOptions[$][r]},$))}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:8},children:[i.jsx("button",{onClick:()=>n("/chatroom"),style:{padding:"8px",borderRadius:8,border:j==="chat"?"2px solid #8ec6f7":"1px solid #eee",background:j==="chat"?"#e6f7ff":"#fff",color:j==="chat"?"#23c6e6":"#333",fontWeight:600,fontSize:14,cursor:"pointer"},children:_t.chatroom[r]}),i.jsx("button",{onClick:()=>K("invites"),style:{padding:"8px",borderRadius:8,border:j==="invites"?"2px solid #6B5BFF":"1px solid #eee",background:j==="invites"?"#f5f4ff":"#fff",color:j==="invites"?"#6B5BFF":"#333",fontWeight:600,fontSize:14,cursor:"pointer"},children:_t.invites[r]}),i.jsx("button",{onClick:()=>K("links"),style:{padding:"8px",borderRadius:8,border:j==="links"?"2px solid #6B5BFF":"1px solid #eee",background:j==="links"?"#f5f4ff":"#fff",color:j==="links"?"#6B5BFF":"#333",fontWeight:600,fontSize:14,cursor:"pointer"},children:_t.mylinks[r]}),i.jsxs("a",{href:"/storywall",style:{padding:"8px",borderRadius:8,border:"1px solid #23c6e6",background:"#fff",color:"#23c6e6",fontWeight:600,fontSize:14,cursor:"pointer",textAlign:"center",textDecoration:"none",display:"block"},children:[_t.returnFriendStories[r]," 🦋"]})]})]}),i.jsxs("div",{style:{background:"rgba(255,255,255,0.95)",borderRadius:16,padding:"16px",minHeight:400},children:[j==="main"&&i.jsx(i.Fragment,{children:(()=>{var he,_e;const $=d.filter(ve=>!I||ve.goal===I);if($.length===0)return i.jsx("div",{style:{textAlign:"center",color:"#e74c3c",fontSize:16,marginTop:40,fontWeight:700},children:((he=_t.noPartnerYet)==null?void 0:he[r])||"🦋你的夥伴很快就會出現喔，請耐心等待..."});const ee=$[m>=0&&m<$.length?m:0];return ee?i.jsxs("div",{style:{textAlign:"center"},children:[i.jsx("img",{src:ee.avatar,alt:"avatar",style:{width:80,height:80,borderRadius:"50%",objectFit:"cover",border:"3px solid #6B5BFF",marginBottom:12}}),i.jsx("div",{style:{fontWeight:800,fontSize:18,color:"#6B5BFF",marginBottom:8},children:ee.name}),i.jsxs("div",{style:{color:"#888",fontSize:14,marginBottom:4},children:["國家/地區：",ee.country||"未填寫"]}),i.jsxs("div",{style:{color:"#888",fontSize:14,marginBottom:4},children:["性別：",ee.gender||"未填寫"]}),i.jsxs("div",{style:{color:"#888",fontSize:14,marginBottom:4},children:["目標：",((_e=_t.goalOptions[ee.goal])==null?void 0:_e[r])||ee.goal]}),i.jsxs("div",{style:{color:"#888",fontSize:14,marginBottom:16},children:["技能：",ee.skills||"未填寫"]}),i.jsxs("div",{style:{display:"flex",gap:12,justifyContent:"center"},children:[i.jsx("button",{onClick:()=>{const ve=document.getElementById("user-card");ve&&(Y("out"),ve.animate([{transform:"translateX(0) scale(1)",opacity:1},{transform:"translateX(120%) scale(0.4)",opacity:0}],{duration:400})),setTimeout(()=>{g(Le=>(Y("in"),(Le-1+$.length)%$.length))},400)},style:{padding:"8px 20px",borderRadius:8,border:"1.5px solid #bbb",background:"#fff",color:"#888",fontWeight:600,fontSize:14,cursor:"pointer"},children:"跳過"}),i.jsx("button",{onClick:()=>ne(ee.id,ee),style:{padding:"8px 20px",borderRadius:8,border:"1.5px solid #6B5BFF",background:"#6B5BFF",color:"#fff",fontWeight:600,fontSize:14,cursor:"pointer"},children:"建立連結"})]})]}):null})()}),j==="chat"&&i.jsx("div",{style:{textAlign:"center",padding:"40px 0"},children:"聊天室功能開發中"}),j==="links"&&i.jsx(ex,{embedded:!0}),j==="invites"&&i.jsx(tx,{embedded:!0})]}),i.jsx(Ln,{})]})]}):i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{position:"fixed",top:0,left:0,right:0,zIndex:100,background:"rgba(255,255,255,0.95)",padding:"12px 24px",display:"flex",justifyContent:"space-between",alignItems:"center",boxShadow:"0 2px 8px #0001"},children:[i.jsx("button",{className:"topbar-btn",onClick:()=>n("/"),style:{fontWeight:700,fontSize:16,padding:"8px 16px",borderRadius:8,border:"1.5px solid #6B5BFF",background:"#fff",color:"#6B5BFF",cursor:"pointer"},children:_t.backToHome[r]}),i.jsxs("h1",{style:{fontSize:"1.8rem",fontWeight:900,color:"#6B5BFF",margin:0,textAlign:"center"},children:["🦋 ",_t.pageTitle[r]]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[i.jsx("button",{className:"topbar-btn",onClick:async()=>{await Tr(ya),localStorage.clear(),window.location.href="/"},style:{fontWeight:700,fontSize:16,padding:"8px 16px",borderRadius:8,border:"1.5px solid #6B5BFF",background:"#fff",color:"#6B5BFF",cursor:"pointer"},children:_t.logout[r]}),i.jsx(Mn,{style:{width:"100px",fontSize:16,padding:"8px 12px"}})]})]}),i.jsx("div",{style:{position:"fixed",left:0,top:60,width:340,height:"calc(100vh - 60px)",background:"rgba(255,255,255,0.95)",borderRight:"1px solid #eee",overflowY:"auto",zIndex:2,padding:"24px 16px"},children:i.jsxs("div",{style:{background:"rgba(255,255,255,0.95)",borderRadius:16,padding:"20px",marginBottom:24,boxShadow:"0 2px 12px #6B5BFF22"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:16,marginBottom:16},children:[i.jsx("div",{style:{fontSize:32},children:"🦋"}),i.jsx("div",{style:{fontWeight:700,fontSize:16,color:"#6B5BFF"},children:_t.hello?_t.hello[r]:"你好，"}),i.jsx("img",{src:A.avatar,alt:"avatar",style:{width:48,height:48,borderRadius:"50%",objectFit:"cover",border:"3px solid #6B5BFF"}}),i.jsx("div",{style:{fontWeight:700,fontSize:16,color:"#333"},children:A.name})]}),i.jsx("div",{style:{fontWeight:700,fontSize:18,color:"#6B5BFF",textAlign:"center",marginBottom:12},children:_t.partnerTitle?_t.partnerTitle[r]:"尋求夥伴同行"}),i.jsx("div",{style:{fontSize:14,color:"#888",textAlign:"center",marginBottom:20},children:_t.partnerSubtitle?_t.partnerSubtitle[r]:"請選擇你的夥伴目標"}),i.jsx("div",{style:{display:"flex",flexDirection:"column",gap:12,marginBottom:24},children:W.map($=>i.jsx("button",{onClick:()=>{_($),K("main")},style:{width:"100%",padding:"12px 16px",borderRadius:10,border:I===$?"2px solid #23c6e6":"1.5px solid #eee",background:I===$?"#e6f7ff":"#fff",color:I===$?"#23c6e6":"#333",fontWeight:700,fontSize:15,cursor:"pointer",boxShadow:I===$?"0 2px 8px #23c6e622":"0 2px 8px #0001",transition:"all 0.2s",outline:"none",borderLeft:I===$?"6px solid #23c6e6":"6px solid transparent",marginBottom:0},children:_t.goalOptions[$][r]},$))}),i.jsx("button",{onClick:()=>n("/chatroom"),style:{width:"100%",marginBottom:12,padding:"12px 0",borderRadius:10,border:j==="chat"?"2px solid #8ec6f7":"1.5px solid #eee",background:j==="chat"?"#e6f7ff":"#fff",color:j==="chat"?"#23c6e6":"#333",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:j==="chat"?"0 2px 8px #23c6e622":"0 2px 8px #0001",transition:"all 0.2s"},children:_t.chatroom[r]}),i.jsx("button",{onClick:()=>K("invites"),style:{width:"100%",marginBottom:12,padding:"12px 0",borderRadius:10,border:j==="invites"?"2px solid #6B5BFF":"1.5px solid #eee",background:j==="invites"?"#f5f4ff":"#fff",color:j==="invites"?"#6B5BFF":"#333",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:j==="invites"?"0 2px 8px #6B5BFF22":"0 2px 8px #0001",transition:"all 0.2s"},children:_t.invites[r]}),i.jsx("button",{onClick:()=>K("links"),style:{width:"100%",marginBottom:12,padding:"12px 0",borderRadius:10,border:j==="links"?"2px solid #6B5BFF":"1.5px solid #eee",background:j==="links"?"#f5f4ff":"#fff",color:j==="links"?"#6B5BFF":"#333",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:j==="links"?"0 2px 8px #6B5BFF22":"0 2px 8px #0001",transition:"all 0.2s"},children:_t.mylinks[r]}),i.jsxs("a",{href:"/storywall",style:{width:"100%",marginBottom:12,padding:"12px 0",borderRadius:10,border:"1.5px solid #23c6e6",background:"#fff",color:"#23c6e6",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:"0 2px 8px #23c6e622",textAlign:"center",textDecoration:"none",display:"block",transition:"all 0.2s"},children:[_t.returnFriendStories[r]," 🦋"]})]})}),i.jsx("div",{style:{position:"fixed",left:340,top:60,width:"calc(100vw - 340px)",height:"calc(100vh - 60px)",overflowY:"auto",display:"flex",flexDirection:"column",alignItems:"center",background:"url('/green_hut.png') center center / cover no-repeat fixed",zIndex:1,pointerEvents:"auto",paddingLeft:0},children:i.jsxs("div",{style:{width:"100%",maxWidth:900,marginTop:60},children:[j==="main"&&i.jsx(i.Fragment,{children:(()=>{var he,_e;const $=d.filter(ve=>!I||ve.goal===I);if($.length===0)return i.jsx("div",{style:{textAlign:"center",color:"#e74c3c",fontSize:18,marginTop:40,fontWeight:700},children:((he=_t.noPartnerYet)==null?void 0:he[r])||"🦋你的夥伴很快就會出現喔，請耐心等待..."});const ee=$[m>=0&&m<$.length?m:0];return ee?i.jsxs("div",{id:"user-card",style:{width:340,margin:"0 auto",background:"#fff",borderRadius:18,boxShadow:"0 2px 16px #6B5BFF22",padding:32,display:"flex",flexDirection:"column",alignItems:"center",position:"relative",minHeight:380,transition:"box-shadow 0.2s, transform 0.4s",transform:Z==="in"?"translateX(-120%) scale(0.4)":Z==="out"?"translateX(120%) scale(0.4)":"translateX(0) scale(1)",opacity:1},onAnimationEnd:()=>{Z==="in"&&Y("none")},children:[i.jsx("img",{src:ee.avatar,alt:"avatar",style:{width:88,height:88,borderRadius:"50%",objectFit:"cover",border:"3px solid #6B5BFF",marginBottom:16}}),i.jsx("div",{style:{fontWeight:800,fontSize:22,color:"#6B5BFF",marginBottom:8},children:ee.name}),i.jsxs("div",{style:{color:"#888",fontSize:15,marginBottom:4},children:["國家/地區：",ee.country||"未填寫"]}),i.jsxs("div",{style:{color:"#888",fontSize:15,marginBottom:4},children:["性別：",ee.gender||"未填寫"]}),i.jsxs("div",{style:{color:"#888",fontSize:15,marginBottom:4},children:["目標：",((_e=_t.goalOptions[ee.goal])==null?void 0:_e[r])||ee.goal]}),i.jsxs("div",{style:{color:"#888",fontSize:15,marginBottom:12},children:["技能：",ee.skills||"未填寫"]}),i.jsxs("div",{style:{display:"flex",gap:16,marginTop:24},children:[i.jsx("button",{onClick:()=>{const ve=document.getElementById("user-card");ve&&(Y("out"),ve.animate([{transform:"translateX(0) scale(1)",opacity:1},{transform:"translateX(120%) scale(0.4)",opacity:0}],{duration:400})),setTimeout(()=>{g(Le=>(Y("in"),(Le-1+$.length)%$.length))},400)},style:{padding:"10px 28px",borderRadius:8,border:"1.5px solid #bbb",background:"#fff",color:"#888",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:"0 2px 8px #0001",transition:"all 0.2s"},children:"跳過"}),i.jsx("button",{onClick:()=>ne(ee.id,ee),style:{padding:"10px 28px",borderRadius:8,border:"1.5px solid #6B5BFF",background:"#6B5BFF",color:"#fff",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:"0 2px 8px #6B5BFF22",transition:"all 0.2s"},children:"建立連結"})]})]}):null})()}),j==="chat"&&i.jsx("div",{children:"聊天室功能開發中"}),j==="links"&&i.jsx(ex,{embedded:!0}),j==="invites"&&i.jsx(tx,{embedded:!0})]})}),i.jsx("div",{style:{position:"absolute",bottom:0,left:340,right:0,zIndex:100},children:i.jsx(Ln,{})})]}),ae&&i.jsx("div",{style:{position:"fixed",top:32,left:"50%",transform:"translateX(-50%)",background:"#1976d2",color:"#fff",padding:"14px 32px",borderRadius:16,fontSize:18,fontWeight:700,zIndex:9999,boxShadow:"0 2px 16px #1976d288",letterSpacing:1,textAlign:"center",opacity:.97},children:ae})]})}function jD(){try{return JSON.parse(localStorage.getItem("messages")||"[]")}catch{return[]}}function ID(){const n=localStorage.getItem("userId")||"",e=jD(),t=localStorage.getItem("lang")||"zh-TW",r={"zh-TW":{title:"我的留言箱",noMessages:"目前沒有收到任何留言",messageFrom:"留言：",aboutPost:"針對你的貼文：「"},"zh-CN":{title:"我的留言箱",noMessages:"目前没有收到任何留言",messageFrom:"留言：",aboutPost:"针对你的贴文：「"},en:{title:"My Inbox",noMessages:"No messages received yet",messageFrom:"message:",aboutPost:'About your post: "'},ja:{title:"メッセージボックス",noMessages:"まだメッセージがありません",messageFrom:"メッセージ：",aboutPost:"あなたの投稿について：「"},ko:{title:"내 메시지함",noMessages:"아직 받은 메시지가 없습니다",messageFrom:"메시지:",aboutPost:'당신의 게시물에 대해: "'},vi:{title:"Hộp thư của tôi",noMessages:"Chưa có tin nhắn nào",messageFrom:"tin nhắn:",aboutPost:'Về bài đăng của bạn: "'},th:{title:"กล่องข้อความของฉัน",noMessages:"ยังไม่มีข้อความ",messageFrom:"ข้อความ:",aboutPost:'เกี่ยวกับโพสต์ของคุณ: "'},la:{title:"Mea Inbox",noMessages:"Nondum epistulae receptae",messageFrom:"epistula:",aboutPost:'De tuo post: "'},ms:{title:"Peti Surat Saya",noMessages:"Belum ada mesej diterima",messageFrom:"mesej:",aboutPost:'Mengenai siaran anda: "'}},s=r[t]||r.en,a=e.flatMap(c=>(c.comments||[]).filter(d=>d.toUserId===n).map(d=>({...d,post:c.text,from:c.user.name})));return i.jsx("div",{className:"modern-bg",style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center"},children:i.jsxs("div",{className:"modern-container",style:{maxWidth:600,width:"100%",margin:"0 auto",padding:32},children:[i.jsx("h2",{style:{textAlign:"center",color:"#6B5BFF",fontWeight:900,marginBottom:24},children:s.title}),a.length===0&&i.jsx("div",{style:{color:"#bbb",textAlign:"center"},children:s.noMessages}),a.map((c,d)=>i.jsxs("div",{style:{background:"#f7f7ff",borderRadius:12,padding:16,boxShadow:"0 2px 8px #6B5BFF11",marginBottom:16},children:[i.jsxs("div",{style:{color:"#6B5BFF",fontWeight:700},children:[c.from," ",s.messageFrom]}),i.jsx("div",{style:{color:"#232946",margin:"8px 0"},children:c.content}),i.jsxs("div",{style:{color:"#6B4F27",fontSize:14},children:[s.aboutPost,c.post,"」"]})]},d))]})})}const US={"zh-TW":{title:"AI 風格回覆",comingSoon:"體驗即將開放，敬請期待！",playing:"播放中...",playAudio:"播放語音"},"zh-CN":{title:"AI 风格回复",comingSoon:"体验即将开放，敬请期待！",playing:"播放中...",playAudio:"播放语音"},en:{title:"AI-Styled Reply",comingSoon:"Experience coming soon, stay tuned!",playing:"Playing...",playAudio:"Play Audio"},ja:{title:"AI風返信",comingSoon:"体験は近日公開予定です、お楽しみに！",playing:"再生中...",playAudio:"音声を再生"},ko:{title:"AI 스타일 응답",comingSoon:"체험이 곧 시작될 예정이니 기대해주세요!",playing:"재생 중...",playAudio:"오디오 재생"},vi:{title:"Trả lời theo phong cách AI",comingSoon:"Trải nghiệm sắp ra mắt, hãy theo dõi!",playing:"Đang phát...",playAudio:"Phát âm thanh"},th:{title:"การตอบกลับสไตล์ AI",comingSoon:"ประสบการณ์กำลังจะมาเร็วๆ นี้ โปรดติดตาม!",playing:"กำลังเล่น...",playAudio:"เล่นเสียง"},la:{title:"Responsum Stilo AI",comingSoon:"Experientia mox praesto erit, mane exspectans!",playing:"Ludens...",playAudio:"Sonum redde"},ms:{title:"Balasan Gaya AI",comingSoon:"Pengalaman akan datang, nantikan!",playing:"Sedang dimainkan...",playAudio:"Mainkan Audio"}};function ED(){const[n,e]=_n.useState(!1),[t,r]=_n.useState(()=>localStorage.getItem("lang")||"zh-TW"),s=US[t]||US["zh-TW"];_n.useEffect(()=>{localStorage.setItem("lang",t)},[t]);const a=()=>{e(!0),setTimeout(()=>e(!1),3e3)};return i.jsxs("div",{className:"modern-bg",style:{minHeight:"100vh",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",position:"relative"},children:[i.jsx(Mn,{}),i.jsxs("div",{className:"modern-container",style:{maxWidth:480,width:"100%",margin:"0 auto",textAlign:"center",padding:48,borderRadius:18,background:"rgba(60,40,20,0.18)",boxShadow:"0 4px 24px #0002"},children:[i.jsx("h2",{style:{color:"#6B5BFF",fontWeight:900,fontSize:28,marginBottom:24},children:s.title}),i.jsx("div",{style:{color:"#6B4F27",fontSize:22,fontWeight:700},children:s.comingSoon}),i.jsx("button",{onClick:a,style:{padding:"6px 18px",borderRadius:8,background:"#6c63ff",color:"#fff",border:"none",fontWeight:700,fontSize:16,marginTop:8},disabled:n,children:n?s.playing:s.playAudio})]})]})}const CD=[{code:"zh-TW",label:"繁中"},{code:"zh-CN",label:"简中"},{code:"en",label:"EN"},{code:"ja",label:"日本語"},{code:"ko",label:"한국어"},{code:"vi",label:"Tiếng Việt"},{code:"th",label:"ไทย"},{code:"la",label:"Latina"},{code:"ms",label:"Bahasa Melayu"}],qS={"zh-TW":{title:"擬真語音輸出",comingSoon:"體驗即將開放，敬請期待！",playing:"播放中...",playAudio:"播放語音"},"zh-CN":{title:"拟真语音输出",comingSoon:"体验即将开放，敬请期待！",playing:"播放中...",playAudio:"播放语音"},en:{title:"Realistic TTS",comingSoon:"Experience coming soon, stay tuned!",playing:"Playing...",playAudio:"Play Audio"},ja:{title:"リアルな音声出力",comingSoon:"体験は近日公開予定です、お楽しみに！",playing:"再生中...",playAudio:"音声を再生"},ko:{title:"사실적인 음성 출력",comingSoon:"체험이 곧 시작될 예정이니 기대해주세요!",playing:"재생 중...",playAudio:"오디오 재생"},vi:{title:"Đầu ra giọng nói thực tế",comingSoon:"Trải nghiệm sắp ra mắt, hãy theo dõi!",playing:"Đang phát...",playAudio:"Phát âm thanh"},th:{title:"การส่งออกเสียงที่สมจริง",comingSoon:"ประสบการณ์กำลังจะมาเร็วๆ นี้ โปรดติดตาม!",playing:"กำลังเล่น...",playAudio:"เล่นเสียง"},la:{title:"Sermo Verus Output",comingSoon:"Experientia mox praesto erit, mane exspectans!",playing:"Ludens...",playAudio:"Sonum redde"},ms:{title:"Output Suara Realistik",comingSoon:"Pengalaman akan datang, nantikan!",playing:"Sedang dimainkan...",playAudio:"Mainkan Audio"}};function HS(){const[n,e]=_n.useState(!1),[t,r]=_n.useState("zh-TW"),s=qS[t]||qS["zh-TW"];_n.useEffect(()=>{const c=localStorage.getItem("lang");c&&CD.find(d=>d.code===c)&&r(c)},[]),_n.useEffect(()=>{localStorage.setItem("lang",t)},[t]);const a=()=>{e(!0),setTimeout(()=>e(!1),2e3)};return i.jsxs("div",{className:"modern-bg",style:{minHeight:"100vh",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",position:"relative"},children:[i.jsx("div",{style:{position:"absolute",top:24,right:36,zIndex:100},children:i.jsx(Mn,{})}),i.jsxs("div",{className:"modern-container",style:{maxWidth:480,width:"100%",margin:"0 auto",textAlign:"center",padding:48,borderRadius:18,background:"rgba(60,40,20,0.18)",boxShadow:"0 4px 24px #0002"},children:[i.jsx("h2",{style:{color:"#6B5BFF",fontWeight:900,fontSize:28,marginBottom:24},children:s.title}),i.jsx("div",{style:{color:"#6B4F27",fontSize:22,fontWeight:700},children:s.comingSoon}),i.jsx("button",{onClick:a,style:{padding:"6px 18px",borderRadius:8,background:"#6c63ff",color:"#fff",border:"none",fontWeight:700,fontSize:16,marginTop:8},disabled:n,children:n?s.playing:s.playAudio})]})]})}const $S={"zh-TW":{back:"返回",logout:"登出",title:"重啟之路",subtitle:"一步步走出迷霧，看見全新的自己",steps:[{title:"第一站：迷霧山谷",desc:"寫下最近一件讓你感到強烈情緒的事。不必評判自己，單純描述事情的經過、你的感受，以及這個感受帶來的影響。",placeholder:"在這裡寫下你的故事...(300字內)"},{title:"第二站：希望之丘",desc:"回顧你剛剛寫下的事件，請思考：在那個情境下，你有沒有做過什麼小小的努力或嘗試？即使很微小，也請寫下來。",placeholder:"寫下你做過的努力或嘗試...(300字內)"},{title:"第三站：勇氣森林",desc:"根據你剛剛發現的努力或資源，請設定一個你願意嘗試的小行動，並寫下你預期會遇到的困難，以及你打算怎麼面對。",placeholder:"寫下你的小行動與預期困難...(300字內)"},{title:"第四站：智慧溪流",desc:"回顧你剛剛的行動經驗，請反思：這個過程中，你學到了什麼？有沒有什麼新的發現或領悟？",placeholder:"寫下你的學習與領悟...(300字內)"},{title:"第五站：重啟之巔",desc:"綜合前面所有關卡的經歷，請寫下你給未來自己的祝福或期許，並思考：如果未來再遇到困難，你會怎麼鼓勵自己？",placeholder:"寫下給自己的祝福或期許...(300字內)"}],submit:"提交，尋求指引",loading:"請稍候...",next:"前往下一站",finish:"恭喜你完成重啟之路！",finishSub:"未來也請繼續善待自己！",error:"發生錯誤，請稍後再試。",retry:"再來一次"},"zh-CN":{back:"返回首页",logout:"登出",title:"日常任务挑战",subtitle:"一步步走出迷雾，看见全新的自己",steps:[{title:"第一站：迷雾山谷",desc:"写下最近一件让你感到强烈情绪的事。不必评判自己，单纯描述事情的经过、你的感受，以及这个感受带来的影响。",placeholder:"在这里写下你的故事...(300字内)"},{title:"第二站：希望之丘",desc:"回顾你刚刚写下的事件，请思考：在那个情境下，你有没有做过什么小小的努力或尝试？即使很微小，也请写下来。",placeholder:"写下你做过的努力或尝试...(300字内)"},{title:"第三站：勇气森林",desc:"根据你刚刚发现的努力或资源，请设定一个你愿意尝试的小行动，并写下你预期会遇到的困难，以及你打算怎么面对。",placeholder:"写下你的小行动与预期困难...(300字内)"},{title:"第四站：智慧溪流",desc:"回顾你刚刚的行动经验，请反思：这个过程中，你学到了什么？有没有什么新的发现或领悟？",placeholder:"写下你的学习与领悟...(300字内)"},{title:"第五站：重启之巅",desc:"综合前面所有关卡的经历，请写下你给未来自己的祝福或期许，并思考：如果未来再遇到困难，你会怎么鼓励自己？",placeholder:"写下给自己的祝福或期许...(300字内)"}],submit:"提交，寻求指引",loading:"请稍候...",next:"前往下一站",finish:"恭喜你完成重启之路！",finishSub:"未来也请继续善待自己！",error:"发生错误，请稍后再试。",retry:"再来一次"},en:{back:"Back to Home",logout:"Logout",title:"Restart Journey",subtitle:"Step by step out of the mist, see a new self",steps:[{title:"Step 1: Misty Valley",desc:"Write about a recent event that made you feel strong emotions. No need to judge yourself, just describe what happened, how you felt, and how it affected you.",placeholder:"Write your story here...(300 words max)"},{title:"Step 2: Hill of Hope",desc:"Review the event you just wrote. Did you make any small effort or try anything in that situation? Even if it was minor, write it down.",placeholder:"Write your effort or attempt...(300 words max)"},{title:"Step 3: Forest of Courage",desc:"Based on your discovered effort or resources, set a small action you are willing to try, and write down the difficulties you expect and how you plan to face them.",placeholder:"Write your action and expected difficulties...(300 words max)"},{title:"Step 4: Stream of Wisdom",desc:"Reflect on your action experience. What did you learn? Any new discoveries or insights?",placeholder:"Write your learning and insights...(300 words max)"},{title:"Step 5: Summit of Restart",desc:"Summarize all your experiences and write a blessing or expectation for your future self. If you face difficulties again, how will you encourage yourself?",placeholder:"Write your blessing or expectation...(300 words max)"}],submit:"Submit for Guidance",loading:"Please wait...",next:"Next Step",finish:"Congratulations on completing your restart journey!",finishSub:"Please continue to be kind to yourself in the future!",error:"An error occurred, please try again later.",retry:"Try Again"},ja:{back:"ホームに戻る",logout:"ログアウト",title:"日課ミッション挑戦",subtitle:"一歩ずつ霧を抜けて、新しい自分に出会おう",steps:[{title:"第1ステップ：霧の谷",desc:"最近あなたが強い感情を抱いた出来事について書いてください。自分を評価せず、出来事の経過や感情、その影響を素直に書きましょう。",placeholder:"ここにあなたのストーリーを書いてください...(300字以内)"},{title:"第2ステップ：希望の丘",desc:"先ほど書いた出来事を振り返り、その状況であなたが行った小さな努力や試みがあれば書いてください。些細なことでも構いません。",placeholder:"あなたの努力や試みを書いてください...(300字以内)"},{title:"第3ステップ：勇気の森",desc:"発見した努力やリソースをもとに、挑戦したい小さな行動と、予想される困難、それにどう向き合うかを書いてください。",placeholder:"行動と予想される困難を書いてください...(300字以内)"},{title:"第4ステップ：知恵の流れ",desc:"行動の経験を振り返り、学んだことや新たな気づきがあれば書いてください。",placeholder:"学びや気づきを書いてください...(300字以内)"},{title:"第5ステップ：再出発の頂",desc:"これまでの経験をまとめ、未来の自分へのメッセージや期待を書いてください。困難に直面したとき、どう自分を励ますかも考えてみましょう。",placeholder:"未来の自分へのメッセージや期待を書いてください...(300字以内)"}],submit:"提出して指導を求める",loading:"お待ちください...",next:"次のステップへ",finish:"再出発の道を完了しました！",finishSub:"これからも自分を大切にしてください！",error:"エラーが発生しました。しばらくしてから再度お試しください。",retry:"もう一度"},ko:{back:"홈으로",logout:"로그아웃",title:"일일 미션 도전",subtitle:"한 걸음씩 안개를 걷고, 새로운 나를 만나보세요",steps:[{title:"1단계: 안개의 계곡",desc:"최근에 강한 감정을 느꼈던 일을 적어보세요. 자신을 평가하지 말고, 그 일의 과정과 감정, 그리고 그 감정이 가져온 영향을 솔직하게 적어보세요.",placeholder:"여기에 당신의 이야기를 적어주세요...(300자 이내)"},{title:"2단계: 희망의 언덕",desc:"방금 적은 일을 돌아보며, 그 상황에서 했던 작은 노력이나 시도가 있다면 적어보세요. 아주 사소한 것도 괜찮아요.",placeholder:"노력이나 시도를 적어주세요...(300자 이내)"},{title:"3단계: 용기의 숲",desc:"발견한 노력이나 자원을 바탕으로, 시도해보고 싶은 작은 행동과 예상되는 어려움, 그리고 어떻게 대처할지 적어보세요.",placeholder:"행동과 예상되는 어려움을 적어주세요...(300자 이내)"},{title:"4단계: 지혜의 시냇물",desc:"행동 경험을 돌아보며, 배운 점이나 새로운 깨달음이 있다면 적어보세요.",placeholder:"배운 점이나 깨달음을 적어주세요...(300자 이내)"},{title:"5단계: 재시작의 정상",desc:"지금까지의 경험을 종합해 미래의 나에게 전하고 싶은 메시지나 기대를 적어보세요. 앞으로 어려움이 닥칠 때 어떻게 자신을 격려할지도 생각해보세요.",placeholder:"미래의 나에게 전하고 싶은 메시지나 기대를 적어주세요...(300자 이내)"}],submit:"제출하고 안내받기",loading:"잠시만 기다려주세요...",next:"다음 단계로",finish:"재시작의 여정을 완료했습니다!",finishSub:"앞으로도 자신을 소중히 하세요!",error:"오류가 발생했습니다. 잠시 후 다시 시도해주세요.",retry:"다시 시도"},th:{back:"กลับหน้าหลัก",logout:"ออกจากระบบ",title:"ภารกิจประจำวัน",subtitle:"ก้าวออกจากหมอกทีละก้าว พบกับตัวเองในมุมใหม่",steps:[{title:"ขั้นที่ 1: หุบเขาหมอก",desc:"เขียนเกี่ยวกับเหตุการณ์ล่าสุดที่ทำให้คุณรู้สึกอารมณ์รุนแรง ไม่ต้องตัดสินตัวเอง เพียงบรรยายเหตุการณ์ ความรู้สึก และผลกระทบที่เกิดขึ้น",placeholder:"เขียนเรื่องราวของคุณที่นี่...(300 คำ)"},{title:"ขั้นที่ 2: เนินแห่งความหวัง",desc:"ทบทวนเหตุการณ์ที่เพิ่งเขียนไป มีความพยายามหรือการลองทำอะไรเล็กๆ ในสถานการณ์นั้นหรือไม่ แม้จะเล็กน้อยก็เขียนได้",placeholder:"เขียนความพยายามหรือสิ่งที่ลองทำ...(300 คำ)"},{title:"ขั้นที่ 3: ป่าแห่งความกล้าหาญ",desc:"จากความพยายามหรือทรัพยากรที่ค้นพบ กำหนดการกระทำเล็กๆ ที่อยากลอง พร้อมทั้งอุปสรรคที่คาดว่าจะเจอและวิธีรับมือ",placeholder:"เขียนการกระทำและอุปสรรคที่คาดไว้...(300 คำ)"},{title:"ขั้นที่ 4: ลำธารแห่งปัญญา",desc:"ทบทวนประสบการณ์การกระทำของคุณ มีอะไรที่ได้เรียนรู้หรือค้นพบใหม่ๆ หรือไม่",placeholder:"เขียนสิ่งที่ได้เรียนรู้หรือค้นพบ...(300 คำ)"},{title:"ขั้นที่ 5: ยอดเขาแห่งการเริ่มต้นใหม่",desc:"สรุปประสบการณ์ทั้งหมด เขียนคำอวยพรหรือความคาดหวังถึงตัวเองในอนาคต หากเจออุปสรรคอีกจะให้กำลังใจตัวเองอย่างไร",placeholder:"เขียนคำอวยพรหรือความคาดหวัง...(300 คำ)"}],submit:"ส่งและขอคำแนะนำ",loading:"กรุณารอสักครู่...",next:"ไปยังขั้นถัดไป",finish:"คุณสำเร็จภารกิจเริ่มต้นใหม่แล้ว!",finishSub:"ขอให้ดูแลตัวเองต่อไป!",error:"เกิดข้อผิดพลาด กรุณาลองใหม่อีกครั้งภายหลัง",retry:"ลองอีกครั้ง"},vi:{back:"Về trang chủ",logout:"Đăng xuất",title:"Thử thách nhiệm vụ hàng ngày",subtitle:"Từng bước vượt qua sương mù, khám phá bản thân mới",steps:[{title:"Bước 1: Thung lũng sương mù",desc:"Viết về một sự kiện gần đây khiến bạn cảm xúc mạnh. Không cần phán xét bản thân, chỉ cần mô tả diễn biến, cảm xúc và ảnh hưởng của nó.",placeholder:"Viết câu chuyện của bạn tại đây...(300 từ)"},{title:"Bước 2: Đồi hy vọng",desc:"Xem lại sự kiện vừa viết, bạn có nỗ lực hoặc thử điều gì nhỏ không? Dù nhỏ cũng hãy ghi lại.",placeholder:"Viết nỗ lực hoặc điều bạn đã thử...(300 từ)"},{title:"Bước 3: Rừng dũng cảm",desc:"Dựa trên nỗ lực hoặc nguồn lực vừa phát hiện, hãy đặt ra một hành động nhỏ muốn thử, dự đoán khó khăn và cách đối mặt.",placeholder:"Viết hành động và khó khăn dự đoán...(300 từ)"},{title:"Bước 4: Suối trí tuệ",desc:"Xem lại trải nghiệm hành động, bạn học được gì? Có phát hiện hay nhận thức mới không?",placeholder:"Viết điều bạn học được hoặc nhận ra...(300 từ)"},{title:"Bước 5: Đỉnh tái khởi động",desc:"Tổng hợp mọi trải nghiệm, viết lời chúc hoặc kỳ vọng cho bản thân tương lai. Nếu gặp khó khăn, bạn sẽ động viên mình thế nào?",placeholder:"Viết lời chúc hoặc kỳ vọng...(300 từ)"}],submit:"Gửi và nhận hướng dẫn",loading:"Vui lòng chờ...",next:"Bước tiếp theo",finish:"Chúc mừng bạn đã hoàn thành hành trình tái khởi động!",finishSub:"Hãy tiếp tục yêu thương bản thân nhé!",error:"Đã xảy ra lỗi, vui lòng thử lại sau.",retry:"Thử lại"},la:{back:"Redi ad domum",logout:"Exire",title:"Provocatio Cotidiana",subtitle:"Gradatim e nebula progredere, novum te aspice",steps:[{title:"Gradus I: Vallis Nebulosa",desc:"Scribe de re nuper te vehementer commotum. Te ipsum iudicare noli, sed simpliciter rem, sensus tuos, et effectus describas.",placeholder:"Hic fabulam tuam scribe...(300 verba)"},{title:"Gradus II: Collis Spei",desc:"Recense rem modo scriptam. In illa condicione quid parvum conatus es? Etiam minima, scribe.",placeholder:"Conatum tuum scribe...(300 verba)"},{title:"Gradus III: Silva Virtutis",desc:"Ex conatu aut opibus inventis, parvam actionem temptare velis, difficultates praevides et quomodo eas superaturus sis scribe.",placeholder:"Actionem et difficultates scribe...(300 verba)"},{title:"Gradus IV: Rivus Sapientiae",desc:"Recense experientiam actionis. Quid didicisti? Quid novi invenisti?",placeholder:"Quae didicisti scribe...(300 verba)"},{title:"Gradus V: Culmen Renovationis",desc:"Omnia experientia colligens, votum aut spem tibi futuro scribe. Si iterum difficultates occurrant, quomodo te hortaberis?",placeholder:"Votum aut spem scribe...(300 verba)"}],submit:"Mitte et consilium pete",loading:"Exspecta quaeso...",next:"Ad gradum proximum",finish:"Iter renovationis confecisti!",finishSub:"Te ipsum semper cura!",error:"Error factus est, quaeso postea repete.",retry:"Iterum conare"},ms:{back:"Kembali ke Laman Utama",logout:"Log keluar",title:"Cabaran Misi Harian",subtitle:"Melangkah keluar dari kabus, temui diri baharu",steps:[{title:"Langkah 1: Lembah Berkabus",desc:"Tulis tentang peristiwa baru-baru ini yang membuatkan anda beremosi kuat. Tidak perlu menilai diri, hanya gambarkan peristiwa, perasaan dan kesannya.",placeholder:"Tulis kisah anda di sini...(300 patah perkataan)"},{title:"Langkah 2: Bukit Harapan",desc:"Imbas kembali peristiwa tadi, adakah anda berusaha atau mencuba sesuatu walaupun kecil? Catatkan walaupun kecil.",placeholder:"Tulis usaha atau percubaan anda...(300 patah perkataan)"},{title:"Langkah 3: Hutan Keberanian",desc:"Berdasarkan usaha atau sumber yang ditemui, tetapkan tindakan kecil yang ingin dicuba, jangka cabaran dan cara menghadapinya.",placeholder:"Tulis tindakan dan cabaran dijangka...(300 patah perkataan)"},{title:"Langkah 4: Sungai Kebijaksanaan",desc:"Imbas kembali pengalaman tindakan anda, apa yang anda pelajari? Ada penemuan atau kesedaran baharu?",placeholder:"Tulis apa yang anda pelajari...(300 patah perkataan)"},{title:"Langkah 5: Puncak Permulaan Semula",desc:"Gabungkan semua pengalaman, tulis harapan atau ucapan untuk diri masa depan. Jika hadapi cabaran lagi, bagaimana anda akan beri semangat pada diri?",placeholder:"Tulis harapan atau ucapan...(300 patah perkataan)"}],submit:"Hantar & mohon panduan",loading:"Sila tunggu...",next:"Langkah seterusnya",finish:"Tahniah, anda telah tamat perjalanan permulaan semula!",finishSub:"Teruskan sayangi diri anda!",error:"Ralat berlaku, sila cuba lagi kemudian.",retry:"Cuba lagi"}};function GS(){var G,N,E,P;const n=wt(),e=gt(),{lang:t}=Bt(),r=$S["zh-TW"],s=$S[t]||r,a={...r,...s,steps:s.steps||r.steps,submit:s.submit||r.submit,loading:s.loading||r.loading,next:s.next||r.next,finish:s.finish||r.finish,finishSub:s.finishSub||r.finishSub,error:s.error||r.error,retry:s.retry||r.retry},[c,d]=w.useState(0),[h,m]=w.useState(""),[g,x]=w.useState([]),[S,I]=w.useState(""),[_,R]=w.useState(!1),[T,A]=w.useState(!1),D=(G=a.steps)==null?void 0:G[c];w.useEffect(()=>{var M;if(S&&c===(((M=a.steps)==null?void 0:M.length)||0)-1){A(!0);const O=setTimeout(()=>A(!1),3e3);return()=>clearTimeout(O)}},[S,c]);const F=async M=>{M.preventDefault(),R(!0),I("");try{console.log("Sending request to /api/mission-ai with:",{step:c,input:h,history:g});const O=await fetch("/api/mission-ai",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({step:c,input:h,history:g})});if(console.log("Response status:",O.status),!O.ok)throw new Error(`HTTP error! status: ${O.status}`);const z=await O.json();console.log("Response data:",z),I(z.reply||"AI教練祝福你！"),x(j=>[...j,h])}catch(O){console.error("Error in handleSubmit:",O),I("發生錯誤，請稍後再試。錯誤詳情："+(O instanceof Error?O.message:"未知錯誤"))}finally{R(!1)}},X=()=>{m(""),I(""),d(c+1)},ie=()=>i.jsxs("div",{style:{position:"fixed",left:0,top:0,width:"100vw",height:"100vh",pointerEvents:"none",zIndex:9999,display:"flex",justifyContent:"center",alignItems:"center"},children:[i.jsx("iframe",{src:"https://embed.lottiefiles.com/animation/85716",style:{width:400,height:400,border:"none",background:"transparent"},title:"fireworks1"}),i.jsx("iframe",{src:"https://embed.lottiefiles.com/animation/85716",style:{width:400,height:400,border:"none",background:"transparent",position:"absolute",left:"20vw",top:"10vh"},title:"fireworks2"}),i.jsx("iframe",{src:"https://embed.lottiefiles.com/animation/85716",style:{width:400,height:400,border:"none",background:"transparent",position:"absolute",right:"20vw",top:"20vh"},title:"fireworks3"})]});return i.jsxs("div",{style:{minHeight:"100vh",width:"100vw",position:"relative",overflowX:"hidden",background:"url('/mountain.png') center center / cover no-repeat fixed, linear-gradient(to bottom, #eaf6ff 0%, #f7fafc 100%)"},children:[i.jsx("button",{onClick:()=>n("/"),style:{position:"absolute",top:"20px",left:"20px",zIndex:1e3,fontWeight:700,fontSize:16,padding:"8px 16px",borderRadius:8,border:"1.5px solid #6B5BFF",background:"#fff",color:"#6B5BFF",cursor:"pointer",minWidth:80,boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:a.back}),i.jsxs("div",{style:{position:"absolute",top:"20px",right:"20px",zIndex:1e3,display:"flex",alignItems:"center",gap:12},children:[i.jsx("button",{onClick:async()=>{await Tr(e),localStorage.clear(),window.location.href="/"},style:{fontWeight:700,fontSize:16,padding:"8px 16px",borderRadius:8,border:"1.5px solid #6B5BFF",background:"#fff",color:"#6B5BFF",cursor:"pointer",minWidth:80,boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:a.logout}),i.jsx("div",{style:{width:80},children:i.jsx(Mn,{style:{width:"100%"}})})]}),i.jsx("div",{style:{width:"100%",maxWidth:700,margin:"20px auto 20px auto",padding:"16px 24px",background:"rgba(255,255,255,0.95)",borderRadius:16,boxShadow:"0 4px 20px rgba(0,0,0,0.1)",display:"flex",alignItems:"center",justifyContent:"center",position:"relative"},children:i.jsxs("h1",{style:{fontWeight:900,fontSize:18,color:"#6B5BFF",margin:0,lineHeight:1,textShadow:"0 2px 8px #6B5BFF88",textAlign:"center"},children:[i.jsx("span",{role:"img","aria-label":"mission",children:"🎯"})," 挑戰任務"]})}),i.jsxs("div",{style:{maxWidth:600,margin:"0 auto",padding:"2rem 0 2rem 0",background:"rgba(255,255,255,0.92)",borderRadius:24,boxShadow:"0 8px 32px rgba(0,0,0,0.08)"},children:[i.jsx("h1",{style:{textAlign:"center",fontWeight:700,fontSize:"2rem",marginBottom:8},children:a.title}),i.jsx("div",{style:{textAlign:"center",color:"#666",marginBottom:32},children:a.subtitle}),i.jsxs("div",{style:{background:"#fff",borderRadius:16,padding:32,boxShadow:"0 2px 8px #0001",marginBottom:24},children:[i.jsx("div",{style:{fontWeight:700,fontSize:"1.3rem",color:"#2a5d8f",marginBottom:8},children:(D==null?void 0:D.title)||""}),i.jsx("div",{style:{color:"#333",marginBottom:24},children:(D==null?void 0:D.desc)||""}),i.jsxs("form",{onSubmit:F,children:[i.jsx("textarea",{value:h,onChange:M=>m(M.target.value),placeholder:(D==null?void 0:D.placeholder)||"",style:{width:"100%",minHeight:100,borderRadius:8,border:"1px solid #ccc",padding:12,marginBottom:16},required:!0}),i.jsx("button",{type:"submit",disabled:_||!h,style:{width:"100%",background:"#6B5BFF",color:"#fff",fontWeight:700,fontSize:18,border:"none",borderRadius:8,padding:"12px 0",cursor:_?"not-allowed":"pointer",opacity:_?.99:1,filter:"none",textShadow:"none",transition:"background 0.18s"},children:_?a.loading:a.submit})]}),S&&i.jsx("div",{style:{marginTop:24,background:"#f5f5f5",borderRadius:8,padding:16,color:"#2a5d8f"},children:S}),S&&c<(((N=a.steps)==null?void 0:N.length)||0)-1&&i.jsx("button",{onClick:X,style:{marginTop:16,width:"100%",background:"#6B5BFF",color:"#fff",fontWeight:700,fontSize:16,border:"none",borderRadius:8,padding:"10px 0",cursor:"pointer",transition:"background 0.18s"},children:a.next}),S&&c===(((E=a.steps)==null?void 0:E.length)||0)-1&&i.jsxs("div",{style:{marginTop:24,textAlign:"center",color:"#e6b800",fontWeight:700,fontSize:20},children:[a.finish,i.jsx("br",{}),i.jsx("span",{style:{fontSize:16,color:"#888"},children:a.finishSub}),T&&i.jsx(ie,{}),i.jsx("div",{style:{marginTop:24},children:i.jsx("button",{onClick:()=>{d(0),m(""),x([]),I("")},style:{background:"#6B5BFF",color:"#fff",fontWeight:700,fontSize:16,border:"none",borderRadius:8,padding:"10px 32px",cursor:"pointer",marginTop:8,boxShadow:"0 2px 8px #0001",transition:"background 0.18s"},children:a.retry})})]})]}),i.jsx("div",{style:{textAlign:"center",color:"#aaa",fontSize:14},children:(a.steps||[]).map((M,O)=>i.jsx("span",{style:{display:"inline-block",width:18,height:18,borderRadius:"50%",background:O<=c?"#8ec6f7":"#e0e0e0",margin:"0 4px",border:O===c?"2px solid #2a5d8f":"none",transition:"all 0.2s"}},O))})]}),i.jsx(Ln,{}),S&&c===(((P=a.steps)==null?void 0:P.length)||0)-1&&T&&i.jsx(ie,{})]})}const RD={encouragement:"/videos/encouragement.mp4",reproach:"/videos/reproach.mp4",motivation:"/videos/motivation.mp4",disappointment:"/videos/disappointment.mp4",joy:"/videos/joy.mp4",lost:"/videos/lost.mp4",breakthrough:"/videos/breakthrough.mp4",clarity:"/videos/clarity.mp4",reluctance:"/videos/reluctance.mp4",confusion:"/videos/confusion.mp4",affection:"/videos/affection.mp4",regret:"/videos/regret.mp4",admiration:"/videos/admiration.mp4",teasing:"/videos/teasing.mp4"};function AD({reactionType:n,onEnd:e,style:t,className:r="",autoPlay:s=!0,...a}){const c=w.useRef(null);return w.useEffect(()=>{s&&c.current&&(c.current.currentTime=0,c.current.play())},[n,s]),i.jsx("div",{className:`video-reaction-player ${r}`,style:{position:"fixed",left:0,top:0,width:"100vw",height:"100vh",zIndex:3e3,background:"rgba(0,0,0,0.32)",display:"flex",alignItems:"center",justifyContent:"center",...t},...a,children:i.jsx("video",{ref:c,src:RD[n],style:{maxWidth:"90vw",maxHeight:"80vh",borderRadius:18,boxShadow:"0 8px 32px #0008",background:"#000"},autoPlay:s,onEnded:e,controls:!1,playsInline:!0})})}const wI=w.createContext({setVideoReaction:()=>{}});function PD(){return w.useContext(wI)}function BD({children:n}){const[e,t]=w.useState(null);return i.jsxs(wI.Provider,{value:{setVideoReaction:t},children:[n,e&&i.jsx(AD,{reactionType:e,onEnd:()=>t(null)})]})}const Mt={backToHome:{"zh-TW":"← 返回首頁","zh-CN":"← 返回首页",ja:"← ホームへ戻る",en:"← Home",ko:"← 홈으로 돌아가기",th:"← กลับหน้าหลัก",vi:"← Về trang chủ",ms:"← Kembali ke Laman Utama",la:"← Ad domum redire"},back:{"zh-TW":"↩ 返回上一頁","zh-CN":"↩ 返回上一页",ja:"↩ 前のページへ",en:"↩ Back",ko:"↩ 이전 페이지로",th:"↩ กลับไป",vi:"↩ Quay lại",ms:"↩ Kembali",la:"↩ Redire"},logout:{"zh-TW":"登出","zh-CN":"登出",ja:"ログアウト",en:"Logout",ko:"로그아웃",th:"ออกจากระบบ",vi:"Đăng xuất",ms:"Log keluar",la:"Exire"},pageTitle:{"zh-TW":"配對對聊 PairTalk","zh-CN":"配对对聊 PairTalk",ja:"ペアトーク PairTalk",en:"PairTalk",ko:"페어톡",th:"คู่คุย",vi:"Trò chuyện đôi",ms:"PairTalk",la:"PairTalk"},subtitle:{"zh-TW":"劫後餘生的交友最珍貴，沒人怕跨出第一步！","zh-CN":"劫后余生的交友最珍贵，没人怕跨出第一步！",en:"Friendship after hardship is the most precious, no one is afraid to take the first step!",ja:"困難を乗り越えた後の友情こそが最も貴重、一歩踏み出すのは誰も怖くない！",ko:"역경 후의 우정이 가장 소중하며, 첫 걸음을 내딛는 것을 두려워하는 사람은 아무도 없습니다!",th:"มิตรภาพหลังความยากลำบากนั้นมีค่าที่สุด ไม่มีใครกลัวที่จะก้าวแรก!",vi:"Tình bạn sau gian khó là quý giá nhất, không ai ngại bước bước đầu tiên!",ms:"Persahabatan selepas kesusahan adalah yang paling berharga, tiada siapa yang takut untuk mengambil langkah pertama!",la:"Amicitia post aerumnas pretiosissima est, nemo primum gradum timere metuit!"},matchStatus:{"zh-TW":"配對狀態","zh-CN":"配对状态",ja:"マッチ状況",en:"Match Status",ko:"매칭 상태",th:"สถานะการจับคู่",vi:"Tình trạng ghép đôi",ms:"Status Padanan",la:"Status Par"},empty:{"zh-TW":"目前沒有配對，等待系統為你尋找夥伴...","zh-CN":"目前没有配对，等待系统为你寻找伙伴...",en:"No matches yet. Waiting for a companion...",ja:"まだマッチがありません。相手を探しています...",ko:"아직 매칭이 없습니다. 상대를 기다리는 중...",th:"ยังไม่มีคู่ รอระบบหาคู่ให้อยู่...",vi:"Chưa có ai được ghép đôi. Đang chờ hệ thống tìm bạn đồng hành...",ms:"Tiada padanan lagi. Menunggu teman...",la:"Nulli pares adhuc. Socium exspectans..."},todayMatch:{"zh-TW":"今日配對：","zh-CN":"今日配对：",ja:"今日のマッチ：",en:"Today's Match:",ko:"오늘의 매칭:",th:"คู่ของวันนี้:",vi:"Ghép đôi hôm nay:",ms:"Padanan Hari Ini:",la:"Par Hodiernus:"},timeLeft:{"zh-TW":"剩餘時間：","zh-CN":"剩余时间：",ja:"残り時間：",en:"Time Left:",ko:"남은 시간:",th:"เวลาที่เหลือ:",vi:"Thời gian còn lại:",ms:"Masa Tinggal:",la:"Tempus Reliquum:"},archive:{"zh-TW":"封存對話","zh-CN":"封存对话",ja:"アーカイブ",en:"Archive",ko:"보관",th:"เก็บถาวร",vi:"Lưu trữ",ms:"Arkib",la:"Archivum"},rematch:{"zh-TW":"重配","zh-CN":"重配",ja:"再マッチ",en:"Rematch",ko:"재매칭",th:"จับคู่ใหม่",vi:"Ghép lại",ms:"Padan semula",la:"Repar"},history:{"zh-TW":"歷史配對","zh-CN":"历史配对",ja:"履歴",en:"History",ko:"기록",th:"ประวัติ",vi:"Lịch sử",ms:"Sejarah",la:"Historia"},viewDetails:{"zh-TW":"查看完整資料","zh-CN":"查看完整资料",ja:"詳細を見る",en:"View Details",ko:"상세 정보 보기",th:"ดูรายละเอียด",vi:"Xem chi tiết",ms:"Lihat Butiran",la:"Singula Videre"},hideDetails:{"zh-TW":"收合資料","zh-CN":"收起资料",ja:"閉じる",en:"Hide",ko:"숨기기",th:"ซ่อน",vi:"Ẩn",ms:"Sembunyi",la:"Celare"},nickname:{"zh-TW":"暱稱","zh-CN":"昵称",ja:"ニックネーム",en:"Nickname",ko:"닉네임",th:"ชื่อเล่น",vi:"Biệt danh",ms:"Nama Samaran",la:"Agnomen"},country:{"zh-TW":"國家","zh-CN":"国家",ja:"国",en:"Country",ko:"국가",th:"ประเทศ",vi:"Quốc gia",ms:"Negara",la:"Natio"},age:{"zh-TW":"年齡","zh-CN":"年龄",ja:"年齢",en:"Age",ko:"나이",th:"อายุ",vi:"Tuổi",ms:"Umur",la:"Aetas"},gender:{"zh-TW":"性別","zh-CN":"性别",ja:"性別",en:"Gender",ko:"성별",th:"เพศ",vi:"Giới tính",ms:"Jantina",la:"Genus"},interest:{"zh-TW":"興趣","zh-CN":"兴趣",ja:"趣味",en:"Interest",ko:"관심사",th:"ความสนใจ",vi:"Sở thích",ms:"Minat",la:"Studium"},eventType:{"zh-TW":"事件類型","zh-CN":"事件类型",ja:"イベントタイプ",en:"Event Type",ko:"이벤트 유형",th:"ประเภทเหตุการณ์",vi:"Loại sự kiện",ms:"Jenis Acara",la:"Genus Eventus"},bio:{"zh-TW":"簡介","zh-CN":"简介",ja:"自己紹介",en:"Bio",ko:"소개",th:"ประวัติ",vi:"Tiểu sử",ms:"Bio",la:"Bio"},sendGift:{"zh-TW":"送出禮物","zh-CN":"送出礼物",ja:"ギフトを送る",en:"Send Gift",ko:"선물 보내기",th:"ส่งของขวัญ",vi:"Gửi quà",ms:"Hantar Hadiah",la:"Donum Mittere"},sendEmail:{"zh-TW":"發送Email","zh-CN":"发送Email",ja:"メール送信",en:"Send Email",ko:"이메일 보내기",th:"ส่งอีเมล",vi:"Gửi Email",ms:"Hantar E-mel",la:"Epistulam Mittere"},next:{"zh-TW":"下一頁","zh-CN":"下一页",ja:"次へ",en:"Next",ko:"다음",th:"ถัดไป",vi:"Tiếp",ms:"Seterusnya",la:"Proximus"},lastPage:{"zh-TW":"最後一頁","zh-CN":"最后一页",ja:"最後のページ",en:"Last page",ko:"마지막 페이지",th:"หน้าสุดท้าย",vi:"Trang cuối",ms:"Halaman terakhir",la:"Pagina Ultima"}},FD=[{id:1,partner:"小明",status:"active",aiGuide:"你可以問對方：今天過得如何？"},{id:2,partner:"Sandy",status:"archived",aiGuide:"你可以問對方：最近有什麼開心的事？"}],ey=[{id:1,nickname:"Alice",country:"台灣",age:28,gender:"female",email:"alice@example.com",bio:"喜歡閱讀與旅行",interest:"閱讀",eventType:"經濟",avatar:"/avatars/female1.jpg"},{id:2,nickname:"Bob",country:"日本",age:32,gender:"male",email:"bob@example.com",bio:"音樂愛好者",interest:"音樂",eventType:"科技",avatar:"/avatars/male1.jpg"}],KS={"zh-TW":{male:"男性",female:"女性",other:"其他"},"zh-CN":{male:"男性",female:"女性",other:"其他"},en:{male:"Male",female:"Female",other:"Other"},ja:{male:"男性",female:"女性",other:"その他"},ko:{male:"남성",female:"여성",other:"기타"},th:{male:"ชาย",female:"หญิง",other:"อื่นๆ"},vi:{male:"Nam",female:"Nữ",other:"Khác"},ms:{male:"Lelaki",female:"Perempuan",other:"Lain-lain"},la:{male:"Mas",female:"Femina",other:"Aliud"}},QS=[{value:"🌹",label:"🌹"},{value:"💍",label:"💍"},{value:"🍰",label:"🍰"},{value:"🎩",label:"🎩"},{value:"🌺",label:"🌺"},{value:"👗",label:"👗"},{value:"✒️",label:"✒️"},{value:"🏎️",label:"🏎️"}],ND={"zh-TW":"歲","zh-CN":"岁",en:"yrs",ja:"歳",ko:"세",th:"ปี",vi:"tuổi",ms:"tahun",la:"anni"};function zD(){var P,M,O,z;const n=wt(),e=gt(),t=((P=e.currentUser)==null?void 0:P.email)||"",r=Bt(),[s,a]=w.useState(JSON.parse(localStorage.getItem("pairs")||"[]")||FD),[c,d]=w.useState(300),[h,m]=w.useState(((M=s.find(j=>j.status==="active"))==null?void 0:M.id)||null),[g,x]=w.useState("AI：記得保持友善，互相傾聽！"),[S,I]=w.useState(0),_=ey[S],[R,T]=w.useState(!1),[A,D]=w.useState(QS[0].value),{setVideoReaction:F}=PD();_n.useEffect(()=>{if(h){const j=setInterval(()=>d(K=>K>0?K-1:0),1e3);return()=>clearInterval(j)}},[h]);const X=j=>{a(s.map(K=>K.id===j?{...K,status:"archived"}:K)),localStorage.setItem("pairs",JSON.stringify(s.map(K=>K.id===j?{...K,status:"archived"}:K))),F("disappointment")},ie=()=>{F("breakthrough")},G=()=>{alert(`${A} 已送出給 ${_.nickname}！`)},N=()=>{window.location.href=`mailto:${_.email}?subject=PairTalk&body=Hi${t?`&from=${t}`:""}`},E=()=>{if(ey.length<=1||S===ey.length-1){alert(Mt.lastPage[r]);return}T(!1),I(j=>j+1)};return i.jsxs("div",{className:"modern-bg",style:{background:"url('/valley.png') center center / cover no-repeat",minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center"},children:[i.jsxs("div",{style:{position:"absolute",top:0,left:0,zIndex:100,display:"flex",alignItems:"center",padding:"18px 32px 0 32px",background:"transparent"},children:[i.jsx("button",{className:"topbar-btn",onClick:()=>n("/"),style:{fontWeight:700,fontSize:18,padding:"6px 16px",borderRadius:8,border:"1.5px solid #6B5BFF",background:"#fff",color:"#6B5BFF",cursor:"pointer",transition:"background 0.18s, color 0.18s, border 0.18s",marginRight:8},onMouseOver:j=>{j.currentTarget.style.background="#6B5BFF",j.currentTarget.style.color="#fff"},onMouseOut:j=>{j.currentTarget.style.background="#fff",j.currentTarget.style.color="#6B5BFF"},children:Mt.backToHome[r]}),window.location.pathname!=="/pairtalk"&&i.jsx("button",{className:"topbar-btn",onClick:()=>n(-1),style:{fontWeight:700,fontSize:18,padding:"6px 16px",borderRadius:8,border:"1.5px solid #6B5BFF",background:"#fff",color:"#6B5BFF",cursor:"pointer",transition:"background 0.18s, color 0.18s, border 0.18s",marginLeft:8},onMouseOver:j=>{j.currentTarget.style.background="#6B5BFF",j.currentTarget.style.color="#fff"},onMouseOut:j=>{j.currentTarget.style.background="#fff",j.currentTarget.style.color="#6B5BFF"},children:Mt.back[r]})]}),i.jsxs("div",{style:{position:"absolute",top:0,right:0,zIndex:100,display:"flex",alignItems:"center",padding:"18px 32px 0 32px",background:"transparent",gap:12},children:[i.jsx("button",{className:"topbar-btn",onClick:async()=>{await Tr(e),localStorage.clear(),window.location.href="/"},style:{fontWeight:700,fontSize:18,padding:"6px 16px",borderRadius:8,border:"1.5px solid #6B5BFF",background:"#fff",color:"#6B5BFF",cursor:"pointer",transition:"background 0.18s, color 0.18s, border 0.18s"},onMouseOver:j=>{j.currentTarget.style.background="#6B5BFF",j.currentTarget.style.color="#fff"},onMouseOut:j=>{j.currentTarget.style.background="#fff",j.currentTarget.style.color="#6B5BFF"},children:Mt.logout[r]}),i.jsx(Mn,{})]}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[i.jsxs("h2",{style:{fontSize:"2.2rem",fontWeight:900,color:"#6B5BFF",textShadow:"0 2px 12px #6B5BFF88, 0 4px 24px #0008",letterSpacing:1,background:"#fff",borderRadius:12,boxShadow:"0 2px 12px #6B5BFF22",padding:"12px 32px",margin:0,marginBottom:24,display:"flex",alignItems:"center",gap:12},children:["🤝 ",Mt.pageTitle[r]]}),i.jsxs("div",{style:{maxWidth:540,width:"100%",background:"#fff",borderRadius:16,padding:32,boxShadow:"0 4px 24px #0002",display:"flex",flexDirection:"column",alignItems:"center"},children:[i.jsx("div",{style:{fontSize:22,color:"#6B5BFF",fontWeight:900,marginBottom:24,textAlign:"center",textShadow:"0 2px 12px #6B5BFF88, 0 4px 24px #0008"},children:Mt.subtitle[r]}),i.jsx("h2",{style:{fontSize:28,fontWeight:900,marginBottom:18},children:Mt.pageTitle[r]}),i.jsxs("div",{style:{marginTop:18},children:[i.jsx("b",{children:Mt.matchStatus[r]}),i.jsx("div",{style:{marginTop:8},children:Mt.empty[r]})]}),h?i.jsxs("div",{style:{marginBottom:16},children:[i.jsx("b",{children:Mt.todayMatch[r]})," ",(O=s.find(j=>j.id===h))==null?void 0:O.partner,i.jsxs("div",{style:{marginTop:8,color:"#6B5BFF"},children:[Mt.timeLeft[r],Math.floor(c/60),":",(c%60).toString().padStart(2,"0")]}),i.jsx("div",{style:{marginTop:8,color:"#23c6e6"},children:(z=s.find(j=>j.id===h))==null?void 0:z.aiGuide}),i.jsx("div",{style:{marginTop:8,color:"#614425"},children:g}),i.jsx("button",{onClick:()=>X(h),style:{marginTop:10,borderRadius:8,background:"#eee",color:"#6B5BFF",border:"none",fontWeight:700,padding:"6px 18px"},children:Mt.archive[r]}),i.jsx("button",{onClick:ie,style:{marginTop:10,marginLeft:10,borderRadius:8,background:"#6B5BFF",color:"#fff",border:"none",fontWeight:700,padding:"6px 18px"},children:Mt.rematch[r]})]}):i.jsx("div",{style:{color:"#614425",fontSize:18,textAlign:"center",marginTop:40},children:Mt.empty[r]}),i.jsxs("div",{style:{marginTop:18},children:[i.jsx("b",{children:Mt.history[r]}),i.jsx("ul",{style:{marginTop:8,paddingLeft:0,listStyle:"none"},children:s.filter(j=>j.status==="archived").map((j,K)=>i.jsxs("li",{style:{background:"#f7f7ff",borderRadius:8,padding:10,marginBottom:8},children:[i.jsx("div",{style:{fontWeight:700},children:j.partner}),i.jsx("div",{style:{color:"#614425",marginTop:4},children:j.aiGuide})]},K))})]}),i.jsxs("div",{style:{width:"100%",maxWidth:420,margin:"0 auto",background:"#f7f7ff",borderRadius:16,padding:24,boxShadow:"0 2px 12px #6B5BFF11",marginBottom:24,textAlign:"center",position:"relative"},children:[i.jsx("img",{src:_.avatar,alt:"avatar",style:{width:72,height:72,borderRadius:"50%",objectFit:"cover",border:"2px solid #6B5BFF",background:"#eee",marginBottom:12}}),i.jsx("div",{style:{fontWeight:700,fontSize:20,color:"#6B5BFF",marginBottom:6},children:_.nickname}),i.jsxs("div",{style:{color:"#614425",fontSize:16,marginBottom:6},children:[_.country," / ",_.age,ND[r]," / ",KS[r][_.gender]]}),i.jsx("button",{onClick:()=>T(j=>!j),style:{margin:"8px 0",padding:"6px 18px",borderRadius:8,fontWeight:700,background:"#fff",color:"#6B5BFF",border:"2px solid #6B5BFF",cursor:"pointer",fontSize:15,transition:"background 0.18s, color 0.18s, box-shadow 0.18s"},onMouseOver:j=>{j.currentTarget.style.background="#6B5BFF",j.currentTarget.style.color="#fff",j.currentTarget.style.boxShadow="0 6px 32px #6B5BFF99"},onMouseOut:j=>{j.currentTarget.style.background="#fff",j.currentTarget.style.color="#6B5BFF",j.currentTarget.style.boxShadow="none"},children:R?Mt.hideDetails[r]:Mt.viewDetails[r]}),R&&i.jsxs("div",{style:{marginTop:8,color:"#232946",fontSize:15,background:"#fff",borderRadius:8,padding:12,boxShadow:"0 2px 8px #6B5BFF11",display:"flex",flexDirection:"column",alignItems:"center",gap:8},children:[i.jsx("img",{src:_.avatar,alt:"avatar",style:{width:72,height:72,borderRadius:"50%",objectFit:"cover",border:"2px solid #6B5BFF",background:"#eee",marginBottom:6}}),i.jsxs("div",{children:[i.jsxs("b",{children:[Mt.nickname[r],"："]}),_.nickname]}),i.jsxs("div",{children:[i.jsxs("b",{children:[Mt.country[r],"："]}),_.country]}),i.jsxs("div",{children:[i.jsxs("b",{children:[Mt.age[r],"："]}),_.age]}),i.jsxs("div",{children:[i.jsxs("b",{children:[Mt.gender[r],"："]}),KS[r][_.gender]]}),i.jsxs("div",{children:[i.jsx("b",{children:"Email："}),_.email]}),i.jsxs("div",{children:[i.jsxs("b",{children:[Mt.interest[r],"："]}),_.interest]}),i.jsxs("div",{children:[i.jsxs("b",{children:[Mt.eventType[r],"："]}),_.eventType]}),i.jsxs("div",{children:[i.jsxs("b",{children:[Mt.bio[r],"："]}),_.bio]})]}),i.jsxs("div",{style:{marginTop:14,display:"flex",flexDirection:"row",gap:10,justifyContent:"center",alignItems:"center"},children:[i.jsx("select",{value:A,onChange:j=>D(j.target.value),style:{padding:"6px 12px",borderRadius:8,border:"1.5px solid #6B5BFF",fontSize:18},children:QS.map(j=>i.jsx("option",{value:j.value,children:j.label},j.value))}),i.jsx("button",{onClick:G,style:{padding:"6px 18px",borderRadius:8,fontWeight:700,background:"linear-gradient(135deg, #6B5BFF 60%, #23c6e6 100%)",color:"#fff",border:"none",fontSize:16,transition:"background 0.18s, box-shadow 0.18s"},onMouseOver:j=>{j.currentTarget.style.background="linear-gradient(135deg, #3a2fff 60%, #0e7fd6 100%)",j.currentTarget.style.boxShadow="0 6px 32px #6B5BFF99"},onMouseOut:j=>{j.currentTarget.style.background="linear-gradient(135deg, #6B5BFF 60%, #23c6e6 100%)",j.currentTarget.style.boxShadow="none"},children:Mt.sendGift[r]}),i.jsx("button",{onClick:N,style:{padding:"6px 18px",borderRadius:8,fontWeight:700,background:"#fff",color:"#6B5BFF",border:"2px solid #6B5BFF",fontSize:16,transition:"background 0.18s, color 0.18s, box-shadow 0.18s"},onMouseOver:j=>{j.currentTarget.style.background="#6B5BFF",j.currentTarget.style.color="#fff",j.currentTarget.style.boxShadow="0 6px 32px #6B5BFF99"},onMouseOut:j=>{j.currentTarget.style.background="#fff",j.currentTarget.style.color="#6B5BFF",j.currentTarget.style.boxShadow="none"},children:Mt.sendEmail[r]})]}),i.jsx("button",{onClick:E,style:{position:"absolute",right:18,bottom:0,transform:"translateY(60px)",padding:"8px 24px",borderRadius:8,fontWeight:700,background:"linear-gradient(135deg, #6B5BFF 60%, #23c6e6 100%)",color:"#fff",border:"none",fontSize:16,boxShadow:"0 2px 8px #6B5BFF33",transition:"background 0.18s, box-shadow 0.18s, transform 0.18s",cursor:"pointer"},onMouseOver:j=>{j.currentTarget.style.background="linear-gradient(135deg, #3a2fff 60%, #0e7fd6 100%)",j.currentTarget.style.boxShadow="0 6px 32px #6B5BFF99",j.currentTarget.style.transform="translateY(55px) scale(1.04)"},onMouseOut:j=>{j.currentTarget.style.background="linear-gradient(135deg, #6B5BFF 60%, #23c6e6 100%)",j.currentTarget.style.boxShadow="0 2px 8px #6B5BFF33",j.currentTarget.style.transform="translateY(60px)"},children:Mt.next[r]})]})]})]}),i.jsx(Ln,{})]})}const os={backToHome:{"zh-TW":"← 返回","zh-CN":"← 返回",ja:"← 戻る",en:"← Back",ko:"← 뒤로",th:"← กลับ",vi:"← Quay lại",ms:"← Kembali",la:"← Redire"},logout:{"zh-TW":"登出","zh-CN":"登出",ja:"ログアウト",en:"Logout",ko:"로그아웃",th:"ออกจากระบบ",vi:"Đăng xuất",ms:"Log keluar",la:"Exire"},pageTitle:{"zh-TW":"情境模擬室 SkillBox","zh-CN":"情境模拟室 SkillBox",en:"SkillBox Scenario Room",ja:"シナリオ練習室 SkillBox",ko:"상황 시뮬레이션실 SkillBox",th:"ห้องจำลองสถานการณ์ SkillBox",vi:"Phòng mô phỏng tình huống SkillBox",ms:"Bilik Senario SkillBox",la:"Camera Scaenarii SkillBox"},subtitle:{"zh-TW":"在這裡磨練你的對話技巧，應對各種挑戰。","zh-CN":"在这里磨练你的对话技巧，应对各种挑战。",en:"Hone your conversation skills here for any challenge.",ja:"ここで会話スキルを磨き、様々な挑戦に備えましょう。",ko:"여기서 대화 기술을 연마하여 모든 도전에 대비하세요.",th:"ฝึกฝนทักษะการสนทนาของคุณที่นี่เพื่อรับมือกับทุกความท้าทาย",vi:"Rèn luyện kỹ năng trò chuyện của bạn ở đây cho mọi thử thách.",ms:"Asah kemahiran perbualan anda di sini untuk sebarang cabaran.",la:"Hic peritiam colloquii tui exacue ad quamvis provocationem."},selectScenario:{"zh-TW":"選擇一個情境開始練習","zh-CN":"选择一个情境开始练习",en:"Select a scenario to start practicing",ja:"練習を始めるシナリオを選択してください",ko:"연습을 시작할 시나리오를 선택하세요",th:"เลือกสถานการณ์เพื่อเริ่มฝึก",vi:"Chọn một kịch bản để bắt đầu luyện tập",ms:"Pilih senario untuk mula berlatih",la:"Scaenarium elige ut exercere incipias"},startPractice:{"zh-TW":"進入模擬","zh-CN":"进入模拟",en:"Enter Simulation",ja:"シミュレーションに入る",ko:"시뮬레이션 시작",th:"เข้าสู่การจำลอง",vi:"Vào mô phỏng",ms:"Masuk Simulasi",la:"Intra Simulationem"},scenarioDifficulty:{"zh-TW":"難度","zh-CN":"难度",en:"Difficulty",ja:"難易度",ko:"난이도",th:"ความยาก",vi:"Độ khó",ms:"Kesukaran",la:"Difficultas"},cancelButton:{"zh-TW":"取消","zh-CN":"取消",en:"Cancel",ja:"キャンセル",ko:"취소",th:"ยกเลิก",vi:"Hủy",ms:"Batal",la:"Abstinere"}};function DD(){const n=wt(),e=gt(),{lang:t}=Bt(),r=t||localStorage.getItem("lang")||"zh-TW",[s,a]=w.useState(null),[c,d]=w.useState([]),[h,m]=w.useState(!0),[g,x]=w.useState(!1),[S,I]=w.useState(null);w.useEffect(()=>{(async()=>{m(!0);try{const D=await fetch(`/locales/${r}/scenarios.json`);if(!D.ok)throw new Error("Failed to fetch scenarios");const F=await D.json();d(F)}catch(D){console.error("Error fetching scenarios:",D),d([])}finally{m(!1)}})()},[r]);const _=A=>{I(A),a(A.id),x(!0)},R=()=>{s?n(`/skillbox/${s}`):alert(os.selectScenario[r])},T=()=>{x(!1),I(null),a(null)};return h?i.jsx("div",{children:"Loading scenarios..."}):i.jsxs("div",{className:"modern-bg",style:{background:"url('/plains.png') center center / cover no-repeat fixed",minHeight:"100vh",width:"100vw",overflow:"hidden",position:"relative"},children:[i.jsxs("div",{style:{width:"100%",maxWidth:700,margin:"20px auto 20px auto",padding:"16px 24px",background:"rgba(255,255,255,0.95)",borderRadius:16,boxShadow:"0 4px 20px rgba(0,0,0,0.1)",display:"flex",alignItems:"center",justifyContent:"space-between",position:"relative"},children:[i.jsx("button",{onClick:()=>n("/"),style:{fontWeight:700,fontSize:16,padding:"8px 16px",borderRadius:8,border:"1.5px solid #6B5BFF",background:"#fff",color:"#6B5BFF",cursor:"pointer",minWidth:80},children:os.backToHome[r]}),i.jsxs("h1",{style:{fontWeight:900,fontSize:18,color:"#6B5BFF",margin:0,lineHeight:1,textShadow:"0 2px 8px #6B5BFF88",textAlign:"center",flex:1},children:[i.jsx("span",{role:"img","aria-label":"skillbox",children:"🛠️"})," ",os.pageTitle[r]]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[i.jsx("button",{onClick:async()=>{await Tr(e),localStorage.clear(),window.location.href="/"},style:{fontWeight:700,fontSize:16,padding:"8px 16px",borderRadius:8,border:"1.5px solid #6B5BFF",background:"#fff",color:"#6B5BFF",cursor:"pointer",minWidth:80},children:os.logout[r]}),i.jsx("div",{style:{width:80},children:i.jsx(Mn,{style:{width:"100%"}})})]})]}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",width:"100%",padding:"24px",marginTop:20,minHeight:"calc(100vh - 120px)",overflowY:"auto"},children:[i.jsx("div",{style:{fontSize:18,color:"#4A4A4A",fontWeight:500,marginBottom:24,textAlign:"center",background:"rgba(255,255,255,0.7)",padding:"8px 16px",borderRadius:8},children:os.subtitle[r]}),i.jsxs("div",{style:{maxWidth:800,width:"100%",background:"#fff",borderRadius:16,padding:"24px 32px",boxShadow:"0 4px 24px #0002",display:"flex",flexDirection:"column",alignItems:"center"},children:[i.jsx("h3",{style:{fontSize:24,fontWeight:700,color:"#6B5BFF",marginBottom:24},children:os.selectScenario[r]}),i.jsx("div",{style:{width:"100%",display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"24px"},children:c.map(A=>i.jsxs("div",{onClick:()=>_(A),style:{background:s===A.id?"linear-gradient(135deg, #6B5BFF 0%, #4D8FFF 100%)":"#f7f7ff",color:s===A.id?"#fff":"#4A4A4A",borderRadius:12,padding:20,boxShadow:s===A.id?"0 8px 24px #6B5BFF66":"0 4px 12px #0000001a",cursor:"pointer",transition:"all 0.3s ease",border:s===A.id?"2px solid #fff":"2px solid transparent",transform:s===A.id?"translateY(-5px)":"none",display:"flex",flexDirection:"column",alignItems:"center",textAlign:"center"},children:[i.jsx("div",{style:{fontSize:48,marginBottom:12},children:A.emoji}),i.jsx("h4",{style:{fontSize:18,fontWeight:700,margin:"0 0 8px 0"},children:A.title}),i.jsx("p",{style:{fontSize:14,margin:"0 0 12px 0",opacity:.8,minHeight:"40px"},children:A.description}),i.jsxs("div",{style:{fontWeight:600,fontSize:14,padding:"4px 12px",borderRadius:16,background:s===A.id?"rgba(255,255,255,0.2)":"rgba(107, 91, 255, 0.1)",color:s===A.id?"#fff":"#6B5BFF"},children:[os.scenarioDifficulty[r],": ",A.difficulty]})]},A.id))})]})]}),g&&S&&i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},onClick:T,children:i.jsxs("div",{style:{background:"#fff",borderRadius:16,padding:"32px",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.3)",maxWidth:400,width:"90%",textAlign:"center",position:"relative"},onClick:A=>A.stopPropagation(),children:[i.jsx("button",{onClick:T,style:{position:"absolute",top:12,right:12,background:"none",border:"none",fontSize:24,cursor:"pointer",color:"#999",width:32,height:32,display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"50%",transition:"background-color 0.2s"},onMouseOver:A=>A.currentTarget.style.backgroundColor="#f0f0f0",onMouseOut:A=>A.currentTarget.style.backgroundColor="transparent",children:"×"}),i.jsx("div",{style:{fontSize:48,marginBottom:16},children:S.emoji}),i.jsx("h3",{style:{fontSize:20,fontWeight:700,color:"#6B5BFF",margin:"0 0 8px 0"},children:S.title}),i.jsx("p",{style:{fontSize:14,color:"#666",margin:"0 0 16px 0",lineHeight:1.5},children:S.description}),i.jsxs("div",{style:{display:"flex",gap:12,justifyContent:"center"},children:[i.jsx("button",{onClick:T,style:{padding:"10px 20px",borderRadius:8,border:"1px solid #ddd",background:"#f8f9fa",color:"#666",cursor:"pointer",fontSize:14,fontWeight:600,transition:"all 0.2s"},onMouseOver:A=>A.currentTarget.style.background="#e9ecef",onMouseOut:A=>A.currentTarget.style.background="#f8f9fa",children:os.cancelButton[r]||"取消"}),i.jsx("button",{onClick:R,style:{padding:"10px 24px",borderRadius:8,border:"none",background:"linear-gradient(135deg, #6B5BFF 0%, #4D8FFF 100%)",color:"#fff",cursor:"pointer",fontSize:14,fontWeight:700,transition:"all 0.2s",boxShadow:"0 4px 12px rgba(107, 91, 255, 0.3)"},onMouseOver:A=>A.currentTarget.style.transform="translateY(-1px)",onMouseOut:A=>A.currentTarget.style.transform="translateY(0)",children:os.startPractice[r]})]})]})}),i.jsx(Ln,{})]})}const MD={"zh-TW":i.jsxs("div",{children:[i.jsx("h1",{children:"Restarter™ 使用條款與更生者聲明"}),i.jsx("h2",{children:"一、平台理念聲明"}),i.jsx("p",{children:"Restarter™ 是幫助更生人社會、心理、生活自信恢復的 AI 平台。我們透過情感引導、角色扮演、任務挑戰，協助用戶釋放負面情緒、重建目標與自信，更引導使用者逐步建立內在動力與行動信心。"}),i.jsx("p",{children:"我們相信每一位更生人都值得被尊重與重新認識。即使你曾經犯錯，在這裡不再被貼標籤。"}),i.jsx("h2",{children:"二、用戶身份與行為規範"}),i.jsx("p",{children:"本平台歡迎曾經服刑、戒癮、感化、接受司法保護、霸凌或因社會排斥而渴望重新開始的個人註冊使用。"}),i.jsx("p",{children:"為確保社群安全與信任，嚴禁下列行為："}),i.jsxs("ul",{children:[i.jsx("li",{children:"冒用他人身份或誤導他人註冊資料"}),i.jsx("li",{children:"散佈仇恨、歧視、暴力、色情、違法內容"}),i.jsx("li",{children:"上傳侵犯他人肖像權或機敏資料的圖片"})]}),i.jsx("p",{children:"違反上述條款者，平台有權立即中止其帳號與使用權限。"}),i.jsx("h2",{children:"三、AI 使用與責任聲明"}),i.jsx("p",{children:"平台所提供的 AI 對話、建議與角色模擬，僅供陪伴、練習與個人成長參考，不構成法律、醫療或心理專業意見。"}),i.jsxs("ul",{children:[i.jsx("li",{children:"平台不對使用者依據 AI 輸出所做的決策承擔法律責任"}),i.jsx("li",{children:"平台不保證 AI 對話完全正確或與真實情境一致"}),i.jsx("li",{children:"請勿將 AI 對話內容散佈作為公共引用資訊"})]}),i.jsx("p",{children:"我們已設置基本風險過濾與話術限制，但 AI 存在輸出偏差或感受誤解的可能。"}),i.jsx("p",{children:"若遇到不適當內容，請透過回報機制通知我們，我們將持續優化模型。"}),i.jsx("h3",{children:"三之一、AI 對話內容使用規範"}),i.jsxs("ul",{children:[i.jsx("li",{children:"不得詢問或輸入他人私密資訊（如住址、犯罪紀錄）"}),i.jsx("li",{children:"不得操作 AI 模擬暴力、自殘或誘導非法行為"}),i.jsx("li",{children:"不得以 Restarter™ 名義散佈虛假或詐騙訊息"}),i.jsx("li",{children:"所有對話資料僅用於匿名模型優化，不作個人追蹤"}),i.jsx("li",{children:"如有必要，平台保留法律配合義務"}),i.jsx("li",{children:"未滿十八歲使用者，需經家長同意方可使用本平台"}),i.jsx("li",{children:"本平台禁止自動爬蟲或未授權系統串接"}),i.jsx("li",{children:"使用者需自負資料輸入內容之法律風險"})]}),i.jsx("h2",{children:"四、資料處理與隱私權聲明"}),i.jsx("p",{children:"平台僅會蒐集註冊所需最基本資料，如暱稱、電子信箱與使用語言偏好。"}),i.jsx("p",{children:"所有資料經加密儲存，不會轉售第三方或做商業行銷使用。"}),i.jsx("p",{children:"使用者可隨時申請帳號刪除，並請求系統清除其所有紀錄。"}),i.jsx("h2",{children:"五、帳號停用與終止權利"}),i.jsx("p",{children:"平台保留中止任何違反本條款使用者帳號的權利，且無須事前通知。"}),i.jsx("p",{children:"如帳號長期未使用，平台將主動發出提醒並保留停用處理權限。"}),i.jsx("p",{children:"用戶可自行隨時停用帳號並刪除所有資料紀錄。"}),i.jsx("h2",{children:"六、本條款之調整與最終解釋權"}),i.jsx("p",{children:"平台有權依據法律、政策與服務優化隨時修改本條款內容。"}),i.jsx("p",{children:"重大異動將透過站內公告與電子郵件通知用戶。"}),i.jsx("p",{children:"本條款之最終解釋權歸 Restarter™ 平台所有。"})]}),"zh-CN":i.jsxs("div",{children:[i.jsx("h1",{children:"Restarter™ 使用条款与更生者声明"}),i.jsx("h2",{children:"一、平台理念声明"}),i.jsx("p",{children:"Restarter™ 是帮助更生人社会、心理、生活自信恢复的 AI 平台。我们通过情感引导、角色扮演、任务挑战，协助用户释放负面情绪、重建目标与自信，并引导用户逐步建立内在动力与行动信心。"}),i.jsx("p",{children:"我们相信每一位更生人都值得被尊重与重新认识。即使你曾经犯错，在这里不再被贴标签。"}),i.jsx("h2",{children:"二、用户身份与行为规范"}),i.jsx("p",{children:"本平台欢迎曾经服刑、戒瘾、感化、接受司法保护、霸凌或因社会排斥而渴望重新开始的个人注册使用。"}),i.jsx("p",{children:"为确保社群安全与信任，严禁下列行为："}),i.jsxs("ul",{children:[i.jsx("li",{children:"冒用他人身份或误导他人注册资料"}),i.jsx("li",{children:"散布仇恨、歧视、暴力、色情、违法内容"}),i.jsx("li",{children:"上传侵犯他人肖像权或敏感资料的图片"})]}),i.jsx("p",{children:"违反上述条款者，平台有权立即中止其账号与使用权限。"}),i.jsx("h2",{children:"三、AI 使用与责任声明"}),i.jsx("p",{children:"平台所提供的 AI 对话、建议与角色模拟，仅供陪伴、练习与个人成长参考，不构成法律、医疗或心理专业意见。"}),i.jsxs("ul",{children:[i.jsx("li",{children:"平台不对用户依据 AI 输出所做的决策承担法律责任"}),i.jsx("li",{children:"平台不保证 AI 对话完全正确或与真实情境一致"}),i.jsx("li",{children:"请勿将 AI 对话内容散布作为公共引用信息"})]}),i.jsx("p",{children:"我们已设置基本风险过滤与话术限制，但 AI 存在输出偏差或感受误解的可能。"}),i.jsx("p",{children:"若遇到不适当内容，请通过举报机制通知我们，我们将持续优化模型。"}),i.jsx("h3",{children:"三之一、AI 对话内容使用规范"}),i.jsxs("ul",{children:[i.jsx("li",{children:"不得询问或输入他人私密信息（如住址、犯罪记录）"}),i.jsx("li",{children:"不得操作 AI 模拟暴力、自残或诱导非法行为"}),i.jsx("li",{children:"不得以 Restarter™ 名义散布虚假或诈骗信息"}),i.jsx("li",{children:"全对话资料仅用于匿名模型优化，不作个人追踪"}),i.jsx("li",{children:"如有必要，平台保留法律配合义务"}),i.jsx("li",{children:"未满十八岁用户，需经家长同意方可使用本平台"}),i.jsx("li",{children:"本平台禁止自动爬虫或未授权系统串接"}),i.jsx("li",{children:"用户需自负资料输入内容之法律风险"})]}),i.jsx("h2",{children:"四、资料处理与隐私权声明"}),i.jsx("p",{children:"平台仅会收集注册所需最基本资料，如昵称、电子邮箱与使用语言偏好。"}),i.jsx("p",{children:"所有资料经加密存储，不会转售第三方或做商业营销使用。"}),i.jsx("p",{children:"用户可随时申请账号删除，并请求系统清除其所有记录。"}),i.jsx("h2",{children:"五、账号停用与终止权利"}),i.jsx("p",{children:"平台保留中止任何违反本条款用户账号的权利，且无需事前通知。"}),i.jsx("p",{children:"如账号长期未使用，平台将主动发出提醒并保留停用处理权限。"}),i.jsx("p",{children:"用户可自行随时停用账号并删除所有资料记录。"}),i.jsx("h2",{children:"六、本条款之调整与最终解释权"}),i.jsx("p",{children:"平台有权依据法律、政策与服务优化随时修改本条款内容。"}),i.jsx("p",{children:"重大变动将通过站内公告与电子邮件通知用户。"}),i.jsx("p",{children:"本条款之最终解释权归 Restarter™ 平台所有。"})]}),en:i.jsxs("div",{children:[i.jsx("h1",{children:"Restarter™ Terms of Use and Ex-Offender Declaration"}),i.jsx("h2",{children:"1. Platform Philosophy Statement"}),i.jsx("p",{children:"Restarter™ is an AI platform dedicated to helping ex-offenders rebuild social, psychological, and life confidence. Through emotional guidance, role-playing, and task challenges, we help users release negative emotions, rebuild goals and confidence, and guide them to gradually build inner motivation and action confidence."}),i.jsx("p",{children:"We believe that every ex-offender deserves respect and a new recognition. Even if you have made mistakes, you will not be labeled here."}),i.jsx("h2",{children:"2. User Identity and Code of Conduct"}),i.jsx("p",{children:"This platform welcomes individuals who have served sentences, undergone rehabilitation, received judicial protection, experienced bullying, or wish to start over due to social exclusion."}),i.jsx("p",{children:"To ensure community safety and trust, the following behaviors are strictly prohibited:"}),i.jsxs("ul",{children:[i.jsx("li",{children:"Impersonating others or providing misleading registration information"}),i.jsx("li",{children:"Spreading hate, discrimination, violence, pornography, or illegal content"}),i.jsx("li",{children:"Uploading images that infringe on others' portrait rights or sensitive data"})]}),i.jsx("p",{children:"Those who violate the above terms may have their accounts and access immediately terminated by the platform."}),i.jsx("h2",{children:"3. AI Usage and Responsibility Statement"}),i.jsx("p",{children:"The AI dialogues, suggestions, and role simulations provided by the platform are for companionship, practice, and personal growth reference only, and do not constitute legal, medical, or psychological professional advice."}),i.jsxs("ul",{children:[i.jsx("li",{children:"The platform is not legally responsible for decisions made by users based on AI output"}),i.jsx("li",{children:"The platform does not guarantee that AI dialogues are completely accurate or consistent with real situations"}),i.jsx("li",{children:"Do not distribute AI dialogue content as public reference information"})]}),i.jsx("p",{children:"We have set up basic risk filtering and dialogue restrictions, but AI may still produce biased or misunderstood outputs."}),i.jsx("p",{children:"If you encounter inappropriate content, please notify us through the reporting mechanism, and we will continue to optimize the model."}),i.jsx("h3",{children:"3.1 AI Dialogue Content Usage Guidelines"}),i.jsxs("ul",{children:[i.jsx("li",{children:"Do not ask for or input others' private information (such as address or criminal record)"}),i.jsx("li",{children:"Do not use AI to simulate violence, self-harm, or induce illegal behavior"}),i.jsx("li",{children:"Do not distribute false or fraudulent information in the name of Restarter™"}),i.jsx("li",{children:"All dialogue data is used only for anonymous model optimization, not for personal tracking"}),i.jsx("li",{children:"The platform reserves the right to cooperate with legal authorities if necessary"}),i.jsx("li",{children:"Users under 18 must have parental consent to use this platform"}),i.jsx("li",{children:"The platform prohibits automated crawling or unauthorized system integration"}),i.jsx("li",{children:"Users are responsible for the legal risks of the content they input"})]}),i.jsx("h2",{children:"4. Data Processing and Privacy Statement"}),i.jsx("p",{children:"The platform only collects the most basic registration information, such as nickname, email, and language preference."}),i.jsx("p",{children:"All data is stored encrypted and will not be sold to third parties or used for commercial marketing."}),i.jsx("p",{children:"Users can request account deletion at any time and ask the system to clear all their records."}),i.jsx("h2",{children:"5. Account Suspension and Termination Rights"}),i.jsx("p",{children:"The platform reserves the right to terminate any user's account that violates these terms at any time without prior notice."}),i.jsx("p",{children:"If an account is inactive for a long period, the platform will proactively send reminders and reserves the right to suspend the account."}),i.jsx("p",{children:"Users can deactivate their accounts and delete all data records at any time."}),i.jsx("h2",{children:"6. Amendments and Final Interpretation"}),i.jsx("p",{children:"The platform reserves the right to modify these terms at any time in accordance with laws, policies, and service optimization."}),i.jsx("p",{children:"Major changes will be announced on the platform and via email notifications to users."}),i.jsx("p",{children:"The final interpretation of these terms belongs to the Restarter™ platform."})]}),ja:i.jsxs("div",{children:[i.jsx("h1",{children:"Restarter™ 利用規約および更生者宣言"}),i.jsx("h2",{children:"1. プラットフォーム理念声明"}),i.jsx("p",{children:"Restarter™ は更生者の社会的・心理的・生活的自信の回復を支援するAIプラットフォームです。感情ガイダンス、ロールプレイ、タスクチャレンジを通じて、ユーザーがネガティブな感情を解放し、目標と自信を再構築し、内面の動機と行動への自信を段階的に築くことをサポートします。"}),i.jsx("p",{children:"私たちは、すべての更生者が尊重され、新たに認識される価値があると信じています。過去に過ちを犯したとしても、ここではラベルを貼られません。"}),i.jsx("h2",{children:"2. ユーザーの身分と行動規範"}),i.jsx("p",{children:"本プラットフォームは、服役経験者、依存症克服者、感化・司法保護を受けた方、いじめや社会的排除を経験し再出発を望む方の登録を歓迎します。"}),i.jsx("p",{children:"コミュニティの安全と信頼を守るため、以下の行為を厳禁とします："}),i.jsxs("ul",{children:[i.jsx("li",{children:"他人の身分を詐称または誤った登録情報の提供"}),i.jsx("li",{children:"憎悪・差別・暴力・ポルノ・違法コンテンツの拡散"}),i.jsx("li",{children:"他人の肖像権や機密情報を侵害する画像のアップロード"})]}),i.jsx("p",{children:"上記規約に違反した場合、プラットフォームは直ちにアカウントと利用権限を停止する権利を有します。"}),i.jsx("h2",{children:"3. AI利用と責任声明"}),i.jsx("p",{children:"本プラットフォームが提供するAI対話・提案・ロールプレイは、伴走・練習・自己成長の参考用であり、法的・医療的・心理的な専門アドバイスではありません。"}),i.jsxs("ul",{children:[i.jsx("li",{children:"AI出力に基づく意思決定に対し、プラットフォームは法的責任を負いません"}),i.jsx("li",{children:"AI対話が常に正確または現実と一致することを保証しません"}),i.jsx("li",{children:"AI対話内容を公共の引用情報として拡散しないでください"})]}),i.jsx("p",{children:"基本的なリスクフィルタと発話制限を設けていますが、AIには出力の偏りや誤解が生じる可能性があります。"}),i.jsx("p",{children:"不適切な内容に遭遇した場合は、報告機能からご連絡ください。モデルの最適化に努めます。"}),i.jsx("h3",{children:"3.1 AI対話内容の利用規範"}),i.jsxs("ul",{children:[i.jsx("li",{children:"他人の個人情報（住所・犯罪歴等）を尋ねたり入力しない"}),i.jsx("li",{children:"AIで暴力・自傷・違法行為を模擬しない"}),i.jsx("li",{children:"Restarter™名義で虚偽・詐欺情報を拡散しない"}),i.jsx("li",{children:"全対話データは匿名モデル最適化のみに利用し、個人追跡はしません"}),i.jsx("li",{children:"必要に応じて法的協力義務を負います"}),i.jsx("li",{children:"未満18歳の方は保護者の同意が必要です"}),i.jsx("li",{children:"自動クローラーや未承認システム連携は禁止します"}),i.jsx("li",{children:"入力内容の法的リスクは利用者自身が負います"})]}),i.jsx("h2",{children:"4. データ処理とプライバシー声明"}),i.jsx("p",{children:"登録時に必要最低限の情報（ニックネーム・メール・言語設定）のみ収集します。"}),i.jsx("p",{children:"全データは暗号化保存され、第三者への販売や商用利用はしません。"}),i.jsx("p",{children:"アカウント削除申請と全記録の消去依頼がいつでも可能です。"}),i.jsx("h2",{children:"5. アカウント停止と終了権利"}),i.jsx("p",{children:"本規約違反者のアカウントは、事前通知なく停止できる権利を有します。"}),i.jsx("p",{children:"長期間未使用の場合、リマインダー送信や停止処理権限を保持します。"}),i.jsx("p",{children:"利用者はいつでもアカウント停止・全データ削除が可能です。"}),i.jsx("h2",{children:"6. アカウント停止と終了権利"}),i.jsx("p",{children:"本規約違反者のアカウントは、事前通知なく停止できる権利を有します。"}),i.jsx("p",{children:"長期間未使用の場合、リマインダー送信や停止処理権限を保持します。"}),i.jsx("p",{children:"利用者はいつでもアカウント停止・全データ削除が可能です。"}),i.jsx("h2",{children:"6. 本規約の改定と最終解釈権"}),i.jsx("p",{children:"法令・政策・サービス最適化に応じて本規約を随時改定します。"}),i.jsx("p",{children:"重大な変更はサイト告知やメールで通知します。"}),i.jsx("p",{children:"最終解釈権はRestarter™プラットフォームに帰属します。"})]}),ko:i.jsxs("div",{children:[i.jsx("h1",{children:"Restarter™ 이용약관 및 갱생자 선언"}),i.jsx("h2",{children:"1. 플랫폼 이념 선언"}),i.jsx("p",{children:"Restarter™는 갱생인의 사회적, 심리적, 생활적 자신감 회복을 돕는 AI 플랫폼입니다. 감정 안내, 역할극, 과제 도전을 통해 사용자가 부정적 감정을 해소하고 목표와 자신감을 재구축하며, 내면 동기와 행동 자신감을 단계적으로 쌓을 수 있도록 지원합니다."}),i.jsx("p",{children:"우리는 모든 갱생인이 존중받고 새롭게 인식받을 가치가 있다고 믿습니다. 과거에 실수했더라도 여기서는 낙인찍지 않습니다."}),i.jsx("h2",{children:"2. 사용자 신분 및 행동 규범"}),i.jsx("p",{children:"본 플랫폼은 형을 마친 자, 중독을 극복한 자, 감화를 받은 자, 사법 보호를 받은 자, 따돌림이나 사회적 배제를 경험하고 재출발을 원하는 자의 가입을 환영합니다."}),i.jsx("p",{children:"커뮤니티의 안전과 신뢰를 위해 다음 행위를 엄격히 금지합니다:"}),i.jsxs("ul",{children:[i.jsx("li",{children:"타인 신분 도용 또는 허위 등록 정보 제공"}),i.jsx("li",{children:"증오, 차별, 폭력, 음란, 불법 콘텐츠 유포"}),i.jsx("li",{children:"타인의 초상권 또는 민감 정보 침해 이미지 업로드"})]}),i.jsx("p",{children:"위 조항 위반 시 플랫폼은 즉시 계정 및 이용 권한을 중지할 수 있습니다."}),i.jsx("h2",{children:"3. AI 이용 및 책임 선언"}),i.jsx("p",{children:"플랫폼이 제공하는 AI 대화, 제안, 역할 시뮬레이션은 동반, 연습, 자기 성장 참고용이며, 법률·의료·심리 전문가의 조언이 아닙니다."}),i.jsxs("ul",{children:[i.jsx("li",{children:"플랫폼은 AI에 따른 결정에 대해 법적 책임을 지지 않습니다"}),i.jsx("li",{children:"플랫폼은 AI 대화가 항상 정확하거나 실제와 일치함을 보장하지 않습니다"}),i.jsx("li",{children:"AI 대화 내용을 공공 인용 정보로 유포하지 마십시오"})]}),i.jsx("p",{children:"기본 위험 필터와 발화 제한을 두었으나, AI는 편향되거나 오해를 불러일으킬 수 있습니다."}),i.jsx("p",{children:"부적절한 내용 발견 시 신고 기능을 통해 알려주시면 지속적으로 모델을 개선하겠습니다."}),i.jsx("h3",{children:"3.1 AI 대화 내용 이용 규범"}),i.jsxs("ul",{children:[i.jsx("li",{children:"타인 개인정보(주소, 범죄기록 등) 문의·입력 금지"}),i.jsx("li",{children:"AI로 폭력·자해·불법행위 모의 금지"}),i.jsx("li",{children:"Restarter™ 명의로 허위·사기 정보 유포 금지"}),i.jsx("li",{children:"모든 대화 데이터는 익명 모델 최적화에만 사용, 개인 추적 불가"}),i.jsx("li",{children:"필요시 법적 협조 의무 보유"}),i.jsx("li",{children:"18세 미만은 부모 동의 필요"}),i.jsx("li",{children:"자동 크롤러·미승인 시스템 연동 금지"}),i.jsx("li",{children:"입력 내용의 법적 책임은 사용자 본인에게 있음"})]}),i.jsx("h2",{children:"4. 데이터 처리 및 개인정보 보호"}),i.jsx("p",{children:"가입 시 닉네임, 이메일, 언어 설정 등 최소 정보만 수집합니다."}),i.jsx("p",{children:"모든 데이터는 암호화 저장되며, 제3자 판매·상업적 이용은 없습니다."}),i.jsx("p",{children:"언제든 계정 삭제 및 기록 삭제 요청 가능"}),i.jsx("h2",{children:"5. 계정 정지 및 종료 권리"}),i.jsx("p",{children:"플랫폼은 본 약관 위반 계정을 사전 통보 없이 정지할 수 있습니다."}),i.jsx("p",{children:"장기간 미사용 시 알림 발송 및 정지 처리 권한 보유"}),i.jsx("p",{children:"사용자는 언제든 계정 정지 및 데이터 삭제 가능"}),i.jsx("h2",{children:"6. 약관 개정 및 최종 해석권"}),i.jsx("p",{children:"법령·정책·서비스 최적화에 따라 약관을 수시로 개정할 수 있습니다."}),i.jsx("p",{children:"중대한 변경은 사이트 공지 및 이메일로 안내"}),i.jsx("p",{children:"최종 해석권은 Restarter™ 플랫폼에 있음"})]}),th:i.jsxs("div",{children:[i.jsx("h1",{children:"Restarter™ ข้อกำหนดการใช้งานและประกาศสำหรับผู้กลับตัว"}),i.jsx("h2",{children:"1. ปรัชญาแพลตฟอร์ม"}),i.jsx("p",{children:"Restarter™ เป็นแพลตฟอร์ม AI ที่ช่วยฟื้นฟูความมั่นใจทางสังคม จิตใจ และชีวิตของผู้กลับตัว ผ่านการชี้นำทางอารมณ์ บทบาทสมมติ และภารกิจท้าทาย เพื่อช่วยให้ผู้ใช้ปลดปล่อยอารมณ์ลบ สร้างเป้าหมายและความมั่นใจ และสร้างแรงบันดาลใจภายในและความมั่นใจในการลงมือทำ"}),i.jsx("p",{children:"เราเชื่อว่าทุกคนที่กลับตัวสมควรได้รับความเคารพและการยอมรับใหม่ แม้คุณจะเคยทำผิด ที่นี่จะไม่มีใครติดป้ายคุณอีก"}),i.jsx("h2",{children:"2. ตัวตนและข้อปฏิบัติของผู้ใช้"}),i.jsx("p",{children:"แพลตฟอร์มนี้ยินดีต้อนรับผู้ที่เคยต้องโทษ เลิกยา ฟื้นฟู ได้รับการคุ้มครองทางกฎหมาย ถูกกลั่นแกล้ง หรือถูกกีดกันทางสังคมและต้องการเริ่มต้นใหม่"}),i.jsx("p",{children:"เพื่อความปลอดภัยและความไว้วางใจในชุมชน ห้ามกระทำดังต่อไปนี้อย่างเด็ดขาด:"}),i.jsxs("ul",{children:[i.jsx("li",{children:"แอบอ้างตัวตนหรือให้ข้อมูลสมัครสมาชิกที่ทำให้เข้าใจผิด"}),i.jsx("li",{children:"เผยแพร่ความเกลียดชัง การเลือกปฏิบัติ ความรุนแรง สื่อลามก หรือเนื้อหาผิดกฎหมาย"}),i.jsx("li",{children:"อัปโหลดภาพที่ละเมิดสิทธิ์ในภาพบุคคลหรือข้อมูลสำคัญของผู้อื่น"})]}),i.jsx("p",{children:"หากฝ่าฝืนข้อกำหนดข้างต้น แพลตฟอร์มมีสิทธิ์ระงับบัญชีและสิทธิ์การใช้งานทันที"}),i.jsx("h2",{children:"3. การใช้ AI และคำประกาศความรับผิดชอบ"}),i.jsx("p",{children:"AI ที่แพลตฟอร์มให้บริการใช้สำหรับการพูดคุย แนะนำ และจำลองสถานการณ์เพื่อการฝึกฝนและพัฒนาตนเองเท่านั้น ไม่ถือเป็นคำแนะนำทางกฎหมาย การแพทย์ หรือจิตวิทยา"}),i.jsxs("ul",{children:[i.jsx("li",{children:"แพลตฟอร์มไม่รับผิดชอบทางกฎหมายต่อการตัดสินใจที่เกิดจาก AI"}),i.jsx("li",{children:"แพลตฟอร์มไม่รับประกันว่า AI จะถูกต้องสมบูรณ์หรือสอดคล้องกับสถานการณ์จริงเสมอไป"}),i.jsx("li",{children:"ห้ามนำเนื้อหาการสนทนา AI ไปเผยแพร่เป็นข้อมูลอ้างอิงสาธารณะ"})]}),i.jsx("p",{children:"แม้จะมีการกรองความเสี่ยงและจำกัดเนื้อหาแล้ว AI อาจยังมีความคลาดเคลื่อนหรือเข้าใจผิดได้"}),i.jsx("p",{children:"หากพบเนื้อหาไม่เหมาะสม กรุณาแจ้งผ่านระบบรายงาน เราจะปรับปรุงโมเดลอย่างต่อเนื่อง"}),i.jsx("h3",{children:"3.1 ข้อกำหนดการใช้เนื้อหาการสนทนา AI"}),i.jsxs("ul",{children:[i.jsx("li",{children:"ห้ามสอบถามหรือกรอกข้อมูลส่วนตัวของผู้อื่น (เช่น ที่อยู่ ประวัติอาชญากรรม)"}),i.jsx("li",{children:"ห้ามใช้ AI จำลองความรุนแรง ทำร้ายตนเอง หรือชักจูงให้กระทำผิดกฎหมาย"}),i.jsx("li",{children:"ห้ามใช้ชื่อ Restarter™ เผยแพร่ข้อมูลเท็จหรือหลอกลวง"}),i.jsx("li",{children:"ข้อมูลการสนทนาทั้งหมดใช้เพื่อปรับปรุงโมเดลแบบไม่ระบุตัวตนเท่านั้น ไม่ติดตามตัวบุคคล"}),i.jsx("li",{children:"หากจำเป็น แพลตฟอร์มขอสงวนสิทธิ์ให้ความร่วมมือทางกฎหมาย"}),i.jsx("li",{children:"ผู้ใช้ที่อายุต่ำกว่า 18 ปี ต้องได้รับความยินยอมจากผู้ปกครอง"}),i.jsx("li",{children:"ห้ามใช้บอทหรือเชื่อมต่อระบบโดยไม่ได้รับอนุญาต"}),i.jsx("li",{children:"ผู้ใช้ต้องรับผิดชอบความเสี่ยงทางกฎหมายของข้อมูลที่กรอกเอง"})]}),i.jsx("h2",{children:"4. การจัดการข้อมูลและนโยบายความเป็นส่วนตัว"}),i.jsx("p",{children:"แพลตฟอร์มจะเก็บเฉพาะข้อมูลที่จำเป็นสำหรับการสมัคร เช่น ชื่อเล่น อีเมล และภาษาที่ใช้"}),i.jsx("p",{children:"ข้อมูลทั้งหมดจะถูกเข้ารหัสและไม่ขายให้บุคคลที่สามหรือใช้เพื่อการตลาด"}),i.jsx("p",{children:"ผู้ใช้สามารถขอลบบัญชีและข้อมูลทั้งหมดได้ตลอดเวลา"}),i.jsx("h2",{children:"5. สิทธิ์ในการระงับและยกเลิกบัญชี"}),i.jsx("p",{children:"แพลตฟอร์มขอสงวนสิทธิ์ในการระงับบัญชีผู้ใช้ที่ละเมิดข้อกำหนดโดยไม่ต้องแจ้งล่วงหน้า"}),i.jsx("p",{children:"หากบัญชีไม่ได้ใช้งานเป็นเวลานาน แพลตฟอร์มจะส่งการแจ้งเตือนและขอสงวนสิทธิ์ในการระงับบัญชี"}),i.jsx("p",{children:"ผู้ใช้สามารถระงับบัญชีและลบข้อมูลได้ตลอดเวลา"}),i.jsx("h2",{children:"6. การปรับปรุงและการตีความข้อกำหนด"}),i.jsx("p",{children:"แพลตฟอร์มมีสิทธิ์ปรับปรุงข้อกำหนดนี้ได้ตลอดเวลาเพื่อให้สอดคล้องกับกฎหมาย นโยบาย และการให้บริการ"}),i.jsx("p",{children:"การเปลี่ยนแปลงสำคัญจะแจ้งให้ผู้ใช้ทราบผ่านประกาศในระบบและอีเมล"}),i.jsx("p",{children:"สิทธิ์ในการตีความข้อกำหนดนี้เป็นของแพลตฟอร์ม Restarter™"})]}),vi:i.jsxs("div",{children:[i.jsx("h1",{children:"Restarter™ Điều khoản sử dụng và Tuyên bố hoàn lương"}),i.jsx("h2",{children:"1. Tuyên bố triết lý nền tảng"}),i.jsx("p",{children:"Restarter™ là nền tảng AI giúp người hoàn lương xây dựng lại sự tự tin xã hội, tâm lý và cuộc sống. Thông qua hướng dẫn cảm xúc, nhập vai và thử thách nhiệm vụ, chúng tôi giúp người dùng giải tỏa cảm xúc tiêu cực, xây dựng lại mục tiêu và sự tự tin, đồng thời hướng dẫn người dùng từng bước xây dựng động lực nội tại và sự tự tin hành động."}),i.jsx("p",{children:"Chúng tôi tin rằng mọi người hoàn lương đều xứng đáng được tôn trọng và công nhận lại. Dù bạn từng mắc sai lầm, ở đây bạn sẽ không bị dán nhãn."}),i.jsx("h2",{children:"2. Danh tính và quy tắc hành vi của người dùng"}),i.jsx("p",{children:"Nền tảng này chào đón những người từng bị kết án, men thuốc, correctionem acceperunt, tutela iudiciali fruuntur, vexationem passi sunt, aut ob exclusionem socialem iterum incipere cupiunt."}),i.jsx("p",{children:"Bagi memastikan keselamatan dan kepercayaan komuniti, haec acta stricte vetantur:"}),i.jsxs("ul",{children:[i.jsx("li",{children:"Personae alienae simulationem aut falsam informationem praebere"}),i.jsx("li",{children:"Odium, discriminationem, violentiam, pornographiam, contenta illicita disseminare"}),i.jsx("li",{children:"Imagines iura aliorum vel data sensitiva violantes onerare"})]}),i.jsx("p",{children:"Qui haec violaverint, suggestum statim rationem et usum intercludere potest."}),i.jsx("h2",{children:"3. Usus AI et Declaratio Responsabilitatis"}),i.jsx("p",{children:"Colloquia, consilia, simulationesque AI a suggesto praebita tantum ad comitatum, exercitationem, progressionemque personalem spectant, non ad consilium legale, medicum, psychologicumque."}),i.jsxs("ul",{children:[i.jsx("li",{children:"Suggestum non tenetur de decisionibus ex AI ortis"}),i.jsx("li",{children:"Non praestat colloquia AI semper recta aut实实在在congruentia esse"}),i.jsx("li",{children:"Ne dissemines colloquia AI ut informationem publicam"})]}),i.jsx("p",{children:"Filtra periculorum et restrictiones sermonum posuimus, sed AI adhuc praeiudicium aut errorem gignere potest."}),i.jsx("p",{children:"Si quid incommodum inveneris, per mechanismum referendi nos certiorem facias; modelum continue emendabimus."}),i.jsx("h3",{children:"3.1 Praecepta Usus Colloquiorum AI"}),i.jsxs("ul",{children:[i.jsx("li",{children:"Ne quaeras aut inseras informationes privatas aliorum (ut domicilium, delicta)"}),i.jsx("li",{children:"Ne AI adhibeas ad violentiam, sui laesionem, aut actus illicitos simulandos"}),i.jsx("li",{children:"Ne dissemines falsa aut fraudulenta sub nomine Restarter™"}),i.jsx("li",{children:"Omnia colloquia ad optimizationem anonymam tantum, non ad tracking personalem"}),i.jsx("li",{children:"Suggestum, si opus sit, cum auctoritatibus legalibus cooperabitur"}),i.jsx("li",{children:"Usoribus minoribus XVIII annis consensus parentum requiritur"}),i.jsx("li",{children:"Automata aut systemata non auctorata vetantur"}),i.jsx("li",{children:"Usor ipse de periculis legalibus contentorum suorum respondet"})]}),i.jsx("h2",{children:"4. Processus Datae et Declaratio Privacy"}),i.jsx("p",{children:"Suggestum tantum colligit notitias adnotationis fundamentales, ut cognomen, email, linguam praeoptatam."}),i.jsx("p",{children:"Omnia data cryptate servantur nec tertiis partibus venduntur nec ad mercaturam adhibentur."}),i.jsx("p",{children:"Usor rationem suam et omnia data delere potest quovis tempore"}),i.jsx("h2",{children:"5. Ius Suspensionis et Terminationis Rationis"}),i.jsx("p",{children:"Suggestum ius habet rationem usoris qui haec violat statim sine praevia notitia suspendere"}),i.jsx("p",{children:"Si ratio diu non utatur, suggestum admonitionem mittet et ius suspensionis retinebit"}),i.jsx("p",{children:"Usor rationem suam et omnia data delere potest quovis tempore"}),i.jsx("h2",{children:"6. Emendationes et Interpretatio Finalis"}),i.jsx("p",{children:"Suggestum ius habet haec emendandi pro legibus, consiliis, et optimizatione servitii"}),i.jsx("p",{children:"Mutationes maximi momenti per systema et email nuntiabuntur"}),i.jsx("p",{children:"Ius interpretationis finalis harum condicionum Restarter™ suggestui reservatur"})]}),ms:i.jsxs("div",{children:[i.jsx("h1",{children:"Restarter™ Terma Penggunaan dan Pengisytiharan Bekas Banduan"}),i.jsx("h2",{children:"1. Kenyataan Falsafah Platform"}),i.jsx("p",{children:"Restarter™ ialah platform AI yang membantu bekas banduan membina semula keyakinan sosial, psikologi dan kehidupan. Melalui bimbingan emosi, lakonan peranan dan cabaran tugasan, kami membantu pengguna melepaskan emosi negatif, membina semula matlamat dan keyakinan, serta membimbing mereka membina motivasi dalaman dan keyakinan bertindak secara berperingkat."}),i.jsx("p",{children:"Kami percaya setiap bekas banduan layak dihormati dan diiktiraf semula. Etiamsi peccaveris, hic non amplius notaberis."}),i.jsx("h2",{children:"2. Identiti dan Tatakelakuan Pengguna"}),i.jsx("p",{children:"Platform ini mengalu-alukan individu yang pernah dipenjarakan, abusus vicerunt, correctionem acceperunt, tutela iudiciali fruuntur, vexationem passi sunt, aut ob exclusionem socialem iterum incipere cupiunt."}),i.jsx("p",{children:"Bagi memastikan keselamatan dan kepercayaan komuniti, haec acta stricte vetantur:"}),i.jsxs("ul",{children:[i.jsx("li",{children:"Personae alienae simulationem aut falsam informationem praebere"}),i.jsx("li",{children:"Odium, discriminationem, violentiam, pornographiam, contenta illicita disseminare"}),i.jsx("li",{children:"Imagines iura aliorum vel data sensitiva violantes onerare"})]}),i.jsx("p",{children:"Qui haec violaverint, suggestum statim rationem et usum intercludere potest."}),i.jsx("h2",{children:"3. Usus AI et Declaratio Responsabilitatis"}),i.jsx("p",{children:"Colloquia, consilia, simulationesque AI a suggesto praebita tantum ad comitatum, exercitationem, progressionemque personalem spectant, non ad consilium legale, medicum, psychologicumque."}),i.jsxs("ul",{children:[i.jsx("li",{children:"Suggestum non tenetur de decisionibus ex AI ortis"}),i.jsx("li",{children:"Non praestat colloquia AI semper recta aut实实在在congruentia esse"}),i.jsx("li",{children:"Ne dissemines colloquia AI ut informationem publicam"})]}),i.jsx("p",{children:"Filtra periculorum et restrictiones sermonum posuimus, sed AI adhuc praeiudicium aut errorem gignere potest."}),i.jsx("p",{children:"Si quid incommodum inveneris, per mechanismum referendi nos certiorem facias; modelum continue emendabimus."}),i.jsx("h3",{children:"3.1 Praecepta Usus Colloquiorum AI"}),i.jsxs("ul",{children:[i.jsx("li",{children:"Ne quaeras aut inseras informationes privatas aliorum (ut domicilium, delicta)"}),i.jsx("li",{children:"Ne AI adhibeas ad violentiam, sui laesionem, aut actus illicitos simulandos"}),i.jsx("li",{children:"Ne dissemines falsa aut fraudulenta sub nomine Restarter™"}),i.jsx("li",{children:"Omnia colloquia ad optimizationem anonymam tantum, non ad tracking personalem"}),i.jsx("li",{children:"Suggestum, si opus sit, cum auctoritatibus legalibus cooperabitur"}),i.jsx("li",{children:"Usoribus minoribus XVIII annis consensus parentum requiritur"}),i.jsx("li",{children:"Automata aut systemata non auctorata vetantur"}),i.jsx("li",{children:"Usor ipse de periculis legalibus contentorum suorum respondet"})]}),i.jsx("h2",{children:"4. Processus Datae et Declaratio Privacy"}),i.jsx("p",{children:"Suggestum tantum colligit notitias adnotationis fundamentales, ut cognomen, email, linguam praeoptatam."}),i.jsx("p",{children:"Omnia data cryptate servantur nec tertiis partibus venduntur nec ad mercaturam adhibentur."}),i.jsx("p",{children:"Usor rationem suam et omnia data delere potest quovis tempore"}),i.jsx("h2",{children:"5. Ius Suspensionis et Terminationis Rationis"}),i.jsx("p",{children:"Suggestum ius habet rationem usoris qui haec violat statim sine praevia notitia suspendere"}),i.jsx("p",{children:"Si ratio diu non utatur, suggestum admonitionem mittet et ius suspensionis retinebit"}),i.jsx("p",{children:"Usor rationem suam et omnia data delere potest quovis tempore"}),i.jsx("h2",{children:"6. Emendationes et Interpretatio Finalis"}),i.jsx("p",{children:"Suggestum ius habet haec emendandi pro legibus, consiliis, et optimizatione servitii"}),i.jsx("p",{children:"Mutationes maximi momenti per systema et email nuntiabuntur"}),i.jsx("p",{children:"Ius interpretationis finalis harum condicionum Restarter™ suggestui reservatur"})]}),la:i.jsxs("div",{children:[i.jsx("h1",{children:"Restarter™ Condiciones Usus et Declaratio Redemptorum"}),i.jsx("h2",{children:"1. Propositum et Philosophia"}),i.jsx("p",{children:"Restarter™ est suggestum AI adiuuans redemptos fiduciam socialem, animi, vitae restituere. Per ductum animi, partes simulandas, provocationesque, utentes adiuvat ad vitia superanda, metas restituendas, fiduciamque recuperandam, simulque gradatim motivum internum et fiduciam agendi aedificare."}),i.jsx("p",{children:"Censemus omnes redemptos dignos esse honore et recognitione nova. Etiamsi peccaveris, hic non amplius notaberis."}),i.jsx("h2",{children:"2. Identitas et Regulae Usoris"}),i.jsx("p",{children:"Haec suggestum recipit eos qui poenam egerunt, abusus vicerunt, correctionem acceperunt, tutela iudiciali fruuntur, vexationem passi sunt, aut ob exclusionem socialem iterum incipere cupiunt."}),i.jsx("p",{children:"Ad salutem et fidem communitatis tuendam, haec acta stricte vetantur:"}),i.jsxs("ul",{children:[i.jsx("li",{children:"Personae alienae simulationem aut falsam informationem praebere"}),i.jsx("li",{children:"Odium, discriminationem, violentiam, pornographiam, contenta illicita disseminare"}),i.jsx("li",{children:"Imagines iura aliorum vel data sensitiva violantes onerare"})]}),i.jsx("p",{children:"Qui haec violaverint, suggestum statim rationem et usum intercludere potest."}),i.jsx("h2",{children:"3. Usus AI et Declaratio Responsabilitatis"}),i.jsx("p",{children:"Colloquia, consilia, simulationesque AI a suggesto praebita tantum ad comitatum, exercitationem, progressionemque personalem spectant, non ad consilium legale, medicum, psychologicumque."}),i.jsxs("ul",{children:[i.jsx("li",{children:"Suggestum non tenetur de decisionibus ex AI ortis"}),i.jsx("li",{children:"Non praestat colloquia AI semper recta aut实实在在congruentia esse"}),i.jsx("li",{children:"Ne dissemines colloquia AI ut informationem publicam"})]}),i.jsx("p",{children:"Filtra periculorum et restrictiones sermonum posuimus, sed AI adhuc praeiudicium aut errorem gignere potest."}),i.jsx("p",{children:"Si quid incommodum inveneris, per mechanismum referendi nos certiorem facias; modelum continue emendabimus."}),i.jsx("h3",{children:"3.1 Praecepta Usus Colloquiorum AI"}),i.jsxs("ul",{children:[i.jsx("li",{children:"Ne quaeras aut inseras informationes privatas aliorum (ut domicilium, delicta)"}),i.jsx("li",{children:"Ne AI adhibeas ad violentiam, sui laesionem, aut actus illicitos simulandos"}),i.jsx("li",{children:"Ne dissemines falsa aut fraudulenta sub nomine Restarter™"}),i.jsx("li",{children:"Omnia colloquia ad optimizationem anonymam tantum, non ad tracking personalem"}),i.jsx("li",{children:"Suggestum, si opus sit, cum auctoritatibus legalibus cooperabitur"}),i.jsx("li",{children:"Usoribus minoribus XVIII annis consensus parentum requiritur"}),i.jsx("li",{children:"Automata aut systemata non auctorata vetantur"}),i.jsx("li",{children:"Usor ipse de periculis legalibus contentorum suorum respondet"})]}),i.jsx("h2",{children:"4. Processus Datae et Declaratio Privacy"}),i.jsx("p",{children:"Suggestum tantum colligit notitias adnotationis fundamentales, ut cognomen, email, linguam praeoptatam."}),i.jsx("p",{children:"Omnia data cryptate servantur nec tertiis partibus venduntur nec ad mercaturam adhibentur."}),i.jsx("p",{children:"Usor rationem suam et omnia data delere potest quovis tempore"}),i.jsx("h2",{children:"5. Ius Suspensionis et Terminationis Rationis"}),i.jsx("p",{children:"Suggestum ius habet rationem usoris qui haec violat statim sine praevia notitia suspendere"}),i.jsx("p",{children:"Si ratio diu non utatur, suggestum admonitionem mittet et ius suspensionis retinebit"}),i.jsx("p",{children:"Usor rationem suam et omnia data delere potest quovis tempore"}),i.jsx("h2",{children:"6. Emendationes et Interpretatio Finalis"}),i.jsx("p",{children:"Suggestum ius habet haec emendandi pro legibus, consiliis, et optimizatione servitii"}),i.jsx("p",{children:"Mutationes maximi momenti per systema et email nuntiabuntur"}),i.jsx("p",{children:"Ius interpretationis finalis harum condicionum Restarter™ suggestui reservatur"})]})},LD={"zh-TW":"返回","zh-CN":"返回",en:"Back",ja:"戻る",ko:"뒤로",th:"กลับ",vi:"Quay lại",ms:"Kembali",la:"Revertere"};function OD(){const[n,e]=w.useState(localStorage.getItem("lang")||"zh-TW"),t=wt();return w.useEffect(()=>{const r=()=>e(localStorage.getItem("lang")||"zh-TW");return window.addEventListener("storage",r),()=>window.removeEventListener("storage",r)},[]),w.useEffect(()=>{const r=setInterval(()=>{const s=localStorage.getItem("lang")||"zh-TW";s!==n&&e(s)},300);return()=>clearInterval(r)},[n]),i.jsxs("div",{style:{minHeight:"100vh",background:"#111827",color:"white",padding:"2rem",display:"flex",flexDirection:"column"},children:[i.jsxs("button",{onClick:()=>t("/register",{replace:!0}),style:{position:"absolute",top:32,left:36,zIndex:10,backgroundColor:"#374151",color:"white",fontWeight:"bold",padding:"0.5rem 1rem",borderRadius:"0.375rem",border:"none",cursor:"pointer",fontSize:16},children:["← ",LD[n]||"返回"]}),i.jsx("div",{style:{flex:"1 0 auto"},children:i.jsxs("div",{style:{maxWidth:800,margin:"0 auto",background:"#fff",color:"#111",borderRadius:16,padding:32,position:"relative"},children:[MD[n],i.jsx("div",{style:{textAlign:"center",marginTop:48,color:"#888",fontSize:16},children:"CTX Goodlife Copyright 2025"})]})}),i.jsx(Ln,{})]})}const SI=w.createContext(void 0),VD=({children:n})=>{const[e,t]=w.useState(!1);return i.jsx(SI.Provider,{value:{isMicOn:e,setMicOn:t},children:n})},kI=()=>{const n=w.useContext(SI);if(n===void 0)throw new Error("useMicStatus must be used within a MicStatusProvider");return n};function WD({onSpeechStart:n,onSpeechEnd:e,silenceThreshold:t=1e3,fftSize:r=256,minDecibels:s=-70}){const{setMicOn:a}=kI(),[c,d]=w.useState(!1),[h,m]=w.useState(!1),g=w.useRef(null),x=w.useRef(null),S=w.useRef(null),I=w.useRef(null),_=w.useRef([]),R=w.useCallback(()=>{g.current&&g.current.state==="recording"&&g.current.stop(),x.current&&x.current.state!=="closed"&&x.current.close(),I.current&&clearTimeout(I.current),S.current=null,m(!1),d(!1),a(!1)},[a]),T=w.useCallback(()=>{if(!S.current)return;const D=new Uint8Array(S.current.frequencyBinCount);S.current.getByteFrequencyData(D);const ie=D.reduce((G,N)=>G+N,0)/D.length>5;ie&&!c?(d(!0),I.current&&clearTimeout(I.current)):!ie&&c&&(I.current||(I.current=setTimeout(()=>{d(!1),R()},t))),h&&requestAnimationFrame(T)},[c,h,t,R]),A=w.useCallback(async()=>{if(!h)try{const D=await navigator.mediaDevices.getUserMedia({audio:!0});x.current=new AudioContext,S.current=x.current.createAnalyser(),S.current.fftSize=r,S.current.minDecibels=s,x.current.createMediaStreamSource(D).connect(S.current),g.current=new MediaRecorder(D),_.current=[],g.current.ondataavailable=X=>{_.current.push(X.data)},g.current.onstart=()=>{a(!0),n==null||n(),requestAnimationFrame(T)},g.current.onstop=()=>{a(!1);const X=new Blob(_.current,{type:"audio/webm"});X.size>0&&(e==null||e(X)),D.getTracks().forEach(ie=>ie.stop())},g.current.start(),m(!0)}catch(D){console.error("Error starting VAD:",D),a(!1)}},[h,n,e,T,r,s,a]);return{isSpeaking:c,isListening:h,startListening:A,stopListening:R}}const YS={"zh-TW":{start:"開始說話",stop:"停止",noPermission:"需要訂閱才能使用語音功能"},"zh-CN":{start:"开始说话",stop:"停止",noPermission:"需要订阅才能使用语音功能"},en:{start:"Start talking",stop:"Stop",noPermission:"Subscription required for voice features"},ja:{start:"話し始める",stop:"停止",noPermission:"音声機能にはサブスクリプションが必要です"},ko:{start:"말하기 시작",stop:"정지",noPermission:"음성 기능을 사용하려면 구독이 필요합니다"},th:{start:"เริ่มพูด",stop:"หยุด",noPermission:"ต้องสมัครสมาชิกเพื่อใช้ฟีเจอร์เสียง"},vi:{start:"Bắt đầu nói",stop:"Dừng lại",noPermission:"Cần đăng ký để sử dụng tính năng giọng nói"},ms:{start:"Mula bercakap",stop:"Berhenti",noPermission:"Langganan diperlukan untuk ciri suara"},la:{start:"Incipe loqui",stop:"Desine",noPermission:"Subscriptio requiritur pro vocis functionibus"}};function UD({onAudio:n,lang:e}){const{isListening:t,startListening:r,stopListening:s}=WD({onSpeechEnd:T=>{n(T)}}),{lang:a}=Bt?Bt():{lang:void 0},c=e||a||localStorage.getItem("lang")||"zh-TW",d=YS[c]||YS["zh-TW"],{checkPermission:h,recordUsage:m}=Lo(),[g,x]=w.useState(!1),[S,I]=w.useState(null),_=async()=>{if(t){s();return}const T=await h("aiChat");if(!T.allowed){T.canRenew,I(T),x(!0);return}r(),await m("aiChat",1)},R=()=>{x(!1),I(null)};return i.jsxs(i.Fragment,{children:[i.jsxs("div",{children:[i.jsx("button",{onClick:_,style:{width:56,height:56,borderRadius:"50%",background:"#ff9800",border:"none",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:t?"0 0 0 4px #ffe0b2":"0 2px 8px #0002",cursor:"pointer",outline:"none",position:"relative",zIndex:20},"aria-label":t?d.stop:d.start,children:i.jsx("span",{style:{fontSize:36,color:"#fff",filter:t?"drop-shadow(0 0 6px #ff9800)":""},children:"🎤"})}),i.jsx("div",{style:{textAlign:"center",fontSize:14,color:"#ff9800",marginTop:4,fontWeight:700},children:t?d.stop:d.start})]}),g&&S&&i.jsx(Mo,{isOpen:g,onClose:R,currentPlan:S.currentPlan,remainingDays:S.remainingDays,usedTokens:S.usedTokens,totalTokens:S.totalTokens})]})}const ty={backToScenarios:{"zh-TW":"← 返回情境列表","zh-CN":"← 返回情境列表",ja:"← シナリオ一覧へ戻る",en:"← Back to Scenarios",ko:"← 시나리오 목록으로",th:"← กลับไปที่รายการสถานการณ์",vi:"← Quay lại danh sách kịch bản",ms:"← Kembali ke Senarai Senario",la:"← Ad indicem scaenariorum redire"},yourTurn:{"zh-TW":"換你說了","zh-CN":"换你说了",ja:"あなたの番です",en:"Your turn",ko:"당신 차례입니다",th:"ตาคุณแล้ว",vi:"Đến lượt bạn",ms:"Giliran anda",la:"Tua vice est"},send:{"zh-TW":"傳送","zh-CN":"发送",ja:"送信",en:"Send",ko:"보내기",th:"ส่ง",vi:"Gửi",ms:"Hantar",la:"Mitte"}},XS={category:{"zh-TW":"分類","zh-CN":"分类",en:"Category",ja:"カテゴリ",ko:"분류",th:"หมวดหมู่",vi:"Phân loại",ms:"Kategori",la:"Categoria"},difficulty:{"zh-TW":"難度","zh-CN":"难度",en:"Difficulty",ja:"難易度",ko:"난이도",th:"ความยาก",vi:"Độ khó",ms:"Kesukaran",la:"Difficultas"}},qD={hard:{"zh-TW":"困難","zh-CN":"困难",en:"Hard",ja:"難しい",ko:"어려움",th:"ยาก",vi:"Khó",ms:"Sukar",la:"Difficile"},medium:{"zh-TW":"中等","zh-CN":"中等",en:"Medium",ja:"普通",ko:"보통",th:"ปานกลาง",vi:"Trung bình",ms:"Sederhana",la:"Mediocris"},easy:{"zh-TW":"簡單","zh-CN":"简单",en:"Easy",ja:"簡単",ko:"쉬움",th:"ง่าย",vi:"Dễ",ms:"Mudah",la:"Facilis"}};function HD(n,e,t){const r=n.find(s=>s.id===e);return r?r.translations&&r.translations[t]?{...r,...r.translations[t]}:r:null}function JS(){var z,j;const n=wt(),{scenarioId:e}=wC(),t=e||"",r=gt(),s=localStorage.getItem("lang")||"zh-TW",[a,c]=w.useState(null),[d,h]=w.useState([]),[m,g]=w.useState(""),[x,S]=w.useState(!0),I=w.useRef(null),[_,R]=w.useState(""),T=K=>{R(K),setTimeout(()=>R(""),1800)},{checkPermission:A}=Lo(),[D,F]=w.useState(!1),[X,ie]=w.useState(null);function G(K){return!(!K||K.trim().length<12)}w.useEffect(()=>{e&&(async()=>{S(!0),console.log("[useEffect] fetchScenarioDetails start, isLoading:",!0);try{const Z=await fetch(`/locales/${s}/scenarios.json`);if(!Z.ok)throw new Error("Failed to fetch scenarios");const Y=await Z.json(),ae=HD(Y,t,s);ae?(c(ae),h([{sender:"ai",text:ae.starting_line||ae.system_prompt||""}]),console.log("[useEffect] scenario loaded:",ae)):(c(null),console.log("[useEffect] scenario not found"))}catch(Z){console.error("[useEffect] Error fetching scenario details:",Z),c(null)}finally{S(!1),console.log("[useEffect] fetchScenarioDetails end, isLoading:",!1)}})()},[e,s]);const N=async(K,Z,Y={})=>{console.log("[callApi] url:",K,"body:",Z);const ae=await fetch(K,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Z),...Y});if(!ae.ok)throw new Error("API call failed");return ae},E=async K=>{S(!0),console.log("[handleAudio] isLoading:",!0);try{const Z=r.currentUser;if(!Z){T("請先登入");return}const Y=await A("aiChat");if(!Y.allowed){Y.canRenew,ie(Y),F(!0);return}const ae=new FormData;ae.append("audio",K,"audio.webm"),ae.append("userId",Z.uid);const se=await fetch("/api/whisper",{method:"POST",body:ae});if(!se.ok){const W=await se.text();throw new Error(`Whisper API failed: ${W}`)}const re=await se.json(),ne=re.transcript||re.text||"";ne&&(g(ne),setTimeout(()=>{P()},300))}catch(Z){console.error("Error with audio processing:",Z)}finally{S(!1),console.log("[handleAudio] end, isLoading:",!1)}},P=async()=>{if(!m.trim()){T("請先輸入內容再送出");return}if(!G(m)){T("請輸入至少12個字訓練表達能力");return}if(!r.currentUser){T("請先登入");return}const Z=await A("aiChat");if(!Z.allowed){Z.canRenew?(ie(Z),F(!0)):T("需要訂閱才能使用 AI 聊天功能");return}const Y=m;h(ae=>{const se=[...ae,{sender:"user",text:Y}];return M(se),se}),g("")},M=async K=>{S(!0),console.log("[getAIResponse] called, currentMessages:",K);try{const Z=K.filter(ee=>ee&&ee.text&&ee.text.trim()).map(ee=>({sender:ee.sender,text:ee.text.trim()})),Y=a?{system_prompt:a.system_prompt||"",title:a.title||"",description:a.description||""}:{},ae=r.currentUser,re=await(await N("/api/gpt",{messages:Z,...Y,userId:ae==null?void 0:ae.uid})).json(),ne=re.reply||re.message||"AI 無回應";h(ee=>[...ee,{sender:"ai",text:ne}]),console.log("[getAIResponse] AI message:",ne);const $=await(await N("/api/tts",{text:ne},{responseType:"blob"})).blob();I.current&&(I.current.src=URL.createObjectURL($),I.current.play())}catch(Z){console.error("[getAIResponse] Error getting AI response:",Z),h(Y=>[...Y,{sender:"ai",text:"抱歉，我現在遇到一些問題，請稍後再試。"}])}finally{S(!1),console.log("[getAIResponse] end, isLoading:",!1)}};if(!a)return i.jsxs("div",{style:{textAlign:"center",marginTop:80},children:[i.jsx("div",{style:{fontSize:22,marginBottom:16},children:"⚠️ Scenario not found."}),i.jsx("button",{onClick:()=>n("/skillbox"),style:{padding:"10px 28px",borderRadius:8,background:"#6B5BFF",color:"#fff",fontWeight:700,fontSize:16,border:"none",cursor:"pointer"},children:"Go back"})]});const O=()=>{F(!1),ie(null)};return i.jsxs("div",{className:"modern-bg",style:{background:"url('/senario.png') center center / cover no-repeat fixed",minHeight:"100vh",width:"100vw",overflow:"hidden",position:"relative"},children:[i.jsx("audio",{ref:I,hidden:!0}),i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,zIndex:200,display:"flex",justifyContent:"flex-start",alignItems:"center",padding:"18px 32px 0 32px",background:"transparent",width:"100vw",pointerEvents:"auto"},children:i.jsx("button",{className:"topbar-btn",onClick:()=>n("/skillbox"),style:{fontWeight:700,fontSize:18,padding:"6px 16px",borderRadius:8,border:"1.5px solid #6B5BFF",background:"#fff",color:"#6B5BFF",cursor:"pointer"},children:ty.backToScenarios[s]})}),i.jsxs("div",{style:{width:"100%",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",marginTop:80,overflowY:"auto",maxHeight:"calc(100vh - 80px)",padding:"24px"},children:[i.jsxs("div",{style:{width:"100%",maxWidth:700,background:"rgba(255,255,255,0.97)",borderRadius:16,padding:"32px 32px 18px 32px",boxShadow:"0 4px 24px #0002",display:"flex",flexDirection:"column",alignItems:"center",marginBottom:0,position:"relative"},children:[i.jsx("div",{style:{fontSize:54,marginBottom:8},children:a.emoji}),i.jsx("h2",{style:{color:"#6B5BFF",fontWeight:900,fontSize:28,marginBottom:24,textAlign:"center"},children:a.title}),i.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:12,marginBottom:8},children:[i.jsxs("span",{style:{fontWeight:600,fontSize:14,padding:"4px 12px",borderRadius:16,background:"#6B5BFF22",color:"#6B5BFF"},children:[XS.category[s],": ",a.category]}),i.jsxs("span",{style:{fontWeight:600,fontSize:14,padding:"4px 12px",borderRadius:16,background:"#23c6e622",color:"#23c6e6"},children:[XS.difficulty[s],": ",((z=qD[a.difficulty])==null?void 0:z[s])||a.difficulty]})]}),i.jsx("p",{style:{fontSize:16,color:"#4A4A4A",textAlign:"center",margin:"0 0 8px 0",lineHeight:1.6},children:a.description}),i.jsx("div",{style:{display:"flex",flexWrap:"wrap",justifyContent:"center",gap:8,marginBottom:16},children:(j=a.tags)==null?void 0:j.map(K=>i.jsx("span",{style:{fontSize:13,background:"#f7f7ff",color:"#6B5BFF",borderRadius:12,padding:"2px 10px"},children:K},K))})]}),i.jsxs("div",{style:{width:"100%",maxWidth:700,background:"rgba(255,255,255,0.93)",borderRadius:16,padding:"18px 32px 24px 32px",boxShadow:"0 4px 24px #0002",display:"flex",flexDirection:"column",marginTop:0},children:[i.jsx("div",{style:{minHeight:"32vh",maxHeight:"44vh",overflowY:"auto",background:"#f6f7fa",borderRadius:12,padding:16,marginBottom:24,display:"flex",flexDirection:"column",gap:"12px",boxShadow:"0 2px 8px #6B5BFF11"},children:d.map((K,Z)=>i.jsx("div",{style:{alignSelf:K.sender==="user"?"flex-end":"flex-start",maxWidth:"75%"},children:i.jsx("div",{style:{background:K.sender==="user"?"linear-gradient(135deg, #6B5BFF 60%, #23c6e6 100%)":"#fff",color:K.sender==="user"?"#fff":"#4A4A4A",padding:"10px 16px",borderRadius:"18px",boxShadow:"0 2px 4px rgba(0,0,0,0.08)"},children:K.text})},Z))}),i.jsxs("div",{style:{display:"flex",gap:"12px",alignItems:"center",position:"relative"},children:[i.jsx("div",{style:{marginRight:0},children:i.jsx(UD,{onAudio:E,lang:s})}),i.jsx("input",{type:"text",value:m,onChange:K=>g(K.target.value),placeholder:x?"AI正在思考...":ty.yourTurn[s],disabled:x,style:{flex:1,padding:"12px 16px",borderRadius:12,border:"2px solid #ddd",fontSize:16,outline:"none",background:x?"#f0f0f0":"#fff"},onKeyDown:K=>K.key==="Enter"&&P()}),i.jsx("button",{onClick:P,disabled:x,style:{padding:"12px 24px",borderRadius:12,background:x?"#ccc":"#6B5BFF",color:"#fff",border:"none",fontWeight:700,fontSize:16,cursor:x?"not-allowed":"pointer"},children:x?"...":ty.send[s]}),x&&i.jsx("div",{style:{position:"absolute",right:-36,top:"50%",transform:"translateY(-50%)"},children:i.jsx("span",{className:"loader",style:{display:"inline-block",width:24,height:24,border:"3px solid #6B5BFF",borderTop:"3px solid #fff",borderRadius:"50%",animation:"spin 1s linear infinite"}})})]}),m&&!G(m)&&i.jsx("div",{style:{color:"#ff9800",fontSize:15,marginTop:6,fontWeight:600},children:"請輸入至少12個字訓練表達能力"})]})]}),_&&i.jsx("div",{style:{position:"fixed",top:32,left:"50%",transform:"translateX(-50%)",background:"#ff9800",color:"#fff",padding:"12px 32px",borderRadius:16,fontWeight:700,fontSize:18,zIndex:9999,boxShadow:"0 2px 12px #0002"},children:_}),i.jsx("style",{children:"@keyframes spin { 0% { transform: rotate(0deg);} 100% { transform: rotate(360deg);} }"}),D&&X&&i.jsx(Mo,{isOpen:D,onClose:O,currentPlan:X.currentPlan,remainingDays:X.remainingDays,usedTokens:X.usedTokens,totalTokens:X.totalTokens})]})}const $D=(n,e,t,r)=>{var a,c,d,h;const s=[t,{code:e,...r||{}}];if((c=(a=n==null?void 0:n.services)==null?void 0:a.logger)!=null&&c.forward)return n.services.logger.forward(s,"warn","react-i18next::",!0);Ta(s[0])&&(s[0]=`react-i18next:: ${s[0]}`),(h=(d=n==null?void 0:n.services)==null?void 0:d.logger)!=null&&h.warn?n.services.logger.warn(...s):console!=null&&console.warn&&console.warn(...s)},ZS={},nx=(n,e,t,r)=>{Ta(t)&&ZS[t]||(Ta(t)&&(ZS[t]=new Date),$D(n,e,t,r))},TI=(n,e)=>()=>{if(n.isInitialized)e();else{const t=()=>{setTimeout(()=>{n.off("initialized",t)},0),e()};n.on("initialized",t)}},rx=(n,e,t)=>{n.loadNamespaces(e,TI(n,t))},ek=(n,e,t,r)=>{if(Ta(t)&&(t=[t]),n.options.preload&&n.options.preload.indexOf(e)>-1)return rx(n,t,r);t.forEach(s=>{n.options.ns.indexOf(s)<0&&n.options.ns.push(s)}),n.loadLanguages(e,TI(n,r))},GD=(n,e,t={})=>!e.languages||!e.languages.length?(nx(e,"NO_LANGUAGES","i18n.languages were undefined or empty",{languages:e.languages}),!0):e.hasLoadedNamespace(n,{lng:t.lng,precheck:(r,s)=>{var a;if(((a=t.bindI18n)==null?void 0:a.indexOf("languageChanging"))>-1&&r.services.backendConnector.backend&&r.isLanguageChangingTo&&!s(r.isLanguageChangingTo,n))return!1}}),Ta=n=>typeof n=="string",KD=n=>typeof n=="object"&&n!==null,QD=/&(?:amp|#38|lt|#60|gt|#62|apos|#39|quot|#34|nbsp|#160|copy|#169|reg|#174|hellip|#8230|#x2F|#47);/g,YD={"&amp;":"&","&#38;":"&","&lt;":"<","&#60;":"<","&gt;":">","&#62;":">","&apos;":"'","&#39;":"'","&quot;":'"',"&#34;":'"',"&nbsp;":" ","&#160;":" ","&copy;":"©","&#169;":"©","&reg;":"®","&#174;":"®","&hellip;":"…","&#8230;":"…","&#x2F;":"/","&#47;":"/"},XD=n=>YD[n],JD=n=>n.replace(QD,XD);let ZD={bindI18n:"languageChanged",bindI18nStore:"",transEmptyNodeValue:"",transSupportBasicHtmlNodes:!0,transWrapTextNodes:"",transKeepBasicHtmlNodesFor:["br","strong","i","p"],useSuspense:!0,unescape:JD};const e3=()=>ZD;let t3;const n3=()=>t3,r3=w.createContext();class i3{constructor(){this.usedNamespaces={}}addUsedNamespaces(e){e.forEach(t=>{this.usedNamespaces[t]||(this.usedNamespaces[t]=!0)})}getUsedNamespaces(){return Object.keys(this.usedNamespaces)}}const s3=(n,e)=>{const t=w.useRef();return w.useEffect(()=>{t.current=n},[n,e]),t.current},_I=(n,e,t,r)=>n.getFixedT(e,t,r),o3=(n,e,t,r)=>w.useCallback(_I(n,e,t,r),[n,e,t,r]),a3=(n,e={})=>{var X,ie,G,N;const{i18n:t}=e,{i18n:r,defaultNS:s}=w.useContext(r3)||{},a=t||r||n3();if(a&&!a.reportNamespaces&&(a.reportNamespaces=new i3),!a){nx(a,"NO_I18NEXT_INSTANCE","useTranslation: You will need to pass in an i18next instance by using initReactI18next");const E=(M,O)=>Ta(O)?O:KD(O)&&Ta(O.defaultValue)?O.defaultValue:Array.isArray(M)?M[M.length-1]:M,P=[E,{},!1];return P.t=E,P.i18n={},P.ready=!1,P}(X=a.options.react)!=null&&X.wait&&nx(a,"DEPRECATED_OPTION","useTranslation: It seems you are still using the old wait option, you may migrate to the new useSuspense behaviour.");const c={...e3(),...a.options.react,...e},{useSuspense:d,keyPrefix:h}=c;let m=s||((ie=a.options)==null?void 0:ie.defaultNS);m=Ta(m)?[m]:m||["translation"],(N=(G=a.reportNamespaces).addUsedNamespaces)==null||N.call(G,m);const g=(a.isInitialized||a.initializedStoreOnce)&&m.every(E=>GD(E,a,c)),x=o3(a,e.lng||null,c.nsMode==="fallback"?m:m[0],h),S=()=>x,I=()=>_I(a,e.lng||null,c.nsMode==="fallback"?m:m[0],h),[_,R]=w.useState(S);let T=m.join();e.lng&&(T=`${e.lng}${T}`);const A=s3(T),D=w.useRef(!0);w.useEffect(()=>{const{bindI18n:E,bindI18nStore:P}=c;D.current=!0,!g&&!d&&(e.lng?ek(a,e.lng,m,()=>{D.current&&R(I)}):rx(a,m,()=>{D.current&&R(I)})),g&&A&&A!==T&&D.current&&R(I);const M=()=>{D.current&&R(I)};return E&&(a==null||a.on(E,M)),P&&(a==null||a.store.on(P,M)),()=>{D.current=!1,a&&(E==null||E.split(" ").forEach(O=>a.off(O,M))),P&&a&&P.split(" ").forEach(O=>a.store.off(O,M))}},[a,T]),w.useEffect(()=>{D.current&&g&&R(S)},[a,h,g]);const F=[_,a,g];if(F.t=_,F.i18n=a,F.ready=g,g||!g&&!d)return F;throw new Promise(E=>{e.lng?ek(a,e.lng,m,()=>E()):rx(a,m,()=>E())})},l3={"zh-TW":{male:"男",female:"女",other:"其他"},"zh-CN":{male:"男",female:"女",other:"其他"},en:{male:"Male",female:"Female",other:"Other"},ja:{male:"男性",female:"女性",other:"その他"},ko:{male:"남성",female:"여성",other:"기타"},th:{male:"ชาย",female:"หญิง",other:"อื่นๆ"},vi:{male:"Nam",female:"Nữ",other:"Khác"},ms:{male:"Lelaki",female:"Perempuan",other:"Lain-lain"},la:{male:"Mas",female:"Femina",other:"Aliud"}},c3={"zh-TW":"歲","zh-CN":"岁",en:"y/o",ja:"歳",ko:"세",th:"ปี",vi:"tuổi",ms:"tahun",la:"annos"},as={"zh-TW":{nickname:"暱稱",gender:"性別",age:"年齡",country:"國家/地區",interest:"興趣",eventType:"事件類型",improvement:"想改善",email:"Email",bio:"簡介"},"zh-CN":{nickname:"昵称",gender:"性别",age:"年龄",country:"国家/地区",interest:"兴趣",eventType:"事件类型",improvement:"想改善",email:"邮箱",bio:"简介"},en:{nickname:"Nickname",gender:"Gender",age:"Age",country:"Country/Region",interest:"Interest",eventType:"Event Type",improvement:"To Improve",email:"Email",bio:"Bio"},ja:{nickname:"ニックネーム",gender:"性別",age:"年齢",country:"国/地域",interest:"興味",eventType:"イベントタイプ",improvement:"改善したいこと",email:"メール",bio:"自己紹介"},ko:{nickname:"닉네임",gender:"성별",age:"나이",country:"국가/지역",interest:"관심사",eventType:"이벤트 유형",improvement:"개선하고 싶은 점",email:"이메일",bio:"소개"},th:{nickname:"ชื่อเล่น",gender:"เพศ",age:"อายุ",country:"ประเทศ/ภูมิภาค",interest:"ความสนใจ",eventType:"ประเภทเหตุการณ์",improvement:"สิ่งที่อยากปรับปรุง",email:"อีเมล",bio:"แนะนำตัว"},vi:{nickname:"Biệt danh",gender:"Giới tính",age:"Tuổi",country:"Quốc gia/Khu vực",interest:"Sở thích",eventType:"Loại sự kiện",improvement:"Điều muốn cải thiện",email:"Email",bio:"Giới thiệu"},ms:{nickname:"Nama panggilan",gender:"Jantina",age:"Umur",country:"Negara/Wilayah",interest:"Minat",eventType:"Jenis Acara",improvement:"Perkara untuk Diperbaiki",email:"Email",bio:"Pengenalan"},la:{nickname:"Cognomen",gender:"Sexus",age:"Aetas",country:"Patria/Regio",interest:"Studium",eventType:"Genus Eventus",improvement:"Emendare",email:"Email",bio:"Introductio"}},tk=({profile:n,variant:e="compact",showAvatar:t=!0,className:r="",style:s={}})=>{var m;const{lang:a}=Bt(),c=n.avatar||n.avatarUrl||"/avatars/Derxl.png",d=n.gender?((m=l3[a])==null?void 0:m[n.gender])||n.gender:"",h=c3[a];return e==="compact"?i.jsxs("div",{className:`user-profile-compact ${r}`,style:{display:"flex",alignItems:"center",gap:12,marginBottom:2,...s},children:[t&&i.jsx("img",{src:c,alt:"avatar",style:{width:36,height:36,borderRadius:"50%",objectFit:"cover",border:"2px solid #ececff"}}),i.jsx("span",{style:{fontWeight:600},children:n.nickname||"-"}),i.jsxs("span",{children:[n.age||"-",h]}),i.jsx("span",{children:d}),i.jsxs("span",{children:[n.country||"-",n.region?`/${n.region}`:""]})]}):i.jsxs("div",{className:`user-profile-detailed ${r}`,style:{marginTop:10,fontSize:14,color:"#6B5BFF",fontWeight:500,background:"#f7f8fc",borderRadius:8,padding:"8px 12px",...s},children:[t&&i.jsx("div",{style:{textAlign:"center",marginBottom:8},children:i.jsx("img",{src:c,alt:"avatar",style:{width:48,height:48,borderRadius:"50%",objectFit:"cover",border:"2px solid #6B5BFF"}})}),i.jsxs("div",{children:[as[a].nickname,"：",n.nickname||"-"]}),i.jsxs("div",{children:[as[a].gender,"：",d]}),i.jsxs("div",{children:[as[a].age,"：",n.age||"-",h]}),i.jsxs("div",{children:[as[a].country,"：",n.country||"-"," ",n.region||""]}),i.jsxs("div",{children:[as[a].interest,"：",n.interest||"-"]}),i.jsxs("div",{children:[as[a].eventType,"：",n.eventType||"-"]}),n.improvement&&i.jsxs("div",{children:[as[a].improvement,"：",n.improvement]}),n.email&&i.jsxs("div",{children:[as[a].email,"：",n.email]}),n.bio&&i.jsxs("div",{children:[as[a].bio,"：",n.bio]})]})},ze={pageTitle:{"zh-TW":"故事鏈ReStoryChain™","zh-CN":"故事链ReStoryChain™",en:"ReStoryChain™",ja:"ストーリーチェーンReStoryChain™",ko:"스토리체인ReStoryChain™",th:"ReStoryChain™",vi:"ReStoryChain™",ms:"ReStoryChain™",la:"ReStoryChain™"},encouragement:{"zh-TW":"AI鼓勵語","zh-CN":"AI鼓励语",en:"AI Encouragement",ja:"AI励まし",ko:"AI 격려",th:"AI ให้กำลังใจ",vi:"AI động viên",ms:"AI Galakan",la:"AI Hortatio"},back:{"zh-TW":"返回","zh-CN":"返回",en:"Back",ja:"戻る",ko:"돌아가기",th:"กลับ",vi:"Quay lại",ms:"Kembali",la:"Redire"},logout:{"zh-TW":"登出","zh-CN":"登出",en:"Logout",ja:"ログアウト",ko:"로그아웃",th:"ออกจากระบบ",vi:"Đăng xuất",ms:"Log keluar",la:"Exire"},titlePlaceholder:{"zh-TW":"請輸入標題(限30字)","zh-CN":"请输入标题(限30字)",en:"Enter title (max 30 chars)",ja:"タイトルを入力（30文字以内）",ko:"제목을 입력하세요(30자 이내)",th:"กรอกชื่อเรื่อง (สูงสุด 30 ตัวอักษร)",vi:"Nhập tiêu đề (tối đa 30 ký tự)",ms:"Masukkan tajuk (maks 30 aksara)",la:"Titulum insere (max 30 litterae)"},contentPlaceholder:{"zh-TW":"請輸入內容(限500字)","zh-CN":"请输入内容(限500字)",en:"Enter content (max 500 chars)",ja:"内容を入力（500文字以内）",ko:"내용을 입력하세요(500자 이내)",th:"กรอกเนื้อหา (สูงสุด 500 ตัวอักษร)",vi:"Nhập nội dung (tối đa 500 ký tự)",ms:"Masukkan kandungan (maks 500 aksara)",la:"Contentum insere (max 500 litterae)"},formTitle:{"zh-TW":"分享你的故事","zh-CN":"分享你的故事",en:"Share Your Story",ja:"ストーリーを共有",ko:"이야기 공유",th:"แบ่งปันเรื่องราวของคุณ",vi:"Chia sẻ câu chuyện của bạn",ms:"Kongsi Cerita Anda",la:"Communica Fabulas Tuas"},formSubmit:{"zh-TW":"送出","zh-CN":"提交",en:"Post",ja:"投稿",ko:"게시",th:"โพสต์",vi:"Đăng",ms:"Hantar",la:"Submittere"},encouragementDefault:{"zh-TW":"繼續前進！你的故事很重要。","zh-CN":"继续前进！你的故事很重要。",en:"Keep going! Your story matters.",ja:"前に進もう！あなたのストーリーは大切です。",ko:"계속 나아가세요! 당신의 이야기는 소중합니다.",th:"เดินหน้าต่อไป! เรื่องราวของคุณสำคัญ",vi:"Tiếp tục nhé! Câu chuyện của bạn rất ý nghĩa.",ms:"Teruskan! Cerita anda penting.",la:"Perge! Fabula tua magni momenti est."},storyQuoteLine1:{"zh-TW":"有些故事不為了解釋，只是為了放下！","zh-CN":"有些故事不是为了说明，只是为了放下！",en:"Some stories are not for explanation, but for letting go!",ja:"いくつかの物語は説明のためではなく、手放すためのものです！",ko:"어떤 이야기는 설명을 위한 것이 아니라 내려놓기 위한 것입니다!",th:"เรื่องราวบางเรื่องไม่ได้มีไว้เพื่ออธิบาย แต่มีไว้เพื่อปล่อยวาง!",vi:"Có những câu chuyện không phải để giải thích, mà là để buông bỏ!",ms:"Sesetengah cerita bukan untuk dijelaskan, tetapi untuk dilepaskan!",la:"Nonnullae fabulae non ad explicandum, sed ad dimittendum sunt!"},storyQuoteLine2:{"zh-TW":"寫下來，也是一種放過自己... 寫下來，也是一種勇敢。","zh-CN":"写下来，也是放过自己... 写下来，也是勇敢。",en:"Writing it down is also a way to release yourself... Writing it down is also a kind of courage.",ja:"書き出すことは自分を解放する方法でもあり... 書き出すことは勇気でもあります。",ko:"써내려가는 것은 자신을 놓아주는 방법이기도 하고... 써내려가는 것은 용기이기도 합니다.",th:"การเขียนออกมาก็เป็นการปลดปล่อยตัวเอง... การเขียนออกมาก็เป็นความกล้าหาญอย่างหนึ่ง",vi:"Viết ra cũng là một cách tha thứ cho bản thân... Viết ra cũng là một sự dũng cảm.",ms:"Menulisnya adalah satu cara melepaskan diri... Menulisnya adalah satu keberanian.",la:"Scribere est te ipsum dimittere... Scribere est etiam audacia."},storyQuoteLine3:{"zh-TW":"有人願意說出口，就有人不再那麼孤單，分享就是力量。","zh-CN":"有人愿意说出口，就有人不再那么孤单，分享就是力量。",en:"When someone is willing to speak out, someone else is no longer alone. Sharing is power.",ja:"誰かが声に出してくれることで、誰かがもう孤独ではなくなります。シェアすることは力です。",ko:"누군가 말할 용기를 내면, 누군가는 더 이상 외롭지 않습니다. 나눔은 힘입니다.",th:"เมื่อมีใครสักคนกล้าที่จะพูดออกมา ก็จะมีใครสักคนที่ไม่ต้องโดดเดี่ยวอีกต่อไป การแบ่งปันคือพลัง",vi:"Khi ai đó dám nói ra, sẽ có người không còn cô đơn nữa. Chia sẻ là sức mạnh.",ms:"Apabila seseorang sanggup meluahkan, seseorang yang lain tidak lagi keseorangan. Berkongsi adalah kekuatan.",la:"Cum aliquis loqui velit, aliquis non iam solus est. Communicatio est potestas."},blockchainNote:{"zh-TW":"💡 區塊鏈功能正在開發中，目前僅為標記功能，實際封存功能將在未來版本中推出","zh-CN":"💡 区块链功能正在开发中，目前仅为标记功能，实际封存功能将在未来版本中推出",en:"💡 Blockchain feature is under development. Currently only a marker function, actual preservation will be available in future versions",ja:"💡 ブロックチェーン機能は開発中です。現在はマーカー機能のみで、実際の保存機能は将来のバージョンで提供予定です",ko:"💡 블록체인 기능이 개발 중입니다. 현재는 마커 기능만 있으며, 실제 보존 기능은 향후 버전에서 제공될 예정입니다",th:"💡 ฟีเจอร์บล็อกเชนกำลังอยู่ในขั้นตอนการพัฒนา ปัจจุบันเป็นเพียงฟังก์ชันเครื่องหมาย การเก็บรักษาจริงจะพร้อมใช้งานในเวอร์ชันอนาคต",vi:"💡 Tính năng blockchain đang được phát triển. Hiện tại chỉ là chức năng đánh dấu, tính năng lưu trữ thực tế sẽ có trong phiên bản tương lai",ms:"💡 Ciri blockchain sedang dalam pembangunan. Kini hanya fungsi penanda, fungsi pemeliharaan sebenar akan tersedia dalam versi masa hadapan",la:"💡 Blockchain functio in progressu est. Nunc tantum signum functionis, vera conservatio in futuris versionibus praesto erit"},storyPrompt:{"zh-TW":"如果只能留下一個故事，你想從哪裡開始呢？","zh-CN":"如果只能留下一个故事，你想从哪里开始呢？",en:"If you could only leave one story, where would you start?",ja:"もし一つの物語しか残せないとしたら、どこから始めますか？",ko:"만약 하나의 이야기만 남길 수 있다면, 어디서부터 시작하시겠습니까?",th:"หากคุณสามารถทิ้งเรื่องราวไว้เพียงเรื่องเดียว คุณจะเริ่มต้นจากที่ไหน?",vi:"Nếu bạn chỉ có thể để lại một câu chuyện, bạn sẽ bắt đầu từ đâu?",ms:"Jika anda hanya boleh tinggalkan satu cerita, di mana anda akan mula?",la:"Si unam tantum fabulam relinquere posses, unde inciperes?"},partnersStories:{"zh-TW":"夥伴們的分享","zh-CN":"伙伴们的分享",en:"Partners' Stories",ja:"仲間たちのシェア",ko:"파트너들의 이야기",th:"เรื่องราวของเพื่อนๆ",vi:"Chia sẻ của các bạn",ms:"Kisah Rakan-rakan",la:"Communicatio Sociorum"},myStories:{"zh-TW":"我的故事","zh-CN":"我的故事",en:"My Stories",ja:"私のストーリー",ko:"나의 이야기",th:"เรื่องราวของฉัน",vi:"Câu chuyện của tôi",ms:"Cerita Saya",la:"Fabulae Meae"},friendStories:{"zh-TW":"好友故事","zh-CN":"好友故事",en:"Friend Stories",ja:"友達のストーリー",ko:"친구 이야기",th:"เรื่องราวของเพื่อน",vi:"Câu chuyện bạn bè",ms:"Cerita Rakan",la:"Fabulae Amicorum"},noFriends:{"zh-TW":"你還沒有好友連結，快去","zh-CN":"你还没有好友连结，快去",en:"You have no friend connections yet, go to",ja:"まだ友達のつながりがありません。",ko:"아직 친구 연결이 없습니다. 빨리",th:"คุณยังไม่มีการเชื่อมต่อเพื่อน",vi:"Bạn chưa có kết nối bạn bè nào, hãy đến",ms:"Anda masih tiada sambungan rakan, pergi ke",la:"Nondum amicos conexos habes, ad"},goToPairTalk:{"zh-TW":"交友區建立連結吧！","zh-CN":"交友区建立连结吧！",en:"Go to Friend Zone to connect!",ja:"フレンドゾーンでつながろう！",ko:"프렌드존에서 연결하세요!",th:"ไปที่ Friend Zone เพื่อเชื่อมต่อ!",vi:"đến Friend Zone để kết nối!",ms:"ke Friend Zone untuk sambung!",la:"ad Friend Zone coniunge!"},visibilityPrivate:{"zh-TW":"私密","zh-CN":"私密",en:"Private",ja:"非公開",ko:"비공개",th:"ส่วนตัว",vi:"Riêng tư",ms:"Peribadi",la:"Privatus"},visibilityFriends:{"zh-TW":"限好友","zh-CN":"限好友",en:"Friends Only",ja:"友達のみ",ko:"친구만",th:"เฉพาะเพื่อน",vi:"Chỉ bạn bè",ms:"Hanya Rakan",la:"Amicis Tantum"},visibilityPublic:{"zh-TW":"開放分享","zh-CN":"开放分享",en:"Public",ja:"公開",ko:"공개",th:"สาธารณะ",vi:"Công khai",ms:"Umum",la:"Publicus"},profileLabels:{"zh-TW":`暱稱：{nickname}
性別：{gender}
年齡：{age}
國家/地區：{country}
興趣：{interest}
事件類型：{eventType}`,"zh-CN":`昵称：{nickname}
性别：{gender}
年龄：{age}
国家/地区：{country}
兴趣：{interest}
事件类型：{eventType}`,en:`Nickname: {nickname}
Gender: {gender}
Age: {age}
Country/Region: {country}
Interest: {interest}
Event Type: {eventType}`,ja:`ニックネーム：{nickname}
性別：{gender}
年齢：{age}
国/地域：{country}
興味：{interest}
イベントタイプ：{eventType}`,ko:`닉네임: {nickname}
성별: {gender}
나이: {age}
국가/지역: {country}
관심사: {interest}
이벤트 유형: {eventType}`,th:`ชื่อเล่น: {nickname}
เพศ: {gender}
อายุ: {age}
ประเทศ/ภูมิภาค: {country}
ความสนใจ: {interest}
ประเภทเหตุการณ์: {eventType}`,vi:`Biệt danh: {nickname}
Giới tính: {gender}
Tuổi: {age}
Quốc gia/Khu vực: {country}
Sở thích: {interest}
Loại sự kiện: {eventType}`,ms:`Nama panggilan: {nickname}
Jantina: {gender}
Umur: {age}
Negara/Wilayah: {country}
Minat: {interest}
Jenis Acara: {eventType}`,la:`Cognomen: {nickname}
Sexus: {gender}
Aetas: {age}
Patria/Regio: {country}
Studium: {interest}
Genus Eventus: {eventType}`}},ny=["bg-gradient-to-br from-[#7f8fff] to-[#b6b6f6]","bg-gradient-to-br from-[#ffb6b6] to-[#ffd6e0]","bg-gradient-to-br from-[#6be6ff] to-[#b6f6ff]","bg-gradient-to-br from-[#ffe66b] to-[#ffb86b]"];function nk(n){if(!n||typeof n!="string")return ny[0];let e=0;for(let t=0;t<n.length;t++)e+=n.charCodeAt(t);return ny[e%ny.length]}const Ct={"zh-TW":{work_restart:"工作重啟",family_trust:"家庭信任",social_treatment:"社會對待",inner_choice:"內心選擇",misunderstood_and_recovered:"誤解與復原",restart_path:"重啟之路"},"zh-CN":{work_restart:"工作重启",family_trust:"家庭信任",social_treatment:"社会对待",inner_choice:"内心选择",misunderstood_and_recovered:"误解与复原",restart_path:"重启之路"},en:{work_restart:"Work Restart",family_trust:"Family Trust",social_treatment:"Social Treatment",inner_choice:"Inner Choice",misunderstood_and_recovered:"Misunderstood & Recovered",restart_path:"Restart Path"},ja:{work_restart:"仕事の再出発",family_trust:"家族の信頼",social_treatment:"社会の扱い",inner_choice:"内なる選択",misunderstood_and_recovered:"誤解と回復",restart_path:"再出発の道"},ko:{work_restart:"일 재시작",family_trust:"가족의 신뢰",social_treatment:"사회적 대우",inner_choice:"내면의 선택",misunderstood_and_recovered:"오해와 회복",restart_path:"재시작의 길"},th:{work_restart:"เริ่มงานใหม่",family_trust:"ความไว้วางใจในครอบครัว",social_treatment:"การปฏิบัติของสังคม",inner_choice:"ทางเลือกภายในใจ",misunderstood_and_recovered:"ความเข้าใจผิดและการฟื้นฟู",restart_path:"เส้นทางเริ่มต้นใหม่"},vi:{work_restart:"Khởi động lại công việc",family_trust:"Niềm tin gia đình",social_treatment:"Cách đối xử của xã hội",inner_choice:"Lựa chọn nội tâm",misunderstood_and_recovered:"Hiểu lầm và phục hồi",restart_path:"Con đường làm lại"},ms:{work_restart:"Mula Kerja Semula",family_trust:"Kepercayaan Keluarga",social_treatment:"Layanan Sosial",inner_choice:"Pilihan Dalaman",misunderstood_and_recovered:"Salah Faham & Pemulihan",restart_path:"Jalan Permulaan Semula"},la:{work_restart:"Opus Renovatum",family_trust:"Fides Familiaris",social_treatment:"Tractatio Socialis",inner_choice:"Electio Interior",misunderstood_and_recovered:"Error et Recuperatio",restart_path:"Iter Renovationis"}},rk={"zh-TW":"✔ 我願意將這段見證封存於區塊鏈（開發中）","zh-CN":"✔ 我愿意将这段见证封存于区块链（开发中）",en:"✔ I agree to preserve this testimony on the blockchain (In Development)",ja:"✔ この証言をブロックチェーンに保存することに同意します（開発中）",ko:"✔ 이 증언을 블록체인에 보존하는 것에 동의합니다（개발 중）",th:"✔ ฉันยินยอมให้บันทึกเรื่องราวนี้บนบล็อกเชน（กำลังพัฒนา）",vi:"✔ Tôi đồng ý lưu giữ câu chuyện này trên blockchain (Đang phát triển)",ms:"✔ Saya bersetuju untuk menyimpan kisah ini di blockchain (Dalam Pembangunan)",la:"✔ Assentior hanc testificationem in blockchain servari (In Progressu)"},ry={"zh-TW":{private:"只有我",friends:"好友可見",public:"所有人",label:"誰可以看到這段故事？"},"zh-CN":{private:"只有我",friends:"好友可见",public:"所有人",label:"谁可以看到这段故事？"},en:{private:"Only me",friends:"Friends only",public:"Everyone",label:"Who can see this story?"},ja:{private:"自分だけ",friends:"友達のみ",public:"全員",label:"誰がこのストーリーを見られますか？"},ko:{private:"나만 보기",friends:"친구만 보기",public:"모두 보기",label:"이 이야기를 누가 볼 수 있나요?"},th:{private:"เฉพาะฉัน",friends:"เพื่อนเท่านั้น",public:"ทุกคน",label:"ใครสามารถเห็นเรื่องราวนี้ได้บ้าง?"},vi:{private:"Chỉ mình tôi",friends:"Chỉ bạn bè",public:"Mọi người",label:"Ai có thể xem câu chuyện này?"},ms:{private:"Hanya saya",friends:"Hanya rakan",public:"Semua orang",label:"Siapa boleh melihat cerita ini?"},la:{private:"Solus ego",friends:"Amici tantum",public:"Omnes",label:"Quis hanc historiam videre potest?"}},u3={"zh-TW":{launch:"寫下來，也是⼀種勇敢。",ask:"如果只能留下一個故事，你會從哪裡說起？",thanks:"🎉 感謝你分享，這是你的故事",success:"你寫得很好，這段經歷值得被看見。",randomEncourage:["你的過去不定義你，選擇講述它，才是你的力量。","每個故事都值得被聽見。","你願意分享真心，我們願意陪你走一段。","你的經歷很珍貴，謝謝你願意說出來。"],chain:"我要將這段故事封存於區塊鏈",anonymous:"我要匿名分享",countryName:{中國大陸:"中國大陸",台灣:"台灣",日本:"日本",韓國:"韓國",美國:"美國",其他:"其他"},eventTypeName:{家暴加害:"家暴加害",家暴受害:"家暴受害",其他:"其他"}},"zh-CN":{launch:"写下来，也是一种勇敢。",ask:"这次你想聊的是什么？",thanks:"🎉 感谢你的分享，这是你的故事",success:"你写得很好，这段经历值得被看见。",randomEncourage:["你的过去不定义你，选择讲述它，才是你的力量。","每个故事都值得被听见。","你愿意分享真心，我们愿意陪你走一段。","你的经历很珍贵，谢谢你愿意说出来。"],chain:"我要将这段故事封存于区块链",anonymous:"我要匿名分享",countryName:{中國大陸:"中国大陆",台灣:"台湾",日本:"日本",韓國:"韩国",美國:"美国",其他:"其他"},eventTypeName:{家暴加害:"家暴加害",家暴受害:"家暴受害",其他:"其他"}},en:{launch:"Writing it down is also an act of courage.",ask:"What do you want to talk about this time?",thanks:"🎉 Thank you for sharing, this is your story",success:"You wrote beautifully. This experience deserves to be seen.",randomEncourage:["Your past does not define you. Choosing to tell it is your power.","Every story deserves to be heard.","You share your heart, we walk with you.","Your experience is precious, thank you for sharing."],chain:"I want to preserve this story on the blockchain",anonymous:"I want to share anonymously",countryName:{中國大陸:"China",台灣:"Taiwan",日本:"Japan",韓國:"Korea",美國:"USA",其他:"Other"},eventTypeName:{家暴加害:"Domestic Violence Perpetrator",家暴受害:"Domestic Violence Victim",其他:"Other"}},ja:{launch:"",ask:"",thanks:"",success:"",randomEncourage:[""],chain:"",anonymous:""},ko:{launch:"",ask:"",thanks:"",success:"",randomEncourage:[""],chain:"",anonymous:""},th:{launch:"",ask:"",thanks:"",success:"",randomEncourage:[""],chain:"",anonymous:""},vi:{launch:"",ask:"",thanks:"",success:"",randomEncourage:[""],chain:"",anonymous:""},ms:{launch:"",ask:"",thanks:"",success:"",randomEncourage:[""],chain:"",anonymous:""},la:{launch:"",ask:"",thanks:"",success:"",randomEncourage:[""],chain:"",anonymous:""}};async function iy(n,e,t){var s;const r={[e]:n};for(const a of t)if(a!==e)try{const d=await(await fetch("/api/translate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:n,from:e,to:a})})).json();r[a]=d.translated||""}catch{try{const d=await(await fetch(`https://translate.googleapis.com/translate_a/single?client=gtx&sl=${e}&tl=${a}&dt=t&q=${encodeURIComponent(n)}`)).json();r[a]=((s=d[0])==null?void 0:s.map(h=>h[0]).join(""))||""}catch{r[a]=""}}return r}function Fl(n,e){return n.titleLangs&&n.titleLangs[e]||n.title}function Nl(n,e){return n.contentLangs&&n.contentLangs[e]||n.content}const zl={"zh-TW":{中國大陸:"中國大陸",台灣:"台灣",日本:"日本",韓國:"韓國",美國:"美國",其他:"其他"},"zh-CN":{中國大陸:"中国大陆",台灣:"台湾",日本:"日本",韓國:"韩国",美國:"美国",其他:"其他"},en:{中國大陸:"China",台灣:"Taiwan",日本:"Japan",韓國:"Korea",美國:"USA",其他:"Other"},ja:{中國大陸:"中国大陸",台灣:"台湾",日本:"日本",韓國:"韓国",美國:"アメリカ",其他:"その他"},ko:{中國大陸:"중국",台灣:"대만",日本:"일본",韓國:"한국",美國:"미국",其他:"기타"},th:{中國大陸:"จีน",台灣:"ไต้หวัน",日本:"ญี่ปุ่น",韓國:"เกาหลี",美國:"สหรัฐอเมริกา",其他:"อื่นๆ"},vi:{中國大陸:"Trung Quốc",台灣:"Đài Loan",日本:"Nhật Bản",韓國:"Hàn Quốc",美國:"Mỹ",其他:"Khác"},ms:{中國大陸:"China",台灣:"Taiwan",日本:"Jepun",韓國:"Korea",美國:"Amerika",其他:"Lain-lain"},la:{中國大陸:"Sina",台灣:"Taiwan",日本:"Iaponia",韓國:"Corea",美國:"CFA",其他:"Aliud"}},Dl={"zh-TW":{家暴加害:"家暴加害",家暴受害:"家暴受害",其他:"其他"},"zh-CN":{家暴加害:"家暴加害",家暴受害:"家暴受害",其他:"其他"},en:{家暴加害:"Domestic Violence Perpetrator",家暴受害:"Domestic Violence Victim",其他:"Other"},ja:{家暴加害:"家庭内暴力加害者",家暴受害:"家庭内暴力被害者",其他:"その他"},ko:{家暴加害:"가정폭력 가해자",家暴受害:"가정폭력 피해자",其他:"기타"},th:{家暴加害:"ผู้กระทำความรุนแรงในครอบครัว",家暴受害:"เหยื่อความรุนแรงในครอบครัว",其他:"อื่นๆ"},vi:{家暴加害:"Người gây bạo lực gia đình",家暴受害:"Nạn nhân bạo lực gia đình",其他:"Khác"},ms:{家暴加害:"Pelaku Keganasan Rumah Tangga",家暴受害:"Mangsa Keganasan Rumah Tangga",其他:"Lain-lain"},la:{家暴加害:"Violentus Domesticus",家暴受害:"Victima Violentiae Domesticae",其他:"Aliud"}},d3=()=>{const n=kd(Do),e=gt(),t=wt(),{t:r,i18n:s}=a3(),[a,c]=w.useState("zh-TW");w.useEffect(()=>{const V=localStorage.getItem("lang");V&&["zh-TW","zh-CN","en","ja","ko","th","vi","ms","la"].includes(V)&&c(V)},[]);const[d,h]=w.useState(null),[m,g]=w.useState([]),[x,S]=w.useState(""),[I,_]=w.useState(""),[R,T]=w.useState(""),[A,D]=w.useState(null),[F,X]=w.useState(!1),[ie,G]=w.useState(""),[N,E]=w.useState(!1),[P,M]=w.useState("public"),[O,z]=w.useState({tags:{}}),[j,K]=w.useState(null),[Z,Y]=w.useState(!1),[ae,se]=w.useState(!1),[re,ne]=w.useState(""),[W,$]=w.useState(null),[ee,he]=w.useState(""),[_e,ve]=w.useState(!1),[Le,Ne]=w.useState({}),[nt,Je]=w.useState({}),[ge,De]=w.useState({}),[tt,Ye]=w.useState(!1),[We,pe]=w.useState([]);w.useEffect(()=>{const V=zo(e,L=>h(L));return()=>V()},[e]),w.useEffect(()=>{(async()=>{const L=cr(kn(n,"stories"),Qp("createdAt","desc")),oe=await Dr(L);g(oe.docs.map(H=>({id:H.id,...H.data()})))})()},[n]),w.useEffect(()=>{fetch(`/locales/${a}/tags.json`).then(V=>V.json()).then(V=>z(V)).catch(()=>z({tags:{}}))},[a]),w.useEffect(()=>{let V;if(ae){let L=0;V=setInterval(()=>{L=(L+1)%6,ne(".".repeat(L))},400)}else ne("");return()=>clearInterval(V)},[ae]),w.useEffect(()=>{async function V(){const L=await cd(()=>Promise.resolve().then(()=>Jp),void 0).then(H=>H.getDocs(H.collection(n,"profiles"))),oe={};L.forEach(H=>{const J=H.data();J.nickname&&(oe[J.nickname]=J),J.name&&(oe[J.name]=J)}),Je(oe)}V()},[]),w.useEffect(()=>{async function V(){const L=await cd(()=>Promise.resolve().then(()=>Jp),void 0).then(H=>H.getDocs(H.collection(n,"profiles"))),oe={};L.forEach(H=>{const J=H.data();J.email&&(oe[J.email]=J)}),De(oe)}V()},[]),w.useEffect(()=>{d&&(async()=>{const L=kn(n,"links"),oe=cr(L,Tn("user1Id","==",d.uid),Tn("status","==","connected")),H=cr(L,Tn("user2Id","==",d.uid),Tn("status","==","connected")),[J,be]=await Promise.all([Dr(oe),Dr(H)]),Me=new Set;J.forEach($e=>Me.add($e.data().user2Id)),be.forEach($e=>Me.add($e.data().user1Id)),pe(Array.from(Me))})()},[d]);const Se=async()=>{if(!x.trim()||!I.trim())return;se(!0),Y(!1);let V=0;const L=setInterval(()=>{V=(V+1)%6,ne(".".repeat(V))},400);try{X(!0);const[oe,H,J]=await Promise.all([fetch("/api/gpt/encourage",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({story:I})}).then(Gt=>Gt.json()).catch(()=>({encouragement:""})),iy(x,a,["zh-TW","zh-CN","en"]),iy(I,a,["zh-TW","zh-CN","en"])]),be=oe.encouragement||"",Me=be?await iy(be,a,["zh-TW","zh-CN","en"]):{},$e=u3[U].randomEncourage,Ze=$e[Math.floor(Math.random()*$e.length)];he(Ze),await go(kn(n,"stories"),{title:x,content:I,author:(d==null?void 0:d.displayName)||"匿名",authorEmail:(d==null?void 0:d.email)||"",createdAt:new Date,comments:[],likes:0,encouragement:be,encouragementLangs:Me,tag:ie,visibility:P,onChain:N,titleLangs:H,contentLangs:J}),S(""),_(""),X(!1);const Ke=cr(kn(n,"stories"),Qp("createdAt","desc")),Ot=(await Dr(Ke)).docs.map(Gt=>({id:Gt.id,...Gt.data()}));g(Ot),K(Ot[0]||null)}catch(oe){console.error("Error adding story:",oe),S(""),_(""),X(!1)}finally{clearInterval(L),se(!1)}};function we(V){return V.encouragementLangs&&V.encouragementLangs[U]?V.encouragementLangs[U]:V.encouragement||ze.encouragementDefault[U]}["intro.sunday","intro.monday","intro.tuesday","intro.wednesday","intro.thursday","intro.friday","intro.saturday"][new Date().getDay()];const Re=async V=>{await Xp(Gn(n,"stories",V)),g(m.filter(L=>L.id!==V)),j&&j.id===V&&K(null)},Ce=V=>{M(V),V!=="public"&&E(!1)},U=a||"zh-TW";return i.jsx("div",{children:window.innerWidth<=768?i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{position:"absolute",top:0,left:0,right:0,zIndex:100,background:"rgba(255,255,255,0.95)",borderRadius:"0 0 16px 16px",padding:"18px 16px",boxShadow:"0 2px 12px #6B5BFF22",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[i.jsx("button",{onClick:()=>t("/"),style:{fontWeight:700,fontSize:18,padding:"6px 16px",borderRadius:8,border:"1.5px solid #6B5BFF",background:"#fff",color:"#6B5BFF",cursor:"pointer"},children:ze.back[U]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[i.jsx("span",{style:{fontSize:"1.5rem",fontWeight:900,color:"#6B5BFF"},children:"📖"}),i.jsx("span",{style:{fontSize:"1.2rem",fontWeight:900,color:"#6B5BFF"},children:ze.pageTitle[U]})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[i.jsx("button",{onClick:async()=>{await Tr(e),localStorage.clear(),t("/")},style:{fontWeight:700,fontSize:16,padding:"6px 12px",borderRadius:8,border:"1.5px solid #6B5BFF",background:"#fff",color:"#6B5BFF",cursor:"pointer"},children:ze.logout[U]}),i.jsx(Mn,{})]})]}),i.jsxs("div",{style:{marginTop:80,marginBottom:16,background:"rgba(255,255,255,0.95)",borderRadius:16,padding:"16px",boxShadow:"0 2px 12px #6B5BFF22",textAlign:"center"},children:[i.jsx("div",{style:{fontSize:14,color:"#000",fontWeight:600,marginBottom:8},children:ze.storyQuoteLine1[U]}),i.jsx("div",{style:{fontSize:14,color:"#000",fontWeight:600,marginBottom:8},children:ze.storyQuoteLine2[U]}),i.jsx("div",{style:{fontSize:12,color:"#888",fontWeight:500},children:ze.storyQuoteLine3[U]})]}),i.jsxs("div",{style:{background:"rgba(255,255,255,0.95)",borderRadius:16,padding:"16px",marginBottom:16,boxShadow:"0 2px 12px #6B5BFF22"},children:[i.jsx("div",{style:{padding:"12px 20px",background:"linear-gradient(135deg, #6B5BFF 60%, #23c6e6 100%)",color:"#fff",border:"none",borderRadius:10,fontWeight:900,fontSize:17,letterSpacing:1,textAlign:"center",marginBottom:16},children:ze.formTitle[U]}),i.jsx("div",{style:{fontSize:16,color:"#6B5BFF",fontWeight:600,marginBottom:16,textAlign:"center"},children:ze.storyPrompt[U]}),i.jsx("input",{value:x,onChange:V=>S(V.target.value),placeholder:ze.titlePlaceholder[U],style:{width:"100%",boxSizing:"border-box",padding:12,borderRadius:16,border:"1px solid #ddd",fontSize:16,marginBottom:8,color:"#232946"}}),i.jsx("textarea",{value:I,onChange:V=>_(V.target.value),rows:3,placeholder:ze.contentPlaceholder[U],style:{width:"100%",height:120,boxSizing:"border-box",padding:12,borderRadius:16,border:"1px solid #ddd",fontSize:16,marginBottom:8,color:"#232946",resize:"none"}}),i.jsxs("div",{style:{display:"flex",gap:16,alignItems:"center",marginBottom:8,fontSize:15},children:[i.jsxs("label",{style:{display:"flex",alignItems:"center",gap:2},children:[i.jsx("input",{type:"radio",name:"visibility",value:"private",checked:P==="private",onChange:()=>Ce("private")})," ",ze.visibilityPrivate[U]]}),i.jsxs("label",{style:{display:"flex",alignItems:"center",gap:2},children:[i.jsx("input",{type:"radio",name:"visibility",value:"friends",checked:P==="friends",onChange:()=>Ce("friends")})," ",ze.visibilityFriends[U]]}),i.jsxs("label",{style:{display:"flex",alignItems:"center",gap:2},children:[i.jsx("input",{type:"radio",name:"visibility",value:"public",checked:P==="public",onChange:()=>Ce("public")})," ",ze.visibilityPublic[U]]})]}),P==="public"&&i.jsxs("div",{style:{marginBottom:8},children:[i.jsxs("label",{style:{display:"flex",alignItems:"center",fontSize:15},children:[i.jsx("input",{type:"checkbox",checked:N,onChange:V=>E(V.target.checked),style:{marginRight:4}})," ",rk[U]]}),i.jsx("div",{style:{fontSize:12,color:"#888",marginTop:4,fontStyle:"italic"},children:ze.blockchainNote[U]})]}),i.jsx("button",{onClick:Se,disabled:F,style:{padding:"12px 20px",background:"linear-gradient(135deg, #6B5BFF 60%, #23c6e6 100%)",color:"#fff",border:"none",borderRadius:10,fontWeight:900,fontSize:17,letterSpacing:1,cursor:F?"not-allowed":"pointer",opacity:F?.6:1},children:ze.formSubmit[U]})]}),i.jsxs("div",{style:{background:"rgba(255,255,255,0.95)",borderRadius:16,padding:"16px",marginBottom:16,boxShadow:"0 2px 12px #6B5BFF22"},children:[i.jsxs("div",{style:{display:"flex",gap:4,marginBottom:16,flexWrap:"nowrap",justifyContent:"space-between"},children:[i.jsxs("button",{onClick:()=>{Y(!0),Ye(!1),ve(!1),$(null)},style:{padding:"6px 8px",borderRadius:18,border:"none",background:Z?"linear-gradient(90deg,#ffb86b 60%,#6B5BFF 100%)":"#eee",color:Z?"#fff":"#6B5BFF",fontWeight:700,fontSize:12,cursor:"pointer",flex:1,marginRight:4},children:["#💬",ze.partnersStories[U]]}),i.jsxs("button",{onClick:()=>{Ye(!0),Y(!1),ve(!1),$(null)},style:{padding:"6px 8px",borderRadius:18,border:"none",background:tt?"linear-gradient(90deg,#23c6e6 60%,#6B5BFF 100%)":"#eee",color:tt?"#fff":"#6B5BFF",fontWeight:700,fontSize:12,cursor:"pointer",flex:1,marginRight:4},children:["#🤝",ze.friendStories[U]]}),i.jsxs("button",{onClick:()=>{ve(!0),Y(!1),Ye(!1),$(null)},style:{padding:"6px 8px",borderRadius:18,border:"none",background:_e?"linear-gradient(90deg,#6B5BFF 60%,#23c6e6 100%)":"#eee",color:_e?"#fff":"#6B5BFF",fontWeight:700,fontSize:12,cursor:"pointer",flex:1},children:["#📝",ze.myStories[U]]})]}),i.jsx("div",{style:{maxHeight:400,overflowY:"auto",width:"100%",paddingRight:6},children:tt?We.length===0?i.jsxs("div",{style:{color:"#888",fontWeight:600,fontSize:16,padding:"32px 0",textAlign:"center"},children:[ze.noFriends[U],i.jsx("span",{onClick:()=>t("/friend"),style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,cursor:"pointer"},children:ze.goToPairTalk[U]})]}):m.filter(V=>V.visibility==="friends"&&We.includes(V.authorEmail)).map(V=>{const L=ge[V.authorEmail]||{};return i.jsxs("div",{style:{background:"#fff",borderRadius:14,boxShadow:"0 2px 8px #b6b6f622",padding:14,marginBottom:14,cursor:"pointer"},children:[i.jsx("div",{style:{fontWeight:700,color:"#6B5BFF",fontSize:16,marginBottom:4},onClick:oe=>{oe.stopPropagation(),$(W===V.id?null:V.id)},children:Fl(V,U)}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:4,fontSize:"12px",flexWrap:"nowrap",whiteSpace:"nowrap"},children:[i.jsx("img",{src:L.avatar||L.avatarUrl||"/avatars/Derxl.png",alt:"avatar",style:{width:24,height:24,borderRadius:"50%",objectFit:"cover",border:"2px solid #ececff"}}),i.jsx("span",{style:{fontWeight:600},children:L&&L.nickname?L.nickname:"-"}),i.jsxs("span",{children:["，",L&&L.age?L.age:"-"]}),i.jsxs("span",{children:["，",L&&L.gender?L.gender:"-"]})]}),W===V.id&&i.jsxs("div",{style:{marginTop:8},children:[i.jsx("div",{style:{color:"#232946",fontSize:14,marginBottom:4,whiteSpace:"pre-line"},children:Nl(V,U)}),i.jsxs("div",{style:{background:"linear-gradient(90deg, #f7f8fc 60%, #e3e6f3 100%)",borderRadius:12,padding:"6px 10px",margin:"6px 0",display:"flex",alignItems:"center",gap:6,boxShadow:"0 2px 8px #b6b6f622",fontSize:12},children:[i.jsxs("span",{style:{color:"#7f8fff",fontWeight:700},children:["🤖 ",ze.encouragement[U],"："]}),i.jsx("span",{style:{color:"#4b4b6b",fontWeight:500},children:we(V)})]}),V.tag&&i.jsx("div",{style:{fontSize:12,color:"#6B5BFF",fontWeight:700,marginBottom:4},children:Ct[U][V.tag]}),V.onChain&&i.jsx("span",{style:{fontSize:12,color:"#23c6e6",fontWeight:700,marginLeft:8},children:"🔗 已封存"}),i.jsx("div",{style:{marginTop:8,fontSize:12,color:"#6B5BFF",fontWeight:500,background:"#f7f8fc",borderRadius:8,padding:"6px 10px"},children:i.jsxs("div",{children:[`${ze.profileLabels[U].split(`
`)[0].split("：")[0]}：${L&&L.nickname?L.nickname:"-"}，`,`${ze.profileLabels[U].split(`
`)[1].split("：")[0]}：${L&&L.gender?L.gender:"-"}，`,`${ze.profileLabels[U].split(`
`)[2].split("：")[0]}：${L&&L.age?L.age:"-"}，`,`${ze.profileLabels[U].split(`
`)[3].split("：")[0]}：${L&&typeof L.country=="string"&&L.country?zl[U][L.country]||L.country:"-"}，`,`${ze.profileLabels[U].split(`
`)[4].split("：")[0]}：${L&&typeof L.interest=="string"&&L.interest?Ct&&Ct[U]&&Ct[U][L.interest]?Ct[U][L.interest]:L.interest:"-"}，`,`${ze.profileLabels[U].split(`
`)[5].split("：")[0]}：${L&&typeof L.eventType=="string"&&L.eventType?Dl[U][L.eventType]||L.eventType:"-"}`]})})]})]},V.id)}):_e?m.filter(V=>V.author===(d==null?void 0:d.displayName)).map(V=>{var oe;const L=ge[V.authorEmail]||{};return i.jsxs("div",{style:{background:"#fff",borderRadius:14,boxShadow:"0 2px 8px #b6b6f622",padding:14,marginBottom:14,position:"relative"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10},children:[i.jsx("div",{className:`w-6 h-6 rounded-full flex items-center justify-center text-white font-extrabold text-sm border-2 border-[#ececff] shadow ${nk(V.author)}`,children:((oe=V.author)==null?void 0:oe[0])||"A"}),i.jsx("div",{style:{fontWeight:700,color:"#6B5BFF",fontSize:14,cursor:"pointer"},onClick:H=>{H.stopPropagation(),$(W===V.id?null:V.id)},children:Fl(V,U)}),i.jsx("button",{onClick:()=>Re(V.id),style:{marginLeft:"auto",background:"#ff6b6b",color:"#fff",border:"none",borderRadius:6,padding:"2px 8px",fontWeight:700,cursor:"pointer",fontSize:12},children:"刪除"})]}),W===V.id&&i.jsxs("div",{style:{marginTop:8},children:[i.jsx("div",{style:{color:"#232946",fontSize:14,marginBottom:4},children:Nl(V,U)}),i.jsxs("div",{style:{background:"linear-gradient(90deg, #f7f8fc 60%, #e3e6f3 100%)",borderRadius:12,padding:"6px 10px",margin:"6px 0",display:"flex",alignItems:"center",gap:6,boxShadow:"0 2px 8px #b6b6f622",fontSize:12},children:[i.jsxs("span",{style:{color:"#7f8fff",fontWeight:700},children:["🤖 ",ze.encouragement[U],"："]}),i.jsx("span",{style:{color:"#4b4b6b",fontWeight:500},children:we(V)})]}),V.tag&&i.jsx("div",{style:{fontSize:12,color:"#6B5BFF",fontWeight:700,marginBottom:4},children:Ct[U][V.tag]}),V.onChain&&i.jsx("span",{style:{fontSize:12,color:"#23c6e6",fontWeight:700,marginLeft:8},children:"🔗 已封存"}),i.jsx("div",{style:{marginTop:8,fontSize:12,color:"#6B5BFF",fontWeight:500,background:"#f7f8fc",borderRadius:8,padding:"6px 10px"},children:i.jsxs("div",{children:[`${ze.profileLabels[U].split(`
`)[0].split("：")[0]}：${L&&L.nickname?L.nickname:"-"}，`,`${ze.profileLabels[U].split(`
`)[1].split("：")[0]}：${L&&L.gender?L.gender:"-"}，`,`${ze.profileLabels[U].split(`
`)[2].split("：")[0]}：${L&&L.age?L.age:"-"}，`,`${ze.profileLabels[U].split(`
`)[3].split("：")[0]}：${L&&typeof L.country=="string"&&L.country?zl[U][L.country]||L.country:"-"}，`,`${ze.profileLabels[U].split(`
`)[4].split("：")[0]}：${L&&typeof L.interest=="string"&&L.interest?Ct&&Ct[U]&&Ct[U][L.interest]?Ct[U][L.interest]:L.interest:"-"}，`,`${ze.profileLabels[U].split(`
`)[5].split("：")[0]}：${L&&typeof L.eventType=="string"&&L.eventType?Dl[U][L.eventType]||L.eventType:"-"}`]})})]})]},V.id)}):m.filter(V=>V.visibility==="public").map(V=>{const L=ge[V.authorEmail]||{};return i.jsxs("div",{style:{background:"#fff",borderRadius:14,boxShadow:"0 2px 8px #b6b6f622",padding:14,marginBottom:14,cursor:"pointer"},children:[i.jsx("div",{style:{fontWeight:700,color:"#6B5BFF",fontSize:16,marginBottom:4},onClick:oe=>{oe.stopPropagation(),$(W===V.id?null:V.id)},children:Fl(V,U)}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:4,fontSize:"12px",flexWrap:"nowrap",whiteSpace:"nowrap"},children:[i.jsx("img",{src:L.avatar||L.avatarUrl||"/avatars/Derxl.png",alt:"avatar",style:{width:24,height:24,borderRadius:"50%",objectFit:"cover",border:"2px solid #ececff"}}),i.jsx("span",{style:{fontWeight:600},children:L&&L.nickname?L.nickname:"-"}),i.jsxs("span",{children:["，",L&&L.age?L.age:"-"]}),i.jsxs("span",{children:["，",L&&L.gender?L.gender:"-"]})]}),W===V.id&&i.jsxs("div",{style:{marginTop:8},children:[i.jsx("div",{style:{color:"#232946",fontSize:14,marginBottom:4,whiteSpace:"pre-line"},children:Nl(V,U)}),i.jsxs("div",{style:{background:"linear-gradient(90deg, #f7f8fc 60%, #e3e6f3 100%)",borderRadius:12,padding:"6px 10px",margin:"6px 0",display:"flex",alignItems:"center",gap:6,boxShadow:"0 2px 8px #b6b6f622",fontSize:12},children:[i.jsxs("span",{style:{color:"#7f8fff",fontWeight:700},children:["🤖 ",ze.encouragement[U],"："]}),i.jsx("span",{style:{color:"#4b4b6b",fontWeight:500},children:we(V)})]}),V.tag&&i.jsx("div",{style:{fontSize:12,color:"#6B5BFF",fontWeight:700,marginBottom:4},children:Ct[U][V.tag]}),V.onChain&&i.jsx("span",{style:{fontSize:12,color:"#23c6e6",fontWeight:700,marginLeft:8},children:"🔗 已封存"}),i.jsx("div",{style:{marginTop:8,fontSize:12,color:"#6B5BFF",fontWeight:500,background:"#f7f8fc",borderRadius:8,padding:"6px 10px"},children:i.jsxs("div",{children:[`${ze.profileLabels[U].split(`
`)[0].split("：")[0]}：${L&&L.nickname?L.nickname:"-"}，`,`${ze.profileLabels[U].split(`
`)[1].split("：")[0]}：${L&&L.gender?L.gender:"-"}，`,`${ze.profileLabels[U].split(`
`)[2].split("：")[0]}：${L&&L.age?L.age:"-"}，`,`${ze.profileLabels[U].split(`
`)[3].split("：")[0]}：${L&&typeof L.country=="string"&&L.country?zl[U][L.country]||L.country:"-"}，`,`${ze.profileLabels[U].split(`
`)[4].split("：")[0]}：${L&&typeof L.interest=="string"&&L.interest?Ct&&Ct[U]&&Ct[U][L.interest]?Ct[U][L.interest]:L.interest:"-"}，`,`${ze.profileLabels[U].split(`
`)[5].split("：")[0]}：${L&&typeof L.eventType=="string"&&L.eventType?Dl[U][L.eventType]||L.eventType:"-"}`]})})]})]},V.id)})})]}),i.jsx(Ln,{})]}):i.jsxs(i.Fragment,{children:[i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundImage:"url(/skytree.png)",backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat",zIndex:-1}}),i.jsxs("div",{style:{position:"absolute",top:0,left:0,right:0,zIndex:100,display:"flex",justifyContent:"space-between",alignItems:"center",padding:"18px 32px"},children:[i.jsx("button",{onClick:()=>t("/"),style:{fontWeight:700,fontSize:18,padding:"6px 16px",borderRadius:8,border:"1.5px solid #6B5BFF",background:"#fff",color:"#6B5BFF",cursor:"pointer"},children:ze.back[U]}),i.jsx("div",{style:{display:"flex",alignItems:"center",gap:16},children:i.jsxs("span",{style:{fontSize:"2rem",fontWeight:900,color:"#6B5BFF"},children:["📖 ",ze.pageTitle[U]]})}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[i.jsx("button",{onClick:async()=>{await Tr(e),localStorage.clear(),t("/")},style:{fontWeight:700,fontSize:18,padding:"6px 16px",borderRadius:8,border:"1.5px solid #6B5BFF",background:"#fff",color:"#6B5BFF",cursor:"pointer"},children:ze.logout[U]}),i.jsx(Mn,{})]})]}),i.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"100vh",padding:"80px 20px 20px 20px"},children:i.jsxs("div",{className:"modern-container",style:{width:"90%",maxWidth:1e3,display:"flex",flexDirection:"column",gap:32,background:"rgba(255, 255, 255, 0.9)",backdropFilter:"blur(10px)",borderRadius:20,padding:32,boxShadow:"0 8px 32px 0 rgba(31, 38, 135, 0.37)"},children:[i.jsxs("div",{style:{textAlign:"center",marginBottom:24},children:[i.jsx("p",{style:{fontSize:"1rem",color:"#000",fontWeight:600,margin:"0 0 8px 0",lineHeight:1.5},children:ze.storyQuoteLine1[U]}),i.jsx("p",{style:{fontSize:"1rem",color:"#000",fontWeight:600,margin:"0 0 8px 0",lineHeight:1.5},children:ze.storyQuoteLine2[U]}),i.jsx("p",{style:{fontSize:"0.9rem",color:"#888",fontWeight:500,margin:0,lineHeight:1.4},children:ze.storyQuoteLine3[U]})]}),i.jsxs("div",{style:{display:"flex",gap:32},children:[i.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",gap:24},children:[i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:16,marginBottom:16},children:[i.jsx("div",{style:{display:"flex",alignItems:"center",gap:16},children:i.jsx("div",{style:{padding:"12px 20px",background:"linear-gradient(135deg, #6B5BFF 60%, #23c6e6 100%)",color:"#fff",border:"none",borderRadius:10,fontWeight:900,fontSize:17,letterSpacing:1,textAlign:"center"},children:ze.formTitle[U]})}),i.jsx("div",{style:{fontSize:16,color:"#6B5BFF",fontWeight:600,textAlign:"center"},children:ze.storyPrompt[U]})]}),i.jsx("input",{value:x,onChange:V=>S(V.target.value),placeholder:ze.titlePlaceholder[U],style:{width:"100%",boxSizing:"border-box",padding:12,borderRadius:16,border:"1px solid #ddd",fontSize:16,marginBottom:8,color:"#232946"}}),i.jsx("textarea",{value:I,onChange:V=>_(V.target.value),rows:3,placeholder:ze.contentPlaceholder[U],style:{width:"100%",height:120,boxSizing:"border-box",padding:12,borderRadius:16,border:"1px solid #ddd",fontSize:16,marginBottom:8,color:"#232946",resize:"none"}}),i.jsxs("div",{style:{display:"flex",gap:16,alignItems:"center",marginBottom:8,fontSize:15},children:[i.jsxs("label",{style:{display:"flex",alignItems:"center",gap:2},children:[i.jsx("input",{type:"radio",name:"visibility",value:"private",checked:P==="private",onChange:()=>Ce("private")})," ",ze.visibilityPrivate[U]]}),i.jsxs("label",{style:{display:"flex",alignItems:"center",gap:2},children:[i.jsx("input",{type:"radio",name:"visibility",value:"friends",checked:P==="friends",onChange:()=>Ce("friends")})," ",ze.visibilityFriends[U]]}),i.jsxs("label",{style:{display:"flex",alignItems:"center",gap:2},children:[i.jsx("input",{type:"radio",name:"visibility",value:"public",checked:P==="public",onChange:()=>Ce("public")})," ",ze.visibilityPublic[U]]})]}),P==="public"&&i.jsxs("div",{style:{marginBottom:8},children:[i.jsxs("label",{style:{display:"flex",alignItems:"center",fontSize:15},children:[i.jsx("input",{type:"checkbox",checked:N,onChange:V=>E(V.target.checked),style:{marginRight:4}})," ",rk[U]]}),i.jsx("div",{style:{fontSize:12,color:"#888",marginTop:4,fontStyle:"italic"},children:ze.blockchainNote[U]})]}),i.jsx("button",{onClick:Se,disabled:F,style:{padding:"12px 20px",background:"linear-gradient(135deg, #6B5BFF 60%, #23c6e6 100%)",color:"#fff",border:"none",borderRadius:10,fontWeight:900,fontSize:17,letterSpacing:1,cursor:F?"not-allowed":"pointer",opacity:F?.6:1},children:ze.formSubmit[U]})]}),i.jsxs("div",{style:{flex:2,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[i.jsxs("div",{style:{display:"flex",gap:10,marginBottom:18},children:[i.jsxs("button",{onClick:()=>{Y(!0),Ye(!1),ve(!1),$(null)},style:{padding:"8px 18px",borderRadius:18,border:"none",background:Z?"linear-gradient(90deg,#ffb86b 60%,#6B5BFF 100%)":"#eee",color:Z?"#fff":"#6B5BFF",fontWeight:700,fontSize:16,cursor:"pointer"},children:["#💬",ze.partnersStories[U]]}),i.jsxs("button",{onClick:()=>{Ye(!0),Y(!1),ve(!1),$(null)},style:{padding:"8px 18px",borderRadius:18,border:"none",background:tt?"linear-gradient(90deg,#23c6e6 60%,#6B5BFF 100%)":"#eee",color:tt?"#fff":"#6B5BFF",fontWeight:700,fontSize:16,cursor:"pointer"},children:["#🤝",ze.friendStories[U]]}),i.jsxs("button",{onClick:()=>{ve(!0),Y(!1),Ye(!1),$(null)},style:{padding:"8px 18px",borderRadius:18,border:"none",background:_e?"linear-gradient(90deg,#6B5BFF 60%,#23c6e6 100%)":"#eee",color:_e?"#fff":"#6B5BFF",fontWeight:700,fontSize:16,cursor:"pointer"},children:["#📝",ze.myStories[U]]})]}),ae?i.jsxs("div",{style:{padding:"48px 0",textAlign:"center",color:"#6B5BFF",fontWeight:700,fontSize:22},children:["🤖 AI正在幫你包裝故事，請稍候",re,i.jsx("div",{style:{fontSize:15,color:"#888",marginTop:12},children:"（有時AI會偷偷加點幽默，請耐心等候...）"})]}):tt?i.jsxs("div",{style:{width:"100%",background:"#fff",borderRadius:18,boxShadow:"0 2px 12px #6B5BFF22",padding:"18px 12px",marginBottom:18},children:[i.jsxs("div",{style:{fontWeight:700,fontSize:18,marginBottom:10,background:"linear-gradient(90deg,#23c6e6 60%,#6B5BFF 100%)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text"},children:["#🤝",ze.friendStories[U]]}),i.jsx("button",{onClick:()=>{Ye(!1),Y(!0),ve(!1),$(null)},style:{margin:"0 0 18px 0",padding:"8px 18px",borderRadius:18,border:"none",background:"#eee",color:"#6B5BFF",fontWeight:700,fontSize:16,cursor:"pointer"},children:"返回夥伴們的故事"}),i.jsx("div",{style:{maxHeight:420,overflowY:"auto",width:"100%",paddingRight:6},children:We.length===0?i.jsxs("div",{style:{color:"#888",fontWeight:600,fontSize:16,padding:"32px 0",textAlign:"center"},children:[ze.noFriends[U],i.jsx("span",{onClick:()=>t("/friend"),style:{color:"#6B5BFF",textDecoration:"underline",fontWeight:700,cursor:"pointer"},children:ze.goToPairTalk[U]})]}):m.filter(V=>V.visibility==="friends"&&We.includes(V.authorEmail)).map(V=>{const L=ge[V.authorEmail]||{};return i.jsxs("div",{style:{background:"#fff",borderRadius:14,boxShadow:"0 2px 8px #b6b6f622",padding:14,marginBottom:14,cursor:"pointer"},children:[i.jsx("div",{style:{fontWeight:700,color:"#6B5BFF",fontSize:18,cursor:"pointer",marginBottom:4},onClick:oe=>{oe.stopPropagation(),$(W===V.id?null:V.id)},children:Fl(V,U)}),i.jsx(tk,{profile:L,variant:"compact"}),W===V.id&&i.jsxs("div",{style:{marginTop:10},children:[i.jsx("div",{style:{color:"#232946",fontSize:15,marginBottom:4,whiteSpace:"pre-line"},children:Nl(V,U)}),i.jsxs("div",{style:{background:"linear-gradient(90deg, #f7f8fc 60%, #e3e6f3 100%)",borderRadius:12,padding:"8px 12px",margin:"8px 0",display:"flex",alignItems:"center",gap:8,boxShadow:"0 2px 8px #b6b6f622",fontSize:14},children:[i.jsxs("span",{style:{color:"#7f8fff",fontWeight:700},children:["🤖 ",ze.encouragement[U],"："]}),i.jsx("span",{style:{color:"#4b4b6b",fontWeight:500},children:we(V)})]}),V.tag&&i.jsx("div",{style:{fontSize:14,color:"#6B5BFF",fontWeight:700,marginBottom:4},children:Ct[U][V.tag]}),V.onChain&&i.jsx("span",{style:{fontSize:14,color:"#23c6e6",fontWeight:700,marginLeft:8},children:"🔗 已封存"}),V.visibility&&["private","friends","public"].includes(V.visibility)&&i.jsx("span",{style:{fontSize:13,color:"#888",marginLeft:8},children:ry[U][V.visibility]}),i.jsx(tk,{profile:L,variant:"detailed"})]})]},V.id)})})]}):_e?i.jsxs("div",{style:{width:"100%",background:"#fff",borderRadius:18,boxShadow:"0 2px 12px #6B5BFF22",padding:"18px 12px",marginBottom:18},children:[i.jsxs("div",{style:{fontWeight:700,fontSize:18,marginBottom:10,background:"linear-gradient(90deg,#6B5BFF 0%,#23c6e6 100%)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text"},children:["#📝",ze.myStories[U]]}),i.jsx("button",{onClick:()=>{ve(!1),Y(!0),Ye(!1),$(null)},style:{margin:"0 0 18px 0",padding:"8px 18px",borderRadius:18,border:"none",background:"#eee",color:"#6B5BFF",fontWeight:700,fontSize:16,cursor:"pointer"},children:"返回夥伴們的故事"}),i.jsx("div",{style:{maxHeight:420,overflowY:"auto",width:"100%",paddingRight:6},children:m.filter(V=>V.author===(d==null?void 0:d.displayName)).map(V=>{var oe;const L=ge[V.authorEmail]||{};return i.jsxs("div",{style:{background:"#fff",borderRadius:14,boxShadow:"0 2px 8px #b6b6f622",padding:14,marginBottom:14,position:"relative"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10},children:[i.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-white font-extrabold text-lg border-2 border-[#ececff] shadow ${nk(V.author)}`,children:((oe=V.author)==null?void 0:oe[0])||"A"}),i.jsx("div",{style:{fontWeight:700,color:"#6B5BFF",fontSize:16,cursor:"pointer"},onClick:H=>{H.stopPropagation(),$(W===V.id?null:V.id)},children:Fl(V,U)}),i.jsx("button",{onClick:()=>Re(V.id),style:{marginLeft:"auto",background:"#ff6b6b",color:"#fff",border:"none",borderRadius:8,padding:"4px 12px",fontWeight:700,cursor:"pointer"},children:"刪除"})]}),W===V.id&&i.jsxs("div",{style:{marginTop:10},children:[i.jsx("div",{style:{color:"#232946",fontSize:15,marginBottom:4},children:Nl(V,U)}),i.jsxs("div",{style:{background:"linear-gradient(90deg, #f7f8fc 60%, #e3e6f3 100%)",borderRadius:12,padding:"8px 12px",margin:"8px 0",display:"flex",alignItems:"center",gap:8,boxShadow:"0 2px 8px #b6b6f622",fontSize:14},children:[i.jsxs("span",{style:{color:"#7f8fff",fontWeight:700},children:["🤖 ",ze.encouragement[U],"："]}),i.jsx("span",{style:{color:"#4b4b6b",fontWeight:500},children:we(V)})]}),V.tag&&i.jsx("div",{style:{fontSize:14,color:"#6B5BFF",fontWeight:700,marginBottom:4},children:Ct[U][V.tag]}),V.onChain&&i.jsx("span",{style:{fontSize:14,color:"#23c6e6",fontWeight:700,marginLeft:8},children:"🔗 已封存"}),V.visibility&&["private","friends","public"].includes(V.visibility)&&i.jsx("span",{style:{fontSize:13,color:"#888",marginLeft:8},children:ry[U][V.visibility]}),i.jsx("div",{style:{marginTop:10,fontSize:14,color:"#6B5BFF",fontWeight:500,background:"#f7f8fc",borderRadius:8,padding:"8px 12px"},children:i.jsxs("div",{children:[`${ze.profileLabels[U].split(`
`)[0].split("：")[0]}：${L&&L.nickname?L.nickname:"-"}，`,`${ze.profileLabels[U].split(`
`)[1].split("：")[0]}：${L&&L.gender?L.gender:"-"}，`,`${ze.profileLabels[U].split(`
`)[2].split("：")[0]}：${L&&L.age?L.age:"-"}，`,`${ze.profileLabels[U].split(`
`)[3].split("：")[0]}：${L&&typeof L.country=="string"&&L.country?zl[U][L.country]||L.country:"-"}，`,`${ze.profileLabels[U].split(`
`)[4].split("：")[0]}：${L&&typeof L.interest=="string"&&L.interest?Ct&&Ct[U]&&Ct[U][L.interest]?Ct[U][L.interest]:L.interest:"-"}，`,`${ze.profileLabels[U].split(`
`)[5].split("：")[0]}：${L&&typeof L.eventType=="string"&&L.eventType?Dl[U][L.eventType]||L.eventType:"-"}`]})})]})]},V.id)})})]}):i.jsxs("div",{style:{width:"100%",background:"#fff",borderRadius:18,boxShadow:"0 2px 12px #6B5BFF22",padding:"18px 12px",marginBottom:18},children:[i.jsxs("div",{style:{fontWeight:700,fontSize:18,marginBottom:10,background:"linear-gradient(90deg,#ffb86b 60%,#6B5BFF 100%)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text"},children:["#💬",ze.partnersStories[U]]}),i.jsx("button",{onClick:()=>{ve(!0),Y(!1),Ye(!1),$(null)},style:{margin:"0 0 18px 0",padding:"8px 18px",borderRadius:18,border:"none",background:"#eee",color:"#6B5BFF",fontWeight:700,fontSize:16,cursor:"pointer"},children:"返回我的故事"}),i.jsx("div",{style:{maxHeight:420,overflowY:"auto",width:"100%",paddingRight:6},children:m.filter(V=>V.visibility==="public").map(V=>{const L=ge[V.authorEmail]||{};return i.jsxs("div",{style:{background:"#fff",borderRadius:14,boxShadow:"0 2px 8px #b6b6f622",padding:14,marginBottom:14,cursor:"pointer"},children:[i.jsx("div",{style:{fontWeight:700,color:"#6B5BFF",fontSize:18,cursor:"pointer",marginBottom:4},onClick:oe=>{oe.stopPropagation(),$(W===V.id?null:V.id)},children:Fl(V,U)}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,marginBottom:2,fontSize:"14px",flexWrap:"nowrap",whiteSpace:"nowrap"},children:[i.jsx("img",{src:L.avatar||L.avatarUrl||"/avatars/Derxl.png",alt:"avatar",style:{width:36,height:36,borderRadius:"50%",objectFit:"cover",border:"2px solid #ececff"}}),i.jsx("span",{style:{fontWeight:600},children:L&&L.nickname?L.nickname:"-"}),i.jsxs("span",{children:["，",L&&L.age?L.age:"-"]}),i.jsxs("span",{children:["，",L&&L.gender?L.gender:"-"]}),i.jsxs("span",{children:["，",L&&typeof L.country=="string"&&L.country?zl[U][L.country]||L.country:"-"]}),i.jsxs("span",{children:["，",L&&typeof L.interest=="string"&&L.interest?Ct&&Ct[U]&&Ct[U][L.interest]?Ct[U][L.interest]:L.interest:"-"]}),i.jsxs("span",{children:["，",L&&typeof L.eventType=="string"&&L.eventType?Dl[U][L.eventType]||L.eventType:"-"]})]}),W===V.id&&i.jsxs("div",{style:{marginTop:10},children:[i.jsx("div",{style:{color:"#232946",fontSize:15,marginBottom:4,whiteSpace:"pre-line"},children:Nl(V,U)}),i.jsxs("div",{style:{background:"linear-gradient(90deg, #f7f8fc 60%, #e3e6f3 100%)",borderRadius:12,padding:"8px 12px",margin:"8px 0",display:"flex",alignItems:"center",gap:8,boxShadow:"0 2px 8px #b6b6f622",fontSize:14},children:[i.jsxs("span",{style:{color:"#7f8fff",fontWeight:700},children:["🤖 ",ze.encouragement[U],"："]}),i.jsx("span",{style:{color:"#4b4b6b",fontWeight:500},children:we(V)})]}),V.tag&&i.jsx("div",{style:{fontSize:14,color:"#6B5BFF",fontWeight:700,marginBottom:4},children:Ct[U][V.tag]}),V.onChain&&i.jsx("span",{style:{fontSize:14,color:"#23c6e6",fontWeight:700,marginLeft:8},children:"🔗 已封存"}),V.visibility&&["private","friends","public"].includes(V.visibility)&&i.jsx("span",{style:{fontSize:13,color:"#888",marginLeft:8},children:ry[U][V.visibility]}),i.jsx("div",{style:{marginTop:10,fontSize:14,color:"#6B5BFF",fontWeight:500,background:"#f7f8fc",borderRadius:8,padding:"8px 12px"},children:i.jsxs("div",{children:[`${ze.profileLabels[U].split(`
`)[0].split("：")[0]}：${L&&L.nickname?L.nickname:"-"}，`,`${ze.profileLabels[U].split(`
`)[1].split("：")[0]}：${L&&L.gender?L.gender:"-"}，`,`${ze.profileLabels[U].split(`
`)[2].split("：")[0]}：${L&&L.age?L.age:"-"}，`,`${ze.profileLabels[U].split(`
`)[3].split("：")[0]}：${L&&typeof L.country=="string"&&L.country?zl[U][L.country]||L.country:"-"}，`,`${ze.profileLabels[U].split(`
`)[4].split("：")[0]}：${L&&typeof L.interest=="string"&&L.interest?Ct&&Ct[U]&&Ct[U][L.interest]?Ct[U][L.interest]:L.interest:"-"}，`,`${ze.profileLabels[U].split(`
`)[5].split("：")[0]}：${L&&typeof L.eventType=="string"&&L.eventType?Dl[U][L.eventType]||L.eventType:"-"}`]})})]})]},V.id)})})]})]})]})]})}),i.jsx(Ln,{})]})})},jI=[{id:1,name_zh:"書吏",name_en:"Scribe",icon:"📜",upgrade_cost:10},{id:2,name_zh:"縣丞",name_en:"County Clerk",icon:"🪪",upgrade_cost:10},{id:3,name_zh:"通判",name_en:"Overseer",icon:"🧾",upgrade_cost:10},{id:4,name_zh:"巡撫",name_en:"Inspector",icon:"🛡️",upgrade_cost:10},{id:5,name_zh:"尚書",name_en:"Minister",icon:"🏛️",upgrade_cost:10},{id:6,name_zh:"太保",name_en:"Imperial Counselor",icon:"📯",upgrade_cost:10},{id:7,name_zh:"宰相",name_en:"Chancellor",icon:"🏯",upgrade_cost:10},{id:8,name_zh:"皇帝",name_en:"Emperor",icon:"🏰🫅",upgrade_cost:0}];function II(n){return jI.find(e=>e.id===n)}function h3(n){return jI.find(e=>e.id===n+1)}function p3(n,e){const t=II(e);return!!t&&t.upgrade_cost>0&&n>=t.upgrade_cost}const f3=w.createContext(void 0);function m3({children:n}){const[e,t]=w.useState(parseInt(localStorage.getItem("badges")||"0",10)),[r,s]=w.useState(parseInt(localStorage.getItem("rankId")||"1",10)),[a,c]=w.useState(!1);function d(){let g=e+1,x=r,S=!1;return p3(g,r)&&(x=r+1,g=0,S=!0,c(!0),setTimeout(()=>c(!1),3e3)),t(g),s(x),localStorage.setItem("badges",String(g)),localStorage.setItem("rankId",String(x)),S}const h=II(r),m=h3(r);return i.jsx(f3.Provider,{value:{badges:e,rankId:r,rank:h,nextRank:m,promotion:a,addBadge:d,setBadges:t,setRankId:s},children:n})}const g3=w.createContext(null);function y3({children:n}){const e=w.useRef(null);return w.useEffect(()=>(e.current=new WebSocket("ws://localhost:3001"),()=>{var t;return(t=e.current)==null?void 0:t.close()}),[]),i.jsx(g3.Provider,{value:e.current,children:n})}const Bn={backToHome:{"zh-TW":"← 返回","zh-CN":"← 返回",ja:"← 戻る",en:"← Back",ko:"← 뒤로",th:"← กลับ",vi:"← Quay lại",ms:"← Kembali",la:"← Redire"},logout:{"zh-TW":"登出","zh-CN":"登出",ja:"ログアウト",en:"Logout",ko:"로그아웃",th:"ออกจากระบบ",vi:"Đăng xuất",ms:"Log keluar",la:"Exire"},pageTitle:{"zh-TW":"心情解鎖盒","zh-CN":"心情解锁盒",ja:"気持ちアンロックボックス",en:"Mood Unlock Box",ko:"감정 언락 박스",th:"กล่องปลดล็อกอารมณ์",vi:"Hộp Mở Khóa Cảm Xúc",ms:"Kotak Buka Kunci Emosi",la:"Arca Unlock Affectus"},subtitle:{"zh-TW":"每天自我反思，抒發心情，追蹤情緒，照顧自己","zh-CN":"每天自我反思，抒發心情，追蹤情緒，照顧自己",ja:"毎日自分を見つめ、気持ちを表現し、感情を追いかけ、自分を大切に",en:"Daily self-reflection, express your feelings, track emotions, take care of yourself",ko:"매일 자기 성찰, 감정 표현, 감정 추적, 자신을 돌보기",th:"สะท้อนตนเองทุกวัน ระบายความรู้สึก ติดตามอารมณ์ ดูแลตัวเอง",vi:"Tự phản ánh mỗi ngày, bày tỏ cảm xúc, theo dõi cảm xúc, chăm sóc bản thân",ms:"Refleksi diri setiap hari, luahkan perasaan, jejak emosi, jaga diri",la:"Cotidie te ipsum considera, affectus exprime, motus tuos persequere, te ipsum cura"},inputPlaceholder:{"zh-TW":"請寫下你的心情...(30字內)","zh-CN":"请写下你的心情...(30字内)",en:"Write your mood... (max 30 chars)",ja:"あなたの気持ちを書いてください...(30文字以内)",ko:"당신의 기분을 적어주세요...(30자 이내)",th:"เขียนความรู้สึกของคุณ...(ไม่เกิน 30 ตัวอักษร)",vi:"Hãy viết tâm trạng của bạn...(tối đa 30 ký tự)",ms:"Tulis perasaan anda...(maksimum 30 aksara)",la:"Animum tuum scribe...(max 30 litterae)"},plantButton:{"zh-TW":"記錄此刻心情","zh-CN":"记录此刻心情",ja:"今の気持ちを記録する",en:"Record Today's Mood",ko:"오늘의 기분 기록",th:"บันทึกอารมณ์วันนี้",vi:"Ghi lại tâm trạng hôm nay",ms:"Catat Perasaan Hari Ini",la:"Inscribere hodiernum animum"},completeTitle:{"zh-TW":"🎉 恭喜你完成拼圖！🎉","zh-CN":"🎉 恭喜你完成拼图！🎉",en:"🎉 Puzzle Completed! 🎉",ja:"🎉 パズル完成！🎉",ko:"🎉 퍼즐 완성! 🎉",th:"🎉 ต่อจิ๊กซอว์สำเร็จ! 🎉",vi:"🎉 Hoàn thành ghép hình! 🎉",ms:"🎉 Teka-teki Selesai! 🎉",la:"🎉 Puzzle Perfectum! 🎉"},completeDesc:{"zh-TW":"你已經解鎖全部心情拼圖，準備好迎接下一個挑戰了嗎？","zh-CN":"你已经解锁全部心情拼图，准备好迎接下一个挑战了吗？",en:"You have unlocked all mood puzzle pieces. Ready for the next challenge?",ja:"すべての気持ちパズルを解放しました。次のチャレンジの準備はできましたか？",ko:"모든 감정 퍼즐을 해제했습니다. 다음 도전을 준비하세요!",th:"คุณได้ปลดล็อกจิ๊กซอว์อารมณ์ทั้งหมดแล้ว พร้อมสำหรับความท้าทายถัดไปหรือยัง?",vi:"Bạn đã mở khóa tất cả các mảnh ghép cảm xúc. Sẵn sàng cho thử thách tiếp theo chưa?",ms:"Anda telah membuka semua kepingan teka-teki emosi. Sedia untuk cabaran seterusnya?",la:"Omnes partes animi puzzle aperuisti. Paratus es ad provocationem sequentem?"},nextChallenge:{"zh-TW":"前往{size}x{size}新挑戰","zh-CN":"前往{size}x{size}新挑战",en:"Next {size}x{size} Challenge",ja:"{size}x{size}新しいチャレンジへ",ko:"{size}x{size} 새 도전으로",th:"ไปยังความท้าทาย {size}x{size} ถัดไป",vi:"Thử thách {size}x{size} tiếp theo",ms:"Cabaran {size}x{size} Seterusnya",la:"Ad novam provocationem {size}x{size}"},encouragement:{"zh-TW":"有時候，記錄心情，就是給自己一份溫柔的陪伴。","zh-CN":"有时候，记录心情，就是给自己一份温柔的陪伴。",en:"Sometimes, recording your feelings is a gentle way to accompany yourself.",ja:"ときどき、気持ちを記録することは自分へのやさしい寄り添いです。",ko:"가끔은 마음을 기록하는 것이 자신에게 주는 따뜻한 동행입니다.",th:"บางครั้งการบันทึกความรู้สึก คือการมอบความอ่อนโยนให้ตัวเอง",vi:"Đôi khi, ghi lại cảm xúc là cách dịu dàng để đồng hành cùng chính mình.",ms:"Kadang-kadang, mencatat perasaan adalah teman yang lembut untuk diri sendiri.",la:"Aliquando, animum inscribere est tibi ipsum leniter comitari."},toastInput:{"zh-TW":"請先輸入你的心情！","zh-CN":"请先输入你的心情！",en:"Please enter your mood first!",ja:"まず気持ちを入力してください！",ko:"먼저 기분을 입력해주세요!",th:"กรุณากรอกความรู้สึกของคุณก่อน!",vi:"Vui lòng nhập tâm trạng của bạn trước!",ms:"Sila masukkan perasaan anda dahulu!",la:"Primum animum tuum inscribe!"},invalidMood:{"zh-TW":"請輸入有意義的心情內容（不能全是數字、符號或重複字元）","zh-CN":"请输入有意义的心情内容（不能全是数字、符号或重复字符）",en:"Please enter a meaningful mood (not just numbers, symbols, or repeated characters)",ja:"意味のある気持ちを入力してください（数字や記号、同じ文字だけは不可）",ko:"의미 있는 기분을 입력해주세요(숫자, 기호, 반복문자만은 불가)",th:"กรุณากรอกความรู้สึกที่มีความหมาย (ห้ามเป็นตัวเลข สัญลักษณ์ หรืออักษรซ้ำ)",vi:"Vui lòng nhập tâm trạng có ý nghĩa (không chỉ là số, ký hiệu hoặc ký tự lặp lại)",ms:"Sila masukkan perasaan yang bermakna (bukan hanya nombor, simbol atau aksara berulang)",la:"Sententiam significantem inscribe (non solum numeri, signa aut litterae repetitae)"},completeNext:{"zh-TW":"已完成本關，請點擊前往新挑戰","zh-CN":"已完成本关，请点击前往新挑战",en:"Puzzle completed! Please proceed to the next challenge.",ja:"このステージはクリアしました。次のチャレンジへ進んでください。",ko:"이 단계는 완료되었습니다. 다음 도전으로 이동하세요.",th:"คุณผ่านด่านนี้แล้ว กรุณาไปยังความท้าทายถัดไป",vi:"Bạn đã hoàn thành màn này, hãy chuyển sang thử thách tiếp theo.",ms:"Tahap ini telah selesai. Sila ke cabaran seterusnya.",la:"Hoc gradum perfecisti. Ad provocationem sequentem procede."},finalCompleteTitle:{"zh-TW":"🎉🎉 你已經完成所有心情拼圖！ 🎉🎉","zh-CN":"🎉🎉 你已经完成所有心情拼图！ 🎉🎉",en:"🎉🎉 You have completed all mood puzzles! 🎉🎉",ja:"🎉🎉 すべての気持ちパズルを完成しました！ 🎉🎉",ko:"🎉🎉 모든 감정 퍼즐을 완성했습니다! 🎉🎉",th:"🎉🎉 คุณได้ต่อจิ๊กซอว์อารมณ์ครบทุกชิ้นแล้ว! 🎉🎉",vi:"🎉🎉 Bạn đã hoàn thành tất cả các mảnh ghép cảm xúc! 🎉🎉",ms:"🎉🎉 Anda telah melengkapkan semua teka-teki emosi! 🎉🎉",la:"🎉🎉 Omnes partes animi puzzle perfecisti! 🎉🎉"},finalCompleteDesc:{"zh-TW":"你已經解鎖所有拼圖碎片，這是屬於你的堅持與成就！請繼續相信自己，未來每一天都值得被記錄與慶祝！","zh-CN":"你已经解锁所有拼图碎片，这是属于你的坚持与成就！请继续相信自己，未来每一天都值得被记录与庆祝！",en:"You have unlocked every puzzle piece. This is your perseverance and achievement! Keep believing in yourself—every day ahead is worth celebrating!",ja:"すべてのピースをアンロックしました。これはあなたの努力と成果です！これからも自分を信じて、毎日を大切にしてください！",ko:"모든 퍼즐 조각을 해제했습니다. 이것은 당신의 끈기와 성취입니다! 앞으로도 자신을 믿고, 매일을 소중히 하세요!",th:"คุณได้ปลดล็อกจิ๊กซอว์ทุกชิ้นแล้ว นี่คือความพยายามและความสำเร็จของคุณ! จงเชื่อมั่นในตัวเองและเฉลิมฉลองทุกวัน!",vi:"Bạn đã mở khóa mọi mảnh ghép. Đây là sự kiên trì và thành tựu của bạn! Hãy tiếp tục tin vào bản thân và ăn mừng mỗi ngày!",ms:"Anda telah membuka semua kepingan teka-teki. Ini adalah ketabahan dan pencapaian anda! Teruskan percaya pada diri sendiri dan raikan setiap hari!",la:"Omnia fragmenta aenigmatis aperuisti. Haec est constantia et perfectio tua! Crede tibi et diem quemque celebra!"}};function x3(){var ee;const n=wt(),e=gt(),{lang:t,setLang:r}=Bt(),[s,a]=w.useState(""),[c,d]=w.useState(!1),[h,m]=w.useState([]),g=((ee=e.currentUser)==null?void 0:ee.uid)||"",[x,S]=w.useState(!1),[I,_]=w.useState(""),R=new Date().toISOString().slice(0,10);w.useEffect(()=>{g&&fetch(`/api/mood?userId=${g}`).then(he=>he.json()).then(he=>m(he))},[g]);const[T,A]=_n.useState(()=>{const he=localStorage.getItem("puzzleStage");return he?JSON.parse(he):{size:3,unlocked:0,completed:!1,lastDate:""}});_n.useEffect(()=>{localStorage.setItem("puzzleStage",JSON.stringify(T))},[T]);const D=T.size||3,F=D+1,ie=`/puzzle${D-2}.png`,G=D,N=G*G;function E(he){return Array.from({length:N},(_e,ve)=>ve<he)}function P(){const he={size:F,unlocked:0,completed:!1,lastDate:new Date().toISOString().slice(0,10)};A(he),m([]),Y(null)}const M=async()=>{if(!g){_("請先登入才能解鎖拼圖"),S(!0),setTimeout(()=>S(!1),2e3);return}let he=!1;if(Array.isArray(h)){for(const Ne of h)if(Ne&&Array.isArray(Ne.petals)&&Ne.petals.some(nt=>typeof nt.date=="string"&&nt.date.slice(0,10)===R)){he=!0;break}}if(he){_("一天解鎖一片拼圖夠啦，明天再來😊"),S(!0),setTimeout(()=>S(!1),2e3);return}if(ae){_(Bn.completeNext[t]),S(!0),setTimeout(()=>S(!1),2e3);return}if(!s){_(Bn.toastInput[t]),S(!0),setTimeout(()=>S(!1),2e3);return}const _e=s.replace(/\s/g,"");if(/^\d+$/.test(_e)){_(Bn.invalidMood[t]),S(!0),setTimeout(()=>S(!1),2e3);return}if(/^[\p{P}\p{S}]+$/u.test(_e)){_(Bn.invalidMood[t]),S(!0),setTimeout(()=>S(!1),2e3);return}if(_e.length>=4&&/^(.)\1+$/.test(_e)){_(Bn.invalidMood[t]),S(!0),setTimeout(()=>S(!1),2e3);return}if(_e.length<4){_(Bn.invalidMood[t]),S(!0),setTimeout(()=>S(!1),2e3);return}d(!0),await fetch("/api/mood",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:g,mood:s,date:new Date().toISOString().slice(0,10)+"-"+Math.random()})}),a(""),fetch(`/api/mood?userId=${g}`).then(Ne=>Ne.json()).then(Ne=>m(Ne)),d(!1),A(Ne=>({...Ne,unlocked:Ne.unlocked+1,lastDate:new Date().toISOString().slice(0,10)}));const ve=new Date,Le=ve.getDay();Y({date:ve.toISOString().slice(0,10),mood:W[Le],isTodayNewPiece:!0})},O=T.unlocked,z=E(O),[j,K]=_n.useState(!1),[Z,Y]=_n.useState(null),ae=O>=N;function se(){const he={size:3,unlocked:0,completed:!1,lastDate:""};localStorage.setItem("puzzleStage",JSON.stringify(he)),window.location.reload()}const re={};Array.isArray(h)&&h.forEach(he=>{he&&Array.isArray(he.petals)&&he.petals.forEach(_e=>{if(_e&&typeof _e.mood=="string"&&typeof _e.date=="string"){const ve=_e.date.slice(0,10);re[ve]={mood:_e.mood,date:ve}}})});const ne=Object.values(re).sort((he,_e)=>he.date.localeCompare(_e.date));console.log("DEBUG allPetals:",ne);const W=["明天記得再來喔 🌈","每天一點點，心情拼圖就會完成！🧩","你的心情很重要，明天也來記錄吧！📝","給自己一個鼓勵，明天見！💪","一天一片，慢慢拼出美好心情！🌟","明天再來解鎖新拼圖吧！🔓","保持好心情，明天繼續加油！😊"],$={"zh-TW":"用心情解鎖拼圖","zh-CN":"用心情解锁拼图",en:"Unlock puzzles with your mood",ja:"気持ちでパズルを解こう",ko:"마음으로 퍼즐을 해제하세요",th:"ปลดล็อกจิ๊กซอว์ด้วยอารมณ์",vi:"Mở khóa ghép hình bằng cảm xúc",ms:"Buka teka-teki dengan perasaan",la:"Affectibus tuis aenigmata solve"};return i.jsxs("div",{style:{width:"100vw",position:"relative",overflowX:"hidden",background:"url('/snowmountain.png') center center / cover no-repeat fixed, linear-gradient(to bottom, #eaf6ff 0%, #f7fafc 100%)",minHeight:"0"},children:[x&&i.jsx("div",{style:{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",background:"rgba(255,255,255,0.98)",color:"#6B5BFF",fontWeight:700,fontSize:20,padding:"28px 48px",borderRadius:18,boxShadow:"0 4px 32px #6B5BFF33",zIndex:3e3,textAlign:"center",letterSpacing:1.5,transition:"opacity 0.3s"},children:I}),i.jsxs("div",{style:{width:"100%",maxWidth:700,margin:"20px auto 20px auto",padding:"16px 24px",background:"rgba(255,255,255,0.95)",borderRadius:16,boxShadow:"0 4px 20px rgba(0,0,0,0.1)",display:"flex",alignItems:"center",justifyContent:"space-between",position:"relative"},children:[i.jsx("button",{className:"topbar-btn",onClick:()=>n("/"),style:{fontWeight:700,fontSize:16,padding:"8px 16px",borderRadius:8,border:"1.5px solid #6B5BFF",background:"#fff",color:"#6B5BFF",cursor:"pointer",minWidth:80},children:Bn.backToHome[t]}),i.jsxs("h1",{style:{fontWeight:900,fontSize:18,color:"#6B5BFF",margin:0,lineHeight:1,textShadow:"0 2px 8px #6B5BFF88",textAlign:"center",flex:1},children:[i.jsx("span",{role:"img","aria-label":"mood",children:"🌱"})," ",Bn.pageTitle[t]]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[i.jsx("button",{className:"topbar-btn",onClick:async()=>{await Tr(e),localStorage.clear(),window.location.href="/"},style:{fontWeight:700,fontSize:16,padding:"8px 16px",borderRadius:8,border:"1.5px solid #6B5BFF",background:"#fff",color:"#6B5BFF",cursor:"pointer",minWidth:80},children:Bn.logout[t]}),i.jsx("div",{style:{width:80},children:i.jsx(Mn,{style:{width:"100%"}})})]})]}),i.jsxs("div",{style:{maxWidth:700,margin:"0 auto 0 auto",padding:"1.2rem 2vw 0 2vw",background:"rgba(255,255,255,0.92)",borderRadius:24,boxShadow:"0 8px 32px rgba(0,0,0,0.08)",position:"relative"},children:[i.jsx("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center",gap:12,flexWrap:"nowrap",marginBottom:8},children:i.jsx("span",{style:{fontSize:15,color:"#888",fontWeight:700,letterSpacing:1,textShadow:"0 2px 12px #6B5BFF55",whiteSpace:"nowrap"},children:$[t]||$.en})}),i.jsx("div",{style:{color:"#888",fontSize:18,marginBottom:0,textAlign:"center",fontWeight:700,letterSpacing:1,textShadow:"0 2px 12px #6B5BFF55"},children:Bn.subtitle[t]}),i.jsxs("div",{style:{width:"100%",textAlign:"center",color:"#232323",fontSize:17,fontWeight:500,margin:"0 0 10px 0",letterSpacing:.5,lineHeight:1.5,textShadow:"0 2px 8px #bbb8"},children:[Bn.encouragement[t],i.jsx("span",{role:"img","aria-label":"rainbow",children:"🌈"})]}),i.jsxs("div",{style:{display:"flex",flexDirection:"row",alignItems:"flex-end",gap:12,width:"100%",justifyContent:"center",marginBottom:8},children:[i.jsx("textarea",{value:s,onChange:he=>a(he.target.value),placeholder:Bn.inputPlaceholder[t],maxLength:30,rows:3,style:{width:260,minWidth:180,maxWidth:320,padding:12,borderRadius:8,border:"1.5px solid #ddd",fontSize:16,resize:"vertical",marginRight:0}}),i.jsx("button",{onClick:M,disabled:c,style:{width:140,minWidth:100,padding:"14px 0",background:c?"#ccc":"linear-gradient(135deg, #6B5BFF 60%, #23c6e6 100%)",color:"#fff",border:"none",borderRadius:10,fontWeight:900,fontSize:16,letterSpacing:1,cursor:c?"not-allowed":"pointer",transition:"all 0.2s ease",marginLeft:0,marginBottom:0},children:c?"...":Bn.plantButton[t]})]}),i.jsx("div",{style:{borderTop:"1px solid #eee",margin:"16px 0"}}),i.jsx("div",{children:i.jsxs("div",{style:{minHeight:0,background:"#f0f8ff",borderRadius:12,display:"block",color:"#aaa",position:"relative",width:"100%",maxWidth:540,overflow:"hidden",margin:"0 auto",padding:"0 0 24px 0"},children:[i.jsx("div",{style:{display:"grid",gridTemplateColumns:`repeat(${G}, 1fr)`,gridTemplateRows:`repeat(${G}, 1fr)`,width:"100%",maxWidth:"100%",margin:"0 auto",aspectRatio:"1 / 1",position:"relative",zIndex:1,gap:0,background:"#fff",boxShadow:"0 2px 24px #6B5BFF22",boxSizing:"border-box"},children:z.map((he,_e)=>{const ve=ne[_e]||null,Le=(ve==null?void 0:ve.mood)||"",Ne=(ve==null?void 0:ve.date)||"",nt=Math.floor(_e/G),Je=_e%G,ge=!!ve;return i.jsxs("div",{style:{width:"100%",height:"100%",aspectRatio:"1/1",overflow:"hidden",position:"relative",border:"none",boxSizing:"border-box",cursor:ge?"pointer":"default",display:"flex",alignItems:"center",justifyContent:"center"},onClick:()=>{ge&&Y({date:Ne,mood:Le})},children:[i.jsx("img",{src:ie,alt:"puzzle",style:{width:`calc(100% * ${G})`,height:`calc(100% * ${G})`,objectFit:"cover",position:"absolute",left:`-${Je*100}%`,top:`-${nt*100}%`,filter:he?"none":"blur(8px) grayscale(1) brightness(1.2)",opacity:he?1:.5,transition:"filter 0.3s, opacity 0.3s"}}),!he&&i.jsx("div",{style:{position:"absolute",inset:0,background:"rgba(255,255,255,0.7)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:32},children:"?"}),!ve&&he&&i.jsx("div",{style:{position:"absolute",inset:0,display:"flex",alignItems:"center",justifyContent:"center",fontSize:18,color:"#bbb"},children:"尚未記錄"})]},_e)})}),Z&&!ae&&i.jsx("div",{style:{position:"fixed",left:0,top:0,width:"100vw",height:"100vh",zIndex:2e3,display:"flex",alignItems:"center",justifyContent:"center"},onClick:()=>Y(null),children:i.jsxs("div",{style:{background:"#fff",borderRadius:16,padding:"32px 40px",boxShadow:"0 4px 32px #0008",minWidth:260,maxWidth:320,textAlign:"center",fontSize:18,fontWeight:700},children:[i.jsx("div",{style:{fontSize:16,color:"#6B5BFF",marginBottom:8},children:Z.date}),i.jsx("div",{style:{fontSize:22,color:"#232946",marginBottom:8},children:Z.mood}),Z.isTodayNewPiece&&i.jsx("div",{style:{fontSize:15,color:"#888",marginTop:8},children:"(一天只能解鎖一片，明天再來！)"}),i.jsx("div",{style:{fontSize:14,color:"#888"},children:"（點擊空白處關閉）"})]})}),ae&&i.jsx(i.Fragment,{children:i.jsx("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",zIndex:2,pointerEvents:"auto",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",textAlign:"center",background:"rgba(255,255,255,0.0)"},children:T.size===22?i.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",width:"100%",maxWidth:"90vw",margin:"0 auto"},children:[i.jsx("div",{style:{fontSize:32,fontWeight:900,color:"#ff9800",textShadow:"0 2px 12px #fff,0 4px 24px #ff980088",letterSpacing:2,marginBottom:12,lineHeight:1.2,wordBreak:"break-word",maxWidth:"100%"},children:Bn.finalCompleteTitle[t]}),i.jsx("div",{style:{fontSize:18,fontWeight:600,color:"#6B5BFF",textShadow:"0 2px 12px #6B5BFF88",letterSpacing:1,lineHeight:1.5,wordBreak:"break-word",maxWidth:"100%",marginBottom:24},children:Bn.finalCompleteDesc[t]}),i.jsx("button",{onClick:se,style:{padding:"14px 40px",background:"linear-gradient(135deg,#6B5BFF 60%,#23c6e6 100%)",color:"#fff",border:"none",borderRadius:16,fontWeight:900,fontSize:22,boxShadow:"0 2px 12px #6B5BFF44",cursor:"pointer",letterSpacing:2,transition:"transform 0.2s",outline:"none",display:"block"},children:"再來一次"})]}):i.jsxs(i.Fragment,{children:[i.jsx("div",{style:{position:"relative",fontSize:24,fontWeight:900,color:"#ff9800",textShadow:"0 2px 12px #fff,0 4px 24px #ff980088",transform:"scale(0.7)",opacity:1,animation:"flyIn1 0.5s 0.1s cubic-bezier(.68,-0.55,.27,1.55) forwards"},children:Bn.completeTitle[t]}),i.jsx("div",{style:{position:"relative",fontSize:20,fontWeight:700,color:"#6B5BFF",marginTop:18,opacity:0,animation:"flyIn2 0.5s 0.6s cubic-bezier(.68,-0.55,.27,1.55) forwards"},children:Bn.completeDesc[t]}),i.jsx("div",{style:{position:"relative",marginTop:32,opacity:0,animation:"flyIn3 0.5s 1.1s cubic-bezier(.68,-0.55,.27,1.55) forwards"},children:i.jsx("button",{type:"button",onClick:P,style:{padding:"18px 48px",background:"linear-gradient(135deg,#6B5BFF 60%,#23c6e6 100%)",color:"#fff",borderRadius:16,fontWeight:900,fontSize:24,boxShadow:"0 2px 12px #6B5BFF44",border:"none",cursor:"pointer",letterSpacing:2,transition:"transform 0.2s",outline:"none",display:"block"},children:Bn.nextChallenge[t].replace(/\{size\}/g,String(F))})}),i.jsx("style",{children:`
@keyframes flyIn1 { from { opacity:0; transform:translateY(40px) scale(0.7);} to { opacity:1; transform:translateY(0) scale(1);} }
@keyframes flyIn2 { from { opacity:0; transform:translateY(40px) scale(0.7);} to { opacity:1; transform:translateY(0) scale(1);} }
@keyframes flyIn3 { from { opacity:0; transform:translateY(40px) scale(0.7);} to { opacity:1; transform:translateY(0) scale(1);} }
`})]})})})]})})]}),i.jsx(Ln,{})]})}const b3="ws://localhost:3001",v3=({roomId:n})=>{const e=w.useRef(null),t=w.useRef(null),[r,s]=w.useState(!1),[a,c]=w.useState(null),[d,h]=w.useState(null),[m,g]=w.useState(n||""),[x,S]=w.useState(n||""),[I,_]=w.useState(""),{checkPermission:R,recordUsage:T}=Lo(),[A,D]=w.useState(!1),[F,X]=w.useState(null);w.useEffect(()=>{n&&!r&&(S(n),G(n))},[n]);const ie=async()=>{const K=await R("aiChat");return K.allowed?!0:(K.canRenew,X(K),D(!0),!1)},G=async K=>{if(!await ie())return;g(K),N();const Y=E(),ae=await navigator.mediaDevices.getUserMedia({video:!0,audio:!0});ae.getTracks().forEach(se=>Y.addTrack(se,ae)),e.current&&(e.current.srcObject=ae),Y.onnegotiationneeded=async()=>{const se=await Y.createOffer();await Y.setLocalDescription(se),a==null||a.send(JSON.stringify({type:"offer",offer:se,room:K}))},s(!0),await T("aiChat",1)},N=()=>{if(a)return;const K=new WebSocket(b3);K.onopen=()=>console.log("WebSocket connected"),K.onmessage=async Z=>{const Y=JSON.parse(Z.data);Y.type==="offer"?await M(Y.offer):Y.type==="answer"?await O(Y.answer):Y.type==="candidate"&&await z(Y.candidate)},K.onerror=Z=>_("WebSocket 連線失敗"),c(K)},E=()=>{const K=new RTCPeerConnection({iceServers:[{urls:"stun:stun.l.google.com:19302"}]});return K.onicecandidate=Z=>{Z.candidate&&a&&m&&a.send(JSON.stringify({type:"candidate",candidate:Z.candidate,room:m}))},K.ontrack=Z=>{t.current&&(t.current.srcObject=Z.streams[0])},h(K),K},P=async()=>{if(!x)return _("請輸入房間代碼");if(!await ie())return;g(x),N();const Z=E(),Y=await navigator.mediaDevices.getUserMedia({video:!0,audio:!0});Y.getTracks().forEach(ae=>Z.addTrack(ae,Y)),e.current&&(e.current.srcObject=Y),Z.onnegotiationneeded=async()=>{const ae=await Z.createOffer();await Z.setLocalDescription(ae),a==null||a.send(JSON.stringify({type:"offer",offer:ae,room:x}))},s(!0),await T("aiChat",1)},M=async K=>{const Z=d||E();await Z.setRemoteDescription(new RTCSessionDescription(K));const Y=await navigator.mediaDevices.getUserMedia({video:!0,audio:!0});Y.getTracks().forEach(se=>Z.addTrack(se,Y)),e.current&&(e.current.srcObject=Y);const ae=await Z.createAnswer();await Z.setLocalDescription(ae),a==null||a.send(JSON.stringify({type:"answer",answer:ae,room:m})),s(!0)},O=async K=>{d&&await d.setRemoteDescription(new RTCSessionDescription(K))},z=async K=>{d&&await d.addIceCandidate(new RTCIceCandidate(K))},j=()=>{D(!1),X(null)};return i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{minHeight:480,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",background:"#f7f7fa"},children:[i.jsx("h2",{style:{color:"#6B5BFF",fontWeight:900,fontSize:24,marginBottom:18},children:"免費一對一視訊聊天"}),!r&&!n&&i.jsxs("div",{style:{marginBottom:24},children:[i.jsx("input",{value:x,onChange:K=>S(K.target.value),placeholder:"請輸入房間代碼",style:{padding:8,borderRadius:8,border:"1.5px solid #6B5BFF",marginRight:8}}),i.jsx("button",{onClick:P,style:{background:"#6B5BFF",color:"#fff",border:"none",borderRadius:8,padding:"8px 18px",fontWeight:700,fontSize:16,cursor:"pointer"},children:"加入房間"})]}),I&&i.jsx("div",{style:{color:"red",marginBottom:12},children:I}),i.jsxs("div",{style:{display:"flex",gap:24},children:[i.jsxs("div",{children:[i.jsx("div",{style:{fontWeight:700,marginBottom:8},children:"本地視訊"}),i.jsx("video",{ref:e,autoPlay:!0,playsInline:!0,muted:!0,style:{width:240,height:180,background:"#000",borderRadius:12}})]}),i.jsxs("div",{children:[i.jsx("div",{style:{fontWeight:700,marginBottom:8},children:"對方視訊"}),i.jsx("video",{ref:t,autoPlay:!0,playsInline:!0,style:{width:240,height:180,background:"#000",borderRadius:12}})]})]})]}),A&&F&&i.jsx(Mo,{isOpen:A,onClose:j,currentPlan:F.currentPlan,remainingDays:F.remainingDays,usedTokens:F.usedTokens,totalTokens:F.totalTokens})]})},ik={"zh-TW":{back:"← 返回上一頁",title:"聊天室",send:"送出",placeholder:"輸入訊息..."},"zh-CN":{back:"← 返回上一页",title:"聊天室",send:"发送",placeholder:"输入信息..."},en:{back:"← Back",title:"Chat Room",send:"Send",placeholder:"Type a message..."},ja:{back:"← 前のページへ",title:"チャットルーム",send:"送信",placeholder:"メッセージを入力..."},ko:{back:"← 이전 페이지",title:"채팅방",send:"보내기",placeholder:"메시지 입력..."},th:{back:"← กลับ",title:"ห้องแชท",send:"ส่ง",placeholder:"พิมพ์ข้อความ..."},vi:{back:"← Quay lại",title:"Phòng chat",send:"Gửi",placeholder:"Nhập tin nhắn..."},ms:{back:"← Kembali",title:"Bilik Sembang",send:"Hantar",placeholder:"Taip mesej..."},la:{back:"← Redire",title:"Cella Colloquii",send:"Mitte",placeholder:"Nuntium insere..."}};function w3({open:n,onClose:e,roomId:t}){return n?i.jsx("div",{style:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",background:"#0007",zIndex:9999,display:"flex",alignItems:"center",justifyContent:"center"},children:i.jsxs("div",{style:{background:"#fff",borderRadius:16,padding:24,boxShadow:"0 2px 16px #0003",minWidth:540,minHeight:420,position:"relative"},children:[i.jsx("button",{onClick:e,style:{position:"absolute",top:12,right:12,background:"#eee",border:"none",borderRadius:8,padding:"6px 14px",fontWeight:700,cursor:"pointer"},children:"關閉"}),i.jsx(v3,{roomId:t})]})}):null}function S3(){const[n,e]=w.useState([]),[t,r]=w.useState(null),[s,a]=w.useState([]),[c,d]=w.useState(""),{lang:h,setLang:m}=Bt(),[g,x]=w.useState(null),[S,I]=w.useState(!0),_=w.useRef(null),R=wt(),[T,A]=w.useState(!1),{isTestMode:D}=RI();w.useEffect(()=>{const G=zo(ya,async N=>{N?(x(N),await F(N.uid)):R("/")});return()=>G()},[R]);const F=async G=>{I(!0);const N=kn(Ft,"links"),E=cr(N,Tn("user1Id","==",G),Tn("status","==","connected")),P=cr(N,Tn("user2Id","==",G),Tn("status","==","connected")),[M,O]=await Promise.all([Dr(E),Dr(P)]),z=new Set;M.forEach(K=>z.add(K.data().user2Id)),O.forEach(K=>z.add(K.data().user1Id));const j=[];for(const K of z){const Z=Gn(Ft,"profiles",K),Y=await Io(Z);if(Y.exists()){const ae=Y.data();j.push({id:K,name:ae.name||"好友",avatar:ae.avatar||"/avatars/Derxl.png",online:!!ae.online})}}D&&j.push({id:"test-friend-1",name:"測試好友 1",avatar:"/avatars/Annie.png",online:!0},{id:"test-friend-2",name:"測試好友 2",avatar:"/avatars/Bray.png",online:!1},{id:"test-friend-3",name:"測試好友 3",avatar:"/avatars/berlex.png",online:!0}),e(j),I(!1)};w.useEffect(()=>{if(g&&t){if(I(!0),D&&t.id.startsWith("test-friend-")){const P=[{id:"test-msg-1",fromUserId:t.id,fromUserName:t.name,toUserId:g.uid,toUserName:g.displayName||"我",text:"你好！很高興認識你 😊",participants:[g.uid,t.id],createdAt:new Date(Date.now()-3e5)},{id:"test-msg-2",fromUserId:g.uid,fromUserName:g.displayName||"我",toUserId:t.id,toUserName:t.name,text:"你好！我也很高興認識你 👋",participants:[g.uid,t.id],createdAt:new Date(Date.now()-24e4)},{id:"test-msg-3",fromUserId:t.id,fromUserName:t.name,toUserId:g.uid,toUserName:g.displayName||"我",text:"今天天氣真不錯，你有什麼計劃嗎？",participants:[g.uid,t.id],createdAt:new Date(Date.now()-18e4)},{id:"test-msg-4",fromUserId:g.uid,fromUserName:g.displayName||"我",toUserId:t.id,toUserName:t.name,text:"我想去公園散步，你要一起嗎？",participants:[g.uid,t.id],createdAt:new Date(Date.now()-12e4)},{id:"test-msg-5",fromUserId:t.id,fromUserName:t.name,toUserId:g.uid,toUserName:g.displayName||"我",text:"好啊！聽起來很有趣 🌳",participants:[g.uid,t.id],createdAt:new Date(Date.now()-6e4)}];a(P),I(!1);return}const G=kn(Ft,"messages"),N=cr(G,Tn("participants","array-contains",g.uid),Qp("createdAt","asc")),E=g0(N,P=>{const M=[];P.forEach(O=>{const z=O.data();z.participants.includes(t.id)&&M.push({...z,id:O.id})}),a(M),I(!1)});return()=>E()}},[g,t,D]),w.useEffect(()=>{var G;(G=_.current)==null||G.scrollIntoView({behavior:"smooth"})},[s]);const X=async()=>{if(!(!c.trim()||!g||!t)){if(D&&t.id.startsWith("test-friend-")){const G={id:`test-msg-${Date.now()}`,fromUserId:g.uid,fromUserName:g.displayName||"我",toUserId:t.id,toUserName:t.name,text:c,participants:[g.uid,t.id],createdAt:new Date};a(N=>[...N,G]),d("");return}try{const G={fromUserId:g.uid,fromUserName:g.displayName||"我",toUserId:t.id,toUserName:t.name,text:c,participants:[g.uid,t.id],createdAt:x0()};await go(kn(Ft,"messages"),G),d("")}catch{alert("發送訊息失敗")}}},ie=G=>{G.key==="Enter"&&!G.shiftKey&&(G.preventDefault(),X())};return S?i.jsx("div",{style:{background:"url('/green_hut.png') center center / cover no-repeat",minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center"},children:i.jsx("div",{style:{color:"#fff",fontSize:18},children:"載入中..."})}):i.jsxs("div",{style:{background:"url('/green_hut.png') center center / cover no-repeat",minHeight:"100vh",display:"flex",flexDirection:"row",alignItems:"flex-start",justifyContent:"center",paddingTop:40,position:"relative"},children:[i.jsx("button",{onClick:()=>R("/friend"),style:{position:"fixed",top:24,left:24,zIndex:10001,background:"#fff",border:"1.5px solid #6B5BFF",color:"#6B5BFF",borderRadius:8,padding:"6px 18px",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:"0 2px 8px #0001"},children:"返回上一頁"}),i.jsxs("div",{style:{width:220,background:"#fff",borderRadius:16,boxShadow:"0 2px 8px #0001",padding:16,marginRight:32,minHeight:600},children:[i.jsx("div",{style:{fontWeight:700,fontSize:20,marginBottom:16},children:"好友列表"}),n.length===0?i.jsx("div",{style:{color:"#888",textAlign:"center",marginTop:80,fontSize:16,fontWeight:600},children:D?i.jsxs(i.Fragment,{children:["測試模式已啟用，但沒有測試好友",i.jsx("br",{}),i.jsx("span",{style:{fontSize:32},children:"🧪"})]}):i.jsxs(i.Fragment,{children:["你暫時沒有連結朋友，再繼續加油 💪",i.jsx("br",{}),i.jsx("span",{style:{fontSize:32},children:"🦋"})]})}):n.map(G=>i.jsxs("div",{onClick:()=>r(G),style:{display:"flex",alignItems:"center",gap:12,marginBottom:16,cursor:"pointer",opacity:(t==null?void 0:t.id)===G.id?1:.7},children:[i.jsx("img",{src:G.avatar,alt:G.name,style:{width:44,height:44,borderRadius:"50%",filter:G.online?"none":"grayscale(1)",border:(t==null?void 0:t.id)===G.id?"2px solid #6B5BFF":"2px solid #eee"}}),i.jsxs("div",{children:[i.jsxs("div",{style:{fontWeight:600,color:G.online?"#222":"#aaa"},children:[G.name,D&&G.id.startsWith("test-friend-")&&i.jsx("span",{style:{fontSize:"10px",background:"#ff6b6b",color:"white",padding:"2px 6px",borderRadius:"4px",marginLeft:"6px",fontWeight:"normal"},children:"測試"})]}),i.jsx("div",{style:{fontSize:12,color:G.online?"#23c6e6":"#aaa"},children:G.online?"在線":"離線"})]})]},G.id))]}),i.jsxs("div",{style:{flex:1,maxWidth:500,background:"#fff",borderRadius:16,boxShadow:"0 2px 8px #0001",padding:32,minHeight:600,display:"flex",flexDirection:"column",position:"relative"},children:[i.jsx("div",{style:{fontWeight:700,fontSize:22,marginBottom:16,marginTop:8},children:t?D&&t.id.startsWith("test-friend-")?`與 ${t.name} 聊天 (測試模式)`:`與 ${t.name} 聊天`:n.length===0?D?"測試模式已啟用，請選擇測試好友開始聊天":"請先加好友，才能開始聊天":"請選擇好友開始聊天"}),i.jsxs("div",{style:{flex:1,overflowY:"auto",marginBottom:16,background:"#f7f7f7",borderRadius:8,padding:16,minHeight:240,maxHeight:340},children:[(!t||s.length===0)&&i.jsx("div",{style:{textAlign:"center",color:"#888",marginTop:20},children:t?D&&t.id.startsWith("test-friend-")?"開始測試聊天吧！":"開始聊天吧！":n.length===0?D?"測試模式已啟用，請選擇測試好友開始聊天！":"還沒有朋友，去交友區加好友吧！":"請先選擇好友"}),t&&s.map((G,N)=>i.jsxs("div",{style:{textAlign:G.fromUserId===(g==null?void 0:g.uid)?"right":"left",marginBottom:10},children:[i.jsxs("span",{style:{fontWeight:600,color:G.fromUserId===(g==null?void 0:g.uid)?"#2a5d8f":"#888"},children:[G.fromUserName,"："]}),i.jsx("span",{style:{marginLeft:8},children:G.text})]},G.id||N)),i.jsx("div",{ref:_})]}),i.jsxs("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",gap:8,minHeight:48,marginTop:8},children:[i.jsx("input",{value:c,onChange:G=>d(G.target.value),onKeyPress:ie,style:{flex:1,borderRadius:6,border:"1px solid #ccc",padding:10,fontSize:16},placeholder:D&&(t!=null&&t.id.startsWith("test-friend-"))?"輸入測試訊息...":ik[h].placeholder,disabled:n.length===0||!t}),i.jsx("button",{onClick:t?X:void 0,disabled:n.length===0||!t,style:{background:"#8ec6f7",color:"#fff",border:"none",borderRadius:6,padding:"10px 20px",fontWeight:700,fontSize:16,cursor:n.length===0||!t?"not-allowed":"pointer",opacity:n.length===0||!t?.5:1},children:D&&(t!=null&&t.id.startsWith("test-friend-"))?"測試發送":ik[h].send}),i.jsx("button",{onClick:t?()=>A(!0):void 0,disabled:n.length===0||!t,style:{background:"#6B5BFF",color:"#fff",border:"none",borderRadius:6,padding:"10px 20px",fontWeight:700,fontSize:16,cursor:n.length===0||!t?"not-allowed":"pointer",opacity:n.length===0||!t?.5:1},children:D&&(t!=null&&t.id.startsWith("test-friend-"))?"測試視訊":"視訊聊天"})]}),i.jsx(w3,{open:T,onClose:()=>A(!1),roomId:g&&t?`${g.uid}_${t.id}`:""})]})]})}const ls={"zh-TW":"每個人都值得一個能「重啟」的起點。","zh-CN":"每个人都值得一个能“重启”的起点。",en:"Everyone deserves a new beginning.",ja:"誰もが「再出発」できるスタート地点を持つべきです。",ko:'모든 사람은 "다시 시작"할 수 있는 출발점이 필요합니다.',th:"ทุกคนสมควรได้รับจุดเริ่มต้นใหม่",vi:"Mỗi người đều xứng đáng có một khởi đầu mới.",ms:"Setiap orang layak mendapat permulaan semula.",la:"Omnis novum initium meretur."},k3={"zh-TW":{title:"我們是誰",subtitle:"🧬 Restarter™｜我們是誰（關於我們）",story:`${ls["zh-TW"]}
你可能來自一場重創，或正走在一條孤獨的路上。
在這個被標籤和數據主導的世界裡，我們知道——有些情緒，不是一句「加油」能解決的。

Restarter™ 是專為「曾經失去節奏的人」打造的 AI 陪伴平台。
我們不但教你怎麼變強、不單告訴你要正能量，
我們更提供一個空間,讓你可以呼吸、可以交流、可以說實話、可以重新選擇。

這裡沒有社會的審判，只有一群「曾經也痛過的人」在用技術把陪伴具體化。
透過 AI，我們讓每一次對話、每一段情緒，都有人接得住。`,quote:"「我們不是修復你，我們是來陪你重啟。」",restart:"Restarter™，是你重新定義自己的起點。",founder:"創辦者的話",founderStory:`我曾經失去自由十年。<br/>
那不是旅居、不是修行，而是被法律與命運關進去的十年。<br/>
在一間不大的房間裡，和一群同樣頂著光頭、穿著另類制服的人擠在一起，日子一開始像是一場長夢，到了後來，連夢都不做了。我以為這一生就這樣被定義了。<br/><br/>
出去那天，天空灰得刺眼。我笑著走出來，但心裡卻是空的。<br/>
社會沒有在等你，家人不知如何面對你，朋友的問候也帶著距離。<br/>
起初的很多時候，我甚至不敢正眼看便利商店的收銀員，因為<span style='color:#e4572e;font-weight:700;'>我忘了怎麼當一個「普通人」</span>。<br/><br/>
我一直想問：<br/>
<span style='color:#614425;font-weight:900;'>我還有沒有機會，重新開始？</span><br/><br/>
後來我才明白——<br/>
<span style='color:#e4572e;font-weight:900;'>不是世界不給機會，是我們被迫忘了怎麼伸手抓。</span><br/><br/>
這就是 <span style='color:#6B5BFF;font-weight:900;'>Restarter™</span> 存在的原因。<br/>
不是來修復你，不是總告訴你「要振作」，<br/>
而是給你一個空間，一個能慢慢重新建立自己的容器。<br/>
讓你在失落裡還能大聲說話，在混亂中依然有人接得住。<br/><br/>
<span style='color:#6B5BFF;font-weight:900;'>Restarter™</span>，不只是技術產品，<br/>
是我從自己生命最底部捧出來的一個火種，<br/>
我希望它能為你，也為更多人，點起一盞燈。<br/><br/>
<span style='color:#614425;font-weight:900;'>不論你是誰，經歷什麼，來自世界哪個角落，<br/>在這裡你可以大膽放下那些標籤、包裝、包袱。</span><br/>
因為我們相信——<br/>
<span style='color:#e4572e;font-weight:900;'>「破碎過的人，不僅能堅強，也能很溫柔。」</span><br/><br/>
<span style='color:#6B5BFF;font-weight:900;'>我們不是修復你，我們是來陪你重啟。</span><br/>
<div style='text-align:right;margin-top:24px;font-size:18px;color:#232946;font-weight:700;'>發起人：Ben<br/>May,21,2025</div>`},"zh-CN":{title:"我们是谁",subtitle:"🧬 Restarter™｜我们是谁（关于我们）",story:`${ls["zh-CN"]}
你可能来自一场重创，或正走在一条孤独的路上。
在这个被标签和数据主导的世界里，我们知道——有些情绪，不是一句「加油」能解决的。

Restarter™ 是专为「曾经失去节奏的人」打造的 AI 陪伴平台。
我们不教你怎么变强、不告诉你要正能量，
我们只提供一个空间，让你可以呼吸、可以说实话、可以重新选择。

这里没有社会的审判，只有一群「曾经也痛过的人」在用技术把陪伴实体化。
通过 AI，我们让每一次对话、每一段情绪，都有人接得住。`,quote:"「我们不是修复你，我们陪你重启。」",restart:"Restarter™，是你重新定义自己的起点。",founder:"创办者的话",founderStory:`我曾经失去自由十年。<br/>
那不是旅行、不是修行，而是被法律和命运关进去了十年。<br/>
在一间不大的房间里，和一群同样光头、穿着统一服装的人挤在一起，日子一开始像是一场长梦，后来连梦都不做了。我以为这一生就这样被定义了。<br/><br/>
出去那天，天空灰得刺眼。我笑着走出来，但心里却是空的。<br/>
社会没有在等你，家人不知如何面对你，朋友的问候也带着距离。<br/>
很多时候，我甚至不敢正眼看便利店的收银员，因为<span style='color:#e4572e;font-weight:700;'>我忘了怎么当一个"普通人"</span>。<br/><br/>
我一直想问：<br/>
<span style='color:#614425;font-weight:900;'>我还有没有机会，重新开始？</span><br/><br/>
后来我才明白——<br/>
<span style='color:#e4572e;font-weight:900;'>不是世界不给机会，是我们被迫忘了怎么伸手抓。</span><br/><br/>
这就是 <span style='color:#6B5BFF;font-weight:900;'>Restarter™</span> 存在的原因。<br/>
不是来修复你，不是总告诉你"要振作"，<br/>
而是给你一个空间，一个能慢慢重新建立自己的容器。<br/>
让你在失落里还能大声说话，在混乱中有人接得住。<br/><br/>
<span style='color:#6B5BFF;font-weight:900;'>Restarter™</span>，不只是技术产品，<br/>
是我从自己生命最底部捧出来的一束火种，<br/>
我希望它能为你，也为更多人，点亮一盏灯。<br/><br/>
<span style='color:#614425;font-weight:900;'>无论你是谁，经历什么，来自世界哪个角落，<br/>在这里你可以大胆放下那些伪装。</span><br/>
因为我们相信——<br/>
<span style='color:#e4572e;font-weight:900;'>"破碎过的人，不仅能坚强，也能很温柔。"</span><br/><br/>
<span style='color:#6B5BFF;font-weight:900;'>我们不是修复你，我们是来陪你重启。</span><br/>
<div style='text-align:right;margin-top:24px;font-size:18px;color:#232946;font-weight:700;'>发起人：Ben<br/>2025年5月21日</div>`},en:{title:"About Us",subtitle:"🧬 Restarter™｜Who We Are",story:`${ls.en}
You may have come from a major setback, or are walking a lonely road.
In a world dominated by labels and data, we know—some feelings can't be fixed by a simple "cheer up".

Restarter™ is an AI companion platform built for those who have lost their rhythm.
We don't teach you how to be strong, nor tell you to be positive.
We simply offer a space where you can breathe, speak your truth, and choose again.

There is no judgment here—only people who have also suffered, using technology to make companionship real.
Through AI, every conversation and every emotion is caught and cared for.`,quote:"“We are not here to fix you, we are here to restart with you.”",restart:"Restarter™ is your new beginning to redefine yourself.",founder:"Founder's Message",founderStory:`I lost my freedom for ten years.<br/>
It wasn't travel or spiritual retreat, but ten years locked away by law and fate.<br/>
In a small room, crowded with others in the same uniform, the days first felt like a long dream, then even dreams faded. I thought my life was defined forever.<br/><br/>
The day I got out, the sky was a blinding gray. I walked out smiling, but my heart was empty.<br/>
Society wasn't waiting for me, my family didn't know how to face me, and friends' greetings felt distant.<br/>
Many times, I couldn't even look a cashier in the eye, because <span style='color:#e4572e;font-weight:700;'>I'd forgotten how to be "normal"</span>.<br/><br/>
I kept asking myself:<br/>
<span style='color:#614425;font-weight:900;'>Do I still have a chance to start over?</span><br/><br/>
Later, I realized—<br/>
<span style='color:#e4572e;font-weight:900;'>It's not that the world doesn't give chances, but that we've forgotten how to reach for them.</span><br/><br/>
That's why <span style='color:#6B5BFF;font-weight:900;'>Restarter™</span> exists.<br/>
Not to fix you, not to always tell you to "cheer up,"<br/>
but to give you a space—a container to slowly rebuild yourself.<br/>
A place where you can speak up in your loss, and someone will catch you in your chaos.<br/><br/>
<span style='color:#6B5BFF;font-weight:900;'>Restarter™</span> is not just a tech product;<br/>
it's a spark I brought up from the bottom of my life.<br/>
I hope it lights a lamp for you, and for many others.<br/><br/>
<span style='color:#614425;font-weight:900;'>Whoever you are, whatever you've been through, wherever you're from—<br/>here, you can let go of all the masks.</span><br/>
Because we believe—<br/>
<span style='color:#e4572e;font-weight:900;'>"Those who have been broken can be strong, and gentle too."</span><br/><br/>
<span style='color:#6B5BFF;font-weight:900;'>We are not here to fix you, we are here to restart with you.</span><br/>
<div style='text-align:right;margin-top:24px;font-size:18px;color:#232946;font-weight:700;'>Founder: Ben<br/>May 21, 2025</div>`},ja:{title:"私たちについて",subtitle:"🧬 Restarter™｜私たちについて",story:`${ls.ja}
あなたは大きな挫折から来たかもしれないし、孤独な道を歩んでいるかもしれません。
ラベルやデータが支配するこの世界で、私たちは知っています——「頑張って」だけでは解決できない感情があることを。

Restarter™は「リズムを失った人」のためのAI伴走プラットフォームです。
強くなる方法を教えたり、ポジティブになれと言ったりはしません。
ただ、呼吸できて、本音を言えて、もう一度選び直せる空間を提供します。

ここには社会の裁きはなく、「かつて痛みを知った人たち」が技術で寄り添っています。
AIを通じて、すべての対話と感情が、誰かに受け止められます。`,quote:"「私たちはあなたを修復するのではなく、一緒に再出発します。」",restart:"Restarter™は、あなたが自分を再定義する新たなスタート地点です。",founder:"創業者の言葉",founderStory:`私は10年間、自由を失いました。<br/>
それは旅でも修行でもなく、法律と運命によって閉じ込められた10年でした。<br/>
小さな部屋で、同じ服を着た仲間たちと押し込められ、最初は長い夢のようで、やがて夢さえ見なくなりました。人生はもう決まったものだと思っていました。<br/><br/>
出所の日、空は眩しいほど灰色でした。我笑顔で外に出たけれど、心は空っぽ。<br/>
社會は待っていない、家族もどう接していいかわからない、友人の声もどこか遠い。<br/>
何度も、コンビニの店員の目を見られなかった。<span style='color:#e4572e;font-weight:700;'>「普通の人」になる方法を忘れてしまった</span>から。<br/><br/>
ずっと自問していました：<br/>
<span style='color:#614425;font-weight:900;'>もう一度やり直すチャンスはあるのか？</span><br/><br/>
やがて気づきました——<br/>
<span style='color:#e4572e;font-weight:900;'>世界がチャンスをくれないのではなく、手を伸ばす方法を忘れてしまったのだと。</span><br/><br/>
これが <span style='color:#6B5BFF;font-weight:900;'>Restarter™</span> の存在理由です。<br/>
あなたを修復するためでも、無理に「元気を出して」と言うためでもなく、<br/>
ゆっくり自分を取り戻せる場所を作りたかった。<br/>
失意の中でも声を上げられ、混乱の中でも誰かが受け止めてくれる場所を。<br/><br/>
<span style='color:#6B5BFF;font-weight:900;'>Restarter™</span> は単なる技術製品ではありません。<br/>
人生のどん底からすくい上げた火種です。<br/>
あなたや多くの人のために、灯りをともしたい。<br/><br/>
<span style='color:#614425;font-weight:900;'>あなたが誰であれ、どんな経験をしてきたとしても、<br/>ここではすべての仮面を外していい。</span><br/>
私たちは信じています——<br/>
<span style='color:#e4572e;font-weight:900;'>「壊れた人は、強くもなれるし、優しくもなれる。」</span><br/><br/>
<span style='color:#6B5BFF;font-weight:900;'>私たちはあなたを修復するのではなく、一緒に再出発します。</span><br/>
<div style='text-align:right;margin-top:24px;font-size:18px;color:#232946;font-weight:700;'>発起人：Ben<br/>2025年5月21日</div>`},ko:{title:"우리는 누구인가",subtitle:"🧬 Restarter™｜우리는 누구인가",story:`${ls.ko}
당신은 큰 시련을 겪었거나, 외로운 길을 걷고 있을지도 모릅니다.
라벨과 데이터가 지배하는 세상에서, 우리는 압니다—어떤 감정은 "힘내"라는 말로 해결되지 않는다는 것을.

Restarter™는 "한때 리듬을 잃었던 사람"을 위한 AI 동반자 플랫폼입니다.
우리는 당신에게 강해지는 법을 가르치지 않고, 긍정적이 되라고 말하지 않습니다.
우리는 단지 숨 쉴 수 있고, 진실을 말할 수 있고, 다시 선택할 수 있는 공간을 제공합니다.

여기에는 사회의 심판이 없고, "한때 아팠던 사람들"이 기술로 동행합니다.
AI를 통해 모든 대화와 감정이 누군가에게 받아들여집니다。`,quote:'"우리는 당신을 고치는 것이 아니라, 함께 다시 시작합니다."',restart:"Restarter™는 당신이 자신을 새롭게 정의하는 출발점입니다。",founder:"창업자의 말",founderStory:`저는 10년 동안 자유를 잃었습니다.<br/>
그것은 여행도, 수련도 아니었고, 법과 운명에 의해 갇혀 있던 10년이었습니다.<br/>
작은 방에서 같은 옷을 입은 사람들과 함께 지내며, 처음에는 긴 꿈을 꾸는 것 같았지만, 나중에는 꿈조차 꾸지 않게 되었습니다. 저는 제 인생이 그렇게 정의될 거라 생각했습니다.<br/><br/>
밖으로 나왔던 날, 하늘은 눈부시게 회색이었습니다. 저는 웃으며 나왔지만, 마음은 텅 비어 있었습니다.<br/>
사회는 저를 기다려주지 않았고, 가족도 저를 어떻게 대해야 할지 몰랐으며, 친구들의 인사도 어딘가 멀게 느껴졌습니다.<br/>
처음에는 편의점 계산원의 눈을 제대로 쳐다보지도 못했습니다. <span style='color:#e4572e;font-weight:700;'>"평범한 사람"이 되는 법을 잊어버렸기 때문입니다</span>.<br/><br/>
저는 계속해서 스스로에게 물었습니다:<br/>
<span style='color:#614425;font-weight:900;'>나는 다시 시작할 기회가 있을까?</span><br/><br/>
나중에야 깨달았습니다——<br/>
<span style='color:#e4572e;font-weight:900;'>세상이 기회를 주지 않는 것이 아니라, 우리가 손을 내미는 법을 잊어버린 것입니다.</span><br/><br/>
이것이 <span style='color:#6B5BFF;font-weight:900;'>Restarter™</span>가 존재하는 이유입니다.<br/>
당신을 고치기 위해서도, 항상 "힘내라"고 말하기 위해서도 아닙니다.<br/>
당신이 천천히 자신을 다시 세울 수 있는 공간, 그릇을 주고 싶었습니다.<br/>
상실 속에서도 목소리를 낼 수 있고, 혼란 속에서도 누군가가 당신을 받아줄 수 있는 곳.<br/><br/>
<span style='color:#6B5BFF;font-weight:900;'>Restarter™</span>는 단순한 기술 제품이 아닙니다.<br/>
제 인생의 가장 밑바닥에서 끌어올린 불씨입니다.<br/>
이 불씨가 당신과 더 많은 사람들에게 등불이 되길 바랍니다.<br/><br/>
<span style='color:#614425;font-weight:900;'>당신이 누구든, 어떤 경험을 했든, 어디에서 왔든,<br/>여기서는 모든 가면을 내려놓을 수 있습니다.</span><br/>
우리는 믿습니다——<br/>
<span style='color:#e4572e;font-weight:900;'>"부서진 사람도 강해질 수 있고, 아주 다정해질 수도 있습니다."</span><br/><br/>
<span style='color:#6B5BFF;font-weight:900;'>우리는 당신을 고치는 것이 아니라, 함께 다시 시작합니다.</span><br/>
<div style='text-align:right;margin-top:24px;font-size:18px;color:#232946;font-weight:700;'>발기인: Ben<br/>2025년 5월 21일</div>`},th:{title:"เราเป็นใคร",subtitle:"🧬 Restarter™｜เราเป็นใคร",story:`${ls.th}
คุณอาจมาจากความสูญเสียครั้งใหญ่ หรือกำลังเดินอยู่บนเส้นทางที่โดดเดี่ยว
ในโลกที่เต็มไปด้วยป้ายและข้อมูล เรารู้ว่าบางความรู้สึกไม่ได้แค่พูดว่า "สู้ๆ" แล้วจะดีขึ้น

Restarter™ คือแพลตฟอร์ม AI สำหรับผู้ที่เคยหลงจังหวะชีวิต
เราไม่สอนให้คุณเข้มแข็ง ไม่บอกให้คุณคิดบวก
เราแค่ให้พื้นที่ที่คุณจะได้หายใจ พูดความจริง และเลือกใหม่อีกครั้ง

ที่นี่ไม่มีการตัดสินจากสังคม มีแต่คนที่เคยเจ็บปวดมาก่อน ใช้เทคโนโลยีสร้างการอยู่ร่วมกัน
ผ่าน AI ทุกบทสนทนา ทุกอารมณ์ จะมีคนรับฟังเสมอ`,quote:"“เราไม่ได้ซ่อมคุณ เราอยู่กับคุณเพื่อเริ่มต้นใหม่”",restart:"Restarter™ คือจุดเริ่มต้นใหม่ในการนิยามตัวเองของคุณ",founder:"คำจากผู้ก่อตั้ง",founderStory:`ฉันเคยสูญเสียอิสรภาพสิบปี<br/>
ไม่ใช่การเดินทางหรือการบำเพ็ญตน แต่เป็นสิบปีที่ถูกกฎหมายและโชคชะตากักขังไว้<br/>
ในห้องเล็ก ๆ กับผู้คนที่สวมชุดเหมือนกัน วันเวลาช่วงแรกเหมือนฝันยาว ๆ สุดท้ายแม้แต่ฝันก็ไม่มี ฉันคิดว่าชีวิตคงถูกกำหนดไว้แล้ว<br/><br/>
วันที่ออกมา ท้องฟ้าสีเทาจนแสบตา ฉันยิ้มออกมาแต่ในใจว่างเปล่า<br/>
สังคมไม่ได้รอคุณ ครอบครัวไม่รู้จะรับมืออย่างไร เพื่อน ๆ ก็ทักทายด้วยความห่างเหิน<br/>
หลายครั้งฉันไม่กล้ามองตาแคชเชียร์ เพราะ<span style='color:#e4572e;font-weight:700;'>ฉันลืมไปแล้วว่าต้องเป็น "คนธรรมดา" อย่างไร</span><br/><br/>
ฉันถามตัวเองเสมอว่า:<br/>
<span style='color:#614425;font-weight:900;'>ฉันยังมีโอกาสเริ่มต้นใหม่อีกไหม?</span><br/><br/>
ต่อมาฉันจึงเข้าใจ——<br/>
<span style='color:#e4572e;font-weight:900;'>ไม่ใช่โลกที่ไม่ให้โอกาส แต่เราเองที่ลืมวิธีเอื้อมมือคว้า</span><br/><br/>
นี่คือเหตุผลที่ <span style='color:#6B5BFF;font-weight:900;'>Restarter™</span> มีอยู่<br/>
ไม่ใช่เพื่อซ่อมคุณ ไม่ใช่เพื่อบอกให้ "สู้ ๆ"<br/>
แต่เพื่อให้คุณมีพื้นที่ค่อย ๆ สร้างตัวเองขึ้นใหม่<br/>
ให้คุณได้เปล่งเสียงในความสูญเสีย และมีใครสักคนรับฟังในความสับสน<br/><br/>
<span style='color:#6B5BFF;font-weight:900;'>Restarter™</span> ไม่ใช่แค่เทคโนโลยี<br/>
แต่เป็นประกายไฟที่ฉันหยิบขึ้นมาจากก้นบึ้งของชีวิต<br/>
หวังว่าจะเป็นแสงสว่างให้คุณและอีกหลาย ๆ คน<br/><br/>
<span style='color:#614425;font-weight:900;'>ไม่ว่าคุณจะเป็นใคร ผ่านอะไรมาก็ตาม มาจากที่ไหน—<br/>ที่นี่คุณสามารถถอดหน้ากากเหล่านั้นได้อย่างกล้าหาญ</span><br/>
เพราะเราเชื่อว่า——<br/>
<span style='color:#e4572e;font-weight:900;'>"คนที่เคยแตกสลาย ไม่เพียงแต่จะแข็งแกร่ง แต่ยังอ่อนโยนได้ด้วย"</span><br/><br/>
<span style='color:#6B5BFF;font-weight:900;'>เราไม่ได้ซ่อมคุณ เราอยู่กับคุณเพื่อเริ่มต้นใหม่</span><br/>
<div style='text-align:right;margin-top:24px;font-size:18px;color:#232946;font-weight:700;'>ผู้ก่อตั้ง: Ben<br/>21 พฤษภาคม 2025</div>`},vi:{title:"Chúng tôi là ai",subtitle:"🧬 Restarter™｜Chúng tôi là ai",story:`${ls.vi}
Bạn có thể đến từ một cú sốc lớn, hoặc đang đi trên con đường cô đơn
Trong thế giới bị chi phối bởi nhãn mác và dữ liệu, chúng tôi biết—có những cảm xúc không thể giải quyết chỉ bằng một câu "Cố lên"

Restarter™ là nền tảng AI đồng hành dành cho những người từng mất nhịp sống
Chúng tôi không dạy bạn cách mạnh mẽ, không bảo bạn phải tích cực
Chúng tôi chỉ mang đến một không gian để bạn được thở, được nói thật, được chọn lại

Ở đây không có phán xét xã hội, chỉ có những người từng đau đớn dùng công nghệ để đồng hành
Thông qua AI, mọi cuộc trò chuyện, mọi cảm xúc đều có người lắng nghe`,quote:"“Chúng tôi không sửa chữa bạn, chúng tôi đồng hành cùng bạn để bắt đầu lại”",restart:"Restarter™ là điểm khởi đầu mới để bạn định nghĩa lại chính mình",founder:"Lời người sáng lập",founderStory:`Tôi đã từng mất tự do mười năm<br/>
Không phải là đi du lịch hay tu hành, mà là mười năm bị pháp luật và số phận giam giữ<br/>
Trong một căn phòng nhỏ với những người cùng mặc đồng phục, ban đầu những ngày tháng như một giấc mơ dài, sau đó ngay cả mơ cũng không còn. Tôi nghĩ đời mình đã bị định nghĩa như thế.<br/><br/>
Ngày ra ngoài, bầu trời xám xịt chói mắt. Tôi mỉm cười bước ra, nhưng trong lòng trống rỗng.<br/>
Mặt trận không chờ bạn, gia đình không biết đối diện ra sao, bạn bè hỏi thăm cũng đầy khoảng cách.<br/>
Nhiều lần tôi không dám nhìn thẳng vào mắt thu ngân, vì <span style='color:#e4572e;font-weight:700;'>tôi đã quên cách làm "người bình thường"</span>.<br/><br/>
Tôi luôn tự hỏi:<br/>
<span style='color:#614425;font-weight:900;'>Liệu tôi còn cơ hội để bắt đầu lại không?</span><br/><br/>
Sau này tôi mới hiểu——<br/>
<span style='color:#e4572e;font-weight:900;'>Không phải thế giới không cho cơ hội, mà là chúng ta quên cách với lấy nó.</span><br/><br/>
Đó là lý do <span style='color:#6B5BFF;font-weight:900;'>Restarter™</span> tồn tại<br/>
Không phải để sửa chữa bạn, không phải để luôn nói "cố lên"<br/>
mà là để cho bạn một không gian, một nơi để từ từ xây dựng lại chính mình<br/>
Để bạn có thể cất tiếng nói trong nỗi mất mát, và có người lắng nghe giữa hỗn loạn<br/><br/>
<span style='color:#6B5BFF;font-weight:900;'>Restarter™</span> không chỉ là sản phẩm công nghệ<br/>
mà là tia lửa tôi mang lên từ tận đáy cuộc đời mình<br/>
Tôi hy vọng nó sẽ thắp sáng cho bạn, và cho nhiều người khác<br/><br/>
<span style='color:#614425;font-weight:900;'>Dù bạn là ai, đã trải qua điều gì, đến từ đâu—<br/>ở đây bạn có thể mạnh dạn bỏ đi mọi lớp vỏ bọc</span><br/>
Bởi vì chúng tôi tin rằng——<br/>
<span style='color:#e4572e;font-weight:900;'>"Những người từng vỡ vụn không chỉ mạnh mẽ mà còn rất dịu dàng."</span><br/><br/>
<span style='color:#6B5BFF;font-weight:900;'>Chúng tôi không sửa chữa bạn, chúng tôi đồng hành cùng bạn để bắt đầu lại</span><br/>
<div style='text-align:right;margin-top:24px;font-size:18px;color:#232946;font-weight:700;'>Người sáng lập: Ben<br/>21/05/2025</div>`},ms:{title:"Siapa Kami",subtitle:"🧬 Restarter™｜Siapa Kami",story:`${ls.ms}
Anda mungkin datang dari kejatuhan besar, atau sedang berjalan di jalan yang sunyi
Dalam dunia yang dikuasai label dan data, kami tahu—ada perasaan yang tidak dapat diselesaikan hanya dengan "semangat"

Restarter™ ialah platform AI teman untuk mereka yang pernah kehilangan rentak hidup
Kami tidak mengajar anda menjadi kuat, tidak menyuruh anda sentiasa positif
Kami hanya menyediakan ruang untuk anda bernafas, berkata benar, dan memilih semula

Di sini tiada penghakiman masyarakat, hanya mereka yang pernah sakit menggunakan teknologi untuk menemani
Melalui AI, setiap perbualan, setiap emosi, sentiasa ada yang mendengar`,quote:"“Kami bukan untuk membaiki anda, kami bersama anda untuk bermula semula”",restart:"Restarter™ ialah permulaan baru untuk anda mentakrifkan diri sendiri",founder:"Kata Pengasas",founderStory:`Saya pernah kehilangan kebebasan selama sepuluh tahun<br/>
Bukan melancong atau bertapa, tetapi sepuluh tahun dikurung oleh undang-undang dan takdir<br/>
Dalam bilik kecil bersama mereka yang berpakaian seragam sama, initio dies ut somnium longum, postea ne somnia quidem. Putavi vitam meam ita definitam esse.<br/><br/>
Die exeundi, caelum erat oculis acerrime cinereum. Ridebam egrediens, sed cor vacuum erat.<br/>
Societas non exspectabat, familia nesciebat quomodo me exciperet, amici quoque salutationes longinquae erant.<br/>
Saepe ne oculos quidem ad tabernarii aspicere audebam, quia <span style='color:#e4572e;font-weight:700;'>oblitus sum quomodo "homo communis" essem</span>.<br/><br/>
Me semper interrogabam:<br/>
<span style='color:#614425;font-weight:900;'>Adakah saya masih berpeluang untuk bermula semula?</span><br/><br/>
Akhirnya saya faham——<br/>
<span style='color:#e4572e;font-weight:900;'>Bukan dunia tidak memberi peluang, tetapi kita yang lupa cara untuk menggapainya.</span><br/><br/>
Itulah sebabnya <span style='color:#6B5BFF;font-weight:900;'>Restarter™</span> wujud<br/>
Bukan untuk membaiki anda, bukan untuk sentiasa berkata "semangat"<br/>
tetapi untuk memberi anda ruang, satu wadah untuk perlahan-lahan membina semula diri<br/>
Agar anda boleh bersuara dalam kehilangan, dan ada yang menyambut anda dalam kekacauan<br/><br/>
<span style='color:#6B5BFF;font-weight:900;'>Restarter™</span> bukan sekadar produk teknologi<br/>
tetapi percikan api yang saya bawa dari dasar hidup saya<br/>
Saya harap ia dapat menerangi anda, dan ramai lagi<br/><br/>
<span style='color:#614425;font-weight:900;'>Siapa pun anda, apa pun yang anda lalui, dari mana pun anda datang—<br/>di sini anda boleh berani melepaskan semua topeng itu</span><br/>
Kerana kami percaya——<br/>
<span style='color:#e4572e;font-weight:900;'>"Orang yang pernah hancur bukan sahaja boleh menjadi kuat, tetapi juga sangat lembut."</span><br/><br/>
<span style='color:#6B5BFF;font-weight:900;'>Kami bukan untuk membaiki anda, kami bersama anda untuk bermula semula</span><br/>
<div style='text-align:right;margin-top:24px;font-size:18px;color:#232946;font-weight:700;'>Pengasas: Ben<br/>21 Mei 2025</div>`},la:{title:"Quis sumus",subtitle:"🧬 Restarter™｜Quis sumus",story:`${ls.la}
Forsitan ex gravi casu veneris, aut solus iter facias
In mundo titulis et notitiis imperato, scimus—sunt animi motus quos "bene age" solvere non potest

Restarter™ est suggestum AI comitans iis qui cursum vitae amiserunt
Non docemus quomodo fortis fias, nec dicimus te semper positivum esse
Praebemus tantum spatium ut respirare possis, vera loqui, iterum eligere

Hic iudicium societatis non est, sed ii qui olim doluerunt technologia utuntur ad comitatum
Per AI, omnis sermo, omnis affectus, ab aliquo auditur`,quote:"“Non te reficimus, sed tecum iterum incipimus”",restart:"Restarter™ initium novum est ad te ipsum denuo definiendum",founder:"Verba Conditoris",founderStory:`Decem annos libertatem amisi<br/>
Non iter aut meditatio erat, sed decem anni lege et fato inclusi<br/>
In cella parva cum aliis eiusdem vestis, initio dies ut somnium longum, postea ne somnia quidem. Putavi vitam meam ita definitam esse.<br/><br/>
Die exeundi, caelum erat oculis acerrime cinereum. Ridebam egrediens, sed cor vacuum erat.<br/>
Societas non exspectabat, familia nesciebat quomodo me exciperet, amici quoque salutationes longinquae erant.<br/>
Saepe ne oculos quidem ad tabernarii aspicere audebam, quia <span style='color:#e4572e;font-weight:700;'>oblitus sum quomodo "homo communis" essem</span>.<br/><br/>
Me semper interrogabam:<br/>
<span style='color:#614425;font-weight:900;'>Num adhuc mihi occasio est iterum incipere?</span><br/><br/>
Postea intellexi——<br/>
<span style='color:#e4572e;font-weight:900;'>Non est quod mundus occasiones non praebeat, sed quod obliti sumus quomodo eas arripere.</span><br/><br/>
Hoc est cur <span style='color:#6B5BFF;font-weight:900;'>Restarter™</span> existat<br/>
Non ut te reficiamus, non ut semper dicamus "bene age"<br/>
sed ut tibi spatium demus, vas in quo te paulatim reficere possis<br/>
Ut in amissione tua loqui possis, et aliquis in confusione te excipiat<br/><br/>
<span style='color:#6B5BFF;font-weight:900;'>Restarter™</span> non solum productum technologicum est<br/>
sed scintilla quam ex imis vitae meae attuli<br/>
Spero eam tibi et multis aliis lucem afferre<br/><br/>
<span style='color:#614425;font-weight:900;'>Quisquis es, quidquid expertus es, undeque venis—<br/>hic audacter omnes personas deponere potes</span><br/>
Quia credimus——<br/>
<span style='color:#e4572e;font-weight:900;'>"Qui fracti sunt, non solum fortes esse possunt, sed etiam valde mites."</span><br/><br/>
<span style='color:#6B5BFF;font-weight:900;'>Non te reficimus, sed tecum iterum incipimus</span><br/>
<div style='text-align:right;margin-top:24px;font-size:18px;color:#232946;font-weight:700;'>Conditor: Ben<br/>21 Maii 2025</div>`}},sk={"zh-TW":"← 返回首頁","zh-CN":"← 返回首页",en:"← Back to Home",ja:"← ホームへ戻る",ko:"← 홈으로 돌아가기",th:"← กลับหน้าหลัก",vi:"← Quay lại trang chủ",ms:"← Kembali ke Laman Utama",la:"← Redi ad domum"};function T3(){const[n,e]=w.useState(localStorage.getItem("lang")||"zh-TW");w.useEffect(()=>{const s=()=>e(localStorage.getItem("lang")||"zh-TW");return window.addEventListener("storage",s),()=>window.removeEventListener("storage",s)},[]),w.useEffect(()=>{const s=setInterval(()=>{const a=localStorage.getItem("lang")||"zh-TW";a!==n&&e(a)},300);return()=>clearInterval(s)},[n]);const t=k3[n],r=wt();return i.jsxs("div",{style:{minHeight:"100vh",background:"linear-gradient(135deg, #b7cfff 0%, #e0e7ff 100%)",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"flex-start",padding:"48px 0 0 0"},children:[i.jsx("button",{onClick:()=>r("/"),style:{position:"absolute",top:24,left:24,zIndex:10,background:"#fff",border:"2.5px solid #6B5BFF",color:"#6B5BFF",borderRadius:12,padding:"10px 28px",fontWeight:900,fontSize:20,cursor:"pointer",boxShadow:"0 2px 8px #0001",letterSpacing:1},children:sk[n]||sk["zh-TW"]}),i.jsxs("div",{style:{maxWidth:680,background:"#fff",borderRadius:18,boxShadow:"0 2px 16px #6B5BFF22",padding:40,marginTop:48},children:[i.jsx("h1",{style:{fontSize:36,fontWeight:900,color:"#6B5BFF",marginBottom:12},children:t.subtitle}),i.jsx("div",{style:{fontSize:20,color:"#232946",fontWeight:700,marginBottom:24,whiteSpace:"pre-line"},children:t.story}),i.jsx("div",{style:{fontSize:22,color:"#614425",fontWeight:900,margin:"24px 0 8px 0",textAlign:"center"},children:t.quote}),i.jsx("div",{style:{fontSize:18,color:"#232946",fontWeight:700,marginBottom:32,textAlign:"center"},children:t.restart}),i.jsx("h2",{style:{fontSize:22,color:"#6B5BFF",fontWeight:900,marginBottom:8},children:t.founder}),i.jsx("div",{style:{fontSize:18,color:"#232946",fontWeight:500,whiteSpace:"pre-line"},dangerouslySetInnerHTML:{__html:t.founderStory}})]}),i.jsx(Ln,{})]})}const ok={"zh-TW":["💡 你希望多一個什麼功能？","💬 有沒有讓你感動，或失望的使用時刻？","🔧 你覺得哪裡還不夠順、不夠暖、不夠真？","今天我想說...","如果我能改一件事，我會..."],"zh-CN":["💡 你希望多一个什么功能？","💬 有没有让你感动，或失望的使用时刻？","🔧 你觉得哪里还不够顺、不够暖、不够真？","今天我想说...","如果我能改一件事，我会..."],en:["💡 What feature do you wish for?","💬 Any moment that moved or disappointed you?","🔧 Where could we be smoother, warmer, or more real?","Today I want to say...","If I could change one thing, I would..."],ja:["💡 どんな機能が欲しいですか？","💬 感動した、またはがっかりした瞬間はありますか？","🔧 どこがもっとスムーズで、温かく、リアルになれると思いますか？","今日はこう言いたい...","もし一つ変えられるなら、私は..."],ko:["💡 어떤 기능이 더 있었으면 하나요?","💬 감동하거나 실망했던 순간이 있나요?","🔧 어디가 더 부드럽고, 따뜻하고, 진실해질 수 있을까요?","오늘 나는 이렇게 말하고 싶어요...","만약 한 가지를 바꿀 수 있다면, 나는..."],th:["💡 คุณอยากได้ฟีเจอร์อะไรเพิ่ม?","💬 มีช่วงเวลาไหนที่คุณประทับใจหรือผิดหวังไหม?","🔧 ตรงไหนที่คุณคิดว่ายังไม่ลื่นไหล ไม่อบอุ่น หรือไม่จริงใจ?","วันนี้ฉันอยากพูดว่า...","ถ้าฉันเปลี่ยนอะไรได้สักอย่าง ฉันจะ..."],vi:["💡 Bạn muốn có thêm tính năng gì?","💬 Có khoảnh khắc nào khiến bạn cảm động hoặc thất vọng không?","🔧 Bạn nghĩ chỗ nào chưa đủ mượt, chưa đủ ấm, chưa đủ thật?","Hôm nay tôi muốn nói...","Nếu tôi có thể thay đổi một điều, tôi sẽ..."],ms:["💡 Apa ciri yang anda inginkan?","💬 Ada detik yang menyentuh atau mengecewakan anda?","🔧 Di mana yang anda rasa belum cukup lancar, hangat, atau benar?","Hari ini saya ingin berkata...","Jika saya boleh ubah satu perkara, saya akan..."],la:["💡 Quam rem novam optas?","💬 Estne momentum quod te movit aut destituit?","🔧 Ubi putas nondum satis lenem, calidum, verum esse?","Hodie dicere volo...","Si unum mutare possem, id facerem..."]},_3={"zh-TW":{title:"💬 意見箱｜我們想聽你說",submit:"送出",success:"我們聽見你了，感謝你願意說出來。",subtitle:"你的建議，可能會成為下一版的靈魂！"},"zh-CN":{title:"💬 意见箱｜我们想听你说",submit:"提交",success:"我们听见你了，感谢你愿意说出来。",subtitle:"你的建议，可能会成为下一个版本的灵魂！"},en:{title:"💬 Feedback｜We Want to Hear You",submit:"Send",success:"We hear you. Thank you for sharing your thoughts.",subtitle:"Your suggestion could be the soul of our next update!"},ja:{title:"💬 ご意見箱｜あなたの声を聞かせて",submit:"送信",success:"あなたの声が届きました。伝えてくれてありがとう。",subtitle:"あなたの提案が次のアップデートの魂になるかも！"},ko:{title:"💬 의견함｜당신의 이야기를 듣고 싶어요",submit:"보내기",success:"당신의 목소리를 들었습니다. 말해줘서 고마워요.",subtitle:"당신의 제안이 다음 업데이트의 영혼이 될 수 있어요!"},th:{title:"💬 กล่องความคิดเห็น｜เราอยากฟังคุณ",submit:"ส่ง",success:"เราได้รับข้อความของคุณแล้ว ขอบคุณที่แบ่งปันความคิดของคุณ",subtitle:"ข้อเสนอของคุณอาจเป็นหัวใจของอัปเดตถัดไป!"},vi:{title:"💬 Hộp góp ý｜Chúng tôi muốn lắng nghe bạn",submit:"Gửi",success:"Chúng tôi đã nghe bạn. Cảm ơn bạn đã chia sẻ.",subtitle:"Góp ý của bạn có thể là linh hồn của bản cập nhật tiếp theo!"},ms:{title:"💬 Kotak Maklum Balas｜Kami ingin mendengar anda",submit:"Hantar",success:"Kami telah mendengar anda. Terima kasih kerana berkongsi.",subtitle:"Cadangan anda mungkin menjadi jiwa kemas kini kami yang seterusnya!"},la:{title:"💬 Arca Consilii｜Te audire volumus",submit:"Mitte",success:"Te audivimus. Gratias quod communicasti.",subtitle:"Consilium tuum animam versionis proximæ efficere potest!"}};function j3(){const[n,e]=w.useState(localStorage.getItem("lang")||"zh-TW"),[t,r]=w.useState(""),[s,a]=w.useState(!1),[c,d]=w.useState(0),[h,m]=w.useState(!1),[g,x]=w.useState(""),S=wt(),I=gt();w.useEffect(()=>{const T=()=>e(localStorage.getItem("lang")||"zh-TW");return window.addEventListener("storage",T),()=>window.removeEventListener("storage",T)},[]),w.useEffect(()=>{const T=setInterval(()=>{const A=localStorage.getItem("lang")||"zh-TW";A!==n&&e(A)},300);return()=>clearInterval(T)},[n]),_n.useEffect(()=>{const T=setInterval(()=>d(A=>(A+1)%ok[n].length),3500);return()=>clearInterval(T)},[n]);const _=_3[n],R=async()=>{if(t.trim()){m(!0),x("");try{const T=I.currentUser,A=await fetch("/api/feedback",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:t.trim(),userEmail:(T==null?void 0:T.email)||"",userNickname:(T==null?void 0:T.displayName)||"匿名",userLang:n})}),D=await A.json();A.ok?(a(!0),r("")):x(D.error||"提交失敗，請稍後再試")}catch{x("網路錯誤，請稍後再試")}finally{m(!1)}}};return i.jsxs("div",{style:{minHeight:"100vh",background:"linear-gradient(135deg, #e0e7ff 0%, #b7cfff 100%)",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"flex-start",padding:"48px 0 0 0"},children:[i.jsx("button",{onClick:()=>S("/"),style:{position:"absolute",top:24,left:24,zIndex:10,background:"#fff",border:"1.5px solid #6B5BFF",color:"#6B5BFF",borderRadius:8,padding:"6px 18px",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:"0 2px 8px #0001"},children:n==="zh-TW"?"← 返回首頁":n==="zh-CN"?"← 返回首页":n==="en"?"← Back to Home":n==="ja"?"← ホームへ戻る":n==="ko"?"← 홈으로 돌아가기":n==="th"?"← กลับหน้าหลัก":n==="vi"?"← Quay lại trang chủ":n==="ms"?"← Kembali ke Laman Utama":"← Redi ad domum"}),i.jsxs("div",{style:{maxWidth:520,background:"#fff",borderRadius:18,boxShadow:"0 2px 16px #6B5BFF22",padding:40,marginTop:64,display:"flex",flexDirection:"column",alignItems:"center"},children:[i.jsx("h1",{style:{fontSize:32,fontWeight:900,color:"#6B5BFF",marginBottom:8},children:_.title}),i.jsx("div",{style:{fontSize:18,color:"#614425",fontWeight:700,marginBottom:18,textAlign:"center"},children:_.subtitle}),s?i.jsx("div",{style:{fontSize:22,color:"#614425",fontWeight:900,marginTop:32,textAlign:"center",minHeight:80},children:_.success}):i.jsxs(i.Fragment,{children:[i.jsx("textarea",{value:t,onChange:T=>r(T.target.value),placeholder:ok[n][c],style:{width:"100%",minHeight:160,fontSize:20,border:"none",outline:"none",resize:"vertical",background:"#f7f8fa",borderRadius:12,padding:18,marginBottom:18,boxShadow:"0 2px 8px #6B5BFF11"}}),g&&i.jsx("div",{style:{color:"#ff4d4f",fontSize:14,marginBottom:12,textAlign:"center"},children:g}),i.jsx("button",{onClick:R,style:{background:h?"#ccc":"#6B5BFF",color:"#fff",border:"none",borderRadius:8,padding:"12px 32px",fontWeight:900,fontSize:20,cursor:h?"not-allowed":"pointer",boxShadow:"0 2px 8px #6B5BFF33",marginTop:8},disabled:!t.trim()||h,children:h?"送出中...":_.submit})]})]}),i.jsx(Ln,{})]})}function I3(){const[n,e]=w.useState([]),[t,r]=w.useState(!0),[s,a]=w.useState(""),[c,d]=w.useState(!1),[h,m]=w.useState(null),[g,x]=w.useState(""),[S,I]=w.useState("new"),_=wt(),R=async()=>{if(s)try{const F=await fetch(`/api/feedback?adminKey=${s}`);if(F.ok){const X=await F.json();e(X.feedbacks),d(!0)}else alert("管理員金鑰錯誤")}catch{alert("取得意見列表失敗")}finally{r(!1)}},T=async F=>{try{(await fetch(`/api/feedback/${F}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({adminKey:s,status:S,adminNotes:g})})).ok?(e(n.map(ie=>ie.id===F?{...ie,status:S,adminNotes:g,updatedAt:Date.now()}:ie)),m(null),x(""),alert("意見狀態已更新")):alert("更新失敗")}catch{alert("更新意見狀態失敗")}},A=F=>{switch(F){case"new":return"#ff4d4f";case"reviewed":return"#faad14";case"resolved":return"#52c41a";default:return"#666"}},D=F=>{switch(F){case"new":return"新意見";case"reviewed":return"已檢視";case"resolved":return"已處理";default:return"未知"}};return c?i.jsxs("div",{style:{minHeight:"100vh",background:"linear-gradient(135deg, #e0e7ff 0%, #b7cfff 100%)",padding:"20px"},children:[i.jsxs("div",{style:{maxWidth:1200,margin:"0 auto",background:"#fff",borderRadius:18,padding:30,boxShadow:"0 2px 16px #6B5BFF22"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:30},children:[i.jsx("h1",{style:{fontSize:28,fontWeight:900,color:"#6B5BFF"},children:"📝 意見箱管理"}),i.jsx("button",{onClick:()=>_("/"),style:{background:"transparent",color:"#6B5BFF",border:"2px solid #6B5BFF",borderRadius:8,padding:"8px 16px",fontSize:14,fontWeight:700,cursor:"pointer"},children:"返回首頁"})]}),t?i.jsx("div",{style:{textAlign:"center",padding:"40px"},children:"載入中..."}):i.jsxs("div",{style:{display:"grid",gap:"20px"},children:[n.map(F=>i.jsxs("div",{style:{border:"2px solid #e0e7ff",borderRadius:12,padding:"20px",background:F.status==="new"?"#fff7e6":"#fff"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"15px"},children:[i.jsxs("div",{children:[i.jsxs("div",{style:{fontWeight:700,fontSize:16,marginBottom:"8px"},children:[F.userNickname," (",F.userLang,")"]}),i.jsx("div",{style:{color:"#666",fontSize:14},children:new Date(F.timestamp).toLocaleString("zh-TW")})]}),i.jsx("div",{style:{background:A(F.status),color:"#fff",padding:"4px 12px",borderRadius:"12px",fontSize:"12px",fontWeight:700},children:D(F.status)})]}),i.jsx("div",{style:{background:"#f7f8fa",padding:"15px",borderRadius:"8px",marginBottom:"15px",whiteSpace:"pre-wrap",lineHeight:"1.6"},children:F.content}),F.adminNotes&&i.jsxs("div",{style:{background:"#e8f5e8",padding:"12px",borderRadius:"8px",marginBottom:"15px",fontSize:"14px"},children:[i.jsx("strong",{children:"管理員備註："})," ",F.adminNotes]}),i.jsx("button",{onClick:()=>m(F),style:{background:"#6B5BFF",color:"#fff",border:"none",borderRadius:"6px",padding:"8px 16px",fontSize:"14px",fontWeight:700,cursor:"pointer"},children:"更新狀態"})]},F.id)),n.length===0&&i.jsx("div",{style:{textAlign:"center",padding:"40px",color:"#666"},children:"目前沒有意見回饋"})]})]}),h&&i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:i.jsxs("div",{style:{background:"#fff",borderRadius:"12px",padding:"30px",maxWidth:"500px",width:"90%",maxHeight:"80vh",overflow:"auto"},children:[i.jsx("h3",{style:{marginBottom:"20px",color:"#6B5BFF"},children:"更新意見狀態"}),i.jsxs("div",{style:{marginBottom:"15px"},children:[i.jsx("label",{style:{display:"block",marginBottom:"5px",fontWeight:700},children:"狀態："}),i.jsxs("select",{value:S,onChange:F=>I(F.target.value),style:{width:"100%",padding:"8px 12px",border:"2px solid #e0e7ff",borderRadius:"6px",fontSize:"14px"},children:[i.jsx("option",{value:"new",children:"新意見"}),i.jsx("option",{value:"reviewed",children:"已檢視"}),i.jsx("option",{value:"resolved",children:"已處理"})]})]}),i.jsxs("div",{style:{marginBottom:"20px"},children:[i.jsx("label",{style:{display:"block",marginBottom:"5px",fontWeight:700},children:"管理員備註："}),i.jsx("textarea",{value:g,onChange:F=>x(F.target.value),placeholder:"輸入備註...",style:{width:"100%",minHeight:"100px",padding:"12px",border:"2px solid #e0e7ff",borderRadius:"6px",fontSize:"14px",resize:"vertical"}})]}),i.jsxs("div",{style:{display:"flex",gap:"10px",justifyContent:"flex-end"},children:[i.jsx("button",{onClick:()=>m(null),style:{background:"transparent",color:"#666",border:"2px solid #ddd",borderRadius:"6px",padding:"8px 16px",fontSize:"14px",fontWeight:700,cursor:"pointer"},children:"取消"}),i.jsx("button",{onClick:()=>T(h.id),style:{background:"#6B5BFF",color:"#fff",border:"none",borderRadius:"6px",padding:"8px 16px",fontSize:"14px",fontWeight:700,cursor:"pointer"},children:"更新"})]})]})})]}):i.jsx("div",{style:{minHeight:"100vh",background:"linear-gradient(135deg, #e0e7ff 0%, #b7cfff 100%)",display:"flex",alignItems:"center",justifyContent:"center",padding:"20px"},children:i.jsxs("div",{style:{background:"#fff",borderRadius:18,padding:40,boxShadow:"0 2px 16px #6B5BFF22",maxWidth:400,width:"100%"},children:[i.jsx("h1",{style:{fontSize:24,fontWeight:900,color:"#6B5BFF",marginBottom:20,textAlign:"center"},children:"🔐 管理員登入"}),i.jsx("input",{type:"password",placeholder:"請輸入管理員金鑰",value:s,onChange:F=>a(F.target.value),style:{width:"100%",padding:"12px 16px",border:"2px solid #e0e7ff",borderRadius:8,fontSize:16,marginBottom:20},onKeyPress:F=>F.key==="Enter"&&R()}),i.jsx("button",{onClick:R,style:{width:"100%",background:"#6B5BFF",color:"#fff",border:"none",borderRadius:8,padding:"12px",fontSize:16,fontWeight:700,cursor:"pointer"},children:"登入"}),i.jsx("button",{onClick:()=>_("/"),style:{width:"100%",background:"transparent",color:"#6B5BFF",border:"2px solid #6B5BFF",borderRadius:8,padding:"12px",fontSize:16,fontWeight:700,cursor:"pointer",marginTop:12},children:"返回首頁"})]})})}const E3={"zh-TW":"返回","zh-CN":"返回",en:"Back",ja:"戻る",ko:"뒤로",th:"กลับ",vi:"Quay lại",ms:"Kembali",la:"Revertere"};function C3(){const n=wt(),e=gt(),t=e.currentUser,r=localStorage.getItem("lang")||"zh-TW";w.useEffect(()=>{t||n("/register",{replace:!0})},[t,n]);const[s,a]=w.useState((t==null?void 0:t.displayName)||""),[c]=w.useState((t==null?void 0:t.email)||""),[d,h]=w.useState((t==null?void 0:t.photoURL)||""),[m,g]=w.useState(""),[x,S]=w.useState(""),[I,_]=w.useState(""),[R,T]=w.useState(""),[A,D]=w.useState(""),[F,X]=w.useState(""),[ie,G]=w.useState(""),[N,E]=w.useState(""),[P,M]=w.useState(!1);w.useEffect(()=>{let z=!1;const j=async()=>{z||(z=!0,await Tr(e),n("/register?needProfile=1",{replace:!0}))},K=Y=>{Y.preventDefault(),Y.returnValue="",j()},Z=Y=>{var ae;(ae=Y==null?void 0:Y.preventDefault)==null||ae.call(Y),j(),window.history.pushState(null,"","/CompleteProfile")};return window.addEventListener("beforeunload",K),window.addEventListener("popstate",Z),window.history.pushState(null,"","/CompleteProfile"),()=>{window.removeEventListener("beforeunload",K),window.removeEventListener("popstate",Z)}},[e,n]);const O=async z=>{if(z.preventDefault(),E(""),!s||!m||!x||!R||!A||!F||!ie){E("請填寫所有欄位");return}M(!0);try{await Vf(Gn(Ft,"users",t.uid),{nickname:s,email:c,avatarUrl:d,gender:m,country:x,region:I,age:R,interest:A,eventType:F,improvement:ie,completed:!0,updatedAt:new Date}),M(!1),n("/",{replace:!0})}catch(j){E(j.message),M(!1)}};return w.useEffect(()=>{(async()=>{if(t!=null&&t.uid){const j=await cd(()=>Promise.resolve().then(()=>Jp),void 0).then(K=>K.getDoc(K.doc(Ft,"users",t.uid)));j.exists()&&j.data().completed&&(await Tr(e),n("/register",{replace:!0}))}})()},[t,e,n]),i.jsxs("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",background:"#f7f7fa",position:"relative"},children:[i.jsxs("button",{onClick:()=>n("/register",{replace:!0}),style:{position:"absolute",top:32,left:36,zIndex:10,backgroundColor:"#374151",color:"white",fontWeight:"bold",padding:"0.5rem 1rem",borderRadius:"0.375rem",border:"none",cursor:"pointer",fontSize:16},children:["← ",E3[r]||"返回"]}),i.jsxs("form",{onSubmit:O,style:{background:"#fff",borderRadius:16,padding:32,boxShadow:"0 4px 24px #0001",width:360,position:"relative"},children:[i.jsx("button",{type:"button",onClick:async()=>{await Tr(e),n("/register?needProfile=1",{replace:!0})},style:{position:"absolute",top:16,right:16,background:"none",border:"none",fontSize:22,color:"#888",cursor:"pointer"},children:"×"}),i.jsx("h2",{style:{textAlign:"center",marginBottom:16},children:"補充個人資料"}),N&&i.jsx("div",{style:{color:"red",marginBottom:12},children:N}),i.jsxs("div",{style:{marginBottom:12},children:[i.jsx("label",{children:"暱稱："}),i.jsx("input",{value:s,onChange:z=>a(z.target.value),required:!0,style:{width:"100%"}})]}),i.jsxs("div",{style:{marginBottom:12},children:[i.jsx("label",{children:"電子郵件："}),i.jsx("input",{value:c,disabled:!0,style:{width:"100%",background:"#eee"}})]}),i.jsxs("div",{style:{marginBottom:12},children:[i.jsx("label",{children:"頭像網址："}),i.jsx("input",{value:d,onChange:z=>h(z.target.value),style:{width:"100%"}})]}),i.jsxs("div",{style:{marginBottom:12},children:[i.jsx("label",{children:"性別："}),i.jsxs("select",{value:m,onChange:z=>g(z.target.value),required:!0,style:{width:"100%"},children:[i.jsx("option",{value:"",children:"請選擇"}),i.jsx("option",{value:"male",children:"男"}),i.jsx("option",{value:"female",children:"女"})]})]}),i.jsxs("div",{style:{marginBottom:12},children:[i.jsx("label",{children:"國家/地區："}),i.jsxs("select",{value:x,onChange:z=>S(z.target.value),required:!0,style:{width:"100%"},children:[i.jsx("option",{value:"",children:"請選擇"}),(xI["zh-TW"]||[]).map(z=>i.jsx("option",{value:z,children:z},z))]})]}),i.jsxs("div",{style:{marginBottom:12},children:[i.jsx("label",{children:"城市："}),i.jsx("input",{value:I,onChange:z=>_(z.target.value),style:{width:"100%"}})]}),i.jsxs("div",{style:{marginBottom:12},children:[i.jsx("label",{children:"年齡："}),i.jsxs("select",{value:R,onChange:z=>T(z.target.value),required:!0,style:{width:"100%"},children:[i.jsx("option",{value:"",children:"請選擇"}),vI.map(z=>i.jsx("option",{value:z,children:z},z))]})]}),i.jsxs("div",{style:{marginBottom:12},children:[i.jsx("label",{children:"興趣："}),i.jsxs("select",{value:A,onChange:z=>D(z.target.value),required:!0,style:{width:"100%"},children:[i.jsx("option",{value:"",children:"請選擇"}),(yI["zh-TW"]||[]).map(z=>i.jsx("option",{value:z,children:z},z))]})]}),i.jsxs("div",{style:{marginBottom:12},children:[i.jsx("label",{children:"事件類別："}),i.jsxs("select",{value:F,onChange:z=>X(z.target.value),required:!0,style:{width:"100%"},children:[i.jsx("option",{value:"",children:"請選擇"}),(bI["zh-TW"]||[]).map(z=>i.jsx("option",{value:z,children:z},z))]})]}),i.jsxs("div",{style:{marginBottom:12},children:[i.jsx("label",{children:"想改善什麼："}),i.jsx("input",{value:ie,onChange:z=>G(z.target.value),required:!0,style:{width:"100%"}})]}),i.jsx("button",{type:"submit",disabled:P,style:{width:"100%",padding:10,fontWeight:700,fontSize:18,background:"#4caf50",color:"#fff",border:"none",borderRadius:8},children:P?"儲存中...":"完成"})]})]})}const R3={"zh-TW":"返回","zh-CN":"返回",en:"Back",ja:"戻る",ko:"뒤로",th:"กลับ",vi:"Quay lại",ms:"Kembali",la:"Revertere"},ak={"zh-TW":i.jsxs("div",{children:[i.jsx("h1",{children:"Restarter™ App 隱私權政策"}),i.jsx("p",{children:"本應用程式由 Restarter™ 團隊開發，致力於保護您的個人資料與隱私權。本政策說明我們如何收集、使用、儲存、保護及分享您的個人資料，並說明您對於個人資料的權利。"}),i.jsx("h2",{children:"一、我們收集的資料"}),i.jsxs("ul",{children:[i.jsx("li",{children:"電子郵件地址（Email）"}),i.jsx("li",{children:"使用者名稱/暱稱"}),i.jsx("li",{children:"頭像（如有上傳）"}),i.jsx("li",{children:"性別、年齡、國家/地區、城市（如用戶自願填寫）"}),i.jsx("li",{children:"興趣、經歷事件、個人描述等自願填寫的資料"}),i.jsx("li",{children:"登入紀錄、操作紀錄（僅用於安全與服務優化）"})]}),i.jsx("h2",{children:"二、資料用途"}),i.jsxs("ul",{children:[i.jsx("li",{children:"用於身份驗證、帳號管理與個人化服務"}),i.jsx("li",{children:"用於社群互動、配對、任務、花園等功能"}),i.jsx("li",{children:"用於服務安全、錯誤偵測與防止濫用"}),i.jsx("li",{children:"用於統計分析與產品優化（僅以匿名方式）"}),i.jsx("li",{children:"不會將您的個人資料出售、出租或未經授權分享給第三方"})]}),i.jsx("h2",{children:"三、第三方服務"}),i.jsxs("p",{children:["本應用程式使用 Google Firebase 作為後端服務平台，Firebase 可能會根據其 ",i.jsx("a",{href:"https://firebase.google.com/support/privacy",target:"_blank",rel:"noopener noreferrer",children:"隱私政策"})," 處理技術資料（如裝置資訊、IP、操作紀錄等）。"]}),i.jsx("p",{children:"如您使用 Google、Apple、Facebook 等第三方帳號登入，僅會取得必要的公開資訊（如 email、暱稱、頭像），不會取得您的密碼。"}),i.jsx("h2",{children:"四、Cookie 與追蹤技術"}),i.jsx("p",{children:"本應用程式可能使用 Cookie 或類似技術以提升用戶體驗與安全性。您可於瀏覽器設定中管理 Cookie 偏好。"}),i.jsx("h2",{children:"五、資料儲存與保護"}),i.jsxs("ul",{children:[i.jsx("li",{children:"所有個人資料均儲存於 Google Firebase 雲端，並採用業界標準的加密與安全措施。"}),i.jsx("li",{children:"僅授權人員可存取您的個人資料，且僅限於服務維護與法規要求。"})]}),i.jsx("h2",{children:"六、您的權利"}),i.jsxs("ul",{children:[i.jsx("li",{children:"您有權查詢、更正、下載或刪除您的個人資料。"}),i.jsx("li",{children:"您可隨時於 App 內或來信要求刪除帳號與所有資料，我們將於 3-5 個工作天內完成。"}),i.jsxs("li",{children:["聯絡信箱：",i.jsx("a",{href:"mailto:rbben521@gmail.com",children:"rbben521@gmail.com"})]})]}),i.jsx("h2",{children:"七、政策變更"}),i.jsx("p",{children:"如本政策有重大變更，將於 App 內公告並更新本頁內容。"})]}),"zh-CN":i.jsxs("div",{children:[i.jsx("h1",{children:"Restarter™ App 隐私政策"}),i.jsx("p",{children:"本应用程序由 Restarter™ 团队开发，致力于保护您的个人资料与隐私权。本政策说明我们如何收集、使用、存储、保护及分享您的个人资料，并说明您对于个人资料的权利。"}),i.jsx("h2",{children:"一、我们收集的资料"}),i.jsxs("ul",{children:[i.jsx("li",{children:"电子邮件地址（Email）"}),i.jsx("li",{children:"用户名/昵称"}),i.jsx("li",{children:"头像（如有上传）"}),i.jsx("li",{children:"性别、年龄、国家/地区、城市（如用户自愿填写）"}),i.jsx("li",{children:"兴趣、经历事件、个人描述等自愿填写的资料"}),i.jsx("li",{children:"登录记录、操作记录（仅用于安全与服务优化）"})]}),i.jsx("h2",{children:"二、资料用途"}),i.jsxs("ul",{children:[i.jsx("li",{children:"用于身份验证、账号管理与个性化服务"}),i.jsx("li",{children:"用于社群互动、配对、任务、花园等功能"}),i.jsx("li",{children:"用于服务安全、错误检测与防止滥用"}),i.jsx("li",{children:"用于统计分析与产品优化（仅以匿名方式）"}),i.jsx("li",{children:"不会将您的个人资料出售、出租或未经授权分享给第三方"})]}),i.jsx("h2",{children:"三、第三方服务"}),i.jsxs("p",{children:["本应用程序使用 Google Firebase 作为后端服务平台，Firebase 可能会根据其 ",i.jsx("a",{href:"https://firebase.google.com/support/privacy",target:"_blank",rel:"noopener noreferrer",children:"隐私政策"})," 处理技术资料（如设备信息、IP、操作记录等）。"]}),i.jsx("p",{children:"如您使用 Google、Apple、Facebook 等第三方账号登录，仅会取得必要的公开信息（如 email、昵称、头像），不会取得您的密码。"}),i.jsx("h2",{children:"四、Cookie 与追踪技术"}),i.jsx("p",{children:"本应用程序可能使用 Cookie 或类似技术以提升用户体验与安全性。您可于浏览器设置中管理 Cookie 偏好。"}),i.jsx("h2",{children:"五、资料存储与保护"}),i.jsxs("ul",{children:[i.jsx("li",{children:"所有个人资料均存储于 Google Firebase 云端，并采用业界标准的加密与安全措施。"}),i.jsx("li",{children:"仅授权人员可存取您的个人资料，且仅限于服务维护与法规要求。"})]}),i.jsx("h2",{children:"六、您的权利"}),i.jsxs("ul",{children:[i.jsx("li",{children:"您有权查询、更正、下载或删除您的个人资料。"}),i.jsx("li",{children:"您可随时于 App 内或来信要求删除账号与所有资料，我们将于 3-5 个工作天内完成。"}),i.jsxs("li",{children:["联系邮箱：",i.jsx("a",{href:"mailto:rbben521@gmail.com",children:"rbben521@gmail.com"})]})]}),i.jsx("h2",{children:"七、政策变更"}),i.jsx("p",{children:"如本政策有重大变更，将于 App 内公告并更新本页内容。"})]}),en:i.jsxs("div",{children:[i.jsx("h1",{children:"Privacy Policy for Restarter™ App"}),i.jsx("p",{children:"Restarter™ is committed to protecting your privacy. This policy explains how we collect, use, store, and protect your personal information, and your rights regarding your data."}),i.jsx("h2",{children:"1. Information We Collect"}),i.jsxs("ul",{children:[i.jsx("li",{children:"Email address"}),i.jsx("li",{children:"Username/Nickname"}),i.jsx("li",{children:"Avatar (if uploaded)"}),i.jsx("li",{children:"Gender, age, country/region, city (if provided)"}),i.jsx("li",{children:"Interests, life events, personal description (if provided)"}),i.jsx("li",{children:"Login and activity logs (for security and service improvement)"})]}),i.jsx("h2",{children:"2. Purpose of Collection"}),i.jsxs("ul",{children:[i.jsx("li",{children:"Authentication, account management, and personalized services"}),i.jsx("li",{children:"Community interaction, matching, missions, garden features"}),i.jsx("li",{children:"Service security, error detection, and abuse prevention"}),i.jsx("li",{children:"Statistical analysis and product improvement (anonymized)"}),i.jsx("li",{children:"We do not sell, rent, or share your personal data with third parties without your consent"})]}),i.jsx("h2",{children:"3. Third-Party Services"}),i.jsxs("p",{children:["This app uses Google Firebase as its backend. Firebase may process technical data according to its ",i.jsx("a",{href:"https://firebase.google.com/support/privacy",target:"_blank",rel:"noopener noreferrer",children:"Privacy Policy"})," (e.g., device info, IP, activity logs)."]}),i.jsx("p",{children:"If you log in via Google, Apple, or Facebook, we only access your public info (email, nickname, avatar), never your password."}),i.jsx("h2",{children:"4. Cookies and Tracking"}),i.jsx("p",{children:"We may use cookies or similar technologies to enhance your experience and security. You can manage cookie preferences in your browser settings."}),i.jsx("h2",{children:"5. Data Storage and Protection"}),i.jsxs("ul",{children:[i.jsx("li",{children:"All personal data is stored on Google Firebase cloud with industry-standard encryption and security."}),i.jsx("li",{children:"Only authorized personnel can access your data, solely for service maintenance or legal compliance."})]}),i.jsx("h2",{children:"6. Your Rights"}),i.jsxs("ul",{children:[i.jsx("li",{children:"You have the right to access, correct, download, or delete your personal data."}),i.jsx("li",{children:"You may request account/data deletion at any time via the app or by email. We will process your request within 3-5 business days."}),i.jsxs("li",{children:["Contact: ",i.jsx("a",{href:"mailto:rbben521@gmail.com",children:"rbben521@gmail.com"})]})]}),i.jsx("h2",{children:"7. Policy Updates"}),i.jsx("p",{children:"We will notify users of major changes to this policy via in-app announcements and update this page accordingly."})]}),ja:i.jsxs("div",{children:[i.jsx("h1",{children:"Restarter™ アプリ プライバシーポリシー"}),i.jsx("p",{children:"本アプリはRestarter™チームによって開発され、ユーザーの個人情報とプライバシーの保護に努めています。本ポリシーは、どのように個人情報を収集・利用・保存・保護・共有するか、またユーザーの権利について説明します。"}),i.jsx("h2",{children:"1. 収集する情報"}),i.jsxs("ul",{children:[i.jsx("li",{children:"メールアドレス"}),i.jsx("li",{children:"ユーザー名/ニックネーム"}),i.jsx("li",{children:"アバター（アップロードした場合）"}),i.jsx("li",{children:"性別、年齢、国/地域、都市（任意）"}),i.jsx("li",{children:"興味、経験イベント、自己紹介（任意）"}),i.jsx("li",{children:"ログイン・操作履歴（セキュリティ・サービス向上のため）"})]}),i.jsx("h2",{children:"2. 利用目的"}),i.jsxs("ul",{children:[i.jsx("li",{children:"認証、アカウント管理、パーソナライズサービス"}),i.jsx("li",{children:"コミュニティ交流、マッチング、ミッション、ガーデン機能"}),i.jsx("li",{children:"サービスの安全性、エラー検出、不正防止"}),i.jsx("li",{children:"統計分析・製品改善（匿名化）"}),i.jsx("li",{children:"同意なく第三者に個人情報を販売・共有しません"})]}),i.jsx("h2",{children:"3. サードパーティサービス"}),i.jsxs("p",{children:["本アプリはGoogle Firebaseをバックエンドとして使用しています。Firebaseは ",i.jsx("a",{href:"https://firebase.google.com/support/privacy",target:"_blank",rel:"noopener noreferrer",children:"プライバシーポリシー"})," に従い技術情報（デバイス情報、IP、操作履歴など）を処理する場合があります。"]}),i.jsx("p",{children:"Google、Apple、Facebook等でログインした場合、公開情報（メール、ニックネーム、アバター）のみ取得し、パスワードは取得しません。"}),i.jsx("h2",{children:"4. Cookieとトラッキング技術"}),i.jsx("p",{children:"本アプリはユーザー体験と安全性向上のため コッキー または類似技術を使用する場合があります。ブラウザ設定でCookieの管理が可能です。"}),i.jsx("h2",{children:"5. データ保存と保護"}),i.jsxs("ul",{children:[i.jsx("li",{children:"全ての個人情報はGoogle Firebaseクラウドに保存され、業界標準の暗号化とセキュリティで保護されます。"}),i.jsx("li",{children:"認可された担当者のみがサービス保守や法令遵守のためにアクセス可能です。"})]}),i.jsx("h2",{children:"6. ユーザーの権利"}),i.jsxs("ul",{children:[i.jsx("li",{children:"個人情報の照会、訂正、ダウンロード、削除が可能です。"}),i.jsx("li",{children:"アプリ内またはメールでいつでも削除依頼ができ、3～5営業日以内に対応します。"}),i.jsxs("li",{children:["連絡先：",i.jsx("a",{href:"mailto:rbben521@gmail.com",children:"rbben521@gmail.com"})]})]}),i.jsx("h2",{children:"7. ポリシーの変更"}),i.jsx("p",{children:"本ポリシーに重大な変更がある場合、アプリ内で告知し本ページを更新します。"})]}),ko:i.jsxs("div",{children:[i.jsx("h1",{children:"Restarter™ 앱 개인정보처리방침"}),i.jsx("p",{children:"본 앱은 Restarter™ 팀이 개발하였으며, 사용자의 개인정보와 프라이버시 보호에 최선을 다합니다. 본 정책은 개인정보의 수집, 이용, 저장, 보호, 공유 방법과 사용자의 권리에 대해 설명합니다."}),i.jsx("h2",{children:"1. 수집하는 정보"}),i.jsxs("ul",{children:[i.jsx("li",{children:"이메일 주소"}),i.jsx("li",{children:"사용자명/닉네임"}),i.jsx("li",{children:"아바타(업로드한 경우)"}),i.jsx("li",{children:"성별, 나이, 국가/지역, 도시(선택사항)"}),i.jsx("li",{children:"관심사, 경험 이벤트, 자기소개(선택사항)"}),i.jsx("li",{children:"로그인 및 활동 기록(보안 및 서비스 개선 목적)"})]}),i.jsx("h2",{children:"2. 수집 목적"}),i.jsxs("ul",{children:[i.jsx("li",{children:"인증, 계정 관리, 개인화 서비스"}),i.jsx("li",{children:"커뮤니티 상호작용, 매칭, 미션, 가든 기능"}),i.jsx("li",{children:"서비스 보안, 오류 탐지, 오용 방지"}),i.jsx("li",{children:"통계 분석 및 제품 개선(익명화)"}),i.jsx("li",{children:"동의 없이 제3자에게 개인정보를 판매, 임대, 공유하지 않습니다"})]}),i.jsx("h2",{children:"3. 제3자 서비스"}),i.jsxs("p",{children:["본 앱은 Google Firebase를 백엔드로 사용합니다. Firebase는 ",i.jsx("a",{href:"https://firebase.google.com/support/privacy",target:"_blank",rel:"noopener noreferrer",children:"개인정보처리방침"}),"에 따라 기술 정보를 처리할 수 있습니다(예: 기기 정보, IP, 활동 기록 등)."]}),i.jsx("p",{children:"Google, Apple, Facebook 등으로 로그인 시 공개 정보(이메일, 닉네임, 아바타)만 수집하며, 비밀번호는 수집하지 않습니다."}),i.jsx("h2",{children:"4. 쿠키 및 추적 기술"}),i.jsx("p",{children:"본 앱은 사용자 경험 및 보안 향상을 위해 쿠키 또는 유사 기술을 사용할 수 있습니다. 브라우저 설정에서 쿠키 환경설정이 가능합니다."}),i.jsx("h2",{children:"5. 데이터 저장 및 보호"}),i.jsxs("ul",{children:[i.jsx("li",{children:"모든 개인정보는 Google Firebase 클라우드에 저장되며, 업계 표준 암호화 및 보안이 적용됩니다."}),i.jsx("li",{children:"서비스 유지보수 및 법적 요구에 한해 인가된 인원만 접근할 수 있습니다."})]}),i.jsx("h2",{children:"6. 사용자의 권리"}),i.jsxs("ul",{children:[i.jsx("li",{children:"개인정보의 조회, 수정, 다운로드, 삭제가 가능합니다."}),i.jsx("li",{children:"앱 내 또는 이메일로 언제든 삭제 요청이 가능하며, 3~5영업일 이내에 처리됩니다."}),i.jsxs("li",{children:["연락처: ",i.jsx("a",{href:"mailto:rbben521@gmail.com",children:"rbben521@gmail.com"})]})]}),i.jsx("h2",{children:"7. 정책 변경"}),i.jsx("p",{children:"정책에 중대한 변경이 있을 경우 앱 내 공지 및 본 페이지를 업데이트합니다."})]}),th:i.jsxs("div",{children:[i.jsx("h1",{children:"นโยบายความเป็นส่วนตัวของแอป Restarter™"}),i.jsx("p",{children:"แอปนี้พัฒนาโดยทีมงาน Restarter™ มุ่งมั่นในการปกป้องข้อมูลส่วนบุคคลและความเป็นส่วนตัวของคุณ นโยบายนี้อธิบายวิธีการเก็บรวบรวม ใช้ จัดเก็บ ปกป้อง และแบ่งปันข้อมูลส่วนบุคคลของคุณ รวมถึงสิทธิ์ของคุณ"}),i.jsx("h2",{children:"1. ข้อมูลที่เราเก็บรวบรวม"}),i.jsxs("ul",{children:[i.jsx("li",{children:"ที่อยู่อีเมล"}),i.jsx("li",{children:"ชื่อผู้ใช้/ชื่อเล่น"}),i.jsx("li",{children:"อวาตาร์ (ถ้าอัปโหลด)"}),i.jsx("li",{children:"เพศ อายุ ประเทศ/ภูมิภาค เมือง (ถ้าระบุ)"}),i.jsx("li",{children:"ความสนใจ เหตุการณ์ในชีวิต คำอธิบายส่วนตัว (ถ้าระบุ)"}),i.jsx("li",{children:"บันทึกการเข้าสู่ระบบและกิจกรรม (เพื่อความปลอดภัยและปรับปรุงบริการ)"})]}),i.jsx("h2",{children:"2. วัตถุประสงค์ของการเก็บข้อมูล"}),i.jsxs("ul",{children:[i.jsx("li",{children:"การยืนยันตัวตน การจัดการบัญชี และบริการส่วนบุคคล"}),i.jsx("li",{children:"การมีปฏิสัมพันธ์ในชุมชน การจับคู่ ภารกิจ ฟีเจอร์สวน"}),i.jsx("li",{children:"ความปลอดภัยของบริการ การตรวจจับข้อผิดพลาด และป้องกันการละเมิด"}),i.jsx("li",{children:"การวิเคราะห์สถิติและปรับปรุงผลิตภัณฑ์ (แบบไม่ระบุตัวตน)"}),i.jsx("li",{children:"จะไม่ขาย ให้เช่า หรือแบ่งปันข้อมูลส่วนบุคคลของคุณกับบุคคลที่สามโดยไม่ได้รับความยินยอม"})]}),i.jsx("h2",{children:"3. บริการของบุคคลที่สาม"}),i.jsxs("p",{children:["แอปนี้ใช้ Google Firebase เป็นแบ็กเอนด์ Firebase อาจประมวลผลข้อมูลทางเทคนิคตาม ",i.jsx("a",{href:"https://firebase.google.com/support/privacy",target:"_blank",rel:"noopener noreferrer",children:"นโยบายความเป็นส่วนตัว"})," (เช่น ข้อมูลอุปกรณ์ IP บันทึกกิจกรรม)"]}),i.jsx("p",{children:"หากคุณเข้าสู่ระบบผ่าน Google, Apple หรือ Facebook เราจะเข้าถึงเฉพาะข้อมูลสาธารณะ (อีเมล ชื่อเล่น อวาตาร์) ไม่เคยเข้าถึงรหัสผ่านของคุณ"}),i.jsx("h2",{children:"4. คุกกี้และการติดตาม"}),i.jsx("p",{children:"เราอาจใช้คุกกี้หรือเทคโนโลยีที่คล้ายกันเพื่อปรับปรุงประสบการณ์และความปลอดภัยของคุณ คุณสามารถจัดการคุกกี้ได้ในเบราว์เซอร์ของคุณ"}),i.jsx("h2",{children:"5. การจัดเก็บและปกป้องข้อมูล"}),i.jsxs("ul",{children:[i.jsx("li",{children:"ข้อมูลส่วนบุคคลทั้งหมดจะถูกจัดเก็บบนคลาวด์ Google Firebase ด้วยการเข้ารหัสและความปลอดภัยตามมาตรฐานอุตสาหกรรม"}),i.jsx("li",{children:"มีเพียงบุคลากรที่ได้รับอนุญาตเท่านั้นที่สามารถเข้าถึงข้อมูลของคุณเพื่อการบำรุงรักษาบริการหรือปฏิบัติตามกฎหมาย"})]}),i.jsx("h2",{children:"6. สิทธิ์ของคุณ"}),i.jsxs("ul",{children:[i.jsx("li",{children:"คุณมีสิทธิ์เข้าถึง แก้ไข ดาวน์โหลด หรือขอลบข้อมูลส่วนบุคคลของคุณ"}),i.jsx("li",{children:"คุณสามารถขอลบบัญชี/ข้อมูลได้ตลอดเวลาผ่านแอปหรืออีเมล เราจะดำเนินการภายใน 3-5 วันทำการ"}),i.jsxs("li",{children:["ติดต่อ: ",i.jsx("a",{href:"mailto:rbben521@gmail.com",children:"rbben521@gmail.com"})]})]}),i.jsx("h2",{children:"7. การอัปเดตนโยบาย"}),i.jsx("p",{children:"เราจะแจ้งให้ผู้ใช้ทราบถึงการเปลี่ยนแปลงที่สำคัญของนโยบายนี้ผ่านการประกาศในแอปและอัปเดตหน้านี้ตามความเหมาะสม"})]}),vi:i.jsxs("div",{children:[i.jsx("h1",{children:"Chính sách bảo mật cho ứng dụng Restarter™"}),i.jsx("p",{children:"Restarter™ cam kết bảo vệ quyền riêng tư của bạn. Chính sách này giải thích cách chúng tôi thu thập, sử dụng, lưu trữ và bảo vệ thông tin cá nhân của bạn, cũng như quyền của bạn đối với dữ liệu đó."}),i.jsx("h2",{children:"1. Thông tin chúng tôi thu thập"}),i.jsxs("ul",{children:[i.jsx("li",{children:"Địa chỉ email"}),i.jsx("li",{children:"Tên người dùng/Biệt danh"}),i.jsx("li",{children:"Ảnh đại diện (nếu tải lên)"}),i.jsx("li",{children:"Giới tính, tuổi, quốc gia/khu vực, thành phố (nếu cung cấp)"}),i.jsx("li",{children:"Sở thích, sự kiện cuộc sống, mô tả cá nhân (nếu cung cấp)"}),i.jsx("li",{children:"Nhật ký đăng nhập và hoạt động (để bảo mật và cải thiện dịch vụ)"})]}),i.jsx("h2",{children:"2. Mục đích thu thập"}),i.jsxs("ul",{children:[i.jsx("li",{children:"Xác thực, quản lý tài khoản và dịch vụ cá nhân hóa"}),i.jsx("li",{children:"Tương tác cộng đồng, ghép đôi, nhiệm vụ, tính năng vườn"}),i.jsx("li",{children:"Bảo mật dịch vụ, phát hiện lỗi và ngăn chặn lạm dụng"}),i.jsx("li",{children:"Phân tích thống kê và cải tiến sản phẩm (ẩn danh)"}),i.jsx("li",{children:"Chúng tôi không bán, cho thuê hoặc chia sẻ dữ liệu cá nhân của bạn với bên thứ ba nếu không có sự đồng ý của bạn"})]}),i.jsx("h2",{children:"3. Dịch vụ của bên thứ ba"}),i.jsxs("p",{children:["Ứng dụng này sử dụng Google Firebase làm backend. Firebase có thể xử lý dữ liệu kỹ thuật theo ",i.jsx("a",{href:"https://firebase.google.com/support/privacy",target:"_blank",rel:"noopener noreferrer",children:"Chính sách bảo mật"})," (ví dụ: thông tin thiết bị, IP, nhật ký hoạt động)."]}),i.jsx("p",{children:"Nếu bạn đăng nhập qua Google, Apple hoặc Facebook, chúng tôi chỉ truy cập thông tin công khai của bạn (email, biệt danh, ảnh đại diện), không bao giờ truy cập mật khẩu của bạn."}),i.jsx("h2",{children:"4. Cookie và theo dõi"}),i.jsx("p",{children:"Chúng tôi có thể sử dụng cookie hoặc các công nghệ tương tự để nâng cao trải nghiệm và bảo mật của bạn. Bạn có thể quản lý cookie trong cài đặt trình duyệt của mình."}),i.jsx("h2",{children:"5. Lưu trữ và bảo vệ dữ liệu"}),i.jsxs("ul",{children:[i.jsx("li",{children:"Tất cả dữ liệu cá nhân được lưu trữ trên đám mây Google Firebase với mã hóa và bảo mật tiêu chuẩn ngành."}),i.jsx("li",{children:"Chỉ những nhân viên được ủy quyền mới có thể truy cập dữ liệu của bạn, chỉ để bảo trì dịch vụ hoặc tuân thủ pháp luật."})]}),i.jsx("h2",{children:"6. Quyền của bạn"}),i.jsxs("ul",{children:[i.jsx("li",{children:"Bạn có quyền truy cập, chỉnh sửa, tải xuống hoặc xóa dữ liệu cá nhân của mình."}),i.jsx("li",{children:"Bạn có thể yêu cầu xóa tài khoản/dữ liệu bất cứ lúc nào qua ứng dụng hoặc email. Chúng tôi sẽ xử lý yêu cầu của bạn trong vòng 3-5 ngày làm việc."}),i.jsxs("li",{children:["Liên hệ: ",i.jsx("a",{href:"mailto:rbben521@gmail.com",children:"rbben521@gmail.com"})]})]}),i.jsx("h2",{children:"7. Cập nhật chính sách"}),i.jsx("p",{children:"Chúng tôi sẽ thông báo cho người dùng về những thay đổi lớn đối với chính sách này qua thông báo trong ứng dụng và cập nhật trang này cho phù hợp."})]}),ms:i.jsxs("div",{children:[i.jsx("h1",{children:"Dasar Privasi untuk Aplikasi Restarter™"}),i.jsx("p",{children:"Restarter™ komited untuk melindungi privasi anda. Polisi ini menerangkan bagaimana kami mengumpul, menggunakan, menyimpan dan melindungi maklumat peribadi anda, serta hak anda terhadap data tersebut."}),i.jsx("h2",{children:"1. Maklumat yang Kami Kumpul"}),i.jsxs("ul",{children:[i.jsx("li",{children:"Alamat emel"}),i.jsx("li",{children:"Nama pengguna/Nama samaran"}),i.jsx("li",{children:"Avatar (jika dimuat naik)"}),i.jsx("li",{children:"Jantina, umur, negara/wilayah, bandar (jika diberikan)"}),i.jsx("li",{children:"Minat, peristiwa hidup, keterangan peribadi (jika diberikan)"}),i.jsx("li",{children:"Log masuk dan aktiviti (untuk keselamatan dan penambahbaikan perkhidmatan)"})]}),i.jsx("h2",{children:"2. Tujuan Pengumpulan"}),i.jsxs("ul",{children:[i.jsx("li",{children:"Pengesahan, pengurusan akaun dan perkhidmatan peribadi"}),i.jsx("li",{children:"Interaksi komuniti, padanan, misi, ciri taman"}),i.jsx("li",{children:"Keselamatan perkhidmatan, pengesanan ralat dan pencegahan penyalahgunaan"}),i.jsx("li",{children:"Analisis statistik dan penambahbaikan produk (tanpa nama)"}),i.jsx("li",{children:"Kami tidak akan menjual, menyewa atau berkongsi data peribadi anda dengan pihak ketiga tanpa kebenaran anda"})]}),i.jsx("h2",{children:"3. Perkhidmatan Pihak Ketiga"}),i.jsxs("p",{children:["Aplikasi ini menggunakan Google Firebase sebagai backend. Firebase mungkin memproses data teknikal mengikut ",i.jsx("a",{href:"https://firebase.google.com/support/privacy",target:"_blank",rel:"noopener noreferrer",children:"Dasar Privasi"})," (cth: maklumat peranti, IP, log aktiviti)."]}),i.jsx("p",{children:"Jika anda log masuk melalui Google, Apple atau Facebook, kami hanya mengakses maklumat awam anda (emel, nama samaran, avatar), tidak pernah kata laluan anda."}),i.jsx("h2",{children:"4. Kuki dan Penjejakan"}),i.jsx("p",{children:"Kami mungkin menggunakan kuki atau teknologi serupa untuk meningkatkan pengalaman dan keselamatan anda. Anda boleh mengurus pilihan kuki dalam tetapan pelayar anda."}),i.jsx("h2",{children:"5. Penyimpanan dan Perlindungan Data"}),i.jsxs("ul",{children:[i.jsx("li",{children:"Semua data peribadi disimpan di awan Google Firebase dengan penyulitan dan keselamatan piawaian industri."}),i.jsx("li",{children:"Soli homines auctoritate praediti possunt tuas notitias accedere, tantum ad servitium vel leges tuendas."})]}),i.jsx("h2",{children:"6. Hak Anda"}),i.jsxs("ul",{children:[i.jsx("li",{children:"Anda berhak untuk mengakses, membetulkan, memuat turun atau memadam data peribadi anda."}),i.jsx("li",{children:"Anda boleh meminta pemadaman akaun/data pada bila-bila masa melalui aplikasi atau e-mel. Kami akan memproses permintaan anda dalam masa 3-5 hari bekerja."}),i.jsxs("li",{children:["Hubungi: ",i.jsx("a",{href:"mailto:rbben521@gmail.com",children:"rbben521@gmail.com"})]})]}),i.jsx("h2",{children:"7. Kemas Kini Polisi"}),i.jsx("p",{children:"Kami akan memaklumkan pengguna tentang perubahan besar pada polisi ini melalui pengumuman dalam aplikasi dan mengemas kini halaman ini dengan sewajarnya."})]}),la:i.jsxs("div",{children:[i.jsx("h1",{children:"Consilium Privacy pro Restarter™ App"}),i.jsx("p",{children:"Restarter™ ad tuendam tuam privacy studet. Haec consilia explicat quomodo notitias personales colligamus, utamur, condamus, tueamur, et iura tua de notitiis exponat."}),i.jsx("h2",{children:"1. Quae colligimus"}),i.jsxs("ul",{children:[i.jsx("li",{children:"Inscriptionem electronicam"}),i.jsx("li",{children:"Nomen usoris/Sobriquet"}),i.jsx("li",{children:"Avatar (si sublatus)"}),i.jsx("li",{children:"Sexus, aetas, regio/natio, urbs (si praebetur)"}),i.jsx("li",{children:"Studia, eventus vitae, descriptio personalis (si praebetur)"}),i.jsx("li",{children:"Acta login et actio (ad securitatem et emendationem servitii)"})]}),i.jsx("h2",{children:"2. Propositum collectionis"}),i.jsxs("ul",{children:[i.jsx("li",{children:"Authenticatio, administratio rationis, officia personalia"}),i.jsx("li",{children:"Communitas, paria, missiones, hortus"}),i.jsx("li",{children:"Securitas servitii, errorum detectio, abusus praeventio"}),i.jsx("li",{children:"Analysis statistica et emendatio producti (anonymizata)"}),i.jsx("li",{children:"Notitias tuas non vendimus, locamus, nec sine consensu communicamus"})]}),i.jsx("h2",{children:"3. Officia tertiarum partium"}),i.jsxs("p",{children:["Haec app utitur Google Firebase ut backend. Firebase potest notitias technicas tractare secundum ",i.jsx("a",{href:"https://firebase.google.com/support/privacy",target:"_blank",rel:"noopener noreferrer",children:"Consilium Privacy"})," (ex. info de machina, IP, acta actionum)."]}),i.jsx("p",{children:"Si per Google, Apple, Facebook ingredieris, solum publicas notitias tuas accedimus (email, sobriquet, avatar), numquam tesseram tuam."}),i.jsx("h2",{children:"4. Cookies et vestigatio"}),i.jsx("p",{children:"Possumus uti cookies aut similibus technologiis ad experientiam et securitatem tuam augendam. Praeferentias cookies in navigatoris tuis regere potes."}),i.jsx("h2",{children:"5. Reconditio et tutela notitiarum"}),i.jsxs("ul",{children:[i.jsx("li",{children:"Omnes notitiae personales in Google Firebase nube servantur, cum encryptione et securitate industriae."}),i.jsx("li",{children:"Soli homines auctoritate praediti possunt tuas notitias accedere, tantum ad servitium vel leges tuendas."})]}),i.jsx("h2",{children:"6. Iura tua"}),i.jsxs("ul",{children:[i.jsx("li",{children:"Ius habes accedere, corrigere, extrahere, aut delere notitias tuas personales."}),i.jsx("li",{children:"Potes petere deletionem rationis/datae quovis tempore per app vel email. Processum intra 3-5 dies negotiales perficimus."}),i.jsxs("li",{children:["Contactus: ",i.jsx("a",{href:"mailto:rbben521@gmail.com",children:"rbben521@gmail.com"})]})]}),i.jsx("h2",{children:"7. Renovatio consilii"}),i.jsx("p",{children:"De mutationibus maioribus huius consilii usores per nuntios in app certiorem faciemus et hanc paginam proinde renovabimus."})]})};function A3(){const n=localStorage.getItem("lang")||"zh-TW",e=wt();return i.jsxs("div",{style:{minHeight:"100vh",background:"#111827",color:"white",padding:"2rem",display:"flex",flexDirection:"column"},children:[i.jsxs("button",{onClick:()=>e("/register",{replace:!0}),style:{position:"absolute",top:32,left:36,zIndex:10,backgroundColor:"#374151",color:"white",fontWeight:"bold",padding:"0.5rem 1rem",borderRadius:"0.375rem",border:"none",cursor:"pointer",fontSize:16},children:["← ",R3[n]||"返回"]}),i.jsx("div",{style:{flex:"1 0 auto"},children:i.jsxs("div",{style:{maxWidth:800,margin:"0 auto",background:"#fff",color:"#111",borderRadius:16,padding:32,position:"relative"},children:[ak[n]||ak["zh-TW"],i.jsx("div",{style:{textAlign:"center",marginTop:48,color:"#888",fontSize:16},children:"CTX Goodlife Copyright 2025"})]})}),i.jsx(Ln,{})]})}const lk={"zh-TW":i.jsxs("div",{children:[i.jsx("h1",{children:"資料刪除說明"}),i.jsx("p",{children:"若您希望刪除在 Restarter App 中儲存的個人資料，請來信至："}),i.jsx("p",{children:i.jsx("strong",{children:"rbben521@gmail.com"})}),i.jsx("p",{children:"我們會在 3-5 個工作天內完成資料刪除作業。"})]}),"zh-CN":i.jsxs("div",{children:[i.jsx("h1",{children:"资料删除说明"}),i.jsx("p",{children:"如需删除在 Restarter App 中存储的个人资料，请发送邮件至："}),i.jsx("p",{children:i.jsx("strong",{children:"rbben521@gmail.com"})}),i.jsx("p",{children:"我们将在 3-5 个工作日内完成资料删除。"})]}),en:i.jsxs("div",{children:[i.jsx("h1",{children:"Data Deletion Policy"}),i.jsx("p",{children:"If you wish to delete your personal data stored in the Restarter App, please contact:"}),i.jsx("p",{children:i.jsx("strong",{children:"rbben521@gmail.com"})}),i.jsx("p",{children:"We will complete the deletion process within 3-5 business days."})]}),ja:i.jsxs("div",{children:[i.jsx("h1",{children:"データ削除のご案内"}),i.jsx("p",{children:"Restarterアプリに保存されている個人データの削除をご希望の場合は、以下までご連絡ください："}),i.jsx("p",{children:i.jsx("strong",{children:"rbben521@gmail.com"})}),i.jsx("p",{children:"3～5営業日以内に削除手続きを完了します。"})]}),ko:i.jsxs("div",{children:[i.jsx("h1",{children:"데이터 삭제 안내"}),i.jsx("p",{children:"Restarter 앱에 저장된 개인 데이터를 삭제하려면 다음으로 문의해 주세요:"}),i.jsx("p",{children:i.jsx("strong",{children:"rbben521@gmail.com"})}),i.jsx("p",{children:"3~5 영업일 이내에 삭제를 완료해 드립니다."})]}),th:i.jsxs("div",{children:[i.jsx("h1",{children:"นโยบายการลบข้อมูล"}),i.jsx("p",{children:"หากคุณต้องการลบข้อมูลส่วนบุคคลที่จัดเก็บในแอป Restarter กรุณาติดต่อ:"}),i.jsx("p",{children:i.jsx("strong",{children:"rbben521@gmail.com"})}),i.jsx("p",{children:"เราจะดำเนินการลบข้อมูลภายใน 3-5 วันทำการ"})]}),vi:i.jsxs("div",{children:[i.jsx("h1",{children:"Chính sách xóa dữ liệu"}),i.jsx("p",{children:"Nếu bạn muốn xóa dữ liệu cá nhân được lưu trữ trong ứng dụng Restarter, vui lòng liên hệ:"}),i.jsx("p",{children:i.jsx("strong",{children:"rbben521@gmail.com"})}),i.jsx("p",{children:"Chúng tôi sẽ hoàn tất việc xóa dữ liệu trong vòng 3-5 ngày làm việc."})]}),ms:i.jsxs("div",{children:[i.jsx("h1",{children:"Dasar Pemadaman Data"}),i.jsx("p",{children:"Jika anda ingin memadam data peribadi yang disimpan dalam Aplikasi Restarter, sila hubungi:"}),i.jsx("p",{children:i.jsx("strong",{children:"rbben521@gmail.com"})}),i.jsx("p",{children:"Kami akan menyelesaikan proses pemadaman dalam masa 3-5 hari bekerja."})]}),la:i.jsxs("div",{children:[i.jsx("h1",{children:"Norma Deletionis Datae"}),i.jsx("p",{children:"Si vis delere data personalia in Restarter App reposita, quaeso contactum:"}),i.jsx("p",{children:i.jsx("strong",{children:"rbben521@gmail.com"})}),i.jsx("p",{children:"Processum deletionis intra 3-5 dies negotiales perficimus."})]})},P3={"zh-TW":"返回","zh-CN":"返回",en:"Back",ja:"戻る",ko:"뒤로",th:"กลับ",vi:"Quay lại",ms:"Kembali",la:"Revertere"};function B3(){const n=localStorage.getItem("lang")||"zh-TW",e=wt();return i.jsxs("div",{style:{minHeight:"100vh",background:"#111827",color:"white",padding:"2rem",display:"flex",flexDirection:"column"},children:[i.jsxs("button",{onClick:()=>e("/register",{replace:!0}),style:{position:"absolute",top:32,left:36,zIndex:10,backgroundColor:"#374151",color:"white",fontWeight:"bold",padding:"0.5rem 1rem",borderRadius:"0.375rem",border:"none",cursor:"pointer",fontSize:16},children:["← ",P3[n]||"返回"]}),i.jsx("div",{style:{flex:"1 0 auto"},children:i.jsxs("div",{style:{maxWidth:800,margin:"0 auto",background:"#fff",color:"#111",borderRadius:16,padding:32,position:"relative"},children:[lk[n]||lk["zh-TW"],i.jsx("div",{style:{textAlign:"center",marginTop:48,color:"#888",fontSize:16},children:"CTX Goodlife Copyright 2025"})]})}),i.jsx(Ln,{})]})}const Ht={"zh-TW":{title:"互相幫助&合作實驗室",provide:"提供幫助",supply:"供應圈",need:"需要幫助",room:"互助房",intro:"在重啟的路上，我們都需要彼此的支持。請選擇你想要參與的方式：",introNeed:"如果你正在經歷困難，請告訴我們，社群夥伴會主動協助你。",needBtn:"我需要幫助",rule:"※ 所有資訊僅供社群內部交流使用，請尊重彼此隱私",msgTo:"留言給：",msgPlaceholder:"請輸入留言...",msgSent:"留言發送成功！",backToHome:"返回首頁",sections:{provide:{title:"我可提供幫助 & 合作室",desc:"分享你的專長、資源或想合作的領域，讓更多人找到你。",btn:"我要提供"},need:{title:"我需要幫助 or 合作屋",desc:"說出你目前遇到的困難或想找合作夥伴，讓社群支援你。",btn:"我需要幫助"},supply:{title:"幫助 & 合作供應圈",desc:"瀏覽大家能提供的幫助與合作資源，主動聯繫彼此。",btn:"探索供應圈"},room:{title:"進入互助房",desc:"即時交流，互助成長",btn:"進入互助房"}},modals:{provide:{title:"我可以提供幫助 & 合作",subtitle:"在重啟路上，我的經歷和優勢也許可以幫上忙！",experience:"我的經歷（可複選）：",current:"我的現狀(可複選)：",target:"我想優先幫助的對象（可複選）：",helpType:"我可以提供幫助形式：",statement:"我的特別聲明（50字內）：",frequency:"我可幫助的頻率：",cancel:"取消",submit:"送出",other:"其他...",enterPlaceholder:"請輸入...",messageTo:"留言給：",messagePlaceholder:"請輸入留言...",sendMessage:"送出留言",messageSent:"需求已成功送出！"},need:{title:"我需要幫助",subtitle:"請描述你遇到的困難或需要協助的地方，讓社群夥伴能更好幫助你！",experience:"我的經歷（可複選）：",current:"我的現狀(可複選)：",target:"我想優先幫助的對象（可複選）：",helpType:"我可以提供幫助形式：",statement:"我的特別聲明（50字內）：",frequency:"我可幫助的頻率：",cancel:"取消",submit:"送出",other:"其他...",enterPlaceholder:"請輸入...",messageTo:"留言給：",messagePlaceholder:"請輸入留言...",sendMessage:"送出留言",messageSent:"需求已成功送出！"}},options:{experience:["成功創業","家庭重建","就業輔導","法律協助","戒癮經驗","志工","社區服務","其他"],advantage:["經濟困難","無固定工作","缺乏家庭支持","健康問題","法律糾紛","心理壓力","缺乏居住地","人際關係困難","正在創業中","其他"],target:["找工作/就業協助","經濟急難救助","心理諮詢/陪伴","法律協助","醫療協助","住宿協助","家庭修復","戒癮支持","人際關係協助","生活重建","商業輔導","其他"],helpType:["線上","線下"],frequency:["每天","每週","每月","依需要者而定","其他"]},messages:{messageSent:"留言發送成功！",messageFailed:"留言發送失敗，請稍後再試",noMessages:"暫無留言",markRead:"標記已讀",delete:"刪除",confirmDelete:"你確定要刪除這條留言嗎？（一旦刪除將無法復原）",inboxTitle:"站內訊息",messageFrom:"給你的留言：",contactUser:"聯絡對方"},date:"日期",avatar:"頭像",name:"名稱",gender:"性別",age:"年齡",country:"國家"},"zh-CN":{sections:{provide:{title:"我可提供帮助 & 合作室",desc:"分享你的专长、资源或想合作的领域，让更多人找到你。",btn:"我要提供"},need:{title:"我需要帮助 or 合作屋",desc:"说出你目前遇到的困难或想找合作伙伴，让社群支援你。",btn:"我需要帮助"},supply:{title:"帮助 & 合作供应圈",desc:"浏览大家能提供的帮助与合作资源，主动联系彼此。",btn:"探索供应圈"},room:{title:"进入互助房",desc:"即时交流，互助成长",btn:"进入互助房"}},modals:{provide:{title:"我可以提供帮助 & 合作",subtitle:"在重启路上，我的经历和优势也许可以帮上忙！",experience:"我的经历（可复选）：",current:"我的现状(可复选)：",target:"我想优先帮助的对象（可复选）：",helpType:"我可以提供帮助形式：",statement:"我的特别声明（50字内）：",frequency:"我可帮助的频率：",cancel:"取消",submit:"送出",other:"其他...",enterPlaceholder:"请输入...",messageTo:"留言给：",messagePlaceholder:"请输入留言...",sendMessage:"送出留言",messageSent:"需求已成功送出！"},need:{title:"我需要帮助",subtitle:"请描述你遇到的困难或需要协助的地方，让社群伙伴能更好帮助你！",experience:"我的经历（可复选）：",current:"我的现状(可复选)：",target:"我遇到的困难/需求（可复选）：",helpType:"希望获得协助形式：",statement:"补充说明（50字内）：",frequency:"希望获得协助频率：",cancel:"取消",submit:"送出",other:"其他...",enterPlaceholder:"请输入...",messageTo:"留言给：",messagePlaceholder:"请输入留言...",sendMessage:"送出留言",messageSent:"需求已成功送出！"}},options:{experience:["成功创业","家庭重建","就业辅导","法律协助","戒瘾经验","志工","社区服务","其他"],advantage:["经济困难","无固定工作","缺乏家庭支持","健康问题","法律纠纷","心理压力","缺乏居住地","人际关系困难","正在创业中","其他"],target:["找工作/就业协助","经济急难救助","心理咨询/陪伴","法律协助","医疗协助","住宿协助","家庭修复","戒瘾支持","人际关系协助","生活重建","商业辅导","其他"],helpType:["线上","线下"],frequency:["每天","每周","每月","依需要者而定","其他"]},messages:{messageSent:"留言发送成功！",messageFailed:"留言发送失败，请稍后再试",noMessages:"暂无留言",markRead:"标记已读",delete:"删除",confirmDelete:"你确定要删除这条留言吗？（一旦删除将无法复原）",inboxTitle:"站内消息",messageFrom:"给你的留言：",contactUser:"联络对方"},date:"日期",avatar:"头像",name:"名称",gender:"性别",age:"年龄",country:"国家"},en:{sections:{provide:{title:"I can provide help & cooperation room",desc:"Share your expertise, resources or areas you want to collaborate on, so more people can find you.",btn:"I want to provide"},need:{title:"I need help or cooperation house",desc:"Tell us about the difficulties you're currently facing or partners you want to find, so the community can support you.",btn:"I need help"},supply:{title:"Help & cooperation supply circle",desc:"Browse the help and cooperation resources everyone can provide, actively contact each other.",btn:"Explore supply circle"},room:{title:"Enter mutual aid room",desc:"Real-time communication, mutual growth",btn:"Enter mutual aid room"}},modals:{provide:{title:"I can provide help & cooperation",subtitle:"On the restart journey, my experience and advantages might be helpful!",experience:"My experience (multiple choice):",current:"My current situation (multiple choice):",target:"People I want to help first (multiple choice):",helpType:"I can provide help in the form of:",statement:"My special statement (within 50 characters):",frequency:"My help frequency:",cancel:"Cancel",submit:"Submit",other:"Other...",enterPlaceholder:"Please enter...",messageTo:"Message to:",messagePlaceholder:"Please enter message...",sendMessage:"Send message",messageSent:"Request sent successfully!",backToHome:"Back to Home"},need:{title:"I need help",subtitle:"Please describe the difficulties you're facing or areas where you need assistance, so community partners can better help you!",experience:"My experience (multiple choice):",current:"My current situation (multiple choice):",target:"People I want to help first (multiple choice):",helpType:"I can provide help in the form of:",statement:"My special statement (within 50 characters):",frequency:"My help frequency:",cancel:"Cancel",submit:"Submit",other:"Other...",enterPlaceholder:"Please enter...",messageTo:"Message to:",messagePlaceholder:"Please enter message...",sendMessage:"Send message",messageSent:"Request sent successfully!",backToHome:"Back to Home"}},options:{experience:["Successful entrepreneurship","Family reconstruction","Employment guidance","Legal assistance","Addiction recovery experience","Volunteer","Community service","Other"],advantage:["Financial difficulties","No fixed job","Lack of family support","Health problems","Legal disputes","Psychological pressure","Lack of housing","Interpersonal difficulties","Currently starting a business","Other"],target:["Job search/employment assistance","Emergency financial assistance","Psychological counseling/companionship","Legal assistance","Medical assistance","Housing assistance","Family repair","Addiction support","Interpersonal assistance","Life reconstruction","Business guidance","Other"],helpType:["Online","Offline"],frequency:["Daily","Weekly","Monthly","As needed","Other"]},messages:{messageSent:"Message sent successfully!",messageFailed:"Message sending failed, please try again later",noMessages:"No messages yet",markRead:"Mark as read",delete:"Delete",confirmDelete:"Are you sure you want to delete this message? (Once deleted, it cannot be restored)",inboxTitle:"Inbox Messages",messageFrom:" sent you a message:",contactUser:"Contact User"},date:"Date",avatar:"Avatar",name:"Name",gender:"Gender",age:"Age",country:"Country"},ja:{sections:{provide:{title:"私は助けと協力の部屋を提供できます",desc:"あなたの専門知識、リソース、または協力したい分野を共有して、より多くの人にあなたを見つけてもらいましょう。",btn:"提供したい"},need:{title:"私は助けまたは協力の家が必要です",desc:"現在直面している困難や見つけたいパートナーについて教えてください。コミュニティがあなたをサポートできるようにします。",btn:"助けが必要です"},supply:{title:"助けと協力の供給サークル",desc:"みんなが提供できる助けと協力のリソースを閲覧し、積極的にお互いに連絡を取り合いましょう。",btn:"供給サークルを探索"},room:{title:"相互扶助の部屋に入る",desc:"リアルタイムコミュニケーション、相互成長",btn:"相互扶助の部屋に入る"}},modals:{provide:{title:"私は助けと協力を提供できます",subtitle:"再出発の道のりで、私の経験と強みがお役に立てるかもしれません！",experience:"私の経験（複数選択可）：",current:"私の現状（複数選択可）：",target:"私が優先的に助けたい人（複数選択可）：",helpType:"私が提供できる助けの形式：",statement:"私の特別な声明（50文字以内）：",frequency:"私が助けられる頻度：",cancel:"キャンセル",submit:"送信",other:"その他...",enterPlaceholder:"入力してください...",messageTo:"メッセージを送る：",messagePlaceholder:"メッセージを入力してください...",sendMessage:"メッセージを送信",messageSent:"リクエストが正常に送信されました！",backToHome:"ホームへ戻る"},need:{title:"助けが必要です",subtitle:"直面している困難や支援が必要な領域を説明してください。コミュニティのパートナーがより良くあなたを助けられるようにします！",experience:"私の経験（複数選択可）：",current:"私の現状（複数選択可）：",target:"私が優先的に助けたい人（複数選択可）：",helpType:"私が提供できる助けの形式：",statement:"私の特別な声明（50文字以内）：",frequency:"私が助けられる頻度：",cancel:"キャンセル",submit:"送信",other:"その他...",enterPlaceholder:"入力してください...",messageTo:"メッセージを送る：",messagePlaceholder:"メッセージを入力してください...",sendMessage:"メッセージを送信",messageSent:"リクエストが正常に送信されました！",backToHome:"ホームへ戻る"}},options:{experience:["成功した起業","家族の再構築","就職支援","法的支援","依存症回復経験","ボランティア","コミュニティサービス","その他"],advantage:["経済的困難","固定職なし","家族のサポート不足","健康問題","法的紛争","心理的プレッシャー","住居不足","人間関係の困難","現在起業中","その他"],target:["仕事探し/就職支援","緊急経済支援","心理カウンセリング/同伴","法的支援","医療支援","住居支援","家族修復","依存症支援","人間関係支援","生活再建","ビジネス指導","その他"],helpType:["オンライン","オフライン"],frequency:["毎日","毎週","毎月","必要に応じて","その他"]},messages:{messageSent:"メッセージが正常に送信されました！",messageFailed:"メッセージの送信に失敗しました。後でもう一度お試しください",noMessages:"まだメッセージがありません",markRead:"既読にする",delete:"削除",confirmDelete:"このメッセージを削除してもよろしいですか？（削除すると復元できません）",inboxTitle:"受信メッセージ",messageFrom:"からメッセージ：",contactUser:"ユーザーに連絡",backToHome:"ホームへ戻る"},date:"日付",avatar:"アイコン",name:"名前",gender:"性別",age:"年齢",country:"国"},ko:{sections:{provide:{title:"나는 도움과 협력 방을 제공할 수 있습니다",desc:"당신의 전문 지식, 자원 또는 협력하고 싶은 분야를 공유하여 더 많은 사람들이 당신을 찾을 수 있도록 하세요.",btn:"제공하고 싶습니다"},need:{title:"나는 도움이나 협력 집이 필요합니다",desc:"현재 직면한 어려움이나 찾고 싶은 파트너에 대해 말씀해 주세요. 커뮤니티가 당신을 지원할 수 있도록 합니다.",btn:"도움이 필요합니다"},supply:{title:"도움과 협력 공급 서클",desc:"모든 사람이 제공할 수 있는 도움과 협력 자원을 둘러보고, 적극적으로 서로 연락하세요.",btn:"공급 서클 탐색"},room:{title:"상호 원조 방에 들어가기",desc:"실시간 소통, 상호 성장",btn:"상호 원조 방에 들어가기"}},modals:{provide:{title:"나는 도움과 협력을 제공할 수 있습니다",subtitle:"재시작 여정에서 제 경험과 장점이 도움이 될 수 있습니다!",experience:"제 경험 (복수 선택 가능):",current:"제 현재 상황 (복수 선택 가능):",target:"제가 우선적으로 도우고 싶은 사람 (복수 선택 가능):",helpType:"제가 제공할 수 있는 도움의 형태:",statement:"제 특별한 선언 (50자 이내):",frequency:"제가 도울 수 있는 빈도:",cancel:"취소",submit:"제출",other:"기타...",enterPlaceholder:"입력하세요...",messageTo:"메시지 보내기:",messagePlaceholder:"메시지를 입력하세요...",sendMessage:"메시지 보내기",messageSent:"요청이 성공적으로 전송되었습니다!",backToHome:"홈으로 돌아가기"},need:{title:"도움이 필요합니다",subtitle:"당신이 직면한 어려움이나 도움이 필요한 분야를 설명해 주세요. 커뮤니티 파트너가 더 잘 당신을 도울 수 있도록 합니다!",experience:"제 경험 (복수 선택 가능):",current:"제 현재 상황 (복수 선택 가능):",target:"제가 우선적으로 도우고 싶은 사람 (복수 선택 가능):",helpType:"제가 제공할 수 있는 도움의 형태:",statement:"제 특별한 선언 (50자 이내):",frequency:"제가 도울 수 있는 빈도:",cancel:"취소",submit:"제출",other:"기타...",enterPlaceholder:"입력하세요...",messageTo:"메시지 보내기:",messagePlaceholder:"메시지를 입력하세요...",sendMessage:"메시지 보내기",messageSent:"요청이 성공적으로 전송되었습니다!",backToHome:"홈으로 돌아가기"}},options:{experience:["성공한 창업","가족 재건","취업 지도","법적 지원","중독 회복 경험","자원봉사","커뮤니티 서비스","기타"],advantage:["경제적 어려움","고정 직업 없음","가족 지원 부족","건강 문제","법적 분쟁","심리적 압박","주거지 부족","인간관계 어려움","현재 창업 중","기타"],target:["일자리 찾기/취업 지원","긴급 경제 지원","심리 상담/동반","법적 지원","의료 지원","주거 지원","가족 회복","중독 지원","인간관계 지원","생활 재건","비즈니스 지도","기타"],helpType:["온라인","오프라인"],frequency:["매일","매주","매월","필요에 따라","기타"]},messages:{messageSent:"메시지가 성공적으로 전송되었습니다!",messageFailed:"메시지 전송에 실패했습니다. 나중에 다시 시도해 주세요",noMessages:"아직 메시지가 없습니다",markRead:"읽음 표시",delete:"삭제",confirmDelete:"이 메시지를 삭제하시겠습니까? (삭제하면 복원할 수 없습니다)",inboxTitle:"받은 메시지",messageFrom:"님이 보낸 메시지:",contactUser:"사용자에게 연락",backToHome:"홈으로 돌아가기"},date:"날짜",avatar:"아바타",name:"이름",gender:"성별",age:"나이",country:"국가"},vi:{sections:{provide:{title:"Tôi có thể cung cấp phòng trợ giúp & hợp tác",desc:"Chia sẻ chuyên môn, tài nguyên hoặc lĩnh vực bạn muốn hợp tác, để nhiều người có thể tìm thấy bạn.",btn:"Tôi muốn cung cấp"},need:{title:"Tôi cần trợ giúp hoặc nhà hợp tác",desc:"Hãy nói về những khó khăn bạn đang gặp phải hoặc đối tác bạn muốn tìm, để cộng đồng có thể hỗ trợ bạn.",btn:"Tôi cần trợ giúp"},supply:{title:"Vòng tròn cung cấp trợ giúp & hợp tác",desc:"Duyệt qua các tài nguyên trợ giúp và hợp tác mà mọi người có thể cung cấp, chủ động liên lạc với nhau.",btn:"Khám phá vòng tròn cung cấp"},room:{title:"Vào phòng hỗ trợ lẫn nhau",desc:"Giao tiếp thời gian thực, cùng nhau phát triển",btn:"Vào phòng hỗ trợ lẫn nhau"}},modals:{provide:{title:"Tôi có thể cung cấp trợ giúp & hợp tác",subtitle:"Trên hành trình khởi động lại, kinh nghiệm và lợi thế của tôi có thể hữu ích!",experience:"Kinh nghiệm của tôi (chọn nhiều):",current:"Tình trạng hiện tại của tôi (chọn nhiều):",target:"Những người tôi muốn ưu tiên giúp đỡ (chọn nhiều):",helpType:"Tôi có thể cung cấp trợ giúp dưới hình thức:",statement:"Tuyên bố đặc biệt của tôi (trong vòng 50 ký tự):",frequency:"Tần suất tôi có thể giúp:",cancel:"Hủy",submit:"Gửi",other:"Khác...",enterPlaceholder:"Vui lòng nhập...",messageTo:"Nhắn tin cho:",messagePlaceholder:"Vui lòng nhập tin nhắn...",sendMessage:"Gửi tin nhắn",messageSent:"Yêu cầu đã được gửi thành công!",backToHome:"Về trang chủ"},need:{title:"Tôi cần trợ giúp",subtitle:"Vui lòng mô tả những khó khăn bạn đang gặp phải hoặc những lĩnh vực cần hỗ trợ, để các đối tác cộng đồng có thể giúp bạn tốt hơn!",experience:"Kinh nghiệm của tôi (chọn nhiều):",current:"Tình trạng hiện tại của tôi (chọn nhiều):",target:"Những người tôi muốn ưu tiên giúp đỡ (chọn nhiều):",helpType:"Tôi có thể cung cấp trợ giúp dưới hình thức:",statement:"Tuyên bố đặc biệt của tôi (trong vòng 50 ký tự):",frequency:"Tần suất tôi có thể giúp:",cancel:"Hủy",submit:"Gửi",other:"Khác...",enterPlaceholder:"Vui lòng nhập...",messageTo:"Nhắn tin cho:",messagePlaceholder:"Vui lòng nhập tin nhắn...",sendMessage:"Gửi tin nhắn",messageSent:"Yêu cầu đã được gửi thành công!",backToHome:"Về trang chủ"}},options:{experience:["Khởi nghiệp thành công","Tái thiết gia đình","Hướng dẫn việc làm","Hỗ trợ pháp lý","Kinh nghiệm cai nghiện","Tình nguyện viên","Dịch vụ cộng đồng","Khác"],advantage:["Khó khăn tài chính","Không có việc làm cố định","Thiếu hỗ trợ gia đình","Vấn đề sức khỏe","Tranh chấp pháp lý","Áp lực tâm lý","Thiếu nơi ở","Khó khăn trong mối quan hệ","Đang khởi nghiệp","Khác"],target:["Tìm việc/hỗ trợ việc làm","Hỗ trợ tài chính khẩn cấp","Tư vấn tâm lý/đồng hành","Hỗ trợ pháp lý","Hỗ trợ y tế","Hỗ trợ nhà ở","Sửa chữa gia đình","Hỗ trợ cai nghiện","Hỗ trợ mối quan hệ","Tái thiết cuộc sống","Hướng dẫn kinh doanh","Khác"],helpType:["Trực tuyến","Ngoại tuyến"],frequency:["Hàng ngày","Hàng tuần","Hàng tháng","Theo nhu cầu","Khác"]},messages:{messageSent:"Tin nhắn đã được gửi thành công!",messageFailed:"Gửi tin nhắn thất bại, vui lòng thử lại sau",noMessages:"Chưa có tin nhắn",markRead:"Đánh dấu đã đọc",delete:"Xóa",confirmDelete:"Bạn có chắc chắn muốn xóa tin nhắn này không? (Một khi xóa sẽ không thể khôi phục)",inboxTitle:"Tin nhắn đến",messageFrom:" đã gửi tin nhắn cho bạn:",contactUser:"Liên hệ người dùng",backToHome:"Về trang chủ"},date:"Ngày",avatar:"Ảnh đại diện",name:"Tên",gender:"Giới tính",age:"Tuổi",country:"Quốc gia"},th:{sections:{provide:{title:"ฉันสามารถให้ความช่วยเหลือและห้องความร่วมมือ",desc:"แบ่งปันความเชี่ยวชาญ ทรัพยากร หรือพื้นที่ที่คุณต้องการร่วมมือ เพื่อให้คนอื่นๆ หาคุณเจอ",btn:"ฉันต้องการให้"},need:{title:"ฉันต้องการความช่วยเหลือหรือบ้านความร่วมมือ",desc:"บอกเราเกี่ยวกับความยากลำบากที่คุณกำลังเผชิญหรือคู่ค้าที่คุณต้องการหา เพื่อให้ชุมชนสามารถสนับสนุนคุณได้",btn:"ฉันต้องการความช่วยเหลือ"},supply:{title:"วงกลมอุปทานความช่วยเหลือและความร่วมมือ",desc:"เรียกดูทรัพยากรความช่วยเหลือและความร่วมมือที่ทุกคนสามารถให้ได้ ติดต่อกันอย่างกระตือรือร้น",btn:"สำรวจวงกลมอุปทาน"},room:{title:"เข้าห้องช่วยเหลือซึ่งกันและกัน",desc:"การสื่อสารแบบเรียลไทม์ การเติบโตร่วมกัน",btn:"เข้าห้องช่วยเหลือซึ่งกันและกัน"}},modals:{provide:{title:"ฉันสามารถให้ความช่วยเหลือและความร่วมมือ",subtitle:"ในการเดินทางเริ่มต้นใหม่ ประสบการณ์และข้อได้เปรียบของฉันอาจเป็นประโยชน์!",experience:"ประสบการณ์ของฉัน (เลือกได้หลายข้อ):",current:"สถานการณ์ปัจจุบันของฉัน (เลือกได้หลายข้อ):",target:"คนที่ฉันต้องการช่วยเป็นอันดับแรก (เลือกได้หลายข้อ):",helpType:"ฉันสามารถให้ความช่วยเหลือในรูปแบบ:",statement:"คำแถลงพิเศษของฉัน (ไม่เกิน 50 ตัวอักษร):",frequency:"ความถี่ที่ฉันสามารถช่วยได้:",cancel:"ยกเลิก",submit:"ส่ง",other:"อื่นๆ...",enterPlaceholder:"กรุณาป้อน...",messageTo:"ส่งข้อความถึง:",messagePlaceholder:"กรุณาป้อนข้อความ...",sendMessage:"ส่งข้อความ",messageSent:"ส่งคำขอสำเร็จแล้ว!",backToHome:"กลับหน้าหลัก"},need:{title:"ฉันต้องการความช่วยเหลือ",subtitle:"กรุณาอธิบายความยากลำบากที่คุณกำลังเผชิญหรือพื้นที่ที่ต้องการความช่วยเหลือ เพื่อให้คู่ค้าชุมชนสามารถช่วยคุณได้ดีขึ้น!",experience:"ประสบการณ์ของฉัน (เลือกได้หลายข้อ):",current:"สถานการณ์ปัจจุบันของฉัน (เลือกได้หลายข้อ):",target:"คนที่ฉันต้องการช่วยเป็นอันดับแรก (เลือกได้หลายข้อ):",helpType:"ฉันสามารถให้ความช่วยเหลือในรูปแบบ:",statement:"คำแถลงพิเศษของฉัน (ไม่เกิน 50 ตัวอักษร):",frequency:"ความถี่ที่ฉันสามารถช่วยได้:",cancel:"ยกเลิก",submit:"ส่ง",other:"อื่นๆ...",enterPlaceholder:"กรุณาป้อน...",messageTo:"ส่งข้อความถึง:",messagePlaceholder:"กรุณาป้อนข้อความ...",sendMessage:"ส่งข้อความ",messageSent:"ส่งคำขอสำเร็จแล้ว!",backToHome:"กลับหน้าหลัก"}},options:{experience:["การเริ่มต้นธุรกิจที่ประสบความสำเร็จ","การสร้างครอบครัวใหม่","การแนะแนวการจ้างงาน","การช่วยเหลือทางกฎหมาย","ประสบการณ์การเลิกเสพติด","อาสาสมัคร","บริการชุมชน","อื่นๆ"],advantage:["ความยากลำบากทางการเงิน","ไม่มีงานประจำ","ขาดการสนับสนุนจากครอบครัว","ปัญหาสุขภาพ","ข้อพิพาททางกฎหมาย","ความกดดันทางจิตใจ","ขาดที่อยู่อาศัย","ความยากลำบากในความสัมพันธ์","กำลังเริ่มต้นธุรกิจ","อื่นๆ"],target:["การหางาน/ความช่วยเหลือการจ้างงาน","ความช่วยเหลือทางการเงินฉุกเฉิน","การให้คำปรึกษาทางจิตวิทยา/การเป็นเพื่อน","การช่วยเหลือทางกฎหมาย","ความช่วยเหลือทางการแพทย์","ความช่วยเหลือที่อยู่อาศัย","การซ่อมแซมครอบครัว","การสนับสนุนการเลิกเสพติด","ความช่วยเหลือความสัมพันธ์","การสร้างชีวิตใหม่","การแนะแนวธุรกิจ","อื่นๆ"],helpType:["ออนไลน์","ออฟไลน์"],frequency:["ทุกวัน","ทุกสัปดาห์","ทุกเดือน","ตามความต้องการ","อื่นๆ"]},messages:{messageSent:"ส่งข้อความสำเร็จแล้ว!",messageFailed:"การส่งข้อความล้มเหลว กรุณาลองใหม่อีกครั้ง",noMessages:"ยังไม่มีข้อความ",markRead:"ทำเครื่องหมายว่าอ่านแล้ว",delete:"ลบ",confirmDelete:"คุณแน่ใจหรือไม่ที่จะลบข้อความนี้? (เมื่อลบแล้วจะไม่สามารถกู้คืนได้)",inboxTitle:"受信メッセージ",messageFrom:"からメッセージ：",contactUser:"ユーザーに連絡",backToHome:"ホームへ戻る"},date:"วันที่",avatar:"รูปภาพ",name:"ชื่อ",gender:"เพศ",age:"อายุ",country:"ประเทศ"},ms:{sections:{provide:{title:"Saya boleh menyediakan bilik bantuan & kerjasama",desc:"Kongsi kepakaran, sumber atau bidang yang anda ingin bekerjasama, supaya lebih ramai orang dapat mencari anda.",btn:"Saya ingin menyediakan"},need:{title:"Saya memerlukan bantuan atau rumah kerjasama",desc:"Beritahu kami tentang kesukaran yang anda hadapi atau rakan kongsi yang anda ingin cari, supaya komuniti dapat menyokong anda.",btn:"Saya memerlukan bantuan"},supply:{title:"Bulatan bekalan bantuan & kerjasama",desc:"Semak imbas sumber bantuan dan kerjasama yang semua orang boleh sediakan, hubungi antara satu sama lain secara aktif.",btn:"Jelajah bulatan bekalan"},room:{title:"Masuk bilik bantuan bersama",desc:"Komunikasi masa nyata, pertumbuhan bersama",btn:"Masuk bilik bantuan bersama"}},modals:{provide:{title:"Saya boleh menyediakan bantuan & kerjasama",subtitle:"Dalam perjalanan memulakan semula, pengalaman dan kelebihan saya mungkin boleh membantu!",experience:"Pengalaman saya (pilihan berganda):",current:"Keadaan semasa saya (pilihan berganda):",target:"Orang yang saya ingin bantu terlebih dahulu (pilihan berganda):",helpType:"Saya boleh menyediakan bantuan dalam bentuk:",statement:"Pernyataan khas saya (dalam 50 aksara):",frequency:"Kekerapan saya boleh membantu:",cancel:"Batal",submit:"Hantar",other:"Lain-lain...",enterPlaceholder:"Sila masukkan...",messageTo:"Mesej kepada:",messagePlaceholder:"Sila masukkan mesej...",sendMessage:"Hantar mesej",messageSent:"Permintaan berjaya dihantar!",backToHome:"Kembali ke Laman Utama"},need:{title:"Saya memerlukan bantuan",subtitle:"Sila terangkan kesukaran yang anda hadapi atau bidang yang memerlukan bantuan, supaya rakan kongsi komuniti dapat membantu anda dengan lebih baik!",experience:"Pengalaman saya (pilihan berganda):",current:"Keadaan semasa saya (pilihan berganda):",target:"Orang yang saya ingin bantu terlebih dahulu (pilihan berganda):",helpType:"Saya boleh menyediakan bantuan dalam bentuk:",statement:"Pernyataan khas saya (dalam 50 aksara):",frequency:"Kekerapan saya boleh membantu:",cancel:"Batal",submit:"Hantar",other:"Lain-lain...",enterPlaceholder:"Sila masukkan...",messageTo:"Mesej kepada:",messagePlaceholder:"Sila masukkan mesej...",sendMessage:"Hantar mesej",messageSent:"Permintaan berjaya dihantar!",backToHome:"Kembali ke Laman Utama"}},options:{experience:["Keusahawanan berjaya","Pembinaan semula keluarga","Bimbingan pekerjaan","Bantuan undang-undang","Pengalaman pemulihan ketagihan","Sukarelawan","Perkhidmatan komuniti","Lain-lain"],advantage:["Kesukaran kewangan","Tiada pekerjaan tetap","Kekurangan sokongan keluarga","Masalah kesihatan","Pertikaian undang-undang","Tekanan psikologi","Kekurangan tempat tinggal","Kesukaran hubungan interpersonal","Sedang memulakan perniagaan","Lain-lain"],target:["Mencari kerja/bantuan pekerjaan","Bantuan kewangan kecemasan","Kaunseling psikologi/teman","Bantuan undang-undang","Bantuan perubatan","Bantuan tempat tinggal","Pembaikan keluarga","Sokongan ketagihan","Bantuan hubungan interpersonal","Pembinaan semula kehidupan","Bimbingan perniagaan","Lain-lain"],helpType:["Dalam talian","Luar talian"],frequency:["Setiap hari","Setiap minggu","Setiap bulan","Mengikut keperluan","Lain-lain"]},messages:{messageSent:"Mesej berjaya dihantar!",messageFailed:"Penghantaran mesej gagal, sila cuba lagi kemudian",noMessages:"Tiada mesej lagi",markRead:"Tandakan sebagai dibaca",delete:"Padam",confirmDelete:"Adakah anda pasti mahu memadamkan mesej ini? (Sebaik sahaja dipadamkan, ia tidak dapat dipulihkan)",inboxTitle:"受信メッセージ",messageFrom:"からメッセージ：",contactUser:"ユーザーに連絡",backToHome:"ホームへ戻る"},date:"Tarikh",avatar:"Avatar",name:"Nama",gender:"Jantina",age:"Umur",country:"Negara"},la:{sections:{provide:{title:"Possum praebere auxilium & cooperationis cubiculum",desc:"Partiri peritiam, opes vel regiones quas cooperari vis, ut plures te invenire possint.",btn:"Volo praebere"},need:{title:"Egeo auxilii vel cooperationis domus",desc:"Dic nobis de difficultatibus quas nunc patieris vel sociis quos quaeris, ut communitas te sustentare possit.",btn:"Egeo auxilii"},supply:{title:"Auxilii & cooperationis copiae circulus",desc:"Perlustra auxilii et cooperationis opes quas omnes praebere possunt, active inter se communicare.",btn:"Explora copiae circulum"},room:{title:"Intra mutuum auxilium cubiculum",desc:"Temporis realis communicatio, mutuus incrementum",btn:"Intra mutuum auxilium cubiculum"}},modals:{provide:{title:"Possum praebere auxilium & cooperationem",subtitle:"In itinere redintegrationis, mea experientia et commoda forsitan prodesse possunt!",experience:"Mea experientia (multiplex electio):",current:"Mea praesens condicio (multiplex electio):",target:"Homines quos primum adiuvare volo (multiplex electio):",helpType:"Possum praebere auxilium in forma:",statement:"Mea specialis declaratio (intra 50 characteres):",frequency:"Mea auxilii frequentia:",cancel:"Cancella",submit:"Submitte",other:"Alia...",enterPlaceholder:"Quaeso intra...",messageTo:"Nuntius ad:",messagePlaceholder:"Quaeso intra nuntium...",sendMessage:"Mitte nuntium",messageSent:"Petitio feliciter missa est!",backToHome:"Ad domum redire"},need:{title:"Egeo auxilii",subtitle:"Quaeso describe difficultates quas patieris vel regiones quae auxilio indigent, ut socii communitatis te melius adiuvare possint!",experience:"Mea experientia (multiplex electio):",current:"Mea praesens condicio (multiplex electio):",target:"Homines quos primum adiuvare volo (multiplex electio):",helpType:"Possum praebere auxilium in forma:",statement:"Mea specialis declaratio (intra 50 characteres):",frequency:"Mea auxilii frequentia:",cancel:"Cancella",submit:"Submitte",other:"Alia...",enterPlaceholder:"Quaeso intra...",messageTo:"Nuntius ad:",messagePlaceholder:"Quaeso intra nuntium...",sendMessage:"Mitte nuntium",messageSent:"Petitio feliciter missa est!",backToHome:"Ad domum redire"}},options:{experience:["Felix initium negotii","Familiae reconstructio","Orientatio laboris","Auxilium legale","Experientia liberationis ab addictione","Voluntarius","Servitium communitatis","Alia"],advantage:["Difficultates oeconomicae","Nullus labor fixus","Defectus sustentationis familiae","Problema sanitatis","Controversia legalis","Pressura psychologica","Defectus habitationis","Difficultates relationum","Nunc initium negotii faciens","Alia"],target:["Quaerere laborem/auxilium laboris","Auxilium oeconomicum urgentis","Consilium psychologicum/societas","Auxilium legale","Auxilium medicum","Auxilium habitationis","Reparatio familiae","Sustentatio liberationis","Auxilium relationum","Reconstructio vitae","Orientatio negotii","Alia"],helpType:["Online","Offline"],frequency:["Quotidie","Quot hebdomadis","Quot mensibus","Secundum necessitatem","Alia"]},messages:{messageSent:"Nuntius feliciter missus est!",messageFailed:"Missio nuntii defecit, quaeso postea denuo tenta",noMessages:"Nondum nuntii",markRead:"Nota ut lectum",delete:"Dele",confirmDelete:"Esne certus hunc nuntium delere velle? (Semel deletus, restitui non potest)",inboxTitle:"Inbox Messages",messageFrom:" sent you a message:",contactUser:"Contact User",backToHome:"Back to Home"},date:"Dies",avatar:"Imago",name:"Nomen",gender:"Genus",age:"Aetas",country:"Patria"}},F3=n=>{const e=Ht[n]||Ht["zh-TW"];return[{emoji:"🤝",title:e.sections.provide.title,desc:e.sections.provide.desc,btn:e.sections.provide.btn,color:"#e0f7fa"},{emoji:"🆘",title:e.sections.need.title,desc:e.sections.need.desc,btn:e.sections.need.btn,color:"#fff3e0"},{emoji:"🌐",title:e.sections.supply.title,desc:e.sections.supply.desc,btn:e.sections.supply.btn,color:"#e8f5e9"},{emoji:"🏠",title:e.sections.room.title,desc:e.sections.room.desc,btn:e.sections.room.btn,color:"#f3e5f5"}]},EI=n=>{const e={"zh-TW":{experience:["成功創業","家庭重建","就業輔導","法律協助","戒癮經驗","志工","社區服務","其他"],advantage:["經濟困難","無固定工作","缺乏家庭支持","健康問題","法律糾紛","心理壓力","缺乏居住地","人際關係困難","正在創業中","其他"],target:["找工作/就業協助","經濟急難救助","心理諮詢/陪伴","法律協助","醫療協助","住宿協助","家庭修復","戒癮支持","人際關係協助","生活重建","商業輔導","其他"],helpType:["線上","線下"],frequency:["每天","每週","每月","依需要者而定","其他"]},"zh-CN":{experience:["成功创业","家庭重建","就业辅导","法律协助","戒瘾经验","志工","社区服务","其他"],advantage:["经济困难","无固定工作","缺乏家庭支持","健康问题","法律纠纷","心理压力","缺乏居住地","人际关系困难","正在创业中","其他"],target:["找工作/就业协助","经济急难救助","心理咨询/陪伴","法律协助","医疗协助","住宿协助","家庭修复","戒瘾支持","人际关系协助","生活重建","商业辅导","其他"],helpType:["线上","线下"],frequency:["每天","每周","每月","依需要者而定","其他"]},en:{experience:["Successful entrepreneurship","Family reconstruction","Employment guidance","Legal assistance","Addiction recovery experience","Volunteer","Community service","Other"],advantage:["Financial difficulties","No fixed job","Lack of family support","Health problems","Legal disputes","Psychological pressure","Lack of housing","Interpersonal difficulties","Currently starting a business","Other"],target:["Job search/employment assistance","Emergency financial assistance","Psychological counseling/companionship","Legal assistance","Medical assistance","Housing assistance","Family repair","Addiction support","Interpersonal assistance","Life reconstruction","Business guidance","Other"],helpType:["Online","Offline"],frequency:["Daily","Weekly","Monthly","As needed","Other"]},ja:{experience:["成功した起業","家族の再構築","就職支援","法的支援","依存症回復経験","ボランティア","コミュニティサービス","その他"],advantage:["経済的困難","固定職なし","家族のサポート不足","健康問題","法的紛争","心理的プレッシャー","住居不足","人間関係の困難","現在起業中","その他"],target:["仕事探し/就職支援","緊急経済支援","心理カウンセリング/同伴","法的支援","医療支援","住居支援","家族修復","依存症支援","人間関係支援","生活再建","ビジネス指導","その他"],helpType:["オンライン","オフライン"],frequency:["毎日","毎週","毎月","必要に応じて","その他"]},ko:{experience:["성공한 창업","가족 재건","취업 지도","법적 지원","중독 회복 경험","자원봉사","커뮤니티 서비스","기타"],advantage:["경제적 어려움","고정 직업 없음","가족 지원 부족","건강 문제","법적 분쟁","심리적 압박","주거지 부족","인간관계 어려움","현재 창업 중","기타"],target:["일자리 찾기/취업 지원","긴급 경제 지원","심리 상담/동반","법적 지원","의료 지원","주거 지원","가족 회복","중독 지원","인간관계 지원","생활 재건","비즈니스 지도","기타"],helpType:["온라인","오프라인"],frequency:["매일","매주","매월","필요에 따라","기타"]},vi:{experience:["Khởi nghiệp thành công","Tái thiết gia đình","Hướng dẫn việc làm","Hỗ trợ pháp lý","Kinh nghiệm cai nghiện","Tình nguyện viên","Dịch vụ cộng đồng","Khác"],advantage:["Khó khăn tài chính","Không có việc làm cố định","Thiếu hỗ trợ gia đình","Vấn đề sức khỏe","Tranh chấp pháp lý","Áp lực tâm lý","Thiếu nơi ở","Khó khăn trong mối quan hệ","Đang khởi nghiệp","Khác"],target:["Tìm việc/hỗ trợ việc làm","Hỗ trợ tài chính khẩn cấp","Tư vấn tâm lý/đồng hành","Hỗ trợ pháp lý","Hỗ trợ y tế","Hỗ trợ nhà ở","Sửa chữa gia đình","Hỗ trợ cai nghiện","Hỗ trợ mối quan hệ","Tái thiết cuộc sống","Hướng dẫn kinh doanh","Khác"],helpType:["Trực tuyến","Ngoại tuyến"],frequency:["Hàng ngày","Hàng tuần","Hàng tháng","Theo nhu cầu","Khác"]},th:{experience:["การเริ่มต้นธุรกิจที่ประสบความสำเร็จ","การสร้างครอบครัวใหม่","การแนะแนวการจ้างงาน","การช่วยเหลือทางกฎหมาย","ประสบการณ์การเลิกเสพติด","อาสาสมัคร","บริการชุมชน","อื่นๆ"],advantage:["ความยากลำบากทางการเงิน","ไม่มีงานประจำ","ขาดการสนับสนุนจากครอบครัว","ปัญหาสุขภาพ","ข้อพิพาททางกฎหมาย","ความกดดันทางจิตใจ","ขาดที่อยู่อาศัย","ความยากลำบากในความสัมพันธ์","กำลังเริ่มต้นธุรกิจ","อื่นๆ"],target:["การหางาน/ความช่วยเหลือการจ้างงาน","ความช่วยเหลือทางการเงินฉุกเฉิน","การให้คำปรึกษาทางจิตวิทยา/การเป็นเพื่อน","การช่วยเหลือทางกฎหมาย","ความช่วยเหลือทางการแพทย์","ความช่วยเหลือที่อยู่อาศัย","การซ่อมแซมครอบครัว","การสนับสนุนการเลิกเสพติด","ความช่วยเหลือความสัมพันธ์","การสร้างชีวิตใหม่","การแนะแนวธุรกิจ","อื่นๆ"],helpType:["ออนไลน์","ออฟไลน์"],frequency:["ทุกวัน","ทุกสัปดาห์","ทุกเดือน","ตามความต้องการ","อื่นๆ"]},ms:{experience:["Keusahawanan berjaya","Pembinaan semula keluarga","Bimbingan pekerjaan","Bantuan undang-undang","Pengalaman pemulihan ketagihan","Sukarelawan","Perkhidmatan komuniti","Lain-lain"],advantage:["Kesukaran kewangan","Tiada pekerjaan tetap","Kekurangan sokongan keluarga","Masalah kesihatan","Pertikaian undang-undang","Tekanan psikologi","Kekurangan tempat tinggal","Kesukaran hubungan interpersonal","Sedang memulakan perniagaan","Lain-lain"],target:["Mencari kerja/bantuan pekerjaan","Bantuan kewangan kecemasan","Kaunseling psikologi/teman","Bantuan undang-undang","Bantuan perubatan","Bantuan tempat tinggal","Pembaikan keluarga","Sokongan ketagihan","Bantuan hubungan interpersonal","Pembinaan semula kehidupan","Bimbingan perniagaan","Lain-lain"],helpType:["Dalam talian","Luar talian"],frequency:["Setiap hari","Setiap minggu","Setiap bulan","Mengikut keperluan","Lain-lain"]},la:{experience:["Felix initium negotii","Familiae reconstructio","Orientatio laboris","Auxilium legale","Experientia liberationis ab addictione","Voluntarius","Servitium communitatis","Alia"],advantage:["Difficultates oeconomicae","Nullus labor fixus","Defectus sustentationis familiae","Problema sanitatis","Controversia legalis","Pressura psychologica","Defectus habitationis","Difficultates relationum","Nunc initium negotii faciens","Alia"],target:["Quaerere laborem/auxilium laboris","Auxilium oeconomicum urgentis","Consilium psychologicum/societas","Auxilium legale","Auxilium medicum","Auxilium habitationis","Reparatio familiae","Sustentatio liberationis","Auxilium relationum","Reconstructio vitae","Orientatio negotii","Alia"],helpType:["Online","Offline"],frequency:["Quotidie","Quot hebdomadis","Quot mensibus","Secundum necessitatem","Alia"]}};return e[n]||e["zh-TW"]};function N3({open:n,onClose:e,userInfo:t,onSubmit:r}){var se,re,ne,W,$,ee,he,_e,ve,Le,Ne,nt,Je,ge,De,tt,Ye,We,pe,Se,we,Re,Ce,U,V,L,oe,H,J,be,Me,$e,Ze,Ke,Et,Ot,Gt,et,ht,Vt,ct,zt,On,Wt,bn,Ir,Er,Es,yi,Cs,Vr,Rs,Zt,Hi,ur,xi,bi;const{lang:s}=Bt(),a=EI(s),[c,d]=w.useState([]),[h,m]=w.useState(""),[g,x]=w.useState([]),[S,I]=w.useState(""),[_,R]=w.useState([]),[T,A]=w.useState(""),[D,F]=w.useState(a.helpType[0]),[X,ie]=w.useState(""),[G,N]=w.useState(a.frequency[0]),[E,P]=w.useState(""),[M,O]=w.useState(!1),[z,j]=w.useState(!1),[K,Z]=w.useState("");if(!n)return null;const Y=(at,rr,$i)=>{rr(at.includes($i)?at.filter(Dc=>Dc!==$i):[...at,$i])},ae=async at=>{at.preventDefault();try{console.log("ProvideModal 開始提交數據"),await r({exp:c,expOther:h,adv:g,advOther:S,target:_,targetOther:T,helpType:D,statement:X,freq:G,freqOther:E}),console.log("ProvideModal 數據提交成功")}catch(rr){console.error("ProvideModal 數據提交失敗:",rr)}};return i.jsx("div",{style:{position:"fixed",zIndex:9999,left:0,top:0,width:"100vw",height:"100vh",background:"rgba(40,40,80,0.18)",display:"flex",alignItems:"center",justifyContent:"center",padding:"16px"},children:i.jsxs("form",{onSubmit:ae,style:{background:"#fff",borderRadius:24,boxShadow:"0 8px 40px #6B5BFF33",padding:24,minWidth:360,width:"100%",maxWidth:"500px",position:"relative",display:"flex",flexDirection:"column",gap:18,maxHeight:"calc(100vh - 32px)"},children:[i.jsx("button",{type:"button",onClick:e,style:{position:"absolute",top:18,right:18,background:"none",border:"none",fontSize:26,color:"#888",cursor:"pointer",fontWeight:700,zIndex:1},children:"×"}),i.jsxs("div",{style:{overflow:"auto",flex:1,paddingRight:"8px",paddingBottom:"8px",maxHeight:"calc(100vh - 120px)"},children:[i.jsx("div",{style:{fontWeight:900,fontSize:22,color:"#6B5BFF",textAlign:"center",marginBottom:2},children:((ne=(re=(se=Ht[s])==null?void 0:se.modals)==null?void 0:re.provide)==null?void 0:ne.title)||"我可以提供幫助 & 合作"}),i.jsx("div",{style:{color:"#888",fontSize:15,textAlign:"center",marginBottom:8},children:((ee=($=(W=Ht[s])==null?void 0:W.modals)==null?void 0:$.provide)==null?void 0:ee.subtitle)||"在重啟路上，我的經歷和優勢也許可以幫上忙！"}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:14,marginBottom:6},children:[i.jsx("img",{src:t.avatarUrl,alt:"avatar",style:{width:54,height:54,borderRadius:"50%",border:"2px solid #e0e7ff",objectFit:"cover"}}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:2},children:[i.jsx("span",{style:{color:"#1976d2",fontWeight:700,cursor:"pointer",textDecoration:"underline"},onClick:()=>O(!0),children:t.nickname}),i.jsx("span",{style:{color:"#1976d2",fontWeight:500,cursor:"pointer",textDecoration:"underline"},onClick:()=>window.open(`mailto:${t.email}`),children:t.email}),i.jsxs("span",{style:{color:"#555",fontSize:14},children:[t.country,"｜",t.gender,"｜",t.age]})]})]}),i.jsx("div",{style:{fontWeight:700,marginTop:8,fontSize:15},children:((ve=(_e=(he=Ht[s])==null?void 0:he.modals)==null?void 0:_e.provide)==null?void 0:ve.experience)||"我的經歷（可複選）："}),i.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:8,fontSize:14},children:[a.experience.map(at=>i.jsxs("label",{style:{display:"flex",alignItems:"center",gap:4,fontWeight:500},children:[i.jsx("input",{type:"checkbox",checked:c.includes(at),onChange:()=>Y(c,d,at)}),at]},at)),i.jsx("input",{placeholder:((nt=(Ne=(Le=Ht[s])==null?void 0:Le.modals)==null?void 0:Ne.provide)==null?void 0:nt.other)||"其他...",value:h,onChange:at=>m(at.target.value),style:{border:"1px solid #e0e7ff",borderRadius:8,padding:"2px 8px",minWidth:60,fontSize:14}})]}),i.jsx("div",{style:{fontWeight:700,marginTop:8,fontSize:15},children:((De=(ge=(Je=Ht[s])==null?void 0:Je.modals)==null?void 0:ge.provide)==null?void 0:De.current)||"我的現狀(可複選)："}),i.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:8,fontSize:14},children:[a.advantage.map(at=>i.jsxs("label",{style:{display:"flex",alignItems:"center",gap:4,fontWeight:500},children:[i.jsx("input",{type:"checkbox",checked:g.includes(at),onChange:()=>Y(g,x,at)}),at]},at)),i.jsx("input",{placeholder:((We=(Ye=(tt=Ht[s])==null?void 0:tt.modals)==null?void 0:Ye.provide)==null?void 0:We.other)||"其他...",value:S,onChange:at=>I(at.target.value),style:{border:"1px solid #e0e7ff",borderRadius:8,padding:"2px 8px",minWidth:60,fontSize:14}})]}),i.jsx("div",{style:{fontWeight:700,marginTop:8,fontSize:15},children:((we=(Se=(pe=Ht[s])==null?void 0:pe.modals)==null?void 0:Se.provide)==null?void 0:we.target)||"我想優先幫助的對象（可複選）："}),i.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:8,fontSize:14},children:[a.target.map(at=>i.jsxs("label",{style:{display:"flex",alignItems:"center",gap:4,fontWeight:500},children:[i.jsx("input",{type:"checkbox",checked:_.includes(at),onChange:()=>Y(_,R,at)}),at]},at)),i.jsx("input",{placeholder:((U=(Ce=(Re=Ht[s])==null?void 0:Re.modals)==null?void 0:Ce.provide)==null?void 0:U.other)||"其他...",value:T,onChange:at=>A(at.target.value),style:{border:"1px solid #e0e7ff",borderRadius:8,padding:"2px 8px",minWidth:60,fontSize:14}})]}),i.jsx("div",{style:{fontWeight:700,marginTop:8,fontSize:15},children:((oe=(L=(V=Ht[s])==null?void 0:V.modals)==null?void 0:L.provide)==null?void 0:oe.helpType)||"我可以提供幫助形式："}),i.jsx("div",{style:{display:"flex",gap:16,fontSize:14},children:a.helpType.map(at=>i.jsxs("label",{style:{display:"flex",alignItems:"center",gap:4,fontWeight:500},children:[i.jsx("input",{type:"radio",name:"helptype",checked:D===at,onChange:()=>F(at)}),at]},at))}),i.jsx("div",{style:{fontWeight:700,marginTop:8,fontSize:15},children:((be=(J=(H=Ht[s])==null?void 0:H.modals)==null?void 0:J.provide)==null?void 0:be.statement)||"我的特別聲明（50字內）："}),i.jsx("input",{maxLength:50,value:X,onChange:at=>ie(at.target.value),placeholder:((Ze=($e=(Me=Ht[s])==null?void 0:Me.modals)==null?void 0:$e.provide)==null?void 0:Ze.enterPlaceholder)||"請輸入...",style:{border:"1px solid #e0e7ff",borderRadius:8,padding:"4px 10px",fontSize:14}}),i.jsxs("div",{style:{color:"#888",fontSize:13,textAlign:"right",marginTop:-8},children:[X.length,"/50"]}),i.jsx("div",{style:{fontWeight:700,marginTop:8,fontSize:15},children:((Ot=(Et=(Ke=Ht[s])==null?void 0:Ke.modals)==null?void 0:Et.provide)==null?void 0:Ot.frequency)||"我可幫助的頻率："}),i.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:16,fontSize:14},children:[a.frequency.map(at=>i.jsxs("label",{style:{display:"flex",alignItems:"center",gap:4,fontWeight:500,marginRight:12},children:[i.jsx("input",{type:"radio",name:"freq",checked:G===at,onChange:()=>N(at)}),at]},at)),i.jsx("input",{placeholder:((ht=(et=(Gt=Ht[s])==null?void 0:Gt.modals)==null?void 0:et.provide)==null?void 0:ht.other)||"其他...",value:E,onChange:at=>P(at.target.value),style:{border:"1px solid #e0e7ff",borderRadius:8,padding:"2px 8px",minWidth:60,fontSize:14}})]}),i.jsxs("div",{style:{display:"flex",gap:18,marginTop:18,justifyContent:"center",padding:"8px 0",minHeight:"44px",background:"#fff",zIndex:10,borderTop:"1px solid #f0f0f0"},children:[i.jsx("button",{type:"button",onClick:e,style:{background:"#eee",color:"#555",border:"none",borderRadius:18,padding:"8px 28px",fontWeight:700,fontSize:16,cursor:"pointer",minHeight:"44px",touchAction:"manipulation",flex:1,maxWidth:"120px"},children:((zt=(ct=(Vt=Ht[s])==null?void 0:Vt.modals)==null?void 0:ct.provide)==null?void 0:zt.cancel)||"取消"}),i.jsx("button",{type:"submit",style:{background:"linear-gradient(90deg, #6e8efb, #a777e3)",color:"#fff",border:"none",borderRadius:18,padding:"8px 28px",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:"0 2px 8px #a777e355",minHeight:"44px",touchAction:"manipulation",flex:1,maxWidth:"120px"},children:((bn=(Wt=(On=Ht[s])==null?void 0:On.modals)==null?void 0:Wt.provide)==null?void 0:bn.submit)||"送出"})]})]}),M&&i.jsx("div",{style:{position:"fixed",left:0,top:0,width:"100vw",height:"100vh",background:"rgba(40,40,80,0.18)",zIndex:1e4,display:"flex",alignItems:"center",justifyContent:"center"},children:i.jsxs("div",{style:{background:"#fff",borderRadius:18,boxShadow:"0 4px 24px #6B5BFF33",padding:28,minWidth:280,maxWidth:340,width:"90vw",position:"relative",display:"flex",flexDirection:"column",gap:12},children:[i.jsx("button",{type:"button",onClick:()=>O(!1),style:{position:"absolute",top:10,right:12,background:"none",border:"none",fontSize:22,color:"#888",cursor:"pointer",fontWeight:700},children:"×"}),i.jsxs("div",{style:{fontWeight:800,fontSize:18,color:"#6B5BFF",textAlign:"center",marginBottom:2},children:[((Es=(Er=(Ir=Ht[s])==null?void 0:Ir.modals)==null?void 0:Er.provide)==null?void 0:Es.messageTo)||"留言給：",t.nickname]}),i.jsx("textarea",{value:K,onChange:at=>Z(at.target.value),rows:3,maxLength:100,placeholder:((Vr=(Cs=(yi=Ht[s])==null?void 0:yi.modals)==null?void 0:Cs.provide)==null?void 0:Vr.messagePlaceholder)||"請輸入留言...",style:{border:"1px solid #e0e7ff",borderRadius:8,padding:"6px 10px",fontSize:15,resize:"none"}}),i.jsx("button",{onClick:async()=>{O(!1);try{await fetch("/api/send-message",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:K,toUid:t.uid,toEmail:t.email,toNickname:t.nickname,fromUid:window.currentUserUid||"",fromEmail:window.currentUserEmail||"",fromNickname:window.currentUserNickname||""})}),j(!0),setTimeout(()=>j(!1),1500)}catch{alert("留言發送失敗，請稍後再試")}},style:{background:"linear-gradient(90deg, #6e8efb, #a777e3)",color:"#fff",border:"none",borderRadius:14,padding:"6px 18px",fontWeight:700,fontSize:15,cursor:"pointer",alignSelf:"center"},children:((Hi=(Zt=(Rs=Ht[s])==null?void 0:Rs.modals)==null?void 0:Zt.provide)==null?void 0:Hi.sendMessage)||"送出留言"})]})}),z&&i.jsx("div",{style:{position:"fixed",left:0,top:0,width:"100vw",height:"100vh",background:"rgba(40,40,80,0.08)",zIndex:10001,display:"flex",alignItems:"center",justifyContent:"center"},children:i.jsx("div",{style:{background:"#fff",borderRadius:14,boxShadow:"0 2px 12px #ffb74d55",padding:"18px 32px",fontWeight:700,color:"#ff4d4f",fontSize:18},children:((bi=(xi=(ur=Ht[s])==null?void 0:ur.modals)==null?void 0:xi.provide)==null?void 0:bi.messageSent)||"需求已成功送出！"})})]})})}function z3({open:n,onClose:e,userInfo:t,onSubmit:r,showMsgSent:s}){const{lang:a}=Bt(),c=EI(a),[d,h]=w.useState([]),[m,g]=w.useState(""),[x,S]=w.useState([]),[I,_]=w.useState(""),[R,T]=w.useState([]),[A,D]=w.useState(""),[F,X]=w.useState(c.helpType[0]),[ie,G]=w.useState(""),[N,E]=w.useState(c.frequency[0]),[P,M]=w.useState(""),[O,z]=w.useState(!1),[j,K]=w.useState(""),[Z,Y]=w.useState(!1);if(!n)return null;const ae=(re,ne,W)=>{ne(re.includes(W)?re.filter($=>$!==W):[...re,W])},se=async re=>{re.preventDefault();try{console.log("NeedHelpModal 開始提交數據"),await r({exp:d,expOther:m,adv:x,advOther:I,target:R,targetOther:A,helpType:F,statement:ie,freq:N,freqOther:P}),console.log("NeedHelpModal 數據提交成功")}catch(ne){console.error("NeedHelpModal 數據提交失敗:",ne)}};return i.jsx("div",{style:{position:"fixed",zIndex:9999,left:0,top:0,width:"100vw",height:"100vh",background:"rgba(40,40,80,0.18)",display:"flex",alignItems:"center",justifyContent:"center",padding:"16px"},children:i.jsxs("form",{onSubmit:se,style:{background:"#fff",borderRadius:24,boxShadow:"0 8px 40px #6B5BFF33",padding:24,minWidth:360,width:"100%",maxWidth:"500px",position:"relative",display:"flex",flexDirection:"column",gap:18,maxHeight:"calc(100vh - 32px)"},children:[i.jsx("button",{type:"button",onClick:e,style:{position:"absolute",top:18,right:18,background:"none",border:"none",fontSize:26,color:"#888",cursor:"pointer",fontWeight:700,zIndex:1},children:"×"}),i.jsxs("div",{style:{overflow:"auto",flex:1,paddingRight:"8px",paddingBottom:"8px",maxHeight:"calc(100vh - 120px)"},children:[i.jsx("div",{style:{fontWeight:900,fontSize:22,color:"#ff4d4f",textAlign:"center",marginBottom:2},children:"我需要幫助"}),i.jsx("div",{style:{color:"#888",fontSize:15,textAlign:"center",marginBottom:8},children:"請描述你遇到的困難或需要協助的地方，讓社群夥伴能更好幫助你！"}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:14,marginBottom:6},children:[i.jsx("img",{src:t.avatarUrl,alt:"avatar",style:{width:54,height:54,borderRadius:"50%",border:"2px solid #e0e7ff",objectFit:"cover"}}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:2},children:[i.jsx("span",{style:{color:"#1976d2",fontWeight:700,cursor:"pointer",textDecoration:"underline"},onClick:()=>z(!0),children:t.nickname}),i.jsx("span",{style:{color:"#1976d2",fontWeight:500,cursor:"pointer",textDecoration:"underline"},onClick:()=>window.open(`mailto:${t.email}`),children:t.email}),i.jsxs("span",{style:{color:"#555",fontSize:14},children:[t.country,"｜",t.gender,"｜",t.age]})]})]}),i.jsx("div",{style:{fontWeight:700,marginTop:8,fontSize:15},children:"我的經歷（可複選）："}),i.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:8,fontSize:14},children:[c.experience.map(re=>i.jsxs("label",{style:{display:"flex",alignItems:"center",gap:4,fontWeight:500},children:[i.jsx("input",{type:"checkbox",checked:d.includes(re),onChange:()=>ae(d,h,re)}),re]},re)),i.jsx("input",{placeholder:"其他...",value:m,onChange:re=>g(re.target.value),style:{border:"1px solid #e0e7ff",borderRadius:8,padding:"2px 8px",minWidth:60,fontSize:14}})]}),i.jsx("div",{style:{fontWeight:700,marginTop:8,fontSize:15},children:"我的現狀(可複選)："}),i.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:8,fontSize:14},children:[c.advantage.map(re=>i.jsxs("label",{style:{display:"flex",alignItems:"center",gap:4,fontWeight:500},children:[i.jsx("input",{type:"checkbox",checked:x.includes(re),onChange:()=>ae(x,S,re)}),re]},re)),i.jsx("input",{placeholder:"其他...",value:I,onChange:re=>_(re.target.value),style:{border:"1px solid #e0e7ff",borderRadius:8,padding:"2px 8px",minWidth:60,fontSize:14}})]}),i.jsx("div",{style:{fontWeight:700,marginTop:8,fontSize:15},children:"我遇到的困難/需求（可複選）："}),i.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:8,fontSize:14},children:[c.target.map(re=>i.jsxs("label",{style:{display:"flex",alignItems:"center",gap:4,fontWeight:500},children:[i.jsx("input",{type:"checkbox",checked:R.includes(re),onChange:()=>ae(R,T,re)}),re]},re)),i.jsx("input",{placeholder:"其他...",value:A,onChange:re=>D(re.target.value),style:{border:"1px solid #e0e7ff",borderRadius:8,padding:"2px 8px",minWidth:60,fontSize:14}})]}),i.jsx("div",{style:{fontWeight:700,marginTop:8,fontSize:15},children:"希望獲得協助形式："}),i.jsx("div",{style:{display:"flex",gap:16,fontSize:14},children:c.helpType.map(re=>i.jsxs("label",{style:{display:"flex",alignItems:"center",gap:4,fontWeight:500},children:[i.jsx("input",{type:"radio",name:"helptype",checked:F===re,onChange:()=>X(re)}),re]},re))}),i.jsx("div",{style:{fontWeight:700,marginTop:8,fontSize:15},children:"補充說明（50字內）："}),i.jsx("input",{maxLength:50,value:ie,onChange:re=>G(re.target.value),placeholder:"請輸入...",style:{border:"1px solid #e0e7ff",borderRadius:8,padding:"4px 10px",fontSize:14}}),i.jsxs("div",{style:{color:"#888",fontSize:13,textAlign:"right",marginTop:-8},children:[ie.length,"/50"]}),i.jsx("div",{style:{fontWeight:700,marginTop:8,fontSize:15},children:"希望獲得協助頻率："}),i.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:16,fontSize:14},children:[c.frequency.map(re=>i.jsxs("label",{style:{display:"flex",alignItems:"center",gap:4,fontWeight:500,marginRight:12},children:[i.jsx("input",{type:"radio",name:"freq",checked:N===re,onChange:()=>E(re)}),re]},re)),i.jsx("input",{placeholder:"其他...",value:P,onChange:re=>M(re.target.value),style:{border:"1px solid #e0e7ff",borderRadius:8,padding:"2px 8px",minWidth:60,fontSize:14}})]}),i.jsxs("div",{style:{display:"flex",gap:18,marginTop:18,justifyContent:"center",padding:"8px 0",minHeight:"44px",background:"#fff",zIndex:10,borderTop:"1px solid #f0f0f0"},children:[i.jsx("button",{type:"button",onClick:e,style:{background:"#eee",color:"#555",border:"none",borderRadius:18,padding:"8px 28px",fontWeight:700,fontSize:16,cursor:"pointer",minHeight:"44px",touchAction:"manipulation",flex:1,maxWidth:"120px"},children:"取消"}),i.jsx("button",{type:"submit",style:{background:"linear-gradient(90deg, #6e8efb, #a777e3)",color:"#fff",border:"none",borderRadius:18,padding:"8px 28px",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:"0 2px 8px #a777e355",minHeight:"44px",touchAction:"manipulation",flex:1,maxWidth:"120px"},children:"送出"})]})]}),O&&i.jsx("div",{style:{position:"fixed",left:0,top:0,width:"100vw",height:"100vh",background:"rgba(40,40,80,0.18)",zIndex:1e4,display:"flex",alignItems:"center",justifyContent:"center"},children:i.jsxs("div",{style:{background:"#fff",borderRadius:18,boxShadow:"0 4px 24px #6B5BFF33",padding:28,minWidth:280,maxWidth:340,width:"90vw",position:"relative",display:"flex",flexDirection:"column",gap:12},children:[i.jsx("button",{type:"button",onClick:()=>z(!1),style:{position:"absolute",top:10,right:12,background:"none",border:"none",fontSize:22,color:"#888",cursor:"pointer",fontWeight:700},children:"×"}),i.jsxs("div",{style:{fontWeight:800,fontSize:18,color:"#6B5BFF",textAlign:"center",marginBottom:2},children:["留言給：",t.nickname]}),i.jsx("textarea",{value:j,onChange:re=>K(re.target.value),rows:3,maxLength:100,placeholder:"請輸入留言...",style:{border:"1px solid #e0e7ff",borderRadius:8,padding:"6px 10px",fontSize:15,resize:"none"}}),i.jsx("button",{onClick:async()=>{z(!1);try{await fetch("/api/send-message",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:j,toUid:t.uid,toEmail:t.email,toNickname:t.nickname,fromUid:window.currentUserUid||"",fromEmail:window.currentUserEmail||"",fromNickname:window.currentUserNickname||""})}),Y(!0),setTimeout(()=>Y(!1),1500)}catch{alert("留言發送失敗，請稍後再試")}},style:{background:"linear-gradient(90deg, #6e8efb, #a777e3)",color:"#fff",border:"none",borderRadius:14,padding:"6px 18px",fontWeight:700,fontSize:15,cursor:"pointer",alignSelf:"center"},children:"送出留言"})]})}),Z&&i.jsx("div",{style:{position:"fixed",left:0,top:0,width:"100vw",height:"100vh",background:"rgba(40,40,80,0.08)",zIndex:10001,display:"flex",alignItems:"center",justifyContent:"center"},children:i.jsx("div",{style:{background:"#fff",borderRadius:14,boxShadow:"0 2px 12px #ffb74d55",padding:"18px 32px",fontWeight:700,color:"#ff4d4f",fontSize:18},children:"需求已成功送出！"})})]})})}function D3(){var De,tt,Ye,We;const{lang:n}=Bt(),e=F3(n),t=pe=>{var we;const Se={"zh-TW":{title:"互相幫助&合作實驗室",provide:"提供幫助",supply:"供應圈",need:"需要幫助",room:"互助房",intro:"在重啟的路上，我們都需要彼此的支持。請選擇你想要參與的方式：",introNeed:"如果你正在經歷困難，請告訴我們，社群夥伴會主動協助你。",needBtn:"我需要幫助",rule:"※ 所有資訊僅供社群內部交流使用，請尊重彼此隱私",msgTo:"留言給：",msgPlaceholder:"請輸入留言...",msgSent:"留言發送成功！",backToHome:"返回首頁",back:"返回",date:"日期",avatar:"頭像",name:"名稱",gender:"性別",age:"年齡",country:"國家"},"zh-CN":{title:"互相帮助&合作实验室",provide:"提供帮助",supply:"供应圈",need:"需要帮助",room:"互助房",intro:"在重启的路上，我们都需要彼此的支持。请选择你想要参与的方式：",introNeed:"如果你正在经历困难，请告诉我们，社群伙伴会主动协助你。",needBtn:"我需要帮助",rule:"※ 所有信息仅供社群内部交流使用，请尊重彼此隐私",msgTo:"留言给：",msgPlaceholder:"请输入留言...",msgSent:"留言发送成功！",backToHome:"返回首页",back:"返回",date:"日期",avatar:"头像",name:"名称",gender:"性别",age:"年龄",country:"国家"},en:{title:"Mutual Help & Cooperation Laboratory",provide:"Provide Help",supply:"Supply Circle",need:"Need Help",room:"Mutual Aid Room",intro:"On the restart journey, we all need each other's support. Please choose how you want to participate:",introNeed:"If you are experiencing difficulties, please tell us, and community partners will actively assist you.",needBtn:"I Need Help",rule:"※ All information is for internal community communication only, please respect each other's privacy",msgTo:"Message to:",msgPlaceholder:"Please enter message...",msgSent:"Message sent successfully!",backToHome:"Back to Home",back:"Back",date:"Date",avatar:"Avatar",name:"Name",gender:"Gender",age:"Age",country:"Country"},ja:{title:"相互支援&協力実験室",provide:"支援を提供",supply:"供給サークル",need:"支援が必要",room:"相互扶助の部屋",intro:"再出発の道のりで、私たちは皆お互いのサポートが必要です。参加したい方法を選択してください：",introNeed:"困難を経験している場合は、お知らせください。コミュニティのパートナーが積極的にサポートします。",needBtn:"支援が必要です",rule:"※ すべての情報はコミュニティ内の交流のみに使用され、お互いのプライバシーを尊重してください",msgTo:"メッセージを送る：",msgPlaceholder:"メッセージを入力してください...",msgSent:"メッセージが正常に送信されました！",backToHome:"ホームへ戻る",back:"戻る",date:"日付",avatar:"アバター",name:"名前",gender:"性別",age:"年齢",country:"国"},ko:{title:"상호 도움&협력 실험실",provide:"도움 제공",supply:"공급 서클",need:"도움 필요",room:"상호 원조 방",intro:"재시작 여정에서 우리 모두는 서로의 지원이 필요합니다. 참여하고 싶은 방법을 선택하세요:",introNeed:"어려움을 겪고 있다면 알려주세요. 커뮤니티 파트너가 적극적으로 도와드릴 것입니다.",needBtn:"도움이 필요합니다",rule:"※ 모든 정보는 커뮤니티 내부 교류용으로만 사용되며, 서로의 개인정보를 존중해 주세요",msgTo:"메시지 보내기:",msgPlaceholder:"메시지를 입력하세요...",msgSent:"메시지가 성공적으로 전송되었습니다!",backToHome:"홈으로 돌아가기",back:"돌아가기",date:"날짜",avatar:"아바타",name:"이름",gender:"성별",age:"나이",country:"국가"},vi:{title:"Phòng thí nghiệm trợ giúp",provide:"Cung cấp trợ giúp",supply:"Vòng tròn cung cấp",need:"Cần trợ giúp",room:"Phòng hỗ trợ lẫn nhau",intro:"Trên hành trình khởi động lại, tất cả chúng ta đều cần sự hỗ trợ của nhau. Vui lòng chọn cách bạn muốn tham gia:",introNeed:"Nếu bạn đang gặp khó khăn, hãy cho chúng tôi biết, các đối tác cộng đồng sẽ tích cực hỗ trợ bạn.",needBtn:"Tôi cần trợ giúp",rule:"※ Tất cả thông tin chỉ dành cho giao tiếp nội bộ cộng đồng, vui lòng tôn trọng quyền riêng tư của nhau",msgTo:"Nhắn tin cho:",msgPlaceholder:"Vui lòng nhập tin nhắn...",msgSent:"Tin nhắn đã được gửi thành công!",backToHome:"Về trang chủ",back:"Quay lại",date:"Ngày",avatar:"Ảnh đại diện",name:"Tên",gender:"Giới tính",age:"Tuổi",country:"Quốc gia"},th:{title:"ห้องทดลองช่วยเหลือ",provide:"ให้ความช่วยเหลือ",supply:"วงกลมอุปทาน",need:"ต้องการความช่วยเหลือ",room:"ห้องช่วยเหลือซึ่งกันและกัน",intro:"ในการเดินทางเริ่มต้นใหม่ เราทุกคนต้องการการสนับสนุนจากกันและกัน กรุณาเลือกวิธีที่คุณต้องการมีส่วนร่วม:",introNeed:"หากคุณกำลังประสบความยากลำบาก กรุณาบอกเรา คู่ค้าชุมชนจะช่วยเหลือคุณอย่างกระตือรือร้น",needBtn:"ฉันต้องการความช่วยเหลือ",rule:"※ ข้อมูลทั้งหมดใช้สำหรับการสื่อสารภายในชุมชนเท่านั้น กรุณาเคารพความเป็นส่วนตัวของกันและกัน",msgTo:"ส่งข้อความถึง:",msgPlaceholder:"กรุณาป้อนข้อความ...",msgSent:"ส่งข้อความสำเร็จแล้ว!",backToHome:"กลับหน้าหลัก",back:"กลับ",date:"วันที่",avatar:"รูปโปรไฟล์",name:"ชื่อ",gender:"เพศ",age:"อายุ",country:"ประเทศ"},ms:{title:"Makmal Bantuan & Kerjasama Bersama",provide:"Sediakan Bantuan",supply:"Bulatan Bekalan",need:"Memerlukan Bantuan",room:"Bilik Bantuan Bersama",intro:"Dalam perjalanan memulakan semula, kita semua memerlukan sokongan antara satu sama lain. Sila pilih cara anda ingin mengambil bahagian:",introNeed:"Jika anda menghadapi kesukaran, sila beritahu kami, rakan kongsi komuniti akan membantu anda secara aktif.",needBtn:"Saya Memerlukan Bantuan",rule:"※ Semua maklumat adalah untuk komunikasi dalaman komuniti sahaja, sila hormati privasi antara satu sama lain",msgTo:"Mesej kepada:",msgPlaceholder:"Sila masukkan mesej...",msgSent:"Mesej berjaya dihantar!",backToHome:"Kembali ke Laman Utama",back:"Kembali",date:"Tarikh",avatar:"Avatar",name:"Nama",gender:"Jantina",age:"Umur",country:"Negara"},la:{title:"Laboratorium Auxilii",provide:"Praebere Auxilium",supply:"Copiae Circulus",need:"Egere Auxilii",room:"Mutuum Auxilium Cubiculum",intro:"In itinere redintegrationis, omnes indigemus sustentatione mutua. Quaeso elige quomodo participare vis:",introNeed:"Si difficultates patieris, quaeso nobis dic, socii communitatis te active adiuvabunt.",needBtn:"Egeo Auxilii",rule:"※ Omnia notitia ad communicationem internam communitatis tantum sunt, quaeso honora privaciam inter se",msgTo:"Nuntius ad:",msgPlaceholder:"Quaeso intra nuntium...",msgSent:"Nuntius feliciter missus est!",backToHome:"Ad domum redire",back:"Redire",date:"Dies",avatar:"Imago",name:"Nomen",gender:"Sexus",age:"Aetas",country:"Patria"}};return((we=Se[n])==null?void 0:we[pe])||Se["zh-TW"][pe]||pe},[r,s]=w.useState(!1),[a,c]=w.useState({avatarUrl:"/ctx-logo.png",nickname:"",email:"",country:"",gender:"",age:""}),[d,h]=w.useState("provide"),[m,g]=w.useState([]),[x,S]=w.useState(null),_=gt(Do).currentUser,[R,T]=w.useState(""),[A,D]=w.useState(!1),[F,X]=w.useState(null),[ie,G]=w.useState(""),[N,E]=w.useState(!1),[P,M]=w.useState(!1),[O,z]=w.useState([]),[j,K]=w.useState(""),[Z,Y]=w.useState(!1),[ae,se]=w.useState(!1),[re,ne]=w.useState([]),[W,$]=w.useState(!1),[ee,he]=w.useState({});w.useEffect(()=>{if(!_)return;(async()=>{try{const Se=await Io(Gn(Ft,"profiles",_.uid)),we=Se.exists()?Se.data():{};let Re=!1;const Ce={};if(we.country||(Ce.country="台灣",Re=!0),we.gender||(Ce.gender="男",Re=!0),we.age||(Ce.age="30",Re=!0),Re){const{setDoc:U}=await cd(async()=>{const{setDoc:oe}=await Promise.resolve().then(()=>Jp);return{setDoc:oe}},void 0);await U(Gn(Ft,"profiles",_.uid),{...we,...Ce},{merge:!0});const V=await Io(Gn(Ft,"profiles",_.uid)),L=V.exists()?V.data():{};c({avatarUrl:L.avatar||_.photoURL||"/ctx-logo.png",nickname:L.nickname||_.displayName||"Restarter",email:L.email||_.email||"",country:L.country||"",gender:L.gender||"",age:L.age||""});return}c({avatarUrl:we.avatar||_.photoURL||"/ctx-logo.png",nickname:we.nickname||_.displayName||"Restarter",email:we.email||_.email||"",country:we.country||"",gender:we.gender||"",age:we.age||""})}catch{c({avatarUrl:_.photoURL||"/ctx-logo.png",nickname:_.displayName||"Restarter",email:_.email||"",country:"",gender:"",age:""})}})()},[_]);async function _e(pe){try{if(console.log("開始保存提供幫助數據:",pe),console.log("用戶信息:",a),console.log("當前用戶:",_),!_){console.error("用戶未登入"),T("❌ 請先登入後再送出"),setTimeout(()=>T(""),3e3);return}const Se=await go(kn(Ft,"helpSupplies"),{...pe,type:"provide",avatarUrl:a.avatarUrl,nickname:a.nickname,email:a.email,country:a.country,gender:a.gender,age:a.age,createdAt:Lt.now(),uid:(_==null?void 0:_.uid)||""});console.log("數據保存成功，文檔ID:",Se.id),s(!1),T("🎉 已成功送出，感謝你的溫暖分享！"),setTimeout(()=>T(""),3e3),ve()}catch(Se){console.error("保存提供幫助數據失敗:",Se),T("❌ 保存失敗，請稍後再試"),setTimeout(()=>T(""),3e3)}}async function ve(){try{console.log("開始獲取供應圈列表");const pe=cr(kn(Ft,"helpSupplies"),Tn("type","==","provide")),Re=(await Dr(pe)).docs.map(Ce=>({id:Ce.id,...Ce.data()})).sort((Ce,U)=>{var oe,H,J,be;const V=((H=(oe=Ce.createdAt)==null?void 0:oe.toDate)==null?void 0:H.call(oe))||new Date(Ce.createdAt);return(((be=(J=U.createdAt)==null?void 0:J.toDate)==null?void 0:be.call(J))||new Date(U.createdAt))-V});console.log("獲取到的供應圈數據:",Re),g(Re)}catch(pe){console.error("獲取供應圈列表失敗:",pe),T("❌ 獲取數據失敗，請稍後再試"),setTimeout(()=>T(""),3e3)}}w.useEffect(()=>{d==="supply"&&ve()},[d]);async function Le(pe,Se){if(console.log("留言送出偵錯：",{user:_,fromUid:_==null?void 0:_.uid,toUid:pe==null?void 0:pe.uid,fromEmail:_==null?void 0:_.email,toEmail:pe==null?void 0:pe.email,content:Se}),!_){K("偵錯：user 為 null，請確認已登入");return}if(!_.uid){K("偵錯：user.uid 為空");return}if(!(pe!=null&&pe.uid)){K("偵錯：toUser.uid 為空");return}if(!Se.trim()){K("請輸入留言內容");return}Y(!0),K("");try{await go(kn(Ft,"messages"),{toUid:pe.uid,toEmail:pe.email,toNickname:pe.nickname,fromUid:_.uid,fromEmail:_.email,fromNickname:a.nickname,content:Se,timestamp:Lt.now(),read:!1}),E(!0),setTimeout(()=>{D(!1),E(!1),G("")},1500)}catch(we){K("留言發送失敗，請稍後再試 (偵錯: "+((we==null?void 0:we.message)||we)+")")}finally{Y(!1)}}async function Ne(){if(!_)return;const pe=cr(kn(Ft,"messages"),Tn("toUid","==",_.uid),Tn("read","==",!1)),Se=await Dr(pe);z(Se.docs.map(we=>({id:we.id,...we.data()})))}w.useEffect(()=>{Ne()},[_,P]);async function nt(pe){await Yp(Gn(Ft,"messages",pe),{read:!0}),Ne()}async function Je(pe){try{if(console.log("開始保存需要幫助數據:",pe),console.log("用戶信息:",a),console.log("當前用戶:",_),!_){console.error("用戶未登入"),T("❌ 請先登入後再送出"),setTimeout(()=>T(""),3e3);return}const Se=await go(kn(Ft,"helpSupplies"),{...pe,type:"need",avatarUrl:a.avatarUrl,nickname:a.nickname,email:a.email,country:a.country,gender:a.gender,age:a.age,createdAt:Lt.now(),uid:(_==null?void 0:_.uid)||""});console.log("數據保存成功，文檔ID:",Se.id),$(!0),setTimeout(()=>{$(!1),se(!1)},1800),T("🎉 你的需求已送出，社群夥伴會看到！"),setTimeout(()=>T(""),3e3),ge()}catch(Se){console.error("保存需要幫助數據失敗:",Se),T("❌ 保存失敗，請稍後再試"),setTimeout(()=>T(""),3e3)}}async function ge(){try{console.log("開始獲取需要幫助列表");const pe=cr(kn(Ft,"helpSupplies"),Tn("type","==","need")),Re=(await Dr(pe)).docs.map(Ce=>({id:Ce.id,...Ce.data()})).sort((Ce,U)=>{var oe,H,J,be;const V=((H=(oe=Ce.createdAt)==null?void 0:oe.toDate)==null?void 0:H.call(oe))||new Date(Ce.createdAt);return(((be=(J=U.createdAt)==null?void 0:J.toDate)==null?void 0:be.call(J))||new Date(U.createdAt))-V});console.log("獲取到的需要幫助數據:",Re),ne(Re)}catch(pe){console.error("獲取需要幫助列表失敗:",pe),T("❌ 獲取數據失敗，請稍後再試"),setTimeout(()=>T(""),3e3)}}return w.useEffect(()=>{d==="room"&&ge()},[d]),i.jsxs("div",{style:{minHeight:"100vh",background:"linear-gradient(135deg, #f8fafc 0%, #e0e7ff 100%)",padding:"0 0 48px 0",position:"relative"},children:[P&&i.jsxs(i.Fragment,{children:[i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.3)",zIndex:1e4},onClick:()=>M(!1)}),i.jsxs("div",{style:{position:"fixed",top:70,right:36,background:"#fff",borderRadius:18,boxShadow:"0 4px 24px #6B5BFF33",padding:24,minWidth:320,zIndex:10001},children:[i.jsx("div",{style:{fontWeight:900,fontSize:20,color:"#6B5BFF",marginBottom:12},children:((tt=(De=Ht[n])==null?void 0:De.messages)==null?void 0:tt.inboxTitle)||"站內訊息"}),O.length===0&&i.jsx("div",{style:{color:"#888",fontSize:15},children:((We=(Ye=Ht[n])==null?void 0:Ye.messages)==null?void 0:We.noMessages)||"目前沒有新訊息"}),O.map(pe=>{var Se,we,Re,Ce,U,V,L,oe,H,J;return i.jsxs("div",{style:{background:"#f7f7ff",borderRadius:12,padding:12,marginBottom:12,boxShadow:"0 2px 8px #6B5BFF11",cursor:"pointer"},onClick:()=>{he(be=>({...be,[pe.id]:!be[pe.id]}))},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[i.jsxs("div",{style:{fontWeight:700,color:"#1976d2"},children:[pe.fromNickname," ",((we=(Se=Ht[n])==null?void 0:Se.messages)==null?void 0:we.messageFrom)||"給你的留言："]}),i.jsx("span",{style:{fontSize:12,color:"#888"},children:ee[pe.id]?"收起":"展開"})]}),ee[pe.id]&&i.jsxs("div",{style:{background:"rgba(255,255,255,0.8)",borderRadius:8,padding:12,marginBottom:8,border:"1px solid #e0e7ff"},children:[i.jsx("div",{style:{color:"#232946",marginBottom:8,lineHeight:"1.5"},children:pe.content}),i.jsx("div",{style:{color:"#888",fontSize:13,marginBottom:8},children:(V=(Ce=(Re=pe.timestamp)==null?void 0:Re.toDate)==null?void 0:(U=Ce.call(Re)).toLocaleString)==null?void 0:V.call(U)}),i.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:[i.jsx("a",{href:`mailto:${pe.fromEmail}`,style:{color:"#6B5BFF",fontWeight:700,textDecoration:"underline",fontSize:13},children:((oe=(L=Ht[n])==null?void 0:L.messages)==null?void 0:oe.contactUser)||"聯絡對方"}),i.jsx("button",{onClick:be=>{be.stopPropagation(),nt(pe.id)},style:{background:"#eee",color:"#6B5BFF",border:"none",borderRadius:6,padding:"4px 12px",fontWeight:700,fontSize:13,cursor:"pointer"},children:((J=(H=Ht[n])==null?void 0:H.messages)==null?void 0:J.markRead)||"標記已讀"})]})]}),!ee[pe.id]&&i.jsx("div",{style:{color:"#666",fontSize:14,fontStyle:"italic"},children:pe.content.length>30?`${pe.content.substring(0,30)}...`:pe.content})]},pe.id)})]})]}),R&&i.jsx("div",{style:{position:"fixed",top:40,left:"50%",transform:"translateX(-50%)",background:"#fff",color:"#6B5BFF",fontWeight:700,fontSize:18,borderRadius:16,boxShadow:"0 4px 24px #6B5BFF22",padding:"18px 36px",zIndex:99999,textAlign:"center",letterSpacing:1},children:R}),i.jsx("button",{onClick:()=>window.location.href="/",style:{position:"absolute",top:"20px",left:"20px",zIndex:1e3,fontWeight:700,fontSize:16,padding:"8px 16px",borderRadius:8,border:"1.5px solid #6B5BFF",background:"#fff",color:"#6B5BFF",cursor:"pointer",minWidth:80,boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:t("back")}),i.jsx("div",{style:{width:"100%",maxWidth:700,margin:"20px auto 20px auto",padding:"16px 24px",background:"rgba(255,255,255,0.95)",borderRadius:16,boxShadow:"0 4px 20px rgba(0,0,0,0.1)",display:"flex",alignItems:"center",justifyContent:"center",position:"relative"},children:i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,justifyContent:"center"},children:[i.jsxs("h1",{style:{fontWeight:900,fontSize:18,color:"#6B5BFF",margin:0,lineHeight:1,textShadow:"0 2px 8px #6B5BFF88",textAlign:"center"},children:[i.jsx("span",{role:"img","aria-label":"helplab",children:"🧪"})," ",t("title")]}),i.jsxs("button",{onClick:()=>M(pe=>!pe),style:{background:"none",border:"none",cursor:"pointer",position:"relative",padding:"8px",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",marginLeft:8},children:[i.jsx("span",{style:{fontSize:24,color:"#6B5BFF"},children:"🔔"}),O.length>0&&i.jsx("span",{style:{position:"absolute",top:0,right:0,minWidth:18,height:18,background:"#ff4d4f",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",border:"2px solid #fff",color:"#fff",fontWeight:900,fontSize:13,padding:"0 5px",boxShadow:"0 2px 8px #ff4d4f88",zIndex:1},children:O.length})]})]})}),i.jsxs("div",{style:{maxWidth:600,margin:"0 auto",padding:"20px 16px 0 16px",background:"#fff",borderRadius:32,boxShadow:"0 8px 40px #b6b6f633, 0 1.5px 8px #6B5BFF22",border:"1.5px solid #e0e7ff"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:24,marginBottom:24},children:[i.jsx("button",{onClick:()=>h("provide"),style:{fontWeight:900,fontSize:18,color:d==="provide"?"#6B5BFF":"#888",background:"#fff",border:d==="provide"?"3px solid #6B5BFF":"2px solid #e0e7ff",borderRadius:16,boxShadow:"0 2px 8px #b6b6f633",padding:"8px 24px",cursor:"pointer",marginBottom:2},children:t("provide")}),i.jsx("button",{onClick:()=>h("supply"),style:{fontWeight:900,fontSize:18,color:d==="supply"?"#6B5BFF":"#888",background:"#fff",border:d==="supply"?"3px solid #6B5BFF":"2px solid #e0e7ff",borderRadius:16,boxShadow:"0 2px 8px #b6b6f633",padding:"8px 24px",cursor:"pointer",marginBottom:2},children:t("supply")}),i.jsx("button",{onClick:()=>h("need"),style:{fontWeight:900,fontSize:18,color:d==="need"?"#ff4d4f":"#888",background:"#fff",border:d==="need"?"3px solid #ff4d4f":"2px solid #e0e7ff",borderRadius:16,boxShadow:"0 2px 8px #ffb74d55",padding:"8px 24px",cursor:"pointer",marginBottom:2},children:t("need")}),i.jsx("button",{onClick:()=>h("room"),style:{fontWeight:900,fontSize:18,color:d==="room"?"#ff4d4f":"#888",background:"#fff",border:d==="room"?"3px solid #ff4d4f":"2px solid #e0e7ff",borderRadius:16,boxShadow:"0 2px 8px #ffb74d55",padding:"8px 24px",cursor:"pointer",marginBottom:2},children:t("room")})]}),d==="provide"&&i.jsxs(i.Fragment,{children:[i.jsx("p",{style:{textAlign:"center",color:"#555",fontSize:18,marginBottom:36},children:t("intro")}),i.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:32,justifyContent:"center"},children:e.map((pe,Se)=>i.jsxs("div",{style:{background:pe.color,borderRadius:20,boxShadow:"0 4px 24px #0001",padding:"32px 28px",minWidth:260,maxWidth:320,flex:"1 1 260px",display:"flex",flexDirection:"column",alignItems:"center",marginBottom:12},children:[i.jsx("div",{style:{fontSize:48,marginBottom:12},children:pe.emoji}),i.jsx("div",{style:{fontWeight:800,fontSize:22,marginBottom:8,color:"#333",letterSpacing:1},children:pe.title}),i.jsx("div",{style:{color:"#666",fontSize:15,marginBottom:18,textAlign:"center",minHeight:44},children:pe.desc}),Se===0?i.jsx("button",{onClick:()=>{h("provide"),s(!0)},style:{background:"linear-gradient(90deg, #6e8efb, #a777e3)",color:"#fff",border:"none",borderRadius:24,padding:"10px 28px",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:"0 2px 8px #a777e355",marginTop:"auto",transition:"background 0.2s"},children:pe.btn}):Se===1?i.jsx("button",{onClick:()=>{h("need"),se(!0)},style:{background:"linear-gradient(90deg, #ff4d4f, #ffb74d)",color:"#fff",border:"none",borderRadius:24,padding:"10px 28px",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:"0 2px 8px #ffb74d55",marginTop:"auto",transition:"background 0.2s"},children:pe.btn}):Se===2?i.jsx("button",{onClick:()=>h("supply"),style:{background:"linear-gradient(90deg, #6e8efb, #a777e3)",color:"#fff",border:"none",borderRadius:24,padding:"10px 28px",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:"0 2px 8px #a777e355",marginTop:"auto",transition:"background 0.2s"},children:pe.btn}):i.jsx("button",{onClick:()=>h("room"),style:{background:"linear-gradient(90deg, #ff4d4f, #ffb74d)",color:"#fff",border:"none",borderRadius:24,padding:"10px 28px",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:"0 2px 8px #ffb74d55",marginTop:"auto",transition:"background 0.2s"},children:pe.btn})]},Se))}),i.jsx("div",{style:{textAlign:"center",color:"#888",fontSize:15,marginTop:40},children:t("rule")}),i.jsx(N3,{open:r,onClose:()=>s(!1),userInfo:a,onSubmit:_e})]}),d==="supply"&&i.jsx("div",{style:{marginTop:24},children:i.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:15,tableLayout:"fixed"},children:[i.jsxs("colgroup",{children:[i.jsx("col",{style:{width:"28%"}}),i.jsx("col",{style:{width:"14%"}}),i.jsx("col",{style:{width:"22%"}}),i.jsx("col",{style:{width:"12%"}}),i.jsx("col",{style:{width:"12%"}}),i.jsx("col",{style:{width:"12%"}})]}),i.jsx("thead",{children:i.jsxs("tr",{style:{background:"#f3f3ff",color:"#6B5BFF"},children:[i.jsx("th",{style:{padding:"8px 4px",textAlign:"left"},children:t("date")}),i.jsx("th",{style:{textAlign:"center"},children:t("avatar")}),i.jsx("th",{style:{textAlign:"left"},children:t("name")}),i.jsx("th",{style:{textAlign:"center"},children:t("gender")}),i.jsx("th",{style:{textAlign:"center"},children:t("age")}),i.jsx("th",{style:{textAlign:"center"},children:t("country")})]})}),i.jsx("tbody",{children:m.map((pe,Se)=>{var we,Re,Ce,U;return i.jsxs(_n.Fragment,{children:[i.jsxs("tr",{style:{cursor:"pointer",borderBottom:"1px solid #eee"},onClick:()=>S(x===Se?null:Se),children:[i.jsx("td",{children:((U=(Ce=(Re=(we=pe.createdAt)==null?void 0:we.toDate)==null?void 0:Re.call(we))==null?void 0:Ce.toLocaleString)==null?void 0:U.call(Ce))||""}),i.jsx("td",{children:i.jsx("img",{src:pe.avatarUrl||"/ctx-logo.png",alt:"avatar",style:{width:36,height:36,borderRadius:"50%"}})}),i.jsx("td",{style:{color:"#1976d2",fontWeight:700,textDecoration:"underline",cursor:"pointer"},onClick:()=>{X(pe),D(!0)},children:pe.nickname}),i.jsx("td",{children:pe.gender}),i.jsx("td",{children:pe.age}),i.jsx("td",{children:pe.country})]}),x===Se&&i.jsx("tr",{children:i.jsxs("td",{colSpan:6,style:{background:"#f8f8ff",padding:18},children:[i.jsx("div",{style:{fontWeight:700,color:"#6B5BFF",marginBottom:8},children:"【你的困難也是我們的困難，讓我們一起面對並解決】"}),i.jsxs("div",{style:{marginBottom:8},children:[i.jsx("b",{children:"經歷："}),(pe.exp||[]).join("、"),pe.expOther?`、${pe.expOther}`:""]}),i.jsxs("div",{style:{marginBottom:8},children:[i.jsx("b",{children:"優勢："}),(pe.adv||[]).join("、"),pe.advOther?`、${pe.advOther}`:""]}),i.jsxs("div",{style:{marginBottom:8},children:[i.jsx("b",{children:"優先幫助對象："}),(pe.target||[]).join("、"),pe.targetOther?`、${pe.targetOther}`:""]}),i.jsxs("div",{style:{marginBottom:8},children:[i.jsx("b",{children:"幫助形式："}),pe.helpType]}),i.jsxs("div",{style:{marginBottom:8},children:[i.jsx("b",{children:"特別聲明："}),pe.statement]}),i.jsxs("div",{style:{marginBottom:8},children:[i.jsx("b",{children:"幫助頻率："}),pe.freq,pe.freqOther?`、${pe.freqOther}`:""]}),i.jsx("div",{style:{marginTop:12},children:i.jsx("a",{href:`mailto:${pe.email}`,style:{color:"#6B5BFF",textDecoration:"underline",marginLeft:12},children:pe.email})})]})})]},pe.id)})})]})}),d==="need"&&i.jsxs(i.Fragment,{children:[i.jsx("p",{style:{textAlign:"center",color:"#555",fontSize:18,marginBottom:36},children:t("introNeed")}),i.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:32,justifyContent:"center"},children:i.jsx("button",{onClick:()=>se(!0),style:{background:"linear-gradient(90deg, #ff4d4f, #ffb74d)",color:"#fff",border:"none",borderRadius:24,padding:"10px 28px",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:"0 2px 8px #ffb74d55",marginTop:"auto",transition:"background 0.2s"},children:t("needBtn")})}),i.jsx(z3,{open:ae,onClose:()=>se(!1),userInfo:a,onSubmit:Je,showMsgSent:W})]}),d==="room"&&i.jsx("div",{style:{marginTop:24},children:i.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:15},children:[i.jsx("thead",{children:i.jsxs("tr",{style:{background:"#fff3e0",color:"#ff4d4f"},children:[i.jsx("th",{style:{padding:"8px 4px",textAlign:"left"},children:t("date")}),i.jsx("th",{style:{textAlign:"center"},children:t("avatar")}),i.jsx("th",{style:{textAlign:"left"},children:t("name")}),i.jsx("th",{style:{textAlign:"center"},children:t("gender")}),i.jsx("th",{style:{textAlign:"center"},children:t("age")}),i.jsx("th",{style:{textAlign:"center"},children:t("country")})]})}),i.jsx("tbody",{children:re.map((pe,Se)=>{var we,Re,Ce,U;return i.jsxs(_n.Fragment,{children:[i.jsxs("tr",{style:{cursor:"pointer",borderBottom:"1px solid #eee"},onClick:()=>S(x===Se?null:Se),children:[i.jsx("td",{children:((U=(Ce=(Re=(we=pe.createdAt)==null?void 0:we.toDate)==null?void 0:Re.call(we))==null?void 0:Ce.toLocaleString)==null?void 0:U.call(Ce))||""}),i.jsx("td",{children:i.jsx("img",{src:pe.avatarUrl||"/ctx-logo.png",alt:"avatar",style:{width:36,height:36,borderRadius:"50%"}})}),i.jsx("td",{style:{color:"#ff4d4f",fontWeight:700,textDecoration:"underline",cursor:"pointer"},onClick:()=>{X(pe),D(!0)},children:pe.nickname}),i.jsx("td",{children:pe.gender}),i.jsx("td",{children:pe.age}),i.jsx("td",{children:pe.country})]}),x===Se&&i.jsx("tr",{children:i.jsxs("td",{colSpan:6,style:{background:"#fff8f0",padding:18},children:[i.jsx("div",{style:{fontWeight:700,color:"#ff4d4f",marginBottom:8},children:"【你的困難我們一起面對，社群夥伴會主動協助你】"}),i.jsxs("div",{style:{marginBottom:8},children:[i.jsx("b",{children:"經歷："}),(pe.exp||[]).join("、"),pe.expOther?`、${pe.expOther}`:""]}),i.jsxs("div",{style:{marginBottom:8},children:[i.jsx("b",{children:"優勢："}),(pe.adv||[]).join("、"),pe.advOther?`、${pe.advOther}`:""]}),i.jsxs("div",{style:{marginBottom:8},children:[i.jsx("b",{children:"困難/需求："}),(pe.target||[]).join("、"),pe.targetOther?`、${pe.targetOther}`:""]}),i.jsxs("div",{style:{marginBottom:8},children:[i.jsx("b",{children:"協助形式："}),pe.helpType]}),i.jsxs("div",{style:{marginBottom:8},children:[i.jsx("b",{children:"補充說明："}),pe.statement]}),i.jsxs("div",{style:{marginBottom:8},children:[i.jsx("b",{children:"協助頻率："}),pe.freq,pe.freqOther?`、${pe.freqOther}`:""]}),i.jsx("div",{style:{marginTop:12},children:i.jsx("a",{href:`mailto:${pe.email}`,style:{color:"#ff4d4f",textDecoration:"underline",marginLeft:12},children:pe.email})})]})})]},pe.id)})})]})})]}),A&&F&&i.jsx("div",{style:{position:"fixed",left:0,top:0,width:"100vw",height:"100vh",background:"rgba(40,40,80,0.18)",zIndex:1e4,display:"flex",alignItems:"center",justifyContent:"center"},children:i.jsxs("div",{style:{background:"#fff",borderRadius:18,boxShadow:"0 4px 24px #6B5BFF33",padding:28,minWidth:280,maxWidth:340,width:"90vw",position:"relative",display:"flex",flexDirection:"column",gap:12},children:[i.jsx("button",{type:"button",onClick:()=>D(!1),style:{position:"absolute",top:10,right:12,background:"none",border:"none",fontSize:22,color:"#888",cursor:"pointer",fontWeight:700},children:"×"}),i.jsxs("div",{style:{fontWeight:800,fontSize:18,color:"#6B5BFF",textAlign:"center",marginBottom:2},children:[t("msgTo"),F.nickname]}),i.jsx("textarea",{value:ie,onChange:pe=>G(pe.target.value),rows:3,maxLength:100,placeholder:t("msgPlaceholder"),style:{border:"1px solid #e0e7ff",borderRadius:8,padding:"6px 10px",fontSize:15,resize:"none"}}),j&&i.jsx("div",{style:{color:"#ff4d4f",fontWeight:700,textAlign:"center",marginTop:4},children:j}),i.jsx("button",{onClick:()=>Le(F,ie),disabled:!ie.trim()||Z,style:{background:"linear-gradient(90deg, #6e8efb, #a777e3)",color:"#fff",border:"none",borderRadius:14,padding:"6px 18px",fontWeight:700,fontSize:15,cursor:!ie.trim()||Z?"not-allowed":"pointer",alignSelf:"center",opacity:!ie.trim()||Z?.6:1},children:Z?"送出中...":"送出留言"}),N&&i.jsx("div",{style:{color:"#6B5BFF",fontWeight:700,textAlign:"center",marginTop:8},children:t("msgSent")})]})}),i.jsx(Ln,{})]})}const zd=(n,e)=>{try{localStorage.setItem(`emotionRelease_${n}`,JSON.stringify(e))}catch{console.log("無法保存遊戲進度到本地存儲")}},Dd=n=>{try{const e=localStorage.getItem(`emotionRelease_${n}`);return e?JSON.parse(e):null}catch{return console.log("無法從本地存儲載入遊戲進度"),null}};function M3(){const{lang:n}=Bt(),[e,t]=w.useState(null),[r,s]=w.useState(!1);w.useEffect(()=>{const h=new Image;h.onload=()=>s(!0),h.onerror=()=>s(!0);const m=setTimeout(()=>{s(!0)},3e3);return h.src="/stress.png",()=>clearTimeout(m)},[]);const a=h=>{var g;const m={"zh-TW":{title:"情緒發洩區",subtitle:"選擇適合的遊戲來釋放你的情緒",farm:"生活農場",farmDesc:"點擊種植，感受成長的喜悅",whackAMole:"打地鼠",whackAMoleDesc:"快速點擊，釋放壓力",fruitPicking:"採水果",fruitPickingDesc:"點擊收集，享受豐收",targetShooting:"情緒泡泡爆破",targetShootingDesc:"戳破情緒泡泡，釋放內心壓力",racing:"極速賽車",racingDesc:"駕駛賽車，體驗速度與激情",rhythm:"音樂節奏",rhythmDesc:"跟隨節奏，釋放音樂能量",rules:"遊戲規則",back:"返回",start:"開始遊戲",close:"關閉"},"zh-CN":{title:"情绪发泄区",subtitle:"选择适合的游戏来释放你的情绪",farm:"生活农场",farmDesc:"点击种植，感受成长的喜悦",whackAMole:"打地鼠",whackAMoleDesc:"快速点击，释放压力",fruitPicking:"采水果",fruitPickingDesc:"点击收集，享受丰收",targetShooting:"飞靶射击",targetShootingDesc:"瞄准射击，提升专注力",racing:"极速赛车",racingDesc:"驾驶赛车，体验速度与激情",rhythm:"音乐节奏",rhythmDesc:"跟随节奏，释放音乐能量",rules:"游戏规则",back:"返回",start:"开始游戏",close:"关闭"},en:{title:"Emotion Release Zone",subtitle:"Choose a game to release your emotions",farm:"Life Farm",farmDesc:"Click to plant, feel the joy of growth",whackAMole:"Whack-a-Mole",whackAMoleDesc:"Quick clicks to release stress",fruitPicking:"Fruit Picking",fruitPickingDesc:"Click to collect, enjoy the harvest",targetShooting:"Target Shooting",targetShootingDesc:"Aim and shoot, improve focus",racing:"Speed Racing",racingDesc:"Drive racing cars, experience speed and excitement",rhythm:"Music Rhythm",rhythmDesc:"Follow the rhythm, release musical energy",rules:"Game Rules",back:"Back",start:"Start Game",close:"Close"},ja:{title:"感情発散エリア",subtitle:"感情を解放するゲームを選択してください",farm:"ライフファーム",farmDesc:"クリックして植える、成長の喜びを感じる",whackAMole:"モグラたたき",whackAMoleDesc:"素早くクリックしてストレスを解放",fruitPicking:"フルーツ収穫",fruitPickingDesc:"クリックして収穫、収穫を楽しむ",targetShooting:"ターゲット射撃",targetShootingDesc:"狙って撃つ、集中力を向上",racing:"スピードレーシング",racingDesc:"レーシングカーを運転、スピードと興奮を体験",rhythm:"音楽リズム",rhythmDesc:"リズムに合わせて、音楽エネルギーを解放",rules:"ゲームルール",back:"戻る",start:"ゲーム開始",close:"閉じる"},ko:{title:"감정 발산 구역",subtitle:"감정을 해방할 게임을 선택하세요",farm:"라이프 팜",farmDesc:"클릭하여 심고, 성장의 기쁨을 느끼세요",whackAMole:"두더지 잡기",whackAMoleDesc:"빠르게 클릭하여 스트레스를 해방하세요",fruitPicking:"과일 수확",fruitPickingDesc:"클릭하여 수확하고, 수확의 기쁨을 누리세요",targetShooting:"타겟 사격",targetShootingDesc:"조준하고 쏘기, 집중력 향상",racing:"스피드 레이싱",racingDesc:"레이싱카 운전, 속도와 흥분을 경험",rhythm:"음악 리듬",rhythmDesc:"리듬에 맞춰 음악 에너지를 해방",rules:"게임 규칙",back:"돌아가기",start:"게임 시작",close:"닫기"},vi:{title:"Khu Vực Giải Tỏa Cảm Xúc",subtitle:"Chọn trò chơi để giải tỏa cảm xúc của bạn",farm:"Nông Trại Cuộc Sống",farmDesc:"Nhấp để trồng, cảm nhận niềm vui của sự phát triển",whackAMole:"Đập Chuột",whackAMoleDesc:"Nhấp nhanh để giải tỏa căng thẳng",fruitPicking:"Hái Trái Cây",fruitPickingDesc:"Nhấp để thu hoạch, tận hưởng mùa màng",targetShooting:"Bắn Bia",targetShootingDesc:"Nhắm và bắn, cải thiện sự tập trung",racing:"Đua Xe Tốc Độ",racingDesc:"Lái xe đua, trải nghiệm tốc độ và sự phấn khích",rhythm:"Nhịp Điệu Âm Nhạc",rhythmDesc:"Theo nhịp điệu, giải phóng năng lượng âm nhạc",rules:"Luật Chơi",back:"Quay Lại",start:"Bắt Đầu Trò Chơi",close:"Đóng"},th:{title:"พื้นที่ระบายอารมณ์",subtitle:"เลือกเกมเพื่อระบายอารมณ์ของคุณ",farm:"ฟาร์มชีวิต",farmDesc:"คลิกเพื่อปลูก รู้สึกถึงความสุขของการเติบโต",whackAMole:"ตีตุ่น",whackAMoleDesc:"คลิกเร็วเพื่อระบายความเครียด",fruitPicking:"เก็บผลไม้",fruitPickingDesc:"คลิกเพื่อเก็บเกี่ยว สนุกกับการเก็บเกี่ยว",targetShooting:"ยิงเป้า",targetShootingDesc:"เล็งและยิง ปรับปรุงสมาธิ",racing:"แข่งรถความเร็ว",racingDesc:"ขับรถแข่ง ประสบการณ์ความเร็วและความตื่นเต้น",rhythm:"จังหวะดนตรี",rhythmDesc:"ตามจังหวะ ปลดปล่อยพลังงานดนตรี",rules:"กฎเกม",back:"กลับ",start:"เริ่มเกม",close:"ปิด"},la:{title:"Zona Emotio Liberationis",subtitle:"Elige ludum ad liberationem emotionum tuarum",farm:"Villa Vitae",farmDesc:"Clicca ad plantandum, senti gaudium incrementi",whackAMole:"Talpa Percutere",whackAMoleDesc:"Clicca celeriter ad liberationem tensionis",fruitPicking:"Fructus Colligere",fruitPickingDesc:"Clicca ad colligendum, fruere messe",targetShooting:"Scopum Iaculare",targetShootingDesc:"Intende et iacula, meliora attentionem",racing:"Cursus Velocitatis",racingDesc:"Guberna currus cursus, experire velocitatem et excitationem",rhythm:"Rhythmus Musicae",rhythmDesc:"Sequere rhythmum, libera energiam musicam",rules:"Regulae Ludi",back:"Regredi",start:"Ludum Incipere",close:"Claudere"},ms:{title:"Zon Pelepasan Emosi",subtitle:"Pilih permainan untuk melepaskan emosi anda",farm:"Ladang Kehidupan",farmDesc:"Klik untuk menanam, rasakan kegembiraan pertumbuhan",whackAMole:"Pukul Tikus",whackAMoleDesc:"Klik pantas untuk melepaskan tekanan",fruitPicking:"Kutip Buah",fruitPickingDesc:"Klik untuk mengutip, nikmati hasil tuaian",targetShooting:"Tembak Sasaran",targetShootingDesc:"Arah dan tembak, tingkatkan fokus",racing:"Lumba Kereta Laju",racingDesc:"Pandu kereta lumba, alami kelajuan dan keseronokan",rhythm:"Irama Muzik",rhythmDesc:"Ikut irama, lepaskan tenaga muzik",rules:"Peraturan Permainan",back:"Kembali",start:"Mulakan Permainan",close:"Tutup"}};return((g=m[n])==null?void 0:g[h])||m["zh-TW"][h]||h},c=[{id:"farm",title:a("farm"),description:a("farmDesc"),icon:"🌱",color:"#4CAF50"},{id:"whackAMole",title:a("whackAMole"),description:a("whackAMoleDesc"),icon:"🔨",color:"#FF5722"},{id:"fruitPicking",title:a("fruitPicking"),description:a("fruitPickingDesc"),icon:"🍎",color:"#FF9800"},{id:"targetShooting",title:a("targetShooting"),description:a("targetShootingDesc"),icon:"🫧",color:"#9C27B0"},{id:"racing",title:a("racing"),description:a("racingDesc"),icon:"🏎️",color:"#E91E63"},{id:"rhythm",title:a("rhythm"),description:a("rhythmDesc"),icon:"🎵",color:"#00BCD4"}],d=()=>{switch(e){case"farm":return i.jsx(L3,{onClose:()=>t(null)});case"whackAMole":return i.jsx(O3,{onClose:()=>t(null)});case"fruitPicking":return i.jsx(V3,{onClose:()=>t(null)});case"targetShooting":return i.jsx(W3,{onClose:()=>t(null)});case"racing":return i.jsx(U3,{onClose:()=>t(null)});case"rhythm":return i.jsx(q3,{onClose:()=>t(null)});default:return null}};return i.jsxs("div",{style:{minHeight:"100vh",background:r?"linear-gradient(135deg, rgba(102, 126, 234, 0.8) 0%, rgba(118, 75, 162, 0.8) 100%), url('/stress.png')":"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat",padding:"clamp(10px, 2vw, 20px)",fontFamily:"Arial, sans-serif",boxSizing:"border-box",position:"relative"},children:[!r&&i.jsxs("div",{style:{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",background:"rgba(255,255,255,0.9)",padding:"20px",borderRadius:"10px",zIndex:2e3,textAlign:"center"},children:[i.jsx("div",{style:{fontSize:"18px",marginBottom:"10px"},children:"載入中..."}),i.jsx("div",{style:{width:"40px",height:"40px",border:"4px solid #f3f3f3",borderTop:"4px solid #667eea",borderRadius:"50%",margin:"0 auto",animation:"spin 1s linear infinite"}}),i.jsx("style",{children:`
            @keyframes spin {
              0% { transform: rotate(0deg); }
              100% { transform: rotate(360deg); }
            }
          `})]}),!e&&i.jsxs("button",{onClick:()=>window.history.back(),style:{position:"absolute",top:"clamp(20px, 4vw, 40px)",left:"clamp(20px, 4vw, 40px)",zIndex:1e3,background:"rgba(255,255,255,0.9)",border:"none",borderRadius:"25px",padding:"clamp(8px, 2vw, 12px) clamp(16px, 3vw, 24px)",fontSize:"clamp(14px, 2.5vw, 18px)",fontWeight:"bold",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",color:"#667eea",transition:"all 0.3s ease",boxShadow:"0 4px 12px rgba(0,0,0,0.15)"},onMouseEnter:h=>{h.currentTarget.style.background="#667eea",h.currentTarget.style.color="#fff",h.currentTarget.style.transform="translateY(-2px)"},onMouseLeave:h=>{h.currentTarget.style.background="rgba(255,255,255,0.9)",h.currentTarget.style.color="#667eea",h.currentTarget.style.transform="translateY(0)"},children:["← ",a("back")]}),e?i.jsxs("div",{style:{position:"relative",height:"100vh"},children:[i.jsx("button",{onClick:h=>{h.preventDefault(),h.stopPropagation(),t(null)},style:{position:"absolute",top:"clamp(20px, 4vw, 40px)",left:"clamp(20px, 4vw, 40px)",zIndex:1e3,background:"rgba(255,255,255,0.9)",border:"none",borderRadius:"50%",width:"clamp(40px, 8vw, 50px)",height:"clamp(40px, 8vw, 50px)",fontSize:"clamp(16px, 3vw, 24px)",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},children:"←"}),d()]}):i.jsxs("div",{style:{maxWidth:"1200px",margin:"0 auto"},children:[i.jsxs("div",{style:{textAlign:"center",marginBottom:"clamp(20px, 4vw, 40px)",marginTop:"clamp(60px, 8vw, 80px)"},children:[i.jsx("h1",{style:{color:"#fff",fontSize:"clamp(1.5rem, 4vw, 2.5rem)",fontWeight:"bold",marginBottom:"10px",textShadow:"2px 2px 4px rgba(0,0,0,0.3)"},children:a("title")}),i.jsx("p",{style:{color:"#fff",fontSize:"clamp(1rem, 2.5vw, 1.2rem)",opacity:.9,textShadow:"1px 1px 2px rgba(0,0,0,0.3)"},children:a("subtitle")})]}),i.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(280px, 1fr))",gap:"clamp(15px, 3vw, 30px)",padding:"clamp(10px, 2vw, 20px)"},children:c.map(h=>i.jsxs("div",{onClick:()=>t(h.id),style:{background:"rgba(255,255,255,0.95)",borderRadius:"20px",padding:"clamp(20px, 4vw, 30px)",textAlign:"center",cursor:"pointer",transition:"all 0.3s ease",boxShadow:"0 8px 32px rgba(0,0,0,0.1)",border:`3px solid ${h.color}`,position:"relative",overflow:"hidden"},onMouseEnter:m=>{m.currentTarget.style.transform="translateY(-5px)",m.currentTarget.style.boxShadow="0 12px 40px rgba(0,0,0,0.2)"},onMouseLeave:m=>{m.currentTarget.style.transform="translateY(0)",m.currentTarget.style.boxShadow="0 8px 32px rgba(0,0,0,0.1)"},children:[i.jsx("div",{style:{fontSize:"clamp(3rem, 8vw, 4rem)",marginBottom:"20px",filter:"drop-shadow(2px 2px 4px rgba(0,0,0,0.2))"},children:h.icon}),i.jsx("h3",{style:{color:h.color,fontSize:"clamp(1.2rem, 3vw, 1.5rem)",fontWeight:"bold",marginBottom:"15px"},children:h.title}),i.jsx("p",{style:{color:"#666",fontSize:"clamp(0.9rem, 2vw, 1rem)",lineHeight:"1.5"},children:h.description}),i.jsx("button",{style:{background:h.color,color:"#fff",border:"none",borderRadius:"25px",padding:"clamp(8px, 2vw, 12px) clamp(20px, 4vw, 30px)",fontSize:"clamp(0.9rem, 2vw, 1rem)",fontWeight:"bold",marginTop:"20px",cursor:"pointer",transition:"all 0.3s ease"},children:a("start")})]},h.id))})]}),i.jsx(Ln,{})]})}function L3({onClose:n}){const{lang:e}=Bt(),[t,r]=w.useState([]),[s,a]=w.useState(0),[c,d]=w.useState("carrot"),[h,m]=w.useState(!1),g=R=>{var A;const T={"zh-TW":{title:"生活農場",rules:"遊戲規則",hideRules:"隱藏規則",seedSelection:"種子選擇：",score:"分數",gameRules:"遊戲規則",plantStage:"種植階段：",harvestStage:"收穫階段：",plantStep1:"1. 選擇種子（6種作物可選）",plantStep2:"2. 點擊空地種植 → 獲得種植分數",plantStep3:"3. 作物會自動生長（幼苗→成熟）",harvestStep1:"1. 點擊成熟的作物進行收穫",harvestStep2:"2. 收穫後獲得更高分數",harvestStep3:"3. 空地可以重新種植",scoring:"計分系統：",scoring1:"• 種植分數：10-25分（根據作物類型）",scoring2:"• 收穫分數：50-125分（根據作物類型）",scoring3:"• 作物生長時間：3-8秒",plant:"種植",harvest:"收穫",growthTime:"生長時間",seconds:"秒",carrot:"胡蘿蔔",tomato:"番茄",corn:"玉米",potato:"馬鈴薯",strawberry:"草莓",watermelon:"西瓜"},"zh-CN":{title:"生活农场",rules:"游戏规则",hideRules:"隐藏规则",seedSelection:"种子选择：",score:"分数",gameRules:"游戏规则",plantStage:"种植阶段：",harvestStage:"收获阶段：",plantStep1:"1. 选择种子（6种作物可选）",plantStep2:"2. 点击空地种植 → 获得种植分数",plantStep3:"3. 作物会自动生长（幼苗→成熟）",harvestStep1:"1. 点击成熟的作物进行收获",harvestStep2:"2. 收获后获得更高分数",harvestStep3:"3. 空地可以重新种植",scoring:"计分系统：",scoring1:"• 种植分数：10-25分（根据作物类型）",scoring2:"• 收获分数：50-125分（根据作物类型）",scoring3:"• 作物生长时间：3-8秒",plant:"种植",harvest:"收获",growthTime:"生长时间",seconds:"秒",carrot:"胡萝卜",tomato:"番茄",corn:"玉米",potato:"马铃薯",strawberry:"草莓",watermelon:"西瓜"},en:{title:"Life Farm",rules:"Game Rules",hideRules:"Hide Rules",seedSelection:"Seed Selection:",score:"Score",gameRules:"Game Rules",plantStage:"Planting Stage:",harvestStage:"Harvest Stage:",plantStep1:"1. Select seeds (6 crop types available)",plantStep2:"2. Click empty plots to plant → Get planting score",plantStep3:"3. Crops grow automatically (seedling→mature)",harvestStep1:"1. Click mature crops to harvest",harvestStep2:"2. Get higher score after harvest",harvestStep3:"3. Empty plots can be replanted",scoring:"Scoring System:",scoring1:"• Planting score: 10-25 points (by crop type)",scoring2:"• Harvest score: 50-125 points (by crop type)",scoring3:"• Growth time: 3-8 seconds",plant:"Plant",harvest:"Harvest",growthTime:"Growth Time",seconds:"seconds",carrot:"Carrot",tomato:"Tomato",corn:"Corn",potato:"Potato",strawberry:"Strawberry",watermelon:"Watermelon"},ja:{title:"ライフファーム",rules:"ゲームルール",hideRules:"ルールを隠す",seedSelection:"種子選択：",score:"スコア",gameRules:"ゲームルール",plantStage:"植栽段階：",harvestStage:"収穫段階：",plantStep1:"1. 種子を選択（6種類の作物）",plantStep2:"2. 空き地をクリックして植栽 → 植栽スコア獲得",plantStep3:"3. 作物は自動で成長（苗→成熟）",harvestStep1:"1. 成熟した作物をクリックして収穫",harvestStep2:"2. 収穫後により高いスコア獲得",harvestStep3:"3. 空き地は再植栽可能",scoring:"スコアシステム：",scoring1:"• 植栽スコア：10-25ポイント（作物タイプ別）",scoring2:"• 収穫スコア：50-125ポイント（作物タイプ別）",scoring3:"• 成長時間：3-8秒",plant:"植栽",harvest:"収穫",growthTime:"成長時間",seconds:"秒",carrot:"ニンジン",tomato:"トマト",corn:"トウモロコシ",potato:"ジャガイモ",strawberry:"イチゴ",watermelon:"スイカ"},ko:{title:"라이프 팜",rules:"게임 규칙",hideRules:"규칙 숨기기",seedSelection:"씨앗 선택:",score:"점수",gameRules:"게임 규칙",plantStage:"심기 단계:",harvestStage:"수확 단계:",plantStep1:"1. 씨앗 선택 (6가지 작물)",plantStep2:"2. 빈 땅 클릭하여 심기 → 심기 점수 획득",plantStep3:"3. 작물 자동 성장 (묘목→성숙)",harvestStep1:"1. 성숙한 작물 클릭하여 수확",harvestStep2:"2. 수확 후 더 높은 점수 획득",harvestStep3:"3. 빈 땅 재심기 가능",scoring:"점수 시스템:",scoring1:"• 심기 점수: 10-25점 (작물 타입별)",scoring2:"• 수확 점수: 50-125점 (작물 타입별)",scoring3:"• 성장 시간: 3-8초",plant:"심기",harvest:"수확",growthTime:"성장 시간",seconds:"초",carrot:"당근",tomato:"토마토",corn:"옥수수",potato:"감자",strawberry:"딸기",watermelon:"수박"},vi:{title:"Nông Trại Cuộc Sống",rules:"Luật Chơi",hideRules:"Ẩn Luật",seedSelection:"Chọn Hạt Giống:",score:"Điểm",gameRules:"Luật Chơi",plantStage:"Giai Đoạn Trồng:",harvestStage:"Giai Đoạn Thu Hoạch:",plantStep1:"1. Chọn hạt giống (6 loại cây trồng)",plantStep2:"2. Nhấp vào ô trống để trồng → Nhận điểm trồng",plantStep3:"3. Cây trồng tự động phát triển (mầm→trưởng thành)",harvestStep1:"1. Nhấp vào cây trưởng thành để thu hoạch",harvestStep2:"2. Nhận điểm cao hơn sau thu hoạch",harvestStep3:"3. Ô trống có thể trồng lại",scoring:"Hệ Thống Điểm:",scoring1:"• Điểm trồng: 10-25 điểm (theo loại cây)",scoring2:"• Điểm thu hoạch: 50-125 điểm (theo loại cây)",scoring3:"• Thời gian phát triển: 3-8 giây",plant:"Trồng",harvest:"Thu hoạch",growthTime:"Thời gian phát triển",seconds:"giây",carrot:"Cà Rốt",tomato:"Cà Chua",corn:"Ngô",potato:"Khoai Tây",strawberry:"Dâu Tây",watermelon:"Dưa Hấu"},th:{title:"ฟาร์มชีวิต",rules:"กฎเกม",hideRules:"ซ่อนกฎ",seedSelection:"เลือกเมล็ด:",score:"คะแนน",gameRules:"กฎเกม",plantStage:"ขั้นตอนปลูก:",harvestStage:"ขั้นตอนเก็บเกี่ยว:",plantStep1:"1. เลือกเมล็ด (6 ชนิดพืช)",plantStep2:"2. คลิกที่แปลงว่างเพื่อปลูก → ได้คะแนนปลูก",plantStep3:"3. พืชเติบโตอัตโนมัติ (ต้นกล้า→สุก)",harvestStep1:"1. คลิกพืชที่สุกแล้วเพื่อเก็บเกี่ยว",harvestStep2:"2. ได้คะแนนสูงขึ้นหลังเก็บเกี่ยว",harvestStep3:"3. แปลงว่างสามารถปลูกใหม่ได้",scoring:"ระบบคะแนน:",scoring1:"• คะแนนปลูก: 10-25 คะแนน (ตามชนิดพืช)",scoring2:"• คะแนนเก็บเกี่ยว: 50-125 คะแนน (ตามชนิดพืช)",scoring3:"• เวลาเติบโต: 3-8 วินาที",plant:"ปลูก",harvest:"เก็บเกี่ยว",growthTime:"เวลาเติบโต",seconds:"วินาที",carrot:"แครอท",tomato:"มะเขือเทศ",corn:"ข้าวโพด",potato:"มันฝรั่ง",strawberry:"สตรอเบอร์รี่",watermelon:"แตงโม"},la:{title:"Villa Vitae",rules:"Regulae Ludi",hideRules:"Occulta Regulas",seedSelection:"Selectio Seminis:",score:"Puncta",gameRules:"Regulae Ludi",plantStage:"Stadium Plantandi:",harvestStage:"Stadium Messis:",plantStep1:"1. Elige semina (6 genera culturarum)",plantStep2:"2. Clicca in agros vacuos ad plantandum → Accipe puncta",plantStep3:"3. Culturae crescunt automatice (plantula→maturus)",harvestStep1:"1. Clicca culturas maturas ad messem",harvestStep2:"2. Accipe puncta altiora post messem",harvestStep3:"3. Agri vacui possunt replantari",scoring:"Systema Punctorum:",scoring1:"• Puncta plantandi: 10-25 (secundum genus)",scoring2:"• Puncta messis: 50-125 (secundum genus)",scoring3:"• Tempus crescendi: 3-8 secundis",plant:"Planta",harvest:"Messis",growthTime:"Tempus Crescendi",seconds:"secundis",carrot:"Daucus",tomato:"Lycopersicum",corn:"Zea",potato:"Solanum",strawberry:"Fragaria",watermelon:"Citrullus"},ms:{title:"Ladang Kehidupan",rules:"Peraturan Permainan",hideRules:"Sembunyikan Peraturan",seedSelection:"Pilihan Benih:",score:"Markah",gameRules:"Peraturan Permainan",plantStage:"Peringkat Menanam:",harvestStage:"Peringkat Menuai:",plantStep1:"1. Pilih benih (6 jenis tanaman)",plantStep2:"2. Klik plot kosong untuk menanam → Dapat markah menanam",plantStep3:"3. Tanaman tumbuh secara automatik (anak benih→matang)",harvestStep1:"1. Klik tanaman matang untuk menuai",harvestStep2:"2. Dapat markah lebih tinggi selepas menuai",harvestStep3:"3. Plot kosong boleh ditanam semula",scoring:"Sistem Markah:",scoring1:"• Markah menanam: 10-25 mata (mengikut jenis tanaman)",scoring2:"• Markah menuai: 50-125 mata (mengikut jenis tanaman)",scoring3:"• Masa tumbuh: 3-8 saat",plant:"Tanam",harvest:"Tuai",growthTime:"Masa Tumbuh",seconds:"saat",carrot:"Lobak Merah",tomato:"Tomato",corn:"Jagung",potato:"Kentang",strawberry:"Strawberi",watermelon:"Tembikai"}};return((A=T[e])==null?void 0:A[R])||T["zh-TW"][R]||R};w.useEffect(()=>{const R=Dd("farm");R&&(r(R.plants||[]),a(R.score||0))},[]),w.useEffect(()=>{zd("farm",{plants:t,score:s})},[t,s]);const x=[{id:"carrot",name:"胡蘿蔔",emoji:"🥕",growthTime:3e3,color:"#FF6B35",plantScore:10,harvestScore:50},{id:"tomato",name:"番茄",emoji:"🍅",growthTime:5e3,color:"#FF4444",plantScore:15,harvestScore:75},{id:"corn",name:"玉米",emoji:"🌽",growthTime:7e3,color:"#FFD700",plantScore:20,harvestScore:100},{id:"potato",name:"馬鈴薯",emoji:"🥔",growthTime:4e3,color:"#8B4513",plantScore:12,harvestScore:60},{id:"strawberry",name:"草莓",emoji:"🍓",growthTime:6e3,color:"#FF69B4",plantScore:18,harvestScore:90},{id:"watermelon",name:"西瓜",emoji:"🍉",growthTime:8e3,color:"#FF6347",plantScore:25,harvestScore:125}],S=(R,T)=>{if(t.find(X=>X.x===R&&X.y===T))return;const D=x.find(X=>X.id===c);if(!D)return;const F={id:Date.now(),type:c,growth:0,planted:Date.now(),x:R,y:T};r(X=>[...X,F]),a(X=>X+D.plantScore),setTimeout(()=>{r(X=>X.map(ie=>ie.id===F.id?{...ie,growth:50}:ie))},D.growthTime/2),setTimeout(()=>{r(X=>X.map(ie=>ie.id===F.id?{...ie,growth:100}:ie))},D.growthTime)},I=R=>{const T=t.find(A=>A.id===R);if(T&&T.growth>=100){const A=x.find(D=>D.id===T.type);r(D=>D.filter(F=>F.id!==R)),a(D=>D+((A==null?void 0:A.harvestScore)||50))}},_=(R,T)=>t.find(A=>A.x===R&&A.y===T);return i.jsx("div",{style:{height:"100vh",background:"linear-gradient(180deg, #87CEEB 0%, #90EE90 100%)",padding:"clamp(10px, 2vw, 20px)",position:"relative",display:"flex",flexDirection:"column",overflow:"hidden"},children:i.jsxs("div",{style:{display:"grid",gridTemplateColumns:window.innerWidth<=768?"1fr":"clamp(200px, 25vw, 250px) 1fr",gap:"clamp(10px, 2vw, 20px)",height:"calc(100% - 60px)",marginTop:"60px",overflow:"visible",minHeight:"0",width:"100%"},children:[i.jsxs("div",{style:{background:"rgba(255,255,255,0.95)",borderRadius:"15px",padding:"clamp(15px, 3vw, 20px)",height:"fit-content",maxHeight:window.innerWidth<=768?"200px":"100%",overflow:"auto",boxShadow:"0 4px 20px rgba(0,0,0,0.1)",alignSelf:"start",display:window.innerWidth<=768?"none":"block"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",fontSize:"clamp(1.2rem, 3vw, 1.5rem)",fontWeight:"bold",color:"#333"},children:["🌱 ",g("title")]}),i.jsx("button",{onClick:()=>m(!h),style:{background:"#4CAF50",color:"#fff",border:"none",borderRadius:"15px",padding:"4px 12px",fontSize:"clamp(0.7rem, 1.8vw, 0.8rem)",cursor:"pointer"},children:g(h?"hideRules":"rules")})]}),i.jsxs("div",{style:{marginBottom:"20px"},children:[i.jsx("h4",{style:{marginBottom:"10px",fontSize:"clamp(1rem, 2.5vw, 1.2rem)",color:"#333",fontWeight:"bold"},children:g("seedSelection")}),x.map(R=>i.jsxs("div",{onClick:()=>d(R.id),style:{padding:"clamp(8px, 2vw, 10px)",margin:"5px 0",borderRadius:"8px",cursor:"pointer",background:c===R.id?"#e8f5e8":"#f5f5f5",border:c===R.id?"2px solid #4CAF50":"2px solid transparent",fontSize:"clamp(0.9rem, 2vw, 1rem)",display:"flex",alignItems:"center",gap:"8px",transition:"all 0.3s ease"},children:[i.jsx("span",{style:{fontSize:"1.2em"},children:R.emoji}),i.jsx("span",{children:g(R.id)})]},R.id))]}),i.jsx("div",{style:{marginBottom:"20px"},children:i.jsxs("h4",{style:{fontSize:"clamp(1rem, 2.5vw, 1.2rem)",color:"#333",fontWeight:"bold"},children:[g("score"),"：",s]})}),h&&i.jsxs("div",{style:{background:"rgba(255,255,255,0.8)",borderRadius:"10px",padding:"12px",marginBottom:"15px",textAlign:"left",fontSize:"clamp(0.7rem, 1.8vw, 0.8rem)",lineHeight:"1.3"},children:[i.jsxs("h4",{style:{marginBottom:"8px",color:"#333"},children:["🎯 ",g("gameRules"),"："]}),i.jsx("p",{style:{marginBottom:"6px"},children:i.jsx("strong",{children:g("plantStage")})}),i.jsx("p",{style:{marginBottom:"6px"},children:g("plantStep1")}),i.jsx("p",{style:{marginBottom:"6px"},children:g("plantStep2")}),i.jsx("p",{style:{marginBottom:"6px"},children:g("plantStep3")}),i.jsx("p",{style:{marginBottom:"6px",marginTop:"8px"},children:i.jsx("strong",{children:g("harvestStage")})}),i.jsx("p",{style:{marginBottom:"6px"},children:g("harvestStep1")}),i.jsx("p",{style:{marginBottom:"6px"},children:g("harvestStep2")}),i.jsx("p",{style:{marginBottom:"6px"},children:g("harvestStep3")}),i.jsx("p",{style:{marginBottom:"6px",marginTop:"8px"},children:i.jsx("strong",{children:g("scoring")})}),i.jsxs("p",{style:{marginBottom:"4px"},children:["🥕 ",g("carrot"),"：",g("plant"),"+10 ",g("harvest"),"+50"]}),i.jsxs("p",{style:{marginBottom:"4px"},children:["🍅 ",g("tomato"),"：",g("plant"),"+15 ",g("harvest"),"+75"]}),i.jsxs("p",{style:{marginBottom:"4px"},children:["🌽 ",g("corn"),"：",g("plant"),"+20 ",g("harvest"),"+100"]}),i.jsxs("p",{style:{marginBottom:"4px"},children:["🥔 ",g("potato"),"：",g("plant"),"+12 ",g("harvest"),"+60"]}),i.jsxs("p",{style:{marginBottom:"4px"},children:["🍓 ",g("strawberry"),"：",g("plant"),"+18 ",g("harvest"),"+90"]}),i.jsxs("p",{style:{marginBottom:"4px"},children:["🍉 ",g("watermelon"),"：",g("plant"),"+25 ",g("harvest"),"+125"]}),i.jsx("p",{style:{marginBottom:"6px",marginTop:"8px"},children:i.jsxs("strong",{children:[g("growthTime"),"："]})}),i.jsxs("p",{style:{marginBottom:"4px"},children:["🥕 ",g("carrot"),"：3",g("seconds")]}),i.jsxs("p",{style:{marginBottom:"4px"},children:["🍅 ",g("tomato"),"：5",g("seconds")]}),i.jsxs("p",{style:{marginBottom:"4px"},children:["🌽 ",g("corn"),"：7",g("seconds")]}),i.jsxs("p",{style:{marginBottom:"4px"},children:["🥔 ",g("potato"),"：4",g("seconds")]}),i.jsxs("p",{style:{marginBottom:"4px"},children:["🍓 ",g("strawberry"),"：6",g("seconds")]}),i.jsxs("p",{style:{marginBottom:"4px"},children:["🍉 ",g("watermelon"),"：8",g("seconds")]})]})]}),i.jsxs("div",{style:{background:"rgba(255,255,255,0.9)",borderRadius:"15px",padding:"clamp(10px, 2vw, 20px)",position:"relative",overflow:"visible",boxShadow:"0 4px 20px rgba(0,0,0,0.1)",display:"flex",flexDirection:"column",zIndex:1,minHeight:"0",width:"100%"},children:[window.innerWidth<=768&&i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"10px",marginBottom:"15px"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"10px",background:"rgba(255,255,255,0.8)",borderRadius:"10px",fontSize:"14px",position:"relative",zIndex:1},children:[i.jsxs("div",{style:{fontWeight:"bold"},children:[g("score"),"：",s]}),i.jsx("div",{style:{display:"flex",gap:"8px"},children:x.map(R=>i.jsx("button",{onClick:()=>d(R.id),style:{padding:"4px 8px",borderRadius:"6px",border:c===R.id?"2px solid #4CAF50":"1px solid #ddd",background:c===R.id?"#e8f5e8":"#fff",cursor:"pointer",fontSize:"12px"},children:R.emoji},R.id))})]}),i.jsx("div",{style:{display:"flex",justifyContent:"center"},children:i.jsx("button",{onClick:()=>m(!h),style:{background:"#4CAF50",color:"#fff",border:"none",borderRadius:"15px",padding:"6px 16px",fontSize:"12px",cursor:"pointer"},children:g(h?"hideRules":"rules")})}),h&&i.jsxs("div",{style:{background:"rgba(255,255,255,0.9)",borderRadius:"10px",padding:"12px",fontSize:"11px",lineHeight:"1.3",textAlign:"left"},children:[i.jsxs("h4",{style:{marginBottom:"6px",color:"#333"},children:["🎯 ",g("gameRules"),"："]}),i.jsxs("p",{style:{marginBottom:"4px"},children:[i.jsx("strong",{children:"種植："}),"選擇種子 → 點擊空地種植"]}),i.jsxs("p",{style:{marginBottom:"4px"},children:[i.jsx("strong",{children:"收穫："}),"點擊成熟作物收穫"]}),i.jsxs("p",{style:{marginBottom:"4px"},children:[i.jsx("strong",{children:"分數："}),"種植+10~25分，收穫+50~125分"]}),i.jsxs("p",{style:{marginBottom:"4px"},children:[i.jsx("strong",{children:"時間："}),"3~8秒成熟"]})]})]}),i.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(10, 1fr)",gridTemplateRows:"repeat(7, 1fr)",gap:"clamp(5px, 1vw, 10px)",width:"100%",height:"fit-content",minHeight:"0",overflow:"visible"},children:Array.from({length:70},(R,T)=>{const A=T%10,D=Math.floor(T/10),F=_(A,D),X=F?x.find(G=>G.id===F.type):null,ie=F&&F.growth>=100;return i.jsx("div",{onClick:()=>{F&&ie?I(F.id):F||S(A,D)},style:{background:F?ie?"#4CAF50":"#8BC34A":"#DEB887",border:"2px solid #A0522D",borderRadius:"8px",display:"flex",alignItems:"center",justifyContent:"center",cursor:F&&!ie?"not-allowed":"pointer",fontSize:F?"clamp(1.5rem, 4vw, 2rem)":"clamp(0.8rem, 2vw, 1rem)",transition:"all 0.3s ease",position:"relative",aspectRatio:"1",boxShadow:F?"0 2px 8px rgba(0,0,0,0.2)":"none",opacity:F&&!ie?.7:1},children:F?i.jsx("div",{style:{fontSize:ie?"clamp(1.5rem, 4vw, 2rem)":"clamp(0.8rem, 2vw, 1rem)",opacity:F.growth/100,transform:ie?"scale(1.1)":"scale(1)",transition:"all 0.3s ease"},children:X==null?void 0:X.emoji}):i.jsx("span",{style:{color:"#8B4513",fontSize:"1.5em"},children:"+"})},T)})})]})]})})}function O3({onClose:n}){const{lang:e}=Bt(),[t,r]=w.useState(0),[s,a]=w.useState(30),[c,d]=w.useState(!1),[h,m]=w.useState(null),g=K=>{var Y;const Z={"zh-TW":{start:"開始遊戲",restart:"重新開始",score:"分數",time:"時間",level:"等級",hits:"擊中",accuracy:"準確率",combo:"連擊",highScore:"最高分",highCombo:"最高連擊",title:"打地鼠",rules:"遊戲規則",close:"關閉",gameOver:"遊戲結束",finalScore:"最終分數",basicGameplay:"基本玩法",scoreSystem:"分數系統",levelSystem:"等級系統",clickMole:"點擊出現的地鼠",getScore:"獲得分數",gameTime:"遊戲時間",seconds:"秒",moleSpeed:"地鼠出現時間會隨等級縮短",baseScore:"基礎分數",points:"分",levelBonus:"等級獎勵",perLevel:"每級",comboBonus:"連擊獎勵",per3Combo:"每3連擊",level1:"1級",level2:"2級",level3:"3級",level4:"4級",molesFaster:"地鼠更快",moreFrequent:"更頻繁",extremeSpeed:"極限速度"},"zh-CN":{start:"开始游戏",restart:"重新开始",score:"分数",time:"时间",level:"等级",hits:"击中",accuracy:"准确率",combo:"连击",highScore:"最高分",highCombo:"最高连击",title:"打地鼠",rules:"游戏规则",close:"关闭",basicGameplay:"基本玩法",scoreSystem:"分数系统",levelSystem:"等级系统",clickMole:"点击出现的地鼠",getScore:"获得分数",gameTime:"游戏时间",seconds:"秒",moleSpeed:"地鼠出现时间会随等级缩短",baseScore:"基础分数",points:"分",levelBonus:"等级奖励",perLevel:"每级",comboBonus:"连击奖励",per3Combo:"每3连击",level1:"1级",level2:"2级",level3:"3级",level4:"4级",molesFaster:"地鼠更快",moreFrequent:"更频繁",extremeSpeed:"极限速度"},en:{start:"Start Game",restart:"Restart",score:"Score",time:"Time",level:"Level",hits:"Hits",accuracy:"Accuracy",combo:"Combo",highScore:"High Score",highCombo:"High Combo",title:"Whack-a-Mole",rules:"Game Rules",close:"Close",basicGameplay:"Basic Gameplay",scoreSystem:"Score System",levelSystem:"Level System",clickMole:"Click appearing moles",getScore:"to get points",gameTime:"Game Time",seconds:"seconds",moleSpeed:"Mole appearance time shortens with level",baseScore:"Base Score",points:"points",levelBonus:"Level Bonus",perLevel:"per level",comboBonus:"Combo Bonus",per3Combo:"per 3 combos",level1:"Level 1",level2:"Level 2",level3:"Level 3",level4:"Level 4",molesFaster:"moles faster",moreFrequent:"more frequent",extremeSpeed:"extreme speed"},ja:{start:"ゲーム開始",restart:"再開",score:"スコア",time:"時間",level:"レベル",hits:"ヒット",accuracy:"精度",combo:"コンボ",highScore:"ハイスコア",highCombo:"ハイコンボ",title:"モグラたたき",rules:"ゲームルール",close:"閉じる",basicGameplay:"基本プレイ",scoreSystem:"スコアシステム",levelSystem:"レベルシステム",clickMole:"現れるモグラをクリック",getScore:"してポイントを獲得",gameTime:"ゲーム時間",seconds:"秒",moleSpeed:"モグラの出現時間はレベルに応じて短縮",baseScore:"ベーススコア",points:"ポイント",levelBonus:"レベルボーナス",perLevel:"レベルごと",comboBonus:"コンボボーナス",per3Combo:"3コンボごと",level1:"レベル1",level2:"レベル2",level3:"レベル3",level4:"レベル4",molesFaster:"モグラがより速く",moreFrequent:"より頻繁に",extremeSpeed:"極限速度"},ko:{start:"게임 시작",restart:"다시 시작",score:"점수",time:"시간",level:"레벨",hits:"타격",accuracy:"정확도",combo:"콤보",highScore:"최고 점수",highCombo:"최고 콤보",title:"두더지 잡기",rules:"게임 규칙",close:"닫기",basicGameplay:"기본 플레이",scoreSystem:"점수 시스템",levelSystem:"레벨 시스템",clickMole:"나타나는 두더지를 클릭",getScore:"하여 점수 획득",gameTime:"게임 시간",seconds:"초",moleSpeed:"두더지 출현 시간은 레벨에 따라 단축",baseScore:"기본 점수",points:"점",levelBonus:"레벨 보너스",perLevel:"레벨당",comboBonus:"콤보 보너스",per3Combo:"3콤보당",level1:"레벨 1",level2:"레벨 2",level3:"레벨 3",level4:"레벨 4",molesFaster:"두더지가 더 빠르게",moreFrequent:"더 자주",extremeSpeed:"극한 속도"},vi:{start:"Bắt Đầu Trò Chơi",restart:"Chơi Lại",score:"Điểm",time:"Thời Gian",level:"Cấp Độ",hits:"Trúng",accuracy:"Độ Chính Xác",combo:"Combo",highScore:"Điểm Cao Nhất",highCombo:"Combo Cao Nhất",title:"Đập Chuột",rules:"Luật Chơi",close:"Đóng",basicGameplay:"Cách Chơi Cơ Bản",scoreSystem:"Hệ Thống Điểm",levelSystem:"Hệ Thống Cấp Độ",clickMole:"Nhấp vào chuột xuất hiện",getScore:"để nhận điểm",gameTime:"Thời Gian Chơi",seconds:"giây",moleSpeed:"Thời gian xuất hiện chuột rút ngắn theo cấp độ",baseScore:"Điểm Cơ Bản",points:"điểm",levelBonus:"Thưởng Cấp Độ",perLevel:"mỗi cấp",comboBonus:"Thưởng Combo",per3Combo:"mỗi 3 combo",level1:"Cấp 1",level2:"Cấp 2",level3:"Cấp 3",level4:"Cấp 4",molesFaster:"chuột nhanh hơn",moreFrequent:"thường xuyên hơn",extremeSpeed:"tốc độ cực hạn"},th:{start:"เริ่มเกม",restart:"เริ่มใหม่",score:"คะแนน",time:"เวลา",level:"ระดับ",hits:"ตีถูก",accuracy:"ความแม่นยำ",combo:"คอมโบ",highScore:"คะแนนสูงสุด",highCombo:"คอมโบสูงสุด",title:"ตีตุ่น",rules:"กฎเกม",close:"ปิด",basicGameplay:"วิธีเล่นพื้นฐาน",scoreSystem:"ระบบคะแนน",levelSystem:"ระบบระดับ",clickMole:"คลิกตุ่นที่ปรากฏ",getScore:"เพื่อได้คะแนน",gameTime:"เวลาเกม",seconds:"วินาที",moleSpeed:"เวลาปรากฏของตุ่นจะสั้นลงตามระดับ",baseScore:"คะแนนพื้นฐาน",points:"คะแนน",levelBonus:"โบนัสระดับ",perLevel:"ต่อระดับ",comboBonus:"โบนัสคอมโบ",per3Combo:"ต่อ 3 คอมโบ",level1:"ระดับ 1",level2:"ระดับ 2",level3:"ระดับ 3",level4:"ระดับ 4",molesFaster:"ตุ่นเร็วขึ้น",moreFrequent:"บ่อยขึ้น",extremeSpeed:"ความเร็วสุดขีด"},la:{start:"Ludum Incipere",restart:"Iterum Incipere",score:"Puncta",time:"Tempus",level:"Gradus",hits:"Ictus",accuracy:"Accuratio",combo:"Combo",highScore:"Puncta Maxima",highCombo:"Combo Maxima",title:"Talpa Percutere",rules:"Regulae Ludi",close:"Claudere",basicGameplay:"Ludus Basicus",scoreSystem:"Systema Punctorum",levelSystem:"Systema Gradus",clickMole:"Clicca talpam apparentem",getScore:"ut puncta accipias",gameTime:"Tempus Ludi",seconds:"secundis",moleSpeed:"Tempus apparentiae talpae cum gradu brevior fit",baseScore:"Puncta Basica",points:"puncta",levelBonus:"Bonus Gradus",perLevel:"per gradum",comboBonus:"Bonus Combo",per3Combo:"per 3 combos",level1:"Gradus 1",level2:"Gradus 2",level3:"Gradus 3",level4:"Gradus 4",molesFaster:"talpae velociores",moreFrequent:"frequentiores",extremeSpeed:"velocitas extrema"},ms:{start:"Mulakan Permainan",restart:"Mulakan Semula",score:"Markah",time:"Masa",level:"Tahap",hits:"Pukulan",accuracy:"Ketepatan",combo:"Combo",highScore:"Markah Tertinggi",highCombo:"Combo Tertinggi",title:"Pukul Tikus",rules:"Peraturan Permainan",close:"Tutup",basicGameplay:"Cara Bermain Asas",scoreSystem:"Sistem Markah",levelSystem:"Sistem Tahap",clickMole:"Klik tikus yang muncul",getScore:"untuk dapat markah",gameTime:"Masa Permainan",seconds:"saat",moleSpeed:"Masa kemunculan tikus memendek dengan tahap",baseScore:"Markah Asas",points:"markah",levelBonus:"Bonus Tahap",perLevel:"setiap tahap",comboBonus:"Bonus Combo",per3Combo:"setiap 3 combo",level1:"Tahap 1",level2:"Tahap 2",level3:"Tahap 3",level4:"Tahap 4",molesFaster:"tikus lebih cepat",moreFrequent:"lebih kerap",extremeSpeed:"kelajuan melampau"}};return((Y=Z[e])==null?void 0:Y[K])||Z["zh-TW"][K]||K},[x,S]=w.useState(0),[I,_]=w.useState(1),[R,T]=w.useState(0),[A,D]=w.useState(0),[F,X]=w.useState(!1),[ie,G]=w.useState(0),[N,E]=w.useState(0),[P,M]=w.useState(0);w.useEffect(()=>{const K=Dd("whackAMole");K&&S(K.highScore||0)},[]),w.useEffect(()=>{t>x&&(S(t),zd("whackAMole",{highScore:t}))},[t,x]),w.useEffect(()=>{t>=100&&I===1?_(2):t>=250&&I===2?_(3):t>=500&&I===3&&_(4)},[t,I]);const O=()=>t<0?"😅 負分？地鼠在笑你！":t<50?"🐹 新手地鼠獵人！":t<100?"🎯 有點手感了！":t<200?"⚡ 地鼠殺手！":t<300?"🔥 地鼠剋星！":t<500?"💪 地鼠終結者！":"👑 地鼠之王！";w.useEffect(()=>{t>=100&&I===1&&_(2),t>=250&&I===2&&_(3),t>=500&&I===3&&_(4)},[t,I]),w.useEffect(()=>{const K=R+A;K>0&&M(Math.round(R/K*100))},[R,A]);const z=()=>{d(!0),r(0),a(30),_(1),T(0),D(0),G(0),E(0),M(0),m(null);let K,Z;K=setInterval(()=>{a(Y=>Y<=1?(clearInterval(K),clearInterval(Z),d(!1),0):Y-1)},1e3),setTimeout(()=>{m(Math.floor(Math.random()*9)),setTimeout(()=>{m(null),D(ae=>ae+1),G(0)},I===1?900:I===2?700:I===3?500:350)},300),Z=setInterval(()=>{m(Math.floor(Math.random()*9)),setTimeout(()=>{m(null),D(ae=>ae+1),G(0)},I===1?900:I===2?700:I===3?500:350)},I===1?1100:I===2?900:I===3?700:500)},j=K=>{if(h===K){const Y=Math.floor(ie/3)*5,ae=I*5,se=10+Y+ae;r(re=>re+se),T(re=>re+1),G(re=>{const ne=re+1;return ne>N&&E(ne),ne}),m(null)}else r(Z=>Z-5),G(0)};return i.jsxs("div",{style:{height:"100vh",background:"linear-gradient(180deg, #8B4513 0%, #A0522D 100%)",padding:"clamp(10px, 2vw, 20px)",display:"flex",flexDirection:"column",alignItems:"center",position:"relative"},children:[i.jsx("button",{onClick:n,style:{position:"absolute",top:"clamp(20px, 4vw, 40px)",left:"clamp(20px, 4vw, 40px)",background:"#fff",border:"2px solid #6B5BFF",borderRadius:"50%",width:"clamp(40px, 8vw, 50px)",height:"clamp(40px, 8vw, 50px)",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",zIndex:20,fontSize:"clamp(1.2rem, 3vw, 1.5rem)",color:"#6B5BFF"},children:"←"}),i.jsxs("div",{style:{background:"rgba(255,255,255,0.9)",borderRadius:"15px",padding:"clamp(10px, 2vw, 15px)",marginTop:"clamp(60px, 12vw, 80px)",marginBottom:"clamp(8px, 1.5vw, 15px)",textAlign:"center",width:"100%",maxWidth:"500px"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"10px"},children:[i.jsxs("h2",{style:{fontSize:"clamp(1.5rem, 4vw, 2rem)",margin:0},children:["🔨 ",g("title")]}),i.jsx("button",{onClick:()=>X(!F),style:{background:"#4CAF50",color:"#fff",border:"none",borderRadius:"20px",padding:"5px 15px",fontSize:"clamp(0.8rem, 2vw, 1rem)",cursor:"pointer"},children:g(F?"close":"rules")})]}),F&&i.jsxs("div",{style:{background:"rgba(255,255,255,0.8)",borderRadius:"10px",padding:"10px",marginBottom:"10px",textAlign:"left",fontSize:"clamp(0.7rem, 1.8vw, 0.8rem)",lineHeight:"1.3"},children:[i.jsxs("h4",{style:{marginBottom:"8px",color:"#333"},children:["🎯 ",g("rules"),"："]}),i.jsx("p",{style:{marginBottom:"6px"},children:i.jsxs("strong",{children:[g("basicGameplay"),"："]})}),i.jsxs("p",{style:{marginBottom:"6px"},children:["• ",g("clickMole")," 🐹 ",g("getScore")]}),i.jsxs("p",{style:{marginBottom:"6px"},children:["• ",g("gameTime"),"：30",g("seconds")]}),i.jsxs("p",{style:{marginBottom:"6px"},children:["• ",g("moleSpeed")]}),i.jsx("p",{style:{marginBottom:"6px",marginTop:"8px"},children:i.jsxs("strong",{children:[g("scoreSystem"),"："]})}),i.jsxs("p",{style:{marginBottom:"6px"},children:["• ",g("baseScore"),"：10",g("points")]}),i.jsxs("p",{style:{marginBottom:"6px"},children:["• ",g("levelBonus"),"：",g("perLevel"),"+5",g("points")]}),i.jsxs("p",{style:{marginBottom:"6px"},children:["• ",g("comboBonus"),"：",g("per3Combo"),"+5",g("points")]}),i.jsx("p",{style:{marginBottom:"6px",marginTop:"8px"},children:i.jsxs("strong",{children:[g("levelSystem"),"："]})}),i.jsxs("p",{style:{marginBottom:"6px"},children:["• ",g("level1"),"：100",g("points")," → ",g("level2"),"（",g("molesFaster"),"）"]}),i.jsxs("p",{style:{marginBottom:"6px"},children:["• ",g("level2"),"：250",g("points")," → ",g("level3"),"（",g("moreFrequent"),"）"]}),i.jsxs("p",{style:{marginBottom:"6px"},children:["• ",g("level3"),"：500",g("points")," → ",g("level4"),"（",g("extremeSpeed"),"）"]})]}),!F&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{display:"flex",gap:"clamp(6px, 1.5vw, 12px)",justifyContent:"center",flexWrap:"wrap",marginBottom:"8px"},children:[i.jsxs("div",{style:{fontSize:"clamp(0.8rem, 2.2vw, 1rem)"},children:[g("score"),"：",t]}),i.jsxs("div",{style:{fontSize:"clamp(0.8rem, 2.2vw, 1rem)"},children:[g("time"),"：",s,"秒"]}),i.jsxs("div",{style:{fontSize:"clamp(0.8rem, 2.2vw, 1rem)"},children:[g("level"),"：",I]})]}),i.jsxs("div",{style:{display:"flex",gap:"clamp(6px, 1.5vw, 12px)",justifyContent:"center",flexWrap:"wrap",marginBottom:"8px"},children:[i.jsxs("div",{style:{fontSize:"clamp(0.7rem, 1.8vw, 0.9rem)"},children:[g("hits"),"：",R]}),i.jsxs("div",{style:{fontSize:"clamp(0.7rem, 1.8vw, 0.9rem)"},children:[g("accuracy"),"：",P,"%"]}),i.jsxs("div",{style:{fontSize:"clamp(0.7rem, 1.8vw, 0.9rem)"},children:[g("combo"),"：",ie]})]}),i.jsxs("div",{style:{display:"flex",gap:"clamp(6px, 1.5vw, 12px)",justifyContent:"center",flexWrap:"wrap"},children:[i.jsxs("div",{style:{fontSize:"clamp(0.7rem, 1.8vw, 0.9rem)"},children:[g("highScore"),"：",x]}),i.jsxs("div",{style:{fontSize:"clamp(0.7rem, 1.8vw, 0.9rem)"},children:[g("highCombo"),"：",N]})]}),i.jsx("div",{style:{fontSize:"clamp(0.8rem, 2vw, 1rem)",color:"#FF5722",fontWeight:"bold",marginTop:"8px",textAlign:"center"},children:O()}),!c&&i.jsx("button",{onClick:z,style:{background:"#FF5722",color:"#fff",border:"none",borderRadius:"25px",padding:"clamp(6px, 1.5vw, 8px) clamp(16px, 3vw, 24px)",fontSize:"clamp(0.9rem, 2.2vw, 1rem)",fontWeight:"bold",marginTop:"10px",cursor:"pointer",transition:"all 0.3s ease"},children:g(s===30?"start":"restart")})]})]}),!F&&i.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"clamp(8px, 1.5vw, 15px)",maxWidth:"500px",width:"100%",marginTop:"10px",padding:"clamp(10px, 2vw, 15px)",background:"rgba(255,255,255,0.9)",borderRadius:"15px",boxSizing:"border-box"},children:Array.from({length:9},(K,Z)=>i.jsx("div",{onClick:()=>j(Z),style:{width:"clamp(60px, 10vw, 80px)",height:"clamp(60px, 10vw, 80px)",background:"#654321",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",border:"3px solid #8B4513",position:"relative",overflow:"hidden"},children:h===Z&&i.jsx("div",{style:{position:"absolute",bottom:"0",width:"100%",height:"60%",background:"#8B4513",borderRadius:"50% 50% 0 0",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"clamp(1.5rem, 4vw, 2rem)",animation:"molePop 0.3s ease-out",cursor:"pointer"},children:"🐹"})},Z))}),i.jsx("style",{children:`
        @keyframes molePop {
          0% { transform: translateY(100%); }
          100% { transform: translateY(0); }
        }
        
        @keyframes whack {
          0% { transform: scale(1); }
          50% { transform: scale(0.8); }
          100% { transform: scale(1); }
        }
        
        @keyframes scorePop {
          0% { opacity: 0; transform: translateY(0); }
          50% { opacity: 1; transform: translateY(-20px); }
          100% { opacity: 0; transform: translateY(-40px); }
        }
      `})]})}function V3({onClose:n}){const{lang:e}=Bt(),[t,r]=w.useState(0),[s,a]=w.useState([]),c=K=>{var Y;const Z={"zh-TW":{title:"採水果",start:"開始遊戲",restart:"重新開始",score:"分數",time:"時間",level:"等級",collected:"收集",highScore:"最高分",rules:"遊戲規則",close:"關閉",hideRules:"隱藏規則",basicGameplay:"基本玩法",scoreSystem:"分數系統",levelSystem:"等級系統",tips:"技巧提示",newFeatures:"新增功能",gameOver:"遊戲結束",clickFruit:"點擊掉落的水果收集分數",putFruitInBasket:"把採到的水果裝進下面的水果籃裡",gameTime:"遊戲時間",seconds:"秒",fruitSpeed:"水果會不定向掉落且速度加快",apple:"蘋果",orange:"橘子",banana:"香蕉",strawberry:"草莓",grape:"葡萄",peach:"桃子",points:"分",level1:"1級",level2:"2級",level3:"3級",level4:"4級",fruitFaster:"水果更快",moreFrequent:"更頻繁",extremeSpeed:"極限速度",prioritizeHighScore:"優先收集高分水果",stayFocused:"保持專注，快速反應",buildHighScore:"建立高分記錄",fruitFromFourDirections:"水果會從四個方向隨機出現",curvedTrajectory:"水果掉落時會呈現彎曲動線",realTimeFeedback:"遊戲中會顯示即時收集反饋",detailedStats:"遊戲結束時顯示詳細統計",fixedBasketPosition:"籃子位置完全固定不震動",increasedFrequency:"水果出現頻率大幅提升"},"zh-CN":{title:"采水果",start:"开始游戏",restart:"重新开始",score:"分数",time:"时间",level:"等级",collected:"收集",highScore:"最高分",rules:"游戏规则",close:"关闭",hideRules:"隐藏规则",basicGameplay:"基本玩法",scoreSystem:"分数系统",levelSystem:"等级系统",tips:"技巧提示",newFeatures:"新增功能",clickFruit:"点击掉落的水果收集分数",putFruitInBasket:"把采到的水果装进下面的水果篮里",gameTime:"游戏时间",seconds:"秒",fruitSpeed:"水果会不定向掉落且速度加快",apple:"苹果",orange:"橘子",banana:"香蕉",strawberry:"草莓",grape:"葡萄",peach:"桃子",points:"分",level1:"1级",level2:"2级",level3:"3级",level4:"4级",fruitFaster:"水果更快",moreFrequent:"更频繁",extremeSpeed:"极限速度",prioritizeHighScore:"优先收集高分水果",stayFocused:"保持专注，快速反应",buildHighScore:"建立高分记录",fruitFromFourDirections:"水果会从四个方向随机出现",curvedTrajectory:"水果掉落时会呈现弯曲动线",realTimeFeedback:"游戏中会显示即时收集反馈",detailedStats:"游戏结束时显示详细统计",fixedBasketPosition:"篮子位置完全固定不震动",increasedFrequency:"水果出现频率大幅提升"},en:{title:"Fruit Picking",start:"Start Game",restart:"Restart",score:"Score",time:"Time",level:"Level",collected:"Collected",highScore:"High Score",rules:"Game Rules",close:"Close",hideRules:"Hide Rules",basicGameplay:"Basic Gameplay",scoreSystem:"Score System",levelSystem:"Level System",tips:"Tips",newFeatures:"New Features",clickFruit:"Click falling fruit to collect points",putFruitInBasket:"Put collected fruit into the basket below",gameTime:"Game Time",seconds:"seconds",fruitSpeed:"Fruit will fall randomly and speed up",apple:"Apple",orange:"Orange",banana:"Banana",strawberry:"Strawberry",grape:"Grape",peach:"Peach",points:"points",level1:"Level 1",level2:"Level 2",level3:"Level 3",level4:"Level 4",fruitFaster:"fruit faster",moreFrequent:"more frequent",extremeSpeed:"extreme speed",prioritizeHighScore:"Prioritize high-score fruits",stayFocused:"Stay focused, react quickly",buildHighScore:"Build high score records",fruitFromFourDirections:"Fruit appears from four directions randomly",curvedTrajectory:"Fruit falls with curved trajectories",realTimeFeedback:"Real-time collection feedback during game",detailedStats:"Detailed statistics when game ends",fixedBasketPosition:"Basket position completely fixed without vibration",increasedFrequency:"Significantly increased fruit appearance frequency"},ja:{title:"フルーツ収穫",start:"ゲーム開始",restart:"再開",score:"スコア",time:"時間",level:"レベル",collected:"収穫",highScore:"ハイスコア",rules:"ゲームルール",close:"閉じる",hideRules:"ルール非表示",basicGameplay:"基本ゲームプレイ",scoreSystem:"スコアシステム",levelSystem:"レベルシステム",tips:"ヒント",newFeatures:"新機能",clickFruit:"落ちる果物をクリックしてポイントを獲得",putFruitInBasket:"収穫した果物を下のバスケットに入れる",gameTime:"ゲーム時間",seconds:"秒",fruitSpeed:"果物はランダムに落ちて速度が上がる",apple:"りんご",orange:"みかん",banana:"バナナ",strawberry:"いちご",grape:"ぶどう",peach:"もも",points:"ポイント",level1:"レベル1",level2:"レベル2",level3:"レベル3",level4:"レベル4",fruitFaster:"果物がより速く",moreFrequent:"より頻繁に",extremeSpeed:"極限速度",prioritizeHighScore:"高得点の果物を優先",stayFocused:"集中して素早く反応",buildHighScore:"高得点記録を築く",fruitFromFourDirections:"果物は4方向からランダムに出現",curvedTrajectory:"果物は曲線軌道で落下",realTimeFeedback:"ゲーム中のリアルタイム収穫フィードバック",detailedStats:"ゲーム終了時の詳細統計",fixedBasketPosition:"バスケット位置は完全固定で震動なし",increasedFrequency:"果物出現頻度が大幅に向上"},ko:{title:"과일 수확",start:"게임 시작",restart:"다시 시작",score:"점수",time:"시간",level:"레벨",collected:"수확",highScore:"최고 점수",rules:"게임 규칙",close:"닫기",hideRules:"규칙 숨기기",basicGameplay:"기본 게임플레이",scoreSystem:"점수 시스템",levelSystem:"레벨 시스템",tips:"팁",newFeatures:"새 기능",clickFruit:"떨어지는 과일을 클릭하여 점수 획득",putFruitInBasket:"수확한 과일을 아래 바구니에 넣기",gameTime:"게임 시간",seconds:"초",fruitSpeed:"과일이 무작위로 떨어지고 속도가 빨라짐",apple:"사과",orange:"귤",banana:"바나나",strawberry:"딸기",grape:"포도",peach:"복숭아",points:"점",level1:"레벨 1",level2:"레벨 2",level3:"레벨 3",level4:"레벨 4",fruitFaster:"과일이 더 빠르게",moreFrequent:"더 자주",extremeSpeed:"극한 속도",prioritizeHighScore:"고점수 과일 우선 수집",stayFocused:"집중하고 빠르게 반응",buildHighScore:"고점수 기록 구축",fruitFromFourDirections:"과일이 네 방향에서 무작위로 나타남",curvedTrajectory:"과일이 곡선 궤적으로 떨어짐",realTimeFeedback:"게임 중 실시간 수확 피드백",detailedStats:"게임 종료 시 상세 통계",fixedBasketPosition:"바구니 위치 완전 고정으로 진동 없음",increasedFrequency:"과일 출현 빈도 대폭 증가"},vi:{title:"Hái Trái Cây",start:"Bắt Đầu Trò Chơi",restart:"Chơi Lại",score:"Điểm",time:"Thời Gian",level:"Cấp Độ",collected:"Thu Hoạch",highScore:"Điểm Cao Nhất",rules:"Luật Chơi",close:"Đóng",hideRules:"Ẩn Luật",basicGameplay:"Cách Chơi Cơ Bản",scoreSystem:"Hệ Thống Điểm",levelSystem:"Hệ Thống Cấp Độ",tips:"Mẹo",newFeatures:"Tính Năng Mới",clickFruit:"Nhấp vào trái cây rơi để nhận điểm",putFruitInBasket:"Đặt trái cây thu hoạch vào giỏ bên dưới",gameTime:"Thời Gian Chơi",seconds:"giây",fruitSpeed:"Trái cây sẽ rơi ngẫu nhiên và tăng tốc",apple:"Táo",orange:"Cam",banana:"Chuối",strawberry:"Dâu tây",grape:"Nho",peach:"Đào",points:"điểm",level1:"Cấp 1",level2:"Cấp 2",level3:"Cấp 3",level4:"Cấp 4",fruitFaster:"trái cây nhanh hơn",moreFrequent:"thường xuyên hơn",extremeSpeed:"tốc độ cực hạn",prioritizeHighScore:"Ưu tiên trái cây điểm cao",stayFocused:"Tập trung, phản ứng nhanh",buildHighScore:"Xây dựng kỷ lục điểm cao",fruitFromFourDirections:"Trái cây xuất hiện từ bốn hướng ngẫu nhiên",curvedTrajectory:"Trái cây rơi theo quỹ đạo cong",realTimeFeedback:"Phản hồi thu hoạch thời gian thực trong game",detailedStats:"Thống kê chi tiết khi kết thúc game",fixedBasketPosition:"Vị trí giỏ hoàn toàn cố định không rung",increasedFrequency:"Tần suất xuất hiện trái cây tăng đáng kể"},th:{title:"เก็บผลไม้",start:"เริ่มเกม",restart:"เริ่มใหม่",score:"คะแนน",time:"เวลา",level:"ระดับ",collected:"เก็บ",highScore:"คะแนนสูงสุด",rules:"กฎเกม",close:"ปิด",hideRules:"ซ่อนกฎ",basicGameplay:"การเล่นพื้นฐาน",scoreSystem:"ระบบคะแนน",levelSystem:"ระบบระดับ",tips:"เคล็ดลับ",newFeatures:"คุณสมบัติใหม่",clickFruit:"คลิกผลไม้ที่ตกลงมาเพื่อได้คะแนน",putFruitInBasket:"ใส่ผลไม้ที่เก็บได้ลงในตะกร้าข้างล่าง",gameTime:"เวลาเกม",seconds:"วินาที",fruitSpeed:"ผลไม้จะตกลงมาแบบสุ่มและเร็วขึ้น",apple:"แอปเปิ้ล",orange:"ส้ม",banana:"กล้วย",strawberry:"สตรอเบอร์รี่",grape:"องุ่น",peach:"พีช",points:"คะแนน",level1:"ระดับ 1",level2:"ระดับ 2",level3:"ระดับ 3",level4:"ระดับ 4",fruitFaster:"ผลไม้เร็วขึ้น",moreFrequent:"บ่อยขึ้น",extremeSpeed:"ความเร็วสุดขีด",prioritizeHighScore:"ให้ความสำคัญกับผลไม้คะแนนสูง",stayFocused:"มีสมาธิและตอบสนองเร็ว",buildHighScore:"สร้างสถิติคะแนนสูง",fruitFromFourDirections:"ผลไม้ปรากฏจากสี่ทิศทางแบบสุ่ม",curvedTrajectory:"ผลไม้ตกลงมาด้วยวิถีโค้ง",realTimeFeedback:"การตอบสนองการเก็บเกี่ยวแบบเรียลไทม์ในเกม",detailedStats:"สถิติรายละเอียดเมื่อเกมจบ",fixedBasketPosition:"ตำแหน่งตะกร้าคงที่โดยไม่สั่น",increasedFrequency:"ความถี่การปรากฏของผลไม้เพิ่มขึ้นอย่างมาก"},la:{title:"Fructus Colligere",start:"Ludum Incipere",restart:"Iterum Incipere",score:"Puncta",time:"Tempus",level:"Gradus",collected:"Collecta",highScore:"Puncta Maxima",rules:"Regulae Ludi",close:"Claudere",hideRules:"Regulae Occultare",basicGameplay:"Ludus Basicus",scoreSystem:"Systema Punctorum",levelSystem:"Systema Graduum",tips:"Consilia",newFeatures:"Facultates Novae",clickFruit:"Clicca fructus cadentes ut puncta accipias",putFruitInBasket:"Pone fructus collectos in corbem infra",gameTime:"Tempus Ludi",seconds:"secundis",fruitSpeed:"Fructus cadent temere et velocitate crescente",apple:"Malum",orange:"Aurantium",banana:"Musa",strawberry:"Fragum",grape:"Uva",peach:"Persicum",points:"puncta",level1:"Gradus 1",level2:"Gradus 2",level3:"Gradus 3",level4:"Gradus 4",fruitFaster:"fructus velociores",moreFrequent:"frequentiores",extremeSpeed:"velocitas extrema",prioritizeHighScore:"Prioritiza fructus punctis altis",stayFocused:"Mane attentus, reage celeriter",buildHighScore:"Aedifica puncta alta",fruitFromFourDirections:"Fructus apparent ex quattuor directionibus temere",curvedTrajectory:"Fructus cadunt cum trajectoriis curvis",realTimeFeedback:"Feedback collectionis tempore reali in ludo",detailedStats:"Statisticae detaillatae cum ludus finitur",fixedBasketPosition:"Positio corbis omnino fixa sine vibratione",increasedFrequency:"Frequentia fructuum apparendi multum aucta"},ms:{title:"Kutip Buah",start:"Mulakan Permainan",restart:"Mulakan Semula",score:"Markah",time:"Masa",level:"Tahap",collected:"Kutip",highScore:"Markah Tertinggi",rules:"Peraturan Permainan",close:"Tutup",hideRules:"Sembunyikan Peraturan",basicGameplay:"Permainan Asas",scoreSystem:"Sistem Markah",levelSystem:"Sistem Tahap",tips:"Petua",newFeatures:"Ciri Baharu",clickFruit:"Klik buah yang jatuh untuk dapat markah",putFruitInBasket:"Letakkan buah yang dikutip ke dalam bakul di bawah",gameTime:"Masa Permainan",seconds:"saat",fruitSpeed:"Buah akan jatuh secara rawak dan laju bertambah",apple:"Epal",orange:"Oren",banana:"Pisang",strawberry:"Strawberi",grape:"Anggur",peach:"Pic",points:"markah",level1:"Tahap 1",level2:"Tahap 2",level3:"Tahap 3",level4:"Tahap 4",fruitFaster:"buah lebih cepat",moreFrequent:"lebih kerap",extremeSpeed:"kelajuan melampau",prioritizeHighScore:"Utamakan buah markah tinggi",stayFocused:"Kekal fokus, bertindak pantas",buildHighScore:"Bina rekod markah tinggi",fruitFromFourDirections:"Buah muncul dari empat arah secara rawak",curvedTrajectory:"Buah jatuh dengan trajektori melengkung",realTimeFeedback:"Maklum balas kutipan masa nyata semasa permainan",detailedStats:"Statistik terperinci apabila permainan tamat",fixedBasketPosition:"Kedudukan bakul tetap sepenuhnya tanpa getaran",increasedFrequency:"Kekerapan kemunculan buah meningkat dengan ketara"}};return((Y=Z[e])==null?void 0:Y[K])||Z["zh-TW"][K]||K},[d,h]=w.useState([]),[m,g]=w.useState({}),[x,S]=w.useState([]),[I,_]=w.useState(0),[R,T]=w.useState(!1),[A,D]=w.useState(30),[F,X]=w.useState(!1),[ie,G]=w.useState(1),[N,E]=w.useState(0);w.useEffect(()=>{const K=Dd("fruitPicking");K&&_(K.highScore||0)},[]),w.useEffect(()=>{if(!F||s.length===0)return;const K=setInterval(()=>{a(Z=>Z.map(ae=>{const se=ae.curveOffset||0,re=ae.curveSpeed||.05,ne=Date.now()*.001,W=Math.sin(ne*re+se)*4,$=Math.cos(ne*re+se)*2,ee=Math.sin(ne*re*2+se)*2,he=Math.cos(ne*re*1.5+se)*1,_e=Math.sin(ne*re*.5+se)*3,ve=W+ee+_e,Le=$+he;return{...ae,y:ae.y+(ae.directionY||ae.speed||1)+Le,x:ae.x+(ae.directionX||ae.direction||0)+ve}}).filter(ae=>ae.y>-20&&ae.y<120&&ae.x>-20&&ae.x<120))},100);return()=>clearInterval(K)},[F,s.length]),w.useEffect(()=>{t>I&&(_(t),zd("fruitPicking",{highScore:t}))},[t,I]),w.useEffect(()=>{t>=100&&ie===1?G(2):t>=250&&ie===2?G(3):t>=500&&ie===3&&G(4)},[t,ie]);const P=[{type:"apple",emoji:"🍎",points:10},{type:"orange",emoji:"🍊",points:15},{type:"banana",emoji:"🍌",points:20},{type:"strawberry",emoji:"🍓",points:25},{type:"grape",emoji:"🍇",points:30},{type:"peach",emoji:"🍑",points:35}],M=()=>{X(!0),r(0),D(30),G(1),E(0),h([]),a([]),g({}),S([]);let K,Z;K=setInterval(()=>{D(Y=>Y<=1?(clearInterval(K),clearInterval(Z),X(!1),0):Y-1)},1e3),setTimeout(()=>{O(),Z=setInterval(()=>{O(),ie>=3&&setTimeout(()=>O(),200),ie>=4&&setTimeout(()=>O(),400)},ie===1?1200:ie===2?800:ie===3?600:400)},100)},O=()=>{const K=P[Math.floor(Math.random()*P.length)],Z=ie===1?1:ie===2?1.5:ie===3?2:2.5,Y=Math.floor(Math.random()*4),ae=Math.random()<.3;let se,re,ne,W;switch(Y){case 0:se=Math.random()*80+10,re=-10,ne=(Math.random()-.5)*.3,W=Z;break;case 1:se=Math.random()*80+10,re=110,ne=(Math.random()-.5)*.3,W=-Z;break;case 2:se=-10,re=Math.random()*80+10,ne=Z,W=(Math.random()-.5)*.3;break;case 3:se=110,re=Math.random()*80+10,ne=-Z,W=(Math.random()-.5)*.3;break;default:se=Math.random()*80+10,re=-10,ne=(Math.random()-.5)*.3,W=Z}const $={id:Date.now()+Math.random(),x:se,y:re,type:K.type,emoji:K.emoji,speed:Z,direction:0,directionX:ne,directionY:W,curveOffset:Math.random()*Math.PI*2,curveSpeed:Math.random()*.15+.08};if(a(ee=>[...ee,$]),ae){const ee=P[Math.floor(Math.random()*P.length)],he=Math.random()*80+10,ve={id:Date.now()+Math.random()+1,x:he,y:-10,type:ee.type,emoji:ee.emoji,speed:Z,direction:0,directionX:(Math.random()-.5)*.3,directionY:Z,curveOffset:Math.random()*Math.PI*2,curveSpeed:Math.random()*.15+.08};a(Le=>[...Le,ve])}},z=K=>{const Z=s.find(Y=>Y.id===K);if(Z){const Y=P.find(ae=>ae.type===Z.type);a(ae=>ae.filter(se=>se.id!==K)),r(ae=>ae+((Y==null?void 0:Y.points)||10)),E(ae=>ae+1),h(ae=>[...ae,{type:Z.type,emoji:Z.emoji}]),g(ae=>{const se={...ae};return se[Z.type]=(se[Z.type]||0)+1,se}),S(ae=>ae.find(re=>re.type===Z.type)?ae.map(re=>re.type===Z.type?{...re,count:re.count+1}:re):[...ae,{type:Z.type,emoji:Z.emoji,count:1}])}},j=()=>N<5?"😅 新手採果者！":N<10?"🍎 有點手感了！":N<15?"🍊 水果獵人！":N<20?"🍌 採果高手！":N<25?"🍓 水果大師！":"👑 採果之王！";return w.useEffect(()=>{if(x.length>0&&F){const K=setTimeout(()=>{S([])},3e3);return()=>clearTimeout(K)}},[x,F]),i.jsxs("div",{style:{height:"100vh",background:"linear-gradient(180deg, #87CEEB 0%, #98FB98 100%)",padding:"clamp(10px, 2vw, 20px)",position:"relative",overflow:"hidden",isolation:"isolate"},children:[i.jsx("button",{onClick:n,style:{position:"absolute",top:"clamp(20px, 4vw, 40px)",left:"clamp(20px, 4vw, 40px)",background:"#fff",border:"2px solid #6B5BFF",borderRadius:"50%",width:"clamp(40px, 8vw, 50px)",height:"clamp(40px, 8vw, 50px)",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",zIndex:20,fontSize:"clamp(1.2rem, 3vw, 1.5rem)",color:"#6B5BFF"},children:"←"}),i.jsxs("div",{style:{position:"absolute",top:"clamp(20px, 4vw, 40px)",left:"clamp(60px, 12vw, 70px)",background:"rgba(255,255,255,0.9)",borderRadius:"15px",padding:"clamp(12px, 2.5vw, 16px)",zIndex:10,maxWidth:"180px"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"8px"},children:[i.jsxs("h3",{style:{fontSize:"clamp(1rem, 2.5vw, 1.2rem)",margin:0,lineHeight:"1.2"},children:["🍎 ",c("title")]}),i.jsx("button",{onClick:()=>T(!R),style:{background:"#4CAF50",color:"#fff",border:"none",borderRadius:"12px",padding:"2px 8px",fontSize:"clamp(0.6rem, 1.5vw, 0.7rem)",cursor:"pointer"},children:c(R?"hideRules":"rules")})]}),R&&i.jsxs("div",{style:{background:"rgba(255,255,255,0.8)",borderRadius:"10px",padding:"10px",marginBottom:"10px",textAlign:"left",fontSize:"clamp(0.7rem, 1.8vw, 0.8rem)",lineHeight:"1.3",maxHeight:"clamp(200px, 40vh, 300px)",overflowY:"auto",overflowX:"hidden",scrollbarWidth:"thin",scrollbarColor:"#4CAF50 #f0f0f0"},children:[i.jsxs("h4",{style:{marginBottom:"8px",color:"#333"},children:["🍎 ",c("rules"),"："]}),i.jsx("p",{style:{marginBottom:"6px"},children:i.jsxs("strong",{children:[c("basicGameplay"),"："]})}),i.jsxs("p",{style:{marginBottom:"6px"},children:["• ",c("clickFruit")]}),i.jsxs("p",{style:{marginBottom:"6px"},children:["• ",c("putFruitInBasket")]}),i.jsxs("p",{style:{marginBottom:"6px"},children:["• ",c("gameTime"),"：30",c("seconds")]}),i.jsxs("p",{style:{marginBottom:"6px"},children:["• ",c("fruitSpeed")]}),i.jsx("p",{style:{marginBottom:"6px",marginTop:"8px"},children:i.jsxs("strong",{children:[c("scoreSystem"),"："]})}),i.jsxs("p",{style:{marginBottom:"6px"},children:["• 🍎 ",c("apple"),"：10",c("points")]}),i.jsxs("p",{style:{marginBottom:"6px"},children:["• 🍊 ",c("orange"),"：15",c("points")]}),i.jsxs("p",{style:{marginBottom:"6px"},children:["• 🍌 ",c("banana"),"：20",c("points")]}),i.jsxs("p",{style:{marginBottom:"6px"},children:["• 🍓 ",c("strawberry"),"：25",c("points")]}),i.jsxs("p",{style:{marginBottom:"6px"},children:["• 🍇 ",c("grape"),"：30",c("points")]}),i.jsxs("p",{style:{marginBottom:"6px"},children:["• 🍑 ",c("peach"),"：35",c("points")]}),i.jsx("p",{style:{marginBottom:"6px",marginTop:"8px"},children:i.jsxs("strong",{children:[c("levelSystem"),"："]})}),i.jsxs("p",{style:{marginBottom:"6px"},children:["• ",c("level1"),"：100",c("points")," → ",c("level2"),"（",c("fruitFaster"),"）"]}),i.jsxs("p",{style:{marginBottom:"6px"},children:["• ",c("level2"),"：250",c("points")," → ",c("level3"),"（",c("moreFrequent"),"）"]}),i.jsxs("p",{style:{marginBottom:"6px"},children:["• ",c("level3"),"：500",c("points")," → ",c("level4"),"（",c("extremeSpeed"),"）"]}),i.jsx("p",{style:{marginBottom:"6px",marginTop:"8px"},children:i.jsxs("strong",{children:[c("tips"),"："]})}),i.jsxs("p",{style:{marginBottom:"6px"},children:["• ",c("prioritizeHighScore")]}),i.jsxs("p",{style:{marginBottom:"6px"},children:["• ",c("stayFocused")]}),i.jsxs("p",{style:{marginBottom:"6px"},children:["• ",c("buildHighScore")]}),i.jsx("p",{style:{marginBottom:"6px",marginTop:"8px"},children:i.jsxs("strong",{children:[c("newFeatures"),"："]})}),i.jsxs("p",{style:{marginBottom:"6px"},children:["• ",c("fruitFromFourDirections")]}),i.jsxs("p",{style:{marginBottom:"6px"},children:["• ",c("curvedTrajectory")]}),i.jsxs("p",{style:{marginBottom:"6px"},children:["• ",c("realTimeFeedback")]}),i.jsxs("p",{style:{marginBottom:"6px"},children:["• ",c("detailedStats")]}),i.jsxs("p",{style:{marginBottom:"6px"},children:["• ",c("fixedBasketPosition")]}),i.jsxs("p",{style:{marginBottom:"6px"},children:["• ",c("increasedFrequency")]})]}),!R&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{display:"flex",gap:"clamp(4px, 1vw, 8px)",justifyContent:"center",flexWrap:"wrap",marginBottom:"6px"},children:[i.jsxs("div",{style:{fontSize:"clamp(0.7rem, 1.8vw, 0.85rem)"},children:[c("score"),"：",t]}),i.jsxs("div",{style:{fontSize:"clamp(0.7rem, 1.8vw, 0.85rem)"},children:[c("time"),"：",A,"秒"]}),i.jsxs("div",{style:{fontSize:"clamp(0.7rem, 1.8vw, 0.85rem)"},children:[c("level"),"：",ie]})]}),i.jsxs("div",{style:{display:"flex",gap:"clamp(4px, 1vw, 8px)",justifyContent:"center",flexWrap:"wrap"},children:[i.jsxs("div",{style:{fontSize:"clamp(0.6rem, 1.5vw, 0.75rem)"},children:[c("collected"),"：",N,"個"]}),i.jsxs("div",{style:{fontSize:"clamp(0.6rem, 1.5vw, 0.75rem)"},children:[c("highScore"),"：",I]})]}),i.jsx("div",{style:{fontSize:"clamp(0.7rem, 1.8vw, 0.85rem)",color:"#FF5722",fontWeight:"bold",marginTop:"6px",textAlign:"center"},children:j()}),!F&&i.jsx("button",{onClick:M,style:{background:"#FF9800",color:"#fff",border:"none",borderRadius:"20px",padding:"clamp(5px, 1.2vw, 6px) clamp(12px, 2.5vw, 18px)",fontSize:"clamp(0.8rem, 2vw, 0.9rem)",fontWeight:"bold",marginTop:"8px",cursor:"pointer",transition:"all 0.3s ease"},children:c(A===30?"start":"restart")})]})]}),!F&&A===0&&i.jsx("div",{style:{position:"absolute",bottom:"clamp(120px, 20vw, 140px)",left:"50%",transform:"translateX(-50%)",display:"flex",gap:"15px",flexWrap:"wrap",justifyContent:"center",zIndex:10},children:Object.entries(m).map(([K,Z])=>{const Y=P.find(ae=>ae.type===K);return i.jsxs("div",{style:{position:"relative",display:"flex",flexDirection:"column",alignItems:"center",gap:"2px"},children:[i.jsx("span",{style:{fontSize:"clamp(2rem, 5vw, 3rem)",filter:"drop-shadow(0 2px 4px rgba(0,0,0,0.3))"},children:Y==null?void 0:Y.emoji}),i.jsx("span",{style:{position:"absolute",top:"-5px",right:"-5px",background:"#FF5722",color:"white",borderRadius:"50%",width:"clamp(20px, 4vw, 25px)",height:"clamp(20px, 4vw, 25px)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"clamp(0.6rem, 1.5vw, 0.8rem)",fontWeight:"bold",boxShadow:"0 2px 4px rgba(0,0,0,0.3)"},children:Z})]},K)})}),i.jsx("div",{style:{position:"fixed",bottom:"clamp(10px, 2vw, 20px)",left:"50%",transform:"translateX(-50%)",display:"flex",alignItems:"flex-end",justifyContent:"center",zIndex:5,width:"clamp(200px, 30vw, 250px)",pointerEvents:"none",userSelect:"none",touchAction:"none",willChange:"auto",backfaceVisibility:"hidden",contain:"layout style paint",isolation:"isolate"},children:i.jsx("div",{style:{background:"#8B4513",width:"clamp(150px, 25vw, 200px)",height:"clamp(75px, 12vw, 100px)",borderRadius:"50% 50% 0 0",border:"4px solid #654321",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"clamp(1.5rem, 4vw, 2rem)",overflow:"hidden",position:"relative",zIndex:6,pointerEvents:"none",transform:"translateZ(0)",willChange:"auto",userSelect:"none",touchAction:"none",backfaceVisibility:"hidden",perspective:"none",transformStyle:"flat",contain:"layout style paint",isolation:"isolate"},children:d.length>0?i.jsxs("div",{style:{display:"flex",flexWrap:"wrap",justifyContent:"center",alignItems:"center",gap:"2px",maxWidth:"90%",maxHeight:"90%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",pointerEvents:"none",userSelect:"none",touchAction:"none",willChange:"auto",backfaceVisibility:"hidden"},children:[x.slice(-4).map((K,Z)=>i.jsxs("span",{style:{fontSize:"clamp(0.8rem, 2vw, 1rem)",position:"relative"},children:[K.emoji,i.jsx("span",{style:{position:"absolute",top:"-8px",right:"-8px",background:"#FF5722",color:"white",borderRadius:"50%",width:"clamp(12px, 2.5vw, 16px)",height:"clamp(12px, 2.5vw, 16px)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"clamp(0.5rem, 1.2vw, 0.7rem)",fontWeight:"bold"},children:K.count})]},Z)),x.length===0&&d.slice(-6).map((K,Z)=>i.jsx("span",{style:{fontSize:"clamp(0.8rem, 2vw, 1rem)"},children:K.emoji},Z)),d.length>6&&x.length===0&&i.jsxs("span",{style:{fontSize:"clamp(0.6rem, 1.5vw, 0.8rem)",color:"#fff"},children:["+",d.length-6]})]}):i.jsx("span",{style:{color:"#654321"},children:"🧺"})})}),s.map(K=>i.jsx("div",{onClick:Z=>{Z.stopPropagation(),z(K.id)},style:{position:"absolute",left:`${K.x}%`,top:`${K.y}%`,fontSize:"clamp(1.5rem, 4vw, 2rem)",cursor:"pointer",userSelect:"none",transition:"all 0.1s ease",zIndex:20,touchAction:"manipulation",willChange:"transform"},children:K.emoji},K.id))]})}function W3({onClose:n}){const{lang:e}=Bt(),[t,r]=w.useState(!1),[s,a]=w.useState(0),c=ge=>{var tt;const De={"zh-TW":{title:"情緒泡泡爆破",start:"開始遊戲",restart:"重新開始",score:"分數",time:"時間",combo:"連擊",accuracy:"準確率",highScore:"最高分",rules:"遊戲規則",close:"關閉",hideRules:"隱藏規則",gameOver:"遊戲結束",soundOn:"音效開",soundOff:"音效關",rhythmGame:"音樂節奏",gameplay:"遊戲玩法",clickStartButton:"點擊「開始遊戲」按鈕",preciseBubblePop:"精準戳破泡泡",computer:"電腦",preciseClickCenter:"精準點擊泡泡中心戳破",mobile:"手機",preciseTouchCenter:"精準觸摸泡泡中心戳破",highAccuracyRequired:"需要高精準度，點擊泡泡邊緣無效",fastBubbles:"快速泡泡",harderToPop:"更難戳破，需要更高精準度",slowBubbles:"慢速泡泡",easierToPop:"相對容易戳破",emotionBubbleScore:"情緒泡泡分數",angryBubble:"憤怒泡泡",anxiousBubble:"焦慮泡泡",depressedBubble:"憂鬱泡泡",stressedBubble:"壓力泡泡",irritatedBubble:"暴躁泡泡",frustratedBubble:"沮喪泡泡",points:"分",specialBubbles:"特殊泡泡",bombBubble:"炸彈泡泡",clearAllNearby:"清除周圍所有泡泡",goldenBubble:"金色泡泡",doubleScore:"雙倍分數",ghostBubble:"幽靈泡泡",clickTwice:"需要點擊兩次",chainBubble:"連鎖泡泡",clearSameType:"清除同類型泡泡",timeBubble:"時間泡泡",add5Seconds:"增加5秒時間",accuracySystem:"精準度系統",above:"以上",triggerPowerMode:"觸發能量模式",goodAccuracy:"良好精準度",below:"以下",needImproveAccuracy:"需要提高精準度",powerMode:"能量模式",autoTrigger:"自動觸發",powerModeEasier:"能量模式下更容易戳破泡泡",last10Seconds:"持續10秒後自動結束",comboSystem:"連擊系統",continuousPopExtraScore:"連續戳破泡泡可獲得額外分數",timeLimit:"時間限制",sixtySecondsHighestScore:"60秒內獲得最高分數",gameGoal:"遊戲目標",precisePopEmotionBubbles:"精準戳破情緒泡泡，釋放內心壓力",accuracyChallenge:"精準度挑戰",onlyClickCenterToPop:"只有點擊泡泡中心才能戳破",fastBubblesNeedHigherAccuracy:"快速泡泡需要更高精準度"},"zh-CN":{title:"情绪泡泡爆破",start:"开始游戏",restart:"重新开始",score:"分数",time:"时间",combo:"连击",accuracy:"准确率",highScore:"最高分",rules:"游戏规则",close:"关闭",hideRules:"隐藏规则",gameplay:"游戏玩法",clickStartButton:"点击「开始游戏」按钮",preciseBubblePop:"精准戳破泡泡",computer:"电脑",preciseClickCenter:"精准点击泡泡中心戳破",mobile:"手机",preciseTouchCenter:"精准触摸泡泡中心戳破",highAccuracyRequired:"需要高精准度，点击泡泡边缘无效",fastBubbles:"快速泡泡",harderToPop:"更难戳破，需要更高精准度",slowBubbles:"慢速泡泡",easierToPop:"相对容易戳破",emotionBubbleScore:"情绪泡泡分数",angryBubble:"愤怒泡泡",anxiousBubble:"焦虑泡泡",depressedBubble:"忧郁泡泡",stressedBubble:"压力泡泡",irritatedBubble:"暴躁泡泡",frustratedBubble:"沮丧泡泡",points:"分",specialBubbles:"特殊泡泡",bombBubble:"炸弹泡泡",clearAllNearby:"清除周围所有泡泡",goldenBubble:"金色泡泡",doubleScore:"双倍分数",ghostBubble:"幽灵泡泡",clickTwice:"需要点击两次",chainBubble:"连锁泡泡",clearSameType:"清除同类型泡泡",timeBubble:"时间泡泡",add5Seconds:"增加5秒时间",accuracySystem:"精准度系统",above:"以上",triggerPowerMode:"触发能量模式",goodAccuracy:"良好精准度",below:"以下",needImproveAccuracy:"需要提高精准度",powerMode:"能量模式",autoTrigger:"自动触发",powerModeEasier:"能量模式下更容易戳破泡泡",last10Seconds:"持续10秒后自动结束",comboSystem:"连击系统",continuousPopExtraScore:"连续戳破泡泡可获得额外分数",timeLimit:"时间限制",sixtySecondsHighestScore:"60秒内获得最高分数",gameGoal:"游戏目标",precisePopEmotionBubbles:"精准戳破情绪泡泡，释放内心压力",accuracyChallenge:"精准度挑战",onlyClickCenterToPop:"只有点击泡泡中心才能戳破",fastBubblesNeedHigherAccuracy:"快速泡泡需要更高精准度"},en:{title:"Bubble Pop",start:"Start Game",restart:"Restart",score:"Score",time:"Time",combo:"Combo",accuracy:"Accuracy",highScore:"High Score",rules:"Game Rules",close:"Close",hideRules:"Hide Rules",gameplay:"Gameplay",clickStartButton:'Click "Start Game" button',preciseBubblePop:"Precise Bubble Pop",computer:"Computer",preciseClickCenter:"Precisely click bubble center to pop",mobile:"Mobile",preciseTouchCenter:"Precisely touch bubble center to pop",highAccuracyRequired:"High accuracy required, clicking bubble edge is invalid",fastBubbles:"Fast bubbles",harderToPop:"Harder to pop, requires higher accuracy",slowBubbles:"Slow bubbles",easierToPop:"Relatively easier to pop",emotionBubbleScore:"Emotion Bubble Score",angryBubble:"Angry bubble",anxiousBubble:"Anxious bubble",depressedBubble:"Depressed bubble",stressedBubble:"Stressed bubble",irritatedBubble:"Irritated bubble",frustratedBubble:"Frustrated bubble",points:"points",specialBubbles:"Special Bubbles",bombBubble:"Bomb bubble",clearAllNearby:"Clear all nearby bubbles",goldenBubble:"Golden bubble",doubleScore:"Double score",ghostBubble:"Ghost bubble",clickTwice:"Need to click twice",chainBubble:"Chain bubble",clearSameType:"Clear same type bubbles",timeBubble:"Time bubble",add5Seconds:"Add 5 seconds",accuracySystem:"Accuracy System",above:"above",triggerPowerMode:"Trigger power mode",goodAccuracy:"Good accuracy",below:"below",needImproveAccuracy:"Need to improve accuracy",powerMode:"Power Mode",autoTrigger:"Auto trigger",powerModeEasier:"Easier to pop bubbles in power mode",last10Seconds:"Last 10 seconds then auto end",comboSystem:"Combo System",continuousPopExtraScore:"Continuous pop for extra score",timeLimit:"Time Limit",sixtySecondsHighestScore:"60 seconds to get highest score",gameGoal:"Game Goal",precisePopEmotionBubbles:"Precisely pop emotion bubbles, release inner pressure",accuracyChallenge:"Accuracy Challenge",onlyClickCenterToPop:"Only by clicking the center of the bubble can you pop it",fastBubblesNeedHigherAccuracy:"Fast bubbles require higher accuracy"},ja:{title:"バブルポップ",start:"ゲーム開始",restart:"再開",score:"スコア",time:"時間",combo:"コンボ",accuracy:"精度",highScore:"ハイスコア",rules:"ゲームルール",close:"閉じる",hideRules:"ルール非表示",gameplay:"ゲームプレイ",clickStartButton:"「ゲーム開始」ボタンをクリック",preciseBubblePop:"精密バブルポップ",computer:"パソコン",preciseClickCenter:"バブルの中心を精密にクリックしてポップ",mobile:"モバイル",preciseTouchCenter:"バブルの中心を精密にタッチしてポップ",highAccuracyRequired:"高精度が必要、バブルの端をクリックは無効",fastBubbles:"高速バブル",harderToPop:"ポップしにくい、より高い精度が必要",slowBubbles:"低速バブル",easierToPop:"比較的ポップしやすい",emotionBubbleScore:"感情バブルスコア",angryBubble:"怒りバブル",anxiousBubble:"不安バブル",depressedBubble:"憂鬱バブル",stressedBubble:"ストレスバブル",irritatedBubble:"イライラバブル",frustratedBubble:"フラストレーションバブル",points:"ポイント",specialBubbles:"特殊バブル",bombBubble:"爆弾バブル",clearAllNearby:"周辺のすべてのバブルをクリア",goldenBubble:"ゴールデンバブル",doubleScore:"ダブルスコア",ghostBubble:"ゴーストバブル",clickTwice:"2回クリックが必要",chainBubble:"チェーンバブル",clearSameType:"同じタイプのバブルをクリア",timeBubble:"タイムバブル",add5Seconds:"5秒追加",accuracySystem:"精度システム",above:"以上",triggerPowerMode:"パワーモード発動",goodAccuracy:"良好な精度",below:"以下",needImproveAccuracy:"精度向上が必要",powerMode:"パワーモード",autoTrigger:"自動発動",powerModeEasier:"パワーモードでバブルがポップしやすい",last10Seconds:"10秒間続いて自動終了",comboSystem:"コンボシステム",continuousPopExtraScore:"連続ポップでボーナススコア",timeLimit:"時間制限",sixtySecondsHighestScore:"60秒で最高スコアを獲得",gameGoal:"ゲーム目標",precisePopEmotionBubbles:"感情バブルを精密にポップして、内なる圧力を解放",accuracyChallenge:"精度チャレンジ",onlyClickCenterToPop:"バブルの中心をクリックするだけでポップできる",fastBubblesNeedHigherAccuracy:"高速バブルはより高い精度が必要"},ko:{title:"버블 팝",start:"게임 시작",restart:"다시 시작",score:"점수",time:"시간",combo:"콤보",accuracy:"정확도",highScore:"최고 점수",rules:"게임 규칙",close:"닫기",hideRules:"규칙 숨기기",gameplay:"게임 플레이",clickStartButton:"「게임 시작」버튼 클릭",preciseBubblePop:"정밀 버블 팝",computer:"컴퓨터",preciseClickCenter:"버블 중심을 정밀하게 클릭하여 팝",mobile:"모바일",preciseTouchCenter:"버블 중심을 정밀하게 터치하여 팝",highAccuracyRequired:"높은 정확도 필요, 버블 가장자리 클릭은 무효",fastBubbles:"빠른 버블",harderToPop:"팝하기 어려움, 더 높은 정확도 필요",slowBubbles:"느린 버블",easierToPop:"상대적으로 팝하기 쉬움",emotionBubbleScore:"감정 버블 점수",angryBubble:"분노 버블",anxiousBubble:"불안 버블",depressedBubble:"우울 버블",stressedBubble:"스트레스 버블",irritatedBubble:"짜증 버블",frustratedBubble:"좌절 버블",points:"점",specialBubbles:"특수 버블",bombBubble:"폭탄 버블",clearAllNearby:"주변 모든 버블 제거",goldenBubble:"골든 버블",doubleScore:"더블 점수",ghostBubble:"고스트 버블",clickTwice:"두 번 클릭 필요",chainBubble:"체인 버블",clearSameType:"같은 타입 버블 제거",timeBubble:"타임 버블",add5Seconds:"5초 추가",accuracySystem:"정확도 시스템",above:"이상",triggerPowerMode:"파워 모드 발동",goodAccuracy:"좋은 정확도",below:"이하",needImproveAccuracy:"정확도 향상 필요",powerMode:"파워 모드",autoTrigger:"자동 발동",powerModeEasier:"파워 모드에서 버블이 팝하기 쉬움",last10Seconds:"10초간 지속 후 자동 종료",comboSystem:"콤보 시스템",continuousPopExtraScore:"연속 팝으로 보너스 점수",timeLimit:"시간 제한",sixtySecondsHighestScore:"60초 내 최고 점수 획득",gameGoal:"게임 목표",precisePopEmotionBubbles:"감정 버블을 정밀하게 팝하여 내면의 압력을 해방",accuracyChallenge:"정확도 챌린지",onlyClickCenterToPop:"버블의 중심을 클릭해야만 팝할 수 있다",fastBubblesNeedHigherAccuracy:"빠른 버블은 더 높은 정확도가 필요하다"},vi:{title:"Bong Bóng Nổ",start:"Bắt Đầu Trò Chơi",restart:"Chơi Lại",score:"Điểm",time:"Thời Gian",combo:"Combo",accuracy:"Độ Chính Xác",highScore:"Điểm Cao Nhất",rules:"Luật Chơi",close:"Đóng",hideRules:"Ẩn Luật",gameplay:"Cách Chơi",clickStartButton:'Nhấp vào nút "Bắt Đầu Trò Chơi"',preciseBubblePop:"Bong Bóng Nổ Chính Xác",computer:"Máy tính",preciseClickCenter:"Nhấp chính xác vào trung tâm bong bóng để nổ",mobile:"Điện thoại",preciseTouchCenter:"Chạm chính xác vào trung tâm bong bóng để nổ",highAccuracyRequired:"Cần độ chính xác cao, nhấp vào cạnh bong bóng không hiệu quả",fastBubbles:"Bong bóng nhanh",harderToPop:"Khó nổ hơn, cần độ chính xác cao hơn",slowBubbles:"Bong bóng chậm",easierToPop:"Tương đối dễ nổ",emotionBubbleScore:"Điểm Bong Bóng Cảm Xúc",angryBubble:"Bong bóng giận dữ",anxiousBubble:"Bong bóng lo lắng",depressedBubble:"Bong bóng trầm cảm",stressedBubble:"Bong bóng căng thẳng",irritatedBubble:"Bong bóng khó chịu",frustratedBubble:"Bong bóng thất vọng",points:"điểm",specialBubbles:"Bong Bóng Đặc Biệt",bombBubble:"Bong bóng bom",clearAllNearby:"Xóa tất cả bong bóng gần đó",goldenBubble:"Bong bóng vàng",doubleScore:"Điểm gấp đôi",ghostBubble:"Bong bóng ma",clickTwice:"Cần nhấp hai lần",chainBubble:"Bong bóng chuỗi",clearSameType:"Xóa bong bóng cùng loại",timeBubble:"Bong bóng thời gian",add5Seconds:"Thêm 5 giây",accuracySystem:"Hệ Thống Chính Xác",above:"trên",triggerPowerMode:"Kích hoạt chế độ năng lượng",goodAccuracy:"Độ chính xác tốt",below:"dưới",needImproveAccuracy:"Cần cải thiện độ chính xác",powerMode:"Chế Độ Năng Lượng",autoTrigger:"Tự động kích hoạt",powerModeEasier:"Dễ nổ bong bóng hơn trong chế độ năng lượng",last10Seconds:"Kéo dài 10 giây rồi tự động kết thúc",comboSystem:"Hệ Thống Combo",continuousPopExtraScore:"Nổ liên tục để có điểm thêm",timeLimit:"Giới Hạn Thời Gian",sixtySecondsHighestScore:"60 giây để đạt điểm cao nhất",gameGoal:"Mục Tiêu Trò Chơi",precisePopEmotionBubbles:"Nổ chính xác bong bóng cảm xúc, giải phóng áp lực bên trong",accuracyChallenge:"Thử Thách Độ Chính Xác",onlyClickCenterToPop:"Chỉ bằng cách nhấp vào trung tâm bong bóng mới có thể nổ",fastBubblesNeedHigherAccuracy:"Bong bóng nhanh cần độ chính xác cao hơn"},th:{title:"ป๊อปบับเบิล",start:"เริ่มเกม",restart:"เริ่มใหม่",score:"คะแนน",time:"เวลา",combo:"คอมโบ",accuracy:"ความแม่นยำ",highScore:"คะแนนสูงสุด",rules:"กฎเกม",close:"ปิด",hideRules:"ซ่อนกฎ",gameplay:"วิธีเล่น",clickStartButton:'คลิกปุ่ม "เริ่มเกม"',preciseBubblePop:"ป๊อปบับเบิลอย่างแม่นยำ",computer:"คอมพิวเตอร์",preciseClickCenter:"คลิกตรงกลางบับเบิลอย่างแม่นยำเพื่อป๊อป",mobile:"มือถือ",preciseTouchCenter:"แตะตรงกลางบับเบิลอย่างแม่นยำเพื่อป๊อป",highAccuracyRequired:"ต้องการความแม่นยำสูง การคลิกขอบบับเบิลไม่นับ",fastBubbles:"บับเบิลเร็ว",harderToPop:"ป๊อปยากขึ้น ต้องการความแม่นยำสูงขึ้น",slowBubbles:"บับเบิลช้า",easierToPop:"ค่อนข้างป๊อปง่าย",emotionBubbleScore:"คะแนนบับเบิลอารมณ์",angryBubble:"บับเบิลโกรธ",anxiousBubble:"บับเบิลกังวล",depressedBubble:"บับเบิลเศร้า",stressedBubble:"บับเบิลเครียด",irritatedBubble:"บับเบิลหงุดหงิด",frustratedBubble:"บับเบิลหงุดหงิด",points:"คะแนน",specialBubbles:"บับเบิลพิเศษ",bombBubble:"บับเบิลระเบิด",clearAllNearby:"ลบบับเบิลใกล้เคียงทั้งหมด",goldenBubble:"บับเบิลทอง",doubleScore:"คะแนนสองเท่า",ghostBubble:"บับเบิลผี",clickTwice:"ต้องคลิกสองครั้ง",chainBubble:"บับเบิลโซ่",clearSameType:"ลบบับเบิลประเภทเดียวกัน",timeBubble:"บับเบิลเวลา",add5Seconds:"เพิ่ม 5 วินาที",accuracySystem:"ระบบความแม่นยำ",above:"ขึ้นไป",triggerPowerMode:"เปิดโหมดพลัง",goodAccuracy:"ความแม่นยำดี",below:"ลงมา",needImproveAccuracy:"ต้องปรับปรุงความแม่นยำ",powerMode:"โหมดพลัง",autoTrigger:"เปิดอัตโนมัติ",powerModeEasier:"ป๊อปบับเบิลง่ายขึ้นในโหมดพลัง",last10Seconds:"คงอยู่ 10 วินาทีแล้วปิดอัตโนมัติ",comboSystem:"ระบบคอมโบ",continuousPopExtraScore:"ป๊อปต่อเนื่องเพื่อคะแนนเพิ่ม",timeLimit:"จำกัดเวลา",sixtySecondsHighestScore:"60 วินาทีเพื่อคะแนนสูงสุด",gameGoal:"เป้าหมายเกม",precisePopEmotionBubbles:"ป๊อปบับเบิลอารมณ์อย่างแม่นยำ ปลดปล่อยแรงกดดันภายใน",accuracyChallenge:"ความท้าทายความแม่นยำ",onlyClickCenterToPop:"เฉพาะการคลิกตรงกลางบับเบิลเท่านั้นที่สามารถป๊อปได้",fastBubblesNeedHigherAccuracy:"บับเบิลเร็วต้องการความแม่นยำสูงขึ้น"},la:{title:"Bulla Explodere",start:"Ludum Incipere",restart:"Iterum Incipere",score:"Puncta",time:"Tempus",combo:"Combo",accuracy:"Accuratio",highScore:"Puncta Maxima",rules:"Regulae Ludi",close:"Claudere",hideRules:"Regulae Occultare",gameplay:"Ludus",clickStartButton:'Clicca "Ludum Incipere" pugnum',preciseBubblePop:"Bulla Accurata Explodere",computer:"Computatrum",preciseClickCenter:"Clicca accurate centrum bullae ut explodat",mobile:"Mobile",preciseTouchCenter:"Tange accurate centrum bullae ut explodat",highAccuracyRequired:"Accuratio alta requiritur, cliccare marginem bullae invalidum est",fastBubbles:"Bullae veloces",harderToPop:"Difficilius explodere, accuratio altior requiritur",slowBubbles:"Bullae tardae",easierToPop:"Relativiter facilius explodere",emotionBubbleScore:"Puncta Bullae Emotionis",angryBubble:"Bulla irata",anxiousBubble:"Bulla anxia",depressedBubble:"Bulla depressa",stressedBubble:"Bulla pressa",irritatedBubble:"Bulla irritata",frustratedBubble:"Bulla frustrata",points:"puncta",specialBubbles:"Bullae Speciales",bombBubble:"Bulla bomba",clearAllNearby:"Clara omnes bullas proximas",goldenBubble:"Bulla aurea",doubleScore:"Puncta dupla",ghostBubble:"Bulla phantasma",clickTwice:"Opus est bis cliccare",chainBubble:"Bulla catena",clearSameType:"Clara bullas eiusdem generis",timeBubble:"Bulla temporis",add5Seconds:"Adde 5 secundis",accuracySystem:"Systema Accurationis",above:"supra",triggerPowerMode:"Activa modum potentiae",goodAccuracy:"Accuratio bona",below:"infra",needImproveAccuracy:"Opus est accuratio meliorare",powerMode:"Modus Potentiae",autoTrigger:"Auto activa",powerModeEasier:"Facilius explodere bullas in modo potentiae",last10Seconds:"Dura 10 secundis deinde auto finis",comboSystem:"Systema Combo",continuousPopExtraScore:"Explodere continuum pro punctis extra",timeLimit:"Finis Temporis",sixtySecondsHighestScore:"60 secundis pro punctis maximis",gameGoal:"Finis Ludi",precisePopEmotionBubbles:"Explodere accurate bullas emotionis, libera pressionem internam",accuracyChallenge:"Provocatio Accurationis",onlyClickCenterToPop:"Solum cliccare centrum bullae potest explodere",fastBubblesNeedHigherAccuracy:"Bullae veloces accuratio altior requiritur"},ms:{title:"Letup Buih",start:"Mulakan Permainan",restart:"Mulakan Semula",score:"Markah",time:"Masa",combo:"Combo",accuracy:"Ketepatan",highScore:"Markah Tertinggi",rules:"Peraturan Permainan",close:"Tutup",hideRules:"Sembunyikan Peraturan",gameplay:"Cara Bermain",clickStartButton:'Klik butang "Mulakan Permainan"',preciseBubblePop:"Letup Buih Tepat",computer:"Komputer",preciseClickCenter:"Klik tepat di tengah buih untuk meletup",mobile:"Mudah alih",preciseTouchCenter:"Sentuh tepat di tengah buih untuk meletup",highAccuracyRequired:"Ketepatan tinggi diperlukan, mengklik tepi buih tidak sah",fastBubbles:"Buih pantas",harderToPop:"Lebih sukar untuk meletup, memerlukan ketepatan lebih tinggi",slowBubbles:"Buih perlahan",easierToPop:"Relatif lebih mudah untuk meletup",emotionBubbleScore:"Markah Buih Emosi",angryBubble:"Buih marah",anxiousBubble:"Buih cemas",depressedBubble:"Buih tertekan",stressedBubble:"Buih tertekan",irritatedBubble:"Buih jengkel",frustratedBubble:"Buih kecewa",points:"markah",specialBubbles:"Buih Khas",bombBubble:"Buih bom",clearAllNearby:"Kosongkan semua buih berdekatan",goldenBubble:"Buih emas",doubleScore:"Markah berganda",ghostBubble:"Buih hantu",clickTwice:"Perlu klik dua kali",chainBubble:"Buih rantai",clearSameType:"Kosongkan buih jenis sama",timeBubble:"Buih masa",add5Seconds:"Tambah 5 saat",accuracySystem:"Sistem Ketepatan",above:"ke atas",triggerPowerMode:"Pencetus mod kuasa",goodAccuracy:"Ketepatan baik",below:"ke bawah",needImproveAccuracy:"Perlu tingkatkan ketepatan",powerMode:"Mod Kuasa",autoTrigger:"Pencetus automatik",powerModeEasier:"Lebih mudah meletup buih dalam mod kuasa",last10Seconds:"Bertahan 10 saat kemudian tamat automatik",comboSystem:"Sistem Combo",continuousPopExtraScore:"Letup berterusan untuk markah tambahan",timeLimit:"Had Masa",sixtySecondsHighestScore:"60 saat untuk markah tertinggi",gameGoal:"Matlamat Permainan",precisePopEmotionBubbles:"Letup tepat buih emosi, lepaskan tekanan dalaman",accuracyChallenge:"Cabaran Ketepatan",onlyClickCenterToPop:"Hanya dengan mengklik pusat buih boleh meletup",fastBubblesNeedHigherAccuracy:"Buih pantas memerlukan ketepatan lebih tinggi"}};return((tt=De[e])==null?void 0:tt[ge])||De["zh-TW"][ge]||ge},[d,h]=w.useState(60),[m,g]=w.useState(0),[x,S]=w.useState(0),[I,_]=w.useState(!1),[R,T]=w.useState(0),[A,D]=w.useState(!1),[F,X]=w.useState(0),[ie,G]=w.useState(0),[N,E]=w.useState(0),[P,M]=w.useState(!1),[O,z]=w.useState(0),[j,K]=w.useState([]),[Z,Y]=w.useState([]);w.useEffect(()=>{const ge=localStorage.getItem("bubblePopHighScore");ge&&S(parseInt(ge))},[]);const ae=[{color:"#ff6b6b",emotion:"😠",points:10,name:"憤怒"},{color:"#4ecdc4",emotion:"😰",points:15,name:"焦慮"},{color:"#ffe66d",emotion:"😔",points:20,name:"憂鬱"},{color:"#a8e6cf",emotion:"😤",points:25,name:"壓力"},{color:"#ff8a80",emotion:"😡",points:30,name:"暴躁"},{color:"#9575cd",emotion:"😞",points:35,name:"沮喪"}],se=()=>{const ge=["戳破煩惱，釋放心情！","泡泡爆破，壓力全消！","情緒泡泡，一戳就爆！","連擊模式，心情舒暢！","泡泡療法，治癒心靈！"];return ge[Math.floor(Math.random()*ge.length)]},[re]=w.useState(se()),ne=()=>{r(!0),a(0),h(60),g(0),K([]),Y([]),X(0),G(0),E(0),M(!1),z(0)},W=()=>{if(!t)return;const ge=ae[Math.floor(Math.random()*ae.length)],De=Math.random()*80+10,tt=Math.random()*80+10,Ye=Math.random();let We;Ye<.3?We=Math.random()*10+15:Ye<.6?We=Math.random()*15+25:Ye<.85?We=Math.random()*20+40:We=Math.random()*25+60;const pe=Math.random();let Se="normal",we=ge.points,Re=ge.color,Ce=ge.emotion;if(pe<.05)Se="bomb",we=50,Re="#ff4757",Ce="💣",We=Math.random()*15+45;else if(pe<.1)Se="golden",we=100,Re="#ffa502",Ce="⭐",We=Math.random()*20+50;else{if(pe<.15)return Se="ghost",we=30,Re="#a4b0be",Ce="👻",We=Math.random()*10+20,{id:Date.now(),x:De,y:tt,size:We,color:Re,emotion:Ce,points:we,speed:Math.random()*3+2,opacity:.8+Math.random()*.2,type:Se,health:2};pe<.2?(Se="chain",we=40,Re="#2ed573",Ce="🔗",We=Math.random()*15+35):pe<.25&&(Se="time",we=25,Re="#3742fa",Ce="⏰",We=Math.random()*12+25)}const U={id:Date.now(),x:De,y:tt,size:We,color:Re,emotion:Ce,points:we,speed:Math.random()*3+1.5,opacity:.8+Math.random()*.2,type:Se,chainId:Se==="chain"?Math.floor(Math.random()*1e3):void 0,timeBonus:Se==="time"?5:void 0};K(V=>[...V,U])},$=ge=>{const De=j.find(Se=>Se.id===ge);if(!De)return;const tt=Math.floor(m/5)*5;let Ye=De.points+tt;if(De.type==="bomb"){const Se=j.filter(we=>we.id!==ge&&Math.sqrt((we.x-De.x)**2+(we.y-De.y)**2)<15);Se.forEach(we=>{Ye+=we.points,g(Re=>Re+1)}),K(we=>we.filter(Re=>Re.id!==ge&&!Se.find(Ce=>Ce.id===Re.id)))}else if(De.type==="golden")Ye*=2,K(Se=>Se.filter(we=>we.id!==ge));else if(De.type==="ghost"){if(De.health&&De.health>1){K(Se=>Se.map(we=>we.id===ge?{...we,health:we.health-1}:we));return}K(Se=>Se.filter(we=>we.id!==ge))}else if(De.type==="chain"){const Se=j.filter(we=>we.id!==ge&&we.chainId===De.chainId);Se.forEach(we=>{Ye+=we.points,g(Re=>Re+1)}),K(we=>we.filter(Re=>Re.id!==ge&&!Se.find(Ce=>Ce.id===Re.id)))}else De.type==="time"?(h(Se=>Se+(De.timeBonus||5)),K(Se=>Se.filter(we=>we.id!==ge))):K(Se=>Se.filter(we=>we.id!==ge));a(Se=>Se+Ye),g(Se=>Se+1),T(3),m>=4&&(D(!0),nt(),setTimeout(()=>D(!1),1e3));const We=De.type==="bomb"?15:8,pe=[];for(let Se=0;Se<We;Se++){const we=Se/We*Math.PI*2,Re=2+Math.random()*3;pe.push({id:Date.now()+Se,x:De.x,y:De.y,vx:Math.cos(we)*Re,vy:Math.sin(we)*Re,color:De.color,life:1})}Y(Se=>[...Se,...pe])},ee=()=>{r(!1),s>x&&(S(s),localStorage.setItem("bubblePopHighScore",s.toString()))};w.useEffect(()=>{if(!t)return;const ge=setInterval(()=>{const De=.03+(60-d)*.001,tt=Math.min(.15,De*1.8);Math.random()<tt&&W(),K(Ye=>Ye.map(We=>({...We,y:We.y-We.speed*1.2,opacity:We.opacity-.003,x:We.x+(Math.random()-.5)*.4})).filter(We=>We.y>-10&&We.opacity>.1)),Y(Ye=>Ye.map(We=>({...We,x:We.x+We.vx,y:We.y+We.vy,vy:We.vy+.1,life:We.life-.02})).filter(We=>We.life>0)),R>0?T(Ye=>Ye-.05):m>0&&g(0),O>0?z(Ye=>Ye-.05):P&&M(!1)},30);return()=>clearInterval(ge)},[t]),w.useEffect(()=>{if(!t||d<=0)return;const ge=setInterval(()=>{h(De=>De<=1?(ee(),0):De-1)},1e3);return()=>clearInterval(ge)},[t,d]),w.useEffect(()=>{},[t,j]);const[he,_e]=w.useState(null),[ve,Le]=w.useState(!0);w.useEffect(()=>{if(typeof window<"u"&&window.AudioContext){const ge=new AudioContext;_e(ge)}},[]);const Ne=()=>{if(!(!he||!ve))try{const ge=he.createOscillator(),De=he.createGain();ge.connect(De),De.connect(he.destination),ge.type="sine",ge.frequency.setValueAtTime(800,he.currentTime),ge.frequency.exponentialRampToValueAtTime(200,he.currentTime+.1),De.gain.setValueAtTime(.3,he.currentTime),De.gain.exponentialRampToValueAtTime(.01,he.currentTime+.1),ge.start(he.currentTime),ge.stop(he.currentTime+.1)}catch(ge){console.log("音效播放失敗:",ge)}},nt=()=>{if(!(!he||!ve))try{const ge=he.createOscillator(),De=he.createGain();ge.connect(De),De.connect(he.destination),ge.type="square",ge.frequency.setValueAtTime(1e3,he.currentTime),ge.frequency.exponentialRampToValueAtTime(400,he.currentTime+.2),De.gain.setValueAtTime(.2,he.currentTime),De.gain.exponentialRampToValueAtTime(.01,he.currentTime+.2),ge.start(he.currentTime),ge.stop(he.currentTime+.2)}catch(ge){console.log("連擊音效播放失敗:",ge)}},Je=()=>{if(!(!he||!ve))try{const ge=he.createOscillator(),De=he.createGain();ge.connect(De),De.connect(he.destination),ge.type="sawtooth",ge.frequency.setValueAtTime(600,he.currentTime),ge.frequency.exponentialRampToValueAtTime(1200,he.currentTime+.3),De.gain.setValueAtTime(.15,he.currentTime),De.gain.exponentialRampToValueAtTime(.01,he.currentTime+.3),ge.start(he.currentTime),ge.stop(he.currentTime+.3)}catch(ge){console.log("能量模式音效播放失敗:",ge)}};return i.jsxs("div",{style:{width:"100vw",height:"100vh",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",position:"relative",overflow:"hidden",cursor:t?"pointer":"default",touchAction:"none",userSelect:"none",WebkitUserSelect:"none",WebkitTouchCallout:"none"},onClick:ge=>{ge.preventDefault(),ge.stopPropagation()},onMouseDown:ge=>{ge.preventDefault(),ge.stopPropagation()},children:[i.jsx("style",{children:`
          @keyframes float {
            0%, 100% { transform: translate(-50%, -50%) translateY(0px); }
            50% { transform: translate(-50%, -50%) translateY(-10px); }
          }
          @keyframes comboEffect {
            0% { 
              transform: translate(-50%, -50%) scale(0.5);
              opacity: 0;
            }
            50% { 
              transform: translate(-50%, -50%) scale(1.2);
              opacity: 1;
            }
            100% { 
              transform: translate(-50%, -50%) scale(1);
              opacity: 0;
            }
          }
          @keyframes powerMode {
            0% { 
              opacity: 0.7;
              textShadow: 0 0 5px #FF5722;
            }
            100% { 
              opacity: 1;
              textShadow: 0 0 15px #FF5722, 0 0 25px #FF5722;
            }
          }
          @keyframes popEffect {
            0% { 
              transform: translate(-50%, -50%) scale(1);
              opacity: 1;
            }
            50% { 
              transform: translate(-50%, -50%) scale(1.3);
              opacity: 0.8;
            }
            100% { 
              transform: translate(-50%, -50%) scale(0);
              opacity: 0;
            }
          }
        `}),i.jsxs("div",{style:{position:"absolute",top:"clamp(20px, 4vw, 40px)",left:"clamp(60px, 12vw, 70px)",background:"rgba(255,255,255,0.9)",borderRadius:"15px",padding:"clamp(12px, 2.5vw, 16px)",zIndex:5,maxWidth:"180px"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"8px"},children:[i.jsxs("h3",{style:{fontSize:"clamp(1rem, 2.5vw, 1.2rem)",margin:0,lineHeight:"1.2"},children:["🫧 ",c("title")]}),i.jsx("button",{onClick:()=>_(!I),style:{background:"#9C27B0",color:"#fff",border:"none",borderRadius:"12px",padding:"2px 8px",fontSize:"clamp(0.6rem, 1.5vw, 0.7rem)",cursor:"pointer"},children:c(I?"hideRules":"rules")})]}),!I&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{display:"flex",gap:"clamp(4px, 1vw, 8px)",justifyContent:"center",flexWrap:"wrap",marginBottom:"6px"},children:[i.jsxs("div",{style:{fontSize:"clamp(0.7rem, 1.8vw, 0.85rem)"},children:[c("score"),"：",s]}),i.jsxs("div",{style:{fontSize:"clamp(0.7rem, 1.8vw, 0.85rem)"},children:[c("time"),"：",d,"秒"]}),i.jsxs("div",{style:{fontSize:"clamp(0.7rem, 1.8vw, 0.85rem)",color:m>=5?"#ff6b6b":m>=3?"#ffa502":"#333",fontWeight:m>=3?"bold":"normal"},children:[c("combo"),"：",m]})]}),i.jsxs("div",{style:{display:"flex",gap:"clamp(4px, 1vw, 8px)",justifyContent:"center",flexWrap:"wrap",marginBottom:"6px"},children:[i.jsxs("div",{style:{fontSize:"clamp(0.7rem, 1.8vw, 0.85rem)",color:F>=80?"#4CAF50":F>=60?"#FF9800":"#F44336"},children:[c("accuracy"),"：",F.toFixed(1),"%"]}),P&&i.jsx("div",{style:{fontSize:"clamp(0.7rem, 1.8vw, 0.85rem)",color:"#FF5722",fontWeight:"bold",animation:"powerMode 0.5s ease-in-out infinite alternate"},children:"⚡能量模式"})]}),i.jsxs("div",{style:{display:"flex",gap:"clamp(4px, 1vw, 8px)",justifyContent:"center",flexWrap:"wrap"},children:[i.jsxs("div",{style:{fontSize:"clamp(0.6rem, 1.5vw, 0.75rem)"},children:["泡泡：",j.length]}),i.jsxs("div",{style:{fontSize:"clamp(0.6rem, 1.5vw, 0.75rem)"},children:[c("highScore"),"：",x]}),i.jsx("div",{style:{fontSize:"clamp(0.6rem, 1.5vw, 0.75rem)",color:j.some(ge=>ge.speed>=3)?"#ff6b6b":j.some(ge=>ge.speed>=2)?"#ffa502":"#4CAF50"},children:j.some(ge=>ge.speed>=3)?"🚀 快速":j.some(ge=>ge.speed>=2)?"⚡ 中速":"🐌 慢速"})]}),i.jsx("div",{style:{display:"flex",justifyContent:"center",marginTop:"clamp(4px, 1vw, 8px)",gap:"clamp(4px, 1vw, 8px)"},children:i.jsxs("button",{onClick:()=>Le(!ve),style:{background:ve?"#4CAF50":"#f44336",color:"white",border:"none",borderRadius:"8px",padding:"clamp(2px, 0.5vw, 4px) clamp(6px, 1.5vw, 8px)",fontSize:"clamp(0.5rem, 1.2vw, 0.6rem)",cursor:"pointer",display:"flex",alignItems:"center",gap:"2px"},children:[ve?"🔊":"🔇"," ",c(ve?"soundOn":"soundOff")]})}),i.jsx("div",{style:{fontSize:"clamp(0.7rem, 1.8vw, 0.85rem)",color:"#9C27B0",fontWeight:"bold",marginTop:"6px",textAlign:"center"},children:re}),!t&&i.jsx("button",{onClick:ne,style:{background:"#9C27B0",color:"#fff",border:"none",borderRadius:"20px",padding:"clamp(5px, 1.2vw, 6px) clamp(12px, 2.5vw, 18px)",fontSize:"clamp(0.8rem, 2vw, 0.9rem)",fontWeight:"bold",marginTop:"8px",cursor:"pointer",transition:"all 0.3s ease"},children:c("start")})]}),I&&i.jsxs("div",{style:{maxHeight:"200px",overflowY:"auto",fontSize:"clamp(0.7rem, 1.8vw, 0.85rem)",lineHeight:"1.4"},children:[i.jsxs("h4",{style:{margin:"0 0 8px 0",color:"#9C27B0"},children:[c("gameplay"),"："]}),i.jsxs("ul",{style:{margin:"0",paddingLeft:"15px"},children:[i.jsxs("li",{children:[i.jsx("strong",{children:c("start")}),"：",c("clickStartButton")]}),i.jsxs("li",{children:[i.jsx("strong",{children:c("preciseBubblePop")}),"：",i.jsx("br",{}),c("computer"),"：",c("preciseClickCenter"),i.jsx("br",{}),c("mobile"),"：",c("preciseTouchCenter"),i.jsx("br",{}),"⚠️ ",c("highAccuracyRequired"),i.jsx("br",{}),"🚀 ",c("fastBubbles"),"：",c("harderToPop"),i.jsx("br",{}),"🐌 ",c("slowBubbles"),"：",c("easierToPop")]}),i.jsxs("li",{children:[i.jsx("strong",{children:c("emotionBubbleScore")}),"：",i.jsx("br",{}),"😠 ",c("angryBubble"),"：10",c("points"),i.jsx("br",{}),"😰 ",c("anxiousBubble"),"：15",c("points"),i.jsx("br",{}),"😔 ",c("depressedBubble"),"：20",c("points"),i.jsx("br",{}),"😤 ",c("stressedBubble"),"：25",c("points"),i.jsx("br",{}),"😡 ",c("irritatedBubble"),"：30",c("points"),i.jsx("br",{}),"😞 ",c("frustratedBubble"),"：35",c("points")]}),i.jsxs("li",{children:[i.jsx("strong",{children:c("specialBubbles")}),"：",i.jsx("br",{}),"💣 ",c("bombBubble"),"：50",c("points"),"，",c("clearAllNearby"),i.jsx("br",{}),"⭐ ",c("goldenBubble"),"：100",c("points"),"，",c("doubleScore"),i.jsx("br",{}),"👻 ",c("ghostBubble"),"：30",c("points"),"，",c("clickTwice"),i.jsx("br",{}),"🔗 ",c("chainBubble"),"：40",c("points"),"，",c("clearSameType"),i.jsx("br",{}),"⏰ ",c("timeBubble"),"：25",c("points"),"，",c("add5Seconds")]}),i.jsxs("li",{children:[i.jsx("strong",{children:c("accuracySystem")}),"：",i.jsx("br",{}),"🟢 80%",c("above"),"：",c("triggerPowerMode"),i.jsx("br",{}),"🟡 60-79%：",c("goodAccuracy"),i.jsx("br",{}),"🔴 60%",c("below"),"：",c("needImproveAccuracy")]}),i.jsxs("li",{children:[i.jsx("strong",{children:c("powerMode")}),"：",i.jsx("br",{}),"⚡ 80%",c("above"),c("autoTrigger"),i.jsx("br",{}),"🎯 ",c("powerModeEasier"),i.jsx("br",{}),"⏱️ ",c("last10Seconds")]}),i.jsxs("li",{children:[i.jsx("strong",{children:c("comboSystem")}),"：",c("continuousPopExtraScore")]}),i.jsxs("li",{children:[i.jsx("strong",{children:c("timeLimit")}),"：",c("60SecondsHighestScore")]}),i.jsxs("li",{children:[i.jsx("strong",{children:c("gameGoal")}),"：",c("precisePopEmotionBubbles"),"！"]})]})]})]}),j.map(ge=>{const De=ge.type==="bomb"?{animation:"float 2s ease-in-out infinite",boxShadow:"0 0 20px #ff4757"}:ge.type==="golden"?{animation:"float 1.5s ease-in-out infinite",boxShadow:"0 0 25px #ffa502"}:ge.type==="ghost"?{animation:"float 1s ease-in-out infinite",opacity:.6}:ge.type==="chain"?{animation:"float 1.8s ease-in-out infinite",boxShadow:"0 0 15px #2ed573"}:ge.type==="time"?{animation:"float 1.2s ease-in-out infinite",boxShadow:"0 0 18px #3742fa"}:{};return i.jsx("div",{style:{position:"absolute",left:`${ge.x}%`,top:`${ge.y}%`,transform:"translate(-50%, -50%)",width:`${ge.size*1.8}px`,height:`${ge.size*1.8}px`,background:`radial-gradient(circle at 30% 30%, ${ge.color}40, ${ge.color})`,borderRadius:"50%",border:`2px solid ${ge.color}80`,display:"flex",alignItems:"center",justifyContent:"center",fontSize:`${Math.max(12,ge.size*.4)}px`,opacity:ge.opacity,cursor:"pointer",transition:"all 0.2s ease",zIndex:20,...De},onMouseEnter:tt=>{tt.currentTarget.style.transform="translate(-50%, -50%) scale(1.1)"},onMouseLeave:tt=>{tt.currentTarget.style.transform="translate(-50%, -50%) scale(1)"},onClick:tt=>{if(tt.preventDefault(),tt.stopPropagation(),console.log("泡泡被點擊:",ge.id),t){const Ye=tt.currentTarget;Ye.style.animation="popEffect 0.4s ease-out forwards";const We=Ye.getBoundingClientRect(),pe=We.left+We.width/2,Se=We.top+We.height/2;for(let we=0;we<12;we++){const Re=document.createElement("div");Re.style.position="fixed",Re.style.left=pe+"px",Re.style.top=Se+"px",Re.style.width="6px",Re.style.height="6px",Re.style.background=ge.color,Re.style.borderRadius="50%",Re.style.pointerEvents="none",Re.style.zIndex="1000",Re.style.boxShadow=`0 0 8px ${ge.color}`,Re.style.transition="all 0.6s ease",document.body.appendChild(Re);const Ce=we*30*Math.PI/180,U=60+Math.random()*40,V=pe+Math.cos(Ce)*U,L=Se+Math.sin(Ce)*U;setTimeout(()=>{Re.style.left=V+"px",Re.style.top=L+"px",Re.style.opacity="0",Re.style.transform="scale(0)"},10),setTimeout(()=>{document.body.contains(Re)&&document.body.removeChild(Re)},600)}G(we=>we+1),E(we=>we+1),$(ge.id),Ne(),F>=80&&!P&&(M(!0),z(10),Je()),X(ie>0?N/ie*100:0)}},onTouchStart:tt=>{tt.preventDefault(),tt.stopPropagation(),console.log("泡泡被觸摸:",ge.id);const Ye=tt.currentTarget;if(Ye.style.transform="translate(-50%, -50%) scale(1.2)",Ye.style.transition="transform 0.1s ease",setTimeout(()=>{Ye.style.transform="translate(-50%, -50%) scale(1)"},100),t){console.log("手機版直接爆破泡泡:",ge.id);const We=tt.currentTarget;We.style.animation="popEffect 0.4s ease-out forwards";const pe=We.getBoundingClientRect(),Se=pe.left+pe.width/2,we=pe.top+pe.height/2;for(let Re=0;Re<12;Re++){const Ce=document.createElement("div");Ce.style.position="fixed",Ce.style.left=Se+"px",Ce.style.top=we+"px",Ce.style.width="6px",Ce.style.height="6px",Ce.style.background=ge.color,Ce.style.borderRadius="50%",Ce.style.pointerEvents="none",Ce.style.zIndex="1000",Ce.style.boxShadow=`0 0 8px ${ge.color}`,Ce.style.transition="all 0.6s ease",document.body.appendChild(Ce);const U=Re*30*Math.PI/180,V=60+Math.random()*40,L=Se+Math.cos(U)*V,oe=we+Math.sin(U)*V;setTimeout(()=>{Ce.style.left=L+"px",Ce.style.top=oe+"px",Ce.style.opacity="0",Ce.style.transform="scale(0)"},10),setTimeout(()=>{document.body.contains(Ce)&&document.body.removeChild(Ce)},600)}G(Re=>Re+1),E(Re=>Re+1),$(ge.id),Ne(),F>=80&&!P&&(M(!0),z(10),Je()),X(ie>0?N/ie*100:0)}},children:ge.emotion},ge.id)}),Z.map(ge=>i.jsx("div",{style:{position:"absolute",left:`${ge.x}%`,top:`${ge.y}%`,transform:"translate(-50%, -50%)",width:"4px",height:"4px",background:ge.color,borderRadius:"50%",opacity:ge.life,pointerEvents:"none"}},ge.id)),A&&i.jsxs("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",fontSize:"clamp(2rem, 5vw, 3rem)",fontWeight:"bold",color:"#ff6b6b",textShadow:"0 0 20px #ff6b6b",animation:"comboEffect 1s ease-out forwards",pointerEvents:"none",zIndex:1e3},children:["COMBO x",m,"!"]}),!t&&i.jsxs("div",{style:{position:"absolute",bottom:"clamp(20px, 4vw, 40px)",left:"50%",transform:"translateX(-50%)",background:"rgba(0,0,0,0.7)",color:"#fff",padding:"clamp(8px, 2vw, 12px)",borderRadius:"10px",fontSize:"clamp(0.7rem, 1.8vw, 0.85rem)",textAlign:"center",zIndex:100},children:["🎯 ",c("accuracyChallenge"),"：",c("onlyClickCenterToPop"),"！",i.jsx("br",{}),"🚀 ",c("fastBubblesNeedHigherAccuracy"),"！"]}),!t&&s>0&&i.jsxs("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",background:"rgba(255,255,255,0.95)",borderRadius:"20px",padding:"clamp(20px, 4vw, 30px)",textAlign:"center",zIndex:1001,minWidth:"clamp(250px, 50vw, 350px)"},children:[i.jsx("h2",{style:{fontSize:"clamp(1.5rem, 3.5vw, 2rem)",margin:"0 0 15px 0",color:"#9C27B0"},children:"遊戲結束！"}),i.jsxs("div",{style:{fontSize:"clamp(1rem, 2.5vw, 1.2rem)",marginBottom:"10px"},children:["最終分數：",s]}),i.jsxs("div",{style:{fontSize:"clamp(0.9rem, 2vw, 1rem)",marginBottom:"20px",color:"#666"},children:["最高分數：",x]}),i.jsxs("div",{style:{display:"flex",gap:"10px",justifyContent:"center"},children:[i.jsx("button",{onClick:ne,style:{background:"#9C27B0",color:"#fff",border:"none",borderRadius:"15px",padding:"clamp(8px, 1.5vw, 12px) clamp(16px, 3vw, 24px)",fontSize:"clamp(0.9rem, 2vw, 1rem)",cursor:"pointer"},children:"再玩一次"}),i.jsx("button",{onClick:n,style:{background:"#666",color:"#fff",border:"none",borderRadius:"15px",padding:"clamp(8px, 1.5vw, 12px) clamp(16px, 3vw, 24px)",fontSize:"clamp(0.9rem, 2vw, 1rem)",cursor:"pointer"},children:"返回"})]})]})]})}function U3({onClose:n}){const{lang:e}=Bt(),[t,r]=w.useState(0),[s,a]=w.useState(0),[c,d]=w.useState(!1),[h,m]=w.useState(60),[g,x]=w.useState(50),[S,I]=w.useState([]),[_,R]=w.useState(3),[T,A]=w.useState(1),[D,F]=w.useState(0),[X,ie]=w.useState(!1),[G,N]=w.useState(!1),E=Z=>{var ae;const Y={"zh-TW":{score:"分數",time:"時間",level:"等級",combo:"連擊",title:"極速賽車",rules:"遊戲規則",close:"關閉",gameOver:"遊戲結束",controlMethod:"控制方式",useArrowKeysOrButtons:"使用方向鍵 ← → 或螢幕按鈕控制賽車",moveLeftRightToAvoid:"左右移動避開障礙物",gameObjective:"遊戲目標",avoidAllObstacles:"避開所有障礙物（石頭、汽車、卡車）",successfulAvoidance:"成功避開獲得5分 + 連擊獎勵",collisionPenalty:"碰撞障礙物扣10分並重置連擊",scoringSystem:"計分系統",baseScore:"基礎分數：避開障礙物 +5分",comboBonus:"連擊獎勵：每次連擊額外 +1分",levelUp:"等級提升：每100分提升一個等級",speedIncrease:"速度增加：等級越高，障礙物移動越快",gameTime:"遊戲時間",sixtySecondsPerGame:"每局遊戲60秒",autoScoreWhenTimeUp:"時間結束自動結算分數"},"zh-CN":{score:"分数",time:"时间",level:"等级",combo:"连击",title:"极速赛车",rules:"游戏规则",close:"关闭",controlMethod:"控制方式",useArrowKeysOrButtons:"使用方向键 ← → 或屏幕按钮控制赛车",moveLeftRightToAvoid:"左右移动避开障碍物",gameObjective:"游戏目标",avoidAllObstacles:"避开所有障碍物（石头、汽车、卡车）",successfulAvoidance:"成功避开获得5分 + 连击奖励",collisionPenalty:"碰撞障碍物扣10分并重置连击",scoringSystem:"计分系统",baseScore:"基础分数：避开障碍物 +5分",comboBonus:"连击奖励：每次连击额外 +1分",levelUp:"等级提升：每100分提升一个等级",speedIncrease:"速度增加：等级越高，障碍物移动越快",gameTime:"游戏时间",sixtySecondsPerGame:"每局游戏60秒",autoScoreWhenTimeUp:"时间结束自动结算分数"},en:{score:"Score",time:"Time",level:"Level",combo:"Combo",title:"Speed Racing",rules:"Game Rules",close:"Close",controlMethod:"Control Method",useArrowKeysOrButtons:"Use arrow keys ← → or screen buttons to control the race car",moveLeftRightToAvoid:"Move left and right to avoid obstacles",gameObjective:"Game Objective",avoidAllObstacles:"Avoid all obstacles (stones, cars, trucks)",successfulAvoidance:"Successfully avoid to get 5 points + combo bonus",collisionPenalty:"Colliding with obstacles deducts 10 points and resets combo",scoringSystem:"Scoring System",baseScore:"Base score: avoid obstacles +5 points",comboBonus:"Combo bonus: +1 point for each combo",levelUp:"Level up: gain one level every 100 points",speedIncrease:"Speed increase: the higher the level, the faster obstacles move",gameTime:"Game Time",sixtySecondsPerGame:"60 seconds per game",autoScoreWhenTimeUp:"Auto score when time is up"},ja:{score:"スコア",time:"時間",level:"レベル",combo:"コンボ",title:"スピードレーシング",rules:"ゲームルール",close:"閉じる",controlMethod:"操作方法",useArrowKeysOrButtons:"矢印キー ← → または画面ボタンでレーシングカーを操作",moveLeftRightToAvoid:"左右に移動して障害物を避ける",gameObjective:"ゲーム目標",avoidAllObstacles:"すべての障害物（石、車、トラック）を避ける",successfulAvoidance:"成功して避けると5ポイント + コンボボーナス",collisionPenalty:"障害物に衝突すると10ポイント減点しコンボリセット",scoringSystem:"スコアシステム",baseScore:"基本スコア：障害物を避けると +5ポイント",comboBonus:"コンボボーナス：各コンボで +1ポイント",levelUp:"レベルアップ：100ポイントごとに1レベルアップ",speedIncrease:"速度増加：レベルが高いほど障害物が速く動く",gameTime:"ゲーム時間",sixtySecondsPerGame:"ゲームあたり60秒",autoScoreWhenTimeUp:"時間切れで自動スコア"},ko:{score:"점수",time:"시간",level:"레벨",combo:"콤보",title:"스피드 레이싱",rules:"게임 규칙",close:"닫기",controlMethod:"조작 방법",useArrowKeysOrButtons:"화살표 키 ← → 또는 화면 버튼으로 레이싱카 조작",moveLeftRightToAvoid:"좌우로 이동하여 장애물 피하기",gameObjective:"게임 목표",avoidAllObstacles:"모든 장애물（돌、자동차、트럭）피하기",successfulAvoidance:"성공적으로 피하면 5점 + 콤보 보너스",collisionPenalty:"장애물과 충돌하면 10점 감점하고 콤보 리셋",scoringSystem:"점수 시스템",baseScore:"기본 점수：장애물 피하기 +5점",comboBonus:"콤보 보너스：각 콤보마다 +1점",levelUp:"레벨 업：100점마다 1레벨 상승",speedIncrease:"속도 증가：레벨이 높을수록 장애물이 빨리 움직임",gameTime:"게임 시간",sixtySecondsPerGame:"게임당 60초",autoScoreWhenTimeUp:"시간 종료 시 자동 점수"},vi:{score:"Điểm",time:"Thời Gian",level:"Cấp Độ",combo:"Combo",title:"Đua Xe Tốc Độ",rules:"Luật Chơi",close:"Đóng",controlMethod:"Phương Pháp Điều Khiển",useArrowKeysOrButtons:"Sử dụng phím mũi tên ← → hoặc nút màn hình để điều khiển xe đua",moveLeftRightToAvoid:"Di chuyển trái phải để tránh chướng ngại vật",gameObjective:"Mục Tiêu Trò Chơi",avoidAllObstacles:"Tránh tất cả chướng ngại vật (đá, xe hơi, xe tải)",successfulAvoidance:"Tránh thành công được 5 điểm + phần thưởng combo",collisionPenalty:"Va chạm với chướng ngại vật trừ 10 điểm và reset combo",scoringSystem:"Hệ Thống Điểm",baseScore:"Điểm cơ bản: tránh chướng ngại vật +5 điểm",comboBonus:"Phần thưởng combo: +1 điểm cho mỗi combo",levelUp:"Tăng cấp: tăng 1 cấp mỗi 100 điểm",speedIncrease:"Tăng tốc độ: cấp càng cao, chướng ngại vật di chuyển càng nhanh",gameTime:"Thời Gian Trò Chơi",sixtySecondsPerGame:"60 giây mỗi trò chơi",autoScoreWhenTimeUp:"Tự động tính điểm khi hết thời gian"},th:{score:"คะแนน",time:"เวลา",level:"ระดับ",combo:"คอมโบ",title:"แข่งรถความเร็ว",rules:"กฎเกม",close:"ปิด",controlMethod:"วิธีการควบคุม",useArrowKeysOrButtons:"ใช้ปุ่มลูกศร ← → หรือปุ่มหน้าจอควบคุมรถแข่ง",moveLeftRightToAvoid:"เคลื่อนที่ซ้ายขวาเพื่อหลบหลีกสิ่งกีดขวาง",gameObjective:"เป้าหมายเกม",avoidAllObstacles:"หลบหลีกสิ่งกีดขวางทั้งหมด（หิน、รถยนต์、รถบรรทุก）",successfulAvoidance:"หลบหลีกสำเร็จได้ 5 คะแนน + โบนัสคอมโบ",collisionPenalty:"ชนสิ่งกีดขวางหัก 10 คะแนนและรีเซ็ตคอมโบ",scoringSystem:"ระบบคะแนน",baseScore:"คะแนนพื้นฐาน：หลบหลีกสิ่งกีดขวาง +5 คะแนน",comboBonus:"โบนัสคอมโบ：+1 คะแนนสำหรับแต่ละคอมโบ",levelUp:"เลเวลอัพ：เพิ่ม 1 เลเวลทุก 100 คะแนน",speedIncrease:"เพิ่มความเร็ว：เลเวลสูงขึ้นสิ่งกีดขวางเคลื่อนที่เร็วขึ้น",gameTime:"เวลาเกม",sixtySecondsPerGame:"60 วินาทีต่อเกม",autoScoreWhenTimeUp:"คะแนนอัตโนมัติเมื่อหมดเวลา"},la:{score:"Puncta",time:"Tempus",level:"Gradus",combo:"Combo",title:"Cursus Velocitatis",rules:"Regulae Ludi",close:"Claudere",controlMethod:"Methodus Controllandi",useArrowKeysOrButtons:"Utere clavis sagittarum ← → vel pugnis scaenae ad currum regendum",moveLeftRightToAvoid:"Move sinistra dextraque ad impedimenta vitanda",gameObjective:"Finis Ludi",avoidAllObstacles:"Vita omnia impedimenta (lapides, currus, plaustra)",successfulAvoidance:"Vitando feliciter accipe 5 puncta + praemium combo",collisionPenalty:"Collidendo cum impedimentis minus 10 puncta et reset combo",scoringSystem:"Systema Punctandi",baseScore:"Puncta fundamentalia: vitando impedimenta +5 puncta",comboBonus:"Praemium combo: +1 punctum pro quaque combo",levelUp:"Gradus sursum: accipe unum gradum pro quaque 100 punctis",speedIncrease:"Auctio velocitatis: altior gradus, velocius impedimenta moventur",gameTime:"Tempus Ludi",sixtySecondsPerGame:"60 secundis pro quaque ludo",autoScoreWhenTimeUp:"Auto puncta quando tempus finitum est"},ms:{score:"Markah",time:"Masa",level:"Tahap",combo:"Combo",title:"Lumba Kereta Laju",rules:"Peraturan Permainan",close:"Tutup",controlMethod:"Kaedah Kawalan",useArrowKeysOrButtons:"Gunakan kekunci anak panah ← → atau butang skrin untuk mengawal kereta lumba",moveLeftRightToAvoid:"Gerakkan kiri kanan untuk mengelakkan halangan",gameObjective:"Objektif Permainan",avoidAllObstacles:"Elakkan semua halangan (batu, kereta, lori)",successfulAvoidance:"Berjaya elakkan dapat 5 markah + bonus combo",collisionPenalty:"Berlanggar dengan halangan tolak 10 markah dan reset combo",scoringSystem:"Sistem Markah",baseScore:"Markah asas: elakkan halangan +5 markah",comboBonus:"Bonus combo: +1 markah untuk setiap combo",levelUp:"Naik tahap: dapat 1 tahap setiap 100 markah",speedIncrease:"Tambah kelajuan: tahap lebih tinggi, halangan bergerak lebih pantas",gameTime:"Masa Permainan",sixtySecondsPerGame:"60 saat setiap permainan",autoScoreWhenTimeUp:"Markah automatik apabila masa habis"}};return((ae=Y[e])==null?void 0:ae[Z])||Y["zh-TW"][Z]||Z};w.useEffect(()=>{const Z=Dd("racing");Z&&a(Z.highScore||0)},[]),w.useEffect(()=>{s>0&&zd("racing",{highScore:s})},[s]);const P=()=>{r(0),m(60),x(50),I([]),R(3),A(1),F(0),d(!0)},M=()=>{d(!1),t>s&&a(t)},O=Z=>{c&&x(Y=>{const ae=Z==="left"?Y-8:Y+8;return Math.max(10,Math.min(90,ae))})},z=()=>{if(!c)return;const Z=["rock","car","truck"],Y=Z[Math.floor(Math.random()*Z.length)],ae=Math.random()*80+10;I(se=>[...se,{id:Date.now(),x:ae,y:-20,type:Y}])},j=(Z,Y)=>Math.abs(Z-Y)<20/2;w.useEffect(()=>{if(!c)return;const Z=setInterval(()=>{m(Y=>Y<=1?(M(),0):Y-1),Math.random()<.02+T*.005&&z(),I(Y=>{const ae=Y.map(se=>({...se,y:se.y+_})).filter(se=>se.y<120);return ae.forEach(se=>{se.y>60&&se.y<80&&(j(g,se.x)?(F(0),r(re=>Math.max(0,re-10))):(F(re=>re+1),r(re=>re+5+D),D>=5&&(ie(!0),setTimeout(()=>ie(!1),1e3))))}),ae}),t>T*100&&(A(Y=>Y+1),R(Y=>Math.min(8,Y+.5)))},50);return()=>clearInterval(Z)},[c,_,T,g,D]),w.useEffect(()=>{const Z=Y=>{c&&(Y.key==="ArrowLeft"||Y.key==="a"?O("left"):(Y.key==="ArrowRight"||Y.key==="d")&&O("right"))};return window.addEventListener("keydown",Z),()=>window.removeEventListener("keydown",Z)},[c]);const K=Z=>{const Y={rock:{background:"#8B4513",borderRadius:"50%"},car:{background:"#FF4444",borderRadius:"5px"},truck:{background:"#FF8800",borderRadius:"8px"}};return Y[Z]||Y.rock};return i.jsxs("div",{style:{width:"100vw",height:"100vh",background:"linear-gradient(180deg, #87CEEB 0%, #98FB98 100%)",position:"relative",overflow:"hidden",fontFamily:"Arial, sans-serif"},children:[i.jsxs("div",{style:{position:"absolute",top:"clamp(20px, 4vw, 40px)",left:"clamp(80px, 16vw, 100px)",background:"rgba(255,255,255,0.9)",padding:"clamp(8px, 1.5vw, 12px)",borderRadius:"10px",fontSize:"clamp(0.8rem, 2vw, 1rem)",zIndex:100},children:[i.jsxs("div",{children:[E("score"),": ",t]}),i.jsxs("div",{children:[E("time"),": ",h,"s"]}),i.jsxs("div",{children:[E("level"),": ",T]}),i.jsxs("div",{children:[E("combo"),": ",D]})]}),i.jsx("div",{style:{position:"absolute",bottom:"20%",left:"0",right:"0",height:"60%",background:"linear-gradient(90deg, #696969 0%, #A9A9A9 20%, #696969 40%, #A9A9A9 60%, #696969 80%, #A9A9A9 100%)",borderTop:"4px solid #FFD700",borderBottom:"4px solid #FFD700"}}),i.jsx("div",{style:{position:"absolute",bottom:"25%",left:`${g}%`,transform:"translateX(-50%)",width:"clamp(40px, 8vw, 60px)",height:"clamp(20px, 4vw, 30px)",background:"linear-gradient(45deg, #FF4444, #FF6666)",borderRadius:"8px",border:"2px solid #CC0000",zIndex:10,transition:"left 0.1s ease"},children:i.jsx("div",{style:{position:"absolute",top:"-8px",left:"50%",transform:"translateX(-50%)",width:"clamp(20px, 4vw, 30px)",height:"clamp(8px, 1.5vw, 12px)",background:"#444",borderRadius:"4px"}})}),S.map(Z=>i.jsx("div",{style:{position:"absolute",bottom:`${Z.y}%`,left:`${Z.x}%`,transform:"translateX(-50%)",width:"clamp(30px, 6vw, 45px)",height:"clamp(15px, 3vw, 22px)",...K(Z.type),zIndex:5}},Z.id)),X&&i.jsxs("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",fontSize:"clamp(2rem, 5vw, 3rem)",fontWeight:"bold",color:"#FFD700",textShadow:"0 0 20px #FFD700",animation:"comboEffect 1s ease-out forwards",pointerEvents:"none",zIndex:1e3},children:["COMBO x",D,"!"]}),i.jsxs("div",{style:{position:"absolute",bottom:"clamp(10px, 2vw, 20px)",left:"50%",transform:"translateX(-50%)",display:"flex",gap:"clamp(10px, 2vw, 20px)",zIndex:100},children:[i.jsx("button",{onClick:()=>O("left"),style:{background:"#FF4444",color:"#fff",border:"none",borderRadius:"50%",width:"clamp(50px, 10vw, 70px)",height:"clamp(50px, 10vw, 70px)",fontSize:"clamp(1.5rem, 3vw, 2rem)",cursor:"pointer",fontWeight:"bold"},children:"←"}),i.jsx("button",{onClick:()=>O("right"),style:{background:"#FF4444",color:"#fff",border:"none",borderRadius:"50%",width:"clamp(50px, 10vw, 70px)",height:"clamp(50px, 10vw, 70px)",fontSize:"clamp(1.5rem, 3vw, 2rem)",cursor:"pointer",fontWeight:"bold"},children:"→"})]}),!c&&i.jsxs("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",background:"rgba(255,255,255,0.95)",borderRadius:"20px",padding:"clamp(20px, 4vw, 30px)",textAlign:"center",zIndex:1001},children:[i.jsx("h2",{style:{fontSize:"clamp(1.5rem, 3.5vw, 2rem)",margin:"0 0 15px 0",color:"#E91E63"},children:E("title")}),i.jsx("p",{style:{fontSize:"clamp(0.9rem, 2vw, 1rem)",marginBottom:"20px",color:"#666"},children:"使用方向鍵或按鈕控制賽車，避開障礙物！"}),i.jsxs("div",{style:{display:"flex",gap:"10px",justifyContent:"center"},children:[i.jsx("button",{onClick:P,style:{background:"#E91E63",color:"#fff",border:"none",borderRadius:"15px",padding:"clamp(10px, 2vw, 15px) clamp(20px, 4vw, 30px)",fontSize:"clamp(1rem, 2.5vw, 1.2rem)",cursor:"pointer",fontWeight:"bold"},children:E("start")}),i.jsx("button",{onClick:()=>N(!0),style:{background:"#666",color:"#fff",border:"none",borderRadius:"15px",padding:"clamp(10px, 2vw, 15px) clamp(20px, 4vw, 30px)",fontSize:"clamp(1rem, 2.5vw, 1.2rem)",cursor:"pointer"},children:E("rules")})]})]}),G&&i.jsx("div",{style:{position:"absolute",top:"0",left:"0",right:"0",bottom:"0",background:"rgba(0,0,0,0.8)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1002},children:i.jsxs("div",{style:{background:"rgba(255,255,255,0.95)",borderRadius:"20px",padding:"clamp(20px, 4vw, 30px)",maxWidth:"clamp(300px, 80vw, 500px)",maxHeight:"clamp(400px, 80vh, 600px)",overflow:"auto"},children:[i.jsxs("h3",{style:{fontSize:"clamp(1.2rem, 3vw, 1.5rem)",margin:"0 0 15px 0",color:"#E91E63",textAlign:"center"},children:[E("title")," - ",E("rules")]}),i.jsxs("div",{style:{fontSize:"clamp(0.9rem, 2vw, 1rem)",lineHeight:"1.6"},children:[i.jsx("p",{children:i.jsxs("strong",{children:["🎮 ",E("controlMethod"),"："]})}),i.jsxs("ul",{children:[i.jsx("li",{children:E("useArrowKeysOrButtons")}),i.jsx("li",{children:E("moveLeftRightToAvoid")})]}),i.jsx("p",{children:i.jsxs("strong",{children:["🎯 ",E("gameObjective"),"："]})}),i.jsxs("ul",{children:[i.jsx("li",{children:E("avoidAllObstacles")}),i.jsx("li",{children:E("successfulAvoidance")}),i.jsx("li",{children:E("collisionPenalty")})]}),i.jsx("p",{children:i.jsxs("strong",{children:["🏆 ",E("scoringSystem"),"："]})}),i.jsxs("ul",{children:[i.jsx("li",{children:E("baseScore")}),i.jsx("li",{children:E("comboBonus")}),i.jsx("li",{children:E("levelUp")}),i.jsx("li",{children:E("speedIncrease")})]}),i.jsx("p",{children:i.jsxs("strong",{children:["⏰ ",E("gameTime"),"："]})}),i.jsxs("ul",{children:[i.jsx("li",{children:E("sixtySecondsPerGame")}),i.jsx("li",{children:E("autoScoreWhenTimeUp")})]})]}),i.jsx("button",{onClick:()=>N(!1),style:{background:"#E91E63",color:"#fff",border:"none",borderRadius:"15px",padding:"clamp(8px, 1.5vw, 12px) clamp(16px, 3vw, 24px)",fontSize:"clamp(0.9rem, 2vw, 1rem)",cursor:"pointer",marginTop:"20px",width:"100%"},children:E("close")})]})}),!c&&t>0&&i.jsxs("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",background:"rgba(255,255,255,0.95)",borderRadius:"20px",padding:"clamp(20px, 4vw, 30px)",textAlign:"center",zIndex:1001},children:[i.jsxs("h2",{style:{fontSize:"clamp(1.5rem, 3.5vw, 2rem)",margin:"0 0 15px 0",color:"#E91E63"},children:[E("gameOver"),"！"]}),i.jsxs("div",{style:{fontSize:"clamp(1rem, 2.5vw, 1.2rem)",marginBottom:"10px"},children:[E("finalScore"),"：",t]}),i.jsxs("div",{style:{fontSize:"clamp(0.9rem, 2vw, 1rem)",marginBottom:"20px",color:"#666"},children:[E("highScore"),"：",s]}),i.jsxs("div",{style:{display:"flex",gap:"10px",justifyContent:"center"},children:[i.jsx("button",{onClick:P,style:{background:"#E91E63",color:"#fff",border:"none",borderRadius:"15px",padding:"clamp(8px, 1.5vw, 12px) clamp(16px, 3vw, 24px)",fontSize:"clamp(0.9rem, 2vw, 1rem)",cursor:"pointer"},children:E("restart")}),i.jsx("button",{onClick:n,style:{background:"#666",color:"#fff",border:"none",borderRadius:"15px",padding:"clamp(8px, 1.5vw, 12px) clamp(16px, 3vw, 24px)",fontSize:"clamp(0.9rem, 2vw, 1rem)",cursor:"pointer"},children:E("back")})]})]})]})}function q3({onClose:n}){const{lang:e}=Bt(),[t,r]=w.useState(0),[s,a]=w.useState(0),[c,d]=w.useState(!1),[h,m]=w.useState(60),[g,x]=w.useState([]),[S,I]=w.useState(0),[_,R]=w.useState(!1),[T,A]=w.useState(null),[D,F]=w.useState(!0),[X,ie]=w.useState(!1),G=z=>{var K;const j={"zh-TW":{score:"分數",time:"時間",combo:"連擊",title:"音樂節奏",rules:"遊戲規則",close:"關閉",gameOver:"遊戲結束",gameplay:"遊戲玩法",clickMovingRhythmPoints:"點擊從上往下移動的節奏點",fourColorsCorrespondToDifferentAudio:"四種顏色的節奏點對應不同音頻",redBlueGreenYellowFrequencies:"紅色(440Hz)、藍色(523Hz)、綠色(659Hz)、黃色(784Hz)",accuracyScoring:"精準度計分",perfect100ms:"Perfect (100ms內)：+10分",good200ms:"Good (200ms內)：+5分",ok300ms:"OK (300ms內)：+2分",missOver300ms:"Miss (超過300ms)：0分",scoring:"計分",eachSuccessfulClickIncreasesCombo:"每次成功點擊增加連擊數",combo5TimesTriggersEffect:"連擊5次以上觸發特效",missingRhythmPointResetsCombo:"錯過節奏點重置連擊",soundControl:"音效控制",soundSwitchInTopRight:"右上角音效開關控制",clickRhythmPointPlaysAudio:"點擊節奏點會播放對應音頻",canTurnSoundOnOffAnytime:"可隨時開啟/關閉音效",gameTime:"遊戲時間",sixtySecondsPerGame:"每局遊戲60秒",autoScoreWhenTimeUp:"時間結束自動結算分數",clickRhythmPointsFollowMusic:"點擊節奏點，跟隨音樂節奏！"},"zh-CN":{score:"分数",time:"时间",combo:"连击",title:"音乐节奏",rules:"游戏规则",close:"关闭",gameplay:"游戏玩法",clickMovingRhythmPoints:"点击从上往下移动的节奏点",fourColorsCorrespondToDifferentAudio:"四种颜色的节奏点对应不同音频",redBlueGreenYellowFrequencies:"红色(440Hz)、蓝色(523Hz)、绿色(659Hz)、黄色(784Hz)",accuracyScoring:"精准度计分",perfect100ms:"Perfect (100ms内)：+10分",good200ms:"Good (200ms内)：+5分",ok300ms:"OK (300ms内)：+2分",missOver300ms:"Miss (超过300ms)：0分",scoring:"计分",eachSuccessfulClickIncreasesCombo:"每次成功点击增加连击数",combo5TimesTriggersEffect:"连击5次以上触发特效",missingRhythmPointResetsCombo:"错过节奏点重置连击",soundControl:"音效控制",soundSwitchInTopRight:"右上角音效开关控制",clickRhythmPointPlaysAudio:"点击节奏点会播放对应音频",canTurnSoundOnOffAnytime:"可随时开启/关闭音效",gameTime:"游戏时间",sixtySecondsPerGame:"每局游戏60秒",autoScoreWhenTimeUp:"时间结束自动结算分数",clickRhythmPointsFollowMusic:"点击节奏点，跟随音乐节奏！"},en:{score:"Score",time:"Time",combo:"Combo",title:"Music Rhythm",rules:"Game Rules",close:"Close",gameplay:"Gameplay",clickMovingRhythmPoints:"Click rhythm points moving from top to bottom",fourColorsCorrespondToDifferentAudio:"Four colors of rhythm points correspond to different audio",redBlueGreenYellowFrequencies:"Red (440Hz), Blue (523Hz), Green (659Hz), Yellow (784Hz)",accuracyScoring:"Accuracy Scoring",perfect100ms:"Perfect (within 100ms): +10 points",good200ms:"Good (within 200ms): +5 points",ok300ms:"OK (within 300ms): +2 points",missOver300ms:"Miss (over 300ms): 0 points",scoring:"Scoring",eachSuccessfulClickIncreasesCombo:"Each successful click increases combo count",combo5TimesTriggersEffect:"Combo 5 times or more triggers special effects",missingRhythmPointResetsCombo:"Missing rhythm point resets combo",soundControl:"Sound Control",soundSwitchInTopRight:"Sound switch control in top right corner",clickRhythmPointPlaysAudio:"Clicking rhythm points plays corresponding audio",canTurnSoundOnOffAnytime:"Can turn sound on/off anytime",gameTime:"Game Time",sixtySecondsPerGame:"60 seconds per game",autoScoreWhenTimeUp:"Auto score when time is up",clickRhythmPointsFollowMusic:"Click rhythm points, follow the music rhythm!"},ja:{score:"スコア",time:"時間",combo:"コンボ",title:"音楽リズム",rules:"ゲームルール",close:"閉じる",gameplay:"ゲームプレイ",clickMovingRhythmPoints:"上から下に移動するリズムポイントをクリック",fourColorsCorrespondToDifferentAudio:"4色のリズムポイントが異なる音声に対応",redBlueGreenYellowFrequencies:"赤(440Hz)、青(523Hz)、緑(659Hz)、黄(784Hz)",accuracyScoring:"精度スコアリング",perfect100ms:"Perfect (100ms以内)：+10ポイント",good200ms:"Good (200ms以内)：+5ポイント",ok300ms:"OK (300ms以内)：+2ポイント",missOver300ms:"Miss (300ms超過)：0ポイント",scoring:"スコアリング",eachSuccessfulClickIncreasesCombo:"各成功クリックでコンボ数増加",combo5TimesTriggersEffect:"コンボ5回以上でエフェクト発動",missingRhythmPointResetsCombo:"リズムポイントを逃すとコンボリセット",soundControl:"サウンドコントロール",soundSwitchInTopRight:"右上のサウンドスイッチ制御",clickRhythmPointPlaysAudio:"リズムポイントクリックで対応音声再生",canTurnSoundOnOffAnytime:"いつでもサウンドオン/オフ可能",gameTime:"ゲーム時間",sixtySecondsPerGame:"ゲームあたり60秒",autoScoreWhenTimeUp:"時間切れで自動スコア",clickRhythmPointsFollowMusic:"リズムポイントをクリックして、音楽のリズムに従ってください！"},ko:{score:"점수",time:"시간",combo:"콤보",title:"음악 리듬",rules:"게임 규칙",close:"닫기",gameplay:"게임 플레이",clickMovingRhythmPoints:"위에서 아래로 이동하는 리듬 포인트 클릭",fourColorsCorrespondToDifferentAudio:"4가지 색상의 리듬 포인트가 다른 오디오에 대응",redBlueGreenYellowFrequencies:"빨강(440Hz)、파랑(523Hz)、초록(659Hz)、노랑(784Hz)",accuracyScoring:"정확도 점수",perfect100ms:"Perfect (100ms 이내)：+10점",good200ms:"Good (200ms 이내)：+5점",ok300ms:"OK (300ms 이내)：+2점",missOver300ms:"Miss (300ms 초과)：0점",scoring:"점수",eachSuccessfulClickIncreasesCombo:"각 성공 클릭마다 콤보 수 증가",combo5TimesTriggersEffect:"콤보 5회 이상 시 특수 효과 발동",missingRhythmPointResetsCombo:"리듬 포인트 놓치면 콤보 리셋",soundControl:"사운드 제어",soundSwitchInTopRight:"우상단 사운드 스위치 제어",clickRhythmPointPlaysAudio:"리듬 포인트 클릭 시 해당 오디오 재생",canTurnSoundOnOffAnytime:"언제든지 사운드 켜기/끄기 가능",gameTime:"게임 시간",sixtySecondsPerGame:"게임당 60초",autoScoreWhenTimeUp:"시간 종료 시 자동 점수",clickRhythmPointsFollowMusic:"리듬 포인트를 클릭하고 음악 리듬을 따라가세요!"},vi:{score:"Điểm",time:"Thời Gian",combo:"Combo",title:"Nhịp Điệu Âm Nhạc",rules:"Luật Chơi",close:"Đóng",gameplay:"Cách Chơi",clickMovingRhythmPoints:"Nhấp vào các điểm nhịp điệu di chuyển từ trên xuống dưới",fourColorsCorrespondToDifferentAudio:"Bốn màu của điểm nhịp điệu tương ứng với âm thanh khác nhau",redBlueGreenYellowFrequencies:"Đỏ (440Hz), Xanh dương (523Hz), Xanh lá (659Hz), Vàng (784Hz)",accuracyScoring:"Điểm Độ Chính Xác",perfect100ms:"Perfect (trong 100ms): +10 điểm",good200ms:"Good (trong 200ms): +5 điểm",ok300ms:"OK (trong 300ms): +2 điểm",missOver300ms:"Miss (trên 300ms): 0 điểm",scoring:"Điểm Số",eachSuccessfulClickIncreasesCombo:"Mỗi lần nhấp thành công tăng số combo",combo5TimesTriggersEffect:"Combo 5 lần trở lên kích hoạt hiệu ứng đặc biệt",missingRhythmPointResetsCombo:"Bỏ lỡ điểm nhịp điệu reset combo",soundControl:"Điều Khiển Âm Thanh",soundSwitchInTopRight:"Công tắc âm thanh ở góc trên bên phải",clickRhythmPointPlaysAudio:"Nhấp điểm nhịp điệu phát âm thanh tương ứng",canTurnSoundOnOffAnytime:"Có thể bật/tắt âm thanh bất cứ lúc nào",gameTime:"Thời Gian Trò Chơi",sixtySecondsPerGame:"60 giây mỗi trò chơi",autoScoreWhenTimeUp:"Tự động tính điểm khi hết thời gian",clickRhythmPointsFollowMusic:"Nhấp vào điểm nhịp điệu, theo nhịp điệu âm nhạc!"},th:{score:"คะแนน",time:"เวลา",combo:"คอมโบ",title:"จังหวะดนตรี",rules:"กฎเกม",close:"ปิด",gameplay:"วิธีเล่น",clickMovingRhythmPoints:"คลิกจุดจังหวะที่เคลื่อนที่จากบนลงล่าง",fourColorsCorrespondToDifferentAudio:"สี่สีของจุดจังหวะสอดคล้องกับเสียงที่แตกต่างกัน",redBlueGreenYellowFrequencies:"แดง (440Hz)、น้ำเงิน (523Hz)、เขียว (659Hz)、เหลือง (784Hz)",accuracyScoring:"คะแนนความแม่นยำ",perfect100ms:"Perfect (ภายใน 100ms)：+10 คะแนน",good200ms:"Good (ภายใน 200ms)：+5 คะแนน",ok300ms:"OK (ภายใน 300ms)：+2 คะแนน",missOver300ms:"Miss (เกิน 300ms)：0 คะแนน",scoring:"คะแนน",eachSuccessfulClickIncreasesCombo:"แต่ละการคลิกที่สำเร็จเพิ่มจำนวนคอมโบ",combo5TimesTriggersEffect:"คอมโบ 5 ครั้งขึ้นไปกระตุ้นเอฟเฟกต์พิเศษ",missingRhythmPointResetsCombo:"พลาดจุดจังหวะรีเซ็ตคอมโบ",soundControl:"ควบคุมเสียง",soundSwitchInTopRight:"สวิตช์เสียงควบคุมที่มุมขวาบน",clickRhythmPointPlaysAudio:"คลิกจุดจังหวะเล่นเสียงที่สอดคล้องกัน",canTurnSoundOnOffAnytime:"สามารถเปิด/ปิดเสียงได้ทุกเมื่อ",gameTime:"เวลาเกม",sixtySecondsPerGame:"60 วินาทีต่อเกม",autoScoreWhenTimeUp:"คะแนนอัตโนมัติเมื่อหมดเวลา",clickRhythmPointsFollowMusic:"คลิกจุดจังหวะและตามจังหวะดนตรี!"},la:{score:"Puncta",time:"Tempus",combo:"Combo",title:"Rhythmus Musicae",rules:"Regulae Ludi",close:"Claudere",gameplay:"Ludus",clickMovingRhythmPoints:"Clicca puncta rhythmi moventia de superiore ad inferiorem",fourColorsCorrespondToDifferentAudio:"Quattuor colores punctorum rhythmi correspondent diversis auditis",redBlueGreenYellowFrequencies:"Rubrum (440Hz), Caeruleum (523Hz), Viride (659Hz), Flavum (784Hz)",accuracyScoring:"Punctatio Accurationis",perfect100ms:"Perfect (intra 100ms): +10 puncta",good200ms:"Good (intra 200ms): +5 puncta",ok300ms:"OK (intra 300ms): +2 puncta",missOver300ms:"Miss (super 300ms): 0 puncta",scoring:"Punctatio",eachSuccessfulClickIncreasesCombo:"Quaelibet felix cliccatio auget numerum combo",combo5TimesTriggersEffect:"Combo 5 vicibus vel plus activat effectus speciales",missingRhythmPointResetsCombo:"Amittendo punctum rhythmi reset combo",soundControl:"Controllatio Sonorum",soundSwitchInTopRight:"Sonorum commutator in angulo superiore dextro",clickRhythmPointPlaysAudio:"Cliccando puncta rhythmi ludit auditum correspondentem",canTurnSoundOnOffAnytime:"Potest sonos aperire/claudere quandocumque",gameTime:"Tempus Ludi",sixtySecondsPerGame:"60 secundis pro quaque ludo",autoScoreWhenTimeUp:"Auto puncta quando tempus finitum est",clickRhythmPointsFollowMusic:"Puncta rhythmi preme et musicam sequere!"},ms:{score:"Markah",time:"Masa",combo:"Combo",title:"Irama Muzik",rules:"Peraturan Permainan",close:"Tutup",gameplay:"Cara Bermain",clickMovingRhythmPoints:"Klik titik irama yang bergerak dari atas ke bawah",fourColorsCorrespondToDifferentAudio:"Empat warna titik irama sepadan dengan audio berbeza",redBlueGreenYellowFrequencies:"Merah (440Hz), Biru (523Hz), Hijau (659Hz), Kuning (784Hz)",accuracyScoring:"Penilaian Ketepatan",perfect100ms:"Perfect (dalam 100ms): +10 markah",good200ms:"Good (dalam 200ms): +5 markah",ok300ms:"OK (dalam 300ms): +2 markah",missOver300ms:"Miss (melebihi 300ms): 0 markah",scoring:"Penilaian",eachSuccessfulClickIncreasesCombo:"Setiap klik berjaya menambah bilangan combo",combo5TimesTriggersEffect:"Combo 5 kali atau lebih mencetuskan kesan khas",missingRhythmPointResetsCombo:"Terlepas titik irama reset combo",soundControl:"Kawalan Bunyi",soundSwitchInTopRight:"Suis bunyi kawalan di sudut kanan atas",clickRhythmPointPlaysAudio:"Klik titik irama memainkan audio sepadan",canTurnSoundOnOffAnytime:"Boleh hidupkan/matikan bunyi bila-bila masa",gameTime:"Masa Permainan",sixtySecondsPerGame:"60 saat setiap permainan",autoScoreWhenTimeUp:"Markah automatik apabila masa habis",clickRhythmPointsFollowMusic:"Klik titik irama, ikut rentak muzik!"}};return((K=j[e])==null?void 0:K[z])||j["zh-TW"][z]||z};w.useEffect(()=>{const z=Dd("rhythm");z&&a(z.highScore||0)},[]),w.useEffect(()=>{s>0&&zd("rhythm",{highScore:s})},[s]),w.useEffect(()=>{typeof window<"u"&&window.AudioContext&&A(new AudioContext)},[]);const N=()=>{r(0),m(60),x([]),I(0),d(!0)},E=()=>{d(!1),t>s&&a(t)},P=()=>{if(!c)return;const z=["red","blue","green","yellow"],j=z[Math.floor(Math.random()*z.length)],K=Math.random()*80+10;x(Z=>[...Z,{id:Date.now(),x:K,y:-10,type:j,timing:Date.now()}])},M=z=>{const j=g.find(Y=>Y.id===z);if(!j)return;const K=Date.now()-j.timing;let Z=0;if(K<100?Z=10:K<200?Z=5:K<300?Z=2:Z=0,r(Y=>Y+Z),I(Y=>Y+1),S>=5&&(R(!0),setTimeout(()=>R(!1),1e3)),T&&D){const Y=T.createOscillator(),ae=T.createGain();Y.connect(ae),ae.connect(T.destination);const se={red:440,blue:523,green:659,yellow:784};Y.frequency.setValueAtTime(se[j.type],T.currentTime),Y.type="sine",ae.gain.setValueAtTime(.3,T.currentTime),ae.gain.exponentialRampToValueAtTime(.01,T.currentTime+.1),Y.start(T.currentTime),Y.stop(T.currentTime+.1)}x(Y=>Y.filter(ae=>ae.id!==z))};w.useEffect(()=>{if(!c)return;const z=setInterval(()=>{m(j=>j<=1?(E(),0):j-1),Math.random()<.03&&P(),x(j=>{const K=j.map(Z=>({...Z,y:Z.y+2})).filter(Z=>Z.y<110);return K.forEach(Z=>{Z.y>90&&(I(0),x(Y=>Y.filter(ae=>ae.id!==Z.id)))}),K})},50);return()=>clearInterval(z)},[c]);const O=z=>({red:"#FF4444",blue:"#4444FF",green:"#44FF44",yellow:"#FFFF44"})[z]||"#FF4444";return i.jsxs("div",{style:{width:"100vw",height:"100vh",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",position:"relative",overflow:"hidden",fontFamily:"Arial, sans-serif"},children:[i.jsxs("div",{style:{position:"absolute",top:"clamp(20px, 4vw, 40px)",left:"clamp(80px, 16vw, 100px)",background:"rgba(255,255,255,0.9)",padding:"clamp(8px, 1.5vw, 12px)",borderRadius:"10px",fontSize:"clamp(0.8rem, 2vw, 1rem)",zIndex:100},children:[i.jsxs("div",{children:[G("score"),": ",t]}),i.jsxs("div",{children:[G("time"),": ",h,"s"]}),i.jsxs("div",{children:[G("combo"),": ",S]})]}),i.jsx("button",{onClick:()=>F(!D),style:{position:"absolute",top:"clamp(10px, 2vw, 20px)",right:"clamp(10px, 2vw, 20px)",background:D?"#4CAF50":"#f44336",color:"#fff",border:"none",borderRadius:"25px",padding:"clamp(8px, 1.5vw, 12px) clamp(16px, 3vw, 24px)",fontSize:"clamp(0.8rem, 2vw, 1rem)",cursor:"pointer",zIndex:100},children:D?"🔊":"🔇"}),i.jsx("div",{style:{position:"absolute",bottom:"20%",left:"10%",right:"10%",height:"60%",background:"rgba(0,0,0,0.3)",borderRadius:"20px",border:"2px solid rgba(255,255,255,0.3)"}}),g.map(z=>i.jsx("div",{onClick:()=>M(z.id),style:{position:"absolute",bottom:`${z.y}%`,left:`${z.x}%`,transform:"translateX(-50%)",width:"clamp(40px, 8vw, 60px)",height:"clamp(40px, 8vw, 60px)",background:O(z.type),borderRadius:"50%",cursor:"pointer",zIndex:10,boxShadow:`0 0 20px ${O(z.type)}`,animation:"pulse 0.5s ease-in-out infinite alternate"}},z.id)),_&&i.jsxs("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",fontSize:"clamp(2rem, 5vw, 3rem)",fontWeight:"bold",color:"#00BCD4",textShadow:"0 0 20px #00BCD4",animation:"comboEffect 1s ease-out forwards",pointerEvents:"none",zIndex:1e3},children:["COMBO x",S,"!"]}),!c&&i.jsxs("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",background:"rgba(255,255,255,0.95)",borderRadius:"20px",padding:"clamp(20px, 4vw, 30px)",textAlign:"center",zIndex:1001},children:[i.jsx("h2",{style:{fontSize:"clamp(1.5rem, 3.5vw, 2rem)",margin:"0 0 15px 0",color:"#00BCD4"},children:G("title")}),i.jsx("p",{style:{fontSize:"clamp(0.9rem, 2vw, 1rem)",marginBottom:"20px",color:"#666"},children:G("clickRhythmPointsFollowMusic")}),i.jsxs("div",{style:{display:"flex",gap:"10px",justifyContent:"center"},children:[i.jsx("button",{onClick:N,style:{background:"#00BCD4",color:"#fff",border:"none",borderRadius:"15px",padding:"clamp(10px, 2vw, 15px) clamp(20px, 4vw, 30px)",fontSize:"clamp(1rem, 2.5vw, 1.2rem)",cursor:"pointer",fontWeight:"bold"},children:G("start")}),i.jsx("button",{onClick:()=>ie(!0),style:{background:"#666",color:"#fff",border:"none",borderRadius:"15px",padding:"clamp(10px, 2vw, 15px) clamp(20px, 4vw, 30px)",fontSize:"clamp(1rem, 2.5vw, 1.2rem)",cursor:"pointer"},children:G("rules")})]})]}),X&&i.jsx("div",{style:{position:"absolute",top:"0",left:"0",right:"0",bottom:"0",background:"rgba(0,0,0,0.8)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1002},children:i.jsxs("div",{style:{background:"rgba(255,255,255,0.95)",borderRadius:"20px",padding:"clamp(20px, 4vw, 30px)",maxWidth:"clamp(300px, 80vw, 500px)",maxHeight:"clamp(400px, 80vh, 600px)",overflow:"auto"},children:[i.jsxs("h3",{style:{fontSize:"clamp(1.2rem, 3vw, 1.5rem)",margin:"0 0 15px 0",color:"#00BCD4",textAlign:"center"},children:[G("rhythmGame")," - ",G("rules")]}),i.jsxs("div",{style:{fontSize:"clamp(0.9rem, 2vw, 1rem)",lineHeight:"1.6"},children:[i.jsx("p",{children:i.jsxs("strong",{children:["🎵 ",G("gameplay"),"："]})}),i.jsxs("ul",{children:[i.jsx("li",{children:G("clickMovingRhythmPoints")}),i.jsx("li",{children:G("fourColorsCorrespondToDifferentAudio")}),i.jsx("li",{children:G("redBlueGreenYellowFrequencies")})]}),i.jsx("p",{children:i.jsxs("strong",{children:["🎯 ",G("accuracyScoring"),"："]})}),i.jsxs("ul",{children:[i.jsx("li",{children:G("perfect100ms")}),i.jsx("li",{children:G("good200ms")}),i.jsx("li",{children:G("ok300ms")}),i.jsx("li",{children:G("missOver300ms")})]}),i.jsx("p",{children:i.jsxs("strong",{children:["🏆 ",G("scoring"),"："]})}),i.jsxs("ul",{children:[i.jsx("li",{children:G("eachSuccessfulClickIncreasesCombo")}),i.jsx("li",{children:G("combo5TimesTriggersEffect")}),i.jsx("li",{children:G("missingRhythmPointResetsCombo")})]}),i.jsx("p",{children:i.jsxs("strong",{children:["🔊 ",G("soundControl"),"："]})}),i.jsxs("ul",{children:[i.jsx("li",{children:G("soundSwitchInTopRight")}),i.jsx("li",{children:G("clickRhythmPointPlaysAudio")}),i.jsx("li",{children:G("canTurnSoundOnOffAnytime")})]}),i.jsx("p",{children:i.jsxs("strong",{children:["⏰ ",G("gameTime"),"："]})}),i.jsxs("ul",{children:[i.jsx("li",{children:G("sixtySecondsPerGame")}),i.jsx("li",{children:G("autoScoreWhenTimeUp")})]})]}),i.jsx("button",{onClick:()=>ie(!1),style:{background:"#00BCD4",color:"#fff",border:"none",borderRadius:"15px",padding:"clamp(8px, 1.5vw, 12px) clamp(16px, 3vw, 24px)",fontSize:"clamp(0.9rem, 2vw, 1rem)",cursor:"pointer",marginTop:"20px",width:"100%"},children:G("close")})]})}),!c&&t>0&&i.jsxs("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",background:"rgba(255,255,255,0.95)",borderRadius:"20px",padding:"clamp(20px, 4vw, 30px)",textAlign:"center",zIndex:1001},children:[i.jsxs("h2",{style:{fontSize:"clamp(1.5rem, 3.5vw, 2rem)",margin:"0 0 15px 0",color:"#00BCD4"},children:[G("gameOver"),"！"]}),i.jsxs("div",{style:{fontSize:"clamp(1rem, 2.5vw, 1.2rem)",marginBottom:"10px"},children:[G("finalScore"),"：",t]}),i.jsxs("div",{style:{fontSize:"clamp(0.9rem, 2vw, 1rem)",marginBottom:"20px",color:"#666"},children:[G("highScore"),"：",s]}),i.jsxs("div",{style:{display:"flex",gap:"10px",justifyContent:"center"},children:[i.jsx("button",{onClick:N,style:{background:"#00BCD4",color:"#fff",border:"none",borderRadius:"15px",padding:"clamp(8px, 1.5vw, 12px) clamp(16px, 3vw, 24px)",fontSize:"clamp(0.9rem, 2vw, 1rem)",cursor:"pointer"},children:G("restart")}),i.jsx("button",{onClick:n,style:{background:"#666",color:"#fff",border:"none",borderRadius:"15px",padding:"clamp(8px, 1.5vw, 12px) clamp(16px, 3vw, 24px)",fontSize:"clamp(0.9rem, 2vw, 1rem)",cursor:"pointer"},children:G("back")})]})]}),i.jsx("style",{children:`
        @keyframes pulse {
          0% { transform: translateX(-50%) scale(1); }
          100% { transform: translateX(-50%) scale(1.1); }
        }
        @keyframes comboEffect {
          0% { opacity: 0; transform: translate(-50%, -50%) scale(0.5); }
          50% { opacity: 1; transform: translate(-50%, -50%) scale(1.2); }
          100% { opacity: 0; transform: translate(-50%, -50%) scale(1); }
        }
      `})]})}const H3=[{name:"免費版",price:"NT$0",period:"永久免費",features:["❌ 無語音功能權限","❌ 無權限使用OpenAI API功能","❌ 無法與其他使用者互動","✅ 基礎功能使用15次/月","💰 成本限制: NT$0/月"],highlight:!1,buttonText:"立即註冊",buttonAction:"register"},{name:"基礎版",price:"NT$149",period:"/月 或 NT$1490/年",features:["🤖 AI Token 限制: 50K tokens/月","👥 用戶互動: 100次/月","💬 留言/里程碑/AI聊天: 各30次/月","🎯 基礎功能: 300次/月","⚡ Token 用完僅暫停語音功能"],highlight:!0,buttonText:"選擇基礎版",buttonAction:"basic"},{name:"進階版",price:"NT$249",period:"/月 或 NT$2490/年",features:["🤖 AI Token 限制: 100K tokens/月","👥 用戶互動: 300次/月","💬 留言/里程碑/AI聊天: 各80次/月","🎯 基礎功能: 600次/月","⚡ Token 用完僅暫停語音功能"],highlight:!1,buttonText:"選擇進階版",buttonAction:"advanced"},{name:"專業版",price:"NT$349",period:"/月 或 NT$3490/年",features:["🤖 AI Token 限制: 200K tokens/月","👥 用戶互動: 800次/月","💬 留言/里程碑/AI聊天: 各150次/月","🎯 基礎功能: 1000次/月","⚡ Token 用完僅暫停語音功能"],highlight:!1,buttonText:"選擇專業版",buttonAction:"professional"},{name:"無限版",price:"NT$499",period:"/月 或 NT$4990/年",features:["🤖 AI Token 限制: 500K tokens/月","♾️ 用戶互動: 無限制","♾️ 留言/里程碑/AI聊天: 無限制","♾️ 基礎功能: 無限制","⚡ 僅受 Token 上限限制"],highlight:!1,buttonText:"選擇無限版",buttonAction:"unlimited"}],$3=["選擇適合您的訂閱方案","完成付款（支援信用卡/Apple Pay/Google Pay）","付款成功後自動升級，立即享有所有訂閱權益"],G3=[{q:"升級後可以隨時取消嗎？",a:"可以，訂閱會員可隨時取消，權益將保留至本期結束。"},{q:"付款方式有哪些？",a:"支援信用卡、Apple Pay、Google Pay 等多種方式。"},{q:"各版本的AI功能限制是什麼？",a:"Token 用完僅暫停語音功能，文字功能可繼續使用至各自限制。各功能獨立檢查使用次數。"},{q:"Token 用完可以續購嗎？",a:"可以！Token 用完但未滿一個月時，可以續購並從今天重新計算使用期，更划算。"},{q:"無限版真的無限制嗎？",a:"無限版除了AI Token上限外，其他功能都無限制使用。"},{q:"可以中途升級或降級嗎？",a:"可以，升級立即生效，降級將在當前週期結束後生效。"}];function K3(){const n=wt(),t=gt().currentUser;localStorage.getItem("lang");const[r,s]=w.useState(!1),[a,c]=w.useState(null),d=h=>{if(!t){s(!0);return}c(h),n(`/payment?plan=${h.buttonAction}`)};return i.jsxs("div",{style:{fontFamily:"-apple-system,BlinkMacSystemFont,sans-serif",background:"#f7f8fc",minHeight:"100vh",padding:"32px 0"},children:[i.jsx("button",{onClick:()=>n("/"),style:{position:"absolute",top:24,left:24,zIndex:10,background:"#fff",border:"1.5px solid #6B5BFF",color:"#6B5BFF",borderRadius:8,padding:"6px 18px",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:"0 2px 8px #0001"},children:"← 返回"}),i.jsxs("div",{style:{maxWidth:1200,margin:"0 auto",background:"#fff",borderRadius:18,boxShadow:"0 4px 24px #6B5BFF22",padding:32},children:[i.jsx("h1",{style:{fontSize:36,fontWeight:900,letterSpacing:2,background:"linear-gradient(90deg,#6B5BFF,#00CFFF)",WebkitBackgroundClip:"text",color:"transparent",marginBottom:24,textAlign:"center"},children:"Restarter 訂閱方案"}),i.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(280px, 1fr))",gap:24,marginBottom:32},children:H3.map((h,m)=>i.jsxs("div",{style:{background:h.highlight?"linear-gradient(135deg, #f3f7ff 0%, #e8f4ff 100%)":"#fff",border:h.highlight?"2px solid #6B5BFF":"1px solid #e0e0e0",borderRadius:16,padding:24,position:"relative",boxShadow:h.highlight?"0 8px 32px #6B5BFF22":"0 4px 16px #0001",transition:"all 0.3s ease",cursor:"pointer"},onClick:()=>d(h),children:[h.highlight&&i.jsx("div",{style:{position:"absolute",top:-12,left:"50%",transform:"translateX(-50%)",background:"#6B5BFF",color:"#fff",padding:"4px 16px",borderRadius:12,fontSize:14,fontWeight:700},children:"推薦方案"}),i.jsx("h3",{style:{fontSize:24,fontWeight:800,color:h.highlight?"#6B5BFF":"#333",marginBottom:8,textAlign:"center"},children:h.name}),i.jsxs("div",{style:{textAlign:"center",marginBottom:20},children:[i.jsx("span",{style:{fontSize:32,fontWeight:900,color:h.highlight?"#6B5BFF":"#333"},children:h.price}),i.jsx("span",{style:{fontSize:16,color:"#666"},children:h.period})]}),i.jsx("ul",{style:{margin:0,padding:0,listStyle:"none"},children:h.features.map((g,x)=>i.jsx("li",{style:{marginBottom:12,fontSize:14,lineHeight:1.5,color:"#555",display:"flex",alignItems:"flex-start",gap:8},children:i.jsx("span",{style:{fontSize:16,marginTop:1},children:g})},x))}),i.jsx("button",{style:{width:"100%",background:h.highlight?"linear-gradient(90deg, #6B5BFF, #00CFFF)":"#f0f0f0",color:h.highlight?"#fff":"#666",border:"none",borderRadius:8,padding:"12px 0",fontSize:16,fontWeight:700,cursor:"pointer",marginTop:20,transition:"all 0.2s ease"},children:h.buttonText})]},h.name))}),i.jsx("h2",{style:{fontSize:24,fontWeight:800,margin:"32px 0 12px",color:"#6B5BFF"},children:"升級流程"}),i.jsx("ol",{style:{fontSize:18,lineHeight:1.8,marginBottom:32,paddingLeft:24},children:$3.map((h,m)=>i.jsx("li",{children:h},m))}),i.jsx("h2",{style:{fontSize:24,fontWeight:800,margin:"32px 0 12px",color:"#6B5BFF"},children:"常見問題"}),i.jsx("div",{style:{marginBottom:32},children:G3.map((h,m)=>i.jsxs("div",{style:{marginBottom:18},children:[i.jsx("div",{style:{fontWeight:700,fontSize:18,color:"#6B5BFF"},children:h.q}),i.jsx("div",{style:{fontSize:17,color:"#444",marginLeft:8,marginTop:2},children:h.a})]},m))}),i.jsx("div",{style:{display:"flex",justifyContent:"center",marginTop:32},children:i.jsx("a",{href:"/register",style:{background:"#00CFFF",color:"#fff",fontWeight:700,fontSize:20,padding:"14px 38px",borderRadius:10,boxShadow:"0 2px 8px #00CFFF33",textDecoration:"none",transition:"0.2s"},children:"立即註冊免費版"})}),r&&i.jsx("div",{style:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",background:"rgba(0,0,0,0.5)",zIndex:9999,display:"flex",alignItems:"center",justifyContent:"center"},children:i.jsxs("div",{style:{background:"#fff",borderRadius:20,padding:32,boxShadow:"0 8px 32px rgba(0,0,0,0.2)",minWidth:380,textAlign:"center"},children:[i.jsx("div",{style:{fontSize:48,marginBottom:16,color:"#6B5BFF"},children:"🎯"}),i.jsx("div",{style:{fontSize:22,fontWeight:700,color:"#6B5BFF",marginBottom:12},children:"歡迎加入 Restarter！"}),i.jsx("div",{style:{fontSize:16,color:"#666",marginBottom:20,lineHeight:1.5},children:"註冊後即可選擇適合您的訂閱方案，開始您的重啟之旅"}),i.jsxs("div",{style:{background:"linear-gradient(135deg, #f8f9ff 0%, #e8f4ff 100%)",borderRadius:12,padding:16,marginBottom:24,border:"1px solid #e0e8ff"},children:[i.jsx("div",{style:{fontSize:14,color:"#6B5BFF",fontWeight:600,marginBottom:8},children:"💡 註冊好處"}),i.jsxs("div",{style:{fontSize:13,color:"#666",lineHeight:1.4},children:["• 免費體驗基礎功能",i.jsx("br",{}),"• 個人化使用記錄",i.jsx("br",{}),"• 安全可靠的服務"]})]}),i.jsxs("div",{style:{display:"flex",gap:12,justifyContent:"center"},children:[i.jsx("button",{onClick:()=>{s(!1),n("/register")},style:{background:"linear-gradient(135deg, #6B5BFF 0%, #00CFFF 100%)",color:"#fff",border:"none",borderRadius:12,padding:"12px 28px",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:"0 4px 12px #6B5BFF33",transition:"all 0.3s ease"},onMouseEnter:h=>{h.currentTarget.style.transform="translateY(-2px)",h.currentTarget.style.boxShadow="0 6px 16px #6B5BFF44"},onMouseLeave:h=>{h.currentTarget.style.transform="translateY(0)",h.currentTarget.style.boxShadow="0 4px 12px #6B5BFF33"},children:"🚀 立即註冊"}),i.jsx("button",{onClick:()=>s(!1),style:{background:"#f8f9ff",color:"#6B5BFF",border:"2px solid #6B5BFF",borderRadius:12,padding:"12px 28px",fontWeight:600,fontSize:16,cursor:"pointer",transition:"all 0.3s ease"},onMouseEnter:h=>{h.currentTarget.style.background="#6B5BFF",h.currentTarget.style.color="#fff"},onMouseLeave:h=>{h.currentTarget.style.background="#f8f9ff",h.currentTarget.style.color="#6B5BFF"},children:"💭 稍後再說"})]})]})})]})]})}const ck={basic:{name:"基礎版",price:"NT$149",period:"/月",features:["🤖 AI Token 限制: 50K tokens/月","👥 用戶互動: 100次/月","💬 留言/里程碑/AI聊天: 各30次/月","🎯 基礎功能: 300次/月"],buttonAction:"basic"},advanced:{name:"進階版",price:"NT$249",period:"/月",features:["🤖 AI Token 限制: 100K tokens/月","👥 用戶互動: 300次/月","💬 留言/里程碑/AI聊天: 各80次/月","🎯 基礎功能: 600次/月"],buttonAction:"advanced"},professional:{name:"專業版",price:"NT$349",period:"/月",features:["🤖 AI Token 限制: 200K tokens/月","👥 用戶互動: 800次/月","💬 留言/里程碑/AI聊天: 各150次/月","🎯 基礎功能: 1000次/月"],buttonAction:"professional"},unlimited:{name:"無限版",price:"NT$499",period:"/月",features:["🤖 AI Token 限制: 500K tokens/月","♾️ 用戶互動: 無限制","♾️ 留言/里程碑/AI聊天: 無限制","♾️ 基礎功能: 無限制"],buttonAction:"unlimited"}};function Q3(){const n=wt(),[e]=WC(),r=gt().currentUser,[s,a]=w.useState(null),[c,d]=w.useState("credit"),[h,m]=w.useState(!1),[g,x]=w.useState(!1);w.useEffect(()=>{const I=e.get("plan");I&&ck[I]?a(ck[I]):n("/plans")},[e,n]);const S=async()=>{if(!r){n("/login");return}m(!0),setTimeout(()=>{m(!1),x(!0),setTimeout(()=>{n("/")},3e3)},2e3)};return s?i.jsxs("div",{style:{fontFamily:"-apple-system,BlinkMacSystemFont,sans-serif",background:"#f7f8fc",minHeight:"100vh",padding:"32px 0"},children:[i.jsx("button",{onClick:()=>n("/plans"),style:{position:"absolute",top:24,left:24,zIndex:10,background:"#fff",border:"1.5px solid #6B5BFF",color:"#6B5BFF",borderRadius:8,padding:"6px 18px",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:"0 2px 8px #0001"},children:"← 返回"}),i.jsxs("div",{style:{maxWidth:600,margin:"0 auto",background:"#fff",borderRadius:18,boxShadow:"0 4px 24px #6B5BFF22",padding:32},children:[i.jsx("h1",{style:{fontSize:32,fontWeight:900,letterSpacing:2,background:"linear-gradient(90deg,#6B5BFF,#00CFFF)",WebkitBackgroundClip:"text",color:"transparent",marginBottom:24,textAlign:"center"},children:"完成訂閱"}),i.jsxs("div",{style:{background:"#f8f9ff",borderRadius:12,padding:24,marginBottom:32},children:[i.jsx("h2",{style:{fontSize:20,fontWeight:700,color:"#6B5BFF",marginBottom:16},children:"選擇的方案"}),i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[i.jsx("span",{style:{fontSize:18,fontWeight:600},children:s.name}),i.jsxs("span",{style:{fontSize:24,fontWeight:900,color:"#6B5BFF"},children:[s.price,s.period]})]}),i.jsx("ul",{style:{margin:0,padding:0,listStyle:"none"},children:s.features.map((I,_)=>i.jsxs("li",{style:{marginBottom:8,fontSize:14,color:"#666"},children:["• ",I]},_))})]}),i.jsxs("div",{style:{marginBottom:32},children:[i.jsx("h2",{style:{fontSize:20,fontWeight:700,color:"#6B5BFF",marginBottom:16},children:"付款方式"}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:12},children:[i.jsxs("label",{style:{display:"flex",alignItems:"center",gap:12,cursor:"pointer"},children:[i.jsx("input",{type:"radio",name:"payment",value:"credit",checked:c==="credit",onChange:I=>d(I.target.value),style:{width:18,height:18}}),i.jsx("span",{style:{fontSize:16},children:"💳 信用卡"})]}),i.jsxs("label",{style:{display:"flex",alignItems:"center",gap:12,cursor:"pointer"},children:[i.jsx("input",{type:"radio",name:"payment",value:"apple",checked:c==="apple",onChange:I=>d(I.target.value),style:{width:18,height:18}}),i.jsx("span",{style:{fontSize:16},children:"🍎 Apple Pay"})]}),i.jsxs("label",{style:{display:"flex",alignItems:"center",gap:12,cursor:"pointer"},children:[i.jsx("input",{type:"radio",name:"payment",value:"google",checked:c==="google",onChange:I=>d(I.target.value),style:{width:18,height:18}}),i.jsx("span",{style:{fontSize:16},children:"🤖 Google Pay"})]})]})]}),i.jsx("button",{onClick:S,disabled:h,style:{width:"100%",background:h?"#ccc":"linear-gradient(90deg,#6B5BFF,#00CFFF)",color:"#fff",border:"none",borderRadius:12,padding:"16px 0",fontSize:18,fontWeight:700,cursor:h?"not-allowed":"pointer",transition:"all 0.2s ease"},children:h?"處理中...":`立即付款 ${s.price}`}),g&&i.jsx("div",{style:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",background:"#0008",zIndex:9999,display:"flex",alignItems:"center",justifyContent:"center"},children:i.jsxs("div",{style:{background:"#fff",borderRadius:16,padding:32,boxShadow:"0 4px 24px #0002",minWidth:320,textAlign:"center"},children:[i.jsx("div",{style:{fontSize:48,marginBottom:16},children:"✅"}),i.jsx("div",{style:{fontSize:20,fontWeight:700,color:"#6B5BFF",marginBottom:8},children:"付款成功！"}),i.jsx("div",{style:{fontSize:16,color:"#666",marginBottom:16},children:"您的訂閱已生效，即將跳轉到首頁..."})]})})]})]}):i.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"},children:i.jsx("div",{children:"載入中..."})})}const sy={monthly:{name:"基礎版訂閱",price:"NT$ 199",period:"/月",features:["每日10次配對、可主動加好友、私訊","每日5次心情記錄、拼圖、基礎成就","每日5次AI任務、基礎任務、基礎徽章","每日10次發文、留言、收藏、互動","每日5次農場互動、基礎作物/道具","每日3次社會互動練習、基礎模擬","每日3次參加、可發出/接受幫助、互動","每日10次AI對話、基礎分析、基礎推薦"],stripeLink:"https://buy.stripe.com/your_monthly_basic_link",paypalLink:"https://www.paypal.com/your_monthly_basic_link",ecpayLink:"https://payment.ecpay.com.tw/your_monthly_basic_link",newebpayLink:"https://ccore.newebpay.com/your_monthly_basic_link"},monthlyPro:{name:"進階版訂閱",price:"NT$ 299",period:"/月",features:["無限配對、主動加好友、私訊、群組","無限心情記錄、拼圖、完整成就、進階分析","無限AI任務、進階任務、專屬徽章、成就牆","無限發文、留言、收藏、互動、高質量內容","無限農場互動、高級作物/道具、專屬活動","無限社會互動練習、進階模擬、成就牆","無限參加、可發出/接受幫助、互動、專屬小組","無限AI對話、深度分析、個人化推薦、高額度API"],stripeLink:"https://buy.stripe.com/your_monthly_pro_link",paypalLink:"https://www.paypal.com/your_monthly_pro_link",ecpayLink:"https://payment.ecpay.com.tw/your_monthly_pro_link",newebpayLink:"https://ccore.newebpay.com/your_monthly_pro_link"},yearly:{name:"基礎版年費",price:"NT$ 1,999",period:"/年",originalPrice:"NT$ 2,388",discount:"省 NT$ 389",features:["所有基礎版月費功能 + 年費專屬優惠","每日15次配對（比月費多5次）","每日8次心情記錄（比月費多3次）","每日8次AI任務（比月費多3次）","優先客服支援","年費專屬徽章與成就"],stripeLink:"https://buy.stripe.com/your_yearly_basic_link",paypalLink:"https://www.paypal.com/your_yearly_basic_link",ecpayLink:"https://payment.ecpay.com.tw/your_yearly_basic_link",newebpayLink:"https://ccore.newebpay.com/your_yearly_basic_link"},yearlyPro:{name:"進階版年費",price:"NT$ 2,999",period:"/年",originalPrice:"NT$ 3,588",discount:"省 NT$ 589",features:["所有進階版月費功能 + 年費專屬優惠","最高優先級客服支援","專屬年費會員活動","年費專屬徽章與成就","高額度API（每月100萬tokens）、專屬AI模型"],stripeLink:"https://buy.stripe.com/your_yearly_pro_link",paypalLink:"https://www.paypal.com/your_yearly_pro_link",ecpayLink:"https://payment.ecpay.com.tw/your_yearly_pro_link",newebpayLink:"https://ccore.newebpay.com/your_yearly_pro_link"}};function Y3(){const n=wt(),t=gt().currentUser,[r,s]=w.useState(!1),[a,c]=w.useState("monthly"),[d,h]=w.useState("stripe"),[m,g]=w.useState(!1),[x,S]=w.useState(null);localStorage.getItem("lang");const I=()=>{if(!t){s(!0);return}const A=sy[a],D=A[`${d}Link`];D&&!D.includes("your_")?_():alert(`請聯絡客服完成付款設定

選擇方案：${A.name}
付款方式：${d==="stripe"?"Stripe":d==="paypal"?"PayPal":d==="ecpay"?"綠界":"藍新"}

客服 Email：support@restarter.com`)},_=async()=>{if(t)try{const A=`TXN_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,D=await fetch("/api/subscription/payment-success",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:t.uid,plan:a,paymentMethod:d,transactionId:A,amount:R(a),currency:"TWD"})});if(D.ok){const F=await D.json();S(F),g(!0),setTimeout(()=>{n("/home")},3e3)}else alert("付款處理失敗，請聯絡客服")}catch(A){console.error("付款處理錯誤:",A),alert("付款處理失敗，請聯絡客服")}},R=A=>({monthly:199,monthlyPro:299,yearly:1999,yearlyPro:2999})[A]||0,T=A=>({monthly:"基礎版月費",monthlyPro:"進階版月費",yearly:"基礎版年費",yearlyPro:"進階版年費"})[A]||A;return i.jsxs("div",{style:{minHeight:"100vh",background:"#f7faff",padding:0},children:[i.jsx("button",{onClick:()=>n("/plans"),style:{position:"absolute",top:24,left:24,zIndex:10,background:"#fff",border:"1.5px solid #6B5BFF",color:"#6B5BFF",borderRadius:8,padding:"6px 18px",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:"0 2px 8px #0001"},children:"← 返回"}),i.jsx("div",{style:{maxWidth:900,margin:"0 auto",padding:"80px 24px 32px"},children:i.jsxs("div",{style:{background:"#fff",borderRadius:18,boxShadow:"0 4px 24px #6B5BFF11",padding:"32px 24px"},children:[i.jsx("h2",{style:{color:"#4B5BFF",fontWeight:900,fontSize:32,marginBottom:8,letterSpacing:2,textAlign:"center"},children:"升級訂閱"}),i.jsx("p",{style:{color:"#666",fontSize:18,textAlign:"center",marginBottom:32},children:"選擇最適合您的訂閱方案，立即享有完整功能"}),i.jsx("div",{style:{display:"flex",gap:24,marginBottom:32,justifyContent:"center"},children:Object.entries(sy).map(([A,D])=>i.jsxs("div",{onClick:()=>c(A),style:{background:a===A?"#6B5BFF":"#fff",color:a===A?"#fff":"#333",border:`2px solid ${a===A?"#6B5BFF":"#ddd"}`,borderRadius:12,padding:"24px",cursor:"pointer",minWidth:200,textAlign:"center",transition:"all 0.3s ease"},children:[i.jsx("div",{style:{fontWeight:700,fontSize:20,marginBottom:8},children:D.name}),i.jsxs("div",{style:{fontSize:32,fontWeight:900,marginBottom:4},children:[D.price,i.jsx("span",{style:{fontSize:16,fontWeight:400},children:D.period})]}),D.originalPrice&&i.jsx("div",{style:{fontSize:14,textDecoration:"line-through",opacity:.7,marginBottom:4},children:D.originalPrice}),D.discount&&i.jsx("div",{style:{fontSize:14,color:"#ff6b6b",fontWeight:700},children:D.discount})]},A))}),i.jsxs("div",{style:{marginBottom:32},children:[i.jsx("h3",{style:{color:"#333",fontWeight:700,fontSize:20,marginBottom:16},children:"選擇付款方式"}),i.jsx("div",{style:{display:"flex",gap:16,flexWrap:"wrap"},children:[{key:"stripe",name:"Stripe",icon:"💳"},{key:"paypal",name:"PayPal",icon:"🔵"},{key:"ecpay",name:"綠界",icon:"🟢"},{key:"newebpay",name:"藍新",icon:"🔵"}].map(A=>i.jsxs("button",{onClick:()=>h(A.key),style:{background:d===A.key?"#6B5BFF":"#fff",color:d===A.key?"#fff":"#333",border:`2px solid ${d===A.key?"#6B5BFF":"#ddd"}`,borderRadius:8,padding:"12px 20px",cursor:"pointer",fontSize:16,fontWeight:600,transition:"all 0.3s ease"},children:[A.icon," ",A.name]},A.key))})]}),i.jsxs("div",{style:{marginBottom:32},children:[i.jsx("h3",{style:{color:"#333",fontWeight:700,fontSize:20,marginBottom:16},children:"訂閱權益"}),i.jsx("div",{style:{display:"grid",gap:12},children:sy[a].features.map((A,D)=>i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[i.jsx("span",{style:{color:"#6B5BFF",fontSize:18},children:"✓"}),i.jsx("span",{style:{color:"#333",fontSize:16},children:A})]},D))})]}),i.jsx("div",{style:{textAlign:"center",marginTop:24},children:i.jsx("button",{onClick:I,style:{background:"linear-gradient(90deg,#6B5BFF 60%,#23c6e6 100%)",color:"#fff",border:"none",borderRadius:12,fontWeight:900,fontSize:20,padding:"12px 48px",boxShadow:"0 2px 12px #6B5BFF33",letterSpacing:2,cursor:"pointer"},children:"立即升級"})}),i.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:24,marginTop:32},children:[i.jsx("button",{onClick:()=>n("/payment-info"),style:{background:"#fff",color:"#6B5BFF",border:"1.5px solid #6B5BFF",borderRadius:8,padding:"10px 32px",fontWeight:600,cursor:"pointer"},children:"付款說明"}),i.jsx("button",{onClick:()=>n("/contact"),style:{background:"#fff",color:"#6B5BFF",border:"1.5px solid #6B5BFF",borderRadius:8,padding:"10px 32px",fontWeight:600,cursor:"pointer"},children:"聯絡客服"})]})]})}),r&&i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:i.jsxs("div",{style:{background:"#fff",borderRadius:20,padding:32,maxWidth:450,textAlign:"center",boxShadow:"0 8px 32px rgba(0,0,0,0.2)"},children:[i.jsx("div",{style:{fontSize:48,marginBottom:16,color:"#6B5BFF"},children:"🎯"}),i.jsx("h3",{style:{color:"#6B5BFF",fontWeight:700,fontSize:22,marginBottom:12},children:"歡迎加入 Restarter！"}),i.jsx("p",{style:{color:"#666",marginBottom:20,lineHeight:1.5,fontSize:16},children:"註冊後即可選擇適合您的訂閱方案，開始您的重啟之旅"}),i.jsxs("div",{style:{background:"linear-gradient(135deg, #f8f9ff 0%, #e8f4ff 100%)",borderRadius:12,padding:16,marginBottom:24,border:"1px solid #e0e8ff"},children:[i.jsx("div",{style:{fontSize:14,color:"#6B5BFF",fontWeight:600,marginBottom:8},children:"💡 註冊好處"}),i.jsxs("div",{style:{fontSize:13,color:"#666",lineHeight:1.4},children:["• 免費體驗基礎功能",i.jsx("br",{}),"• 個人化使用記錄",i.jsx("br",{}),"• 安全可靠的服務"]})]}),i.jsxs("div",{style:{display:"flex",gap:12,justifyContent:"center"},children:[i.jsx("button",{onClick:()=>n("/register"),style:{background:"linear-gradient(135deg, #6B5BFF 0%, #00CFFF 100%)",color:"#fff",border:"none",borderRadius:12,padding:"12px 28px",fontWeight:700,cursor:"pointer",fontSize:16,boxShadow:"0 4px 12px #6B5BFF33",transition:"all 0.3s ease"},onMouseEnter:A=>{A.currentTarget.style.transform="translateY(-2px)",A.currentTarget.style.boxShadow="0 6px 16px #6B5BFF44"},onMouseLeave:A=>{A.currentTarget.style.transform="translateY(0)",A.currentTarget.style.boxShadow="0 4px 12px #6B5BFF33"},children:"🚀 立即註冊"}),i.jsx("button",{onClick:()=>s(!1),style:{background:"#f8f9ff",color:"#6B5BFF",border:"2px solid #6B5BFF",borderRadius:12,padding:"12px 28px",fontWeight:600,cursor:"pointer",fontSize:16,transition:"all 0.3s ease"},onMouseEnter:A=>{A.currentTarget.style.background="#6B5BFF",A.currentTarget.style.color="#fff"},onMouseLeave:A=>{A.currentTarget.style.background="#f8f9ff",A.currentTarget.style.color="#6B5BFF"},children:"💭 稍後再說"})]})]})}),m&&x&&i.jsx("div",{style:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",background:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e4},children:i.jsxs("div",{style:{background:"#fff",borderRadius:20,padding:32,maxWidth:480,width:"90%",textAlign:"center",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.2)"},children:[i.jsx("div",{style:{fontSize:64,marginBottom:16,color:"#52c41a"},children:"✅"}),i.jsx("h2",{style:{fontSize:24,fontWeight:700,color:"#333",marginBottom:12},children:"付款成功！"}),i.jsx("p",{style:{fontSize:16,color:"#666",marginBottom:20,lineHeight:1.6},children:x.message}),i.jsxs("div",{style:{background:"linear-gradient(135deg, #f6ffed 0%, #d9f7be 100%)",borderRadius:12,padding:16,marginBottom:24,border:"1px solid #b7eb8f"},children:[i.jsx("div",{style:{fontSize:14,color:"#52c41a",fontWeight:600,marginBottom:8},children:"🎉 訂閱詳情"}),i.jsxs("div",{style:{fontSize:13,color:"#666",lineHeight:1.4},children:["• 方案：",T(a),i.jsx("br",{}),"• 剩餘天數：",x.remainingDays," 天",i.jsx("br",{}),"• AI Token：",x.plan.limits.aiCostLimit,"K tokens",i.jsx("br",{}),"• 立即生效，可開始使用所有 AI 功能"]})]}),i.jsx("div",{style:{display:"flex",gap:12,justifyContent:"center"},children:i.jsx("button",{onClick:()=>n("/home"),style:{background:"linear-gradient(135deg, #52c41a 0%, #73d13d 100%)",color:"#fff",border:"none",borderRadius:12,padding:"14px 28px",fontSize:16,fontWeight:700,cursor:"pointer",flex:1,boxShadow:"0 4px 12px #52c41a33",transition:"all 0.3s ease"},onMouseEnter:A=>{A.currentTarget.style.transform="translateY(-2px)",A.currentTarget.style.boxShadow="0 6px 16px #52c41a44"},onMouseLeave:A=>{A.currentTarget.style.transform="translateY(0)",A.currentTarget.style.boxShadow="0 4px 12px #52c41a33"},children:"🚀 立即開始使用"})}),i.jsx("div",{style:{marginTop:16,fontSize:14,color:"#888"},children:"3秒後自動跳轉到首頁..."})]})})]})}function X3(){const n=wt(),t=gt().currentUser;return localStorage.getItem("lang"),t?i.jsxs("div",{style:{minHeight:"100vh",background:"#f7faff",padding:0},children:[i.jsx("button",{onClick:()=>n("/"),style:{position:"absolute",top:24,left:24,zIndex:10,background:"#fff",border:"1.5px solid #6B5BFF",color:"#6B5BFF",borderRadius:8,padding:"6px 18px",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:"0 2px 8px #0001"},children:"← 返回首頁"}),i.jsxs("div",{style:{maxWidth:500,margin:"0 auto",background:"#fff",borderRadius:18,boxShadow:"0 4px 24px #6B5BFF11",padding:"32px 24px",marginTop:64,textAlign:"center"},children:[i.jsx("img",{src:t.photoURL||"/avatars/Derxl.png",alt:"avatar",style:{width:88,height:88,borderRadius:"50%",objectFit:"cover",border:"2px solid #ececff",background:"#eee",marginBottom:18}}),i.jsx("div",{style:{fontSize:24,fontWeight:900,color:"#6B5BFF",marginBottom:8},children:t.displayName||t.email||"用戶"}),i.jsx("div",{style:{fontSize:16,color:"#888",marginBottom:18},children:t.email}),i.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:18,marginTop:24},children:[i.jsx("button",{onClick:()=>n("/CompleteProfile"),style:{background:"#00CFFF",color:"#fff",fontWeight:700,fontSize:18,padding:"10px 32px",borderRadius:10,boxShadow:"0 2px 8px #00CFFF33",border:"none",cursor:"pointer"},children:"編輯個人資料"}),i.jsx("button",{onClick:()=>n("/upgrade"),style:{background:"#6B5BFF",color:"#fff",fontWeight:700,fontSize:18,padding:"10px 32px",borderRadius:10,boxShadow:"0 2px 8px #6B5BFF33",border:"none",cursor:"pointer"},children:"升級訂閱"})]})]})]}):i.jsx("div",{style:{minHeight:"100vh",background:"#f7faff",display:"flex",alignItems:"center",justifyContent:"center"},children:i.jsxs("div",{style:{background:"#fff",borderRadius:16,padding:32,boxShadow:"0 4px 24px #0002",minWidth:320,textAlign:"center"},children:[i.jsx("div",{style:{fontSize:20,fontWeight:700,color:"#6B5BFF",marginBottom:18},children:"請先註冊/登入才能進入個人中心"}),i.jsx("button",{onClick:()=>n("/register"),style:{background:"#6B5BFF",color:"#fff",border:"none",borderRadius:8,padding:"8px 32px",fontWeight:700,fontSize:18,cursor:"pointer",marginTop:8},children:"前往註冊/登入"})]})})}function J3(){const n=wt();return i.jsxs("div",{style:{minHeight:"100vh",background:"#f7faff",padding:0},children:[i.jsx("button",{onClick:()=>n("/upgrade"),style:{position:"absolute",top:24,left:24,zIndex:10,background:"#fff",border:"1.5px solid #6B5BFF",color:"#6B5BFF",borderRadius:8,padding:"6px 18px",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:"0 2px 8px #0001"},children:"← 返回"}),i.jsx("div",{style:{maxWidth:900,margin:"0 auto",padding:"80px 24px 32px"},children:i.jsxs("div",{style:{background:"#fff",borderRadius:18,boxShadow:"0 4px 24px #6B5BFF11",padding:"32px 24px"},children:[i.jsx("h2",{style:{color:"#4B5BFF",fontWeight:900,fontSize:32,marginBottom:8,letterSpacing:2,textAlign:"center"},children:"付款設定說明"}),i.jsx("p",{style:{color:"#666",fontSize:18,textAlign:"center",marginBottom:32},children:"了解如何設定付款方式與完成訂閱"}),i.jsxs("div",{style:{marginBottom:32},children:[i.jsx("h3",{style:{color:"#333",fontWeight:700,fontSize:20,marginBottom:16},children:"支援的付款方式"}),i.jsxs("div",{style:{display:"grid",gap:16},children:[i.jsxs("div",{style:{border:"1px solid #e0e7ff",borderRadius:12,padding:20},children:[i.jsx("h4",{style:{color:"#6B5BFF",fontWeight:700,fontSize:18,marginBottom:8},children:"💳 Stripe"}),i.jsx("p",{style:{color:"#666",fontSize:16,lineHeight:1.6},children:"國際信用卡支付，支援 Visa、Mastercard、American Express 等主要信用卡。"})]}),i.jsxs("div",{style:{border:"1px solid #e0e7ff",borderRadius:12,padding:20},children:[i.jsx("h4",{style:{color:"#6B5BFF",fontWeight:700,fontSize:18,marginBottom:8},children:"🔵 PayPal"}),i.jsx("p",{style:{color:"#666",fontSize:16,lineHeight:1.6},children:"國際電子錢包，支援 PayPal 帳戶或信用卡付款。"})]}),i.jsxs("div",{style:{border:"1px solid #e0e7ff",borderRadius:12,padding:20},children:[i.jsx("h4",{style:{color:"#6B5BFF",fontWeight:700,fontSize:18,marginBottom:8},children:"🟢 綠界"}),i.jsx("p",{style:{color:"#666",fontSize:16,lineHeight:1.6},children:"台灣本地支付，支援信用卡、ATM 轉帳、超商付款等。"})]}),i.jsxs("div",{style:{border:"1px solid #e0e7ff",borderRadius:12,padding:20},children:[i.jsx("h4",{style:{color:"#6B5BFF",fontWeight:700,fontSize:18,marginBottom:8},children:"🔵 藍新"}),i.jsx("p",{style:{color:"#666",fontSize:16,lineHeight:1.6},children:"台灣本地支付，支援信用卡、ATM 轉帳、超商付款等。"})]})]})]}),i.jsxs("div",{style:{marginBottom:32},children:[i.jsx("h3",{style:{color:"#333",fontWeight:700,fontSize:20,marginBottom:16},children:"付款設定步驟"}),i.jsxs("ol",{style:{fontSize:16,lineHeight:1.8,paddingLeft:24},children:[i.jsx("li",{children:"選擇您想要的訂閱方案（月費或年費）"}),i.jsx("li",{children:"選擇付款方式（Stripe、PayPal、綠界、藍新）"}),i.jsx("li",{children:"點擊「立即升級」按鈕"}),i.jsx("li",{children:"系統會導向對應的付款頁面"}),i.jsx("li",{children:"完成付款後自動升級會員權益"})]})]}),i.jsxs("div",{style:{marginBottom:32},children:[i.jsx("h3",{style:{color:"#333",fontWeight:700,fontSize:20,marginBottom:16},children:"注意事項"}),i.jsxs("ul",{style:{fontSize:16,lineHeight:1.8,paddingLeft:24},children:[i.jsx("li",{children:"付款成功後，會員權益會立即生效"}),i.jsx("li",{children:"月費方案每月自動續費，年費方案每年自動續費"}),i.jsx("li",{children:"可隨時在會員中心取消自動續費"}),i.jsx("li",{children:"如有付款問題，請聯絡客服：support@restarter.com"})]})]}),i.jsx("div",{style:{textAlign:"center",marginTop:32},children:i.jsx("button",{onClick:()=>n("/upgrade"),style:{background:"linear-gradient(90deg,#6B5BFF 60%,#23c6e6 100%)",color:"#fff",border:"none",borderRadius:12,fontWeight:900,fontSize:20,padding:"12px 48px",boxShadow:"0 2px 12px #6B5BFF33",letterSpacing:2,cursor:"pointer"},children:"返回升級頁面"})})]})})]})}function Z3(){const n=wt();return i.jsxs("div",{style:{minHeight:"100vh",background:"#f7faff",padding:0},children:[i.jsx("button",{onClick:()=>n("/plans"),style:{position:"absolute",top:24,left:24,zIndex:10,background:"#fff",border:"1.5px solid #6B5BFF",color:"#6B5BFF",borderRadius:8,padding:"6px 18px",fontWeight:700,fontSize:16,cursor:"pointer",boxShadow:"0 2px 8px #0001"},children:"← 返回"}),i.jsxs("div",{style:{maxWidth:600,margin:"0 auto",background:"#fff",borderRadius:18,boxShadow:"0 4px 24px #6B5BFF11",padding:"32px 24px",marginTop:64},children:[i.jsx("h2",{style:{color:"#4B5BFF",fontWeight:900,fontSize:32,marginBottom:24,letterSpacing:1},children:"聯絡客服"}),i.jsx("div",{style:{fontSize:18,color:"#333",marginBottom:24,lineHeight:1.8},children:"如有任何問題、付款疑問、升級需求，歡迎透過以下方式聯絡我們："}),i.jsxs("ul",{style:{fontSize:17,color:"#666",marginBottom:32,marginLeft:24},children:[i.jsxs("li",{children:["Email：",i.jsx("a",{href:"mailto:support@restarter.app",style:{color:"#6B5BFF",textDecoration:"underline"},children:"support@restarter.app"})]}),i.jsxs("li",{children:["LINE 客服：",i.jsx("a",{href:"https://line.me/R/ti/p/@restarter",target:"_blank",rel:"noopener noreferrer",style:{color:"#6B5BFF",textDecoration:"underline"},children:"@restarter"})]}),i.jsxs("li",{children:["Messenger：",i.jsx("a",{href:"https://m.me/restarterapp",target:"_blank",rel:"noopener noreferrer",style:{color:"#6B5BFF",textDecoration:"underline"},children:"Restarter 粉專"})]}),i.jsxs("li",{children:["線上表單：",i.jsx("a",{href:"https://forms.gle/xxxxxx",target:"_blank",rel:"noopener noreferrer",style:{color:"#6B5BFF",textDecoration:"underline"},children:"填寫表單"})]})]}),i.jsx("div",{style:{fontSize:16,color:"#888",marginTop:24},children:"客服回覆時間：週一至週五 10:00-18:00"})]})]})}function eM(){const n=wt();gt();const{checkPermission:e,recordUsage:t}=Lo(),[r,s]=w.useState([]),[a,c]=w.useState(!1),[d,h]=w.useState("test-user-123"),m=R=>{s(T=>[...T,`${new Date().toLocaleTimeString()}: ${R}`])},g=async()=>{m("模擬登入測試用戶...");try{const R={uid:d,email:"test@example.com",displayName:"Test User"};return localStorage.setItem("testUser",JSON.stringify(R)),m("測試用戶已登入"),R}catch(R){return m(`登入失敗: ${R}`),null}},x=async()=>{c(!0),m("開始測試 Token 消耗功能...");try{await g();const R=await e("aiChat");if(m(`權限檢查結果: ${R.allowed?"允許":"拒絕"} - ${R.reason||"無原因"}`),R.allowed){await t("aiChat",5),m("已記錄 5 tokens 使用量");const T=await e("aiChat");if(m(`使用後權限檢查: ${T.allowed?"允許":"拒絕"}`),T.subscriptionData){const{usage:A,limits:D}=T.subscriptionData;m(`當前使用量: ${A.aiCost}/${D.aiCostLimit} tokens`),m(`剩餘 tokens: ${Math.max(0,D.aiCostLimit-A.aiCost)}`)}}else m("權限被拒絕，無法測試 token 消耗")}catch(R){m(`測試失敗: ${R}`)}finally{c(!1)}},S=async()=>{c(!0),m("開始測試達到限制功能...");try{await g();let R=0;const T=50;for(;R<T;){const A=await e("aiChat");if(!A.allowed){m(`達到限制！在第 ${R} 次嘗試後被拒絕`),m(`拒絕原因: ${A.reason}`);break}await t("aiChat",1),R++,R%10===0&&m(`已記錄 ${R} 次使用`)}R>=T&&m("達到最大測試次數，可能沒有設置限制")}catch(R){m(`測試失敗: ${R}`)}finally{c(!1)}},I=async()=>{c(!0),m("重置使用量...");try{await g();const R=await fetch("/api/subscription/reset-usage",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:d})});if(R.ok){const T=await R.json();m(`使用量已重置: ${T.message}`)}else{const T=await R.json();m(`重置失敗: ${T.error}`)}}catch(R){m(`重置失敗: ${R}`)}finally{c(!1)}},_=async()=>{m("獲取當前訂閱狀態...");try{await g();const R=await fetch(`/api/subscription/details/${d}`);if(R.ok){const T=await R.json();m("=== 當前訂閱狀態 ==="),m(`方案: ${T.subscription}`),m(`AI Token 使用: ${T.usage.aiCost}/${T.limits.aiCostLimit}`),m(`AI 聊天次數: ${T.usage.aiChats}/${T.limits.aiChats}`),m(`剩餘天數: ${T.remainingDays} 天`),m(`是否激活: ${T.isActive?"是":"否"}`)}else{const T=await R.json();m(`無法獲取訂閱狀態: ${T.error}`)}}catch(R){m(`獲取狀態失敗: ${R}`)}};return w.useEffect(()=>{g()},[]),i.jsxs("div",{style:{minHeight:"100vh",background:"#f7faff",padding:"20px",fontFamily:"Arial, sans-serif"},children:[i.jsx("button",{onClick:()=>n("/home"),style:{position:"absolute",top:20,left:20,background:"#6B5BFF",color:"white",border:"none",borderRadius:8,padding:"10px 20px",cursor:"pointer",fontSize:16},children:"← 返回首頁"}),i.jsxs("div",{style:{maxWidth:800,margin:"0 auto",paddingTop:60},children:[i.jsx("h1",{style:{color:"#333",textAlign:"center",marginBottom:30},children:"🧪 Token 消耗測試工具"}),i.jsxs("div",{style:{background:"#fff",borderRadius:12,padding:24,marginBottom:24,boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:[i.jsx("h3",{style:{color:"#333",marginBottom:16},children:"測試功能"}),i.jsxs("div",{style:{display:"flex",gap:12,flexWrap:"wrap",marginBottom:20},children:[i.jsx("button",{onClick:x,disabled:a,style:{background:"#6B5BFF",color:"white",border:"none",borderRadius:8,padding:"12px 24px",cursor:a?"not-allowed":"pointer",fontSize:14},children:"🔄 測試 Token 消耗"}),i.jsx("button",{onClick:S,disabled:a,style:{background:"#ff6b6b",color:"white",border:"none",borderRadius:8,padding:"12px 24px",cursor:a?"not-allowed":"pointer",fontSize:14},children:"⚠️ 測試達到限制"}),i.jsx("button",{onClick:I,disabled:a,style:{background:"#51cf66",color:"white",border:"none",borderRadius:8,padding:"12px 24px",cursor:a?"not-allowed":"pointer",fontSize:14},children:"🔄 重置使用量"}),i.jsx("button",{onClick:_,disabled:a,style:{background:"#339af0",color:"white",border:"none",borderRadius:8,padding:"12px 24px",cursor:a?"not-allowed":"pointer",fontSize:14},children:"📊 顯示當前狀態"})]}),a&&i.jsx("div",{style:{textAlign:"center",color:"#666",marginBottom:16},children:"⏳ 測試中..."})]}),i.jsxs("div",{style:{background:"#fff",borderRadius:12,padding:24,boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:[i.jsx("h3",{style:{color:"#333",marginBottom:16},children:"測試結果"}),i.jsx("div",{style:{background:"#f8f9fa",borderRadius:8,padding:16,maxHeight:400,overflowY:"auto",fontFamily:"monospace",fontSize:14,lineHeight:1.5},children:r.length===0?i.jsx("div",{style:{color:"#666",fontStyle:"italic"},children:"點擊上方按鈕開始測試..."}):r.map((R,T)=>i.jsx("div",{style:{marginBottom:4},children:R},T))}),r.length>0&&i.jsx("button",{onClick:()=>s([]),style:{background:"#868e96",color:"white",border:"none",borderRadius:6,padding:"8px 16px",cursor:"pointer",fontSize:12,marginTop:12},children:"清空結果"})]})]})]})}const tM=({onTestModeChange:n})=>{const[e,t]=w.useState(!1);w.useEffect(()=>{const s=localStorage.getItem("testMode")==="true";t(s),n(s)},[n]);const r=()=>{const s=!e;t(s),localStorage.setItem("testMode",s.toString()),n(s)};return i.jsxs("div",{style:{position:"fixed",top:"20px",right:"20px",zIndex:1e4,display:"flex",flexDirection:"column",alignItems:"center",gap:"8px"},children:[i.jsx("button",{onClick:r,style:{background:e?"#ff6b6b":"#4ecdc4",color:"white",border:"none",borderRadius:"8px",padding:"8px 12px",fontSize:"12px",fontWeight:"bold",cursor:"pointer",boxShadow:"0 2px 8px rgba(0,0,0,0.2)",transition:"all 0.3s ease",minWidth:"80px"},onMouseEnter:s=>{s.currentTarget.style.transform="scale(1.05)"},onMouseLeave:s=>{s.currentTarget.style.transform="scale(1)"},children:e?"測試模式 ON":"測試模式 OFF"}),e&&i.jsx("div",{style:{background:"rgba(255, 107, 107, 0.9)",color:"white",padding:"6px 10px",borderRadius:"6px",fontSize:"10px",textAlign:"center",maxWidth:"120px",lineHeight:"1.2"},children:"語音功能已解鎖"})]})},CI=_n.createContext({isTestMode:!1,setIsTestMode:()=>{}}),RI=()=>_n.useContext(CI);function nM(){const{isMicOn:n}=kI();return n?i.jsx("div",{style:{position:"fixed",top:"12px",left:"50%",transform:"translateX(-50%)",zIndex:9999,background:"#ff6347",borderRadius:"50%",padding:"12px",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"0 4px 20px rgba(0,0,0,0.35)",border:"2px solid white"},children:i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"30",height:"30",viewBox:"0 0 24 24",fill:"white",children:i.jsx("path",{d:"M12 14c1.66 0 3-1.34 3-3V5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3zm5.3-3c0 3-2.54 5.1-5.3 5.1S6.7 14 6.7 11H5c0 3.41 2.72 6.23 6 6.72V21h2v-3.28c3.28-.49 6-3.31 6-6.72h-1.7z"})})}):null}function rM(){const[n,e]=w.useState(null),[t,r]=w.useState(!0),[s,a]=w.useState(!1),c=gt(Do);return w.useEffect(()=>{const d=zo(c,h=>{e(h),r(!1)});return()=>d()},[c]),t?i.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh",fontSize:"2rem"},children:"Loading..."}):i.jsx(kz,{children:i.jsx(VD,{children:i.jsx(y3,{children:i.jsx(BD,{children:i.jsx(VC,{children:i.jsxs(CI.Provider,{value:{isTestMode:s,setIsTestMode:a},children:[i.jsx(tM,{onTestModeChange:a}),i.jsx(nM,{}),i.jsx(m3,{children:i.jsxs(DC,{children:[i.jsx(pt,{path:"/splash",element:i.jsx(aw,{})}),i.jsx(pt,{path:"/terms",element:i.jsx(OD,{})}),i.jsx(pt,{path:"/",element:i.jsx(aw,{})}),i.jsx(pt,{path:"/home",element:i.jsx(jz,{})}),i.jsx(pt,{path:"/register",element:i.jsx(kD,{})}),n&&i.jsx(pt,{path:"/wall",element:i.jsx(Ez,{})}),n&&i.jsx(pt,{path:"/echo-box",element:i.jsx(Cz,{})}),n&&i.jsx(pt,{path:"/my-story",element:i.jsx(Rz,{})}),n&&i.jsx(pt,{path:"/chat",element:i.jsx(pD,{})}),n&&i.jsx(pt,{path:"/friend",element:i.jsx(_D,{})}),n&&i.jsx(pt,{path:"/inbox",element:i.jsx(ID,{})}),n&&i.jsx(pt,{path:"/ai",element:i.jsx(ED,{})}),n&&i.jsx(pt,{path:"/tts",element:i.jsx(HS,{})}),n&&i.jsx(pt,{path:"/journal",element:i.jsx(x3,{})}),n&&i.jsx(pt,{path:"/missions",element:i.jsx(GS,{})}),n&&i.jsx(pt,{path:"/restart-missions",element:i.jsx(GS,{})}),n&&i.jsx(pt,{path:"/pairtalk",element:i.jsx(zD,{})}),n&&i.jsx(pt,{path:"/skillbox",element:i.jsx(DD,{})}),n&&i.jsx(pt,{path:"/skillbox/:scenarioId",element:i.jsx(JS,{})}),n&&i.jsx(pt,{path:"/practice",element:i.jsx(JS,{})}),n&&i.jsx(pt,{path:"/realistic-tts",element:i.jsx(HS,{})}),n&&i.jsx(pt,{path:"/storywall",element:i.jsx(d3,{})}),n&&i.jsx(pt,{path:"/chatroom",element:i.jsx(S3,{})}),n&&i.jsx(pt,{path:"/invites",element:i.jsx(tx,{})}),n&&i.jsx(pt,{path:"/mylinks",element:i.jsx(ex,{})}),i.jsx(pt,{path:"/about",element:i.jsx(T3,{})}),i.jsx(pt,{path:"/feedback",element:i.jsx(j3,{})}),i.jsx(pt,{path:"/admin/feedback",element:i.jsx(I3,{})}),i.jsx(pt,{path:"/CompleteProfile",element:i.jsx(C3,{})}),i.jsx(pt,{path:"/privacy-policy",element:i.jsx(A3,{})}),i.jsx(pt,{path:"/data-deletion",element:i.jsx(B3,{})}),i.jsx(pt,{path:"/HelpLab",element:i.jsx(D3,{})}),i.jsx(pt,{path:"/emotion-release",element:i.jsx(M3,{})}),i.jsx(pt,{path:"/plans",element:i.jsx(K3,{})}),i.jsx(pt,{path:"/payment",element:i.jsx(Q3,{})}),i.jsx(pt,{path:"/upgrade",element:i.jsx(Y3,{})}),i.jsx(pt,{path:"/profile",element:i.jsx(X3,{})}),i.jsx(pt,{path:"/payment-info",element:i.jsx(J3,{})}),i.jsx(pt,{path:"/contact",element:i.jsx(Z3,{})}),i.jsx(pt,{path:"/token-test",element:i.jsx(eM,{})})]})})]})})})})})})}const iM=UE.createRoot(document.getElementById("root"));iM.render(i.jsx(rM,{}));
